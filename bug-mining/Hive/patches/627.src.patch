diff --git a/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java b/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java
index d29cc77ad2..b46976f659 100644
--- a/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java
+++ b/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java
@@ -368,6 +368,7 @@ public static enum ConfVars {
     HIVEOPTCP("hive.optimize.cp", true), // column pruner
     HIVEOPTINDEXFILTER("hive.optimize.index.filter", false), // automatically use indexes
     HIVEOPTPPD("hive.optimize.ppd", true), // predicate pushdown
+    HIVEPPDREMOVEDUPLICATEFILTERS("hive.ppd.remove.duplicatefilters", true),
     // push predicates down to storage handlers
     HIVEOPTPPD_STORAGE("hive.optimize.ppd.storage", true),
     HIVEOPTGROUPBY("hive.optimize.groupby", true), // optimize group by
diff --git a/contrib/src/test/results/clientpositive/dboutput.q.out b/contrib/src/test/results/clientpositive/dboutput.q.out
index 72e9a228e0..188c27ddfe 100644
--- a/contrib/src/test/results/clientpositive/dboutput.q.out
+++ b/contrib/src/test/results/clientpositive/dboutput.q.out
@@ -143,21 +143,17 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: dboutput('jdbc:derby:../build/test_dboutput_db','','','INSERT INTO app_info (kkey,vvalue) VALUES (?,?)',key,value)
-                        type: int
-                  outputColumnNames: _col0
-                  File Output Operator
-                    compressed: false
-                    GlobalTableId: 0
-                    table:
-                        input format: org.apache.hadoop.mapred.TextInputFormat
-                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+              Select Operator
+                expressions:
+                      expr: dboutput('jdbc:derby:../build/test_dboutput_db','','','INSERT INTO app_info (kkey,vvalue) VALUES (?,?)',key,value)
+                      type: int
+                outputColumnNames: _col0
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 0
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
 
   Stage: Stage-0
     Fetch Operator
diff --git a/contrib/src/test/results/clientpositive/serde_typedbytes4.q.out b/contrib/src/test/results/clientpositive/serde_typedbytes4.q.out
index 2f0a25d42b..ee74d793ce 100644
--- a/contrib/src/test/results/clientpositive/serde_typedbytes4.q.out
+++ b/contrib/src/test/results/clientpositive/serde_typedbytes4.q.out
@@ -50,42 +50,38 @@ STAGE PLANS:
               predicate:
                   expr: (key < 100)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 100)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: UDFToByte(key)
-                        type: tinyint
-                        expr: value
-                        type: string
-                  outputColumnNames: _col0, _col1
-                  Transform Operator
-                    command: /bin/cat
-                    output info:
-                        input format: org.apache.hadoop.mapred.TextInputFormat
-                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                    Select Operator
-                      expressions:
+              Select Operator
+                expressions:
+                      expr: UDFToByte(key)
+                      type: tinyint
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Transform Operator
+                  command: /bin/cat
+                  output info:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                  Select Operator
+                    expressions:
+                          expr: _col0
+                          type: string
+                          expr: _col1
+                          type: string
+                    outputColumnNames: _col0, _col1
+                    Reduce Output Operator
+                      key expressions:
+                            expr: _col0
+                            type: string
+                            expr: _col1
+                            type: string
+                      sort order: ++
+                      tag: -1
+                      value expressions:
                             expr: _col0
                             type: string
                             expr: _col1
                             type: string
-                      outputColumnNames: _col0, _col1
-                      Reduce Output Operator
-                        key expressions:
-                              expr: _col0
-                              type: string
-                              expr: _col1
-                              type: string
-                        sort order: ++
-                        tag: -1
-                        value expressions:
-                              expr: _col0
-                              type: string
-                              expr: _col1
-                              type: string
       Reduce Operator Tree:
         Extract
           File Output Operator
diff --git a/hbase-handler/src/test/results/hbase_pushdown.q.out b/hbase-handler/src/test/results/hbase_pushdown.q.out
index 0dfb804cdb..50c7dee148 100644
--- a/hbase-handler/src/test/results/hbase_pushdown.q.out
+++ b/hbase-handler/src/test/results/hbase_pushdown.q.out
@@ -103,23 +103,19 @@ STAGE PLANS:
               predicate:
                   expr: (value like '%90%')
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: ((key = 90) and (value like '%90%'))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: int
-                        expr: value
-                        type: string
-                  outputColumnNames: _col0, _col1
-                  File Output Operator
-                    compressed: false
-                    GlobalTableId: 0
-                    table:
-                        input format: org.apache.hadoop.mapred.TextInputFormat
-                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+              Select Operator
+                expressions:
+                      expr: key
+                      type: int
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 0
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
 
   Stage: Stage-0
     Fetch Operator
@@ -166,23 +162,19 @@ STAGE PLANS:
               predicate:
                   expr: ((value like '%90%') and (key = UDFToInteger(value)))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (((key = 90) and (value like '%90%')) and (key = UDFToInteger(value)))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: int
-                        expr: value
-                        type: string
-                  outputColumnNames: _col0, _col1
-                  File Output Operator
-                    compressed: false
-                    GlobalTableId: 0
-                    table:
-                        input format: org.apache.hadoop.mapred.TextInputFormat
-                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+              Select Operator
+                expressions:
+                      expr: key
+                      type: int
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 0
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
 
   Stage: Stage-0
     Fetch Operator
@@ -217,23 +209,19 @@ STAGE PLANS:
               predicate:
                   expr: (((key = 80) and (key = 90)) and (value like '%90%'))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (((key = 80) and (key = 90)) and (value like '%90%'))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: int
-                        expr: value
-                        type: string
-                  outputColumnNames: _col0, _col1
-                  File Output Operator
-                    compressed: false
-                    GlobalTableId: 0
-                    table:
-                        input format: org.apache.hadoop.mapred.TextInputFormat
-                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+              Select Operator
+                expressions:
+                      expr: key
+                      type: int
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 0
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
 
   Stage: Stage-0
     Fetch Operator
@@ -300,23 +288,19 @@ STAGE PLANS:
               predicate:
                   expr: (CASE WHEN ((key = 90)) THEN (2) ELSE (4) END > 3)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (CASE WHEN ((key = 90)) THEN (2) ELSE (4) END > 3)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: int
-                        expr: value
-                        type: string
-                  outputColumnNames: _col0, _col1
-                  File Output Operator
-                    compressed: false
-                    GlobalTableId: 0
-                    table:
-                        input format: org.apache.hadoop.mapred.TextInputFormat
-                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+              Select Operator
+                expressions:
+                      expr: key
+                      type: int
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 0
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
 
   Stage: Stage-0
     Fetch Operator
@@ -353,23 +337,19 @@ STAGE PLANS:
               predicate:
                   expr: ((key = 80) or (value like '%90%'))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: ((key = 80) or (value like '%90%'))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: int
-                        expr: value
-                        type: string
-                  outputColumnNames: _col0, _col1
-                  File Output Operator
-                    compressed: false
-                    GlobalTableId: 0
-                    table:
-                        input format: org.apache.hadoop.mapred.TextInputFormat
-                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+              Select Operator
+                expressions:
+                      expr: key
+                      type: int
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 0
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
 
   Stage: Stage-0
     Fetch Operator
@@ -402,23 +382,19 @@ STAGE PLANS:
               predicate:
                   expr: (key = 90)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key = 90)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: int
-                        expr: value
-                        type: string
-                  outputColumnNames: _col0, _col1
-                  File Output Operator
-                    compressed: false
-                    GlobalTableId: 0
-                    table:
-                        input format: org.apache.hadoop.mapred.TextInputFormat
-                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+              Select Operator
+                expressions:
+                      expr: key
+                      type: int
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 0
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
 
   Stage: Stage-0
     Fetch Operator
diff --git a/hbase-handler/src/test/results/hbase_queries.q.out b/hbase-handler/src/test/results/hbase_queries.q.out
index 01fb09326f..f0f1babf75 100644
--- a/hbase-handler/src/test/results/hbase_queries.q.out
+++ b/hbase-handler/src/test/results/hbase_queries.q.out
@@ -50,32 +50,28 @@ STAGE PLANS:
               predicate:
                   expr: ((key % 2) = 0)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: ((key % 2) = 0)
-                    type: boolean
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
                 Select Operator
                   expressions:
-                        expr: key
-                        type: string
-                        expr: value
+                        expr: UDFToInteger(_col0)
+                        type: int
+                        expr: _col1
                         type: string
                   outputColumnNames: _col0, _col1
-                  Select Operator
-                    expressions:
-                          expr: UDFToInteger(_col0)
-                          type: int
-                          expr: _col1
-                          type: string
-                    outputColumnNames: _col0, _col1
-                    File Output Operator
-                      compressed: false
-                      GlobalTableId: 1
-                      table:
-                          input format: org.apache.hadoop.hive.hbase.HiveHBaseTableInputFormat
-                          output format: org.apache.hadoop.hive.hbase.HiveHBaseTableOutputFormat
-                          serde: org.apache.hadoop.hive.hbase.HBaseSerDe
-                          name: default.hbase_table_1
+                  File Output Operator
+                    compressed: false
+                    GlobalTableId: 1
+                    table:
+                        input format: org.apache.hadoop.hive.hbase.HiveHBaseTableInputFormat
+                        output format: org.apache.hadoop.hive.hbase.HiveHBaseTableOutputFormat
+                        serde: org.apache.hadoop.hive.hbase.HBaseSerDe
+                        name: default.hbase_table_1
 
 
 PREHOOK: query: FROM src INSERT OVERWRITE TABLE hbase_table_1 SELECT * WHERE (key%2)=0
@@ -306,24 +302,20 @@ STAGE PLANS:
               predicate:
                   expr: (key > 100)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key > 100)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: int
+                outputColumnNames: _col0
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: int
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
                         type: int
-                  outputColumnNames: _col0
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: int
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: int
-                    tag: 0
+                  tag: 0
         y:hbase_table_2 
           TableScan
             alias: hbase_table_2
@@ -331,31 +323,27 @@ STAGE PLANS:
               predicate:
                   expr: (key < 120)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 120)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: int
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
                         type: int
-                        expr: value
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: int
+                  tag: 1
+                  value expressions:
+                        expr: _col0
+                        type: int
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: int
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: int
-                    tag: 1
-                    value expressions:
-                          expr: _col0
-                          type: int
-                          expr: _col1
-                          type: string
       Reduce Operator Tree:
         Join Operator
           condition map:
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/Operator.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/Operator.java
index 31f8ecdd50..a8276318f8 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/Operator.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/Operator.java
@@ -675,6 +675,24 @@ public void removeChildAndAdoptItsChildren(Operator<? extends Serializable> chil
     }
   }
 
+  public void removeParent(Operator<? extends Serializable> parent) {
+    int parentIndex = parentOperators.indexOf(parent);
+    assert parentIndex != -1;
+    if (parentOperators.size() == 1) {
+      parentOperators = null;
+    } else {
+      parentOperators.remove(parentIndex);
+    }
+
+    int childIndex = parent.getChildOperators().indexOf(this);
+    assert childIndex != -1;
+    if (parent.getChildOperators().size() == 1) {
+      parent.setChildOperators(null);
+    } else {
+      parent.getChildOperators().remove(childIndex);
+    }
+  }
+
   /**
    * Replace one parent with another at the same position. Chilren of the new
    * parent are not updated
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/ppd/ExprWalkerInfo.java b/ql/src/java/org/apache/hadoop/hive/ql/ppd/ExprWalkerInfo.java
index c5906ddcca..1f37d72ab1 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/ppd/ExprWalkerInfo.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/ppd/ExprWalkerInfo.java
@@ -66,21 +66,30 @@ public ExprInfo(boolean isCandidate, String alias, ExprNodeDesc replacedNode) {
   private RowResolver toRR = null;
 
   /**
-   * this map contains a expr infos. Each key is a node in the expression tree
-   * and the information for each node is the value which is used while walking
-   * the tree by its parent.
+   * Values the expression sub-trees (predicates) that can be pushed down for
+   * root expression tree. Since there can be more than one alias in an
+   * expression tree, this is a map from the alias to predicates.
    */
   private final Map<String, List<ExprNodeDesc>> pushdownPreds;
+
   /**
-   * Values the expression sub-trees (predicates) that can be pushed down for
+   * Values the expression sub-trees (predicates) that can not be pushed down for
    * root expression tree. Since there can be more than one alias in an
    * expression tree, this is a map from the alias to predicates.
    */
+  private final Map<String, List<ExprNodeDesc>> nonFinalPreds;
+
+  /**
+   * this map contains a expr infos. Each key is a node in the expression tree
+   * and the information for each node is the value which is used while walking
+   * the tree by its parent.
+   */
   private final Map<ExprNodeDesc, ExprInfo> exprInfoMap;
   private boolean isDeterministic = true;
 
   public ExprWalkerInfo() {
     pushdownPreds = new HashMap<String, List<ExprNodeDesc>>();
+    nonFinalPreds = new HashMap<String, List<ExprNodeDesc>>();
     exprInfoMap = new HashMap<ExprNodeDesc, ExprInfo>();
   }
 
@@ -91,6 +100,7 @@ public ExprWalkerInfo(Operator<? extends Serializable> op,
 
     pushdownPreds = new HashMap<String, List<ExprNodeDesc>>();
     exprInfoMap = new HashMap<ExprNodeDesc, ExprInfo>();
+    nonFinalPreds = new HashMap<String, List<ExprNodeDesc>>();
   }
 
   /**
@@ -213,6 +223,19 @@ public void addFinalCandidate(ExprNodeDesc expr) {
     pushdownPreds.get(alias).add(expr.clone());
   }
 
+  /**
+   * Adds the passed list of pushDowns for the alias.
+   *
+   * @param alias
+   * @param pushDowns
+   */
+  public void addPushDowns(String alias, List<ExprNodeDesc> pushDowns) {
+    if (pushdownPreds.get(alias) == null) {
+      pushdownPreds.put(alias, new ArrayList<ExprNodeDesc>());
+    }
+    pushdownPreds.get(alias).addAll(pushDowns);
+  }
+
   /**
    * Returns the list of pushdown expressions for each alias that appear in the
    * current operator's RowResolver. The exprs in each list can be combined
@@ -224,6 +247,28 @@ public Map<String, List<ExprNodeDesc>> getFinalCandidates() {
     return pushdownPreds;
   }
 
+  /**
+   * Adds the specified expr as a non-final candidate
+   *
+   * @param expr
+   */
+  public void addNonFinalCandidate(ExprNodeDesc expr) {
+    String alias = getAlias(expr);
+    if (nonFinalPreds.get(alias) == null) {
+      nonFinalPreds.put(alias, new ArrayList<ExprNodeDesc>());
+    }
+    nonFinalPreds.get(alias).add(expr.clone());
+  }
+
+  /**
+   * Returns list of non-final candidate predicate for each map.
+   *
+   * @return
+   */
+  public Map<String, List<ExprNodeDesc>> getNonFinalCandidates() {
+    return nonFinalPreds;
+  }
+
   /**
    * Merges the specified pushdown predicates with the current class.
    * 
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/ppd/ExprWalkerProcFactory.java b/ql/src/java/org/apache/hadoop/hive/ql/ppd/ExprWalkerProcFactory.java
index cd2cbcb42b..6a7b618da0 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/ppd/ExprWalkerProcFactory.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/ppd/ExprWalkerProcFactory.java
@@ -26,6 +26,7 @@
 
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
+import org.apache.hadoop.hive.conf.HiveConf;
 import org.apache.hadoop.hive.ql.exec.FunctionRegistry;
 import org.apache.hadoop.hive.ql.exec.Operator;
 import org.apache.hadoop.hive.ql.lib.DefaultGraphWalker;
@@ -277,9 +278,10 @@ public static ExprWalkerInfo extractPushdownPreds(OpWalkerInfo opContext,
 
     egw.startWalking(startNodes, null);
 
+    HiveConf conf = opContext.getParseContext().getConf();
     // check the root expression for final candidates
     for (ExprNodeDesc pred : clonedPreds) {
-      extractFinalCandidates(pred, exprContext);
+      extractFinalCandidates(pred, exprContext, conf);
     }
     return exprContext;
   }
@@ -289,17 +291,20 @@ public static ExprWalkerInfo extractPushdownPreds(OpWalkerInfo opContext,
    * candidates.
    */
   private static void extractFinalCandidates(ExprNodeDesc expr,
-      ExprWalkerInfo ctx) {
+      ExprWalkerInfo ctx, HiveConf conf) {
     if (ctx.isCandidate(expr)) {
       ctx.addFinalCandidate(expr);
       return;
+    } else if (!FunctionRegistry.isOpAnd(expr) &&
+        HiveConf.getBoolVar(conf, HiveConf.ConfVars.HIVEPPDREMOVEDUPLICATEFILTERS)) {
+      ctx.addNonFinalCandidate(expr);
     }
 
     if (FunctionRegistry.isOpAnd(expr)) {
       // If the operator is AND, we need to determine if any of the children are
       // final candidates.
       for (Node ch : expr.getChildren()) {
-        extractFinalCandidates((ExprNodeDesc) ch, ctx);
+        extractFinalCandidates((ExprNodeDesc) ch, ctx, conf);
       }
     }
   }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/ppd/OpProcFactory.java b/ql/src/java/org/apache/hadoop/hive/ql/ppd/OpProcFactory.java
index 9e23c42287..28655684a3 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/ppd/OpProcFactory.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/ppd/OpProcFactory.java
@@ -88,6 +88,26 @@ public Object process(Node nd, Stack<Node> stack, NodeProcessorCtx procCtx,
       // script operator is a black-box to hive so no optimization here
       // assuming that nothing can be pushed above the script op
       // same with LIMIT op
+      // create a filter with all children predicates
+      OpWalkerInfo owi = (OpWalkerInfo) procCtx;
+      if (HiveConf.getBoolVar(owi.getParseContext().getConf(),
+          HiveConf.ConfVars.HIVEPPDREMOVEDUPLICATEFILTERS)) {
+        ExprWalkerInfo unpushedPreds = mergeChildrenPred(nd, owi, null, false);
+        return createFilter((Operator)nd, unpushedPreds, owi);
+      }
+      return null;
+    }
+
+  }
+
+  public static class UDTFPPD extends DefaultPPD implements NodeProcessor {
+    @Override
+    public Object process(Node nd, Stack<Node> stack, NodeProcessorCtx procCtx,
+        Object... nodeOutputs) throws SemanticException {
+      LOG.info("Processing for " + nd.getName() + "("
+          + ((Operator) nd).getIdentifier() + ")");
+      //Predicates for UDTF wont be candidates for its children. So, nothing to
+      //optimize here. See lateral_view_ppd.q for example.
       return null;
     }
 
@@ -102,6 +122,10 @@ public Object process(Node nd, Stack<Node> stack, NodeProcessorCtx procCtx,
           + ((Operator) nd).getIdentifier() + ")");
       OpWalkerInfo owi = (OpWalkerInfo) procCtx;
 
+      // The lateral view forward operator has 2 children, a SELECT(*) and
+      // a SELECT(cols) (for the UDTF operator) The child at index 0 is the
+      // SELECT(*) because that's the way that the DAG was constructed. We
+      // only want to get the predicates from the SELECT(*).
       ExprWalkerInfo childPreds = owi
       .getPrunedPreds((Operator<? extends Serializable>) nd.getChildren()
       .get(0));
@@ -146,22 +170,32 @@ public Object process(Node nd, Stack<Node> stack, NodeProcessorCtx procCtx,
       OpWalkerInfo owi = (OpWalkerInfo) procCtx;
       Operator<? extends Serializable> op = (Operator<? extends Serializable>) nd;
       ExprNodeDesc predicate = (((FilterOperator) nd).getConf()).getPredicate();
-      // get pushdown predicates for this operator's predicate
-      ExprWalkerInfo ewi = ExprWalkerProcFactory.extractPushdownPreds(owi, op,
-          predicate);
-      if (!ewi.isDeterministic()) {
-        /* predicate is not deterministic */
-        if (op.getChildren() != null && op.getChildren().size() == 1) {
-          createFilter(op, owi
-              .getPrunedPreds((Operator<? extends Serializable>) (op
-              .getChildren().get(0))), owi);
+      ExprWalkerInfo ewi = new ExprWalkerInfo();
+      // Don't push a sampling predicate since createFilter() always creates filter
+      // with isSamplePred = false. Also, the filterop with sampling pred is always
+      // a child of TableScan, so there is no need to push this predicate.
+      if (!((FilterOperator)op).getConf().getIsSamplingPred()) {
+        // get pushdown predicates for this operator's predicate
+        ewi = ExprWalkerProcFactory.extractPushdownPreds(owi, op, predicate);
+        if (!ewi.isDeterministic()) {
+          /* predicate is not deterministic */
+          if (op.getChildren() != null && op.getChildren().size() == 1) {
+            createFilter(op, owi
+                .getPrunedPreds((Operator<? extends Serializable>) (op
+                .getChildren().get(0))), owi);
+          }
+          return null;
         }
-
-        return null;
+        if (HiveConf.getBoolVar(owi.getParseContext().getConf(),
+            HiveConf.ConfVars.HIVEPPDREMOVEDUPLICATEFILTERS)) {
+          // add this filter for deletion, if it does not have non-final candidates
+          if (ewi.getNonFinalCandidates().values().isEmpty()) {
+            owi.addCandidateFilterOp((FilterOperator)op);
+          }
+        }
+        logExpr(nd, ewi);
+        owi.putPrunedPreds((Operator<? extends Serializable>) nd, ewi);
       }
-
-      logExpr(nd, ewi);
-      owi.putPrunedPreds(op, ewi);
       // merge it with children predicates
       mergeWithChildrenPred(op, owi, ewi, null, false);
 
@@ -182,7 +216,15 @@ public Object process(Node nd, Stack<Node> stack, NodeProcessorCtx procCtx,
       OpWalkerInfo owi = (OpWalkerInfo) procCtx;
       Set<String> aliases = getQualifiedAliases((JoinOperator) nd, owi
           .getRowResolver(nd));
-      mergeWithChildrenPred(nd, owi, null, aliases, false);
+      boolean hasUnpushedPredicates = mergeWithChildrenPred(nd, owi, null, aliases, false);
+      if (HiveConf.getBoolVar(owi.getParseContext().getConf(),
+          HiveConf.ConfVars.HIVEPPDREMOVEDUPLICATEFILTERS)) {
+        if (hasUnpushedPredicates) {
+          aliases = null;
+        }
+        ExprWalkerInfo unpushedPreds = mergeChildrenPred(nd, owi, aliases, false);
+        return createFilter((Operator)nd, unpushedPreds, owi);
+      }
       return null;
     }
 
@@ -283,7 +325,15 @@ public Object process(Node nd, Stack<Node> stack, NodeProcessorCtx procCtx,
         Object... nodeOutputs) throws SemanticException {
       LOG.info("Processing for " + nd.getName() + "("
           + ((Operator) nd).getIdentifier() + ")");
-      mergeWithChildrenPred(nd, (OpWalkerInfo) procCtx, null, null, false);
+      OpWalkerInfo owi = (OpWalkerInfo) procCtx;
+      boolean hasUnpushedPredicates = mergeWithChildrenPred(nd, owi, null, null, false);
+      if (HiveConf.getBoolVar(owi.getParseContext().getConf(),
+          HiveConf.ConfVars.HIVEPPDREMOVEDUPLICATEFILTERS)) {
+        if (hasUnpushedPredicates) {
+          ExprWalkerInfo unpushedPreds = mergeChildrenPred(nd, owi, null, false);
+          return createFilter((Operator)nd, unpushedPreds, owi);
+        }
+      }
       return null;
     }
 
@@ -318,20 +368,21 @@ protected void logExpr(Node nd, ExprWalkerInfo ewi) {
      * @param ignoreAliases
      * @throws SemanticException
      */
-    protected void mergeWithChildrenPred(Node nd, OpWalkerInfo owi,
+    protected boolean mergeWithChildrenPred(Node nd, OpWalkerInfo owi,
         ExprWalkerInfo ewi, Set<String> aliases, boolean ignoreAliases)
         throws SemanticException {
+      boolean hasUnpushedPredicates = false;
       if (nd.getChildren() == null || nd.getChildren().size() > 1) {
         // ppd for multi-insert query is not yet implemented
         // no-op for leafs
-        return;
+        return hasUnpushedPredicates;
       }
       Operator<? extends Serializable> op = (Operator<? extends Serializable>) nd;
       ExprWalkerInfo childPreds = owi
           .getPrunedPreds((Operator<? extends Serializable>) nd.getChildren()
           .get(0));
       if (childPreds == null) {
-        return;
+        return hasUnpushedPredicates;
       }
       if (ewi == null) {
         ewi = new ExprWalkerInfo();
@@ -344,11 +395,40 @@ protected void mergeWithChildrenPred(Node nd, OpWalkerInfo owi,
           // input8.q
           ExprWalkerInfo extractPushdownPreds = ExprWalkerProcFactory
               .extractPushdownPreds(owi, op, e.getValue());
+          if (!extractPushdownPreds.getNonFinalCandidates().isEmpty()) {
+            hasUnpushedPredicates = true;
+          }
           ewi.merge(extractPushdownPreds);
           logExpr(nd, extractPushdownPreds);
         }
       }
       owi.putPrunedPreds((Operator<? extends Serializable>) nd, ewi);
+      return hasUnpushedPredicates;
+    }
+
+    protected ExprWalkerInfo mergeChildrenPred(Node nd, OpWalkerInfo owi,
+        Set<String> excludedAliases, boolean ignoreAliases)
+        throws SemanticException {
+      if (nd.getChildren() == null) {
+        return null;
+      }
+      Operator<? extends Serializable> op = (Operator<? extends Serializable>) nd;
+      ExprWalkerInfo ewi = new ExprWalkerInfo();
+      for (Operator<? extends Serializable> child : op.getChildOperators()) {
+        ExprWalkerInfo childPreds = owi.getPrunedPreds(child);
+        if (childPreds == null) {
+          continue;
+        }
+        for (Entry<String, List<ExprNodeDesc>> e : childPreds
+            .getFinalCandidates().entrySet()) {
+          if (ignoreAliases || excludedAliases == null ||
+              !excludedAliases.contains(e.getKey()) || e.getKey() == null) {
+            ewi.addPushDowns(e.getKey(), e.getValue());
+            logExpr(nd, ewi);
+          }
+        }
+      }
+      return ewi;
     }
   }
 
@@ -386,7 +466,7 @@ protected static Object createFilter(Operator op,
     if (condn == null) {
       return null;
     }
-    
+
     if (op instanceof TableScanOperator) {
       boolean pushFilterToStorage;
       HiveConf hiveConf = owi.getParseContext().getConf();
@@ -423,6 +503,24 @@ protected static Object createFilter(Operator op,
     }
     OpParseContext ctx = new OpParseContext(inputRR);
     owi.put(output, ctx);
+
+    if (HiveConf.getBoolVar(owi.getParseContext().getConf(),
+        HiveConf.ConfVars.HIVEPPDREMOVEDUPLICATEFILTERS)) {
+      // remove the candidate filter ops
+      for (FilterOperator fop : owi.getCandidateFilterOps()) {
+        List<Operator<? extends Serializable>> children = fop.getChildOperators();
+        List<Operator<? extends Serializable>> parents = fop.getParentOperators();
+        for (Operator<? extends Serializable> parent : parents) {
+          parent.getChildOperators().addAll(children);
+          parent.removeChild(fop);
+        }
+        for (Operator<? extends Serializable> child : children) {
+          child.getParentOperators().addAll(parents);
+          child.removeParent(fop);
+        }
+      }
+      owi.getCandidateFilterOps().clear();
+    }
     return output;
   }
 
@@ -506,7 +604,7 @@ private static ExprNodeDesc pushFilterToStorageHandler(
     tableScanDesc.setFilterExpr(decomposed.pushedPredicate);
     return decomposed.residualPredicate;
   }
-  
+
   public static NodeProcessor getFilterProc() {
     return new FilterPPD();
   }
@@ -536,7 +634,7 @@ public static NodeProcessor getLIMProc() {
   }
 
   public static NodeProcessor getUDTFProc() {
-    return new ScriptPPD();
+    return new UDTFPPD();
   }
 
   public static NodeProcessor getLVFProc() {
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/ppd/OpWalkerInfo.java b/ql/src/java/org/apache/hadoop/hive/ql/ppd/OpWalkerInfo.java
index 2d11e877a7..50d146cdef 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/ppd/OpWalkerInfo.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/ppd/OpWalkerInfo.java
@@ -18,9 +18,12 @@
 package org.apache.hadoop.hive.ql.ppd;
 
 import java.io.Serializable;
+import java.util.ArrayList;
 import java.util.HashMap;
+import java.util.List;
 import java.util.Map;
 
+import org.apache.hadoop.hive.ql.exec.FilterOperator;
 import org.apache.hadoop.hive.ql.exec.Operator;
 import org.apache.hadoop.hive.ql.lib.Node;
 import org.apache.hadoop.hive.ql.lib.NodeProcessorCtx;
@@ -39,11 +42,13 @@ public class OpWalkerInfo implements NodeProcessorCtx {
   private final HashMap<Operator<? extends Serializable>, ExprWalkerInfo> opToPushdownPredMap;
   private final Map<Operator<? extends Serializable>, OpParseContext> opToParseCtxMap;
   private final ParseContext pGraphContext;
+  private final List<FilterOperator> candidateFilterOps;
 
   public OpWalkerInfo(ParseContext pGraphContext) {
     this.pGraphContext = pGraphContext;
     opToParseCtxMap = pGraphContext.getOpParseCtx();
     opToPushdownPredMap = new HashMap<Operator<? extends Serializable>, ExprWalkerInfo>();
+    candidateFilterOps = new ArrayList<FilterOperator>();
   }
 
   public ExprWalkerInfo getPrunedPreds(Operator<? extends Serializable> op) {
@@ -67,4 +72,13 @@ public OpParseContext put(Operator<? extends Serializable> key,
   public ParseContext getParseContext() {
     return pGraphContext;
   }
+
+  public List<FilterOperator> getCandidateFilterOps() {
+    return candidateFilterOps;
+  }
+
+  public void addCandidateFilterOp(FilterOperator fop) {
+    candidateFilterOps.add(fop);
+  }
+
 }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/ppd/PredicatePushDown.java b/ql/src/java/org/apache/hadoop/hive/ql/ppd/PredicatePushDown.java
index ef647b3bef..7b23b7b140 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/ppd/PredicatePushDown.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/ppd/PredicatePushDown.java
@@ -17,13 +17,10 @@
  */
 package org.apache.hadoop.hive.ql.ppd;
 
-import java.io.Serializable;
 import java.util.ArrayList;
-import java.util.HashMap;
 import java.util.LinkedHashMap;
 import java.util.Map;
 
-import org.apache.hadoop.hive.ql.exec.Operator;
 import org.apache.hadoop.hive.ql.lib.DefaultGraphWalker;
 import org.apache.hadoop.hive.ql.lib.DefaultRuleDispatcher;
 import org.apache.hadoop.hive.ql.lib.Dispatcher;
@@ -33,7 +30,6 @@
 import org.apache.hadoop.hive.ql.lib.Rule;
 import org.apache.hadoop.hive.ql.lib.RuleRegExp;
 import org.apache.hadoop.hive.ql.optimizer.Transform;
-import org.apache.hadoop.hive.ql.parse.OpParseContext;
 import org.apache.hadoop.hive.ql.parse.ParseContext;
 import org.apache.hadoop.hive.ql.parse.SemanticException;
 
@@ -73,12 +69,10 @@
 public class PredicatePushDown implements Transform {
 
   private ParseContext pGraphContext;
-  private HashMap<Operator<? extends Serializable>, OpParseContext> opToParseCtxMap;
 
   @Override
   public ParseContext transform(ParseContext pctx) throws SemanticException {
     pGraphContext = pctx;
-    opToParseCtxMap = pGraphContext.getOpParseCtx();
 
     // create a the context for walking operators
     OpWalkerInfo opWalkerInfo = new OpWalkerInfo(pGraphContext);
diff --git a/ql/src/test/queries/clientpositive/ppd1.q b/ql/src/test/queries/clientpositive/ppd1.q
index e66a80a8e9..a5a4db0544 100644
--- a/ql/src/test/queries/clientpositive/ppd1.q
+++ b/ql/src/test/queries/clientpositive/ppd1.q
@@ -1,7 +1,14 @@
 set hive.optimize.ppd=true;
+set hive.ppd.remove.duplicatefilters=false;
 
 EXPLAIN
 SELECT src.key as c3 from src where src.key > '2';
 
 SELECT src.key as c3 from src where src.key > '2';
 
+set hive.ppd.remove.duplicatefilters=true;
+
+EXPLAIN
+SELECT src.key as c3 from src where src.key > '2';
+
+SELECT src.key as c3 from src where src.key > '2';
diff --git a/ql/src/test/queries/clientpositive/ppd_clusterby.q b/ql/src/test/queries/clientpositive/ppd_clusterby.q
index e4d13ae0a7..0c8b245d81 100644
--- a/ql/src/test/queries/clientpositive/ppd_clusterby.q
+++ b/ql/src/test/queries/clientpositive/ppd_clusterby.q
@@ -1,4 +1,15 @@
 set hive.optimize.ppd=true;
+set hive.ppd.remove.duplicatefilters=false;
+
+EXPLAIN
+SELECT * FROM SRC x where x.key = 10 CLUSTER BY x.key;
+SELECT * FROM SRC x where x.key = 10 CLUSTER BY x.key;
+
+EXPLAIN 
+SELECT x.key, x.value as v1, y.key  FROM SRC x JOIN SRC y ON (x.key = y.key)  where x.key = 20 CLUSTER BY v1;;
+SELECT x.key, x.value as v1, y.key  FROM SRC x JOIN SRC y ON (x.key = y.key) where x.key = 20 CLUSTER BY v1;
+
+set hive.ppd.remove.duplicatefilters=true;
 
 EXPLAIN
 SELECT * FROM SRC x where x.key = 10 CLUSTER BY x.key;
diff --git a/ql/src/test/queries/clientpositive/ppd_constant_expr.q b/ql/src/test/queries/clientpositive/ppd_constant_expr.q
index 0b450aff54..969c7e4f0c 100644
--- a/ql/src/test/queries/clientpositive/ppd_constant_expr.q
+++ b/ql/src/test/queries/clientpositive/ppd_constant_expr.q
@@ -1,4 +1,6 @@
 set hive.optimize.ppd=true;
+set hive.ppd.remove.duplicatefilters=false;
+
 CREATE TABLE ppd_constant_expr(c1 STRING, c2 INT, c3 DOUBLE) STORED AS TEXTFILE;
 
 EXPLAIN
@@ -10,4 +12,13 @@ INSERT OVERWRITE TABLE ppd_constant_expr SELECT 4 + NULL, src1.key - NULL, NULL
 
 SELECT ppd_constant_expr.* FROM ppd_constant_expr;
 
+set hive.ppd.remove.duplicatefilters=true;
+
+EXPLAIN
+FROM src1 
+INSERT OVERWRITE TABLE ppd_constant_expr SELECT 4 + NULL, src1.key - NULL, NULL + NULL;
 
+FROM src1 
+INSERT OVERWRITE TABLE ppd_constant_expr SELECT 4 + NULL, src1.key - NULL, NULL + NULL;
+
+SELECT ppd_constant_expr.* FROM ppd_constant_expr;
diff --git a/ql/src/test/queries/clientpositive/ppd_gby.q b/ql/src/test/queries/clientpositive/ppd_gby.q
index d7af0cb660..65c0b01198 100644
--- a/ql/src/test/queries/clientpositive/ppd_gby.q
+++ b/ql/src/test/queries/clientpositive/ppd_gby.q
@@ -1,4 +1,18 @@
 set hive.optimize.ppd=true;
+set hive.ppd.remove.duplicatefilters=false;
+
+EXPLAIN
+SELECT src1.c1 
+FROM
+(SELECT src.value as c1, count(src.key) as c2 from src where src.value > 'val_10' group by src.value) src1
+WHERE src1.c1 > 'val_200' and (src1.c2 > 30 or src1.c1 < 'val_400'); 
+
+SELECT src1.c1 
+FROM
+(SELECT src.value as c1, count(src.key) as c2 from src where src.value > 'val_10' group by src.value) src1
+WHERE src1.c1 > 'val_200' and (src1.c2 > 30 or src1.c1 < 'val_400'); 
+
+set hive.ppd.remove.duplicatefilters=true;
 
 EXPLAIN
 SELECT src1.c1 
diff --git a/ql/src/test/queries/clientpositive/ppd_gby2.q b/ql/src/test/queries/clientpositive/ppd_gby2.q
index 8b98612a44..ae288eada2 100644
--- a/ql/src/test/queries/clientpositive/ppd_gby2.q
+++ b/ql/src/test/queries/clientpositive/ppd_gby2.q
@@ -1,4 +1,20 @@
 set hive.optimize.ppd=true;
+set hive.ppd.remove.duplicatefilters=false;
+
+EXPLAIN
+SELECT max(src1.c1), src1.c2 
+FROM
+(SELECT src.value AS c1, count(src.key) AS c2 FROM src WHERE src.value > 'val_10' GROUP BY src.value) src1
+WHERE src1.c1 > 'val_200' AND (src1.c2 > 30 OR src1.c1 < 'val_400')
+GROUP BY src1.c2; 
+
+SELECT max(src1.c1), src1.c2 
+FROM
+(SELECT src.value AS c1, count(src.key) AS c2 FROM src WHERE src.value > 'val_10' GROUP BY src.value) src1
+WHERE src1.c1 > 'val_200' AND (src1.c2 > 30 OR src1.c1 < 'val_400')
+GROUP BY src1.c2; 
+
+set hive.ppd.remove.duplicatefilters=true;
 
 EXPLAIN
 SELECT max(src1.c1), src1.c2 
diff --git a/ql/src/test/queries/clientpositive/ppd_gby_join.q b/ql/src/test/queries/clientpositive/ppd_gby_join.q
index 22661901b8..82f358b0d6 100644
--- a/ql/src/test/queries/clientpositive/ppd_gby_join.q
+++ b/ql/src/test/queries/clientpositive/ppd_gby_join.q
@@ -1,4 +1,5 @@
 set hive.optimize.ppd=true;
+set hive.ppd.remove.duplicatefilters=false;
 
 EXPLAIN
 SELECT src1.c1, count(1) 
@@ -10,3 +11,14 @@ ON src1.c1 = src2.c3 AND src1.c1 < '400'
 WHERE src1.c1 > '20' AND (src1.c2 < 'val_50' OR src1.c1 > '2') AND (src2.c3 > '50' OR src1.c1 < '50') AND (src2.c3 <> '4')
 GROUP BY src1.c1;
 
+set hive.ppd.remove.duplicatefilters=true;
+
+EXPLAIN
+SELECT src1.c1, count(1) 
+FROM
+(SELECT src.key AS c1, src.value AS c2 from src where src.key > '1' ) src1
+JOIN
+(SELECT src.key AS c3, src.value AS c4 from src where src.key > '2' ) src2
+ON src1.c1 = src2.c3 AND src1.c1 < '400'
+WHERE src1.c1 > '20' AND (src1.c2 < 'val_50' OR src1.c1 > '2') AND (src2.c3 > '50' OR src1.c1 < '50') AND (src2.c3 <> '4')
+GROUP BY src1.c1;
diff --git a/ql/src/test/queries/clientpositive/ppd_join.q b/ql/src/test/queries/clientpositive/ppd_join.q
index 3b4f8bbe7b..09323e965b 100644
--- a/ql/src/test/queries/clientpositive/ppd_join.q
+++ b/ql/src/test/queries/clientpositive/ppd_join.q
@@ -1,4 +1,24 @@
 set hive.optimize.ppd=true;
+set hive.ppd.remove.duplicatefilters=false;
+
+EXPLAIN
+SELECT src1.c1, src2.c4 
+FROM
+(SELECT src.key as c1, src.value as c2 from src where src.key > '1' ) src1
+JOIN
+(SELECT src.key as c3, src.value as c4 from src where src.key > '2' ) src2
+ON src1.c1 = src2.c3 AND src1.c1 < '400'
+WHERE src1.c1 > '20' and (src1.c2 < 'val_50' or src1.c1 > '2') and (src2.c3 > '50' or src1.c1 < '50') and (src2.c3 <> '4');
+
+SELECT src1.c1, src2.c4 
+FROM
+(SELECT src.key as c1, src.value as c2 from src where src.key > '1' ) src1
+JOIN
+(SELECT src.key as c3, src.value as c4 from src where src.key > '2' ) src2
+ON src1.c1 = src2.c3 AND src1.c1 < '400'
+WHERE src1.c1 > '20' and (src1.c2 < 'val_50' or src1.c1 > '2') and (src2.c3 > '50' or src1.c1 < '50') and (src2.c3 <> '4');
+
+set hive.ppd.remove.duplicatefilters=true;
 
 EXPLAIN
 SELECT src1.c1, src2.c4 
diff --git a/ql/src/test/queries/clientpositive/ppd_join2.q b/ql/src/test/queries/clientpositive/ppd_join2.q
index 3ded91456f..8bd4cae3f9 100644
--- a/ql/src/test/queries/clientpositive/ppd_join2.q
+++ b/ql/src/test/queries/clientpositive/ppd_join2.q
@@ -1,4 +1,30 @@
 set hive.optimize.ppd=true;
+set hive.ppd.remove.duplicatefilters=false;
+
+EXPLAIN
+SELECT src1.c1, src2.c4 
+FROM
+(SELECT src.key as c1, src.value as c2 from src where src.key <> '302' ) src1
+JOIN
+(SELECT src.key as c3, src.value as c4 from src where src.key <> '305' ) src2
+ON src1.c1 = src2.c3 AND src1.c1 < '400'
+JOIN
+(SELECT src.key as c5, src.value as c6 from src where src.key <> '306' ) src3
+ON src1.c2 = src3.c6
+WHERE src1.c1 <> '311' and (src1.c2 <> 'val_50' or src1.c1 > '1') and (src2.c3 <> '10' or src1.c1 <> '10') and (src2.c3 <> '14') and (sqrt(src3.c5) <> 13);
+
+SELECT src1.c1, src2.c4 
+FROM
+(SELECT src.key as c1, src.value as c2 from src where src.key <> '302' ) src1
+JOIN
+(SELECT src.key as c3, src.value as c4 from src where src.key <> '305' ) src2
+ON src1.c1 = src2.c3 AND src1.c1 < '400'
+JOIN
+(SELECT src.key as c5, src.value as c6 from src where src.key <> '306' ) src3
+ON src1.c2 = src3.c6
+WHERE src1.c1 <> '311' and (src1.c2 <> 'val_50' or src1.c1 > '1') and (src2.c3 <> '10' or src1.c1 <> '10') and (src2.c3 <> '14') and (sqrt(src3.c5) <> 13);
+
+set hive.ppd.remove.duplicatefilters=true;
 
 EXPLAIN
 SELECT src1.c1, src2.c4 
diff --git a/ql/src/test/queries/clientpositive/ppd_join3.q b/ql/src/test/queries/clientpositive/ppd_join3.q
index 9fc510fa51..7abf410986 100644
--- a/ql/src/test/queries/clientpositive/ppd_join3.q
+++ b/ql/src/test/queries/clientpositive/ppd_join3.q
@@ -1,4 +1,30 @@
 set hive.optimize.ppd=true;
+set hive.ppd.remove.duplicatefilters=false;
+
+EXPLAIN
+SELECT src1.c1, src2.c4 
+FROM
+(SELECT src.key as c1, src.value as c2 from src where src.key <> '11' ) src1
+JOIN
+(SELECT src.key as c3, src.value as c4 from src where src.key <> '12' ) src2
+ON src1.c1 = src2.c3 AND src1.c1 < '400'
+JOIN
+(SELECT src.key as c5, src.value as c6 from src where src.key <> '13' ) src3
+ON src1.c1 = src3.c5
+WHERE src1.c1 > '0' and (src1.c2 <> 'val_500' or src1.c1 > '1') and (src2.c3 > '10' or src1.c1 <> '10') and (src2.c3 <> '4') and (src3.c5 <> '1');
+
+SELECT src1.c1, src2.c4 
+FROM
+(SELECT src.key as c1, src.value as c2 from src where src.key <> '11' ) src1
+JOIN
+(SELECT src.key as c3, src.value as c4 from src where src.key <> '12' ) src2
+ON src1.c1 = src2.c3 AND src1.c1 < '400'
+JOIN
+(SELECT src.key as c5, src.value as c6 from src where src.key <> '13' ) src3
+ON src1.c1 = src3.c5
+WHERE src1.c1 > '0' and (src1.c2 <> 'val_500' or src1.c1 > '1') and (src2.c3 > '10' or src1.c1 <> '10') and (src2.c3 <> '4') and (src3.c5 <> '1');
+
+set hive.ppd.remove.duplicatefilters=true;
 
 EXPLAIN
 SELECT src1.c1, src2.c4 
diff --git a/ql/src/test/queries/clientpositive/ppd_multi_insert.q b/ql/src/test/queries/clientpositive/ppd_multi_insert.q
index 9e79c179d1..a802df1b98 100644
--- a/ql/src/test/queries/clientpositive/ppd_multi_insert.q
+++ b/ql/src/test/queries/clientpositive/ppd_multi_insert.q
@@ -1,6 +1,5 @@
 set hive.optimize.ppd=true;
-
-
+set hive.ppd.remove.duplicatefilters=false;
 
 CREATE TABLE mi1(key INT, value STRING) STORED AS TEXTFILE;
 CREATE TABLE mi2(key INT, value STRING) STORED AS TEXTFILE;
@@ -25,5 +24,22 @@ SELECT mi3.* FROM mi3;
 dfs -cat ../build/ql/test/data/warehouse/mi4.out/*;
 
 
+set hive.ppd.remove.duplicatefilters=true;
+
+EXPLAIN
+FROM src a JOIN src b ON (a.key = b.key)
+INSERT OVERWRITE TABLE mi1 SELECT a.* WHERE a.key < 100
+INSERT OVERWRITE TABLE mi2 SELECT a.key, a.value WHERE a.key >= 100 and a.key < 200
+INSERT OVERWRITE TABLE mi3 PARTITION(ds='2008-04-08', hr='12') SELECT a.key WHERE a.key >= 200 and a.key < 300
+INSERT OVERWRITE DIRECTORY '../build/ql/test/data/warehouse/mi4.out' SELECT a.value WHERE a.key >= 300;
 
+FROM src a JOIN src b ON (a.key = b.key)
+INSERT OVERWRITE TABLE mi1 SELECT a.* WHERE a.key < 100
+INSERT OVERWRITE TABLE mi2 SELECT a.key, a.value WHERE a.key >= 100 and a.key < 200
+INSERT OVERWRITE TABLE mi3 PARTITION(ds='2008-04-08', hr='12') SELECT a.key WHERE a.key >= 200 and a.key < 300
+INSERT OVERWRITE DIRECTORY '../build/ql/test/data/warehouse/mi4.out' SELECT a.value WHERE a.key >= 300;
 
+SELECT mi1.* FROM mi1;
+SELECT mi2.* FROM mi2;
+SELECT mi3.* FROM mi3;
+dfs -cat ../build/ql/test/data/warehouse/mi4.out/*;
diff --git a/ql/src/test/queries/clientpositive/ppd_outer_join1.q b/ql/src/test/queries/clientpositive/ppd_outer_join1.q
index 0ce3c9a6d7..752176c4b7 100644
--- a/ql/src/test/queries/clientpositive/ppd_outer_join1.q
+++ b/ql/src/test/queries/clientpositive/ppd_outer_join1.q
@@ -1,4 +1,5 @@
 set hive.optimize.ppd=true;
+set hive.ppd.remove.duplicatefilters=false;
 
 EXPLAIN
  FROM 
@@ -17,3 +18,21 @@ EXPLAIN
  SELECT a.key, a.value, b.key, b.value
  WHERE a.key > 10 AND a.key < 20 AND b.key > 15 AND b.key < 25;
 
+set hive.ppd.remove.duplicatefilters=true;
+
+EXPLAIN
+ FROM 
+  src a
+ LEFT OUTER JOIN 
+  src b 
+ ON (a.key = b.key)
+ SELECT a.key, a.value, b.key, b.value
+ WHERE a.key > 10 AND a.key < 20 AND b.key > 15 AND b.key < 25;
+
+ FROM 
+  src a
+ LEFT OUTER JOIN 
+  src b 
+ ON (a.key = b.key)
+ SELECT a.key, a.value, b.key, b.value
+ WHERE a.key > 10 AND a.key < 20 AND b.key > 15 AND b.key < 25;
diff --git a/ql/src/test/queries/clientpositive/ppd_outer_join2.q b/ql/src/test/queries/clientpositive/ppd_outer_join2.q
index e92e7367f8..e22892b45f 100644
--- a/ql/src/test/queries/clientpositive/ppd_outer_join2.q
+++ b/ql/src/test/queries/clientpositive/ppd_outer_join2.q
@@ -1,4 +1,5 @@
 set hive.optimize.ppd=true;
+set hive.ppd.remove.duplicatefilters=false;
 
 EXPLAIN
  FROM 
@@ -17,3 +18,21 @@ EXPLAIN
  SELECT a.key, a.value, b.key, b.value
  WHERE a.key > '10' AND a.key < '20' AND b.key > '15' AND b.key < '25';
 
+set hive.ppd.remove.duplicatefilters=true;
+
+EXPLAIN
+ FROM 
+  src a
+ RIGHT OUTER JOIN 
+  src b 
+ ON (a.key = b.key)
+ SELECT a.key, a.value, b.key, b.value
+ WHERE a.key > '10' AND a.key < '20' AND b.key > '15' AND b.key < '25';
+
+ FROM 
+  src a
+ RIGHT OUTER JOIN 
+  src b 
+ ON (a.key = b.key)
+ SELECT a.key, a.value, b.key, b.value
+ WHERE a.key > '10' AND a.key < '20' AND b.key > '15' AND b.key < '25';
diff --git a/ql/src/test/queries/clientpositive/ppd_outer_join3.q b/ql/src/test/queries/clientpositive/ppd_outer_join3.q
index f2bcdade59..d756b90e84 100644
--- a/ql/src/test/queries/clientpositive/ppd_outer_join3.q
+++ b/ql/src/test/queries/clientpositive/ppd_outer_join3.q
@@ -1,4 +1,5 @@
 set hive.optimize.ppd=true;
+set hive.ppd.remove.duplicatefilters=false;
 
 EXPLAIN
  FROM 
@@ -17,5 +18,21 @@ EXPLAIN
  SELECT a.key, a.value, b.key, b.value
  WHERE a.key > '10' AND a.key < '20' AND b.key > '15' AND b.key < '25';
 
+set hive.ppd.remove.duplicatefilters=true;
 
+EXPLAIN
+ FROM 
+  src a
+ FULL OUTER JOIN 
+  src b 
+ ON (a.key = b.key)
+ SELECT a.key, a.value, b.key, b.value
+ WHERE a.key > '10' AND a.key < '20' AND b.key > '15' AND b.key < '25';
 
+ FROM 
+  src a
+ FULL OUTER JOIN 
+  src b 
+ ON (a.key = b.key)
+ SELECT a.key, a.value, b.key, b.value
+ WHERE a.key > '10' AND a.key < '20' AND b.key > '15' AND b.key < '25';
diff --git a/ql/src/test/queries/clientpositive/ppd_outer_join4.q b/ql/src/test/queries/clientpositive/ppd_outer_join4.q
index b65e73e59e..e465eda68e 100644
--- a/ql/src/test/queries/clientpositive/ppd_outer_join4.q
+++ b/ql/src/test/queries/clientpositive/ppd_outer_join4.q
@@ -1,4 +1,5 @@
 set hive.optimize.ppd=true;
+set hive.ppd.remove.duplicatefilters=false;
 
 EXPLAIN
  FROM 
@@ -23,3 +24,27 @@ EXPLAIN
  SELECT a.key, a.value, b.key, b.value, c.key
  WHERE a.key > '10' AND a.key < '20' AND b.key > '15' AND b.key < '25' AND sqrt(c.key) <> 13 ;
 
+set hive.ppd.remove.duplicatefilters=true;
+
+EXPLAIN
+ FROM 
+  src a
+ LEFT OUTER JOIN
+  src b
+ ON (a.key = b.key)
+ RIGHT OUTER JOIN 
+  src c 
+ ON (a.key = c.key)
+ SELECT a.key, a.value, b.key, b.value, c.key
+ WHERE a.key > '10' AND a.key < '20' AND b.key > '15' AND b.key < '25' AND sqrt(c.key) <> 13 ;
+
+ FROM 
+  src a
+ LEFT OUTER JOIN
+  src b
+ ON (a.key = b.key)
+ RIGHT OUTER JOIN 
+  src c 
+ ON (a.key = c.key)
+ SELECT a.key, a.value, b.key, b.value, c.key
+ WHERE a.key > '10' AND a.key < '20' AND b.key > '15' AND b.key < '25' AND sqrt(c.key) <> 13 ;
diff --git a/ql/src/test/queries/clientpositive/ppd_random.q b/ql/src/test/queries/clientpositive/ppd_random.q
index 4c498e29ff..de0c067f35 100644
--- a/ql/src/test/queries/clientpositive/ppd_random.q
+++ b/ql/src/test/queries/clientpositive/ppd_random.q
@@ -1,4 +1,16 @@
 set hive.optimize.ppd=true;
+set hive.ppd.remove.duplicatefilters=false;
+
+EXPLAIN
+SELECT src1.c1, src2.c4 
+FROM
+(SELECT src.key as c1, src.value as c2 from src ) src1
+JOIN
+(SELECT src.key as c3, src.value as c4 from src where src.key > '2' ) src2
+ON src1.c1 = src2.c3
+WHERE rand() > 0.5;
+
+set hive.ppd.remove.duplicatefilters=true;
 
 EXPLAIN
 SELECT src1.c1, src2.c4 
diff --git a/ql/src/test/queries/clientpositive/ppd_transform.q b/ql/src/test/queries/clientpositive/ppd_transform.q
index eb49558e69..ba92c239e8 100644
--- a/ql/src/test/queries/clientpositive/ppd_transform.q
+++ b/ql/src/test/queries/clientpositive/ppd_transform.q
@@ -1,4 +1,5 @@
 set hive.optimize.ppd=true;
+set hive.ppd.remove.duplicatefilters=false;
 
 EXPLAIN
 FROM (
@@ -17,3 +18,21 @@ FROM (
 ) tmap
 SELECT tmap.tkey, tmap.tvalue WHERE tmap.tkey < 100;
 
+set hive.ppd.remove.duplicatefilters=true;
+
+EXPLAIN
+FROM (
+  FROM src
+  SELECT TRANSFORM(src.key, src.value)
+         USING '/bin/cat' AS (tkey, tvalue) 
+  CLUSTER BY tkey 
+) tmap
+SELECT tmap.tkey, tmap.tvalue WHERE tmap.tkey < 100;
+
+FROM (
+  FROM src
+  SELECT TRANSFORM(src.key, src.value)
+         USING '/bin/cat' AS (tkey, tvalue) 
+  CLUSTER BY tkey 
+) tmap
+SELECT tmap.tkey, tmap.tvalue WHERE tmap.tkey < 100;
diff --git a/ql/src/test/queries/clientpositive/ppd_udf_case.q b/ql/src/test/queries/clientpositive/ppd_udf_case.q
index 6d475b1ea2..b7a6b15bfd 100644
--- a/ql/src/test/queries/clientpositive/ppd_udf_case.q
+++ b/ql/src/test/queries/clientpositive/ppd_udf_case.q
@@ -1,4 +1,32 @@
 set hive.optimize.ppd=true;
+set hive.ppd.remove.duplicatefilters=false;
+
+EXPLAIN
+SELECT *
+FROM srcpart a JOIN srcpart b
+ON a.key = b.key
+WHERE a.ds = '2008-04-08' AND
+      b.ds = '2008-04-08' AND
+      CASE a.key
+        WHEN '27' THEN TRUE
+        WHEN '38' THEN FALSE
+        ELSE NULL
+       END
+ORDER BY a.key, a.value, a.ds, a.hr, b.key, b.value, b.ds, b.hr;
+
+SELECT *
+FROM srcpart a JOIN srcpart b
+ON a.key = b.key
+WHERE a.ds = '2008-04-08' AND
+      b.ds = '2008-04-08' AND
+      CASE a.key
+        WHEN '27' THEN TRUE
+        WHEN '38' THEN FALSE
+        ELSE NULL
+       END
+ORDER BY a.key, a.value, a.ds, a.hr, b.key, b.value, b.ds, b.hr;
+
+set hive.ppd.remove.duplicatefilters=true;
 
 EXPLAIN
 SELECT *
diff --git a/ql/src/test/queries/clientpositive/ppd_union.q b/ql/src/test/queries/clientpositive/ppd_union.q
index 74fcfa10dd..2cd876e078 100644
--- a/ql/src/test/queries/clientpositive/ppd_union.q
+++ b/ql/src/test/queries/clientpositive/ppd_union.q
@@ -1,4 +1,5 @@
 set hive.optimize.ppd=true;
+set hive.ppd.remove.duplicatefilters=false;
 
 EXPLAIN
 FROM (
@@ -17,4 +18,21 @@ FROM (
 SELECT unioned_query.*
   WHERE key > '4' and value > 'val_4';
 
+set hive.ppd.remove.duplicatefilters=true;
 
+EXPLAIN
+FROM (
+  FROM src select src.key, src.value WHERE src.key < '100'
+    UNION ALL
+  FROM src SELECT src.* WHERE src.key > '150'
+) unioned_query
+SELECT unioned_query.*
+  WHERE key > '4' and value > 'val_4';
+
+FROM (
+  FROM src select src.key, src.value WHERE src.key < '100'
+    UNION ALL
+  FROM src SELECT src.* WHERE src.key > '150'
+) unioned_query
+SELECT unioned_query.*
+  WHERE key > '4' and value > 'val_4';
diff --git a/ql/src/test/results/clientpositive/auto_join0.q.out b/ql/src/test/results/clientpositive/auto_join0.q.out
index 9f5f19081b..dc716f3004 100644
--- a/ql/src/test/results/clientpositive/auto_join0.q.out
+++ b/ql/src/test/results/clientpositive/auto_join0.q.out
@@ -52,26 +52,22 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
-                  outputColumnNames: _col0, _col1
-                  HashTable Sink Operator
-                    condition expressions:
-                      0 {_col0} {_col1}
-                      1 {_col0} {_col1}
-                    handleSkewJoin: false
-                    keys:
-                      0 []
-                      1 []
-                    Position of Big Table: 0
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                HashTable Sink Operator
+                  condition expressions:
+                    0 {_col0} {_col1}
+                    1 {_col0} {_col1}
+                  handleSkewJoin: false
+                  keys:
+                    0 []
+                    1 []
+                  Position of Big Table: 0
 
   Stage: Stage-5
     Map Reduce
@@ -83,46 +79,42 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
-                  outputColumnNames: _col0, _col1
-                  Map Join Operator
-                    condition map:
-                         Inner Join 0 to 1
-                    condition expressions:
-                      0 {_col0} {_col1}
-                      1 {_col0} {_col1}
-                    handleSkewJoin: false
-                    keys:
-                      0 []
-                      1 []
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Map Join Operator
+                  condition map:
+                       Inner Join 0 to 1
+                  condition expressions:
+                    0 {_col0} {_col1}
+                    1 {_col0} {_col1}
+                  handleSkewJoin: false
+                  keys:
+                    0 []
+                    1 []
+                  outputColumnNames: _col0, _col1, _col2, _col3
+                  Position of Big Table: 0
+                  Select Operator
+                    expressions:
+                          expr: _col0
+                          type: string
+                          expr: _col1
+                          type: string
+                          expr: _col2
+                          type: string
+                          expr: _col3
+                          type: string
                     outputColumnNames: _col0, _col1, _col2, _col3
-                    Position of Big Table: 0
-                    Select Operator
-                      expressions:
-                            expr: _col0
-                            type: string
-                            expr: _col1
-                            type: string
-                            expr: _col2
-                            type: string
-                            expr: _col3
-                            type: string
-                      outputColumnNames: _col0, _col1, _col2, _col3
-                      File Output Operator
-                        compressed: false
-                        GlobalTableId: 0
-                        table:
-                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
-                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+                    File Output Operator
+                      compressed: false
+                      GlobalTableId: 0
+                      table:
+                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
       Local Work:
         Map Reduce Local Work
 
@@ -220,26 +212,22 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
-                  outputColumnNames: _col0, _col1
-                  HashTable Sink Operator
-                    condition expressions:
-                      0 {_col0} {_col1}
-                      1 {_col0} {_col1}
-                    handleSkewJoin: false
-                    keys:
-                      0 []
-                      1 []
-                    Position of Big Table: 1
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                HashTable Sink Operator
+                  condition expressions:
+                    0 {_col0} {_col1}
+                    1 {_col0} {_col1}
+                  handleSkewJoin: false
+                  keys:
+                    0 []
+                    1 []
+                  Position of Big Table: 1
 
   Stage: Stage-6
     Map Reduce
@@ -251,46 +239,42 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
-                  outputColumnNames: _col0, _col1
-                  Map Join Operator
-                    condition map:
-                         Inner Join 0 to 1
-                    condition expressions:
-                      0 {_col0} {_col1}
-                      1 {_col0} {_col1}
-                    handleSkewJoin: false
-                    keys:
-                      0 []
-                      1 []
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Map Join Operator
+                  condition map:
+                       Inner Join 0 to 1
+                  condition expressions:
+                    0 {_col0} {_col1}
+                    1 {_col0} {_col1}
+                  handleSkewJoin: false
+                  keys:
+                    0 []
+                    1 []
+                  outputColumnNames: _col0, _col1, _col2, _col3
+                  Position of Big Table: 1
+                  Select Operator
+                    expressions:
+                          expr: _col0
+                          type: string
+                          expr: _col1
+                          type: string
+                          expr: _col2
+                          type: string
+                          expr: _col3
+                          type: string
                     outputColumnNames: _col0, _col1, _col2, _col3
-                    Position of Big Table: 1
-                    Select Operator
-                      expressions:
-                            expr: _col0
-                            type: string
-                            expr: _col1
-                            type: string
-                            expr: _col2
-                            type: string
-                            expr: _col3
-                            type: string
-                      outputColumnNames: _col0, _col1, _col2, _col3
-                      File Output Operator
-                        compressed: false
-                        GlobalTableId: 0
-                        table:
-                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
-                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+                    File Output Operator
+                      compressed: false
+                      GlobalTableId: 0
+                      table:
+                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
       Local Work:
         Map Reduce Local Work
 
@@ -304,25 +288,21 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  sort order: 
+                  tag: 0
+                  value expressions:
+                        expr: _col0
                         type: string
-                        expr: value
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    sort order: 
-                    tag: 0
-                    value expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
         a:src2:src 
           TableScan
             alias: src
@@ -330,25 +310,21 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  sort order: 
+                  tag: 1
+                  value expressions:
+                        expr: _col0
                         type: string
-                        expr: value
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    sort order: 
-                    tag: 1
-                    value expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
       Reduce Operator Tree:
         Join Operator
           condition map:
diff --git a/ql/src/test/results/clientpositive/auto_join11.q.out b/ql/src/test/results/clientpositive/auto_join11.q.out
index 7881d9962c..246ff61260 100644
--- a/ql/src/test/results/clientpositive/auto_join11.q.out
+++ b/ql/src/test/results/clientpositive/auto_join11.q.out
@@ -73,41 +73,37 @@ STAGE PLANS:
                       expr: key
                       type: string
                 outputColumnNames: _col0
-                Filter Operator
-                  predicate:
-                      expr: (_col0 < 100)
-                      type: boolean
-                  Map Join Operator
-                    condition map:
-                         Inner Join 0 to 1
-                    condition expressions:
-                      0 {_col0}
-                      1 {_col1}
-                    handleSkewJoin: false
-                    keys:
-                      0 [Column[_col0]]
-                      1 [Column[_col0]]
+                Map Join Operator
+                  condition map:
+                       Inner Join 0 to 1
+                  condition expressions:
+                    0 {_col0}
+                    1 {_col1}
+                  handleSkewJoin: false
+                  keys:
+                    0 [Column[_col0]]
+                    1 [Column[_col0]]
+                  outputColumnNames: _col0, _col3
+                  Position of Big Table: 0
+                  Select Operator
+                    expressions:
+                          expr: _col0
+                          type: string
+                          expr: _col3
+                          type: string
                     outputColumnNames: _col0, _col3
-                    Position of Big Table: 0
-                    Select Operator
-                      expressions:
-                            expr: _col0
-                            type: string
-                            expr: _col3
-                            type: string
-                      outputColumnNames: _col0, _col3
-                      Group By Operator
-                        aggregations:
-                              expr: sum(hash(_col0,_col3))
-                        bucketGroup: false
-                        mode: hash
-                        outputColumnNames: _col0
-                        File Output Operator
-                          compressed: false
-                          GlobalTableId: 0
-                          table:
-                              input format: org.apache.hadoop.mapred.SequenceFileInputFormat
-                              output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+                    Group By Operator
+                      aggregations:
+                            expr: sum(hash(_col0,_col3))
+                      bucketGroup: false
+                      mode: hash
+                      outputColumnNames: _col0
+                      File Output Operator
+                        compressed: false
+                        GlobalTableId: 0
+                        table:
+                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
       Local Work:
         Map Reduce Local Work
 
@@ -159,19 +155,15 @@ STAGE PLANS:
                       expr: key
                       type: string
                 outputColumnNames: _col0
-                Filter Operator
-                  predicate:
-                      expr: (_col0 < 100)
-                      type: boolean
-                  HashTable Sink Operator
-                    condition expressions:
-                      0 {_col0}
-                      1 {_col1}
-                    handleSkewJoin: false
-                    keys:
-                      0 [Column[_col0]]
-                      1 [Column[_col0]]
-                    Position of Big Table: 1
+                HashTable Sink Operator
+                  condition expressions:
+                    0 {_col0}
+                    1 {_col1}
+                  handleSkewJoin: false
+                  keys:
+                    0 [Column[_col0]]
+                    1 [Column[_col0]]
+                  Position of Big Table: 1
 
   Stage: Stage-5
     Map Reduce
@@ -235,22 +227,18 @@ STAGE PLANS:
                       expr: key
                       type: string
                 outputColumnNames: _col0
-                Filter Operator
-                  predicate:
-                      expr: (_col0 < 100)
-                      type: boolean
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: 0
-                    value expressions:
-                          expr: _col0
-                          type: string
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: 0
+                  value expressions:
+                        expr: _col0
+                        type: string
         src2:src 
           TableScan
             alias: src
diff --git a/ql/src/test/results/clientpositive/auto_join12.q.out b/ql/src/test/results/clientpositive/auto_join12.q.out
index 4b24503cab..dcf991e6d5 100644
--- a/ql/src/test/results/clientpositive/auto_join12.q.out
+++ b/ql/src/test/results/clientpositive/auto_join12.q.out
@@ -82,21 +82,17 @@ STAGE PLANS:
                       expr: key
                       type: string
                 outputColumnNames: _col0
-                Filter Operator
-                  predicate:
-                      expr: (_col0 < 80)
-                      type: boolean
-                  HashTable Sink Operator
-                    condition expressions:
-                      0 {_col0}
-                      1 {_col1}
-                      2 
-                    handleSkewJoin: false
-                    keys:
-                      0 [Column[_col0]]
-                      1 [Column[_col0]]
-                      2 [Column[_col0]]
-                    Position of Big Table: 0
+                HashTable Sink Operator
+                  condition expressions:
+                    0 {_col0}
+                    1 {_col1}
+                    2 
+                  handleSkewJoin: false
+                  keys:
+                    0 [Column[_col0]]
+                    1 [Column[_col0]]
+                    2 [Column[_col0]]
+                  Position of Big Table: 0
 
   Stage: Stage-5
     Map Reduce
@@ -113,44 +109,40 @@ STAGE PLANS:
                       expr: key
                       type: string
                 outputColumnNames: _col0
-                Filter Operator
-                  predicate:
-                      expr: (_col0 < 100)
-                      type: boolean
-                  Map Join Operator
-                    condition map:
-                         Inner Join 0 to 1
-                         Inner Join 0 to 2
-                    condition expressions:
-                      0 {_col0}
-                      1 {_col1}
-                      2 
-                    handleSkewJoin: false
-                    keys:
-                      0 [Column[_col0]]
-                      1 [Column[_col0]]
-                      2 [Column[_col0]]
+                Map Join Operator
+                  condition map:
+                       Inner Join 0 to 1
+                       Inner Join 0 to 2
+                  condition expressions:
+                    0 {_col0}
+                    1 {_col1}
+                    2 
+                  handleSkewJoin: false
+                  keys:
+                    0 [Column[_col0]]
+                    1 [Column[_col0]]
+                    2 [Column[_col0]]
+                  outputColumnNames: _col0, _col3
+                  Position of Big Table: 0
+                  Select Operator
+                    expressions:
+                          expr: _col0
+                          type: string
+                          expr: _col3
+                          type: string
                     outputColumnNames: _col0, _col3
-                    Position of Big Table: 0
-                    Select Operator
-                      expressions:
-                            expr: _col0
-                            type: string
-                            expr: _col3
-                            type: string
-                      outputColumnNames: _col0, _col3
-                      Group By Operator
-                        aggregations:
-                              expr: sum(hash(_col0,_col3))
-                        bucketGroup: false
-                        mode: hash
-                        outputColumnNames: _col0
-                        File Output Operator
-                          compressed: false
-                          GlobalTableId: 0
-                          table:
-                              input format: org.apache.hadoop.mapred.SequenceFileInputFormat
-                              output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+                    Group By Operator
+                      aggregations:
+                            expr: sum(hash(_col0,_col3))
+                      bucketGroup: false
+                      mode: hash
+                      outputColumnNames: _col0
+                      File Output Operator
+                        compressed: false
+                        GlobalTableId: 0
+                        table:
+                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
       Local Work:
         Map Reduce Local Work
 
@@ -205,21 +197,17 @@ STAGE PLANS:
                       expr: key
                       type: string
                 outputColumnNames: _col0
-                Filter Operator
-                  predicate:
-                      expr: (_col0 < 100)
-                      type: boolean
-                  HashTable Sink Operator
-                    condition expressions:
-                      0 {_col0}
-                      1 {_col1}
-                      2 
-                    handleSkewJoin: false
-                    keys:
-                      0 [Column[_col0]]
-                      1 [Column[_col0]]
-                      2 [Column[_col0]]
-                    Position of Big Table: 1
+                HashTable Sink Operator
+                  condition expressions:
+                    0 {_col0}
+                    1 {_col1}
+                    2 
+                  handleSkewJoin: false
+                  keys:
+                    0 [Column[_col0]]
+                    1 [Column[_col0]]
+                    2 [Column[_col0]]
+                  Position of Big Table: 1
         src3:src 
           TableScan
             alias: src
@@ -232,21 +220,17 @@ STAGE PLANS:
                       expr: key
                       type: string
                 outputColumnNames: _col0
-                Filter Operator
-                  predicate:
-                      expr: (_col0 < 80)
-                      type: boolean
-                  HashTable Sink Operator
-                    condition expressions:
-                      0 {_col0}
-                      1 {_col1}
-                      2 
-                    handleSkewJoin: false
-                    keys:
-                      0 [Column[_col0]]
-                      1 [Column[_col0]]
-                      2 [Column[_col0]]
-                    Position of Big Table: 1
+                HashTable Sink Operator
+                  condition expressions:
+                    0 {_col0}
+                    1 {_col1}
+                    2 
+                  handleSkewJoin: false
+                  keys:
+                    0 [Column[_col0]]
+                    1 [Column[_col0]]
+                    2 [Column[_col0]]
+                  Position of Big Table: 1
 
   Stage: Stage-6
     Map Reduce
@@ -320,21 +304,17 @@ STAGE PLANS:
                       expr: key
                       type: string
                 outputColumnNames: _col0
-                Filter Operator
-                  predicate:
-                      expr: (_col0 < 100)
-                      type: boolean
-                  HashTable Sink Operator
-                    condition expressions:
-                      0 {_col0}
-                      1 {_col1}
-                      2 
-                    handleSkewJoin: false
-                    keys:
-                      0 [Column[_col0]]
-                      1 [Column[_col0]]
-                      2 [Column[_col0]]
-                    Position of Big Table: 2
+                HashTable Sink Operator
+                  condition expressions:
+                    0 {_col0}
+                    1 {_col1}
+                    2 
+                  handleSkewJoin: false
+                  keys:
+                    0 [Column[_col0]]
+                    1 [Column[_col0]]
+                    2 [Column[_col0]]
+                  Position of Big Table: 2
         src2:src 
           TableScan
             alias: src
@@ -372,44 +352,40 @@ STAGE PLANS:
                       expr: key
                       type: string
                 outputColumnNames: _col0
-                Filter Operator
-                  predicate:
-                      expr: (_col0 < 80)
-                      type: boolean
-                  Map Join Operator
-                    condition map:
-                         Inner Join 0 to 1
-                         Inner Join 0 to 2
-                    condition expressions:
-                      0 {_col0}
-                      1 {_col1}
-                      2 
-                    handleSkewJoin: false
-                    keys:
-                      0 [Column[_col0]]
-                      1 [Column[_col0]]
-                      2 [Column[_col0]]
+                Map Join Operator
+                  condition map:
+                       Inner Join 0 to 1
+                       Inner Join 0 to 2
+                  condition expressions:
+                    0 {_col0}
+                    1 {_col1}
+                    2 
+                  handleSkewJoin: false
+                  keys:
+                    0 [Column[_col0]]
+                    1 [Column[_col0]]
+                    2 [Column[_col0]]
+                  outputColumnNames: _col0, _col3
+                  Position of Big Table: 2
+                  Select Operator
+                    expressions:
+                          expr: _col0
+                          type: string
+                          expr: _col3
+                          type: string
                     outputColumnNames: _col0, _col3
-                    Position of Big Table: 2
-                    Select Operator
-                      expressions:
-                            expr: _col0
-                            type: string
-                            expr: _col3
-                            type: string
-                      outputColumnNames: _col0, _col3
-                      Group By Operator
-                        aggregations:
-                              expr: sum(hash(_col0,_col3))
-                        bucketGroup: false
-                        mode: hash
-                        outputColumnNames: _col0
-                        File Output Operator
-                          compressed: false
-                          GlobalTableId: 0
-                          table:
-                              input format: org.apache.hadoop.mapred.SequenceFileInputFormat
-                              output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+                    Group By Operator
+                      aggregations:
+                            expr: sum(hash(_col0,_col3))
+                      bucketGroup: false
+                      mode: hash
+                      outputColumnNames: _col0
+                      File Output Operator
+                        compressed: false
+                        GlobalTableId: 0
+                        table:
+                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
       Local Work:
         Map Reduce Local Work
 
@@ -428,22 +404,18 @@ STAGE PLANS:
                       expr: key
                       type: string
                 outputColumnNames: _col0
-                Filter Operator
-                  predicate:
-                      expr: (_col0 < 100)
-                      type: boolean
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: 0
-                    value expressions:
-                          expr: _col0
-                          type: string
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: 0
+                  value expressions:
+                        expr: _col0
+                        type: string
         src2:src 
           TableScan
             alias: src
@@ -478,19 +450,15 @@ STAGE PLANS:
                       expr: key
                       type: string
                 outputColumnNames: _col0
-                Filter Operator
-                  predicate:
-                      expr: (_col0 < 80)
-                      type: boolean
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: 2
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: 2
       Reduce Operator Tree:
         Join Operator
           condition map:
diff --git a/ql/src/test/results/clientpositive/auto_join13.q.out b/ql/src/test/results/clientpositive/auto_join13.q.out
index ed0290969f..f53ffb15b6 100644
--- a/ql/src/test/results/clientpositive/auto_join13.q.out
+++ b/ql/src/test/results/clientpositive/auto_join13.q.out
@@ -85,28 +85,24 @@ STAGE PLANS:
                       expr: key
                       type: string
                 outputColumnNames: _col0
-                Filter Operator
-                  predicate:
-                      expr: (_col0 < 100)
-                      type: boolean
-                  Map Join Operator
-                    condition map:
-                         Inner Join 0 to 1
-                    condition expressions:
-                      0 {_col0}
-                      1 {_col0} {_col1}
-                    handleSkewJoin: false
-                    keys:
-                      0 [Column[_col0]]
-                      1 [Column[_col0]]
-                    outputColumnNames: _col0, _col2, _col3
-                    Position of Big Table: 0
-                    File Output Operator
-                      compressed: false
-                      GlobalTableId: 0
-                      table:
-                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
-                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+                Map Join Operator
+                  condition map:
+                       Inner Join 0 to 1
+                  condition expressions:
+                    0 {_col0}
+                    1 {_col0} {_col1}
+                  handleSkewJoin: false
+                  keys:
+                    0 [Column[_col0]]
+                    1 [Column[_col0]]
+                  outputColumnNames: _col0, _col2, _col3
+                  Position of Big Table: 0
+                  File Output Operator
+                    compressed: false
+                    GlobalTableId: 0
+                    table:
+                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
       Local Work:
         Map Reduce Local Work
 
@@ -132,19 +128,15 @@ STAGE PLANS:
                       expr: key
                       type: string
                 outputColumnNames: _col0
-                Filter Operator
-                  predicate:
-                      expr: (_col0 < 200)
-                      type: boolean
-                  HashTable Sink Operator
-                    condition expressions:
-                      0 {_col3} {_col0}
-                      1 
-                    handleSkewJoin: false
-                    keys:
-                      0 [class org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge(Column[_col0], Column[_col2]()]
-                      1 [class org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge(Column[_col0]()]
-                    Position of Big Table: 0
+                HashTable Sink Operator
+                  condition expressions:
+                    0 {_col3} {_col0}
+                    1 
+                  handleSkewJoin: false
+                  keys:
+                    0 [class org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge(Column[_col0], Column[_col2]()]
+                    1 [class org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge(Column[_col0]()]
+                  Position of Big Table: 0
 
   Stage: Stage-6
     Map Reduce
@@ -246,41 +238,37 @@ STAGE PLANS:
                       expr: key
                       type: string
                 outputColumnNames: _col0
-                Filter Operator
-                  predicate:
-                      expr: (_col0 < 200)
-                      type: boolean
-                  Map Join Operator
-                    condition map:
-                         Inner Join 0 to 1
-                    condition expressions:
-                      0 {_col3} {_col0}
-                      1 
-                    handleSkewJoin: false
-                    keys:
-                      0 [class org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge(Column[_col0], Column[_col2]()]
-                      1 [class org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge(Column[_col0]()]
-                    outputColumnNames: _col1, _col2
-                    Position of Big Table: 1
-                    Select Operator
-                      expressions:
-                            expr: _col2
-                            type: string
-                            expr: _col1
-                            type: string
-                      outputColumnNames: _col2, _col1
-                      Group By Operator
-                        aggregations:
-                              expr: sum(hash(_col2,_col1))
-                        bucketGroup: false
-                        mode: hash
-                        outputColumnNames: _col0
-                        File Output Operator
-                          compressed: false
-                          GlobalTableId: 0
-                          table:
-                              input format: org.apache.hadoop.mapred.SequenceFileInputFormat
-                              output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+                Map Join Operator
+                  condition map:
+                       Inner Join 0 to 1
+                  condition expressions:
+                    0 {_col3} {_col0}
+                    1 
+                  handleSkewJoin: false
+                  keys:
+                    0 [class org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge(Column[_col0], Column[_col2]()]
+                    1 [class org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge(Column[_col0]()]
+                  outputColumnNames: _col1, _col2
+                  Position of Big Table: 1
+                  Select Operator
+                    expressions:
+                          expr: _col2
+                          type: string
+                          expr: _col1
+                          type: string
+                    outputColumnNames: _col2, _col1
+                    Group By Operator
+                      aggregations:
+                            expr: sum(hash(_col2,_col1))
+                      bucketGroup: false
+                      mode: hash
+                      outputColumnNames: _col0
+                      File Output Operator
+                        compressed: false
+                        GlobalTableId: 0
+                        table:
+                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
       Local Work:
         Map Reduce Local Work
 
@@ -314,19 +302,15 @@ STAGE PLANS:
                       expr: key
                       type: string
                 outputColumnNames: _col0
-                Filter Operator
-                  predicate:
-                      expr: (_col0 < 200)
-                      type: boolean
-                  Reduce Output Operator
-                    key expressions:
-                          expr: UDFToDouble(_col0)
-                          type: double
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: UDFToDouble(_col0)
-                          type: double
-                    tag: 1
+                Reduce Output Operator
+                  key expressions:
+                        expr: UDFToDouble(_col0)
+                        type: double
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: UDFToDouble(_col0)
+                        type: double
+                  tag: 1
       Reduce Operator Tree:
         Join Operator
           condition map:
@@ -375,19 +359,15 @@ STAGE PLANS:
                       expr: key
                       type: string
                 outputColumnNames: _col0
-                Filter Operator
-                  predicate:
-                      expr: (_col0 < 100)
-                      type: boolean
-                  HashTable Sink Operator
-                    condition expressions:
-                      0 {_col0}
-                      1 {_col0} {_col1}
-                    handleSkewJoin: false
-                    keys:
-                      0 [Column[_col0]]
-                      1 [Column[_col0]]
-                    Position of Big Table: 1
+                HashTable Sink Operator
+                  condition expressions:
+                    0 {_col0}
+                    1 {_col0} {_col1}
+                  handleSkewJoin: false
+                  keys:
+                    0 [Column[_col0]]
+                    1 [Column[_col0]]
+                  Position of Big Table: 1
 
   Stage: Stage-10
     Map Reduce
@@ -438,22 +418,18 @@ STAGE PLANS:
                       expr: key
                       type: string
                 outputColumnNames: _col0
-                Filter Operator
-                  predicate:
-                      expr: (_col0 < 100)
-                      type: boolean
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: 0
-                    value expressions:
-                          expr: _col0
-                          type: string
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: 0
+                  value expressions:
+                        expr: _col0
+                        type: string
         src2:src 
           TableScan
             alias: src
diff --git a/ql/src/test/results/clientpositive/auto_join14.q.out b/ql/src/test/results/clientpositive/auto_join14.q.out
index 4fbf24f2cd..e677c8b640 100644
--- a/ql/src/test/results/clientpositive/auto_join14.q.out
+++ b/ql/src/test/results/clientpositive/auto_join14.q.out
@@ -38,19 +38,15 @@ STAGE PLANS:
         srcpart 
           TableScan
             alias: srcpart
-            Filter Operator
-              predicate:
-                  expr: (ds = '2008-04-08')
-                  type: boolean
-              HashTable Sink Operator
-                condition expressions:
-                  0 {key}
-                  1 {value}
-                handleSkewJoin: false
-                keys:
-                  0 [Column[key]]
-                  1 [Column[key]]
-                Position of Big Table: 0
+            HashTable Sink Operator
+              condition expressions:
+                0 {key}
+                1 {value}
+              handleSkewJoin: false
+              keys:
+                0 [Column[key]]
+                1 [Column[key]]
+              Position of Big Table: 0
 
   Stage: Stage-4
     Map Reduce
@@ -62,44 +58,40 @@ STAGE PLANS:
               predicate:
                   expr: (key > 100)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key > 100)
-                    type: boolean
-                Map Join Operator
-                  condition map:
-                       Inner Join 0 to 1
-                  condition expressions:
-                    0 {key}
-                    1 {value}
-                  handleSkewJoin: false
-                  keys:
-                    0 [Column[key]]
-                    1 [Column[key]]
-                  outputColumnNames: _col0, _col5
-                  Position of Big Table: 0
+              Map Join Operator
+                condition map:
+                     Inner Join 0 to 1
+                condition expressions:
+                  0 {key}
+                  1 {value}
+                handleSkewJoin: false
+                keys:
+                  0 [Column[key]]
+                  1 [Column[key]]
+                outputColumnNames: _col0, _col5
+                Position of Big Table: 0
+                Select Operator
+                  expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col5
+                        type: string
+                  outputColumnNames: _col0, _col1
                   Select Operator
                     expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col5
+                          expr: UDFToInteger(_col0)
+                          type: int
+                          expr: _col1
                           type: string
                     outputColumnNames: _col0, _col1
-                    Select Operator
-                      expressions:
-                            expr: UDFToInteger(_col0)
-                            type: int
-                            expr: _col1
-                            type: string
-                      outputColumnNames: _col0, _col1
-                      File Output Operator
-                        compressed: false
-                        GlobalTableId: 1
-                        table:
-                            input format: org.apache.hadoop.mapred.TextInputFormat
-                            output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                            serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                            name: default.dest1
+                    File Output Operator
+                      compressed: false
+                      GlobalTableId: 1
+                      table:
+                          input format: org.apache.hadoop.mapred.TextInputFormat
+                          output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                          name: default.dest1
       Local Work:
         Map Reduce Local Work
 
@@ -130,33 +122,7 @@ STAGE PLANS:
               predicate:
                   expr: (key > 100)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key > 100)
-                    type: boolean
-                HashTable Sink Operator
-                  condition expressions:
-                    0 {key}
-                    1 {value}
-                  handleSkewJoin: false
-                  keys:
-                    0 [Column[key]]
-                    1 [Column[key]]
-                  Position of Big Table: 1
-
-  Stage: Stage-5
-    Map Reduce
-      Alias -> Map Operator Tree:
-        srcpart 
-          TableScan
-            alias: srcpart
-            Filter Operator
-              predicate:
-                  expr: (ds = '2008-04-08')
-                  type: boolean
-              Map Join Operator
-                condition map:
-                     Inner Join 0 to 1
+              HashTable Sink Operator
                 condition expressions:
                   0 {key}
                   1 {value}
@@ -164,30 +130,48 @@ STAGE PLANS:
                 keys:
                   0 [Column[key]]
                   1 [Column[key]]
-                outputColumnNames: _col0, _col5
                 Position of Big Table: 1
+
+  Stage: Stage-5
+    Map Reduce
+      Alias -> Map Operator Tree:
+        srcpart 
+          TableScan
+            alias: srcpart
+            Map Join Operator
+              condition map:
+                   Inner Join 0 to 1
+              condition expressions:
+                0 {key}
+                1 {value}
+              handleSkewJoin: false
+              keys:
+                0 [Column[key]]
+                1 [Column[key]]
+              outputColumnNames: _col0, _col5
+              Position of Big Table: 1
+              Select Operator
+                expressions:
+                      expr: _col0
+                      type: string
+                      expr: _col5
+                      type: string
+                outputColumnNames: _col0, _col1
                 Select Operator
                   expressions:
-                        expr: _col0
-                        type: string
-                        expr: _col5
+                        expr: UDFToInteger(_col0)
+                        type: int
+                        expr: _col1
                         type: string
                   outputColumnNames: _col0, _col1
-                  Select Operator
-                    expressions:
-                          expr: UDFToInteger(_col0)
-                          type: int
-                          expr: _col1
-                          type: string
-                    outputColumnNames: _col0, _col1
-                    File Output Operator
-                      compressed: false
-                      GlobalTableId: 1
-                      table:
-                          input format: org.apache.hadoop.mapred.TextInputFormat
-                          output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                          name: default.dest1
+                  File Output Operator
+                    compressed: false
+                    GlobalTableId: 1
+                    table:
+                        input format: org.apache.hadoop.mapred.TextInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                        name: default.dest1
       Local Work:
         Map Reduce Local Work
 
@@ -201,29 +185,6 @@ STAGE PLANS:
               predicate:
                   expr: (key > 100)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key > 100)
-                    type: boolean
-                Reduce Output Operator
-                  key expressions:
-                        expr: key
-                        type: string
-                  sort order: +
-                  Map-reduce partition columns:
-                        expr: key
-                        type: string
-                  tag: 0
-                  value expressions:
-                        expr: key
-                        type: string
-        srcpart 
-          TableScan
-            alias: srcpart
-            Filter Operator
-              predicate:
-                  expr: (ds = '2008-04-08')
-                  type: boolean
               Reduce Output Operator
                 key expressions:
                       expr: key
@@ -232,10 +193,25 @@ STAGE PLANS:
                 Map-reduce partition columns:
                       expr: key
                       type: string
-                tag: 1
+                tag: 0
                 value expressions:
-                      expr: value
+                      expr: key
                       type: string
+        srcpart 
+          TableScan
+            alias: srcpart
+            Reduce Output Operator
+              key expressions:
+                    expr: key
+                    type: string
+              sort order: +
+              Map-reduce partition columns:
+                    expr: key
+                    type: string
+              tag: 1
+              value expressions:
+                    expr: value
+                    type: string
       Reduce Operator Tree:
         Join Operator
           condition map:
diff --git a/ql/src/test/results/clientpositive/auto_join16.q.out b/ql/src/test/results/clientpositive/auto_join16.q.out
index 8da6ce20c1..f0f76817a1 100644
--- a/ql/src/test/results/clientpositive/auto_join16.q.out
+++ b/ql/src/test/results/clientpositive/auto_join16.q.out
@@ -65,56 +65,44 @@ STAGE PLANS:
               predicate:
                   expr: ((key > 10) and (key > 20))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key > 10)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
-                  outputColumnNames: _col0, _col1
-                  Filter Operator
-                    predicate:
-                        expr: (_col0 > 20)
-                        type: boolean
-                    Map Join Operator
-                      condition map:
-                           Inner Join 0 to 1
-                      condition expressions:
-                        0 {_col0}
-                        1 {value}
-                      handleSkewJoin: false
-                      keys:
-                        0 [Column[_col0], Column[_col1]]
-                        1 [Column[key], Column[value]]
-                      outputColumnNames: _col0, _col3
-                      Position of Big Table: 0
-                      Filter Operator
-                        predicate:
-                            expr: (_col3 < 200)
-                            type: boolean
-                        Select Operator
-                          expressions:
-                                expr: _col0
-                                type: string
-                                expr: _col3
-                                type: string
-                          outputColumnNames: _col0, _col3
-                          Group By Operator
-                            aggregations:
-                                  expr: sum(hash(_col0,_col3))
-                            bucketGroup: false
-                            mode: hash
-                            outputColumnNames: _col0
-                            File Output Operator
-                              compressed: false
-                              GlobalTableId: 0
-                              table:
-                                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
-                                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Map Join Operator
+                  condition map:
+                       Inner Join 0 to 1
+                  condition expressions:
+                    0 {_col0}
+                    1 {value}
+                  handleSkewJoin: false
+                  keys:
+                    0 [Column[_col0], Column[_col1]]
+                    1 [Column[key], Column[value]]
+                  outputColumnNames: _col0, _col3
+                  Position of Big Table: 0
+                  Select Operator
+                    expressions:
+                          expr: _col0
+                          type: string
+                          expr: _col3
+                          type: string
+                    outputColumnNames: _col0, _col3
+                    Group By Operator
+                      aggregations:
+                            expr: sum(hash(_col0,_col3))
+                      bucketGroup: false
+                      mode: hash
+                      outputColumnNames: _col0
+                      File Output Operator
+                        compressed: false
+                        GlobalTableId: 0
+                        table:
+                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
       Local Work:
         Map Reduce Local Work
 
@@ -161,30 +149,22 @@ STAGE PLANS:
               predicate:
                   expr: ((key > 10) and (key > 20))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key > 10)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
-                  outputColumnNames: _col0, _col1
-                  Filter Operator
-                    predicate:
-                        expr: (_col0 > 20)
-                        type: boolean
-                    HashTable Sink Operator
-                      condition expressions:
-                        0 {_col0}
-                        1 {value}
-                      handleSkewJoin: false
-                      keys:
-                        0 [Column[_col0], Column[_col1]]
-                        1 [Column[key], Column[value]]
-                      Position of Big Table: 1
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                HashTable Sink Operator
+                  condition expressions:
+                    0 {_col0}
+                    1 {value}
+                  handleSkewJoin: false
+                  keys:
+                    0 [Column[_col0], Column[_col1]]
+                    1 [Column[key], Column[value]]
+                  Position of Big Table: 1
 
   Stage: Stage-5
     Map Reduce
@@ -208,29 +188,25 @@ STAGE PLANS:
                   1 [Column[key], Column[value]]
                 outputColumnNames: _col0, _col3
                 Position of Big Table: 1
-                Filter Operator
-                  predicate:
-                      expr: (_col3 < 200)
-                      type: boolean
-                  Select Operator
-                    expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col3
-                          type: string
-                    outputColumnNames: _col0, _col3
-                    Group By Operator
-                      aggregations:
-                            expr: sum(hash(_col0,_col3))
-                      bucketGroup: false
-                      mode: hash
-                      outputColumnNames: _col0
-                      File Output Operator
-                        compressed: false
-                        GlobalTableId: 0
-                        table:
-                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
-                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+                Select Operator
+                  expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col3
+                        type: string
+                  outputColumnNames: _col0, _col3
+                  Group By Operator
+                    aggregations:
+                          expr: sum(hash(_col0,_col3))
+                    bucketGroup: false
+                    mode: hash
+                    outputColumnNames: _col0
+                    File Output Operator
+                      compressed: false
+                      GlobalTableId: 0
+                      table:
+                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
       Local Work:
         Map Reduce Local Work
 
@@ -244,37 +220,29 @@ STAGE PLANS:
               predicate:
                   expr: ((key > 10) and (key > 20))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key > 10)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col1
+                        type: string
+                  sort order: ++
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                        expr: _col1
                         type: string
-                        expr: value
+                  tag: 0
+                  value expressions:
+                        expr: _col0
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Filter Operator
-                    predicate:
-                        expr: (_col0 > 20)
-                        type: boolean
-                    Reduce Output Operator
-                      key expressions:
-                            expr: _col0
-                            type: string
-                            expr: _col1
-                            type: string
-                      sort order: ++
-                      Map-reduce partition columns:
-                            expr: _col0
-                            type: string
-                            expr: _col1
-                            type: string
-                      tag: 0
-                      value expressions:
-                            expr: _col0
-                            type: string
         tab 
           TableScan
             alias: tab
@@ -307,29 +275,25 @@ STAGE PLANS:
             1 {VALUE._col1}
           handleSkewJoin: false
           outputColumnNames: _col0, _col3
-          Filter Operator
-            predicate:
-                expr: (_col3 < 200)
-                type: boolean
-            Select Operator
-              expressions:
-                    expr: _col0
-                    type: string
-                    expr: _col3
-                    type: string
-              outputColumnNames: _col0, _col3
-              Group By Operator
-                aggregations:
-                      expr: sum(hash(_col0,_col3))
-                bucketGroup: false
-                mode: hash
-                outputColumnNames: _col0
-                File Output Operator
-                  compressed: false
-                  GlobalTableId: 0
-                  table:
-                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
-                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+          Select Operator
+            expressions:
+                  expr: _col0
+                  type: string
+                  expr: _col3
+                  type: string
+            outputColumnNames: _col0, _col3
+            Group By Operator
+              aggregations:
+                    expr: sum(hash(_col0,_col3))
+              bucketGroup: false
+              mode: hash
+              outputColumnNames: _col0
+              File Output Operator
+                compressed: false
+                GlobalTableId: 0
+                table:
+                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
 
   Stage: Stage-0
     Fetch Operator
diff --git a/ql/src/test/results/clientpositive/auto_join19.q.out b/ql/src/test/results/clientpositive/auto_join19.q.out
index 8d3d1865ba..2cc93f9492 100644
--- a/ql/src/test/results/clientpositive/auto_join19.q.out
+++ b/ql/src/test/results/clientpositive/auto_join19.q.out
@@ -68,32 +68,28 @@ STAGE PLANS:
                 1 [Column[key]]
               outputColumnNames: _col0, _col2, _col3, _col7
               Position of Big Table: 0
-              Filter Operator
-                predicate:
-                    expr: (((_col2 = '2008-04-08') or (_col2 = '2008-04-09')) and ((_col3 = '12') or (_col3 = '11')))
-                    type: boolean
+              Select Operator
+                expressions:
+                      expr: _col0
+                      type: string
+                      expr: _col7
+                      type: string
+                outputColumnNames: _col0, _col1
                 Select Operator
                   expressions:
-                        expr: _col0
-                        type: string
-                        expr: _col7
+                        expr: UDFToInteger(_col0)
+                        type: int
+                        expr: _col1
                         type: string
                   outputColumnNames: _col0, _col1
-                  Select Operator
-                    expressions:
-                          expr: UDFToInteger(_col0)
-                          type: int
-                          expr: _col1
-                          type: string
-                    outputColumnNames: _col0, _col1
-                    File Output Operator
-                      compressed: false
-                      GlobalTableId: 1
-                      table:
-                          input format: org.apache.hadoop.mapred.TextInputFormat
-                          output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                          name: default.dest1
+                  File Output Operator
+                    compressed: false
+                    GlobalTableId: 1
+                    table:
+                        input format: org.apache.hadoop.mapred.TextInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                        name: default.dest1
       Local Work:
         Map Reduce Local Work
 
@@ -148,32 +144,28 @@ STAGE PLANS:
                 1 [Column[key]]
               outputColumnNames: _col0, _col2, _col3, _col7
               Position of Big Table: 1
-              Filter Operator
-                predicate:
-                    expr: (((_col2 = '2008-04-08') or (_col2 = '2008-04-09')) and ((_col3 = '12') or (_col3 = '11')))
-                    type: boolean
+              Select Operator
+                expressions:
+                      expr: _col0
+                      type: string
+                      expr: _col7
+                      type: string
+                outputColumnNames: _col0, _col1
                 Select Operator
                   expressions:
-                        expr: _col0
-                        type: string
-                        expr: _col7
+                        expr: UDFToInteger(_col0)
+                        type: int
+                        expr: _col1
                         type: string
                   outputColumnNames: _col0, _col1
-                  Select Operator
-                    expressions:
-                          expr: UDFToInteger(_col0)
-                          type: int
-                          expr: _col1
-                          type: string
-                    outputColumnNames: _col0, _col1
-                    File Output Operator
-                      compressed: false
-                      GlobalTableId: 1
-                      table:
-                          input format: org.apache.hadoop.mapred.TextInputFormat
-                          output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                          name: default.dest1
+                  File Output Operator
+                    compressed: false
+                    GlobalTableId: 1
+                    table:
+                        input format: org.apache.hadoop.mapred.TextInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                        name: default.dest1
       Local Work:
         Map Reduce Local Work
 
@@ -223,32 +215,28 @@ STAGE PLANS:
             1 {VALUE._col1}
           handleSkewJoin: false
           outputColumnNames: _col0, _col2, _col3, _col7
-          Filter Operator
-            predicate:
-                expr: (((_col2 = '2008-04-08') or (_col2 = '2008-04-09')) and ((_col3 = '12') or (_col3 = '11')))
-                type: boolean
+          Select Operator
+            expressions:
+                  expr: _col0
+                  type: string
+                  expr: _col7
+                  type: string
+            outputColumnNames: _col0, _col1
             Select Operator
               expressions:
-                    expr: _col0
-                    type: string
-                    expr: _col7
+                    expr: UDFToInteger(_col0)
+                    type: int
+                    expr: _col1
                     type: string
               outputColumnNames: _col0, _col1
-              Select Operator
-                expressions:
-                      expr: UDFToInteger(_col0)
-                      type: int
-                      expr: _col1
-                      type: string
-                outputColumnNames: _col0, _col1
-                File Output Operator
-                  compressed: false
-                  GlobalTableId: 1
-                  table:
-                      input format: org.apache.hadoop.mapred.TextInputFormat
-                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                      name: default.dest1
+              File Output Operator
+                compressed: false
+                GlobalTableId: 1
+                table:
+                    input format: org.apache.hadoop.mapred.TextInputFormat
+                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                    name: default.dest1
 
 
 PREHOOK: query: FROM srcpart src1 JOIN src src2 ON (src1.key = src2.key)
diff --git a/ql/src/test/results/clientpositive/auto_join20.q.out b/ql/src/test/results/clientpositive/auto_join20.q.out
index ebc65ac0d0..70215ccd95 100644
--- a/ql/src/test/results/clientpositive/auto_join20.q.out
+++ b/ql/src/test/results/clientpositive/auto_join20.q.out
@@ -47,25 +47,21 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                HashTable Sink Operator
-                  condition expressions:
-                    0 {key} {value}
-                    1 {key} {value}
-                    2 {key} {value}
-                  filter predicates:
-                    0 
-                    1 
-                    2 {(key < 20)}
-                  handleSkewJoin: false
-                  keys:
-                    0 [Column[key]]
-                    1 [Column[key]]
-                    2 [Column[key]]
-                  Position of Big Table: 2
+              HashTable Sink Operator
+                condition expressions:
+                  0 {key} {value}
+                  1 {key} {value}
+                  2 {key} {value}
+                filter predicates:
+                  0 
+                  1 
+                  2 {(key < 20)}
+                handleSkewJoin: false
+                keys:
+                  0 [Column[key]]
+                  1 [Column[key]]
+                  2 [Column[key]]
+                Position of Big Table: 2
         a:src2 
           TableScan
             alias: src2
@@ -236,24 +232,20 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                Reduce Output Operator
-                  key expressions:
-                        expr: key
-                        type: string
-                  sort order: +
-                  Map-reduce partition columns:
-                        expr: key
-                        type: string
-                  tag: 0
-                  value expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
+              Reduce Output Operator
+                key expressions:
+                      expr: key
+                      type: string
+                sort order: +
+                Map-reduce partition columns:
+                      expr: key
+                      type: string
+                tag: 0
+                value expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
         a:src2 
           TableScan
             alias: src2
@@ -398,25 +390,21 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                HashTable Sink Operator
-                  condition expressions:
-                    0 {key} {value}
-                    1 {key} {value}
-                    2 {key} {value}
-                  filter predicates:
-                    0 
-                    1 
-                    2 {(key < 20)}
-                  handleSkewJoin: false
-                  keys:
-                    0 [Column[key]]
-                    1 [Column[key]]
-                    2 [Column[key]]
-                  Position of Big Table: 2
+              HashTable Sink Operator
+                condition expressions:
+                  0 {key} {value}
+                  1 {key} {value}
+                  2 {key} {value}
+                filter predicates:
+                  0 
+                  1 
+                  2 {(key < 20)}
+                handleSkewJoin: false
+                keys:
+                  0 [Column[key]]
+                  1 [Column[key]]
+                  2 [Column[key]]
+                Position of Big Table: 2
         a:src2 
           TableScan
             alias: src2
@@ -424,25 +412,21 @@ STAGE PLANS:
               predicate:
                   expr: (key < 15)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 15)
-                    type: boolean
-                HashTable Sink Operator
-                  condition expressions:
-                    0 {key} {value}
-                    1 {key} {value}
-                    2 {key} {value}
-                  filter predicates:
-                    0 
-                    1 
-                    2 {(key < 20)}
-                  handleSkewJoin: false
-                  keys:
-                    0 [Column[key]]
-                    1 [Column[key]]
-                    2 [Column[key]]
-                  Position of Big Table: 2
+              HashTable Sink Operator
+                condition expressions:
+                  0 {key} {value}
+                  1 {key} {value}
+                  2 {key} {value}
+                filter predicates:
+                  0 
+                  1 
+                  2 {(key < 20)}
+                handleSkewJoin: false
+                keys:
+                  0 [Column[key]]
+                  1 [Column[key]]
+                  2 [Column[key]]
+                Position of Big Table: 2
 
   Stage: Stage-6
     Map Reduce
@@ -595,24 +579,20 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                Reduce Output Operator
-                  key expressions:
-                        expr: key
-                        type: string
-                  sort order: +
-                  Map-reduce partition columns:
-                        expr: key
-                        type: string
-                  tag: 0
-                  value expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
+              Reduce Output Operator
+                key expressions:
+                      expr: key
+                      type: string
+                sort order: +
+                Map-reduce partition columns:
+                      expr: key
+                      type: string
+                tag: 0
+                value expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
         a:src2 
           TableScan
             alias: src2
@@ -620,24 +600,20 @@ STAGE PLANS:
               predicate:
                   expr: (key < 15)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 15)
-                    type: boolean
-                Reduce Output Operator
-                  key expressions:
-                        expr: key
-                        type: string
-                  sort order: +
-                  Map-reduce partition columns:
-                        expr: key
-                        type: string
-                  tag: 1
-                  value expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
+              Reduce Output Operator
+                key expressions:
+                      expr: key
+                      type: string
+                sort order: +
+                Map-reduce partition columns:
+                      expr: key
+                      type: string
+                tag: 1
+                value expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
         a:src3 
           TableScan
             alias: src3
diff --git a/ql/src/test/results/clientpositive/auto_join21.q.out b/ql/src/test/results/clientpositive/auto_join21.q.out
index d98e314d7b..e8771e2be8 100644
--- a/ql/src/test/results/clientpositive/auto_join21.q.out
+++ b/ql/src/test/results/clientpositive/auto_join21.q.out
@@ -54,25 +54,21 @@ STAGE PLANS:
               predicate:
                   expr: (key > 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key > 10)
-                    type: boolean
-                HashTable Sink Operator
-                  condition expressions:
-                    0 {key} {value}
-                    1 {key} {value}
-                    2 {key} {value}
-                  filter predicates:
-                    0 {(key < 10)}
-                    1 
-                    2 {(key < 10)}
-                  handleSkewJoin: false
-                  keys:
-                    0 [Column[key]]
-                    1 [Column[key]]
-                    2 [Column[key]]
-                  Position of Big Table: 2
+              HashTable Sink Operator
+                condition expressions:
+                  0 {key} {value}
+                  1 {key} {value}
+                  2 {key} {value}
+                filter predicates:
+                  0 {(key < 10)}
+                  1 
+                  2 {(key < 10)}
+                handleSkewJoin: false
+                keys:
+                  0 [Column[key]]
+                  1 [Column[key]]
+                  2 [Column[key]]
+                Position of Big Table: 2
 
   Stage: Stage-5
     Map Reduce
@@ -192,24 +188,20 @@ STAGE PLANS:
               predicate:
                   expr: (key > 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key > 10)
-                    type: boolean
-                Reduce Output Operator
-                  key expressions:
-                        expr: key
-                        type: string
-                  sort order: +
-                  Map-reduce partition columns:
-                        expr: key
-                        type: string
-                  tag: 1
-                  value expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
+              Reduce Output Operator
+                key expressions:
+                      expr: key
+                      type: string
+                sort order: +
+                Map-reduce partition columns:
+                      expr: key
+                      type: string
+                tag: 1
+                value expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
         src3 
           TableScan
             alias: src3
diff --git a/ql/src/test/results/clientpositive/auto_join23.q.out b/ql/src/test/results/clientpositive/auto_join23.q.out
index 09ab24b255..8d4c34a4d6 100644
--- a/ql/src/test/results/clientpositive/auto_join23.q.out
+++ b/ql/src/test/results/clientpositive/auto_join23.q.out
@@ -67,27 +67,23 @@ STAGE PLANS:
                   1 []
                 outputColumnNames: _col0, _col1, _col4, _col5
                 Position of Big Table: 0
-                Filter Operator
-                  predicate:
-                      expr: ((_col0 < 10) and (_col4 < 10))
-                      type: boolean
-                  Select Operator
-                    expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
-                          expr: _col4
-                          type: string
-                          expr: _col5
-                          type: string
-                    outputColumnNames: _col0, _col1, _col2, _col3
-                    File Output Operator
-                      compressed: false
-                      GlobalTableId: 0
-                      table:
-                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
-                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+                Select Operator
+                  expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col1
+                        type: string
+                        expr: _col4
+                        type: string
+                        expr: _col5
+                        type: string
+                  outputColumnNames: _col0, _col1, _col2, _col3
+                  File Output Operator
+                    compressed: false
+                    GlobalTableId: 0
+                    table:
+                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
       Local Work:
         Map Reduce Local Work
 
@@ -171,27 +167,23 @@ STAGE PLANS:
                   1 []
                 outputColumnNames: _col0, _col1, _col4, _col5
                 Position of Big Table: 1
-                Filter Operator
-                  predicate:
-                      expr: ((_col0 < 10) and (_col4 < 10))
-                      type: boolean
-                  Select Operator
-                    expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
-                          expr: _col4
-                          type: string
-                          expr: _col5
-                          type: string
-                    outputColumnNames: _col0, _col1, _col2, _col3
-                    File Output Operator
-                      compressed: false
-                      GlobalTableId: 0
-                      table:
-                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
-                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+                Select Operator
+                  expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col1
+                        type: string
+                        expr: _col4
+                        type: string
+                        expr: _col5
+                        type: string
+                  outputColumnNames: _col0, _col1, _col2, _col3
+                  File Output Operator
+                    compressed: false
+                    GlobalTableId: 0
+                    table:
+                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
       Local Work:
         Map Reduce Local Work
 
@@ -237,27 +229,23 @@ STAGE PLANS:
             1 {VALUE._col0} {VALUE._col1}
           handleSkewJoin: false
           outputColumnNames: _col0, _col1, _col4, _col5
-          Filter Operator
-            predicate:
-                expr: ((_col0 < 10) and (_col4 < 10))
-                type: boolean
-            Select Operator
-              expressions:
-                    expr: _col0
-                    type: string
-                    expr: _col1
-                    type: string
-                    expr: _col4
-                    type: string
-                    expr: _col5
-                    type: string
-              outputColumnNames: _col0, _col1, _col2, _col3
-              File Output Operator
-                compressed: false
-                GlobalTableId: 0
-                table:
-                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
-                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+          Select Operator
+            expressions:
+                  expr: _col0
+                  type: string
+                  expr: _col1
+                  type: string
+                  expr: _col4
+                  type: string
+                  expr: _col5
+                  type: string
+            outputColumnNames: _col0, _col1, _col2, _col3
+            File Output Operator
+              compressed: false
+              GlobalTableId: 0
+              table:
+                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
 
   Stage: Stage-0
     Fetch Operator
diff --git a/ql/src/test/results/clientpositive/auto_join27.q.out b/ql/src/test/results/clientpositive/auto_join27.q.out
index efd0c2e07d..5a8c37649c 100644
--- a/ql/src/test/results/clientpositive/auto_join27.q.out
+++ b/ql/src/test/results/clientpositive/auto_join27.q.out
@@ -119,19 +119,15 @@ STAGE PLANS:
                       expr: key
                       type: string
                 outputColumnNames: _col0
-                Filter Operator
-                  predicate:
-                      expr: (_col0 < 200)
-                      type: boolean
-                  HashTable Sink Operator
-                    condition expressions:
-                      0 
-                      1 
-                    handleSkewJoin: false
-                    keys:
-                      0 [Column[_col0]]
-                      1 [Column[_col0]]
-                    Position of Big Table: 0
+                HashTable Sink Operator
+                  condition expressions:
+                    0 
+                    1 
+                  handleSkewJoin: false
+                  keys:
+                    0 [Column[_col0]]
+                    1 [Column[_col0]]
+                  Position of Big Table: 0
 
   Stage: Stage-6
     Map Reduce
@@ -268,34 +264,30 @@ STAGE PLANS:
                       expr: key
                       type: string
                 outputColumnNames: _col0
-                Filter Operator
-                  predicate:
-                      expr: (_col0 < 200)
-                      type: boolean
-                  Map Join Operator
-                    condition map:
-                         Inner Join 0 to 1
-                    condition expressions:
-                      0 
-                      1 
-                    handleSkewJoin: false
-                    keys:
-                      0 [Column[_col0]]
-                      1 [Column[_col0]]
-                    Position of Big Table: 1
-                    Select Operator
-                      Group By Operator
-                        aggregations:
-                              expr: count(1)
-                        bucketGroup: false
-                        mode: hash
-                        outputColumnNames: _col0
-                        File Output Operator
-                          compressed: false
-                          GlobalTableId: 0
-                          table:
-                              input format: org.apache.hadoop.mapred.SequenceFileInputFormat
-                              output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+                Map Join Operator
+                  condition map:
+                       Inner Join 0 to 1
+                  condition expressions:
+                    0 
+                    1 
+                  handleSkewJoin: false
+                  keys:
+                    0 [Column[_col0]]
+                    1 [Column[_col0]]
+                  Position of Big Table: 1
+                  Select Operator
+                    Group By Operator
+                      aggregations:
+                            expr: count(1)
+                      bucketGroup: false
+                      mode: hash
+                      outputColumnNames: _col0
+                      File Output Operator
+                        compressed: false
+                        GlobalTableId: 0
+                        table:
+                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
       Local Work:
         Map Reduce Local Work
 
@@ -336,19 +328,15 @@ STAGE PLANS:
                       expr: key
                       type: string
                 outputColumnNames: _col0
-                Filter Operator
-                  predicate:
-                      expr: (_col0 < 200)
-                      type: boolean
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: 1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: 1
       Reduce Operator Tree:
         Join Operator
           condition map:
diff --git a/ql/src/test/results/clientpositive/auto_join28.q.out b/ql/src/test/results/clientpositive/auto_join28.q.out
index 80f3fd4258..252d20c8ef 100644
--- a/ql/src/test/results/clientpositive/auto_join28.q.out
+++ b/ql/src/test/results/clientpositive/auto_join28.q.out
@@ -44,24 +44,20 @@ STAGE PLANS:
               predicate:
                   expr: (key > 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key > 10)
-                    type: boolean
-                Reduce Output Operator
-                  key expressions:
-                        expr: key
-                        type: string
-                  sort order: +
-                  Map-reduce partition columns:
-                        expr: key
-                        type: string
-                  tag: 1
-                  value expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
+              Reduce Output Operator
+                key expressions:
+                      expr: key
+                      type: string
+                sort order: +
+                Map-reduce partition columns:
+                      expr: key
+                      type: string
+                tag: 1
+                value expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
         src3 
           TableScan
             alias: src3
@@ -209,24 +205,20 @@ STAGE PLANS:
               predicate:
                   expr: (key > 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key > 10)
-                    type: boolean
-                Reduce Output Operator
-                  key expressions:
-                        expr: key
-                        type: string
-                  sort order: +
-                  Map-reduce partition columns:
-                        expr: key
-                        type: string
-                  tag: 1
-                  value expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
+              Reduce Output Operator
+                key expressions:
+                      expr: key
+                      type: string
+                sort order: +
+                Map-reduce partition columns:
+                      expr: key
+                      type: string
+                tag: 1
+                value expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
         src3 
           TableScan
             alias: src3
@@ -234,24 +226,20 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                Reduce Output Operator
-                  key expressions:
-                        expr: key
-                        type: string
-                  sort order: +
-                  Map-reduce partition columns:
-                        expr: key
-                        type: string
-                  tag: 2
-                  value expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
+              Reduce Output Operator
+                key expressions:
+                      expr: key
+                      type: string
+                sort order: +
+                Map-reduce partition columns:
+                      expr: key
+                      type: string
+                tag: 2
+                value expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
       Reduce Operator Tree:
         Join Operator
           condition map:
@@ -365,24 +353,20 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                Reduce Output Operator
-                  key expressions:
-                        expr: key
-                        type: string
-                  sort order: +
-                  Map-reduce partition columns:
-                        expr: key
-                        type: string
-                  tag: 0
-                  value expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
+              Reduce Output Operator
+                key expressions:
+                      expr: key
+                      type: string
+                sort order: +
+                Map-reduce partition columns:
+                      expr: key
+                      type: string
+                tag: 0
+                value expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
         src2 
           TableScan
             alias: src2
@@ -407,24 +391,20 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                Reduce Output Operator
-                  key expressions:
-                        expr: key
-                        type: string
-                  sort order: +
-                  Map-reduce partition columns:
-                        expr: key
-                        type: string
-                  tag: 2
-                  value expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
+              Reduce Output Operator
+                key expressions:
+                      expr: key
+                      type: string
+                sort order: +
+                Map-reduce partition columns:
+                      expr: key
+                      type: string
+                tag: 2
+                value expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
       Reduce Operator Tree:
         Join Operator
           condition map:
@@ -538,24 +518,20 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                Reduce Output Operator
-                  key expressions:
-                        expr: key
-                        type: string
-                  sort order: +
-                  Map-reduce partition columns:
-                        expr: key
-                        type: string
-                  tag: 0
-                  value expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
+              Reduce Output Operator
+                key expressions:
+                      expr: key
+                      type: string
+                sort order: +
+                Map-reduce partition columns:
+                      expr: key
+                      type: string
+                tag: 0
+                value expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
         src2 
           TableScan
             alias: src2
diff --git a/ql/src/test/results/clientpositive/auto_join29.q.out b/ql/src/test/results/clientpositive/auto_join29.q.out
index f7768bd8db..b5301911b7 100644
--- a/ql/src/test/results/clientpositive/auto_join29.q.out
+++ b/ql/src/test/results/clientpositive/auto_join29.q.out
@@ -54,25 +54,21 @@ STAGE PLANS:
               predicate:
                   expr: (key > 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key > 10)
-                    type: boolean
-                HashTable Sink Operator
-                  condition expressions:
-                    0 {key} {value}
-                    1 {key} {value}
-                    2 {key} {value}
-                  filter predicates:
-                    0 {(key < 10)}
-                    1 
-                    2 {(key < 10)}
-                  handleSkewJoin: false
-                  keys:
-                    0 [Column[key]]
-                    1 [Column[key]]
-                    2 [Column[key]]
-                  Position of Big Table: 2
+              HashTable Sink Operator
+                condition expressions:
+                  0 {key} {value}
+                  1 {key} {value}
+                  2 {key} {value}
+                filter predicates:
+                  0 {(key < 10)}
+                  1 
+                  2 {(key < 10)}
+                handleSkewJoin: false
+                keys:
+                  0 [Column[key]]
+                  1 [Column[key]]
+                  2 [Column[key]]
+                Position of Big Table: 2
 
   Stage: Stage-5
     Map Reduce
@@ -192,24 +188,20 @@ STAGE PLANS:
               predicate:
                   expr: (key > 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key > 10)
-                    type: boolean
-                Reduce Output Operator
-                  key expressions:
-                        expr: key
-                        type: string
-                  sort order: +
-                  Map-reduce partition columns:
-                        expr: key
-                        type: string
-                  tag: 1
-                  value expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
+              Reduce Output Operator
+                key expressions:
+                      expr: key
+                      type: string
+                sort order: +
+                Map-reduce partition columns:
+                      expr: key
+                      type: string
+                tag: 1
+                value expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
         src3 
           TableScan
             alias: src3
@@ -2921,25 +2913,21 @@ STAGE PLANS:
               predicate:
                   expr: (key > 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key > 10)
-                    type: boolean
-                HashTable Sink Operator
-                  condition expressions:
-                    0 {key} {value}
-                    1 {key} {value}
-                    2 {key} {value}
-                  filter predicates:
-                    0 {(key < 10)}
-                    1 
-                    2 
-                  handleSkewJoin: false
-                  keys:
-                    0 [Column[key]]
-                    1 [Column[key]]
-                    2 [Column[key]]
-                  Position of Big Table: 0
+              HashTable Sink Operator
+                condition expressions:
+                  0 {key} {value}
+                  1 {key} {value}
+                  2 {key} {value}
+                filter predicates:
+                  0 {(key < 10)}
+                  1 
+                  2 
+                handleSkewJoin: false
+                keys:
+                  0 [Column[key]]
+                  1 [Column[key]]
+                  2 [Column[key]]
+                Position of Big Table: 0
         src3 
           TableScan
             alias: src3
@@ -2947,25 +2935,21 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                HashTable Sink Operator
-                  condition expressions:
-                    0 {key} {value}
-                    1 {key} {value}
-                    2 {key} {value}
-                  filter predicates:
-                    0 {(key < 10)}
-                    1 
-                    2 
-                  handleSkewJoin: false
-                  keys:
-                    0 [Column[key]]
-                    1 [Column[key]]
-                    2 [Column[key]]
-                  Position of Big Table: 0
+              HashTable Sink Operator
+                condition expressions:
+                  0 {key} {value}
+                  1 {key} {value}
+                  2 {key} {value}
+                filter predicates:
+                  0 {(key < 10)}
+                  1 
+                  2 
+                handleSkewJoin: false
+                keys:
+                  0 [Column[key]]
+                  1 [Column[key]]
+                  2 [Column[key]]
+                Position of Big Table: 0
 
   Stage: Stage-5
     Map Reduce
@@ -3085,24 +3069,20 @@ STAGE PLANS:
               predicate:
                   expr: (key > 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key > 10)
-                    type: boolean
-                Reduce Output Operator
-                  key expressions:
-                        expr: key
-                        type: string
-                  sort order: +
-                  Map-reduce partition columns:
-                        expr: key
-                        type: string
-                  tag: 1
-                  value expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
+              Reduce Output Operator
+                key expressions:
+                      expr: key
+                      type: string
+                sort order: +
+                Map-reduce partition columns:
+                      expr: key
+                      type: string
+                tag: 1
+                value expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
         src3 
           TableScan
             alias: src3
@@ -3110,24 +3090,20 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                Reduce Output Operator
-                  key expressions:
-                        expr: key
-                        type: string
-                  sort order: +
-                  Map-reduce partition columns:
-                        expr: key
-                        type: string
-                  tag: 2
-                  value expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
+              Reduce Output Operator
+                key expressions:
+                      expr: key
+                      type: string
+                sort order: +
+                Map-reduce partition columns:
+                      expr: key
+                      type: string
+                tag: 2
+                value expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
       Reduce Operator Tree:
         Join Operator
           condition map:
@@ -4244,25 +4220,21 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                HashTable Sink Operator
-                  condition expressions:
-                    0 {key} {value}
-                    1 {key} {value}
-                    2 {key} {value}
-                  filter predicates:
-                    0 
-                    1 {(key > 10)}
-                    2 
-                  handleSkewJoin: false
-                  keys:
-                    0 [Column[key]]
-                    1 [Column[key]]
-                    2 [Column[key]]
-                  Position of Big Table: 1
+              HashTable Sink Operator
+                condition expressions:
+                  0 {key} {value}
+                  1 {key} {value}
+                  2 {key} {value}
+                filter predicates:
+                  0 
+                  1 {(key > 10)}
+                  2 
+                handleSkewJoin: false
+                keys:
+                  0 [Column[key]]
+                  1 [Column[key]]
+                  2 [Column[key]]
+                Position of Big Table: 1
         src3 
           TableScan
             alias: src3
@@ -4270,25 +4242,21 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                HashTable Sink Operator
-                  condition expressions:
-                    0 {key} {value}
-                    1 {key} {value}
-                    2 {key} {value}
-                  filter predicates:
-                    0 
-                    1 {(key > 10)}
-                    2 
-                  handleSkewJoin: false
-                  keys:
-                    0 [Column[key]]
-                    1 [Column[key]]
-                    2 [Column[key]]
-                  Position of Big Table: 1
+              HashTable Sink Operator
+                condition expressions:
+                  0 {key} {value}
+                  1 {key} {value}
+                  2 {key} {value}
+                filter predicates:
+                  0 
+                  1 {(key > 10)}
+                  2 
+                handleSkewJoin: false
+                keys:
+                  0 [Column[key]]
+                  1 [Column[key]]
+                  2 [Column[key]]
+                Position of Big Table: 1
 
   Stage: Stage-5
     Map Reduce
@@ -4391,24 +4359,20 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                Reduce Output Operator
-                  key expressions:
-                        expr: key
-                        type: string
-                  sort order: +
-                  Map-reduce partition columns:
-                        expr: key
-                        type: string
-                  tag: 0
-                  value expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
+              Reduce Output Operator
+                key expressions:
+                      expr: key
+                      type: string
+                sort order: +
+                Map-reduce partition columns:
+                      expr: key
+                      type: string
+                tag: 0
+                value expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
         src2 
           TableScan
             alias: src2
@@ -4433,24 +4397,20 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                Reduce Output Operator
-                  key expressions:
-                        expr: key
-                        type: string
-                  sort order: +
-                  Map-reduce partition columns:
-                        expr: key
-                        type: string
-                  tag: 2
-                  value expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
+              Reduce Output Operator
+                key expressions:
+                      expr: key
+                      type: string
+                sort order: +
+                Map-reduce partition columns:
+                      expr: key
+                      type: string
+                tag: 2
+                value expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
       Reduce Operator Tree:
         Join Operator
           condition map:
@@ -5087,25 +5047,21 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                HashTable Sink Operator
-                  condition expressions:
-                    0 {key} {value}
-                    1 {key} {value}
-                    2 {key} {value}
-                  filter predicates:
-                    0 
-                    1 {(key > 10)}
-                    2 {(key < 10)}
-                  handleSkewJoin: false
-                  keys:
-                    0 [Column[key]]
-                    1 [Column[key]]
-                    2 [Column[key]]
-                  Position of Big Table: 2
+              HashTable Sink Operator
+                condition expressions:
+                  0 {key} {value}
+                  1 {key} {value}
+                  2 {key} {value}
+                filter predicates:
+                  0 
+                  1 {(key > 10)}
+                  2 {(key < 10)}
+                handleSkewJoin: false
+                keys:
+                  0 [Column[key]]
+                  1 [Column[key]]
+                  2 [Column[key]]
+                Position of Big Table: 2
         src2 
           TableScan
             alias: src2
@@ -5226,24 +5182,20 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                Reduce Output Operator
-                  key expressions:
-                        expr: key
-                        type: string
-                  sort order: +
-                  Map-reduce partition columns:
-                        expr: key
-                        type: string
-                  tag: 0
-                  value expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
+              Reduce Output Operator
+                key expressions:
+                      expr: key
+                      type: string
+                sort order: +
+                Map-reduce partition columns:
+                      expr: key
+                      type: string
+                tag: 0
+                value expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
         src2 
           TableScan
             alias: src2
@@ -6432,21 +6384,17 @@ STAGE PLANS:
               predicate:
                   expr: (key > 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key > 10)
-                    type: boolean
-                HashTable Sink Operator
-                  condition expressions:
-                    0 {key} {value}
-                    1 {key} {value}
-                    2 {key} {value}
-                  handleSkewJoin: false
-                  keys:
-                    0 [Column[key]]
-                    1 [Column[key]]
-                    2 [Column[key]]
-                  Position of Big Table: 0
+              HashTable Sink Operator
+                condition expressions:
+                  0 {key} {value}
+                  1 {key} {value}
+                  2 {key} {value}
+                handleSkewJoin: false
+                keys:
+                  0 [Column[key]]
+                  1 [Column[key]]
+                  2 [Column[key]]
+                Position of Big Table: 0
         src3 
           TableScan
             alias: src3
@@ -6454,21 +6402,17 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                HashTable Sink Operator
-                  condition expressions:
-                    0 {key} {value}
-                    1 {key} {value}
-                    2 {key} {value}
-                  handleSkewJoin: false
-                  keys:
-                    0 [Column[key]]
-                    1 [Column[key]]
-                    2 [Column[key]]
-                  Position of Big Table: 0
+              HashTable Sink Operator
+                condition expressions:
+                  0 {key} {value}
+                  1 {key} {value}
+                  2 {key} {value}
+                handleSkewJoin: false
+                keys:
+                  0 [Column[key]]
+                  1 [Column[key]]
+                  2 [Column[key]]
+                Position of Big Table: 0
 
   Stage: Stage-5
     Map Reduce
@@ -6480,46 +6424,42 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                Map Join Operator
-                  condition map:
-                       Inner Join 0 to 1
-                       Left Outer Join1 to 2
-                  condition expressions:
-                    0 {key} {value}
-                    1 {key} {value}
-                    2 {key} {value}
-                  handleSkewJoin: false
-                  keys:
-                    0 [Column[key]]
-                    1 [Column[key]]
-                    2 [Column[key]]
-                  outputColumnNames: _col0, _col1, _col4, _col5, _col8, _col9
-                  Position of Big Table: 0
-                  Select Operator
-                    expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
-                          expr: _col4
-                          type: string
-                          expr: _col5
-                          type: string
-                          expr: _col8
-                          type: string
-                          expr: _col9
-                          type: string
-                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
-                    File Output Operator
-                      compressed: false
-                      GlobalTableId: 0
-                      table:
-                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
-                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+              Map Join Operator
+                condition map:
+                     Inner Join 0 to 1
+                     Left Outer Join1 to 2
+                condition expressions:
+                  0 {key} {value}
+                  1 {key} {value}
+                  2 {key} {value}
+                handleSkewJoin: false
+                keys:
+                  0 [Column[key]]
+                  1 [Column[key]]
+                  2 [Column[key]]
+                outputColumnNames: _col0, _col1, _col4, _col5, _col8, _col9
+                Position of Big Table: 0
+                Select Operator
+                  expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col1
+                        type: string
+                        expr: _col4
+                        type: string
+                        expr: _col5
+                        type: string
+                        expr: _col8
+                        type: string
+                        expr: _col9
+                        type: string
+                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
+                  File Output Operator
+                    compressed: false
+                    GlobalTableId: 0
+                    table:
+                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
       Local Work:
         Map Reduce Local Work
 
@@ -6582,21 +6522,17 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                HashTable Sink Operator
-                  condition expressions:
-                    0 {key} {value}
-                    1 {key} {value}
-                    2 {key} {value}
-                  handleSkewJoin: false
-                  keys:
-                    0 [Column[key]]
-                    1 [Column[key]]
-                    2 [Column[key]]
-                  Position of Big Table: 1
+              HashTable Sink Operator
+                condition expressions:
+                  0 {key} {value}
+                  1 {key} {value}
+                  2 {key} {value}
+                handleSkewJoin: false
+                keys:
+                  0 [Column[key]]
+                  1 [Column[key]]
+                  2 [Column[key]]
+                Position of Big Table: 1
         src3 
           TableScan
             alias: src3
@@ -6604,21 +6540,17 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                HashTable Sink Operator
-                  condition expressions:
-                    0 {key} {value}
-                    1 {key} {value}
-                    2 {key} {value}
-                  handleSkewJoin: false
-                  keys:
-                    0 [Column[key]]
-                    1 [Column[key]]
-                    2 [Column[key]]
-                  Position of Big Table: 1
+              HashTable Sink Operator
+                condition expressions:
+                  0 {key} {value}
+                  1 {key} {value}
+                  2 {key} {value}
+                handleSkewJoin: false
+                keys:
+                  0 [Column[key]]
+                  1 [Column[key]]
+                  2 [Column[key]]
+                Position of Big Table: 1
 
   Stage: Stage-6
     Map Reduce
@@ -6630,46 +6562,42 @@ STAGE PLANS:
               predicate:
                   expr: (key > 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key > 10)
-                    type: boolean
-                Map Join Operator
-                  condition map:
-                       Inner Join 0 to 1
-                       Left Outer Join1 to 2
-                  condition expressions:
-                    0 {key} {value}
-                    1 {key} {value}
-                    2 {key} {value}
-                  handleSkewJoin: false
-                  keys:
-                    0 [Column[key]]
-                    1 [Column[key]]
-                    2 [Column[key]]
-                  outputColumnNames: _col0, _col1, _col4, _col5, _col8, _col9
-                  Position of Big Table: 1
-                  Select Operator
-                    expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
-                          expr: _col4
-                          type: string
-                          expr: _col5
-                          type: string
-                          expr: _col8
-                          type: string
-                          expr: _col9
-                          type: string
-                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
-                    File Output Operator
-                      compressed: false
-                      GlobalTableId: 0
-                      table:
-                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
-                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+              Map Join Operator
+                condition map:
+                     Inner Join 0 to 1
+                     Left Outer Join1 to 2
+                condition expressions:
+                  0 {key} {value}
+                  1 {key} {value}
+                  2 {key} {value}
+                handleSkewJoin: false
+                keys:
+                  0 [Column[key]]
+                  1 [Column[key]]
+                  2 [Column[key]]
+                outputColumnNames: _col0, _col1, _col4, _col5, _col8, _col9
+                Position of Big Table: 1
+                Select Operator
+                  expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col1
+                        type: string
+                        expr: _col4
+                        type: string
+                        expr: _col5
+                        type: string
+                        expr: _col8
+                        type: string
+                        expr: _col9
+                        type: string
+                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
+                  File Output Operator
+                    compressed: false
+                    GlobalTableId: 0
+                    table:
+                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
       Local Work:
         Map Reduce Local Work
 
@@ -6683,24 +6611,20 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                Reduce Output Operator
-                  key expressions:
-                        expr: key
-                        type: string
-                  sort order: +
-                  Map-reduce partition columns:
-                        expr: key
-                        type: string
-                  tag: 0
-                  value expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
+              Reduce Output Operator
+                key expressions:
+                      expr: key
+                      type: string
+                sort order: +
+                Map-reduce partition columns:
+                      expr: key
+                      type: string
+                tag: 0
+                value expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
         src2 
           TableScan
             alias: src2
@@ -6708,24 +6632,20 @@ STAGE PLANS:
               predicate:
                   expr: (key > 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key > 10)
-                    type: boolean
-                Reduce Output Operator
-                  key expressions:
-                        expr: key
-                        type: string
-                  sort order: +
-                  Map-reduce partition columns:
-                        expr: key
-                        type: string
-                  tag: 1
-                  value expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
+              Reduce Output Operator
+                key expressions:
+                      expr: key
+                      type: string
+                sort order: +
+                Map-reduce partition columns:
+                      expr: key
+                      type: string
+                tag: 1
+                value expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
         src3 
           TableScan
             alias: src3
@@ -6733,24 +6653,20 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                Reduce Output Operator
-                  key expressions:
-                        expr: key
-                        type: string
-                  sort order: +
-                  Map-reduce partition columns:
-                        expr: key
-                        type: string
-                  tag: 2
-                  value expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
+              Reduce Output Operator
+                key expressions:
+                      expr: key
+                      type: string
+                sort order: +
+                Map-reduce partition columns:
+                      expr: key
+                      type: string
+                tag: 2
+                value expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
       Reduce Operator Tree:
         Join Operator
           condition map:
@@ -6835,25 +6751,21 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                HashTable Sink Operator
-                  condition expressions:
-                    0 {key} {value}
-                    1 {key} {value}
-                    2 {key} {value}
-                  filter predicates:
-                    0 
-                    1 
-                    2 {(key < 10)}
-                  handleSkewJoin: false
-                  keys:
-                    0 [Column[key]]
-                    1 [Column[key]]
-                    2 [Column[key]]
-                  Position of Big Table: 2
+              HashTable Sink Operator
+                condition expressions:
+                  0 {key} {value}
+                  1 {key} {value}
+                  2 {key} {value}
+                filter predicates:
+                  0 
+                  1 
+                  2 {(key < 10)}
+                handleSkewJoin: false
+                keys:
+                  0 [Column[key]]
+                  1 [Column[key]]
+                  2 [Column[key]]
+                Position of Big Table: 2
         src2 
           TableScan
             alias: src2
@@ -6861,25 +6773,21 @@ STAGE PLANS:
               predicate:
                   expr: (key > 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key > 10)
-                    type: boolean
-                HashTable Sink Operator
-                  condition expressions:
-                    0 {key} {value}
-                    1 {key} {value}
-                    2 {key} {value}
-                  filter predicates:
-                    0 
-                    1 
-                    2 {(key < 10)}
-                  handleSkewJoin: false
-                  keys:
-                    0 [Column[key]]
-                    1 [Column[key]]
-                    2 [Column[key]]
-                  Position of Big Table: 2
+              HashTable Sink Operator
+                condition expressions:
+                  0 {key} {value}
+                  1 {key} {value}
+                  2 {key} {value}
+                filter predicates:
+                  0 
+                  1 
+                  2 {(key < 10)}
+                handleSkewJoin: false
+                keys:
+                  0 [Column[key]]
+                  1 [Column[key]]
+                  2 [Column[key]]
+                Position of Big Table: 2
 
   Stage: Stage-5
     Map Reduce
@@ -6982,24 +6890,20 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                Reduce Output Operator
-                  key expressions:
-                        expr: key
-                        type: string
-                  sort order: +
-                  Map-reduce partition columns:
-                        expr: key
-                        type: string
-                  tag: 0
-                  value expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
+              Reduce Output Operator
+                key expressions:
+                      expr: key
+                      type: string
+                sort order: +
+                Map-reduce partition columns:
+                      expr: key
+                      type: string
+                tag: 0
+                value expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
         src2 
           TableScan
             alias: src2
@@ -7007,24 +6911,20 @@ STAGE PLANS:
               predicate:
                   expr: (key > 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key > 10)
-                    type: boolean
-                Reduce Output Operator
-                  key expressions:
-                        expr: key
-                        type: string
-                  sort order: +
-                  Map-reduce partition columns:
-                        expr: key
-                        type: string
-                  tag: 1
-                  value expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
+              Reduce Output Operator
+                key expressions:
+                      expr: key
+                      type: string
+                sort order: +
+                Map-reduce partition columns:
+                      expr: key
+                      type: string
+                tag: 1
+                value expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
         src3 
           TableScan
             alias: src3
@@ -7630,25 +7530,21 @@ STAGE PLANS:
               predicate:
                   expr: (key > 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key > 10)
-                    type: boolean
-                HashTable Sink Operator
-                  condition expressions:
-                    0 {key} {value}
-                    1 {key} {value}
-                    2 {key} {value}
-                  filter predicates:
-                    0 {(key < 10)}
-                    1 
-                    2 
-                  handleSkewJoin: false
-                  keys:
-                    0 [Column[key]]
-                    1 [Column[key]]
-                    2 [Column[key]]
-                  Position of Big Table: 0
+              HashTable Sink Operator
+                condition expressions:
+                  0 {key} {value}
+                  1 {key} {value}
+                  2 {key} {value}
+                filter predicates:
+                  0 {(key < 10)}
+                  1 
+                  2 
+                handleSkewJoin: false
+                keys:
+                  0 [Column[key]]
+                  1 [Column[key]]
+                  2 [Column[key]]
+                Position of Big Table: 0
         src3 
           TableScan
             alias: src3
@@ -7656,25 +7552,21 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                HashTable Sink Operator
-                  condition expressions:
-                    0 {key} {value}
-                    1 {key} {value}
-                    2 {key} {value}
-                  filter predicates:
-                    0 {(key < 10)}
-                    1 
-                    2 
-                  handleSkewJoin: false
-                  keys:
-                    0 [Column[key]]
-                    1 [Column[key]]
-                    2 [Column[key]]
-                  Position of Big Table: 0
+              HashTable Sink Operator
+                condition expressions:
+                  0 {key} {value}
+                  1 {key} {value}
+                  2 {key} {value}
+                filter predicates:
+                  0 {(key < 10)}
+                  1 
+                  2 
+                handleSkewJoin: false
+                keys:
+                  0 [Column[key]]
+                  1 [Column[key]]
+                  2 [Column[key]]
+                Position of Big Table: 0
 
   Stage: Stage-5
     Map Reduce
@@ -7794,24 +7686,20 @@ STAGE PLANS:
               predicate:
                   expr: (key > 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key > 10)
-                    type: boolean
-                Reduce Output Operator
-                  key expressions:
-                        expr: key
-                        type: string
-                  sort order: +
-                  Map-reduce partition columns:
-                        expr: key
-                        type: string
-                  tag: 1
-                  value expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
+              Reduce Output Operator
+                key expressions:
+                      expr: key
+                      type: string
+                sort order: +
+                Map-reduce partition columns:
+                      expr: key
+                      type: string
+                tag: 1
+                value expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
         src3 
           TableScan
             alias: src3
@@ -7819,24 +7707,20 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                Reduce Output Operator
-                  key expressions:
-                        expr: key
-                        type: string
-                  sort order: +
-                  Map-reduce partition columns:
-                        expr: key
-                        type: string
-                  tag: 2
-                  value expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
+              Reduce Output Operator
+                key expressions:
+                      expr: key
+                      type: string
+                sort order: +
+                Map-reduce partition columns:
+                      expr: key
+                      type: string
+                tag: 2
+                value expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
       Reduce Operator Tree:
         Join Operator
           condition map:
@@ -7927,25 +7811,21 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                HashTable Sink Operator
-                  condition expressions:
-                    0 {key} {value}
-                    1 {key} {value}
-                    2 {key} {value}
-                  filter predicates:
-                    0 
-                    1 {(key > 10)}
-                    2 
-                  handleSkewJoin: false
-                  keys:
-                    0 [Column[key]]
-                    1 [Column[key]]
-                    2 [Column[key]]
-                  Position of Big Table: 1
+              HashTable Sink Operator
+                condition expressions:
+                  0 {key} {value}
+                  1 {key} {value}
+                  2 {key} {value}
+                filter predicates:
+                  0 
+                  1 {(key > 10)}
+                  2 
+                handleSkewJoin: false
+                keys:
+                  0 [Column[key]]
+                  1 [Column[key]]
+                  2 [Column[key]]
+                Position of Big Table: 1
         src3 
           TableScan
             alias: src3
@@ -7953,25 +7833,21 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                HashTable Sink Operator
-                  condition expressions:
-                    0 {key} {value}
-                    1 {key} {value}
-                    2 {key} {value}
-                  filter predicates:
-                    0 
-                    1 {(key > 10)}
-                    2 
-                  handleSkewJoin: false
-                  keys:
-                    0 [Column[key]]
-                    1 [Column[key]]
-                    2 [Column[key]]
-                  Position of Big Table: 1
+              HashTable Sink Operator
+                condition expressions:
+                  0 {key} {value}
+                  1 {key} {value}
+                  2 {key} {value}
+                filter predicates:
+                  0 
+                  1 {(key > 10)}
+                  2 
+                handleSkewJoin: false
+                keys:
+                  0 [Column[key]]
+                  1 [Column[key]]
+                  2 [Column[key]]
+                Position of Big Table: 1
 
   Stage: Stage-5
     Map Reduce
@@ -8081,25 +7957,21 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                HashTable Sink Operator
-                  condition expressions:
-                    0 {key} {value}
-                    1 {key} {value}
-                    2 {key} {value}
-                  filter predicates:
-                    0 
-                    1 {(key > 10)}
-                    2 
-                  handleSkewJoin: false
-                  keys:
-                    0 [Column[key]]
-                    1 [Column[key]]
-                    2 [Column[key]]
-                  Position of Big Table: 2
+              HashTable Sink Operator
+                condition expressions:
+                  0 {key} {value}
+                  1 {key} {value}
+                  2 {key} {value}
+                filter predicates:
+                  0 
+                  1 {(key > 10)}
+                  2 
+                handleSkewJoin: false
+                keys:
+                  0 [Column[key]]
+                  1 [Column[key]]
+                  2 [Column[key]]
+                Position of Big Table: 2
         src2 
           TableScan
             alias: src2
@@ -8129,50 +8001,46 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                Map Join Operator
-                  condition map:
-                       Right Outer Join0 to 1
-                       Inner Join 1 to 2
-                  condition expressions:
-                    0 {key} {value}
-                    1 {key} {value}
-                    2 {key} {value}
-                  filter predicates:
-                    0 
-                    1 {(key > 10)}
-                    2 
-                  handleSkewJoin: false
-                  keys:
-                    0 [Column[key]]
-                    1 [Column[key]]
-                    2 [Column[key]]
-                  outputColumnNames: _col0, _col1, _col4, _col5, _col8, _col9
-                  Position of Big Table: 2
-                  Select Operator
-                    expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
-                          expr: _col4
-                          type: string
-                          expr: _col5
-                          type: string
-                          expr: _col8
-                          type: string
-                          expr: _col9
-                          type: string
-                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
-                    File Output Operator
-                      compressed: false
-                      GlobalTableId: 0
-                      table:
-                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
-                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+              Map Join Operator
+                condition map:
+                     Right Outer Join0 to 1
+                     Inner Join 1 to 2
+                condition expressions:
+                  0 {key} {value}
+                  1 {key} {value}
+                  2 {key} {value}
+                filter predicates:
+                  0 
+                  1 {(key > 10)}
+                  2 
+                handleSkewJoin: false
+                keys:
+                  0 [Column[key]]
+                  1 [Column[key]]
+                  2 [Column[key]]
+                outputColumnNames: _col0, _col1, _col4, _col5, _col8, _col9
+                Position of Big Table: 2
+                Select Operator
+                  expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col1
+                        type: string
+                        expr: _col4
+                        type: string
+                        expr: _col5
+                        type: string
+                        expr: _col8
+                        type: string
+                        expr: _col9
+                        type: string
+                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
+                  File Output Operator
+                    compressed: false
+                    GlobalTableId: 0
+                    table:
+                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
       Local Work:
         Map Reduce Local Work
 
@@ -8186,24 +8054,20 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                Reduce Output Operator
-                  key expressions:
-                        expr: key
-                        type: string
-                  sort order: +
-                  Map-reduce partition columns:
-                        expr: key
-                        type: string
-                  tag: 0
-                  value expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
+              Reduce Output Operator
+                key expressions:
+                      expr: key
+                      type: string
+                sort order: +
+                Map-reduce partition columns:
+                      expr: key
+                      type: string
+                tag: 0
+                value expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
         src2 
           TableScan
             alias: src2
@@ -8228,24 +8092,20 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                Reduce Output Operator
-                  key expressions:
-                        expr: key
-                        type: string
-                  sort order: +
-                  Map-reduce partition columns:
-                        expr: key
-                        type: string
-                  tag: 2
-                  value expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
+              Reduce Output Operator
+                key expressions:
+                      expr: key
+                      type: string
+                sort order: +
+                Map-reduce partition columns:
+                      expr: key
+                      type: string
+                tag: 2
+                value expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
       Reduce Operator Tree:
         Join Operator
           condition map:
@@ -8396,21 +8256,17 @@ STAGE PLANS:
               predicate:
                   expr: (key > 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key > 10)
-                    type: boolean
-                HashTable Sink Operator
-                  condition expressions:
-                    0 {key} {value}
-                    1 {key} {value}
-                    2 {key} {value}
-                  handleSkewJoin: false
-                  keys:
-                    0 [Column[key]]
-                    1 [Column[key]]
-                    2 [Column[key]]
-                  Position of Big Table: 0
+              HashTable Sink Operator
+                condition expressions:
+                  0 {key} {value}
+                  1 {key} {value}
+                  2 {key} {value}
+                handleSkewJoin: false
+                keys:
+                  0 [Column[key]]
+                  1 [Column[key]]
+                  2 [Column[key]]
+                Position of Big Table: 0
         src3 
           TableScan
             alias: src3
@@ -8418,21 +8274,17 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                HashTable Sink Operator
-                  condition expressions:
-                    0 {key} {value}
-                    1 {key} {value}
-                    2 {key} {value}
-                  handleSkewJoin: false
-                  keys:
-                    0 [Column[key]]
-                    1 [Column[key]]
-                    2 [Column[key]]
-                  Position of Big Table: 0
+              HashTable Sink Operator
+                condition expressions:
+                  0 {key} {value}
+                  1 {key} {value}
+                  2 {key} {value}
+                handleSkewJoin: false
+                keys:
+                  0 [Column[key]]
+                  1 [Column[key]]
+                  2 [Column[key]]
+                Position of Big Table: 0
 
   Stage: Stage-5
     Map Reduce
@@ -8444,46 +8296,42 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                Map Join Operator
-                  condition map:
-                       Inner Join 0 to 1
-                       Inner Join 1 to 2
-                  condition expressions:
-                    0 {key} {value}
-                    1 {key} {value}
-                    2 {key} {value}
-                  handleSkewJoin: false
-                  keys:
-                    0 [Column[key]]
-                    1 [Column[key]]
-                    2 [Column[key]]
-                  outputColumnNames: _col0, _col1, _col4, _col5, _col8, _col9
-                  Position of Big Table: 0
-                  Select Operator
-                    expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
-                          expr: _col4
-                          type: string
-                          expr: _col5
-                          type: string
-                          expr: _col8
-                          type: string
-                          expr: _col9
-                          type: string
-                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
-                    File Output Operator
-                      compressed: false
-                      GlobalTableId: 0
-                      table:
-                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
-                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+              Map Join Operator
+                condition map:
+                     Inner Join 0 to 1
+                     Inner Join 1 to 2
+                condition expressions:
+                  0 {key} {value}
+                  1 {key} {value}
+                  2 {key} {value}
+                handleSkewJoin: false
+                keys:
+                  0 [Column[key]]
+                  1 [Column[key]]
+                  2 [Column[key]]
+                outputColumnNames: _col0, _col1, _col4, _col5, _col8, _col9
+                Position of Big Table: 0
+                Select Operator
+                  expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col1
+                        type: string
+                        expr: _col4
+                        type: string
+                        expr: _col5
+                        type: string
+                        expr: _col8
+                        type: string
+                        expr: _col9
+                        type: string
+                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
+                  File Output Operator
+                    compressed: false
+                    GlobalTableId: 0
+                    table:
+                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
       Local Work:
         Map Reduce Local Work
 
@@ -8546,21 +8394,17 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                HashTable Sink Operator
-                  condition expressions:
-                    0 {key} {value}
-                    1 {key} {value}
-                    2 {key} {value}
-                  handleSkewJoin: false
-                  keys:
-                    0 [Column[key]]
-                    1 [Column[key]]
-                    2 [Column[key]]
-                  Position of Big Table: 1
+              HashTable Sink Operator
+                condition expressions:
+                  0 {key} {value}
+                  1 {key} {value}
+                  2 {key} {value}
+                handleSkewJoin: false
+                keys:
+                  0 [Column[key]]
+                  1 [Column[key]]
+                  2 [Column[key]]
+                Position of Big Table: 1
         src3 
           TableScan
             alias: src3
@@ -8568,21 +8412,17 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                HashTable Sink Operator
-                  condition expressions:
-                    0 {key} {value}
-                    1 {key} {value}
-                    2 {key} {value}
-                  handleSkewJoin: false
-                  keys:
-                    0 [Column[key]]
-                    1 [Column[key]]
-                    2 [Column[key]]
-                  Position of Big Table: 1
+              HashTable Sink Operator
+                condition expressions:
+                  0 {key} {value}
+                  1 {key} {value}
+                  2 {key} {value}
+                handleSkewJoin: false
+                keys:
+                  0 [Column[key]]
+                  1 [Column[key]]
+                  2 [Column[key]]
+                Position of Big Table: 1
 
   Stage: Stage-6
     Map Reduce
@@ -8594,46 +8434,42 @@ STAGE PLANS:
               predicate:
                   expr: (key > 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key > 10)
-                    type: boolean
-                Map Join Operator
-                  condition map:
-                       Inner Join 0 to 1
-                       Inner Join 1 to 2
-                  condition expressions:
-                    0 {key} {value}
-                    1 {key} {value}
-                    2 {key} {value}
-                  handleSkewJoin: false
-                  keys:
-                    0 [Column[key]]
-                    1 [Column[key]]
-                    2 [Column[key]]
-                  outputColumnNames: _col0, _col1, _col4, _col5, _col8, _col9
-                  Position of Big Table: 1
-                  Select Operator
-                    expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
-                          expr: _col4
-                          type: string
-                          expr: _col5
-                          type: string
-                          expr: _col8
-                          type: string
-                          expr: _col9
-                          type: string
-                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
-                    File Output Operator
-                      compressed: false
-                      GlobalTableId: 0
-                      table:
-                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
-                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+              Map Join Operator
+                condition map:
+                     Inner Join 0 to 1
+                     Inner Join 1 to 2
+                condition expressions:
+                  0 {key} {value}
+                  1 {key} {value}
+                  2 {key} {value}
+                handleSkewJoin: false
+                keys:
+                  0 [Column[key]]
+                  1 [Column[key]]
+                  2 [Column[key]]
+                outputColumnNames: _col0, _col1, _col4, _col5, _col8, _col9
+                Position of Big Table: 1
+                Select Operator
+                  expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col1
+                        type: string
+                        expr: _col4
+                        type: string
+                        expr: _col5
+                        type: string
+                        expr: _col8
+                        type: string
+                        expr: _col9
+                        type: string
+                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
+                  File Output Operator
+                    compressed: false
+                    GlobalTableId: 0
+                    table:
+                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
       Local Work:
         Map Reduce Local Work
 
@@ -8654,21 +8490,17 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                HashTable Sink Operator
-                  condition expressions:
-                    0 {key} {value}
-                    1 {key} {value}
-                    2 {key} {value}
-                  handleSkewJoin: false
-                  keys:
-                    0 [Column[key]]
-                    1 [Column[key]]
-                    2 [Column[key]]
-                  Position of Big Table: 2
+              HashTable Sink Operator
+                condition expressions:
+                  0 {key} {value}
+                  1 {key} {value}
+                  2 {key} {value}
+                handleSkewJoin: false
+                keys:
+                  0 [Column[key]]
+                  1 [Column[key]]
+                  2 [Column[key]]
+                Position of Big Table: 2
         src2 
           TableScan
             alias: src2
@@ -8676,21 +8508,17 @@ STAGE PLANS:
               predicate:
                   expr: (key > 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key > 10)
-                    type: boolean
-                HashTable Sink Operator
-                  condition expressions:
-                    0 {key} {value}
-                    1 {key} {value}
-                    2 {key} {value}
-                  handleSkewJoin: false
-                  keys:
-                    0 [Column[key]]
-                    1 [Column[key]]
-                    2 [Column[key]]
-                  Position of Big Table: 2
+              HashTable Sink Operator
+                condition expressions:
+                  0 {key} {value}
+                  1 {key} {value}
+                  2 {key} {value}
+                handleSkewJoin: false
+                keys:
+                  0 [Column[key]]
+                  1 [Column[key]]
+                  2 [Column[key]]
+                Position of Big Table: 2
 
   Stage: Stage-7
     Map Reduce
@@ -8702,46 +8530,42 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                Map Join Operator
-                  condition map:
-                       Inner Join 0 to 1
-                       Inner Join 1 to 2
-                  condition expressions:
-                    0 {key} {value}
-                    1 {key} {value}
-                    2 {key} {value}
-                  handleSkewJoin: false
-                  keys:
-                    0 [Column[key]]
-                    1 [Column[key]]
-                    2 [Column[key]]
-                  outputColumnNames: _col0, _col1, _col4, _col5, _col8, _col9
-                  Position of Big Table: 2
-                  Select Operator
-                    expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
-                          expr: _col4
-                          type: string
-                          expr: _col5
-                          type: string
-                          expr: _col8
-                          type: string
-                          expr: _col9
-                          type: string
-                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
-                    File Output Operator
-                      compressed: false
-                      GlobalTableId: 0
-                      table:
-                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
-                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+              Map Join Operator
+                condition map:
+                     Inner Join 0 to 1
+                     Inner Join 1 to 2
+                condition expressions:
+                  0 {key} {value}
+                  1 {key} {value}
+                  2 {key} {value}
+                handleSkewJoin: false
+                keys:
+                  0 [Column[key]]
+                  1 [Column[key]]
+                  2 [Column[key]]
+                outputColumnNames: _col0, _col1, _col4, _col5, _col8, _col9
+                Position of Big Table: 2
+                Select Operator
+                  expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col1
+                        type: string
+                        expr: _col4
+                        type: string
+                        expr: _col5
+                        type: string
+                        expr: _col8
+                        type: string
+                        expr: _col9
+                        type: string
+                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
+                  File Output Operator
+                    compressed: false
+                    GlobalTableId: 0
+                    table:
+                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
       Local Work:
         Map Reduce Local Work
 
@@ -8755,24 +8579,20 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                Reduce Output Operator
-                  key expressions:
-                        expr: key
-                        type: string
-                  sort order: +
-                  Map-reduce partition columns:
-                        expr: key
-                        type: string
-                  tag: 0
-                  value expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
+              Reduce Output Operator
+                key expressions:
+                      expr: key
+                      type: string
+                sort order: +
+                Map-reduce partition columns:
+                      expr: key
+                      type: string
+                tag: 0
+                value expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
         src2 
           TableScan
             alias: src2
@@ -8780,24 +8600,20 @@ STAGE PLANS:
               predicate:
                   expr: (key > 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key > 10)
-                    type: boolean
-                Reduce Output Operator
-                  key expressions:
-                        expr: key
-                        type: string
-                  sort order: +
-                  Map-reduce partition columns:
-                        expr: key
-                        type: string
-                  tag: 1
-                  value expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
+              Reduce Output Operator
+                key expressions:
+                      expr: key
+                      type: string
+                sort order: +
+                Map-reduce partition columns:
+                      expr: key
+                      type: string
+                tag: 1
+                value expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
         src3 
           TableScan
             alias: src3
@@ -8805,24 +8621,20 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                Reduce Output Operator
-                  key expressions:
-                        expr: key
-                        type: string
-                  sort order: +
-                  Map-reduce partition columns:
-                        expr: key
-                        type: string
-                  tag: 2
-                  value expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
+              Reduce Output Operator
+                key expressions:
+                      expr: key
+                      type: string
+                sort order: +
+                Map-reduce partition columns:
+                      expr: key
+                      type: string
+                tag: 2
+                value expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
       Reduce Operator Tree:
         Join Operator
           condition map:
@@ -8860,6 +8672,7 @@ STAGE PLANS:
     Fetch Operator
       limit: -1
 
+
 PREHOOK: query: SELECT * FROM src src1 JOIN src src2 ON (src1.key = src2.key AND src1.key < 10 AND src2.key > 10) JOIN src src3 ON (src2.key = src3.key AND src3.key < 10) SORT BY src1.key, src1.value, src2.key, src2.value, src3.key, src3.value
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
diff --git a/ql/src/test/results/clientpositive/auto_join4.q.out b/ql/src/test/results/clientpositive/auto_join4.q.out
index 65ac8e651b..6e9cfee84c 100644
--- a/ql/src/test/results/clientpositive/auto_join4.q.out
+++ b/ql/src/test/results/clientpositive/auto_join4.q.out
@@ -62,26 +62,22 @@ STAGE PLANS:
               predicate:
                   expr: ((key > 15) and (key < 25))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: ((key > 15) and (key < 25))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
-                  outputColumnNames: _col0, _col1
-                  HashTable Sink Operator
-                    condition expressions:
-                      0 {_col0} {_col1}
-                      1 {_col0} {_col1}
-                    handleSkewJoin: false
-                    keys:
-                      0 [Column[_col0]]
-                      1 [Column[_col0]]
-                    Position of Big Table: 0
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                HashTable Sink Operator
+                  condition expressions:
+                    0 {_col0} {_col1}
+                    1 {_col0} {_col1}
+                  handleSkewJoin: false
+                  keys:
+                    0 [Column[_col0]]
+                    1 [Column[_col0]]
+                  Position of Big Table: 0
 
   Stage: Stage-4
     Map Reduce
@@ -93,29 +89,36 @@ STAGE PLANS:
               predicate:
                   expr: ((key > 10) and (key < 20))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: ((key > 10) and (key < 20))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
-                  outputColumnNames: _col0, _col1
-                  Map Join Operator
-                    condition map:
-                         Left Outer Join0 to 1
-                    condition expressions:
-                      0 {_col0} {_col1}
-                      1 {_col0} {_col1}
-                    handleSkewJoin: false
-                    keys:
-                      0 [Column[_col0]]
-                      1 [Column[_col0]]
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Map Join Operator
+                  condition map:
+                       Left Outer Join0 to 1
+                  condition expressions:
+                    0 {_col0} {_col1}
+                    1 {_col0} {_col1}
+                  handleSkewJoin: false
+                  keys:
+                    0 [Column[_col0]]
+                    1 [Column[_col0]]
+                  outputColumnNames: _col0, _col1, _col2, _col3
+                  Position of Big Table: 0
+                  Select Operator
+                    expressions:
+                          expr: _col0
+                          type: string
+                          expr: _col1
+                          type: string
+                          expr: _col2
+                          type: string
+                          expr: _col3
+                          type: string
                     outputColumnNames: _col0, _col1, _col2, _col3
-                    Position of Big Table: 0
                     Select Operator
                       expressions:
                             expr: _col0
@@ -129,34 +132,23 @@ STAGE PLANS:
                       outputColumnNames: _col0, _col1, _col2, _col3
                       Select Operator
                         expressions:
-                              expr: _col0
-                              type: string
+                              expr: UDFToInteger(_col0)
+                              type: int
                               expr: _col1
                               type: string
-                              expr: _col2
-                              type: string
+                              expr: UDFToInteger(_col2)
+                              type: int
                               expr: _col3
                               type: string
                         outputColumnNames: _col0, _col1, _col2, _col3
-                        Select Operator
-                          expressions:
-                                expr: UDFToInteger(_col0)
-                                type: int
-                                expr: _col1
-                                type: string
-                                expr: UDFToInteger(_col2)
-                                type: int
-                                expr: _col3
-                                type: string
-                          outputColumnNames: _col0, _col1, _col2, _col3
-                          File Output Operator
-                            compressed: false
-                            GlobalTableId: 1
-                            table:
-                                input format: org.apache.hadoop.mapred.TextInputFormat
-                                output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                                name: default.dest1
+                        File Output Operator
+                          compressed: false
+                          GlobalTableId: 1
+                          table:
+                              input format: org.apache.hadoop.mapred.TextInputFormat
+                              output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                              serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                              name: default.dest1
       Local Work:
         Map Reduce Local Work
 
@@ -183,31 +175,27 @@ STAGE PLANS:
               predicate:
                   expr: ((key > 10) and (key < 20))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: ((key > 10) and (key < 20))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
                         type: string
-                        expr: value
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: 0
+                  value expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: 0
-                    value expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
         c:b:src2 
           TableScan
             alias: src2
@@ -215,31 +203,27 @@ STAGE PLANS:
               predicate:
                   expr: ((key > 15) and (key < 25))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: ((key > 15) and (key < 25))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
                         type: string
-                        expr: value
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: 1
+                  value expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: 1
-                    value expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
       Reduce Operator Tree:
         Join Operator
           condition map:
diff --git a/ql/src/test/results/clientpositive/auto_join5.q.out b/ql/src/test/results/clientpositive/auto_join5.q.out
index 61d25286b5..e2930a003b 100644
--- a/ql/src/test/results/clientpositive/auto_join5.q.out
+++ b/ql/src/test/results/clientpositive/auto_join5.q.out
@@ -62,26 +62,22 @@ STAGE PLANS:
               predicate:
                   expr: ((key > 10) and (key < 20))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: ((key > 10) and (key < 20))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
-                  outputColumnNames: _col0, _col1
-                  HashTable Sink Operator
-                    condition expressions:
-                      0 {_col0} {_col1}
-                      1 {_col0} {_col1}
-                    handleSkewJoin: false
-                    keys:
-                      0 [Column[_col0]]
-                      1 [Column[_col0]]
-                    Position of Big Table: 1
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                HashTable Sink Operator
+                  condition expressions:
+                    0 {_col0} {_col1}
+                    1 {_col0} {_col1}
+                  handleSkewJoin: false
+                  keys:
+                    0 [Column[_col0]]
+                    1 [Column[_col0]]
+                  Position of Big Table: 1
 
   Stage: Stage-4
     Map Reduce
@@ -93,29 +89,36 @@ STAGE PLANS:
               predicate:
                   expr: ((key > 15) and (key < 25))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: ((key > 15) and (key < 25))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
-                  outputColumnNames: _col0, _col1
-                  Map Join Operator
-                    condition map:
-                         Right Outer Join0 to 1
-                    condition expressions:
-                      0 {_col0} {_col1}
-                      1 {_col0} {_col1}
-                    handleSkewJoin: false
-                    keys:
-                      0 [Column[_col0]]
-                      1 [Column[_col0]]
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Map Join Operator
+                  condition map:
+                       Right Outer Join0 to 1
+                  condition expressions:
+                    0 {_col0} {_col1}
+                    1 {_col0} {_col1}
+                  handleSkewJoin: false
+                  keys:
+                    0 [Column[_col0]]
+                    1 [Column[_col0]]
+                  outputColumnNames: _col0, _col1, _col2, _col3
+                  Position of Big Table: 1
+                  Select Operator
+                    expressions:
+                          expr: _col0
+                          type: string
+                          expr: _col1
+                          type: string
+                          expr: _col2
+                          type: string
+                          expr: _col3
+                          type: string
                     outputColumnNames: _col0, _col1, _col2, _col3
-                    Position of Big Table: 1
                     Select Operator
                       expressions:
                             expr: _col0
@@ -129,34 +132,23 @@ STAGE PLANS:
                       outputColumnNames: _col0, _col1, _col2, _col3
                       Select Operator
                         expressions:
-                              expr: _col0
-                              type: string
+                              expr: UDFToInteger(_col0)
+                              type: int
                               expr: _col1
                               type: string
-                              expr: _col2
-                              type: string
+                              expr: UDFToInteger(_col2)
+                              type: int
                               expr: _col3
                               type: string
                         outputColumnNames: _col0, _col1, _col2, _col3
-                        Select Operator
-                          expressions:
-                                expr: UDFToInteger(_col0)
-                                type: int
-                                expr: _col1
-                                type: string
-                                expr: UDFToInteger(_col2)
-                                type: int
-                                expr: _col3
-                                type: string
-                          outputColumnNames: _col0, _col1, _col2, _col3
-                          File Output Operator
-                            compressed: false
-                            GlobalTableId: 1
-                            table:
-                                input format: org.apache.hadoop.mapred.TextInputFormat
-                                output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                                name: default.dest1
+                        File Output Operator
+                          compressed: false
+                          GlobalTableId: 1
+                          table:
+                              input format: org.apache.hadoop.mapred.TextInputFormat
+                              output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                              serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                              name: default.dest1
       Local Work:
         Map Reduce Local Work
 
@@ -183,31 +175,27 @@ STAGE PLANS:
               predicate:
                   expr: ((key > 10) and (key < 20))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: ((key > 10) and (key < 20))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
                         type: string
-                        expr: value
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: 0
+                  value expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: 0
-                    value expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
         c:b:src2 
           TableScan
             alias: src2
@@ -215,31 +203,27 @@ STAGE PLANS:
               predicate:
                   expr: ((key > 15) and (key < 25))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: ((key > 15) and (key < 25))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
                         type: string
-                        expr: value
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: 1
+                  value expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: 1
-                    value expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
       Reduce Operator Tree:
         Join Operator
           condition map:
diff --git a/ql/src/test/results/clientpositive/auto_join6.q.out b/ql/src/test/results/clientpositive/auto_join6.q.out
index d1585efe87..4b5ddbc366 100644
--- a/ql/src/test/results/clientpositive/auto_join6.q.out
+++ b/ql/src/test/results/clientpositive/auto_join6.q.out
@@ -52,31 +52,27 @@ STAGE PLANS:
               predicate:
                   expr: ((key > 10) and (key < 20))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: ((key > 10) and (key < 20))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: 0
+                  value expressions:
+                        expr: _col0
                         type: string
-                        expr: value
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: 0
-                    value expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
         c:b:src2 
           TableScan
             alias: src2
@@ -84,31 +80,27 @@ STAGE PLANS:
               predicate:
                   expr: ((key > 15) and (key < 25))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: ((key > 15) and (key < 25))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: 1
+                  value expressions:
+                        expr: _col0
                         type: string
-                        expr: value
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: 1
-                    value expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
       Reduce Operator Tree:
         Join Operator
           condition map:
diff --git a/ql/src/test/results/clientpositive/auto_join7.q.out b/ql/src/test/results/clientpositive/auto_join7.q.out
index ceb15cb8dc..e892dc48ce 100644
--- a/ql/src/test/results/clientpositive/auto_join7.q.out
+++ b/ql/src/test/results/clientpositive/auto_join7.q.out
@@ -62,31 +62,27 @@ STAGE PLANS:
               predicate:
                   expr: ((key > 10) and (key < 20))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: ((key > 10) and (key < 20))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
                         type: string
-                        expr: value
+                  tag: 0
+                  value expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: 0
-                    value expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
         c:b:src2 
           TableScan
             alias: src2
@@ -94,31 +90,27 @@ STAGE PLANS:
               predicate:
                   expr: ((key > 15) and (key < 25))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: ((key > 15) and (key < 25))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: 1
+                  value expressions:
+                        expr: _col0
                         type: string
-                        expr: value
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: 1
-                    value expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
         c:c:src3 
           TableScan
             alias: src3
@@ -126,31 +118,27 @@ STAGE PLANS:
               predicate:
                   expr: ((key > 20) and (key < 25))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: ((key > 20) and (key < 25))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: 2
+                  value expressions:
+                        expr: _col0
                         type: string
-                        expr: value
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: 2
-                    value expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
       Reduce Operator Tree:
         Join Operator
           condition map:
diff --git a/ql/src/test/results/clientpositive/auto_join8.q.out b/ql/src/test/results/clientpositive/auto_join8.q.out
index 73c1a6f408..e6f1f53a28 100644
--- a/ql/src/test/results/clientpositive/auto_join8.q.out
+++ b/ql/src/test/results/clientpositive/auto_join8.q.out
@@ -62,26 +62,22 @@ STAGE PLANS:
               predicate:
                   expr: ((key > 15) and (key < 25))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: ((key > 15) and (key < 25))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
-                  outputColumnNames: _col0, _col1
-                  HashTable Sink Operator
-                    condition expressions:
-                      0 {_col0} {_col1}
-                      1 {_col0} {_col1}
-                    handleSkewJoin: false
-                    keys:
-                      0 [Column[_col0]]
-                      1 [Column[_col0]]
-                    Position of Big Table: 0
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                HashTable Sink Operator
+                  condition expressions:
+                    0 {_col0} {_col1}
+                    1 {_col0} {_col1}
+                  handleSkewJoin: false
+                  keys:
+                    0 [Column[_col0]]
+                    1 [Column[_col0]]
+                  Position of Big Table: 0
 
   Stage: Stage-4
     Map Reduce
@@ -93,29 +89,29 @@ STAGE PLANS:
               predicate:
                   expr: ((key > 10) and (key < 20))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: ((key > 10) and (key < 20))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
-                  outputColumnNames: _col0, _col1
-                  Map Join Operator
-                    condition map:
-                         Left Outer Join0 to 1
-                    condition expressions:
-                      0 {_col0} {_col1}
-                      1 {_col0} {_col1}
-                    handleSkewJoin: false
-                    keys:
-                      0 [Column[_col0]]
-                      1 [Column[_col0]]
-                    outputColumnNames: _col0, _col1, _col2, _col3
-                    Position of Big Table: 0
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Map Join Operator
+                  condition map:
+                       Left Outer Join0 to 1
+                  condition expressions:
+                    0 {_col0} {_col1}
+                    1 {_col0} {_col1}
+                  handleSkewJoin: false
+                  keys:
+                    0 [Column[_col0]]
+                    1 [Column[_col0]]
+                  outputColumnNames: _col0, _col1, _col2, _col3
+                  Position of Big Table: 0
+                  Filter Operator
+                    predicate:
+                        expr: (_col2 is null and _col0 is not null)
+                        type: boolean
                     Select Operator
                       expressions:
                             expr: _col0
@@ -127,40 +123,36 @@ STAGE PLANS:
                             expr: _col3
                             type: string
                       outputColumnNames: _col0, _col1, _col2, _col3
-                      Filter Operator
-                        predicate:
-                            expr: (_col2 is null and _col0 is not null)
-                            type: boolean
+                      Select Operator
+                        expressions:
+                              expr: _col0
+                              type: string
+                              expr: _col1
+                              type: string
+                              expr: _col2
+                              type: string
+                              expr: _col3
+                              type: string
+                        outputColumnNames: _col0, _col1, _col2, _col3
                         Select Operator
                           expressions:
-                                expr: _col0
-                                type: string
+                                expr: UDFToInteger(_col0)
+                                type: int
                                 expr: _col1
                                 type: string
-                                expr: _col2
-                                type: string
+                                expr: UDFToInteger(_col2)
+                                type: int
                                 expr: _col3
                                 type: string
                           outputColumnNames: _col0, _col1, _col2, _col3
-                          Select Operator
-                            expressions:
-                                  expr: UDFToInteger(_col0)
-                                  type: int
-                                  expr: _col1
-                                  type: string
-                                  expr: UDFToInteger(_col2)
-                                  type: int
-                                  expr: _col3
-                                  type: string
-                            outputColumnNames: _col0, _col1, _col2, _col3
-                            File Output Operator
-                              compressed: false
-                              GlobalTableId: 1
-                              table:
-                                  input format: org.apache.hadoop.mapred.TextInputFormat
-                                  output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                                  name: default.dest1
+                          File Output Operator
+                            compressed: false
+                            GlobalTableId: 1
+                            table:
+                                input format: org.apache.hadoop.mapred.TextInputFormat
+                                output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                                name: default.dest1
       Local Work:
         Map Reduce Local Work
 
@@ -187,31 +179,27 @@ STAGE PLANS:
               predicate:
                   expr: ((key > 10) and (key < 20))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: ((key > 10) and (key < 20))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
                         type: string
-                        expr: value
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: 0
+                  value expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: 0
-                    value expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
         c:b:src2 
           TableScan
             alias: src2
@@ -219,31 +207,27 @@ STAGE PLANS:
               predicate:
                   expr: ((key > 15) and (key < 25))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: ((key > 15) and (key < 25))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
                         type: string
-                        expr: value
+                  tag: 1
+                  value expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: 1
-                    value expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
       Reduce Operator Tree:
         Join Operator
           condition map:
@@ -253,21 +237,21 @@ STAGE PLANS:
             1 {VALUE._col0} {VALUE._col1}
           handleSkewJoin: false
           outputColumnNames: _col0, _col1, _col2, _col3
-          Select Operator
-            expressions:
-                  expr: _col0
-                  type: string
-                  expr: _col1
-                  type: string
-                  expr: _col2
-                  type: string
-                  expr: _col3
-                  type: string
-            outputColumnNames: _col0, _col1, _col2, _col3
-            Filter Operator
-              predicate:
-                  expr: (_col2 is null and _col0 is not null)
-                  type: boolean
+          Filter Operator
+            predicate:
+                expr: (_col2 is null and _col0 is not null)
+                type: boolean
+            Select Operator
+              expressions:
+                    expr: _col0
+                    type: string
+                    expr: _col1
+                    type: string
+                    expr: _col2
+                    type: string
+                    expr: _col3
+                    type: string
+              outputColumnNames: _col0, _col1, _col2, _col3
               Select Operator
                 expressions:
                       expr: _col0
diff --git a/ql/src/test/results/clientpositive/auto_join9.q.out b/ql/src/test/results/clientpositive/auto_join9.q.out
index 51c3bded06..81785a3b6d 100644
--- a/ql/src/test/results/clientpositive/auto_join9.q.out
+++ b/ql/src/test/results/clientpositive/auto_join9.q.out
@@ -66,32 +66,28 @@ STAGE PLANS:
                 1 [Column[key]]
               outputColumnNames: _col0, _col2, _col3, _col7
               Position of Big Table: 0
-              Filter Operator
-                predicate:
-                    expr: ((_col2 = '2008-04-08') and (_col3 = '12'))
-                    type: boolean
+              Select Operator
+                expressions:
+                      expr: _col0
+                      type: string
+                      expr: _col7
+                      type: string
+                outputColumnNames: _col0, _col1
                 Select Operator
                   expressions:
-                        expr: _col0
-                        type: string
-                        expr: _col7
+                        expr: UDFToInteger(_col0)
+                        type: int
+                        expr: _col1
                         type: string
                   outputColumnNames: _col0, _col1
-                  Select Operator
-                    expressions:
-                          expr: UDFToInteger(_col0)
-                          type: int
-                          expr: _col1
-                          type: string
-                    outputColumnNames: _col0, _col1
-                    File Output Operator
-                      compressed: false
-                      GlobalTableId: 1
-                      table:
-                          input format: org.apache.hadoop.mapred.TextInputFormat
-                          output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                          name: default.dest1
+                  File Output Operator
+                    compressed: false
+                    GlobalTableId: 1
+                    table:
+                        input format: org.apache.hadoop.mapred.TextInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                        name: default.dest1
       Local Work:
         Map Reduce Local Work
 
@@ -146,32 +142,28 @@ STAGE PLANS:
                 1 [Column[key]]
               outputColumnNames: _col0, _col2, _col3, _col7
               Position of Big Table: 1
-              Filter Operator
-                predicate:
-                    expr: ((_col2 = '2008-04-08') and (_col3 = '12'))
-                    type: boolean
+              Select Operator
+                expressions:
+                      expr: _col0
+                      type: string
+                      expr: _col7
+                      type: string
+                outputColumnNames: _col0, _col1
                 Select Operator
                   expressions:
-                        expr: _col0
-                        type: string
-                        expr: _col7
+                        expr: UDFToInteger(_col0)
+                        type: int
+                        expr: _col1
                         type: string
                   outputColumnNames: _col0, _col1
-                  Select Operator
-                    expressions:
-                          expr: UDFToInteger(_col0)
-                          type: int
-                          expr: _col1
-                          type: string
-                    outputColumnNames: _col0, _col1
-                    File Output Operator
-                      compressed: false
-                      GlobalTableId: 1
-                      table:
-                          input format: org.apache.hadoop.mapred.TextInputFormat
-                          output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                          name: default.dest1
+                  File Output Operator
+                    compressed: false
+                    GlobalTableId: 1
+                    table:
+                        input format: org.apache.hadoop.mapred.TextInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                        name: default.dest1
       Local Work:
         Map Reduce Local Work
 
@@ -221,32 +213,28 @@ STAGE PLANS:
             1 {VALUE._col1}
           handleSkewJoin: false
           outputColumnNames: _col0, _col2, _col3, _col7
-          Filter Operator
-            predicate:
-                expr: ((_col2 = '2008-04-08') and (_col3 = '12'))
-                type: boolean
+          Select Operator
+            expressions:
+                  expr: _col0
+                  type: string
+                  expr: _col7
+                  type: string
+            outputColumnNames: _col0, _col1
             Select Operator
               expressions:
-                    expr: _col0
-                    type: string
-                    expr: _col7
+                    expr: UDFToInteger(_col0)
+                    type: int
+                    expr: _col1
                     type: string
               outputColumnNames: _col0, _col1
-              Select Operator
-                expressions:
-                      expr: UDFToInteger(_col0)
-                      type: int
-                      expr: _col1
-                      type: string
-                outputColumnNames: _col0, _col1
-                File Output Operator
-                  compressed: false
-                  GlobalTableId: 1
-                  table:
-                      input format: org.apache.hadoop.mapred.TextInputFormat
-                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                      name: default.dest1
+              File Output Operator
+                compressed: false
+                GlobalTableId: 1
+                table:
+                    input format: org.apache.hadoop.mapred.TextInputFormat
+                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                    name: default.dest1
 
 
 PREHOOK: query: FROM srcpart src1 JOIN src src2 ON (src1.key = src2.key)
diff --git a/ql/src/test/results/clientpositive/bucket2.q.out b/ql/src/test/results/clientpositive/bucket2.q.out
index f63e90531e..89794616f4 100644
--- a/ql/src/test/results/clientpositive/bucket2.q.out
+++ b/ql/src/test/results/clientpositive/bucket2.q.out
@@ -190,28 +190,24 @@ STAGE PLANS:
               predicate:
                   expr: (((hash(key) & 2147483647) % 2) = 0)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (((hash(key) & 2147483647) % 2) = 0)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: int
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: int
+                  sort order: +
+                  tag: -1
+                  value expressions:
+                        expr: _col0
                         type: int
-                        expr: value
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: int
-                    sort order: +
-                    tag: -1
-                    value expressions:
-                          expr: _col0
-                          type: int
-                          expr: _col1
-                          type: string
       Reduce Operator Tree:
         Extract
           File Output Operator
diff --git a/ql/src/test/results/clientpositive/bucket3.q.out b/ql/src/test/results/clientpositive/bucket3.q.out
index f6c0fee311..4701e50b16 100644
--- a/ql/src/test/results/clientpositive/bucket3.q.out
+++ b/ql/src/test/results/clientpositive/bucket3.q.out
@@ -211,36 +211,28 @@ STAGE PLANS:
               predicate:
                   expr: (((hash(key) & 2147483647) % 2) = 0)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (((hash(key) & 2147483647) % 2) = 0)
-                    type: boolean
-                Filter Operator
-                  predicate:
-                      expr: (ds = '1')
-                      type: boolean
-                  Select Operator
-                    expressions:
-                          expr: key
-                          type: int
-                          expr: value
-                          type: string
-                          expr: ds
-                          type: string
-                    outputColumnNames: _col0, _col1, _col2
-                    Reduce Output Operator
-                      key expressions:
-                            expr: _col0
-                            type: int
-                      sort order: +
-                      tag: -1
-                      value expressions:
-                            expr: _col0
-                            type: int
-                            expr: _col1
-                            type: string
-                            expr: _col2
-                            type: string
+              Select Operator
+                expressions:
+                      expr: key
+                      type: int
+                      expr: value
+                      type: string
+                      expr: ds
+                      type: string
+                outputColumnNames: _col0, _col1, _col2
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: int
+                  sort order: +
+                  tag: -1
+                  value expressions:
+                        expr: _col0
+                        type: int
+                        expr: _col1
+                        type: string
+                        expr: _col2
+                        type: string
       Reduce Operator Tree:
         Extract
           File Output Operator
diff --git a/ql/src/test/results/clientpositive/bucket4.q.out b/ql/src/test/results/clientpositive/bucket4.q.out
index 0d3c7cc6ec..a6611ffecb 100644
--- a/ql/src/test/results/clientpositive/bucket4.q.out
+++ b/ql/src/test/results/clientpositive/bucket4.q.out
@@ -195,23 +195,19 @@ STAGE PLANS:
               predicate:
                   expr: (((hash(key) & 2147483647) % 2) = 0)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (((hash(key) & 2147483647) % 2) = 0)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: int
-                        expr: value
-                        type: string
-                  outputColumnNames: _col0, _col1
-                  File Output Operator
-                    compressed: false
-                    GlobalTableId: 0
-                    table:
-                        input format: org.apache.hadoop.mapred.TextInputFormat
-                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+              Select Operator
+                expressions:
+                      expr: key
+                      type: int
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 0
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
 
   Stage: Stage-0
     Fetch Operator
diff --git a/ql/src/test/results/clientpositive/bucket_groupby.q.out b/ql/src/test/results/clientpositive/bucket_groupby.q.out
index b2cbbcfaf7..24ef4c6bbe 100644
--- a/ql/src/test/results/clientpositive/bucket_groupby.q.out
+++ b/ql/src/test/results/clientpositive/bucket_groupby.q.out
@@ -44,36 +44,32 @@ STAGE PLANS:
         clustergroupby 
           TableScan
             alias: clustergroupby
-            Filter Operator
-              predicate:
-                  expr: (ds = '100')
-                  type: boolean
-              Select Operator
-                expressions:
+            Select Operator
+              expressions:
+                    expr: key
+                    type: string
+              outputColumnNames: key
+              Group By Operator
+                aggregations:
+                      expr: count(1)
+                bucketGroup: false
+                keys:
                       expr: key
                       type: string
-                outputColumnNames: key
-                Group By Operator
-                  aggregations:
-                        expr: count(1)
-                  bucketGroup: false
-                  keys:
-                        expr: key
+                mode: hash
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
                         type: string
-                  mode: hash
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: -1
-                    value expressions:
-                          expr: _col1
-                          type: bigint
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: -1
+                  value expressions:
+                        expr: _col1
+                        type: bigint
       Reduce Operator Tree:
         Group By Operator
           aggregations:
@@ -183,36 +179,32 @@ STAGE PLANS:
         clustergroupby 
           TableScan
             alias: clustergroupby
-            Filter Operator
-              predicate:
-                  expr: (ds = '101')
-                  type: boolean
-              Select Operator
-                expressions:
+            Select Operator
+              expressions:
+                    expr: key
+                    type: string
+              outputColumnNames: key
+              Group By Operator
+                aggregations:
+                      expr: count(1)
+                bucketGroup: true
+                keys:
                       expr: key
                       type: string
-                outputColumnNames: key
-                Group By Operator
-                  aggregations:
-                        expr: count(1)
-                  bucketGroup: true
-                  keys:
-                        expr: key
+                mode: hash
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
                         type: string
-                  mode: hash
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: -1
-                    value expressions:
-                          expr: _col1
-                          type: bigint
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: -1
+                  value expressions:
+                        expr: _col1
+                        type: bigint
       Reduce Operator Tree:
         Group By Operator
           aggregations:
@@ -291,36 +283,32 @@ STAGE PLANS:
         clustergroupby 
           TableScan
             alias: clustergroupby
-            Filter Operator
-              predicate:
-                  expr: (ds = '101')
-                  type: boolean
-              Select Operator
-                expressions:
-                      expr: key
-                      type: string
-                outputColumnNames: key
-                Group By Operator
-                  aggregations:
-                        expr: count(1)
-                  bucketGroup: true
-                  keys:
-                        expr: length(key)
+            Select Operator
+              expressions:
+                    expr: key
+                    type: string
+              outputColumnNames: key
+              Group By Operator
+                aggregations:
+                      expr: count(1)
+                bucketGroup: true
+                keys:
+                      expr: length(key)
+                      type: int
+                mode: hash
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
                         type: int
-                  mode: hash
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: int
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: int
-                    tag: -1
-                    value expressions:
-                          expr: _col1
-                          type: bigint
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: int
+                  tag: -1
+                  value expressions:
+                        expr: _col1
+                        type: bigint
       Reduce Operator Tree:
         Group By Operator
           aggregations:
@@ -390,36 +378,32 @@ STAGE PLANS:
         clustergroupby 
           TableScan
             alias: clustergroupby
-            Filter Operator
-              predicate:
-                  expr: (ds = '101')
-                  type: boolean
-              Select Operator
-                expressions:
-                      expr: key
-                      type: string
-                outputColumnNames: key
-                Group By Operator
-                  aggregations:
-                        expr: count(1)
-                  bucketGroup: true
-                  keys:
-                        expr: abs(length(key))
+            Select Operator
+              expressions:
+                    expr: key
+                    type: string
+              outputColumnNames: key
+              Group By Operator
+                aggregations:
+                      expr: count(1)
+                bucketGroup: true
+                keys:
+                      expr: abs(length(key))
+                      type: int
+                mode: hash
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
                         type: int
-                  mode: hash
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: int
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: int
-                    tag: -1
-                    value expressions:
-                          expr: _col1
-                          type: bigint
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: int
+                  tag: -1
+                  value expressions:
+                        expr: _col1
+                        type: bigint
       Reduce Operator Tree:
         Group By Operator
           aggregations:
@@ -491,42 +475,38 @@ STAGE PLANS:
         clustergroupby 
           TableScan
             alias: clustergroupby
-            Filter Operator
-              predicate:
-                  expr: (ds = '101')
-                  type: boolean
-              Select Operator
-                expressions:
+            Select Operator
+              expressions:
+                    expr: key
+                    type: string
+              outputColumnNames: key
+              Group By Operator
+                aggregations:
+                      expr: count(1)
+                bucketGroup: true
+                keys:
                       expr: key
                       type: string
-                outputColumnNames: key
-                Group By Operator
-                  aggregations:
-                        expr: count(1)
-                  bucketGroup: true
-                  keys:
-                        expr: key
+                      expr: 3
+                      type: int
+                mode: hash
+                outputColumnNames: _col0, _col1, _col2
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
                         type: string
-                        expr: 3
+                        expr: _col1
                         type: int
-                  mode: hash
-                  outputColumnNames: _col0, _col1, _col2
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: int
-                    sort order: ++
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: int
-                    tag: -1
-                    value expressions:
-                          expr: _col2
-                          type: bigint
+                  sort order: ++
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                        expr: _col1
+                        type: int
+                  tag: -1
+                  value expressions:
+                        expr: _col2
+                        type: bigint
       Reduce Operator Tree:
         Group By Operator
           aggregations:
@@ -607,41 +587,37 @@ STAGE PLANS:
         subq:clustergroupby 
           TableScan
             alias: clustergroupby
-            Filter Operator
-              predicate:
-                  expr: (ds = '101')
-                  type: boolean
+            Select Operator
+              expressions:
+                    expr: value
+                    type: string
+              outputColumnNames: _col0
               Select Operator
                 expressions:
-                      expr: value
+                      expr: _col0
                       type: string
                 outputColumnNames: _col0
-                Select Operator
-                  expressions:
+                Group By Operator
+                  aggregations:
+                        expr: count(1)
+                  bucketGroup: false
+                  keys:
                         expr: _col0
                         type: string
-                  outputColumnNames: _col0
-                  Group By Operator
-                    aggregations:
-                          expr: count(1)
-                    bucketGroup: false
-                    keys:
+                  mode: hash
+                  outputColumnNames: _col0, _col1
+                  Reduce Output Operator
+                    key expressions:
+                          expr: _col0
+                          type: string
+                    sort order: +
+                    Map-reduce partition columns:
                           expr: _col0
                           type: string
-                    mode: hash
-                    outputColumnNames: _col0, _col1
-                    Reduce Output Operator
-                      key expressions:
-                            expr: _col0
-                            type: string
-                      sort order: +
-                      Map-reduce partition columns:
-                            expr: _col0
-                            type: string
-                      tag: -1
-                      value expressions:
-                            expr: _col1
-                            type: bigint
+                    tag: -1
+                    value expressions:
+                          expr: _col1
+                          type: bigint
       Reduce Operator Tree:
         Group By Operator
           aggregations:
@@ -1250,36 +1226,32 @@ STAGE PLANS:
         clustergroupby 
           TableScan
             alias: clustergroupby
-            Filter Operator
-              predicate:
-                  expr: (ds = '102')
-                  type: boolean
-              Select Operator
-                expressions:
+            Select Operator
+              expressions:
+                    expr: key
+                    type: string
+              outputColumnNames: key
+              Group By Operator
+                aggregations:
+                      expr: count(1)
+                bucketGroup: true
+                keys:
                       expr: key
                       type: string
-                outputColumnNames: key
-                Group By Operator
-                  aggregations:
-                        expr: count(1)
-                  bucketGroup: true
-                  keys:
-                        expr: key
+                mode: hash
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
                         type: string
-                  mode: hash
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: -1
-                    value expressions:
-                          expr: _col1
-                          type: bigint
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: -1
+                  value expressions:
+                        expr: _col1
+                        type: bigint
       Reduce Operator Tree:
         Group By Operator
           aggregations:
@@ -1360,36 +1332,32 @@ STAGE PLANS:
         clustergroupby 
           TableScan
             alias: clustergroupby
-            Filter Operator
-              predicate:
-                  expr: (ds = '102')
-                  type: boolean
-              Select Operator
-                expressions:
+            Select Operator
+              expressions:
+                    expr: value
+                    type: string
+              outputColumnNames: value
+              Group By Operator
+                aggregations:
+                      expr: count(1)
+                bucketGroup: false
+                keys:
                       expr: value
                       type: string
-                outputColumnNames: value
-                Group By Operator
-                  aggregations:
-                        expr: count(1)
-                  bucketGroup: false
-                  keys:
-                        expr: value
+                mode: hash
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
                         type: string
-                  mode: hash
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: -1
-                    value expressions:
-                          expr: _col1
-                          type: bigint
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: -1
+                  value expressions:
+                        expr: _col1
+                        type: bigint
       Reduce Operator Tree:
         Group By Operator
           aggregations:
@@ -1470,44 +1438,40 @@ STAGE PLANS:
         clustergroupby 
           TableScan
             alias: clustergroupby
-            Filter Operator
-              predicate:
-                  expr: (ds = '102')
-                  type: boolean
-              Select Operator
-                expressions:
+            Select Operator
+              expressions:
+                    expr: key
+                    type: string
+                    expr: value
+                    type: string
+              outputColumnNames: key, value
+              Group By Operator
+                aggregations:
+                      expr: count(1)
+                bucketGroup: true
+                keys:
                       expr: key
                       type: string
                       expr: value
                       type: string
-                outputColumnNames: key, value
-                Group By Operator
-                  aggregations:
-                        expr: count(1)
-                  bucketGroup: true
-                  keys:
-                        expr: key
+                mode: hash
+                outputColumnNames: _col0, _col1, _col2
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
                         type: string
-                        expr: value
+                        expr: _col1
                         type: string
-                  mode: hash
-                  outputColumnNames: _col0, _col1, _col2
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
-                    sort order: ++
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
-                    tag: -1
-                    value expressions:
-                          expr: _col2
-                          type: bigint
+                  sort order: ++
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                        expr: _col1
+                        type: string
+                  tag: -1
+                  value expressions:
+                        expr: _col2
+                        type: bigint
       Reduce Operator Tree:
         Group By Operator
           aggregations:
@@ -1637,36 +1601,32 @@ STAGE PLANS:
         clustergroupby 
           TableScan
             alias: clustergroupby
-            Filter Operator
-              predicate:
-                  expr: (ds = '103')
-                  type: boolean
-              Select Operator
-                expressions:
+            Select Operator
+              expressions:
+                    expr: key
+                    type: string
+              outputColumnNames: key
+              Group By Operator
+                aggregations:
+                      expr: count(1)
+                bucketGroup: true
+                keys:
                       expr: key
                       type: string
-                outputColumnNames: key
-                Group By Operator
-                  aggregations:
-                        expr: count(1)
-                  bucketGroup: true
-                  keys:
-                        expr: key
+                mode: hash
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
                         type: string
-                  mode: hash
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: -1
-                    value expressions:
-                          expr: _col1
-                          type: bigint
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: -1
+                  value expressions:
+                        expr: _col1
+                        type: bigint
       Reduce Operator Tree:
         Group By Operator
           aggregations:
@@ -1751,44 +1711,40 @@ STAGE PLANS:
         clustergroupby 
           TableScan
             alias: clustergroupby
-            Filter Operator
-              predicate:
-                  expr: (ds = '103')
-                  type: boolean
-              Select Operator
-                expressions:
+            Select Operator
+              expressions:
+                    expr: value
+                    type: string
+                    expr: key
+                    type: string
+              outputColumnNames: value, key
+              Group By Operator
+                aggregations:
+                      expr: count(1)
+                bucketGroup: false
+                keys:
                       expr: value
                       type: string
                       expr: key
                       type: string
-                outputColumnNames: value, key
-                Group By Operator
-                  aggregations:
-                        expr: count(1)
-                  bucketGroup: false
-                  keys:
-                        expr: value
+                mode: hash
+                outputColumnNames: _col0, _col1, _col2
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
                         type: string
-                        expr: key
+                        expr: _col1
                         type: string
-                  mode: hash
-                  outputColumnNames: _col0, _col1, _col2
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
-                    sort order: ++
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
-                    tag: -1
-                    value expressions:
-                          expr: _col2
-                          type: bigint
+                  sort order: ++
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                        expr: _col1
+                        type: string
+                  tag: -1
+                  value expressions:
+                        expr: _col2
+                        type: bigint
       Reduce Operator Tree:
         Group By Operator
           aggregations:
diff --git a/ql/src/test/results/clientpositive/bucketmapjoin1.q.out b/ql/src/test/results/clientpositive/bucketmapjoin1.q.out
index c8fbc2bb61..fa4e9003bb 100644
--- a/ql/src/test/results/clientpositive/bucketmapjoin1.q.out
+++ b/ql/src/test/results/clientpositive/bucketmapjoin1.q.out
@@ -162,46 +162,41 @@ STAGE PLANS:
                       expr: _col6
                       type: string
                 outputColumnNames: _col0, _col1, _col5, _col6
-                Filter Operator
-                  isSamplingPred: false
-                  predicate:
-                      expr: (_col6 = '2008-04-08')
-                      type: boolean
-                  Select Operator
-                    expressions:
-                          expr: _col0
-                          type: int
-                          expr: _col1
-                          type: string
-                          expr: _col5
-                          type: string
-                    outputColumnNames: _col0, _col1, _col2
-                    File Output Operator
-                      compressed: false
-                      GlobalTableId: 1
-                      directory: pfile:/data/users/tomasz/apache-hive/build/ql/scratchdir/hive_2011-06-01_18-43-58_298_9037696460370256238/-ext-10002
-                      NumFilesPerFileSink: 1
-                      Stats Publishing Key Prefix: pfile:/data/users/tomasz/apache-hive/build/ql/scratchdir/hive_2011-06-01_18-43-58_298_9037696460370256238/-ext-10000/
-                      table:
-                          input format: org.apache.hadoop.mapred.TextInputFormat
-                          output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                          properties:
-                            bucket_count -1
-                            columns key,value1,value2
-                            columns.types string:string:string
-                            file.inputformat org.apache.hadoop.mapred.TextInputFormat
-                            file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                            location pfile:/data/users/tomasz/apache-hive/build/ql/test/data/warehouse/bucketmapjoin_tmp_result
-                            name default.bucketmapjoin_tmp_result
-                            serialization.ddl struct bucketmapjoin_tmp_result { string key, string value1, string value2}
-                            serialization.format 1
-                            serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                            transient_lastDdlTime 1306979038
-                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                          name: default.bucketmapjoin_tmp_result
-                      TotalFiles: 1
-                      GatherStats: true
-                      MultiFileSpray: false
+                Select Operator
+                  expressions:
+                        expr: _col0
+                        type: int
+                        expr: _col1
+                        type: string
+                        expr: _col5
+                        type: string
+                  outputColumnNames: _col0, _col1, _col2
+                  File Output Operator
+                    compressed: false
+                    GlobalTableId: 1
+                    directory: pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_01-32-48_276_7157048291488416942/-ext-10002
+                    NumFilesPerFileSink: 1
+                    Stats Publishing Key Prefix: pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_01-32-48_276_7157048291488416942/-ext-10000/
+                    table:
+                        input format: org.apache.hadoop.mapred.TextInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                        properties:
+                          bucket_count -1
+                          columns key,value1,value2
+                          columns.types string:string:string
+                          file.inputformat org.apache.hadoop.mapred.TextInputFormat
+                          file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                          location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/bucketmapjoin_tmp_result
+                          name default.bucketmapjoin_tmp_result
+                          serialization.ddl struct bucketmapjoin_tmp_result { string key, string value1, string value2}
+                          serialization.format 1
+                          serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                          transient_lastDdlTime 1310373168
+                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                        name: default.bucketmapjoin_tmp_result
+                    TotalFiles: 1
+                    GatherStats: true
+                    MultiFileSpray: false
       Local Work:
         Map Reduce Local Work
       Needs Tagging: false
@@ -593,51 +588,46 @@ STAGE PLANS:
                       expr: _col6
                       type: string
                 outputColumnNames: _col0, _col1, _col5, _col6
-                Filter Operator
-                  isSamplingPred: false
-                  predicate:
-                      expr: (_col6 = '2008-04-08')
-                      type: boolean
-                  Select Operator
-                    expressions:
-                          expr: _col0
-                          type: int
-                          expr: _col1
-                          type: string
-                          expr: _col5
-                          type: string
-                    outputColumnNames: _col0, _col1, _col2
-                    File Output Operator
-                      compressed: false
-                      GlobalTableId: 1
-                      directory: pfile:/data/users/tomasz/apache-hive/build/ql/scratchdir/hive_2011-06-01_18-44-28_997_7507478881890153288/-ext-10002
-                      NumFilesPerFileSink: 1
-                      Stats Publishing Key Prefix: pfile:/data/users/tomasz/apache-hive/build/ql/scratchdir/hive_2011-06-01_18-44-28_997_7507478881890153288/-ext-10000/
-                      table:
-                          input format: org.apache.hadoop.mapred.TextInputFormat
-                          output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                          properties:
-                            bucket_count -1
-                            columns key,value1,value2
-                            columns.types string:string:string
-                            file.inputformat org.apache.hadoop.mapred.TextInputFormat
-                            file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                            location pfile:/data/users/tomasz/apache-hive/build/ql/test/data/warehouse/bucketmapjoin_tmp_result
-                            name default.bucketmapjoin_tmp_result
-                            numFiles 1
-                            numPartitions 0
-                            numRows 464
-                            rawDataSize 8519
-                            serialization.ddl struct bucketmapjoin_tmp_result { string key, string value1, string value2}
-                            serialization.format 1
-                            serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                            totalSize 8983
-                            transient_lastDdlTime 1306979058
-                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                          name: default.bucketmapjoin_tmp_result
-                      TotalFiles: 1
-                      GatherStats: true
-                      MultiFileSpray: false
+                Select Operator
+                  expressions:
+                        expr: _col0
+                        type: int
+                        expr: _col1
+                        type: string
+                        expr: _col5
+                        type: string
+                  outputColumnNames: _col0, _col1, _col2
+                  File Output Operator
+                    compressed: false
+                    GlobalTableId: 1
+                    directory: pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_01-33-14_326_2924976190429141214/-ext-10002
+                    NumFilesPerFileSink: 1
+                    Stats Publishing Key Prefix: pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_01-33-14_326_2924976190429141214/-ext-10000/
+                    table:
+                        input format: org.apache.hadoop.mapred.TextInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                        properties:
+                          bucket_count -1
+                          columns key,value1,value2
+                          columns.types string:string:string
+                          file.inputformat org.apache.hadoop.mapred.TextInputFormat
+                          file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                          location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/bucketmapjoin_tmp_result
+                          name default.bucketmapjoin_tmp_result
+                          numFiles 1
+                          numPartitions 0
+                          numRows 464
+                          rawDataSize 8519
+                          serialization.ddl struct bucketmapjoin_tmp_result { string key, string value1, string value2}
+                          serialization.format 1
+                          serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                          totalSize 8983
+                          transient_lastDdlTime 1310373185
+                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                        name: default.bucketmapjoin_tmp_result
+                    TotalFiles: 1
+                    GatherStats: true
+                    MultiFileSpray: false
       Local Work:
         Map Reduce Local Work
       Needs Tagging: false
diff --git a/ql/src/test/results/clientpositive/bucketmapjoin2.q.out b/ql/src/test/results/clientpositive/bucketmapjoin2.q.out
index ed07b63257..2cd3617350 100644
--- a/ql/src/test/results/clientpositive/bucketmapjoin2.q.out
+++ b/ql/src/test/results/clientpositive/bucketmapjoin2.q.out
@@ -114,20 +114,15 @@ STAGE PLANS:
           TableScan
             alias: b
             GatherStats: false
-            Filter Operator
-              isSamplingPred: false
-              predicate:
-                  expr: (ds = '2008-04-08')
-                  type: boolean
-              HashTable Sink Operator
-                condition expressions:
-                  0 {key} {value}
-                  1 {value}
-                handleSkewJoin: false
-                keys:
-                  0 [Column[key]]
-                  1 [Column[key]]
-                Position of Big Table: 0
+            HashTable Sink Operator
+              condition expressions:
+                0 {key} {value}
+                1 {value}
+              handleSkewJoin: false
+              keys:
+                0 [Column[key]]
+                1 [Column[key]]
+              Position of Big Table: 0
       Bucket Mapjoin Context:
           Alias Bucket Base File Name Mapping:
             b {srcbucket20.txt=[srcbucket22.txt], srcbucket21.txt=[srcbucket23.txt]}
@@ -566,23 +561,27 @@ STAGE PLANS:
           TableScan
             alias: b
             GatherStats: false
-            Filter Operator
-              isSamplingPred: false
-              predicate:
-                  expr: (ds = '2008-04-08')
-                  type: boolean
-              Map Join Operator
-                condition map:
-                     Inner Join 0 to 1
-                condition expressions:
-                  0 {key} {value}
-                  1 {value}
-                handleSkewJoin: false
-                keys:
-                  0 [Column[key]]
-                  1 [Column[key]]
+            Map Join Operator
+              condition map:
+                   Inner Join 0 to 1
+              condition expressions:
+                0 {key} {value}
+                1 {value}
+              handleSkewJoin: false
+              keys:
+                0 [Column[key]]
+                1 [Column[key]]
+              outputColumnNames: _col0, _col1, _col5
+              Position of Big Table: 1
+              Select Operator
+                expressions:
+                      expr: _col0
+                      type: int
+                      expr: _col1
+                      type: string
+                      expr: _col5
+                      type: string
                 outputColumnNames: _col0, _col1, _col5
-                Position of Big Table: 1
                 Select Operator
                   expressions:
                         expr: _col0
@@ -591,47 +590,38 @@ STAGE PLANS:
                         type: string
                         expr: _col5
                         type: string
-                  outputColumnNames: _col0, _col1, _col5
-                  Select Operator
-                    expressions:
-                          expr: _col0
-                          type: int
-                          expr: _col1
-                          type: string
-                          expr: _col5
-                          type: string
-                    outputColumnNames: _col0, _col1, _col2
-                    File Output Operator
-                      compressed: false
-                      GlobalTableId: 1
-                      directory: pfile:/data/users/tomasz/apache-hive/build/ql/scratchdir/hive_2011-06-01_18-45-37_439_7794471196064019055/-ext-10002
-                      NumFilesPerFileSink: 1
-                      Stats Publishing Key Prefix: pfile:/data/users/tomasz/apache-hive/build/ql/scratchdir/hive_2011-06-01_18-45-37_439_7794471196064019055/-ext-10000/
-                      table:
-                          input format: org.apache.hadoop.mapred.TextInputFormat
-                          output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                          properties:
-                            bucket_count -1
-                            columns key,value1,value2
-                            columns.types string:string:string
-                            file.inputformat org.apache.hadoop.mapred.TextInputFormat
-                            file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                            location pfile:/data/users/tomasz/apache-hive/build/ql/test/data/warehouse/bucketmapjoin_tmp_result
-                            name default.bucketmapjoin_tmp_result
-                            numFiles 1
-                            numPartitions 0
-                            numRows 0
-                            rawDataSize 0
-                            serialization.ddl struct bucketmapjoin_tmp_result { string key, string value1, string value2}
-                            serialization.format 1
-                            serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                            totalSize 0
-                            transient_lastDdlTime 1306979126
-                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                          name: default.bucketmapjoin_tmp_result
-                      TotalFiles: 1
-                      GatherStats: true
-                      MultiFileSpray: false
+                  outputColumnNames: _col0, _col1, _col2
+                  File Output Operator
+                    compressed: false
+                    GlobalTableId: 1
+                    directory: pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_01-34-10_535_3760851253870163797/-ext-10002
+                    NumFilesPerFileSink: 1
+                    Stats Publishing Key Prefix: pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_01-34-10_535_3760851253870163797/-ext-10000/
+                    table:
+                        input format: org.apache.hadoop.mapred.TextInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                        properties:
+                          bucket_count -1
+                          columns key,value1,value2
+                          columns.types string:string:string
+                          file.inputformat org.apache.hadoop.mapred.TextInputFormat
+                          file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                          location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/bucketmapjoin_tmp_result
+                          name default.bucketmapjoin_tmp_result
+                          numFiles 1
+                          numPartitions 0
+                          numRows 0
+                          rawDataSize 0
+                          serialization.ddl struct bucketmapjoin_tmp_result { string key, string value1, string value2}
+                          serialization.format 1
+                          serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                          totalSize 0
+                          transient_lastDdlTime 1310373241
+                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                        name: default.bucketmapjoin_tmp_result
+                    TotalFiles: 1
+                    GatherStats: true
+                    MultiFileSpray: false
       Local Work:
         Map Reduce Local Work
       Needs Tagging: false
diff --git a/ql/src/test/results/clientpositive/bucketmapjoin3.q.out b/ql/src/test/results/clientpositive/bucketmapjoin3.q.out
index 47dc9353c3..dff25e1fec 100644
--- a/ql/src/test/results/clientpositive/bucketmapjoin3.q.out
+++ b/ql/src/test/results/clientpositive/bucketmapjoin3.q.out
@@ -114,20 +114,15 @@ STAGE PLANS:
           TableScan
             alias: b
             GatherStats: false
-            Filter Operator
-              isSamplingPred: false
-              predicate:
-                  expr: (ds = '2008-04-08')
-                  type: boolean
-              HashTable Sink Operator
-                condition expressions:
-                  0 {key} {value}
-                  1 {value}
-                handleSkewJoin: false
-                keys:
-                  0 [Column[key]]
-                  1 [Column[key]]
-                Position of Big Table: 0
+            HashTable Sink Operator
+              condition expressions:
+                0 {key} {value}
+                1 {value}
+              handleSkewJoin: false
+              keys:
+                0 [Column[key]]
+                1 [Column[key]]
+              Position of Big Table: 0
       Bucket Mapjoin Context:
           Alias Bucket Base File Name Mapping:
             b {srcbucket22.txt=[srcbucket20.txt, srcbucket22.txt], srcbucket23.txt=[srcbucket21.txt, srcbucket23.txt]}
@@ -144,23 +139,27 @@ STAGE PLANS:
           TableScan
             alias: a
             GatherStats: false
-            Filter Operator
-              isSamplingPred: false
-              predicate:
-                  expr: (ds = '2008-04-08')
-                  type: boolean
-              Map Join Operator
-                condition map:
-                     Inner Join 0 to 1
-                condition expressions:
-                  0 {key} {value}
-                  1 {value}
-                handleSkewJoin: false
-                keys:
-                  0 [Column[key]]
-                  1 [Column[key]]
+            Map Join Operator
+              condition map:
+                   Inner Join 0 to 1
+              condition expressions:
+                0 {key} {value}
+                1 {value}
+              handleSkewJoin: false
+              keys:
+                0 [Column[key]]
+                1 [Column[key]]
+              outputColumnNames: _col0, _col1, _col6
+              Position of Big Table: 0
+              Select Operator
+                expressions:
+                      expr: _col0
+                      type: int
+                      expr: _col1
+                      type: string
+                      expr: _col6
+                      type: string
                 outputColumnNames: _col0, _col1, _col6
-                Position of Big Table: 0
                 Select Operator
                   expressions:
                         expr: _col0
@@ -169,42 +168,33 @@ STAGE PLANS:
                         type: string
                         expr: _col6
                         type: string
-                  outputColumnNames: _col0, _col1, _col6
-                  Select Operator
-                    expressions:
-                          expr: _col0
-                          type: int
-                          expr: _col1
-                          type: string
-                          expr: _col6
-                          type: string
-                    outputColumnNames: _col0, _col1, _col2
-                    File Output Operator
-                      compressed: false
-                      GlobalTableId: 1
-                      directory: pfile:/data/users/tomasz/apache-hive/build/ql/scratchdir/hive_2011-06-01_18-46-14_989_6212335898656818660/-ext-10002
-                      NumFilesPerFileSink: 1
-                      Stats Publishing Key Prefix: pfile:/data/users/tomasz/apache-hive/build/ql/scratchdir/hive_2011-06-01_18-46-14_989_6212335898656818660/-ext-10000/
-                      table:
-                          input format: org.apache.hadoop.mapred.TextInputFormat
-                          output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                          properties:
-                            bucket_count -1
-                            columns key,value1,value2
-                            columns.types string:string:string
-                            file.inputformat org.apache.hadoop.mapred.TextInputFormat
-                            file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                            location pfile:/data/users/tomasz/apache-hive/build/ql/test/data/warehouse/bucketmapjoin_tmp_result
-                            name default.bucketmapjoin_tmp_result
-                            serialization.ddl struct bucketmapjoin_tmp_result { string key, string value1, string value2}
-                            serialization.format 1
-                            serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                            transient_lastDdlTime 1306979174
-                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                          name: default.bucketmapjoin_tmp_result
-                      TotalFiles: 1
-                      GatherStats: true
-                      MultiFileSpray: false
+                  outputColumnNames: _col0, _col1, _col2
+                  File Output Operator
+                    compressed: false
+                    GlobalTableId: 1
+                    directory: pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_01-34-40_179_2078859592920140854/-ext-10002
+                    NumFilesPerFileSink: 1
+                    Stats Publishing Key Prefix: pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_01-34-40_179_2078859592920140854/-ext-10000/
+                    table:
+                        input format: org.apache.hadoop.mapred.TextInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                        properties:
+                          bucket_count -1
+                          columns key,value1,value2
+                          columns.types string:string:string
+                          file.inputformat org.apache.hadoop.mapred.TextInputFormat
+                          file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                          location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/bucketmapjoin_tmp_result
+                          name default.bucketmapjoin_tmp_result
+                          serialization.ddl struct bucketmapjoin_tmp_result { string key, string value1, string value2}
+                          serialization.format 1
+                          serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                          transient_lastDdlTime 1310373280
+                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                        name: default.bucketmapjoin_tmp_result
+                    TotalFiles: 1
+                    GatherStats: true
+                    MultiFileSpray: false
       Local Work:
         Map Reduce Local Work
       Needs Tagging: false
@@ -550,20 +540,15 @@ STAGE PLANS:
           TableScan
             alias: a
             GatherStats: false
-            Filter Operator
-              isSamplingPred: false
-              predicate:
-                  expr: (ds = '2008-04-08')
-                  type: boolean
-              HashTable Sink Operator
-                condition expressions:
-                  0 {key} {value}
-                  1 {value}
-                handleSkewJoin: false
-                keys:
-                  0 [Column[key]]
-                  1 [Column[key]]
-                Position of Big Table: 1
+            HashTable Sink Operator
+              condition expressions:
+                0 {key} {value}
+                1 {value}
+              handleSkewJoin: false
+              keys:
+                0 [Column[key]]
+                1 [Column[key]]
+              Position of Big Table: 1
       Bucket Mapjoin Context:
           Alias Bucket Base File Name Mapping:
             a {srcbucket20.txt=[srcbucket22.txt], srcbucket21.txt=[srcbucket23.txt], srcbucket22.txt=[srcbucket22.txt], srcbucket23.txt=[srcbucket23.txt]}
@@ -582,23 +567,27 @@ STAGE PLANS:
           TableScan
             alias: b
             GatherStats: false
-            Filter Operator
-              isSamplingPred: false
-              predicate:
-                  expr: (ds = '2008-04-08')
-                  type: boolean
-              Map Join Operator
-                condition map:
-                     Inner Join 0 to 1
-                condition expressions:
-                  0 {key} {value}
-                  1 {value}
-                handleSkewJoin: false
-                keys:
-                  0 [Column[key]]
-                  1 [Column[key]]
+            Map Join Operator
+              condition map:
+                   Inner Join 0 to 1
+              condition expressions:
+                0 {key} {value}
+                1 {value}
+              handleSkewJoin: false
+              keys:
+                0 [Column[key]]
+                1 [Column[key]]
+              outputColumnNames: _col0, _col1, _col6
+              Position of Big Table: 1
+              Select Operator
+                expressions:
+                      expr: _col0
+                      type: int
+                      expr: _col1
+                      type: string
+                      expr: _col6
+                      type: string
                 outputColumnNames: _col0, _col1, _col6
-                Position of Big Table: 1
                 Select Operator
                   expressions:
                         expr: _col0
@@ -607,47 +596,38 @@ STAGE PLANS:
                         type: string
                         expr: _col6
                         type: string
-                  outputColumnNames: _col0, _col1, _col6
-                  Select Operator
-                    expressions:
-                          expr: _col0
-                          type: int
-                          expr: _col1
-                          type: string
-                          expr: _col6
-                          type: string
-                    outputColumnNames: _col0, _col1, _col2
-                    File Output Operator
-                      compressed: false
-                      GlobalTableId: 1
-                      directory: pfile:/data/users/tomasz/apache-hive/build/ql/scratchdir/hive_2011-06-01_18-46-45_810_5134529884228638664/-ext-10002
-                      NumFilesPerFileSink: 1
-                      Stats Publishing Key Prefix: pfile:/data/users/tomasz/apache-hive/build/ql/scratchdir/hive_2011-06-01_18-46-45_810_5134529884228638664/-ext-10000/
-                      table:
-                          input format: org.apache.hadoop.mapred.TextInputFormat
-                          output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                          properties:
-                            bucket_count -1
-                            columns key,value1,value2
-                            columns.types string:string:string
-                            file.inputformat org.apache.hadoop.mapred.TextInputFormat
-                            file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                            location pfile:/data/users/tomasz/apache-hive/build/ql/test/data/warehouse/bucketmapjoin_tmp_result
-                            name default.bucketmapjoin_tmp_result
-                            numFiles 1
-                            numPartitions 0
-                            numRows 564
-                            rawDataSize 10503
-                            serialization.ddl struct bucketmapjoin_tmp_result { string key, string value1, string value2}
-                            serialization.format 1
-                            serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                            totalSize 11067
-                            transient_lastDdlTime 1306979195
-                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                          name: default.bucketmapjoin_tmp_result
-                      TotalFiles: 1
-                      GatherStats: true
-                      MultiFileSpray: false
+                  outputColumnNames: _col0, _col1, _col2
+                  File Output Operator
+                    compressed: false
+                    GlobalTableId: 1
+                    directory: pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_01-35-06_760_1506759328569853293/-ext-10002
+                    NumFilesPerFileSink: 1
+                    Stats Publishing Key Prefix: pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_01-35-06_760_1506759328569853293/-ext-10000/
+                    table:
+                        input format: org.apache.hadoop.mapred.TextInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                        properties:
+                          bucket_count -1
+                          columns key,value1,value2
+                          columns.types string:string:string
+                          file.inputformat org.apache.hadoop.mapred.TextInputFormat
+                          file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                          location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/bucketmapjoin_tmp_result
+                          name default.bucketmapjoin_tmp_result
+                          numFiles 1
+                          numPartitions 0
+                          numRows 564
+                          rawDataSize 10503
+                          serialization.ddl struct bucketmapjoin_tmp_result { string key, string value1, string value2}
+                          serialization.format 1
+                          serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                          totalSize 11067
+                          transient_lastDdlTime 1310373297
+                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                        name: default.bucketmapjoin_tmp_result
+                    TotalFiles: 1
+                    GatherStats: true
+                    MultiFileSpray: false
       Local Work:
         Map Reduce Local Work
       Needs Tagging: false
diff --git a/ql/src/test/results/clientpositive/bucketmapjoin_negative.q.out b/ql/src/test/results/clientpositive/bucketmapjoin_negative.q.out
index 0fb476cccf..87455f9465 100644
--- a/ql/src/test/results/clientpositive/bucketmapjoin_negative.q.out
+++ b/ql/src/test/results/clientpositive/bucketmapjoin_negative.q.out
@@ -120,46 +120,41 @@ STAGE PLANS:
                       expr: _col6
                       type: string
                 outputColumnNames: _col0, _col1, _col5, _col6
-                Filter Operator
-                  isSamplingPred: false
-                  predicate:
-                      expr: (_col6 = '2008-04-08')
-                      type: boolean
-                  Select Operator
-                    expressions:
-                          expr: _col0
-                          type: int
-                          expr: _col1
-                          type: string
-                          expr: _col5
-                          type: string
-                    outputColumnNames: _col0, _col1, _col2
-                    File Output Operator
-                      compressed: false
-                      GlobalTableId: 1
-                      directory: pfile:/Users/krishnak/Projects/hdp/sources/hive-git-apache/build/ql/scratchdir/hive_2011-03-20_22-39-58_430_2374140411482084338/-ext-10002
-                      NumFilesPerFileSink: 1
-                      Stats Publishing Key Prefix: pfile:/Users/krishnak/Projects/hdp/sources/hive-git-apache/build/ql/scratchdir/hive_2011-03-20_22-39-58_430_2374140411482084338/-ext-10000/
-                      table:
-                          input format: org.apache.hadoop.mapred.TextInputFormat
-                          output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                          properties:
-                            bucket_count -1
-                            columns key,value1,value2
-                            columns.types string:string:string
-                            file.inputformat org.apache.hadoop.mapred.TextInputFormat
-                            file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                            location pfile:/Users/krishnak/Projects/hdp/sources/hive-git-apache/build/ql/test/data/warehouse/bucketmapjoin_tmp_result
-                            name default.bucketmapjoin_tmp_result
-                            serialization.ddl struct bucketmapjoin_tmp_result { string key, string value1, string value2}
-                            serialization.format 1
-                            serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                            transient_lastDdlTime 1300685998
-                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                          name: default.bucketmapjoin_tmp_result
-                      TotalFiles: 1
-                      GatherStats: true
-                      MultiFileSpray: false
+                Select Operator
+                  expressions:
+                        expr: _col0
+                        type: int
+                        expr: _col1
+                        type: string
+                        expr: _col5
+                        type: string
+                  outputColumnNames: _col0, _col1, _col2
+                  File Output Operator
+                    compressed: false
+                    GlobalTableId: 1
+                    directory: pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-03-23_03-48-35_145_7336188183229568049/-ext-10002
+                    NumFilesPerFileSink: 1
+                    Stats Publishing Key Prefix: pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-03-23_03-48-35_145_7336188183229568049/-ext-10000/
+                    table:
+                        input format: org.apache.hadoop.mapred.TextInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                        properties:
+                          bucket_count -1
+                          columns key,value1,value2
+                          columns.types string:string:string
+                          file.inputformat org.apache.hadoop.mapred.TextInputFormat
+                          file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                          location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/bucketmapjoin_tmp_result
+                          name default.bucketmapjoin_tmp_result
+                          serialization.ddl struct bucketmapjoin_tmp_result { string key, string value1, string value2}
+                          serialization.format 1
+                          serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                          transient_lastDdlTime 1300877315
+                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                        name: default.bucketmapjoin_tmp_result
+                    TotalFiles: 1
+                    GatherStats: true
+                    MultiFileSpray: false
       Local Work:
         Map Reduce Local Work
       Needs Tagging: false
diff --git a/ql/src/test/results/clientpositive/case_sensitivity.q.out b/ql/src/test/results/clientpositive/case_sensitivity.q.out
index 7b0f9539f5..007d1fffc4 100644
--- a/ql/src/test/results/clientpositive/case_sensitivity.q.out
+++ b/ql/src/test/results/clientpositive/case_sensitivity.q.out
@@ -33,25 +33,21 @@ STAGE PLANS:
               predicate:
                   expr: (lint[0] > 0)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (lint[0] > 0)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: lint[1]
-                        type: int
-                        expr: lintstring[0].MYSTRING
-                        type: string
-                  outputColumnNames: _col0, _col1
-                  File Output Operator
-                    compressed: false
-                    GlobalTableId: 1
-                    table:
-                        input format: org.apache.hadoop.mapred.TextInputFormat
-                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                        name: default.dest1
+              Select Operator
+                expressions:
+                      expr: lint[1]
+                      type: int
+                      expr: lintstring[0].MYSTRING
+                      type: string
+                outputColumnNames: _col0, _col1
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 1
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                      name: default.dest1
 
   Stage: Stage-5
     Conditional Operator
diff --git a/ql/src/test/results/clientpositive/cast1.q.out b/ql/src/test/results/clientpositive/cast1.q.out
index 037510bd0a..a4759232db 100644
--- a/ql/src/test/results/clientpositive/cast1.q.out
+++ b/ql/src/test/results/clientpositive/cast1.q.out
@@ -31,35 +31,31 @@ STAGE PLANS:
               predicate:
                   expr: (key = 86)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key = 86)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: (3 + 2)
-                        type: int
-                        expr: (3.0 + 2)
-                        type: double
-                        expr: (3 + 2.0)
-                        type: double
-                        expr: (3.0 + 2.0)
-                        type: double
-                        expr: ((3 + UDFToInteger(2.0)) + UDFToInteger(UDFToShort(0)))
-                        type: int
-                        expr: UDFToBoolean(1)
-                        type: boolean
-                        expr: UDFToInteger(true)
-                        type: int
-                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
-                  File Output Operator
-                    compressed: false
-                    GlobalTableId: 1
-                    table:
-                        input format: org.apache.hadoop.mapred.TextInputFormat
-                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                        name: default.dest1
+              Select Operator
+                expressions:
+                      expr: (3 + 2)
+                      type: int
+                      expr: (3.0 + 2)
+                      type: double
+                      expr: (3 + 2.0)
+                      type: double
+                      expr: (3.0 + 2.0)
+                      type: double
+                      expr: ((3 + UDFToInteger(2.0)) + UDFToInteger(UDFToShort(0)))
+                      type: int
+                      expr: UDFToBoolean(1)
+                      type: boolean
+                      expr: UDFToInteger(true)
+                      type: int
+                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 1
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                      name: default.dest1
 
   Stage: Stage-5
     Conditional Operator
diff --git a/ql/src/test/results/clientpositive/cluster.q.out b/ql/src/test/results/clientpositive/cluster.q.out
index 2897ba185a..7b074bddc1 100644
--- a/ql/src/test/results/clientpositive/cluster.q.out
+++ b/ql/src/test/results/clientpositive/cluster.q.out
@@ -22,31 +22,27 @@ STAGE PLANS:
               predicate:
                   expr: (key = 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key = 10)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
                         type: string
-                        expr: value
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: -1
+                  value expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: -1
-                    value expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
       Reduce Operator Tree:
         Extract
           File Output Operator
@@ -94,31 +90,27 @@ STAGE PLANS:
               predicate:
                   expr: (key = 20)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key = 20)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
                         type: string
-                        expr: value
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: -1
+                  value expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: -1
-                    value expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
       Reduce Operator Tree:
         Extract
           File Output Operator
@@ -166,31 +158,27 @@ STAGE PLANS:
               predicate:
                   expr: (key = 20)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key = 20)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
                         type: string
-                        expr: value
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: -1
+                  value expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: -1
-                    value expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
       Reduce Operator Tree:
         Extract
           File Output Operator
@@ -238,31 +226,27 @@ STAGE PLANS:
               predicate:
                   expr: (key = 20)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key = 20)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
                         type: string
-                        expr: value
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: -1
+                  value expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: -1
-                    value expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
       Reduce Operator Tree:
         Extract
           File Output Operator
@@ -310,31 +294,27 @@ STAGE PLANS:
               predicate:
                   expr: (key = 20)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key = 20)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
                         type: string
-                        expr: value
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: -1
+                  value expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: -1
-                    value expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
       Reduce Operator Tree:
         Extract
           File Output Operator
@@ -382,31 +362,27 @@ STAGE PLANS:
               predicate:
                   expr: (key = 20)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key = 20)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
                         type: string
-                        expr: value
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: -1
+                  value expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: -1
-                    value expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
       Reduce Operator Tree:
         Extract
           File Output Operator
@@ -454,31 +430,27 @@ STAGE PLANS:
               predicate:
                   expr: (key = 20)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key = 20)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col1
                         type: string
-                        expr: value
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col1
+                        type: string
+                  tag: -1
+                  value expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col1
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col1
-                          type: string
-                    tag: -1
-                    value expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
       Reduce Operator Tree:
         Extract
           File Output Operator
@@ -640,25 +612,21 @@ STAGE PLANS:
             1 {VALUE._col0}
           handleSkewJoin: false
           outputColumnNames: _col0, _col1, _col4
-          Filter Operator
-            predicate:
-                expr: (_col0 = 20)
-                type: boolean
-            Select Operator
-              expressions:
-                    expr: _col0
-                    type: string
-                    expr: _col1
-                    type: string
-                    expr: _col4
-                    type: string
-              outputColumnNames: _col0, _col1, _col2
-              File Output Operator
-                compressed: false
-                GlobalTableId: 0
-                table:
-                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
-                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+          Select Operator
+            expressions:
+                  expr: _col0
+                  type: string
+                  expr: _col1
+                  type: string
+                  expr: _col4
+                  type: string
+            outputColumnNames: _col0, _col1, _col2
+            File Output Operator
+              compressed: false
+              GlobalTableId: 0
+              table:
+                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
 
   Stage: Stage-2
     Map Reduce
@@ -768,27 +736,23 @@ STAGE PLANS:
             1 {VALUE._col0} {VALUE._col1}
           handleSkewJoin: false
           outputColumnNames: _col0, _col1, _col4, _col5
-          Filter Operator
-            predicate:
-                expr: (_col0 = 20)
-                type: boolean
-            Select Operator
-              expressions:
-                    expr: _col0
-                    type: string
-                    expr: _col1
-                    type: string
-                    expr: _col4
-                    type: string
-                    expr: _col5
-                    type: string
-              outputColumnNames: _col0, _col1, _col2, _col3
-              File Output Operator
-                compressed: false
-                GlobalTableId: 0
-                table:
-                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
-                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+          Select Operator
+            expressions:
+                  expr: _col0
+                  type: string
+                  expr: _col1
+                  type: string
+                  expr: _col4
+                  type: string
+                  expr: _col5
+                  type: string
+            outputColumnNames: _col0, _col1, _col2, _col3
+            File Output Operator
+              compressed: false
+              GlobalTableId: 0
+              table:
+                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
 
   Stage: Stage-2
     Map Reduce
@@ -900,27 +864,23 @@ STAGE PLANS:
             1 {VALUE._col0} {VALUE._col1}
           handleSkewJoin: false
           outputColumnNames: _col0, _col1, _col4, _col5
-          Filter Operator
-            predicate:
-                expr: (_col0 = 20)
-                type: boolean
-            Select Operator
-              expressions:
-                    expr: _col0
-                    type: string
-                    expr: _col1
-                    type: string
-                    expr: _col4
-                    type: string
-                    expr: _col5
-                    type: string
-              outputColumnNames: _col0, _col1, _col2, _col3
-              File Output Operator
-                compressed: false
-                GlobalTableId: 0
-                table:
-                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
-                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+          Select Operator
+            expressions:
+                  expr: _col0
+                  type: string
+                  expr: _col1
+                  type: string
+                  expr: _col4
+                  type: string
+                  expr: _col5
+                  type: string
+            outputColumnNames: _col0, _col1, _col2, _col3
+            File Output Operator
+              compressed: false
+              GlobalTableId: 0
+              table:
+                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
 
   Stage: Stage-2
     Map Reduce
@@ -1030,25 +990,21 @@ STAGE PLANS:
             1 {VALUE._col0}
           handleSkewJoin: false
           outputColumnNames: _col0, _col1, _col4
-          Filter Operator
-            predicate:
-                expr: (_col0 = 20)
-                type: boolean
-            Select Operator
-              expressions:
-                    expr: _col0
-                    type: string
-                    expr: _col1
-                    type: string
-                    expr: _col4
-                    type: string
-              outputColumnNames: _col0, _col1, _col2
-              File Output Operator
-                compressed: false
-                GlobalTableId: 0
-                table:
-                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
-                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+          Select Operator
+            expressions:
+                  expr: _col0
+                  type: string
+                  expr: _col1
+                  type: string
+                  expr: _col4
+                  type: string
+            outputColumnNames: _col0, _col1, _col2
+            File Output Operator
+              compressed: false
+              GlobalTableId: 0
+              table:
+                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
 
   Stage: Stage-2
     Map Reduce
@@ -1129,39 +1085,35 @@ STAGE PLANS:
               predicate:
                   expr: (key < 100)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 100)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
-                  outputColumnNames: _col0, _col1
-                  Union
-                    Select Operator
-                      expressions:
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Union
+                  Select Operator
+                    expressions:
+                          expr: _col0
+                          type: string
+                          expr: _col1
+                          type: string
+                    outputColumnNames: _col0, _col1
+                    Reduce Output Operator
+                      key expressions:
+                            expr: _col0
+                            type: string
+                      sort order: +
+                      Map-reduce partition columns:
+                            expr: _col0
+                            type: string
+                      tag: -1
+                      value expressions:
                             expr: _col0
                             type: string
                             expr: _col1
                             type: string
-                      outputColumnNames: _col0, _col1
-                      Reduce Output Operator
-                        key expressions:
-                              expr: _col0
-                              type: string
-                        sort order: +
-                        Map-reduce partition columns:
-                              expr: _col0
-                              type: string
-                        tag: -1
-                        value expressions:
-                              expr: _col0
-                              type: string
-                              expr: _col1
-                              type: string
         null-subquery2:unioninput-subquery2:src 
           TableScan
             alias: src
@@ -1169,39 +1121,35 @@ STAGE PLANS:
               predicate:
                   expr: (key > 100)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key > 100)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
-                  outputColumnNames: _col0, _col1
-                  Union
-                    Select Operator
-                      expressions:
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Union
+                  Select Operator
+                    expressions:
+                          expr: _col0
+                          type: string
+                          expr: _col1
+                          type: string
+                    outputColumnNames: _col0, _col1
+                    Reduce Output Operator
+                      key expressions:
+                            expr: _col0
+                            type: string
+                      sort order: +
+                      Map-reduce partition columns:
+                            expr: _col0
+                            type: string
+                      tag: -1
+                      value expressions:
                             expr: _col0
                             type: string
                             expr: _col1
                             type: string
-                      outputColumnNames: _col0, _col1
-                      Reduce Output Operator
-                        key expressions:
-                              expr: _col0
-                              type: string
-                        sort order: +
-                        Map-reduce partition columns:
-                              expr: _col0
-                              type: string
-                        tag: -1
-                        value expressions:
-                              expr: _col0
-                              type: string
-                              expr: _col1
-                              type: string
       Reduce Operator Tree:
         Extract
           File Output Operator
diff --git a/ql/src/test/results/clientpositive/combine2.q.out b/ql/src/test/results/clientpositive/combine2.q.out
index 5d212eb36a..4432d44e7a 100644
--- a/ql/src/test/results/clientpositive/combine2.q.out
+++ b/ql/src/test/results/clientpositive/combine2.q.out
@@ -86,28 +86,24 @@ STAGE PLANS:
         combine2 
           TableScan
             alias: combine2
-            Filter Operator
-              predicate:
-                  expr: value is not null
-                  type: boolean
-              Select Operator
-                expressions:
-                      expr: key
+            Select Operator
+              expressions:
+                    expr: key
+                    type: string
+                    expr: value
+                    type: string
+              outputColumnNames: _col0, _col1
+              Reduce Output Operator
+                key expressions:
+                      expr: _col0
                       type: string
-                      expr: value
+                sort order: +
+                tag: -1
+                value expressions:
+                      expr: _col0
+                      type: string
+                      expr: _col1
                       type: string
-                outputColumnNames: _col0, _col1
-                Reduce Output Operator
-                  key expressions:
-                        expr: _col0
-                        type: string
-                  sort order: +
-                  tag: -1
-                  value expressions:
-                        expr: _col0
-                        type: string
-                        expr: _col1
-                        type: string
       Reduce Operator Tree:
         Extract
           File Output Operator
@@ -193,24 +189,19 @@ STAGE PLANS:
           TableScan
             alias: combine2
             GatherStats: false
-            Filter Operator
-              isSamplingPred: false
-              predicate:
-                  expr: value is not null
-                  type: boolean
-              Select Operator
-                Group By Operator
-                  aggregations:
-                        expr: count(1)
-                  bucketGroup: false
-                  mode: hash
-                  outputColumnNames: _col0
-                  Reduce Output Operator
-                    sort order: 
-                    tag: -1
-                    value expressions:
-                          expr: _col0
-                          type: bigint
+            Select Operator
+              Group By Operator
+                aggregations:
+                      expr: count(1)
+                bucketGroup: false
+                mode: hash
+                outputColumnNames: _col0
+                Reduce Output Operator
+                  sort order: 
+                  tag: -1
+                  value expressions:
+                        expr: _col0
+                        type: bigint
       Needs Tagging: false
       Path -> Alias:
         pfile:/data/users/tomasz/apache-hive/build/ql/test/data/warehouse/combine2/value=2010-04-21 09%3A45%3A00 [combine2]
@@ -715,36 +706,32 @@ STAGE PLANS:
         srcpart 
           TableScan
             alias: srcpart
-            Filter Operator
-              predicate:
-                  expr: ds is not null
-                  type: boolean
-              Select Operator
-                expressions:
+            Select Operator
+              expressions:
+                    expr: ds
+                    type: string
+              outputColumnNames: ds
+              Group By Operator
+                aggregations:
+                      expr: count(1)
+                bucketGroup: false
+                keys:
                       expr: ds
                       type: string
-                outputColumnNames: ds
-                Group By Operator
-                  aggregations:
-                        expr: count(1)
-                  bucketGroup: false
-                  keys:
-                        expr: ds
+                mode: hash
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
                         type: string
-                  mode: hash
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: -1
-                    value expressions:
-                          expr: _col1
-                          type: bigint
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: -1
+                  value expressions:
+                        expr: _col1
+                        type: bigint
       Reduce Operator Tree:
         Group By Operator
           aggregations:
diff --git a/ql/src/test/results/clientpositive/create_view.q.out b/ql/src/test/results/clientpositive/create_view.q.out
index 9d6c88102e..52ad165bdf 100644
--- a/ql/src/test/results/clientpositive/create_view.q.out
+++ b/ql/src/test/results/clientpositive/create_view.q.out
@@ -194,23 +194,19 @@ STAGE PLANS:
                       expr: value
                       type: string
                 outputColumnNames: _col0, _col1
-                Filter Operator
-                  predicate:
-                      expr: (_col0 = 18)
-                      type: boolean
-                  Select Operator
-                    expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
-                    outputColumnNames: _col0, _col1
-                    File Output Operator
-                      compressed: false
-                      GlobalTableId: 0
-                      table:
-                          input format: org.apache.hadoop.mapred.TextInputFormat
-                          output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                Select Operator
+                  expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col1
+                        type: string
+                  outputColumnNames: _col0, _col1
+                  File Output Operator
+                    compressed: false
+                    GlobalTableId: 0
+                    table:
+                        input format: org.apache.hadoop.mapred.TextInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
 
   Stage: Stage-0
     Fetch Operator
diff --git a/ql/src/test/results/clientpositive/disable_merge_for_bucketing.q.out b/ql/src/test/results/clientpositive/disable_merge_for_bucketing.q.out
index e92f3cfbd9..1655dc8058 100644
--- a/ql/src/test/results/clientpositive/disable_merge_for_bucketing.q.out
+++ b/ql/src/test/results/clientpositive/disable_merge_for_bucketing.q.out
@@ -190,28 +190,24 @@ STAGE PLANS:
               predicate:
                   expr: (((hash(key) & 2147483647) % 2) = 0)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (((hash(key) & 2147483647) % 2) = 0)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: int
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: int
+                  sort order: +
+                  tag: -1
+                  value expressions:
+                        expr: _col0
                         type: int
-                        expr: value
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: int
-                    sort order: +
-                    tag: -1
-                    value expressions:
-                          expr: _col0
-                          type: int
-                          expr: _col1
-                          type: string
       Reduce Operator Tree:
         Extract
           File Output Operator
diff --git a/ql/src/test/results/clientpositive/filter_join_breaktask.q.out b/ql/src/test/results/clientpositive/filter_join_breaktask.q.out
index e29e5cce14..33e156f0fd 100644
--- a/ql/src/test/results/clientpositive/filter_join_breaktask.q.out
+++ b/ql/src/test/results/clientpositive/filter_join_breaktask.q.out
@@ -48,28 +48,18 @@ STAGE PLANS:
               predicate:
                   expr: key is not null
                   type: boolean
-              Filter Operator
-                isSamplingPred: false
-                predicate:
-                    expr: (ds = '2008-04-08')
-                    type: boolean
-                Filter Operator
-                  isSamplingPred: false
-                  predicate:
-                      expr: key is not null
-                      type: boolean
-                  Reduce Output Operator
-                    key expressions:
-                          expr: key
-                          type: int
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: key
-                          type: int
-                    tag: 0
-                    value expressions:
-                          expr: key
-                          type: int
+              Reduce Output Operator
+                key expressions:
+                      expr: key
+                      type: int
+                sort order: +
+                Map-reduce partition columns:
+                      expr: key
+                      type: int
+                tag: 0
+                value expressions:
+                      expr: key
+                      type: int
         m 
           TableScan
             alias: m
@@ -79,25 +69,20 @@ STAGE PLANS:
               predicate:
                   expr: (value is not null and (value <> ''))
                   type: boolean
-              Filter Operator
-                isSamplingPred: false
-                predicate:
-                    expr: (ds = '2008-04-08')
-                    type: boolean
-                Reduce Output Operator
-                  key expressions:
-                        expr: key
-                        type: int
-                  sort order: +
-                  Map-reduce partition columns:
-                        expr: key
-                        type: int
-                  tag: 1
-                  value expressions:
-                        expr: value
-                        type: string
-                        expr: ds
-                        type: string
+              Reduce Output Operator
+                key expressions:
+                      expr: key
+                      type: int
+                sort order: +
+                Map-reduce partition columns:
+                      expr: key
+                      type: int
+                tag: 1
+                value expressions:
+                      expr: value
+                      type: string
+                      expr: ds
+                      type: string
       Needs Tagging: true
       Path -> Alias:
         pfile:/data/users/tomasz/apache-hive/build/ql/test/data/warehouse/filter_join_breaktask/ds=2008-04-08 [f, m]
@@ -161,36 +146,21 @@ STAGE PLANS:
             1 {VALUE._col1} {VALUE._col2}
           handleSkewJoin: false
           outputColumnNames: _col0, _col6, _col7
-          Filter Operator
-            isSamplingPred: false
-            predicate:
-                expr: (_col7 = '2008-04-08')
-                type: boolean
-            Filter Operator
-              isSamplingPred: false
-              predicate:
-                  expr: _col6 is not null
-                  type: boolean
-              Filter Operator
-                isSamplingPred: false
-                predicate:
-                    expr: (_col6 <> '')
-                    type: boolean
-                File Output Operator
-                  compressed: false
-                  GlobalTableId: 0
-                  directory: file:/tmp/tomasz/hive_2011-06-01_19-00-51_695_3409169030364207424/-mr-10002
-                  NumFilesPerFileSink: 1
-                  table:
-                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
-                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
-                      properties:
-                        columns _col0,_col6
-                        columns.types int,string
-                        escape.delim \
-                  TotalFiles: 1
-                  GatherStats: false
-                  MultiFileSpray: false
+          File Output Operator
+            compressed: false
+            GlobalTableId: 0
+            directory: file:/tmp/amarsri/hive_2011-07-11_01-46-22_446_957936931018191228/-mr-10002
+            NumFilesPerFileSink: 1
+            table:
+                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+                properties:
+                  columns _col0,_col6,_col7
+                  columns.types int,string,string
+                  escape.delim \
+            TotalFiles: 1
+            GatherStats: false
+            MultiFileSpray: false
 
   Stage: Stage-2
     Map Reduce
@@ -212,23 +182,18 @@ STAGE PLANS:
           TableScan
             alias: g
             GatherStats: false
-            Filter Operator
-              isSamplingPred: false
-              predicate:
-                  expr: (ds = '2008-04-08')
-                  type: boolean
-              Reduce Output Operator
-                key expressions:
-                      expr: value
-                      type: string
-                sort order: +
-                Map-reduce partition columns:
-                      expr: value
-                      type: string
-                tag: 1
-                value expressions:
-                      expr: value
-                      type: string
+            Reduce Output Operator
+              key expressions:
+                    expr: value
+                    type: string
+              sort order: +
+              Map-reduce partition columns:
+                    expr: value
+                    type: string
+              tag: 1
+              value expressions:
+                    expr: value
+                    type: string
       Needs Tagging: true
       Path -> Alias:
         file:/tmp/tomasz/hive_2011-06-01_19-00-51_695_3409169030364207424/-mr-10002 [$INTNAME]
@@ -240,15 +205,15 @@ STAGE PLANS:
             input format: org.apache.hadoop.mapred.SequenceFileInputFormat
             output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
             properties:
-              columns _col0,_col6
-              columns.types int,string
+              columns _col0,_col6,_col7
+              columns.types int,string,string
               escape.delim \
           
               input format: org.apache.hadoop.mapred.SequenceFileInputFormat
               output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
               properties:
-                columns _col0,_col6
-                columns.types int,string
+                columns _col0,_col6,_col7
+                columns.types int,string,string
                 escape.delim \
         pfile:/data/users/tomasz/apache-hive/build/ql/test/data/warehouse/filter_join_breaktask/ds=2008-04-08 
           Partition
diff --git a/ql/src/test/results/clientpositive/groupby_map_ppr.q.out b/ql/src/test/results/clientpositive/groupby_map_ppr.q.out
index 43add857dd..a8c33c5f9e 100644
--- a/ql/src/test/results/clientpositive/groupby_map_ppr.q.out
+++ b/ql/src/test/results/clientpositive/groupby_map_ppr.q.out
@@ -33,46 +33,41 @@ STAGE PLANS:
           TableScan
             alias: src
             GatherStats: false
-            Filter Operator
-              isSamplingPred: false
-              predicate:
-                  expr: (ds = '2008-04-08')
-                  type: boolean
-              Select Operator
-                expressions:
-                      expr: key
+            Select Operator
+              expressions:
+                    expr: key
+                    type: string
+                    expr: value
+                    type: string
+              outputColumnNames: key, value
+              Group By Operator
+                aggregations:
+                      expr: count(DISTINCT substr(value, 5))
+                      expr: sum(substr(value, 5))
+                bucketGroup: false
+                keys:
+                      expr: substr(key, 1, 1)
                       type: string
-                      expr: value
+                      expr: substr(value, 5)
                       type: string
-                outputColumnNames: key, value
-                Group By Operator
-                  aggregations:
-                        expr: count(DISTINCT substr(value, 5))
-                        expr: sum(substr(value, 5))
-                  bucketGroup: false
-                  keys:
-                        expr: substr(key, 1, 1)
+                mode: hash
+                outputColumnNames: _col0, _col1, _col2, _col3
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col1
                         type: string
-                        expr: substr(value, 5)
+                  sort order: ++
+                  Map-reduce partition columns:
+                        expr: _col0
                         type: string
-                  mode: hash
-                  outputColumnNames: _col0, _col1, _col2, _col3
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
-                    sort order: ++
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: -1
-                    value expressions:
-                          expr: _col2
-                          type: bigint
-                          expr: _col3
-                          type: double
+                  tag: -1
+                  value expressions:
+                        expr: _col2
+                        type: bigint
+                        expr: _col3
+                        type: double
       Needs Tagging: false
       Path -> Alias:
         pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 [src]
diff --git a/ql/src/test/results/clientpositive/groupby_map_ppr_multi_distinct.q.out b/ql/src/test/results/clientpositive/groupby_map_ppr_multi_distinct.q.out
index 7160817cc5..7465063869 100644
--- a/ql/src/test/results/clientpositive/groupby_map_ppr_multi_distinct.q.out
+++ b/ql/src/test/results/clientpositive/groupby_map_ppr_multi_distinct.q.out
@@ -33,56 +33,51 @@ STAGE PLANS:
           TableScan
             alias: src
             GatherStats: false
-            Filter Operator
-              isSamplingPred: false
-              predicate:
-                  expr: (ds = '2008-04-08')
-                  type: boolean
-              Select Operator
-                expressions:
-                      expr: key
+            Select Operator
+              expressions:
+                    expr: key
+                    type: string
+                    expr: value
+                    type: string
+              outputColumnNames: key, value
+              Group By Operator
+                aggregations:
+                      expr: count(DISTINCT substr(value, 5))
+                      expr: sum(substr(value, 5))
+                      expr: sum(DISTINCT substr(value, 5))
+                      expr: count(DISTINCT value)
+                bucketGroup: false
+                keys:
+                      expr: substr(key, 1, 1)
+                      type: string
+                      expr: substr(value, 5)
                       type: string
                       expr: value
                       type: string
-                outputColumnNames: key, value
-                Group By Operator
-                  aggregations:
-                        expr: count(DISTINCT substr(value, 5))
-                        expr: sum(substr(value, 5))
-                        expr: sum(DISTINCT substr(value, 5))
-                        expr: count(DISTINCT value)
-                  bucketGroup: false
-                  keys:
-                        expr: substr(key, 1, 1)
+                mode: hash
+                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col1
                         type: string
-                        expr: substr(value, 5)
+                        expr: _col2
                         type: string
-                        expr: value
+                  sort order: +++
+                  Map-reduce partition columns:
+                        expr: _col0
                         type: string
-                  mode: hash
-                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
-                          expr: _col2
-                          type: string
-                    sort order: +++
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: -1
-                    value expressions:
-                          expr: _col3
-                          type: bigint
-                          expr: _col4
-                          type: double
-                          expr: _col5
-                          type: double
-                          expr: _col6
-                          type: bigint
+                  tag: -1
+                  value expressions:
+                        expr: _col3
+                        type: bigint
+                        expr: _col4
+                        type: double
+                        expr: _col5
+                        type: double
+                        expr: _col6
+                        type: bigint
       Needs Tagging: false
       Path -> Alias:
         pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 [src]
diff --git a/ql/src/test/results/clientpositive/groupby_ppr.q.out b/ql/src/test/results/clientpositive/groupby_ppr.q.out
index eb33d2ee3e..3839cbb669 100644
--- a/ql/src/test/results/clientpositive/groupby_ppr.q.out
+++ b/ql/src/test/results/clientpositive/groupby_ppr.q.out
@@ -33,29 +33,24 @@ STAGE PLANS:
           TableScan
             alias: src
             GatherStats: false
-            Filter Operator
-              isSamplingPred: false
-              predicate:
-                  expr: (ds = '2008-04-08')
-                  type: boolean
-              Select Operator
-                expressions:
-                      expr: key
+            Select Operator
+              expressions:
+                    expr: key
+                    type: string
+                    expr: value
+                    type: string
+              outputColumnNames: key, value
+              Reduce Output Operator
+                key expressions:
+                      expr: substr(key, 1, 1)
+                      type: string
+                      expr: substr(value, 5)
                       type: string
-                      expr: value
+                sort order: ++
+                Map-reduce partition columns:
+                      expr: substr(key, 1, 1)
                       type: string
-                outputColumnNames: key, value
-                Reduce Output Operator
-                  key expressions:
-                        expr: substr(key, 1, 1)
-                        type: string
-                        expr: substr(value, 5)
-                        type: string
-                  sort order: ++
-                  Map-reduce partition columns:
-                        expr: substr(key, 1, 1)
-                        type: string
-                  tag: -1
+                tag: -1
       Needs Tagging: false
       Path -> Alias:
         pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 [src]
diff --git a/ql/src/test/results/clientpositive/groupby_ppr_multi_distinct.q.out b/ql/src/test/results/clientpositive/groupby_ppr_multi_distinct.q.out
index 2d5628b4f2..17d0e7fedc 100644
--- a/ql/src/test/results/clientpositive/groupby_ppr_multi_distinct.q.out
+++ b/ql/src/test/results/clientpositive/groupby_ppr_multi_distinct.q.out
@@ -33,31 +33,26 @@ STAGE PLANS:
           TableScan
             alias: src
             GatherStats: false
-            Filter Operator
-              isSamplingPred: false
-              predicate:
-                  expr: (ds = '2008-04-08')
-                  type: boolean
-              Select Operator
-                expressions:
-                      expr: key
+            Select Operator
+              expressions:
+                    expr: key
+                    type: string
+                    expr: value
+                    type: string
+              outputColumnNames: key, value
+              Reduce Output Operator
+                key expressions:
+                      expr: substr(key, 1, 1)
+                      type: string
+                      expr: substr(value, 5)
                       type: string
                       expr: value
                       type: string
-                outputColumnNames: key, value
-                Reduce Output Operator
-                  key expressions:
-                        expr: substr(key, 1, 1)
-                        type: string
-                        expr: substr(value, 5)
-                        type: string
-                        expr: value
-                        type: string
-                  sort order: +++
-                  Map-reduce partition columns:
-                        expr: substr(key, 1, 1)
-                        type: string
-                  tag: -1
+                sort order: +++
+                Map-reduce partition columns:
+                      expr: substr(key, 1, 1)
+                      type: string
+                tag: -1
       Needs Tagging: false
       Path -> Alias:
         pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 [src]
diff --git a/ql/src/test/results/clientpositive/having.q.out b/ql/src/test/results/clientpositive/having.q.out
index 9c307869da..b36787a7ba 100644
--- a/ql/src/test/results/clientpositive/having.q.out
+++ b/ql/src/test/results/clientpositive/having.q.out
@@ -153,23 +153,19 @@ STAGE PLANS:
                 type: string
           mode: mergepartial
           outputColumnNames: _col0, _col1
-          Filter Operator
-            predicate:
-                expr: (_col0 <> 302)
-                type: boolean
-            Select Operator
-              expressions:
-                    expr: _col0
-                    type: string
-                    expr: _col1
-                    type: string
-              outputColumnNames: _col0, _col1
-              File Output Operator
-                compressed: false
-                GlobalTableId: 0
-                table:
-                    input format: org.apache.hadoop.mapred.TextInputFormat
-                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+          Select Operator
+            expressions:
+                  expr: _col0
+                  type: string
+                  expr: _col1
+                  type: string
+            outputColumnNames: _col0, _col1
+            File Output Operator
+              compressed: false
+              GlobalTableId: 0
+              table:
+                  input format: org.apache.hadoop.mapred.TextInputFormat
+                  output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
 
   Stage: Stage-0
     Fetch Operator
@@ -798,38 +794,34 @@ STAGE PLANS:
               predicate:
                   expr: (key > 300)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key > 300)
-                    type: boolean
-                Select Operator
-                  expressions:
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: key, value
+                Group By Operator
+                  aggregations:
+                        expr: max(value)
+                  bucketGroup: false
+                  keys:
                         expr: key
                         type: string
-                        expr: value
-                        type: string
-                  outputColumnNames: key, value
-                  Group By Operator
-                    aggregations:
-                          expr: max(value)
-                    bucketGroup: false
-                    keys:
-                          expr: key
+                  mode: hash
+                  outputColumnNames: _col0, _col1
+                  Reduce Output Operator
+                    key expressions:
+                          expr: _col0
+                          type: string
+                    sort order: +
+                    Map-reduce partition columns:
+                          expr: _col0
+                          type: string
+                    tag: -1
+                    value expressions:
+                          expr: _col1
                           type: string
-                    mode: hash
-                    outputColumnNames: _col0, _col1
-                    Reduce Output Operator
-                      key expressions:
-                            expr: _col0
-                            type: string
-                      sort order: +
-                      Map-reduce partition columns:
-                            expr: _col0
-                            type: string
-                      tag: -1
-                      value expressions:
-                            expr: _col1
-                            type: string
       Reduce Operator Tree:
         Group By Operator
           aggregations:
diff --git a/ql/src/test/results/clientpositive/implicit_cast1.q.out b/ql/src/test/results/clientpositive/implicit_cast1.q.out
index d8d88d3eef..9c7e9811e3 100644
--- a/ql/src/test/results/clientpositive/implicit_cast1.q.out
+++ b/ql/src/test/results/clientpositive/implicit_cast1.q.out
@@ -31,23 +31,19 @@ STAGE PLANS:
               predicate:
                   expr: (a <> 0)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (a <> 0)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: a
-                        type: bigint
-                        expr: b
-                        type: string
-                  outputColumnNames: _col0, _col1
-                  File Output Operator
-                    compressed: false
-                    GlobalTableId: 0
-                    table:
-                        input format: org.apache.hadoop.mapred.TextInputFormat
-                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+              Select Operator
+                expressions:
+                      expr: a
+                      type: bigint
+                      expr: b
+                      type: string
+                outputColumnNames: _col0, _col1
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 0
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
 
   Stage: Stage-0
     Fetch Operator
diff --git a/ql/src/test/results/clientpositive/index_auto.q.out b/ql/src/test/results/clientpositive/index_auto.q.out
index 222db34387..8d65f984e8 100644
--- a/ql/src/test/results/clientpositive/index_auto.q.out
+++ b/ql/src/test/results/clientpositive/index_auto.q.out
@@ -84,28 +84,24 @@ STAGE PLANS:
               predicate:
                   expr: ((key > 80) and (key < 100))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: ((key > 80) and (key < 100))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
                         type: string
-                        expr: value
+                  sort order: +
+                  tag: -1
+                  value expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    tag: -1
-                    value expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
       Reduce Operator Tree:
         Extract
           File Output Operator
@@ -185,23 +181,19 @@ STAGE PLANS:
               predicate:
                   expr: ((key > 80) and (key < 100))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: ((key > 80) and (key < 100))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: _bucketname
-                        type: string
-                        expr: _offsets
-                        type: array<bigint>
-                  outputColumnNames: _col0, _col1
-                  File Output Operator
-                    compressed: false
-                    GlobalTableId: 1
-                    table:
-                        input format: org.apache.hadoop.mapred.TextInputFormat
-                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+              Select Operator
+                expressions:
+                      expr: _bucketname
+                      type: string
+                      expr: _offsets
+                      type: array<bigint>
+                outputColumnNames: _col0, _col1
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 1
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
 
   Stage: Stage-6
     Conditional Operator
@@ -231,28 +223,24 @@ STAGE PLANS:
               predicate:
                   expr: ((key > 80) and (key < 100))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: ((key > 80) and (key < 100))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                  sort order: +
+                  tag: -1
+                  value expressions:
+                        expr: _col0
                         type: string
-                        expr: value
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    tag: -1
-                    value expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
       Reduce Operator Tree:
         Extract
           File Output Operator
diff --git a/ql/src/test/results/clientpositive/index_auto_file_format.q.out b/ql/src/test/results/clientpositive/index_auto_file_format.q.out
index 8430296971..194b35e48b 100644
--- a/ql/src/test/results/clientpositive/index_auto_file_format.q.out
+++ b/ql/src/test/results/clientpositive/index_auto_file_format.q.out
@@ -48,23 +48,19 @@ STAGE PLANS:
               predicate:
                   expr: (key = 86)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key = 86)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: _bucketname
-                        type: string
-                        expr: _offsets
-                        type: array<bigint>
-                  outputColumnNames: _col0, _col1
-                  File Output Operator
-                    compressed: false
-                    GlobalTableId: 1
-                    table:
-                        input format: org.apache.hadoop.mapred.TextInputFormat
-                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+              Select Operator
+                expressions:
+                      expr: _bucketname
+                      type: string
+                      expr: _offsets
+                      type: array<bigint>
+                outputColumnNames: _col0, _col1
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 1
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
 
   Stage: Stage-6
     Conditional Operator
@@ -94,28 +90,24 @@ STAGE PLANS:
               predicate:
                   expr: (key = 86)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key = 86)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                  sort order: +
+                  tag: -1
+                  value expressions:
+                        expr: _col0
                         type: string
-                        expr: value
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    tag: -1
-                    value expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
       Reduce Operator Tree:
         Extract
           File Output Operator
@@ -188,23 +180,19 @@ STAGE PLANS:
               predicate:
                   expr: (key = 86)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key = 86)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: _bucketname
-                        type: string
-                        expr: _offsets
-                        type: array<bigint>
-                  outputColumnNames: _col0, _col1
-                  File Output Operator
-                    compressed: false
-                    GlobalTableId: 1
-                    table:
-                        input format: org.apache.hadoop.mapred.TextInputFormat
-                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+              Select Operator
+                expressions:
+                      expr: _bucketname
+                      type: string
+                      expr: _offsets
+                      type: array<bigint>
+                outputColumnNames: _col0, _col1
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 1
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
 
   Stage: Stage-6
     Conditional Operator
@@ -234,28 +222,24 @@ STAGE PLANS:
               predicate:
                   expr: (key = 86)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key = 86)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                  sort order: +
+                  tag: -1
+                  value expressions:
+                        expr: _col0
                         type: string
-                        expr: value
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    tag: -1
-                    value expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
       Reduce Operator Tree:
         Extract
           File Output Operator
diff --git a/ql/src/test/results/clientpositive/index_auto_multiple.q.out b/ql/src/test/results/clientpositive/index_auto_multiple.q.out
index 28add9f08a..6b81fc33a7 100644
--- a/ql/src/test/results/clientpositive/index_auto_multiple.q.out
+++ b/ql/src/test/results/clientpositive/index_auto_multiple.q.out
@@ -71,23 +71,19 @@ STAGE PLANS:
               predicate:
                   expr: (key = 86)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key = 86)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: _bucketname
-                        type: string
-                        expr: _offsets
-                        type: array<bigint>
-                  outputColumnNames: _col0, _col1
-                  File Output Operator
-                    compressed: false
-                    GlobalTableId: 1
-                    table:
-                        input format: org.apache.hadoop.mapred.TextInputFormat
-                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+              Select Operator
+                expressions:
+                      expr: _bucketname
+                      type: string
+                      expr: _offsets
+                      type: array<bigint>
+                outputColumnNames: _col0, _col1
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 1
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
 
   Stage: Stage-6
     Conditional Operator
@@ -117,28 +113,24 @@ STAGE PLANS:
               predicate:
                   expr: (key = 86)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key = 86)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                  sort order: +
+                  tag: -1
+                  value expressions:
+                        expr: _col0
                         type: string
-                        expr: value
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    tag: -1
-                    value expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
       Reduce Operator Tree:
         Extract
           File Output Operator
diff --git a/ql/src/test/results/clientpositive/index_auto_partitioned.q.out b/ql/src/test/results/clientpositive/index_auto_partitioned.q.out
index b332a8b279..b0635db69b 100644
--- a/ql/src/test/results/clientpositive/index_auto_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/index_auto_partitioned.q.out
@@ -60,23 +60,19 @@ STAGE PLANS:
               predicate:
                   expr: (key = 86)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: ((key = 86) and (ds = '2008-04-09'))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: _bucketname
-                        type: string
-                        expr: _offsets
-                        type: array<bigint>
-                  outputColumnNames: _col0, _col1
-                  File Output Operator
-                    compressed: false
-                    GlobalTableId: 1
-                    table:
-                        input format: org.apache.hadoop.mapred.TextInputFormat
-                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+              Select Operator
+                expressions:
+                      expr: _bucketname
+                      type: string
+                      expr: _offsets
+                      type: array<bigint>
+                outputColumnNames: _col0, _col1
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 1
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
 
   Stage: Stage-6
     Conditional Operator
@@ -106,28 +102,24 @@ STAGE PLANS:
               predicate:
                   expr: (key = 86)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: ((key = 86) and (ds = '2008-04-09'))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                  sort order: +
+                  tag: -1
+                  value expressions:
+                        expr: _col0
                         type: string
-                        expr: value
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    tag: -1
-                    value expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
       Reduce Operator Tree:
         Extract
           File Output Operator
diff --git a/ql/src/test/results/clientpositive/index_auto_unused.q.out b/ql/src/test/results/clientpositive/index_auto_unused.q.out
index 8fe3ac91de..3631bbcbc5 100644
--- a/ql/src/test/results/clientpositive/index_auto_unused.q.out
+++ b/ql/src/test/results/clientpositive/index_auto_unused.q.out
@@ -47,28 +47,24 @@ STAGE PLANS:
               predicate:
                   expr: ((key > 80) and (key < 100))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: ((key > 80) and (key < 100))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
                         type: string
-                        expr: value
+                  sort order: +
+                  tag: -1
+                  value expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    tag: -1
-                    value expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
       Reduce Operator Tree:
         Extract
           File Output Operator
@@ -143,28 +139,24 @@ STAGE PLANS:
               predicate:
                   expr: ((key > 80) and (key < 100))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: ((key > 80) and (key < 100))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                  sort order: +
+                  tag: -1
+                  value expressions:
+                        expr: _col0
                         type: string
-                        expr: value
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    tag: -1
-                    value expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
       Reduce Operator Tree:
         Extract
           File Output Operator
@@ -239,28 +231,24 @@ STAGE PLANS:
               predicate:
                   expr: ((key < 10) or (key > 480))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: ((key < 10) or (key > 480))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                  sort order: +
+                  tag: -1
+                  value expressions:
+                        expr: _col0
                         type: string
-                        expr: value
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    tag: -1
-                    value expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
       Reduce Operator Tree:
         Extract
           File Output Operator
@@ -379,28 +367,24 @@ STAGE PLANS:
               predicate:
                   expr: ((key > 80) and (key < 100))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: ((key > 80) and (key < 100))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
                         type: string
-                        expr: value
+                  sort order: +
+                  tag: -1
+                  value expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    tag: -1
-                    value expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
       Reduce Operator Tree:
         Extract
           File Output Operator
@@ -521,36 +505,32 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (((ds = '2008-04-09') and (hr = 12)) and (key < 10))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                      expr: ds
+                      type: string
+                      expr: hr
+                      type: string
+                outputColumnNames: _col0, _col1, _col2, _col3
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                  sort order: +
+                  tag: -1
+                  value expressions:
+                        expr: _col0
                         type: string
-                        expr: value
+                        expr: _col1
                         type: string
-                        expr: ds
+                        expr: _col2
                         type: string
-                        expr: hr
+                        expr: _col3
                         type: string
-                  outputColumnNames: _col0, _col1, _col2, _col3
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    tag: -1
-                    value expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
-                          expr: _col2
-                          type: string
-                          expr: _col3
-                          type: string
       Reduce Operator Tree:
         Extract
           File Output Operator
diff --git a/ql/src/test/results/clientpositive/index_bitmap3.q.out b/ql/src/test/results/clientpositive/index_bitmap3.q.out
index 8091359183..116c9731d2 100644
--- a/ql/src/test/results/clientpositive/index_bitmap3.q.out
+++ b/ql/src/test/results/clientpositive/index_bitmap3.q.out
@@ -1147,39 +1147,35 @@ STAGE PLANS:
               predicate:
                   expr: (key = 0)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key = 0)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: _bucketname
+              Select Operator
+                expressions:
+                      expr: _bucketname
+                      type: string
+                      expr: _offset
+                      type: bigint
+                      expr: _bitmaps
+                      type: array<bigint>
+                outputColumnNames: _col0, _col1, _col2
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col1
+                        type: bigint
+                  sort order: ++
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                        expr: _col1
+                        type: bigint
+                  tag: 0
+                  value expressions:
+                        expr: _col0
                         type: string
-                        expr: _offset
+                        expr: _col1
                         type: bigint
-                        expr: _bitmaps
+                        expr: _col2
                         type: array<bigint>
-                  outputColumnNames: _col0, _col1, _col2
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: bigint
-                    sort order: ++
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: bigint
-                    tag: 0
-                    value expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: bigint
-                          expr: _col2
-                          type: array<bigint>
         b:default__src_src2_index__ 
           TableScan
             alias: default__src_src2_index__
@@ -1187,35 +1183,31 @@ STAGE PLANS:
               predicate:
                   expr: (value = 'val_0')
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (value = 'val_0')
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: _bucketname
+              Select Operator
+                expressions:
+                      expr: _bucketname
+                      type: string
+                      expr: _offset
+                      type: bigint
+                      expr: _bitmaps
+                      type: array<bigint>
+                outputColumnNames: _col0, _col1, _col2
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col1
+                        type: bigint
+                  sort order: ++
+                  Map-reduce partition columns:
+                        expr: _col0
                         type: string
-                        expr: _offset
+                        expr: _col1
                         type: bigint
-                        expr: _bitmaps
+                  tag: 1
+                  value expressions:
+                        expr: _col2
                         type: array<bigint>
-                  outputColumnNames: _col0, _col1, _col2
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: bigint
-                    sort order: ++
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: bigint
-                    tag: 1
-                    value expressions:
-                          expr: _col2
-                          type: array<bigint>
       Reduce Operator Tree:
         Join Operator
           condition map:
diff --git a/ql/src/test/results/clientpositive/index_bitmap_auto.q.out b/ql/src/test/results/clientpositive/index_bitmap_auto.q.out
index e73877aaab..cc9d91effa 100644
--- a/ql/src/test/results/clientpositive/index_bitmap_auto.q.out
+++ b/ql/src/test/results/clientpositive/index_bitmap_auto.q.out
@@ -1166,39 +1166,35 @@ STAGE PLANS:
               predicate:
                   expr: (key = 0)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key = 0)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: _bucketname
+              Select Operator
+                expressions:
+                      expr: _bucketname
+                      type: string
+                      expr: _offset
+                      type: bigint
+                      expr: _bitmaps
+                      type: array<bigint>
+                outputColumnNames: _col0, _col1, _col2
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col1
+                        type: bigint
+                  sort order: ++
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                        expr: _col1
+                        type: bigint
+                  tag: 0
+                  value expressions:
+                        expr: _col0
                         type: string
-                        expr: _offset
+                        expr: _col1
                         type: bigint
-                        expr: _bitmaps
+                        expr: _col2
                         type: array<bigint>
-                  outputColumnNames: _col0, _col1, _col2
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: bigint
-                    sort order: ++
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: bigint
-                    tag: 0
-                    value expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: bigint
-                          expr: _col2
-                          type: array<bigint>
         b:default__src_src2_index__ 
           TableScan
             alias: default__src_src2_index__
@@ -1206,35 +1202,31 @@ STAGE PLANS:
               predicate:
                   expr: (value = 'val_0')
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (value = 'val_0')
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: _bucketname
+              Select Operator
+                expressions:
+                      expr: _bucketname
+                      type: string
+                      expr: _offset
+                      type: bigint
+                      expr: _bitmaps
+                      type: array<bigint>
+                outputColumnNames: _col0, _col1, _col2
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col1
+                        type: bigint
+                  sort order: ++
+                  Map-reduce partition columns:
+                        expr: _col0
                         type: string
-                        expr: _offset
+                        expr: _col1
                         type: bigint
-                        expr: _bitmaps
+                  tag: 1
+                  value expressions:
+                        expr: _col2
                         type: array<bigint>
-                  outputColumnNames: _col0, _col1, _col2
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: bigint
-                    sort order: ++
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: bigint
-                    tag: 1
-                    value expressions:
-                          expr: _col2
-                          type: array<bigint>
       Reduce Operator Tree:
         Join Operator
           condition map:
diff --git a/ql/src/test/results/clientpositive/index_bitmap_auto_partitioned.q.out b/ql/src/test/results/clientpositive/index_bitmap_auto_partitioned.q.out
index 4c9efd1e95..9003eb44b8 100644
--- a/ql/src/test/results/clientpositive/index_bitmap_auto_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/index_bitmap_auto_partitioned.q.out
@@ -59,58 +59,50 @@ STAGE PLANS:
               predicate:
                   expr: ((key = 86) and (not EWAH_BITMAP_EMPTY(_bitmaps)))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: ((key = 86) and (ds = '2008-04-09'))
-                    type: boolean
+              Select Operator
+                expressions:
+                      expr: _bucketname
+                      type: string
+                      expr: _offset
+                      type: bigint
+                      expr: _bitmaps
+                      type: array<bigint>
+                outputColumnNames: _col1, _col2, _col3
                 Select Operator
                   expressions:
-                        expr: _bucketname
+                        expr: _col1
                         type: string
-                        expr: _offset
+                        expr: _col2
                         type: bigint
-                        expr: _bitmaps
-                        type: array<bigint>
-                  outputColumnNames: _col1, _col2, _col3
-                  Filter Operator
-                    predicate:
-                        expr: (not EWAH_BITMAP_EMPTY(_col3))
-                        type: boolean
-                    Select Operator
-                      expressions:
-                            expr: _col1
+                  outputColumnNames: _col0, _col1
+                  Select Operator
+                    expressions:
+                          expr: _col0
+                          type: string
+                          expr: _col1
+                          type: bigint
+                    outputColumnNames: _col0, _col1
+                    Group By Operator
+                      aggregations:
+                            expr: collect_set(_col1)
+                      bucketGroup: false
+                      keys:
+                            expr: _col0
                             type: string
-                            expr: _col2
-                            type: bigint
+                      mode: hash
                       outputColumnNames: _col0, _col1
-                      Select Operator
-                        expressions:
+                      Reduce Output Operator
+                        key expressions:
                               expr: _col0
                               type: string
+                        sort order: +
+                        Map-reduce partition columns:
+                              expr: _col0
+                              type: string
+                        tag: -1
+                        value expressions:
                               expr: _col1
-                              type: bigint
-                        outputColumnNames: _col0, _col1
-                        Group By Operator
-                          aggregations:
-                                expr: collect_set(_col1)
-                          bucketGroup: false
-                          keys:
-                                expr: _col0
-                                type: string
-                          mode: hash
-                          outputColumnNames: _col0, _col1
-                          Reduce Output Operator
-                            key expressions:
-                                  expr: _col0
-                                  type: string
-                            sort order: +
-                            Map-reduce partition columns:
-                                  expr: _col0
-                                  type: string
-                            tag: -1
-                            value expressions:
-                                  expr: _col1
-                                  type: array<bigint>
+                              type: array<bigint>
       Reduce Operator Tree:
         Group By Operator
           aggregations:
@@ -154,28 +146,24 @@ STAGE PLANS:
               predicate:
                   expr: (key = 86)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: ((key = 86) and (ds = '2008-04-09'))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
                         type: string
-                        expr: value
+                  sort order: +
+                  tag: -1
+                  value expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    tag: -1
-                    value expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
       Reduce Operator Tree:
         Extract
           File Output Operator
diff --git a/ql/src/test/results/clientpositive/input11.q.out b/ql/src/test/results/clientpositive/input11.q.out
index 244130ba52..5e7209e920 100644
--- a/ql/src/test/results/clientpositive/input11.q.out
+++ b/ql/src/test/results/clientpositive/input11.q.out
@@ -33,32 +33,28 @@ STAGE PLANS:
               predicate:
                   expr: (key < 100)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 100)
-                    type: boolean
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
                 Select Operator
                   expressions:
-                        expr: key
-                        type: string
-                        expr: value
+                        expr: UDFToInteger(_col0)
+                        type: int
+                        expr: _col1
                         type: string
                   outputColumnNames: _col0, _col1
-                  Select Operator
-                    expressions:
-                          expr: UDFToInteger(_col0)
-                          type: int
-                          expr: _col1
-                          type: string
-                    outputColumnNames: _col0, _col1
-                    File Output Operator
-                      compressed: false
-                      GlobalTableId: 1
-                      table:
-                          input format: org.apache.hadoop.mapred.TextInputFormat
-                          output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                          name: default.dest1
+                  File Output Operator
+                    compressed: false
+                    GlobalTableId: 1
+                    table:
+                        input format: org.apache.hadoop.mapred.TextInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                        name: default.dest1
 
   Stage: Stage-5
     Conditional Operator
diff --git a/ql/src/test/results/clientpositive/input11_limit.q.out b/ql/src/test/results/clientpositive/input11_limit.q.out
index 195f03c1f7..7a311e720c 100644
--- a/ql/src/test/results/clientpositive/input11_limit.q.out
+++ b/ql/src/test/results/clientpositive/input11_limit.q.out
@@ -30,26 +30,22 @@ STAGE PLANS:
               predicate:
                   expr: (key < 100)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 100)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
-                  outputColumnNames: _col0, _col1
-                  Limit
-                    Reduce Output Operator
-                      sort order: 
-                      tag: -1
-                      value expressions:
-                            expr: _col0
-                            type: string
-                            expr: _col1
-                            type: string
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Limit
+                  Reduce Output Operator
+                    sort order: 
+                    tag: -1
+                    value expressions:
+                          expr: _col0
+                          type: string
+                          expr: _col1
+                          type: string
       Reduce Operator Tree:
         Extract
           Limit
diff --git a/ql/src/test/results/clientpositive/input14.q.out b/ql/src/test/results/clientpositive/input14.q.out
index ec919b7fea..9554c75d81 100644
--- a/ql/src/test/results/clientpositive/input14.q.out
+++ b/ql/src/test/results/clientpositive/input14.q.out
@@ -48,48 +48,48 @@ STAGE PLANS:
                 output info:
                     input format: org.apache.hadoop.mapred.TextInputFormat
                     output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                Reduce Output Operator
-                  key expressions:
-                        expr: _col0
-                        type: string
-                  sort order: +
-                  Map-reduce partition columns:
-                        expr: _col0
-                        type: string
-                  tag: -1
-                  value expressions:
-                        expr: _col0
-                        type: string
-                        expr: _col1
-                        type: string
+                Filter Operator
+                  predicate:
+                      expr: (_col0 < 100)
+                      type: boolean
+                  Reduce Output Operator
+                    key expressions:
+                          expr: _col0
+                          type: string
+                    sort order: +
+                    Map-reduce partition columns:
+                          expr: _col0
+                          type: string
+                    tag: -1
+                    value expressions:
+                          expr: _col0
+                          type: string
+                          expr: _col1
+                          type: string
       Reduce Operator Tree:
         Extract
-          Filter Operator
-            predicate:
-                expr: (_col0 < 100)
-                type: boolean
+          Select Operator
+            expressions:
+                  expr: _col0
+                  type: string
+                  expr: _col1
+                  type: string
+            outputColumnNames: _col0, _col1
             Select Operator
               expressions:
-                    expr: _col0
-                    type: string
+                    expr: UDFToInteger(_col0)
+                    type: int
                     expr: _col1
                     type: string
               outputColumnNames: _col0, _col1
-              Select Operator
-                expressions:
-                      expr: UDFToInteger(_col0)
-                      type: int
-                      expr: _col1
-                      type: string
-                outputColumnNames: _col0, _col1
-                File Output Operator
-                  compressed: false
-                  GlobalTableId: 1
-                  table:
-                      input format: org.apache.hadoop.mapred.TextInputFormat
-                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                      name: default.dest1
+              File Output Operator
+                compressed: false
+                GlobalTableId: 1
+                table:
+                    input format: org.apache.hadoop.mapred.TextInputFormat
+                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                    name: default.dest1
 
   Stage: Stage-0
     Move Operator
diff --git a/ql/src/test/results/clientpositive/input18.q.out b/ql/src/test/results/clientpositive/input18.q.out
index ddb286f052..7a09c6fc75 100644
--- a/ql/src/test/results/clientpositive/input18.q.out
+++ b/ql/src/test/results/clientpositive/input18.q.out
@@ -52,48 +52,48 @@ STAGE PLANS:
                 output info:
                     input format: org.apache.hadoop.mapred.TextInputFormat
                     output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                Reduce Output Operator
-                  key expressions:
-                        expr: _col0
-                        type: string
-                  sort order: +
-                  Map-reduce partition columns:
-                        expr: _col0
-                        type: string
-                  tag: -1
-                  value expressions:
-                        expr: _col0
-                        type: string
-                        expr: _col1
-                        type: string
+                Filter Operator
+                  predicate:
+                      expr: (_col0 < 100)
+                      type: boolean
+                  Reduce Output Operator
+                    key expressions:
+                          expr: _col0
+                          type: string
+                    sort order: +
+                    Map-reduce partition columns:
+                          expr: _col0
+                          type: string
+                    tag: -1
+                    value expressions:
+                          expr: _col0
+                          type: string
+                          expr: _col1
+                          type: string
       Reduce Operator Tree:
         Extract
-          Filter Operator
-            predicate:
-                expr: (_col0 < 100)
-                type: boolean
+          Select Operator
+            expressions:
+                  expr: _col0
+                  type: string
+                  expr: regexp_replace(_col1, '	', '+')
+                  type: string
+            outputColumnNames: _col0, _col1
             Select Operator
               expressions:
-                    expr: _col0
-                    type: string
-                    expr: regexp_replace(_col1, '	', '+')
+                    expr: UDFToInteger(_col0)
+                    type: int
+                    expr: _col1
                     type: string
               outputColumnNames: _col0, _col1
-              Select Operator
-                expressions:
-                      expr: UDFToInteger(_col0)
-                      type: int
-                      expr: _col1
-                      type: string
-                outputColumnNames: _col0, _col1
-                File Output Operator
-                  compressed: false
-                  GlobalTableId: 1
-                  table:
-                      input format: org.apache.hadoop.mapred.TextInputFormat
-                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                      name: default.dest1
+              File Output Operator
+                compressed: false
+                GlobalTableId: 1
+                table:
+                    input format: org.apache.hadoop.mapred.TextInputFormat
+                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                    name: default.dest1
 
   Stage: Stage-0
     Move Operator
diff --git a/ql/src/test/results/clientpositive/input23.q.out b/ql/src/test/results/clientpositive/input23.q.out
index fdfe6099e0..fa4fbfc237 100644
--- a/ql/src/test/results/clientpositive/input23.q.out
+++ b/ql/src/test/results/clientpositive/input23.q.out
@@ -106,47 +106,42 @@ STAGE PLANS:
             1 {VALUE._col0} {VALUE._col1} {VALUE._col2} {VALUE._col3}
           handleSkewJoin: false
           outputColumnNames: _col0, _col1, _col2, _col3, _col6, _col7, _col8, _col9
-          Filter Operator
-            isSamplingPred: false
-            predicate:
-                expr: ((((_col2 = '2008-04-08') and (_col3 = '11')) and (_col8 = '2008-04-08')) and (_col9 = '14'))
-                type: boolean
-            Select Operator
-              expressions:
-                    expr: _col0
-                    type: string
-                    expr: _col1
-                    type: string
-                    expr: _col2
-                    type: string
-                    expr: _col3
-                    type: string
-                    expr: _col6
-                    type: string
-                    expr: _col7
-                    type: string
-                    expr: _col8
-                    type: string
-                    expr: _col9
-                    type: string
-              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
-              Limit
-                File Output Operator
-                  compressed: false
-                  GlobalTableId: 0
-                  directory: file:/tmp/sdong/hive_2011-02-10_15-54-28_256_717236059530733661/-ext-10001
-                  NumFilesPerFileSink: 1
-                  Stats Publishing Key Prefix: file:/tmp/sdong/hive_2011-02-10_15-54-28_256_717236059530733661/-ext-10001/
-                  table:
-                      input format: org.apache.hadoop.mapred.TextInputFormat
-                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                      properties:
-                        columns _col0,_col1,_col2,_col3,_col4,_col5,_col6,_col7
-                        columns.types string:string:string:string:string:string:string:string
-                        serialization.format 1
-                  TotalFiles: 1
-                  GatherStats: false
-                  MultiFileSpray: false
+          Select Operator
+            expressions:
+                  expr: _col0
+                  type: string
+                  expr: _col1
+                  type: string
+                  expr: _col2
+                  type: string
+                  expr: _col3
+                  type: string
+                  expr: _col6
+                  type: string
+                  expr: _col7
+                  type: string
+                  expr: _col8
+                  type: string
+                  expr: _col9
+                  type: string
+            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
+            Limit
+              File Output Operator
+                compressed: false
+                GlobalTableId: 0
+                directory: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-17_09-04-29_865_6849719999466698028/-ext-10001
+                NumFilesPerFileSink: 1
+                Stats Publishing Key Prefix: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-17_09-04-29_865_6849719999466698028/-ext-10001/
+                table:
+                    input format: org.apache.hadoop.mapred.TextInputFormat
+                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                    properties:
+                      columns _col0,_col1,_col2,_col3,_col4,_col5,_col6,_col7
+                      columns.types string:string:string:string:string:string:string:string
+                      serialization.format 1
+                TotalFiles: 1
+                GatherStats: false
+                MultiFileSpray: false
 
   Stage: Stage-0
     Fetch Operator
diff --git a/ql/src/test/results/clientpositive/input24.q.out b/ql/src/test/results/clientpositive/input24.q.out
index dfc9328f8d..6c6c7eea3c 100644
--- a/ql/src/test/results/clientpositive/input24.q.out
+++ b/ql/src/test/results/clientpositive/input24.q.out
@@ -30,23 +30,19 @@ STAGE PLANS:
         x 
           TableScan
             alias: x
-            Filter Operator
-              predicate:
-                  expr: (d = '2009-01-01')
-                  type: boolean
-              Select Operator
-                Group By Operator
-                  aggregations:
-                        expr: count(1)
-                  bucketGroup: false
-                  mode: hash
-                  outputColumnNames: _col0
-                  Reduce Output Operator
-                    sort order: 
-                    tag: -1
-                    value expressions:
-                          expr: _col0
-                          type: bigint
+            Select Operator
+              Group By Operator
+                aggregations:
+                      expr: count(1)
+                bucketGroup: false
+                mode: hash
+                outputColumnNames: _col0
+                Reduce Output Operator
+                  sort order: 
+                  tag: -1
+                  value expressions:
+                        expr: _col0
+                        type: bigint
       Reduce Operator Tree:
         Group By Operator
           aggregations:
diff --git a/ql/src/test/results/clientpositive/input25.q.out b/ql/src/test/results/clientpositive/input25.q.out
index 6db4ec8923..ef879ca63e 100644
--- a/ql/src/test/results/clientpositive/input25.q.out
+++ b/ql/src/test/results/clientpositive/input25.q.out
@@ -47,30 +47,26 @@ STAGE PLANS:
         null-subquery1:subq-subquery1:x 
           TableScan
             alias: x
-            Filter Operator
-              predicate:
-                  expr: (d = '2009-01-01')
-                  type: boolean
-              Select Operator
-                expressions:
-                      expr: a
-                      type: int
-                      expr: b
-                      type: int
-                      expr: d
-                      type: string
-                outputColumnNames: _col0, _col1, _col2
-                Limit
-                  Reduce Output Operator
-                    sort order: 
-                    tag: -1
-                    value expressions:
-                          expr: _col0
-                          type: int
-                          expr: _col1
-                          type: int
-                          expr: _col2
-                          type: string
+            Select Operator
+              expressions:
+                    expr: a
+                    type: int
+                    expr: b
+                    type: int
+                    expr: d
+                    type: string
+              outputColumnNames: _col0, _col1, _col2
+              Limit
+                Reduce Output Operator
+                  sort order: 
+                  tag: -1
+                  value expressions:
+                        expr: _col0
+                        type: int
+                        expr: _col1
+                        type: int
+                        expr: _col2
+                        type: string
       Reduce Operator Tree:
         Extract
           Limit
@@ -125,30 +121,26 @@ STAGE PLANS:
         null-subquery2:subq-subquery2:x 
           TableScan
             alias: x
-            Filter Operator
-              predicate:
-                  expr: (d = '2009-02-02')
-                  type: boolean
-              Select Operator
-                expressions:
-                      expr: a
-                      type: int
-                      expr: b
-                      type: int
-                      expr: d
-                      type: string
-                outputColumnNames: _col0, _col1, _col2
-                Limit
-                  Reduce Output Operator
-                    sort order: 
-                    tag: -1
-                    value expressions:
-                          expr: _col0
-                          type: int
-                          expr: _col1
-                          type: int
-                          expr: _col2
-                          type: string
+            Select Operator
+              expressions:
+                    expr: a
+                    type: int
+                    expr: b
+                    type: int
+                    expr: d
+                    type: string
+              outputColumnNames: _col0, _col1, _col2
+              Limit
+                Reduce Output Operator
+                  sort order: 
+                  tag: -1
+                  value expressions:
+                        expr: _col0
+                        type: int
+                        expr: _col1
+                        type: int
+                        expr: _col2
+                        type: string
       Reduce Operator Tree:
         Extract
           Limit
diff --git a/ql/src/test/results/clientpositive/input26.q.out b/ql/src/test/results/clientpositive/input26.q.out
index c6dc8efeb5..d693b0a5f4 100644
--- a/ql/src/test/results/clientpositive/input26.q.out
+++ b/ql/src/test/results/clientpositive/input26.q.out
@@ -28,36 +28,32 @@ STAGE PLANS:
         null-subquery1:subq-subquery1:a 
           TableScan
             alias: a
-            Filter Operator
-              predicate:
-                  expr: ((ds = '2008-04-08') and (hr = '11'))
-                  type: boolean
-              Select Operator
-                expressions:
-                      expr: key
+            Select Operator
+              expressions:
+                    expr: key
+                    type: string
+                    expr: value
+                    type: string
+                    expr: ds
+                    type: string
+                    expr: hr
+                    type: string
+              outputColumnNames: _col0, _col1, _col2, _col3
+              Reduce Output Operator
+                key expressions:
+                      expr: _col0
                       type: string
-                      expr: value
+                sort order: +
+                tag: -1
+                value expressions:
+                      expr: _col0
                       type: string
-                      expr: ds
+                      expr: _col1
                       type: string
-                      expr: hr
+                      expr: _col2
+                      type: string
+                      expr: _col3
                       type: string
-                outputColumnNames: _col0, _col1, _col2, _col3
-                Reduce Output Operator
-                  key expressions:
-                        expr: _col0
-                        type: string
-                  sort order: +
-                  tag: -1
-                  value expressions:
-                        expr: _col0
-                        type: string
-                        expr: _col1
-                        type: string
-                        expr: _col2
-                        type: string
-                        expr: _col3
-                        type: string
       Reduce Operator Tree:
         Extract
           Limit
@@ -120,34 +116,30 @@ STAGE PLANS:
               predicate:
                   expr: ((ds = '2008-04-08') and (hr = '14'))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: ((ds = '2008-04-08') and (hr = '14'))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
-                        expr: ds
-                        type: string
-                        expr: hr
-                        type: string
-                  outputColumnNames: _col0, _col1, _col2, _col3
-                  Limit
-                    Reduce Output Operator
-                      sort order: 
-                      tag: -1
-                      value expressions:
-                            expr: _col0
-                            type: string
-                            expr: _col1
-                            type: string
-                            expr: _col2
-                            type: string
-                            expr: _col3
-                            type: string
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                      expr: ds
+                      type: string
+                      expr: hr
+                      type: string
+                outputColumnNames: _col0, _col1, _col2, _col3
+                Limit
+                  Reduce Output Operator
+                    sort order: 
+                    tag: -1
+                    value expressions:
+                          expr: _col0
+                          type: string
+                          expr: _col1
+                          type: string
+                          expr: _col2
+                          type: string
+                          expr: _col3
+                          type: string
       Reduce Operator Tree:
         Extract
           Limit
diff --git a/ql/src/test/results/clientpositive/input2_limit.q.out b/ql/src/test/results/clientpositive/input2_limit.q.out
index 8680877ceb..3514dd227f 100644
--- a/ql/src/test/results/clientpositive/input2_limit.q.out
+++ b/ql/src/test/results/clientpositive/input2_limit.q.out
@@ -22,24 +22,20 @@ STAGE PLANS:
               predicate:
                   expr: (key < 300)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 300)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
-                  outputColumnNames: _col0, _col1
-                  Limit
-                    File Output Operator
-                      compressed: false
-                      GlobalTableId: 0
-                      table:
-                          input format: org.apache.hadoop.mapred.TextInputFormat
-                          output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Limit
+                  File Output Operator
+                    compressed: false
+                    GlobalTableId: 0
+                    table:
+                        input format: org.apache.hadoop.mapred.TextInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
 
   Stage: Stage-0
     Fetch Operator
diff --git a/ql/src/test/results/clientpositive/input31.q.out b/ql/src/test/results/clientpositive/input31.q.out
index eb21e2cb40..50f25f7fb5 100644
--- a/ql/src/test/results/clientpositive/input31.q.out
+++ b/ql/src/test/results/clientpositive/input31.q.out
@@ -35,23 +35,19 @@ STAGE PLANS:
               predicate:
                   expr: (((hash(key) & 2147483647) % 2) = 0)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (((hash(key) & 2147483647) % 2) = 0)
-                    type: boolean
-                Select Operator
-                  Group By Operator
-                    aggregations:
-                          expr: count(1)
-                    bucketGroup: false
-                    mode: hash
-                    outputColumnNames: _col0
-                    Reduce Output Operator
-                      sort order: 
-                      tag: -1
-                      value expressions:
-                            expr: _col0
-                            type: bigint
+              Select Operator
+                Group By Operator
+                  aggregations:
+                        expr: count(1)
+                  bucketGroup: false
+                  mode: hash
+                  outputColumnNames: _col0
+                  Reduce Output Operator
+                    sort order: 
+                    tag: -1
+                    value expressions:
+                          expr: _col0
+                          type: bigint
       Reduce Operator Tree:
         Group By Operator
           aggregations:
diff --git a/ql/src/test/results/clientpositive/input39.q.out b/ql/src/test/results/clientpositive/input39.q.out
index 8baaa77c68..e6a7a6c575 100644
--- a/ql/src/test/results/clientpositive/input39.q.out
+++ b/ql/src/test/results/clientpositive/input39.q.out
@@ -121,23 +121,19 @@ STAGE PLANS:
             1 {VALUE._col2}
           handleSkewJoin: false
           outputColumnNames: _col2, _col7
-          Filter Operator
-            predicate:
-                expr: ((_col2 = '1') and (_col7 = '1'))
-                type: boolean
-            Select Operator
-              Group By Operator
-                aggregations:
-                      expr: count(1)
-                bucketGroup: false
-                mode: hash
-                outputColumnNames: _col0
-                File Output Operator
-                  compressed: false
-                  GlobalTableId: 0
-                  table:
-                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
-                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+          Select Operator
+            Group By Operator
+              aggregations:
+                    expr: count(1)
+              bucketGroup: false
+              mode: hash
+              outputColumnNames: _col0
+              File Output Operator
+                compressed: false
+                GlobalTableId: 0
+                table:
+                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
 
   Stage: Stage-2
     Map Reduce
diff --git a/ql/src/test/results/clientpositive/input42.q.out b/ql/src/test/results/clientpositive/input42.q.out
index 959edb30dc..bec23c3c84 100644
--- a/ql/src/test/results/clientpositive/input42.q.out
+++ b/ql/src/test/results/clientpositive/input42.q.out
@@ -19,39 +19,34 @@ STAGE PLANS:
           TableScan
             alias: a
             GatherStats: false
-            Filter Operator
-              isSamplingPred: false
-              predicate:
-                  expr: (ds = '2008-04-08')
-                  type: boolean
-              Select Operator
-                expressions:
-                      expr: key
+            Select Operator
+              expressions:
+                    expr: key
+                    type: string
+                    expr: value
+                    type: string
+                    expr: ds
+                    type: string
+                    expr: hr
+                    type: string
+              outputColumnNames: _col0, _col1, _col2, _col3
+              Reduce Output Operator
+                key expressions:
+                      expr: _col0
                       type: string
-                      expr: value
+                      expr: _col3
                       type: string
-                      expr: ds
+                sort order: ++
+                tag: -1
+                value expressions:
+                      expr: _col0
                       type: string
-                      expr: hr
+                      expr: _col1
+                      type: string
+                      expr: _col2
+                      type: string
+                      expr: _col3
                       type: string
-                outputColumnNames: _col0, _col1, _col2, _col3
-                Reduce Output Operator
-                  key expressions:
-                        expr: _col0
-                        type: string
-                        expr: _col3
-                        type: string
-                  sort order: ++
-                  tag: -1
-                  value expressions:
-                        expr: _col0
-                        type: string
-                        expr: _col1
-                        type: string
-                        expr: _col2
-                        type: string
-                        expr: _col3
-                        type: string
       Needs Tagging: false
       Path -> Alias:
         pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 [a]
@@ -1199,39 +1194,34 @@ STAGE PLANS:
               predicate:
                   expr: (key < 200)
                   type: boolean
-              Filter Operator
-                isSamplingPred: false
-                predicate:
-                    expr: ((ds = '2008-04-08') and (key < 200))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                      expr: ds
+                      type: string
+                      expr: hr
+                      type: string
+                outputColumnNames: _col0, _col1, _col2, _col3
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
                         type: string
-                        expr: value
+                        expr: _col3
                         type: string
-                        expr: ds
+                  sort order: ++
+                  tag: -1
+                  value expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col1
                         type: string
-                        expr: hr
+                        expr: _col2
+                        type: string
+                        expr: _col3
                         type: string
-                  outputColumnNames: _col0, _col1, _col2, _col3
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col3
-                          type: string
-                    sort order: ++
-                    tag: -1
-                    value expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
-                          expr: _col2
-                          type: string
-                          expr: _col3
-                          type: string
       Needs Tagging: false
       Path -> Alias:
         pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 [a]
diff --git a/ql/src/test/results/clientpositive/input6.q.out b/ql/src/test/results/clientpositive/input6.q.out
index f0426aea42..34925ac5fd 100644
--- a/ql/src/test/results/clientpositive/input6.q.out
+++ b/ql/src/test/results/clientpositive/input6.q.out
@@ -33,25 +33,21 @@ STAGE PLANS:
               predicate:
                   expr: key is null
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: key is null
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
-                  outputColumnNames: _col0, _col1
-                  File Output Operator
-                    compressed: false
-                    GlobalTableId: 1
-                    table:
-                        input format: org.apache.hadoop.mapred.TextInputFormat
-                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                        name: default.dest1
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 1
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                      name: default.dest1
 
   Stage: Stage-5
     Conditional Operator
diff --git a/ql/src/test/results/clientpositive/input9.q.out b/ql/src/test/results/clientpositive/input9.q.out
index 4b8988e13a..07aac5ed4b 100644
--- a/ql/src/test/results/clientpositive/input9.q.out
+++ b/ql/src/test/results/clientpositive/input9.q.out
@@ -33,32 +33,28 @@ STAGE PLANS:
               predicate:
                   expr: (null = null)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (null = null)
-                    type: boolean
+              Select Operator
+                expressions:
+                      expr: null
+                      type: string
+                      expr: key
+                      type: string
+                outputColumnNames: _col0, _col1
                 Select Operator
                   expressions:
-                        expr: null
-                        type: string
-                        expr: key
-                        type: string
+                        expr: _col0
+                        type: void
+                        expr: UDFToInteger(_col1)
+                        type: int
                   outputColumnNames: _col0, _col1
-                  Select Operator
-                    expressions:
-                          expr: _col0
-                          type: void
-                          expr: UDFToInteger(_col1)
-                          type: int
-                    outputColumnNames: _col0, _col1
-                    File Output Operator
-                      compressed: false
-                      GlobalTableId: 1
-                      table:
-                          input format: org.apache.hadoop.mapred.TextInputFormat
-                          output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                          name: default.dest1
+                  File Output Operator
+                    compressed: false
+                    GlobalTableId: 1
+                    table:
+                        input format: org.apache.hadoop.mapred.TextInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                        name: default.dest1
 
   Stage: Stage-5
     Conditional Operator
diff --git a/ql/src/test/results/clientpositive/input_part1.q.out b/ql/src/test/results/clientpositive/input_part1.q.out
index 916189da9e..6de047719b 100644
--- a/ql/src/test/results/clientpositive/input_part1.q.out
+++ b/ql/src/test/results/clientpositive/input_part1.q.out
@@ -35,59 +35,54 @@ STAGE PLANS:
               predicate:
                   expr: (key < 100)
                   type: boolean
-              Filter Operator
-                isSamplingPred: false
-                predicate:
-                    expr: (((key < 100) and (ds = '2008-04-08')) and (hr = '12'))
-                    type: boolean
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                      expr: hr
+                      type: string
+                      expr: ds
+                      type: string
+                outputColumnNames: _col0, _col1, _col2, _col3
                 Select Operator
                   expressions:
-                        expr: key
+                        expr: UDFToInteger(_col0)
+                        type: int
+                        expr: _col1
                         type: string
-                        expr: value
+                        expr: _col2
                         type: string
-                        expr: hr
-                        type: string
-                        expr: ds
+                        expr: _col3
                         type: string
                   outputColumnNames: _col0, _col1, _col2, _col3
-                  Select Operator
-                    expressions:
-                          expr: UDFToInteger(_col0)
-                          type: int
-                          expr: _col1
-                          type: string
-                          expr: _col2
-                          type: string
-                          expr: _col3
-                          type: string
-                    outputColumnNames: _col0, _col1, _col2, _col3
-                    File Output Operator
-                      compressed: false
-                      GlobalTableId: 1
-                      directory: pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-02-10_15-59-53_966_4370880936716856186/-ext-10002
-                      NumFilesPerFileSink: 1
-                      Stats Publishing Key Prefix: pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-02-10_15-59-53_966_4370880936716856186/-ext-10000/
-                      table:
-                          input format: org.apache.hadoop.mapred.TextInputFormat
-                          output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                          properties:
-                            bucket_count -1
-                            columns key,value,hr,ds
-                            columns.types int:string:string:string
-                            file.inputformat org.apache.hadoop.mapred.TextInputFormat
-                            file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                            location pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/dest1
-                            name default.dest1
-                            serialization.ddl struct dest1 { i32 key, string value, string hr, string ds}
-                            serialization.format 1
-                            serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                            transient_lastDdlTime 1297382393
-                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                          name: default.dest1
-                      TotalFiles: 1
-                      GatherStats: true
-                      MultiFileSpray: false
+                  File Output Operator
+                    compressed: false
+                    GlobalTableId: 1
+                    directory: pfile:/Users/amarsri/Documents/workspace/hive/build/ql/scratchdir/hive_2011-03-17_09-16-00_167_373354768081382011/-ext-10002
+                    NumFilesPerFileSink: 1
+                    Stats Publishing Key Prefix: pfile:/Users/amarsri/Documents/workspace/hive/build/ql/scratchdir/hive_2011-03-17_09-16-00_167_373354768081382011/-ext-10000/
+                    table:
+                        input format: org.apache.hadoop.mapred.TextInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                        properties:
+                          bucket_count -1
+                          columns key,value,hr,ds
+                          columns.types int:string:string:string
+                          file.inputformat org.apache.hadoop.mapred.TextInputFormat
+                          file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                          location pfile:/Users/amarsri/Documents/workspace/hive/build/ql/test/data/warehouse/dest1
+                          name default.dest1
+                          serialization.ddl struct dest1 { i32 key, string value, string hr, string ds}
+                          serialization.format 1
+                          serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                          transient_lastDdlTime 1300378560
+                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                        name: default.dest1
+                    TotalFiles: 1
+                    GatherStats: true
+                    MultiFileSpray: false
       Needs Tagging: false
       Path -> Alias:
         pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12 [srcpart]
diff --git a/ql/src/test/results/clientpositive/input_part5.q.out b/ql/src/test/results/clientpositive/input_part5.q.out
index 350dd70844..182b3e29ed 100644
--- a/ql/src/test/results/clientpositive/input_part5.q.out
+++ b/ql/src/test/results/clientpositive/input_part5.q.out
@@ -33,29 +33,25 @@ STAGE PLANS:
               predicate:
                   expr: (key < 100)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: ((ds = '2008-04-08') and (key < 100))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
-                        expr: ds
-                        type: string
-                        expr: hr
-                        type: string
-                  outputColumnNames: _col0, _col1, _col2, _col3
-                  File Output Operator
-                    compressed: false
-                    GlobalTableId: 1
-                    table:
-                        input format: org.apache.hadoop.mapred.TextInputFormat
-                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                        name: default.tmptable
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                      expr: ds
+                      type: string
+                      expr: hr
+                      type: string
+                outputColumnNames: _col0, _col1, _col2, _col3
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 1
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                      name: default.tmptable
 
   Stage: Stage-5
     Conditional Operator
diff --git a/ql/src/test/results/clientpositive/input_part6.q.out b/ql/src/test/results/clientpositive/input_part6.q.out
index 8ae0d9c9bb..6eacd9e702 100644
--- a/ql/src/test/results/clientpositive/input_part6.q.out
+++ b/ql/src/test/results/clientpositive/input_part6.q.out
@@ -22,28 +22,24 @@ STAGE PLANS:
               predicate:
                   expr: (ds = ((2008 - 4) - 8))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (ds = ((2008 - 4) - 8))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
-                        expr: ds
-                        type: string
-                        expr: hr
-                        type: string
-                  outputColumnNames: _col0, _col1, _col2, _col3
-                  Limit
-                    File Output Operator
-                      compressed: false
-                      GlobalTableId: 0
-                      table:
-                          input format: org.apache.hadoop.mapred.TextInputFormat
-                          output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                      expr: ds
+                      type: string
+                      expr: hr
+                      type: string
+                outputColumnNames: _col0, _col1, _col2, _col3
+                Limit
+                  File Output Operator
+                    compressed: false
+                    GlobalTableId: 0
+                    table:
+                        input format: org.apache.hadoop.mapred.TextInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
 
   Stage: Stage-0
     Fetch Operator
diff --git a/ql/src/test/results/clientpositive/input_part7.q.out b/ql/src/test/results/clientpositive/input_part7.q.out
index a14a09cbbc..b66191b167 100644
--- a/ql/src/test/results/clientpositive/input_part7.q.out
+++ b/ql/src/test/results/clientpositive/input_part7.q.out
@@ -34,25 +34,42 @@ STAGE PLANS:
               predicate:
                   expr: (key < 100)
                   type: boolean
-              Filter Operator
-                isSamplingPred: false
-                predicate:
-                    expr: ((ds = '2008-04-08') and (key < 100))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
-                        expr: ds
-                        type: string
-                        expr: hr
-                        type: string
-                  outputColumnNames: _col0, _col1, _col2, _col3
-                  Union
-                    Select Operator
-                      expressions:
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                      expr: ds
+                      type: string
+                      expr: hr
+                      type: string
+                outputColumnNames: _col0, _col1, _col2, _col3
+                Union
+                  Select Operator
+                    expressions:
+                          expr: _col0
+                          type: string
+                          expr: _col1
+                          type: string
+                          expr: _col2
+                          type: string
+                          expr: _col3
+                          type: string
+                    outputColumnNames: _col0, _col1, _col2, _col3
+                    Reduce Output Operator
+                      key expressions:
+                            expr: _col0
+                            type: string
+                            expr: _col1
+                            type: string
+                            expr: _col2
+                            type: string
+                            expr: _col3
+                            type: string
+                      sort order: ++++
+                      tag: -1
+                      value expressions:
                             expr: _col0
                             type: string
                             expr: _col1
@@ -61,28 +78,6 @@ STAGE PLANS:
                             type: string
                             expr: _col3
                             type: string
-                      outputColumnNames: _col0, _col1, _col2, _col3
-                      Reduce Output Operator
-                        key expressions:
-                              expr: _col0
-                              type: string
-                              expr: _col1
-                              type: string
-                              expr: _col2
-                              type: string
-                              expr: _col3
-                              type: string
-                        sort order: ++++
-                        tag: -1
-                        value expressions:
-                              expr: _col0
-                              type: string
-                              expr: _col1
-                              type: string
-                              expr: _col2
-                              type: string
-                              expr: _col3
-                              type: string
         null-subquery2:a-subquery2:y 
           TableScan
             alias: y
@@ -92,25 +87,42 @@ STAGE PLANS:
               predicate:
                   expr: (key < 100)
                   type: boolean
-              Filter Operator
-                isSamplingPred: false
-                predicate:
-                    expr: ((ds = '2008-04-08') and (key < 100))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
-                        expr: ds
-                        type: string
-                        expr: hr
-                        type: string
-                  outputColumnNames: _col0, _col1, _col2, _col3
-                  Union
-                    Select Operator
-                      expressions:
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                      expr: ds
+                      type: string
+                      expr: hr
+                      type: string
+                outputColumnNames: _col0, _col1, _col2, _col3
+                Union
+                  Select Operator
+                    expressions:
+                          expr: _col0
+                          type: string
+                          expr: _col1
+                          type: string
+                          expr: _col2
+                          type: string
+                          expr: _col3
+                          type: string
+                    outputColumnNames: _col0, _col1, _col2, _col3
+                    Reduce Output Operator
+                      key expressions:
+                            expr: _col0
+                            type: string
+                            expr: _col1
+                            type: string
+                            expr: _col2
+                            type: string
+                            expr: _col3
+                            type: string
+                      sort order: ++++
+                      tag: -1
+                      value expressions:
                             expr: _col0
                             type: string
                             expr: _col1
@@ -119,28 +131,6 @@ STAGE PLANS:
                             type: string
                             expr: _col3
                             type: string
-                      outputColumnNames: _col0, _col1, _col2, _col3
-                      Reduce Output Operator
-                        key expressions:
-                              expr: _col0
-                              type: string
-                              expr: _col1
-                              type: string
-                              expr: _col2
-                              type: string
-                              expr: _col3
-                              type: string
-                        sort order: ++++
-                        tag: -1
-                        value expressions:
-                              expr: _col0
-                              type: string
-                              expr: _col1
-                              type: string
-                              expr: _col2
-                              type: string
-                              expr: _col3
-                              type: string
       Needs Tagging: false
       Path -> Alias:
         pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 [null-subquery1:a-subquery1:x, null-subquery2:a-subquery2:y]
diff --git a/ql/src/test/results/clientpositive/input_part9.q.out b/ql/src/test/results/clientpositive/input_part9.q.out
index 4b32c6bc36..13ab4e5d04 100644
--- a/ql/src/test/results/clientpositive/input_part9.q.out
+++ b/ql/src/test/results/clientpositive/input_part9.q.out
@@ -24,39 +24,34 @@ STAGE PLANS:
               predicate:
                   expr: key is not null
                   type: boolean
-              Filter Operator
-                isSamplingPred: false
-                predicate:
-                    expr: (key is not null and (ds = '2008-04-08'))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                      expr: ds
+                      type: string
+                      expr: hr
+                      type: string
+                outputColumnNames: _col0, _col1, _col2, _col3
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
                         type: string
-                        expr: value
+                        expr: _col3
                         type: string
-                        expr: ds
+                  sort order: ++
+                  tag: -1
+                  value expressions:
+                        expr: _col0
                         type: string
-                        expr: hr
+                        expr: _col1
+                        type: string
+                        expr: _col2
+                        type: string
+                        expr: _col3
                         type: string
-                  outputColumnNames: _col0, _col1, _col2, _col3
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col3
-                          type: string
-                    sort order: ++
-                    tag: -1
-                    value expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
-                          expr: _col2
-                          type: string
-                          expr: _col3
-                          type: string
       Needs Tagging: false
       Path -> Alias:
         pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 [x]
diff --git a/ql/src/test/results/clientpositive/input_testxpath2.q.out b/ql/src/test/results/clientpositive/input_testxpath2.q.out
index 419148a0d7..130d6732e5 100644
--- a/ql/src/test/results/clientpositive/input_testxpath2.q.out
+++ b/ql/src/test/results/clientpositive/input_testxpath2.q.out
@@ -33,27 +33,23 @@ STAGE PLANS:
               predicate:
                   expr: (lint is not null and (not mstringstring is null))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (lint is not null and (not mstringstring is null))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: size(lint)
-                        type: int
-                        expr: size(lintstring)
-                        type: int
-                        expr: size(mstringstring)
-                        type: int
-                  outputColumnNames: _col0, _col1, _col2
-                  File Output Operator
-                    compressed: false
-                    GlobalTableId: 1
-                    table:
-                        input format: org.apache.hadoop.mapred.TextInputFormat
-                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                        name: default.dest1
+              Select Operator
+                expressions:
+                      expr: size(lint)
+                      type: int
+                      expr: size(lintstring)
+                      type: int
+                      expr: size(mstringstring)
+                      type: int
+                outputColumnNames: _col0, _col1, _col2
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 1
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                      name: default.dest1
 
   Stage: Stage-5
     Conditional Operator
diff --git a/ql/src/test/results/clientpositive/input_testxpath4.q.out b/ql/src/test/results/clientpositive/input_testxpath4.q.out
index 0220df5af4..e432643236 100644
--- a/ql/src/test/results/clientpositive/input_testxpath4.q.out
+++ b/ql/src/test/results/clientpositive/input_testxpath4.q.out
@@ -107,23 +107,19 @@ STAGE PLANS:
               predicate:
                   expr: ((mstringstring['key_9'] is not null and lintstring.myint is not null) and lintstring is not null)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: ((mstringstring['key_9'] is not null and lintstring.myint is not null) and lintstring is not null)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: mstringstring['key_9']
-                        type: string
-                        expr: lintstring.myint
-                        type: array<int>
-                  outputColumnNames: _col0, _col1
-                  File Output Operator
-                    compressed: false
-                    GlobalTableId: 0
-                    table:
-                        input format: org.apache.hadoop.mapred.TextInputFormat
-                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+              Select Operator
+                expressions:
+                      expr: mstringstring['key_9']
+                      type: string
+                      expr: lintstring.myint
+                      type: array<int>
+                outputColumnNames: _col0, _col1
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 0
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
 
   Stage: Stage-0
     Fetch Operator
diff --git a/ql/src/test/results/clientpositive/join0.q.out b/ql/src/test/results/clientpositive/join0.q.out
index 1fc29231ad..1351b86cd8 100644
--- a/ql/src/test/results/clientpositive/join0.q.out
+++ b/ql/src/test/results/clientpositive/join0.q.out
@@ -33,25 +33,21 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  sort order: 
+                  tag: 0
+                  value expressions:
+                        expr: _col0
                         type: string
-                        expr: value
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    sort order: 
-                    tag: 0
-                    value expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
         src2:src 
           TableScan
             alias: src
@@ -59,25 +55,21 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  sort order: 
+                  tag: 1
+                  value expressions:
+                        expr: _col0
                         type: string
-                        expr: value
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    sort order: 
-                    tag: 1
-                    value expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
       Reduce Operator Tree:
         Join Operator
           condition map:
diff --git a/ql/src/test/results/clientpositive/join11.q.out b/ql/src/test/results/clientpositive/join11.q.out
index ea83748ef3..6b25351377 100644
--- a/ql/src/test/results/clientpositive/join11.q.out
+++ b/ql/src/test/results/clientpositive/join11.q.out
@@ -37,22 +37,18 @@ STAGE PLANS:
                       expr: key
                       type: string
                 outputColumnNames: _col0
-                Filter Operator
-                  predicate:
-                      expr: (_col0 < 100)
-                      type: boolean
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: 0
-                    value expressions:
-                          expr: _col0
-                          type: string
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: 0
+                  value expressions:
+                        expr: _col0
+                        type: string
         src2:src 
           TableScan
             alias: src
diff --git a/ql/src/test/results/clientpositive/join12.q.out b/ql/src/test/results/clientpositive/join12.q.out
index 49cf7d5eb3..cb9d014658 100644
--- a/ql/src/test/results/clientpositive/join12.q.out
+++ b/ql/src/test/results/clientpositive/join12.q.out
@@ -43,22 +43,18 @@ STAGE PLANS:
                       expr: key
                       type: string
                 outputColumnNames: _col0
-                Filter Operator
-                  predicate:
-                      expr: (_col0 < 100)
-                      type: boolean
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: 0
-                    value expressions:
-                          expr: _col0
-                          type: string
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: 0
+                  value expressions:
+                        expr: _col0
+                        type: string
         src2:src 
           TableScan
             alias: src
@@ -93,19 +89,15 @@ STAGE PLANS:
                       expr: key
                       type: string
                 outputColumnNames: _col0
-                Filter Operator
-                  predicate:
-                      expr: (_col0 < 80)
-                      type: boolean
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: 2
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: 2
       Reduce Operator Tree:
         Join Operator
           condition map:
diff --git a/ql/src/test/results/clientpositive/join13.q.out b/ql/src/test/results/clientpositive/join13.q.out
index 3b057aeff0..e336ff97e5 100644
--- a/ql/src/test/results/clientpositive/join13.q.out
+++ b/ql/src/test/results/clientpositive/join13.q.out
@@ -44,22 +44,18 @@ STAGE PLANS:
                       expr: key
                       type: string
                 outputColumnNames: _col0
-                Filter Operator
-                  predicate:
-                      expr: (_col0 < 100)
-                      type: boolean
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: 0
-                    value expressions:
-                          expr: _col0
-                          type: string
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: 0
+                  value expressions:
+                        expr: _col0
+                        type: string
         src2:src 
           TableScan
             alias: src
@@ -130,19 +126,15 @@ STAGE PLANS:
                       expr: key
                       type: string
                 outputColumnNames: _col0
-                Filter Operator
-                  predicate:
-                      expr: (_col0 < 200)
-                      type: boolean
-                  Reduce Output Operator
-                    key expressions:
-                          expr: UDFToDouble(_col0)
-                          type: double
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: UDFToDouble(_col0)
-                          type: double
-                    tag: 1
+                Reduce Output Operator
+                  key expressions:
+                        expr: UDFToDouble(_col0)
+                        type: double
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: UDFToDouble(_col0)
+                        type: double
+                  tag: 1
       Reduce Operator Tree:
         Join Operator
           condition map:
diff --git a/ql/src/test/results/clientpositive/join14.q.out b/ql/src/test/results/clientpositive/join14.q.out
index d079b632c0..83d1d92f2f 100644
--- a/ql/src/test/results/clientpositive/join14.q.out
+++ b/ql/src/test/results/clientpositive/join14.q.out
@@ -30,29 +30,6 @@ STAGE PLANS:
               predicate:
                   expr: (key > 100)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key > 100)
-                    type: boolean
-                Reduce Output Operator
-                  key expressions:
-                        expr: key
-                        type: string
-                  sort order: +
-                  Map-reduce partition columns:
-                        expr: key
-                        type: string
-                  tag: 0
-                  value expressions:
-                        expr: key
-                        type: string
-        srcpart 
-          TableScan
-            alias: srcpart
-            Filter Operator
-              predicate:
-                  expr: (ds = '2008-04-08')
-                  type: boolean
               Reduce Output Operator
                 key expressions:
                       expr: key
@@ -61,10 +38,25 @@ STAGE PLANS:
                 Map-reduce partition columns:
                       expr: key
                       type: string
-                tag: 1
+                tag: 0
                 value expressions:
-                      expr: value
+                      expr: key
                       type: string
+        srcpart 
+          TableScan
+            alias: srcpart
+            Reduce Output Operator
+              key expressions:
+                    expr: key
+                    type: string
+              sort order: +
+              Map-reduce partition columns:
+                    expr: key
+                    type: string
+              tag: 1
+              value expressions:
+                    expr: value
+                    type: string
       Reduce Operator Tree:
         Join Operator
           condition map:
diff --git a/ql/src/test/results/clientpositive/join16.q.out b/ql/src/test/results/clientpositive/join16.q.out
index f1334b4ff2..003c0b45b3 100644
--- a/ql/src/test/results/clientpositive/join16.q.out
+++ b/ql/src/test/results/clientpositive/join16.q.out
@@ -20,37 +20,29 @@ STAGE PLANS:
               predicate:
                   expr: ((key > 10) and (key > 20))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key > 10)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col1
+                        type: string
+                  sort order: ++
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                        expr: _col1
                         type: string
-                        expr: value
+                  tag: 0
+                  value expressions:
+                        expr: _col0
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Filter Operator
-                    predicate:
-                        expr: (_col0 > 20)
-                        type: boolean
-                    Reduce Output Operator
-                      key expressions:
-                            expr: _col0
-                            type: string
-                            expr: _col1
-                            type: string
-                      sort order: ++
-                      Map-reduce partition columns:
-                            expr: _col0
-                            type: string
-                            expr: _col1
-                            type: string
-                      tag: 0
-                      value expressions:
-                            expr: _col0
-                            type: string
         tab 
           TableScan
             alias: tab
@@ -83,23 +75,19 @@ STAGE PLANS:
             1 {VALUE._col1}
           handleSkewJoin: false
           outputColumnNames: _col0, _col3
-          Filter Operator
-            predicate:
-                expr: (_col3 < 200)
-                type: boolean
-            Select Operator
-              expressions:
-                    expr: _col0
-                    type: string
-                    expr: _col3
-                    type: string
-              outputColumnNames: _col0, _col1
-              File Output Operator
-                compressed: false
-                GlobalTableId: 0
-                table:
-                    input format: org.apache.hadoop.mapred.TextInputFormat
-                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+          Select Operator
+            expressions:
+                  expr: _col0
+                  type: string
+                  expr: _col3
+                  type: string
+            outputColumnNames: _col0, _col1
+            File Output Operator
+              compressed: false
+              GlobalTableId: 0
+              table:
+                  input format: org.apache.hadoop.mapred.TextInputFormat
+                  output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
 
   Stage: Stage-0
     Fetch Operator
diff --git a/ql/src/test/results/clientpositive/join19.q.out b/ql/src/test/results/clientpositive/join19.q.out
index fd4e7d9094..fc4efde2d1 100644
--- a/ql/src/test/results/clientpositive/join19.q.out
+++ b/ql/src/test/results/clientpositive/join19.q.out
@@ -135,27 +135,23 @@ STAGE PLANS:
               predicate:
                   expr: ((predicate = 'http://sofa.semanticweb.org/sofa/v1.0/system#__INSTANCEOF_REL') and (object = 'http://ontos/OntosMiner/Common.English/ontology#Citation'))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: ((predicate = 'http://sofa.semanticweb.org/sofa/v1.0/system#__INSTANCEOF_REL') and (object = 'http://ontos/OntosMiner/Common.English/ontology#Citation'))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: subject
+              Select Operator
+                expressions:
+                      expr: subject
+                      type: string
+                outputColumnNames: _col0
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: 0
+                  value expressions:
+                        expr: _col0
                         type: string
-                  outputColumnNames: _col0
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: 0
-                    value expressions:
-                          expr: _col0
-                          type: string
         t22:t2 
           TableScan
             alias: t2
@@ -163,29 +159,25 @@ STAGE PLANS:
               predicate:
                   expr: (predicate = 'http://sofa.semanticweb.org/sofa/v1.0/system#__LABEL_REL')
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (predicate = 'http://sofa.semanticweb.org/sofa/v1.0/system#__LABEL_REL')
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: subject
+              Select Operator
+                expressions:
+                      expr: subject
+                      type: string
+                      expr: object
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
                         type: string
-                        expr: object
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: 1
+                  value expressions:
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: 1
-                    value expressions:
-                          expr: _col1
-                          type: string
         t33:t3 
           TableScan
             alias: t3
@@ -193,29 +185,25 @@ STAGE PLANS:
               predicate:
                   expr: (predicate = 'http://www.ontosearch.com/2007/12/ontosofa-ns#_from')
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (predicate = 'http://www.ontosearch.com/2007/12/ontosofa-ns#_from')
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: subject
+              Select Operator
+                expressions:
+                      expr: subject
+                      type: string
+                      expr: object
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col1
+                        type: string
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col1
                         type: string
-                        expr: object
+                  tag: 2
+                  value expressions:
+                        expr: _col0
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col1
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col1
-                          type: string
-                    tag: 2
-                    value expressions:
-                          expr: _col0
-                          type: string
       Reduce Operator Tree:
         Join Operator
           condition map:
@@ -261,24 +249,20 @@ STAGE PLANS:
               predicate:
                   expr: ((predicate = 'http://sofa.semanticweb.org/sofa/v1.0/system#__INSTANCEOF_REL') and (object = 'http://ontos/OntosMiner/Common.English/ontology#Author'))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: ((predicate = 'http://sofa.semanticweb.org/sofa/v1.0/system#__INSTANCEOF_REL') and (object = 'http://ontos/OntosMiner/Common.English/ontology#Author'))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: subject
+              Select Operator
+                expressions:
+                      expr: subject
+                      type: string
+                outputColumnNames: _col0
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
                         type: string
-                  outputColumnNames: _col0
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: 1
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: 1
         t55:t5 
           TableScan
             alias: t5
@@ -286,29 +270,25 @@ STAGE PLANS:
               predicate:
                   expr: (predicate = 'http://www.ontosearch.com/2007/12/ontosofa-ns#_to')
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (predicate = 'http://www.ontosearch.com/2007/12/ontosofa-ns#_to')
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: subject
+              Select Operator
+                expressions:
+                      expr: subject
+                      type: string
+                      expr: object
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
                         type: string
-                        expr: object
+                  tag: 2
+                  value expressions:
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: 2
-                    value expressions:
-                          expr: _col1
-                          type: string
       Reduce Operator Tree:
         Join Operator
           condition map:
@@ -356,29 +336,25 @@ STAGE PLANS:
               predicate:
                   expr: (predicate = 'http://sofa.semanticweb.org/sofa/v1.0/system#__LABEL_REL')
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (predicate = 'http://sofa.semanticweb.org/sofa/v1.0/system#__LABEL_REL')
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: subject
+              Select Operator
+                expressions:
+                      expr: subject
+                      type: string
+                      expr: object
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
                         type: string
-                        expr: object
+                  tag: 1
+                  value expressions:
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: 1
-                    value expressions:
-                          expr: _col1
-                          type: string
       Reduce Operator Tree:
         Join Operator
           condition map:
diff --git a/ql/src/test/results/clientpositive/join20.q.out b/ql/src/test/results/clientpositive/join20.q.out
index f360af29ec..0f9004ddf2 100644
--- a/ql/src/test/results/clientpositive/join20.q.out
+++ b/ql/src/test/results/clientpositive/join20.q.out
@@ -25,24 +25,20 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                Reduce Output Operator
-                  key expressions:
-                        expr: key
-                        type: string
-                  sort order: +
-                  Map-reduce partition columns:
-                        expr: key
-                        type: string
-                  tag: 0
-                  value expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
+              Reduce Output Operator
+                key expressions:
+                      expr: key
+                      type: string
+                sort order: +
+                Map-reduce partition columns:
+                      expr: key
+                      type: string
+                tag: 0
+                value expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
         src2 
           TableScan
             alias: src2
@@ -746,24 +742,20 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                Reduce Output Operator
-                  key expressions:
-                        expr: key
-                        type: string
-                  sort order: +
-                  Map-reduce partition columns:
-                        expr: key
-                        type: string
-                  tag: 0
-                  value expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
+              Reduce Output Operator
+                key expressions:
+                      expr: key
+                      type: string
+                sort order: +
+                Map-reduce partition columns:
+                      expr: key
+                      type: string
+                tag: 0
+                value expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
         src2 
           TableScan
             alias: src2
@@ -771,24 +763,20 @@ STAGE PLANS:
               predicate:
                   expr: (key < 15)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 15)
-                    type: boolean
-                Reduce Output Operator
-                  key expressions:
-                        expr: key
-                        type: string
-                  sort order: +
-                  Map-reduce partition columns:
-                        expr: key
-                        type: string
-                  tag: 1
-                  value expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
+              Reduce Output Operator
+                key expressions:
+                      expr: key
+                      type: string
+                sort order: +
+                Map-reduce partition columns:
+                      expr: key
+                      type: string
+                tag: 1
+                value expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
         src3 
           TableScan
             alias: src3
diff --git a/ql/src/test/results/clientpositive/join21.q.out b/ql/src/test/results/clientpositive/join21.q.out
index 235baa5c5e..f9b379d490 100644
--- a/ql/src/test/results/clientpositive/join21.q.out
+++ b/ql/src/test/results/clientpositive/join21.q.out
@@ -40,24 +40,20 @@ STAGE PLANS:
               predicate:
                   expr: (key > 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key > 10)
-                    type: boolean
-                Reduce Output Operator
-                  key expressions:
-                        expr: key
-                        type: string
-                  sort order: +
-                  Map-reduce partition columns:
-                        expr: key
-                        type: string
-                  tag: 1
-                  value expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
+              Reduce Output Operator
+                key expressions:
+                      expr: key
+                      type: string
+                sort order: +
+                Map-reduce partition columns:
+                      expr: key
+                      type: string
+                tag: 1
+                value expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
         src3 
           TableScan
             alias: src3
diff --git a/ql/src/test/results/clientpositive/join23.q.out b/ql/src/test/results/clientpositive/join23.q.out
index cdfc94928d..64dd5314ac 100644
--- a/ql/src/test/results/clientpositive/join23.q.out
+++ b/ql/src/test/results/clientpositive/join23.q.out
@@ -55,27 +55,23 @@ STAGE PLANS:
             1 {VALUE._col0} {VALUE._col1}
           handleSkewJoin: false
           outputColumnNames: _col0, _col1, _col4, _col5
-          Filter Operator
-            predicate:
-                expr: ((_col0 < 10) and (_col4 < 10))
-                type: boolean
-            Select Operator
-              expressions:
-                    expr: _col0
-                    type: string
-                    expr: _col1
-                    type: string
-                    expr: _col4
-                    type: string
-                    expr: _col5
-                    type: string
-              outputColumnNames: _col0, _col1, _col2, _col3
-              File Output Operator
-                compressed: false
-                GlobalTableId: 0
-                table:
-                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
-                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+          Select Operator
+            expressions:
+                  expr: _col0
+                  type: string
+                  expr: _col1
+                  type: string
+                  expr: _col4
+                  type: string
+                  expr: _col5
+                  type: string
+            outputColumnNames: _col0, _col1, _col2, _col3
+            File Output Operator
+              compressed: false
+              GlobalTableId: 0
+              table:
+                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
 
   Stage: Stage-2
     Map Reduce
diff --git a/ql/src/test/results/clientpositive/join26.q.out b/ql/src/test/results/clientpositive/join26.q.out
index b3ad98530c..7fc3b72022 100644
--- a/ql/src/test/results/clientpositive/join26.q.out
+++ b/ql/src/test/results/clientpositive/join26.q.out
@@ -76,75 +76,65 @@ STAGE PLANS:
           TableScan
             alias: z
             GatherStats: false
-            Filter Operator
-              isSamplingPred: false
-              predicate:
-                  expr: (ds = '2008-04-08')
-                  type: boolean
-              Filter Operator
-                isSamplingPred: false
-                predicate:
-                    expr: (hr = 11)
-                    type: boolean
-                Map Join Operator
-                  condition map:
-                       Inner Join 0 to 1
-                       Inner Join 0 to 2
-                  condition expressions:
-                    0 {key}
-                    1 {value}
-                    2 {value}
-                  handleSkewJoin: false
-                  keys:
-                    0 [Column[key]]
-                    1 [Column[key]]
-                    2 [Column[key]]
-                  outputColumnNames: _col0, _col5, _col9
-                  Position of Big Table: 2
-                  Select Operator
-                    expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col5
-                          type: string
-                          expr: _col9
-                          type: string
-                    outputColumnNames: _col0, _col5, _col9
-                    Select Operator
-                      expressions:
-                            expr: _col0
-                            type: string
-                            expr: _col9
-                            type: string
-                            expr: _col5
-                            type: string
-                      outputColumnNames: _col0, _col1, _col2
-                      File Output Operator
-                        compressed: false
-                        GlobalTableId: 1
-                        directory: pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-02-10_16-03-56_680_8440893894140638044/-ext-10002
-                        NumFilesPerFileSink: 1
-                        Stats Publishing Key Prefix: pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-02-10_16-03-56_680_8440893894140638044/-ext-10000/
-                        table:
-                            input format: org.apache.hadoop.mapred.TextInputFormat
-                            output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                            properties:
-                              bucket_count -1
-                              columns key,value,val2
-                              columns.types string:string:string
-                              file.inputformat org.apache.hadoop.mapred.TextInputFormat
-                              file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                              location pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/dest_j1
-                              name default.dest_j1
-                              serialization.ddl struct dest_j1 { string key, string value, string val2}
-                              serialization.format 1
-                              serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                              transient_lastDdlTime 1297382636
-                            serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                            name: default.dest_j1
-                        TotalFiles: 1
-                        GatherStats: true
-                        MultiFileSpray: false
+            Map Join Operator
+              condition map:
+                   Inner Join 0 to 1
+                   Inner Join 0 to 2
+              condition expressions:
+                0 {key}
+                1 {value}
+                2 {value}
+              handleSkewJoin: false
+              keys:
+                0 [Column[key]]
+                1 [Column[key]]
+                2 [Column[key]]
+              outputColumnNames: _col0, _col5, _col9
+              Position of Big Table: 2
+              Select Operator
+                expressions:
+                      expr: _col0
+                      type: string
+                      expr: _col5
+                      type: string
+                      expr: _col9
+                      type: string
+                outputColumnNames: _col0, _col5, _col9
+                Select Operator
+                  expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col9
+                        type: string
+                        expr: _col5
+                        type: string
+                  outputColumnNames: _col0, _col1, _col2
+                  File Output Operator
+                    compressed: false
+                    GlobalTableId: 1
+                    directory: pfile:/Users/amarsri/Documents/workspace/hive/build/ql/scratchdir/hive_2011-03-17_09-25-32_631_7413274741403705596/-ext-10002
+                    NumFilesPerFileSink: 1
+                    Stats Publishing Key Prefix: pfile:/Users/amarsri/Documents/workspace/hive/build/ql/scratchdir/hive_2011-03-17_09-25-32_631_7413274741403705596/-ext-10000/
+                    table:
+                        input format: org.apache.hadoop.mapred.TextInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                        properties:
+                          bucket_count -1
+                          columns key,value,val2
+                          columns.types string:string:string
+                          file.inputformat org.apache.hadoop.mapred.TextInputFormat
+                          file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                          location pfile:/Users/amarsri/Documents/workspace/hive/build/ql/test/data/warehouse/dest_j1
+                          name default.dest_j1
+                          serialization.ddl struct dest_j1 { string key, string value, string val2}
+                          serialization.format 1
+                          serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                          transient_lastDdlTime 1300379132
+                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                        name: default.dest_j1
+                    TotalFiles: 1
+                    GatherStats: true
+                    MultiFileSpray: false
       Local Work:
         Map Reduce Local Work
       Needs Tagging: false
diff --git a/ql/src/test/results/clientpositive/join28.q.out b/ql/src/test/results/clientpositive/join28.q.out
index 853c4a224d..c980b78853 100644
--- a/ql/src/test/results/clientpositive/join28.q.out
+++ b/ql/src/test/results/clientpositive/join28.q.out
@@ -57,23 +57,15 @@ STAGE PLANS:
         z 
           TableScan
             alias: z
-            Filter Operator
-              predicate:
-                  expr: (ds = '2008-04-08')
-                  type: boolean
-              Filter Operator
-                predicate:
-                    expr: (hr = 11)
-                    type: boolean
-                HashTable Sink Operator
-                  condition expressions:
-                    0 {_col0}
-                    1 {value}
-                  handleSkewJoin: false
-                  keys:
-                    0 [Column[_col0]]
-                    1 [Column[key]]
-                  Position of Big Table: 0
+            HashTable Sink Operator
+              condition expressions:
+                0 {_col0}
+                1 {value}
+              handleSkewJoin: false
+              keys:
+                0 [Column[_col0]]
+                1 [Column[key]]
+              Position of Big Table: 0
 
   Stage: Stage-1
     Map Reduce
diff --git a/ql/src/test/results/clientpositive/join32.q.out b/ql/src/test/results/clientpositive/join32.q.out
index bf7220bb76..a73b2f020b 100644
--- a/ql/src/test/results/clientpositive/join32.q.out
+++ b/ql/src/test/results/clientpositive/join32.q.out
@@ -139,25 +139,15 @@ STAGE PLANS:
           TableScan
             alias: z
             GatherStats: false
-            Filter Operator
-              isSamplingPred: false
-              predicate:
-                  expr: (ds = '2008-04-08')
-                  type: boolean
-              Filter Operator
-                isSamplingPred: false
-                predicate:
-                    expr: (hr = 11)
-                    type: boolean
-                HashTable Sink Operator
-                  condition expressions:
-                    0 {_col5} {_col0}
-                    1 {value}
-                  handleSkewJoin: false
-                  keys:
-                    0 [Column[_col1]]
-                    1 [Column[value]]
-                  Position of Big Table: 0
+            HashTable Sink Operator
+              condition expressions:
+                0 {_col5} {_col0}
+                1 {value}
+              handleSkewJoin: false
+              keys:
+                0 [Column[_col1]]
+                1 [Column[value]]
+              Position of Big Table: 0
 
   Stage: Stage-1
     Map Reduce
diff --git a/ql/src/test/results/clientpositive/join33.q.out b/ql/src/test/results/clientpositive/join33.q.out
index db675f6bea..4e999046d7 100644
--- a/ql/src/test/results/clientpositive/join33.q.out
+++ b/ql/src/test/results/clientpositive/join33.q.out
@@ -155,28 +155,18 @@ STAGE PLANS:
           TableScan
             alias: z
             GatherStats: false
-            Filter Operator
-              isSamplingPred: false
-              predicate:
-                  expr: (ds = '2008-04-08')
-                  type: boolean
-              Filter Operator
-                isSamplingPred: false
-                predicate:
-                    expr: (hr = 11)
-                    type: boolean
-                Reduce Output Operator
-                  key expressions:
-                        expr: value
-                        type: string
-                  sort order: +
-                  Map-reduce partition columns:
-                        expr: value
-                        type: string
-                  tag: 1
-                  value expressions:
-                        expr: value
-                        type: string
+            Reduce Output Operator
+              key expressions:
+                    expr: value
+                    type: string
+              sort order: +
+              Map-reduce partition columns:
+                    expr: value
+                    type: string
+              tag: 1
+              value expressions:
+                    expr: value
+                    type: string
       Needs Tagging: true
       Path -> Alias:
         file:/tmp/sdong/hive_2011-02-10_16-05-42_624_7730493356150230026/-mr-10002 [file:/tmp/sdong/hive_2011-02-10_16-05-42_624_7730493356150230026/-mr-10002]
diff --git a/ql/src/test/results/clientpositive/join34.q.out b/ql/src/test/results/clientpositive/join34.q.out
index 301192fd49..77250caf4e 100644
--- a/ql/src/test/results/clientpositive/join34.q.out
+++ b/ql/src/test/results/clientpositive/join34.q.out
@@ -69,75 +69,70 @@ STAGE PLANS:
               predicate:
                   expr: (key < 20)
                   type: boolean
-              Filter Operator
-                isSamplingPred: false
-                predicate:
-                    expr: (key < 20)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
-                  outputColumnNames: _col0, _col1
-                  Union
-                    Map Join Operator
-                      condition map:
-                           Inner Join 0 to 1
-                      condition expressions:
-                        0 {_col1}
-                        1 {key} {value}
-                      handleSkewJoin: false
-                      keys:
-                        0 [Column[_col0]]
-                        1 [Column[key]]
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Union
+                  Map Join Operator
+                    condition map:
+                         Inner Join 0 to 1
+                    condition expressions:
+                      0 {_col1}
+                      1 {key} {value}
+                    handleSkewJoin: false
+                    keys:
+                      0 [Column[_col0]]
+                      1 [Column[key]]
+                    outputColumnNames: _col1, _col2, _col3
+                    Position of Big Table: 0
+                    Select Operator
+                      expressions:
+                            expr: _col1
+                            type: string
+                            expr: _col2
+                            type: string
+                            expr: _col3
+                            type: string
                       outputColumnNames: _col1, _col2, _col3
-                      Position of Big Table: 0
                       Select Operator
                         expressions:
-                              expr: _col1
-                              type: string
                               expr: _col2
                               type: string
                               expr: _col3
                               type: string
-                        outputColumnNames: _col1, _col2, _col3
-                        Select Operator
-                          expressions:
-                                expr: _col2
-                                type: string
-                                expr: _col3
-                                type: string
-                                expr: _col1
-                                type: string
-                          outputColumnNames: _col0, _col1, _col2
-                          File Output Operator
-                            compressed: false
-                            GlobalTableId: 1
-                            directory: pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-02-10_16-05-57_676_6075966104051319240/-ext-10002
-                            NumFilesPerFileSink: 1
-                            Stats Publishing Key Prefix: pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-02-10_16-05-57_676_6075966104051319240/-ext-10000/
-                            table:
-                                input format: org.apache.hadoop.mapred.TextInputFormat
-                                output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                                properties:
-                                  bucket_count -1
-                                  columns key,value,val2
-                                  columns.types string:string:string
-                                  file.inputformat org.apache.hadoop.mapred.TextInputFormat
-                                  file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                                  location pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/dest_j1
-                                  name default.dest_j1
-                                  serialization.ddl struct dest_j1 { string key, string value, string val2}
-                                  serialization.format 1
-                                  serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                                  transient_lastDdlTime 1297382757
-                                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                                name: default.dest_j1
-                            TotalFiles: 1
-                            GatherStats: true
-                            MultiFileSpray: false
+                              expr: _col1
+                              type: string
+                        outputColumnNames: _col0, _col1, _col2
+                        File Output Operator
+                          compressed: false
+                          GlobalTableId: 1
+                          directory: pfile:/Users/amarsri/Documents/workspace/hive/build/ql/scratchdir/hive_2011-03-17_09-30-27_511_6544642459407208280/-ext-10002
+                          NumFilesPerFileSink: 1
+                          Stats Publishing Key Prefix: pfile:/Users/amarsri/Documents/workspace/hive/build/ql/scratchdir/hive_2011-03-17_09-30-27_511_6544642459407208280/-ext-10000/
+                          table:
+                              input format: org.apache.hadoop.mapred.TextInputFormat
+                              output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                              properties:
+                                bucket_count -1
+                                columns key,value,val2
+                                columns.types string:string:string
+                                file.inputformat org.apache.hadoop.mapred.TextInputFormat
+                                file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                                location pfile:/Users/amarsri/Documents/workspace/hive/build/ql/test/data/warehouse/dest_j1
+                                name default.dest_j1
+                                serialization.ddl struct dest_j1 { string key, string value, string val2}
+                                serialization.format 1
+                                serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                                transient_lastDdlTime 1300379427
+                              serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                              name: default.dest_j1
+                          TotalFiles: 1
+                          GatherStats: true
+                          MultiFileSpray: false
         null-subquery2:subq1-subquery2:x1 
           TableScan
             alias: x1
@@ -147,75 +142,70 @@ STAGE PLANS:
               predicate:
                   expr: (key > 100)
                   type: boolean
-              Filter Operator
-                isSamplingPred: false
-                predicate:
-                    expr: (key > 100)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
-                  outputColumnNames: _col0, _col1
-                  Union
-                    Map Join Operator
-                      condition map:
-                           Inner Join 0 to 1
-                      condition expressions:
-                        0 {_col1}
-                        1 {key} {value}
-                      handleSkewJoin: false
-                      keys:
-                        0 [Column[_col0]]
-                        1 [Column[key]]
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Union
+                  Map Join Operator
+                    condition map:
+                         Inner Join 0 to 1
+                    condition expressions:
+                      0 {_col1}
+                      1 {key} {value}
+                    handleSkewJoin: false
+                    keys:
+                      0 [Column[_col0]]
+                      1 [Column[key]]
+                    outputColumnNames: _col1, _col2, _col3
+                    Position of Big Table: 0
+                    Select Operator
+                      expressions:
+                            expr: _col1
+                            type: string
+                            expr: _col2
+                            type: string
+                            expr: _col3
+                            type: string
                       outputColumnNames: _col1, _col2, _col3
-                      Position of Big Table: 0
                       Select Operator
                         expressions:
-                              expr: _col1
-                              type: string
                               expr: _col2
                               type: string
                               expr: _col3
                               type: string
-                        outputColumnNames: _col1, _col2, _col3
-                        Select Operator
-                          expressions:
-                                expr: _col2
-                                type: string
-                                expr: _col3
-                                type: string
-                                expr: _col1
-                                type: string
-                          outputColumnNames: _col0, _col1, _col2
-                          File Output Operator
-                            compressed: false
-                            GlobalTableId: 1
-                            directory: pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-02-10_16-05-57_676_6075966104051319240/-ext-10002
-                            NumFilesPerFileSink: 1
-                            Stats Publishing Key Prefix: pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-02-10_16-05-57_676_6075966104051319240/-ext-10000/
-                            table:
-                                input format: org.apache.hadoop.mapred.TextInputFormat
-                                output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                                properties:
-                                  bucket_count -1
-                                  columns key,value,val2
-                                  columns.types string:string:string
-                                  file.inputformat org.apache.hadoop.mapred.TextInputFormat
-                                  file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                                  location pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/dest_j1
-                                  name default.dest_j1
-                                  serialization.ddl struct dest_j1 { string key, string value, string val2}
-                                  serialization.format 1
-                                  serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                                  transient_lastDdlTime 1297382757
-                                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                                name: default.dest_j1
-                            TotalFiles: 1
-                            GatherStats: true
-                            MultiFileSpray: false
+                              expr: _col1
+                              type: string
+                        outputColumnNames: _col0, _col1, _col2
+                        File Output Operator
+                          compressed: false
+                          GlobalTableId: 1
+                          directory: pfile:/Users/amarsri/Documents/workspace/hive/build/ql/scratchdir/hive_2011-03-17_09-30-27_511_6544642459407208280/-ext-10002
+                          NumFilesPerFileSink: 1
+                          Stats Publishing Key Prefix: pfile:/Users/amarsri/Documents/workspace/hive/build/ql/scratchdir/hive_2011-03-17_09-30-27_511_6544642459407208280/-ext-10000/
+                          table:
+                              input format: org.apache.hadoop.mapred.TextInputFormat
+                              output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                              properties:
+                                bucket_count -1
+                                columns key,value,val2
+                                columns.types string:string:string
+                                file.inputformat org.apache.hadoop.mapred.TextInputFormat
+                                file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                                location pfile:/Users/amarsri/Documents/workspace/hive/build/ql/test/data/warehouse/dest_j1
+                                name default.dest_j1
+                                serialization.ddl struct dest_j1 { string key, string value, string val2}
+                                serialization.format 1
+                                serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                                transient_lastDdlTime 1300379427
+                              serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                              name: default.dest_j1
+                          TotalFiles: 1
+                          GatherStats: true
+                          MultiFileSpray: false
       Local Work:
         Map Reduce Local Work
       Needs Tagging: false
diff --git a/ql/src/test/results/clientpositive/join35.q.out b/ql/src/test/results/clientpositive/join35.q.out
index 0ffeff652d..9f7e23465b 100644
--- a/ql/src/test/results/clientpositive/join35.q.out
+++ b/ql/src/test/results/clientpositive/join35.q.out
@@ -50,37 +50,32 @@ STAGE PLANS:
               predicate:
                   expr: (key < 20)
                   type: boolean
-              Filter Operator
-                isSamplingPred: false
-                predicate:
-                    expr: (key < 20)
-                    type: boolean
-                Select Operator
-                  expressions:
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                outputColumnNames: key
+                Group By Operator
+                  aggregations:
+                        expr: count(1)
+                  bucketGroup: false
+                  keys:
                         expr: key
                         type: string
-                  outputColumnNames: key
-                  Group By Operator
-                    aggregations:
-                          expr: count(1)
-                    bucketGroup: false
-                    keys:
-                          expr: key
+                  mode: hash
+                  outputColumnNames: _col0, _col1
+                  Reduce Output Operator
+                    key expressions:
+                          expr: _col0
+                          type: string
+                    sort order: +
+                    Map-reduce partition columns:
+                          expr: _col0
                           type: string
-                    mode: hash
-                    outputColumnNames: _col0, _col1
-                    Reduce Output Operator
-                      key expressions:
-                            expr: _col0
-                            type: string
-                      sort order: +
-                      Map-reduce partition columns:
-                            expr: _col0
-                            type: string
-                      tag: -1
-                      value expressions:
-                            expr: _col1
-                            type: bigint
+                    tag: -1
+                    value expressions:
+                          expr: _col1
+                          type: bigint
       Needs Tagging: false
       Path -> Alias:
         pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src [null-subquery1:subq1-subquery1:x]
@@ -472,37 +467,32 @@ STAGE PLANS:
               predicate:
                   expr: (key > 100)
                   type: boolean
-              Filter Operator
-                isSamplingPred: false
-                predicate:
-                    expr: (key > 100)
-                    type: boolean
-                Select Operator
-                  expressions:
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                outputColumnNames: key
+                Group By Operator
+                  aggregations:
+                        expr: count(1)
+                  bucketGroup: false
+                  keys:
                         expr: key
                         type: string
-                  outputColumnNames: key
-                  Group By Operator
-                    aggregations:
-                          expr: count(1)
-                    bucketGroup: false
-                    keys:
-                          expr: key
+                  mode: hash
+                  outputColumnNames: _col0, _col1
+                  Reduce Output Operator
+                    key expressions:
+                          expr: _col0
+                          type: string
+                    sort order: +
+                    Map-reduce partition columns:
+                          expr: _col0
                           type: string
-                    mode: hash
-                    outputColumnNames: _col0, _col1
-                    Reduce Output Operator
-                      key expressions:
-                            expr: _col0
-                            type: string
-                      sort order: +
-                      Map-reduce partition columns:
-                            expr: _col0
-                            type: string
-                      tag: -1
-                      value expressions:
-                            expr: _col1
-                            type: bigint
+                    tag: -1
+                    value expressions:
+                          expr: _col1
+                          type: bigint
       Needs Tagging: false
       Path -> Alias:
         pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src [null-subquery2:subq1-subquery2:x1]
diff --git a/ql/src/test/results/clientpositive/join38.q.out b/ql/src/test/results/clientpositive/join38.q.out
index 7f05cef034..93853270d2 100644
--- a/ql/src/test/results/clientpositive/join38.q.out
+++ b/ql/src/test/results/clientpositive/join38.q.out
@@ -143,44 +143,40 @@ STAGE PLANS:
                   expr: _col15
                   type: string
             outputColumnNames: _col1, _col9, _col15
-            Filter Operator
-              predicate:
-                  expr: (_col15 = 111)
-                  type: boolean
-              Select Operator
-                expressions:
+            Select Operator
+              expressions:
+                    expr: _col1
+                    type: string
+                    expr: _col9
+                    type: string
+              outputColumnNames: _col1, _col9
+              Group By Operator
+                aggregations:
+                      expr: count(1)
+                bucketGroup: false
+                keys:
                       expr: _col1
                       type: string
                       expr: _col9
                       type: string
-                outputColumnNames: _col1, _col9
-                Group By Operator
-                  aggregations:
-                        expr: count(1)
-                  bucketGroup: false
-                  keys:
+                mode: hash
+                outputColumnNames: _col0, _col1, _col2
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
                         expr: _col1
                         type: string
-                        expr: _col9
+                  sort order: ++
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                        expr: _col1
                         type: string
-                  mode: hash
-                  outputColumnNames: _col0, _col1, _col2
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
-                    sort order: ++
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
-                    tag: -1
-                    value expressions:
-                          expr: _col2
-                          type: bigint
+                  tag: -1
+                  value expressions:
+                        expr: _col2
+                        type: bigint
       Reduce Operator Tree:
         Group By Operator
           aggregations:
diff --git a/ql/src/test/results/clientpositive/join39.q.out b/ql/src/test/results/clientpositive/join39.q.out
index b2d8235e82..7609334f8b 100644
--- a/ql/src/test/results/clientpositive/join39.q.out
+++ b/ql/src/test/results/clientpositive/join39.q.out
@@ -40,26 +40,22 @@ STAGE PLANS:
               predicate:
                   expr: (key <= 100)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key <= 100)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
-                  outputColumnNames: _col0, _col1
-                  HashTable Sink Operator
-                    condition expressions:
-                      0 {key} {value}
-                      1 {_col0} {_col1}
-                    handleSkewJoin: false
-                    keys:
-                      0 [Column[key]]
-                      1 [Column[_col0]]
-                    Position of Big Table: 0
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                HashTable Sink Operator
+                  condition expressions:
+                    0 {key} {value}
+                    1 {_col0} {_col1}
+                  handleSkewJoin: false
+                  keys:
+                    0 [Column[key]]
+                    1 [Column[_col0]]
+                  Position of Big Table: 0
 
   Stage: Stage-1
     Map Reduce
diff --git a/ql/src/test/results/clientpositive/join4.q.out b/ql/src/test/results/clientpositive/join4.q.out
index 95be58e6c6..cc12e8128a 100644
--- a/ql/src/test/results/clientpositive/join4.q.out
+++ b/ql/src/test/results/clientpositive/join4.q.out
@@ -52,31 +52,27 @@ STAGE PLANS:
               predicate:
                   expr: ((key > 10) and (key < 20))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: ((key > 10) and (key < 20))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: 0
+                  value expressions:
+                        expr: _col0
                         type: string
-                        expr: value
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: 0
-                    value expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
         c:b:src2 
           TableScan
             alias: src2
@@ -84,31 +80,27 @@ STAGE PLANS:
               predicate:
                   expr: ((key > 15) and (key < 25))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: ((key > 15) and (key < 25))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: 1
+                  value expressions:
+                        expr: _col0
                         type: string
-                        expr: value
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: 1
-                    value expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
       Reduce Operator Tree:
         Join Operator
           condition map:
diff --git a/ql/src/test/results/clientpositive/join40.q.out b/ql/src/test/results/clientpositive/join40.q.out
index 41e25daf2d..dd7dfc6d7a 100644
--- a/ql/src/test/results/clientpositive/join40.q.out
+++ b/ql/src/test/results/clientpositive/join40.q.out
@@ -39,31 +39,27 @@ STAGE PLANS:
               predicate:
                   expr: (key <= 100)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key <= 100)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
                         type: string
-                        expr: value
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: 1
+                  value expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: 1
-                    value expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
       Reduce Operator Tree:
         Join Operator
           condition map:
@@ -1812,24 +1808,20 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                Reduce Output Operator
-                  key expressions:
-                        expr: key
-                        type: string
-                  sort order: +
-                  Map-reduce partition columns:
-                        expr: key
-                        type: string
-                  tag: 0
-                  value expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
+              Reduce Output Operator
+                key expressions:
+                      expr: key
+                      type: string
+                sort order: +
+                Map-reduce partition columns:
+                      expr: key
+                      type: string
+                tag: 0
+                value expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
         src2 
           TableScan
             alias: src2
@@ -2533,24 +2525,20 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                Reduce Output Operator
-                  key expressions:
-                        expr: key
-                        type: string
-                  sort order: +
-                  Map-reduce partition columns:
-                        expr: key
-                        type: string
-                  tag: 0
-                  value expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
+              Reduce Output Operator
+                key expressions:
+                      expr: key
+                      type: string
+                sort order: +
+                Map-reduce partition columns:
+                      expr: key
+                      type: string
+                tag: 0
+                value expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
         src2 
           TableScan
             alias: src2
@@ -2558,24 +2546,20 @@ STAGE PLANS:
               predicate:
                   expr: (key < 15)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 15)
-                    type: boolean
-                Reduce Output Operator
-                  key expressions:
-                        expr: key
-                        type: string
-                  sort order: +
-                  Map-reduce partition columns:
-                        expr: key
-                        type: string
-                  tag: 1
-                  value expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
+              Reduce Output Operator
+                key expressions:
+                      expr: key
+                      type: string
+                sort order: +
+                Map-reduce partition columns:
+                      expr: key
+                      type: string
+                tag: 1
+                value expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
         src3 
           TableScan
             alias: src3
@@ -3266,26 +3250,22 @@ STAGE PLANS:
               predicate:
                   expr: (key <= 100)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key <= 100)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
-                  outputColumnNames: _col0, _col1
-                  HashTable Sink Operator
-                    condition expressions:
-                      0 {key} {value}
-                      1 {_col0} {_col1}
-                    handleSkewJoin: false
-                    keys:
-                      0 [Column[key]]
-                      1 [Column[_col0]]
-                    Position of Big Table: 0
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                HashTable Sink Operator
+                  condition expressions:
+                    0 {key} {value}
+                    1 {_col0} {_col1}
+                  handleSkewJoin: false
+                  keys:
+                    0 [Column[key]]
+                    1 [Column[_col0]]
+                  Position of Big Table: 0
 
   Stage: Stage-1
     Map Reduce
diff --git a/ql/src/test/results/clientpositive/join5.q.out b/ql/src/test/results/clientpositive/join5.q.out
index 6fe7bc8b56..5242028ce8 100644
--- a/ql/src/test/results/clientpositive/join5.q.out
+++ b/ql/src/test/results/clientpositive/join5.q.out
@@ -52,31 +52,27 @@ STAGE PLANS:
               predicate:
                   expr: ((key > 10) and (key < 20))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: ((key > 10) and (key < 20))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: 0
+                  value expressions:
+                        expr: _col0
                         type: string
-                        expr: value
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: 0
-                    value expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
         c:b:src2 
           TableScan
             alias: src2
@@ -84,31 +80,27 @@ STAGE PLANS:
               predicate:
                   expr: ((key > 15) and (key < 25))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: ((key > 15) and (key < 25))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: 1
+                  value expressions:
+                        expr: _col0
                         type: string
-                        expr: value
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: 1
-                    value expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
       Reduce Operator Tree:
         Join Operator
           condition map:
diff --git a/ql/src/test/results/clientpositive/join6.q.out b/ql/src/test/results/clientpositive/join6.q.out
index 0ae70c3bed..6a0b7d0373 100644
--- a/ql/src/test/results/clientpositive/join6.q.out
+++ b/ql/src/test/results/clientpositive/join6.q.out
@@ -52,31 +52,27 @@ STAGE PLANS:
               predicate:
                   expr: ((key > 10) and (key < 20))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: ((key > 10) and (key < 20))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: 0
+                  value expressions:
+                        expr: _col0
                         type: string
-                        expr: value
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: 0
-                    value expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
         c:b:src2 
           TableScan
             alias: src2
@@ -84,31 +80,27 @@ STAGE PLANS:
               predicate:
                   expr: ((key > 15) and (key < 25))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: ((key > 15) and (key < 25))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: 1
+                  value expressions:
+                        expr: _col0
                         type: string
-                        expr: value
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: 1
-                    value expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
       Reduce Operator Tree:
         Join Operator
           condition map:
diff --git a/ql/src/test/results/clientpositive/join7.q.out b/ql/src/test/results/clientpositive/join7.q.out
index c643bf5c8d..eb8ea98ef3 100644
--- a/ql/src/test/results/clientpositive/join7.q.out
+++ b/ql/src/test/results/clientpositive/join7.q.out
@@ -62,31 +62,27 @@ STAGE PLANS:
               predicate:
                   expr: ((key > 10) and (key < 20))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: ((key > 10) and (key < 20))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
                         type: string
-                        expr: value
+                  tag: 0
+                  value expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: 0
-                    value expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
         c:b:src2 
           TableScan
             alias: src2
@@ -94,31 +90,27 @@ STAGE PLANS:
               predicate:
                   expr: ((key > 15) and (key < 25))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: ((key > 15) and (key < 25))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: 1
+                  value expressions:
+                        expr: _col0
                         type: string
-                        expr: value
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: 1
-                    value expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
         c:c:src3 
           TableScan
             alias: src3
@@ -126,31 +118,27 @@ STAGE PLANS:
               predicate:
                   expr: ((key > 20) and (key < 25))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: ((key > 20) and (key < 25))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: 2
+                  value expressions:
+                        expr: _col0
                         type: string
-                        expr: value
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: 2
-                    value expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
       Reduce Operator Tree:
         Join Operator
           condition map:
diff --git a/ql/src/test/results/clientpositive/join8.q.out b/ql/src/test/results/clientpositive/join8.q.out
index c880c2bdab..ab008994c7 100644
--- a/ql/src/test/results/clientpositive/join8.q.out
+++ b/ql/src/test/results/clientpositive/join8.q.out
@@ -52,31 +52,27 @@ STAGE PLANS:
               predicate:
                   expr: ((key > 10) and (key < 20))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: ((key > 10) and (key < 20))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
                         type: string
-                        expr: value
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: 0
+                  value expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: 0
-                    value expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
         c:b:src2 
           TableScan
             alias: src2
@@ -84,31 +80,27 @@ STAGE PLANS:
               predicate:
                   expr: ((key > 15) and (key < 25))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: ((key > 15) and (key < 25))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
                         type: string
-                        expr: value
+                  tag: 1
+                  value expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: 1
-                    value expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
       Reduce Operator Tree:
         Join Operator
           condition map:
@@ -118,21 +110,21 @@ STAGE PLANS:
             1 {VALUE._col0} {VALUE._col1}
           handleSkewJoin: false
           outputColumnNames: _col0, _col1, _col2, _col3
-          Select Operator
-            expressions:
-                  expr: _col0
-                  type: string
-                  expr: _col1
-                  type: string
-                  expr: _col2
-                  type: string
-                  expr: _col3
-                  type: string
-            outputColumnNames: _col0, _col1, _col2, _col3
-            Filter Operator
-              predicate:
-                  expr: (_col2 is null and _col0 is not null)
-                  type: boolean
+          Filter Operator
+            predicate:
+                expr: (_col2 is null and _col0 is not null)
+                type: boolean
+            Select Operator
+              expressions:
+                    expr: _col0
+                    type: string
+                    expr: _col1
+                    type: string
+                    expr: _col2
+                    type: string
+                    expr: _col3
+                    type: string
+              outputColumnNames: _col0, _col1, _col2, _col3
               Select Operator
                 expressions:
                       expr: _col0
diff --git a/ql/src/test/results/clientpositive/join9.q.out b/ql/src/test/results/clientpositive/join9.q.out
index e72790e0b8..2abdffc937 100644
--- a/ql/src/test/results/clientpositive/join9.q.out
+++ b/ql/src/test/results/clientpositive/join9.q.out
@@ -150,51 +150,46 @@ STAGE PLANS:
             1 {VALUE._col1}
           handleSkewJoin: false
           outputColumnNames: _col0, _col2, _col3, _col7
-          Filter Operator
-            isSamplingPred: false
-            predicate:
-                expr: ((_col2 = '2008-04-08') and (_col3 = '12'))
-                type: boolean
+          Select Operator
+            expressions:
+                  expr: _col0
+                  type: string
+                  expr: _col7
+                  type: string
+            outputColumnNames: _col0, _col1
             Select Operator
               expressions:
-                    expr: _col0
-                    type: string
-                    expr: _col7
+                    expr: UDFToInteger(_col0)
+                    type: int
+                    expr: _col1
                     type: string
               outputColumnNames: _col0, _col1
-              Select Operator
-                expressions:
-                      expr: UDFToInteger(_col0)
-                      type: int
-                      expr: _col1
-                      type: string
-                outputColumnNames: _col0, _col1
-                File Output Operator
-                  compressed: false
-                  GlobalTableId: 1
-                  directory: pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-02-10_16-08-44_532_2940878602076923711/-ext-10000
-                  NumFilesPerFileSink: 1
-                  Stats Publishing Key Prefix: pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-02-10_16-08-44_532_2940878602076923711/-ext-10000/
-                  table:
-                      input format: org.apache.hadoop.mapred.TextInputFormat
-                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                      properties:
-                        bucket_count -1
-                        columns key,value
-                        columns.types int:string
-                        file.inputformat org.apache.hadoop.mapred.TextInputFormat
-                        file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                        location pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/dest1
-                        name default.dest1
-                        serialization.ddl struct dest1 { i32 key, string value}
-                        serialization.format 1
-                        serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                        transient_lastDdlTime 1297382924
-                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                      name: default.dest1
-                  TotalFiles: 1
-                  GatherStats: true
-                  MultiFileSpray: false
+              File Output Operator
+                compressed: false
+                GlobalTableId: 1
+                directory: pfile:/Users/amarsri/Documents/workspace/hive/build/ql/scratchdir/hive_2011-03-17_09-37-30_985_6005635493455371640/-ext-10000
+                NumFilesPerFileSink: 1
+                Stats Publishing Key Prefix: pfile:/Users/amarsri/Documents/workspace/hive/build/ql/scratchdir/hive_2011-03-17_09-37-30_985_6005635493455371640/-ext-10000/
+                table:
+                    input format: org.apache.hadoop.mapred.TextInputFormat
+                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                    properties:
+                      bucket_count -1
+                      columns key,value
+                      columns.types int:string
+                      file.inputformat org.apache.hadoop.mapred.TextInputFormat
+                      file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                      location pfile:/Users/amarsri/Documents/workspace/hive/build/ql/test/data/warehouse/dest1
+                      name default.dest1
+                      serialization.ddl struct dest1 { i32 key, string value}
+                      serialization.format 1
+                      serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                      transient_lastDdlTime 1300379850
+                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                    name: default.dest1
+                TotalFiles: 1
+                GatherStats: true
+                MultiFileSpray: false
 
   Stage: Stage-0
     Move Operator
diff --git a/ql/src/test/results/clientpositive/join_map_ppr.q.out b/ql/src/test/results/clientpositive/join_map_ppr.q.out
index c88017223b..fd06fa45d3 100644
--- a/ql/src/test/results/clientpositive/join_map_ppr.q.out
+++ b/ql/src/test/results/clientpositive/join_map_ppr.q.out
@@ -106,46 +106,41 @@ STAGE PLANS:
                       expr: _col11
                       type: string
                 outputColumnNames: _col0, _col5, _col9, _col10, _col11
-                Filter Operator
-                  isSamplingPred: false
-                  predicate:
-                      expr: ((_col10 = '2008-04-08') and (_col11 = 11))
-                      type: boolean
-                  Select Operator
-                    expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col9
-                          type: string
-                          expr: _col5
-                          type: string
-                    outputColumnNames: _col0, _col1, _col2
-                    File Output Operator
-                      compressed: false
-                      GlobalTableId: 1
-                      directory: pfile:/data/users/tomasz/apache-hive/build/ql/scratchdir/hive_2011-06-01_19-43-21_478_8339235676581259155/-ext-10002
-                      NumFilesPerFileSink: 1
-                      Stats Publishing Key Prefix: pfile:/data/users/tomasz/apache-hive/build/ql/scratchdir/hive_2011-06-01_19-43-21_478_8339235676581259155/-ext-10000/
-                      table:
-                          input format: org.apache.hadoop.mapred.TextInputFormat
-                          output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                          properties:
-                            bucket_count -1
-                            columns key,value,val2
-                            columns.types string:string:string
-                            file.inputformat org.apache.hadoop.mapred.TextInputFormat
-                            file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                            location pfile:/data/users/tomasz/apache-hive/build/ql/test/data/warehouse/dest_j1
-                            name default.dest_j1
-                            serialization.ddl struct dest_j1 { string key, string value, string val2}
-                            serialization.format 1
-                            serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                            transient_lastDdlTime 1306982601
-                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                          name: default.dest_j1
-                      TotalFiles: 1
-                      GatherStats: true
-                      MultiFileSpray: false
+                Select Operator
+                  expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col9
+                        type: string
+                        expr: _col5
+                        type: string
+                  outputColumnNames: _col0, _col1, _col2
+                  File Output Operator
+                    compressed: false
+                    GlobalTableId: 1
+                    directory: pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_02-22-41_288_1522348091919369375/-ext-10002
+                    NumFilesPerFileSink: 1
+                    Stats Publishing Key Prefix: pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_02-22-41_288_1522348091919369375/-ext-10000/
+                    table:
+                        input format: org.apache.hadoop.mapred.TextInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                        properties:
+                          bucket_count -1
+                          columns key,value,val2
+                          columns.types string:string:string
+                          file.inputformat org.apache.hadoop.mapred.TextInputFormat
+                          file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                          location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/dest_j1
+                          name default.dest_j1
+                          serialization.ddl struct dest_j1 { string key, string value, string val2}
+                          serialization.format 1
+                          serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                          transient_lastDdlTime 1310376161
+                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                        name: default.dest_j1
+                    TotalFiles: 1
+                    GatherStats: true
+                    MultiFileSpray: false
       Local Work:
         Map Reduce Local Work
       Needs Tagging: false
@@ -598,51 +593,46 @@ STAGE PLANS:
                       expr: _col11
                       type: string
                 outputColumnNames: _col0, _col5, _col9, _col10, _col11
-                Filter Operator
-                  isSamplingPred: false
-                  predicate:
-                      expr: ((_col10 = '2008-04-08') and (_col11 = 11))
-                      type: boolean
-                  Select Operator
-                    expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col9
-                          type: string
-                          expr: _col5
-                          type: string
-                    outputColumnNames: _col0, _col1, _col2
-                    File Output Operator
-                      compressed: false
-                      GlobalTableId: 1
-                      directory: pfile:/data/users/tomasz/apache-hive/build/ql/scratchdir/hive_2011-06-01_19-43-39_193_3629767743822800153/-ext-10002
-                      NumFilesPerFileSink: 1
-                      Stats Publishing Key Prefix: pfile:/data/users/tomasz/apache-hive/build/ql/scratchdir/hive_2011-06-01_19-43-39_193_3629767743822800153/-ext-10000/
-                      table:
-                          input format: org.apache.hadoop.mapred.TextInputFormat
-                          output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                          properties:
-                            bucket_count -1
-                            columns key,value,val2
-                            columns.types string:string:string
-                            file.inputformat org.apache.hadoop.mapred.TextInputFormat
-                            file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                            location pfile:/data/users/tomasz/apache-hive/build/ql/test/data/warehouse/dest_j1
-                            name default.dest_j1
-                            numFiles 1
-                            numPartitions 0
-                            numRows 107
-                            rawDataSize 2018
-                            serialization.ddl struct dest_j1 { string key, string value, string val2}
-                            serialization.format 1
-                            serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                            totalSize 2125
-                            transient_lastDdlTime 1306982607
-                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                          name: default.dest_j1
-                      TotalFiles: 1
-                      GatherStats: true
-                      MultiFileSpray: false
+                Select Operator
+                  expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col9
+                        type: string
+                        expr: _col5
+                        type: string
+                  outputColumnNames: _col0, _col1, _col2
+                  File Output Operator
+                    compressed: false
+                    GlobalTableId: 1
+                    directory: pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_02-22-56_227_1785331413587992732/-ext-10002
+                    NumFilesPerFileSink: 1
+                    Stats Publishing Key Prefix: pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_02-22-56_227_1785331413587992732/-ext-10000/
+                    table:
+                        input format: org.apache.hadoop.mapred.TextInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                        properties:
+                          bucket_count -1
+                          columns key,value,val2
+                          columns.types string:string:string
+                          file.inputformat org.apache.hadoop.mapred.TextInputFormat
+                          file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                          location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/dest_j1
+                          name default.dest_j1
+                          numFiles 1
+                          numPartitions 0
+                          numRows 107
+                          rawDataSize 2018
+                          serialization.ddl struct dest_j1 { string key, string value, string val2}
+                          serialization.format 1
+                          serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                          totalSize 2125
+                          transient_lastDdlTime 1310376166
+                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                        name: default.dest_j1
+                    TotalFiles: 1
+                    GatherStats: true
+                    MultiFileSpray: false
       Local Work:
         Map Reduce Local Work
       Needs Tagging: false
diff --git a/ql/src/test/results/clientpositive/lateral_view_ppd.q.out b/ql/src/test/results/clientpositive/lateral_view_ppd.q.out
index 7f588ddc19..a18e8715cb 100644
--- a/ql/src/test/results/clientpositive/lateral_view_ppd.q.out
+++ b/ql/src/test/results/clientpositive/lateral_view_ppd.q.out
@@ -34,23 +34,19 @@ STAGE PLANS:
                             expr: _col2
                             type: int
                       outputColumnNames: _col0, _col1, _col2
-                      Filter Operator
-                        predicate:
-                            expr: (_col0 = '0')
-                            type: boolean
-                        Select Operator
-                          expressions:
-                                expr: _col1
-                                type: string
-                                expr: _col2
-                                type: int
-                          outputColumnNames: _col0, _col1
-                          File Output Operator
-                            compressed: false
-                            GlobalTableId: 0
-                            table:
-                                input format: org.apache.hadoop.mapred.TextInputFormat
-                                output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                      Select Operator
+                        expressions:
+                              expr: _col1
+                              type: string
+                              expr: _col2
+                              type: int
+                        outputColumnNames: _col0, _col1
+                        File Output Operator
+                          compressed: false
+                          GlobalTableId: 0
+                          table:
+                              input format: org.apache.hadoop.mapred.TextInputFormat
+                              output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                 Select Operator
                   expressions:
                         expr: array(1,2,3)
@@ -69,23 +65,19 @@ STAGE PLANS:
                               expr: _col2
                               type: int
                         outputColumnNames: _col0, _col1, _col2
-                        Filter Operator
-                          predicate:
-                              expr: (_col0 = '0')
-                              type: boolean
-                          Select Operator
-                            expressions:
-                                  expr: _col1
-                                  type: string
-                                  expr: _col2
-                                  type: int
-                            outputColumnNames: _col0, _col1
-                            File Output Operator
-                              compressed: false
-                              GlobalTableId: 0
-                              table:
-                                  input format: org.apache.hadoop.mapred.TextInputFormat
-                                  output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                        Select Operator
+                          expressions:
+                                expr: _col1
+                                type: string
+                                expr: _col2
+                                type: int
+                          outputColumnNames: _col0, _col1
+                          File Output Operator
+                            compressed: false
+                            GlobalTableId: 0
+                            table:
+                                input format: org.apache.hadoop.mapred.TextInputFormat
+                                output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
 
   Stage: Stage-0
     Fetch Operator
@@ -136,19 +128,19 @@ STAGE PLANS:
                   SELECT * : (no compute)
                   Lateral View Join Operator
                     outputColumnNames: _col0, _col1, _col2
-                    Select Operator
-                      expressions:
-                            expr: _col0
-                            type: string
-                            expr: _col1
-                            type: string
-                            expr: _col2
-                            type: int
-                      outputColumnNames: _col0, _col1, _col2
-                      Filter Operator
-                        predicate:
-                            expr: ((_col0 = '0') and (_col2 = 1))
-                            type: boolean
+                    Filter Operator
+                      predicate:
+                          expr: ((_col0 = '0') and (_col2 = 1))
+                          type: boolean
+                      Select Operator
+                        expressions:
+                              expr: _col0
+                              type: string
+                              expr: _col1
+                              type: string
+                              expr: _col2
+                              type: int
+                        outputColumnNames: _col0, _col1, _col2
                         Select Operator
                           expressions:
                                 expr: _col1
@@ -171,19 +163,19 @@ STAGE PLANS:
                     function name: explode
                     Lateral View Join Operator
                       outputColumnNames: _col0, _col1, _col2
-                      Select Operator
-                        expressions:
-                              expr: _col0
-                              type: string
-                              expr: _col1
-                              type: string
-                              expr: _col2
-                              type: int
-                        outputColumnNames: _col0, _col1, _col2
-                        Filter Operator
-                          predicate:
-                              expr: ((_col0 = '0') and (_col2 = 1))
-                              type: boolean
+                      Filter Operator
+                        predicate:
+                            expr: ((_col0 = '0') and (_col2 = 1))
+                            type: boolean
+                        Select Operator
+                          expressions:
+                                expr: _col0
+                                type: string
+                                expr: _col1
+                                type: string
+                                expr: _col2
+                                type: int
+                          outputColumnNames: _col0, _col1, _col2
                           Select Operator
                             expressions:
                                   expr: _col1
@@ -248,24 +240,20 @@ STAGE PLANS:
                           expr: _col3
                           type: string
                     outputColumnNames: _col1, _col4, _col2, _col3
-                    Filter Operator
-                      predicate:
-                          expr: ((_col2 = '2008-04-08') and (_col3 = '12'))
-                          type: boolean
-                      Select Operator
-                        expressions:
-                              expr: _col1
-                              type: string
-                              expr: _col4
-                              type: int
-                        outputColumnNames: _col0, _col1
-                        Limit
-                          File Output Operator
-                            compressed: false
-                            GlobalTableId: 0
-                            table:
-                                input format: org.apache.hadoop.mapred.TextInputFormat
-                                output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                    Select Operator
+                      expressions:
+                            expr: _col1
+                            type: string
+                            expr: _col4
+                            type: int
+                      outputColumnNames: _col0, _col1
+                      Limit
+                        File Output Operator
+                          compressed: false
+                          GlobalTableId: 0
+                          table:
+                              input format: org.apache.hadoop.mapred.TextInputFormat
+                              output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
               Select Operator
                 expressions:
                       expr: array(1,2,3)
@@ -286,24 +274,20 @@ STAGE PLANS:
                             expr: _col3
                             type: string
                       outputColumnNames: _col1, _col4, _col2, _col3
-                      Filter Operator
-                        predicate:
-                            expr: ((_col2 = '2008-04-08') and (_col3 = '12'))
-                            type: boolean
-                        Select Operator
-                          expressions:
-                                expr: _col1
-                                type: string
-                                expr: _col4
-                                type: int
-                          outputColumnNames: _col0, _col1
-                          Limit
-                            File Output Operator
-                              compressed: false
-                              GlobalTableId: 0
-                              table:
-                                  input format: org.apache.hadoop.mapred.TextInputFormat
-                                  output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                      Select Operator
+                        expressions:
+                              expr: _col1
+                              type: string
+                              expr: _col4
+                              type: int
+                        outputColumnNames: _col0, _col1
+                        Limit
+                          File Output Operator
+                            compressed: false
+                            GlobalTableId: 0
+                            table:
+                                input format: org.apache.hadoop.mapred.TextInputFormat
+                                output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
 
   Stage: Stage-0
     Fetch Operator
@@ -371,23 +355,19 @@ STAGE PLANS:
                                   expr: _col0
                                   type: string
                             outputColumnNames: _col1, _col2, _col0
-                            Filter Operator
-                              predicate:
-                                  expr: (_col0 = '0')
-                                  type: boolean
-                              Select Operator
-                                expressions:
-                                      expr: _col1
-                                      type: string
-                                      expr: _col2
-                                      type: int
-                                outputColumnNames: _col0, _col1
-                                File Output Operator
-                                  compressed: false
-                                  GlobalTableId: 0
-                                  table:
-                                      input format: org.apache.hadoop.mapred.TextInputFormat
-                                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                            Select Operator
+                              expressions:
+                                    expr: _col1
+                                    type: string
+                                    expr: _col2
+                                    type: int
+                              outputColumnNames: _col0, _col1
+                              File Output Operator
+                                compressed: false
+                                GlobalTableId: 0
+                                table:
+                                    input format: org.apache.hadoop.mapred.TextInputFormat
+                                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                       Select Operator
                         expressions:
                               expr: array(1,2,3)
@@ -406,23 +386,19 @@ STAGE PLANS:
                                     expr: _col0
                                     type: string
                               outputColumnNames: _col1, _col2, _col0
-                              Filter Operator
-                                predicate:
-                                    expr: (_col0 = '0')
-                                    type: boolean
-                                Select Operator
-                                  expressions:
-                                        expr: _col1
-                                        type: string
-                                        expr: _col2
-                                        type: int
-                                  outputColumnNames: _col0, _col1
-                                  File Output Operator
-                                    compressed: false
-                                    GlobalTableId: 0
-                                    table:
-                                        input format: org.apache.hadoop.mapred.TextInputFormat
-                                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                              Select Operator
+                                expressions:
+                                      expr: _col1
+                                      type: string
+                                      expr: _col2
+                                      type: int
+                                outputColumnNames: _col0, _col1
+                                File Output Operator
+                                  compressed: false
+                                  GlobalTableId: 0
+                                  table:
+                                      input format: org.apache.hadoop.mapred.TextInputFormat
+                                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                 Select Operator
                   expressions:
                         expr: array(1,2,3)
@@ -446,23 +422,19 @@ STAGE PLANS:
                                     expr: _col0
                                     type: string
                               outputColumnNames: _col1, _col2, _col0
-                              Filter Operator
-                                predicate:
-                                    expr: (_col0 = '0')
-                                    type: boolean
-                                Select Operator
-                                  expressions:
-                                        expr: _col1
-                                        type: string
-                                        expr: _col2
-                                        type: int
-                                  outputColumnNames: _col0, _col1
-                                  File Output Operator
-                                    compressed: false
-                                    GlobalTableId: 0
-                                    table:
-                                        input format: org.apache.hadoop.mapred.TextInputFormat
-                                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                              Select Operator
+                                expressions:
+                                      expr: _col1
+                                      type: string
+                                      expr: _col2
+                                      type: int
+                                outputColumnNames: _col0, _col1
+                                File Output Operator
+                                  compressed: false
+                                  GlobalTableId: 0
+                                  table:
+                                      input format: org.apache.hadoop.mapred.TextInputFormat
+                                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                         Select Operator
                           expressions:
                                 expr: array(1,2,3)
@@ -481,23 +453,19 @@ STAGE PLANS:
                                       expr: _col0
                                       type: string
                                 outputColumnNames: _col1, _col2, _col0
-                                Filter Operator
-                                  predicate:
-                                      expr: (_col0 = '0')
-                                      type: boolean
-                                  Select Operator
-                                    expressions:
-                                          expr: _col1
-                                          type: string
-                                          expr: _col2
-                                          type: int
-                                    outputColumnNames: _col0, _col1
-                                    File Output Operator
-                                      compressed: false
-                                      GlobalTableId: 0
-                                      table:
-                                          input format: org.apache.hadoop.mapred.TextInputFormat
-                                          output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                                Select Operator
+                                  expressions:
+                                        expr: _col1
+                                        type: string
+                                        expr: _col2
+                                        type: int
+                                  outputColumnNames: _col0, _col1
+                                  File Output Operator
+                                    compressed: false
+                                    GlobalTableId: 0
+                                    table:
+                                        input format: org.apache.hadoop.mapred.TextInputFormat
+                                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
 
   Stage: Stage-0
     Fetch Operator
diff --git a/ql/src/test/results/clientpositive/load_dyn_part10.q.out b/ql/src/test/results/clientpositive/load_dyn_part10.q.out
index 5646d49c4d..74ee9acf3f 100644
--- a/ql/src/test/results/clientpositive/load_dyn_part10.q.out
+++ b/ql/src/test/results/clientpositive/load_dyn_part10.q.out
@@ -44,27 +44,23 @@ STAGE PLANS:
         srcpart 
           TableScan
             alias: srcpart
-            Filter Operator
-              predicate:
-                  expr: (ds > '2008-04-08')
-                  type: boolean
-              Select Operator
-                expressions:
-                      expr: key
-                      type: string
-                      expr: value
-                      type: string
-                      expr: hr
-                      type: string
-                outputColumnNames: _col0, _col1, _col2
-                File Output Operator
-                  compressed: false
-                  GlobalTableId: 1
-                  table:
-                      input format: org.apache.hadoop.mapred.TextInputFormat
-                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                      name: default.nzhang_part10
+            Select Operator
+              expressions:
+                    expr: key
+                    type: string
+                    expr: value
+                    type: string
+                    expr: hr
+                    type: string
+              outputColumnNames: _col0, _col1, _col2
+              File Output Operator
+                compressed: false
+                GlobalTableId: 1
+                table:
+                    input format: org.apache.hadoop.mapred.TextInputFormat
+                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                    name: default.nzhang_part10
 
   Stage: Stage-0
     Move Operator
diff --git a/ql/src/test/results/clientpositive/load_dyn_part13.q.out b/ql/src/test/results/clientpositive/load_dyn_part13.q.out
index ce04451503..8ed502d77f 100644
--- a/ql/src/test/results/clientpositive/load_dyn_part13.q.out
+++ b/ql/src/test/results/clientpositive/load_dyn_part13.q.out
@@ -62,37 +62,33 @@ STAGE PLANS:
               predicate:
                   expr: (key < 20)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 20)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
-                        expr: '22'
-                        type: string
-                  outputColumnNames: _col0, _col1, _col2
-                  Union
-                    Select Operator
-                      expressions:
-                            expr: _col0
-                            type: string
-                            expr: _col1
-                            type: string
-                            expr: _col2
-                            type: string
-                      outputColumnNames: _col0, _col1, _col2
-                      File Output Operator
-                        compressed: false
-                        GlobalTableId: 1
-                        table:
-                            input format: org.apache.hadoop.mapred.TextInputFormat
-                            output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                            serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                            name: default.nzhang_part13
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                      expr: '22'
+                      type: string
+                outputColumnNames: _col0, _col1, _col2
+                Union
+                  Select Operator
+                    expressions:
+                          expr: _col0
+                          type: string
+                          expr: _col1
+                          type: string
+                          expr: _col2
+                          type: string
+                    outputColumnNames: _col0, _col1, _col2
+                    File Output Operator
+                      compressed: false
+                      GlobalTableId: 1
+                      table:
+                          input format: org.apache.hadoop.mapred.TextInputFormat
+                          output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                          name: default.nzhang_part13
         null-subquery2:s-subquery2:src 
           TableScan
             alias: src
@@ -100,37 +96,33 @@ STAGE PLANS:
               predicate:
                   expr: ((key > 20) and (key < 40))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: ((key > 20) and (key < 40))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
-                        expr: '33'
-                        type: string
-                  outputColumnNames: _col0, _col1, _col2
-                  Union
-                    Select Operator
-                      expressions:
-                            expr: _col0
-                            type: string
-                            expr: _col1
-                            type: string
-                            expr: _col2
-                            type: string
-                      outputColumnNames: _col0, _col1, _col2
-                      File Output Operator
-                        compressed: false
-                        GlobalTableId: 1
-                        table:
-                            input format: org.apache.hadoop.mapred.TextInputFormat
-                            output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                            serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                            name: default.nzhang_part13
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                      expr: '33'
+                      type: string
+                outputColumnNames: _col0, _col1, _col2
+                Union
+                  Select Operator
+                    expressions:
+                          expr: _col0
+                          type: string
+                          expr: _col1
+                          type: string
+                          expr: _col2
+                          type: string
+                    outputColumnNames: _col0, _col1, _col2
+                    File Output Operator
+                      compressed: false
+                      GlobalTableId: 1
+                      table:
+                          input format: org.apache.hadoop.mapred.TextInputFormat
+                          output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                          name: default.nzhang_part13
 
   Stage: Stage-0
     Move Operator
diff --git a/ql/src/test/results/clientpositive/load_dyn_part2.q.out b/ql/src/test/results/clientpositive/load_dyn_part2.q.out
index 44956ae56f..44954e7709 100644
--- a/ql/src/test/results/clientpositive/load_dyn_part2.q.out
+++ b/ql/src/test/results/clientpositive/load_dyn_part2.q.out
@@ -38,32 +38,28 @@ STAGE PLANS:
         srcpart 
           TableScan
             alias: srcpart
-            Filter Operator
-              predicate:
-                  expr: (ds is not null and hr is not null)
-                  type: boolean
-              Select Operator
-                expressions:
-                      expr: key
+            Select Operator
+              expressions:
+                    expr: key
+                    type: string
+                    expr: value
+                    type: string
+                    expr: hr
+                    type: string
+              outputColumnNames: _col0, _col1, _col2
+              Reduce Output Operator
+                sort order: 
+                Map-reduce partition columns:
+                      expr: _col0
                       type: string
-                      expr: value
+                tag: -1
+                value expressions:
+                      expr: _col0
                       type: string
-                      expr: hr
+                      expr: _col1
+                      type: string
+                      expr: _col2
                       type: string
-                outputColumnNames: _col0, _col1, _col2
-                Reduce Output Operator
-                  sort order: 
-                  Map-reduce partition columns:
-                        expr: _col0
-                        type: string
-                  tag: -1
-                  value expressions:
-                        expr: _col0
-                        type: string
-                        expr: _col1
-                        type: string
-                        expr: _col2
-                        type: string
       Reduce Operator Tree:
         Extract
           File Output Operator
diff --git a/ql/src/test/results/clientpositive/load_dyn_part3.q.out b/ql/src/test/results/clientpositive/load_dyn_part3.q.out
index 0fb696bff0..115c3b3c28 100644
--- a/ql/src/test/results/clientpositive/load_dyn_part3.q.out
+++ b/ql/src/test/results/clientpositive/load_dyn_part3.q.out
@@ -42,29 +42,25 @@ STAGE PLANS:
         srcpart 
           TableScan
             alias: srcpart
-            Filter Operator
-              predicate:
-                  expr: (ds is not null and hr is not null)
-                  type: boolean
-              Select Operator
-                expressions:
-                      expr: key
-                      type: string
-                      expr: value
-                      type: string
-                      expr: ds
-                      type: string
-                      expr: hr
-                      type: string
-                outputColumnNames: _col0, _col1, _col2, _col3
-                File Output Operator
-                  compressed: false
-                  GlobalTableId: 1
-                  table:
-                      input format: org.apache.hadoop.mapred.TextInputFormat
-                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                      name: default.nzhang_part3
+            Select Operator
+              expressions:
+                    expr: key
+                    type: string
+                    expr: value
+                    type: string
+                    expr: ds
+                    type: string
+                    expr: hr
+                    type: string
+              outputColumnNames: _col0, _col1, _col2, _col3
+              File Output Operator
+                compressed: false
+                GlobalTableId: 1
+                table:
+                    input format: org.apache.hadoop.mapred.TextInputFormat
+                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                    name: default.nzhang_part3
 
   Stage: Stage-0
     Move Operator
diff --git a/ql/src/test/results/clientpositive/load_dyn_part4.q.out b/ql/src/test/results/clientpositive/load_dyn_part4.q.out
index 9791797232..dd9feebca4 100644
--- a/ql/src/test/results/clientpositive/load_dyn_part4.q.out
+++ b/ql/src/test/results/clientpositive/load_dyn_part4.q.out
@@ -54,29 +54,25 @@ STAGE PLANS:
         srcpart 
           TableScan
             alias: srcpart
-            Filter Operator
-              predicate:
-                  expr: (ds is not null and hr is not null)
-                  type: boolean
-              Select Operator
-                expressions:
-                      expr: key
-                      type: string
-                      expr: value
-                      type: string
-                      expr: ds
-                      type: string
-                      expr: hr
-                      type: string
-                outputColumnNames: _col0, _col1, _col2, _col3
-                File Output Operator
-                  compressed: false
-                  GlobalTableId: 1
-                  table:
-                      input format: org.apache.hadoop.mapred.TextInputFormat
-                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                      name: default.nzhang_part4
+            Select Operator
+              expressions:
+                    expr: key
+                    type: string
+                    expr: value
+                    type: string
+                    expr: ds
+                    type: string
+                    expr: hr
+                    type: string
+              outputColumnNames: _col0, _col1, _col2, _col3
+              File Output Operator
+                compressed: false
+                GlobalTableId: 1
+                table:
+                    input format: org.apache.hadoop.mapred.TextInputFormat
+                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                    name: default.nzhang_part4
 
   Stage: Stage-0
     Move Operator
diff --git a/ql/src/test/results/clientpositive/load_dyn_part9.q.out b/ql/src/test/results/clientpositive/load_dyn_part9.q.out
index 6a5fd2e479..c3f6a6c4e5 100644
--- a/ql/src/test/results/clientpositive/load_dyn_part9.q.out
+++ b/ql/src/test/results/clientpositive/load_dyn_part9.q.out
@@ -44,29 +44,25 @@ STAGE PLANS:
         srcpart 
           TableScan
             alias: srcpart
-            Filter Operator
-              predicate:
-                  expr: (ds <= '2008-04-08')
-                  type: boolean
-              Select Operator
-                expressions:
-                      expr: key
-                      type: string
-                      expr: value
-                      type: string
-                      expr: ds
-                      type: string
-                      expr: hr
-                      type: string
-                outputColumnNames: _col0, _col1, _col2, _col3
-                File Output Operator
-                  compressed: false
-                  GlobalTableId: 1
-                  table:
-                      input format: org.apache.hadoop.mapred.TextInputFormat
-                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                      name: default.nzhang_part9
+            Select Operator
+              expressions:
+                    expr: key
+                    type: string
+                    expr: value
+                    type: string
+                    expr: ds
+                    type: string
+                    expr: hr
+                    type: string
+              outputColumnNames: _col0, _col1, _col2, _col3
+              File Output Operator
+                compressed: false
+                GlobalTableId: 1
+                table:
+                    input format: org.apache.hadoop.mapred.TextInputFormat
+                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                    name: default.nzhang_part9
 
   Stage: Stage-0
     Move Operator
diff --git a/ql/src/test/results/clientpositive/louter_join_ppr.q.out b/ql/src/test/results/clientpositive/louter_join_ppr.q.out
index b3e33c019a..9b9425fc98 100644
--- a/ql/src/test/results/clientpositive/louter_join_ppr.q.out
+++ b/ql/src/test/results/clientpositive/louter_join_ppr.q.out
@@ -54,25 +54,20 @@ STAGE PLANS:
           TableScan
             alias: b
             GatherStats: false
-            Filter Operator
-              isSamplingPred: false
-              predicate:
-                  expr: (ds = '2008-04-08')
-                  type: boolean
-              Reduce Output Operator
-                key expressions:
-                      expr: key
-                      type: string
-                sort order: +
-                Map-reduce partition columns:
-                      expr: key
-                      type: string
-                tag: 1
-                value expressions:
-                      expr: key
-                      type: string
-                      expr: value
-                      type: string
+            Reduce Output Operator
+              key expressions:
+                    expr: key
+                    type: string
+              sort order: +
+              Map-reduce partition columns:
+                    expr: key
+                    type: string
+              tag: 1
+              value expressions:
+                    expr: key
+                    type: string
+                    expr: value
+                    type: string
       Needs Tagging: true
       Path -> Alias:
         pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src [a]
@@ -209,7 +204,7 @@ STAGE PLANS:
           Filter Operator
             isSamplingPred: false
             predicate:
-                expr: ((((_col0 > 10) and (_col0 < 20)) and (_col4 > 15)) and (_col4 < 25))
+                expr: ((_col4 > 15) and (_col4 < 25))
                 type: boolean
             Select Operator
               expressions:
@@ -575,7 +570,7 @@ STAGE PLANS:
           Filter Operator
             isSamplingPred: false
             predicate:
-                expr: ((((_col0 > 10) and (_col0 < 20)) and (_col6 > 15)) and (_col6 < 25))
+                expr: ((_col6 > 15) and (_col6 < 25))
                 type: boolean
             Select Operator
               expressions:
@@ -942,7 +937,7 @@ STAGE PLANS:
           Filter Operator
             isSamplingPred: false
             predicate:
-                expr: (((((_col0 > 10) and (_col0 < 20)) and (_col4 > 15)) and (_col4 < 25)) and (_col6 = '2008-04-08'))
+                expr: (((_col4 > 15) and (_col4 < 25)) and (_col6 = '2008-04-08'))
                 type: boolean
             Select Operator
               expressions:
@@ -1225,7 +1220,7 @@ STAGE PLANS:
           Filter Operator
             isSamplingPred: false
             predicate:
-                expr: (((((_col0 > 10) and (_col0 < 20)) and (_col6 > 15)) and (_col6 < 25)) and (_col2 = '2008-04-08'))
+                expr: ((_col6 > 15) and (_col6 < 25))
                 type: boolean
             Select Operator
               expressions:
diff --git a/ql/src/test/results/clientpositive/mapjoin_distinct.q.out b/ql/src/test/results/clientpositive/mapjoin_distinct.q.out
index c0c93b59e0..ec6851cadb 100644
--- a/ql/src/test/results/clientpositive/mapjoin_distinct.q.out
+++ b/ql/src/test/results/clientpositive/mapjoin_distinct.q.out
@@ -31,19 +31,15 @@ STAGE PLANS:
         d 
           TableScan
             alias: d
-            Filter Operator
-              predicate:
-                  expr: (ds = '2008-04-08')
-                  type: boolean
-              HashTable Sink Operator
-                condition expressions:
-                  0 {value}
-                  1 
-                handleSkewJoin: false
-                keys:
-                  0 [Column[key]]
-                  1 [Column[key]]
-                Position of Big Table: 0
+            HashTable Sink Operator
+              condition expressions:
+                0 {value}
+                1 
+              handleSkewJoin: false
+              keys:
+                0 [Column[key]]
+                1 [Column[key]]
+              Position of Big Table: 0
 
   Stage: Stage-1
     Map Reduce
@@ -51,28 +47,24 @@ STAGE PLANS:
         c 
           TableScan
             alias: c
-            Filter Operator
-              predicate:
-                  expr: (ds = '2008-04-08')
-                  type: boolean
-              Map Join Operator
-                condition map:
-                     Inner Join 0 to 1
-                condition expressions:
-                  0 {value}
-                  1 
-                handleSkewJoin: false
-                keys:
-                  0 [Column[key]]
-                  1 [Column[key]]
-                outputColumnNames: _col1
-                Position of Big Table: 0
-                File Output Operator
-                  compressed: false
-                  GlobalTableId: 0
-                  table:
-                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
-                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+            Map Join Operator
+              condition map:
+                   Inner Join 0 to 1
+              condition expressions:
+                0 {value}
+                1 
+              handleSkewJoin: false
+              keys:
+                0 [Column[key]]
+                1 [Column[key]]
+              outputColumnNames: _col1
+              Position of Big Table: 0
+              File Output Operator
+                compressed: false
+                GlobalTableId: 0
+                table:
+                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
       Local Work:
         Map Reduce Local Work
 
@@ -217,19 +209,15 @@ STAGE PLANS:
         d 
           TableScan
             alias: d
-            Filter Operator
-              predicate:
-                  expr: (ds = '2008-04-08')
-                  type: boolean
-              HashTable Sink Operator
-                condition expressions:
-                  0 {value}
-                  1 
-                handleSkewJoin: false
-                keys:
-                  0 [Column[key]]
-                  1 [Column[key]]
-                Position of Big Table: 0
+            HashTable Sink Operator
+              condition expressions:
+                0 {value}
+                1 
+              handleSkewJoin: false
+              keys:
+                0 [Column[key]]
+                1 [Column[key]]
+              Position of Big Table: 0
 
   Stage: Stage-1
     Map Reduce
@@ -237,28 +225,24 @@ STAGE PLANS:
         c 
           TableScan
             alias: c
-            Filter Operator
-              predicate:
-                  expr: (ds = '2008-04-08')
-                  type: boolean
-              Map Join Operator
-                condition map:
-                     Inner Join 0 to 1
-                condition expressions:
-                  0 {value}
-                  1 
-                handleSkewJoin: false
-                keys:
-                  0 [Column[key]]
-                  1 [Column[key]]
-                outputColumnNames: _col1
-                Position of Big Table: 0
-                File Output Operator
-                  compressed: false
-                  GlobalTableId: 0
-                  table:
-                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
-                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+            Map Join Operator
+              condition map:
+                   Inner Join 0 to 1
+              condition expressions:
+                0 {value}
+                1 
+              handleSkewJoin: false
+              keys:
+                0 [Column[key]]
+                1 [Column[key]]
+              outputColumnNames: _col1
+              Position of Big Table: 0
+              File Output Operator
+                compressed: false
+                GlobalTableId: 0
+                table:
+                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
       Local Work:
         Map Reduce Local Work
 
@@ -376,19 +360,15 @@ STAGE PLANS:
         d 
           TableScan
             alias: d
-            Filter Operator
-              predicate:
-                  expr: (ds = '2008-04-08')
-                  type: boolean
-              HashTable Sink Operator
-                condition expressions:
-                  0 {value}
-                  1 
-                handleSkewJoin: false
-                keys:
-                  0 [Column[key]]
-                  1 [Column[key]]
-                Position of Big Table: 0
+            HashTable Sink Operator
+              condition expressions:
+                0 {value}
+                1 
+              handleSkewJoin: false
+              keys:
+                0 [Column[key]]
+                1 [Column[key]]
+              Position of Big Table: 0
 
   Stage: Stage-1
     Map Reduce
@@ -396,28 +376,24 @@ STAGE PLANS:
         c 
           TableScan
             alias: c
-            Filter Operator
-              predicate:
-                  expr: (ds = '2008-04-08')
-                  type: boolean
-              Map Join Operator
-                condition map:
-                     Inner Join 0 to 1
-                condition expressions:
-                  0 {value}
-                  1 
-                handleSkewJoin: false
-                keys:
-                  0 [Column[key]]
-                  1 [Column[key]]
-                outputColumnNames: _col1
-                Position of Big Table: 0
-                File Output Operator
-                  compressed: false
-                  GlobalTableId: 0
-                  table:
-                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
-                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+            Map Join Operator
+              condition map:
+                   Inner Join 0 to 1
+              condition expressions:
+                0 {value}
+                1 
+              handleSkewJoin: false
+              keys:
+                0 [Column[key]]
+                1 [Column[key]]
+              outputColumnNames: _col1
+              Position of Big Table: 0
+              File Output Operator
+                compressed: false
+                GlobalTableId: 0
+                table:
+                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
       Local Work:
         Map Reduce Local Work
 
@@ -555,19 +531,15 @@ STAGE PLANS:
         d 
           TableScan
             alias: d
-            Filter Operator
-              predicate:
-                  expr: (ds = '2008-04-08')
-                  type: boolean
-              HashTable Sink Operator
-                condition expressions:
-                  0 {value}
-                  1 
-                handleSkewJoin: false
-                keys:
-                  0 [Column[key]]
-                  1 [Column[key]]
-                Position of Big Table: 0
+            HashTable Sink Operator
+              condition expressions:
+                0 {value}
+                1 
+              handleSkewJoin: false
+              keys:
+                0 [Column[key]]
+                1 [Column[key]]
+              Position of Big Table: 0
 
   Stage: Stage-1
     Map Reduce
@@ -575,28 +547,24 @@ STAGE PLANS:
         c 
           TableScan
             alias: c
-            Filter Operator
-              predicate:
-                  expr: (ds = '2008-04-08')
-                  type: boolean
-              Map Join Operator
-                condition map:
-                     Inner Join 0 to 1
-                condition expressions:
-                  0 {value}
-                  1 
-                handleSkewJoin: false
-                keys:
-                  0 [Column[key]]
-                  1 [Column[key]]
-                outputColumnNames: _col1
-                Position of Big Table: 0
-                File Output Operator
-                  compressed: false
-                  GlobalTableId: 0
-                  table:
-                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
-                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+            Map Join Operator
+              condition map:
+                   Inner Join 0 to 1
+              condition expressions:
+                0 {value}
+                1 
+              handleSkewJoin: false
+              keys:
+                0 [Column[key]]
+                1 [Column[key]]
+              outputColumnNames: _col1
+              Position of Big Table: 0
+              File Output Operator
+                compressed: false
+                GlobalTableId: 0
+                table:
+                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
       Local Work:
         Map Reduce Local Work
 
diff --git a/ql/src/test/results/clientpositive/mapjoin_subquery.q.out b/ql/src/test/results/clientpositive/mapjoin_subquery.q.out
index 9d530dcab3..b4ef9fdfaf 100644
--- a/ql/src/test/results/clientpositive/mapjoin_subquery.q.out
+++ b/ql/src/test/results/clientpositive/mapjoin_subquery.q.out
@@ -46,23 +46,15 @@ STAGE PLANS:
         z 
           TableScan
             alias: z
-            Filter Operator
-              predicate:
-                  expr: (ds = '2008-04-08')
-                  type: boolean
-              Filter Operator
-                predicate:
-                    expr: (hr = 11)
-                    type: boolean
-                HashTable Sink Operator
-                  condition expressions:
-                    0 {_col0}
-                    1 {value}
-                  handleSkewJoin: false
-                  keys:
-                    0 [Column[_col0]]
-                    1 [Column[key]]
-                  Position of Big Table: 0
+            HashTable Sink Operator
+              condition expressions:
+                0 {_col0}
+                1 {value}
+              handleSkewJoin: false
+              keys:
+                0 [Column[_col0]]
+                1 [Column[key]]
+              Position of Big Table: 0
 
   Stage: Stage-1
     Map Reduce
@@ -310,23 +302,15 @@ STAGE PLANS:
         z 
           TableScan
             alias: z
-            Filter Operator
-              predicate:
-                  expr: (ds = '2008-04-08')
-                  type: boolean
-              Filter Operator
-                predicate:
-                    expr: (hr = 11)
-                    type: boolean
-                HashTable Sink Operator
-                  condition expressions:
-                    0 {_col0}
-                    1 {value}
-                  handleSkewJoin: false
-                  keys:
-                    0 [Column[_col0]]
-                    1 [Column[key]]
-                  Position of Big Table: 0
+            HashTable Sink Operator
+              condition expressions:
+                0 {_col0}
+                1 {value}
+              handleSkewJoin: false
+              keys:
+                0 [Column[_col0]]
+                1 [Column[key]]
+              Position of Big Table: 0
 
   Stage: Stage-1
     Map Reduce
diff --git a/ql/src/test/results/clientpositive/merge3.q.out b/ql/src/test/results/clientpositive/merge3.q.out
index 4a5571158d..608a33e1c1 100644
--- a/ql/src/test/results/clientpositive/merge3.q.out
+++ b/ql/src/test/results/clientpositive/merge3.q.out
@@ -2268,47 +2268,42 @@ STAGE PLANS:
           TableScan
             alias: merge_src_part
             GatherStats: false
-            Filter Operator
-              isSamplingPred: false
-              predicate:
-                  expr: ds is not null
-                  type: boolean
-              Select Operator
-                expressions:
-                      expr: key
-                      type: string
-                      expr: value
-                      type: string
-                      expr: ds
-                      type: string
-                outputColumnNames: _col0, _col1, _col2
-                File Output Operator
-                  compressed: false
-                  GlobalTableId: 1
-                  directory: pfile:/data/users/tomasz/apache-hive/build/ql/scratchdir/hive_2011-06-01_20-01-51_051_6120737160044680268/-ext-10002
-                  NumFilesPerFileSink: 1
-                  Stats Publishing Key Prefix: pfile:/data/users/tomasz/apache-hive/build/ql/scratchdir/hive_2011-06-01_20-01-51_051_6120737160044680268/-ext-10000/
-                  table:
-                      input format: org.apache.hadoop.mapred.TextInputFormat
-                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                      properties:
-                        bucket_count -1
-                        columns key,value
-                        columns.types string:string
-                        file.inputformat org.apache.hadoop.mapred.TextInputFormat
-                        file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                        location pfile:/data/users/tomasz/apache-hive/build/ql/test/data/warehouse/merge_src_part2
-                        name default.merge_src_part2
-                        partition_columns ds
-                        serialization.ddl struct merge_src_part2 { string key, string value}
-                        serialization.format 1
-                        serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                        transient_lastDdlTime 1306983711
-                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                      name: default.merge_src_part2
-                  TotalFiles: 1
-                  GatherStats: true
-                  MultiFileSpray: false
+            Select Operator
+              expressions:
+                    expr: key
+                    type: string
+                    expr: value
+                    type: string
+                    expr: ds
+                    type: string
+              outputColumnNames: _col0, _col1, _col2
+              File Output Operator
+                compressed: false
+                GlobalTableId: 1
+                directory: pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_02-35-46_067_3066864399805575043/-ext-10002
+                NumFilesPerFileSink: 1
+                Stats Publishing Key Prefix: pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_02-35-46_067_3066864399805575043/-ext-10000/
+                table:
+                    input format: org.apache.hadoop.mapred.TextInputFormat
+                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                    properties:
+                      bucket_count -1
+                      columns key,value
+                      columns.types string:string
+                      file.inputformat org.apache.hadoop.mapred.TextInputFormat
+                      file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                      location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/merge_src_part2
+                      name default.merge_src_part2
+                      partition_columns ds
+                      serialization.ddl struct merge_src_part2 { string key, string value}
+                      serialization.format 1
+                      serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                      transient_lastDdlTime 1310376946
+                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                    name: default.merge_src_part2
+                TotalFiles: 1
+                GatherStats: true
+                MultiFileSpray: false
       Needs Tagging: false
       Path -> Alias:
         pfile:/data/users/tomasz/apache-hive/build/ql/test/data/warehouse/merge_src_part/ds=2008-04-08 [merge_src_part]
@@ -4651,33 +4646,28 @@ STAGE PLANS:
           TableScan
             alias: merge_src_part
             GatherStats: false
-            Filter Operator
-              isSamplingPred: false
-              predicate:
-                  expr: ds is not null
-                  type: boolean
-              Select Operator
-                expressions:
-                      expr: key
+            Select Operator
+              expressions:
+                    expr: key
+                    type: string
+                    expr: value
+                    type: string
+                    expr: ds
+                    type: string
+              outputColumnNames: _col0, _col1, _col2
+              Reduce Output Operator
+                sort order: 
+                Map-reduce partition columns:
+                      expr: _col2
+                      type: string
+                tag: -1
+                value expressions:
+                      expr: _col0
                       type: string
-                      expr: value
+                      expr: _col1
                       type: string
-                      expr: ds
+                      expr: _col2
                       type: string
-                outputColumnNames: _col0, _col1, _col2
-                Reduce Output Operator
-                  sort order: 
-                  Map-reduce partition columns:
-                        expr: _col2
-                        type: string
-                  tag: -1
-                  value expressions:
-                        expr: _col0
-                        type: string
-                        expr: _col1
-                        type: string
-                        expr: _col2
-                        type: string
       Needs Tagging: false
       Path -> Alias:
         pfile:/data/users/tomasz/apache-hive/build/ql/test/data/warehouse/merge_src_part/ds=2008-04-08 [s:merge_src_part]
diff --git a/ql/src/test/results/clientpositive/merge4.q.out b/ql/src/test/results/clientpositive/merge4.q.out
index c948d9330c..b170355cc4 100644
--- a/ql/src/test/results/clientpositive/merge4.q.out
+++ b/ql/src/test/results/clientpositive/merge4.q.out
@@ -27,27 +27,23 @@ STAGE PLANS:
         srcpart 
           TableScan
             alias: srcpart
-            Filter Operator
-              predicate:
-                  expr: (ds = '2008-04-08')
-                  type: boolean
-              Select Operator
-                expressions:
-                      expr: key
-                      type: string
-                      expr: value
-                      type: string
-                      expr: hr
-                      type: string
-                outputColumnNames: _col0, _col1, _col2
-                File Output Operator
-                  compressed: false
-                  GlobalTableId: 1
-                  table:
-                      input format: org.apache.hadoop.mapred.TextInputFormat
-                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                      name: default.nzhang_part
+            Select Operator
+              expressions:
+                    expr: key
+                    type: string
+                    expr: value
+                    type: string
+                    expr: hr
+                    type: string
+              outputColumnNames: _col0, _col1, _col2
+              File Output Operator
+                compressed: false
+                GlobalTableId: 1
+                table:
+                    input format: org.apache.hadoop.mapred.TextInputFormat
+                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                    name: default.nzhang_part
 
   Stage: Stage-5
     Conditional Operator
@@ -1145,25 +1141,21 @@ STAGE PLANS:
         srcpart 
           TableScan
             alias: srcpart
-            Filter Operator
-              predicate:
-                  expr: (ds = '2008-04-08')
-                  type: boolean
-              Select Operator
-                expressions:
-                      expr: key
-                      type: string
-                      expr: value
-                      type: string
-                outputColumnNames: _col0, _col1
-                File Output Operator
-                  compressed: false
-                  GlobalTableId: 1
-                  table:
-                      input format: org.apache.hadoop.mapred.TextInputFormat
-                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                      name: default.nzhang_part
+            Select Operator
+              expressions:
+                    expr: key
+                    type: string
+                    expr: value
+                    type: string
+              outputColumnNames: _col0, _col1
+              File Output Operator
+                compressed: false
+                GlobalTableId: 1
+                table:
+                    input format: org.apache.hadoop.mapred.TextInputFormat
+                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                    name: default.nzhang_part
 
   Stage: Stage-5
     Conditional Operator
@@ -2776,25 +2768,21 @@ STAGE PLANS:
         null-subquery1:s-subquery1:srcpart 
           TableScan
             alias: srcpart
-            Filter Operator
-              predicate:
-                  expr: (ds = '2008-04-08')
-                  type: boolean
-              Select Operator
-                expressions:
-                      expr: key
-                      type: string
-                      expr: value
-                      type: string
-                      expr: hr
-                      type: string
-                outputColumnNames: _col0, _col1, _col2
-                File Output Operator
-                  compressed: false
-                  GlobalTableId: 0
-                  table:
-                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
-                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+            Select Operator
+              expressions:
+                    expr: key
+                    type: string
+                    expr: value
+                    type: string
+                    expr: hr
+                    type: string
+              outputColumnNames: _col0, _col1, _col2
+              File Output Operator
+                compressed: false
+                GlobalTableId: 0
+                table:
+                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
 
   Stage: Stage-2
     Map Reduce
diff --git a/ql/src/test/results/clientpositive/merge_dynamic_partition.q.out b/ql/src/test/results/clientpositive/merge_dynamic_partition.q.out
index 3c7b7c0c78..a697a1b091 100644
--- a/ql/src/test/results/clientpositive/merge_dynamic_partition.q.out
+++ b/ql/src/test/results/clientpositive/merge_dynamic_partition.q.out
@@ -54,27 +54,23 @@ STAGE PLANS:
         srcpart_merge_dp 
           TableScan
             alias: srcpart_merge_dp
-            Filter Operator
-              predicate:
-                  expr: (ds = '2008-04-08')
-                  type: boolean
-              Select Operator
-                expressions:
-                      expr: key
-                      type: string
-                      expr: value
-                      type: string
-                      expr: hr
-                      type: string
-                outputColumnNames: _col0, _col1, _col2
-                File Output Operator
-                  compressed: false
-                  GlobalTableId: 1
-                  table:
-                      input format: org.apache.hadoop.mapred.TextInputFormat
-                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                      name: default.merge_dynamic_part
+            Select Operator
+              expressions:
+                    expr: key
+                    type: string
+                    expr: value
+                    type: string
+                    expr: hr
+                    type: string
+              outputColumnNames: _col0, _col1, _col2
+              File Output Operator
+                compressed: false
+                GlobalTableId: 1
+                table:
+                    input format: org.apache.hadoop.mapred.TextInputFormat
+                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                    name: default.merge_dynamic_part
 
   Stage: Stage-0
     Move Operator
@@ -660,25 +656,21 @@ STAGE PLANS:
         srcpart_merge_dp 
           TableScan
             alias: srcpart_merge_dp
-            Filter Operator
-              predicate:
-                  expr: (ds = '2008-04-08')
-                  type: boolean
-              Select Operator
-                expressions:
-                      expr: key
-                      type: string
-                      expr: value
-                      type: string
-                outputColumnNames: _col0, _col1
-                File Output Operator
-                  compressed: false
-                  GlobalTableId: 1
-                  table:
-                      input format: org.apache.hadoop.mapred.TextInputFormat
-                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                      name: default.merge_dynamic_part
+            Select Operator
+              expressions:
+                    expr: key
+                    type: string
+                    expr: value
+                    type: string
+              outputColumnNames: _col0, _col1
+              File Output Operator
+                compressed: false
+                GlobalTableId: 1
+                table:
+                    input format: org.apache.hadoop.mapred.TextInputFormat
+                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                    name: default.merge_dynamic_part
 
   Stage: Stage-5
     Conditional Operator
@@ -1294,29 +1286,25 @@ STAGE PLANS:
         srcpart_merge_dp 
           TableScan
             alias: srcpart_merge_dp
-            Filter Operator
-              predicate:
-                  expr: ((ds = '2008-04-08') and (hr = 11))
-                  type: boolean
-              Select Operator
-                expressions:
-                      expr: key
-                      type: string
-                      expr: value
-                      type: string
-                      expr: ds
-                      type: string
-                      expr: hr
-                      type: string
-                outputColumnNames: _col0, _col1, _col2, _col3
-                File Output Operator
-                  compressed: false
-                  GlobalTableId: 1
-                  table:
-                      input format: org.apache.hadoop.mapred.TextInputFormat
-                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                      name: default.merge_dynamic_part
+            Select Operator
+              expressions:
+                    expr: key
+                    type: string
+                    expr: value
+                    type: string
+                    expr: ds
+                    type: string
+                    expr: hr
+                    type: string
+              outputColumnNames: _col0, _col1, _col2, _col3
+              File Output Operator
+                compressed: false
+                GlobalTableId: 1
+                table:
+                    input format: org.apache.hadoop.mapred.TextInputFormat
+                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                    name: default.merge_dynamic_part
 
   Stage: Stage-5
     Conditional Operator
diff --git a/ql/src/test/results/clientpositive/merge_dynamic_partition2.q.out b/ql/src/test/results/clientpositive/merge_dynamic_partition2.q.out
index 9030a34091..e78adbe7fc 100644
--- a/ql/src/test/results/clientpositive/merge_dynamic_partition2.q.out
+++ b/ql/src/test/results/clientpositive/merge_dynamic_partition2.q.out
@@ -70,27 +70,23 @@ STAGE PLANS:
         srcpart_merge_dp 
           TableScan
             alias: srcpart_merge_dp
-            Filter Operator
-              predicate:
-                  expr: (ds = '2008-04-08')
-                  type: boolean
-              Select Operator
-                expressions:
-                      expr: key
-                      type: string
-                      expr: value
-                      type: string
-                      expr: hr
-                      type: string
-                outputColumnNames: _col0, _col1, _col2
-                File Output Operator
-                  compressed: false
-                  GlobalTableId: 1
-                  table:
-                      input format: org.apache.hadoop.mapred.TextInputFormat
-                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                      name: default.merge_dynamic_part
+            Select Operator
+              expressions:
+                    expr: key
+                    type: string
+                    expr: value
+                    type: string
+                    expr: hr
+                    type: string
+              outputColumnNames: _col0, _col1, _col2
+              File Output Operator
+                compressed: false
+                GlobalTableId: 1
+                table:
+                    input format: org.apache.hadoop.mapred.TextInputFormat
+                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                    name: default.merge_dynamic_part
 
   Stage: Stage-5
     Conditional Operator
diff --git a/ql/src/test/results/clientpositive/merge_dynamic_partition3.q.out b/ql/src/test/results/clientpositive/merge_dynamic_partition3.q.out
index 5a114d8838..24d1d80de5 100644
--- a/ql/src/test/results/clientpositive/merge_dynamic_partition3.q.out
+++ b/ql/src/test/results/clientpositive/merge_dynamic_partition3.q.out
@@ -116,29 +116,25 @@ STAGE PLANS:
         srcpart_merge_dp 
           TableScan
             alias: srcpart_merge_dp
-            Filter Operator
-              predicate:
-                  expr: (ds >= '2008-04-08')
-                  type: boolean
-              Select Operator
-                expressions:
-                      expr: key
-                      type: string
-                      expr: value
-                      type: string
-                      expr: ds
-                      type: string
-                      expr: hr
-                      type: string
-                outputColumnNames: _col0, _col1, _col2, _col3
-                File Output Operator
-                  compressed: false
-                  GlobalTableId: 1
-                  table:
-                      input format: org.apache.hadoop.mapred.TextInputFormat
-                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                      name: default.merge_dynamic_part
+            Select Operator
+              expressions:
+                    expr: key
+                    type: string
+                    expr: value
+                    type: string
+                    expr: ds
+                    type: string
+                    expr: hr
+                    type: string
+              outputColumnNames: _col0, _col1, _col2, _col3
+              File Output Operator
+                compressed: false
+                GlobalTableId: 1
+                table:
+                    input format: org.apache.hadoop.mapred.TextInputFormat
+                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                    name: default.merge_dynamic_part
 
   Stage: Stage-5
     Conditional Operator
diff --git a/ql/src/test/results/clientpositive/no_hooks.q.out b/ql/src/test/results/clientpositive/no_hooks.q.out
index 262308fb15..8501279e73 100644
--- a/ql/src/test/results/clientpositive/no_hooks.q.out
+++ b/ql/src/test/results/clientpositive/no_hooks.q.out
@@ -52,27 +52,23 @@ STAGE PLANS:
             1 {VALUE._col0} {VALUE._col1}
           handleSkewJoin: false
           outputColumnNames: _col0, _col1, _col4, _col5
-          Filter Operator
-            predicate:
-                expr: ((_col0 < 10) and (_col4 < 10))
-                type: boolean
-            Select Operator
-              expressions:
-                    expr: _col0
-                    type: string
-                    expr: _col1
-                    type: string
-                    expr: _col4
-                    type: string
-                    expr: _col5
-                    type: string
-              outputColumnNames: _col0, _col1, _col2, _col3
-              File Output Operator
-                compressed: false
-                GlobalTableId: 0
-                table:
-                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
-                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+          Select Operator
+            expressions:
+                  expr: _col0
+                  type: string
+                  expr: _col1
+                  type: string
+                  expr: _col4
+                  type: string
+                  expr: _col5
+                  type: string
+            outputColumnNames: _col0, _col1, _col2, _col3
+            File Output Operator
+              compressed: false
+              GlobalTableId: 0
+              table:
+                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
 
   Stage: Stage-2
     Map Reduce
diff --git a/ql/src/test/results/clientpositive/noalias_subq1.q.out b/ql/src/test/results/clientpositive/noalias_subq1.q.out
index 6c78838ea1..6d6645b838 100644
--- a/ql/src/test/results/clientpositive/noalias_subq1.q.out
+++ b/ql/src/test/results/clientpositive/noalias_subq1.q.out
@@ -29,21 +29,17 @@ STAGE PLANS:
                       expr: key
                       type: string
                 outputColumnNames: _col0, _col1
-                Filter Operator
-                  predicate:
-                      expr: (_col1 < 100)
-                      type: boolean
-                  Select Operator
-                    expressions:
-                          expr: _col0
-                          type: string
-                    outputColumnNames: _col0
-                    File Output Operator
-                      compressed: false
-                      GlobalTableId: 0
-                      table:
-                          input format: org.apache.hadoop.mapred.TextInputFormat
-                          output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                Select Operator
+                  expressions:
+                        expr: _col0
+                        type: string
+                  outputColumnNames: _col0
+                  File Output Operator
+                    compressed: false
+                    GlobalTableId: 0
+                    table:
+                        input format: org.apache.hadoop.mapred.TextInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
 
   Stage: Stage-0
     Fetch Operator
diff --git a/ql/src/test/results/clientpositive/notable_alias1.q.out b/ql/src/test/results/clientpositive/notable_alias1.q.out
index 4d21253b72..e92afa987a 100644
--- a/ql/src/test/results/clientpositive/notable_alias1.q.out
+++ b/ql/src/test/results/clientpositive/notable_alias1.q.out
@@ -30,36 +30,32 @@ STAGE PLANS:
               predicate:
                   expr: (key < 100)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 100)
-                    type: boolean
-                Select Operator
-                  expressions:
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                outputColumnNames: key
+                Group By Operator
+                  aggregations:
+                        expr: count(1)
+                  bucketGroup: false
+                  keys:
                         expr: key
                         type: string
-                  outputColumnNames: key
-                  Group By Operator
-                    aggregations:
-                          expr: count(1)
-                    bucketGroup: false
-                    keys:
-                          expr: key
+                  mode: hash
+                  outputColumnNames: _col0, _col1
+                  Reduce Output Operator
+                    key expressions:
+                          expr: _col0
                           type: string
-                    mode: hash
-                    outputColumnNames: _col0, _col1
-                    Reduce Output Operator
-                      key expressions:
-                            expr: _col0
-                            type: string
-                      sort order: +
-                      Map-reduce partition columns:
-                            expr: _col0
-                            type: string
-                      tag: -1
-                      value expressions:
-                            expr: _col1
-                            type: bigint
+                    sort order: +
+                    Map-reduce partition columns:
+                          expr: _col0
+                          type: string
+                    tag: -1
+                    value expressions:
+                          expr: _col1
+                          type: bigint
       Reduce Operator Tree:
         Group By Operator
           aggregations:
diff --git a/ql/src/test/results/clientpositive/notable_alias2.q.out b/ql/src/test/results/clientpositive/notable_alias2.q.out
index 7440821f71..2431ee0ada 100644
--- a/ql/src/test/results/clientpositive/notable_alias2.q.out
+++ b/ql/src/test/results/clientpositive/notable_alias2.q.out
@@ -30,36 +30,32 @@ STAGE PLANS:
               predicate:
                   expr: (key < 100)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 100)
-                    type: boolean
-                Select Operator
-                  expressions:
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                outputColumnNames: key
+                Group By Operator
+                  aggregations:
+                        expr: count(1)
+                  bucketGroup: false
+                  keys:
                         expr: key
                         type: string
-                  outputColumnNames: key
-                  Group By Operator
-                    aggregations:
-                          expr: count(1)
-                    bucketGroup: false
-                    keys:
-                          expr: key
+                  mode: hash
+                  outputColumnNames: _col0, _col1
+                  Reduce Output Operator
+                    key expressions:
+                          expr: _col0
                           type: string
-                    mode: hash
-                    outputColumnNames: _col0, _col1
-                    Reduce Output Operator
-                      key expressions:
-                            expr: _col0
-                            type: string
-                      sort order: +
-                      Map-reduce partition columns:
-                            expr: _col0
-                            type: string
-                      tag: -1
-                      value expressions:
-                            expr: _col1
-                            type: bigint
+                    sort order: +
+                    Map-reduce partition columns:
+                          expr: _col0
+                          type: string
+                    tag: -1
+                    value expressions:
+                          expr: _col1
+                          type: bigint
       Reduce Operator Tree:
         Group By Operator
           aggregations:
diff --git a/ql/src/test/results/clientpositive/nullgroup.q.out b/ql/src/test/results/clientpositive/nullgroup.q.out
index c4e1fca251..33a4558a40 100644
--- a/ql/src/test/results/clientpositive/nullgroup.q.out
+++ b/ql/src/test/results/clientpositive/nullgroup.q.out
@@ -22,23 +22,19 @@ STAGE PLANS:
               predicate:
                   expr: (key > 9999)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key > 9999)
-                    type: boolean
-                Select Operator
-                  Group By Operator
-                    aggregations:
-                          expr: count(1)
-                    bucketGroup: false
-                    mode: hash
-                    outputColumnNames: _col0
-                    Reduce Output Operator
-                      sort order: 
-                      tag: -1
-                      value expressions:
-                            expr: _col0
-                            type: bigint
+              Select Operator
+                Group By Operator
+                  aggregations:
+                        expr: count(1)
+                  bucketGroup: false
+                  mode: hash
+                  outputColumnNames: _col0
+                  Reduce Output Operator
+                    sort order: 
+                    tag: -1
+                    value expressions:
+                          expr: _col0
+                          type: bigint
       Reduce Operator Tree:
         Group By Operator
           aggregations:
@@ -96,23 +92,19 @@ STAGE PLANS:
               predicate:
                   expr: (key > 9999)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key > 9999)
-                    type: boolean
-                Select Operator
-                  Group By Operator
-                    aggregations:
-                          expr: count(1)
-                    bucketGroup: false
-                    mode: hash
-                    outputColumnNames: _col0
-                    Reduce Output Operator
-                      sort order: 
-                      tag: -1
-                      value expressions:
-                            expr: _col0
-                            type: bigint
+              Select Operator
+                Group By Operator
+                  aggregations:
+                        expr: count(1)
+                  bucketGroup: false
+                  mode: hash
+                  outputColumnNames: _col0
+                  Reduce Output Operator
+                    sort order: 
+                    tag: -1
+                    value expressions:
+                          expr: _col0
+                          type: bigint
       Reduce Operator Tree:
         Group By Operator
           aggregations:
@@ -171,20 +163,16 @@ STAGE PLANS:
               predicate:
                   expr: (key > 9999)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key > 9999)
-                    type: boolean
-                Select Operator
-                  Reduce Output Operator
-                    sort order: 
-                    Map-reduce partition columns:
-                          expr: rand()
-                          type: double
-                    tag: -1
-                    value expressions:
-                          expr: 1
-                          type: int
+              Select Operator
+                Reduce Output Operator
+                  sort order: 
+                  Map-reduce partition columns:
+                        expr: rand()
+                        type: double
+                  tag: -1
+                  value expressions:
+                        expr: 1
+                        type: int
       Reduce Operator Tree:
         Group By Operator
           aggregations:
@@ -266,17 +254,13 @@ STAGE PLANS:
               predicate:
                   expr: (key > 9999)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key > 9999)
-                    type: boolean
-                Select Operator
-                  Reduce Output Operator
-                    sort order: 
-                    tag: -1
-                    value expressions:
-                          expr: 1
-                          type: int
+              Select Operator
+                Reduce Output Operator
+                  sort order: 
+                  tag: -1
+                  value expressions:
+                        expr: 1
+                        type: int
       Reduce Operator Tree:
         Group By Operator
           aggregations:
diff --git a/ql/src/test/results/clientpositive/nullgroup2.q.out b/ql/src/test/results/clientpositive/nullgroup2.q.out
index 6964a31435..8401cf1e03 100644
--- a/ql/src/test/results/clientpositive/nullgroup2.q.out
+++ b/ql/src/test/results/clientpositive/nullgroup2.q.out
@@ -23,36 +23,32 @@ STAGE PLANS:
               predicate:
                   expr: (key > 9999)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key > 9999)
-                    type: boolean
-                Select Operator
-                  expressions:
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                outputColumnNames: key
+                Group By Operator
+                  aggregations:
+                        expr: count(1)
+                  bucketGroup: false
+                  keys:
                         expr: key
                         type: string
-                  outputColumnNames: key
-                  Group By Operator
-                    aggregations:
-                          expr: count(1)
-                    bucketGroup: false
-                    keys:
-                          expr: key
+                  mode: hash
+                  outputColumnNames: _col0, _col1
+                  Reduce Output Operator
+                    key expressions:
+                          expr: _col0
                           type: string
-                    mode: hash
-                    outputColumnNames: _col0, _col1
-                    Reduce Output Operator
-                      key expressions:
-                            expr: _col0
-                            type: string
-                      sort order: +
-                      Map-reduce partition columns:
-                            expr: rand()
-                            type: double
-                      tag: -1
-                      value expressions:
-                            expr: _col1
-                            type: bigint
+                    sort order: +
+                    Map-reduce partition columns:
+                          expr: rand()
+                          type: double
+                    tag: -1
+                    value expressions:
+                          expr: _col1
+                          type: bigint
       Reduce Operator Tree:
         Group By Operator
           aggregations:
@@ -147,36 +143,32 @@ STAGE PLANS:
               predicate:
                   expr: (key > 9999)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key > 9999)
-                    type: boolean
-                Select Operator
-                  expressions:
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                outputColumnNames: key
+                Group By Operator
+                  aggregations:
+                        expr: count(1)
+                  bucketGroup: false
+                  keys:
                         expr: key
                         type: string
-                  outputColumnNames: key
-                  Group By Operator
-                    aggregations:
-                          expr: count(1)
-                    bucketGroup: false
-                    keys:
-                          expr: key
+                  mode: hash
+                  outputColumnNames: _col0, _col1
+                  Reduce Output Operator
+                    key expressions:
+                          expr: _col0
+                          type: string
+                    sort order: +
+                    Map-reduce partition columns:
+                          expr: _col0
                           type: string
-                    mode: hash
-                    outputColumnNames: _col0, _col1
-                    Reduce Output Operator
-                      key expressions:
-                            expr: _col0
-                            type: string
-                      sort order: +
-                      Map-reduce partition columns:
-                            expr: _col0
-                            type: string
-                      tag: -1
-                      value expressions:
-                            expr: _col1
-                            type: bigint
+                    tag: -1
+                    value expressions:
+                          expr: _col1
+                          type: bigint
       Reduce Operator Tree:
         Group By Operator
           aggregations:
@@ -239,27 +231,23 @@ STAGE PLANS:
               predicate:
                   expr: (key > 9999)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key > 9999)
-                    type: boolean
-                Select Operator
-                  expressions:
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                outputColumnNames: key
+                Reduce Output Operator
+                  key expressions:
                         expr: key
                         type: string
-                  outputColumnNames: key
-                  Reduce Output Operator
-                    key expressions:
-                          expr: key
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: rand()
-                          type: double
-                    tag: -1
-                    value expressions:
-                          expr: 1
-                          type: int
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: rand()
+                        type: double
+                  tag: -1
+                  value expressions:
+                        expr: 1
+                        type: int
       Reduce Operator Tree:
         Group By Operator
           aggregations:
@@ -354,27 +342,23 @@ STAGE PLANS:
               predicate:
                   expr: (key > 9999)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key > 9999)
-                    type: boolean
-                Select Operator
-                  expressions:
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                outputColumnNames: key
+                Reduce Output Operator
+                  key expressions:
                         expr: key
                         type: string
-                  outputColumnNames: key
-                  Reduce Output Operator
-                    key expressions:
-                          expr: key
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: key
-                          type: string
-                    tag: -1
-                    value expressions:
-                          expr: 1
-                          type: int
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: key
+                        type: string
+                  tag: -1
+                  value expressions:
+                        expr: 1
+                        type: int
       Reduce Operator Tree:
         Group By Operator
           aggregations:
diff --git a/ql/src/test/results/clientpositive/nullgroup4.q.out b/ql/src/test/results/clientpositive/nullgroup4.q.out
index 7de89870fa..1e832a4b78 100644
--- a/ql/src/test/results/clientpositive/nullgroup4.q.out
+++ b/ql/src/test/results/clientpositive/nullgroup4.q.out
@@ -23,39 +23,35 @@ STAGE PLANS:
               predicate:
                   expr: (key = 9999)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key = 9999)
-                    type: boolean
-                Select Operator
-                  expressions:
+              Select Operator
+                expressions:
+                      expr: value
+                      type: string
+                outputColumnNames: value
+                Group By Operator
+                  aggregations:
+                        expr: count(1)
+                        expr: count(DISTINCT value)
+                  bucketGroup: false
+                  keys:
                         expr: value
                         type: string
-                  outputColumnNames: value
-                  Group By Operator
-                    aggregations:
-                          expr: count(1)
-                          expr: count(DISTINCT value)
-                    bucketGroup: false
-                    keys:
-                          expr: value
+                  mode: hash
+                  outputColumnNames: _col0, _col1, _col2
+                  Reduce Output Operator
+                    key expressions:
+                          expr: _col0
                           type: string
-                    mode: hash
-                    outputColumnNames: _col0, _col1, _col2
-                    Reduce Output Operator
-                      key expressions:
-                            expr: _col0
-                            type: string
-                      sort order: +
-                      Map-reduce partition columns:
-                            expr: _col0
-                            type: string
-                      tag: -1
-                      value expressions:
-                            expr: _col1
-                            type: bigint
-                            expr: _col2
-                            type: bigint
+                    sort order: +
+                    Map-reduce partition columns:
+                          expr: _col0
+                          type: string
+                    tag: -1
+                    value expressions:
+                          expr: _col1
+                          type: bigint
+                          expr: _col2
+                          type: bigint
       Reduce Operator Tree:
         Group By Operator
           aggregations:
@@ -143,36 +139,32 @@ STAGE PLANS:
               predicate:
                   expr: (key = 9999)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key = 9999)
-                    type: boolean
-                Select Operator
-                  expressions:
+              Select Operator
+                expressions:
+                      expr: value
+                      type: string
+                outputColumnNames: value
+                Group By Operator
+                  aggregations:
+                        expr: count(1)
+                        expr: count(DISTINCT value)
+                  bucketGroup: false
+                  keys:
                         expr: value
                         type: string
-                  outputColumnNames: value
-                  Group By Operator
-                    aggregations:
-                          expr: count(1)
-                          expr: count(DISTINCT value)
-                    bucketGroup: false
-                    keys:
-                          expr: value
+                  mode: hash
+                  outputColumnNames: _col0, _col1, _col2
+                  Reduce Output Operator
+                    key expressions:
+                          expr: _col0
                           type: string
-                    mode: hash
-                    outputColumnNames: _col0, _col1, _col2
-                    Reduce Output Operator
-                      key expressions:
-                            expr: _col0
-                            type: string
-                      sort order: +
-                      tag: -1
-                      value expressions:
-                            expr: _col1
-                            type: bigint
-                            expr: _col2
-                            type: bigint
+                    sort order: +
+                    tag: -1
+                    value expressions:
+                          expr: _col1
+                          type: bigint
+                          expr: _col2
+                          type: bigint
       Reduce Operator Tree:
         Group By Operator
           aggregations:
@@ -234,27 +226,23 @@ STAGE PLANS:
               predicate:
                   expr: (key = 9999)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key = 9999)
-                    type: boolean
-                Select Operator
-                  expressions:
+              Select Operator
+                expressions:
+                      expr: value
+                      type: string
+                outputColumnNames: value
+                Reduce Output Operator
+                  key expressions:
                         expr: value
                         type: string
-                  outputColumnNames: value
-                  Reduce Output Operator
-                    key expressions:
-                          expr: value
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: value
-                          type: string
-                    tag: -1
-                    value expressions:
-                          expr: 1
-                          type: int
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: value
+                        type: string
+                  tag: -1
+                  value expressions:
+                        expr: 1
+                        type: int
       Reduce Operator Tree:
         Group By Operator
           aggregations:
@@ -342,24 +330,20 @@ STAGE PLANS:
               predicate:
                   expr: (key = 9999)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key = 9999)
-                    type: boolean
-                Select Operator
-                  expressions:
+              Select Operator
+                expressions:
+                      expr: value
+                      type: string
+                outputColumnNames: value
+                Reduce Output Operator
+                  key expressions:
                         expr: value
                         type: string
-                  outputColumnNames: value
-                  Reduce Output Operator
-                    key expressions:
-                          expr: value
-                          type: string
-                    sort order: +
-                    tag: -1
-                    value expressions:
-                          expr: 1
-                          type: int
+                  sort order: +
+                  tag: -1
+                  value expressions:
+                        expr: 1
+                        type: int
       Reduce Operator Tree:
         Group By Operator
           aggregations:
diff --git a/ql/src/test/results/clientpositive/nullgroup4_multi_distinct.q.out b/ql/src/test/results/clientpositive/nullgroup4_multi_distinct.q.out
index d7033f5af2..9a2cb51e03 100644
--- a/ql/src/test/results/clientpositive/nullgroup4_multi_distinct.q.out
+++ b/ql/src/test/results/clientpositive/nullgroup4_multi_distinct.q.out
@@ -22,43 +22,39 @@ STAGE PLANS:
               predicate:
                   expr: (key = 9999)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key = 9999)
-                    type: boolean
-                Select Operator
-                  expressions:
+              Select Operator
+                expressions:
+                      expr: value
+                      type: string
+                outputColumnNames: value
+                Group By Operator
+                  aggregations:
+                        expr: count(1)
+                        expr: count(DISTINCT value)
+                        expr: count(DISTINCT substr(value, 5))
+                  bucketGroup: false
+                  keys:
                         expr: value
                         type: string
-                  outputColumnNames: value
-                  Group By Operator
-                    aggregations:
-                          expr: count(1)
-                          expr: count(DISTINCT value)
-                          expr: count(DISTINCT substr(value, 5))
-                    bucketGroup: false
-                    keys:
-                          expr: value
+                        expr: substr(value, 5)
+                        type: string
+                  mode: hash
+                  outputColumnNames: _col0, _col1, _col2, _col3, _col4
+                  Reduce Output Operator
+                    key expressions:
+                          expr: _col0
                           type: string
-                          expr: substr(value, 5)
+                          expr: _col1
                           type: string
-                    mode: hash
-                    outputColumnNames: _col0, _col1, _col2, _col3, _col4
-                    Reduce Output Operator
-                      key expressions:
-                            expr: _col0
-                            type: string
-                            expr: _col1
-                            type: string
-                      sort order: ++
-                      tag: -1
-                      value expressions:
-                            expr: _col2
-                            type: bigint
-                            expr: _col3
-                            type: bigint
-                            expr: _col4
-                            type: bigint
+                    sort order: ++
+                    tag: -1
+                    value expressions:
+                          expr: _col2
+                          type: bigint
+                          expr: _col3
+                          type: bigint
+                          expr: _col4
+                          type: bigint
       Reduce Operator Tree:
         Group By Operator
           aggregations:
@@ -122,26 +118,22 @@ STAGE PLANS:
               predicate:
                   expr: (key = 9999)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key = 9999)
-                    type: boolean
-                Select Operator
-                  expressions:
+              Select Operator
+                expressions:
+                      expr: value
+                      type: string
+                outputColumnNames: value
+                Reduce Output Operator
+                  key expressions:
                         expr: value
                         type: string
-                  outputColumnNames: value
-                  Reduce Output Operator
-                    key expressions:
-                          expr: value
-                          type: string
-                          expr: substr(value, 5)
-                          type: string
-                    sort order: ++
-                    tag: -1
-                    value expressions:
-                          expr: 1
-                          type: int
+                        expr: substr(value, 5)
+                        type: string
+                  sort order: ++
+                  tag: -1
+                  value expressions:
+                        expr: 1
+                        type: int
       Reduce Operator Tree:
         Group By Operator
           aggregations:
diff --git a/ql/src/test/results/clientpositive/nullgroup5.q.out b/ql/src/test/results/clientpositive/nullgroup5.q.out
index f15b01cfcf..7068982e94 100644
--- a/ql/src/test/results/clientpositive/nullgroup5.q.out
+++ b/ql/src/test/results/clientpositive/nullgroup5.q.out
@@ -56,38 +56,6 @@ STAGE PLANS:
               predicate:
                   expr: (ds = '2009-04-05')
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (ds = '2009-04-05')
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
-                  outputColumnNames: _col0, _col1
-                  Union
-                    Select Operator
-                      expressions:
-                            expr: _col0
-                            type: string
-                            expr: _col1
-                            type: string
-                      outputColumnNames: _col0, _col1
-                      File Output Operator
-                        compressed: false
-                        GlobalTableId: 0
-                        table:
-                            input format: org.apache.hadoop.mapred.TextInputFormat
-                            output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-        null-subquery2:u-subquery2:y 
-          TableScan
-            alias: y
-            Filter Operator
-              predicate:
-                  expr: (ds = '2009-04-09')
-                  type: boolean
               Select Operator
                 expressions:
                       expr: key
@@ -109,6 +77,30 @@ STAGE PLANS:
                       table:
                           input format: org.apache.hadoop.mapred.TextInputFormat
                           output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+        null-subquery2:u-subquery2:y 
+          TableScan
+            alias: y
+            Select Operator
+              expressions:
+                    expr: key
+                    type: string
+                    expr: value
+                    type: string
+              outputColumnNames: _col0, _col1
+              Union
+                Select Operator
+                  expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col1
+                        type: string
+                  outputColumnNames: _col0, _col1
+                  File Output Operator
+                    compressed: false
+                    GlobalTableId: 0
+                    table:
+                        input format: org.apache.hadoop.mapred.TextInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
 
   Stage: Stage-0
     Fetch Operator
diff --git a/ql/src/test/results/clientpositive/outer_join_ppr.q.out b/ql/src/test/results/clientpositive/outer_join_ppr.q.out
index 3f0d38e3b0..8bf38c7197 100644
--- a/ql/src/test/results/clientpositive/outer_join_ppr.q.out
+++ b/ql/src/test/results/clientpositive/outer_join_ppr.q.out
@@ -288,7 +288,7 @@ STAGE PLANS:
           Filter Operator
             isSamplingPred: false
             predicate:
-                expr: ((((_col0 > 10) and (_col0 < 20)) and (_col4 > 15)) and (_col4 < 25))
+                expr: (((_col4 > 15) and (_col4 < 25)) and ((_col0 > 10) and (_col0 < 20)))
                 type: boolean
             Select Operator
               expressions:
@@ -650,7 +650,7 @@ STAGE PLANS:
           Filter Operator
             isSamplingPred: false
             predicate:
-                expr: (((((_col0 > 10) and (_col0 < 20)) and (_col4 > 15)) and (_col4 < 25)) and (_col6 = '2008-04-08'))
+                expr: ((((_col4 > 15) and (_col4 < 25)) and (_col6 = '2008-04-08')) and ((_col0 > 10) and (_col0 < 20)))
                 type: boolean
             Select Operator
               expressions:
diff --git a/ql/src/test/results/clientpositive/pcr.q.out b/ql/src/test/results/clientpositive/pcr.q.out
index bea728c6b6..74457f371b 100644
--- a/ql/src/test/results/clientpositive/pcr.q.out
+++ b/ql/src/test/results/clientpositive/pcr.q.out
@@ -81,35 +81,30 @@ STAGE PLANS:
               predicate:
                   expr: (key < 5)
                   type: boolean
-              Filter Operator
-                isSamplingPred: false
-                predicate:
-                    expr: ((ds <= '2000-04-09') and (key < 5))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: int
+                      expr: value
+                      type: string
+                      expr: ds
+                      type: string
+                outputColumnNames: _col0, _col1, _col2
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: int
+                        expr: _col2
+                        type: string
+                  sort order: ++
+                  tag: -1
+                  value expressions:
+                        expr: _col0
                         type: int
-                        expr: value
+                        expr: _col1
                         type: string
-                        expr: ds
+                        expr: _col2
                         type: string
-                  outputColumnNames: _col0, _col1, _col2
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: int
-                          expr: _col2
-                          type: string
-                    sort order: ++
-                    tag: -1
-                    value expressions:
-                          expr: _col0
-                          type: int
-                          expr: _col1
-                          type: string
-                          expr: _col2
-                          type: string
       Needs Tagging: false
       Path -> Alias:
         pfile:/data/users/tomasz/apache-hive/build/ql/test/data/warehouse/pcr_t1/ds=2000-04-08 [pcr_t1]
@@ -295,29 +290,24 @@ STAGE PLANS:
               predicate:
                   expr: ((ds <= '2000-04-09') or (key < 5))
                   type: boolean
-              Filter Operator
-                isSamplingPred: false
-                predicate:
-                    expr: ((ds <= '2000-04-09') or (key < 5))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: int
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
                         type: int
-                        expr: value
+                  sort order: +
+                  tag: -1
+                  value expressions:
+                        expr: _col0
+                        type: int
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: int
-                    sort order: +
-                    tag: -1
-                    value expressions:
-                          expr: _col0
-                          type: int
-                          expr: _col1
-                          type: string
       Needs Tagging: false
       Path -> Alias:
         pfile:/data/users/tomasz/apache-hive/build/ql/test/data/warehouse/pcr_t1/ds=2000-04-08 [pcr_t1]
@@ -591,35 +581,30 @@ STAGE PLANS:
               predicate:
                   expr: ((key < 5) and (value <> 'val_2'))
                   type: boolean
-              Filter Operator
-                isSamplingPred: false
-                predicate:
-                    expr: (((ds <= '2000-04-09') and (key < 5)) and (value <> 'val_2'))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: int
+                      expr: value
+                      type: string
+                      expr: ds
+                      type: string
+                outputColumnNames: _col0, _col1, _col2
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: int
+                        expr: _col2
+                        type: string
+                  sort order: ++
+                  tag: -1
+                  value expressions:
+                        expr: _col0
                         type: int
-                        expr: value
+                        expr: _col1
                         type: string
-                        expr: ds
+                        expr: _col2
                         type: string
-                  outputColumnNames: _col0, _col1, _col2
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: int
-                          expr: _col2
-                          type: string
-                    sort order: ++
-                    tag: -1
-                    value expressions:
-                          expr: _col0
-                          type: int
-                          expr: _col1
-                          type: string
-                          expr: _col2
-                          type: string
       Needs Tagging: false
       Path -> Alias:
         pfile:/data/users/tomasz/apache-hive/build/ql/test/data/warehouse/pcr_t1/ds=2000-04-08 [pcr_t1]
@@ -807,35 +792,30 @@ STAGE PLANS:
               predicate:
                   expr: (((ds < '2000-04-09') and (key < 5)) or ((ds > '2000-04-09') and (value = 'val_5')))
                   type: boolean
-              Filter Operator
-                isSamplingPred: false
-                predicate:
-                    expr: (((ds < '2000-04-09') and (key < 5)) or ((ds > '2000-04-09') and (value = 'val_5')))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: int
+                      expr: value
+                      type: string
+                      expr: ds
+                      type: string
+                outputColumnNames: _col0, _col1, _col2
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
                         type: int
-                        expr: value
+                        expr: _col2
+                        type: string
+                  sort order: ++
+                  tag: -1
+                  value expressions:
+                        expr: _col0
+                        type: int
+                        expr: _col1
                         type: string
-                        expr: ds
+                        expr: _col2
                         type: string
-                  outputColumnNames: _col0, _col1, _col2
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: int
-                          expr: _col2
-                          type: string
-                    sort order: ++
-                    tag: -1
-                    value expressions:
-                          expr: _col0
-                          type: int
-                          expr: _col1
-                          type: string
-                          expr: _col2
-                          type: string
       Needs Tagging: false
       Path -> Alias:
         pfile:/data/users/tomasz/apache-hive/build/ql/test/data/warehouse/pcr_t1/ds=2000-04-08 [pcr_t1]
@@ -1025,35 +1005,30 @@ STAGE PLANS:
               predicate:
                   expr: (((ds < '2000-04-10') and (key < 5)) or ((ds > '2000-04-08') and (value = 'val_5')))
                   type: boolean
-              Filter Operator
-                isSamplingPred: false
-                predicate:
-                    expr: (((ds < '2000-04-10') and (key < 5)) or ((ds > '2000-04-08') and (value = 'val_5')))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: int
+                      expr: value
+                      type: string
+                      expr: ds
+                      type: string
+                outputColumnNames: _col0, _col1, _col2
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
                         type: int
-                        expr: value
+                        expr: _col2
                         type: string
-                        expr: ds
+                  sort order: ++
+                  tag: -1
+                  value expressions:
+                        expr: _col0
+                        type: int
+                        expr: _col1
+                        type: string
+                        expr: _col2
                         type: string
-                  outputColumnNames: _col0, _col1, _col2
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: int
-                          expr: _col2
-                          type: string
-                    sort order: ++
-                    tag: -1
-                    value expressions:
-                          expr: _col0
-                          type: int
-                          expr: _col1
-                          type: string
-                          expr: _col2
-                          type: string
       Needs Tagging: false
       Path -> Alias:
         pfile:/data/users/tomasz/apache-hive/build/ql/test/data/warehouse/pcr_t1/ds=2000-04-08 [pcr_t1]
@@ -1304,35 +1279,30 @@ STAGE PLANS:
               predicate:
                   expr: (((ds < '2000-04-10') or (key < 5)) and ((ds > '2000-04-08') or (value = 'val_5')))
                   type: boolean
-              Filter Operator
-                isSamplingPred: false
-                predicate:
-                    expr: (((ds < '2000-04-10') or (key < 5)) and ((ds > '2000-04-08') or (value = 'val_5')))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: int
+                      expr: value
+                      type: string
+                      expr: ds
+                      type: string
+                outputColumnNames: _col0, _col1, _col2
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
                         type: int
-                        expr: value
+                        expr: _col2
                         type: string
-                        expr: ds
+                  sort order: ++
+                  tag: -1
+                  value expressions:
+                        expr: _col0
+                        type: int
+                        expr: _col1
+                        type: string
+                        expr: _col2
                         type: string
-                  outputColumnNames: _col0, _col1, _col2
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: int
-                          expr: _col2
-                          type: string
-                    sort order: ++
-                    tag: -1
-                    value expressions:
-                          expr: _col0
-                          type: int
-                          expr: _col1
-                          type: string
-                          expr: _col2
-                          type: string
       Needs Tagging: false
       Path -> Alias:
         pfile:/data/users/tomasz/apache-hive/build/ql/test/data/warehouse/pcr_t1/ds=2000-04-08 [pcr_t1]
@@ -1591,31 +1561,26 @@ STAGE PLANS:
               predicate:
                   expr: (key = 14)
                   type: boolean
-              Filter Operator
-                isSamplingPred: false
-                predicate:
-                    expr: (((ds = '2000-04-08') or (ds = '2000-04-09')) and (key = 14))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: int
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: int
+                        expr: _col1
+                        type: string
+                  sort order: ++
+                  tag: -1
+                  value expressions:
+                        expr: _col0
                         type: int
-                        expr: value
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: int
-                          expr: _col1
-                          type: string
-                    sort order: ++
-                    tag: -1
-                    value expressions:
-                          expr: _col0
-                          type: int
-                          expr: _col1
-                          type: string
       Needs Tagging: false
       Path -> Alias:
         pfile:/data/users/tomasz/apache-hive/build/ql/test/data/warehouse/pcr_t1/ds=2000-04-08 [pcr_t1]
@@ -1786,31 +1751,26 @@ STAGE PLANS:
           TableScan
             alias: pcr_t1
             GatherStats: false
-            Filter Operator
-              isSamplingPred: false
-              predicate:
-                  expr: ((ds = '2000-04-08') or (ds = '2000-04-09'))
-                  type: boolean
-              Select Operator
-                expressions:
-                      expr: key
+            Select Operator
+              expressions:
+                    expr: key
+                    type: int
+                    expr: value
+                    type: string
+              outputColumnNames: _col0, _col1
+              Reduce Output Operator
+                key expressions:
+                      expr: _col0
                       type: int
-                      expr: value
+                      expr: _col1
+                      type: string
+                sort order: ++
+                tag: -1
+                value expressions:
+                      expr: _col0
+                      type: int
+                      expr: _col1
                       type: string
-                outputColumnNames: _col0, _col1
-                Reduce Output Operator
-                  key expressions:
-                        expr: _col0
-                        type: int
-                        expr: _col1
-                        type: string
-                  sort order: ++
-                  tag: -1
-                  value expressions:
-                        expr: _col0
-                        type: int
-                        expr: _col1
-                        type: string
       Needs Tagging: false
       Path -> Alias:
         pfile:/data/users/tomasz/apache-hive/build/ql/test/data/warehouse/pcr_t1/ds=2000-04-08 [pcr_t1]
@@ -2021,31 +1981,26 @@ STAGE PLANS:
           TableScan
             alias: pcr_t1
             GatherStats: false
-            Filter Operator
-              isSamplingPred: false
-              predicate:
-                  expr: ((ds >= '2000-04-08') or (ds < '2000-04-10'))
-                  type: boolean
-              Select Operator
-                expressions:
-                      expr: key
+            Select Operator
+              expressions:
+                    expr: key
+                    type: int
+                    expr: value
+                    type: string
+              outputColumnNames: _col0, _col1
+              Reduce Output Operator
+                key expressions:
+                      expr: _col0
                       type: int
-                      expr: value
+                      expr: _col1
+                      type: string
+                sort order: ++
+                tag: -1
+                value expressions:
+                      expr: _col0
+                      type: int
+                      expr: _col1
                       type: string
-                outputColumnNames: _col0, _col1
-                Reduce Output Operator
-                  key expressions:
-                        expr: _col0
-                        type: int
-                        expr: _col1
-                        type: string
-                  sort order: ++
-                  tag: -1
-                  value expressions:
-                        expr: _col0
-                        type: int
-                        expr: _col1
-                        type: string
       Needs Tagging: false
       Path -> Alias:
         pfile:/data/users/tomasz/apache-hive/build/ql/test/data/warehouse/pcr_t1/ds=2000-04-08 [pcr_t1]
@@ -2334,37 +2289,32 @@ STAGE PLANS:
               predicate:
                   expr: (((ds = '2000-04-08') and (key = 1)) or ((ds = '2000-04-09') and (key = 2)))
                   type: boolean
-              Filter Operator
-                isSamplingPred: false
-                predicate:
-                    expr: (((ds = '2000-04-08') and (key = 1)) or ((ds = '2000-04-09') and (key = 2)))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: int
+                      expr: value
+                      type: string
+                      expr: ds
+                      type: string
+                outputColumnNames: _col0, _col1, _col2
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
                         type: int
-                        expr: value
+                        expr: _col1
                         type: string
-                        expr: ds
+                        expr: _col2
+                        type: string
+                  sort order: +++
+                  tag: -1
+                  value expressions:
+                        expr: _col0
+                        type: int
+                        expr: _col1
+                        type: string
+                        expr: _col2
                         type: string
-                  outputColumnNames: _col0, _col1, _col2
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: int
-                          expr: _col1
-                          type: string
-                          expr: _col2
-                          type: string
-                    sort order: +++
-                    tag: -1
-                    value expressions:
-                          expr: _col0
-                          type: int
-                          expr: _col1
-                          type: string
-                          expr: _col2
-                          type: string
       Needs Tagging: false
       Path -> Alias:
         pfile:/data/users/tomasz/apache-hive/build/ql/test/data/warehouse/pcr_t1/ds=2000-04-08 [pcr_t1]
@@ -2537,52 +2487,42 @@ STAGE PLANS:
           TableScan
             alias: t1
             GatherStats: false
-            Filter Operator
-              isSamplingPred: false
-              predicate:
-                  expr: (ds = '2000-04-08')
-                  type: boolean
-              Reduce Output Operator
-                key expressions:
-                      expr: key
-                      type: int
-                sort order: +
-                Map-reduce partition columns:
-                      expr: key
-                      type: int
-                tag: 0
-                value expressions:
-                      expr: key
-                      type: int
-                      expr: value
-                      type: string
-                      expr: ds
-                      type: string
+            Reduce Output Operator
+              key expressions:
+                    expr: key
+                    type: int
+              sort order: +
+              Map-reduce partition columns:
+                    expr: key
+                    type: int
+              tag: 0
+              value expressions:
+                    expr: key
+                    type: int
+                    expr: value
+                    type: string
+                    expr: ds
+                    type: string
         t2 
           TableScan
             alias: t2
             GatherStats: false
-            Filter Operator
-              isSamplingPred: false
-              predicate:
-                  expr: (ds = '2000-04-08')
-                  type: boolean
-              Reduce Output Operator
-                key expressions:
-                      expr: key
-                      type: int
-                sort order: +
-                Map-reduce partition columns:
-                      expr: key
-                      type: int
-                tag: 1
-                value expressions:
-                      expr: key
-                      type: int
-                      expr: value
-                      type: string
-                      expr: ds
-                      type: string
+            Reduce Output Operator
+              key expressions:
+                    expr: key
+                    type: int
+              sort order: +
+              Map-reduce partition columns:
+                    expr: key
+                    type: int
+              tag: 1
+              value expressions:
+                    expr: key
+                    type: int
+                    expr: value
+                    type: string
+                    expr: ds
+                    type: string
       Needs Tagging: true
       Path -> Alias:
         pfile:/data/users/tomasz/apache-hive/build/ql/test/data/warehouse/pcr_t1/ds=2000-04-08 [t2, t1]
@@ -2822,52 +2762,42 @@ STAGE PLANS:
           TableScan
             alias: t1
             GatherStats: false
-            Filter Operator
-              isSamplingPred: false
-              predicate:
-                  expr: (ds = '2000-04-08')
-                  type: boolean
-              Reduce Output Operator
-                key expressions:
-                      expr: key
-                      type: int
-                sort order: +
-                Map-reduce partition columns:
-                      expr: key
-                      type: int
-                tag: 0
-                value expressions:
-                      expr: key
-                      type: int
-                      expr: value
-                      type: string
-                      expr: ds
-                      type: string
+            Reduce Output Operator
+              key expressions:
+                    expr: key
+                    type: int
+              sort order: +
+              Map-reduce partition columns:
+                    expr: key
+                    type: int
+              tag: 0
+              value expressions:
+                    expr: key
+                    type: int
+                    expr: value
+                    type: string
+                    expr: ds
+                    type: string
         t2 
           TableScan
             alias: t2
             GatherStats: false
-            Filter Operator
-              isSamplingPred: false
-              predicate:
-                  expr: (ds = '2000-04-09')
-                  type: boolean
-              Reduce Output Operator
-                key expressions:
-                      expr: key
-                      type: int
-                sort order: +
-                Map-reduce partition columns:
-                      expr: key
-                      type: int
-                tag: 1
-                value expressions:
-                      expr: key
-                      type: int
-                      expr: value
-                      type: string
-                      expr: ds
-                      type: string
+            Reduce Output Operator
+              key expressions:
+                    expr: key
+                    type: int
+              sort order: +
+              Map-reduce partition columns:
+                    expr: key
+                    type: int
+              tag: 1
+              value expressions:
+                    expr: key
+                    type: int
+                    expr: value
+                    type: string
+                    expr: ds
+                    type: string
       Needs Tagging: true
       Path -> Alias:
         pfile:/data/users/tomasz/apache-hive/build/ql/test/data/warehouse/pcr_t1/ds=2000-04-08 [t1]
@@ -3182,37 +3112,32 @@ STAGE PLANS:
               predicate:
                   expr: (((ds > '2000-04-08') and (ds < '2000-04-11')) or (key = 2))
                   type: boolean
-              Filter Operator
-                isSamplingPred: false
-                predicate:
-                    expr: (((ds > '2000-04-08') and (ds < '2000-04-11')) or (((ds >= '2000-04-08') and (ds <= '2000-04-11')) and (key = 2)))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: int
+                      expr: value
+                      type: string
+                      expr: ds
+                      type: string
+                outputColumnNames: _col0, _col1, _col2
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: int
+                        expr: _col1
+                        type: string
+                        expr: _col2
+                        type: string
+                  sort order: +++
+                  tag: -1
+                  value expressions:
+                        expr: _col0
                         type: int
-                        expr: value
+                        expr: _col1
                         type: string
-                        expr: ds
+                        expr: _col2
                         type: string
-                  outputColumnNames: _col0, _col1, _col2
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: int
-                          expr: _col1
-                          type: string
-                          expr: _col2
-                          type: string
-                    sort order: +++
-                    tag: -1
-                    value expressions:
-                          expr: _col0
-                          type: int
-                          expr: _col1
-                          type: string
-                          expr: _col2
-                          type: string
       Needs Tagging: false
       Path -> Alias:
         pfile:/data/users/tomasz/apache-hive/build/ql/test/data/warehouse/pcr_t1/ds=2000-04-08 [pcr_t1]
@@ -3540,37 +3465,32 @@ STAGE PLANS:
               predicate:
                   expr: ((ds > '2000-04-08') or ((ds <= '2000-04-09') and (key = 2)))
                   type: boolean
-              Filter Operator
-                isSamplingPred: false
-                predicate:
-                    expr: (((ds > '2000-04-08') and (ds < '2000-04-11')) or ((ds <= '2000-04-09') and (key = 2)))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: int
+                      expr: value
+                      type: string
+                      expr: ds
+                      type: string
+                outputColumnNames: _col0, _col1, _col2
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: int
+                        expr: _col1
+                        type: string
+                        expr: _col2
+                        type: string
+                  sort order: +++
+                  tag: -1
+                  value expressions:
+                        expr: _col0
                         type: int
-                        expr: value
+                        expr: _col1
                         type: string
-                        expr: ds
+                        expr: _col2
                         type: string
-                  outputColumnNames: _col0, _col1, _col2
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: int
-                          expr: _col1
-                          type: string
-                          expr: _col2
-                          type: string
-                    sort order: +++
-                    tag: -1
-                    value expressions:
-                          expr: _col0
-                          type: int
-                          expr: _col1
-                          type: string
-                          expr: _col2
-                          type: string
       Needs Tagging: false
       Path -> Alias:
         pfile:/data/users/tomasz/apache-hive/build/ql/test/data/warehouse/pcr_t1/ds=2000-04-08 [pcr_t1]
@@ -4753,29 +4673,24 @@ STAGE PLANS:
           TableScan
             alias: srcpart
             GatherStats: false
-            Filter Operator
-              isSamplingPred: false
-              predicate:
-                  expr: ((ds = '2008-04-08') and (hr = 11))
-                  type: boolean
-              Select Operator
-                expressions:
-                      expr: key
+            Select Operator
+              expressions:
+                    expr: key
+                    type: string
+                    expr: value
+                    type: string
+              outputColumnNames: _col0, _col1
+              Reduce Output Operator
+                key expressions:
+                      expr: _col0
                       type: string
-                      expr: value
+                sort order: +
+                tag: -1
+                value expressions:
+                      expr: _col0
+                      type: string
+                      expr: _col1
                       type: string
-                outputColumnNames: _col0, _col1
-                Reduce Output Operator
-                  key expressions:
-                        expr: _col0
-                        type: string
-                  sort order: +
-                  tag: -1
-                  value expressions:
-                        expr: _col0
-                        type: string
-                        expr: _col1
-                        type: string
       Needs Tagging: false
       Path -> Alias:
         pfile:/data/users/tomasz/apache-hive/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 [srcpart]
@@ -4908,41 +4823,36 @@ STAGE PLANS:
               predicate:
                   expr: (key = 11)
                   type: boolean
-              Filter Operator
-                isSamplingPred: false
-                predicate:
-                    expr: (((ds = '2008-04-08') and ((hr = '11') or (hr = '12'))) and (key = 11))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                      expr: ds
+                      type: string
+                      expr: hr
+                      type: string
+                outputColumnNames: _col0, _col1, _col2, _col3
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col2
+                        type: string
+                        expr: _col3
+                        type: string
+                  sort order: +++
+                  tag: -1
+                  value expressions:
+                        expr: _col0
                         type: string
-                        expr: value
+                        expr: _col1
                         type: string
-                        expr: ds
+                        expr: _col2
                         type: string
-                        expr: hr
+                        expr: _col3
                         type: string
-                  outputColumnNames: _col0, _col1, _col2, _col3
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col2
-                          type: string
-                          expr: _col3
-                          type: string
-                    sort order: +++
-                    tag: -1
-                    value expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
-                          expr: _col2
-                          type: string
-                          expr: _col3
-                          type: string
       Needs Tagging: false
       Path -> Alias:
         pfile:/data/users/tomasz/apache-hive/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 [srcpart]
@@ -5122,41 +5032,36 @@ STAGE PLANS:
               predicate:
                   expr: (key = 11)
                   type: boolean
-              Filter Operator
-                isSamplingPred: false
-                predicate:
-                    expr: ((hr = '11') and (key = 11))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                      expr: ds
+                      type: string
+                      expr: hr
+                      type: string
+                outputColumnNames: _col0, _col1, _col2, _col3
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col2
                         type: string
-                        expr: value
+                        expr: _col3
+                        type: string
+                  sort order: +++
+                  tag: -1
+                  value expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col1
                         type: string
-                        expr: ds
+                        expr: _col2
                         type: string
-                        expr: hr
+                        expr: _col3
                         type: string
-                  outputColumnNames: _col0, _col1, _col2, _col3
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col2
-                          type: string
-                          expr: _col3
-                          type: string
-                    sort order: +++
-                    tag: -1
-                    value expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
-                          expr: _col2
-                          type: string
-                          expr: _col3
-                          type: string
       Needs Tagging: false
       Path -> Alias:
         pfile:/data/users/tomasz/apache-hive/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 [srcpart]
diff --git a/ql/src/test/results/clientpositive/ppd1.q.out b/ql/src/test/results/clientpositive/ppd1.q.out
index cd4985d1cb..1992f0a840 100644
--- a/ql/src/test/results/clientpositive/ppd1.q.out
+++ b/ql/src/test/results/clientpositive/ppd1.q.out
@@ -46,11 +46,441 @@ STAGE PLANS:
 PREHOOK: query: SELECT src.key as c3 from src where src.key > '2'
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
-PREHOOK: Output: file:/tmp/sdong/hive_2011-02-10_16-56-18_823_4035711180151393629/-mr-10000
+PREHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_01-46-31_378_5424397768218246092/-mr-10000
 POSTHOOK: query: SELECT src.key as c3 from src where src.key > '2'
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
-POSTHOOK: Output: file:/tmp/sdong/hive_2011-02-10_16-56-18_823_4035711180151393629/-mr-10000
+POSTHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_01-46-31_378_5424397768218246092/-mr-10000
+238
+86
+311
+27
+409
+255
+278
+98
+484
+265
+401
+273
+224
+369
+66
+213
+406
+429
+374
+469
+495
+37
+327
+281
+277
+209
+82
+403
+417
+430
+252
+292
+219
+287
+338
+446
+459
+394
+237
+482
+413
+494
+207
+466
+208
+399
+396
+247
+417
+489
+377
+397
+309
+365
+266
+439
+342
+367
+325
+475
+203
+339
+455
+311
+316
+57
+302
+205
+438
+345
+20
+489
+378
+221
+92
+47
+72
+4
+280
+35
+427
+277
+208
+356
+399
+382
+498
+386
+437
+469
+286
+54
+459
+51
+239
+213
+216
+430
+278
+289
+221
+65
+318
+332
+311
+275
+241
+83
+333
+284
+230
+67
+260
+404
+384
+489
+353
+373
+272
+217
+84
+348
+466
+58
+8
+411
+230
+208
+348
+24
+463
+431
+42
+496
+322
+468
+393
+454
+298
+418
+96
+26
+327
+230
+205
+51
+404
+43
+436
+469
+468
+308
+95
+288
+481
+457
+98
+282
+318
+318
+409
+470
+369
+316
+413
+85
+77
+490
+87
+364
+395
+282
+238
+419
+72
+90
+307
+435
+277
+273
+306
+224
+309
+389
+327
+242
+369
+392
+272
+331
+401
+242
+452
+226
+5
+497
+402
+396
+317
+395
+58
+35
+336
+95
+34
+229
+233
+472
+322
+498
+42
+321
+430
+489
+458
+78
+76
+41
+223
+492
+449
+218
+228
+453
+30
+209
+64
+468
+76
+74
+342
+69
+230
+33
+368
+296
+216
+367
+344
+274
+219
+239
+485
+223
+256
+263
+70
+487
+480
+401
+288
+5
+244
+438
+467
+432
+202
+316
+229
+469
+463
+280
+35
+283
+331
+235
+80
+44
+321
+335
+466
+366
+403
+483
+53
+257
+406
+409
+406
+401
+258
+90
+203
+262
+348
+424
+396
+201
+217
+431
+454
+478
+298
+431
+424
+382
+5
+70
+397
+480
+291
+24
+351
+255
+70
+438
+414
+200
+491
+237
+439
+360
+248
+479
+305
+417
+444
+429
+443
+323
+325
+277
+230
+478
+468
+310
+317
+333
+493
+460
+207
+249
+265
+480
+83
+353
+214
+462
+233
+406
+454
+375
+401
+421
+407
+384
+256
+26
+67
+384
+379
+462
+492
+298
+9
+341
+498
+458
+362
+285
+348
+273
+281
+344
+97
+469
+315
+84
+28
+37
+448
+348
+307
+414
+477
+222
+90
+403
+400
+200
+97
+PREHOOK: query: EXPLAIN
+SELECT src.key as c3 from src where src.key > '2'
+PREHOOK: type: QUERY
+POSTHOOK: query: EXPLAIN
+SELECT src.key as c3 from src where src.key > '2'
+POSTHOOK: type: QUERY
+ABSTRACT SYNTAX TREE:
+  (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME src))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL src) key) c3)) (TOK_WHERE (> (. (TOK_TABLE_OR_COL src) key) '2'))))
+
+STAGE DEPENDENCIES:
+  Stage-1 is a root stage
+  Stage-0 is a root stage
+
+STAGE PLANS:
+  Stage: Stage-1
+    Map Reduce
+      Alias -> Map Operator Tree:
+        src 
+          TableScan
+            alias: src
+            Filter Operator
+              predicate:
+                  expr: (key > '2')
+                  type: boolean
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                outputColumnNames: _col0
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 0
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+
+  Stage: Stage-0
+    Fetch Operator
+      limit: -1
+
+
+PREHOOK: query: SELECT src.key as c3 from src where src.key > '2'
+PREHOOK: type: QUERY
+PREHOOK: Input: default@src
+PREHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_01-46-40_411_5342026921630284187/-mr-10000
+POSTHOOK: query: SELECT src.key as c3 from src where src.key > '2'
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@src
+POSTHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_01-46-40_411_5342026921630284187/-mr-10000
 238
 86
 311
diff --git a/ql/src/test/results/clientpositive/ppd_clusterby.q.out b/ql/src/test/results/clientpositive/ppd_clusterby.q.out
index 7a9cd63895..fb68f20549 100644
--- a/ql/src/test/results/clientpositive/ppd_clusterby.q.out
+++ b/ql/src/test/results/clientpositive/ppd_clusterby.q.out
@@ -194,5 +194,195 @@ PREHOOK: Output: file:/tmp/sdong/hive_2011-02-10_16-56-25_950_457722549612687908
 POSTHOOK: query: SELECT x.key, x.value as v1, y.key  FROM SRC x JOIN SRC y ON (x.key = y.key) where x.key = 20 CLUSTER BY v1
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
-POSTHOOK: Output: file:/tmp/sdong/hive_2011-02-10_16-56-25_950_4577225496126879083/-mr-10000
+POSTHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-06-51_471_1696629323983265212/-mr-10000
+20	val_20	20
+PREHOOK: query: EXPLAIN
+SELECT * FROM SRC x where x.key = 10 CLUSTER BY x.key
+PREHOOK: type: QUERY
+POSTHOOK: query: EXPLAIN
+SELECT * FROM SRC x where x.key = 10 CLUSTER BY x.key
+POSTHOOK: type: QUERY
+ABSTRACT SYNTAX TREE:
+  (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME SRC) x)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR TOK_ALLCOLREF)) (TOK_WHERE (= (. (TOK_TABLE_OR_COL x) key) 10)) (TOK_CLUSTERBY (. (TOK_TABLE_OR_COL x) key))))
+
+STAGE DEPENDENCIES:
+  Stage-1 is a root stage
+  Stage-0 is a root stage
+
+STAGE PLANS:
+  Stage: Stage-1
+    Map Reduce
+      Alias -> Map Operator Tree:
+        x 
+          TableScan
+            alias: x
+            Filter Operator
+              predicate:
+                  expr: (key = 10)
+                  type: boolean
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: -1
+                  value expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col1
+                        type: string
+      Reduce Operator Tree:
+        Extract
+          File Output Operator
+            compressed: false
+            GlobalTableId: 0
+            table:
+                input format: org.apache.hadoop.mapred.TextInputFormat
+                output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+
+  Stage: Stage-0
+    Fetch Operator
+      limit: -1
+
+
+PREHOOK: query: SELECT * FROM SRC x where x.key = 10 CLUSTER BY x.key
+PREHOOK: type: QUERY
+PREHOOK: Input: default@src
+PREHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-07-07_755_9086280220307924310/-mr-10000
+POSTHOOK: query: SELECT * FROM SRC x where x.key = 10 CLUSTER BY x.key
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@src
+POSTHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-07-07_755_9086280220307924310/-mr-10000
+10	val_10
+PREHOOK: query: EXPLAIN 
+SELECT x.key, x.value as v1, y.key  FROM SRC x JOIN SRC y ON (x.key = y.key)  where x.key = 20 CLUSTER BY v1
+PREHOOK: type: QUERY
+POSTHOOK: query: EXPLAIN 
+SELECT x.key, x.value as v1, y.key  FROM SRC x JOIN SRC y ON (x.key = y.key)  where x.key = 20 CLUSTER BY v1
+POSTHOOK: type: QUERY
+ABSTRACT SYNTAX TREE:
+  (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_TABREF (TOK_TABNAME SRC) x) (TOK_TABREF (TOK_TABNAME SRC) y) (= (. (TOK_TABLE_OR_COL x) key) (. (TOK_TABLE_OR_COL y) key)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL x) key)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL x) value) v1) (TOK_SELEXPR (. (TOK_TABLE_OR_COL y) key))) (TOK_WHERE (= (. (TOK_TABLE_OR_COL x) key) 20)) (TOK_CLUSTERBY (TOK_TABLE_OR_COL v1))))
+
+STAGE DEPENDENCIES:
+  Stage-1 is a root stage
+  Stage-2 depends on stages: Stage-1
+  Stage-0 is a root stage
+
+STAGE PLANS:
+  Stage: Stage-1
+    Map Reduce
+      Alias -> Map Operator Tree:
+        x 
+          TableScan
+            alias: x
+            Filter Operator
+              predicate:
+                  expr: (key = 20)
+                  type: boolean
+              Reduce Output Operator
+                key expressions:
+                      expr: key
+                      type: string
+                sort order: +
+                Map-reduce partition columns:
+                      expr: key
+                      type: string
+                tag: 0
+                value expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+        y 
+          TableScan
+            alias: y
+            Reduce Output Operator
+              key expressions:
+                    expr: key
+                    type: string
+              sort order: +
+              Map-reduce partition columns:
+                    expr: key
+                    type: string
+              tag: 1
+              value expressions:
+                    expr: key
+                    type: string
+      Reduce Operator Tree:
+        Join Operator
+          condition map:
+               Inner Join 0 to 1
+          condition expressions:
+            0 {VALUE._col0} {VALUE._col1}
+            1 {VALUE._col0}
+          handleSkewJoin: false
+          outputColumnNames: _col0, _col1, _col4
+          Select Operator
+            expressions:
+                  expr: _col0
+                  type: string
+                  expr: _col1
+                  type: string
+                  expr: _col4
+                  type: string
+            outputColumnNames: _col0, _col1, _col2
+            File Output Operator
+              compressed: false
+              GlobalTableId: 0
+              table:
+                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+
+  Stage: Stage-2
+    Map Reduce
+      Alias -> Map Operator Tree:
+        file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-07-16_261_4934200005006221322/-mr-10002 
+            Reduce Output Operator
+              key expressions:
+                    expr: _col1
+                    type: string
+              sort order: +
+              Map-reduce partition columns:
+                    expr: _col1
+                    type: string
+              tag: -1
+              value expressions:
+                    expr: _col0
+                    type: string
+                    expr: _col1
+                    type: string
+                    expr: _col2
+                    type: string
+      Reduce Operator Tree:
+        Extract
+          File Output Operator
+            compressed: false
+            GlobalTableId: 0
+            table:
+                input format: org.apache.hadoop.mapred.TextInputFormat
+                output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+
+  Stage: Stage-0
+    Fetch Operator
+      limit: -1
+
+
+PREHOOK: query: SELECT x.key, x.value as v1, y.key  FROM SRC x JOIN SRC y ON (x.key = y.key) where x.key = 20 CLUSTER BY v1
+PREHOOK: type: QUERY
+PREHOOK: Input: default@src
+PREHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-07-16_525_2344085515974635436/-mr-10000
+POSTHOOK: query: SELECT x.key, x.value as v1, y.key  FROM SRC x JOIN SRC y ON (x.key = y.key) where x.key = 20 CLUSTER BY v1
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@src
+POSTHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-07-16_525_2344085515974635436/-mr-10000
 20	val_20	20
diff --git a/ql/src/test/results/clientpositive/ppd_constant_expr.q.out b/ql/src/test/results/clientpositive/ppd_constant_expr.q.out
index 6a5561be35..0364be5be8 100644
--- a/ql/src/test/results/clientpositive/ppd_constant_expr.q.out
+++ b/ql/src/test/results/clientpositive/ppd_constant_expr.q.out
@@ -112,7 +112,7 @@ PREHOOK: Output: file:/tmp/sdong/hive_2011-02-10_16-56-37_539_487703800968787792
 POSTHOOK: query: SELECT ppd_constant_expr.* FROM ppd_constant_expr
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@ppd_constant_expr
-POSTHOOK: Output: file:/tmp/sdong/hive_2011-02-10_16-56-37_539_4877038009687877928/-mr-10000
+POSTHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_03-08-49_562_6227549501988296305/-mr-10000
 POSTHOOK: Lineage: ppd_constant_expr.c1 EXPRESSION []
 POSTHOOK: Lineage: ppd_constant_expr.c2 EXPRESSION [(src1)src1.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: ppd_constant_expr.c3 EXPRESSION []
@@ -141,3 +141,150 @@ NULL	NULL	NULL
 NULL	NULL	NULL
 NULL	NULL	NULL
 NULL	NULL	NULL
+PREHOOK: query: EXPLAIN
+FROM src1 
+INSERT OVERWRITE TABLE ppd_constant_expr SELECT 4 + NULL, src1.key - NULL, NULL + NULL
+PREHOOK: type: QUERY
+POSTHOOK: query: EXPLAIN
+FROM src1 
+INSERT OVERWRITE TABLE ppd_constant_expr SELECT 4 + NULL, src1.key - NULL, NULL + NULL
+POSTHOOK: type: QUERY
+POSTHOOK: Lineage: ppd_constant_expr.c1 EXPRESSION []
+POSTHOOK: Lineage: ppd_constant_expr.c2 EXPRESSION [(src1)src1.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: ppd_constant_expr.c3 EXPRESSION []
+ABSTRACT SYNTAX TREE:
+  (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME src1))) (TOK_INSERT (TOK_DESTINATION (TOK_TAB (TOK_TABNAME ppd_constant_expr))) (TOK_SELECT (TOK_SELEXPR (+ 4 TOK_NULL)) (TOK_SELEXPR (- (. (TOK_TABLE_OR_COL src1) key) TOK_NULL)) (TOK_SELEXPR (+ TOK_NULL TOK_NULL)))))
+
+STAGE DEPENDENCIES:
+  Stage-1 is a root stage
+  Stage-5 depends on stages: Stage-1 , consists of Stage-4, Stage-3
+  Stage-4
+  Stage-0 depends on stages: Stage-4, Stage-3
+  Stage-2 depends on stages: Stage-0
+  Stage-3
+
+STAGE PLANS:
+  Stage: Stage-1
+    Map Reduce
+      Alias -> Map Operator Tree:
+        src1 
+          TableScan
+            alias: src1
+            Select Operator
+              expressions:
+                    expr: (4 + null)
+                    type: int
+                    expr: (key - null)
+                    type: double
+                    expr: (null + null)
+                    type: tinyint
+              outputColumnNames: _col0, _col1, _col2
+              Select Operator
+                expressions:
+                      expr: _col0
+                      type: int
+                      expr: UDFToInteger(_col1)
+                      type: int
+                      expr: UDFToDouble(_col2)
+                      type: double
+                outputColumnNames: _col0, _col1, _col2
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 1
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                      name: default.ppd_constant_expr
+
+  Stage: Stage-5
+    Conditional Operator
+
+  Stage: Stage-4
+    Move Operator
+      files:
+          hdfs directory: true
+          destination: pfile:/Users/amarsri/Documents/workspace/hive/build/ql/scratchdir/hive_2011-03-22_03-08-50_015_6932944037979128451/-ext-10000
+
+  Stage: Stage-0
+    Move Operator
+      tables:
+          replace: true
+          table:
+              input format: org.apache.hadoop.mapred.TextInputFormat
+              output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+              serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+              name: default.ppd_constant_expr
+
+  Stage: Stage-2
+    Stats-Aggr Operator
+
+  Stage: Stage-3
+    Map Reduce
+      Alias -> Map Operator Tree:
+        pfile:/Users/amarsri/Documents/workspace/hive/build/ql/scratchdir/hive_2011-03-22_03-08-50_015_6932944037979128451/-ext-10002 
+            File Output Operator
+              compressed: false
+              GlobalTableId: 0
+              table:
+                  input format: org.apache.hadoop.mapred.TextInputFormat
+                  output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                  name: default.ppd_constant_expr
+
+
+PREHOOK: query: FROM src1 
+INSERT OVERWRITE TABLE ppd_constant_expr SELECT 4 + NULL, src1.key - NULL, NULL + NULL
+PREHOOK: type: QUERY
+PREHOOK: Input: default@src1
+PREHOOK: Output: default@ppd_constant_expr
+POSTHOOK: query: FROM src1 
+INSERT OVERWRITE TABLE ppd_constant_expr SELECT 4 + NULL, src1.key - NULL, NULL + NULL
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@src1
+POSTHOOK: Output: default@ppd_constant_expr
+POSTHOOK: Lineage: ppd_constant_expr.c1 EXPRESSION []
+POSTHOOK: Lineage: ppd_constant_expr.c1 EXPRESSION []
+POSTHOOK: Lineage: ppd_constant_expr.c2 EXPRESSION [(src1)src1.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: ppd_constant_expr.c2 EXPRESSION [(src1)src1.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: ppd_constant_expr.c3 EXPRESSION []
+POSTHOOK: Lineage: ppd_constant_expr.c3 EXPRESSION []
+PREHOOK: query: SELECT ppd_constant_expr.* FROM ppd_constant_expr
+PREHOOK: type: QUERY
+PREHOOK: Input: default@ppd_constant_expr
+PREHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_03-08-58_708_3073565512234424163/-mr-10000
+POSTHOOK: query: SELECT ppd_constant_expr.* FROM ppd_constant_expr
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@ppd_constant_expr
+POSTHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_03-08-58_708_3073565512234424163/-mr-10000
+POSTHOOK: Lineage: ppd_constant_expr.c1 EXPRESSION []
+POSTHOOK: Lineage: ppd_constant_expr.c1 EXPRESSION []
+POSTHOOK: Lineage: ppd_constant_expr.c2 EXPRESSION [(src1)src1.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: ppd_constant_expr.c2 EXPRESSION [(src1)src1.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: ppd_constant_expr.c3 EXPRESSION []
+POSTHOOK: Lineage: ppd_constant_expr.c3 EXPRESSION []
+NULL	NULL	NULL
+NULL	NULL	NULL
+NULL	NULL	NULL
+NULL	NULL	NULL
+NULL	NULL	NULL
+NULL	NULL	NULL
+NULL	NULL	NULL
+NULL	NULL	NULL
+NULL	NULL	NULL
+NULL	NULL	NULL
+NULL	NULL	NULL
+NULL	NULL	NULL
+NULL	NULL	NULL
+NULL	NULL	NULL
+NULL	NULL	NULL
+NULL	NULL	NULL
+NULL	NULL	NULL
+NULL	NULL	NULL
+NULL	NULL	NULL
+NULL	NULL	NULL
+NULL	NULL	NULL
+NULL	NULL	NULL
+NULL	NULL	NULL
+NULL	NULL	NULL
+NULL	NULL	NULL
diff --git a/ql/src/test/results/clientpositive/ppd_gby.q.out b/ql/src/test/results/clientpositive/ppd_gby.q.out
index cb95c53586..304d8fda76 100644
--- a/ql/src/test/results/clientpositive/ppd_gby.q.out
+++ b/ql/src/test/results/clientpositive/ppd_gby.q.out
@@ -104,14 +104,253 @@ FROM
 WHERE src1.c1 > 'val_200' and (src1.c2 > 30 or src1.c1 < 'val_400')
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
-PREHOOK: Output: file:/tmp/sdong/hive_2011-02-10_16-56-38_112_8267432549996239027/-mr-10000
+PREHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-12-18_104_5370641899416935796/-mr-10000
 POSTHOOK: query: SELECT src1.c1 
 FROM
 (SELECT src.value as c1, count(src.key) as c2 from src where src.value > 'val_10' group by src.value) src1
 WHERE src1.c1 > 'val_200' and (src1.c2 > 30 or src1.c1 < 'val_400')
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
-POSTHOOK: Output: file:/tmp/sdong/hive_2011-02-10_16-56-38_112_8267432549996239027/-mr-10000
+POSTHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-12-18_104_5370641899416935796/-mr-10000
+val_201
+val_202
+val_203
+val_205
+val_207
+val_208
+val_209
+val_213
+val_214
+val_216
+val_217
+val_218
+val_219
+val_221
+val_222
+val_223
+val_224
+val_226
+val_228
+val_229
+val_230
+val_233
+val_235
+val_237
+val_238
+val_239
+val_24
+val_241
+val_242
+val_244
+val_247
+val_248
+val_249
+val_252
+val_255
+val_256
+val_257
+val_258
+val_26
+val_260
+val_262
+val_263
+val_265
+val_266
+val_27
+val_272
+val_273
+val_274
+val_275
+val_277
+val_278
+val_28
+val_280
+val_281
+val_282
+val_283
+val_284
+val_285
+val_286
+val_287
+val_288
+val_289
+val_291
+val_292
+val_296
+val_298
+val_30
+val_302
+val_305
+val_306
+val_307
+val_308
+val_309
+val_310
+val_311
+val_315
+val_316
+val_317
+val_318
+val_321
+val_322
+val_323
+val_325
+val_327
+val_33
+val_331
+val_332
+val_333
+val_335
+val_336
+val_338
+val_339
+val_34
+val_341
+val_342
+val_344
+val_345
+val_348
+val_35
+val_351
+val_353
+val_356
+val_360
+val_362
+val_364
+val_365
+val_366
+val_367
+val_368
+val_369
+val_37
+val_373
+val_374
+val_375
+val_377
+val_378
+val_379
+val_382
+val_384
+val_386
+val_389
+val_392
+val_393
+val_394
+val_395
+val_396
+val_397
+val_399
+val_4
+PREHOOK: query: EXPLAIN
+SELECT src1.c1 
+FROM
+(SELECT src.value as c1, count(src.key) as c2 from src where src.value > 'val_10' group by src.value) src1
+WHERE src1.c1 > 'val_200' and (src1.c2 > 30 or src1.c1 < 'val_400')
+PREHOOK: type: QUERY
+POSTHOOK: query: EXPLAIN
+SELECT src1.c1 
+FROM
+(SELECT src.value as c1, count(src.key) as c2 from src where src.value > 'val_10' group by src.value) src1
+WHERE src1.c1 > 'val_200' and (src1.c2 > 30 or src1.c1 < 'val_400')
+POSTHOOK: type: QUERY
+ABSTRACT SYNTAX TREE:
+  (TOK_QUERY (TOK_FROM (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME src))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL src) value) c1) (TOK_SELEXPR (TOK_FUNCTION count (. (TOK_TABLE_OR_COL src) key)) c2)) (TOK_WHERE (> (. (TOK_TABLE_OR_COL src) value) 'val_10')) (TOK_GROUPBY (. (TOK_TABLE_OR_COL src) value)))) src1)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL src1) c1))) (TOK_WHERE (and (> (. (TOK_TABLE_OR_COL src1) c1) 'val_200') (or (> (. (TOK_TABLE_OR_COL src1) c2) 30) (< (. (TOK_TABLE_OR_COL src1) c1) 'val_400'))))))
+
+STAGE DEPENDENCIES:
+  Stage-1 is a root stage
+  Stage-0 is a root stage
+
+STAGE PLANS:
+  Stage: Stage-1
+    Map Reduce
+      Alias -> Map Operator Tree:
+        src1:src 
+          TableScan
+            alias: src
+            Filter Operator
+              predicate:
+                  expr: ((value > 'val_10') and (value > 'val_200'))
+                  type: boolean
+              Select Operator
+                expressions:
+                      expr: value
+                      type: string
+                      expr: key
+                      type: string
+                outputColumnNames: value, key
+                Group By Operator
+                  aggregations:
+                        expr: count(key)
+                  bucketGroup: false
+                  keys:
+                        expr: value
+                        type: string
+                  mode: hash
+                  outputColumnNames: _col0, _col1
+                  Reduce Output Operator
+                    key expressions:
+                          expr: _col0
+                          type: string
+                    sort order: +
+                    Map-reduce partition columns:
+                          expr: _col0
+                          type: string
+                    tag: -1
+                    value expressions:
+                          expr: _col1
+                          type: bigint
+      Reduce Operator Tree:
+        Group By Operator
+          aggregations:
+                expr: count(VALUE._col0)
+          bucketGroup: false
+          keys:
+                expr: KEY._col0
+                type: string
+          mode: mergepartial
+          outputColumnNames: _col0, _col1
+          Filter Operator
+            predicate:
+                expr: ((_col0 > 'val_200') and ((_col1 > 30) or (_col0 < 'val_400')))
+                type: boolean
+            Select Operator
+              expressions:
+                    expr: _col0
+                    type: string
+                    expr: _col1
+                    type: bigint
+              outputColumnNames: _col0, _col1
+              Select Operator
+                expressions:
+                      expr: _col0
+                      type: string
+                outputColumnNames: _col0
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 0
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+
+  Stage: Stage-0
+    Fetch Operator
+      limit: -1
+
+
+PREHOOK: query: SELECT src1.c1 
+FROM
+(SELECT src.value as c1, count(src.key) as c2 from src where src.value > 'val_10' group by src.value) src1
+WHERE src1.c1 > 'val_200' and (src1.c2 > 30 or src1.c1 < 'val_400')
+PREHOOK: type: QUERY
+PREHOOK: Input: default@src
+PREHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-12-29_361_5339487985983121248/-mr-10000
+POSTHOOK: query: SELECT src1.c1 
+FROM
+(SELECT src.value as c1, count(src.key) as c2 from src where src.value > 'val_10' group by src.value) src1
+WHERE src1.c1 > 'val_200' and (src1.c2 > 30 or src1.c1 < 'val_400')
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@src
+POSTHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-12-29_361_5339487985983121248/-mr-10000
 val_201
 val_202
 val_203
diff --git a/ql/src/test/results/clientpositive/ppd_gby2.q.out b/ql/src/test/results/clientpositive/ppd_gby2.q.out
index aa2a4601fc..e7485cd577 100644
--- a/ql/src/test/results/clientpositive/ppd_gby2.q.out
+++ b/ql/src/test/results/clientpositive/ppd_gby2.q.out
@@ -110,7 +110,7 @@ STAGE PLANS:
   Stage: Stage-2
     Map Reduce
       Alias -> Map Operator Tree:
-        file:/tmp/sdong/hive_2011-02-10_16-56-41_891_721328983378577073/-mr-10002 
+        file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-17-03_240_3343733212968194961/-mr-10002 
             Reduce Output Operator
               key expressions:
                     expr: _col0
@@ -159,7 +159,7 @@ WHERE src1.c1 > 'val_200' AND (src1.c2 > 30 OR src1.c1 < 'val_400')
 GROUP BY src1.c2
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
-PREHOOK: Output: file:/tmp/sdong/hive_2011-02-10_16-56-41_988_2096999785618851738/-mr-10000
+PREHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-17-04_077_883376489676525041/-mr-10000
 POSTHOOK: query: SELECT max(src1.c1), src1.c2 
 FROM
 (SELECT src.value AS c1, count(src.key) AS c2 FROM src WHERE src.value > 'val_10' GROUP BY src.value) src1
@@ -167,7 +167,178 @@ WHERE src1.c1 > 'val_200' AND (src1.c2 > 30 OR src1.c1 < 'val_400')
 GROUP BY src1.c2
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
-POSTHOOK: Output: file:/tmp/sdong/hive_2011-02-10_16-56-41_988_2096999785618851738/-mr-10000
+POSTHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-17-04_077_883376489676525041/-mr-10000
+val_4	1
+val_399	2
+val_396	3
+val_277	4
+val_348	5
+PREHOOK: query: EXPLAIN
+SELECT max(src1.c1), src1.c2 
+FROM
+(SELECT src.value AS c1, count(src.key) AS c2 FROM src WHERE src.value > 'val_10' GROUP BY src.value) src1
+WHERE src1.c1 > 'val_200' AND (src1.c2 > 30 OR src1.c1 < 'val_400')
+GROUP BY src1.c2
+PREHOOK: type: QUERY
+POSTHOOK: query: EXPLAIN
+SELECT max(src1.c1), src1.c2 
+FROM
+(SELECT src.value AS c1, count(src.key) AS c2 FROM src WHERE src.value > 'val_10' GROUP BY src.value) src1
+WHERE src1.c1 > 'val_200' AND (src1.c2 > 30 OR src1.c1 < 'val_400')
+GROUP BY src1.c2
+POSTHOOK: type: QUERY
+ABSTRACT SYNTAX TREE:
+  (TOK_QUERY (TOK_FROM (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME src))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL src) value) c1) (TOK_SELEXPR (TOK_FUNCTION count (. (TOK_TABLE_OR_COL src) key)) c2)) (TOK_WHERE (> (. (TOK_TABLE_OR_COL src) value) 'val_10')) (TOK_GROUPBY (. (TOK_TABLE_OR_COL src) value)))) src1)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_FUNCTION max (. (TOK_TABLE_OR_COL src1) c1))) (TOK_SELEXPR (. (TOK_TABLE_OR_COL src1) c2))) (TOK_WHERE (AND (> (. (TOK_TABLE_OR_COL src1) c1) 'val_200') (OR (> (. (TOK_TABLE_OR_COL src1) c2) 30) (< (. (TOK_TABLE_OR_COL src1) c1) 'val_400')))) (TOK_GROUPBY (. (TOK_TABLE_OR_COL src1) c2))))
+
+STAGE DEPENDENCIES:
+  Stage-1 is a root stage
+  Stage-2 depends on stages: Stage-1
+  Stage-0 is a root stage
+
+STAGE PLANS:
+  Stage: Stage-1
+    Map Reduce
+      Alias -> Map Operator Tree:
+        src1:src 
+          TableScan
+            alias: src
+            Filter Operator
+              predicate:
+                  expr: ((value > 'val_10') and (value > 'val_200'))
+                  type: boolean
+              Select Operator
+                expressions:
+                      expr: value
+                      type: string
+                      expr: key
+                      type: string
+                outputColumnNames: value, key
+                Group By Operator
+                  aggregations:
+                        expr: count(key)
+                  bucketGroup: false
+                  keys:
+                        expr: value
+                        type: string
+                  mode: hash
+                  outputColumnNames: _col0, _col1
+                  Reduce Output Operator
+                    key expressions:
+                          expr: _col0
+                          type: string
+                    sort order: +
+                    Map-reduce partition columns:
+                          expr: _col0
+                          type: string
+                    tag: -1
+                    value expressions:
+                          expr: _col1
+                          type: bigint
+      Reduce Operator Tree:
+        Group By Operator
+          aggregations:
+                expr: count(VALUE._col0)
+          bucketGroup: false
+          keys:
+                expr: KEY._col0
+                type: string
+          mode: mergepartial
+          outputColumnNames: _col0, _col1
+          Filter Operator
+            predicate:
+                expr: ((_col0 > 'val_200') and ((_col1 > 30) or (_col0 < 'val_400')))
+                type: boolean
+            Select Operator
+              expressions:
+                    expr: _col0
+                    type: string
+                    expr: _col1
+                    type: bigint
+              outputColumnNames: _col0, _col1
+              Select Operator
+                expressions:
+                      expr: _col0
+                      type: string
+                      expr: _col1
+                      type: bigint
+                outputColumnNames: _col0, _col1
+                Group By Operator
+                  aggregations:
+                        expr: max(_col0)
+                  bucketGroup: false
+                  keys:
+                        expr: _col1
+                        type: bigint
+                  mode: hash
+                  outputColumnNames: _col0, _col1
+                  File Output Operator
+                    compressed: false
+                    GlobalTableId: 0
+                    table:
+                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+
+  Stage: Stage-2
+    Map Reduce
+      Alias -> Map Operator Tree:
+        file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-17-23_094_9196364983578023762/-mr-10002 
+            Reduce Output Operator
+              key expressions:
+                    expr: _col0
+                    type: bigint
+              sort order: +
+              Map-reduce partition columns:
+                    expr: _col0
+                    type: bigint
+              tag: -1
+              value expressions:
+                    expr: _col1
+                    type: string
+      Reduce Operator Tree:
+        Group By Operator
+          aggregations:
+                expr: max(VALUE._col0)
+          bucketGroup: false
+          keys:
+                expr: KEY._col0
+                type: bigint
+          mode: mergepartial
+          outputColumnNames: _col0, _col1
+          Select Operator
+            expressions:
+                  expr: _col1
+                  type: string
+                  expr: _col0
+                  type: bigint
+            outputColumnNames: _col0, _col1
+            File Output Operator
+              compressed: false
+              GlobalTableId: 0
+              table:
+                  input format: org.apache.hadoop.mapred.TextInputFormat
+                  output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+
+  Stage: Stage-0
+    Fetch Operator
+      limit: -1
+
+
+PREHOOK: query: SELECT max(src1.c1), src1.c2 
+FROM
+(SELECT src.value AS c1, count(src.key) AS c2 FROM src WHERE src.value > 'val_10' GROUP BY src.value) src1
+WHERE src1.c1 > 'val_200' AND (src1.c2 > 30 OR src1.c1 < 'val_400')
+GROUP BY src1.c2
+PREHOOK: type: QUERY
+PREHOOK: Input: default@src
+PREHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-17-23_367_2772975119752922926/-mr-10000
+POSTHOOK: query: SELECT max(src1.c1), src1.c2 
+FROM
+(SELECT src.value AS c1, count(src.key) AS c2 FROM src WHERE src.value > 'val_10' GROUP BY src.value) src1
+WHERE src1.c1 > 'val_200' AND (src1.c2 > 30 OR src1.c1 < 'val_400')
+GROUP BY src1.c2
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@src
+POSTHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-17-23_367_2772975119752922926/-mr-10000
 val_4	1
 val_399	2
 val_396	3
diff --git a/ql/src/test/results/clientpositive/ppd_gby_join.q.out b/ql/src/test/results/clientpositive/ppd_gby_join.q.out
index 5de9c4a145..7e39d4fcf3 100644
--- a/ql/src/test/results/clientpositive/ppd_gby_join.q.out
+++ b/ql/src/test/results/clientpositive/ppd_gby_join.q.out
@@ -131,7 +131,170 @@ STAGE PLANS:
   Stage: Stage-2
     Map Reduce
       Alias -> Map Operator Tree:
-        file:/tmp/sdong/hive_2011-02-10_16-56-49_887_123690558182632791/-mr-10002 
+        file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-14-53_815_8679319347089159838/-mr-10002 
+            Reduce Output Operator
+              key expressions:
+                    expr: _col0
+                    type: string
+              sort order: +
+              Map-reduce partition columns:
+                    expr: _col0
+                    type: string
+              tag: -1
+              value expressions:
+                    expr: _col1
+                    type: bigint
+      Reduce Operator Tree:
+        Group By Operator
+          aggregations:
+                expr: count(VALUE._col0)
+          bucketGroup: false
+          keys:
+                expr: KEY._col0
+                type: string
+          mode: mergepartial
+          outputColumnNames: _col0, _col1
+          Select Operator
+            expressions:
+                  expr: _col0
+                  type: string
+                  expr: _col1
+                  type: bigint
+            outputColumnNames: _col0, _col1
+            File Output Operator
+              compressed: false
+              GlobalTableId: 0
+              table:
+                  input format: org.apache.hadoop.mapred.TextInputFormat
+                  output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+
+  Stage: Stage-0
+    Fetch Operator
+      limit: -1
+
+
+PREHOOK: query: EXPLAIN
+SELECT src1.c1, count(1) 
+FROM
+(SELECT src.key AS c1, src.value AS c2 from src where src.key > '1' ) src1
+JOIN
+(SELECT src.key AS c3, src.value AS c4 from src where src.key > '2' ) src2
+ON src1.c1 = src2.c3 AND src1.c1 < '400'
+WHERE src1.c1 > '20' AND (src1.c2 < 'val_50' OR src1.c1 > '2') AND (src2.c3 > '50' OR src1.c1 < '50') AND (src2.c3 <> '4')
+GROUP BY src1.c1
+PREHOOK: type: QUERY
+POSTHOOK: query: EXPLAIN
+SELECT src1.c1, count(1) 
+FROM
+(SELECT src.key AS c1, src.value AS c2 from src where src.key > '1' ) src1
+JOIN
+(SELECT src.key AS c3, src.value AS c4 from src where src.key > '2' ) src2
+ON src1.c1 = src2.c3 AND src1.c1 < '400'
+WHERE src1.c1 > '20' AND (src1.c2 < 'val_50' OR src1.c1 > '2') AND (src2.c3 > '50' OR src1.c1 < '50') AND (src2.c3 <> '4')
+GROUP BY src1.c1
+POSTHOOK: type: QUERY
+ABSTRACT SYNTAX TREE:
+  (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME src))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL src) key) c1) (TOK_SELEXPR (. (TOK_TABLE_OR_COL src) value) c2)) (TOK_WHERE (> (. (TOK_TABLE_OR_COL src) key) '1')))) src1) (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME src))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL src) key) c3) (TOK_SELEXPR (. (TOK_TABLE_OR_COL src) value) c4)) (TOK_WHERE (> (. (TOK_TABLE_OR_COL src) key) '2')))) src2) (AND (= (. (TOK_TABLE_OR_COL src1) c1) (. (TOK_TABLE_OR_COL src2) c3)) (< (. (TOK_TABLE_OR_COL src1) c1) '400')))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL src1) c1)) (TOK_SELEXPR (TOK_FUNCTION count 1))) (TOK_WHERE (AND (AND (AND (> (. (TOK_TABLE_OR_COL src1) c1) '20') (OR (< (. (TOK_TABLE_OR_COL src1) c2) 'val_50') (> (. (TOK_TABLE_OR_COL src1) c1) '2'))) (OR (> (. (TOK_TABLE_OR_COL src2) c3) '50') (< (. (TOK_TABLE_OR_COL src1) c1) '50'))) (<> (. (TOK_TABLE_OR_COL src2) c3) '4'))) (TOK_GROUPBY (. (TOK_TABLE_OR_COL src1) c1))))
+
+STAGE DEPENDENCIES:
+  Stage-1 is a root stage
+  Stage-2 depends on stages: Stage-1
+  Stage-0 is a root stage
+
+STAGE PLANS:
+  Stage: Stage-1
+    Map Reduce
+      Alias -> Map Operator Tree:
+        src1:src 
+          TableScan
+            alias: src
+            Filter Operator
+              predicate:
+                  expr: (((key > '1') and (key < '400')) and ((key > '20') and ((value < 'val_50') or (key > '2'))))
+                  type: boolean
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: 0
+                  value expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col1
+                        type: string
+        src2:src 
+          TableScan
+            alias: src
+            Filter Operator
+              predicate:
+                  expr: ((key > '2') and (key <> '4'))
+                  type: boolean
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                outputColumnNames: _col0
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: 1
+                  value expressions:
+                        expr: _col0
+                        type: string
+      Reduce Operator Tree:
+        Join Operator
+          condition map:
+               Inner Join 0 to 1
+          condition expressions:
+            0 {VALUE._col0} {VALUE._col1}
+            1 {VALUE._col0}
+          handleSkewJoin: false
+          outputColumnNames: _col0, _col1, _col2
+          Filter Operator
+            predicate:
+                expr: ((((_col0 > '20') and ((_col1 < 'val_50') or (_col0 > '2'))) and ((_col2 > '50') or (_col0 < '50'))) and (_col2 <> '4'))
+                type: boolean
+            Select Operator
+              expressions:
+                    expr: _col0
+                    type: string
+              outputColumnNames: _col0
+              Group By Operator
+                aggregations:
+                      expr: count(1)
+                bucketGroup: false
+                keys:
+                      expr: _col0
+                      type: string
+                mode: hash
+                outputColumnNames: _col0, _col1
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 0
+                  table:
+                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+
+  Stage: Stage-2
+    Map Reduce
+      Alias -> Map Operator Tree:
+        file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-14-54_718_7102065647101283820/-mr-10002 
             Reduce Output Operator
               key expressions:
                     expr: _col0
diff --git a/ql/src/test/results/clientpositive/ppd_join.q.out b/ql/src/test/results/clientpositive/ppd_join.q.out
index 5d374cb8bc..41d75cd9fd 100644
--- a/ql/src/test/results/clientpositive/ppd_join.q.out
+++ b/ql/src/test/results/clientpositive/ppd_join.q.out
@@ -136,7 +136,7 @@ ON src1.c1 = src2.c3 AND src1.c1 < '400'
 WHERE src1.c1 > '20' and (src1.c2 < 'val_50' or src1.c1 > '2') and (src2.c3 > '50' or src1.c1 < '50') and (src2.c3 <> '4')
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
-PREHOOK: Output: file:/tmp/sdong/hive_2011-02-10_16-56-50_301_2741043495905569604/-mr-10000
+PREHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-19-54_404_4275400666711143229/-mr-10000
 POSTHOOK: query: SELECT src1.c1, src2.c4 
 FROM
 (SELECT src.key as c1, src.value as c2 from src where src.key > '1' ) src1
@@ -146,7 +146,562 @@ ON src1.c1 = src2.c3 AND src1.c1 < '400'
 WHERE src1.c1 > '20' and (src1.c2 < 'val_50' or src1.c1 > '2') and (src2.c3 > '50' or src1.c1 < '50') and (src2.c3 <> '4')
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
-POSTHOOK: Output: file:/tmp/sdong/hive_2011-02-10_16-56-50_301_2741043495905569604/-mr-10000
+POSTHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-19-54_404_4275400666711143229/-mr-10000
+200	val_200
+200	val_200
+200	val_200
+200	val_200
+201	val_201
+202	val_202
+203	val_203
+203	val_203
+203	val_203
+203	val_203
+205	val_205
+205	val_205
+205	val_205
+205	val_205
+207	val_207
+207	val_207
+207	val_207
+207	val_207
+208	val_208
+208	val_208
+208	val_208
+208	val_208
+208	val_208
+208	val_208
+208	val_208
+208	val_208
+208	val_208
+209	val_209
+209	val_209
+209	val_209
+209	val_209
+213	val_213
+213	val_213
+213	val_213
+213	val_213
+214	val_214
+216	val_216
+216	val_216
+216	val_216
+216	val_216
+217	val_217
+217	val_217
+217	val_217
+217	val_217
+218	val_218
+219	val_219
+219	val_219
+219	val_219
+219	val_219
+221	val_221
+221	val_221
+221	val_221
+221	val_221
+222	val_222
+223	val_223
+223	val_223
+223	val_223
+223	val_223
+224	val_224
+224	val_224
+224	val_224
+224	val_224
+226	val_226
+228	val_228
+229	val_229
+229	val_229
+229	val_229
+229	val_229
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+233	val_233
+233	val_233
+233	val_233
+233	val_233
+235	val_235
+237	val_237
+237	val_237
+237	val_237
+237	val_237
+238	val_238
+238	val_238
+238	val_238
+238	val_238
+239	val_239
+239	val_239
+239	val_239
+239	val_239
+24	val_24
+24	val_24
+24	val_24
+24	val_24
+241	val_241
+242	val_242
+242	val_242
+242	val_242
+242	val_242
+244	val_244
+247	val_247
+248	val_248
+249	val_249
+252	val_252
+255	val_255
+255	val_255
+255	val_255
+255	val_255
+256	val_256
+256	val_256
+256	val_256
+256	val_256
+257	val_257
+258	val_258
+26	val_26
+26	val_26
+26	val_26
+26	val_26
+260	val_260
+262	val_262
+263	val_263
+265	val_265
+265	val_265
+265	val_265
+265	val_265
+266	val_266
+27	val_27
+272	val_272
+272	val_272
+272	val_272
+272	val_272
+273	val_273
+273	val_273
+273	val_273
+273	val_273
+273	val_273
+273	val_273
+273	val_273
+273	val_273
+273	val_273
+274	val_274
+275	val_275
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+278	val_278
+278	val_278
+278	val_278
+278	val_278
+28	val_28
+280	val_280
+280	val_280
+280	val_280
+280	val_280
+281	val_281
+281	val_281
+281	val_281
+281	val_281
+282	val_282
+282	val_282
+282	val_282
+282	val_282
+283	val_283
+284	val_284
+285	val_285
+286	val_286
+287	val_287
+288	val_288
+288	val_288
+288	val_288
+288	val_288
+289	val_289
+291	val_291
+292	val_292
+296	val_296
+298	val_298
+298	val_298
+298	val_298
+298	val_298
+298	val_298
+298	val_298
+298	val_298
+298	val_298
+298	val_298
+30	val_30
+302	val_302
+305	val_305
+306	val_306
+307	val_307
+307	val_307
+307	val_307
+307	val_307
+308	val_308
+309	val_309
+309	val_309
+309	val_309
+309	val_309
+310	val_310
+311	val_311
+311	val_311
+311	val_311
+311	val_311
+311	val_311
+311	val_311
+311	val_311
+311	val_311
+311	val_311
+315	val_315
+316	val_316
+316	val_316
+316	val_316
+316	val_316
+316	val_316
+316	val_316
+316	val_316
+316	val_316
+316	val_316
+317	val_317
+317	val_317
+317	val_317
+317	val_317
+318	val_318
+318	val_318
+318	val_318
+318	val_318
+318	val_318
+318	val_318
+318	val_318
+318	val_318
+318	val_318
+321	val_321
+321	val_321
+321	val_321
+321	val_321
+322	val_322
+322	val_322
+322	val_322
+322	val_322
+323	val_323
+325	val_325
+325	val_325
+325	val_325
+325	val_325
+327	val_327
+327	val_327
+327	val_327
+327	val_327
+327	val_327
+327	val_327
+327	val_327
+327	val_327
+327	val_327
+33	val_33
+331	val_331
+331	val_331
+331	val_331
+331	val_331
+332	val_332
+333	val_333
+333	val_333
+333	val_333
+333	val_333
+335	val_335
+336	val_336
+338	val_338
+339	val_339
+34	val_34
+341	val_341
+342	val_342
+342	val_342
+342	val_342
+342	val_342
+344	val_344
+344	val_344
+344	val_344
+344	val_344
+345	val_345
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+351	val_351
+353	val_353
+353	val_353
+353	val_353
+353	val_353
+356	val_356
+360	val_360
+362	val_362
+364	val_364
+365	val_365
+366	val_366
+367	val_367
+367	val_367
+367	val_367
+367	val_367
+368	val_368
+369	val_369
+369	val_369
+369	val_369
+369	val_369
+369	val_369
+369	val_369
+369	val_369
+369	val_369
+369	val_369
+37	val_37
+37	val_37
+37	val_37
+37	val_37
+373	val_373
+374	val_374
+375	val_375
+377	val_377
+378	val_378
+379	val_379
+382	val_382
+382	val_382
+382	val_382
+382	val_382
+384	val_384
+384	val_384
+384	val_384
+384	val_384
+384	val_384
+384	val_384
+384	val_384
+384	val_384
+384	val_384
+386	val_386
+389	val_389
+392	val_392
+393	val_393
+394	val_394
+395	val_395
+395	val_395
+395	val_395
+395	val_395
+396	val_396
+396	val_396
+396	val_396
+396	val_396
+396	val_396
+396	val_396
+396	val_396
+396	val_396
+396	val_396
+397	val_397
+397	val_397
+397	val_397
+397	val_397
+399	val_399
+399	val_399
+399	val_399
+399	val_399
+PREHOOK: query: EXPLAIN
+SELECT src1.c1, src2.c4 
+FROM
+(SELECT src.key as c1, src.value as c2 from src where src.key > '1' ) src1
+JOIN
+(SELECT src.key as c3, src.value as c4 from src where src.key > '2' ) src2
+ON src1.c1 = src2.c3 AND src1.c1 < '400'
+WHERE src1.c1 > '20' and (src1.c2 < 'val_50' or src1.c1 > '2') and (src2.c3 > '50' or src1.c1 < '50') and (src2.c3 <> '4')
+PREHOOK: type: QUERY
+POSTHOOK: query: EXPLAIN
+SELECT src1.c1, src2.c4 
+FROM
+(SELECT src.key as c1, src.value as c2 from src where src.key > '1' ) src1
+JOIN
+(SELECT src.key as c3, src.value as c4 from src where src.key > '2' ) src2
+ON src1.c1 = src2.c3 AND src1.c1 < '400'
+WHERE src1.c1 > '20' and (src1.c2 < 'val_50' or src1.c1 > '2') and (src2.c3 > '50' or src1.c1 < '50') and (src2.c3 <> '4')
+POSTHOOK: type: QUERY
+ABSTRACT SYNTAX TREE:
+  (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME src))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL src) key) c1) (TOK_SELEXPR (. (TOK_TABLE_OR_COL src) value) c2)) (TOK_WHERE (> (. (TOK_TABLE_OR_COL src) key) '1')))) src1) (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME src))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL src) key) c3) (TOK_SELEXPR (. (TOK_TABLE_OR_COL src) value) c4)) (TOK_WHERE (> (. (TOK_TABLE_OR_COL src) key) '2')))) src2) (AND (= (. (TOK_TABLE_OR_COL src1) c1) (. (TOK_TABLE_OR_COL src2) c3)) (< (. (TOK_TABLE_OR_COL src1) c1) '400')))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL src1) c1)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL src2) c4))) (TOK_WHERE (and (and (and (> (. (TOK_TABLE_OR_COL src1) c1) '20') (or (< (. (TOK_TABLE_OR_COL src1) c2) 'val_50') (> (. (TOK_TABLE_OR_COL src1) c1) '2'))) (or (> (. (TOK_TABLE_OR_COL src2) c3) '50') (< (. (TOK_TABLE_OR_COL src1) c1) '50'))) (<> (. (TOK_TABLE_OR_COL src2) c3) '4')))))
+
+STAGE DEPENDENCIES:
+  Stage-1 is a root stage
+  Stage-0 is a root stage
+
+STAGE PLANS:
+  Stage: Stage-1
+    Map Reduce
+      Alias -> Map Operator Tree:
+        src1:src 
+          TableScan
+            alias: src
+            Filter Operator
+              predicate:
+                  expr: (((key > '1') and (key < '400')) and ((key > '20') and ((value < 'val_50') or (key > '2'))))
+                  type: boolean
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: 0
+                  value expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col1
+                        type: string
+        src2:src 
+          TableScan
+            alias: src
+            Filter Operator
+              predicate:
+                  expr: ((key > '2') and (key <> '4'))
+                  type: boolean
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: 1
+                  value expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col1
+                        type: string
+      Reduce Operator Tree:
+        Join Operator
+          condition map:
+               Inner Join 0 to 1
+          condition expressions:
+            0 {VALUE._col0} {VALUE._col1}
+            1 {VALUE._col0} {VALUE._col1}
+          handleSkewJoin: false
+          outputColumnNames: _col0, _col1, _col2, _col3
+          Filter Operator
+            predicate:
+                expr: ((((_col0 > '20') and ((_col1 < 'val_50') or (_col0 > '2'))) and ((_col2 > '50') or (_col0 < '50'))) and (_col2 <> '4'))
+                type: boolean
+            Select Operator
+              expressions:
+                    expr: _col0
+                    type: string
+                    expr: _col3
+                    type: string
+              outputColumnNames: _col0, _col1
+              File Output Operator
+                compressed: false
+                GlobalTableId: 0
+                table:
+                    input format: org.apache.hadoop.mapred.TextInputFormat
+                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+
+  Stage: Stage-0
+    Fetch Operator
+      limit: -1
+
+
+PREHOOK: query: SELECT src1.c1, src2.c4 
+FROM
+(SELECT src.key as c1, src.value as c2 from src where src.key > '1' ) src1
+JOIN
+(SELECT src.key as c3, src.value as c4 from src where src.key > '2' ) src2
+ON src1.c1 = src2.c3 AND src1.c1 < '400'
+WHERE src1.c1 > '20' and (src1.c2 < 'val_50' or src1.c1 > '2') and (src2.c3 > '50' or src1.c1 < '50') and (src2.c3 <> '4')
+PREHOOK: type: QUERY
+PREHOOK: Input: default@src
+PREHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-20-04_832_4076756605206612832/-mr-10000
+POSTHOOK: query: SELECT src1.c1, src2.c4 
+FROM
+(SELECT src.key as c1, src.value as c2 from src where src.key > '1' ) src1
+JOIN
+(SELECT src.key as c3, src.value as c4 from src where src.key > '2' ) src2
+ON src1.c1 = src2.c3 AND src1.c1 < '400'
+WHERE src1.c1 > '20' and (src1.c2 < 'val_50' or src1.c1 > '2') and (src2.c3 > '50' or src1.c1 < '50') and (src2.c3 <> '4')
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@src
+POSTHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-20-04_832_4076756605206612832/-mr-10000
 200	val_200
 200	val_200
 200	val_200
diff --git a/ql/src/test/results/clientpositive/ppd_join2.q.out b/ql/src/test/results/clientpositive/ppd_join2.q.out
index 9311b22554..5d51e56fe0 100644
--- a/ql/src/test/results/clientpositive/ppd_join2.q.out
+++ b/ql/src/test/results/clientpositive/ppd_join2.q.out
@@ -214,7 +214,7 @@ ON src1.c2 = src3.c6
 WHERE src1.c1 <> '311' and (src1.c2 <> 'val_50' or src1.c1 > '1') and (src2.c3 <> '10' or src1.c1 <> '10') and (src2.c3 <> '14') and (sqrt(src3.c5) <> 13)
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
-PREHOOK: Output: file:/tmp/sdong/hive_2011-02-10_16-56-54_335_1550783828530525327/-mr-10000
+PREHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-22-23_609_8022409171851868425/-mr-10000
 POSTHOOK: query: SELECT src1.c1, src2.c4 
 FROM
 (SELECT src.key as c1, src.value as c2 from src where src.key <> '302' ) src1
@@ -227,7 +227,1739 @@ ON src1.c2 = src3.c6
 WHERE src1.c1 <> '311' and (src1.c2 <> 'val_50' or src1.c1 > '1') and (src2.c3 <> '10' or src1.c1 <> '10') and (src2.c3 <> '14') and (sqrt(src3.c5) <> 13)
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
-POSTHOOK: Output: file:/tmp/sdong/hive_2011-02-10_16-56-54_335_1550783828530525327/-mr-10000
+POSTHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-22-23_609_8022409171851868425/-mr-10000
+0	val_0
+0	val_0
+0	val_0
+0	val_0
+0	val_0
+0	val_0
+0	val_0
+0	val_0
+0	val_0
+0	val_0
+0	val_0
+0	val_0
+0	val_0
+0	val_0
+0	val_0
+0	val_0
+0	val_0
+0	val_0
+0	val_0
+0	val_0
+0	val_0
+0	val_0
+0	val_0
+0	val_0
+0	val_0
+0	val_0
+0	val_0
+100	val_100
+100	val_100
+100	val_100
+100	val_100
+100	val_100
+100	val_100
+100	val_100
+100	val_100
+103	val_103
+103	val_103
+103	val_103
+103	val_103
+103	val_103
+103	val_103
+103	val_103
+103	val_103
+104	val_104
+104	val_104
+104	val_104
+104	val_104
+104	val_104
+104	val_104
+104	val_104
+104	val_104
+105	val_105
+11	val_11
+111	val_111
+113	val_113
+113	val_113
+113	val_113
+113	val_113
+113	val_113
+113	val_113
+113	val_113
+113	val_113
+114	val_114
+116	val_116
+118	val_118
+118	val_118
+118	val_118
+118	val_118
+118	val_118
+118	val_118
+118	val_118
+118	val_118
+119	val_119
+119	val_119
+119	val_119
+119	val_119
+119	val_119
+119	val_119
+119	val_119
+119	val_119
+119	val_119
+119	val_119
+119	val_119
+119	val_119
+119	val_119
+119	val_119
+119	val_119
+119	val_119
+119	val_119
+119	val_119
+119	val_119
+119	val_119
+119	val_119
+119	val_119
+119	val_119
+119	val_119
+119	val_119
+119	val_119
+119	val_119
+12	val_12
+12	val_12
+12	val_12
+12	val_12
+12	val_12
+12	val_12
+12	val_12
+12	val_12
+120	val_120
+120	val_120
+120	val_120
+120	val_120
+120	val_120
+120	val_120
+120	val_120
+120	val_120
+125	val_125
+125	val_125
+125	val_125
+125	val_125
+125	val_125
+125	val_125
+125	val_125
+125	val_125
+126	val_126
+128	val_128
+128	val_128
+128	val_128
+128	val_128
+128	val_128
+128	val_128
+128	val_128
+128	val_128
+128	val_128
+128	val_128
+128	val_128
+128	val_128
+128	val_128
+128	val_128
+128	val_128
+128	val_128
+128	val_128
+128	val_128
+128	val_128
+128	val_128
+128	val_128
+128	val_128
+128	val_128
+128	val_128
+128	val_128
+128	val_128
+128	val_128
+129	val_129
+129	val_129
+129	val_129
+129	val_129
+129	val_129
+129	val_129
+129	val_129
+129	val_129
+131	val_131
+133	val_133
+134	val_134
+134	val_134
+134	val_134
+134	val_134
+134	val_134
+134	val_134
+134	val_134
+134	val_134
+136	val_136
+137	val_137
+137	val_137
+137	val_137
+137	val_137
+137	val_137
+137	val_137
+137	val_137
+137	val_137
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+143	val_143
+145	val_145
+146	val_146
+146	val_146
+146	val_146
+146	val_146
+146	val_146
+146	val_146
+146	val_146
+146	val_146
+149	val_149
+149	val_149
+149	val_149
+149	val_149
+149	val_149
+149	val_149
+149	val_149
+149	val_149
+15	val_15
+15	val_15
+15	val_15
+15	val_15
+15	val_15
+15	val_15
+15	val_15
+15	val_15
+150	val_150
+152	val_152
+152	val_152
+152	val_152
+152	val_152
+152	val_152
+152	val_152
+152	val_152
+152	val_152
+153	val_153
+155	val_155
+156	val_156
+157	val_157
+158	val_158
+160	val_160
+162	val_162
+163	val_163
+164	val_164
+164	val_164
+164	val_164
+164	val_164
+164	val_164
+164	val_164
+164	val_164
+164	val_164
+165	val_165
+165	val_165
+165	val_165
+165	val_165
+165	val_165
+165	val_165
+165	val_165
+165	val_165
+166	val_166
+167	val_167
+167	val_167
+167	val_167
+167	val_167
+167	val_167
+167	val_167
+167	val_167
+167	val_167
+167	val_167
+167	val_167
+167	val_167
+167	val_167
+167	val_167
+167	val_167
+167	val_167
+167	val_167
+167	val_167
+167	val_167
+167	val_167
+167	val_167
+167	val_167
+167	val_167
+167	val_167
+167	val_167
+167	val_167
+167	val_167
+167	val_167
+168	val_168
+17	val_17
+170	val_170
+172	val_172
+172	val_172
+172	val_172
+172	val_172
+172	val_172
+172	val_172
+172	val_172
+172	val_172
+174	val_174
+174	val_174
+174	val_174
+174	val_174
+174	val_174
+174	val_174
+174	val_174
+174	val_174
+175	val_175
+175	val_175
+175	val_175
+175	val_175
+175	val_175
+175	val_175
+175	val_175
+175	val_175
+176	val_176
+176	val_176
+176	val_176
+176	val_176
+176	val_176
+176	val_176
+176	val_176
+176	val_176
+177	val_177
+178	val_178
+179	val_179
+179	val_179
+179	val_179
+179	val_179
+179	val_179
+179	val_179
+179	val_179
+179	val_179
+18	val_18
+18	val_18
+18	val_18
+18	val_18
+18	val_18
+18	val_18
+18	val_18
+18	val_18
+180	val_180
+181	val_181
+183	val_183
+186	val_186
+187	val_187
+187	val_187
+187	val_187
+187	val_187
+187	val_187
+187	val_187
+187	val_187
+187	val_187
+187	val_187
+187	val_187
+187	val_187
+187	val_187
+187	val_187
+187	val_187
+187	val_187
+187	val_187
+187	val_187
+187	val_187
+187	val_187
+187	val_187
+187	val_187
+187	val_187
+187	val_187
+187	val_187
+187	val_187
+187	val_187
+187	val_187
+189	val_189
+19	val_19
+190	val_190
+191	val_191
+191	val_191
+191	val_191
+191	val_191
+191	val_191
+191	val_191
+191	val_191
+191	val_191
+192	val_192
+193	val_193
+193	val_193
+193	val_193
+193	val_193
+193	val_193
+193	val_193
+193	val_193
+193	val_193
+193	val_193
+193	val_193
+193	val_193
+193	val_193
+193	val_193
+193	val_193
+193	val_193
+193	val_193
+193	val_193
+193	val_193
+193	val_193
+193	val_193
+193	val_193
+193	val_193
+193	val_193
+193	val_193
+193	val_193
+193	val_193
+193	val_193
+194	val_194
+195	val_195
+195	val_195
+195	val_195
+195	val_195
+195	val_195
+195	val_195
+195	val_195
+195	val_195
+196	val_196
+197	val_197
+197	val_197
+197	val_197
+197	val_197
+197	val_197
+197	val_197
+197	val_197
+197	val_197
+199	val_199
+199	val_199
+199	val_199
+199	val_199
+199	val_199
+199	val_199
+199	val_199
+199	val_199
+199	val_199
+199	val_199
+199	val_199
+199	val_199
+199	val_199
+199	val_199
+199	val_199
+199	val_199
+199	val_199
+199	val_199
+199	val_199
+199	val_199
+199	val_199
+199	val_199
+199	val_199
+199	val_199
+199	val_199
+199	val_199
+199	val_199
+2	val_2
+20	val_20
+200	val_200
+200	val_200
+200	val_200
+200	val_200
+200	val_200
+200	val_200
+200	val_200
+200	val_200
+201	val_201
+202	val_202
+203	val_203
+203	val_203
+203	val_203
+203	val_203
+203	val_203
+203	val_203
+203	val_203
+203	val_203
+205	val_205
+205	val_205
+205	val_205
+205	val_205
+205	val_205
+205	val_205
+205	val_205
+205	val_205
+207	val_207
+207	val_207
+207	val_207
+207	val_207
+207	val_207
+207	val_207
+207	val_207
+207	val_207
+208	val_208
+208	val_208
+208	val_208
+208	val_208
+208	val_208
+208	val_208
+208	val_208
+208	val_208
+208	val_208
+208	val_208
+208	val_208
+208	val_208
+208	val_208
+208	val_208
+208	val_208
+208	val_208
+208	val_208
+208	val_208
+208	val_208
+208	val_208
+208	val_208
+208	val_208
+208	val_208
+208	val_208
+208	val_208
+208	val_208
+208	val_208
+209	val_209
+209	val_209
+209	val_209
+209	val_209
+209	val_209
+209	val_209
+209	val_209
+209	val_209
+213	val_213
+213	val_213
+213	val_213
+213	val_213
+213	val_213
+213	val_213
+213	val_213
+213	val_213
+214	val_214
+216	val_216
+216	val_216
+216	val_216
+216	val_216
+216	val_216
+216	val_216
+216	val_216
+216	val_216
+217	val_217
+217	val_217
+217	val_217
+217	val_217
+217	val_217
+217	val_217
+217	val_217
+217	val_217
+218	val_218
+219	val_219
+219	val_219
+219	val_219
+219	val_219
+219	val_219
+219	val_219
+219	val_219
+219	val_219
+221	val_221
+221	val_221
+221	val_221
+221	val_221
+221	val_221
+221	val_221
+221	val_221
+221	val_221
+222	val_222
+223	val_223
+223	val_223
+223	val_223
+223	val_223
+223	val_223
+223	val_223
+223	val_223
+223	val_223
+224	val_224
+224	val_224
+224	val_224
+224	val_224
+224	val_224
+224	val_224
+224	val_224
+224	val_224
+226	val_226
+228	val_228
+229	val_229
+229	val_229
+229	val_229
+229	val_229
+229	val_229
+229	val_229
+229	val_229
+229	val_229
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+233	val_233
+233	val_233
+233	val_233
+233	val_233
+233	val_233
+233	val_233
+233	val_233
+233	val_233
+235	val_235
+237	val_237
+237	val_237
+237	val_237
+237	val_237
+237	val_237
+237	val_237
+237	val_237
+237	val_237
+238	val_238
+238	val_238
+238	val_238
+238	val_238
+238	val_238
+238	val_238
+238	val_238
+238	val_238
+239	val_239
+239	val_239
+239	val_239
+239	val_239
+239	val_239
+239	val_239
+239	val_239
+239	val_239
+24	val_24
+24	val_24
+24	val_24
+24	val_24
+24	val_24
+24	val_24
+24	val_24
+24	val_24
+241	val_241
+242	val_242
+242	val_242
+242	val_242
+242	val_242
+242	val_242
+242	val_242
+242	val_242
+242	val_242
+244	val_244
+247	val_247
+248	val_248
+249	val_249
+252	val_252
+255	val_255
+255	val_255
+255	val_255
+255	val_255
+255	val_255
+255	val_255
+255	val_255
+255	val_255
+256	val_256
+256	val_256
+256	val_256
+256	val_256
+256	val_256
+256	val_256
+256	val_256
+256	val_256
+257	val_257
+258	val_258
+26	val_26
+26	val_26
+26	val_26
+26	val_26
+26	val_26
+26	val_26
+26	val_26
+26	val_26
+260	val_260
+262	val_262
+263	val_263
+265	val_265
+265	val_265
+265	val_265
+265	val_265
+265	val_265
+265	val_265
+265	val_265
+265	val_265
+266	val_266
+27	val_27
+272	val_272
+272	val_272
+272	val_272
+272	val_272
+272	val_272
+272	val_272
+272	val_272
+272	val_272
+273	val_273
+273	val_273
+273	val_273
+273	val_273
+273	val_273
+273	val_273
+273	val_273
+273	val_273
+273	val_273
+273	val_273
+273	val_273
+273	val_273
+273	val_273
+273	val_273
+273	val_273
+273	val_273
+273	val_273
+273	val_273
+273	val_273
+273	val_273
+273	val_273
+273	val_273
+273	val_273
+273	val_273
+273	val_273
+273	val_273
+273	val_273
+274	val_274
+275	val_275
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+278	val_278
+278	val_278
+278	val_278
+278	val_278
+278	val_278
+278	val_278
+278	val_278
+278	val_278
+28	val_28
+280	val_280
+280	val_280
+280	val_280
+280	val_280
+280	val_280
+280	val_280
+280	val_280
+280	val_280
+281	val_281
+281	val_281
+281	val_281
+281	val_281
+281	val_281
+281	val_281
+281	val_281
+281	val_281
+282	val_282
+282	val_282
+282	val_282
+282	val_282
+282	val_282
+282	val_282
+282	val_282
+282	val_282
+283	val_283
+284	val_284
+285	val_285
+286	val_286
+287	val_287
+288	val_288
+288	val_288
+288	val_288
+288	val_288
+288	val_288
+288	val_288
+288	val_288
+288	val_288
+289	val_289
+291	val_291
+292	val_292
+296	val_296
+298	val_298
+298	val_298
+298	val_298
+298	val_298
+298	val_298
+298	val_298
+298	val_298
+298	val_298
+298	val_298
+298	val_298
+298	val_298
+298	val_298
+298	val_298
+298	val_298
+298	val_298
+298	val_298
+298	val_298
+298	val_298
+298	val_298
+298	val_298
+298	val_298
+298	val_298
+298	val_298
+298	val_298
+298	val_298
+298	val_298
+298	val_298
+30	val_30
+307	val_307
+307	val_307
+307	val_307
+307	val_307
+307	val_307
+307	val_307
+307	val_307
+307	val_307
+308	val_308
+309	val_309
+309	val_309
+309	val_309
+309	val_309
+309	val_309
+309	val_309
+309	val_309
+309	val_309
+310	val_310
+315	val_315
+316	val_316
+316	val_316
+316	val_316
+316	val_316
+316	val_316
+316	val_316
+316	val_316
+316	val_316
+316	val_316
+316	val_316
+316	val_316
+316	val_316
+316	val_316
+316	val_316
+316	val_316
+316	val_316
+316	val_316
+316	val_316
+316	val_316
+316	val_316
+316	val_316
+316	val_316
+316	val_316
+316	val_316
+316	val_316
+316	val_316
+316	val_316
+317	val_317
+317	val_317
+317	val_317
+317	val_317
+317	val_317
+317	val_317
+317	val_317
+317	val_317
+318	val_318
+318	val_318
+318	val_318
+318	val_318
+318	val_318
+318	val_318
+318	val_318
+318	val_318
+318	val_318
+318	val_318
+318	val_318
+318	val_318
+318	val_318
+318	val_318
+318	val_318
+318	val_318
+318	val_318
+318	val_318
+318	val_318
+318	val_318
+318	val_318
+318	val_318
+318	val_318
+318	val_318
+318	val_318
+318	val_318
+318	val_318
+321	val_321
+321	val_321
+321	val_321
+321	val_321
+321	val_321
+321	val_321
+321	val_321
+321	val_321
+322	val_322
+322	val_322
+322	val_322
+322	val_322
+322	val_322
+322	val_322
+322	val_322
+322	val_322
+323	val_323
+325	val_325
+325	val_325
+325	val_325
+325	val_325
+325	val_325
+325	val_325
+325	val_325
+325	val_325
+327	val_327
+327	val_327
+327	val_327
+327	val_327
+327	val_327
+327	val_327
+327	val_327
+327	val_327
+327	val_327
+327	val_327
+327	val_327
+327	val_327
+327	val_327
+327	val_327
+327	val_327
+327	val_327
+327	val_327
+327	val_327
+327	val_327
+327	val_327
+327	val_327
+327	val_327
+327	val_327
+327	val_327
+327	val_327
+327	val_327
+327	val_327
+33	val_33
+331	val_331
+331	val_331
+331	val_331
+331	val_331
+331	val_331
+331	val_331
+331	val_331
+331	val_331
+332	val_332
+333	val_333
+333	val_333
+333	val_333
+333	val_333
+333	val_333
+333	val_333
+333	val_333
+333	val_333
+335	val_335
+336	val_336
+338	val_338
+339	val_339
+34	val_34
+341	val_341
+342	val_342
+342	val_342
+342	val_342
+342	val_342
+342	val_342
+342	val_342
+342	val_342
+342	val_342
+344	val_344
+344	val_344
+344	val_344
+344	val_344
+344	val_344
+344	val_344
+344	val_344
+344	val_344
+345	val_345
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+351	val_351
+353	val_353
+353	val_353
+353	val_353
+353	val_353
+353	val_353
+353	val_353
+353	val_353
+353	val_353
+356	val_356
+360	val_360
+362	val_362
+364	val_364
+365	val_365
+366	val_366
+367	val_367
+367	val_367
+367	val_367
+367	val_367
+367	val_367
+367	val_367
+367	val_367
+367	val_367
+368	val_368
+369	val_369
+369	val_369
+369	val_369
+369	val_369
+369	val_369
+369	val_369
+369	val_369
+369	val_369
+369	val_369
+369	val_369
+369	val_369
+369	val_369
+369	val_369
+369	val_369
+369	val_369
+369	val_369
+369	val_369
+369	val_369
+369	val_369
+369	val_369
+369	val_369
+369	val_369
+369	val_369
+369	val_369
+369	val_369
+369	val_369
+369	val_369
+37	val_37
+37	val_37
+37	val_37
+37	val_37
+37	val_37
+37	val_37
+37	val_37
+37	val_37
+373	val_373
+374	val_374
+375	val_375
+377	val_377
+378	val_378
+379	val_379
+382	val_382
+382	val_382
+382	val_382
+382	val_382
+382	val_382
+382	val_382
+382	val_382
+382	val_382
+384	val_384
+384	val_384
+384	val_384
+384	val_384
+384	val_384
+384	val_384
+384	val_384
+384	val_384
+384	val_384
+384	val_384
+384	val_384
+384	val_384
+384	val_384
+384	val_384
+384	val_384
+384	val_384
+384	val_384
+384	val_384
+384	val_384
+384	val_384
+384	val_384
+384	val_384
+384	val_384
+384	val_384
+384	val_384
+384	val_384
+384	val_384
+386	val_386
+389	val_389
+392	val_392
+393	val_393
+394	val_394
+395	val_395
+395	val_395
+395	val_395
+395	val_395
+395	val_395
+395	val_395
+395	val_395
+395	val_395
+396	val_396
+396	val_396
+396	val_396
+396	val_396
+396	val_396
+396	val_396
+396	val_396
+396	val_396
+396	val_396
+396	val_396
+396	val_396
+396	val_396
+396	val_396
+396	val_396
+396	val_396
+396	val_396
+396	val_396
+396	val_396
+396	val_396
+396	val_396
+396	val_396
+396	val_396
+396	val_396
+396	val_396
+396	val_396
+396	val_396
+396	val_396
+397	val_397
+397	val_397
+397	val_397
+397	val_397
+397	val_397
+397	val_397
+397	val_397
+397	val_397
+399	val_399
+399	val_399
+399	val_399
+399	val_399
+399	val_399
+399	val_399
+399	val_399
+399	val_399
+4	val_4
+PREHOOK: query: EXPLAIN
+SELECT src1.c1, src2.c4 
+FROM
+(SELECT src.key as c1, src.value as c2 from src where src.key <> '302' ) src1
+JOIN
+(SELECT src.key as c3, src.value as c4 from src where src.key <> '305' ) src2
+ON src1.c1 = src2.c3 AND src1.c1 < '400'
+JOIN
+(SELECT src.key as c5, src.value as c6 from src where src.key <> '306' ) src3
+ON src1.c2 = src3.c6
+WHERE src1.c1 <> '311' and (src1.c2 <> 'val_50' or src1.c1 > '1') and (src2.c3 <> '10' or src1.c1 <> '10') and (src2.c3 <> '14') and (sqrt(src3.c5) <> 13)
+PREHOOK: type: QUERY
+POSTHOOK: query: EXPLAIN
+SELECT src1.c1, src2.c4 
+FROM
+(SELECT src.key as c1, src.value as c2 from src where src.key <> '302' ) src1
+JOIN
+(SELECT src.key as c3, src.value as c4 from src where src.key <> '305' ) src2
+ON src1.c1 = src2.c3 AND src1.c1 < '400'
+JOIN
+(SELECT src.key as c5, src.value as c6 from src where src.key <> '306' ) src3
+ON src1.c2 = src3.c6
+WHERE src1.c1 <> '311' and (src1.c2 <> 'val_50' or src1.c1 > '1') and (src2.c3 <> '10' or src1.c1 <> '10') and (src2.c3 <> '14') and (sqrt(src3.c5) <> 13)
+POSTHOOK: type: QUERY
+ABSTRACT SYNTAX TREE:
+  (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_JOIN (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME src))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL src) key) c1) (TOK_SELEXPR (. (TOK_TABLE_OR_COL src) value) c2)) (TOK_WHERE (<> (. (TOK_TABLE_OR_COL src) key) '302')))) src1) (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME src))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL src) key) c3) (TOK_SELEXPR (. (TOK_TABLE_OR_COL src) value) c4)) (TOK_WHERE (<> (. (TOK_TABLE_OR_COL src) key) '305')))) src2) (AND (= (. (TOK_TABLE_OR_COL src1) c1) (. (TOK_TABLE_OR_COL src2) c3)) (< (. (TOK_TABLE_OR_COL src1) c1) '400'))) (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME src))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL src) key) c5) (TOK_SELEXPR (. (TOK_TABLE_OR_COL src) value) c6)) (TOK_WHERE (<> (. (TOK_TABLE_OR_COL src) key) '306')))) src3) (= (. (TOK_TABLE_OR_COL src1) c2) (. (TOK_TABLE_OR_COL src3) c6)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL src1) c1)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL src2) c4))) (TOK_WHERE (and (and (and (and (<> (. (TOK_TABLE_OR_COL src1) c1) '311') (or (<> (. (TOK_TABLE_OR_COL src1) c2) 'val_50') (> (. (TOK_TABLE_OR_COL src1) c1) '1'))) (or (<> (. (TOK_TABLE_OR_COL src2) c3) '10') (<> (. (TOK_TABLE_OR_COL src1) c1) '10'))) (<> (. (TOK_TABLE_OR_COL src2) c3) '14')) (<> (TOK_FUNCTION sqrt (. (TOK_TABLE_OR_COL src3) c5)) 13)))))
+
+STAGE DEPENDENCIES:
+  Stage-1 is a root stage
+  Stage-2 depends on stages: Stage-1
+  Stage-0 is a root stage
+
+STAGE PLANS:
+  Stage: Stage-1
+    Map Reduce
+      Alias -> Map Operator Tree:
+        src1:src 
+          TableScan
+            alias: src
+            Filter Operator
+              predicate:
+                  expr: (((key <> '302') and (key < '400')) and ((key <> '311') and ((value <> 'val_50') or (key > '1'))))
+                  type: boolean
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: 0
+                  value expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col1
+                        type: string
+        src2:src 
+          TableScan
+            alias: src
+            Filter Operator
+              predicate:
+                  expr: ((key <> '305') and (key <> '14'))
+                  type: boolean
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: 1
+                  value expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col1
+                        type: string
+      Reduce Operator Tree:
+        Join Operator
+          condition map:
+               Inner Join 0 to 1
+          condition expressions:
+            0 {VALUE._col0} {VALUE._col1}
+            1 {VALUE._col0} {VALUE._col1}
+          handleSkewJoin: false
+          outputColumnNames: _col0, _col1, _col2, _col3
+          File Output Operator
+            compressed: false
+            GlobalTableId: 0
+            table:
+                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+
+  Stage: Stage-2
+    Map Reduce
+      Alias -> Map Operator Tree:
+        $INTNAME 
+            Reduce Output Operator
+              key expressions:
+                    expr: _col1
+                    type: string
+              sort order: +
+              Map-reduce partition columns:
+                    expr: _col1
+                    type: string
+              tag: 0
+              value expressions:
+                    expr: _col2
+                    type: string
+                    expr: _col3
+                    type: string
+                    expr: _col0
+                    type: string
+                    expr: _col1
+                    type: string
+        src3:src 
+          TableScan
+            alias: src
+            Filter Operator
+              predicate:
+                  expr: ((key <> '306') and (sqrt(key) <> 13))
+                  type: boolean
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col1
+                        type: string
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col1
+                        type: string
+                  tag: 1
+                  value expressions:
+                        expr: _col0
+                        type: string
+      Reduce Operator Tree:
+        Join Operator
+          condition map:
+               Inner Join 0 to 1
+          condition expressions:
+            0 {VALUE._col0} {VALUE._col1} {VALUE._col2} {VALUE._col3}
+            1 {VALUE._col0}
+          handleSkewJoin: false
+          outputColumnNames: _col0, _col1, _col2, _col3, _col4
+          Filter Operator
+            predicate:
+                expr: (((((_col2 <> '311') and ((_col3 <> 'val_50') or (_col2 > '1'))) and ((_col0 <> '10') or (_col2 <> '10'))) and (_col0 <> '14')) and (sqrt(_col4) <> 13))
+                type: boolean
+            Select Operator
+              expressions:
+                    expr: _col2
+                    type: string
+                    expr: _col1
+                    type: string
+              outputColumnNames: _col0, _col1
+              File Output Operator
+                compressed: false
+                GlobalTableId: 0
+                table:
+                    input format: org.apache.hadoop.mapred.TextInputFormat
+                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+
+  Stage: Stage-0
+    Fetch Operator
+      limit: -1
+
+
+PREHOOK: query: SELECT src1.c1, src2.c4 
+FROM
+(SELECT src.key as c1, src.value as c2 from src where src.key <> '302' ) src1
+JOIN
+(SELECT src.key as c3, src.value as c4 from src where src.key <> '305' ) src2
+ON src1.c1 = src2.c3 AND src1.c1 < '400'
+JOIN
+(SELECT src.key as c5, src.value as c6 from src where src.key <> '306' ) src3
+ON src1.c2 = src3.c6
+WHERE src1.c1 <> '311' and (src1.c2 <> 'val_50' or src1.c1 > '1') and (src2.c3 <> '10' or src1.c1 <> '10') and (src2.c3 <> '14') and (sqrt(src3.c5) <> 13)
+PREHOOK: type: QUERY
+PREHOOK: Input: default@src
+PREHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-22-44_680_6270114164732441996/-mr-10000
+POSTHOOK: query: SELECT src1.c1, src2.c4 
+FROM
+(SELECT src.key as c1, src.value as c2 from src where src.key <> '302' ) src1
+JOIN
+(SELECT src.key as c3, src.value as c4 from src where src.key <> '305' ) src2
+ON src1.c1 = src2.c3 AND src1.c1 < '400'
+JOIN
+(SELECT src.key as c5, src.value as c6 from src where src.key <> '306' ) src3
+ON src1.c2 = src3.c6
+WHERE src1.c1 <> '311' and (src1.c2 <> 'val_50' or src1.c1 > '1') and (src2.c3 <> '10' or src1.c1 <> '10') and (src2.c3 <> '14') and (sqrt(src3.c5) <> 13)
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@src
+POSTHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-22-44_680_6270114164732441996/-mr-10000
 0	val_0
 0	val_0
 0	val_0
diff --git a/ql/src/test/results/clientpositive/ppd_join3.q.out b/ql/src/test/results/clientpositive/ppd_join3.q.out
index daed2e6c60..0c7c767371 100644
--- a/ql/src/test/results/clientpositive/ppd_join3.q.out
+++ b/ql/src/test/results/clientpositive/ppd_join3.q.out
@@ -175,7 +175,7 @@ ON src1.c1 = src3.c5
 WHERE src1.c1 > '0' and (src1.c2 <> 'val_500' or src1.c1 > '1') and (src2.c3 > '10' or src1.c1 <> '10') and (src2.c3 <> '4') and (src3.c5 <> '1')
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
-PREHOOK: Output: file:/tmp/sdong/hive_2011-02-10_16-57-01_987_2716591092944855571/-mr-10000
+PREHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-25-08_238_6256269886850027827/-mr-10000
 POSTHOOK: query: SELECT src1.c1, src2.c4 
 FROM
 (SELECT src.key as c1, src.value as c2 from src where src.key <> '11' ) src1
@@ -188,7 +188,1757 @@ ON src1.c1 = src3.c5
 WHERE src1.c1 > '0' and (src1.c2 <> 'val_500' or src1.c1 > '1') and (src2.c3 > '10' or src1.c1 <> '10') and (src2.c3 <> '4') and (src3.c5 <> '1')
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
-POSTHOOK: Output: file:/tmp/sdong/hive_2011-02-10_16-57-01_987_2716591092944855571/-mr-10000
+POSTHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-25-08_238_6256269886850027827/-mr-10000
+100	val_100
+100	val_100
+100	val_100
+100	val_100
+100	val_100
+100	val_100
+100	val_100
+100	val_100
+103	val_103
+103	val_103
+103	val_103
+103	val_103
+103	val_103
+103	val_103
+103	val_103
+103	val_103
+104	val_104
+104	val_104
+104	val_104
+104	val_104
+104	val_104
+104	val_104
+104	val_104
+104	val_104
+105	val_105
+111	val_111
+113	val_113
+113	val_113
+113	val_113
+113	val_113
+113	val_113
+113	val_113
+113	val_113
+113	val_113
+114	val_114
+116	val_116
+118	val_118
+118	val_118
+118	val_118
+118	val_118
+118	val_118
+118	val_118
+118	val_118
+118	val_118
+119	val_119
+119	val_119
+119	val_119
+119	val_119
+119	val_119
+119	val_119
+119	val_119
+119	val_119
+119	val_119
+119	val_119
+119	val_119
+119	val_119
+119	val_119
+119	val_119
+119	val_119
+119	val_119
+119	val_119
+119	val_119
+119	val_119
+119	val_119
+119	val_119
+119	val_119
+119	val_119
+119	val_119
+119	val_119
+119	val_119
+119	val_119
+120	val_120
+120	val_120
+120	val_120
+120	val_120
+120	val_120
+120	val_120
+120	val_120
+120	val_120
+125	val_125
+125	val_125
+125	val_125
+125	val_125
+125	val_125
+125	val_125
+125	val_125
+125	val_125
+126	val_126
+128	val_128
+128	val_128
+128	val_128
+128	val_128
+128	val_128
+128	val_128
+128	val_128
+128	val_128
+128	val_128
+128	val_128
+128	val_128
+128	val_128
+128	val_128
+128	val_128
+128	val_128
+128	val_128
+128	val_128
+128	val_128
+128	val_128
+128	val_128
+128	val_128
+128	val_128
+128	val_128
+128	val_128
+128	val_128
+128	val_128
+128	val_128
+129	val_129
+129	val_129
+129	val_129
+129	val_129
+129	val_129
+129	val_129
+129	val_129
+129	val_129
+131	val_131
+133	val_133
+134	val_134
+134	val_134
+134	val_134
+134	val_134
+134	val_134
+134	val_134
+134	val_134
+134	val_134
+136	val_136
+137	val_137
+137	val_137
+137	val_137
+137	val_137
+137	val_137
+137	val_137
+137	val_137
+137	val_137
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+143	val_143
+145	val_145
+146	val_146
+146	val_146
+146	val_146
+146	val_146
+146	val_146
+146	val_146
+146	val_146
+146	val_146
+149	val_149
+149	val_149
+149	val_149
+149	val_149
+149	val_149
+149	val_149
+149	val_149
+149	val_149
+15	val_15
+15	val_15
+15	val_15
+15	val_15
+15	val_15
+15	val_15
+15	val_15
+15	val_15
+150	val_150
+152	val_152
+152	val_152
+152	val_152
+152	val_152
+152	val_152
+152	val_152
+152	val_152
+152	val_152
+153	val_153
+155	val_155
+156	val_156
+157	val_157
+158	val_158
+160	val_160
+162	val_162
+163	val_163
+164	val_164
+164	val_164
+164	val_164
+164	val_164
+164	val_164
+164	val_164
+164	val_164
+164	val_164
+165	val_165
+165	val_165
+165	val_165
+165	val_165
+165	val_165
+165	val_165
+165	val_165
+165	val_165
+166	val_166
+167	val_167
+167	val_167
+167	val_167
+167	val_167
+167	val_167
+167	val_167
+167	val_167
+167	val_167
+167	val_167
+167	val_167
+167	val_167
+167	val_167
+167	val_167
+167	val_167
+167	val_167
+167	val_167
+167	val_167
+167	val_167
+167	val_167
+167	val_167
+167	val_167
+167	val_167
+167	val_167
+167	val_167
+167	val_167
+167	val_167
+167	val_167
+168	val_168
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+17	val_17
+170	val_170
+172	val_172
+172	val_172
+172	val_172
+172	val_172
+172	val_172
+172	val_172
+172	val_172
+172	val_172
+174	val_174
+174	val_174
+174	val_174
+174	val_174
+174	val_174
+174	val_174
+174	val_174
+174	val_174
+175	val_175
+175	val_175
+175	val_175
+175	val_175
+175	val_175
+175	val_175
+175	val_175
+175	val_175
+176	val_176
+176	val_176
+176	val_176
+176	val_176
+176	val_176
+176	val_176
+176	val_176
+176	val_176
+177	val_177
+178	val_178
+179	val_179
+179	val_179
+179	val_179
+179	val_179
+179	val_179
+179	val_179
+179	val_179
+179	val_179
+18	val_18
+18	val_18
+18	val_18
+18	val_18
+18	val_18
+18	val_18
+18	val_18
+18	val_18
+180	val_180
+181	val_181
+183	val_183
+186	val_186
+187	val_187
+187	val_187
+187	val_187
+187	val_187
+187	val_187
+187	val_187
+187	val_187
+187	val_187
+187	val_187
+187	val_187
+187	val_187
+187	val_187
+187	val_187
+187	val_187
+187	val_187
+187	val_187
+187	val_187
+187	val_187
+187	val_187
+187	val_187
+187	val_187
+187	val_187
+187	val_187
+187	val_187
+187	val_187
+187	val_187
+187	val_187
+189	val_189
+19	val_19
+190	val_190
+191	val_191
+191	val_191
+191	val_191
+191	val_191
+191	val_191
+191	val_191
+191	val_191
+191	val_191
+192	val_192
+193	val_193
+193	val_193
+193	val_193
+193	val_193
+193	val_193
+193	val_193
+193	val_193
+193	val_193
+193	val_193
+193	val_193
+193	val_193
+193	val_193
+193	val_193
+193	val_193
+193	val_193
+193	val_193
+193	val_193
+193	val_193
+193	val_193
+193	val_193
+193	val_193
+193	val_193
+193	val_193
+193	val_193
+193	val_193
+193	val_193
+193	val_193
+194	val_194
+195	val_195
+195	val_195
+195	val_195
+195	val_195
+195	val_195
+195	val_195
+195	val_195
+195	val_195
+196	val_196
+197	val_197
+197	val_197
+197	val_197
+197	val_197
+197	val_197
+197	val_197
+197	val_197
+197	val_197
+199	val_199
+199	val_199
+199	val_199
+199	val_199
+199	val_199
+199	val_199
+199	val_199
+199	val_199
+199	val_199
+199	val_199
+199	val_199
+199	val_199
+199	val_199
+199	val_199
+199	val_199
+199	val_199
+199	val_199
+199	val_199
+199	val_199
+199	val_199
+199	val_199
+199	val_199
+199	val_199
+199	val_199
+199	val_199
+199	val_199
+199	val_199
+2	val_2
+20	val_20
+200	val_200
+200	val_200
+200	val_200
+200	val_200
+200	val_200
+200	val_200
+200	val_200
+200	val_200
+201	val_201
+202	val_202
+203	val_203
+203	val_203
+203	val_203
+203	val_203
+203	val_203
+203	val_203
+203	val_203
+203	val_203
+205	val_205
+205	val_205
+205	val_205
+205	val_205
+205	val_205
+205	val_205
+205	val_205
+205	val_205
+207	val_207
+207	val_207
+207	val_207
+207	val_207
+207	val_207
+207	val_207
+207	val_207
+207	val_207
+208	val_208
+208	val_208
+208	val_208
+208	val_208
+208	val_208
+208	val_208
+208	val_208
+208	val_208
+208	val_208
+208	val_208
+208	val_208
+208	val_208
+208	val_208
+208	val_208
+208	val_208
+208	val_208
+208	val_208
+208	val_208
+208	val_208
+208	val_208
+208	val_208
+208	val_208
+208	val_208
+208	val_208
+208	val_208
+208	val_208
+208	val_208
+209	val_209
+209	val_209
+209	val_209
+209	val_209
+209	val_209
+209	val_209
+209	val_209
+209	val_209
+213	val_213
+213	val_213
+213	val_213
+213	val_213
+213	val_213
+213	val_213
+213	val_213
+213	val_213
+214	val_214
+216	val_216
+216	val_216
+216	val_216
+216	val_216
+216	val_216
+216	val_216
+216	val_216
+216	val_216
+217	val_217
+217	val_217
+217	val_217
+217	val_217
+217	val_217
+217	val_217
+217	val_217
+217	val_217
+218	val_218
+219	val_219
+219	val_219
+219	val_219
+219	val_219
+219	val_219
+219	val_219
+219	val_219
+219	val_219
+221	val_221
+221	val_221
+221	val_221
+221	val_221
+221	val_221
+221	val_221
+221	val_221
+221	val_221
+222	val_222
+223	val_223
+223	val_223
+223	val_223
+223	val_223
+223	val_223
+223	val_223
+223	val_223
+223	val_223
+224	val_224
+224	val_224
+224	val_224
+224	val_224
+224	val_224
+224	val_224
+224	val_224
+224	val_224
+226	val_226
+228	val_228
+229	val_229
+229	val_229
+229	val_229
+229	val_229
+229	val_229
+229	val_229
+229	val_229
+229	val_229
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+233	val_233
+233	val_233
+233	val_233
+233	val_233
+233	val_233
+233	val_233
+233	val_233
+233	val_233
+235	val_235
+237	val_237
+237	val_237
+237	val_237
+237	val_237
+237	val_237
+237	val_237
+237	val_237
+237	val_237
+238	val_238
+238	val_238
+238	val_238
+238	val_238
+238	val_238
+238	val_238
+238	val_238
+238	val_238
+239	val_239
+239	val_239
+239	val_239
+239	val_239
+239	val_239
+239	val_239
+239	val_239
+239	val_239
+24	val_24
+24	val_24
+24	val_24
+24	val_24
+24	val_24
+24	val_24
+24	val_24
+24	val_24
+241	val_241
+242	val_242
+242	val_242
+242	val_242
+242	val_242
+242	val_242
+242	val_242
+242	val_242
+242	val_242
+244	val_244
+247	val_247
+248	val_248
+249	val_249
+252	val_252
+255	val_255
+255	val_255
+255	val_255
+255	val_255
+255	val_255
+255	val_255
+255	val_255
+255	val_255
+256	val_256
+256	val_256
+256	val_256
+256	val_256
+256	val_256
+256	val_256
+256	val_256
+256	val_256
+257	val_257
+258	val_258
+26	val_26
+26	val_26
+26	val_26
+26	val_26
+26	val_26
+26	val_26
+26	val_26
+26	val_26
+260	val_260
+262	val_262
+263	val_263
+265	val_265
+265	val_265
+265	val_265
+265	val_265
+265	val_265
+265	val_265
+265	val_265
+265	val_265
+266	val_266
+27	val_27
+272	val_272
+272	val_272
+272	val_272
+272	val_272
+272	val_272
+272	val_272
+272	val_272
+272	val_272
+273	val_273
+273	val_273
+273	val_273
+273	val_273
+273	val_273
+273	val_273
+273	val_273
+273	val_273
+273	val_273
+273	val_273
+273	val_273
+273	val_273
+273	val_273
+273	val_273
+273	val_273
+273	val_273
+273	val_273
+273	val_273
+273	val_273
+273	val_273
+273	val_273
+273	val_273
+273	val_273
+273	val_273
+273	val_273
+273	val_273
+273	val_273
+274	val_274
+275	val_275
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+278	val_278
+278	val_278
+278	val_278
+278	val_278
+278	val_278
+278	val_278
+278	val_278
+278	val_278
+28	val_28
+280	val_280
+280	val_280
+280	val_280
+280	val_280
+280	val_280
+280	val_280
+280	val_280
+280	val_280
+281	val_281
+281	val_281
+281	val_281
+281	val_281
+281	val_281
+281	val_281
+281	val_281
+281	val_281
+282	val_282
+282	val_282
+282	val_282
+282	val_282
+282	val_282
+282	val_282
+282	val_282
+282	val_282
+283	val_283
+284	val_284
+285	val_285
+286	val_286
+287	val_287
+288	val_288
+288	val_288
+288	val_288
+288	val_288
+288	val_288
+288	val_288
+288	val_288
+288	val_288
+289	val_289
+291	val_291
+292	val_292
+296	val_296
+298	val_298
+298	val_298
+298	val_298
+298	val_298
+298	val_298
+298	val_298
+298	val_298
+298	val_298
+298	val_298
+298	val_298
+298	val_298
+298	val_298
+298	val_298
+298	val_298
+298	val_298
+298	val_298
+298	val_298
+298	val_298
+298	val_298
+298	val_298
+298	val_298
+298	val_298
+298	val_298
+298	val_298
+298	val_298
+298	val_298
+298	val_298
+30	val_30
+302	val_302
+305	val_305
+306	val_306
+307	val_307
+307	val_307
+307	val_307
+307	val_307
+307	val_307
+307	val_307
+307	val_307
+307	val_307
+308	val_308
+309	val_309
+309	val_309
+309	val_309
+309	val_309
+309	val_309
+309	val_309
+309	val_309
+309	val_309
+310	val_310
+311	val_311
+311	val_311
+311	val_311
+311	val_311
+311	val_311
+311	val_311
+311	val_311
+311	val_311
+311	val_311
+311	val_311
+311	val_311
+311	val_311
+311	val_311
+311	val_311
+311	val_311
+311	val_311
+311	val_311
+311	val_311
+311	val_311
+311	val_311
+311	val_311
+311	val_311
+311	val_311
+311	val_311
+311	val_311
+311	val_311
+311	val_311
+315	val_315
+316	val_316
+316	val_316
+316	val_316
+316	val_316
+316	val_316
+316	val_316
+316	val_316
+316	val_316
+316	val_316
+316	val_316
+316	val_316
+316	val_316
+316	val_316
+316	val_316
+316	val_316
+316	val_316
+316	val_316
+316	val_316
+316	val_316
+316	val_316
+316	val_316
+316	val_316
+316	val_316
+316	val_316
+316	val_316
+316	val_316
+316	val_316
+317	val_317
+317	val_317
+317	val_317
+317	val_317
+317	val_317
+317	val_317
+317	val_317
+317	val_317
+318	val_318
+318	val_318
+318	val_318
+318	val_318
+318	val_318
+318	val_318
+318	val_318
+318	val_318
+318	val_318
+318	val_318
+318	val_318
+318	val_318
+318	val_318
+318	val_318
+318	val_318
+318	val_318
+318	val_318
+318	val_318
+318	val_318
+318	val_318
+318	val_318
+318	val_318
+318	val_318
+318	val_318
+318	val_318
+318	val_318
+318	val_318
+321	val_321
+321	val_321
+321	val_321
+321	val_321
+321	val_321
+321	val_321
+321	val_321
+321	val_321
+322	val_322
+322	val_322
+322	val_322
+322	val_322
+322	val_322
+322	val_322
+322	val_322
+322	val_322
+323	val_323
+325	val_325
+325	val_325
+325	val_325
+325	val_325
+325	val_325
+325	val_325
+325	val_325
+325	val_325
+327	val_327
+327	val_327
+327	val_327
+327	val_327
+327	val_327
+327	val_327
+327	val_327
+327	val_327
+327	val_327
+327	val_327
+327	val_327
+327	val_327
+327	val_327
+327	val_327
+327	val_327
+327	val_327
+327	val_327
+327	val_327
+327	val_327
+327	val_327
+327	val_327
+327	val_327
+327	val_327
+327	val_327
+327	val_327
+327	val_327
+327	val_327
+33	val_33
+331	val_331
+331	val_331
+331	val_331
+331	val_331
+331	val_331
+331	val_331
+331	val_331
+331	val_331
+332	val_332
+333	val_333
+333	val_333
+333	val_333
+333	val_333
+333	val_333
+333	val_333
+333	val_333
+333	val_333
+335	val_335
+336	val_336
+338	val_338
+339	val_339
+34	val_34
+341	val_341
+342	val_342
+342	val_342
+342	val_342
+342	val_342
+342	val_342
+342	val_342
+342	val_342
+342	val_342
+344	val_344
+344	val_344
+344	val_344
+344	val_344
+344	val_344
+344	val_344
+344	val_344
+344	val_344
+345	val_345
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+351	val_351
+353	val_353
+353	val_353
+353	val_353
+353	val_353
+353	val_353
+353	val_353
+353	val_353
+353	val_353
+356	val_356
+360	val_360
+362	val_362
+364	val_364
+365	val_365
+366	val_366
+367	val_367
+367	val_367
+367	val_367
+367	val_367
+367	val_367
+367	val_367
+367	val_367
+367	val_367
+368	val_368
+369	val_369
+369	val_369
+369	val_369
+369	val_369
+369	val_369
+369	val_369
+369	val_369
+369	val_369
+369	val_369
+369	val_369
+369	val_369
+369	val_369
+369	val_369
+369	val_369
+369	val_369
+369	val_369
+369	val_369
+369	val_369
+369	val_369
+369	val_369
+369	val_369
+369	val_369
+369	val_369
+369	val_369
+369	val_369
+369	val_369
+369	val_369
+37	val_37
+37	val_37
+37	val_37
+37	val_37
+37	val_37
+37	val_37
+37	val_37
+37	val_37
+373	val_373
+374	val_374
+375	val_375
+377	val_377
+378	val_378
+379	val_379
+382	val_382
+382	val_382
+382	val_382
+382	val_382
+382	val_382
+382	val_382
+382	val_382
+382	val_382
+384	val_384
+384	val_384
+384	val_384
+384	val_384
+384	val_384
+384	val_384
+384	val_384
+384	val_384
+384	val_384
+384	val_384
+384	val_384
+384	val_384
+384	val_384
+384	val_384
+384	val_384
+384	val_384
+384	val_384
+384	val_384
+384	val_384
+384	val_384
+384	val_384
+384	val_384
+384	val_384
+384	val_384
+384	val_384
+384	val_384
+384	val_384
+386	val_386
+389	val_389
+392	val_392
+393	val_393
+394	val_394
+395	val_395
+395	val_395
+395	val_395
+395	val_395
+395	val_395
+395	val_395
+395	val_395
+395	val_395
+396	val_396
+396	val_396
+396	val_396
+396	val_396
+396	val_396
+396	val_396
+396	val_396
+396	val_396
+396	val_396
+396	val_396
+396	val_396
+396	val_396
+396	val_396
+396	val_396
+396	val_396
+396	val_396
+396	val_396
+396	val_396
+396	val_396
+396	val_396
+396	val_396
+396	val_396
+396	val_396
+396	val_396
+396	val_396
+396	val_396
+396	val_396
+397	val_397
+397	val_397
+397	val_397
+397	val_397
+397	val_397
+397	val_397
+397	val_397
+397	val_397
+399	val_399
+399	val_399
+399	val_399
+399	val_399
+399	val_399
+399	val_399
+399	val_399
+399	val_399
+PREHOOK: query: EXPLAIN
+SELECT src1.c1, src2.c4 
+FROM
+(SELECT src.key as c1, src.value as c2 from src where src.key <> '11' ) src1
+JOIN
+(SELECT src.key as c3, src.value as c4 from src where src.key <> '12' ) src2
+ON src1.c1 = src2.c3 AND src1.c1 < '400'
+JOIN
+(SELECT src.key as c5, src.value as c6 from src where src.key <> '13' ) src3
+ON src1.c1 = src3.c5
+WHERE src1.c1 > '0' and (src1.c2 <> 'val_500' or src1.c1 > '1') and (src2.c3 > '10' or src1.c1 <> '10') and (src2.c3 <> '4') and (src3.c5 <> '1')
+PREHOOK: type: QUERY
+POSTHOOK: query: EXPLAIN
+SELECT src1.c1, src2.c4 
+FROM
+(SELECT src.key as c1, src.value as c2 from src where src.key <> '11' ) src1
+JOIN
+(SELECT src.key as c3, src.value as c4 from src where src.key <> '12' ) src2
+ON src1.c1 = src2.c3 AND src1.c1 < '400'
+JOIN
+(SELECT src.key as c5, src.value as c6 from src where src.key <> '13' ) src3
+ON src1.c1 = src3.c5
+WHERE src1.c1 > '0' and (src1.c2 <> 'val_500' or src1.c1 > '1') and (src2.c3 > '10' or src1.c1 <> '10') and (src2.c3 <> '4') and (src3.c5 <> '1')
+POSTHOOK: type: QUERY
+ABSTRACT SYNTAX TREE:
+  (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_JOIN (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME src))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL src) key) c1) (TOK_SELEXPR (. (TOK_TABLE_OR_COL src) value) c2)) (TOK_WHERE (<> (. (TOK_TABLE_OR_COL src) key) '11')))) src1) (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME src))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL src) key) c3) (TOK_SELEXPR (. (TOK_TABLE_OR_COL src) value) c4)) (TOK_WHERE (<> (. (TOK_TABLE_OR_COL src) key) '12')))) src2) (AND (= (. (TOK_TABLE_OR_COL src1) c1) (. (TOK_TABLE_OR_COL src2) c3)) (< (. (TOK_TABLE_OR_COL src1) c1) '400'))) (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME src))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL src) key) c5) (TOK_SELEXPR (. (TOK_TABLE_OR_COL src) value) c6)) (TOK_WHERE (<> (. (TOK_TABLE_OR_COL src) key) '13')))) src3) (= (. (TOK_TABLE_OR_COL src1) c1) (. (TOK_TABLE_OR_COL src3) c5)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL src1) c1)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL src2) c4))) (TOK_WHERE (and (and (and (and (> (. (TOK_TABLE_OR_COL src1) c1) '0') (or (<> (. (TOK_TABLE_OR_COL src1) c2) 'val_500') (> (. (TOK_TABLE_OR_COL src1) c1) '1'))) (or (> (. (TOK_TABLE_OR_COL src2) c3) '10') (<> (. (TOK_TABLE_OR_COL src1) c1) '10'))) (<> (. (TOK_TABLE_OR_COL src2) c3) '4')) (<> (. (TOK_TABLE_OR_COL src3) c5) '1')))))
+
+STAGE DEPENDENCIES:
+  Stage-1 is a root stage
+  Stage-0 is a root stage
+
+STAGE PLANS:
+  Stage: Stage-1
+    Map Reduce
+      Alias -> Map Operator Tree:
+        src1:src 
+          TableScan
+            alias: src
+            Filter Operator
+              predicate:
+                  expr: (((key <> '11') and (key < '400')) and ((key > '0') and ((value <> 'val_500') or (key > '1'))))
+                  type: boolean
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: 0
+                  value expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col1
+                        type: string
+        src2:src 
+          TableScan
+            alias: src
+            Filter Operator
+              predicate:
+                  expr: ((key <> '12') and (key <> '4'))
+                  type: boolean
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: 1
+                  value expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col1
+                        type: string
+        src3:src 
+          TableScan
+            alias: src
+            Filter Operator
+              predicate:
+                  expr: ((key <> '13') and (key <> '1'))
+                  type: boolean
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                outputColumnNames: _col0
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: 2
+                  value expressions:
+                        expr: _col0
+                        type: string
+      Reduce Operator Tree:
+        Join Operator
+          condition map:
+               Inner Join 0 to 1
+               Inner Join 0 to 2
+          condition expressions:
+            0 {VALUE._col0} {VALUE._col1}
+            1 {VALUE._col0} {VALUE._col1}
+            2 {VALUE._col0}
+          handleSkewJoin: false
+          outputColumnNames: _col0, _col1, _col2, _col3, _col4
+          Filter Operator
+            predicate:
+                expr: (((((_col0 > '0') and ((_col1 <> 'val_500') or (_col0 > '1'))) and ((_col2 > '10') or (_col0 <> '10'))) and (_col2 <> '4')) and (_col4 <> '1'))
+                type: boolean
+            Select Operator
+              expressions:
+                    expr: _col0
+                    type: string
+                    expr: _col3
+                    type: string
+              outputColumnNames: _col0, _col1
+              File Output Operator
+                compressed: false
+                GlobalTableId: 0
+                table:
+                    input format: org.apache.hadoop.mapred.TextInputFormat
+                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+
+  Stage: Stage-0
+    Fetch Operator
+      limit: -1
+
+
+PREHOOK: query: SELECT src1.c1, src2.c4 
+FROM
+(SELECT src.key as c1, src.value as c2 from src where src.key <> '11' ) src1
+JOIN
+(SELECT src.key as c3, src.value as c4 from src where src.key <> '12' ) src2
+ON src1.c1 = src2.c3 AND src1.c1 < '400'
+JOIN
+(SELECT src.key as c5, src.value as c6 from src where src.key <> '13' ) src3
+ON src1.c1 = src3.c5
+WHERE src1.c1 > '0' and (src1.c2 <> 'val_500' or src1.c1 > '1') and (src2.c3 > '10' or src1.c1 <> '10') and (src2.c3 <> '4') and (src3.c5 <> '1')
+PREHOOK: type: QUERY
+PREHOOK: Input: default@src
+PREHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-25-20_069_5364583495609185769/-mr-10000
+POSTHOOK: query: SELECT src1.c1, src2.c4 
+FROM
+(SELECT src.key as c1, src.value as c2 from src where src.key <> '11' ) src1
+JOIN
+(SELECT src.key as c3, src.value as c4 from src where src.key <> '12' ) src2
+ON src1.c1 = src2.c3 AND src1.c1 < '400'
+JOIN
+(SELECT src.key as c5, src.value as c6 from src where src.key <> '13' ) src3
+ON src1.c1 = src3.c5
+WHERE src1.c1 > '0' and (src1.c2 <> 'val_500' or src1.c1 > '1') and (src2.c3 > '10' or src1.c1 <> '10') and (src2.c3 <> '4') and (src3.c5 <> '1')
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@src
+POSTHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-25-20_069_5364583495609185769/-mr-10000
 100	val_100
 100	val_100
 100	val_100
diff --git a/ql/src/test/results/clientpositive/ppd_multi_insert.q.out b/ql/src/test/results/clientpositive/ppd_multi_insert.q.out
index 2ecb7a78aa..ed0198901b 100644
--- a/ql/src/test/results/clientpositive/ppd_multi_insert.q.out
+++ b/ql/src/test/results/clientpositive/ppd_multi_insert.q.out
@@ -1315,3 +1315,1330 @@ val_498
 val_498
 val_498
 val_498
+PREHOOK: query: EXPLAIN
+FROM src a JOIN src b ON (a.key = b.key)
+INSERT OVERWRITE TABLE mi1 SELECT a.* WHERE a.key < 100
+INSERT OVERWRITE TABLE mi2 SELECT a.key, a.value WHERE a.key >= 100 and a.key < 200
+INSERT OVERWRITE TABLE mi3 PARTITION(ds='2008-04-08', hr='12') SELECT a.key WHERE a.key >= 200 and a.key < 300
+INSERT OVERWRITE DIRECTORY '../build/ql/test/data/warehouse/mi4.out' SELECT a.value WHERE a.key >= 300
+PREHOOK: type: QUERY
+POSTHOOK: query: EXPLAIN
+FROM src a JOIN src b ON (a.key = b.key)
+INSERT OVERWRITE TABLE mi1 SELECT a.* WHERE a.key < 100
+INSERT OVERWRITE TABLE mi2 SELECT a.key, a.value WHERE a.key >= 100 and a.key < 200
+INSERT OVERWRITE TABLE mi3 PARTITION(ds='2008-04-08', hr='12') SELECT a.key WHERE a.key >= 200 and a.key < 300
+INSERT OVERWRITE DIRECTORY '../build/ql/test/data/warehouse/mi4.out' SELECT a.value WHERE a.key >= 300
+POSTHOOK: type: QUERY
+POSTHOOK: Lineage: mi1.key EXPRESSION [(src)a.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: mi1.value SIMPLE [(src)a.FieldSchema(name:value, type:string, comment:default), ]
+POSTHOOK: Lineage: mi2.key EXPRESSION [(src)a.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: mi2.value SIMPLE [(src)a.FieldSchema(name:value, type:string, comment:default), ]
+POSTHOOK: Lineage: mi3 PARTITION(ds=2008-04-08,hr=12).key EXPRESSION [(src)a.FieldSchema(name:key, type:string, comment:default), ]
+ABSTRACT SYNTAX TREE:
+  (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_TABREF (TOK_TABNAME src) a) (TOK_TABREF (TOK_TABNAME src) b) (= (. (TOK_TABLE_OR_COL a) key) (. (TOK_TABLE_OR_COL b) key)))) (TOK_INSERT (TOK_DESTINATION (TOK_TAB (TOK_TABNAME mi1))) (TOK_SELECT (TOK_SELEXPR (TOK_ALLCOLREF (TOK_TABNAME a)))) (TOK_WHERE (< (. (TOK_TABLE_OR_COL a) key) 100))) (TOK_INSERT (TOK_DESTINATION (TOK_TAB (TOK_TABNAME mi2))) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL a) key)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL a) value))) (TOK_WHERE (and (>= (. (TOK_TABLE_OR_COL a) key) 100) (< (. (TOK_TABLE_OR_COL a) key) 200)))) (TOK_INSERT (TOK_DESTINATION (TOK_TAB (TOK_TABNAME mi3) (TOK_PARTSPEC (TOK_PARTVAL ds '2008-04-08') (TOK_PARTVAL hr '12')))) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL a) key))) (TOK_WHERE (and (>= (. (TOK_TABLE_OR_COL a) key) 200) (< (. (TOK_TABLE_OR_COL a) key) 300)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR '../build/ql/test/data/warehouse/mi4.out')) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL a) value))) (TOK_WHERE (>= (. (TOK_TABLE_OR_COL a) key) 300))))
+
+STAGE DEPENDENCIES:
+  Stage-4 is a root stage
+  Stage-0 depends on stages: Stage-4
+  Stage-5 depends on stages: Stage-0
+  Stage-1 depends on stages: Stage-4
+  Stage-6 depends on stages: Stage-1
+  Stage-2 depends on stages: Stage-4
+  Stage-7 depends on stages: Stage-2
+  Stage-3 depends on stages: Stage-4
+
+STAGE PLANS:
+  Stage: Stage-4
+    Map Reduce
+      Alias -> Map Operator Tree:
+        a 
+          TableScan
+            alias: a
+            Reduce Output Operator
+              key expressions:
+                    expr: key
+                    type: string
+              sort order: +
+              Map-reduce partition columns:
+                    expr: key
+                    type: string
+              tag: 0
+              value expressions:
+                    expr: key
+                    type: string
+                    expr: value
+                    type: string
+        b 
+          TableScan
+            alias: b
+            Reduce Output Operator
+              key expressions:
+                    expr: key
+                    type: string
+              sort order: +
+              Map-reduce partition columns:
+                    expr: key
+                    type: string
+              tag: 1
+      Reduce Operator Tree:
+        Join Operator
+          condition map:
+               Inner Join 0 to 1
+          condition expressions:
+            0 {VALUE._col0} {VALUE._col1}
+            1 
+          handleSkewJoin: false
+          outputColumnNames: _col0, _col1
+          Filter Operator
+            predicate:
+                expr: (_col0 < 100)
+                type: boolean
+            Select Operator
+              expressions:
+                    expr: _col0
+                    type: string
+                    expr: _col1
+                    type: string
+              outputColumnNames: _col0, _col1
+              Select Operator
+                expressions:
+                      expr: UDFToInteger(_col0)
+                      type: int
+                      expr: _col1
+                      type: string
+                outputColumnNames: _col0, _col1
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 1
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                      name: default.mi1
+          Filter Operator
+            predicate:
+                expr: ((_col0 >= 100) and (_col0 < 200))
+                type: boolean
+            Select Operator
+              expressions:
+                    expr: _col0
+                    type: string
+                    expr: _col1
+                    type: string
+              outputColumnNames: _col0, _col1
+              Select Operator
+                expressions:
+                      expr: UDFToInteger(_col0)
+                      type: int
+                      expr: _col1
+                      type: string
+                outputColumnNames: _col0, _col1
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 2
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                      name: default.mi2
+          Filter Operator
+            predicate:
+                expr: ((_col0 >= 200) and (_col0 < 300))
+                type: boolean
+            Select Operator
+              expressions:
+                    expr: _col0
+                    type: string
+              outputColumnNames: _col0
+              Select Operator
+                expressions:
+                      expr: UDFToInteger(_col0)
+                      type: int
+                outputColumnNames: _col0
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 3
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                      name: default.mi3
+          Filter Operator
+            predicate:
+                expr: (_col0 >= 300)
+                type: boolean
+            Select Operator
+              expressions:
+                    expr: _col1
+                    type: string
+              outputColumnNames: _col0
+              File Output Operator
+                compressed: false
+                GlobalTableId: 4
+                table:
+                    input format: org.apache.hadoop.mapred.TextInputFormat
+                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+
+  Stage: Stage-0
+    Move Operator
+      tables:
+          replace: true
+          table:
+              input format: org.apache.hadoop.mapred.TextInputFormat
+              output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+              serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+              name: default.mi1
+
+  Stage: Stage-5
+    Stats-Aggr Operator
+
+  Stage: Stage-1
+    Move Operator
+      tables:
+          replace: true
+          table:
+              input format: org.apache.hadoop.mapred.TextInputFormat
+              output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+              serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+              name: default.mi2
+
+  Stage: Stage-6
+    Stats-Aggr Operator
+
+  Stage: Stage-2
+    Move Operator
+      tables:
+          partition:
+            ds 2008-04-08
+            hr 12
+          replace: true
+          table:
+              input format: org.apache.hadoop.mapred.TextInputFormat
+              output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+              serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+              name: default.mi3
+
+  Stage: Stage-7
+    Stats-Aggr Operator
+
+  Stage: Stage-3
+    Move Operator
+      files:
+          hdfs directory: true
+          destination: ../build/ql/test/data/warehouse/mi4.out
+
+
+PREHOOK: query: FROM src a JOIN src b ON (a.key = b.key)
+INSERT OVERWRITE TABLE mi1 SELECT a.* WHERE a.key < 100
+INSERT OVERWRITE TABLE mi2 SELECT a.key, a.value WHERE a.key >= 100 and a.key < 200
+INSERT OVERWRITE TABLE mi3 PARTITION(ds='2008-04-08', hr='12') SELECT a.key WHERE a.key >= 200 and a.key < 300
+INSERT OVERWRITE DIRECTORY '../build/ql/test/data/warehouse/mi4.out' SELECT a.value WHERE a.key >= 300
+PREHOOK: type: QUERY
+PREHOOK: Input: default@src
+PREHOOK: Output: ../build/ql/test/data/warehouse/mi4.out
+PREHOOK: Output: default@mi1
+PREHOOK: Output: default@mi2
+PREHOOK: Output: default@mi3@ds=2008-04-08/hr=12
+POSTHOOK: query: FROM src a JOIN src b ON (a.key = b.key)
+INSERT OVERWRITE TABLE mi1 SELECT a.* WHERE a.key < 100
+INSERT OVERWRITE TABLE mi2 SELECT a.key, a.value WHERE a.key >= 100 and a.key < 200
+INSERT OVERWRITE TABLE mi3 PARTITION(ds='2008-04-08', hr='12') SELECT a.key WHERE a.key >= 200 and a.key < 300
+INSERT OVERWRITE DIRECTORY '../build/ql/test/data/warehouse/mi4.out' SELECT a.value WHERE a.key >= 300
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@src
+POSTHOOK: Output: ../build/ql/test/data/warehouse/mi4.out
+POSTHOOK: Output: default@mi1
+POSTHOOK: Output: default@mi2
+POSTHOOK: Output: default@mi3@ds=2008-04-08/hr=12
+POSTHOOK: Lineage: mi1.key EXPRESSION [(src)a.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: mi1.key EXPRESSION [(src)a.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: mi1.value SIMPLE [(src)a.FieldSchema(name:value, type:string, comment:default), ]
+POSTHOOK: Lineage: mi1.value SIMPLE [(src)a.FieldSchema(name:value, type:string, comment:default), ]
+POSTHOOK: Lineage: mi2.key EXPRESSION [(src)a.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: mi2.key EXPRESSION [(src)a.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: mi2.value SIMPLE [(src)a.FieldSchema(name:value, type:string, comment:default), ]
+POSTHOOK: Lineage: mi2.value SIMPLE [(src)a.FieldSchema(name:value, type:string, comment:default), ]
+POSTHOOK: Lineage: mi3 PARTITION(ds=2008-04-08,hr=12).key EXPRESSION [(src)a.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: mi3 PARTITION(ds=2008-04-08,hr=12).key EXPRESSION [(src)a.FieldSchema(name:key, type:string, comment:default), ]
+PREHOOK: query: SELECT mi1.* FROM mi1
+PREHOOK: type: QUERY
+PREHOOK: Input: default@mi1
+PREHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-28-03_345_2699966828518452446/-mr-10000
+POSTHOOK: query: SELECT mi1.* FROM mi1
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@mi1
+POSTHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-28-03_345_2699966828518452446/-mr-10000
+POSTHOOK: Lineage: mi1.key EXPRESSION [(src)a.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: mi1.key EXPRESSION [(src)a.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: mi1.value SIMPLE [(src)a.FieldSchema(name:value, type:string, comment:default), ]
+POSTHOOK: Lineage: mi1.value SIMPLE [(src)a.FieldSchema(name:value, type:string, comment:default), ]
+POSTHOOK: Lineage: mi2.key EXPRESSION [(src)a.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: mi2.key EXPRESSION [(src)a.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: mi2.value SIMPLE [(src)a.FieldSchema(name:value, type:string, comment:default), ]
+POSTHOOK: Lineage: mi2.value SIMPLE [(src)a.FieldSchema(name:value, type:string, comment:default), ]
+POSTHOOK: Lineage: mi3 PARTITION(ds=2008-04-08,hr=12).key EXPRESSION [(src)a.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: mi3 PARTITION(ds=2008-04-08,hr=12).key EXPRESSION [(src)a.FieldSchema(name:key, type:string, comment:default), ]
+0	val_0
+0	val_0
+0	val_0
+0	val_0
+0	val_0
+0	val_0
+0	val_0
+0	val_0
+0	val_0
+10	val_10
+11	val_11
+12	val_12
+12	val_12
+12	val_12
+12	val_12
+15	val_15
+15	val_15
+15	val_15
+15	val_15
+17	val_17
+18	val_18
+18	val_18
+18	val_18
+18	val_18
+19	val_19
+2	val_2
+20	val_20
+24	val_24
+24	val_24
+24	val_24
+24	val_24
+26	val_26
+26	val_26
+26	val_26
+26	val_26
+27	val_27
+28	val_28
+30	val_30
+33	val_33
+34	val_34
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+35	val_35
+37	val_37
+37	val_37
+37	val_37
+37	val_37
+4	val_4
+41	val_41
+42	val_42
+42	val_42
+42	val_42
+42	val_42
+43	val_43
+44	val_44
+47	val_47
+5	val_5
+5	val_5
+5	val_5
+5	val_5
+5	val_5
+5	val_5
+5	val_5
+5	val_5
+5	val_5
+51	val_51
+51	val_51
+51	val_51
+51	val_51
+53	val_53
+54	val_54
+57	val_57
+58	val_58
+58	val_58
+58	val_58
+58	val_58
+64	val_64
+65	val_65
+66	val_66
+67	val_67
+67	val_67
+67	val_67
+67	val_67
+69	val_69
+70	val_70
+70	val_70
+70	val_70
+70	val_70
+70	val_70
+70	val_70
+70	val_70
+70	val_70
+70	val_70
+72	val_72
+72	val_72
+72	val_72
+72	val_72
+74	val_74
+76	val_76
+76	val_76
+76	val_76
+76	val_76
+77	val_77
+78	val_78
+8	val_8
+80	val_80
+82	val_82
+83	val_83
+83	val_83
+83	val_83
+83	val_83
+84	val_84
+84	val_84
+84	val_84
+84	val_84
+85	val_85
+86	val_86
+87	val_87
+9	val_9
+90	val_90
+90	val_90
+90	val_90
+90	val_90
+90	val_90
+90	val_90
+90	val_90
+90	val_90
+90	val_90
+92	val_92
+95	val_95
+95	val_95
+95	val_95
+95	val_95
+96	val_96
+97	val_97
+97	val_97
+97	val_97
+97	val_97
+98	val_98
+98	val_98
+98	val_98
+98	val_98
+PREHOOK: query: SELECT mi2.* FROM mi2
+PREHOOK: type: QUERY
+PREHOOK: Input: default@mi2
+PREHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-28-03_677_3645923501369564199/-mr-10000
+POSTHOOK: query: SELECT mi2.* FROM mi2
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@mi2
+POSTHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-28-03_677_3645923501369564199/-mr-10000
+POSTHOOK: Lineage: mi1.key EXPRESSION [(src)a.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: mi1.key EXPRESSION [(src)a.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: mi1.value SIMPLE [(src)a.FieldSchema(name:value, type:string, comment:default), ]
+POSTHOOK: Lineage: mi1.value SIMPLE [(src)a.FieldSchema(name:value, type:string, comment:default), ]
+POSTHOOK: Lineage: mi2.key EXPRESSION [(src)a.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: mi2.key EXPRESSION [(src)a.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: mi2.value SIMPLE [(src)a.FieldSchema(name:value, type:string, comment:default), ]
+POSTHOOK: Lineage: mi2.value SIMPLE [(src)a.FieldSchema(name:value, type:string, comment:default), ]
+POSTHOOK: Lineage: mi3 PARTITION(ds=2008-04-08,hr=12).key EXPRESSION [(src)a.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: mi3 PARTITION(ds=2008-04-08,hr=12).key EXPRESSION [(src)a.FieldSchema(name:key, type:string, comment:default), ]
+100	val_100
+100	val_100
+100	val_100
+100	val_100
+103	val_103
+103	val_103
+103	val_103
+103	val_103
+104	val_104
+104	val_104
+104	val_104
+104	val_104
+105	val_105
+111	val_111
+113	val_113
+113	val_113
+113	val_113
+113	val_113
+114	val_114
+116	val_116
+118	val_118
+118	val_118
+118	val_118
+118	val_118
+119	val_119
+119	val_119
+119	val_119
+119	val_119
+119	val_119
+119	val_119
+119	val_119
+119	val_119
+119	val_119
+120	val_120
+120	val_120
+120	val_120
+120	val_120
+125	val_125
+125	val_125
+125	val_125
+125	val_125
+126	val_126
+128	val_128
+128	val_128
+128	val_128
+128	val_128
+128	val_128
+128	val_128
+128	val_128
+128	val_128
+128	val_128
+129	val_129
+129	val_129
+129	val_129
+129	val_129
+131	val_131
+133	val_133
+134	val_134
+134	val_134
+134	val_134
+134	val_134
+136	val_136
+137	val_137
+137	val_137
+137	val_137
+137	val_137
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+138	val_138
+143	val_143
+145	val_145
+146	val_146
+146	val_146
+146	val_146
+146	val_146
+149	val_149
+149	val_149
+149	val_149
+149	val_149
+150	val_150
+152	val_152
+152	val_152
+152	val_152
+152	val_152
+153	val_153
+155	val_155
+156	val_156
+157	val_157
+158	val_158
+160	val_160
+162	val_162
+163	val_163
+164	val_164
+164	val_164
+164	val_164
+164	val_164
+165	val_165
+165	val_165
+165	val_165
+165	val_165
+166	val_166
+167	val_167
+167	val_167
+167	val_167
+167	val_167
+167	val_167
+167	val_167
+167	val_167
+167	val_167
+167	val_167
+168	val_168
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+169	val_169
+170	val_170
+172	val_172
+172	val_172
+172	val_172
+172	val_172
+174	val_174
+174	val_174
+174	val_174
+174	val_174
+175	val_175
+175	val_175
+175	val_175
+175	val_175
+176	val_176
+176	val_176
+176	val_176
+176	val_176
+177	val_177
+178	val_178
+179	val_179
+179	val_179
+179	val_179
+179	val_179
+180	val_180
+181	val_181
+183	val_183
+186	val_186
+187	val_187
+187	val_187
+187	val_187
+187	val_187
+187	val_187
+187	val_187
+187	val_187
+187	val_187
+187	val_187
+189	val_189
+190	val_190
+191	val_191
+191	val_191
+191	val_191
+191	val_191
+192	val_192
+193	val_193
+193	val_193
+193	val_193
+193	val_193
+193	val_193
+193	val_193
+193	val_193
+193	val_193
+193	val_193
+194	val_194
+195	val_195
+195	val_195
+195	val_195
+195	val_195
+196	val_196
+197	val_197
+197	val_197
+197	val_197
+197	val_197
+199	val_199
+199	val_199
+199	val_199
+199	val_199
+199	val_199
+199	val_199
+199	val_199
+199	val_199
+199	val_199
+PREHOOK: query: SELECT mi3.* FROM mi3
+PREHOOK: type: QUERY
+PREHOOK: Input: default@mi3@ds=2008-04-08/hr=12
+PREHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-28-04_004_5001774654114388405/-mr-10000
+POSTHOOK: query: SELECT mi3.* FROM mi3
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@mi3@ds=2008-04-08/hr=12
+POSTHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-28-04_004_5001774654114388405/-mr-10000
+POSTHOOK: Lineage: mi1.key EXPRESSION [(src)a.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: mi1.key EXPRESSION [(src)a.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: mi1.value SIMPLE [(src)a.FieldSchema(name:value, type:string, comment:default), ]
+POSTHOOK: Lineage: mi1.value SIMPLE [(src)a.FieldSchema(name:value, type:string, comment:default), ]
+POSTHOOK: Lineage: mi2.key EXPRESSION [(src)a.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: mi2.key EXPRESSION [(src)a.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: mi2.value SIMPLE [(src)a.FieldSchema(name:value, type:string, comment:default), ]
+POSTHOOK: Lineage: mi2.value SIMPLE [(src)a.FieldSchema(name:value, type:string, comment:default), ]
+POSTHOOK: Lineage: mi3 PARTITION(ds=2008-04-08,hr=12).key EXPRESSION [(src)a.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: mi3 PARTITION(ds=2008-04-08,hr=12).key EXPRESSION [(src)a.FieldSchema(name:key, type:string, comment:default), ]
+200	2008-04-08	12
+200	2008-04-08	12
+200	2008-04-08	12
+200	2008-04-08	12
+201	2008-04-08	12
+202	2008-04-08	12
+203	2008-04-08	12
+203	2008-04-08	12
+203	2008-04-08	12
+203	2008-04-08	12
+205	2008-04-08	12
+205	2008-04-08	12
+205	2008-04-08	12
+205	2008-04-08	12
+207	2008-04-08	12
+207	2008-04-08	12
+207	2008-04-08	12
+207	2008-04-08	12
+208	2008-04-08	12
+208	2008-04-08	12
+208	2008-04-08	12
+208	2008-04-08	12
+208	2008-04-08	12
+208	2008-04-08	12
+208	2008-04-08	12
+208	2008-04-08	12
+208	2008-04-08	12
+209	2008-04-08	12
+209	2008-04-08	12
+209	2008-04-08	12
+209	2008-04-08	12
+213	2008-04-08	12
+213	2008-04-08	12
+213	2008-04-08	12
+213	2008-04-08	12
+214	2008-04-08	12
+216	2008-04-08	12
+216	2008-04-08	12
+216	2008-04-08	12
+216	2008-04-08	12
+217	2008-04-08	12
+217	2008-04-08	12
+217	2008-04-08	12
+217	2008-04-08	12
+218	2008-04-08	12
+219	2008-04-08	12
+219	2008-04-08	12
+219	2008-04-08	12
+219	2008-04-08	12
+221	2008-04-08	12
+221	2008-04-08	12
+221	2008-04-08	12
+221	2008-04-08	12
+222	2008-04-08	12
+223	2008-04-08	12
+223	2008-04-08	12
+223	2008-04-08	12
+223	2008-04-08	12
+224	2008-04-08	12
+224	2008-04-08	12
+224	2008-04-08	12
+224	2008-04-08	12
+226	2008-04-08	12
+228	2008-04-08	12
+229	2008-04-08	12
+229	2008-04-08	12
+229	2008-04-08	12
+229	2008-04-08	12
+230	2008-04-08	12
+230	2008-04-08	12
+230	2008-04-08	12
+230	2008-04-08	12
+230	2008-04-08	12
+230	2008-04-08	12
+230	2008-04-08	12
+230	2008-04-08	12
+230	2008-04-08	12
+230	2008-04-08	12
+230	2008-04-08	12
+230	2008-04-08	12
+230	2008-04-08	12
+230	2008-04-08	12
+230	2008-04-08	12
+230	2008-04-08	12
+230	2008-04-08	12
+230	2008-04-08	12
+230	2008-04-08	12
+230	2008-04-08	12
+230	2008-04-08	12
+230	2008-04-08	12
+230	2008-04-08	12
+230	2008-04-08	12
+230	2008-04-08	12
+233	2008-04-08	12
+233	2008-04-08	12
+233	2008-04-08	12
+233	2008-04-08	12
+235	2008-04-08	12
+237	2008-04-08	12
+237	2008-04-08	12
+237	2008-04-08	12
+237	2008-04-08	12
+238	2008-04-08	12
+238	2008-04-08	12
+238	2008-04-08	12
+238	2008-04-08	12
+239	2008-04-08	12
+239	2008-04-08	12
+239	2008-04-08	12
+239	2008-04-08	12
+241	2008-04-08	12
+242	2008-04-08	12
+242	2008-04-08	12
+242	2008-04-08	12
+242	2008-04-08	12
+244	2008-04-08	12
+247	2008-04-08	12
+248	2008-04-08	12
+249	2008-04-08	12
+252	2008-04-08	12
+255	2008-04-08	12
+255	2008-04-08	12
+255	2008-04-08	12
+255	2008-04-08	12
+256	2008-04-08	12
+256	2008-04-08	12
+256	2008-04-08	12
+256	2008-04-08	12
+257	2008-04-08	12
+258	2008-04-08	12
+260	2008-04-08	12
+262	2008-04-08	12
+263	2008-04-08	12
+265	2008-04-08	12
+265	2008-04-08	12
+265	2008-04-08	12
+265	2008-04-08	12
+266	2008-04-08	12
+272	2008-04-08	12
+272	2008-04-08	12
+272	2008-04-08	12
+272	2008-04-08	12
+273	2008-04-08	12
+273	2008-04-08	12
+273	2008-04-08	12
+273	2008-04-08	12
+273	2008-04-08	12
+273	2008-04-08	12
+273	2008-04-08	12
+273	2008-04-08	12
+273	2008-04-08	12
+274	2008-04-08	12
+275	2008-04-08	12
+277	2008-04-08	12
+277	2008-04-08	12
+277	2008-04-08	12
+277	2008-04-08	12
+277	2008-04-08	12
+277	2008-04-08	12
+277	2008-04-08	12
+277	2008-04-08	12
+277	2008-04-08	12
+277	2008-04-08	12
+277	2008-04-08	12
+277	2008-04-08	12
+277	2008-04-08	12
+277	2008-04-08	12
+277	2008-04-08	12
+277	2008-04-08	12
+278	2008-04-08	12
+278	2008-04-08	12
+278	2008-04-08	12
+278	2008-04-08	12
+280	2008-04-08	12
+280	2008-04-08	12
+280	2008-04-08	12
+280	2008-04-08	12
+281	2008-04-08	12
+281	2008-04-08	12
+281	2008-04-08	12
+281	2008-04-08	12
+282	2008-04-08	12
+282	2008-04-08	12
+282	2008-04-08	12
+282	2008-04-08	12
+283	2008-04-08	12
+284	2008-04-08	12
+285	2008-04-08	12
+286	2008-04-08	12
+287	2008-04-08	12
+288	2008-04-08	12
+288	2008-04-08	12
+288	2008-04-08	12
+288	2008-04-08	12
+289	2008-04-08	12
+291	2008-04-08	12
+292	2008-04-08	12
+296	2008-04-08	12
+298	2008-04-08	12
+298	2008-04-08	12
+298	2008-04-08	12
+298	2008-04-08	12
+298	2008-04-08	12
+298	2008-04-08	12
+298	2008-04-08	12
+298	2008-04-08	12
+298	2008-04-08	12
+val_302
+val_305
+val_306
+val_307
+val_307
+val_307
+val_307
+val_308
+val_309
+val_309
+val_309
+val_309
+val_310
+val_311
+val_311
+val_311
+val_311
+val_311
+val_311
+val_311
+val_311
+val_311
+val_315
+val_316
+val_316
+val_316
+val_316
+val_316
+val_316
+val_316
+val_316
+val_316
+val_317
+val_317
+val_317
+val_317
+val_318
+val_318
+val_318
+val_318
+val_318
+val_318
+val_318
+val_318
+val_318
+val_321
+val_321
+val_321
+val_321
+val_322
+val_322
+val_322
+val_322
+val_323
+val_325
+val_325
+val_325
+val_325
+val_327
+val_327
+val_327
+val_327
+val_327
+val_327
+val_327
+val_327
+val_327
+val_331
+val_331
+val_331
+val_331
+val_332
+val_333
+val_333
+val_333
+val_333
+val_335
+val_336
+val_338
+val_339
+val_341
+val_342
+val_342
+val_342
+val_342
+val_344
+val_344
+val_344
+val_344
+val_345
+val_348
+val_348
+val_348
+val_348
+val_348
+val_348
+val_348
+val_348
+val_348
+val_348
+val_348
+val_348
+val_348
+val_348
+val_348
+val_348
+val_348
+val_348
+val_348
+val_348
+val_348
+val_348
+val_348
+val_348
+val_348
+val_351
+val_353
+val_353
+val_353
+val_353
+val_356
+val_360
+val_362
+val_364
+val_365
+val_366
+val_367
+val_367
+val_367
+val_367
+val_368
+val_369
+val_369
+val_369
+val_369
+val_369
+val_369
+val_369
+val_369
+val_369
+val_373
+val_374
+val_375
+val_377
+val_378
+val_379
+val_382
+val_382
+val_382
+val_382
+val_384
+val_384
+val_384
+val_384
+val_384
+val_384
+val_384
+val_384
+val_384
+val_386
+val_389
+val_392
+val_393
+val_394
+val_395
+val_395
+val_395
+val_395
+val_396
+val_396
+val_396
+val_396
+val_396
+val_396
+val_396
+val_396
+val_396
+val_397
+val_397
+val_397
+val_397
+val_399
+val_399
+val_399
+val_399
+val_400
+val_401
+val_401
+val_401
+val_401
+val_401
+val_401
+val_401
+val_401
+val_401
+val_401
+val_401
+val_401
+val_401
+val_401
+val_401
+val_401
+val_401
+val_401
+val_401
+val_401
+val_401
+val_401
+val_401
+val_401
+val_401
+val_402
+val_403
+val_403
+val_403
+val_403
+val_403
+val_403
+val_403
+val_403
+val_403
+val_404
+val_404
+val_404
+val_404
+val_406
+val_406
+val_406
+val_406
+val_406
+val_406
+val_406
+val_406
+val_406
+val_406
+val_406
+val_406
+val_406
+val_406
+val_406
+val_406
+val_407
+val_409
+val_409
+val_409
+val_409
+val_409
+val_409
+val_409
+val_409
+val_409
+val_411
+val_413
+val_413
+val_413
+val_413
+val_414
+val_414
+val_414
+val_414
+val_417
+val_417
+val_417
+val_417
+val_417
+val_417
+val_417
+val_417
+val_417
+val_418
+val_419
+val_421
+val_424
+val_424
+val_424
+val_424
+val_427
+val_429
+val_429
+val_429
+val_429
+val_430
+val_430
+val_430
+val_430
+val_430
+val_430
+val_430
+val_430
+val_430
+val_431
+val_431
+val_431
+val_431
+val_431
+val_431
+val_431
+val_431
+val_431
+val_432
+val_435
+val_436
+val_437
+val_438
+val_438
+val_438
+val_438
+val_438
+val_438
+val_438
+val_438
+val_438
+val_439
+val_439
+val_439
+val_439
+val_443
+val_444
+val_446
+val_448
+val_449
+val_452
+val_453
+val_454
+val_454
+val_454
+val_454
+val_454
+val_454
+val_454
+val_454
+val_454
+val_455
+val_457
+val_458
+val_458
+val_458
+val_458
+val_459
+val_459
+val_459
+val_459
+val_460
+val_462
+val_462
+val_462
+val_462
+val_463
+val_463
+val_463
+val_463
+val_466
+val_466
+val_466
+val_466
+val_466
+val_466
+val_466
+val_466
+val_466
+val_467
+val_468
+val_468
+val_468
+val_468
+val_468
+val_468
+val_468
+val_468
+val_468
+val_468
+val_468
+val_468
+val_468
+val_468
+val_468
+val_468
+val_469
+val_469
+val_469
+val_469
+val_469
+val_469
+val_469
+val_469
+val_469
+val_469
+val_469
+val_469
+val_469
+val_469
+val_469
+val_469
+val_469
+val_469
+val_469
+val_469
+val_469
+val_469
+val_469
+val_469
+val_469
+val_470
+val_472
+val_475
+val_477
+val_478
+val_478
+val_478
+val_478
+val_479
+val_480
+val_480
+val_480
+val_480
+val_480
+val_480
+val_480
+val_480
+val_480
+val_481
+val_482
+val_483
+val_484
+val_485
+val_487
+val_489
+val_489
+val_489
+val_489
+val_489
+val_489
+val_489
+val_489
+val_489
+val_489
+val_489
+val_489
+val_489
+val_489
+val_489
+val_489
+val_490
+val_491
+val_492
+val_492
+val_492
+val_492
+val_493
+val_494
+val_495
+val_496
+val_497
+val_498
+val_498
+val_498
+val_498
+val_498
+val_498
+val_498
+val_498
+val_498
diff --git a/ql/src/test/results/clientpositive/ppd_outer_join1.q.out b/ql/src/test/results/clientpositive/ppd_outer_join1.q.out
index 701fcf2015..673d9d619e 100644
--- a/ql/src/test/results/clientpositive/ppd_outer_join1.q.out
+++ b/ql/src/test/results/clientpositive/ppd_outer_join1.q.out
@@ -110,7 +110,7 @@ PREHOOK: query: FROM
  WHERE a.key > 10 AND a.key < 20 AND b.key > 15 AND b.key < 25
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
-PREHOOK: Output: file:/tmp/sdong/hive_2011-02-10_16-57-14_648_6362739881959261544/-mr-10000
+PREHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-30-10_517_1449004673525932594/-mr-10000
 POSTHOOK: query: FROM 
   src a
  LEFT OUTER JOIN 
@@ -120,7 +120,136 @@ POSTHOOK: query: FROM
  WHERE a.key > 10 AND a.key < 20 AND b.key > 15 AND b.key < 25
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
-POSTHOOK: Output: file:/tmp/sdong/hive_2011-02-10_16-57-14_648_6362739881959261544/-mr-10000
+POSTHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-30-10_517_1449004673525932594/-mr-10000
+17	val_17	17	val_17
+18	val_18	18	val_18
+18	val_18	18	val_18
+18	val_18	18	val_18
+18	val_18	18	val_18
+19	val_19	19	val_19
+PREHOOK: query: EXPLAIN
+ FROM 
+  src a
+ LEFT OUTER JOIN 
+  src b 
+ ON (a.key = b.key)
+ SELECT a.key, a.value, b.key, b.value
+ WHERE a.key > 10 AND a.key < 20 AND b.key > 15 AND b.key < 25
+PREHOOK: type: QUERY
+POSTHOOK: query: EXPLAIN
+ FROM 
+  src a
+ LEFT OUTER JOIN 
+  src b 
+ ON (a.key = b.key)
+ SELECT a.key, a.value, b.key, b.value
+ WHERE a.key > 10 AND a.key < 20 AND b.key > 15 AND b.key < 25
+POSTHOOK: type: QUERY
+ABSTRACT SYNTAX TREE:
+  (TOK_QUERY (TOK_FROM (TOK_LEFTOUTERJOIN (TOK_TABREF (TOK_TABNAME src) a) (TOK_TABREF (TOK_TABNAME src) b) (= (. (TOK_TABLE_OR_COL a) key) (. (TOK_TABLE_OR_COL b) key)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL a) key)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL a) value)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL b) key)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL b) value))) (TOK_WHERE (AND (AND (AND (> (. (TOK_TABLE_OR_COL a) key) 10) (< (. (TOK_TABLE_OR_COL a) key) 20)) (> (. (TOK_TABLE_OR_COL b) key) 15)) (< (. (TOK_TABLE_OR_COL b) key) 25)))))
+
+STAGE DEPENDENCIES:
+  Stage-1 is a root stage
+  Stage-0 is a root stage
+
+STAGE PLANS:
+  Stage: Stage-1
+    Map Reduce
+      Alias -> Map Operator Tree:
+        a 
+          TableScan
+            alias: a
+            Filter Operator
+              predicate:
+                  expr: ((key > 10) and (key < 20))
+                  type: boolean
+              Reduce Output Operator
+                key expressions:
+                      expr: key
+                      type: string
+                sort order: +
+                Map-reduce partition columns:
+                      expr: key
+                      type: string
+                tag: 0
+                value expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+        b 
+          TableScan
+            alias: b
+            Reduce Output Operator
+              key expressions:
+                    expr: key
+                    type: string
+              sort order: +
+              Map-reduce partition columns:
+                    expr: key
+                    type: string
+              tag: 1
+              value expressions:
+                    expr: key
+                    type: string
+                    expr: value
+                    type: string
+      Reduce Operator Tree:
+        Join Operator
+          condition map:
+               Left Outer Join0 to 1
+          condition expressions:
+            0 {VALUE._col0} {VALUE._col1}
+            1 {VALUE._col0} {VALUE._col1}
+          handleSkewJoin: false
+          outputColumnNames: _col0, _col1, _col4, _col5
+          Filter Operator
+            predicate:
+                expr: ((_col4 > 15) and (_col4 < 25))
+                type: boolean
+            Select Operator
+              expressions:
+                    expr: _col0
+                    type: string
+                    expr: _col1
+                    type: string
+                    expr: _col4
+                    type: string
+                    expr: _col5
+                    type: string
+              outputColumnNames: _col0, _col1, _col2, _col3
+              File Output Operator
+                compressed: false
+                GlobalTableId: 0
+                table:
+                    input format: org.apache.hadoop.mapred.TextInputFormat
+                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+
+  Stage: Stage-0
+    Fetch Operator
+      limit: -1
+
+
+PREHOOK: query: FROM 
+  src a
+ LEFT OUTER JOIN 
+  src b 
+ ON (a.key = b.key)
+ SELECT a.key, a.value, b.key, b.value
+ WHERE a.key > 10 AND a.key < 20 AND b.key > 15 AND b.key < 25
+PREHOOK: type: QUERY
+PREHOOK: Input: default@src
+PREHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-30-20_062_1274880924259137309/-mr-10000
+POSTHOOK: query: FROM 
+  src a
+ LEFT OUTER JOIN 
+  src b 
+ ON (a.key = b.key)
+ SELECT a.key, a.value, b.key, b.value
+ WHERE a.key > 10 AND a.key < 20 AND b.key > 15 AND b.key < 25
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@src
+POSTHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-30-20_062_1274880924259137309/-mr-10000
 17	val_17	17	val_17
 18	val_18	18	val_18
 18	val_18	18	val_18
diff --git a/ql/src/test/results/clientpositive/ppd_outer_join2.q.out b/ql/src/test/results/clientpositive/ppd_outer_join2.q.out
index 37fde7326b..c01edfa134 100644
--- a/ql/src/test/results/clientpositive/ppd_outer_join2.q.out
+++ b/ql/src/test/results/clientpositive/ppd_outer_join2.q.out
@@ -110,7 +110,7 @@ PREHOOK: query: FROM
  WHERE a.key > '10' AND a.key < '20' AND b.key > '15' AND b.key < '25'
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
-PREHOOK: Output: file:/tmp/sdong/hive_2011-02-10_16-57-18_662_1007936007610334670/-mr-10000
+PREHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-32-34_464_515670423172601583/-mr-10000
 POSTHOOK: query: FROM 
   src a
  RIGHT OUTER JOIN 
@@ -120,7 +120,256 @@ POSTHOOK: query: FROM
  WHERE a.key > '10' AND a.key < '20' AND b.key > '15' AND b.key < '25'
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
-POSTHOOK: Output: file:/tmp/sdong/hive_2011-02-10_16-57-18_662_1007936007610334670/-mr-10000
+POSTHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-32-34_464_515670423172601583/-mr-10000
+150	val_150	150	val_150
+152	val_152	152	val_152
+152	val_152	152	val_152
+152	val_152	152	val_152
+152	val_152	152	val_152
+153	val_153	153	val_153
+155	val_155	155	val_155
+156	val_156	156	val_156
+157	val_157	157	val_157
+158	val_158	158	val_158
+160	val_160	160	val_160
+162	val_162	162	val_162
+163	val_163	163	val_163
+164	val_164	164	val_164
+164	val_164	164	val_164
+164	val_164	164	val_164
+164	val_164	164	val_164
+165	val_165	165	val_165
+165	val_165	165	val_165
+165	val_165	165	val_165
+165	val_165	165	val_165
+166	val_166	166	val_166
+167	val_167	167	val_167
+167	val_167	167	val_167
+167	val_167	167	val_167
+167	val_167	167	val_167
+167	val_167	167	val_167
+167	val_167	167	val_167
+167	val_167	167	val_167
+167	val_167	167	val_167
+167	val_167	167	val_167
+168	val_168	168	val_168
+169	val_169	169	val_169
+169	val_169	169	val_169
+169	val_169	169	val_169
+169	val_169	169	val_169
+169	val_169	169	val_169
+169	val_169	169	val_169
+169	val_169	169	val_169
+169	val_169	169	val_169
+169	val_169	169	val_169
+169	val_169	169	val_169
+169	val_169	169	val_169
+169	val_169	169	val_169
+169	val_169	169	val_169
+169	val_169	169	val_169
+169	val_169	169	val_169
+169	val_169	169	val_169
+17	val_17	17	val_17
+170	val_170	170	val_170
+172	val_172	172	val_172
+172	val_172	172	val_172
+172	val_172	172	val_172
+172	val_172	172	val_172
+174	val_174	174	val_174
+174	val_174	174	val_174
+174	val_174	174	val_174
+174	val_174	174	val_174
+175	val_175	175	val_175
+175	val_175	175	val_175
+175	val_175	175	val_175
+175	val_175	175	val_175
+176	val_176	176	val_176
+176	val_176	176	val_176
+176	val_176	176	val_176
+176	val_176	176	val_176
+177	val_177	177	val_177
+178	val_178	178	val_178
+179	val_179	179	val_179
+179	val_179	179	val_179
+179	val_179	179	val_179
+179	val_179	179	val_179
+18	val_18	18	val_18
+18	val_18	18	val_18
+18	val_18	18	val_18
+18	val_18	18	val_18
+180	val_180	180	val_180
+181	val_181	181	val_181
+183	val_183	183	val_183
+186	val_186	186	val_186
+187	val_187	187	val_187
+187	val_187	187	val_187
+187	val_187	187	val_187
+187	val_187	187	val_187
+187	val_187	187	val_187
+187	val_187	187	val_187
+187	val_187	187	val_187
+187	val_187	187	val_187
+187	val_187	187	val_187
+189	val_189	189	val_189
+19	val_19	19	val_19
+190	val_190	190	val_190
+191	val_191	191	val_191
+191	val_191	191	val_191
+191	val_191	191	val_191
+191	val_191	191	val_191
+192	val_192	192	val_192
+193	val_193	193	val_193
+193	val_193	193	val_193
+193	val_193	193	val_193
+193	val_193	193	val_193
+193	val_193	193	val_193
+193	val_193	193	val_193
+193	val_193	193	val_193
+193	val_193	193	val_193
+193	val_193	193	val_193
+194	val_194	194	val_194
+195	val_195	195	val_195
+195	val_195	195	val_195
+195	val_195	195	val_195
+195	val_195	195	val_195
+196	val_196	196	val_196
+197	val_197	197	val_197
+197	val_197	197	val_197
+197	val_197	197	val_197
+197	val_197	197	val_197
+199	val_199	199	val_199
+199	val_199	199	val_199
+199	val_199	199	val_199
+199	val_199	199	val_199
+199	val_199	199	val_199
+199	val_199	199	val_199
+199	val_199	199	val_199
+199	val_199	199	val_199
+199	val_199	199	val_199
+2	val_2	2	val_2
+PREHOOK: query: EXPLAIN
+ FROM 
+  src a
+ RIGHT OUTER JOIN 
+  src b 
+ ON (a.key = b.key)
+ SELECT a.key, a.value, b.key, b.value
+ WHERE a.key > '10' AND a.key < '20' AND b.key > '15' AND b.key < '25'
+PREHOOK: type: QUERY
+POSTHOOK: query: EXPLAIN
+ FROM 
+  src a
+ RIGHT OUTER JOIN 
+  src b 
+ ON (a.key = b.key)
+ SELECT a.key, a.value, b.key, b.value
+ WHERE a.key > '10' AND a.key < '20' AND b.key > '15' AND b.key < '25'
+POSTHOOK: type: QUERY
+ABSTRACT SYNTAX TREE:
+  (TOK_QUERY (TOK_FROM (TOK_RIGHTOUTERJOIN (TOK_TABREF (TOK_TABNAME src) a) (TOK_TABREF (TOK_TABNAME src) b) (= (. (TOK_TABLE_OR_COL a) key) (. (TOK_TABLE_OR_COL b) key)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL a) key)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL a) value)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL b) key)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL b) value))) (TOK_WHERE (AND (AND (AND (> (. (TOK_TABLE_OR_COL a) key) '10') (< (. (TOK_TABLE_OR_COL a) key) '20')) (> (. (TOK_TABLE_OR_COL b) key) '15')) (< (. (TOK_TABLE_OR_COL b) key) '25')))))
+
+STAGE DEPENDENCIES:
+  Stage-1 is a root stage
+  Stage-0 is a root stage
+
+STAGE PLANS:
+  Stage: Stage-1
+    Map Reduce
+      Alias -> Map Operator Tree:
+        a 
+          TableScan
+            alias: a
+            Reduce Output Operator
+              key expressions:
+                    expr: key
+                    type: string
+              sort order: +
+              Map-reduce partition columns:
+                    expr: key
+                    type: string
+              tag: 0
+              value expressions:
+                    expr: key
+                    type: string
+                    expr: value
+                    type: string
+        b 
+          TableScan
+            alias: b
+            Filter Operator
+              predicate:
+                  expr: ((key > '15') and (key < '25'))
+                  type: boolean
+              Reduce Output Operator
+                key expressions:
+                      expr: key
+                      type: string
+                sort order: +
+                Map-reduce partition columns:
+                      expr: key
+                      type: string
+                tag: 1
+                value expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+      Reduce Operator Tree:
+        Join Operator
+          condition map:
+               Right Outer Join0 to 1
+          condition expressions:
+            0 {VALUE._col0} {VALUE._col1}
+            1 {VALUE._col0} {VALUE._col1}
+          handleSkewJoin: false
+          outputColumnNames: _col0, _col1, _col4, _col5
+          Filter Operator
+            predicate:
+                expr: ((_col0 > '10') and (_col0 < '20'))
+                type: boolean
+            Select Operator
+              expressions:
+                    expr: _col0
+                    type: string
+                    expr: _col1
+                    type: string
+                    expr: _col4
+                    type: string
+                    expr: _col5
+                    type: string
+              outputColumnNames: _col0, _col1, _col2, _col3
+              File Output Operator
+                compressed: false
+                GlobalTableId: 0
+                table:
+                    input format: org.apache.hadoop.mapred.TextInputFormat
+                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+
+  Stage: Stage-0
+    Fetch Operator
+      limit: -1
+
+
+PREHOOK: query: FROM 
+  src a
+ RIGHT OUTER JOIN 
+  src b 
+ ON (a.key = b.key)
+ SELECT a.key, a.value, b.key, b.value
+ WHERE a.key > '10' AND a.key < '20' AND b.key > '15' AND b.key < '25'
+PREHOOK: type: QUERY
+PREHOOK: Input: default@src
+PREHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-32-44_509_6575656481631571931/-mr-10000
+POSTHOOK: query: FROM 
+  src a
+ RIGHT OUTER JOIN 
+  src b 
+ ON (a.key = b.key)
+ SELECT a.key, a.value, b.key, b.value
+ WHERE a.key > '10' AND a.key < '20' AND b.key > '15' AND b.key < '25'
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@src
+POSTHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-32-44_509_6575656481631571931/-mr-10000
 150	val_150	150	val_150
 152	val_152	152	val_152
 152	val_152	152	val_152
diff --git a/ql/src/test/results/clientpositive/ppd_outer_join3.q.out b/ql/src/test/results/clientpositive/ppd_outer_join3.q.out
index 52a8c02ffd..1909fbf757 100644
--- a/ql/src/test/results/clientpositive/ppd_outer_join3.q.out
+++ b/ql/src/test/results/clientpositive/ppd_outer_join3.q.out
@@ -106,7 +106,7 @@ PREHOOK: query: FROM
  WHERE a.key > '10' AND a.key < '20' AND b.key > '15' AND b.key < '25'
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
-PREHOOK: Output: file:/tmp/sdong/hive_2011-02-10_16-57-22_895_2367881874317279593/-mr-10000
+PREHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-35-23_324_1018503791576708396/-mr-10000
 POSTHOOK: query: FROM 
   src a
  FULL OUTER JOIN 
@@ -116,7 +116,252 @@ POSTHOOK: query: FROM
  WHERE a.key > '10' AND a.key < '20' AND b.key > '15' AND b.key < '25'
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
-POSTHOOK: Output: file:/tmp/sdong/hive_2011-02-10_16-57-22_895_2367881874317279593/-mr-10000
+POSTHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-35-23_324_1018503791576708396/-mr-10000
+150	val_150	150	val_150
+152	val_152	152	val_152
+152	val_152	152	val_152
+152	val_152	152	val_152
+152	val_152	152	val_152
+153	val_153	153	val_153
+155	val_155	155	val_155
+156	val_156	156	val_156
+157	val_157	157	val_157
+158	val_158	158	val_158
+160	val_160	160	val_160
+162	val_162	162	val_162
+163	val_163	163	val_163
+164	val_164	164	val_164
+164	val_164	164	val_164
+164	val_164	164	val_164
+164	val_164	164	val_164
+165	val_165	165	val_165
+165	val_165	165	val_165
+165	val_165	165	val_165
+165	val_165	165	val_165
+166	val_166	166	val_166
+167	val_167	167	val_167
+167	val_167	167	val_167
+167	val_167	167	val_167
+167	val_167	167	val_167
+167	val_167	167	val_167
+167	val_167	167	val_167
+167	val_167	167	val_167
+167	val_167	167	val_167
+167	val_167	167	val_167
+168	val_168	168	val_168
+169	val_169	169	val_169
+169	val_169	169	val_169
+169	val_169	169	val_169
+169	val_169	169	val_169
+169	val_169	169	val_169
+169	val_169	169	val_169
+169	val_169	169	val_169
+169	val_169	169	val_169
+169	val_169	169	val_169
+169	val_169	169	val_169
+169	val_169	169	val_169
+169	val_169	169	val_169
+169	val_169	169	val_169
+169	val_169	169	val_169
+169	val_169	169	val_169
+169	val_169	169	val_169
+17	val_17	17	val_17
+170	val_170	170	val_170
+172	val_172	172	val_172
+172	val_172	172	val_172
+172	val_172	172	val_172
+172	val_172	172	val_172
+174	val_174	174	val_174
+174	val_174	174	val_174
+174	val_174	174	val_174
+174	val_174	174	val_174
+175	val_175	175	val_175
+175	val_175	175	val_175
+175	val_175	175	val_175
+175	val_175	175	val_175
+176	val_176	176	val_176
+176	val_176	176	val_176
+176	val_176	176	val_176
+176	val_176	176	val_176
+177	val_177	177	val_177
+178	val_178	178	val_178
+179	val_179	179	val_179
+179	val_179	179	val_179
+179	val_179	179	val_179
+179	val_179	179	val_179
+18	val_18	18	val_18
+18	val_18	18	val_18
+18	val_18	18	val_18
+18	val_18	18	val_18
+180	val_180	180	val_180
+181	val_181	181	val_181
+183	val_183	183	val_183
+186	val_186	186	val_186
+187	val_187	187	val_187
+187	val_187	187	val_187
+187	val_187	187	val_187
+187	val_187	187	val_187
+187	val_187	187	val_187
+187	val_187	187	val_187
+187	val_187	187	val_187
+187	val_187	187	val_187
+187	val_187	187	val_187
+189	val_189	189	val_189
+19	val_19	19	val_19
+190	val_190	190	val_190
+191	val_191	191	val_191
+191	val_191	191	val_191
+191	val_191	191	val_191
+191	val_191	191	val_191
+192	val_192	192	val_192
+193	val_193	193	val_193
+193	val_193	193	val_193
+193	val_193	193	val_193
+193	val_193	193	val_193
+193	val_193	193	val_193
+193	val_193	193	val_193
+193	val_193	193	val_193
+193	val_193	193	val_193
+193	val_193	193	val_193
+194	val_194	194	val_194
+195	val_195	195	val_195
+195	val_195	195	val_195
+195	val_195	195	val_195
+195	val_195	195	val_195
+196	val_196	196	val_196
+197	val_197	197	val_197
+197	val_197	197	val_197
+197	val_197	197	val_197
+197	val_197	197	val_197
+199	val_199	199	val_199
+199	val_199	199	val_199
+199	val_199	199	val_199
+199	val_199	199	val_199
+199	val_199	199	val_199
+199	val_199	199	val_199
+199	val_199	199	val_199
+199	val_199	199	val_199
+199	val_199	199	val_199
+2	val_2	2	val_2
+PREHOOK: query: EXPLAIN
+ FROM 
+  src a
+ FULL OUTER JOIN 
+  src b 
+ ON (a.key = b.key)
+ SELECT a.key, a.value, b.key, b.value
+ WHERE a.key > '10' AND a.key < '20' AND b.key > '15' AND b.key < '25'
+PREHOOK: type: QUERY
+POSTHOOK: query: EXPLAIN
+ FROM 
+  src a
+ FULL OUTER JOIN 
+  src b 
+ ON (a.key = b.key)
+ SELECT a.key, a.value, b.key, b.value
+ WHERE a.key > '10' AND a.key < '20' AND b.key > '15' AND b.key < '25'
+POSTHOOK: type: QUERY
+ABSTRACT SYNTAX TREE:
+  (TOK_QUERY (TOK_FROM (TOK_FULLOUTERJOIN (TOK_TABREF (TOK_TABNAME src) a) (TOK_TABREF (TOK_TABNAME src) b) (= (. (TOK_TABLE_OR_COL a) key) (. (TOK_TABLE_OR_COL b) key)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL a) key)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL a) value)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL b) key)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL b) value))) (TOK_WHERE (AND (AND (AND (> (. (TOK_TABLE_OR_COL a) key) '10') (< (. (TOK_TABLE_OR_COL a) key) '20')) (> (. (TOK_TABLE_OR_COL b) key) '15')) (< (. (TOK_TABLE_OR_COL b) key) '25')))))
+
+STAGE DEPENDENCIES:
+  Stage-1 is a root stage
+  Stage-0 is a root stage
+
+STAGE PLANS:
+  Stage: Stage-1
+    Map Reduce
+      Alias -> Map Operator Tree:
+        a 
+          TableScan
+            alias: a
+            Reduce Output Operator
+              key expressions:
+                    expr: key
+                    type: string
+              sort order: +
+              Map-reduce partition columns:
+                    expr: key
+                    type: string
+              tag: 0
+              value expressions:
+                    expr: key
+                    type: string
+                    expr: value
+                    type: string
+        b 
+          TableScan
+            alias: b
+            Reduce Output Operator
+              key expressions:
+                    expr: key
+                    type: string
+              sort order: +
+              Map-reduce partition columns:
+                    expr: key
+                    type: string
+              tag: 1
+              value expressions:
+                    expr: key
+                    type: string
+                    expr: value
+                    type: string
+      Reduce Operator Tree:
+        Join Operator
+          condition map:
+               Outer Join 0 to 1
+          condition expressions:
+            0 {VALUE._col0} {VALUE._col1}
+            1 {VALUE._col0} {VALUE._col1}
+          handleSkewJoin: false
+          outputColumnNames: _col0, _col1, _col4, _col5
+          Filter Operator
+            predicate:
+                expr: (((_col4 > '15') and (_col4 < '25')) and ((_col0 > '10') and (_col0 < '20')))
+                type: boolean
+            Select Operator
+              expressions:
+                    expr: _col0
+                    type: string
+                    expr: _col1
+                    type: string
+                    expr: _col4
+                    type: string
+                    expr: _col5
+                    type: string
+              outputColumnNames: _col0, _col1, _col2, _col3
+              File Output Operator
+                compressed: false
+                GlobalTableId: 0
+                table:
+                    input format: org.apache.hadoop.mapred.TextInputFormat
+                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+
+  Stage: Stage-0
+    Fetch Operator
+      limit: -1
+
+
+PREHOOK: query: FROM 
+  src a
+ FULL OUTER JOIN 
+  src b 
+ ON (a.key = b.key)
+ SELECT a.key, a.value, b.key, b.value
+ WHERE a.key > '10' AND a.key < '20' AND b.key > '15' AND b.key < '25'
+PREHOOK: type: QUERY
+PREHOOK: Input: default@src
+PREHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-35-35_138_6944101774390059493/-mr-10000
+POSTHOOK: query: FROM 
+  src a
+ FULL OUTER JOIN 
+  src b 
+ ON (a.key = b.key)
+ SELECT a.key, a.value, b.key, b.value
+ WHERE a.key > '10' AND a.key < '20' AND b.key > '15' AND b.key < '25'
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@src
+POSTHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-35-35_138_6944101774390059493/-mr-10000
 150	val_150	150	val_150
 152	val_152	152	val_152
 152	val_152	152	val_152
diff --git a/ql/src/test/results/clientpositive/ppd_outer_join4.q.out b/ql/src/test/results/clientpositive/ppd_outer_join4.q.out
index 3d2e1d41a2..99183866c4 100644
--- a/ql/src/test/results/clientpositive/ppd_outer_join4.q.out
+++ b/ql/src/test/results/clientpositive/ppd_outer_join4.q.out
@@ -134,7 +134,7 @@ PREHOOK: query: FROM
  WHERE a.key > '10' AND a.key < '20' AND b.key > '15' AND b.key < '25' AND sqrt(c.key) <> 13
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
-PREHOOK: Output: file:/tmp/sdong/hive_2011-02-10_16-57-26_835_1439714224998684331/-mr-10000
+PREHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-38-11_041_8830294243573092446/-mr-10000
 POSTHOOK: query: FROM 
   src a
  LEFT OUTER JOIN
@@ -147,7 +147,387 @@ POSTHOOK: query: FROM
  WHERE a.key > '10' AND a.key < '20' AND b.key > '15' AND b.key < '25' AND sqrt(c.key) <> 13
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
-POSTHOOK: Output: file:/tmp/sdong/hive_2011-02-10_16-57-26_835_1439714224998684331/-mr-10000
+POSTHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-38-11_041_8830294243573092446/-mr-10000
+150	val_150	150	val_150	150
+152	val_152	152	val_152	152
+152	val_152	152	val_152	152
+152	val_152	152	val_152	152
+152	val_152	152	val_152	152
+152	val_152	152	val_152	152
+152	val_152	152	val_152	152
+152	val_152	152	val_152	152
+152	val_152	152	val_152	152
+153	val_153	153	val_153	153
+155	val_155	155	val_155	155
+156	val_156	156	val_156	156
+157	val_157	157	val_157	157
+158	val_158	158	val_158	158
+160	val_160	160	val_160	160
+162	val_162	162	val_162	162
+163	val_163	163	val_163	163
+164	val_164	164	val_164	164
+164	val_164	164	val_164	164
+164	val_164	164	val_164	164
+164	val_164	164	val_164	164
+164	val_164	164	val_164	164
+164	val_164	164	val_164	164
+164	val_164	164	val_164	164
+164	val_164	164	val_164	164
+165	val_165	165	val_165	165
+165	val_165	165	val_165	165
+165	val_165	165	val_165	165
+165	val_165	165	val_165	165
+165	val_165	165	val_165	165
+165	val_165	165	val_165	165
+165	val_165	165	val_165	165
+165	val_165	165	val_165	165
+166	val_166	166	val_166	166
+167	val_167	167	val_167	167
+167	val_167	167	val_167	167
+167	val_167	167	val_167	167
+167	val_167	167	val_167	167
+167	val_167	167	val_167	167
+167	val_167	167	val_167	167
+167	val_167	167	val_167	167
+167	val_167	167	val_167	167
+167	val_167	167	val_167	167
+167	val_167	167	val_167	167
+167	val_167	167	val_167	167
+167	val_167	167	val_167	167
+167	val_167	167	val_167	167
+167	val_167	167	val_167	167
+167	val_167	167	val_167	167
+167	val_167	167	val_167	167
+167	val_167	167	val_167	167
+167	val_167	167	val_167	167
+167	val_167	167	val_167	167
+167	val_167	167	val_167	167
+167	val_167	167	val_167	167
+167	val_167	167	val_167	167
+167	val_167	167	val_167	167
+167	val_167	167	val_167	167
+167	val_167	167	val_167	167
+167	val_167	167	val_167	167
+167	val_167	167	val_167	167
+168	val_168	168	val_168	168
+17	val_17	17	val_17	17
+170	val_170	170	val_170	170
+172	val_172	172	val_172	172
+172	val_172	172	val_172	172
+172	val_172	172	val_172	172
+172	val_172	172	val_172	172
+172	val_172	172	val_172	172
+172	val_172	172	val_172	172
+172	val_172	172	val_172	172
+172	val_172	172	val_172	172
+174	val_174	174	val_174	174
+174	val_174	174	val_174	174
+174	val_174	174	val_174	174
+174	val_174	174	val_174	174
+174	val_174	174	val_174	174
+174	val_174	174	val_174	174
+174	val_174	174	val_174	174
+174	val_174	174	val_174	174
+175	val_175	175	val_175	175
+175	val_175	175	val_175	175
+175	val_175	175	val_175	175
+175	val_175	175	val_175	175
+175	val_175	175	val_175	175
+175	val_175	175	val_175	175
+175	val_175	175	val_175	175
+175	val_175	175	val_175	175
+176	val_176	176	val_176	176
+176	val_176	176	val_176	176
+176	val_176	176	val_176	176
+176	val_176	176	val_176	176
+176	val_176	176	val_176	176
+176	val_176	176	val_176	176
+176	val_176	176	val_176	176
+176	val_176	176	val_176	176
+177	val_177	177	val_177	177
+178	val_178	178	val_178	178
+179	val_179	179	val_179	179
+179	val_179	179	val_179	179
+179	val_179	179	val_179	179
+179	val_179	179	val_179	179
+179	val_179	179	val_179	179
+179	val_179	179	val_179	179
+179	val_179	179	val_179	179
+179	val_179	179	val_179	179
+18	val_18	18	val_18	18
+18	val_18	18	val_18	18
+18	val_18	18	val_18	18
+18	val_18	18	val_18	18
+18	val_18	18	val_18	18
+18	val_18	18	val_18	18
+18	val_18	18	val_18	18
+18	val_18	18	val_18	18
+180	val_180	180	val_180	180
+181	val_181	181	val_181	181
+183	val_183	183	val_183	183
+186	val_186	186	val_186	186
+187	val_187	187	val_187	187
+187	val_187	187	val_187	187
+187	val_187	187	val_187	187
+187	val_187	187	val_187	187
+187	val_187	187	val_187	187
+187	val_187	187	val_187	187
+187	val_187	187	val_187	187
+187	val_187	187	val_187	187
+187	val_187	187	val_187	187
+187	val_187	187	val_187	187
+187	val_187	187	val_187	187
+187	val_187	187	val_187	187
+187	val_187	187	val_187	187
+187	val_187	187	val_187	187
+187	val_187	187	val_187	187
+187	val_187	187	val_187	187
+187	val_187	187	val_187	187
+187	val_187	187	val_187	187
+187	val_187	187	val_187	187
+187	val_187	187	val_187	187
+187	val_187	187	val_187	187
+187	val_187	187	val_187	187
+187	val_187	187	val_187	187
+187	val_187	187	val_187	187
+187	val_187	187	val_187	187
+187	val_187	187	val_187	187
+187	val_187	187	val_187	187
+189	val_189	189	val_189	189
+19	val_19	19	val_19	19
+190	val_190	190	val_190	190
+191	val_191	191	val_191	191
+191	val_191	191	val_191	191
+191	val_191	191	val_191	191
+191	val_191	191	val_191	191
+191	val_191	191	val_191	191
+191	val_191	191	val_191	191
+191	val_191	191	val_191	191
+191	val_191	191	val_191	191
+192	val_192	192	val_192	192
+193	val_193	193	val_193	193
+193	val_193	193	val_193	193
+193	val_193	193	val_193	193
+193	val_193	193	val_193	193
+193	val_193	193	val_193	193
+193	val_193	193	val_193	193
+193	val_193	193	val_193	193
+193	val_193	193	val_193	193
+193	val_193	193	val_193	193
+193	val_193	193	val_193	193
+193	val_193	193	val_193	193
+193	val_193	193	val_193	193
+193	val_193	193	val_193	193
+193	val_193	193	val_193	193
+193	val_193	193	val_193	193
+193	val_193	193	val_193	193
+193	val_193	193	val_193	193
+193	val_193	193	val_193	193
+193	val_193	193	val_193	193
+193	val_193	193	val_193	193
+193	val_193	193	val_193	193
+193	val_193	193	val_193	193
+193	val_193	193	val_193	193
+193	val_193	193	val_193	193
+193	val_193	193	val_193	193
+193	val_193	193	val_193	193
+193	val_193	193	val_193	193
+194	val_194	194	val_194	194
+195	val_195	195	val_195	195
+195	val_195	195	val_195	195
+195	val_195	195	val_195	195
+195	val_195	195	val_195	195
+195	val_195	195	val_195	195
+195	val_195	195	val_195	195
+195	val_195	195	val_195	195
+195	val_195	195	val_195	195
+196	val_196	196	val_196	196
+197	val_197	197	val_197	197
+197	val_197	197	val_197	197
+197	val_197	197	val_197	197
+197	val_197	197	val_197	197
+197	val_197	197	val_197	197
+197	val_197	197	val_197	197
+197	val_197	197	val_197	197
+197	val_197	197	val_197	197
+199	val_199	199	val_199	199
+199	val_199	199	val_199	199
+199	val_199	199	val_199	199
+199	val_199	199	val_199	199
+199	val_199	199	val_199	199
+199	val_199	199	val_199	199
+199	val_199	199	val_199	199
+199	val_199	199	val_199	199
+199	val_199	199	val_199	199
+199	val_199	199	val_199	199
+199	val_199	199	val_199	199
+199	val_199	199	val_199	199
+199	val_199	199	val_199	199
+199	val_199	199	val_199	199
+199	val_199	199	val_199	199
+199	val_199	199	val_199	199
+199	val_199	199	val_199	199
+199	val_199	199	val_199	199
+199	val_199	199	val_199	199
+199	val_199	199	val_199	199
+199	val_199	199	val_199	199
+199	val_199	199	val_199	199
+199	val_199	199	val_199	199
+199	val_199	199	val_199	199
+199	val_199	199	val_199	199
+199	val_199	199	val_199	199
+199	val_199	199	val_199	199
+2	val_2	2	val_2	2
+PREHOOK: query: EXPLAIN
+ FROM 
+  src a
+ LEFT OUTER JOIN
+  src b
+ ON (a.key = b.key)
+ RIGHT OUTER JOIN 
+  src c 
+ ON (a.key = c.key)
+ SELECT a.key, a.value, b.key, b.value, c.key
+ WHERE a.key > '10' AND a.key < '20' AND b.key > '15' AND b.key < '25' AND sqrt(c.key) <> 13
+PREHOOK: type: QUERY
+POSTHOOK: query: EXPLAIN
+ FROM 
+  src a
+ LEFT OUTER JOIN
+  src b
+ ON (a.key = b.key)
+ RIGHT OUTER JOIN 
+  src c 
+ ON (a.key = c.key)
+ SELECT a.key, a.value, b.key, b.value, c.key
+ WHERE a.key > '10' AND a.key < '20' AND b.key > '15' AND b.key < '25' AND sqrt(c.key) <> 13
+POSTHOOK: type: QUERY
+ABSTRACT SYNTAX TREE:
+  (TOK_QUERY (TOK_FROM (TOK_RIGHTOUTERJOIN (TOK_LEFTOUTERJOIN (TOK_TABREF (TOK_TABNAME src) a) (TOK_TABREF (TOK_TABNAME src) b) (= (. (TOK_TABLE_OR_COL a) key) (. (TOK_TABLE_OR_COL b) key))) (TOK_TABREF (TOK_TABNAME src) c) (= (. (TOK_TABLE_OR_COL a) key) (. (TOK_TABLE_OR_COL c) key)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL a) key)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL a) value)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL b) key)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL b) value)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL c) key))) (TOK_WHERE (AND (AND (AND (AND (> (. (TOK_TABLE_OR_COL a) key) '10') (< (. (TOK_TABLE_OR_COL a) key) '20')) (> (. (TOK_TABLE_OR_COL b) key) '15')) (< (. (TOK_TABLE_OR_COL b) key) '25')) (<> (TOK_FUNCTION sqrt (. (TOK_TABLE_OR_COL c) key)) 13)))))
+
+STAGE DEPENDENCIES:
+  Stage-1 is a root stage
+  Stage-0 is a root stage
+
+STAGE PLANS:
+  Stage: Stage-1
+    Map Reduce
+      Alias -> Map Operator Tree:
+        a 
+          TableScan
+            alias: a
+            Reduce Output Operator
+              key expressions:
+                    expr: key
+                    type: string
+              sort order: +
+              Map-reduce partition columns:
+                    expr: key
+                    type: string
+              tag: 0
+              value expressions:
+                    expr: key
+                    type: string
+                    expr: value
+                    type: string
+        b 
+          TableScan
+            alias: b
+            Reduce Output Operator
+              key expressions:
+                    expr: key
+                    type: string
+              sort order: +
+              Map-reduce partition columns:
+                    expr: key
+                    type: string
+              tag: 1
+              value expressions:
+                    expr: key
+                    type: string
+                    expr: value
+                    type: string
+        c 
+          TableScan
+            alias: c
+            Reduce Output Operator
+              key expressions:
+                    expr: key
+                    type: string
+              sort order: +
+              Map-reduce partition columns:
+                    expr: key
+                    type: string
+              tag: 2
+              value expressions:
+                    expr: key
+                    type: string
+      Reduce Operator Tree:
+        Join Operator
+          condition map:
+               Left Outer Join0 to 1
+               Right Outer Join0 to 2
+          condition expressions:
+            0 {VALUE._col0} {VALUE._col1}
+            1 {VALUE._col0} {VALUE._col1}
+            2 {VALUE._col0}
+          handleSkewJoin: false
+          outputColumnNames: _col0, _col1, _col4, _col5, _col8
+          Filter Operator
+            predicate:
+                expr: ((((_col4 > '15') and (_col4 < '25')) and (sqrt(_col8) <> 13)) and ((_col0 > '10') and (_col0 < '20')))
+                type: boolean
+            Select Operator
+              expressions:
+                    expr: _col0
+                    type: string
+                    expr: _col1
+                    type: string
+                    expr: _col4
+                    type: string
+                    expr: _col5
+                    type: string
+                    expr: _col8
+                    type: string
+              outputColumnNames: _col0, _col1, _col2, _col3, _col4
+              File Output Operator
+                compressed: false
+                GlobalTableId: 0
+                table:
+                    input format: org.apache.hadoop.mapred.TextInputFormat
+                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+
+  Stage: Stage-0
+    Fetch Operator
+      limit: -1
+
+
+PREHOOK: query: FROM 
+  src a
+ LEFT OUTER JOIN
+  src b
+ ON (a.key = b.key)
+ RIGHT OUTER JOIN 
+  src c 
+ ON (a.key = c.key)
+ SELECT a.key, a.value, b.key, b.value, c.key
+ WHERE a.key > '10' AND a.key < '20' AND b.key > '15' AND b.key < '25' AND sqrt(c.key) <> 13
+PREHOOK: type: QUERY
+PREHOOK: Input: default@src
+PREHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-38-20_602_416360783321217123/-mr-10000
+POSTHOOK: query: FROM 
+  src a
+ LEFT OUTER JOIN
+  src b
+ ON (a.key = b.key)
+ RIGHT OUTER JOIN 
+  src c 
+ ON (a.key = c.key)
+ SELECT a.key, a.value, b.key, b.value, c.key
+ WHERE a.key > '10' AND a.key < '20' AND b.key > '15' AND b.key < '25' AND sqrt(c.key) <> 13
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@src
+POSTHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-38-20_602_416360783321217123/-mr-10000
 150	val_150	150	val_150	150
 152	val_152	152	val_152	152
 152	val_152	152	val_152	152
diff --git a/ql/src/test/results/clientpositive/ppd_random.q.out b/ql/src/test/results/clientpositive/ppd_random.q.out
index e8ede4307e..de2af2008c 100644
--- a/ql/src/test/results/clientpositive/ppd_random.q.out
+++ b/ql/src/test/results/clientpositive/ppd_random.q.out
@@ -109,3 +109,110 @@ STAGE PLANS:
       limit: -1
 
 
+PREHOOK: query: EXPLAIN
+SELECT src1.c1, src2.c4 
+FROM
+(SELECT src.key as c1, src.value as c2 from src ) src1
+JOIN
+(SELECT src.key as c3, src.value as c4 from src where src.key > '2' ) src2
+ON src1.c1 = src2.c3
+WHERE rand() > 0.5
+PREHOOK: type: QUERY
+POSTHOOK: query: EXPLAIN
+SELECT src1.c1, src2.c4 
+FROM
+(SELECT src.key as c1, src.value as c2 from src ) src1
+JOIN
+(SELECT src.key as c3, src.value as c4 from src where src.key > '2' ) src2
+ON src1.c1 = src2.c3
+WHERE rand() > 0.5
+POSTHOOK: type: QUERY
+ABSTRACT SYNTAX TREE:
+  (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME src))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL src) key) c1) (TOK_SELEXPR (. (TOK_TABLE_OR_COL src) value) c2)))) src1) (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME src))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL src) key) c3) (TOK_SELEXPR (. (TOK_TABLE_OR_COL src) value) c4)) (TOK_WHERE (> (. (TOK_TABLE_OR_COL src) key) '2')))) src2) (= (. (TOK_TABLE_OR_COL src1) c1) (. (TOK_TABLE_OR_COL src2) c3)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL src1) c1)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL src2) c4))) (TOK_WHERE (> (TOK_FUNCTION rand) 0.5))))
+
+STAGE DEPENDENCIES:
+  Stage-1 is a root stage
+  Stage-0 is a root stage
+
+STAGE PLANS:
+  Stage: Stage-1
+    Map Reduce
+      Alias -> Map Operator Tree:
+        src1:src 
+          TableScan
+            alias: src
+            Select Operator
+              expressions:
+                    expr: key
+                    type: string
+              outputColumnNames: _col0
+              Reduce Output Operator
+                key expressions:
+                      expr: _col0
+                      type: string
+                sort order: +
+                Map-reduce partition columns:
+                      expr: _col0
+                      type: string
+                tag: 0
+                value expressions:
+                      expr: _col0
+                      type: string
+        src2:src 
+          TableScan
+            alias: src
+            Filter Operator
+              predicate:
+                  expr: (key > '2')
+                  type: boolean
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: 1
+                  value expressions:
+                        expr: _col1
+                        type: string
+      Reduce Operator Tree:
+        Join Operator
+          condition map:
+               Inner Join 0 to 1
+          condition expressions:
+            0 {VALUE._col0}
+            1 {VALUE._col1}
+          handleSkewJoin: false
+          outputColumnNames: _col0, _col3
+          Filter Operator
+            predicate:
+                expr: (rand() > 0.5)
+                type: boolean
+            Select Operator
+              expressions:
+                    expr: _col0
+                    type: string
+                    expr: _col3
+                    type: string
+              outputColumnNames: _col0, _col1
+              File Output Operator
+                compressed: false
+                GlobalTableId: 0
+                table:
+                    input format: org.apache.hadoop.mapred.TextInputFormat
+                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+
+  Stage: Stage-0
+    Fetch Operator
+      limit: -1
+
+
diff --git a/ql/src/test/results/clientpositive/ppd_transform.q.out b/ql/src/test/results/clientpositive/ppd_transform.q.out
index 59454d743c..c6ffc0921c 100644
--- a/ql/src/test/results/clientpositive/ppd_transform.q.out
+++ b/ql/src/test/results/clientpositive/ppd_transform.q.out
@@ -90,7 +90,7 @@ PREHOOK: query: FROM (
 SELECT tmap.tkey, tmap.tvalue WHERE tmap.tkey < 100
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
-PREHOOK: Output: file:/tmp/sdong/hive_2011-02-10_16-57-31_072_8845907404314698533/-mr-10000
+PREHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-50-56_212_3129782761910965240/-mr-10000
 POSTHOOK: query: FROM (
   FROM src
   SELECT TRANSFORM(src.key, src.value)
@@ -100,7 +100,194 @@ POSTHOOK: query: FROM (
 SELECT tmap.tkey, tmap.tvalue WHERE tmap.tkey < 100
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
-POSTHOOK: Output: file:/tmp/sdong/hive_2011-02-10_16-57-31_072_8845907404314698533/-mr-10000
+POSTHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-50-56_212_3129782761910965240/-mr-10000
+0	val_0
+0	val_0
+0	val_0
+10	val_10
+11	val_11
+12	val_12
+12	val_12
+15	val_15
+15	val_15
+17	val_17
+18	val_18
+18	val_18
+19	val_19
+2	val_2
+20	val_20
+24	val_24
+24	val_24
+26	val_26
+26	val_26
+27	val_27
+28	val_28
+30	val_30
+33	val_33
+34	val_34
+35	val_35
+35	val_35
+35	val_35
+37	val_37
+37	val_37
+4	val_4
+41	val_41
+42	val_42
+42	val_42
+43	val_43
+44	val_44
+47	val_47
+5	val_5
+5	val_5
+5	val_5
+51	val_51
+51	val_51
+53	val_53
+54	val_54
+57	val_57
+58	val_58
+58	val_58
+64	val_64
+65	val_65
+66	val_66
+67	val_67
+67	val_67
+69	val_69
+70	val_70
+70	val_70
+70	val_70
+72	val_72
+72	val_72
+74	val_74
+76	val_76
+76	val_76
+77	val_77
+78	val_78
+8	val_8
+80	val_80
+82	val_82
+83	val_83
+83	val_83
+84	val_84
+84	val_84
+85	val_85
+86	val_86
+87	val_87
+9	val_9
+90	val_90
+90	val_90
+90	val_90
+92	val_92
+95	val_95
+95	val_95
+96	val_96
+97	val_97
+97	val_97
+98	val_98
+98	val_98
+PREHOOK: query: EXPLAIN
+FROM (
+  FROM src
+  SELECT TRANSFORM(src.key, src.value)
+         USING '/bin/cat' AS (tkey, tvalue) 
+  CLUSTER BY tkey 
+) tmap
+SELECT tmap.tkey, tmap.tvalue WHERE tmap.tkey < 100
+PREHOOK: type: QUERY
+POSTHOOK: query: EXPLAIN
+FROM (
+  FROM src
+  SELECT TRANSFORM(src.key, src.value)
+         USING '/bin/cat' AS (tkey, tvalue) 
+  CLUSTER BY tkey 
+) tmap
+SELECT tmap.tkey, tmap.tvalue WHERE tmap.tkey < 100
+POSTHOOK: type: QUERY
+ABSTRACT SYNTAX TREE:
+  (TOK_QUERY (TOK_FROM (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME src))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TRANSFORM (TOK_EXPLIST (. (TOK_TABLE_OR_COL src) key) (. (TOK_TABLE_OR_COL src) value)) TOK_SERDE TOK_RECORDWRITER '/bin/cat' TOK_SERDE TOK_RECORDREADER (TOK_ALIASLIST tkey tvalue)))) (TOK_CLUSTERBY (TOK_TABLE_OR_COL tkey)))) tmap)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL tmap) tkey)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL tmap) tvalue))) (TOK_WHERE (< (. (TOK_TABLE_OR_COL tmap) tkey) 100))))
+
+STAGE DEPENDENCIES:
+  Stage-1 is a root stage
+  Stage-0 is a root stage
+
+STAGE PLANS:
+  Stage: Stage-1
+    Map Reduce
+      Alias -> Map Operator Tree:
+        tmap:src 
+          TableScan
+            alias: src
+            Select Operator
+              expressions:
+                    expr: key
+                    type: string
+                    expr: value
+                    type: string
+              outputColumnNames: _col0, _col1
+              Transform Operator
+                command: /bin/cat
+                output info:
+                    input format: org.apache.hadoop.mapred.TextInputFormat
+                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                Filter Operator
+                  predicate:
+                      expr: (_col0 < 100)
+                      type: boolean
+                  Reduce Output Operator
+                    key expressions:
+                          expr: _col0
+                          type: string
+                    sort order: +
+                    Map-reduce partition columns:
+                          expr: _col0
+                          type: string
+                    tag: -1
+                    value expressions:
+                          expr: _col0
+                          type: string
+                          expr: _col1
+                          type: string
+      Reduce Operator Tree:
+        Extract
+          Select Operator
+            expressions:
+                  expr: _col0
+                  type: string
+                  expr: _col1
+                  type: string
+            outputColumnNames: _col0, _col1
+            File Output Operator
+              compressed: false
+              GlobalTableId: 0
+              table:
+                  input format: org.apache.hadoop.mapred.TextInputFormat
+                  output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+
+  Stage: Stage-0
+    Fetch Operator
+      limit: -1
+
+
+PREHOOK: query: FROM (
+  FROM src
+  SELECT TRANSFORM(src.key, src.value)
+         USING '/bin/cat' AS (tkey, tvalue) 
+  CLUSTER BY tkey 
+) tmap
+SELECT tmap.tkey, tmap.tvalue WHERE tmap.tkey < 100
+PREHOOK: type: QUERY
+PREHOOK: Input: default@src
+PREHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-51-05_287_665431322083364408/-mr-10000
+POSTHOOK: query: FROM (
+  FROM src
+  SELECT TRANSFORM(src.key, src.value)
+         USING '/bin/cat' AS (tkey, tvalue) 
+  CLUSTER BY tkey 
+) tmap
+SELECT tmap.tkey, tmap.tvalue WHERE tmap.tkey < 100
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@src
+POSTHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-51-05_287_665431322083364408/-mr-10000
 0	val_0
 0	val_0
 0	val_0
diff --git a/ql/src/test/results/clientpositive/ppd_udf_case.q.out b/ql/src/test/results/clientpositive/ppd_udf_case.q.out
index 5c9da54999..2226514943 100644
--- a/ql/src/test/results/clientpositive/ppd_udf_case.q.out
+++ b/ql/src/test/results/clientpositive/ppd_udf_case.q.out
@@ -124,7 +124,7 @@ STAGE PLANS:
   Stage: Stage-2
     Map Reduce
       Alias -> Map Operator Tree:
-        file:/tmp/sdong/hive_2011-02-10_16-57-34_795_6886645259044041600/-mr-10002 
+        file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-53-19_011_6078693060764998539/-mr-10002 
             Reduce Output Operator
               key expressions:
                     expr: _col0
@@ -190,7 +190,7 @@ ORDER BY a.key, a.value, a.ds, a.hr, b.key, b.value, b.ds, b.hr
 PREHOOK: type: QUERY
 PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
-PREHOOK: Output: file:/tmp/sdong/hive_2011-02-10_16-57-34_974_8461060314707067318/-mr-10000
+PREHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-53-20_085_7457265695938103038/-mr-10000
 POSTHOOK: query: SELECT *
 FROM srcpart a JOIN srcpart b
 ON a.key = b.key
@@ -205,7 +205,215 @@ ORDER BY a.key, a.value, a.ds, a.hr, b.key, b.value, b.ds, b.hr
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
-POSTHOOK: Output: file:/tmp/sdong/hive_2011-02-10_16-57-34_974_8461060314707067318/-mr-10000
+POSTHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-53-20_085_7457265695938103038/-mr-10000
+27	val_27	2008-04-08	11	27	val_27	2008-04-08	11
+27	val_27	2008-04-08	11	27	val_27	2008-04-08	12
+27	val_27	2008-04-08	12	27	val_27	2008-04-08	11
+27	val_27	2008-04-08	12	27	val_27	2008-04-08	12
+PREHOOK: query: EXPLAIN
+SELECT *
+FROM srcpart a JOIN srcpart b
+ON a.key = b.key
+WHERE a.ds = '2008-04-08' AND
+      b.ds = '2008-04-08' AND
+      CASE a.key
+        WHEN '27' THEN TRUE
+        WHEN '38' THEN FALSE
+        ELSE NULL
+       END
+ORDER BY a.key, a.value, a.ds, a.hr, b.key, b.value, b.ds, b.hr
+PREHOOK: type: QUERY
+POSTHOOK: query: EXPLAIN
+SELECT *
+FROM srcpart a JOIN srcpart b
+ON a.key = b.key
+WHERE a.ds = '2008-04-08' AND
+      b.ds = '2008-04-08' AND
+      CASE a.key
+        WHEN '27' THEN TRUE
+        WHEN '38' THEN FALSE
+        ELSE NULL
+       END
+ORDER BY a.key, a.value, a.ds, a.hr, b.key, b.value, b.ds, b.hr
+POSTHOOK: type: QUERY
+ABSTRACT SYNTAX TREE:
+  (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_TABREF (TOK_TABNAME srcpart) a) (TOK_TABREF (TOK_TABNAME srcpart) b) (= (. (TOK_TABLE_OR_COL a) key) (. (TOK_TABLE_OR_COL b) key)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR TOK_ALLCOLREF)) (TOK_WHERE (AND (AND (= (. (TOK_TABLE_OR_COL a) ds) '2008-04-08') (= (. (TOK_TABLE_OR_COL b) ds) '2008-04-08')) (TOK_FUNCTION CASE (. (TOK_TABLE_OR_COL a) key) '27' TRUE '38' FALSE TOK_NULL))) (TOK_ORDERBY (TOK_TABSORTCOLNAMEASC (. (TOK_TABLE_OR_COL a) key)) (TOK_TABSORTCOLNAMEASC (. (TOK_TABLE_OR_COL a) value)) (TOK_TABSORTCOLNAMEASC (. (TOK_TABLE_OR_COL a) ds)) (TOK_TABSORTCOLNAMEASC (. (TOK_TABLE_OR_COL a) hr)) (TOK_TABSORTCOLNAMEASC (. (TOK_TABLE_OR_COL b) key)) (TOK_TABSORTCOLNAMEASC (. (TOK_TABLE_OR_COL b) value)) (TOK_TABSORTCOLNAMEASC (. (TOK_TABLE_OR_COL b) ds)) (TOK_TABSORTCOLNAMEASC (. (TOK_TABLE_OR_COL b) hr)))))
+
+STAGE DEPENDENCIES:
+  Stage-1 is a root stage
+  Stage-2 depends on stages: Stage-1
+  Stage-0 is a root stage
+
+STAGE PLANS:
+  Stage: Stage-1
+    Map Reduce
+      Alias -> Map Operator Tree:
+        a 
+          TableScan
+            alias: a
+            Filter Operator
+              predicate:
+                  expr: CASE (key) WHEN ('27') THEN (true) WHEN ('38') THEN (false) ELSE (null) END
+                  type: boolean
+              Reduce Output Operator
+                key expressions:
+                      expr: key
+                      type: string
+                sort order: +
+                Map-reduce partition columns:
+                      expr: key
+                      type: string
+                tag: 0
+                value expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                      expr: ds
+                      type: string
+                      expr: hr
+                      type: string
+        b 
+          TableScan
+            alias: b
+            Reduce Output Operator
+              key expressions:
+                    expr: key
+                    type: string
+              sort order: +
+              Map-reduce partition columns:
+                    expr: key
+                    type: string
+              tag: 1
+              value expressions:
+                    expr: key
+                    type: string
+                    expr: value
+                    type: string
+                    expr: ds
+                    type: string
+                    expr: hr
+                    type: string
+      Reduce Operator Tree:
+        Join Operator
+          condition map:
+               Inner Join 0 to 1
+          condition expressions:
+            0 {VALUE._col0} {VALUE._col1} {VALUE._col2} {VALUE._col3}
+            1 {VALUE._col0} {VALUE._col1} {VALUE._col2} {VALUE._col3}
+          handleSkewJoin: false
+          outputColumnNames: _col0, _col1, _col2, _col3, _col6, _col7, _col8, _col9
+          Select Operator
+            expressions:
+                  expr: _col0
+                  type: string
+                  expr: _col1
+                  type: string
+                  expr: _col2
+                  type: string
+                  expr: _col3
+                  type: string
+                  expr: _col6
+                  type: string
+                  expr: _col7
+                  type: string
+                  expr: _col8
+                  type: string
+                  expr: _col9
+                  type: string
+            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
+            File Output Operator
+              compressed: false
+              GlobalTableId: 0
+              table:
+                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+
+  Stage: Stage-2
+    Map Reduce
+      Alias -> Map Operator Tree:
+        file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-53-40_322_7654615073140246084/-mr-10002 
+            Reduce Output Operator
+              key expressions:
+                    expr: _col0
+                    type: string
+                    expr: _col1
+                    type: string
+                    expr: _col2
+                    type: string
+                    expr: _col3
+                    type: string
+                    expr: _col4
+                    type: string
+                    expr: _col5
+                    type: string
+                    expr: _col6
+                    type: string
+                    expr: _col7
+                    type: string
+              sort order: ++++++++
+              tag: -1
+              value expressions:
+                    expr: _col0
+                    type: string
+                    expr: _col1
+                    type: string
+                    expr: _col2
+                    type: string
+                    expr: _col3
+                    type: string
+                    expr: _col4
+                    type: string
+                    expr: _col5
+                    type: string
+                    expr: _col6
+                    type: string
+                    expr: _col7
+                    type: string
+      Reduce Operator Tree:
+        Extract
+          File Output Operator
+            compressed: false
+            GlobalTableId: 0
+            table:
+                input format: org.apache.hadoop.mapred.TextInputFormat
+                output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+
+  Stage: Stage-0
+    Fetch Operator
+      limit: -1
+
+
+PREHOOK: query: SELECT *
+FROM srcpart a JOIN srcpart b
+ON a.key = b.key
+WHERE a.ds = '2008-04-08' AND
+      b.ds = '2008-04-08' AND
+      CASE a.key
+        WHEN '27' THEN TRUE
+        WHEN '38' THEN FALSE
+        ELSE NULL
+       END
+ORDER BY a.key, a.value, a.ds, a.hr, b.key, b.value, b.ds, b.hr
+PREHOOK: type: QUERY
+PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
+PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
+PREHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-53-40_840_3692167909003016050/-mr-10000
+POSTHOOK: query: SELECT *
+FROM srcpart a JOIN srcpart b
+ON a.key = b.key
+WHERE a.ds = '2008-04-08' AND
+      b.ds = '2008-04-08' AND
+      CASE a.key
+        WHEN '27' THEN TRUE
+        WHEN '38' THEN FALSE
+        ELSE NULL
+       END
+ORDER BY a.key, a.value, a.ds, a.hr, b.key, b.value, b.ds, b.hr
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
+POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
+POSTHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-53-40_840_3692167909003016050/-mr-10000
 27	val_27	2008-04-08	11	27	val_27	2008-04-08	11
 27	val_27	2008-04-08	11	27	val_27	2008-04-08	12
 27	val_27	2008-04-08	12	27	val_27	2008-04-08	11
diff --git a/ql/src/test/results/clientpositive/ppd_union.q.out b/ql/src/test/results/clientpositive/ppd_union.q.out
index f0b80dc89d..4028948db9 100644
--- a/ql/src/test/results/clientpositive/ppd_union.q.out
+++ b/ql/src/test/results/clientpositive/ppd_union.q.out
@@ -114,7 +114,7 @@ SELECT unioned_query.*
   WHERE key > '4' and value > 'val_4'
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
-PREHOOK: Output: file:/tmp/sdong/hive_2011-02-10_16-57-42_422_7786150548202984482/-mr-10000
+PREHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-56-10_639_4479616588694636353/-mr-10000
 POSTHOOK: query: FROM (
   FROM src select src.key, src.value WHERE src.key < '100'
     UNION ALL
@@ -124,7 +124,289 @@ SELECT unioned_query.*
   WHERE key > '4' and value > 'val_4'
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
-POSTHOOK: Output: file:/tmp/sdong/hive_2011-02-10_16-57-42_422_7786150548202984482/-mr-10000
+POSTHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-56-10_639_4479616588694636353/-mr-10000
+86	val_86
+409	val_409
+98	val_98
+484	val_484
+401	val_401
+66	val_66
+406	val_406
+429	val_429
+469	val_469
+495	val_495
+82	val_82
+403	val_403
+417	val_417
+430	val_430
+446	val_446
+459	val_459
+482	val_482
+413	val_413
+494	val_494
+466	val_466
+417	val_417
+489	val_489
+439	val_439
+475	val_475
+455	val_455
+57	val_57
+438	val_438
+489	val_489
+92	val_92
+47	val_47
+72	val_72
+427	val_427
+498	val_498
+437	val_437
+469	val_469
+54	val_54
+459	val_459
+51	val_51
+430	val_430
+65	val_65
+83	val_83
+67	val_67
+404	val_404
+489	val_489
+84	val_84
+466	val_466
+58	val_58
+8	val_8
+411	val_411
+463	val_463
+431	val_431
+42	val_42
+496	val_496
+468	val_468
+454	val_454
+418	val_418
+96	val_96
+51	val_51
+404	val_404
+43	val_43
+436	val_436
+469	val_469
+468	val_468
+95	val_95
+481	val_481
+457	val_457
+98	val_98
+409	val_409
+470	val_470
+413	val_413
+85	val_85
+77	val_77
+490	val_490
+87	val_87
+419	val_419
+72	val_72
+90	val_90
+435	val_435
+401	val_401
+452	val_452
+5	val_5
+497	val_497
+402	val_402
+58	val_58
+95	val_95
+472	val_472
+498	val_498
+42	val_42
+430	val_430
+489	val_489
+458	val_458
+78	val_78
+76	val_76
+41	val_41
+492	val_492
+449	val_449
+453	val_453
+64	val_64
+468	val_468
+76	val_76
+74	val_74
+69	val_69
+485	val_485
+70	val_70
+487	val_487
+480	val_480
+401	val_401
+5	val_5
+438	val_438
+467	val_467
+432	val_432
+469	val_469
+463	val_463
+80	val_80
+44	val_44
+466	val_466
+403	val_403
+483	val_483
+53	val_53
+406	val_406
+409	val_409
+406	val_406
+401	val_401
+90	val_90
+424	val_424
+431	val_431
+454	val_454
+478	val_478
+431	val_431
+424	val_424
+5	val_5
+70	val_70
+480	val_480
+70	val_70
+438	val_438
+414	val_414
+491	val_491
+439	val_439
+479	val_479
+417	val_417
+444	val_444
+429	val_429
+443	val_443
+478	val_478
+468	val_468
+493	val_493
+460	val_460
+480	val_480
+83	val_83
+462	val_462
+406	val_406
+454	val_454
+401	val_401
+421	val_421
+407	val_407
+67	val_67
+462	val_462
+492	val_492
+9	val_9
+498	val_498
+458	val_458
+97	val_97
+469	val_469
+84	val_84
+448	val_448
+414	val_414
+477	val_477
+90	val_90
+403	val_403
+400	val_400
+97	val_97
+PREHOOK: query: EXPLAIN
+FROM (
+  FROM src select src.key, src.value WHERE src.key < '100'
+    UNION ALL
+  FROM src SELECT src.* WHERE src.key > '150'
+) unioned_query
+SELECT unioned_query.*
+  WHERE key > '4' and value > 'val_4'
+PREHOOK: type: QUERY
+POSTHOOK: query: EXPLAIN
+FROM (
+  FROM src select src.key, src.value WHERE src.key < '100'
+    UNION ALL
+  FROM src SELECT src.* WHERE src.key > '150'
+) unioned_query
+SELECT unioned_query.*
+  WHERE key > '4' and value > 'val_4'
+POSTHOOK: type: QUERY
+ABSTRACT SYNTAX TREE:
+  (TOK_QUERY (TOK_FROM (TOK_SUBQUERY (TOK_UNION (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME src))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL src) key)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL src) value))) (TOK_WHERE (< (. (TOK_TABLE_OR_COL src) key) '100')))) (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME src))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_ALLCOLREF (TOK_TABNAME src)))) (TOK_WHERE (> (. (TOK_TABLE_OR_COL src) key) '150'))))) unioned_query)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_ALLCOLREF (TOK_TABNAME unioned_query)))) (TOK_WHERE (and (> (TOK_TABLE_OR_COL key) '4') (> (TOK_TABLE_OR_COL value) 'val_4')))))
+
+STAGE DEPENDENCIES:
+  Stage-1 is a root stage
+  Stage-0 is a root stage
+
+STAGE PLANS:
+  Stage: Stage-1
+    Map Reduce
+      Alias -> Map Operator Tree:
+        null-subquery1:unioned_query-subquery1:src 
+          TableScan
+            alias: src
+            Filter Operator
+              predicate:
+                  expr: ((key < '100') and ((key > '4') and (value > 'val_4')))
+                  type: boolean
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Union
+                  Select Operator
+                    expressions:
+                          expr: _col0
+                          type: string
+                          expr: _col1
+                          type: string
+                    outputColumnNames: _col0, _col1
+                    File Output Operator
+                      compressed: false
+                      GlobalTableId: 0
+                      table:
+                          input format: org.apache.hadoop.mapred.TextInputFormat
+                          output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+        null-subquery2:unioned_query-subquery2:src 
+          TableScan
+            alias: src
+            Filter Operator
+              predicate:
+                  expr: ((key > '150') and ((key > '4') and (value > 'val_4')))
+                  type: boolean
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Union
+                  Select Operator
+                    expressions:
+                          expr: _col0
+                          type: string
+                          expr: _col1
+                          type: string
+                    outputColumnNames: _col0, _col1
+                    File Output Operator
+                      compressed: false
+                      GlobalTableId: 0
+                      table:
+                          input format: org.apache.hadoop.mapred.TextInputFormat
+                          output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+
+  Stage: Stage-0
+    Fetch Operator
+      limit: -1
+
+
+PREHOOK: query: FROM (
+  FROM src select src.key, src.value WHERE src.key < '100'
+    UNION ALL
+  FROM src SELECT src.* WHERE src.key > '150'
+) unioned_query
+SELECT unioned_query.*
+  WHERE key > '4' and value > 'val_4'
+PREHOOK: type: QUERY
+PREHOOK: Input: default@src
+PREHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-56-19_201_5931398035634081896/-mr-10000
+POSTHOOK: query: FROM (
+  FROM src select src.key, src.value WHERE src.key < '100'
+    UNION ALL
+  FROM src SELECT src.* WHERE src.key > '150'
+) unioned_query
+SELECT unioned_query.*
+  WHERE key > '4' and value > 'val_4'
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@src
+POSTHOOK: Output: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-22_02-56-19_201_5931398035634081896/-mr-10000
 86	val_86
 409	val_409
 98	val_98
diff --git a/ql/src/test/results/clientpositive/ppr_pushdown3.q.out b/ql/src/test/results/clientpositive/ppr_pushdown3.q.out
index 981fbd030f..c815d14d71 100644
--- a/ql/src/test/results/clientpositive/ppr_pushdown3.q.out
+++ b/ql/src/test/results/clientpositive/ppr_pushdown3.q.out
@@ -20,27 +20,23 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
-                        expr: ds
-                        type: string
-                        expr: hr
-                        type: string
-                  outputColumnNames: _col0, _col1, _col2, _col3
-                  File Output Operator
-                    compressed: false
-                    GlobalTableId: 0
-                    table:
-                        input format: org.apache.hadoop.mapred.TextInputFormat
-                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                      expr: ds
+                      type: string
+                      expr: hr
+                      type: string
+                outputColumnNames: _col0, _col1, _col2, _col3
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 0
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
 
   Stage: Stage-0
     Fetch Operator
diff --git a/ql/src/test/results/clientpositive/query_result_fileformat.q.out b/ql/src/test/results/clientpositive/query_result_fileformat.q.out
index 06291ad919..6ebd5eefaa 100644
--- a/ql/src/test/results/clientpositive/query_result_fileformat.q.out
+++ b/ql/src/test/results/clientpositive/query_result_fileformat.q.out
@@ -56,23 +56,19 @@ STAGE PLANS:
               predicate:
                   expr: (key = 'key1')
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key = 'key1')
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
-                  outputColumnNames: _col0, _col1
-                  File Output Operator
-                    compressed: false
-                    GlobalTableId: 0
-                    table:
-                        input format: org.apache.hadoop.mapred.TextInputFormat
-                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 0
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
 
   Stage: Stage-0
     Fetch Operator
@@ -136,23 +132,19 @@ STAGE PLANS:
               predicate:
                   expr: (key = 'key1')
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key = 'key1')
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
-                  outputColumnNames: _col0, _col1
-                  File Output Operator
-                    compressed: false
-                    GlobalTableId: 0
-                    table:
-                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
-                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 0
+                  table:
+                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
 
   Stage: Stage-0
     Fetch Operator
diff --git a/ql/src/test/results/clientpositive/quote1.q.out b/ql/src/test/results/clientpositive/quote1.q.out
index 3dc32eb25c..ef3db62d42 100644
--- a/ql/src/test/results/clientpositive/quote1.q.out
+++ b/ql/src/test/results/clientpositive/quote1.q.out
@@ -33,32 +33,28 @@ STAGE PLANS:
               predicate:
                   expr: ((key >= 200) and (key < 300))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: ((key >= 200) and (key < 300))
-                    type: boolean
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
                 Select Operator
                   expressions:
-                        expr: key
-                        type: string
-                        expr: value
+                        expr: UDFToInteger(_col0)
+                        type: int
+                        expr: _col1
                         type: string
                   outputColumnNames: _col0, _col1
-                  Select Operator
-                    expressions:
-                          expr: UDFToInteger(_col0)
-                          type: int
-                          expr: _col1
-                          type: string
-                    outputColumnNames: _col0, _col1
-                    File Output Operator
-                      compressed: false
-                      GlobalTableId: 1
-                      table:
-                          input format: org.apache.hadoop.mapred.TextInputFormat
-                          output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                          name: default.dest1
+                  File Output Operator
+                    compressed: false
+                    GlobalTableId: 1
+                    table:
+                        input format: org.apache.hadoop.mapred.TextInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                        name: default.dest1
 
   Stage: Stage-5
     Conditional Operator
@@ -122,25 +118,21 @@ STAGE PLANS:
               predicate:
                   expr: (table = '2008-04-08')
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (table = '2008-04-08')
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: location
-                        type: int
-                        expr: type
-                        type: string
-                        expr: table
-                        type: string
-                  outputColumnNames: _col0, _col1, _col2
-                  File Output Operator
-                    compressed: false
-                    GlobalTableId: 0
-                    table:
-                        input format: org.apache.hadoop.mapred.TextInputFormat
-                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+              Select Operator
+                expressions:
+                      expr: location
+                      type: int
+                      expr: type
+                      type: string
+                      expr: table
+                      type: string
+                outputColumnNames: _col0, _col1, _col2
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 0
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
 
   Stage: Stage-0
     Fetch Operator
diff --git a/ql/src/test/results/clientpositive/rand_partitionpruner3.q.out b/ql/src/test/results/clientpositive/rand_partitionpruner3.q.out
index a4b2c064cc..444db5cfd9 100644
--- a/ql/src/test/results/clientpositive/rand_partitionpruner3.q.out
+++ b/ql/src/test/results/clientpositive/rand_partitionpruner3.q.out
@@ -143,38 +143,33 @@ STAGE PLANS:
               predicate:
                   expr: (not ((key > 50) or (key < 10)))
                   type: boolean
-              Filter Operator
-                isSamplingPred: false
-                predicate:
-                    expr: (((ds = '2008-04-08') and (not ((key > 50) or (key < 10)))) and (hr like '%2'))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
-                        expr: ds
-                        type: string
-                        expr: hr
-                        type: string
-                  outputColumnNames: _col0, _col1, _col2, _col3
-                  File Output Operator
-                    compressed: false
-                    GlobalTableId: 0
-                    directory: file:/tmp/sdong/hive_2011-02-10_16-59-31_097_6104330106842070340/-ext-10001
-                    NumFilesPerFileSink: 1
-                    Stats Publishing Key Prefix: file:/tmp/sdong/hive_2011-02-10_16-59-31_097_6104330106842070340/-ext-10001/
-                    table:
-                        input format: org.apache.hadoop.mapred.TextInputFormat
-                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                        properties:
-                          columns _col0,_col1,_col2,_col3
-                          columns.types string:string:string:string
-                          serialization.format 1
-                    TotalFiles: 1
-                    GatherStats: false
-                    MultiFileSpray: false
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                      expr: ds
+                      type: string
+                      expr: hr
+                      type: string
+                outputColumnNames: _col0, _col1, _col2, _col3
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 0
+                  directory: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-17_11-41-58_245_7085869776801424539/-ext-10001
+                  NumFilesPerFileSink: 1
+                  Stats Publishing Key Prefix: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-17_11-41-58_245_7085869776801424539/-ext-10001/
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                      properties:
+                        columns _col0,_col1,_col2,_col3
+                        columns.types string:string:string:string
+                        serialization.format 1
+                  TotalFiles: 1
+                  GatherStats: false
+                  MultiFileSpray: false
       Needs Tagging: false
       Path -> Alias:
         pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12 [a]
diff --git a/ql/src/test/results/clientpositive/rcfile_null_value.q.out b/ql/src/test/results/clientpositive/rcfile_null_value.q.out
index 774fac20aa..da407513f5 100644
--- a/ql/src/test/results/clientpositive/rcfile_null_value.q.out
+++ b/ql/src/test/results/clientpositive/rcfile_null_value.q.out
@@ -106,31 +106,27 @@ STAGE PLANS:
               predicate:
                   expr: ((key > 10) and (key < 20))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: ((key > 10) and (key < 20))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: 0
+                  value expressions:
+                        expr: _col0
                         type: string
-                        expr: value
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: 0
-                    value expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
         c:b:src2 
           TableScan
             alias: src2
@@ -138,31 +134,27 @@ STAGE PLANS:
               predicate:
                   expr: ((key > 15) and (key < 25))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: ((key > 15) and (key < 25))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: 1
+                  value expressions:
+                        expr: _col0
                         type: string
-                        expr: value
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: 1
-                    value expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
       Reduce Operator Tree:
         Join Operator
           condition map:
diff --git a/ql/src/test/results/clientpositive/reduce_deduplicate.q.out b/ql/src/test/results/clientpositive/reduce_deduplicate.q.out
index 8cb121fc7b..4ecdb1e05e 100644
--- a/ql/src/test/results/clientpositive/reduce_deduplicate.q.out
+++ b/ql/src/test/results/clientpositive/reduce_deduplicate.q.out
@@ -258,52 +258,47 @@ STAGE PLANS:
               predicate:
                   expr: (ds = '2010-03-29')
                   type: boolean
-              Filter Operator
-                isSamplingPred: false
-                predicate:
-                    expr: (ds = '2010-03-29')
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: aet
-                        type: string
-                        expr: aes
-                        type: string
-                  outputColumnNames: _col0, _col1
-                  Transform Operator
-                    command: cat
-                    output info:
-                        input format: org.apache.hadoop.mapred.TextInputFormat
-                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                        properties:
-                          columns _col0,_col1,_col2,_col3,_col4,_col5,_col6
-                          columns.types string,string,int,string,bigint,string,string
-                          field.delim 9
-                          serialization.format 9
-                    Reduce Output Operator
-                      key expressions:
-                            expr: _col1
-                            type: string
-                      sort order: +
-                      Map-reduce partition columns:
-                            expr: _col1
-                            type: string
-                      tag: -1
-                      value expressions:
-                            expr: _col0
-                            type: string
-                            expr: _col1
-                            type: string
-                            expr: _col2
-                            type: int
-                            expr: _col3
-                            type: string
-                            expr: _col4
-                            type: bigint
-                            expr: _col5
-                            type: string
-                            expr: _col6
-                            type: string
+              Select Operator
+                expressions:
+                      expr: aet
+                      type: string
+                      expr: aes
+                      type: string
+                outputColumnNames: _col0, _col1
+                Transform Operator
+                  command: cat
+                  output info:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                      properties:
+                        columns _col0,_col1,_col2,_col3,_col4,_col5,_col6
+                        columns.types string,string,int,string,bigint,string,string
+                        field.delim 9
+                        serialization.format 9
+                  Reduce Output Operator
+                    key expressions:
+                          expr: _col1
+                          type: string
+                    sort order: +
+                    Map-reduce partition columns:
+                          expr: _col1
+                          type: string
+                    tag: -1
+                    value expressions:
+                          expr: _col0
+                          type: string
+                          expr: _col1
+                          type: string
+                          expr: _col2
+                          type: int
+                          expr: _col3
+                          type: string
+                          expr: _col4
+                          type: bigint
+                          expr: _col5
+                          type: string
+                          expr: _col6
+                          type: string
       Needs Tagging: false
       Reduce Operator Tree:
         Extract
diff --git a/ql/src/test/results/clientpositive/regex_col.q.out b/ql/src/test/results/clientpositive/regex_col.q.out
index c54ae4ba8f..f31e797b60 100644
--- a/ql/src/test/results/clientpositive/regex_col.q.out
+++ b/ql/src/test/results/clientpositive/regex_col.q.out
@@ -216,27 +216,23 @@ STAGE PLANS:
               predicate:
                   expr: (key = 103)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key = 103)
-                    type: boolean
-                Reduce Output Operator
-                  key expressions:
-                        expr: key
-                        type: string
-                        expr: hr
-                        type: string
-                        expr: ds
-                        type: string
-                  sort order: +++
-                  Map-reduce partition columns:
-                        expr: key
-                        type: string
-                        expr: hr
-                        type: string
-                        expr: ds
-                        type: string
-                  tag: 0
+              Reduce Output Operator
+                key expressions:
+                      expr: key
+                      type: string
+                      expr: hr
+                      type: string
+                      expr: ds
+                      type: string
+                sort order: +++
+                Map-reduce partition columns:
+                      expr: key
+                      type: string
+                      expr: hr
+                      type: string
+                      expr: ds
+                      type: string
+                tag: 0
         b 
           TableScan
             alias: b
diff --git a/ql/src/test/results/clientpositive/regexp_extract.q.out b/ql/src/test/results/clientpositive/regexp_extract.q.out
index 3713c52f5d..d3de1c14a5 100644
--- a/ql/src/test/results/clientpositive/regexp_extract.q.out
+++ b/ql/src/test/results/clientpositive/regexp_extract.q.out
@@ -53,20 +53,25 @@ STAGE PLANS:
                       field.delim 9
                       serialization.format 9
                       serialization.last.column.takes.rest true
-                Reduce Output Operator
-                  key expressions:
-                        expr: _col0
-                        type: string
-                  sort order: +
-                  Map-reduce partition columns:
-                        expr: _col0
-                        type: string
-                  tag: -1
-                  value expressions:
-                        expr: _col0
-                        type: string
-                        expr: _col1
-                        type: string
+                Filter Operator
+                  isSamplingPred: false
+                  predicate:
+                      expr: (_col0 < 100)
+                      type: boolean
+                  Reduce Output Operator
+                    key expressions:
+                          expr: _col0
+                          type: string
+                    sort order: +
+                    Map-reduce partition columns:
+                          expr: _col0
+                          type: string
+                    tag: -1
+                    value expressions:
+                          expr: _col0
+                          type: string
+                          expr: _col1
+                          type: string
       Needs Tagging: false
       Path -> Alias:
         pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src [tmap:src]
@@ -109,34 +114,29 @@ STAGE PLANS:
             name: default.src
       Reduce Operator Tree:
         Extract
-          Filter Operator
-            isSamplingPred: false
-            predicate:
-                expr: (_col0 < 100)
-                type: boolean
-            Select Operator
-              expressions:
-                    expr: _col0
-                    type: string
-                    expr: regexp_extract(_col1, 'val_(\d+\t\d+)', 1)
-                    type: string
-              outputColumnNames: _col0, _col1
-              File Output Operator
-                compressed: false
-                GlobalTableId: 0
-                directory: file:/tmp/sdong/hive_2011-02-10_17-01-39_424_6724088978945525837/-ext-10001
-                NumFilesPerFileSink: 1
-                Stats Publishing Key Prefix: file:/tmp/sdong/hive_2011-02-10_17-01-39_424_6724088978945525837/-ext-10001/
-                table:
-                    input format: org.apache.hadoop.mapred.TextInputFormat
-                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                    properties:
-                      columns _col0,_col1
-                      columns.types string:string
-                      serialization.format 1
-                TotalFiles: 1
-                GatherStats: false
-                MultiFileSpray: false
+          Select Operator
+            expressions:
+                  expr: _col0
+                  type: string
+                  expr: regexp_extract(_col1, 'val_(\d+\t\d+)', 1)
+                  type: string
+            outputColumnNames: _col0, _col1
+            File Output Operator
+              compressed: false
+              GlobalTableId: 0
+              directory: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-17_11-47-02_223_1393307901149024596/-ext-10001
+              NumFilesPerFileSink: 1
+              Stats Publishing Key Prefix: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-17_11-47-02_223_1393307901149024596/-ext-10001/
+              table:
+                  input format: org.apache.hadoop.mapred.TextInputFormat
+                  output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                  properties:
+                    columns _col0,_col1
+                    columns.types string:string
+                    serialization.format 1
+              TotalFiles: 1
+              GatherStats: false
+              MultiFileSpray: false
 
   Stage: Stage-0
     Fetch Operator
@@ -302,20 +302,25 @@ STAGE PLANS:
                       field.delim 9
                       serialization.format 9
                       serialization.last.column.takes.rest true
-                Reduce Output Operator
-                  key expressions:
-                        expr: _col0
-                        type: string
-                  sort order: +
-                  Map-reduce partition columns:
-                        expr: _col0
-                        type: string
-                  tag: -1
-                  value expressions:
-                        expr: _col0
-                        type: string
-                        expr: _col1
-                        type: string
+                Filter Operator
+                  isSamplingPred: false
+                  predicate:
+                      expr: (_col0 < 100)
+                      type: boolean
+                  Reduce Output Operator
+                    key expressions:
+                          expr: _col0
+                          type: string
+                    sort order: +
+                    Map-reduce partition columns:
+                          expr: _col0
+                          type: string
+                    tag: -1
+                    value expressions:
+                          expr: _col0
+                          type: string
+                          expr: _col1
+                          type: string
       Needs Tagging: false
       Path -> Alias:
         pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src [tmap:src]
@@ -358,34 +363,29 @@ STAGE PLANS:
             name: default.src
       Reduce Operator Tree:
         Extract
-          Filter Operator
-            isSamplingPred: false
-            predicate:
-                expr: (_col0 < 100)
-                type: boolean
-            Select Operator
-              expressions:
-                    expr: _col0
-                    type: string
-                    expr: regexp_extract(_col1, 'val_(\d+\t\d+)')
-                    type: string
-              outputColumnNames: _col0, _col1
-              File Output Operator
-                compressed: false
-                GlobalTableId: 0
-                directory: file:/tmp/sdong/hive_2011-02-10_17-01-43_012_4690012969555367930/-ext-10001
-                NumFilesPerFileSink: 1
-                Stats Publishing Key Prefix: file:/tmp/sdong/hive_2011-02-10_17-01-43_012_4690012969555367930/-ext-10001/
-                table:
-                    input format: org.apache.hadoop.mapred.TextInputFormat
-                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                    properties:
-                      columns _col0,_col1
-                      columns.types string:string
-                      serialization.format 1
-                TotalFiles: 1
-                GatherStats: false
-                MultiFileSpray: false
+          Select Operator
+            expressions:
+                  expr: _col0
+                  type: string
+                  expr: regexp_extract(_col1, 'val_(\d+\t\d+)')
+                  type: string
+            outputColumnNames: _col0, _col1
+            File Output Operator
+              compressed: false
+              GlobalTableId: 0
+              directory: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-17_11-47-14_408_4797588639767330030/-ext-10001
+              NumFilesPerFileSink: 1
+              Stats Publishing Key Prefix: file:/var/folders/uc/ucuNeMAVGQGzy3459D8z2+++Z0Q/-Tmp-/amarsri/hive_2011-03-17_11-47-14_408_4797588639767330030/-ext-10001/
+              table:
+                  input format: org.apache.hadoop.mapred.TextInputFormat
+                  output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                  properties:
+                    columns _col0,_col1
+                    columns.types string:string
+                    serialization.format 1
+              TotalFiles: 1
+              GatherStats: false
+              MultiFileSpray: false
 
   Stage: Stage-0
     Fetch Operator
diff --git a/ql/src/test/results/clientpositive/router_join_ppr.q.out b/ql/src/test/results/clientpositive/router_join_ppr.q.out
index 70115376bd..55f5a466f0 100644
--- a/ql/src/test/results/clientpositive/router_join_ppr.q.out
+++ b/ql/src/test/results/clientpositive/router_join_ppr.q.out
@@ -293,7 +293,7 @@ STAGE PLANS:
           Filter Operator
             isSamplingPred: false
             predicate:
-                expr: ((((_col0 > 10) and (_col0 < 20)) and (_col4 > 15)) and (_col4 < 25))
+                expr: ((_col0 > 10) and (_col0 < 20))
                 type: boolean
             Select Operator
               expressions:
@@ -401,25 +401,20 @@ STAGE PLANS:
           TableScan
             alias: a
             GatherStats: false
-            Filter Operator
-              isSamplingPred: false
-              predicate:
-                  expr: (ds = '2008-04-08')
-                  type: boolean
-              Reduce Output Operator
-                key expressions:
-                      expr: key
-                      type: string
-                sort order: +
-                Map-reduce partition columns:
-                      expr: key
-                      type: string
-                tag: 0
-                value expressions:
-                      expr: key
-                      type: string
-                      expr: value
-                      type: string
+            Reduce Output Operator
+              key expressions:
+                    expr: key
+                    type: string
+              sort order: +
+              Map-reduce partition columns:
+                    expr: key
+                    type: string
+              tag: 0
+              value expressions:
+                    expr: key
+                    type: string
+                    expr: value
+                    type: string
         b 
           TableScan
             alias: b
@@ -579,7 +574,7 @@ STAGE PLANS:
           Filter Operator
             isSamplingPred: false
             predicate:
-                expr: ((((_col0 > 10) and (_col0 < 20)) and (_col6 > 15)) and (_col6 < 25))
+                expr: ((_col0 > 10) and (_col0 < 20))
                 type: boolean
             Select Operator
               expressions:
@@ -858,7 +853,7 @@ STAGE PLANS:
           Filter Operator
             isSamplingPred: false
             predicate:
-                expr: (((((_col0 > 10) and (_col0 < 20)) and (_col4 > 15)) and (_col4 < 25)) and (_col6 = '2008-04-08'))
+                expr: ((_col0 > 10) and (_col0 < 20))
                 type: boolean
             Select Operator
               expressions:
@@ -1221,7 +1216,7 @@ STAGE PLANS:
           Filter Operator
             isSamplingPred: false
             predicate:
-                expr: (((((_col0 > 10) and (_col0 < 20)) and (_col6 > 15)) and (_col6 < 25)) and (_col2 = '2008-04-08'))
+                expr: (((_col0 > 10) and (_col0 < 20)) and (_col2 = '2008-04-08'))
                 type: boolean
             Select Operator
               expressions:
diff --git a/ql/src/test/results/clientpositive/sample1.q.out b/ql/src/test/results/clientpositive/sample1.q.out
index 1e74faed26..cd3f119184 100644
--- a/ql/src/test/results/clientpositive/sample1.q.out
+++ b/ql/src/test/results/clientpositive/sample1.q.out
@@ -39,59 +39,54 @@ STAGE PLANS:
               predicate:
                   expr: (((hash(rand()) & 2147483647) % 1) = 0)
                   type: boolean
-              Filter Operator
-                isSamplingPred: false
-                predicate:
-                    expr: ((ds = '2008-04-08') and (hr = '11'))
-                    type: boolean
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                      expr: ds
+                      type: string
+                      expr: hr
+                      type: string
+                outputColumnNames: _col0, _col1, _col2, _col3
                 Select Operator
                   expressions:
-                        expr: key
+                        expr: UDFToInteger(_col0)
+                        type: int
+                        expr: _col1
                         type: string
-                        expr: value
+                        expr: _col2
                         type: string
-                        expr: ds
-                        type: string
-                        expr: hr
+                        expr: _col3
                         type: string
                   outputColumnNames: _col0, _col1, _col2, _col3
-                  Select Operator
-                    expressions:
-                          expr: UDFToInteger(_col0)
-                          type: int
-                          expr: _col1
-                          type: string
-                          expr: _col2
-                          type: string
-                          expr: _col3
-                          type: string
-                    outputColumnNames: _col0, _col1, _col2, _col3
-                    File Output Operator
-                      compressed: false
-                      GlobalTableId: 1
-                      directory: pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-19_19-53-28_734_1650557364525480631/-ext-10002
-                      NumFilesPerFileSink: 1
-                      Stats Publishing Key Prefix: pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-19_19-53-28_734_1650557364525480631/-ext-10000/
-                      table:
-                          input format: org.apache.hadoop.mapred.TextInputFormat
-                          output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                          properties:
-                            bucket_count -1
-                            columns key,value,dt,hr
-                            columns.types int:string:string:string
-                            file.inputformat org.apache.hadoop.mapred.TextInputFormat
-                            file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                            location pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/dest1
-                            name default.dest1
-                            serialization.ddl struct dest1 { i32 key, string value, string dt, string hr}
-                            serialization.format 1
-                            serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                            transient_lastDdlTime 1303268008
-                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                          name: default.dest1
-                      TotalFiles: 1
-                      GatherStats: true
-                      MultiFileSpray: false
+                  File Output Operator
+                    compressed: false
+                    GlobalTableId: 1
+                    directory: pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_02-57-22_086_7502476312093213805/-ext-10002
+                    NumFilesPerFileSink: 1
+                    Stats Publishing Key Prefix: pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_02-57-22_086_7502476312093213805/-ext-10000/
+                    table:
+                        input format: org.apache.hadoop.mapred.TextInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                        properties:
+                          bucket_count -1
+                          columns key,value,dt,hr
+                          columns.types int:string:string:string
+                          file.inputformat org.apache.hadoop.mapred.TextInputFormat
+                          file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                          location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/dest1
+                          name default.dest1
+                          serialization.ddl struct dest1 { i32 key, string value, string dt, string hr}
+                          serialization.format 1
+                          serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                          transient_lastDdlTime 1310378242
+                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                        name: default.dest1
+                    TotalFiles: 1
+                    GatherStats: true
+                    MultiFileSpray: false
       Needs Tagging: false
       Path -> Alias:
         pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 [s]
diff --git a/ql/src/test/results/clientpositive/sample10.q.out b/ql/src/test/results/clientpositive/sample10.q.out
index a03636cb2a..06914e9bc1 100644
--- a/ql/src/test/results/clientpositive/sample10.q.out
+++ b/ql/src/test/results/clientpositive/sample10.q.out
@@ -62,56 +62,46 @@ STAGE PLANS:
             alias: srcpartbucket
             GatherStats: false
             Filter Operator
-              isSamplingPred: false
+              isSamplingPred: true
               predicate:
                   expr: (((hash(key) & 2147483647) % 4) = 0)
                   type: boolean
-              Filter Operator
-                isSamplingPred: true
-                predicate:
-                    expr: (((hash(key) & 2147483647) % 4) = 0)
-                    type: boolean
-                Filter Operator
-                  isSamplingPred: false
-                  predicate:
-                      expr: ds is not null
-                      type: boolean
-                  Select Operator
-                    expressions:
-                          expr: ds
+              Select Operator
+                expressions:
+                      expr: ds
+                      type: string
+                outputColumnNames: ds
+                Group By Operator
+                  aggregations:
+                        expr: count(1)
+                  bucketGroup: false
+                  keys:
+                        expr: ds
+                        type: string
+                  mode: hash
+                  outputColumnNames: _col0, _col1
+                  Reduce Output Operator
+                    key expressions:
+                          expr: _col0
                           type: string
-                    outputColumnNames: ds
-                    Group By Operator
-                      aggregations:
-                            expr: count(1)
-                      bucketGroup: false
-                      keys:
-                            expr: ds
-                            type: string
-                      mode: hash
-                      outputColumnNames: _col0, _col1
-                      Reduce Output Operator
-                        key expressions:
-                              expr: _col0
-                              type: string
-                        sort order: +
-                        Map-reduce partition columns:
-                              expr: _col0
-                              type: string
-                        tag: -1
-                        value expressions:
-                              expr: _col1
-                              type: bigint
+                    sort order: +
+                    Map-reduce partition columns:
+                          expr: _col0
+                          type: string
+                    tag: -1
+                    value expressions:
+                          expr: _col1
+                          type: bigint
       Needs Tagging: false
       Path -> Alias:
-        pfile:/data/users/tomasz/apache-hive/build/ql/test/data/warehouse/srcpartbucket/ds=2008-04-08/hr=11/000000_0 [srcpartbucket]
-        pfile:/data/users/tomasz/apache-hive/build/ql/test/data/warehouse/srcpartbucket/ds=2008-04-08/hr=12/000000_0 [srcpartbucket]
-        pfile:/data/users/tomasz/apache-hive/build/ql/test/data/warehouse/srcpartbucket/ds=2008-04-09/hr=11/000000_0 [srcpartbucket]
-        pfile:/data/users/tomasz/apache-hive/build/ql/test/data/warehouse/srcpartbucket/ds=2008-04-09/hr=12/000000_0 [srcpartbucket]
+        pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcpartbucket/ds=2008-04-08/hr=11 [srcpartbucket]
+        pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcpartbucket/ds=2008-04-08/hr=12 [srcpartbucket]
+        pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcpartbucket/ds=2008-04-09/hr=11 [srcpartbucket]
+        pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcpartbucket/ds=2008-04-09/hr=12 [srcpartbucket]
       Path -> Partition:
-        pfile:/data/users/tomasz/apache-hive/build/ql/test/data/warehouse/srcpartbucket/ds=2008-04-08/hr=11/000000_0 
+        pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcpartbucket/ds=2008-04-08/hr=11 
           Partition
-            base file name: 000000_0
+            base file name: hr=11
             input format: org.apache.hadoop.hive.ql.io.RCFileInputFormat
             output format: org.apache.hadoop.hive.ql.io.RCFileOutputFormat
             partition values:
@@ -124,7 +114,7 @@ STAGE PLANS:
               columns.types string:string
               file.inputformat org.apache.hadoop.hive.ql.io.RCFileInputFormat
               file.outputformat org.apache.hadoop.hive.ql.io.RCFileOutputFormat
-              location pfile:/data/users/tomasz/apache-hive/build/ql/test/data/warehouse/srcpartbucket/ds=2008-04-08/hr=11
+              location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcpartbucket/ds=2008-04-08/hr=11
               name default.srcpartbucket
               numFiles 4
               numPartitions 4
@@ -135,7 +125,7 @@ STAGE PLANS:
               serialization.format 1
               serialization.lib org.apache.hadoop.hive.serde2.columnar.ColumnarSerDe
               totalSize 687
-              transient_lastDdlTime 1306985008
+              transient_lastDdlTime 1310378253
             serde: org.apache.hadoop.hive.serde2.columnar.ColumnarSerDe
           
               input format: org.apache.hadoop.hive.ql.io.RCFileInputFormat
@@ -147,7 +137,7 @@ STAGE PLANS:
                 columns.types string:string
                 file.inputformat org.apache.hadoop.hive.ql.io.RCFileInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.RCFileOutputFormat
-                location pfile:/data/users/tomasz/apache-hive/build/ql/test/data/warehouse/srcpartbucket
+                location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcpartbucket
                 name default.srcpartbucket
                 numFiles 16
                 numPartitions 4
@@ -158,13 +148,13 @@ STAGE PLANS:
                 serialization.format 1
                 serialization.lib org.apache.hadoop.hive.serde2.columnar.ColumnarSerDe
                 totalSize 2748
-                transient_lastDdlTime 1306985009
+                transient_lastDdlTime 1310378254
               serde: org.apache.hadoop.hive.serde2.columnar.ColumnarSerDe
               name: default.srcpartbucket
             name: default.srcpartbucket
-        pfile:/data/users/tomasz/apache-hive/build/ql/test/data/warehouse/srcpartbucket/ds=2008-04-08/hr=12/000000_0 
+        pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcpartbucket/ds=2008-04-08/hr=12 
           Partition
-            base file name: 000000_0
+            base file name: hr=12
             input format: org.apache.hadoop.hive.ql.io.RCFileInputFormat
             output format: org.apache.hadoop.hive.ql.io.RCFileOutputFormat
             partition values:
@@ -177,7 +167,7 @@ STAGE PLANS:
               columns.types string:string
               file.inputformat org.apache.hadoop.hive.ql.io.RCFileInputFormat
               file.outputformat org.apache.hadoop.hive.ql.io.RCFileOutputFormat
-              location pfile:/data/users/tomasz/apache-hive/build/ql/test/data/warehouse/srcpartbucket/ds=2008-04-08/hr=12
+              location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcpartbucket/ds=2008-04-08/hr=12
               name default.srcpartbucket
               numFiles 4
               numPartitions 4
@@ -188,7 +178,7 @@ STAGE PLANS:
               serialization.format 1
               serialization.lib org.apache.hadoop.hive.serde2.columnar.ColumnarSerDe
               totalSize 687
-              transient_lastDdlTime 1306985008
+              transient_lastDdlTime 1310378253
             serde: org.apache.hadoop.hive.serde2.columnar.ColumnarSerDe
           
               input format: org.apache.hadoop.hive.ql.io.RCFileInputFormat
@@ -200,7 +190,7 @@ STAGE PLANS:
                 columns.types string:string
                 file.inputformat org.apache.hadoop.hive.ql.io.RCFileInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.RCFileOutputFormat
-                location pfile:/data/users/tomasz/apache-hive/build/ql/test/data/warehouse/srcpartbucket
+                location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcpartbucket
                 name default.srcpartbucket
                 numFiles 16
                 numPartitions 4
@@ -211,13 +201,13 @@ STAGE PLANS:
                 serialization.format 1
                 serialization.lib org.apache.hadoop.hive.serde2.columnar.ColumnarSerDe
                 totalSize 2748
-                transient_lastDdlTime 1306985009
+                transient_lastDdlTime 1310378254
               serde: org.apache.hadoop.hive.serde2.columnar.ColumnarSerDe
               name: default.srcpartbucket
             name: default.srcpartbucket
-        pfile:/data/users/tomasz/apache-hive/build/ql/test/data/warehouse/srcpartbucket/ds=2008-04-09/hr=11/000000_0 
+        pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcpartbucket/ds=2008-04-09/hr=11 
           Partition
-            base file name: 000000_0
+            base file name: hr=11
             input format: org.apache.hadoop.hive.ql.io.RCFileInputFormat
             output format: org.apache.hadoop.hive.ql.io.RCFileOutputFormat
             partition values:
@@ -230,7 +220,7 @@ STAGE PLANS:
               columns.types string:string
               file.inputformat org.apache.hadoop.hive.ql.io.RCFileInputFormat
               file.outputformat org.apache.hadoop.hive.ql.io.RCFileOutputFormat
-              location pfile:/data/users/tomasz/apache-hive/build/ql/test/data/warehouse/srcpartbucket/ds=2008-04-09/hr=11
+              location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcpartbucket/ds=2008-04-09/hr=11
               name default.srcpartbucket
               numFiles 4
               numPartitions 4
@@ -241,7 +231,7 @@ STAGE PLANS:
               serialization.format 1
               serialization.lib org.apache.hadoop.hive.serde2.columnar.ColumnarSerDe
               totalSize 687
-              transient_lastDdlTime 1306985009
+              transient_lastDdlTime 1310378254
             serde: org.apache.hadoop.hive.serde2.columnar.ColumnarSerDe
           
               input format: org.apache.hadoop.hive.ql.io.RCFileInputFormat
@@ -253,7 +243,7 @@ STAGE PLANS:
                 columns.types string:string
                 file.inputformat org.apache.hadoop.hive.ql.io.RCFileInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.RCFileOutputFormat
-                location pfile:/data/users/tomasz/apache-hive/build/ql/test/data/warehouse/srcpartbucket
+                location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcpartbucket
                 name default.srcpartbucket
                 numFiles 16
                 numPartitions 4
@@ -264,13 +254,13 @@ STAGE PLANS:
                 serialization.format 1
                 serialization.lib org.apache.hadoop.hive.serde2.columnar.ColumnarSerDe
                 totalSize 2748
-                transient_lastDdlTime 1306985009
+                transient_lastDdlTime 1310378254
               serde: org.apache.hadoop.hive.serde2.columnar.ColumnarSerDe
               name: default.srcpartbucket
             name: default.srcpartbucket
-        pfile:/data/users/tomasz/apache-hive/build/ql/test/data/warehouse/srcpartbucket/ds=2008-04-09/hr=12/000000_0 
+        pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcpartbucket/ds=2008-04-09/hr=12 
           Partition
-            base file name: 000000_0
+            base file name: hr=12
             input format: org.apache.hadoop.hive.ql.io.RCFileInputFormat
             output format: org.apache.hadoop.hive.ql.io.RCFileOutputFormat
             partition values:
@@ -283,7 +273,7 @@ STAGE PLANS:
               columns.types string:string
               file.inputformat org.apache.hadoop.hive.ql.io.RCFileInputFormat
               file.outputformat org.apache.hadoop.hive.ql.io.RCFileOutputFormat
-              location pfile:/data/users/tomasz/apache-hive/build/ql/test/data/warehouse/srcpartbucket/ds=2008-04-09/hr=12
+              location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcpartbucket/ds=2008-04-09/hr=12
               name default.srcpartbucket
               numFiles 4
               numPartitions 4
@@ -294,7 +284,7 @@ STAGE PLANS:
               serialization.format 1
               serialization.lib org.apache.hadoop.hive.serde2.columnar.ColumnarSerDe
               totalSize 687
-              transient_lastDdlTime 1306985009
+              transient_lastDdlTime 1310378254
             serde: org.apache.hadoop.hive.serde2.columnar.ColumnarSerDe
           
               input format: org.apache.hadoop.hive.ql.io.RCFileInputFormat
@@ -306,7 +296,7 @@ STAGE PLANS:
                 columns.types string:string
                 file.inputformat org.apache.hadoop.hive.ql.io.RCFileInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.RCFileOutputFormat
-                location pfile:/data/users/tomasz/apache-hive/build/ql/test/data/warehouse/srcpartbucket
+                location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcpartbucket
                 name default.srcpartbucket
                 numFiles 16
                 numPartitions 4
@@ -317,7 +307,7 @@ STAGE PLANS:
                 serialization.format 1
                 serialization.lib org.apache.hadoop.hive.serde2.columnar.ColumnarSerDe
                 totalSize 2748
-                transient_lastDdlTime 1306985009
+                transient_lastDdlTime 1310378254
               serde: org.apache.hadoop.hive.serde2.columnar.ColumnarSerDe
               name: default.srcpartbucket
             name: default.srcpartbucket
@@ -341,9 +331,9 @@ STAGE PLANS:
             File Output Operator
               compressed: false
               GlobalTableId: 0
-              directory: file:/tmp/tomasz/hive_2011-06-01_20-23-29_444_7696526641405452058/-ext-10001
+              directory: file:/tmp/amarsri/hive_2011-07-11_02-57-34_199_3121154239583559117/-ext-10001
               NumFilesPerFileSink: 1
-              Stats Publishing Key Prefix: file:/tmp/tomasz/hive_2011-06-01_20-23-29_444_7696526641405452058/-ext-10001/
+              Stats Publishing Key Prefix: file:/tmp/amarsri/hive_2011-07-11_02-57-34_199_3121154239583559117/-ext-10001/
               table:
                   input format: org.apache.hadoop.mapred.TextInputFormat
                   output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -366,14 +356,14 @@ PREHOOK: Input: default@srcpartbucket@ds=2008-04-08/hr=11
 PREHOOK: Input: default@srcpartbucket@ds=2008-04-08/hr=12
 PREHOOK: Input: default@srcpartbucket@ds=2008-04-09/hr=11
 PREHOOK: Input: default@srcpartbucket@ds=2008-04-09/hr=12
-PREHOOK: Output: file:/tmp/tomasz/hive_2011-06-01_20-23-30_508_5406045561869452297/-mr-10000
+PREHOOK: Output: file:/tmp/amarsri/hive_2011-07-11_02-57-34_266_8959693938921606201/-mr-10000
 POSTHOOK: query: select ds, count(1) from srcpartbucket tablesample (bucket 1 out of 4 on key) where ds is not null group by ds
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcpartbucket@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpartbucket@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpartbucket@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpartbucket@ds=2008-04-09/hr=12
-POSTHOOK: Output: file:/tmp/tomasz/hive_2011-06-01_20-23-30_508_5406045561869452297/-mr-10000
+POSTHOOK: Output: file:/tmp/amarsri/hive_2011-07-11_02-57-34_266_8959693938921606201/-mr-10000
 POSTHOOK: Lineage: srcpartbucket PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: srcpartbucket PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: srcpartbucket PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -390,14 +380,14 @@ PREHOOK: Input: default@srcpartbucket@ds=2008-04-08/hr=11
 PREHOOK: Input: default@srcpartbucket@ds=2008-04-08/hr=12
 PREHOOK: Input: default@srcpartbucket@ds=2008-04-09/hr=11
 PREHOOK: Input: default@srcpartbucket@ds=2008-04-09/hr=12
-PREHOOK: Output: file:/tmp/tomasz/hive_2011-06-01_20-23-35_137_2751107101196563632/-mr-10000
+PREHOOK: Output: file:/tmp/amarsri/hive_2011-07-11_02-57-37_721_8565979138240547969/-mr-10000
 POSTHOOK: query: select ds, count(1) from srcpartbucket tablesample (bucket 1 out of 2 on key) where ds is not null group by ds
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcpartbucket@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpartbucket@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpartbucket@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpartbucket@ds=2008-04-09/hr=12
-POSTHOOK: Output: file:/tmp/tomasz/hive_2011-06-01_20-23-35_137_2751107101196563632/-mr-10000
+POSTHOOK: Output: file:/tmp/amarsri/hive_2011-07-11_02-57-37_721_8565979138240547969/-mr-10000
 POSTHOOK: Lineage: srcpartbucket PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: srcpartbucket PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: srcpartbucket PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -414,14 +404,14 @@ PREHOOK: Input: default@srcpartbucket@ds=2008-04-08/hr=11
 PREHOOK: Input: default@srcpartbucket@ds=2008-04-08/hr=12
 PREHOOK: Input: default@srcpartbucket@ds=2008-04-09/hr=11
 PREHOOK: Input: default@srcpartbucket@ds=2008-04-09/hr=12
-PREHOOK: Output: file:/tmp/tomasz/hive_2011-06-01_20-23-41_104_4777815480864595260/-mr-10000
+PREHOOK: Output: file:/tmp/amarsri/hive_2011-07-11_02-57-41_141_6108039306390462068/-mr-10000
 POSTHOOK: query: select * from srcpartbucket where ds is not null
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcpartbucket@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpartbucket@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpartbucket@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpartbucket@ds=2008-04-09/hr=12
-POSTHOOK: Output: file:/tmp/tomasz/hive_2011-06-01_20-23-41_104_4777815480864595260/-mr-10000
+POSTHOOK: Output: file:/tmp/amarsri/hive_2011-07-11_02-57-41_141_6108039306390462068/-mr-10000
 POSTHOOK: Lineage: srcpartbucket PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: srcpartbucket PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: srcpartbucket PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/sample2.q.out b/ql/src/test/results/clientpositive/sample2.q.out
index bd3a26657d..246f720474 100644
--- a/ql/src/test/results/clientpositive/sample2.q.out
+++ b/ql/src/test/results/clientpositive/sample2.q.out
@@ -35,55 +35,50 @@ STAGE PLANS:
             alias: s
             GatherStats: false
             Filter Operator
-              isSamplingPred: false
+              isSamplingPred: true
               predicate:
                   expr: (((hash(key) & 2147483647) % 2) = 0)
                   type: boolean
-              Filter Operator
-                isSamplingPred: true
-                predicate:
-                    expr: (((hash(key) & 2147483647) % 2) = 0)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: int
-                        expr: value
-                        type: string
-                  outputColumnNames: _col0, _col1
-                  File Output Operator
-                    compressed: false
-                    GlobalTableId: 1
-                    directory: pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-19_19-54-04_767_3073506034460854405/-ext-10002
-                    NumFilesPerFileSink: 1
-                    Stats Publishing Key Prefix: pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-19_19-54-04_767_3073506034460854405/-ext-10000/
-                    table:
-                        input format: org.apache.hadoop.mapred.TextInputFormat
-                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                        properties:
-                          bucket_count -1
-                          columns key,value
-                          columns.types int:string
-                          file.inputformat org.apache.hadoop.mapred.TextInputFormat
-                          file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                          location pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/dest1
-                          name default.dest1
-                          serialization.ddl struct dest1 { i32 key, string value}
-                          serialization.format 1
-                          serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                          transient_lastDdlTime 1303268044
-                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                        name: default.dest1
-                    TotalFiles: 1
-                    GatherStats: true
-                    MultiFileSpray: false
+              Select Operator
+                expressions:
+                      expr: key
+                      type: int
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 1
+                  directory: pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_02-57-42_556_3775563263647495718/-ext-10002
+                  NumFilesPerFileSink: 1
+                  Stats Publishing Key Prefix: pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_02-57-42_556_3775563263647495718/-ext-10000/
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                      properties:
+                        bucket_count -1
+                        columns key,value
+                        columns.types int:string
+                        file.inputformat org.apache.hadoop.mapred.TextInputFormat
+                        file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                        location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/dest1
+                        name default.dest1
+                        serialization.ddl struct dest1 { i32 key, string value}
+                        serialization.format 1
+                        serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                        transient_lastDdlTime 1310378262
+                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                      name: default.dest1
+                  TotalFiles: 1
+                  GatherStats: true
+                  MultiFileSpray: false
       Needs Tagging: false
       Path -> Alias:
-        pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt [s]
+        pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket [s]
       Path -> Partition:
-        pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt 
+        pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket 
           Partition
-            base file name: srcbucket0.txt
+            base file name: srcbucket
             input format: org.apache.hadoop.mapred.TextInputFormat
             output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
             properties:
@@ -93,12 +88,12 @@ STAGE PLANS:
               columns.types int:string
               file.inputformat org.apache.hadoop.mapred.TextInputFormat
               file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-              location pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket
+              location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket
               name default.srcbucket
               serialization.ddl struct srcbucket { i32 key, string value}
               serialization.format 1
               serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-              transient_lastDdlTime 1303260542
+              transient_lastDdlTime 1310371847
             serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
           
               input format: org.apache.hadoop.mapred.TextInputFormat
@@ -110,12 +105,12 @@ STAGE PLANS:
                 columns.types int:string
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket
+                location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket
                 name default.srcbucket
                 serialization.ddl struct srcbucket { i32 key, string value}
                 serialization.format 1
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                transient_lastDdlTime 1303260542
+                transient_lastDdlTime 1310371847
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: default.srcbucket
             name: default.srcbucket
@@ -127,14 +122,14 @@ STAGE PLANS:
     Move Operator
       files:
           hdfs directory: true
-          source: pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-19_19-54-04_767_3073506034460854405/-ext-10002
-          destination: pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-19_19-54-04_767_3073506034460854405/-ext-10000
+          source: pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_02-57-42_556_3775563263647495718/-ext-10002
+          destination: pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_02-57-42_556_3775563263647495718/-ext-10000
 
   Stage: Stage-0
     Move Operator
       tables:
           replace: true
-          source: pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-19_19-54-04_767_3073506034460854405/-ext-10000
+          source: pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_02-57-42_556_3775563263647495718/-ext-10000
           table:
               input format: org.apache.hadoop.mapred.TextInputFormat
               output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -144,28 +139,28 @@ STAGE PLANS:
                 columns.types int:string
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/dest1
+                location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/dest1
                 name default.dest1
                 serialization.ddl struct dest1 { i32 key, string value}
                 serialization.format 1
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                transient_lastDdlTime 1303268044
+                transient_lastDdlTime 1310378262
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: default.dest1
-          tmp directory: pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-19_19-54-04_767_3073506034460854405/-ext-10001
+          tmp directory: pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_02-57-42_556_3775563263647495718/-ext-10001
 
   Stage: Stage-2
     Stats-Aggr Operator
-      Stats Aggregation Key Prefix: pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-19_19-54-04_767_3073506034460854405/-ext-10000/
+      Stats Aggregation Key Prefix: pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_02-57-42_556_3775563263647495718/-ext-10000/
 
   Stage: Stage-3
     Map Reduce
       Alias -> Map Operator Tree:
-        pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-19_19-54-04_767_3073506034460854405/-ext-10002 
+        pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_02-57-42_556_3775563263647495718/-ext-10002 
             File Output Operator
               compressed: false
               GlobalTableId: 0
-              directory: pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-19_19-54-04_767_3073506034460854405/-ext-10000
+              directory: pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_02-57-42_556_3775563263647495718/-ext-10000
               NumFilesPerFileSink: 1
               table:
                   input format: org.apache.hadoop.mapred.TextInputFormat
@@ -176,12 +171,12 @@ STAGE PLANS:
                     columns.types int:string
                     file.inputformat org.apache.hadoop.mapred.TextInputFormat
                     file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                    location pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/dest1
+                    location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/dest1
                     name default.dest1
                     serialization.ddl struct dest1 { i32 key, string value}
                     serialization.format 1
                     serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                    transient_lastDdlTime 1303268044
+                    transient_lastDdlTime 1310378262
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   name: default.dest1
               TotalFiles: 1
@@ -189,9 +184,9 @@ STAGE PLANS:
               MultiFileSpray: false
       Needs Tagging: false
       Path -> Alias:
-        pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-19_19-54-04_767_3073506034460854405/-ext-10002 [pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-19_19-54-04_767_3073506034460854405/-ext-10002]
+        pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_02-57-42_556_3775563263647495718/-ext-10002 [pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_02-57-42_556_3775563263647495718/-ext-10002]
       Path -> Partition:
-        pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-19_19-54-04_767_3073506034460854405/-ext-10002 
+        pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_02-57-42_556_3775563263647495718/-ext-10002 
           Partition
             base file name: -ext-10002
             input format: org.apache.hadoop.mapred.TextInputFormat
@@ -202,12 +197,12 @@ STAGE PLANS:
               columns.types int:string
               file.inputformat org.apache.hadoop.mapred.TextInputFormat
               file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-              location pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/dest1
+              location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/dest1
               name default.dest1
               serialization.ddl struct dest1 { i32 key, string value}
               serialization.format 1
               serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-              transient_lastDdlTime 1303268044
+              transient_lastDdlTime 1310378262
             serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
           
               input format: org.apache.hadoop.mapred.TextInputFormat
@@ -218,12 +213,12 @@ STAGE PLANS:
                 columns.types int:string
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/dest1
+                location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/dest1
                 name default.dest1
                 serialization.ddl struct dest1 { i32 key, string value}
                 serialization.format 1
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                transient_lastDdlTime 1303268044
+                transient_lastDdlTime 1310378262
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: default.dest1
             name: default.dest1
@@ -244,11 +239,11 @@ POSTHOOK: Lineage: dest1.value SIMPLE [(srcbucket)s.FieldSchema(name:value, type
 PREHOOK: query: SELECT dest1.* FROM dest1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@dest1
-PREHOOK: Output: file:/tmp/sdong/hive_2011-04-19_19-54-09_653_6287363092772761622/-mr-10000
+PREHOOK: Output: file:/tmp/amarsri/hive_2011-07-11_02-57-46_140_4116462247752325624/-mr-10000
 POSTHOOK: query: SELECT dest1.* FROM dest1
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@dest1
-POSTHOOK: Output: file:/tmp/sdong/hive_2011-04-19_19-54-09_653_6287363092772761622/-mr-10000
+POSTHOOK: Output: file:/tmp/amarsri/hive_2011-07-11_02-57-46_140_4116462247752325624/-mr-10000
 POSTHOOK: Lineage: dest1.key SIMPLE [(srcbucket)s.FieldSchema(name:key, type:int, comment:null), ]
 POSTHOOK: Lineage: dest1.value SIMPLE [(srcbucket)s.FieldSchema(name:value, type:string, comment:null), ]
 474	val_475
diff --git a/ql/src/test/results/clientpositive/sample3.q.out b/ql/src/test/results/clientpositive/sample3.q.out
index 93ff513ffb..11b0fc3d2a 100644
--- a/ql/src/test/results/clientpositive/sample3.q.out
+++ b/ql/src/test/results/clientpositive/sample3.q.out
@@ -26,21 +26,17 @@ STAGE PLANS:
               predicate:
                   expr: (((hash(key) & 2147483647) % 5) = 0)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (((hash(key) & 2147483647) % 5) = 0)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: int
-                  outputColumnNames: _col0
-                  File Output Operator
-                    compressed: false
-                    GlobalTableId: 0
-                    table:
-                        input format: org.apache.hadoop.mapred.TextInputFormat
-                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+              Select Operator
+                expressions:
+                      expr: key
+                      type: int
+                outputColumnNames: _col0
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 0
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
 
   Stage: Stage-0
     Fetch Operator
diff --git a/ql/src/test/results/clientpositive/sample4.q.out b/ql/src/test/results/clientpositive/sample4.q.out
index 53ce498963..99eea9d7e2 100644
--- a/ql/src/test/results/clientpositive/sample4.q.out
+++ b/ql/src/test/results/clientpositive/sample4.q.out
@@ -35,55 +35,50 @@ STAGE PLANS:
             alias: s
             GatherStats: false
             Filter Operator
-              isSamplingPred: false
+              isSamplingPred: true
               predicate:
                   expr: (((hash(key) & 2147483647) % 2) = 0)
                   type: boolean
-              Filter Operator
-                isSamplingPred: true
-                predicate:
-                    expr: (((hash(key) & 2147483647) % 2) = 0)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: int
-                        expr: value
-                        type: string
-                  outputColumnNames: _col0, _col1
-                  File Output Operator
-                    compressed: false
-                    GlobalTableId: 1
-                    directory: pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-19_19-54-14_006_7513722082543864748/-ext-10002
-                    NumFilesPerFileSink: 1
-                    Stats Publishing Key Prefix: pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-19_19-54-14_006_7513722082543864748/-ext-10000/
-                    table:
-                        input format: org.apache.hadoop.mapred.TextInputFormat
-                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                        properties:
-                          bucket_count -1
-                          columns key,value
-                          columns.types int:string
-                          file.inputformat org.apache.hadoop.mapred.TextInputFormat
-                          file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                          location pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/dest1
-                          name default.dest1
-                          serialization.ddl struct dest1 { i32 key, string value}
-                          serialization.format 1
-                          serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                          transient_lastDdlTime 1303268053
-                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                        name: default.dest1
-                    TotalFiles: 1
-                    GatherStats: true
-                    MultiFileSpray: false
+              Select Operator
+                expressions:
+                      expr: key
+                      type: int
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 1
+                  directory: pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_02-57-49_352_3228233042050354215/-ext-10002
+                  NumFilesPerFileSink: 1
+                  Stats Publishing Key Prefix: pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_02-57-49_352_3228233042050354215/-ext-10000/
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                      properties:
+                        bucket_count -1
+                        columns key,value
+                        columns.types int:string
+                        file.inputformat org.apache.hadoop.mapred.TextInputFormat
+                        file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                        location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/dest1
+                        name default.dest1
+                        serialization.ddl struct dest1 { i32 key, string value}
+                        serialization.format 1
+                        serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                        transient_lastDdlTime 1310378269
+                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                      name: default.dest1
+                  TotalFiles: 1
+                  GatherStats: true
+                  MultiFileSpray: false
       Needs Tagging: false
       Path -> Alias:
-        pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt [s]
+        pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket [s]
       Path -> Partition:
-        pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt 
+        pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket 
           Partition
-            base file name: srcbucket0.txt
+            base file name: srcbucket
             input format: org.apache.hadoop.mapred.TextInputFormat
             output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
             properties:
@@ -93,12 +88,12 @@ STAGE PLANS:
               columns.types int:string
               file.inputformat org.apache.hadoop.mapred.TextInputFormat
               file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-              location pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket
+              location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket
               name default.srcbucket
               serialization.ddl struct srcbucket { i32 key, string value}
               serialization.format 1
               serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-              transient_lastDdlTime 1303260542
+              transient_lastDdlTime 1310371847
             serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
           
               input format: org.apache.hadoop.mapred.TextInputFormat
@@ -110,12 +105,12 @@ STAGE PLANS:
                 columns.types int:string
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket
+                location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket
                 name default.srcbucket
                 serialization.ddl struct srcbucket { i32 key, string value}
                 serialization.format 1
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                transient_lastDdlTime 1303260542
+                transient_lastDdlTime 1310371847
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: default.srcbucket
             name: default.srcbucket
@@ -127,14 +122,14 @@ STAGE PLANS:
     Move Operator
       files:
           hdfs directory: true
-          source: pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-19_19-54-14_006_7513722082543864748/-ext-10002
-          destination: pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-19_19-54-14_006_7513722082543864748/-ext-10000
+          source: pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_02-57-49_352_3228233042050354215/-ext-10002
+          destination: pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_02-57-49_352_3228233042050354215/-ext-10000
 
   Stage: Stage-0
     Move Operator
       tables:
           replace: true
-          source: pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-19_19-54-14_006_7513722082543864748/-ext-10000
+          source: pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_02-57-49_352_3228233042050354215/-ext-10000
           table:
               input format: org.apache.hadoop.mapred.TextInputFormat
               output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -144,28 +139,28 @@ STAGE PLANS:
                 columns.types int:string
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/dest1
+                location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/dest1
                 name default.dest1
                 serialization.ddl struct dest1 { i32 key, string value}
                 serialization.format 1
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                transient_lastDdlTime 1303268053
+                transient_lastDdlTime 1310378269
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: default.dest1
-          tmp directory: pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-19_19-54-14_006_7513722082543864748/-ext-10001
+          tmp directory: pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_02-57-49_352_3228233042050354215/-ext-10001
 
   Stage: Stage-2
     Stats-Aggr Operator
-      Stats Aggregation Key Prefix: pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-19_19-54-14_006_7513722082543864748/-ext-10000/
+      Stats Aggregation Key Prefix: pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_02-57-49_352_3228233042050354215/-ext-10000/
 
   Stage: Stage-3
     Map Reduce
       Alias -> Map Operator Tree:
-        pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-19_19-54-14_006_7513722082543864748/-ext-10002 
+        pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_02-57-49_352_3228233042050354215/-ext-10002 
             File Output Operator
               compressed: false
               GlobalTableId: 0
-              directory: pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-19_19-54-14_006_7513722082543864748/-ext-10000
+              directory: pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_02-57-49_352_3228233042050354215/-ext-10000
               NumFilesPerFileSink: 1
               table:
                   input format: org.apache.hadoop.mapred.TextInputFormat
@@ -176,12 +171,12 @@ STAGE PLANS:
                     columns.types int:string
                     file.inputformat org.apache.hadoop.mapred.TextInputFormat
                     file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                    location pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/dest1
+                    location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/dest1
                     name default.dest1
                     serialization.ddl struct dest1 { i32 key, string value}
                     serialization.format 1
                     serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                    transient_lastDdlTime 1303268053
+                    transient_lastDdlTime 1310378269
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   name: default.dest1
               TotalFiles: 1
@@ -189,9 +184,9 @@ STAGE PLANS:
               MultiFileSpray: false
       Needs Tagging: false
       Path -> Alias:
-        pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-19_19-54-14_006_7513722082543864748/-ext-10002 [pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-19_19-54-14_006_7513722082543864748/-ext-10002]
+        pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_02-57-49_352_3228233042050354215/-ext-10002 [pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_02-57-49_352_3228233042050354215/-ext-10002]
       Path -> Partition:
-        pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-19_19-54-14_006_7513722082543864748/-ext-10002 
+        pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_02-57-49_352_3228233042050354215/-ext-10002 
           Partition
             base file name: -ext-10002
             input format: org.apache.hadoop.mapred.TextInputFormat
@@ -202,12 +197,12 @@ STAGE PLANS:
               columns.types int:string
               file.inputformat org.apache.hadoop.mapred.TextInputFormat
               file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-              location pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/dest1
+              location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/dest1
               name default.dest1
               serialization.ddl struct dest1 { i32 key, string value}
               serialization.format 1
               serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-              transient_lastDdlTime 1303268053
+              transient_lastDdlTime 1310378269
             serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
           
               input format: org.apache.hadoop.mapred.TextInputFormat
@@ -218,12 +213,12 @@ STAGE PLANS:
                 columns.types int:string
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/dest1
+                location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/dest1
                 name default.dest1
                 serialization.ddl struct dest1 { i32 key, string value}
                 serialization.format 1
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                transient_lastDdlTime 1303268053
+                transient_lastDdlTime 1310378269
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: default.dest1
             name: default.dest1
@@ -244,11 +239,11 @@ POSTHOOK: Lineage: dest1.value SIMPLE [(srcbucket)s.FieldSchema(name:value, type
 PREHOOK: query: SELECT dest1.* FROM dest1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@dest1
-PREHOOK: Output: file:/tmp/sdong/hive_2011-04-19_19-54-18_801_912578276922482779/-mr-10000
+PREHOOK: Output: file:/tmp/amarsri/hive_2011-07-11_02-57-52_947_159525324700836003/-mr-10000
 POSTHOOK: query: SELECT dest1.* FROM dest1
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@dest1
-POSTHOOK: Output: file:/tmp/sdong/hive_2011-04-19_19-54-18_801_912578276922482779/-mr-10000
+POSTHOOK: Output: file:/tmp/amarsri/hive_2011-07-11_02-57-52_947_159525324700836003/-mr-10000
 POSTHOOK: Lineage: dest1.key SIMPLE [(srcbucket)s.FieldSchema(name:key, type:int, comment:null), ]
 POSTHOOK: Lineage: dest1.value SIMPLE [(srcbucket)s.FieldSchema(name:value, type:string, comment:null), ]
 474	val_475
diff --git a/ql/src/test/results/clientpositive/sample5.q.out b/ql/src/test/results/clientpositive/sample5.q.out
index 464bca6825..21fbbaf2f6 100644
--- a/ql/src/test/results/clientpositive/sample5.q.out
+++ b/ql/src/test/results/clientpositive/sample5.q.out
@@ -33,48 +33,43 @@ STAGE PLANS:
             alias: s
             GatherStats: false
             Filter Operator
-              isSamplingPred: false
+              isSamplingPred: true
               predicate:
                   expr: (((hash(key) & 2147483647) % 5) = 0)
                   type: boolean
-              Filter Operator
-                isSamplingPred: true
-                predicate:
-                    expr: (((hash(key) & 2147483647) % 5) = 0)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: int
-                        expr: value
-                        type: string
-                  outputColumnNames: _col0, _col1
-                  File Output Operator
-                    compressed: false
-                    GlobalTableId: 1
-                    directory: pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-19_19-54-19_492_6757110521675833834/-ext-10002
-                    NumFilesPerFileSink: 1
-                    Stats Publishing Key Prefix: pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-19_19-54-19_492_6757110521675833834/-ext-10000/
-                    table:
-                        input format: org.apache.hadoop.mapred.TextInputFormat
-                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                        properties:
-                          bucket_count -1
-                          columns key,value
-                          columns.types int:string
-                          file.inputformat org.apache.hadoop.mapred.TextInputFormat
-                          file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                          location pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/dest1
-                          name default.dest1
-                          serialization.ddl struct dest1 { i32 key, string value}
-                          serialization.format 1
-                          serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                          transient_lastDdlTime 1303268059
-                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                        name: default.dest1
-                    TotalFiles: 1
-                    GatherStats: true
-                    MultiFileSpray: false
+              Select Operator
+                expressions:
+                      expr: key
+                      type: int
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 1
+                  directory: pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_02-57-53_347_8409652609921946176/-ext-10002
+                  NumFilesPerFileSink: 1
+                  Stats Publishing Key Prefix: pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_02-57-53_347_8409652609921946176/-ext-10000/
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                      properties:
+                        bucket_count -1
+                        columns key,value
+                        columns.types int:string
+                        file.inputformat org.apache.hadoop.mapred.TextInputFormat
+                        file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                        location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/dest1
+                        name default.dest1
+                        serialization.ddl struct dest1 { i32 key, string value}
+                        serialization.format 1
+                        serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                        transient_lastDdlTime 1310378273
+                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                      name: default.dest1
+                  TotalFiles: 1
+                  GatherStats: true
+                  MultiFileSpray: false
       Needs Tagging: false
       Path -> Alias:
         pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket [s]
diff --git a/ql/src/test/results/clientpositive/sample6.q.out b/ql/src/test/results/clientpositive/sample6.q.out
index ad552a8854..9136a356b9 100644
--- a/ql/src/test/results/clientpositive/sample6.q.out
+++ b/ql/src/test/results/clientpositive/sample6.q.out
@@ -33,55 +33,50 @@ STAGE PLANS:
             alias: s
             GatherStats: false
             Filter Operator
-              isSamplingPred: false
+              isSamplingPred: true
               predicate:
                   expr: (((hash(key) & 2147483647) % 4) = 0)
                   type: boolean
-              Filter Operator
-                isSamplingPred: true
-                predicate:
-                    expr: (((hash(key) & 2147483647) % 4) = 0)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: int
-                        expr: value
-                        type: string
-                  outputColumnNames: _col0, _col1
-                  File Output Operator
-                    compressed: false
-                    GlobalTableId: 1
-                    directory: pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-19_19-54-27_627_3309354126941173289/-ext-10002
-                    NumFilesPerFileSink: 1
-                    Stats Publishing Key Prefix: pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-19_19-54-27_627_3309354126941173289/-ext-10000/
-                    table:
-                        input format: org.apache.hadoop.mapred.TextInputFormat
-                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                        properties:
-                          bucket_count -1
-                          columns key,value
-                          columns.types int:string
-                          file.inputformat org.apache.hadoop.mapred.TextInputFormat
-                          file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                          location pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/dest1
-                          name default.dest1
-                          serialization.ddl struct dest1 { i32 key, string value}
-                          serialization.format 1
-                          serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                          transient_lastDdlTime 1303268067
-                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                        name: default.dest1
-                    TotalFiles: 1
-                    GatherStats: true
-                    MultiFileSpray: false
+              Select Operator
+                expressions:
+                      expr: key
+                      type: int
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 1
+                  directory: pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_02-58-00_018_458728813403565509/-ext-10002
+                  NumFilesPerFileSink: 1
+                  Stats Publishing Key Prefix: pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_02-58-00_018_458728813403565509/-ext-10000/
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                      properties:
+                        bucket_count -1
+                        columns key,value
+                        columns.types int:string
+                        file.inputformat org.apache.hadoop.mapred.TextInputFormat
+                        file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                        location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/dest1
+                        name default.dest1
+                        serialization.ddl struct dest1 { i32 key, string value}
+                        serialization.format 1
+                        serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                        transient_lastDdlTime 1310378280
+                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                      name: default.dest1
+                  TotalFiles: 1
+                  GatherStats: true
+                  MultiFileSpray: false
       Needs Tagging: false
       Path -> Alias:
-        pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt [s]
+        pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket [s]
       Path -> Partition:
-        pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt 
+        pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket 
           Partition
-            base file name: srcbucket0.txt
+            base file name: srcbucket
             input format: org.apache.hadoop.mapred.TextInputFormat
             output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
             properties:
@@ -91,12 +86,12 @@ STAGE PLANS:
               columns.types int:string
               file.inputformat org.apache.hadoop.mapred.TextInputFormat
               file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-              location pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket
+              location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket
               name default.srcbucket
               serialization.ddl struct srcbucket { i32 key, string value}
               serialization.format 1
               serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-              transient_lastDdlTime 1303260542
+              transient_lastDdlTime 1310371847
             serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
           
               input format: org.apache.hadoop.mapred.TextInputFormat
@@ -108,12 +103,12 @@ STAGE PLANS:
                 columns.types int:string
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket
+                location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket
                 name default.srcbucket
                 serialization.ddl struct srcbucket { i32 key, string value}
                 serialization.format 1
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                transient_lastDdlTime 1303260542
+                transient_lastDdlTime 1310371847
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: default.srcbucket
             name: default.srcbucket
@@ -125,14 +120,14 @@ STAGE PLANS:
     Move Operator
       files:
           hdfs directory: true
-          source: pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-19_19-54-27_627_3309354126941173289/-ext-10002
-          destination: pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-19_19-54-27_627_3309354126941173289/-ext-10000
+          source: pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_02-58-00_018_458728813403565509/-ext-10002
+          destination: pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_02-58-00_018_458728813403565509/-ext-10000
 
   Stage: Stage-0
     Move Operator
       tables:
           replace: true
-          source: pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-19_19-54-27_627_3309354126941173289/-ext-10000
+          source: pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_02-58-00_018_458728813403565509/-ext-10000
           table:
               input format: org.apache.hadoop.mapred.TextInputFormat
               output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -142,28 +137,28 @@ STAGE PLANS:
                 columns.types int:string
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/dest1
+                location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/dest1
                 name default.dest1
                 serialization.ddl struct dest1 { i32 key, string value}
                 serialization.format 1
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                transient_lastDdlTime 1303268067
+                transient_lastDdlTime 1310378280
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: default.dest1
-          tmp directory: pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-19_19-54-27_627_3309354126941173289/-ext-10001
+          tmp directory: pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_02-58-00_018_458728813403565509/-ext-10001
 
   Stage: Stage-2
     Stats-Aggr Operator
-      Stats Aggregation Key Prefix: pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-19_19-54-27_627_3309354126941173289/-ext-10000/
+      Stats Aggregation Key Prefix: pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_02-58-00_018_458728813403565509/-ext-10000/
 
   Stage: Stage-3
     Map Reduce
       Alias -> Map Operator Tree:
-        pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-19_19-54-27_627_3309354126941173289/-ext-10002 
+        pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_02-58-00_018_458728813403565509/-ext-10002 
             File Output Operator
               compressed: false
               GlobalTableId: 0
-              directory: pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-19_19-54-27_627_3309354126941173289/-ext-10000
+              directory: pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_02-58-00_018_458728813403565509/-ext-10000
               NumFilesPerFileSink: 1
               table:
                   input format: org.apache.hadoop.mapred.TextInputFormat
@@ -174,12 +169,12 @@ STAGE PLANS:
                     columns.types int:string
                     file.inputformat org.apache.hadoop.mapred.TextInputFormat
                     file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                    location pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/dest1
+                    location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/dest1
                     name default.dest1
                     serialization.ddl struct dest1 { i32 key, string value}
                     serialization.format 1
                     serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                    transient_lastDdlTime 1303268067
+                    transient_lastDdlTime 1310378280
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   name: default.dest1
               TotalFiles: 1
@@ -187,9 +182,9 @@ STAGE PLANS:
               MultiFileSpray: false
       Needs Tagging: false
       Path -> Alias:
-        pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-19_19-54-27_627_3309354126941173289/-ext-10002 [pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-19_19-54-27_627_3309354126941173289/-ext-10002]
+        pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_02-58-00_018_458728813403565509/-ext-10002 [pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_02-58-00_018_458728813403565509/-ext-10002]
       Path -> Partition:
-        pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-19_19-54-27_627_3309354126941173289/-ext-10002 
+        pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_02-58-00_018_458728813403565509/-ext-10002 
           Partition
             base file name: -ext-10002
             input format: org.apache.hadoop.mapred.TextInputFormat
@@ -200,12 +195,12 @@ STAGE PLANS:
               columns.types int:string
               file.inputformat org.apache.hadoop.mapred.TextInputFormat
               file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-              location pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/dest1
+              location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/dest1
               name default.dest1
               serialization.ddl struct dest1 { i32 key, string value}
               serialization.format 1
               serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-              transient_lastDdlTime 1303268067
+              transient_lastDdlTime 1310378280
             serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
           
               input format: org.apache.hadoop.mapred.TextInputFormat
@@ -216,12 +211,12 @@ STAGE PLANS:
                 columns.types int:string
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/dest1
+                location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/dest1
                 name default.dest1
                 serialization.ddl struct dest1 { i32 key, string value}
                 serialization.format 1
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                transient_lastDdlTime 1303268067
+                transient_lastDdlTime 1310378280
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: default.dest1
             name: default.dest1
@@ -242,11 +237,11 @@ POSTHOOK: Lineage: dest1.value SIMPLE [(srcbucket)s.FieldSchema(name:value, type
 PREHOOK: query: SELECT dest1.* FROM dest1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@dest1
-PREHOOK: Output: file:/tmp/sdong/hive_2011-04-19_19-54-33_389_7760677817749293223/-mr-10000
+PREHOOK: Output: file:/tmp/amarsri/hive_2011-07-11_02-58-03_687_2062247448126517612/-mr-10000
 POSTHOOK: query: SELECT dest1.* FROM dest1
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@dest1
-POSTHOOK: Output: file:/tmp/sdong/hive_2011-04-19_19-54-33_389_7760677817749293223/-mr-10000
+POSTHOOK: Output: file:/tmp/amarsri/hive_2011-07-11_02-58-03_687_2062247448126517612/-mr-10000
 POSTHOOK: Lineage: dest1.key SIMPLE [(srcbucket)s.FieldSchema(name:key, type:int, comment:null), ]
 POSTHOOK: Lineage: dest1.value SIMPLE [(srcbucket)s.FieldSchema(name:value, type:string, comment:null), ]
 468	val_469
@@ -522,42 +517,37 @@ STAGE PLANS:
             alias: s
             GatherStats: false
             Filter Operator
-              isSamplingPred: false
+              isSamplingPred: true
               predicate:
                   expr: (((hash(key) & 2147483647) % 4) = 3)
                   type: boolean
-              Filter Operator
-                isSamplingPred: true
-                predicate:
-                    expr: (((hash(key) & 2147483647) % 4) = 3)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: int
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: int
+                        expr: _col1
+                        type: string
+                  sort order: ++
+                  tag: -1
+                  value expressions:
+                        expr: _col0
                         type: int
-                        expr: value
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: int
-                          expr: _col1
-                          type: string
-                    sort order: ++
-                    tag: -1
-                    value expressions:
-                          expr: _col0
-                          type: int
-                          expr: _col1
-                          type: string
       Needs Tagging: false
       Path -> Alias:
-        pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket/srcbucket1.txt [s]
+        pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket [s]
       Path -> Partition:
-        pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket/srcbucket1.txt 
+        pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket 
           Partition
-            base file name: srcbucket1.txt
+            base file name: srcbucket
             input format: org.apache.hadoop.mapred.TextInputFormat
             output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
             properties:
@@ -567,12 +557,12 @@ STAGE PLANS:
               columns.types int:string
               file.inputformat org.apache.hadoop.mapred.TextInputFormat
               file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-              location pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket
+              location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket
               name default.srcbucket
               serialization.ddl struct srcbucket { i32 key, string value}
               serialization.format 1
               serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-              transient_lastDdlTime 1303260542
+              transient_lastDdlTime 1310371847
             serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
           
               input format: org.apache.hadoop.mapred.TextInputFormat
@@ -584,12 +574,12 @@ STAGE PLANS:
                 columns.types int:string
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket
+                location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket
                 name default.srcbucket
                 serialization.ddl struct srcbucket { i32 key, string value}
                 serialization.format 1
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                transient_lastDdlTime 1303260542
+                transient_lastDdlTime 1310371847
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: default.srcbucket
             name: default.srcbucket
@@ -598,9 +588,9 @@ STAGE PLANS:
           File Output Operator
             compressed: false
             GlobalTableId: 0
-            directory: file:/tmp/sdong/hive_2011-04-19_19-54-33_827_389668384025414462/-ext-10001
+            directory: file:/tmp/amarsri/hive_2011-07-11_02-58-03_815_3440650522759974343/-ext-10001
             NumFilesPerFileSink: 1
-            Stats Publishing Key Prefix: file:/tmp/sdong/hive_2011-04-19_19-54-33_827_389668384025414462/-ext-10001/
+            Stats Publishing Key Prefix: file:/tmp/amarsri/hive_2011-07-11_02-58-03_815_3440650522759974343/-ext-10001/
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -621,12 +611,12 @@ PREHOOK: query: SELECT s.* FROM srcbucket TABLESAMPLE (BUCKET 4 OUT OF 4 on key)
 ORDER BY key, value
 PREHOOK: type: QUERY
 PREHOOK: Input: default@srcbucket
-PREHOOK: Output: file:/tmp/sdong/hive_2011-04-19_19-54-34_030_551214422770351063/-mr-10000
+PREHOOK: Output: file:/tmp/amarsri/hive_2011-07-11_02-58-03_854_6271750517263563878/-mr-10000
 POSTHOOK: query: SELECT s.* FROM srcbucket TABLESAMPLE (BUCKET 4 OUT OF 4 on key) s
 ORDER BY key, value
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcbucket
-POSTHOOK: Output: file:/tmp/sdong/hive_2011-04-19_19-54-34_030_551214422770351063/-mr-10000
+POSTHOOK: Output: file:/tmp/amarsri/hive_2011-07-11_02-58-03_854_6271750517263563878/-mr-10000
 POSTHOOK: Lineage: dest1.key SIMPLE [(srcbucket)s.FieldSchema(name:key, type:int, comment:null), ]
 POSTHOOK: Lineage: dest1.value SIMPLE [(srcbucket)s.FieldSchema(name:value, type:string, comment:null), ]
 3	val_4
@@ -892,42 +882,37 @@ STAGE PLANS:
             alias: s
             GatherStats: false
             Filter Operator
-              isSamplingPred: false
+              isSamplingPred: true
               predicate:
                   expr: (((hash(key) & 2147483647) % 2) = 0)
                   type: boolean
-              Filter Operator
-                isSamplingPred: true
-                predicate:
-                    expr: (((hash(key) & 2147483647) % 2) = 0)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: int
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: int
+                        expr: _col1
+                        type: string
+                  sort order: ++
+                  tag: -1
+                  value expressions:
+                        expr: _col0
                         type: int
-                        expr: value
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: int
-                          expr: _col1
-                          type: string
-                    sort order: ++
-                    tag: -1
-                    value expressions:
-                          expr: _col0
-                          type: int
-                          expr: _col1
-                          type: string
       Needs Tagging: false
       Path -> Alias:
-        pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt [s]
+        pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket [s]
       Path -> Partition:
-        pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt 
+        pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket 
           Partition
-            base file name: srcbucket0.txt
+            base file name: srcbucket
             input format: org.apache.hadoop.mapred.TextInputFormat
             output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
             properties:
@@ -937,12 +922,12 @@ STAGE PLANS:
               columns.types int:string
               file.inputformat org.apache.hadoop.mapred.TextInputFormat
               file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-              location pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket
+              location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket
               name default.srcbucket
               serialization.ddl struct srcbucket { i32 key, string value}
               serialization.format 1
               serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-              transient_lastDdlTime 1303260542
+              transient_lastDdlTime 1310371847
             serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
           
               input format: org.apache.hadoop.mapred.TextInputFormat
@@ -954,12 +939,12 @@ STAGE PLANS:
                 columns.types int:string
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket
+                location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket
                 name default.srcbucket
                 serialization.ddl struct srcbucket { i32 key, string value}
                 serialization.format 1
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                transient_lastDdlTime 1303260542
+                transient_lastDdlTime 1310371847
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: default.srcbucket
             name: default.srcbucket
@@ -968,9 +953,9 @@ STAGE PLANS:
           File Output Operator
             compressed: false
             GlobalTableId: 0
-            directory: file:/tmp/sdong/hive_2011-04-19_19-54-37_207_200034802818981990/-ext-10001
+            directory: file:/tmp/amarsri/hive_2011-07-11_02-58-06_669_1410317577849689409/-ext-10001
             NumFilesPerFileSink: 1
-            Stats Publishing Key Prefix: file:/tmp/sdong/hive_2011-04-19_19-54-37_207_200034802818981990/-ext-10001/
+            Stats Publishing Key Prefix: file:/tmp/amarsri/hive_2011-07-11_02-58-06_669_1410317577849689409/-ext-10001/
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -991,12 +976,12 @@ PREHOOK: query: SELECT s.* FROM srcbucket TABLESAMPLE (BUCKET 1 OUT OF 2 on key)
 ORDER BY key, value
 PREHOOK: type: QUERY
 PREHOOK: Input: default@srcbucket
-PREHOOK: Output: file:/tmp/sdong/hive_2011-04-19_19-54-37_421_4651239266027596073/-mr-10000
+PREHOOK: Output: file:/tmp/amarsri/hive_2011-07-11_02-58-06_708_7756573301727009933/-mr-10000
 POSTHOOK: query: SELECT s.* FROM srcbucket TABLESAMPLE (BUCKET 1 OUT OF 2 on key) s
 ORDER BY key, value
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcbucket
-POSTHOOK: Output: file:/tmp/sdong/hive_2011-04-19_19-54-37_421_4651239266027596073/-mr-10000
+POSTHOOK: Output: file:/tmp/amarsri/hive_2011-07-11_02-58-06_708_7756573301727009933/-mr-10000
 POSTHOOK: Lineage: dest1.key SIMPLE [(srcbucket)s.FieldSchema(name:key, type:int, comment:null), ]
 POSTHOOK: Lineage: dest1.value SIMPLE [(srcbucket)s.FieldSchema(name:value, type:string, comment:null), ]
 0	val_0
@@ -1516,40 +1501,35 @@ STAGE PLANS:
             alias: s
             GatherStats: false
             Filter Operator
-              isSamplingPred: false
+              isSamplingPred: true
               predicate:
                   expr: (((hash(key) & 2147483647) % 3) = 0)
                   type: boolean
-              Filter Operator
-                isSamplingPred: true
-                predicate:
-                    expr: (((hash(key) & 2147483647) % 3) = 0)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: int
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
                         type: int
-                        expr: value
+                        expr: _col1
+                        type: string
+                  sort order: ++
+                  tag: -1
+                  value expressions:
+                        expr: _col0
+                        type: int
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: int
-                          expr: _col1
-                          type: string
-                    sort order: ++
-                    tag: -1
-                    value expressions:
-                          expr: _col0
-                          type: int
-                          expr: _col1
-                          type: string
       Needs Tagging: false
       Path -> Alias:
-        pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket [s]
+        pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket [s]
       Path -> Partition:
-        pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket 
+        pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket 
           Partition
             base file name: srcbucket
             input format: org.apache.hadoop.mapred.TextInputFormat
@@ -1561,12 +1541,12 @@ STAGE PLANS:
               columns.types int:string
               file.inputformat org.apache.hadoop.mapred.TextInputFormat
               file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-              location pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket
+              location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket
               name default.srcbucket
               serialization.ddl struct srcbucket { i32 key, string value}
               serialization.format 1
               serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-              transient_lastDdlTime 1303260542
+              transient_lastDdlTime 1310371847
             serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
           
               input format: org.apache.hadoop.mapred.TextInputFormat
@@ -1578,12 +1558,12 @@ STAGE PLANS:
                 columns.types int:string
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket
+                location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket
                 name default.srcbucket
                 serialization.ddl struct srcbucket { i32 key, string value}
                 serialization.format 1
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                transient_lastDdlTime 1303260542
+                transient_lastDdlTime 1310371847
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: default.srcbucket
             name: default.srcbucket
@@ -1592,9 +1572,9 @@ STAGE PLANS:
           File Output Operator
             compressed: false
             GlobalTableId: 0
-            directory: file:/tmp/sdong/hive_2011-04-19_19-54-40_626_8344413354265807082/-ext-10001
+            directory: file:/tmp/amarsri/hive_2011-07-11_02-58-09_360_6989967716610636074/-ext-10001
             NumFilesPerFileSink: 1
-            Stats Publishing Key Prefix: file:/tmp/sdong/hive_2011-04-19_19-54-40_626_8344413354265807082/-ext-10001/
+            Stats Publishing Key Prefix: file:/tmp/amarsri/hive_2011-07-11_02-58-09_360_6989967716610636074/-ext-10001/
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -1615,12 +1595,12 @@ PREHOOK: query: SELECT s.* FROM srcbucket TABLESAMPLE (BUCKET 1 OUT OF 3 on key)
 ORDER BY key, value
 PREHOOK: type: QUERY
 PREHOOK: Input: default@srcbucket
-PREHOOK: Output: file:/tmp/sdong/hive_2011-04-19_19-54-40_714_2969909884270153149/-mr-10000
+PREHOOK: Output: file:/tmp/amarsri/hive_2011-07-11_02-58-09_405_8746850347504403733/-mr-10000
 POSTHOOK: query: SELECT s.* FROM srcbucket TABLESAMPLE (BUCKET 1 OUT OF 3 on key) s
 ORDER BY key, value
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcbucket
-POSTHOOK: Output: file:/tmp/sdong/hive_2011-04-19_19-54-40_714_2969909884270153149/-mr-10000
+POSTHOOK: Output: file:/tmp/amarsri/hive_2011-07-11_02-58-09_405_8746850347504403733/-mr-10000
 POSTHOOK: Lineage: dest1.key SIMPLE [(srcbucket)s.FieldSchema(name:key, type:int, comment:null), ]
 POSTHOOK: Lineage: dest1.value SIMPLE [(srcbucket)s.FieldSchema(name:value, type:string, comment:null), ]
 0	val_0
@@ -1983,40 +1963,35 @@ STAGE PLANS:
             alias: s
             GatherStats: false
             Filter Operator
-              isSamplingPred: false
+              isSamplingPred: true
               predicate:
                   expr: (((hash(key) & 2147483647) % 3) = 1)
                   type: boolean
-              Filter Operator
-                isSamplingPred: true
-                predicate:
-                    expr: (((hash(key) & 2147483647) % 3) = 1)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: int
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
                         type: int
-                        expr: value
+                        expr: _col1
+                        type: string
+                  sort order: ++
+                  tag: -1
+                  value expressions:
+                        expr: _col0
+                        type: int
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: int
-                          expr: _col1
-                          type: string
-                    sort order: ++
-                    tag: -1
-                    value expressions:
-                          expr: _col0
-                          type: int
-                          expr: _col1
-                          type: string
       Needs Tagging: false
       Path -> Alias:
-        pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket [s]
+        pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket [s]
       Path -> Partition:
-        pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket 
+        pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket 
           Partition
             base file name: srcbucket
             input format: org.apache.hadoop.mapred.TextInputFormat
@@ -2028,12 +2003,12 @@ STAGE PLANS:
               columns.types int:string
               file.inputformat org.apache.hadoop.mapred.TextInputFormat
               file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-              location pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket
+              location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket
               name default.srcbucket
               serialization.ddl struct srcbucket { i32 key, string value}
               serialization.format 1
               serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-              transient_lastDdlTime 1303260542
+              transient_lastDdlTime 1310371847
             serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
           
               input format: org.apache.hadoop.mapred.TextInputFormat
@@ -2045,12 +2020,12 @@ STAGE PLANS:
                 columns.types int:string
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket
+                location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket
                 name default.srcbucket
                 serialization.ddl struct srcbucket { i32 key, string value}
                 serialization.format 1
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                transient_lastDdlTime 1303260542
+                transient_lastDdlTime 1310371847
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: default.srcbucket
             name: default.srcbucket
@@ -2059,9 +2034,9 @@ STAGE PLANS:
           File Output Operator
             compressed: false
             GlobalTableId: 0
-            directory: file:/tmp/sdong/hive_2011-04-19_19-54-43_892_7813003909078968435/-ext-10001
+            directory: file:/tmp/amarsri/hive_2011-07-11_02-58-12_091_1241249343366878880/-ext-10001
             NumFilesPerFileSink: 1
-            Stats Publishing Key Prefix: file:/tmp/sdong/hive_2011-04-19_19-54-43_892_7813003909078968435/-ext-10001/
+            Stats Publishing Key Prefix: file:/tmp/amarsri/hive_2011-07-11_02-58-12_091_1241249343366878880/-ext-10001/
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -2082,12 +2057,12 @@ PREHOOK: query: SELECT s.* FROM srcbucket TABLESAMPLE (BUCKET 2 OUT OF 3 on key)
 ORDER BY key, value
 PREHOOK: type: QUERY
 PREHOOK: Input: default@srcbucket
-PREHOOK: Output: file:/tmp/sdong/hive_2011-04-19_19-54-43_980_1056408795977903895/-mr-10000
+PREHOOK: Output: file:/tmp/amarsri/hive_2011-07-11_02-58-12_130_7467195593406386569/-mr-10000
 POSTHOOK: query: SELECT s.* FROM srcbucket TABLESAMPLE (BUCKET 2 OUT OF 3 on key) s
 ORDER BY key, value
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcbucket
-POSTHOOK: Output: file:/tmp/sdong/hive_2011-04-19_19-54-43_980_1056408795977903895/-mr-10000
+POSTHOOK: Output: file:/tmp/amarsri/hive_2011-07-11_02-58-12_130_7467195593406386569/-mr-10000
 POSTHOOK: Lineage: dest1.key SIMPLE [(srcbucket)s.FieldSchema(name:key, type:int, comment:null), ]
 POSTHOOK: Lineage: dest1.value SIMPLE [(srcbucket)s.FieldSchema(name:value, type:string, comment:null), ]
 1	val_2
@@ -2436,43 +2411,37 @@ STAGE PLANS:
             alias: s
             GatherStats: false
             Filter Operator
-              isSamplingPred: false
+              isSamplingPred: true
               predicate:
                   expr: (((hash(key) & 2147483647) % 2) = 0)
                   type: boolean
-              Filter Operator
-                isSamplingPred: true
-                predicate:
-                    expr: (((hash(key) & 2147483647) % 2) = 0)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: int
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
                         type: int
-                        expr: value
+                        expr: _col1
+                        type: string
+                  sort order: ++
+                  tag: -1
+                  value expressions:
+                        expr: _col0
+                        type: int
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: int
-                          expr: _col1
-                          type: string
-                    sort order: ++
-                    tag: -1
-                    value expressions:
-                          expr: _col0
-                          type: int
-                          expr: _col1
-                          type: string
       Needs Tagging: false
       Path -> Alias:
-        pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket2/srcbucket20.txt [s]
-        pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket2/srcbucket22.txt [s]
+        pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket2 [s]
       Path -> Partition:
-        pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket2/srcbucket20.txt 
+        pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket2 
           Partition
-            base file name: srcbucket20.txt
+            base file name: srcbucket2
             input format: org.apache.hadoop.mapred.TextInputFormat
             output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
             properties:
@@ -2482,12 +2451,12 @@ STAGE PLANS:
               columns.types int:string
               file.inputformat org.apache.hadoop.mapred.TextInputFormat
               file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-              location pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket2
+              location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket2
               name default.srcbucket2
               serialization.ddl struct srcbucket2 { i32 key, string value}
               serialization.format 1
               serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-              transient_lastDdlTime 1303260544
+              transient_lastDdlTime 1310371848
             serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
           
               input format: org.apache.hadoop.mapred.TextInputFormat
@@ -2499,50 +2468,12 @@ STAGE PLANS:
                 columns.types int:string
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket2
+                location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket2
                 name default.srcbucket2
                 serialization.ddl struct srcbucket2 { i32 key, string value}
                 serialization.format 1
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                transient_lastDdlTime 1303260544
-              serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-              name: default.srcbucket2
-            name: default.srcbucket2
-        pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket2/srcbucket22.txt 
-          Partition
-            base file name: srcbucket22.txt
-            input format: org.apache.hadoop.mapred.TextInputFormat
-            output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-            properties:
-              bucket_count 4
-              bucket_field_name key
-              columns key,value
-              columns.types int:string
-              file.inputformat org.apache.hadoop.mapred.TextInputFormat
-              file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-              location pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket2
-              name default.srcbucket2
-              serialization.ddl struct srcbucket2 { i32 key, string value}
-              serialization.format 1
-              serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-              transient_lastDdlTime 1303260544
-            serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-          
-              input format: org.apache.hadoop.mapred.TextInputFormat
-              output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-              properties:
-                bucket_count 4
-                bucket_field_name key
-                columns key,value
-                columns.types int:string
-                file.inputformat org.apache.hadoop.mapred.TextInputFormat
-                file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket2
-                name default.srcbucket2
-                serialization.ddl struct srcbucket2 { i32 key, string value}
-                serialization.format 1
-                serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                transient_lastDdlTime 1303260544
+                transient_lastDdlTime 1310371848
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: default.srcbucket2
             name: default.srcbucket2
@@ -2551,9 +2482,9 @@ STAGE PLANS:
           File Output Operator
             compressed: false
             GlobalTableId: 0
-            directory: file:/tmp/sdong/hive_2011-04-19_19-54-47_115_1778465985574852574/-ext-10001
+            directory: file:/tmp/amarsri/hive_2011-07-11_02-58-14_778_4777537004727741553/-ext-10001
             NumFilesPerFileSink: 1
-            Stats Publishing Key Prefix: file:/tmp/sdong/hive_2011-04-19_19-54-47_115_1778465985574852574/-ext-10001/
+            Stats Publishing Key Prefix: file:/tmp/amarsri/hive_2011-07-11_02-58-14_778_4777537004727741553/-ext-10001/
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -2574,12 +2505,12 @@ PREHOOK: query: SELECT s.* FROM srcbucket2 TABLESAMPLE (BUCKET 1 OUT OF 2 on key
 ORDER BY key, value
 PREHOOK: type: QUERY
 PREHOOK: Input: default@srcbucket2
-PREHOOK: Output: file:/tmp/sdong/hive_2011-04-19_19-54-47_633_8309063970411271815/-mr-10000
+PREHOOK: Output: file:/tmp/amarsri/hive_2011-07-11_02-58-14_817_7365496467903983867/-mr-10000
 POSTHOOK: query: SELECT s.* FROM srcbucket2 TABLESAMPLE (BUCKET 1 OUT OF 2 on key) s
 ORDER BY key, value
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcbucket2
-POSTHOOK: Output: file:/tmp/sdong/hive_2011-04-19_19-54-47_633_8309063970411271815/-mr-10000
+POSTHOOK: Output: file:/tmp/amarsri/hive_2011-07-11_02-58-14_817_7365496467903983867/-mr-10000
 POSTHOOK: Lineage: dest1.key SIMPLE [(srcbucket)s.FieldSchema(name:key, type:int, comment:null), ]
 POSTHOOK: Lineage: dest1.value SIMPLE [(srcbucket)s.FieldSchema(name:value, type:string, comment:null), ]
 0	val_0
@@ -2588,26 +2519,62 @@ POSTHOOK: Lineage: dest1.value SIMPLE [(srcbucket)s.FieldSchema(name:value, type
 2	val_2
 4	val_4
 8	val_8
+10	val_10
+12	val_12
+12	val_12
+18	val_18
+18	val_18
 20	val_20
 24	val_24
 24	val_24
 26	val_26
 26	val_26
 28	val_28
+30	val_30
+34	val_34
 42	val_42
 42	val_42
 44	val_44
+54	val_54
+58	val_58
+58	val_58
 64	val_64
 66	val_66
+70	val_70
+70	val_70
+70	val_70
+72	val_72
+72	val_72
+74	val_74
+76	val_76
+76	val_76
+78	val_78
 80	val_80
 82	val_82
 84	val_84
 84	val_84
 86	val_86
+90	val_90
+90	val_90
+90	val_90
+92	val_92
+96	val_96
+98	val_98
+98	val_98
+100	val_100
+100	val_100
+104	val_104
+104	val_104
 114	val_114
 116	val_116
 118	val_118
 118	val_118
+120	val_120
+120	val_120
+126	val_126
+128	val_128
+128	val_128
+128	val_128
 134	val_134
 134	val_134
 136	val_136
@@ -2615,11 +2582,19 @@ POSTHOOK: Lineage: dest1.value SIMPLE [(srcbucket)s.FieldSchema(name:value, type
 138	val_138
 138	val_138
 138	val_138
+146	val_146
+146	val_146
 150	val_150
 152	val_152
 152	val_152
 156	val_156
 158	val_158
+160	val_160
+162	val_162
+164	val_164
+164	val_164
+166	val_166
+168	val_168
 170	val_170
 172	val_172
 172	val_172
@@ -2628,6 +2603,8 @@ POSTHOOK: Lineage: dest1.value SIMPLE [(srcbucket)s.FieldSchema(name:value, type
 176	val_176
 176	val_176
 178	val_178
+180	val_180
+186	val_186
 190	val_190
 192	val_192
 194	val_194
@@ -2638,18 +2615,38 @@ POSTHOOK: Lineage: dest1.value SIMPLE [(srcbucket)s.FieldSchema(name:value, type
 208	val_208
 208	val_208
 208	val_208
+214	val_214
+216	val_216
+216	val_216
+218	val_218
 222	val_222
 224	val_224
 224	val_224
 226	val_226
 228	val_228
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+238	val_238
+238	val_238
 242	val_242
 242	val_242
 244	val_244
 248	val_248
+252	val_252
+256	val_256
+256	val_256
+258	val_258
 260	val_260
 262	val_262
 266	val_266
+272	val_272
+272	val_272
+274	val_274
+278	val_278
+278	val_278
 280	val_280
 280	val_280
 282	val_282
@@ -2658,6 +2655,14 @@ POSTHOOK: Lineage: dest1.value SIMPLE [(srcbucket)s.FieldSchema(name:value, type
 286	val_286
 288	val_288
 288	val_288
+292	val_292
+296	val_296
+298	val_298
+298	val_298
+298	val_298
+302	val_302
+306	val_306
+308	val_308
 310	val_310
 316	val_316
 316	val_316
@@ -2665,12 +2670,34 @@ POSTHOOK: Lineage: dest1.value SIMPLE [(srcbucket)s.FieldSchema(name:value, type
 318	val_318
 318	val_318
 318	val_318
+322	val_322
+322	val_322
 332	val_332
 336	val_336
 338	val_338
+342	val_342
+342	val_342
+344	val_344
+344	val_344
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
 356	val_356
+360	val_360
+362	val_362
+364	val_364
+366	val_366
+368	val_368
 374	val_374
 378	val_378
+382	val_382
+382	val_382
+384	val_384
+384	val_384
+384	val_384
+386	val_386
 392	val_392
 394	val_394
 396	val_396
@@ -2684,11 +2711,28 @@ POSTHOOK: Lineage: dest1.value SIMPLE [(srcbucket)s.FieldSchema(name:value, type
 406	val_406
 406	val_406
 406	val_406
+414	val_414
+414	val_414
+418	val_418
 424	val_424
 424	val_424
+430	val_430
+430	val_430
+430	val_430
+432	val_432
+436	val_436
+438	val_438
+438	val_438
+438	val_438
 444	val_444
 446	val_446
 448	val_448
+452	val_452
+454	val_454
+454	val_454
+454	val_454
+458	val_458
+458	val_458
 460	val_460
 462	val_462
 462	val_462
@@ -2699,11 +2743,23 @@ POSTHOOK: Lineage: dest1.value SIMPLE [(srcbucket)s.FieldSchema(name:value, type
 468	val_468
 468	val_468
 468	val_468
+470	val_470
+472	val_472
+478	val_478
+478	val_478
 480	val_480
 480	val_480
 480	val_480
 482	val_482
 484	val_484
+490	val_490
+492	val_492
+492	val_492
+494	val_494
+496	val_496
+498	val_498
+498	val_498
+498	val_498
 PREHOOK: query: EXPLAIN EXTENDED SELECT s.* FROM srcbucket2 TABLESAMPLE (BUCKET 2 OUT OF 4 on key) s
 ORDER BY key, value
 PREHOOK: type: QUERY
@@ -2728,42 +2784,37 @@ STAGE PLANS:
             alias: s
             GatherStats: false
             Filter Operator
-              isSamplingPred: false
+              isSamplingPred: true
               predicate:
                   expr: (((hash(key) & 2147483647) % 4) = 1)
                   type: boolean
-              Filter Operator
-                isSamplingPred: true
-                predicate:
-                    expr: (((hash(key) & 2147483647) % 4) = 1)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: int
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
                         type: int
-                        expr: value
+                        expr: _col1
+                        type: string
+                  sort order: ++
+                  tag: -1
+                  value expressions:
+                        expr: _col0
+                        type: int
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: int
-                          expr: _col1
-                          type: string
-                    sort order: ++
-                    tag: -1
-                    value expressions:
-                          expr: _col0
-                          type: int
-                          expr: _col1
-                          type: string
       Needs Tagging: false
       Path -> Alias:
-        pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket2/srcbucket21.txt [s]
+        pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket2 [s]
       Path -> Partition:
-        pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket2/srcbucket21.txt 
+        pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket2 
           Partition
-            base file name: srcbucket21.txt
+            base file name: srcbucket2
             input format: org.apache.hadoop.mapred.TextInputFormat
             output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
             properties:
@@ -2773,12 +2824,12 @@ STAGE PLANS:
               columns.types int:string
               file.inputformat org.apache.hadoop.mapred.TextInputFormat
               file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-              location pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket2
+              location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket2
               name default.srcbucket2
               serialization.ddl struct srcbucket2 { i32 key, string value}
               serialization.format 1
               serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-              transient_lastDdlTime 1303260544
+              transient_lastDdlTime 1310371848
             serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
           
               input format: org.apache.hadoop.mapred.TextInputFormat
@@ -2790,12 +2841,12 @@ STAGE PLANS:
                 columns.types int:string
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket2
+                location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket2
                 name default.srcbucket2
                 serialization.ddl struct srcbucket2 { i32 key, string value}
                 serialization.format 1
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                transient_lastDdlTime 1303260544
+                transient_lastDdlTime 1310371848
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: default.srcbucket2
             name: default.srcbucket2
@@ -2804,9 +2855,9 @@ STAGE PLANS:
           File Output Operator
             compressed: false
             GlobalTableId: 0
-            directory: file:/tmp/sdong/hive_2011-04-19_19-54-51_203_3981912443934260367/-ext-10001
+            directory: file:/tmp/amarsri/hive_2011-07-11_02-58-17_484_3834914689711003679/-ext-10001
             NumFilesPerFileSink: 1
-            Stats Publishing Key Prefix: file:/tmp/sdong/hive_2011-04-19_19-54-51_203_3981912443934260367/-ext-10001/
+            Stats Publishing Key Prefix: file:/tmp/amarsri/hive_2011-07-11_02-58-17_484_3834914689711003679/-ext-10001/
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -2827,34 +2878,115 @@ PREHOOK: query: SELECT s.* FROM srcbucket2 TABLESAMPLE (BUCKET 2 OUT OF 4 on key
 ORDER BY key, value
 PREHOOK: type: QUERY
 PREHOOK: Input: default@srcbucket2
-PREHOOK: Output: file:/tmp/sdong/hive_2011-04-19_19-54-51_536_2222098349658422634/-mr-10000
+PREHOOK: Output: file:/tmp/amarsri/hive_2011-07-11_02-58-17_524_6116746546442362470/-mr-10000
 POSTHOOK: query: SELECT s.* FROM srcbucket2 TABLESAMPLE (BUCKET 2 OUT OF 4 on key) s
 ORDER BY key, value
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcbucket2
-POSTHOOK: Output: file:/tmp/sdong/hive_2011-04-19_19-54-51_536_2222098349658422634/-mr-10000
+POSTHOOK: Output: file:/tmp/amarsri/hive_2011-07-11_02-58-17_524_6116746546442362470/-mr-10000
 POSTHOOK: Lineage: dest1.key SIMPLE [(srcbucket)s.FieldSchema(name:key, type:int, comment:null), ]
 POSTHOOK: Lineage: dest1.value SIMPLE [(srcbucket)s.FieldSchema(name:value, type:string, comment:null), ]
 5	val_5
 5	val_5
 5	val_5
 9	val_9
+17	val_17
+33	val_33
+37	val_37
+37	val_37
 41	val_41
+53	val_53
+57	val_57
+65	val_65
+69	val_69
+77	val_77
 85	val_85
+97	val_97
+97	val_97
+105	val_105
+113	val_113
+113	val_113
+125	val_125
+125	val_125
+129	val_129
+129	val_129
 133	val_133
 137	val_137
 137	val_137
+145	val_145
+149	val_149
+149	val_149
+153	val_153
+157	val_157
+165	val_165
+165	val_165
+169	val_169
+169	val_169
+169	val_169
+169	val_169
 177	val_177
+181	val_181
+189	val_189
+193	val_193
+193	val_193
+193	val_193
+197	val_197
+197	val_197
+201	val_201
+205	val_205
+205	val_205
+209	val_209
+209	val_209
+213	val_213
+213	val_213
+217	val_217
+217	val_217
 221	val_221
 221	val_221
 229	val_229
 229	val_229
+233	val_233
+233	val_233
+237	val_237
+237	val_237
+241	val_241
+249	val_249
+257	val_257
 265	val_265
 265	val_265
+273	val_273
+273	val_273
+273	val_273
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+281	val_281
+281	val_281
+285	val_285
+289	val_289
+305	val_305
+309	val_309
+309	val_309
 317	val_317
 317	val_317
+321	val_321
+321	val_321
+325	val_325
+325	val_325
+333	val_333
+333	val_333
+341	val_341
+345	val_345
 353	val_353
 353	val_353
+365	val_365
+369	val_369
+369	val_369
+369	val_369
+373	val_373
+377	val_377
+389	val_389
 393	val_393
 397	val_397
 397	val_397
@@ -2866,13 +2998,32 @@ POSTHOOK: Lineage: dest1.value SIMPLE [(srcbucket)s.FieldSchema(name:value, type
 409	val_409
 409	val_409
 409	val_409
+413	val_413
+413	val_413
+417	val_417
+417	val_417
+417	val_417
+421	val_421
+429	val_429
+429	val_429
+437	val_437
 449	val_449
+453	val_453
+457	val_457
+469	val_469
+469	val_469
+469	val_469
+469	val_469
+469	val_469
+477	val_477
 481	val_481
 485	val_485
 489	val_489
 489	val_489
 489	val_489
 489	val_489
+493	val_493
+497	val_497
 PREHOOK: query: CREATE TABLE empty_bucket (key int, value string) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 POSTHOOK: query: CREATE TABLE empty_bucket (key int, value string) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
@@ -2904,44 +3055,80 @@ STAGE PLANS:
             alias: s
             GatherStats: false
             Filter Operator
-              isSamplingPred: false
+              isSamplingPred: true
               predicate:
                   expr: (((hash(key) & 2147483647) % 2) = 0)
                   type: boolean
-              Filter Operator
-                isSamplingPred: true
-                predicate:
-                    expr: (((hash(key) & 2147483647) % 2) = 0)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
+              Select Operator
+                expressions:
+                      expr: key
+                      type: int
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
                         type: int
-                        expr: value
+                        expr: _col1
+                        type: string
+                  sort order: ++
+                  tag: -1
+                  value expressions:
+                        expr: _col0
+                        type: int
+                        expr: _col1
                         type: string
-                  outputColumnNames: _col0, _col1
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: int
-                          expr: _col1
-                          type: string
-                    sort order: ++
-                    tag: -1
-                    value expressions:
-                          expr: _col0
-                          type: int
-                          expr: _col1
-                          type: string
       Needs Tagging: false
+      Path -> Alias:
+        pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/empty_bucket [s]
+      Path -> Partition:
+        pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/empty_bucket 
+          Partition
+            base file name: empty_bucket
+            input format: org.apache.hadoop.mapred.TextInputFormat
+            output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+            properties:
+              bucket_count 2
+              bucket_field_name key
+              columns key,value
+              columns.types int:string
+              file.inputformat org.apache.hadoop.mapred.TextInputFormat
+              file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+              location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/empty_bucket
+              name default.empty_bucket
+              serialization.ddl struct empty_bucket { i32 key, string value}
+              serialization.format 1
+              serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+              transient_lastDdlTime 1310378300
+            serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+          
+              input format: org.apache.hadoop.mapred.TextInputFormat
+              output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+              properties:
+                bucket_count 2
+                bucket_field_name key
+                columns key,value
+                columns.types int:string
+                file.inputformat org.apache.hadoop.mapred.TextInputFormat
+                file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/empty_bucket
+                name default.empty_bucket
+                serialization.ddl struct empty_bucket { i32 key, string value}
+                serialization.format 1
+                serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                transient_lastDdlTime 1310378300
+              serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+              name: default.empty_bucket
+            name: default.empty_bucket
       Reduce Operator Tree:
         Extract
           File Output Operator
             compressed: false
             GlobalTableId: 0
-            directory: file:/tmp/sdong/hive_2011-04-19_19-54-54_970_837635628196553945/-ext-10001
+            directory: file:/tmp/amarsri/hive_2011-07-11_02-58-20_219_7398883575090456577/-ext-10001
             NumFilesPerFileSink: 1
-            Stats Publishing Key Prefix: file:/tmp/sdong/hive_2011-04-19_19-54-54_970_837635628196553945/-ext-10001/
+            Stats Publishing Key Prefix: file:/tmp/amarsri/hive_2011-07-11_02-58-20_219_7398883575090456577/-ext-10001/
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -2962,11 +3149,11 @@ PREHOOK: query: SELECT s.* FROM empty_bucket TABLESAMPLE (BUCKET 1 OUT OF 2 on k
 ORDER BY key, value
 PREHOOK: type: QUERY
 PREHOOK: Input: default@empty_bucket
-PREHOOK: Output: file:/tmp/sdong/hive_2011-04-19_19-54-55_069_4633328979298722063/-mr-10000
+PREHOOK: Output: file:/tmp/amarsri/hive_2011-07-11_02-58-20_257_2520214403406970744/-mr-10000
 POSTHOOK: query: SELECT s.* FROM empty_bucket TABLESAMPLE (BUCKET 1 OUT OF 2 on key) s
 ORDER BY key, value
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@empty_bucket
-POSTHOOK: Output: file:/tmp/sdong/hive_2011-04-19_19-54-55_069_4633328979298722063/-mr-10000
+POSTHOOK: Output: file:/tmp/amarsri/hive_2011-07-11_02-58-20_257_2520214403406970744/-mr-10000
 POSTHOOK: Lineage: dest1.key SIMPLE [(srcbucket)s.FieldSchema(name:key, type:int, comment:null), ]
 POSTHOOK: Lineage: dest1.value SIMPLE [(srcbucket)s.FieldSchema(name:value, type:string, comment:null), ]
diff --git a/ql/src/test/results/clientpositive/sample7.q.out b/ql/src/test/results/clientpositive/sample7.q.out
index 534f289666..f1076488ce 100644
--- a/ql/src/test/results/clientpositive/sample7.q.out
+++ b/ql/src/test/results/clientpositive/sample7.q.out
@@ -37,51 +37,46 @@ STAGE PLANS:
             Filter Operator
               isSamplingPred: false
               predicate:
-                  expr: ((((hash(key) & 2147483647) % 4) = 0) and (key > 100))
+                  expr: (key > 100)
                   type: boolean
               Filter Operator
                 isSamplingPred: true
                 predicate:
                     expr: (((hash(key) & 2147483647) % 4) = 0)
                     type: boolean
-                Filter Operator
-                  isSamplingPred: false
-                  predicate:
-                      expr: (key > 100)
-                      type: boolean
-                  Select Operator
-                    expressions:
-                          expr: key
-                          type: int
-                          expr: value
-                          type: string
-                    outputColumnNames: _col0, _col1
-                    File Output Operator
-                      compressed: false
-                      GlobalTableId: 1
-                      directory: pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-19_19-54-58_518_7055483572049586597/-ext-10002
-                      NumFilesPerFileSink: 1
-                      Stats Publishing Key Prefix: pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-19_19-54-58_518_7055483572049586597/-ext-10000/
-                      table:
-                          input format: org.apache.hadoop.mapred.TextInputFormat
-                          output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                          properties:
-                            bucket_count -1
-                            columns key,value
-                            columns.types int:string
-                            file.inputformat org.apache.hadoop.mapred.TextInputFormat
-                            file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                            location pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/dest1
-                            name default.dest1
-                            serialization.ddl struct dest1 { i32 key, string value}
-                            serialization.format 1
-                            serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                            transient_lastDdlTime 1303268098
-                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                          name: default.dest1
-                      TotalFiles: 1
-                      GatherStats: true
-                      MultiFileSpray: false
+                Select Operator
+                  expressions:
+                        expr: key
+                        type: int
+                        expr: value
+                        type: string
+                  outputColumnNames: _col0, _col1
+                  File Output Operator
+                    compressed: false
+                    GlobalTableId: 1
+                    directory: pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_02-58-23_160_5772419563904958236/-ext-10002
+                    NumFilesPerFileSink: 1
+                    Stats Publishing Key Prefix: pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_02-58-23_160_5772419563904958236/-ext-10000/
+                    table:
+                        input format: org.apache.hadoop.mapred.TextInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                        properties:
+                          bucket_count -1
+                          columns key,value
+                          columns.types int:string
+                          file.inputformat org.apache.hadoop.mapred.TextInputFormat
+                          file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                          location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/dest1
+                          name default.dest1
+                          serialization.ddl struct dest1 { i32 key, string value}
+                          serialization.format 1
+                          serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                          transient_lastDdlTime 1310378303
+                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                        name: default.dest1
+                    TotalFiles: 1
+                    GatherStats: true
+                    MultiFileSpray: false
       Needs Tagging: false
       Path -> Alias:
         pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt [s]
diff --git a/ql/src/test/results/clientpositive/sample8.q.out b/ql/src/test/results/clientpositive/sample8.q.out
index ce188e1c8a..ffdbb7cc6d 100644
--- a/ql/src/test/results/clientpositive/sample8.q.out
+++ b/ql/src/test/results/clientpositive/sample8.q.out
@@ -33,49 +33,39 @@ STAGE PLANS:
             alias: s
             GatherStats: false
             Filter Operator
-              isSamplingPred: false
+              isSamplingPred: true
               predicate:
                   expr: (((hash(key) & 2147483647) % 1) = 0)
                   type: boolean
-              Filter Operator
-                isSamplingPred: true
-                predicate:
-                    expr: (((hash(key) & 2147483647) % 1) = 0)
-                    type: boolean
-                Reduce Output Operator
-                  sort order: 
-                  tag: 0
-                  value expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
-                        expr: ds
-                        type: string
-                        expr: hr
-                        type: string
+              Reduce Output Operator
+                sort order: 
+                tag: 0
+                value expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                      expr: ds
+                      type: string
+                      expr: hr
+                      type: string
         t 
           TableScan
             alias: t
             GatherStats: false
             Filter Operator
-              isSamplingPred: false
+              isSamplingPred: true
               predicate:
                   expr: (((hash(key) & 2147483647) % 10) = 0)
                   type: boolean
-              Filter Operator
-                isSamplingPred: true
-                predicate:
-                    expr: (((hash(key) & 2147483647) % 10) = 0)
-                    type: boolean
-                Reduce Output Operator
-                  sort order: 
-                  tag: 1
-                  value expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
+              Reduce Output Operator
+                sort order: 
+                tag: 1
+                value expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
       Needs Tagging: true
       Path -> Alias:
         pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 [t, s]
diff --git a/ql/src/test/results/clientpositive/sample9.q.out b/ql/src/test/results/clientpositive/sample9.q.out
index 9c69a6fd17..dd71c69a3a 100644
--- a/ql/src/test/results/clientpositive/sample9.q.out
+++ b/ql/src/test/results/clientpositive/sample9.q.out
@@ -22,52 +22,47 @@ STAGE PLANS:
             alias: a
             GatherStats: false
             Filter Operator
-              isSamplingPred: false
+              isSamplingPred: true
               predicate:
                   expr: (((hash(key) & 2147483647) % 2) = 0)
                   type: boolean
-              Filter Operator
-                isSamplingPred: true
-                predicate:
-                    expr: (((hash(key) & 2147483647) % 2) = 0)
-                    type: boolean
+              Select Operator
+                expressions:
+                      expr: key
+                      type: int
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
                 Select Operator
                   expressions:
-                        expr: key
+                        expr: _col0
                         type: int
-                        expr: value
+                        expr: _col1
                         type: string
                   outputColumnNames: _col0, _col1
-                  Select Operator
-                    expressions:
-                          expr: _col0
-                          type: int
-                          expr: _col1
-                          type: string
-                    outputColumnNames: _col0, _col1
-                    File Output Operator
-                      compressed: false
-                      GlobalTableId: 0
-                      directory: file:/tmp/sdong/hive_2011-04-19_19-55-15_093_8705959538820118982/-ext-10001
-                      NumFilesPerFileSink: 1
-                      Stats Publishing Key Prefix: file:/tmp/sdong/hive_2011-04-19_19-55-15_093_8705959538820118982/-ext-10001/
-                      table:
-                          input format: org.apache.hadoop.mapred.TextInputFormat
-                          output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                          properties:
-                            columns _col0,_col1
-                            columns.types int:string
-                            serialization.format 1
-                      TotalFiles: 1
-                      GatherStats: false
-                      MultiFileSpray: false
+                  File Output Operator
+                    compressed: false
+                    GlobalTableId: 0
+                    directory: file:/tmp/amarsri/hive_2011-07-11_02-58-35_476_3346956740908751236/-ext-10001
+                    NumFilesPerFileSink: 1
+                    Stats Publishing Key Prefix: file:/tmp/amarsri/hive_2011-07-11_02-58-35_476_3346956740908751236/-ext-10001/
+                    table:
+                        input format: org.apache.hadoop.mapred.TextInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                        properties:
+                          columns _col0,_col1
+                          columns.types int:string
+                          serialization.format 1
+                    TotalFiles: 1
+                    GatherStats: false
+                    MultiFileSpray: false
       Needs Tagging: false
       Path -> Alias:
-        pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt [s:a]
+        pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket [s:a]
       Path -> Partition:
-        pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt 
+        pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket 
           Partition
-            base file name: srcbucket0.txt
+            base file name: srcbucket
             input format: org.apache.hadoop.mapred.TextInputFormat
             output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
             properties:
@@ -77,12 +72,12 @@ STAGE PLANS:
               columns.types int:string
               file.inputformat org.apache.hadoop.mapred.TextInputFormat
               file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-              location pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket
+              location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket
               name default.srcbucket
               serialization.ddl struct srcbucket { i32 key, string value}
               serialization.format 1
               serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-              transient_lastDdlTime 1303260542
+              transient_lastDdlTime 1310371847
             serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
           
               input format: org.apache.hadoop.mapred.TextInputFormat
@@ -94,12 +89,12 @@ STAGE PLANS:
                 columns.types int:string
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket
+                location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket
                 name default.srcbucket
                 serialization.ddl struct srcbucket { i32 key, string value}
                 serialization.format 1
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                transient_lastDdlTime 1303260542
+                transient_lastDdlTime 1310371847
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: default.srcbucket
             name: default.srcbucket
@@ -113,12 +108,12 @@ PREHOOK: query: SELECT s.*
 FROM (SELECT a.* FROM srcbucket TABLESAMPLE (BUCKET 1 OUT OF 2 on key) a) s
 PREHOOK: type: QUERY
 PREHOOK: Input: default@srcbucket
-PREHOOK: Output: file:/tmp/sdong/hive_2011-04-19_19-55-15_304_876052844698471163/-mr-10000
+PREHOOK: Output: file:/tmp/amarsri/hive_2011-07-11_02-58-35_521_5870581689660228083/-mr-10000
 POSTHOOK: query: SELECT s.*
 FROM (SELECT a.* FROM srcbucket TABLESAMPLE (BUCKET 1 OUT OF 2 on key) a) s
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcbucket
-POSTHOOK: Output: file:/tmp/sdong/hive_2011-04-19_19-55-15_304_876052844698471163/-mr-10000
+POSTHOOK: Output: file:/tmp/amarsri/hive_2011-07-11_02-58-35_521_5870581689660228083/-mr-10000
 474	val_475
 62	val_63
 468	val_469
diff --git a/ql/src/test/results/clientpositive/semijoin.q.out b/ql/src/test/results/clientpositive/semijoin.q.out
index 3792fa5d8f..1891a6e0e9 100644
--- a/ql/src/test/results/clientpositive/semijoin.q.out
+++ b/ql/src/test/results/clientpositive/semijoin.q.out
@@ -517,33 +517,29 @@ STAGE PLANS:
               predicate:
                   expr: (key < '15')
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < '15')
-                    type: boolean
-                Select Operator
-                  expressions:
+              Select Operator
+                expressions:
+                      expr: key
+                      type: int
+                outputColumnNames: key
+                Group By Operator
+                  bucketGroup: false
+                  keys:
                         expr: key
                         type: int
-                  outputColumnNames: key
-                  Group By Operator
-                    bucketGroup: false
-                    keys:
-                          expr: key
+                        expr: key
+                        type: int
+                  mode: hash
+                  outputColumnNames: _col0, _col1
+                  Reduce Output Operator
+                    key expressions:
+                          expr: _col1
                           type: int
-                          expr: key
+                    sort order: +
+                    Map-reduce partition columns:
+                          expr: _col1
                           type: int
-                    mode: hash
-                    outputColumnNames: _col0, _col1
-                    Reduce Output Operator
-                      key expressions:
-                            expr: _col1
-                            type: int
-                      sort order: +
-                      Map-reduce partition columns:
-                            expr: _col1
-                            type: int
-                      tag: 1
+                    tag: 1
       Reduce Operator Tree:
         Join Operator
           condition map:
@@ -653,35 +649,31 @@ STAGE PLANS:
               predicate:
                   expr: (value < 'val_10')
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (value < 'val_10')
-                    type: boolean
-                Select Operator
-                  expressions:
+              Select Operator
+                expressions:
+                      expr: key
+                      type: int
+                      expr: value
+                      type: string
+                outputColumnNames: key, value
+                Group By Operator
+                  bucketGroup: false
+                  keys:
                         expr: key
                         type: int
                         expr: value
                         type: string
-                  outputColumnNames: key, value
-                  Group By Operator
-                    bucketGroup: false
-                    keys:
-                          expr: key
+                  mode: hash
+                  outputColumnNames: _col0, _col1
+                  Reduce Output Operator
+                    key expressions:
+                          expr: _col0
                           type: int
-                          expr: value
-                          type: string
-                    mode: hash
-                    outputColumnNames: _col0, _col1
-                    Reduce Output Operator
-                      key expressions:
-                            expr: _col0
-                            type: int
-                      sort order: +
-                      Map-reduce partition columns:
-                            expr: _col0
-                            type: int
-                      tag: 1
+                    sort order: +
+                    Map-reduce partition columns:
+                          expr: _col0
+                          type: int
+                    tag: 1
       Reduce Operator Tree:
         Join Operator
           condition map:
@@ -787,36 +779,32 @@ STAGE PLANS:
               predicate:
                   expr: (key > 5)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key > 5)
-                    type: boolean
+              Select Operator
+                expressions:
+                      expr: key
+                      type: int
+                outputColumnNames: _col0
                 Select Operator
                   expressions:
-                        expr: key
+                        expr: _col0
                         type: int
                   outputColumnNames: _col0
-                  Select Operator
-                    expressions:
+                  Group By Operator
+                    bucketGroup: false
+                    keys:
                           expr: _col0
                           type: int
+                    mode: hash
                     outputColumnNames: _col0
-                    Group By Operator
-                      bucketGroup: false
-                      keys:
+                    Reduce Output Operator
+                      key expressions:
                             expr: _col0
                             type: int
-                      mode: hash
-                      outputColumnNames: _col0
-                      Reduce Output Operator
-                        key expressions:
-                              expr: _col0
-                              type: int
-                        sort order: +
-                        Map-reduce partition columns:
-                              expr: _col0
-                              type: int
-                        tag: 1
+                      sort order: +
+                      Map-reduce partition columns:
+                            expr: _col0
+                            type: int
+                      tag: 1
       Reduce Operator Tree:
         Join Operator
           condition map:
@@ -916,46 +904,38 @@ STAGE PLANS:
               predicate:
                   expr: ((key > 5) and (value <= 'val_20'))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key > 5)
-                    type: boolean
+              Select Operator
+                expressions:
+                      expr: key
+                      type: int
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
                 Select Operator
                   expressions:
-                        expr: key
+                        expr: _col0
                         type: int
-                        expr: value
+                        expr: _col1
                         type: string
                   outputColumnNames: _col0, _col1
-                  Filter Operator
-                    predicate:
-                        expr: (_col1 <= 'val_20')
-                        type: boolean
-                    Select Operator
-                      expressions:
+                  Group By Operator
+                    bucketGroup: false
+                    keys:
+                          expr: _col0
+                          type: int
+                          expr: _col1
+                          type: string
+                    mode: hash
+                    outputColumnNames: _col0, _col1
+                    Reduce Output Operator
+                      key expressions:
                             expr: _col0
                             type: int
-                            expr: _col1
-                            type: string
-                      outputColumnNames: _col0, _col1
-                      Group By Operator
-                        bucketGroup: false
-                        keys:
-                              expr: _col0
-                              type: int
-                              expr: _col1
-                              type: string
-                        mode: hash
-                        outputColumnNames: _col0, _col1
-                        Reduce Output Operator
-                          key expressions:
-                                expr: _col0
-                                type: int
-                          sort order: +
-                          Map-reduce partition columns:
-                                expr: _col0
-                                type: int
-                          tag: 1
+                      sort order: +
+                      Map-reduce partition columns:
+                            expr: _col0
+                            type: int
+                      tag: 1
       Reduce Operator Tree:
         Join Operator
           condition map:
@@ -1054,36 +1034,32 @@ STAGE PLANS:
               predicate:
                   expr: (key > 2)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key > 2)
-                    type: boolean
+              Select Operator
+                expressions:
+                      expr: key
+                      type: int
+                outputColumnNames: _col0
                 Select Operator
                   expressions:
-                        expr: key
+                        expr: _col0
                         type: int
                   outputColumnNames: _col0
-                  Select Operator
-                    expressions:
+                  Group By Operator
+                    bucketGroup: false
+                    keys:
                           expr: _col0
                           type: int
+                    mode: hash
                     outputColumnNames: _col0
-                    Group By Operator
-                      bucketGroup: false
-                      keys:
+                    Reduce Output Operator
+                      key expressions:
+                            expr: _col0
+                            type: int
+                      sort order: +
+                      Map-reduce partition columns:
                             expr: _col0
                             type: int
-                      mode: hash
-                      outputColumnNames: _col0
-                      Reduce Output Operator
-                        key expressions:
-                              expr: _col0
-                              type: int
-                        sort order: +
-                        Map-reduce partition columns:
-                              expr: _col0
-                              type: int
-                        tag: 1
+                      tag: 1
       Reduce Operator Tree:
         Join Operator
           condition map:
diff --git a/ql/src/test/results/clientpositive/set_processor_namespaces.q.out b/ql/src/test/results/clientpositive/set_processor_namespaces.q.out
index 67fcb7c965..a365e2c879 100644
--- a/ql/src/test/results/clientpositive/set_processor_namespaces.q.out
+++ b/ql/src/test/results/clientpositive/set_processor_namespaces.q.out
@@ -25,23 +25,19 @@ STAGE PLANS:
               predicate:
                   expr: (key = 5)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key = 5)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
-                  outputColumnNames: _col0, _col1
-                  File Output Operator
-                    compressed: false
-                    GlobalTableId: 0
-                    table:
-                        input format: org.apache.hadoop.mapred.TextInputFormat
-                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 0
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
 
   Stage: Stage-0
     Fetch Operator
diff --git a/ql/src/test/results/clientpositive/skewjoin.q.out b/ql/src/test/results/clientpositive/skewjoin.q.out
index 7dd581eb78..774397dcde 100644
--- a/ql/src/test/results/clientpositive/skewjoin.q.out
+++ b/ql/src/test/results/clientpositive/skewjoin.q.out
@@ -1198,22 +1198,18 @@ STAGE PLANS:
                       expr: key
                       type: string
                 outputColumnNames: _col0
-                Filter Operator
-                  predicate:
-                      expr: (_col0 < 100)
-                      type: boolean
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: 0
-                    value expressions:
-                          expr: _col0
-                          type: string
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: 0
+                  value expressions:
+                        expr: _col0
+                        type: string
         src2:src 
           TableScan
             alias: src
@@ -1248,19 +1244,15 @@ STAGE PLANS:
                       expr: key
                       type: string
                 outputColumnNames: _col0
-                Filter Operator
-                  predicate:
-                      expr: (_col0 < 80)
-                      type: boolean
-                  Reduce Output Operator
-                    key expressions:
-                          expr: _col0
-                          type: string
-                    sort order: +
-                    Map-reduce partition columns:
-                          expr: _col0
-                          type: string
-                    tag: 2
+                Reduce Output Operator
+                  key expressions:
+                        expr: _col0
+                        type: string
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: _col0
+                        type: string
+                  tag: 2
       Reduce Operator Tree:
         Join Operator
           condition map:
diff --git a/ql/src/test/results/clientpositive/smb_mapjoin9.q.out b/ql/src/test/results/clientpositive/smb_mapjoin9.q.out
index 32a1f9145c..e6ac6669af 100644
--- a/ql/src/test/results/clientpositive/smb_mapjoin9.q.out
+++ b/ql/src/test/results/clientpositive/smb_mapjoin9.q.out
@@ -88,27 +88,23 @@ STAGE PLANS:
                       expr: _col7
                       type: string
                 outputColumnNames: _col0, _col2, _col5, _col6, _col7
-                Filter Operator
-                  predicate:
-                      expr: (((_col2 = '2010-10-15') and (_col7 = '2010-10-15')) and _col5 is not null)
-                      type: boolean
-                  Select Operator
-                    expressions:
-                          expr: _col5
-                          type: int
-                          expr: _col6
-                          type: string
-                          expr: _col7
-                          type: string
-                          expr: _col0
-                          type: int
-                    outputColumnNames: _col0, _col1, _col2, _col3
-                    File Output Operator
-                      compressed: false
-                      GlobalTableId: 1
-                      table:
-                          input format: org.apache.hadoop.mapred.TextInputFormat
-                          output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                Select Operator
+                  expressions:
+                        expr: _col5
+                        type: int
+                        expr: _col6
+                        type: string
+                        expr: _col7
+                        type: string
+                        expr: _col0
+                        type: int
+                  outputColumnNames: _col0, _col1, _col2, _col3
+                  File Output Operator
+                    compressed: false
+                    GlobalTableId: 1
+                    table:
+                        input format: org.apache.hadoop.mapred.TextInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
 
   Stage: Stage-0
     Move Operator
diff --git a/ql/src/test/results/clientpositive/smb_mapjoin_6.q.out b/ql/src/test/results/clientpositive/smb_mapjoin_6.q.out
index b41e454f4e..65e989a39a 100644
--- a/ql/src/test/results/clientpositive/smb_mapjoin_6.q.out
+++ b/ql/src/test/results/clientpositive/smb_mapjoin_6.q.out
@@ -2634,29 +2634,25 @@ STAGE PLANS:
                       expr: _col5
                       type: string
                 outputColumnNames: _col0, _col1, _col4, _col5
-                Filter Operator
-                  predicate:
-                      expr: (_col0 > 1000)
-                      type: boolean
-                  Select Operator
-                    expressions:
-                          expr: _col0
-                          type: int
-                          expr: _col1
-                          type: string
-                          expr: _col4
-                          type: int
-                          expr: _col5
-                          type: string
-                    outputColumnNames: _col0, _col1, _col2, _col3
-                    File Output Operator
-                      compressed: false
-                      GlobalTableId: 1
-                      table:
-                          input format: org.apache.hadoop.mapred.TextInputFormat
-                          output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                          name: default.smb_join_results
+                Select Operator
+                  expressions:
+                        expr: _col0
+                        type: int
+                        expr: _col1
+                        type: string
+                        expr: _col4
+                        type: int
+                        expr: _col5
+                        type: string
+                  outputColumnNames: _col0, _col1, _col2, _col3
+                  File Output Operator
+                    compressed: false
+                    GlobalTableId: 1
+                    table:
+                        input format: org.apache.hadoop.mapred.TextInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                        name: default.smb_join_results
 
   Stage: Stage-0
     Move Operator
@@ -2790,29 +2786,25 @@ STAGE PLANS:
                         expr: _col5
                         type: string
                   outputColumnNames: _col0, _col1, _col4, _col5
-                  Filter Operator
-                    predicate:
-                        expr: (_col0 > 1000)
-                        type: boolean
-                    Select Operator
-                      expressions:
-                            expr: _col0
-                            type: int
-                            expr: _col1
-                            type: string
-                            expr: _col4
-                            type: int
-                            expr: _col5
-                            type: string
-                      outputColumnNames: _col0, _col1, _col2, _col3
-                      File Output Operator
-                        compressed: false
-                        GlobalTableId: 1
-                        table:
-                            input format: org.apache.hadoop.mapred.TextInputFormat
-                            output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                            serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                            name: default.smb_join_results
+                  Select Operator
+                    expressions:
+                          expr: _col0
+                          type: int
+                          expr: _col1
+                          type: string
+                          expr: _col4
+                          type: int
+                          expr: _col5
+                          type: string
+                    outputColumnNames: _col0, _col1, _col2, _col3
+                    File Output Operator
+                      compressed: false
+                      GlobalTableId: 1
+                      table:
+                          input format: org.apache.hadoop.mapred.TextInputFormat
+                          output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                          name: default.smb_join_results
 
   Stage: Stage-0
     Move Operator
@@ -2958,31 +2950,27 @@ STAGE PLANS:
                         expr: _col9
                         type: string
                   outputColumnNames: _col0, _col1, _col4, _col5, _col8, _col9
-                  Filter Operator
-                    predicate:
-                        expr: (_col0 > 1000)
-                        type: boolean
-                    Select Operator
-                      expressions:
-                            expr: _col0
-                            type: int
-                            expr: _col1
-                            type: string
-                            expr: _col4
-                            type: int
-                            expr: _col5
-                            type: string
-                            expr: _col8
-                            type: int
-                            expr: _col9
-                            type: string
-                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
-                      File Output Operator
-                        compressed: false
-                        GlobalTableId: 0
-                        table:
-                            input format: org.apache.hadoop.mapred.TextInputFormat
-                            output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                  Select Operator
+                    expressions:
+                          expr: _col0
+                          type: int
+                          expr: _col1
+                          type: string
+                          expr: _col4
+                          type: int
+                          expr: _col5
+                          type: string
+                          expr: _col8
+                          type: int
+                          expr: _col9
+                          type: string
+                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
+                    File Output Operator
+                      compressed: false
+                      GlobalTableId: 0
+                      table:
+                          input format: org.apache.hadoop.mapred.TextInputFormat
+                          output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
 
   Stage: Stage-0
     Fetch Operator
diff --git a/ql/src/test/results/clientpositive/split_sample.q.out b/ql/src/test/results/clientpositive/split_sample.q.out
index 550dc443c2..c350085ada 100644
--- a/ql/src/test/results/clientpositive/split_sample.q.out
+++ b/ql/src/test/results/clientpositive/split_sample.q.out
@@ -4111,17 +4111,17 @@ STAGE PLANS:
             1 {VALUE._col0}
           handleSkewJoin: false
           outputColumnNames: _col0, _col4
-          Select Operator
-            expressions:
-                  expr: _col0
-                  type: int
-                  expr: _col4
-                  type: int
-            outputColumnNames: _col0, _col1
-            Filter Operator
-              predicate:
-                  expr: ((_col1) IN (199, 10199, 20199) or (_col0) IN (199, 10199, 20199))
-                  type: boolean
+          Filter Operator
+            predicate:
+                expr: ((_col4) IN (199, 10199, 20199) or (_col0) IN (199, 10199, 20199))
+                type: boolean
+            Select Operator
+              expressions:
+                    expr: _col0
+                    type: int
+                    expr: _col4
+                    type: int
+              outputColumnNames: _col0, _col1
               Select Operator
                 expressions:
                       expr: _col0
diff --git a/ql/src/test/results/clientpositive/stats11.q.out b/ql/src/test/results/clientpositive/stats11.q.out
index d76bd8c961..652997228c 100644
--- a/ql/src/test/results/clientpositive/stats11.q.out
+++ b/ql/src/test/results/clientpositive/stats11.q.out
@@ -162,46 +162,41 @@ STAGE PLANS:
                       expr: _col6
                       type: string
                 outputColumnNames: _col0, _col1, _col5, _col6
-                Filter Operator
-                  isSamplingPred: false
-                  predicate:
-                      expr: (_col6 = '2008-04-08')
-                      type: boolean
-                  Select Operator
-                    expressions:
-                          expr: _col0
-                          type: int
-                          expr: _col1
-                          type: string
-                          expr: _col5
-                          type: string
-                    outputColumnNames: _col0, _col1, _col2
-                    File Output Operator
-                      compressed: false
-                      GlobalTableId: 1
-                      directory: pfile:/data/users/tomasz/apache-hive/build/ql/scratchdir/hive_2011-06-01_20-41-18_163_6560883492277571896/-ext-10002
-                      NumFilesPerFileSink: 1
-                      Stats Publishing Key Prefix: pfile:/data/users/tomasz/apache-hive/build/ql/scratchdir/hive_2011-06-01_20-41-18_163_6560883492277571896/-ext-10000/
-                      table:
-                          input format: org.apache.hadoop.mapred.TextInputFormat
-                          output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                          properties:
-                            bucket_count -1
-                            columns key,value1,value2
-                            columns.types string:string:string
-                            file.inputformat org.apache.hadoop.mapred.TextInputFormat
-                            file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                            location pfile:/data/users/tomasz/apache-hive/build/ql/test/data/warehouse/bucketmapjoin_tmp_result
-                            name default.bucketmapjoin_tmp_result
-                            serialization.ddl struct bucketmapjoin_tmp_result { string key, string value1, string value2}
-                            serialization.format 1
-                            serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                            transient_lastDdlTime 1306986078
-                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                          name: default.bucketmapjoin_tmp_result
-                      TotalFiles: 1
-                      GatherStats: true
-                      MultiFileSpray: false
+                Select Operator
+                  expressions:
+                        expr: _col0
+                        type: int
+                        expr: _col1
+                        type: string
+                        expr: _col5
+                        type: string
+                  outputColumnNames: _col0, _col1, _col2
+                  File Output Operator
+                    compressed: false
+                    GlobalTableId: 1
+                    directory: pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_03-10-59_585_1038860316679520823/-ext-10002
+                    NumFilesPerFileSink: 1
+                    Stats Publishing Key Prefix: pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_03-10-59_585_1038860316679520823/-ext-10000/
+                    table:
+                        input format: org.apache.hadoop.mapred.TextInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                        properties:
+                          bucket_count -1
+                          columns key,value1,value2
+                          columns.types string:string:string
+                          file.inputformat org.apache.hadoop.mapred.TextInputFormat
+                          file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                          location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/bucketmapjoin_tmp_result
+                          name default.bucketmapjoin_tmp_result
+                          serialization.ddl struct bucketmapjoin_tmp_result { string key, string value1, string value2}
+                          serialization.format 1
+                          serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                          transient_lastDdlTime 1310379059
+                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                        name: default.bucketmapjoin_tmp_result
+                    TotalFiles: 1
+                    GatherStats: true
+                    MultiFileSpray: false
       Local Work:
         Map Reduce Local Work
       Needs Tagging: false
@@ -593,51 +588,46 @@ STAGE PLANS:
                       expr: _col6
                       type: string
                 outputColumnNames: _col0, _col1, _col5, _col6
-                Filter Operator
-                  isSamplingPred: false
-                  predicate:
-                      expr: (_col6 = '2008-04-08')
-                      type: boolean
-                  Select Operator
-                    expressions:
-                          expr: _col0
-                          type: int
-                          expr: _col1
-                          type: string
-                          expr: _col5
-                          type: string
-                    outputColumnNames: _col0, _col1, _col2
-                    File Output Operator
-                      compressed: false
-                      GlobalTableId: 1
-                      directory: pfile:/data/users/tomasz/apache-hive/build/ql/scratchdir/hive_2011-06-01_20-41-49_304_6102645690321346948/-ext-10002
-                      NumFilesPerFileSink: 1
-                      Stats Publishing Key Prefix: pfile:/data/users/tomasz/apache-hive/build/ql/scratchdir/hive_2011-06-01_20-41-49_304_6102645690321346948/-ext-10000/
-                      table:
-                          input format: org.apache.hadoop.mapred.TextInputFormat
-                          output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                          properties:
-                            bucket_count -1
-                            columns key,value1,value2
-                            columns.types string:string:string
-                            file.inputformat org.apache.hadoop.mapred.TextInputFormat
-                            file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                            location pfile:/data/users/tomasz/apache-hive/build/ql/test/data/warehouse/bucketmapjoin_tmp_result
-                            name default.bucketmapjoin_tmp_result
-                            numFiles 1
-                            numPartitions 0
-                            numRows 464
-                            rawDataSize 8519
-                            serialization.ddl struct bucketmapjoin_tmp_result { string key, string value1, string value2}
-                            serialization.format 1
-                            serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                            totalSize 8983
-                            transient_lastDdlTime 1306986098
-                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                          name: default.bucketmapjoin_tmp_result
-                      TotalFiles: 1
-                      GatherStats: true
-                      MultiFileSpray: false
+                Select Operator
+                  expressions:
+                        expr: _col0
+                        type: int
+                        expr: _col1
+                        type: string
+                        expr: _col5
+                        type: string
+                  outputColumnNames: _col0, _col1, _col2
+                  File Output Operator
+                    compressed: false
+                    GlobalTableId: 1
+                    directory: pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_03-11-25_827_1887525539038984243/-ext-10002
+                    NumFilesPerFileSink: 1
+                    Stats Publishing Key Prefix: pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_03-11-25_827_1887525539038984243/-ext-10000/
+                    table:
+                        input format: org.apache.hadoop.mapred.TextInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                        properties:
+                          bucket_count -1
+                          columns key,value1,value2
+                          columns.types string:string:string
+                          file.inputformat org.apache.hadoop.mapred.TextInputFormat
+                          file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                          location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/bucketmapjoin_tmp_result
+                          name default.bucketmapjoin_tmp_result
+                          numFiles 1
+                          numPartitions 0
+                          numRows 464
+                          rawDataSize 8519
+                          serialization.ddl struct bucketmapjoin_tmp_result { string key, string value1, string value2}
+                          serialization.format 1
+                          serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                          totalSize 8983
+                          transient_lastDdlTime 1310379076
+                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                        name: default.bucketmapjoin_tmp_result
+                    TotalFiles: 1
+                    GatherStats: true
+                    MultiFileSpray: false
       Local Work:
         Map Reduce Local Work
       Needs Tagging: false
diff --git a/ql/src/test/results/clientpositive/stats2.q.out b/ql/src/test/results/clientpositive/stats2.q.out
index d2186b4406..e90f231f29 100644
--- a/ql/src/test/results/clientpositive/stats2.q.out
+++ b/ql/src/test/results/clientpositive/stats2.q.out
@@ -23,29 +23,25 @@ STAGE PLANS:
         srcpart 
           TableScan
             alias: srcpart
-            Filter Operator
-              predicate:
-                  expr: ds is not null
-                  type: boolean
-              Select Operator
-                expressions:
-                      expr: key
-                      type: string
-                      expr: value
-                      type: string
-                      expr: ds
-                      type: string
-                      expr: hr
-                      type: string
-                outputColumnNames: _col0, _col1, _col2, _col3
-                File Output Operator
-                  compressed: false
-                  GlobalTableId: 1
-                  table:
-                      input format: org.apache.hadoop.mapred.TextInputFormat
-                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                      name: default.analyze_t1
+            Select Operator
+              expressions:
+                    expr: key
+                    type: string
+                    expr: value
+                    type: string
+                    expr: ds
+                    type: string
+                    expr: hr
+                    type: string
+              outputColumnNames: _col0, _col1, _col2, _col3
+              File Output Operator
+                compressed: false
+                GlobalTableId: 1
+                table:
+                    input format: org.apache.hadoop.mapred.TextInputFormat
+                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                    name: default.analyze_t1
 
   Stage: Stage-0
     Move Operator
diff --git a/ql/src/test/results/clientpositive/subq.q.out b/ql/src/test/results/clientpositive/subq.q.out
index 1631abddbe..3725d103c1 100644
--- a/ql/src/test/results/clientpositive/subq.q.out
+++ b/ql/src/test/results/clientpositive/subq.q.out
@@ -31,30 +31,26 @@ STAGE PLANS:
               predicate:
                   expr: (key < 100)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 100)
-                    type: boolean
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
                 Select Operator
                   expressions:
-                        expr: key
+                        expr: _col0
                         type: string
-                        expr: value
+                        expr: _col1
                         type: string
                   outputColumnNames: _col0, _col1
-                  Select Operator
-                    expressions:
-                          expr: _col0
-                          type: string
-                          expr: _col1
-                          type: string
-                    outputColumnNames: _col0, _col1
-                    File Output Operator
-                      compressed: false
-                      GlobalTableId: 1
-                      table:
-                          input format: org.apache.hadoop.mapred.TextInputFormat
-                          output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                  File Output Operator
+                    compressed: false
+                    GlobalTableId: 1
+                    table:
+                        input format: org.apache.hadoop.mapred.TextInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
 
   Stage: Stage-4
     Conditional Operator
diff --git a/ql/src/test/results/clientpositive/subq2.q.out b/ql/src/test/results/clientpositive/subq2.q.out
index cc20209a07..d59077ba62 100644
--- a/ql/src/test/results/clientpositive/subq2.q.out
+++ b/ql/src/test/results/clientpositive/subq2.q.out
@@ -69,23 +69,19 @@ STAGE PLANS:
                   expr: _col1
                   type: bigint
             outputColumnNames: _col0, _col1
-            Filter Operator
-              predicate:
-                  expr: (_col0 >= 90)
-                  type: boolean
-              Select Operator
-                expressions:
-                      expr: _col0
-                      type: string
-                      expr: _col1
-                      type: bigint
-                outputColumnNames: _col0, _col1
-                File Output Operator
-                  compressed: false
-                  GlobalTableId: 0
-                  table:
-                      input format: org.apache.hadoop.mapred.TextInputFormat
-                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+            Select Operator
+              expressions:
+                    expr: _col0
+                    type: string
+                    expr: _col1
+                    type: bigint
+              outputColumnNames: _col0, _col1
+              File Output Operator
+                compressed: false
+                GlobalTableId: 0
+                table:
+                    input format: org.apache.hadoop.mapred.TextInputFormat
+                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
 
   Stage: Stage-0
     Fetch Operator
diff --git a/ql/src/test/results/clientpositive/transform_ppr1.q.out b/ql/src/test/results/clientpositive/transform_ppr1.q.out
index c56cc95b70..9ecae0b14c 100644
--- a/ql/src/test/results/clientpositive/transform_ppr1.q.out
+++ b/ql/src/test/results/clientpositive/transform_ppr1.q.out
@@ -50,22 +50,27 @@ STAGE PLANS:
                       columns.types string,string,string
                       field.delim 9
                       serialization.format 9
-                Reduce Output Operator
-                  key expressions:
-                        expr: _col1
-                        type: string
-                  sort order: +
-                  Map-reduce partition columns:
-                        expr: _col1
-                        type: string
-                  tag: -1
-                  value expressions:
-                        expr: _col0
-                        type: string
-                        expr: _col1
-                        type: string
-                        expr: _col2
-                        type: string
+                Filter Operator
+                  isSamplingPred: false
+                  predicate:
+                      expr: ((_col1 < 100) and (_col0 = '2008-04-08'))
+                      type: boolean
+                  Reduce Output Operator
+                    key expressions:
+                          expr: _col1
+                          type: string
+                    sort order: +
+                    Map-reduce partition columns:
+                          expr: _col1
+                          type: string
+                    tag: -1
+                    value expressions:
+                          expr: _col0
+                          type: string
+                          expr: _col1
+                          type: string
+                          expr: _col2
+                          type: string
       Needs Tagging: false
       Path -> Alias:
         pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 [tmap:src]
@@ -239,34 +244,29 @@ STAGE PLANS:
             name: default.srcpart
       Reduce Operator Tree:
         Extract
-          Filter Operator
-            isSamplingPred: false
-            predicate:
-                expr: ((_col1 < 100) and (_col0 = '2008-04-08'))
-                type: boolean
-            Select Operator
-              expressions:
-                    expr: _col1
-                    type: string
-                    expr: _col2
-                    type: string
-              outputColumnNames: _col0, _col1
-              File Output Operator
-                compressed: false
-                GlobalTableId: 0
-                directory: file:/tmp/sdong/hive_2011-02-10_17-24-54_583_8987862490121410836/-ext-10001
-                NumFilesPerFileSink: 1
-                Stats Publishing Key Prefix: file:/tmp/sdong/hive_2011-02-10_17-24-54_583_8987862490121410836/-ext-10001/
-                table:
-                    input format: org.apache.hadoop.mapred.TextInputFormat
-                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                    properties:
-                      columns _col0,_col1
-                      columns.types string:string
-                      serialization.format 1
-                TotalFiles: 1
-                GatherStats: false
-                MultiFileSpray: false
+          Select Operator
+            expressions:
+                  expr: _col1
+                  type: string
+                  expr: _col2
+                  type: string
+            outputColumnNames: _col0, _col1
+            File Output Operator
+              compressed: false
+              GlobalTableId: 0
+              directory: file:/tmp/amarsri/hive_2011-03-19_01-46-48_559_8291501891794719709/-ext-10001
+              NumFilesPerFileSink: 1
+              Stats Publishing Key Prefix: file:/tmp/amarsri/hive_2011-03-19_01-46-48_559_8291501891794719709/-ext-10001/
+              table:
+                  input format: org.apache.hadoop.mapred.TextInputFormat
+                  output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                  properties:
+                    columns _col0,_col1
+                    columns.types string:string
+                    serialization.format 1
+              TotalFiles: 1
+              GatherStats: false
+              MultiFileSpray: false
 
   Stage: Stage-0
     Fetch Operator
diff --git a/ql/src/test/results/clientpositive/transform_ppr2.q.out b/ql/src/test/results/clientpositive/transform_ppr2.q.out
index 8789db795a..79757f4314 100644
--- a/ql/src/test/results/clientpositive/transform_ppr2.q.out
+++ b/ql/src/test/results/clientpositive/transform_ppr2.q.out
@@ -33,30 +33,30 @@ STAGE PLANS:
           TableScan
             alias: src
             GatherStats: false
-            Filter Operator
-              isSamplingPred: false
-              predicate:
-                  expr: (ds = '2008-04-08')
-                  type: boolean
-              Select Operator
-                expressions:
-                      expr: ds
-                      type: string
-                      expr: key
-                      type: string
-                      expr: value
-                      type: string
-                outputColumnNames: _col0, _col1, _col2
-                Transform Operator
-                  command: /bin/cat
-                  output info:
-                      input format: org.apache.hadoop.mapred.TextInputFormat
-                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                      properties:
-                        columns _col0,_col1,_col2
-                        columns.types string,string,string
-                        field.delim 9
-                        serialization.format 9
+            Select Operator
+              expressions:
+                    expr: ds
+                    type: string
+                    expr: key
+                    type: string
+                    expr: value
+                    type: string
+              outputColumnNames: _col0, _col1, _col2
+              Transform Operator
+                command: /bin/cat
+                output info:
+                    input format: org.apache.hadoop.mapred.TextInputFormat
+                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                    properties:
+                      columns _col0,_col1,_col2
+                      columns.types string,string,string
+                      field.delim 9
+                      serialization.format 9
+                Filter Operator
+                  isSamplingPred: false
+                  predicate:
+                      expr: (_col1 < 100)
+                      type: boolean
                   Reduce Output Operator
                     key expressions:
                           expr: _col1
@@ -162,34 +162,29 @@ STAGE PLANS:
             name: default.srcpart
       Reduce Operator Tree:
         Extract
-          Filter Operator
-            isSamplingPred: false
-            predicate:
-                expr: (_col1 < 100)
-                type: boolean
-            Select Operator
-              expressions:
-                    expr: _col1
-                    type: string
-                    expr: _col2
-                    type: string
-              outputColumnNames: _col0, _col1
-              File Output Operator
-                compressed: false
-                GlobalTableId: 0
-                directory: file:/tmp/sdong/hive_2011-02-10_17-24-59_315_262991000601799738/-ext-10001
-                NumFilesPerFileSink: 1
-                Stats Publishing Key Prefix: file:/tmp/sdong/hive_2011-02-10_17-24-59_315_262991000601799738/-ext-10001/
-                table:
-                    input format: org.apache.hadoop.mapred.TextInputFormat
-                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                    properties:
-                      columns _col0,_col1
-                      columns.types string:string
-                      serialization.format 1
-                TotalFiles: 1
-                GatherStats: false
-                MultiFileSpray: false
+          Select Operator
+            expressions:
+                  expr: _col1
+                  type: string
+                  expr: _col2
+                  type: string
+            outputColumnNames: _col0, _col1
+            File Output Operator
+              compressed: false
+              GlobalTableId: 0
+              directory: file:/tmp/amarsri/hive_2011-03-19_01-46-51_820_4418676794321891468/-ext-10001
+              NumFilesPerFileSink: 1
+              Stats Publishing Key Prefix: file:/tmp/amarsri/hive_2011-03-19_01-46-51_820_4418676794321891468/-ext-10001/
+              table:
+                  input format: org.apache.hadoop.mapred.TextInputFormat
+                  output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                  properties:
+                    columns _col0,_col1
+                    columns.types string:string
+                    serialization.format 1
+              TotalFiles: 1
+              GatherStats: false
+              MultiFileSpray: false
 
   Stage: Stage-0
     Fetch Operator
diff --git a/ql/src/test/results/clientpositive/udf1.q.out b/ql/src/test/results/clientpositive/udf1.q.out
index 8fb5bcf276..c798e4321e 100644
--- a/ql/src/test/results/clientpositive/udf1.q.out
+++ b/ql/src/test/results/clientpositive/udf1.q.out
@@ -51,61 +51,57 @@ STAGE PLANS:
               predicate:
                   expr: (key = 86)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key = 86)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: ('a' like '%a%')
-                        type: boolean
-                        expr: ('b' like '%a%')
-                        type: boolean
-                        expr: ('ab' like '%a%')
-                        type: boolean
-                        expr: ('ab' like '%a_')
-                        type: boolean
-                        expr: ('%_' like '\%\_')
-                        type: boolean
-                        expr: ('ab' like '\%\_')
-                        type: boolean
-                        expr: ('ab' like '_a%')
-                        type: boolean
-                        expr: ('ab' like 'a')
-                        type: boolean
-                        expr: ('' rlike '.*')
-                        type: boolean
-                        expr: ('a' rlike '[ab]')
-                        type: boolean
-                        expr: ('' rlike '[ab]')
-                        type: boolean
-                        expr: ('hadoop' rlike '[a-z]*')
-                        type: boolean
-                        expr: ('hadoop' rlike 'o*')
-                        type: boolean
-                        expr: regexp_replace('abc', 'b', 'c')
-                        type: string
-                        expr: regexp_replace('abc', 'z', 'a')
-                        type: string
-                        expr: regexp_replace('abbbb', 'bb', 'b')
-                        type: string
-                        expr: regexp_replace('hadoop', '(.)[a-z]*', '$1ive')
-                        type: string
-                        expr: regexp_replace('hadoopAAA', 'A.*', '')
-                        type: string
-                        expr: regexp_replace('abc', '', 'A')
-                        type: string
-                        expr: ('abc' rlike '')
-                        type: boolean
-                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19
-                  File Output Operator
-                    compressed: false
-                    GlobalTableId: 1
-                    table:
-                        input format: org.apache.hadoop.mapred.TextInputFormat
-                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                        name: default.dest1
+              Select Operator
+                expressions:
+                      expr: ('a' like '%a%')
+                      type: boolean
+                      expr: ('b' like '%a%')
+                      type: boolean
+                      expr: ('ab' like '%a%')
+                      type: boolean
+                      expr: ('ab' like '%a_')
+                      type: boolean
+                      expr: ('%_' like '\%\_')
+                      type: boolean
+                      expr: ('ab' like '\%\_')
+                      type: boolean
+                      expr: ('ab' like '_a%')
+                      type: boolean
+                      expr: ('ab' like 'a')
+                      type: boolean
+                      expr: ('' rlike '.*')
+                      type: boolean
+                      expr: ('a' rlike '[ab]')
+                      type: boolean
+                      expr: ('' rlike '[ab]')
+                      type: boolean
+                      expr: ('hadoop' rlike '[a-z]*')
+                      type: boolean
+                      expr: ('hadoop' rlike 'o*')
+                      type: boolean
+                      expr: regexp_replace('abc', 'b', 'c')
+                      type: string
+                      expr: regexp_replace('abc', 'z', 'a')
+                      type: string
+                      expr: regexp_replace('abbbb', 'bb', 'b')
+                      type: string
+                      expr: regexp_replace('hadoop', '(.)[a-z]*', '$1ive')
+                      type: string
+                      expr: regexp_replace('hadoopAAA', 'A.*', '')
+                      type: string
+                      expr: regexp_replace('abc', '', 'A')
+                      type: string
+                      expr: ('abc' rlike '')
+                      type: boolean
+                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 1
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                      name: default.dest1
 
   Stage: Stage-5
     Conditional Operator
diff --git a/ql/src/test/results/clientpositive/udf9.q.out b/ql/src/test/results/clientpositive/udf9.q.out
index 4e122f68a5..e7b7ce42f0 100644
--- a/ql/src/test/results/clientpositive/udf9.q.out
+++ b/ql/src/test/results/clientpositive/udf9.q.out
@@ -38,51 +38,47 @@ STAGE PLANS:
               predicate:
                   expr: (key = 86)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key = 86)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: datediff('2008-12-31', '2009-01-01')
-                        type: int
-                        expr: datediff('2008-03-01', '2008-02-28')
-                        type: int
-                        expr: datediff('2007-03-01', '2007-01-28')
-                        type: int
-                        expr: datediff('2008-03-01 23:59:59', '2008-03-02 00:00:00')
-                        type: int
-                        expr: date_add('2008-12-31', 1)
-                        type: string
-                        expr: date_add('2008-12-31', 365)
-                        type: string
-                        expr: date_add('2008-02-28', 2)
-                        type: string
-                        expr: date_add('2009-02-28', 2)
-                        type: string
-                        expr: date_add('2007-02-28', 365)
-                        type: string
-                        expr: date_add('2007-02-28 23:59:59', 730)
-                        type: string
-                        expr: date_sub('2009-01-01', 1)
-                        type: string
-                        expr: date_sub('2009-01-01', 365)
-                        type: string
-                        expr: date_sub('2008-02-28', 2)
-                        type: string
-                        expr: date_sub('2009-02-28', 2)
-                        type: string
-                        expr: date_sub('2007-02-28', 365)
-                        type: string
-                        expr: date_sub('2007-02-28 01:12:34', 730)
-                        type: string
-                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15
-                  File Output Operator
-                    compressed: false
-                    GlobalTableId: 0
-                    table:
-                        input format: org.apache.hadoop.mapred.TextInputFormat
-                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+              Select Operator
+                expressions:
+                      expr: datediff('2008-12-31', '2009-01-01')
+                      type: int
+                      expr: datediff('2008-03-01', '2008-02-28')
+                      type: int
+                      expr: datediff('2007-03-01', '2007-01-28')
+                      type: int
+                      expr: datediff('2008-03-01 23:59:59', '2008-03-02 00:00:00')
+                      type: int
+                      expr: date_add('2008-12-31', 1)
+                      type: string
+                      expr: date_add('2008-12-31', 365)
+                      type: string
+                      expr: date_add('2008-02-28', 2)
+                      type: string
+                      expr: date_add('2009-02-28', 2)
+                      type: string
+                      expr: date_add('2007-02-28', 365)
+                      type: string
+                      expr: date_add('2007-02-28 23:59:59', 730)
+                      type: string
+                      expr: date_sub('2009-01-01', 1)
+                      type: string
+                      expr: date_sub('2009-01-01', 365)
+                      type: string
+                      expr: date_sub('2008-02-28', 2)
+                      type: string
+                      expr: date_sub('2009-02-28', 2)
+                      type: string
+                      expr: date_sub('2007-02-28', 365)
+                      type: string
+                      expr: date_sub('2007-02-28 01:12:34', 730)
+                      type: string
+                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 0
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
 
   Stage: Stage-0
     Fetch Operator
diff --git a/ql/src/test/results/clientpositive/udf_10_trims.q.out b/ql/src/test/results/clientpositive/udf_10_trims.q.out
index cc614be114..d2cb1f26c0 100644
--- a/ql/src/test/results/clientpositive/udf_10_trims.q.out
+++ b/ql/src/test/results/clientpositive/udf_10_trims.q.out
@@ -37,23 +37,19 @@ STAGE PLANS:
               predicate:
                   expr: (key = 86)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key = 86)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: trim(trim(trim(trim(trim(trim(trim(trim(trim(trim('  abc  '))))))))))
-                        type: string
-                  outputColumnNames: _col0
-                  File Output Operator
-                    compressed: false
-                    GlobalTableId: 1
-                    table:
-                        input format: org.apache.hadoop.mapred.TextInputFormat
-                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                        name: default.dest1
+              Select Operator
+                expressions:
+                      expr: trim(trim(trim(trim(trim(trim(trim(trim(trim(trim('  abc  '))))))))))
+                      type: string
+                outputColumnNames: _col0
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 1
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                      name: default.dest1
 
   Stage: Stage-5
     Conditional Operator
diff --git a/ql/src/test/results/clientpositive/udf_hour.q.out b/ql/src/test/results/clientpositive/udf_hour.q.out
index a5150ded6c..bbe931c57b 100644
--- a/ql/src/test/results/clientpositive/udf_hour.q.out
+++ b/ql/src/test/results/clientpositive/udf_hour.q.out
@@ -40,25 +40,21 @@ STAGE PLANS:
               predicate:
                   expr: (key = 86)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key = 86)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: hour('2009-08-07 13:14:15')
-                        type: int
-                        expr: hour('13:14:15')
-                        type: int
-                        expr: hour('2009-08-07')
-                        type: int
-                  outputColumnNames: _col0, _col1, _col2
-                  File Output Operator
-                    compressed: false
-                    GlobalTableId: 0
-                    table:
-                        input format: org.apache.hadoop.mapred.TextInputFormat
-                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+              Select Operator
+                expressions:
+                      expr: hour('2009-08-07 13:14:15')
+                      type: int
+                      expr: hour('13:14:15')
+                      type: int
+                      expr: hour('2009-08-07')
+                      type: int
+                outputColumnNames: _col0, _col1, _col2
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 0
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
 
   Stage: Stage-0
     Fetch Operator
diff --git a/ql/src/test/results/clientpositive/udf_isnull_isnotnull.q.out b/ql/src/test/results/clientpositive/udf_isnull_isnotnull.q.out
index bf62687192..e522bb8e6e 100644
--- a/ql/src/test/results/clientpositive/udf_isnull_isnotnull.q.out
+++ b/ql/src/test/results/clientpositive/udf_isnull_isnotnull.q.out
@@ -50,26 +50,22 @@ STAGE PLANS:
               predicate:
                   expr: true is not null
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: true is not null
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: null is null
-                        type: boolean
-                        expr: 1 is not null
-                        type: boolean
-                        expr: 'my string' is not null
-                        type: boolean
-                  outputColumnNames: _col0, _col1, _col2
-                  Limit
-                    File Output Operator
-                      compressed: false
-                      GlobalTableId: 0
-                      table:
-                          input format: org.apache.hadoop.mapred.TextInputFormat
-                          output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+              Select Operator
+                expressions:
+                      expr: null is null
+                      type: boolean
+                      expr: 1 is not null
+                      type: boolean
+                      expr: 'my string' is not null
+                      type: boolean
+                outputColumnNames: _col0, _col1, _col2
+                Limit
+                  File Output Operator
+                    compressed: false
+                    GlobalTableId: 0
+                    table:
+                        input format: org.apache.hadoop.mapred.TextInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
 
   Stage: Stage-0
     Fetch Operator
@@ -127,26 +123,22 @@ STAGE PLANS:
               predicate:
                   expr: (lint is not null and (not mstringstring is null))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (lint is not null and (not mstringstring is null))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: lint is not null
-                        type: boolean
-                        expr: lintstring is not null
-                        type: boolean
-                        expr: mstringstring is not null
-                        type: boolean
-                  outputColumnNames: _col0, _col1, _col2
-                  Limit
-                    File Output Operator
-                      compressed: false
-                      GlobalTableId: 0
-                      table:
-                          input format: org.apache.hadoop.mapred.TextInputFormat
-                          output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+              Select Operator
+                expressions:
+                      expr: lint is not null
+                      type: boolean
+                      expr: lintstring is not null
+                      type: boolean
+                      expr: mstringstring is not null
+                      type: boolean
+                outputColumnNames: _col0, _col1, _col2
+                Limit
+                  File Output Operator
+                    compressed: false
+                    GlobalTableId: 0
+                    table:
+                        input format: org.apache.hadoop.mapred.TextInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
 
   Stage: Stage-0
     Fetch Operator
diff --git a/ql/src/test/results/clientpositive/udf_like.q.out b/ql/src/test/results/clientpositive/udf_like.q.out
index 69af4e9be0..ae2e3db856 100644
--- a/ql/src/test/results/clientpositive/udf_like.q.out
+++ b/ql/src/test/results/clientpositive/udf_like.q.out
@@ -41,43 +41,39 @@ STAGE PLANS:
               predicate:
                   expr: (key = 86)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key = 86)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: ('_%_' like '%\_\%\_%')
-                        type: boolean
-                        expr: ('__' like '%\_\%\_%')
-                        type: boolean
-                        expr: ('%%_%_' like '%\_\%\_%')
-                        type: boolean
-                        expr: ('%_%_%' like '%\%\_\%')
-                        type: boolean
-                        expr: ('_%_' like '\%\_%')
-                        type: boolean
-                        expr: ('%__' like '__\%%')
-                        type: boolean
-                        expr: ('_%' like '\_\%\_\%%')
-                        type: boolean
-                        expr: ('_%' like '\_\%_%')
-                        type: boolean
-                        expr: ('%_' like '\%\_')
-                        type: boolean
-                        expr: ('ab' like '\%\_')
-                        type: boolean
-                        expr: ('ab' like '_a%')
-                        type: boolean
-                        expr: ('ab' like 'a')
-                        type: boolean
-                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11
-                  File Output Operator
-                    compressed: false
-                    GlobalTableId: 0
-                    table:
-                        input format: org.apache.hadoop.mapred.TextInputFormat
-                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+              Select Operator
+                expressions:
+                      expr: ('_%_' like '%\_\%\_%')
+                      type: boolean
+                      expr: ('__' like '%\_\%\_%')
+                      type: boolean
+                      expr: ('%%_%_' like '%\_\%\_%')
+                      type: boolean
+                      expr: ('%_%_%' like '%\%\_\%')
+                      type: boolean
+                      expr: ('_%_' like '\%\_%')
+                      type: boolean
+                      expr: ('%__' like '__\%%')
+                      type: boolean
+                      expr: ('_%' like '\_\%\_\%%')
+                      type: boolean
+                      expr: ('_%' like '\_\%_%')
+                      type: boolean
+                      expr: ('%_' like '\%\_')
+                      type: boolean
+                      expr: ('ab' like '\%\_')
+                      type: boolean
+                      expr: ('ab' like '_a%')
+                      type: boolean
+                      expr: ('ab' like 'a')
+                      type: boolean
+                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 0
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
 
   Stage: Stage-0
     Fetch Operator
diff --git a/ql/src/test/results/clientpositive/udf_lower.q.out b/ql/src/test/results/clientpositive/udf_lower.q.out
index c823210ec4..81c50c5b1f 100644
--- a/ql/src/test/results/clientpositive/udf_lower.q.out
+++ b/ql/src/test/results/clientpositive/udf_lower.q.out
@@ -36,23 +36,19 @@ STAGE PLANS:
               predicate:
                   expr: (key = 86)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key = 86)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: lower('AbC 123')
-                        type: string
-                        expr: upper('AbC 123')
-                        type: string
-                  outputColumnNames: _col0, _col1
-                  File Output Operator
-                    compressed: false
-                    GlobalTableId: 0
-                    table:
-                        input format: org.apache.hadoop.mapred.TextInputFormat
-                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+              Select Operator
+                expressions:
+                      expr: lower('AbC 123')
+                      type: string
+                      expr: upper('AbC 123')
+                      type: string
+                outputColumnNames: _col0, _col1
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 0
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
 
   Stage: Stage-0
     Fetch Operator
diff --git a/ql/src/test/results/clientpositive/udf_minute.q.out b/ql/src/test/results/clientpositive/udf_minute.q.out
index 9d72fa1956..e74d411c84 100644
--- a/ql/src/test/results/clientpositive/udf_minute.q.out
+++ b/ql/src/test/results/clientpositive/udf_minute.q.out
@@ -40,25 +40,21 @@ STAGE PLANS:
               predicate:
                   expr: (key = 86)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key = 86)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: minute('2009-08-07 13:14:15')
-                        type: int
-                        expr: minute('13:14:15')
-                        type: int
-                        expr: minute('2009-08-07')
-                        type: int
-                  outputColumnNames: _col0, _col1, _col2
-                  File Output Operator
-                    compressed: false
-                    GlobalTableId: 0
-                    table:
-                        input format: org.apache.hadoop.mapred.TextInputFormat
-                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+              Select Operator
+                expressions:
+                      expr: minute('2009-08-07 13:14:15')
+                      type: int
+                      expr: minute('13:14:15')
+                      type: int
+                      expr: minute('2009-08-07')
+                      type: int
+                outputColumnNames: _col0, _col1, _col2
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 0
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
 
   Stage: Stage-0
     Fetch Operator
diff --git a/ql/src/test/results/clientpositive/udf_notequal.q.out b/ql/src/test/results/clientpositive/udf_notequal.q.out
index 0deb50b4b4..7d07bf2ad8 100644
--- a/ql/src/test/results/clientpositive/udf_notequal.q.out
+++ b/ql/src/test/results/clientpositive/udf_notequal.q.out
@@ -48,23 +48,19 @@ STAGE PLANS:
               predicate:
                   expr: (key <> '302')
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key <> '302')
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
-                  outputColumnNames: _col0, _col1
-                  File Output Operator
-                    compressed: false
-                    GlobalTableId: 0
-                    table:
-                        input format: org.apache.hadoop.mapred.TextInputFormat
-                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 0
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
 
   Stage: Stage-0
     Fetch Operator
@@ -610,23 +606,19 @@ STAGE PLANS:
               predicate:
                   expr: (key <> '302')
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key <> '302')
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
-                  outputColumnNames: _col0, _col1
-                  File Output Operator
-                    compressed: false
-                    GlobalTableId: 0
-                    table:
-                        input format: org.apache.hadoop.mapred.TextInputFormat
-                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 0
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
 
   Stage: Stage-0
     Fetch Operator
diff --git a/ql/src/test/results/clientpositive/udf_parse_url.q.out b/ql/src/test/results/clientpositive/udf_parse_url.q.out
index b763ab15a5..7aff086b6c 100644
--- a/ql/src/test/results/clientpositive/udf_parse_url.q.out
+++ b/ql/src/test/results/clientpositive/udf_parse_url.q.out
@@ -63,41 +63,37 @@ STAGE PLANS:
               predicate:
                   expr: (key = 86)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key = 86)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: parse_url('http://facebook.com/path1/p.php?k1=v1&k2=v2#Ref1', 'HOST')
-                        type: string
-                        expr: parse_url('http://facebook.com/path1/p.php?k1=v1&k2=v2#Ref1', 'PATH')
-                        type: string
-                        expr: parse_url('http://facebook.com/path1/p.php?k1=v1&k2=v2#Ref1', 'QUERY')
-                        type: string
-                        expr: parse_url('http://facebook.com/path1/p.php?k1=v1&k2=v2#Ref1', 'REF')
-                        type: string
-                        expr: parse_url('http://facebook.com/path1/p.php?k1=v1&k2=v2#Ref1', 'QUERY', 'k2')
-                        type: string
-                        expr: parse_url('http://facebook.com/path1/p.php?k1=v1&k2=v2#Ref1', 'QUERY', 'k1')
-                        type: string
-                        expr: parse_url('http://facebook.com/path1/p.php?k1=v1&k2=v2#Ref1', 'QUERY', 'k3')
-                        type: string
-                        expr: parse_url('http://facebook.com/path1/p.php?k1=v1&k2=v2#Ref1', 'FILE')
-                        type: string
-                        expr: parse_url('http://facebook.com/path1/p.php?k1=v1&k2=v2#Ref1', 'PROTOCOL')
-                        type: string
-                        expr: parse_url('http://facebook.com/path1/p.php?k1=v1&k2=v2#Ref1', 'USERINFO')
-                        type: string
-                        expr: parse_url('http://facebook.com/path1/p.php?k1=v1&k2=v2#Ref1', 'AUTHORITY')
-                        type: string
-                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
-                  File Output Operator
-                    compressed: false
-                    GlobalTableId: 0
-                    table:
-                        input format: org.apache.hadoop.mapred.TextInputFormat
-                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+              Select Operator
+                expressions:
+                      expr: parse_url('http://facebook.com/path1/p.php?k1=v1&k2=v2#Ref1', 'HOST')
+                      type: string
+                      expr: parse_url('http://facebook.com/path1/p.php?k1=v1&k2=v2#Ref1', 'PATH')
+                      type: string
+                      expr: parse_url('http://facebook.com/path1/p.php?k1=v1&k2=v2#Ref1', 'QUERY')
+                      type: string
+                      expr: parse_url('http://facebook.com/path1/p.php?k1=v1&k2=v2#Ref1', 'REF')
+                      type: string
+                      expr: parse_url('http://facebook.com/path1/p.php?k1=v1&k2=v2#Ref1', 'QUERY', 'k2')
+                      type: string
+                      expr: parse_url('http://facebook.com/path1/p.php?k1=v1&k2=v2#Ref1', 'QUERY', 'k1')
+                      type: string
+                      expr: parse_url('http://facebook.com/path1/p.php?k1=v1&k2=v2#Ref1', 'QUERY', 'k3')
+                      type: string
+                      expr: parse_url('http://facebook.com/path1/p.php?k1=v1&k2=v2#Ref1', 'FILE')
+                      type: string
+                      expr: parse_url('http://facebook.com/path1/p.php?k1=v1&k2=v2#Ref1', 'PROTOCOL')
+                      type: string
+                      expr: parse_url('http://facebook.com/path1/p.php?k1=v1&k2=v2#Ref1', 'USERINFO')
+                      type: string
+                      expr: parse_url('http://facebook.com/path1/p.php?k1=v1&k2=v2#Ref1', 'AUTHORITY')
+                      type: string
+                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 0
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
 
   Stage: Stage-0
     Fetch Operator
diff --git a/ql/src/test/results/clientpositive/udf_second.q.out b/ql/src/test/results/clientpositive/udf_second.q.out
index 994989daa3..b3d4eb2644 100644
--- a/ql/src/test/results/clientpositive/udf_second.q.out
+++ b/ql/src/test/results/clientpositive/udf_second.q.out
@@ -40,25 +40,21 @@ STAGE PLANS:
               predicate:
                   expr: (key = 86)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key = 86)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: second('2009-08-07 13:14:15')
-                        type: int
-                        expr: second('13:14:15')
-                        type: int
-                        expr: second('2009-08-07')
-                        type: int
-                  outputColumnNames: _col0, _col1, _col2
-                  File Output Operator
-                    compressed: false
-                    GlobalTableId: 0
-                    table:
-                        input format: org.apache.hadoop.mapred.TextInputFormat
-                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+              Select Operator
+                expressions:
+                      expr: second('2009-08-07 13:14:15')
+                      type: int
+                      expr: second('13:14:15')
+                      type: int
+                      expr: second('2009-08-07')
+                      type: int
+                outputColumnNames: _col0, _col1, _col2
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 0
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
 
   Stage: Stage-0
     Fetch Operator
diff --git a/ql/src/test/results/clientpositive/udf_size.q.out b/ql/src/test/results/clientpositive/udf_size.q.out
index 70440282e7..25b925156b 100644
--- a/ql/src/test/results/clientpositive/udf_size.q.out
+++ b/ql/src/test/results/clientpositive/udf_size.q.out
@@ -44,28 +44,24 @@ STAGE PLANS:
               predicate:
                   expr: (lint is not null and (not mstringstring is null))
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (lint is not null and (not mstringstring is null))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: size(lint)
-                        type: int
-                        expr: size(lintstring)
-                        type: int
-                        expr: size(mstringstring)
-                        type: int
-                        expr: size(null)
-                        type: int
-                  outputColumnNames: _col0, _col1, _col2, _col3
-                  Limit
-                    File Output Operator
-                      compressed: false
-                      GlobalTableId: 0
-                      table:
-                          input format: org.apache.hadoop.mapred.TextInputFormat
-                          output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+              Select Operator
+                expressions:
+                      expr: size(lint)
+                      type: int
+                      expr: size(lintstring)
+                      type: int
+                      expr: size(mstringstring)
+                      type: int
+                      expr: size(null)
+                      type: int
+                outputColumnNames: _col0, _col1, _col2, _col3
+                Limit
+                  File Output Operator
+                    compressed: false
+                    GlobalTableId: 0
+                    table:
+                        input format: org.apache.hadoop.mapred.TextInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
 
   Stage: Stage-0
     Fetch Operator
diff --git a/ql/src/test/results/clientpositive/union.q.out b/ql/src/test/results/clientpositive/union.q.out
index e541095275..f13031737f 100644
--- a/ql/src/test/results/clientpositive/union.q.out
+++ b/ql/src/test/results/clientpositive/union.q.out
@@ -39,31 +39,27 @@ STAGE PLANS:
               predicate:
                   expr: (key < 100)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 100)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
-                  outputColumnNames: _col0, _col1
-                  Union
-                    Select Operator
-                      expressions:
-                            expr: _col0
-                            type: string
-                            expr: _col1
-                            type: string
-                      outputColumnNames: _col0, _col1
-                      File Output Operator
-                        compressed: false
-                        GlobalTableId: 1
-                        table:
-                            input format: org.apache.hadoop.mapred.TextInputFormat
-                            output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Union
+                  Select Operator
+                    expressions:
+                          expr: _col0
+                          type: string
+                          expr: _col1
+                          type: string
+                    outputColumnNames: _col0, _col1
+                    File Output Operator
+                      compressed: false
+                      GlobalTableId: 1
+                      table:
+                          input format: org.apache.hadoop.mapred.TextInputFormat
+                          output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
         null-subquery2:unioninput-subquery2:src 
           TableScan
             alias: src
@@ -71,31 +67,27 @@ STAGE PLANS:
               predicate:
                   expr: (key > 100)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key > 100)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
-                  outputColumnNames: _col0, _col1
-                  Union
-                    Select Operator
-                      expressions:
-                            expr: _col0
-                            type: string
-                            expr: _col1
-                            type: string
-                      outputColumnNames: _col0, _col1
-                      File Output Operator
-                        compressed: false
-                        GlobalTableId: 1
-                        table:
-                            input format: org.apache.hadoop.mapred.TextInputFormat
-                            output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                Union
+                  Select Operator
+                    expressions:
+                          expr: _col0
+                          type: string
+                          expr: _col1
+                          type: string
+                    outputColumnNames: _col0, _col1
+                    File Output Operator
+                      compressed: false
+                      GlobalTableId: 1
+                      table:
+                          input format: org.apache.hadoop.mapred.TextInputFormat
+                          output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
 
   Stage: Stage-4
     Conditional Operator
diff --git a/ql/src/test/results/clientpositive/union20.q.out b/ql/src/test/results/clientpositive/union20.q.out
index 6ef3deb6d3..54f0952776 100644
--- a/ql/src/test/results/clientpositive/union20.q.out
+++ b/ql/src/test/results/clientpositive/union20.q.out
@@ -164,23 +164,19 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
-                  outputColumnNames: _col0, _col1
-                  File Output Operator
-                    compressed: false
-                    GlobalTableId: 0
-                    table:
-                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
-                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 0
+                  table:
+                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
 
   Stage: Stage-4
     Map Reduce
@@ -192,23 +188,19 @@ STAGE PLANS:
               predicate:
                   expr: (key < 10)
                   type: boolean
-              Filter Operator
-                predicate:
-                    expr: (key < 10)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
-                  outputColumnNames: _col0, _col1
-                  File Output Operator
-                    compressed: false
-                    GlobalTableId: 0
-                    table:
-                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
-                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                outputColumnNames: _col0, _col1
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 0
+                  table:
+                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
 
   Stage: Stage-5
     Map Reduce
diff --git a/ql/src/test/results/clientpositive/union22.q.out b/ql/src/test/results/clientpositive/union22.q.out
index a85ad0cb6c..3204a100c0 100644
--- a/ql/src/test/results/clientpositive/union22.q.out
+++ b/ql/src/test/results/clientpositive/union22.q.out
@@ -105,32 +105,27 @@ STAGE PLANS:
               predicate:
                   expr: (k0 > 50)
                   type: boolean
-              Filter Operator
-                isSamplingPred: false
-                predicate:
-                    expr: ((ds = '1') and (k0 > 50))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: k1
-                        type: string
-                        expr: k3
-                        type: string
-                        expr: k4
-                        type: string
-                  outputColumnNames: _col1, _col3, _col4
-                  HashTable Sink Operator
-                    condition expressions:
-                      0 {k1} {k2}
-                      1 {_col3} {_col4}
-                    filter predicates:
-                      0 {(ds = '1')}
-                      1 
-                    handleSkewJoin: false
-                    keys:
-                      0 [Column[k1]]
-                      1 [Column[_col1]]
-                    Position of Big Table: 0
+              Select Operator
+                expressions:
+                      expr: k1
+                      type: string
+                      expr: k3
+                      type: string
+                      expr: k4
+                      type: string
+                outputColumnNames: _col1, _col3, _col4
+                HashTable Sink Operator
+                  condition expressions:
+                    0 {k1} {k2}
+                    1 {_col3} {_col4}
+                  filter predicates:
+                    0 {(ds = '1')}
+                    1 
+                  handleSkewJoin: false
+                  keys:
+                    0 [Column[k1]]
+                    1 [Column[_col1]]
+                  Position of Big Table: 0
 
   Stage: Stage-1
     Map Reduce
@@ -246,20 +241,80 @@ STAGE PLANS:
                   expr: _col11
                   type: string
             outputColumnNames: _col0, _col1, _col10, _col11
+            Select Operator
+              expressions:
+                    expr: _col0
+                    type: string
+                    expr: _col1
+                    type: string
+                    expr: _col10
+                    type: string
+                    expr: _col11
+                    type: string
+              outputColumnNames: _col0, _col1, _col2, _col3
+              Union
+                Select Operator
+                  expressions:
+                        expr: _col0
+                        type: string
+                        expr: _col1
+                        type: string
+                        expr: _col2
+                        type: string
+                        expr: _col3
+                        type: string
+                  outputColumnNames: _col0, _col1, _col2, _col3
+                  File Output Operator
+                    compressed: false
+                    GlobalTableId: 1
+                    directory: pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_03-36-05_942_4742399607666706050/-ext-10000
+                    NumFilesPerFileSink: 1
+                    Static Partition Specification: ds=2/
+                    Stats Publishing Key Prefix: pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_03-36-05_942_4742399607666706050/-ext-10000/
+                    table:
+                        input format: org.apache.hadoop.mapred.TextInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                        properties:
+                          bucket_count -1
+                          columns k1,k2,k3,k4
+                          columns.types string:string:string:string
+                          file.inputformat org.apache.hadoop.mapred.TextInputFormat
+                          file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                          location pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/dst_union22
+                          name default.dst_union22
+                          numFiles 1
+                          numPartitions 1
+                          numRows 500
+                          partition_columns ds
+                          rawDataSize 11124
+                          serialization.ddl struct dst_union22 { string k1, string k2, string k3, string k4}
+                          serialization.format 1
+                          serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                          totalSize 11624
+                          transient_lastDdlTime 1310380562
+                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                        name: default.dst_union22
+                    TotalFiles: 1
+                    GatherStats: true
+                    MultiFileSpray: false
+        null-subquery1:subq-subquery1:dst_union22_delta 
+          TableScan
+            alias: dst_union22_delta
+            GatherStats: false
             Filter Operator
               isSamplingPred: false
               predicate:
-                  expr: (_col0 > 20)
+                  expr: (k0 <= 50)
                   type: boolean
               Select Operator
                 expressions:
-                      expr: _col0
+                      expr: k1
                       type: string
-                      expr: _col1
+                      expr: k2
                       type: string
-                      expr: _col10
+                      expr: k3
                       type: string
-                      expr: _col11
+                      expr: k4
                       type: string
                 outputColumnNames: _col0, _col1, _col2, _col3
                 Union
@@ -307,76 +362,6 @@ STAGE PLANS:
                       TotalFiles: 1
                       GatherStats: true
                       MultiFileSpray: false
-        null-subquery1:subq-subquery1:dst_union22_delta 
-          TableScan
-            alias: dst_union22_delta
-            GatherStats: false
-            Filter Operator
-              isSamplingPred: false
-              predicate:
-                  expr: (k0 <= 50)
-                  type: boolean
-              Filter Operator
-                isSamplingPred: false
-                predicate:
-                    expr: ((ds = '1') and (k0 <= 50))
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: k1
-                        type: string
-                        expr: k2
-                        type: string
-                        expr: k3
-                        type: string
-                        expr: k4
-                        type: string
-                  outputColumnNames: _col0, _col1, _col2, _col3
-                  Union
-                    Select Operator
-                      expressions:
-                            expr: _col0
-                            type: string
-                            expr: _col1
-                            type: string
-                            expr: _col2
-                            type: string
-                            expr: _col3
-                            type: string
-                      outputColumnNames: _col0, _col1, _col2, _col3
-                      File Output Operator
-                        compressed: false
-                        GlobalTableId: 1
-                        directory: pfile:/data/users/tomasz/apache-hive/build/ql/scratchdir/hive_2011-06-01_21-10-51_082_6975609978266062150/-ext-10000
-                        NumFilesPerFileSink: 1
-                        Static Partition Specification: ds=2/
-                        Stats Publishing Key Prefix: pfile:/data/users/tomasz/apache-hive/build/ql/scratchdir/hive_2011-06-01_21-10-51_082_6975609978266062150/-ext-10000/
-                        table:
-                            input format: org.apache.hadoop.mapred.TextInputFormat
-                            output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                            properties:
-                              bucket_count -1
-                              columns k1,k2,k3,k4
-                              columns.types string:string:string:string
-                              file.inputformat org.apache.hadoop.mapred.TextInputFormat
-                              file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                              location pfile:/data/users/tomasz/apache-hive/build/ql/test/data/warehouse/dst_union22
-                              name default.dst_union22
-                              numFiles 1
-                              numPartitions 1
-                              numRows 500
-                              partition_columns ds
-                              rawDataSize 11124
-                              serialization.ddl struct dst_union22 { string k1, string k2, string k3, string k4}
-                              serialization.format 1
-                              serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                              totalSize 11624
-                              transient_lastDdlTime 1306987846
-                            serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                            name: default.dst_union22
-                        TotalFiles: 1
-                        GatherStats: true
-                        MultiFileSpray: false
       Needs Tagging: false
       Path -> Alias:
         file:/tmp/tomasz/hive_2011-06-01_21-10-51_082_6975609978266062150/-mr-10002 [file:/tmp/tomasz/hive_2011-06-01_21-10-51_082_6975609978266062150/-mr-10002]
diff --git a/ql/src/test/results/clientpositive/union_ppr.q.out b/ql/src/test/results/clientpositive/union_ppr.q.out
index 13bbff05da..57afc1e8d1 100644
--- a/ql/src/test/results/clientpositive/union_ppr.q.out
+++ b/ql/src/test/results/clientpositive/union_ppr.q.out
@@ -36,60 +36,50 @@ STAGE PLANS:
               predicate:
                   expr: (key < 100)
                   type: boolean
-              Filter Operator
-                isSamplingPred: false
-                predicate:
-                    expr: (key < 100)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
-                        expr: ds
-                        type: string
-                        expr: hr
-                        type: string
-                  outputColumnNames: _col0, _col1, _col2, _col3
-                  Union
-                    Filter Operator
-                      isSamplingPred: false
-                      predicate:
-                          expr: (_col2 = '2008-04-08')
-                          type: boolean
-                      Select Operator
-                        expressions:
-                              expr: _col0
-                              type: string
-                              expr: _col1
-                              type: string
-                              expr: _col2
-                              type: string
-                              expr: _col3
-                              type: string
-                        outputColumnNames: _col0, _col1, _col2, _col3
-                        Reduce Output Operator
-                          key expressions:
-                                expr: _col0
-                                type: string
-                                expr: _col1
-                                type: string
-                                expr: _col2
-                                type: string
-                                expr: _col3
-                                type: string
-                          sort order: ++++
-                          tag: -1
-                          value expressions:
-                                expr: _col0
-                                type: string
-                                expr: _col1
-                                type: string
-                                expr: _col2
-                                type: string
-                                expr: _col3
-                                type: string
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                      expr: ds
+                      type: string
+                      expr: hr
+                      type: string
+                outputColumnNames: _col0, _col1, _col2, _col3
+                Union
+                  Select Operator
+                    expressions:
+                          expr: _col0
+                          type: string
+                          expr: _col1
+                          type: string
+                          expr: _col2
+                          type: string
+                          expr: _col3
+                          type: string
+                    outputColumnNames: _col0, _col1, _col2, _col3
+                    Reduce Output Operator
+                      key expressions:
+                            expr: _col0
+                            type: string
+                            expr: _col1
+                            type: string
+                            expr: _col2
+                            type: string
+                            expr: _col3
+                            type: string
+                      sort order: ++++
+                      tag: -1
+                      value expressions:
+                            expr: _col0
+                            type: string
+                            expr: _col1
+                            type: string
+                            expr: _col2
+                            type: string
+                            expr: _col3
+                            type: string
         null-subquery2:a-subquery2:y 
           TableScan
             alias: y
@@ -99,60 +89,50 @@ STAGE PLANS:
               predicate:
                   expr: (key < 100)
                   type: boolean
-              Filter Operator
-                isSamplingPred: false
-                predicate:
-                    expr: (key < 100)
-                    type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
-                        expr: ds
-                        type: string
-                        expr: hr
-                        type: string
-                  outputColumnNames: _col0, _col1, _col2, _col3
-                  Union
-                    Filter Operator
-                      isSamplingPred: false
-                      predicate:
-                          expr: (_col2 = '2008-04-08')
-                          type: boolean
-                      Select Operator
-                        expressions:
-                              expr: _col0
-                              type: string
-                              expr: _col1
-                              type: string
-                              expr: _col2
-                              type: string
-                              expr: _col3
-                              type: string
-                        outputColumnNames: _col0, _col1, _col2, _col3
-                        Reduce Output Operator
-                          key expressions:
-                                expr: _col0
-                                type: string
-                                expr: _col1
-                                type: string
-                                expr: _col2
-                                type: string
-                                expr: _col3
-                                type: string
-                          sort order: ++++
-                          tag: -1
-                          value expressions:
-                                expr: _col0
-                                type: string
-                                expr: _col1
-                                type: string
-                                expr: _col2
-                                type: string
-                                expr: _col3
-                                type: string
+              Select Operator
+                expressions:
+                      expr: key
+                      type: string
+                      expr: value
+                      type: string
+                      expr: ds
+                      type: string
+                      expr: hr
+                      type: string
+                outputColumnNames: _col0, _col1, _col2, _col3
+                Union
+                  Select Operator
+                    expressions:
+                          expr: _col0
+                          type: string
+                          expr: _col1
+                          type: string
+                          expr: _col2
+                          type: string
+                          expr: _col3
+                          type: string
+                    outputColumnNames: _col0, _col1, _col2, _col3
+                    Reduce Output Operator
+                      key expressions:
+                            expr: _col0
+                            type: string
+                            expr: _col1
+                            type: string
+                            expr: _col2
+                            type: string
+                            expr: _col3
+                            type: string
+                      sort order: ++++
+                      tag: -1
+                      value expressions:
+                            expr: _col0
+                            type: string
+                            expr: _col1
+                            type: string
+                            expr: _col2
+                            type: string
+                            expr: _col3
+                            type: string
       Needs Tagging: false
       Path -> Alias:
         pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 [null-subquery1:a-subquery1:x, null-subquery2:a-subquery2:y]
diff --git a/ql/src/test/results/compiler/plan/case_sensitivity.q.xml b/ql/src/test/results/compiler/plan/case_sensitivity.q.xml
index 101966caab..2cc75e141b 100644
--- a/ql/src/test/results/compiler/plan/case_sensitivity.q.xml
+++ b/ql/src/test/results/compiler/plan/case_sensitivity.q.xml
@@ -1,5 +1,5 @@
 <?xml version="1.0" encoding="UTF-8"?> 
-<java version="1.6.0_07" class="java.beans.XMLDecoder"> 
+<java version="1.6.0_01" class="java.beans.XMLDecoder"> 
  <object id="MapRedTask0" class="org.apache.hadoop.hive.ql.exec.MapRedTask"> 
   <void property="childTasks"> 
    <object class="java.util.ArrayList"> 
@@ -33,7 +33,7 @@
                   <void property="work"> 
                    <object class="org.apache.hadoop.hive.ql.plan.StatsWork"> 
                     <void property="aggKey"> 
-                     <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-52-40_122_3999959333490330122/-ext-10000/</string> 
+                     <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-04-22_117_318942524743087866/-ext-10000/</string> 
                     </void> 
                    </object> 
                   </void> 
@@ -73,7 +73,7 @@
                     <void property="aliasToWork"> 
                      <object class="java.util.LinkedHashMap"> 
                       <void method="put"> 
-                       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-52-40_122_3999959333490330122/-ext-10002</string> 
+                       <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-04-22_117_318942524743087866/-ext-10002</string> 
                        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                         <void property="childOperators"> 
                          <object class="java.util.ArrayList"> 
@@ -82,7 +82,7 @@
                             <void property="conf"> 
                              <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
                               <void property="dirName"> 
-                               <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-52-40_122_3999959333490330122/-ext-10000</string> 
+                               <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-04-22_117_318942524743087866/-ext-10000</string> 
                               </void> 
                               <void property="numFiles"> 
                                <int>1</int> 
@@ -134,7 +134,7 @@
                                   </void> 
                                   <void method="put"> 
                                    <string>location</string> 
-                                   <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/dest1</string> 
+                                   <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/dest1</string> 
                                   </void> 
                                   <void method="put"> 
                                    <string>file.outputformat</string> 
@@ -142,7 +142,7 @@
                                   </void> 
                                   <void method="put"> 
                                    <string>transient_lastDdlTime</string> 
-                                   <string>1304059959</string> 
+                                   <string>1310382261</string> 
                                   </void> 
                                  </object> 
                                 </void> 
@@ -262,10 +262,10 @@
                     <void property="pathToAliases"> 
                      <object class="java.util.LinkedHashMap"> 
                       <void method="put"> 
-                       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-52-40_122_3999959333490330122/-ext-10002</string> 
+                       <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-04-22_117_318942524743087866/-ext-10002</string> 
                        <object class="java.util.ArrayList"> 
                         <void method="add"> 
-                         <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-52-40_122_3999959333490330122/-ext-10002</string> 
+                         <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-04-22_117_318942524743087866/-ext-10002</string> 
                         </void> 
                        </object> 
                       </void> 
@@ -274,7 +274,7 @@
                     <void property="pathToPartitionInfo"> 
                      <object class="java.util.LinkedHashMap"> 
                       <void method="put"> 
-                       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-52-40_122_3999959333490330122/-ext-10002</string> 
+                       <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-04-22_117_318942524743087866/-ext-10002</string> 
                        <object class="org.apache.hadoop.hive.ql.plan.PartitionDesc"> 
                         <void property="baseFileName"> 
                          <string>-ext-10002</string> 
@@ -328,11 +328,11 @@
                           </void> 
                           <void method="put"> 
                            <string>location</string> 
-                           <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/dest1</string> 
+                           <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/dest1</string> 
                           </void> 
                           <void method="put"> 
                            <string>transient_lastDdlTime</string> 
-                           <string>1304059959</string> 
+                           <string>1310382261</string> 
                           </void> 
                          </object> 
                         </void> 
@@ -382,13 +382,13 @@
                    <boolean>true</boolean> 
                   </void> 
                   <void property="sourceDir"> 
-                   <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-52-40_122_3999959333490330122/-ext-10000</string> 
+                   <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-04-22_117_318942524743087866/-ext-10000</string> 
                   </void> 
                   <void property="table"> 
                    <object idref="TableDesc0"/> 
                   </void> 
                   <void property="tmpDir"> 
-                   <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-52-40_122_3999959333490330122/-ext-10001</string> 
+                   <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-04-22_117_318942524743087866/-ext-10001</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -409,10 +409,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-52-40_122_3999959333490330122/-ext-10002</string> 
+               <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-04-22_117_318942524743087866/-ext-10002</string> 
               </void> 
               <void property="targetDir"> 
-               <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-52-40_122_3999959333490330122/-ext-10000</string> 
+               <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-04-22_117_318942524743087866/-ext-10000</string> 
               </void> 
              </object> 
             </void> 
@@ -438,7 +438,7 @@
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
         <void property="dir"> 
-         <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-52-40_122_3999959333490330122/-ext-10002</string> 
+         <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-04-22_117_318942524743087866/-ext-10002</string> 
         </void> 
         <void property="listTasks"> 
          <object idref="ArrayList0"/> 
@@ -528,11 +528,11 @@
          </void> 
          <void method="put"> 
           <string>location</string> 
-          <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src_thrift</string> 
+          <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src_thrift</string> 
          </void> 
          <void method="put"> 
           <string>transient_lastDdlTime</string> 
-          <string>1304059959</string> 
+          <string>1310382261</string> 
          </void> 
         </object> 
        </void> 
@@ -594,11 +594,11 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src_thrift</string> 
+            <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src_thrift</string> 
            </void> 
            <void method="put"> 
             <string>transient_lastDdlTime</string> 
-            <string>1304059959</string> 
+            <string>1310382261</string> 
            </void> 
           </object> 
          </void> 
@@ -622,327 +622,176 @@
             <void property="childOperators"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+               <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                    <void property="childOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                        <void property="conf"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                          <void property="destTableId"> 
-                           <int>1</int> 
-                          </void> 
-                          <void property="dirName"> 
-                           <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-52-40_122_3999959333490330122/-ext-10002</string> 
-                          </void> 
-                          <void property="gatherStats"> 
-                           <boolean>true</boolean> 
-                          </void> 
-                          <void property="numFiles"> 
-                           <int>1</int> 
-                          </void> 
-                          <void property="statsAggPrefix"> 
-                           <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-52-40_122_3999959333490330122/-ext-10000/</string> 
-                          </void> 
-                          <void property="tableInfo"> 
-                           <object idref="TableDesc0"/> 
-                          </void> 
-                          <void property="totalFiles"> 
-                           <int>1</int> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="counterNames"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_3_NUM_INPUT_ROWS</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_3_NUM_OUTPUT_ROWS</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_3_TIME_TAKEN</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_3_FATAL_ERROR</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="operatorId"> 
-                         <string>FS_3</string> 
-                        </void> 
-                        <void property="parentOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object idref="SelectOperator0"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="schema"> 
-                         <object idref="RowSchema0"/> 
-                        </void> 
-                       </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                    <void property="conf"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                      <void property="destTableId"> 
+                       <int>1</int> 
                       </void> 
-                     </object> 
-                    </void> 
-                    <void property="columnExprMap"> 
-                     <object class="java.util.HashMap"> 
-                      <void method="put"> 
-                       <string>_col1</string> 
-                       <object id="ExprNodeFieldDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeFieldDesc"> 
-                        <void property="desc"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                          <void property="childExprs"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                              <void property="column"> 
-                               <string>lintstring</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string>src_thrift</string> 
-                              </void> 
-                              <void property="typeInfo"> 
-                               <object id="ListTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.ListTypeInfo"> 
-                                <void property="listElementTypeInfo"> 
-                                 <object id="StructTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.StructTypeInfo"> 
-                                  <void property="allStructFieldNames"> 
-                                   <object class="java.util.ArrayList"> 
-                                    <void method="add"> 
-                                     <string>myint</string> 
-                                    </void> 
-                                    <void method="add"> 
-                                     <string>mystring</string> 
-                                    </void> 
-                                    <void method="add"> 
-                                     <string>underscore_int</string> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                  <void property="allStructFieldTypeInfos"> 
-                                   <object class="java.util.ArrayList"> 
-                                    <void method="add"> 
-                                     <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                                      <void property="typeName"> 
-                                       <string>int</string> 
-                                      </void> 
-                                     </object> 
-                                    </void> 
-                                    <void method="add"> 
-                                     <object idref="PrimitiveTypeInfo0"/> 
-                                    </void> 
-                                    <void method="add"> 
-                                     <object idref="PrimitiveTypeInfo1"/> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                              <void property="typeInfo"> 
-                               <object idref="PrimitiveTypeInfo1"/> 
-                              </void> 
-                              <void property="value"> 
-                               <int>0</int> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="genericUDF"> 
-                           <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFIndex"/> 
-                          </void> 
-                          <void property="typeInfo"> 
-                           <object idref="StructTypeInfo0"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="fieldName"> 
-                         <string>MYSTRING</string> 
-                        </void> 
-                        <void property="isList"> 
-                         <boolean>false</boolean> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
+                      <void property="dirName"> 
+                       <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-04-22_117_318942524743087866/-ext-10002</string> 
                       </void> 
-                      <void method="put"> 
-                       <string>_col0</string> 
-                       <object id="ExprNodeGenericFuncDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>lint</string> 
-                            </void> 
-                            <void property="tabAlias"> 
-                             <string>src_thrift</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object id="ListTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.ListTypeInfo"> 
-                              <void property="listElementTypeInfo"> 
-                               <object idref="PrimitiveTypeInfo1"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <int>1</int> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFIndex"/> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                       </object> 
+                      <void property="gatherStats"> 
+                       <boolean>true</boolean> 
                       </void> 
-                     </object> 
-                    </void> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                      <void property="colList"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object idref="ExprNodeGenericFuncDesc0"/> 
-                        </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeFieldDesc0"/> 
-                        </void> 
-                       </object> 
+                      <void property="numFiles"> 
+                       <int>1</int> 
                       </void> 
-                      <void property="outputColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void method="add"> 
-                         <string>_col1</string> 
-                        </void> 
-                       </object> 
+                      <void property="statsAggPrefix"> 
+                       <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-04-22_117_318942524743087866/-ext-10000/</string> 
+                      </void> 
+                      <void property="tableInfo"> 
+                       <object idref="TableDesc0"/> 
+                      </void> 
+                      <void property="totalFiles"> 
+                       <int>1</int> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_2_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_FS_3_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_2_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_FS_3_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_2_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_FS_3_TIME_TAKEN</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_2_FATAL_ERROR</string> 
+                       <string>CNTR_NAME_FS_3_FATAL_ERROR</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>SEL_2</string> 
+                     <string>FS_3</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object idref="FilterOperator1"/> 
+                       <object idref="SelectOperator0"/> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="schema"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                      <void property="signature"> 
+                     <object idref="RowSchema0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="columnExprMap"> 
+                 <object class="java.util.HashMap"> 
+                  <void method="put"> 
+                   <string>_col1</string> 
+                   <object id="ExprNodeFieldDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeFieldDesc"> 
+                    <void property="desc"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                      <void property="childExprs"> 
                        <object class="java.util.ArrayList"> 
                         <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col0</string> 
+                         <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                          <void property="column"> 
+                           <string>lintstring</string> 
                           </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo1"/> 
+                          <void property="tabAlias"> 
+                           <string>src_thrift</string> 
+                          </void> 
+                          <void property="typeInfo"> 
+                           <object id="ListTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.ListTypeInfo"> 
+                            <void property="listElementTypeInfo"> 
+                             <object id="StructTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.StructTypeInfo"> 
+                              <void property="allStructFieldNames"> 
+                               <object class="java.util.ArrayList"> 
+                                <void method="add"> 
+                                 <string>myint</string> 
+                                </void> 
+                                <void method="add"> 
+                                 <string>mystring</string> 
+                                </void> 
+                                <void method="add"> 
+                                 <string>underscore_int</string> 
+                                </void> 
+                               </object> 
+                              </void> 
+                              <void property="allStructFieldTypeInfos"> 
+                               <object class="java.util.ArrayList"> 
+                                <void method="add"> 
+                                 <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                                  <void property="typeName"> 
+                                   <string>int</string> 
+                                  </void> 
+                                 </object> 
+                                </void> 
+                                <void method="add"> 
+                                 <object idref="PrimitiveTypeInfo0"/> 
+                                </void> 
+                                <void method="add"> 
+                                 <object idref="PrimitiveTypeInfo1"/> 
+                                </void> 
+                               </object> 
+                              </void> 
+                             </object> 
+                            </void> 
+                           </object> 
                           </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col1</string> 
+                         <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                          <void property="typeInfo"> 
+                           <object idref="PrimitiveTypeInfo1"/> 
                           </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
+                          <void property="value"> 
+                           <int>0</int> 
                           </void> 
                          </object> 
                         </void> 
                        </object> 
                       </void> 
+                      <void property="genericUDF"> 
+                       <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFIndex"/> 
+                      </void> 
+                      <void property="typeInfo"> 
+                       <object idref="StructTypeInfo0"/> 
+                      </void> 
                      </object> 
                     </void> 
+                    <void property="fieldName"> 
+                     <string>MYSTRING</string> 
+                    </void> 
+                    <void property="isList"> 
+                     <boolean>false</boolean> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
                    </object> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-                  <void property="predicate"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                  <void method="put"> 
+                   <string>_col0</string> 
+                   <object id="ExprNodeGenericFuncDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
                     <void property="childExprs"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>lint</string> 
-                            </void> 
-                            <void property="tabAlias"> 
-                             <string>src_thrift</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="ListTypeInfo1"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <int>0</int> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                        <void property="column"> 
+                         <string>lint</string> 
                         </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFIndex"/> 
+                        <void property="tabAlias"> 
+                         <string>src_thrift</string> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
+                         <object id="ListTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.ListTypeInfo"> 
+                          <void property="listElementTypeInfo"> 
+                           <object idref="PrimitiveTypeInfo1"/> 
+                          </void> 
+                         </object> 
                         </void> 
                        </object> 
                       </void> 
@@ -952,21 +801,41 @@
                          <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
                         <void property="value"> 
-                         <int>0</int> 
+                         <int>1</int> 
                         </void> 
                        </object> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan"/> 
+                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFIndex"/> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                      <void property="typeName"> 
-                       <string>boolean</string> 
-                      </void> 
-                     </object> 
+                     <object idref="PrimitiveTypeInfo1"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="conf"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                  <void property="colList"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object idref="ExprNodeGenericFuncDesc0"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="ExprNodeFieldDesc0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void property="outputColumnNames"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <string>_col0</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col1</string> 
                     </void> 
                    </object> 
                   </void> 
@@ -975,21 +844,21 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_1_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_2_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_1_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_2_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_1_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_SEL_2_TIME_TAKEN</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_1_FATAL_ERROR</string> 
+                   <string>CNTR_NAME_SEL_2_FATAL_ERROR</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>FIL_1</string> 
+                 <string>SEL_2</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -1003,28 +872,22 @@
                   <void property="signature"> 
                    <object class="java.util.ArrayList"> 
                     <void method="add"> 
-                     <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                       <void property="internalName"> 
-                       <string>lint</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>src_thrift</string> 
+                       <string>_col0</string> 
                       </void> 
                       <void property="type"> 
-                       <object idref="ListTypeInfo1"/> 
+                       <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
-                     <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                       <void property="internalName"> 
-                       <string>lintstring</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>src_thrift</string> 
+                       <string>_col1</string> 
                       </void> 
                       <void property="type"> 
-                       <object idref="ListTypeInfo0"/> 
+                       <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
                      </object> 
                     </void> 
@@ -1095,7 +958,11 @@
                  <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan"/> 
                 </void> 
                 <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo2"/> 
+                 <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                  <void property="typeName"> 
+                   <string>boolean</string> 
+                  </void> 
+                 </object> 
                 </void> 
                </object> 
               </void> 
@@ -1158,7 +1025,17 @@
                  </object> 
                 </void> 
                 <void method="add"> 
-                 <object idref="ColumnInfo0"/> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>lint</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>src_thrift</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="ListTypeInfo1"/> 
+                  </void> 
+                 </object> 
                 </void> 
                 <void method="add"> 
                  <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
@@ -1178,7 +1055,17 @@
                  </object> 
                 </void> 
                 <void method="add"> 
-                 <object idref="ColumnInfo1"/> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>lintstring</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>src_thrift</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="ListTypeInfo0"/> 
+                  </void> 
+                 </object> 
                 </void> 
                 <void method="add"> 
                  <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
@@ -1303,7 +1190,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src_thrift</string> 
+       <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src_thrift</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>src_thrift</string> 
@@ -1315,7 +1202,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src_thrift</string> 
+       <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src_thrift</string> 
        <object class="org.apache.hadoop.hive.ql.plan.PartitionDesc"> 
         <void property="baseFileName"> 
          <string>src_thrift</string> 
@@ -1376,11 +1263,11 @@
           </void> 
           <void method="put"> 
            <string>location</string> 
-           <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src_thrift</string> 
+           <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src_thrift</string> 
           </void> 
           <void method="put"> 
            <string>transient_lastDdlTime</string> 
-           <string>1304059959</string> 
+           <string>1310382261</string> 
           </void> 
          </object> 
         </void> 
@@ -1442,11 +1329,11 @@
             </void> 
             <void method="put"> 
              <string>location</string> 
-             <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src_thrift</string> 
+             <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src_thrift</string> 
             </void> 
             <void method="put"> 
              <string>transient_lastDdlTime</string> 
-             <string>1304059959</string> 
+             <string>1310382261</string> 
             </void> 
            </object> 
           </void> 
diff --git a/ql/src/test/results/compiler/plan/cast1.q.xml b/ql/src/test/results/compiler/plan/cast1.q.xml
index 776e069626..c16cef4dcb 100644
--- a/ql/src/test/results/compiler/plan/cast1.q.xml
+++ b/ql/src/test/results/compiler/plan/cast1.q.xml
@@ -1,5 +1,5 @@
 <?xml version="1.0" encoding="UTF-8"?> 
-<java version="1.6.0_07" class="java.beans.XMLDecoder"> 
+<java version="1.6.0_01" class="java.beans.XMLDecoder"> 
  <object class="org.apache.hadoop.hive.ql.exec.MapRedTask"> 
   <void property="id"> 
    <string>Stage-3</string> 
@@ -62,11 +62,11 @@
          </void> 
          <void method="put"> 
           <string>location</string> 
-          <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src</string> 
+          <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src</string> 
          </void> 
          <void method="put"> 
           <string>transient_lastDdlTime</string> 
-          <string>1304059967</string> 
+          <string>1310382265</string> 
          </void> 
         </object> 
        </void> 
@@ -124,11 +124,11 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src</string> 
+            <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src</string> 
            </void> 
            <void method="put"> 
             <string>transient_lastDdlTime</string> 
-            <string>1304059967</string> 
+            <string>1310382265</string> 
            </void> 
           </object> 
          </void> 
@@ -152,490 +152,289 @@
             <void property="childOperators"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+               <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                    <void property="childOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                        <void property="conf"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                          <void property="dirName"> 
-                           <string>file:/tmp/sdong/hive_2011-04-28_23-52-49_698_4831640136709839662/-ext-10001</string> 
-                          </void> 
-                          <void property="numFiles"> 
-                           <int>1</int> 
-                          </void> 
-                          <void property="statsAggPrefix"> 
-                           <string>file:/tmp/sdong/hive_2011-04-28_23-52-49_698_4831640136709839662/-ext-10001/</string> 
-                          </void> 
-                          <void property="tableInfo"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                            <void property="deserializerClass"> 
-                             <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
-                            </void> 
-                            <void property="inputFileFormatClass"> 
-                             <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-                            </void> 
-                            <void property="outputFileFormatClass"> 
-                             <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-                            </void> 
-                            <void property="properties"> 
-                             <object class="java.util.Properties"> 
-                              <void method="put"> 
-                               <string>columns</string> 
-                               <string>_col0,_col1,_col2,_col3,_col4,_col5,_col6</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>serialization.format</string> 
-                               <string>1</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>columns.types</string> 
-                               <string>int:double:double:double:int:boolean:int</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="totalFiles"> 
-                           <int>1</int> 
-                          </void> 
-                         </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                    <void property="conf"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                      <void property="dirName"> 
+                       <string>file:/tmp/amarsri/hive_2011-07-11_04-04-26_769_5192710661051968856/-ext-10001</string> 
+                      </void> 
+                      <void property="numFiles"> 
+                       <int>1</int> 
+                      </void> 
+                      <void property="statsAggPrefix"> 
+                       <string>file:/tmp/amarsri/hive_2011-07-11_04-04-26_769_5192710661051968856/-ext-10001/</string> 
+                      </void> 
+                      <void property="tableInfo"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                        <void property="deserializerClass"> 
+                         <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
                         </void> 
-                        <void property="counterNames"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_17_NUM_INPUT_ROWS</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_17_NUM_OUTPUT_ROWS</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_17_TIME_TAKEN</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_17_FATAL_ERROR</string> 
-                          </void> 
-                         </object> 
+                        <void property="inputFileFormatClass"> 
+                         <class>org.apache.hadoop.mapred.TextInputFormat</class> 
                         </void> 
-                        <void property="operatorId"> 
-                         <string>FS_17</string> 
+                        <void property="outputFileFormatClass"> 
+                         <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
                         </void> 
-                        <void property="parentOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object idref="SelectOperator0"/> 
+                        <void property="properties"> 
+                         <object class="java.util.Properties"> 
+                          <void method="put"> 
+                           <string>columns</string> 
+                           <string>_col0,_col1,_col2,_col3,_col4,_col5,_col6</string> 
                           </void> 
-                         </object> 
-                        </void> 
-                        <void property="schema"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                          <void property="signature"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>_col0</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string></string> 
-                              </void> 
-                              <void property="type"> 
-                               <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                                <void property="typeName"> 
-                                 <string>int</string> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>_col1</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string></string> 
-                              </void> 
-                              <void property="type"> 
-                               <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                                <void property="typeName"> 
-                                 <string>double</string> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>_col2</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string></string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo1"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>_col3</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string></string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo1"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>_col4</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string></string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>_col5</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string></string> 
-                              </void> 
-                              <void property="type"> 
-                               <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                                <void property="typeName"> 
-                                 <string>boolean</string> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>_col6</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string></string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
+                          <void method="put"> 
+                           <string>serialization.format</string> 
+                           <string>1</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>columns.types</string> 
+                           <string>int:double:double:double:int:boolean:int</string> 
                           </void> 
                          </object> 
                         </void> 
                        </object> 
                       </void> 
+                      <void property="totalFiles"> 
+                       <int>1</int> 
+                      </void> 
                      </object> 
                     </void> 
-                    <void property="columnExprMap"> 
-                     <object class="java.util.HashMap"> 
-                      <void method="put"> 
-                       <string>_col6</string> 
-                       <object id="ExprNodeGenericFuncDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo2"/> 
-                            </void> 
-                            <void property="value"> 
-                             <boolean>true</boolean> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                          <void property="udfClass"> 
-                           <class>org.apache.hadoop.hive.ql.udf.UDFToInteger</class> 
+                    <void property="counterNames"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <string>CNTR_NAME_FS_16_NUM_INPUT_ROWS</string> 
+                      </void> 
+                      <void method="add"> 
+                       <string>CNTR_NAME_FS_16_NUM_OUTPUT_ROWS</string> 
+                      </void> 
+                      <void method="add"> 
+                       <string>CNTR_NAME_FS_16_TIME_TAKEN</string> 
+                      </void> 
+                      <void method="add"> 
+                       <string>CNTR_NAME_FS_16_FATAL_ERROR</string> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="operatorId"> 
+                     <string>FS_16</string> 
+                    </void> 
+                    <void property="parentOperators"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object idref="SelectOperator0"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="schema"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                      <void property="signature"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                          <void property="internalName"> 
+                           <string>_col0</string> 
                           </void> 
-                          <void property="udfName"> 
-                           <string>UDFToInteger</string> 
+                          <void property="tabAlias"> 
+                           <string></string> 
                           </void> 
-                         </object> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="put"> 
-                       <string>_col5</string> 
-                       <object id="ExprNodeGenericFuncDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                            <void property="value"> 
-                             <int>1</int> 
+                          <void property="type"> 
+                           <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                            <void property="typeName"> 
+                             <string>int</string> 
                             </void> 
                            </object> 
                           </void> 
                          </object> 
                         </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                          <void property="udfClass"> 
-                           <class>org.apache.hadoop.hive.ql.udf.UDFToBoolean</class> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                          <void property="internalName"> 
+                           <string>_col1</string> 
                           </void> 
-                          <void property="udfName"> 
-                           <string>UDFToBoolean</string> 
+                          <void property="tabAlias"> 
+                           <string></string> 
                           </void> 
-                         </object> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo2"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="put"> 
-                       <string>_col4</string> 
-                       <object id="ExprNodeGenericFuncDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                            <void property="value"> 
-                             <int>3</int> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                            <void property="childExprs"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo1"/> 
-                                </void> 
-                                <void property="value"> 
-                                 <double>2.0</double> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="genericUDF"> 
-                             <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                              <void property="udfClass"> 
-                               <class>org.apache.hadoop.hive.ql.udf.UDFToInteger</class> 
-                              </void> 
-                              <void property="udfName"> 
-                               <string>UDFToInteger</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
+                          <void property="type"> 
+                           <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                            <void property="typeName"> 
+                             <string>double</string> 
                             </void> 
                            </object> 
                           </void> 
                          </object> 
                         </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                          <void property="operator"> 
-                           <boolean>true</boolean> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                          <void property="internalName"> 
+                           <string>_col2</string> 
                           </void> 
-                          <void property="udfClass"> 
-                           <class>org.apache.hadoop.hive.ql.udf.UDFOPPlus</class> 
+                          <void property="tabAlias"> 
+                           <string></string> 
                           </void> 
-                          <void property="udfName"> 
-                           <string>+</string> 
+                          <void property="type"> 
+                           <object idref="PrimitiveTypeInfo1"/> 
                           </void> 
                          </object> 
                         </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="put"> 
-                       <string>_col3</string> 
-                       <object id="ExprNodeGenericFuncDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <double>3.0</double> 
-                            </void> 
-                           </object> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                          <void property="internalName"> 
+                           <string>_col3</string> 
                           </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <double>2.0</double> 
-                            </void> 
-                           </object> 
+                          <void property="tabAlias"> 
+                           <string></string> 
+                          </void> 
+                          <void property="type"> 
+                           <object idref="PrimitiveTypeInfo1"/> 
                           </void> 
                          </object> 
                         </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                          <void property="operator"> 
-                           <boolean>true</boolean> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                          <void property="internalName"> 
+                           <string>_col4</string> 
                           </void> 
-                          <void property="udfClass"> 
-                           <class>org.apache.hadoop.hive.ql.udf.UDFOPPlus</class> 
+                          <void property="tabAlias"> 
+                           <string></string> 
                           </void> 
-                          <void property="udfName"> 
-                           <string>+</string> 
+                          <void property="type"> 
+                           <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
                          </object> 
                         </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="put"> 
-                       <string>_col2</string> 
-                       <object id="ExprNodeGenericFuncDesc4" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                            <void property="value"> 
-                             <int>3</int> 
-                            </void> 
-                           </object> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                          <void property="internalName"> 
+                           <string>_col5</string> 
                           </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <double>2.0</double> 
+                          <void property="tabAlias"> 
+                           <string></string> 
+                          </void> 
+                          <void property="type"> 
+                           <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                            <void property="typeName"> 
+                             <string>boolean</string> 
                             </void> 
                            </object> 
                           </void> 
                          </object> 
                         </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                          <void property="operator"> 
-                           <boolean>true</boolean> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                          <void property="internalName"> 
+                           <string>_col6</string> 
                           </void> 
-                          <void property="udfClass"> 
-                           <class>org.apache.hadoop.hive.ql.udf.UDFOPPlus</class> 
+                          <void property="tabAlias"> 
+                           <string></string> 
                           </void> 
-                          <void property="udfName"> 
-                           <string>+</string> 
+                          <void property="type"> 
+                           <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
                          </object> 
                         </void> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="columnExprMap"> 
+                 <object class="java.util.HashMap"> 
+                  <void method="put"> 
+                   <string>_col6</string> 
+                   <object id="ExprNodeGenericFuncDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                    <void property="childExprs"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
+                         <object idref="PrimitiveTypeInfo2"/> 
+                        </void> 
+                        <void property="value"> 
+                         <boolean>true</boolean> 
                         </void> 
                        </object> 
                       </void> 
-                      <void method="put"> 
-                       <string>_col1</string> 
-                       <object id="ExprNodeGenericFuncDesc5" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <double>3.0</double> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                            <void property="value"> 
-                             <int>2</int> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
+                     </object> 
+                    </void> 
+                    <void property="genericUDF"> 
+                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                      <void property="udfClass"> 
+                       <class>org.apache.hadoop.hive.ql.udf.UDFToInteger</class> 
+                      </void> 
+                      <void property="udfName"> 
+                       <string>UDFToInteger</string> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="put"> 
+                   <string>_col5</string> 
+                   <object id="ExprNodeGenericFuncDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                    <void property="childExprs"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo0"/> 
                         </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                          <void property="operator"> 
-                           <boolean>true</boolean> 
-                          </void> 
-                          <void property="udfClass"> 
-                           <class>org.apache.hadoop.hive.ql.udf.UDFOPPlus</class> 
-                          </void> 
-                          <void property="udfName"> 
-                           <string>+</string> 
-                          </void> 
-                         </object> 
+                        <void property="value"> 
+                         <int>1</int> 
                         </void> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="genericUDF"> 
+                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                      <void property="udfClass"> 
+                       <class>org.apache.hadoop.hive.ql.udf.UDFToBoolean</class> 
+                      </void> 
+                      <void property="udfName"> 
+                       <string>UDFToBoolean</string> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo2"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="put"> 
+                   <string>_col4</string> 
+                   <object id="ExprNodeGenericFuncDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                    <void property="childExprs"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
+                         <object idref="PrimitiveTypeInfo0"/> 
+                        </void> 
+                        <void property="value"> 
+                         <int>3</int> 
                         </void> 
                        </object> 
                       </void> 
-                      <void method="put"> 
-                       <string>_col0</string> 
-                       <object id="ExprNodeGenericFuncDesc6" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
                         <void property="childExprs"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                            <void property="value"> 
-                             <int>3</int> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                             <void property="value"> 
-                             <int>2</int> 
+                             <double>2.0</double> 
                             </void> 
                            </object> 
                           </void> 
@@ -643,14 +442,11 @@
                         </void> 
                         <void property="genericUDF"> 
                          <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                          <void property="operator"> 
-                           <boolean>true</boolean> 
-                          </void> 
                           <void property="udfClass"> 
-                           <class>org.apache.hadoop.hive.ql.udf.UDFOPPlus</class> 
+                           <class>org.apache.hadoop.hive.ql.udf.UDFToInteger</class> 
                           </void> 
                           <void property="udfName"> 
-                           <string>+</string> 
+                           <string>UDFToInteger</string> 
                           </void> 
                          </object> 
                         </void> 
@@ -661,209 +457,171 @@
                       </void> 
                      </object> 
                     </void> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                      <void property="colList"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object idref="ExprNodeGenericFuncDesc6"/> 
-                        </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeGenericFuncDesc5"/> 
+                    <void property="genericUDF"> 
+                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                      <void property="operator"> 
+                       <boolean>true</boolean> 
+                      </void> 
+                      <void property="udfClass"> 
+                       <class>org.apache.hadoop.hive.ql.udf.UDFOPPlus</class> 
+                      </void> 
+                      <void property="udfName"> 
+                       <string>+</string> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="put"> 
+                   <string>_col3</string> 
+                   <object id="ExprNodeGenericFuncDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                    <void property="childExprs"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeGenericFuncDesc4"/> 
+                        <void property="value"> 
+                         <double>3.0</double> 
                         </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeGenericFuncDesc3"/> 
+                       </object> 
+                      </void> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeGenericFuncDesc2"/> 
+                        <void property="value"> 
+                         <double>2.0</double> 
                         </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeGenericFuncDesc1"/> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="genericUDF"> 
+                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                      <void property="operator"> 
+                       <boolean>true</boolean> 
+                      </void> 
+                      <void property="udfClass"> 
+                       <class>org.apache.hadoop.hive.ql.udf.UDFOPPlus</class> 
+                      </void> 
+                      <void property="udfName"> 
+                       <string>+</string> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo1"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="put"> 
+                   <string>_col2</string> 
+                   <object id="ExprNodeGenericFuncDesc4" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                    <void property="childExprs"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo0"/> 
                         </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeGenericFuncDesc0"/> 
+                        <void property="value"> 
+                         <int>3</int> 
                         </void> 
                        </object> 
                       </void> 
-                      <void property="outputColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void method="add"> 
-                         <string>_col1</string> 
-                        </void> 
-                        <void method="add"> 
-                         <string>_col2</string> 
-                        </void> 
-                        <void method="add"> 
-                         <string>_col3</string> 
-                        </void> 
-                        <void method="add"> 
-                         <string>_col4</string> 
-                        </void> 
-                        <void method="add"> 
-                         <string>_col5</string> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
-                        <void method="add"> 
-                         <string>_col6</string> 
+                        <void property="value"> 
+                         <double>2.0</double> 
                         </void> 
                        </object> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="counterNames"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <string>CNTR_NAME_SEL_16_NUM_INPUT_ROWS</string> 
-                      </void> 
-                      <void method="add"> 
-                       <string>CNTR_NAME_SEL_16_NUM_OUTPUT_ROWS</string> 
+                    <void property="genericUDF"> 
+                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                      <void property="operator"> 
+                       <boolean>true</boolean> 
                       </void> 
-                      <void method="add"> 
-                       <string>CNTR_NAME_SEL_16_TIME_TAKEN</string> 
+                      <void property="udfClass"> 
+                       <class>org.apache.hadoop.hive.ql.udf.UDFOPPlus</class> 
                       </void> 
-                      <void method="add"> 
-                       <string>CNTR_NAME_SEL_16_FATAL_ERROR</string> 
+                      <void property="udfName"> 
+                       <string>+</string> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="operatorId"> 
-                     <string>SEL_16</string> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo1"/> 
                     </void> 
-                    <void property="parentOperators"> 
+                   </object> 
+                  </void> 
+                  <void method="put"> 
+                   <string>_col1</string> 
+                   <object id="ExprNodeGenericFuncDesc5" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                    <void property="childExprs"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object idref="FilterOperator1"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="schema"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                      <void property="signature"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="alias"> 
-                           <string>_c0</string> 
-                          </void> 
-                          <void property="internalName"> 
-                           <string>_col0</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="alias"> 
-                           <string>_c1</string> 
-                          </void> 
-                          <void property="internalName"> 
-                           <string>_col1</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo1"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="alias"> 
-                           <string>_c2</string> 
-                          </void> 
-                          <void property="internalName"> 
-                           <string>_col2</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo1"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="alias"> 
-                           <string>_c3</string> 
-                          </void> 
-                          <void property="internalName"> 
-                           <string>_col3</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo1"/> 
-                          </void> 
-                         </object> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="alias"> 
-                           <string>_c4</string> 
-                          </void> 
-                          <void property="internalName"> 
-                           <string>_col4</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                         </object> 
+                        <void property="value"> 
+                         <double>3.0</double> 
                         </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="alias"> 
-                           <string>_c5</string> 
-                          </void> 
-                          <void property="internalName"> 
-                           <string>_col5</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo2"/> 
-                          </void> 
-                         </object> 
+                       </object> 
+                      </void> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo0"/> 
                         </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="alias"> 
-                           <string>_c6</string> 
-                          </void> 
-                          <void property="internalName"> 
-                           <string>_col6</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                         </object> 
+                        <void property="value"> 
+                         <int>2</int> 
                         </void> 
                        </object> 
                       </void> 
                      </object> 
                     </void> 
+                    <void property="genericUDF"> 
+                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                      <void property="operator"> 
+                       <boolean>true</boolean> 
+                      </void> 
+                      <void property="udfClass"> 
+                       <class>org.apache.hadoop.hive.ql.udf.UDFOPPlus</class> 
+                      </void> 
+                      <void property="udfName"> 
+                       <string>+</string> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo1"/> 
+                    </void> 
                    </object> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-                  <void property="predicate"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                  <void method="put"> 
+                   <string>_col0</string> 
+                   <object id="ExprNodeGenericFuncDesc6" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
                     <void property="childExprs"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src</string> 
-                        </void> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
                         <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo3" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
+                         <object idref="PrimitiveTypeInfo0"/> 
+                        </void> 
+                        <void property="value"> 
+                         <int>3</int> 
                         </void> 
                        </object> 
                       </void> 
@@ -873,17 +631,81 @@
                          <object idref="PrimitiveTypeInfo0"/> 
                         </void> 
                         <void property="value"> 
-                         <int>86</int> 
+                         <int>2</int> 
                         </void> 
                        </object> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual"/> 
+                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                      <void property="operator"> 
+                       <boolean>true</boolean> 
+                      </void> 
+                      <void property="udfClass"> 
+                       <class>org.apache.hadoop.hive.ql.udf.UDFOPPlus</class> 
+                      </void> 
+                      <void property="udfName"> 
+                       <string>+</string> 
+                      </void> 
+                     </object> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="conf"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                  <void property="colList"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object idref="ExprNodeGenericFuncDesc6"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="ExprNodeGenericFuncDesc5"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="ExprNodeGenericFuncDesc4"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="ExprNodeGenericFuncDesc3"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="ExprNodeGenericFuncDesc2"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="ExprNodeGenericFuncDesc1"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="ExprNodeGenericFuncDesc0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void property="outputColumnNames"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <string>_col0</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col1</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col2</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col3</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col4</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col5</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col6</string> 
                     </void> 
                    </object> 
                   </void> 
@@ -892,21 +714,21 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_15_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_15_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_15_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_15_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_15_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_SEL_15_TIME_TAKEN</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_15_FATAL_ERROR</string> 
+                   <string>CNTR_NAME_SEL_15_FATAL_ERROR</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>FIL_15</string> 
+                 <string>SEL_15</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -920,15 +742,93 @@
                   <void property="signature"> 
                    <object class="java.util.ArrayList"> 
                     <void method="add"> 
-                     <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="alias"> 
+                       <string>_c0</string> 
+                      </void> 
+                      <void property="internalName"> 
+                       <string>_col0</string> 
+                      </void> 
+                      <void property="type"> 
+                       <object idref="PrimitiveTypeInfo0"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="alias"> 
+                       <string>_c1</string> 
+                      </void> 
+                      <void property="internalName"> 
+                       <string>_col1</string> 
+                      </void> 
+                      <void property="type"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="alias"> 
+                       <string>_c2</string> 
+                      </void> 
+                      <void property="internalName"> 
+                       <string>_col2</string> 
+                      </void> 
+                      <void property="type"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="alias"> 
+                       <string>_c3</string> 
+                      </void> 
+                      <void property="internalName"> 
+                       <string>_col3</string> 
+                      </void> 
+                      <void property="type"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="alias"> 
+                       <string>_c4</string> 
+                      </void> 
+                      <void property="internalName"> 
+                       <string>_col4</string> 
+                      </void> 
+                      <void property="type"> 
+                       <object idref="PrimitiveTypeInfo0"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="alias"> 
+                       <string>_c5</string> 
+                      </void> 
                       <void property="internalName"> 
-                       <string>key</string> 
+                       <string>_col5</string> 
+                      </void> 
+                      <void property="type"> 
+                       <object idref="PrimitiveTypeInfo2"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="alias"> 
+                       <string>_c6</string> 
                       </void> 
-                      <void property="tabAlias"> 
-                       <string>src</string> 
+                      <void property="internalName"> 
+                       <string>_col6</string> 
                       </void> 
                       <void property="type"> 
-                       <object idref="PrimitiveTypeInfo3"/> 
+                       <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
                      </object> 
                     </void> 
@@ -955,7 +855,11 @@
                      <string>src</string> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo3"/> 
+                     <object id="PrimitiveTypeInfo3" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                      <void property="typeName"> 
+                       <string>string</string> 
+                      </void> 
+                     </object> 
                     </void> 
                    </object> 
                   </void> 
@@ -984,21 +888,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_18_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_17_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_18_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_17_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_18_TIME_TAKEN</string> 
+               <string>CNTR_NAME_FIL_17_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_18_FATAL_ERROR</string> 
+               <string>CNTR_NAME_FIL_17_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>FIL_18</string> 
+             <string>FIL_17</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -1012,7 +916,17 @@
               <void property="signature"> 
                <object id="ArrayList0" class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <object idref="ColumnInfo0"/> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>key</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>src</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo3"/> 
+                  </void> 
+                 </object> 
                 </void> 
                 <void method="add"> 
                  <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
@@ -1084,16 +998,16 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_14_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_13_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_14_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_13_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_14_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_13_TIME_TAKEN</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_14_FATAL_ERROR</string> 
+           <string>CNTR_NAME_TS_13_FATAL_ERROR</string> 
           </void> 
          </object> 
         </void> 
@@ -1105,7 +1019,7 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_14</string> 
+         <string>TS_13</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -1124,7 +1038,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src</string> 
+       <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>src</string> 
@@ -1136,7 +1050,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src</string> 
+       <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src</string> 
        <object class="org.apache.hadoop.hive.ql.plan.PartitionDesc"> 
         <void property="baseFileName"> 
          <string>src</string> 
@@ -1193,11 +1107,11 @@
           </void> 
           <void method="put"> 
            <string>location</string> 
-           <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src</string> 
+           <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src</string> 
           </void> 
           <void method="put"> 
            <string>transient_lastDdlTime</string> 
-           <string>1304059967</string> 
+           <string>1310382265</string> 
           </void> 
          </object> 
         </void> 
@@ -1255,11 +1169,11 @@
             </void> 
             <void method="put"> 
              <string>location</string> 
-             <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src</string> 
+             <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src</string> 
             </void> 
             <void method="put"> 
              <string>transient_lastDdlTime</string> 
-             <string>1304059967</string> 
+             <string>1310382265</string> 
             </void> 
            </object> 
           </void> 
diff --git a/ql/src/test/results/compiler/plan/groupby1.q.xml b/ql/src/test/results/compiler/plan/groupby1.q.xml
index 91f63f1ed2..3b8515e022 100755
--- a/ql/src/test/results/compiler/plan/groupby1.q.xml
+++ b/ql/src/test/results/compiler/plan/groupby1.q.xml
@@ -435,21 +435,21 @@
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_27_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_RS_25_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_27_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_RS_25_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_27_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_RS_25_TIME_TAKEN</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_27_FATAL_ERROR</string> 
+                       <string>CNTR_NAME_RS_25_FATAL_ERROR</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>RS_27</string> 
+                     <string>RS_25</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
@@ -614,21 +614,21 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_GBY_26_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_GBY_24_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_GBY_26_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_GBY_24_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_GBY_26_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_GBY_24_TIME_TAKEN</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_GBY_26_FATAL_ERROR</string> 
+                   <string>CNTR_NAME_GBY_24_FATAL_ERROR</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>GBY_26</string> 
+                 <string>GBY_24</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -725,21 +725,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_25_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_SEL_23_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_25_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_SEL_23_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_25_TIME_TAKEN</string> 
+               <string>CNTR_NAME_SEL_23_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_25_FATAL_ERROR</string> 
+               <string>CNTR_NAME_SEL_23_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>SEL_25</string> 
+             <string>SEL_23</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -799,16 +799,16 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_24_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_22_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_24_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_22_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_24_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_22_TIME_TAKEN</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_24_FATAL_ERROR</string> 
+           <string>CNTR_NAME_TS_22_FATAL_ERROR</string> 
           </void> 
          </object> 
         </void> 
@@ -823,7 +823,7 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_24</string> 
+         <string>TS_22</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -1080,21 +1080,21 @@
               <void property="counterNames"> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>CNTR_NAME_FS_30_NUM_INPUT_ROWS</string> 
+                 <string>CNTR_NAME_FS_28_NUM_INPUT_ROWS</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_FS_30_NUM_OUTPUT_ROWS</string> 
+                 <string>CNTR_NAME_FS_28_NUM_OUTPUT_ROWS</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_FS_30_TIME_TAKEN</string> 
+                 <string>CNTR_NAME_FS_28_TIME_TAKEN</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_FS_30_FATAL_ERROR</string> 
+                 <string>CNTR_NAME_FS_28_FATAL_ERROR</string> 
                 </void> 
                </object> 
               </void> 
               <void property="operatorId"> 
-               <string>FS_30</string> 
+               <string>FS_28</string> 
               </void> 
               <void property="parentOperators"> 
                <object class="java.util.ArrayList"> 
@@ -1200,21 +1200,21 @@
           <void property="counterNames"> 
            <object class="java.util.ArrayList"> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_29_NUM_INPUT_ROWS</string> 
+             <string>CNTR_NAME_SEL_27_NUM_INPUT_ROWS</string> 
             </void> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_29_NUM_OUTPUT_ROWS</string> 
+             <string>CNTR_NAME_SEL_27_NUM_OUTPUT_ROWS</string> 
             </void> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_29_TIME_TAKEN</string> 
+             <string>CNTR_NAME_SEL_27_TIME_TAKEN</string> 
             </void> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_29_FATAL_ERROR</string> 
+             <string>CNTR_NAME_SEL_27_FATAL_ERROR</string> 
             </void> 
            </object> 
           </void> 
           <void property="operatorId"> 
-           <string>SEL_29</string> 
+           <string>SEL_27</string> 
           </void> 
           <void property="parentOperators"> 
            <object class="java.util.ArrayList"> 
@@ -1338,21 +1338,21 @@
       <void property="counterNames"> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
-         <string>CNTR_NAME_GBY_28_NUM_INPUT_ROWS</string> 
+         <string>CNTR_NAME_GBY_26_NUM_INPUT_ROWS</string> 
         </void> 
         <void method="add"> 
-         <string>CNTR_NAME_GBY_28_NUM_OUTPUT_ROWS</string> 
+         <string>CNTR_NAME_GBY_26_NUM_OUTPUT_ROWS</string> 
         </void> 
         <void method="add"> 
-         <string>CNTR_NAME_GBY_28_TIME_TAKEN</string> 
+         <string>CNTR_NAME_GBY_26_TIME_TAKEN</string> 
         </void> 
         <void method="add"> 
-         <string>CNTR_NAME_GBY_28_FATAL_ERROR</string> 
+         <string>CNTR_NAME_GBY_26_FATAL_ERROR</string> 
         </void> 
        </object> 
       </void> 
       <void property="operatorId"> 
-       <string>GBY_28</string> 
+       <string>GBY_26</string> 
       </void> 
       <void property="parentOperators"> 
        <object class="java.util.ArrayList"> 
diff --git a/ql/src/test/results/compiler/plan/groupby2.q.xml b/ql/src/test/results/compiler/plan/groupby2.q.xml
index 99e6303d79..5f94292444 100755
--- a/ql/src/test/results/compiler/plan/groupby2.q.xml
+++ b/ql/src/test/results/compiler/plan/groupby2.q.xml
@@ -349,21 +349,21 @@
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_41_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_RS_39_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_41_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_RS_39_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_41_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_RS_39_TIME_TAKEN</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_41_FATAL_ERROR</string> 
+                       <string>CNTR_NAME_RS_39_FATAL_ERROR</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>RS_41</string> 
+                     <string>RS_39</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
@@ -707,21 +707,21 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_GBY_40_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_GBY_38_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_GBY_40_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_GBY_38_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_GBY_40_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_GBY_38_TIME_TAKEN</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_GBY_40_FATAL_ERROR</string> 
+                   <string>CNTR_NAME_GBY_38_FATAL_ERROR</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>GBY_40</string> 
+                 <string>GBY_38</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -844,21 +844,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_39_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_SEL_37_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_39_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_SEL_37_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_39_TIME_TAKEN</string> 
+               <string>CNTR_NAME_SEL_37_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_39_FATAL_ERROR</string> 
+               <string>CNTR_NAME_SEL_37_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>SEL_39</string> 
+             <string>SEL_37</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -918,16 +918,16 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_38_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_36_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_38_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_36_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_38_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_36_TIME_TAKEN</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_38_FATAL_ERROR</string> 
+           <string>CNTR_NAME_TS_36_FATAL_ERROR</string> 
           </void> 
          </object> 
         </void> 
@@ -942,7 +942,7 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_38</string> 
+         <string>TS_36</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -1212,21 +1212,21 @@
               <void property="counterNames"> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>CNTR_NAME_FS_44_NUM_INPUT_ROWS</string> 
+                 <string>CNTR_NAME_FS_42_NUM_INPUT_ROWS</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_FS_44_NUM_OUTPUT_ROWS</string> 
+                 <string>CNTR_NAME_FS_42_NUM_OUTPUT_ROWS</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_FS_44_TIME_TAKEN</string> 
+                 <string>CNTR_NAME_FS_42_TIME_TAKEN</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_FS_44_FATAL_ERROR</string> 
+                 <string>CNTR_NAME_FS_42_FATAL_ERROR</string> 
                 </void> 
                </object> 
               </void> 
               <void property="operatorId"> 
-               <string>FS_44</string> 
+               <string>FS_42</string> 
               </void> 
               <void property="parentOperators"> 
                <object class="java.util.ArrayList"> 
@@ -1399,21 +1399,21 @@
           <void property="counterNames"> 
            <object class="java.util.ArrayList"> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_43_NUM_INPUT_ROWS</string> 
+             <string>CNTR_NAME_SEL_41_NUM_INPUT_ROWS</string> 
             </void> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_43_NUM_OUTPUT_ROWS</string> 
+             <string>CNTR_NAME_SEL_41_NUM_OUTPUT_ROWS</string> 
             </void> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_43_TIME_TAKEN</string> 
+             <string>CNTR_NAME_SEL_41_TIME_TAKEN</string> 
             </void> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_43_FATAL_ERROR</string> 
+             <string>CNTR_NAME_SEL_41_FATAL_ERROR</string> 
             </void> 
            </object> 
           </void> 
           <void property="operatorId"> 
-           <string>SEL_43</string> 
+           <string>SEL_41</string> 
           </void> 
           <void property="parentOperators"> 
            <object class="java.util.ArrayList"> 
@@ -1591,21 +1591,21 @@
       <void property="counterNames"> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
-         <string>CNTR_NAME_GBY_42_NUM_INPUT_ROWS</string> 
+         <string>CNTR_NAME_GBY_40_NUM_INPUT_ROWS</string> 
         </void> 
         <void method="add"> 
-         <string>CNTR_NAME_GBY_42_NUM_OUTPUT_ROWS</string> 
+         <string>CNTR_NAME_GBY_40_NUM_OUTPUT_ROWS</string> 
         </void> 
         <void method="add"> 
-         <string>CNTR_NAME_GBY_42_TIME_TAKEN</string> 
+         <string>CNTR_NAME_GBY_40_TIME_TAKEN</string> 
         </void> 
         <void method="add"> 
-         <string>CNTR_NAME_GBY_42_FATAL_ERROR</string> 
+         <string>CNTR_NAME_GBY_40_FATAL_ERROR</string> 
         </void> 
        </object> 
       </void> 
       <void property="operatorId"> 
-       <string>GBY_42</string> 
+       <string>GBY_40</string> 
       </void> 
       <void property="parentOperators"> 
        <object class="java.util.ArrayList"> 
diff --git a/ql/src/test/results/compiler/plan/groupby3.q.xml b/ql/src/test/results/compiler/plan/groupby3.q.xml
index 1eacb52d3b..02a564735a 100644
--- a/ql/src/test/results/compiler/plan/groupby3.q.xml
+++ b/ql/src/test/results/compiler/plan/groupby3.q.xml
@@ -390,21 +390,21 @@
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_55_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_RS_53_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_55_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_RS_53_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_55_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_RS_53_TIME_TAKEN</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_55_FATAL_ERROR</string> 
+                       <string>CNTR_NAME_RS_53_FATAL_ERROR</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>RS_55</string> 
+                     <string>RS_53</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
@@ -899,21 +899,21 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_GBY_54_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_GBY_52_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_GBY_54_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_GBY_52_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_GBY_54_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_GBY_52_TIME_TAKEN</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_GBY_54_FATAL_ERROR</string> 
+                   <string>CNTR_NAME_GBY_52_FATAL_ERROR</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>GBY_54</string> 
+                 <string>GBY_52</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -1046,21 +1046,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_53_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_SEL_51_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_53_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_SEL_51_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_53_TIME_TAKEN</string> 
+               <string>CNTR_NAME_SEL_51_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_53_FATAL_ERROR</string> 
+               <string>CNTR_NAME_SEL_51_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>SEL_53</string> 
+             <string>SEL_51</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -1107,16 +1107,16 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_52_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_50_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_52_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_50_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_52_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_50_TIME_TAKEN</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_52_FATAL_ERROR</string> 
+           <string>CNTR_NAME_TS_50_FATAL_ERROR</string> 
           </void> 
          </object> 
         </void> 
@@ -1128,7 +1128,7 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_52</string> 
+         <string>TS_50</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -1408,21 +1408,21 @@
               <void property="counterNames"> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>CNTR_NAME_FS_58_NUM_INPUT_ROWS</string> 
+                 <string>CNTR_NAME_FS_56_NUM_INPUT_ROWS</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_FS_58_NUM_OUTPUT_ROWS</string> 
+                 <string>CNTR_NAME_FS_56_NUM_OUTPUT_ROWS</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_FS_58_TIME_TAKEN</string> 
+                 <string>CNTR_NAME_FS_56_TIME_TAKEN</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_FS_58_FATAL_ERROR</string> 
+                 <string>CNTR_NAME_FS_56_FATAL_ERROR</string> 
                 </void> 
                </object> 
               </void> 
               <void property="operatorId"> 
-               <string>FS_58</string> 
+               <string>FS_56</string> 
               </void> 
               <void property="parentOperators"> 
                <object class="java.util.ArrayList"> 
@@ -1627,21 +1627,21 @@
           <void property="counterNames"> 
            <object class="java.util.ArrayList"> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_57_NUM_INPUT_ROWS</string> 
+             <string>CNTR_NAME_SEL_55_NUM_INPUT_ROWS</string> 
             </void> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_57_NUM_OUTPUT_ROWS</string> 
+             <string>CNTR_NAME_SEL_55_NUM_OUTPUT_ROWS</string> 
             </void> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_57_TIME_TAKEN</string> 
+             <string>CNTR_NAME_SEL_55_TIME_TAKEN</string> 
             </void> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_57_FATAL_ERROR</string> 
+             <string>CNTR_NAME_SEL_55_FATAL_ERROR</string> 
             </void> 
            </object> 
           </void> 
           <void property="operatorId"> 
-           <string>SEL_57</string> 
+           <string>SEL_55</string> 
           </void> 
           <void property="parentOperators"> 
            <object class="java.util.ArrayList"> 
@@ -1916,21 +1916,21 @@
       <void property="counterNames"> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
-         <string>CNTR_NAME_GBY_56_NUM_INPUT_ROWS</string> 
+         <string>CNTR_NAME_GBY_54_NUM_INPUT_ROWS</string> 
         </void> 
         <void method="add"> 
-         <string>CNTR_NAME_GBY_56_NUM_OUTPUT_ROWS</string> 
+         <string>CNTR_NAME_GBY_54_NUM_OUTPUT_ROWS</string> 
         </void> 
         <void method="add"> 
-         <string>CNTR_NAME_GBY_56_TIME_TAKEN</string> 
+         <string>CNTR_NAME_GBY_54_TIME_TAKEN</string> 
         </void> 
         <void method="add"> 
-         <string>CNTR_NAME_GBY_56_FATAL_ERROR</string> 
+         <string>CNTR_NAME_GBY_54_FATAL_ERROR</string> 
         </void> 
        </object> 
       </void> 
       <void property="operatorId"> 
-       <string>GBY_56</string> 
+       <string>GBY_54</string> 
       </void> 
       <void property="parentOperators"> 
        <object class="java.util.ArrayList"> 
diff --git a/ql/src/test/results/compiler/plan/groupby4.q.xml b/ql/src/test/results/compiler/plan/groupby4.q.xml
index 1e8337c89a..8f59d646fc 100644
--- a/ql/src/test/results/compiler/plan/groupby4.q.xml
+++ b/ql/src/test/results/compiler/plan/groupby4.q.xml
@@ -279,21 +279,21 @@
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_69_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_RS_67_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_69_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_RS_67_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_69_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_RS_67_TIME_TAKEN</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_69_FATAL_ERROR</string> 
+                       <string>CNTR_NAME_RS_67_FATAL_ERROR</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>RS_69</string> 
+                     <string>RS_67</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
@@ -422,21 +422,21 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_GBY_68_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_GBY_66_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_GBY_68_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_GBY_66_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_GBY_68_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_GBY_66_TIME_TAKEN</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_GBY_68_FATAL_ERROR</string> 
+                   <string>CNTR_NAME_GBY_66_FATAL_ERROR</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>GBY_68</string> 
+                 <string>GBY_66</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -504,21 +504,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_67_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_SEL_65_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_67_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_SEL_65_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_67_TIME_TAKEN</string> 
+               <string>CNTR_NAME_SEL_65_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_67_FATAL_ERROR</string> 
+               <string>CNTR_NAME_SEL_65_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>SEL_67</string> 
+             <string>SEL_65</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -565,16 +565,16 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_66_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_64_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_66_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_64_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_66_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_64_TIME_TAKEN</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_66_FATAL_ERROR</string> 
+           <string>CNTR_NAME_TS_64_FATAL_ERROR</string> 
           </void> 
          </object> 
         </void> 
@@ -586,7 +586,7 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_66</string> 
+         <string>TS_64</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -870,21 +870,21 @@
               <void property="counterNames"> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>CNTR_NAME_FS_72_NUM_INPUT_ROWS</string> 
+                 <string>CNTR_NAME_FS_70_NUM_INPUT_ROWS</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_FS_72_NUM_OUTPUT_ROWS</string> 
+                 <string>CNTR_NAME_FS_70_NUM_OUTPUT_ROWS</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_FS_72_TIME_TAKEN</string> 
+                 <string>CNTR_NAME_FS_70_TIME_TAKEN</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_FS_72_FATAL_ERROR</string> 
+                 <string>CNTR_NAME_FS_70_FATAL_ERROR</string> 
                 </void> 
                </object> 
               </void> 
               <void property="operatorId"> 
-               <string>FS_72</string> 
+               <string>FS_70</string> 
               </void> 
               <void property="parentOperators"> 
                <object class="java.util.ArrayList"> 
@@ -957,21 +957,21 @@
           <void property="counterNames"> 
            <object class="java.util.ArrayList"> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_71_NUM_INPUT_ROWS</string> 
+             <string>CNTR_NAME_SEL_69_NUM_INPUT_ROWS</string> 
             </void> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_71_NUM_OUTPUT_ROWS</string> 
+             <string>CNTR_NAME_SEL_69_NUM_OUTPUT_ROWS</string> 
             </void> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_71_TIME_TAKEN</string> 
+             <string>CNTR_NAME_SEL_69_TIME_TAKEN</string> 
             </void> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_71_FATAL_ERROR</string> 
+             <string>CNTR_NAME_SEL_69_FATAL_ERROR</string> 
             </void> 
            </object> 
           </void> 
           <void property="operatorId"> 
-           <string>SEL_71</string> 
+           <string>SEL_69</string> 
           </void> 
           <void property="parentOperators"> 
            <object class="java.util.ArrayList"> 
@@ -1055,21 +1055,21 @@
       <void property="counterNames"> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
-         <string>CNTR_NAME_GBY_70_NUM_INPUT_ROWS</string> 
+         <string>CNTR_NAME_GBY_68_NUM_INPUT_ROWS</string> 
         </void> 
         <void method="add"> 
-         <string>CNTR_NAME_GBY_70_NUM_OUTPUT_ROWS</string> 
+         <string>CNTR_NAME_GBY_68_NUM_OUTPUT_ROWS</string> 
         </void> 
         <void method="add"> 
-         <string>CNTR_NAME_GBY_70_TIME_TAKEN</string> 
+         <string>CNTR_NAME_GBY_68_TIME_TAKEN</string> 
         </void> 
         <void method="add"> 
-         <string>CNTR_NAME_GBY_70_FATAL_ERROR</string> 
+         <string>CNTR_NAME_GBY_68_FATAL_ERROR</string> 
         </void> 
        </object> 
       </void> 
       <void property="operatorId"> 
-       <string>GBY_70</string> 
+       <string>GBY_68</string> 
       </void> 
       <void property="parentOperators"> 
        <object class="java.util.ArrayList"> 
diff --git a/ql/src/test/results/compiler/plan/groupby5.q.xml b/ql/src/test/results/compiler/plan/groupby5.q.xml
index 630195652b..9c4b3680e2 100644
--- a/ql/src/test/results/compiler/plan/groupby5.q.xml
+++ b/ql/src/test/results/compiler/plan/groupby5.q.xml
@@ -301,21 +301,21 @@
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_83_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_RS_81_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_83_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_RS_81_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_83_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_RS_81_TIME_TAKEN</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_83_FATAL_ERROR</string> 
+                       <string>CNTR_NAME_RS_81_FATAL_ERROR</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>RS_83</string> 
+                     <string>RS_81</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
@@ -480,21 +480,21 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_GBY_82_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_GBY_80_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_GBY_82_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_GBY_80_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_GBY_82_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_GBY_80_TIME_TAKEN</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_GBY_82_FATAL_ERROR</string> 
+                   <string>CNTR_NAME_GBY_80_FATAL_ERROR</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>GBY_82</string> 
+                 <string>GBY_80</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -591,21 +591,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_81_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_SEL_79_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_81_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_SEL_79_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_81_TIME_TAKEN</string> 
+               <string>CNTR_NAME_SEL_79_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_81_FATAL_ERROR</string> 
+               <string>CNTR_NAME_SEL_79_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>SEL_81</string> 
+             <string>SEL_79</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -665,16 +665,16 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_80_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_78_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_80_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_78_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_80_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_78_TIME_TAKEN</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_80_FATAL_ERROR</string> 
+           <string>CNTR_NAME_TS_78_FATAL_ERROR</string> 
           </void> 
          </object> 
         </void> 
@@ -689,7 +689,7 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_80</string> 
+         <string>TS_78</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -963,21 +963,21 @@
               <void property="counterNames"> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>CNTR_NAME_FS_86_NUM_INPUT_ROWS</string> 
+                 <string>CNTR_NAME_FS_84_NUM_INPUT_ROWS</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_FS_86_NUM_OUTPUT_ROWS</string> 
+                 <string>CNTR_NAME_FS_84_NUM_OUTPUT_ROWS</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_FS_86_TIME_TAKEN</string> 
+                 <string>CNTR_NAME_FS_84_TIME_TAKEN</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_FS_86_FATAL_ERROR</string> 
+                 <string>CNTR_NAME_FS_84_FATAL_ERROR</string> 
                 </void> 
                </object> 
               </void> 
               <void property="operatorId"> 
-               <string>FS_86</string> 
+               <string>FS_84</string> 
               </void> 
               <void property="parentOperators"> 
                <object class="java.util.ArrayList"> 
@@ -1083,21 +1083,21 @@
           <void property="counterNames"> 
            <object class="java.util.ArrayList"> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_85_NUM_INPUT_ROWS</string> 
+             <string>CNTR_NAME_SEL_83_NUM_INPUT_ROWS</string> 
             </void> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_85_NUM_OUTPUT_ROWS</string> 
+             <string>CNTR_NAME_SEL_83_NUM_OUTPUT_ROWS</string> 
             </void> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_85_TIME_TAKEN</string> 
+             <string>CNTR_NAME_SEL_83_TIME_TAKEN</string> 
             </void> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_85_FATAL_ERROR</string> 
+             <string>CNTR_NAME_SEL_83_FATAL_ERROR</string> 
             </void> 
            </object> 
           </void> 
           <void property="operatorId"> 
-           <string>SEL_85</string> 
+           <string>SEL_83</string> 
           </void> 
           <void property="parentOperators"> 
            <object class="java.util.ArrayList"> 
@@ -1227,21 +1227,21 @@
       <void property="counterNames"> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
-         <string>CNTR_NAME_GBY_84_NUM_INPUT_ROWS</string> 
+         <string>CNTR_NAME_GBY_82_NUM_INPUT_ROWS</string> 
         </void> 
         <void method="add"> 
-         <string>CNTR_NAME_GBY_84_NUM_OUTPUT_ROWS</string> 
+         <string>CNTR_NAME_GBY_82_NUM_OUTPUT_ROWS</string> 
         </void> 
         <void method="add"> 
-         <string>CNTR_NAME_GBY_84_TIME_TAKEN</string> 
+         <string>CNTR_NAME_GBY_82_TIME_TAKEN</string> 
         </void> 
         <void method="add"> 
-         <string>CNTR_NAME_GBY_84_FATAL_ERROR</string> 
+         <string>CNTR_NAME_GBY_82_FATAL_ERROR</string> 
         </void> 
        </object> 
       </void> 
       <void property="operatorId"> 
-       <string>GBY_84</string> 
+       <string>GBY_82</string> 
       </void> 
       <void property="parentOperators"> 
        <object class="java.util.ArrayList"> 
diff --git a/ql/src/test/results/compiler/plan/groupby6.q.xml b/ql/src/test/results/compiler/plan/groupby6.q.xml
index be335faecf..517c3590e3 100644
--- a/ql/src/test/results/compiler/plan/groupby6.q.xml
+++ b/ql/src/test/results/compiler/plan/groupby6.q.xml
@@ -279,21 +279,21 @@
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_97_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_RS_95_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_97_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_RS_95_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_97_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_RS_95_TIME_TAKEN</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_97_FATAL_ERROR</string> 
+                       <string>CNTR_NAME_RS_95_FATAL_ERROR</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>RS_97</string> 
+                     <string>RS_95</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
@@ -422,21 +422,21 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_GBY_96_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_GBY_94_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_GBY_96_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_GBY_94_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_GBY_96_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_GBY_94_TIME_TAKEN</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_GBY_96_FATAL_ERROR</string> 
+                   <string>CNTR_NAME_GBY_94_FATAL_ERROR</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>GBY_96</string> 
+                 <string>GBY_94</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -504,21 +504,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_95_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_SEL_93_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_95_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_SEL_93_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_95_TIME_TAKEN</string> 
+               <string>CNTR_NAME_SEL_93_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_95_FATAL_ERROR</string> 
+               <string>CNTR_NAME_SEL_93_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>SEL_95</string> 
+             <string>SEL_93</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -565,16 +565,16 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_94_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_92_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_94_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_92_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_94_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_92_TIME_TAKEN</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_94_FATAL_ERROR</string> 
+           <string>CNTR_NAME_TS_92_FATAL_ERROR</string> 
           </void> 
          </object> 
         </void> 
@@ -586,7 +586,7 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_94</string> 
+         <string>TS_92</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -870,21 +870,21 @@
               <void property="counterNames"> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>CNTR_NAME_FS_100_NUM_INPUT_ROWS</string> 
+                 <string>CNTR_NAME_FS_98_NUM_INPUT_ROWS</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_FS_100_NUM_OUTPUT_ROWS</string> 
+                 <string>CNTR_NAME_FS_98_NUM_OUTPUT_ROWS</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_FS_100_TIME_TAKEN</string> 
+                 <string>CNTR_NAME_FS_98_TIME_TAKEN</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_FS_100_FATAL_ERROR</string> 
+                 <string>CNTR_NAME_FS_98_FATAL_ERROR</string> 
                 </void> 
                </object> 
               </void> 
               <void property="operatorId"> 
-               <string>FS_100</string> 
+               <string>FS_98</string> 
               </void> 
               <void property="parentOperators"> 
                <object class="java.util.ArrayList"> 
@@ -957,21 +957,21 @@
           <void property="counterNames"> 
            <object class="java.util.ArrayList"> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_99_NUM_INPUT_ROWS</string> 
+             <string>CNTR_NAME_SEL_97_NUM_INPUT_ROWS</string> 
             </void> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_99_NUM_OUTPUT_ROWS</string> 
+             <string>CNTR_NAME_SEL_97_NUM_OUTPUT_ROWS</string> 
             </void> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_99_TIME_TAKEN</string> 
+             <string>CNTR_NAME_SEL_97_TIME_TAKEN</string> 
             </void> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_99_FATAL_ERROR</string> 
+             <string>CNTR_NAME_SEL_97_FATAL_ERROR</string> 
             </void> 
            </object> 
           </void> 
           <void property="operatorId"> 
-           <string>SEL_99</string> 
+           <string>SEL_97</string> 
           </void> 
           <void property="parentOperators"> 
            <object class="java.util.ArrayList"> 
@@ -1055,21 +1055,21 @@
       <void property="counterNames"> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
-         <string>CNTR_NAME_GBY_98_NUM_INPUT_ROWS</string> 
+         <string>CNTR_NAME_GBY_96_NUM_INPUT_ROWS</string> 
         </void> 
         <void method="add"> 
-         <string>CNTR_NAME_GBY_98_NUM_OUTPUT_ROWS</string> 
+         <string>CNTR_NAME_GBY_96_NUM_OUTPUT_ROWS</string> 
         </void> 
         <void method="add"> 
-         <string>CNTR_NAME_GBY_98_TIME_TAKEN</string> 
+         <string>CNTR_NAME_GBY_96_TIME_TAKEN</string> 
         </void> 
         <void method="add"> 
-         <string>CNTR_NAME_GBY_98_FATAL_ERROR</string> 
+         <string>CNTR_NAME_GBY_96_FATAL_ERROR</string> 
         </void> 
        </object> 
       </void> 
       <void property="operatorId"> 
-       <string>GBY_98</string> 
+       <string>GBY_96</string> 
       </void> 
       <void property="parentOperators"> 
        <object class="java.util.ArrayList"> 
diff --git a/ql/src/test/results/compiler/plan/input1.q.xml b/ql/src/test/results/compiler/plan/input1.q.xml
index 8a2433cd2c..8c0250e153 100755
--- a/ql/src/test/results/compiler/plan/input1.q.xml
+++ b/ql/src/test/results/compiler/plan/input1.q.xml
@@ -1,5 +1,5 @@
 <?xml version="1.0" encoding="UTF-8"?> 
-<java version="1.6.0_07" class="java.beans.XMLDecoder"> 
+<java version="1.6.0_01" class="java.beans.XMLDecoder"> 
  <object id="MapRedTask0" class="org.apache.hadoop.hive.ql.exec.MapRedTask"> 
   <void property="childTasks"> 
    <object class="java.util.ArrayList"> 
@@ -33,7 +33,7 @@
                   <void property="work"> 
                    <object class="org.apache.hadoop.hive.ql.plan.StatsWork"> 
                     <void property="aggKey"> 
-                     <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-53-49_576_2888243981035876529/-ext-10000/</string> 
+                     <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-04-53_288_7531718006958804873/-ext-10000/</string> 
                     </void> 
                    </object> 
                   </void> 
@@ -73,7 +73,7 @@
                     <void property="aliasToWork"> 
                      <object class="java.util.LinkedHashMap"> 
                       <void method="put"> 
-                       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-53-49_576_2888243981035876529/-ext-10002</string> 
+                       <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-04-53_288_7531718006958804873/-ext-10002</string> 
                        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                         <void property="childOperators"> 
                          <object class="java.util.ArrayList"> 
@@ -82,7 +82,7 @@
                             <void property="conf"> 
                              <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
                               <void property="dirName"> 
-                               <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-53-49_576_2888243981035876529/-ext-10000</string> 
+                               <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-04-53_288_7531718006958804873/-ext-10000</string> 
                               </void> 
                               <void property="numFiles"> 
                                <int>1</int> 
@@ -134,7 +134,7 @@
                                   </void> 
                                   <void method="put"> 
                                    <string>location</string> 
-                                   <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/dest1</string> 
+                                   <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/dest1</string> 
                                   </void> 
                                   <void method="put"> 
                                    <string>file.outputformat</string> 
@@ -142,7 +142,7 @@
                                   </void> 
                                   <void method="put"> 
                                    <string>transient_lastDdlTime</string> 
-                                   <string>1304060029</string> 
+                                   <string>1310382293</string> 
                                   </void> 
                                  </object> 
                                 </void> 
@@ -159,21 +159,21 @@
                             <void property="counterNames"> 
                              <object class="java.util.ArrayList"> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_114_NUM_INPUT_ROWS</string> 
+                               <string>CNTR_NAME_FS_112_NUM_INPUT_ROWS</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_114_NUM_OUTPUT_ROWS</string> 
+                               <string>CNTR_NAME_FS_112_NUM_OUTPUT_ROWS</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_114_TIME_TAKEN</string> 
+                               <string>CNTR_NAME_FS_112_TIME_TAKEN</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_114_FATAL_ERROR</string> 
+                               <string>CNTR_NAME_FS_112_FATAL_ERROR</string> 
                               </void> 
                              </object> 
                             </void> 
                             <void property="operatorId"> 
-                             <string>FS_114</string> 
+                             <string>FS_112</string> 
                             </void> 
                             <void property="parentOperators"> 
                              <object class="java.util.ArrayList"> 
@@ -227,21 +227,21 @@
                         <void property="counterNames"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_113_NUM_INPUT_ROWS</string> 
+                           <string>CNTR_NAME_TS_111_NUM_INPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_113_NUM_OUTPUT_ROWS</string> 
+                           <string>CNTR_NAME_TS_111_NUM_OUTPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_113_TIME_TAKEN</string> 
+                           <string>CNTR_NAME_TS_111_TIME_TAKEN</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_113_FATAL_ERROR</string> 
+                           <string>CNTR_NAME_TS_111_FATAL_ERROR</string> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="operatorId"> 
-                         <string>TS_113</string> 
+                         <string>TS_111</string> 
                         </void> 
                         <void property="schema"> 
                          <object idref="RowSchema0"/> 
@@ -262,10 +262,10 @@
                     <void property="pathToAliases"> 
                      <object class="java.util.LinkedHashMap"> 
                       <void method="put"> 
-                       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-53-49_576_2888243981035876529/-ext-10002</string> 
+                       <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-04-53_288_7531718006958804873/-ext-10002</string> 
                        <object class="java.util.ArrayList"> 
                         <void method="add"> 
-                         <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-53-49_576_2888243981035876529/-ext-10002</string> 
+                         <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-04-53_288_7531718006958804873/-ext-10002</string> 
                         </void> 
                        </object> 
                       </void> 
@@ -274,7 +274,7 @@
                     <void property="pathToPartitionInfo"> 
                      <object class="java.util.LinkedHashMap"> 
                       <void method="put"> 
-                       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-53-49_576_2888243981035876529/-ext-10002</string> 
+                       <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-04-53_288_7531718006958804873/-ext-10002</string> 
                        <object class="org.apache.hadoop.hive.ql.plan.PartitionDesc"> 
                         <void property="baseFileName"> 
                          <string>-ext-10002</string> 
@@ -328,11 +328,11 @@
                           </void> 
                           <void method="put"> 
                            <string>location</string> 
-                           <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/dest1</string> 
+                           <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/dest1</string> 
                           </void> 
                           <void method="put"> 
                            <string>transient_lastDdlTime</string> 
-                           <string>1304060029</string> 
+                           <string>1310382293</string> 
                           </void> 
                          </object> 
                         </void> 
@@ -382,13 +382,13 @@
                    <boolean>true</boolean> 
                   </void> 
                   <void property="sourceDir"> 
-                   <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-53-49_576_2888243981035876529/-ext-10000</string> 
+                   <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-04-53_288_7531718006958804873/-ext-10000</string> 
                   </void> 
                   <void property="table"> 
                    <object idref="TableDesc0"/> 
                   </void> 
                   <void property="tmpDir"> 
-                   <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-53-49_576_2888243981035876529/-ext-10001</string> 
+                   <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-04-53_288_7531718006958804873/-ext-10001</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -409,10 +409,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-53-49_576_2888243981035876529/-ext-10002</string> 
+               <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-04-53_288_7531718006958804873/-ext-10002</string> 
               </void> 
               <void property="targetDir"> 
-               <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-53-49_576_2888243981035876529/-ext-10000</string> 
+               <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-04-53_288_7531718006958804873/-ext-10000</string> 
               </void> 
              </object> 
             </void> 
@@ -438,7 +438,7 @@
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
         <void property="dir"> 
-         <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-53-49_576_2888243981035876529/-ext-10002</string> 
+         <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-04-53_288_7531718006958804873/-ext-10002</string> 
         </void> 
         <void property="listTasks"> 
          <object idref="ArrayList0"/> 
@@ -524,11 +524,11 @@
          </void> 
          <void method="put"> 
           <string>location</string> 
-          <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src</string> 
+          <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src</string> 
          </void> 
          <void method="put"> 
           <string>transient_lastDdlTime</string> 
-          <string>1304060027</string> 
+          <string>1310382292</string> 
          </void> 
         </object> 
        </void> 
@@ -586,11 +586,11 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src</string> 
+            <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src</string> 
            </void> 
            <void method="put"> 
             <string>transient_lastDdlTime</string> 
-            <string>1304060027</string> 
+            <string>1310382292</string> 
            </void> 
           </object> 
          </void> 
@@ -614,237 +614,120 @@
             <void property="childOperators"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+               <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                    <void property="childOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                        <void property="conf"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                          <void property="destTableId"> 
-                           <int>1</int> 
-                          </void> 
-                          <void property="dirName"> 
-                           <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-53-49_576_2888243981035876529/-ext-10002</string> 
-                          </void> 
-                          <void property="gatherStats"> 
-                           <boolean>true</boolean> 
-                          </void> 
-                          <void property="numFiles"> 
-                           <int>1</int> 
-                          </void> 
-                          <void property="statsAggPrefix"> 
-                           <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-53-49_576_2888243981035876529/-ext-10000/</string> 
-                          </void> 
-                          <void property="tableInfo"> 
-                           <object idref="TableDesc0"/> 
-                          </void> 
-                          <void property="totalFiles"> 
-                           <int>1</int> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="counterNames"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_111_NUM_INPUT_ROWS</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_111_NUM_OUTPUT_ROWS</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_111_TIME_TAKEN</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_111_FATAL_ERROR</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="operatorId"> 
-                         <string>FS_111</string> 
-                        </void> 
-                        <void property="parentOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object idref="SelectOperator0"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="schema"> 
-                         <object idref="RowSchema0"/> 
-                        </void> 
-                       </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                    <void property="conf"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                      <void property="destTableId"> 
+                       <int>1</int> 
                       </void> 
-                     </object> 
-                    </void> 
-                    <void property="columnExprMap"> 
-                     <object class="java.util.HashMap"> 
-                      <void method="put"> 
-                       <string>_col1</string> 
-                       <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>value</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
+                      <void property="dirName"> 
+                       <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-04-53_288_7531718006958804873/-ext-10002</string> 
                       </void> 
-                      <void method="put"> 
-                       <string>_col0</string> 
-                       <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
+                      <void property="gatherStats"> 
+                       <boolean>true</boolean> 
                       </void> 
-                     </object> 
-                    </void> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                      <void property="colList"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc1"/> 
-                        </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc0"/> 
-                        </void> 
-                       </object> 
+                      <void property="numFiles"> 
+                       <int>1</int> 
                       </void> 
-                      <void property="outputColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void method="add"> 
-                         <string>_col1</string> 
-                        </void> 
-                       </object> 
+                      <void property="statsAggPrefix"> 
+                       <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-04-53_288_7531718006958804873/-ext-10000/</string> 
+                      </void> 
+                      <void property="tableInfo"> 
+                       <object idref="TableDesc0"/> 
+                      </void> 
+                      <void property="totalFiles"> 
+                       <int>1</int> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_110_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_FS_109_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_110_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_FS_109_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_110_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_FS_109_TIME_TAKEN</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_110_FATAL_ERROR</string> 
+                       <string>CNTR_NAME_FS_109_FATAL_ERROR</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>SEL_110</string> 
+                     <string>FS_109</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object idref="FilterOperator1"/> 
+                       <object idref="SelectOperator0"/> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="schema"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                      <void property="signature"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col0</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string>src</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col1</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string>src</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                     <object idref="RowSchema0"/> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-                  <void property="predicate"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="childExprs"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>int</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="value"> 
-                         <int>100</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                <void property="columnExprMap"> 
+                 <object class="java.util.HashMap"> 
+                  <void method="put"> 
+                   <string>_col1</string> 
+                   <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>value</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string>src</string> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="put"> 
+                   <string>_col0</string> 
+                   <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>key</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
+                    <void property="tabAlias"> 
+                     <string>src</string> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                      <void property="typeName"> 
-                       <string>boolean</string> 
-                      </void> 
-                     </object> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="conf"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                  <void property="colList"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object idref="ExprNodeColumnDesc1"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="ExprNodeColumnDesc0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void property="outputColumnNames"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <string>_col0</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col1</string> 
                     </void> 
                    </object> 
                   </void> 
@@ -853,21 +736,21 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_109_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_108_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_109_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_108_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_109_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_SEL_108_TIME_TAKEN</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_109_FATAL_ERROR</string> 
+                   <string>CNTR_NAME_SEL_108_FATAL_ERROR</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>FIL_109</string> 
+                 <string>SEL_108</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -881,9 +764,9 @@
                   <void property="signature"> 
                    <object class="java.util.ArrayList"> 
                     <void method="add"> 
-                     <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                       <void property="internalName"> 
-                       <string>key</string> 
+                       <string>_col0</string> 
                       </void> 
                       <void property="tabAlias"> 
                        <string>src</string> 
@@ -894,9 +777,9 @@
                      </object> 
                     </void> 
                     <void method="add"> 
-                     <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                       <void property="internalName"> 
-                       <string>value</string> 
+                       <string>_col1</string> 
                       </void> 
                       <void property="tabAlias"> 
                        <string>src</string> 
@@ -936,7 +819,11 @@
                   <void method="add"> 
                    <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
+                     <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                      <void property="typeName"> 
+                       <string>int</string> 
+                      </void> 
+                     </object> 
                     </void> 
                     <void property="value"> 
                      <int>100</int> 
@@ -949,7 +836,11 @@
                  <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
                 </void> 
                 <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo2"/> 
+                 <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                  <void property="typeName"> 
+                   <string>boolean</string> 
+                  </void> 
+                 </object> 
                 </void> 
                </object> 
               </void> 
@@ -958,21 +849,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_112_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_110_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_112_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_110_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_112_TIME_TAKEN</string> 
+               <string>CNTR_NAME_FIL_110_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_112_FATAL_ERROR</string> 
+               <string>CNTR_NAME_FIL_110_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>FIL_112</string> 
+             <string>FIL_110</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -986,10 +877,30 @@
               <void property="signature"> 
                <object id="ArrayList1" class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <object idref="ColumnInfo0"/> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>key</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>src</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
                 </void> 
                 <void method="add"> 
-                 <object idref="ColumnInfo1"/> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>value</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>src</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
                 </void> 
                 <void method="add"> 
                  <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
@@ -1048,16 +959,16 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_108_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_106_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_108_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_106_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_108_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_106_TIME_TAKEN</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_108_FATAL_ERROR</string> 
+           <string>CNTR_NAME_TS_106_FATAL_ERROR</string> 
           </void> 
          </object> 
         </void> 
@@ -1072,7 +983,7 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_108</string> 
+         <string>TS_106</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -1094,7 +1005,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src</string> 
+       <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>src</string> 
@@ -1106,7 +1017,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src</string> 
+       <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src</string> 
        <object class="org.apache.hadoop.hive.ql.plan.PartitionDesc"> 
         <void property="baseFileName"> 
          <string>src</string> 
@@ -1163,11 +1074,11 @@
           </void> 
           <void method="put"> 
            <string>location</string> 
-           <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src</string> 
+           <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src</string> 
           </void> 
           <void method="put"> 
            <string>transient_lastDdlTime</string> 
-           <string>1304060027</string> 
+           <string>1310382292</string> 
           </void> 
          </object> 
         </void> 
@@ -1225,11 +1136,11 @@
             </void> 
             <void method="put"> 
              <string>location</string> 
-             <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src</string> 
+             <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src</string> 
             </void> 
             <void method="put"> 
              <string>transient_lastDdlTime</string> 
-             <string>1304060027</string> 
+             <string>1310382292</string> 
             </void> 
            </object> 
           </void> 
diff --git a/ql/src/test/results/compiler/plan/input2.q.xml b/ql/src/test/results/compiler/plan/input2.q.xml
index ea810263f1..db9abef9ae 100755
--- a/ql/src/test/results/compiler/plan/input2.q.xml
+++ b/ql/src/test/results/compiler/plan/input2.q.xml
@@ -159,21 +159,21 @@
                             <void property="counterNames"> 
                              <object class="java.util.ArrayList"> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_133_NUM_INPUT_ROWS</string> 
+                               <string>CNTR_NAME_FS_130_NUM_INPUT_ROWS</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_133_NUM_OUTPUT_ROWS</string> 
+                               <string>CNTR_NAME_FS_130_NUM_OUTPUT_ROWS</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_133_TIME_TAKEN</string> 
+                               <string>CNTR_NAME_FS_130_TIME_TAKEN</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_133_FATAL_ERROR</string> 
+                               <string>CNTR_NAME_FS_130_FATAL_ERROR</string> 
                               </void> 
                              </object> 
                             </void> 
                             <void property="operatorId"> 
-                             <string>FS_133</string> 
+                             <string>FS_130</string> 
                             </void> 
                             <void property="parentOperators"> 
                              <object class="java.util.ArrayList"> 
@@ -227,21 +227,21 @@
                         <void property="counterNames"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_132_NUM_INPUT_ROWS</string> 
+                           <string>CNTR_NAME_TS_129_NUM_INPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_132_NUM_OUTPUT_ROWS</string> 
+                           <string>CNTR_NAME_TS_129_NUM_OUTPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_132_TIME_TAKEN</string> 
+                           <string>CNTR_NAME_TS_129_TIME_TAKEN</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_132_FATAL_ERROR</string> 
+                           <string>CNTR_NAME_TS_129_FATAL_ERROR</string> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="operatorId"> 
-                         <string>TS_132</string> 
+                         <string>TS_129</string> 
                         </void> 
                         <void property="schema"> 
                          <object idref="RowSchema0"/> 
@@ -617,21 +617,21 @@
                             <void property="counterNames"> 
                              <object class="java.util.ArrayList"> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_135_NUM_INPUT_ROWS</string> 
+                               <string>CNTR_NAME_FS_132_NUM_INPUT_ROWS</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_135_NUM_OUTPUT_ROWS</string> 
+                               <string>CNTR_NAME_FS_132_NUM_OUTPUT_ROWS</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_135_TIME_TAKEN</string> 
+                               <string>CNTR_NAME_FS_132_TIME_TAKEN</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_135_FATAL_ERROR</string> 
+                               <string>CNTR_NAME_FS_132_FATAL_ERROR</string> 
                               </void> 
                              </object> 
                             </void> 
                             <void property="operatorId"> 
-                             <string>FS_135</string> 
+                             <string>FS_132</string> 
                             </void> 
                             <void property="parentOperators"> 
                              <object class="java.util.ArrayList"> 
@@ -681,21 +681,21 @@
                         <void property="counterNames"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_134_NUM_INPUT_ROWS</string> 
+                           <string>CNTR_NAME_TS_131_NUM_INPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_134_NUM_OUTPUT_ROWS</string> 
+                           <string>CNTR_NAME_TS_131_NUM_OUTPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_134_TIME_TAKEN</string> 
+                           <string>CNTR_NAME_TS_131_TIME_TAKEN</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_134_FATAL_ERROR</string> 
+                           <string>CNTR_NAME_TS_131_FATAL_ERROR</string> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="operatorId"> 
-                         <string>TS_134</string> 
+                         <string>TS_131</string> 
                         </void> 
                         <void property="schema"> 
                          <object idref="RowSchema1"/> 
@@ -1075,21 +1075,21 @@
                             <void property="counterNames"> 
                              <object class="java.util.ArrayList"> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_137_NUM_INPUT_ROWS</string> 
+                               <string>CNTR_NAME_FS_134_NUM_INPUT_ROWS</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_137_NUM_OUTPUT_ROWS</string> 
+                               <string>CNTR_NAME_FS_134_NUM_OUTPUT_ROWS</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_137_TIME_TAKEN</string> 
+                               <string>CNTR_NAME_FS_134_TIME_TAKEN</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_137_FATAL_ERROR</string> 
+                               <string>CNTR_NAME_FS_134_FATAL_ERROR</string> 
                               </void> 
                              </object> 
                             </void> 
                             <void property="operatorId"> 
-                             <string>FS_137</string> 
+                             <string>FS_134</string> 
                             </void> 
                             <void property="parentOperators"> 
                              <object class="java.util.ArrayList"> 
@@ -1139,21 +1139,21 @@
                         <void property="counterNames"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_136_NUM_INPUT_ROWS</string> 
+                           <string>CNTR_NAME_TS_133_NUM_INPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_136_NUM_OUTPUT_ROWS</string> 
+                           <string>CNTR_NAME_TS_133_NUM_OUTPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_136_TIME_TAKEN</string> 
+                           <string>CNTR_NAME_TS_133_TIME_TAKEN</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_136_FATAL_ERROR</string> 
+                           <string>CNTR_NAME_TS_133_FATAL_ERROR</string> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="operatorId"> 
-                         <string>TS_136</string> 
+                         <string>TS_133</string> 
                         </void> 
                         <void property="schema"> 
                          <object idref="RowSchema2"/> 
@@ -1568,21 +1568,21 @@
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_FS_125_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_FS_122_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_FS_125_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_FS_122_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_FS_125_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_FS_122_TIME_TAKEN</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_FS_125_FATAL_ERROR</string> 
+                       <string>CNTR_NAME_FS_122_FATAL_ERROR</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>FS_125</string> 
+                     <string>FS_122</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
@@ -1660,21 +1660,21 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_SEL_124_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_121_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_SEL_124_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_121_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_SEL_124_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_SEL_121_TIME_TAKEN</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_SEL_124_FATAL_ERROR</string> 
+                   <string>CNTR_NAME_SEL_121_FATAL_ERROR</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>SEL_124</string> 
+                 <string>SEL_121</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -1773,21 +1773,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_123_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_120_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_123_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_120_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_123_TIME_TAKEN</string> 
+               <string>CNTR_NAME_FIL_120_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_123_FATAL_ERROR</string> 
+               <string>CNTR_NAME_FIL_120_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>FIL_123</string> 
+             <string>FIL_120</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -1870,21 +1870,21 @@
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_FS_128_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_FS_125_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_FS_128_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_FS_125_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_FS_128_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_FS_125_TIME_TAKEN</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_FS_128_FATAL_ERROR</string> 
+                       <string>CNTR_NAME_FS_125_FATAL_ERROR</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>FS_128</string> 
+                     <string>FS_125</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
@@ -1959,21 +1959,21 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_SEL_127_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_124_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_SEL_127_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_124_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_SEL_127_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_SEL_124_TIME_TAKEN</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_SEL_127_FATAL_ERROR</string> 
+                   <string>CNTR_NAME_SEL_124_FATAL_ERROR</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>SEL_127</string> 
+                 <string>SEL_124</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -2115,21 +2115,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_126_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_123_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_126_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_123_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_126_TIME_TAKEN</string> 
+               <string>CNTR_NAME_FIL_123_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_126_FATAL_ERROR</string> 
+               <string>CNTR_NAME_FIL_123_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>FIL_126</string> 
+             <string>FIL_123</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -2195,21 +2195,21 @@
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_FS_131_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_FS_128_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_FS_131_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_FS_128_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_FS_131_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_FS_128_TIME_TAKEN</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_FS_131_FATAL_ERROR</string> 
+                       <string>CNTR_NAME_FS_128_FATAL_ERROR</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>FS_131</string> 
+                     <string>FS_128</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
@@ -2281,21 +2281,21 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_SEL_130_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_127_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_SEL_130_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_127_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_SEL_130_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_SEL_127_TIME_TAKEN</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_SEL_130_FATAL_ERROR</string> 
+                   <string>CNTR_NAME_SEL_127_FATAL_ERROR</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>SEL_130</string> 
+                 <string>SEL_127</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -2383,21 +2383,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_129_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_126_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_129_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_126_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_129_TIME_TAKEN</string> 
+               <string>CNTR_NAME_FIL_126_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_129_FATAL_ERROR</string> 
+               <string>CNTR_NAME_FIL_126_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>FIL_129</string> 
+             <string>FIL_126</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -2434,16 +2434,16 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_122_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_119_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_122_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_119_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_122_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_119_TIME_TAKEN</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_122_FATAL_ERROR</string> 
+           <string>CNTR_NAME_TS_119_FATAL_ERROR</string> 
           </void> 
          </object> 
         </void> 
@@ -2458,7 +2458,7 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_122</string> 
+         <string>TS_119</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
diff --git a/ql/src/test/results/compiler/plan/input20.q.xml b/ql/src/test/results/compiler/plan/input20.q.xml
index 99501d4d57..f07b9b64a8 100644
--- a/ql/src/test/results/compiler/plan/input20.q.xml
+++ b/ql/src/test/results/compiler/plan/input20.q.xml
@@ -319,21 +319,21 @@
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_157_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_RS_154_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_157_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_RS_154_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_157_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_RS_154_TIME_TAKEN</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_157_FATAL_ERROR</string> 
+                       <string>CNTR_NAME_RS_154_FATAL_ERROR</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>RS_157</string> 
+                     <string>RS_154</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
@@ -498,21 +498,21 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_SCR_156_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_SCR_153_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_SCR_156_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_SCR_153_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_SCR_156_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_SCR_153_TIME_TAKEN</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_SCR_156_FATAL_ERROR</string> 
+                   <string>CNTR_NAME_SCR_153_FATAL_ERROR</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>SCR_156</string> 
+                 <string>SCR_153</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -667,21 +667,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_155_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_SEL_152_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_155_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_SEL_152_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_155_TIME_TAKEN</string> 
+               <string>CNTR_NAME_SEL_152_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_155_FATAL_ERROR</string> 
+               <string>CNTR_NAME_SEL_152_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>SEL_155</string> 
+             <string>SEL_152</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -735,16 +735,16 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_154_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_151_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_154_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_151_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_154_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_151_TIME_TAKEN</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_154_FATAL_ERROR</string> 
+           <string>CNTR_NAME_TS_151_FATAL_ERROR</string> 
           </void> 
          </object> 
         </void> 
@@ -756,7 +756,7 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_154</string> 
+         <string>TS_151</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -1054,21 +1054,21 @@
                   <void property="counterNames"> 
                    <object class="java.util.ArrayList"> 
                     <void method="add"> 
-                     <string>CNTR_NAME_FS_161_NUM_INPUT_ROWS</string> 
+                     <string>CNTR_NAME_FS_158_NUM_INPUT_ROWS</string> 
                     </void> 
                     <void method="add"> 
-                     <string>CNTR_NAME_FS_161_NUM_OUTPUT_ROWS</string> 
+                     <string>CNTR_NAME_FS_158_NUM_OUTPUT_ROWS</string> 
                     </void> 
                     <void method="add"> 
-                     <string>CNTR_NAME_FS_161_TIME_TAKEN</string> 
+                     <string>CNTR_NAME_FS_158_TIME_TAKEN</string> 
                     </void> 
                     <void method="add"> 
-                     <string>CNTR_NAME_FS_161_FATAL_ERROR</string> 
+                     <string>CNTR_NAME_FS_158_FATAL_ERROR</string> 
                     </void> 
                    </object> 
                   </void> 
                   <void property="operatorId"> 
-                   <string>FS_161</string> 
+                   <string>FS_158</string> 
                   </void> 
                   <void property="parentOperators"> 
                    <object class="java.util.ArrayList"> 
@@ -1229,21 +1229,21 @@
               <void property="counterNames"> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>CNTR_NAME_SCR_160_NUM_INPUT_ROWS</string> 
+                 <string>CNTR_NAME_SCR_157_NUM_INPUT_ROWS</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_SCR_160_NUM_OUTPUT_ROWS</string> 
+                 <string>CNTR_NAME_SCR_157_NUM_OUTPUT_ROWS</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_SCR_160_TIME_TAKEN</string> 
+                 <string>CNTR_NAME_SCR_157_TIME_TAKEN</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_SCR_160_FATAL_ERROR</string> 
+                 <string>CNTR_NAME_SCR_157_FATAL_ERROR</string> 
                 </void> 
                </object> 
               </void> 
               <void property="operatorId"> 
-               <string>SCR_160</string> 
+               <string>SCR_157</string> 
               </void> 
               <void property="parentOperators"> 
                <object class="java.util.ArrayList"> 
@@ -1349,21 +1349,21 @@
           <void property="counterNames"> 
            <object class="java.util.ArrayList"> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_159_NUM_INPUT_ROWS</string> 
+             <string>CNTR_NAME_SEL_156_NUM_INPUT_ROWS</string> 
             </void> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_159_NUM_OUTPUT_ROWS</string> 
+             <string>CNTR_NAME_SEL_156_NUM_OUTPUT_ROWS</string> 
             </void> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_159_TIME_TAKEN</string> 
+             <string>CNTR_NAME_SEL_156_TIME_TAKEN</string> 
             </void> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_159_FATAL_ERROR</string> 
+             <string>CNTR_NAME_SEL_156_FATAL_ERROR</string> 
             </void> 
            </object> 
           </void> 
           <void property="operatorId"> 
-           <string>SEL_159</string> 
+           <string>SEL_156</string> 
           </void> 
           <void property="parentOperators"> 
            <object class="java.util.ArrayList"> 
@@ -1424,21 +1424,21 @@
       <void property="counterNames"> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
-         <string>CNTR_NAME_OP_158_NUM_INPUT_ROWS</string> 
+         <string>CNTR_NAME_OP_155_NUM_INPUT_ROWS</string> 
         </void> 
         <void method="add"> 
-         <string>CNTR_NAME_OP_158_NUM_OUTPUT_ROWS</string> 
+         <string>CNTR_NAME_OP_155_NUM_OUTPUT_ROWS</string> 
         </void> 
         <void method="add"> 
-         <string>CNTR_NAME_OP_158_TIME_TAKEN</string> 
+         <string>CNTR_NAME_OP_155_TIME_TAKEN</string> 
         </void> 
         <void method="add"> 
-         <string>CNTR_NAME_OP_158_FATAL_ERROR</string> 
+         <string>CNTR_NAME_OP_155_FATAL_ERROR</string> 
         </void> 
        </object> 
       </void> 
       <void property="operatorId"> 
-       <string>OP_158</string> 
+       <string>OP_155</string> 
       </void> 
       <void property="parentOperators"> 
        <object class="java.util.ArrayList"> 
diff --git a/ql/src/test/results/compiler/plan/input3.q.xml b/ql/src/test/results/compiler/plan/input3.q.xml
index 2820ad3eb7..001fad0ae0 100755
--- a/ql/src/test/results/compiler/plan/input3.q.xml
+++ b/ql/src/test/results/compiler/plan/input3.q.xml
@@ -159,21 +159,21 @@
                             <void property="counterNames"> 
                              <object class="java.util.ArrayList"> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_184_NUM_INPUT_ROWS</string> 
+                               <string>CNTR_NAME_FS_181_NUM_INPUT_ROWS</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_184_NUM_OUTPUT_ROWS</string> 
+                               <string>CNTR_NAME_FS_181_NUM_OUTPUT_ROWS</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_184_TIME_TAKEN</string> 
+                               <string>CNTR_NAME_FS_181_TIME_TAKEN</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_184_FATAL_ERROR</string> 
+                               <string>CNTR_NAME_FS_181_FATAL_ERROR</string> 
                               </void> 
                              </object> 
                             </void> 
                             <void property="operatorId"> 
-                             <string>FS_184</string> 
+                             <string>FS_181</string> 
                             </void> 
                             <void property="parentOperators"> 
                              <object class="java.util.ArrayList"> 
@@ -227,21 +227,21 @@
                         <void property="counterNames"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_183_NUM_INPUT_ROWS</string> 
+                           <string>CNTR_NAME_TS_180_NUM_INPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_183_NUM_OUTPUT_ROWS</string> 
+                           <string>CNTR_NAME_TS_180_NUM_OUTPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_183_TIME_TAKEN</string> 
+                           <string>CNTR_NAME_TS_180_TIME_TAKEN</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_183_FATAL_ERROR</string> 
+                           <string>CNTR_NAME_TS_180_FATAL_ERROR</string> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="operatorId"> 
-                         <string>TS_183</string> 
+                         <string>TS_180</string> 
                         </void> 
                         <void property="schema"> 
                          <object idref="RowSchema0"/> 
@@ -617,21 +617,21 @@
                             <void property="counterNames"> 
                              <object class="java.util.ArrayList"> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_186_NUM_INPUT_ROWS</string> 
+                               <string>CNTR_NAME_FS_183_NUM_INPUT_ROWS</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_186_NUM_OUTPUT_ROWS</string> 
+                               <string>CNTR_NAME_FS_183_NUM_OUTPUT_ROWS</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_186_TIME_TAKEN</string> 
+                               <string>CNTR_NAME_FS_183_TIME_TAKEN</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_186_FATAL_ERROR</string> 
+                               <string>CNTR_NAME_FS_183_FATAL_ERROR</string> 
                               </void> 
                              </object> 
                             </void> 
                             <void property="operatorId"> 
-                             <string>FS_186</string> 
+                             <string>FS_183</string> 
                             </void> 
                             <void property="parentOperators"> 
                              <object class="java.util.ArrayList"> 
@@ -681,21 +681,21 @@
                         <void property="counterNames"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_185_NUM_INPUT_ROWS</string> 
+                           <string>CNTR_NAME_TS_182_NUM_INPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_185_NUM_OUTPUT_ROWS</string> 
+                           <string>CNTR_NAME_TS_182_NUM_OUTPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_185_TIME_TAKEN</string> 
+                           <string>CNTR_NAME_TS_182_TIME_TAKEN</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_185_FATAL_ERROR</string> 
+                           <string>CNTR_NAME_TS_182_FATAL_ERROR</string> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="operatorId"> 
-                         <string>TS_185</string> 
+                         <string>TS_182</string> 
                         </void> 
                         <void property="schema"> 
                          <object idref="RowSchema1"/> 
@@ -1075,21 +1075,21 @@
                             <void property="counterNames"> 
                              <object class="java.util.ArrayList"> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_188_NUM_INPUT_ROWS</string> 
+                               <string>CNTR_NAME_FS_185_NUM_INPUT_ROWS</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_188_NUM_OUTPUT_ROWS</string> 
+                               <string>CNTR_NAME_FS_185_NUM_OUTPUT_ROWS</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_188_TIME_TAKEN</string> 
+                               <string>CNTR_NAME_FS_185_TIME_TAKEN</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_188_FATAL_ERROR</string> 
+                               <string>CNTR_NAME_FS_185_FATAL_ERROR</string> 
                               </void> 
                              </object> 
                             </void> 
                             <void property="operatorId"> 
-                             <string>FS_188</string> 
+                             <string>FS_185</string> 
                             </void> 
                             <void property="parentOperators"> 
                              <object class="java.util.ArrayList"> 
@@ -1139,21 +1139,21 @@
                         <void property="counterNames"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_187_NUM_INPUT_ROWS</string> 
+                           <string>CNTR_NAME_TS_184_NUM_INPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_187_NUM_OUTPUT_ROWS</string> 
+                           <string>CNTR_NAME_TS_184_NUM_OUTPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_187_TIME_TAKEN</string> 
+                           <string>CNTR_NAME_TS_184_TIME_TAKEN</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_187_FATAL_ERROR</string> 
+                           <string>CNTR_NAME_TS_184_FATAL_ERROR</string> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="operatorId"> 
-                         <string>TS_187</string> 
+                         <string>TS_184</string> 
                         </void> 
                         <void property="schema"> 
                          <object idref="RowSchema2"/> 
@@ -1471,21 +1471,21 @@
                             <void property="counterNames"> 
                              <object class="java.util.ArrayList"> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_190_NUM_INPUT_ROWS</string> 
+                               <string>CNTR_NAME_FS_187_NUM_INPUT_ROWS</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_190_NUM_OUTPUT_ROWS</string> 
+                               <string>CNTR_NAME_FS_187_NUM_OUTPUT_ROWS</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_190_TIME_TAKEN</string> 
+                               <string>CNTR_NAME_FS_187_TIME_TAKEN</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_190_FATAL_ERROR</string> 
+                               <string>CNTR_NAME_FS_187_FATAL_ERROR</string> 
                               </void> 
                              </object> 
                             </void> 
                             <void property="operatorId"> 
-                             <string>FS_190</string> 
+                             <string>FS_187</string> 
                             </void> 
                             <void property="parentOperators"> 
                              <object class="java.util.ArrayList"> 
@@ -1522,21 +1522,21 @@
                         <void property="counterNames"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_189_NUM_INPUT_ROWS</string> 
+                           <string>CNTR_NAME_TS_186_NUM_INPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_189_NUM_OUTPUT_ROWS</string> 
+                           <string>CNTR_NAME_TS_186_NUM_OUTPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_189_TIME_TAKEN</string> 
+                           <string>CNTR_NAME_TS_186_TIME_TAKEN</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_189_FATAL_ERROR</string> 
+                           <string>CNTR_NAME_TS_186_FATAL_ERROR</string> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="operatorId"> 
-                         <string>TS_189</string> 
+                         <string>TS_186</string> 
                         </void> 
                         <void property="schema"> 
                          <object idref="RowSchema3"/> 
@@ -1904,21 +1904,21 @@
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_FS_173_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_FS_170_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_FS_173_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_FS_170_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_FS_173_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_FS_170_TIME_TAKEN</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_FS_173_FATAL_ERROR</string> 
+                       <string>CNTR_NAME_FS_170_FATAL_ERROR</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>FS_173</string> 
+                     <string>FS_170</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
@@ -1996,21 +1996,21 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_SEL_172_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_169_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_SEL_172_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_169_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_SEL_172_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_SEL_169_TIME_TAKEN</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_SEL_172_FATAL_ERROR</string> 
+                   <string>CNTR_NAME_SEL_169_FATAL_ERROR</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>SEL_172</string> 
+                 <string>SEL_169</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -2109,21 +2109,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_171_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_168_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_171_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_168_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_171_TIME_TAKEN</string> 
+               <string>CNTR_NAME_FIL_168_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_171_FATAL_ERROR</string> 
+               <string>CNTR_NAME_FIL_168_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>FIL_171</string> 
+             <string>FIL_168</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -2206,21 +2206,21 @@
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_FS_176_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_FS_173_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_FS_176_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_FS_173_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_FS_176_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_FS_173_TIME_TAKEN</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_FS_176_FATAL_ERROR</string> 
+                       <string>CNTR_NAME_FS_173_FATAL_ERROR</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>FS_176</string> 
+                     <string>FS_173</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
@@ -2295,21 +2295,21 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_SEL_175_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_172_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_SEL_175_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_172_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_SEL_175_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_SEL_172_TIME_TAKEN</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_SEL_175_FATAL_ERROR</string> 
+                   <string>CNTR_NAME_SEL_172_FATAL_ERROR</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>SEL_175</string> 
+                 <string>SEL_172</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -2451,21 +2451,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_174_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_171_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_174_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_171_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_174_TIME_TAKEN</string> 
+               <string>CNTR_NAME_FIL_171_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_174_FATAL_ERROR</string> 
+               <string>CNTR_NAME_FIL_171_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>FIL_174</string> 
+             <string>FIL_171</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -2531,21 +2531,21 @@
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_FS_179_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_FS_176_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_FS_179_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_FS_176_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_FS_179_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_FS_176_TIME_TAKEN</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_FS_179_FATAL_ERROR</string> 
+                       <string>CNTR_NAME_FS_176_FATAL_ERROR</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>FS_179</string> 
+                     <string>FS_176</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
@@ -2617,21 +2617,21 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_SEL_178_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_175_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_SEL_178_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_175_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_SEL_178_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_SEL_175_TIME_TAKEN</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_SEL_178_FATAL_ERROR</string> 
+                   <string>CNTR_NAME_SEL_175_FATAL_ERROR</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>SEL_178</string> 
+                 <string>SEL_175</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -2770,21 +2770,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_177_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_174_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_177_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_174_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_177_TIME_TAKEN</string> 
+               <string>CNTR_NAME_FIL_174_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_177_FATAL_ERROR</string> 
+               <string>CNTR_NAME_FIL_174_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>FIL_177</string> 
+             <string>FIL_174</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -2841,21 +2841,21 @@
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_FS_182_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_FS_179_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_FS_182_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_FS_179_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_FS_182_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_FS_179_TIME_TAKEN</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_FS_182_FATAL_ERROR</string> 
+                       <string>CNTR_NAME_FS_179_FATAL_ERROR</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>FS_182</string> 
+                     <string>FS_179</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
@@ -2910,21 +2910,21 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_SEL_181_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_178_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_SEL_181_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_178_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_SEL_181_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_SEL_178_TIME_TAKEN</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_SEL_181_FATAL_ERROR</string> 
+                   <string>CNTR_NAME_SEL_178_FATAL_ERROR</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>SEL_181</string> 
+                 <string>SEL_178</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -3005,21 +3005,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_180_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_177_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_180_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_177_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_180_TIME_TAKEN</string> 
+               <string>CNTR_NAME_FIL_177_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_180_FATAL_ERROR</string> 
+               <string>CNTR_NAME_FIL_177_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>FIL_180</string> 
+             <string>FIL_177</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -3059,16 +3059,16 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_170_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_167_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_170_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_167_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_170_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_167_TIME_TAKEN</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_170_FATAL_ERROR</string> 
+           <string>CNTR_NAME_TS_167_FATAL_ERROR</string> 
           </void> 
          </object> 
         </void> 
@@ -3083,7 +3083,7 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_170</string> 
+         <string>TS_167</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
diff --git a/ql/src/test/results/compiler/plan/input4.q.xml b/ql/src/test/results/compiler/plan/input4.q.xml
index 7b8c804e53..fd584eb316 100755
--- a/ql/src/test/results/compiler/plan/input4.q.xml
+++ b/ql/src/test/results/compiler/plan/input4.q.xml
@@ -1,5 +1,5 @@
 <?xml version="1.0" encoding="UTF-8"?> 
-<java version="1.6.0_07" class="java.beans.XMLDecoder"> 
+<java version="1.6.0_01" class="java.beans.XMLDecoder"> 
  <object id="MapRedTask0" class="org.apache.hadoop.hive.ql.exec.MapRedTask"> 
   <void property="childTasks"> 
    <object class="java.util.ArrayList"> 
@@ -22,7 +22,7 @@
           <void property="work"> 
            <object class="org.apache.hadoop.hive.ql.plan.StatsWork"> 
             <void property="aggKey"> 
-             <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-54-25_717_5787624435007958970/-ext-10000/</string> 
+             <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-05-08_392_4021619949206592501/-ext-10000/</string> 
             </void> 
            </object> 
           </void> 
@@ -58,7 +58,7 @@
            <boolean>true</boolean> 
           </void> 
           <void property="sourceDir"> 
-           <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-54-25_717_5787624435007958970/-ext-10000</string> 
+           <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-05-08_392_4021619949206592501/-ext-10000</string> 
           </void> 
           <void property="table"> 
            <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
@@ -111,11 +111,11 @@
               </void> 
               <void method="put"> 
                <string>location</string> 
-               <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/dest1</string> 
+               <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/dest1</string> 
               </void> 
               <void method="put"> 
                <string>transient_lastDdlTime</string> 
-               <string>1304060065</string> 
+               <string>1310382308</string> 
               </void> 
              </object> 
             </void> 
@@ -125,7 +125,7 @@
            </object> 
           </void> 
           <void property="tmpDir"> 
-           <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-54-25_717_5787624435007958970/-ext-10001</string> 
+           <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-05-08_392_4021619949206592501/-ext-10001</string> 
           </void> 
          </object> 
         </void> 
@@ -196,11 +196,11 @@
          </void> 
          <void method="put"> 
           <string>location</string> 
-          <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src</string> 
+          <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src</string> 
          </void> 
          <void method="put"> 
           <string>transient_lastDdlTime</string> 
-          <string>1304060063</string> 
+          <string>1310382307</string> 
          </void> 
         </object> 
        </void> 
@@ -258,11 +258,11 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src</string> 
+            <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src</string> 
            </void> 
            <void method="put"> 
             <string>transient_lastDdlTime</string> 
-            <string>1304060063</string> 
+            <string>1310382307</string> 
            </void> 
           </object> 
          </void> 
@@ -290,159 +290,273 @@
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object id="ReduceSinkOperator0" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
-                    <void property="columnExprMap"> 
-                     <object class="java.util.HashMap"> 
-                      <void method="put"> 
-                       <string>_col1</string> 
-                       <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>_col1</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>string</string> 
+                   <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+                    <void property="childOperators"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object id="ReduceSinkOperator0" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
+                        <void property="columnExprMap"> 
+                         <object class="java.util.HashMap"> 
+                          <void method="put"> 
+                           <string>_col1</string> 
+                           <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                            <void property="column"> 
+                             <string>_col1</string> 
+                            </void> 
+                            <void property="typeInfo"> 
+                             <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                              <void property="typeName"> 
+                               <string>string</string> 
+                              </void> 
+                             </object> 
+                            </void> 
+                           </object> 
+                          </void> 
+                          <void method="put"> 
+                           <string>_col0</string> 
+                           <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                            <void property="column"> 
+                             <string>_col0</string> 
+                            </void> 
+                            <void property="typeInfo"> 
+                             <object idref="PrimitiveTypeInfo0"/> 
+                            </void> 
+                           </object> 
                           </void> 
                          </object> 
                         </void> 
-                       </object> 
-                      </void> 
-                      <void method="put"> 
-                       <string>_col0</string> 
-                       <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
-                      <void property="distinctColumnIndices"> 
-                       <object class="java.util.ArrayList"/> 
-                      </void> 
-                      <void property="keyCols"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                          <void property="column"> 
-                           <string>_col0</string> 
+                        <void property="conf"> 
+                         <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
+                          <void property="distinctColumnIndices"> 
+                           <object class="java.util.ArrayList"/> 
+                          </void> 
+                          <void property="keyCols"> 
+                           <object class="java.util.ArrayList"> 
+                            <void method="add"> 
+                             <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                              <void property="column"> 
+                               <string>_col0</string> 
+                              </void> 
+                              <void property="typeInfo"> 
+                               <object idref="PrimitiveTypeInfo0"/> 
+                              </void> 
+                             </object> 
+                            </void> 
+                           </object> 
+                          </void> 
+                          <void property="keySerializeInfo"> 
+                           <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                            <void property="deserializerClass"> 
+                             <class>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</class> 
+                            </void> 
+                            <void property="inputFileFormatClass"> 
+                             <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                            </void> 
+                            <void property="outputFileFormatClass"> 
+                             <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                            </void> 
+                            <void property="properties"> 
+                             <object class="java.util.Properties"> 
+                              <void method="put"> 
+                               <string>columns</string> 
+                               <string>reducesinkkey0</string> 
+                              </void> 
+                              <void method="put"> 
+                               <string>serialization.sort.order</string> 
+                               <string>+</string> 
+                              </void> 
+                              <void method="put"> 
+                               <string>columns.types</string> 
+                               <string>string</string> 
+                              </void> 
+                             </object> 
+                            </void> 
+                           </object> 
+                          </void> 
+                          <void property="numDistributionKeys"> 
+                           <int>1</int> 
+                          </void> 
+                          <void property="numReducers"> 
+                           <int>-1</int> 
                           </void> 
-                          <void property="typeInfo"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
+                          <void property="outputKeyColumnNames"> 
+                           <object class="java.util.ArrayList"> 
+                            <void method="add"> 
+                             <string>reducesinkkey0</string> 
+                            </void> 
+                           </object> 
+                          </void> 
+                          <void property="outputValueColumnNames"> 
+                           <object class="java.util.ArrayList"> 
+                            <void method="add"> 
+                             <string>_col0</string> 
+                            </void> 
+                            <void method="add"> 
+                             <string>_col1</string> 
+                            </void> 
+                           </object> 
+                          </void> 
+                          <void property="partitionCols"> 
+                           <object class="java.util.ArrayList"> 
+                            <void method="add"> 
+                             <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                              <void property="column"> 
+                               <string>_col0</string> 
+                              </void> 
+                              <void property="typeInfo"> 
+                               <object idref="PrimitiveTypeInfo0"/> 
+                              </void> 
+                             </object> 
+                            </void> 
+                           </object> 
+                          </void> 
+                          <void property="tag"> 
+                           <int>-1</int> 
+                          </void> 
+                          <void property="valueCols"> 
+                           <object class="java.util.ArrayList"> 
+                            <void method="add"> 
+                             <object idref="ExprNodeColumnDesc1"/> 
+                            </void> 
+                            <void method="add"> 
+                             <object idref="ExprNodeColumnDesc0"/> 
+                            </void> 
+                           </object> 
+                          </void> 
+                          <void property="valueSerializeInfo"> 
+                           <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                            <void property="deserializerClass"> 
+                             <class>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</class> 
+                            </void> 
+                            <void property="inputFileFormatClass"> 
+                             <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                            </void> 
+                            <void property="outputFileFormatClass"> 
+                             <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                            </void> 
+                            <void property="properties"> 
+                             <object class="java.util.Properties"> 
+                              <void method="put"> 
+                               <string>columns</string> 
+                               <string>_col0,_col1</string> 
+                              </void> 
+                              <void method="put"> 
+                               <string>columns.types</string> 
+                               <string>string,string</string> 
+                              </void> 
+                              <void method="put"> 
+                               <string>escape.delim</string> 
+                               <string>\</string> 
+                              </void> 
+                             </object> 
+                            </void> 
+                           </object> 
                           </void> 
                          </object> 
                         </void> 
-                       </object> 
-                      </void> 
-                      <void property="keySerializeInfo"> 
-                       <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                        <void property="deserializerClass"> 
-                         <class>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</class> 
-                        </void> 
-                        <void property="inputFileFormatClass"> 
-                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                        </void> 
-                        <void property="outputFileFormatClass"> 
-                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                        </void> 
-                        <void property="properties"> 
-                         <object class="java.util.Properties"> 
-                          <void method="put"> 
-                           <string>columns</string> 
-                           <string>reducesinkkey0</string> 
+                        <void property="counterNames"> 
+                         <object class="java.util.ArrayList"> 
+                          <void method="add"> 
+                           <string>CNTR_NAME_RS_212_NUM_INPUT_ROWS</string> 
                           </void> 
-                          <void method="put"> 
-                           <string>serialization.sort.order</string> 
-                           <string>+</string> 
+                          <void method="add"> 
+                           <string>CNTR_NAME_RS_212_NUM_OUTPUT_ROWS</string> 
                           </void> 
-                          <void method="put"> 
-                           <string>columns.types</string> 
-                           <string>string</string> 
+                          <void method="add"> 
+                           <string>CNTR_NAME_RS_212_TIME_TAKEN</string> 
+                          </void> 
+                          <void method="add"> 
+                           <string>CNTR_NAME_RS_212_FATAL_ERROR</string> 
                           </void> 
                          </object> 
                         </void> 
-                       </object> 
-                      </void> 
-                      <void property="numDistributionKeys"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="numReducers"> 
-                       <int>-1</int> 
-                      </void> 
-                      <void property="outputKeyColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>reducesinkkey0</string> 
+                        <void property="operatorId"> 
+                         <string>RS_212</string> 
                         </void> 
-                       </object> 
-                      </void> 
-                      <void property="outputValueColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>_col0</string> 
+                        <void property="parentOperators"> 
+                         <object class="java.util.ArrayList"> 
+                          <void method="add"> 
+                           <object idref="FilterOperator0"/> 
+                          </void> 
+                         </object> 
                         </void> 
-                        <void method="add"> 
-                         <string>_col1</string> 
+                        <void property="schema"> 
+                         <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                          <void property="signature"> 
+                           <object id="ArrayList0" class="java.util.ArrayList"> 
+                            <void method="add"> 
+                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                              <void property="alias"> 
+                               <string>tkey</string> 
+                              </void> 
+                              <void property="internalName"> 
+                               <string>_col0</string> 
+                              </void> 
+                              <void property="type"> 
+                               <object idref="PrimitiveTypeInfo0"/> 
+                              </void> 
+                             </object> 
+                            </void> 
+                            <void method="add"> 
+                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                              <void property="alias"> 
+                               <string>tvalue</string> 
+                              </void> 
+                              <void property="internalName"> 
+                               <string>_col1</string> 
+                              </void> 
+                              <void property="type"> 
+                               <object idref="PrimitiveTypeInfo0"/> 
+                              </void> 
+                             </object> 
+                            </void> 
+                           </object> 
+                          </void> 
+                         </object> 
                         </void> 
                        </object> 
                       </void> 
-                      <void property="partitionCols"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                          <void property="column"> 
-                           <string>_col0</string> 
+                     </object> 
+                    </void> 
+                    <void property="conf"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
+                      <void property="predicate"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                        <void property="childExprs"> 
+                         <object class="java.util.ArrayList"> 
+                          <void method="add"> 
+                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                            <void property="column"> 
+                             <string>_col0</string> 
+                            </void> 
+                            <void property="typeInfo"> 
+                             <object idref="PrimitiveTypeInfo0"/> 
+                            </void> 
+                           </object> 
                           </void> 
-                          <void property="typeInfo"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
+                          <void method="add"> 
+                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                            <void property="typeInfo"> 
+                             <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                              <void property="typeName"> 
+                               <string>int</string> 
+                              </void> 
+                             </object> 
+                            </void> 
+                            <void property="value"> 
+                             <int>100</int> 
+                            </void> 
+                           </object> 
                           </void> 
                          </object> 
                         </void> 
-                       </object> 
-                      </void> 
-                      <void property="tag"> 
-                       <int>-1</int> 
-                      </void> 
-                      <void property="valueCols"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc1"/> 
-                        </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="valueSerializeInfo"> 
-                       <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                        <void property="deserializerClass"> 
-                         <class>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</class> 
+                        <void property="genericUDF"> 
+                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
                         </void> 
-                        <void property="inputFileFormatClass"> 
-                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                        </void> 
-                        <void property="outputFileFormatClass"> 
-                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                        </void> 
-                        <void property="properties"> 
-                         <object class="java.util.Properties"> 
-                          <void method="put"> 
-                           <string>columns</string> 
-                           <string>_col0,_col1</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns.types</string> 
-                           <string>string,string</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>escape.delim</string> 
-                           <string>\</string> 
+                        <void property="typeInfo"> 
+                         <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                          <void property="typeName"> 
+                           <string>boolean</string> 
                           </void> 
                          </object> 
                         </void> 
@@ -453,21 +567,21 @@
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_215_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_FIL_217_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_215_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_FIL_217_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_215_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_FIL_217_TIME_TAKEN</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_215_FATAL_ERROR</string> 
+                       <string>CNTR_NAME_FIL_217_FATAL_ERROR</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>RS_215</string> 
+                     <string>FIL_217</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
@@ -479,34 +593,7 @@
                     <void property="schema"> 
                      <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
                       <void property="signature"> 
-                       <object id="ArrayList0" class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="alias"> 
-                           <string>tkey</string> 
-                          </void> 
-                          <void property="internalName"> 
-                           <string>_col0</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="alias"> 
-                           <string>tvalue</string> 
-                          </void> 
-                          <void property="internalName"> 
-                           <string>_col1</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
+                       <object idref="ArrayList0"/> 
                       </void> 
                      </object> 
                     </void> 
@@ -628,21 +715,21 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_SCR_214_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_SCR_211_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_SCR_214_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_SCR_211_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_SCR_214_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_SCR_211_TIME_TAKEN</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_SCR_214_FATAL_ERROR</string> 
+                   <string>CNTR_NAME_SCR_211_FATAL_ERROR</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>SCR_214</string> 
+                 <string>SCR_211</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -721,21 +808,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_213_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_SEL_210_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_213_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_SEL_210_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_213_TIME_TAKEN</string> 
+               <string>CNTR_NAME_SEL_210_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_213_FATAL_ERROR</string> 
+               <string>CNTR_NAME_SEL_210_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>SEL_213</string> 
+             <string>SEL_210</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -789,16 +876,16 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_212_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_209_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_212_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_209_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_212_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_209_TIME_TAKEN</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_212_FATAL_ERROR</string> 
+           <string>CNTR_NAME_TS_209_FATAL_ERROR</string> 
           </void> 
          </object> 
         </void> 
@@ -813,7 +900,7 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_212</string> 
+         <string>TS_209</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -904,7 +991,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src</string> 
+       <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>tmap:src</string> 
@@ -916,7 +1003,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src</string> 
+       <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src</string> 
        <object class="org.apache.hadoop.hive.ql.plan.PartitionDesc"> 
         <void property="baseFileName"> 
          <string>src</string> 
@@ -973,11 +1060,11 @@
           </void> 
           <void method="put"> 
            <string>location</string> 
-           <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src</string> 
+           <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src</string> 
           </void> 
           <void method="put"> 
            <string>transient_lastDdlTime</string> 
-           <string>1304060063</string> 
+           <string>1310382307</string> 
           </void> 
          </object> 
         </void> 
@@ -1035,11 +1122,11 @@
             </void> 
             <void method="put"> 
              <string>location</string> 
-             <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src</string> 
+             <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src</string> 
             </void> 
             <void method="put"> 
              <string>transient_lastDdlTime</string> 
-             <string>1304060063</string> 
+             <string>1310382307</string> 
             </void> 
            </object> 
           </void> 
@@ -1057,183 +1144,59 @@
       <void property="childOperators"> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
-         <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+         <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
           <void property="childOperators"> 
            <object class="java.util.ArrayList"> 
             <void method="add"> 
-             <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-              <void property="childOperators"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                  <void property="conf"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                    <void property="destTableId"> 
-                     <int>1</int> 
-                    </void> 
-                    <void property="dirName"> 
-                     <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-54-25_717_5787624435007958970/-ext-10000</string> 
-                    </void> 
-                    <void property="gatherStats"> 
-                     <boolean>true</boolean> 
-                    </void> 
-                    <void property="numFiles"> 
-                     <int>1</int> 
-                    </void> 
-                    <void property="statsAggPrefix"> 
-                     <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-54-25_717_5787624435007958970/-ext-10000/</string> 
-                    </void> 
-                    <void property="tableInfo"> 
-                     <object idref="TableDesc0"/> 
-                    </void> 
-                    <void property="totalFiles"> 
-                     <int>1</int> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void property="counterNames"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <string>CNTR_NAME_FS_219_NUM_INPUT_ROWS</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>CNTR_NAME_FS_219_NUM_OUTPUT_ROWS</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>CNTR_NAME_FS_219_TIME_TAKEN</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>CNTR_NAME_FS_219_FATAL_ERROR</string> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void property="operatorId"> 
-                   <string>FS_219</string> 
-                  </void> 
-                  <void property="parentOperators"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="SelectOperator1"/> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void property="schema"> 
-                   <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                    <void property="signature"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                        <void property="internalName"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string></string> 
-                        </void> 
-                        <void property="type"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                        <void property="internalName"> 
-                         <string>value</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string></string> 
-                        </void> 
-                        <void property="type"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
+             <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                <void property="destTableId"> 
+                 <int>1</int> 
                 </void> 
-               </object> 
-              </void> 
-              <void property="columnExprMap"> 
-               <object class="java.util.HashMap"> 
-                <void method="put"> 
-                 <string>_col1</string> 
-                 <object id="ExprNodeColumnDesc4" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                  <void property="column"> 
-                   <string>_col1</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>tmap</string> 
-                  </void> 
-                  <void property="typeInfo"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                 </object> 
+                <void property="dirName"> 
+                 <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-05-08_392_4021619949206592501/-ext-10000</string> 
                 </void> 
-                <void method="put"> 
-                 <string>_col0</string> 
-                 <object id="ExprNodeColumnDesc5" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                  <void property="column"> 
-                   <string>_col0</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>tmap</string> 
-                  </void> 
-                  <void property="typeInfo"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                 </object> 
+                <void property="gatherStats"> 
+                 <boolean>true</boolean> 
                 </void> 
-               </object> 
-              </void> 
-              <void property="conf"> 
-               <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                <void property="colList"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object idref="ExprNodeColumnDesc5"/> 
-                  </void> 
-                  <void method="add"> 
-                   <object idref="ExprNodeColumnDesc4"/> 
-                  </void> 
-                 </object> 
+                <void property="numFiles"> 
+                 <int>1</int> 
                 </void> 
-                <void property="outputColumnNames"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <string>_col0</string> 
-                  </void> 
-                  <void method="add"> 
-                   <string>_col1</string> 
-                  </void> 
-                 </object> 
+                <void property="statsAggPrefix"> 
+                 <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-05-08_392_4021619949206592501/-ext-10000/</string> 
+                </void> 
+                <void property="tableInfo"> 
+                 <object idref="TableDesc0"/> 
+                </void> 
+                <void property="totalFiles"> 
+                 <int>1</int> 
                 </void> 
                </object> 
               </void> 
               <void property="counterNames"> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>CNTR_NAME_SEL_218_NUM_INPUT_ROWS</string> 
+                 <string>CNTR_NAME_FS_216_NUM_INPUT_ROWS</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_SEL_218_NUM_OUTPUT_ROWS</string> 
+                 <string>CNTR_NAME_FS_216_NUM_OUTPUT_ROWS</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_SEL_218_TIME_TAKEN</string> 
+                 <string>CNTR_NAME_FS_216_TIME_TAKEN</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_SEL_218_FATAL_ERROR</string> 
+                 <string>CNTR_NAME_FS_216_FATAL_ERROR</string> 
                 </void> 
                </object> 
               </void> 
               <void property="operatorId"> 
-               <string>SEL_218</string> 
+               <string>FS_216</string> 
               </void> 
               <void property="parentOperators"> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <object idref="FilterOperator0"/> 
+                 <object idref="SelectOperator1"/> 
                 </void> 
                </object> 
               </void> 
@@ -1244,10 +1207,10 @@
                   <void method="add"> 
                    <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                     <void property="internalName"> 
-                     <string>_col0</string> 
+                     <string>key</string> 
                     </void> 
                     <void property="tabAlias"> 
-                     <string>tmap</string> 
+                     <string></string> 
                     </void> 
                     <void property="type"> 
                      <object idref="PrimitiveTypeInfo0"/> 
@@ -1257,10 +1220,10 @@
                   <void method="add"> 
                    <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                     <void property="internalName"> 
-                     <string>_col1</string> 
+                     <string>value</string> 
                     </void> 
                     <void property="tabAlias"> 
-                     <string>tmap</string> 
+                     <string></string> 
                     </void> 
                     <void property="type"> 
                      <object idref="PrimitiveTypeInfo0"/> 
@@ -1275,50 +1238,57 @@
             </void> 
            </object> 
           </void> 
-          <void property="conf"> 
-           <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-            <void property="predicate"> 
-             <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-              <void property="childExprs"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                  <void property="column"> 
-                   <string>_col0</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>tmap</string> 
-                  </void> 
-                  <void property="typeInfo"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                  <void property="typeInfo"> 
-                   <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                    <void property="typeName"> 
-                     <string>int</string> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void property="value"> 
-                   <int>100</int> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
+          <void property="columnExprMap"> 
+           <object class="java.util.HashMap"> 
+            <void method="put"> 
+             <string>_col1</string> 
+             <object id="ExprNodeColumnDesc4" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+              <void property="column"> 
+               <string>_col1</string> 
               </void> 
-              <void property="genericUDF"> 
-               <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
+              <void property="tabAlias"> 
+               <string>tmap</string> 
               </void> 
               <void property="typeInfo"> 
-               <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                <void property="typeName"> 
-                 <string>boolean</string> 
-                </void> 
-               </object> 
+               <object idref="PrimitiveTypeInfo0"/> 
+              </void> 
+             </object> 
+            </void> 
+            <void method="put"> 
+             <string>_col0</string> 
+             <object id="ExprNodeColumnDesc5" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+              <void property="column"> 
+               <string>_col0</string> 
+              </void> 
+              <void property="tabAlias"> 
+               <string>tmap</string> 
+              </void> 
+              <void property="typeInfo"> 
+               <object idref="PrimitiveTypeInfo0"/> 
+              </void> 
+             </object> 
+            </void> 
+           </object> 
+          </void> 
+          <void property="conf"> 
+           <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+            <void property="colList"> 
+             <object class="java.util.ArrayList"> 
+              <void method="add"> 
+               <object idref="ExprNodeColumnDesc5"/> 
+              </void> 
+              <void method="add"> 
+               <object idref="ExprNodeColumnDesc4"/> 
+              </void> 
+             </object> 
+            </void> 
+            <void property="outputColumnNames"> 
+             <object class="java.util.ArrayList"> 
+              <void method="add"> 
+               <string>_col0</string> 
+              </void> 
+              <void method="add"> 
+               <string>_col1</string> 
               </void> 
              </object> 
             </void> 
@@ -1327,21 +1297,21 @@
           <void property="counterNames"> 
            <object class="java.util.ArrayList"> 
             <void method="add"> 
-             <string>CNTR_NAME_FIL_217_NUM_INPUT_ROWS</string> 
+             <string>CNTR_NAME_SEL_215_NUM_INPUT_ROWS</string> 
             </void> 
             <void method="add"> 
-             <string>CNTR_NAME_FIL_217_NUM_OUTPUT_ROWS</string> 
+             <string>CNTR_NAME_SEL_215_NUM_OUTPUT_ROWS</string> 
             </void> 
             <void method="add"> 
-             <string>CNTR_NAME_FIL_217_TIME_TAKEN</string> 
+             <string>CNTR_NAME_SEL_215_TIME_TAKEN</string> 
             </void> 
             <void method="add"> 
-             <string>CNTR_NAME_FIL_217_FATAL_ERROR</string> 
+             <string>CNTR_NAME_SEL_215_FATAL_ERROR</string> 
             </void> 
            </object> 
           </void> 
           <void property="operatorId"> 
-           <string>FIL_217</string> 
+           <string>SEL_215</string> 
           </void> 
           <void property="parentOperators"> 
            <object class="java.util.ArrayList"> 
@@ -1355,7 +1325,7 @@
             <void property="signature"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+               <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                 <void property="internalName"> 
                  <string>_col0</string> 
                 </void> 
@@ -1368,7 +1338,7 @@
                </object> 
               </void> 
               <void method="add"> 
-               <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+               <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                 <void property="internalName"> 
                  <string>_col1</string> 
                 </void> 
@@ -1408,21 +1378,21 @@
       <void property="counterNames"> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
-         <string>CNTR_NAME_OP_216_NUM_INPUT_ROWS</string> 
+         <string>CNTR_NAME_OP_213_NUM_INPUT_ROWS</string> 
         </void> 
         <void method="add"> 
-         <string>CNTR_NAME_OP_216_NUM_OUTPUT_ROWS</string> 
+         <string>CNTR_NAME_OP_213_NUM_OUTPUT_ROWS</string> 
         </void> 
         <void method="add"> 
-         <string>CNTR_NAME_OP_216_TIME_TAKEN</string> 
+         <string>CNTR_NAME_OP_213_TIME_TAKEN</string> 
         </void> 
         <void method="add"> 
-         <string>CNTR_NAME_OP_216_FATAL_ERROR</string> 
+         <string>CNTR_NAME_OP_213_FATAL_ERROR</string> 
         </void> 
        </object> 
       </void> 
       <void property="operatorId"> 
-       <string>OP_216</string> 
+       <string>OP_213</string> 
       </void> 
       <void property="parentOperators"> 
        <object class="java.util.ArrayList"> 
@@ -1436,10 +1406,30 @@
         <void property="signature"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <object idref="ColumnInfo0"/> 
+           <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+            <void property="internalName"> 
+             <string>_col0</string> 
+            </void> 
+            <void property="tabAlias"> 
+             <string>tmap</string> 
+            </void> 
+            <void property="type"> 
+             <object idref="PrimitiveTypeInfo0"/> 
+            </void> 
+           </object> 
           </void> 
           <void method="add"> 
-           <object idref="ColumnInfo1"/> 
+           <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+            <void property="internalName"> 
+             <string>_col1</string> 
+            </void> 
+            <void property="tabAlias"> 
+             <string>tmap</string> 
+            </void> 
+            <void property="type"> 
+             <object idref="PrimitiveTypeInfo0"/> 
+            </void> 
+           </object> 
           </void> 
          </object> 
         </void> 
diff --git a/ql/src/test/results/compiler/plan/input5.q.xml b/ql/src/test/results/compiler/plan/input5.q.xml
index 8fcf73f042..f9d6b94cf6 100644
--- a/ql/src/test/results/compiler/plan/input5.q.xml
+++ b/ql/src/test/results/compiler/plan/input5.q.xml
@@ -461,21 +461,21 @@
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_231_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_RS_229_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_231_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_RS_229_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_231_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_RS_229_TIME_TAKEN</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_231_FATAL_ERROR</string> 
+                       <string>CNTR_NAME_RS_229_FATAL_ERROR</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>RS_231</string> 
+                     <string>RS_229</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
@@ -636,21 +636,21 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_SCR_230_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_SCR_228_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_SCR_230_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_SCR_228_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_SCR_230_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_SCR_228_TIME_TAKEN</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_SCR_230_FATAL_ERROR</string> 
+                   <string>CNTR_NAME_SCR_228_FATAL_ERROR</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>SCR_230</string> 
+                 <string>SCR_228</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -768,21 +768,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_229_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_SEL_227_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_229_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_SEL_227_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_229_TIME_TAKEN</string> 
+               <string>CNTR_NAME_SEL_227_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_229_FATAL_ERROR</string> 
+               <string>CNTR_NAME_SEL_227_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>SEL_229</string> 
+             <string>SEL_227</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -836,16 +836,16 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_228_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_226_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_228_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_226_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_228_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_226_TIME_TAKEN</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_228_FATAL_ERROR</string> 
+           <string>CNTR_NAME_TS_226_FATAL_ERROR</string> 
           </void> 
          </object> 
         </void> 
@@ -860,7 +860,7 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_228</string> 
+         <string>TS_226</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -1208,21 +1208,21 @@
               <void property="counterNames"> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>CNTR_NAME_FS_234_NUM_INPUT_ROWS</string> 
+                 <string>CNTR_NAME_FS_232_NUM_INPUT_ROWS</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_FS_234_NUM_OUTPUT_ROWS</string> 
+                 <string>CNTR_NAME_FS_232_NUM_OUTPUT_ROWS</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_FS_234_TIME_TAKEN</string> 
+                 <string>CNTR_NAME_FS_232_TIME_TAKEN</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_FS_234_FATAL_ERROR</string> 
+                 <string>CNTR_NAME_FS_232_FATAL_ERROR</string> 
                 </void> 
                </object> 
               </void> 
               <void property="operatorId"> 
-               <string>FS_234</string> 
+               <string>FS_232</string> 
               </void> 
               <void property="parentOperators"> 
                <object class="java.util.ArrayList"> 
@@ -1328,21 +1328,21 @@
           <void property="counterNames"> 
            <object class="java.util.ArrayList"> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_233_NUM_INPUT_ROWS</string> 
+             <string>CNTR_NAME_SEL_231_NUM_INPUT_ROWS</string> 
             </void> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_233_NUM_OUTPUT_ROWS</string> 
+             <string>CNTR_NAME_SEL_231_NUM_OUTPUT_ROWS</string> 
             </void> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_233_TIME_TAKEN</string> 
+             <string>CNTR_NAME_SEL_231_TIME_TAKEN</string> 
             </void> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_233_FATAL_ERROR</string> 
+             <string>CNTR_NAME_SEL_231_FATAL_ERROR</string> 
             </void> 
            </object> 
           </void> 
           <void property="operatorId"> 
-           <string>SEL_233</string> 
+           <string>SEL_231</string> 
           </void> 
           <void property="parentOperators"> 
            <object class="java.util.ArrayList"> 
@@ -1409,21 +1409,21 @@
       <void property="counterNames"> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
-         <string>CNTR_NAME_OP_232_NUM_INPUT_ROWS</string> 
+         <string>CNTR_NAME_OP_230_NUM_INPUT_ROWS</string> 
         </void> 
         <void method="add"> 
-         <string>CNTR_NAME_OP_232_NUM_OUTPUT_ROWS</string> 
+         <string>CNTR_NAME_OP_230_NUM_OUTPUT_ROWS</string> 
         </void> 
         <void method="add"> 
-         <string>CNTR_NAME_OP_232_TIME_TAKEN</string> 
+         <string>CNTR_NAME_OP_230_TIME_TAKEN</string> 
         </void> 
         <void method="add"> 
-         <string>CNTR_NAME_OP_232_FATAL_ERROR</string> 
+         <string>CNTR_NAME_OP_230_FATAL_ERROR</string> 
         </void> 
        </object> 
       </void> 
       <void property="operatorId"> 
-       <string>OP_232</string> 
+       <string>OP_230</string> 
       </void> 
       <void property="parentOperators"> 
        <object class="java.util.ArrayList"> 
diff --git a/ql/src/test/results/compiler/plan/input6.q.xml b/ql/src/test/results/compiler/plan/input6.q.xml
index 6fc83fd6b6..e1344f3b65 100644
--- a/ql/src/test/results/compiler/plan/input6.q.xml
+++ b/ql/src/test/results/compiler/plan/input6.q.xml
@@ -1,5 +1,5 @@
 <?xml version="1.0" encoding="UTF-8"?> 
-<java version="1.6.0_07" class="java.beans.XMLDecoder"> 
+<java version="1.6.0_01" class="java.beans.XMLDecoder"> 
  <object id="MapRedTask0" class="org.apache.hadoop.hive.ql.exec.MapRedTask"> 
   <void property="childTasks"> 
    <object class="java.util.ArrayList"> 
@@ -33,7 +33,7 @@
                   <void property="work"> 
                    <object class="org.apache.hadoop.hive.ql.plan.StatsWork"> 
                     <void property="aggKey"> 
-                     <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-54-44_457_1118129043044323606/-ext-10000/</string> 
+                     <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-05-15_593_5091965176340900232/-ext-10000/</string> 
                     </void> 
                    </object> 
                   </void> 
@@ -73,7 +73,7 @@
                     <void property="aliasToWork"> 
                      <object class="java.util.LinkedHashMap"> 
                       <void method="put"> 
-                       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-54-44_457_1118129043044323606/-ext-10002</string> 
+                       <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-05-15_593_5091965176340900232/-ext-10002</string> 
                        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                         <void property="childOperators"> 
                          <object class="java.util.ArrayList"> 
@@ -82,7 +82,7 @@
                             <void property="conf"> 
                              <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
                               <void property="dirName"> 
-                               <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-54-44_457_1118129043044323606/-ext-10000</string> 
+                               <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-05-15_593_5091965176340900232/-ext-10000</string> 
                               </void> 
                               <void property="numFiles"> 
                                <int>1</int> 
@@ -134,7 +134,7 @@
                                   </void> 
                                   <void method="put"> 
                                    <string>location</string> 
-                                   <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/dest1</string> 
+                                   <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/dest1</string> 
                                   </void> 
                                   <void method="put"> 
                                    <string>file.outputformat</string> 
@@ -142,7 +142,7 @@
                                   </void> 
                                   <void method="put"> 
                                    <string>transient_lastDdlTime</string> 
-                                   <string>1304060084</string> 
+                                   <string>1310382315</string> 
                                   </void> 
                                  </object> 
                                 </void> 
@@ -159,21 +159,21 @@
                             <void property="counterNames"> 
                              <object class="java.util.ArrayList"> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_248_NUM_INPUT_ROWS</string> 
+                               <string>CNTR_NAME_FS_246_NUM_INPUT_ROWS</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_248_NUM_OUTPUT_ROWS</string> 
+                               <string>CNTR_NAME_FS_246_NUM_OUTPUT_ROWS</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_248_TIME_TAKEN</string> 
+                               <string>CNTR_NAME_FS_246_TIME_TAKEN</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_248_FATAL_ERROR</string> 
+                               <string>CNTR_NAME_FS_246_FATAL_ERROR</string> 
                               </void> 
                              </object> 
                             </void> 
                             <void property="operatorId"> 
-                             <string>FS_248</string> 
+                             <string>FS_246</string> 
                             </void> 
                             <void property="parentOperators"> 
                              <object class="java.util.ArrayList"> 
@@ -227,21 +227,21 @@
                         <void property="counterNames"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_247_NUM_INPUT_ROWS</string> 
+                           <string>CNTR_NAME_TS_245_NUM_INPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_247_NUM_OUTPUT_ROWS</string> 
+                           <string>CNTR_NAME_TS_245_NUM_OUTPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_247_TIME_TAKEN</string> 
+                           <string>CNTR_NAME_TS_245_TIME_TAKEN</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_247_FATAL_ERROR</string> 
+                           <string>CNTR_NAME_TS_245_FATAL_ERROR</string> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="operatorId"> 
-                         <string>TS_247</string> 
+                         <string>TS_245</string> 
                         </void> 
                         <void property="schema"> 
                          <object idref="RowSchema0"/> 
@@ -262,10 +262,10 @@
                     <void property="pathToAliases"> 
                      <object class="java.util.LinkedHashMap"> 
                       <void method="put"> 
-                       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-54-44_457_1118129043044323606/-ext-10002</string> 
+                       <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-05-15_593_5091965176340900232/-ext-10002</string> 
                        <object class="java.util.ArrayList"> 
                         <void method="add"> 
-                         <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-54-44_457_1118129043044323606/-ext-10002</string> 
+                         <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-05-15_593_5091965176340900232/-ext-10002</string> 
                         </void> 
                        </object> 
                       </void> 
@@ -274,7 +274,7 @@
                     <void property="pathToPartitionInfo"> 
                      <object class="java.util.LinkedHashMap"> 
                       <void method="put"> 
-                       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-54-44_457_1118129043044323606/-ext-10002</string> 
+                       <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-05-15_593_5091965176340900232/-ext-10002</string> 
                        <object class="org.apache.hadoop.hive.ql.plan.PartitionDesc"> 
                         <void property="baseFileName"> 
                          <string>-ext-10002</string> 
@@ -328,11 +328,11 @@
                           </void> 
                           <void method="put"> 
                            <string>location</string> 
-                           <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/dest1</string> 
+                           <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/dest1</string> 
                           </void> 
                           <void method="put"> 
                            <string>transient_lastDdlTime</string> 
-                           <string>1304060084</string> 
+                           <string>1310382315</string> 
                           </void> 
                          </object> 
                         </void> 
@@ -382,13 +382,13 @@
                    <boolean>true</boolean> 
                   </void> 
                   <void property="sourceDir"> 
-                   <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-54-44_457_1118129043044323606/-ext-10000</string> 
+                   <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-05-15_593_5091965176340900232/-ext-10000</string> 
                   </void> 
                   <void property="table"> 
                    <object idref="TableDesc0"/> 
                   </void> 
                   <void property="tmpDir"> 
-                   <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-54-44_457_1118129043044323606/-ext-10001</string> 
+                   <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-05-15_593_5091965176340900232/-ext-10001</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -409,10 +409,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-54-44_457_1118129043044323606/-ext-10002</string> 
+               <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-05-15_593_5091965176340900232/-ext-10002</string> 
               </void> 
               <void property="targetDir"> 
-               <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-54-44_457_1118129043044323606/-ext-10000</string> 
+               <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-05-15_593_5091965176340900232/-ext-10000</string> 
               </void> 
              </object> 
             </void> 
@@ -438,7 +438,7 @@
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
         <void property="dir"> 
-         <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-54-44_457_1118129043044323606/-ext-10002</string> 
+         <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-05-15_593_5091965176340900232/-ext-10002</string> 
         </void> 
         <void property="listTasks"> 
          <object idref="ArrayList0"/> 
@@ -524,11 +524,11 @@
          </void> 
          <void method="put"> 
           <string>location</string> 
-          <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src1</string> 
+          <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src1</string> 
          </void> 
          <void method="put"> 
           <string>transient_lastDdlTime</string> 
-          <string>1304060082</string> 
+          <string>1310382314</string> 
          </void> 
         </object> 
        </void> 
@@ -586,11 +586,11 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src1</string> 
+            <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src1</string> 
            </void> 
            <void method="put"> 
             <string>transient_lastDdlTime</string> 
-            <string>1304060082</string> 
+            <string>1310382314</string> 
            </void> 
           </object> 
          </void> 
@@ -614,223 +614,120 @@
             <void property="childOperators"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+               <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                    <void property="childOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                        <void property="conf"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                          <void property="destTableId"> 
-                           <int>1</int> 
-                          </void> 
-                          <void property="dirName"> 
-                           <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-54-44_457_1118129043044323606/-ext-10002</string> 
-                          </void> 
-                          <void property="gatherStats"> 
-                           <boolean>true</boolean> 
-                          </void> 
-                          <void property="numFiles"> 
-                           <int>1</int> 
-                          </void> 
-                          <void property="statsAggPrefix"> 
-                           <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-54-44_457_1118129043044323606/-ext-10000/</string> 
-                          </void> 
-                          <void property="tableInfo"> 
-                           <object idref="TableDesc0"/> 
-                          </void> 
-                          <void property="totalFiles"> 
-                           <int>1</int> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="counterNames"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_245_NUM_INPUT_ROWS</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_245_NUM_OUTPUT_ROWS</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_245_TIME_TAKEN</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_245_FATAL_ERROR</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="operatorId"> 
-                         <string>FS_245</string> 
-                        </void> 
-                        <void property="parentOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object idref="SelectOperator0"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="schema"> 
-                         <object idref="RowSchema0"/> 
-                        </void> 
-                       </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                    <void property="conf"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                      <void property="destTableId"> 
+                       <int>1</int> 
                       </void> 
-                     </object> 
-                    </void> 
-                    <void property="columnExprMap"> 
-                     <object class="java.util.HashMap"> 
-                      <void method="put"> 
-                       <string>_col1</string> 
-                       <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>value</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src1</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
+                      <void property="dirName"> 
+                       <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-05-15_593_5091965176340900232/-ext-10002</string> 
                       </void> 
-                      <void method="put"> 
-                       <string>_col0</string> 
-                       <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src1</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
+                      <void property="gatherStats"> 
+                       <boolean>true</boolean> 
                       </void> 
-                     </object> 
-                    </void> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                      <void property="colList"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc1"/> 
-                        </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc0"/> 
-                        </void> 
-                       </object> 
+                      <void property="numFiles"> 
+                       <int>1</int> 
                       </void> 
-                      <void property="outputColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void method="add"> 
-                         <string>_col1</string> 
-                        </void> 
-                       </object> 
+                      <void property="statsAggPrefix"> 
+                       <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-05-15_593_5091965176340900232/-ext-10000/</string> 
+                      </void> 
+                      <void property="tableInfo"> 
+                       <object idref="TableDesc0"/> 
+                      </void> 
+                      <void property="totalFiles"> 
+                       <int>1</int> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_244_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_FS_243_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_244_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_FS_243_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_244_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_FS_243_TIME_TAKEN</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_244_FATAL_ERROR</string> 
+                       <string>CNTR_NAME_FS_243_FATAL_ERROR</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>SEL_244</string> 
+                     <string>FS_243</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object idref="FilterOperator1"/> 
+                       <object idref="SelectOperator0"/> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="schema"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                      <void property="signature"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col0</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string>src1</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col1</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string>src1</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                     <object idref="RowSchema0"/> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-                  <void property="predicate"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="childExprs"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src1</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                <void property="columnExprMap"> 
+                 <object class="java.util.HashMap"> 
+                  <void method="put"> 
+                   <string>_col1</string> 
+                   <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>value</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPNull"/> 
+                    <void property="tabAlias"> 
+                     <string>src1</string> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                      <void property="typeName"> 
-                       <string>boolean</string> 
-                      </void> 
-                     </object> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="put"> 
+                   <string>_col0</string> 
+                   <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>key</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string>src1</string> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="conf"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                  <void property="colList"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object idref="ExprNodeColumnDesc1"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="ExprNodeColumnDesc0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void property="outputColumnNames"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <string>_col0</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col1</string> 
                     </void> 
                    </object> 
                   </void> 
@@ -839,21 +736,21 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_243_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_242_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_243_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_242_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_243_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_SEL_242_TIME_TAKEN</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_243_FATAL_ERROR</string> 
+                   <string>CNTR_NAME_SEL_242_FATAL_ERROR</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>FIL_243</string> 
+                 <string>SEL_242</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -867,9 +764,9 @@
                   <void property="signature"> 
                    <object class="java.util.ArrayList"> 
                     <void method="add"> 
-                     <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                       <void property="internalName"> 
-                       <string>key</string> 
+                       <string>_col0</string> 
                       </void> 
                       <void property="tabAlias"> 
                        <string>src1</string> 
@@ -880,9 +777,9 @@
                      </object> 
                     </void> 
                     <void method="add"> 
-                     <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                       <void property="internalName"> 
-                       <string>value</string> 
+                       <string>_col1</string> 
                       </void> 
                       <void property="tabAlias"> 
                        <string>src1</string> 
@@ -925,7 +822,11 @@
                  <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPNull"/> 
                 </void> 
                 <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo1"/> 
+                 <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                  <void property="typeName"> 
+                   <string>boolean</string> 
+                  </void> 
+                 </object> 
                 </void> 
                </object> 
               </void> 
@@ -934,21 +835,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_246_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_244_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_246_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_244_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_246_TIME_TAKEN</string> 
+               <string>CNTR_NAME_FIL_244_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_246_FATAL_ERROR</string> 
+               <string>CNTR_NAME_FIL_244_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>FIL_246</string> 
+             <string>FIL_244</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -962,10 +863,30 @@
               <void property="signature"> 
                <object id="ArrayList1" class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <object idref="ColumnInfo0"/> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>key</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>src1</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
                 </void> 
                 <void method="add"> 
-                 <object idref="ColumnInfo1"/> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>value</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>src1</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
                 </void> 
                 <void method="add"> 
                  <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
@@ -1024,16 +945,16 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_242_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_240_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_242_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_240_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_242_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_240_TIME_TAKEN</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_242_FATAL_ERROR</string> 
+           <string>CNTR_NAME_TS_240_FATAL_ERROR</string> 
           </void> 
          </object> 
         </void> 
@@ -1048,7 +969,7 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_242</string> 
+         <string>TS_240</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -1070,7 +991,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src1</string> 
+       <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src1</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>src1</string> 
@@ -1082,7 +1003,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src1</string> 
+       <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src1</string> 
        <object class="org.apache.hadoop.hive.ql.plan.PartitionDesc"> 
         <void property="baseFileName"> 
          <string>src1</string> 
@@ -1139,11 +1060,11 @@
           </void> 
           <void method="put"> 
            <string>location</string> 
-           <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src1</string> 
+           <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src1</string> 
           </void> 
           <void method="put"> 
            <string>transient_lastDdlTime</string> 
-           <string>1304060082</string> 
+           <string>1310382314</string> 
           </void> 
          </object> 
         </void> 
@@ -1201,11 +1122,11 @@
             </void> 
             <void method="put"> 
              <string>location</string> 
-             <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src1</string> 
+             <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src1</string> 
             </void> 
             <void method="put"> 
              <string>transient_lastDdlTime</string> 
-             <string>1304060082</string> 
+             <string>1310382314</string> 
             </void> 
            </object> 
           </void> 
diff --git a/ql/src/test/results/compiler/plan/input7.q.xml b/ql/src/test/results/compiler/plan/input7.q.xml
index 80b573e6d5..ac325274f9 100644
--- a/ql/src/test/results/compiler/plan/input7.q.xml
+++ b/ql/src/test/results/compiler/plan/input7.q.xml
@@ -159,21 +159,21 @@
                             <void property="counterNames"> 
                              <object class="java.util.ArrayList"> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_260_NUM_INPUT_ROWS</string> 
+                               <string>CNTR_NAME_FS_257_NUM_INPUT_ROWS</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_260_NUM_OUTPUT_ROWS</string> 
+                               <string>CNTR_NAME_FS_257_NUM_OUTPUT_ROWS</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_260_TIME_TAKEN</string> 
+                               <string>CNTR_NAME_FS_257_TIME_TAKEN</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_260_FATAL_ERROR</string> 
+                               <string>CNTR_NAME_FS_257_FATAL_ERROR</string> 
                               </void> 
                              </object> 
                             </void> 
                             <void property="operatorId"> 
-                             <string>FS_260</string> 
+                             <string>FS_257</string> 
                             </void> 
                             <void property="parentOperators"> 
                              <object class="java.util.ArrayList"> 
@@ -227,21 +227,21 @@
                         <void property="counterNames"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_259_NUM_INPUT_ROWS</string> 
+                           <string>CNTR_NAME_TS_256_NUM_INPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_259_NUM_OUTPUT_ROWS</string> 
+                           <string>CNTR_NAME_TS_256_NUM_OUTPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_259_TIME_TAKEN</string> 
+                           <string>CNTR_NAME_TS_256_TIME_TAKEN</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_259_FATAL_ERROR</string> 
+                           <string>CNTR_NAME_TS_256_FATAL_ERROR</string> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="operatorId"> 
-                         <string>TS_259</string> 
+                         <string>TS_256</string> 
                         </void> 
                         <void property="schema"> 
                          <object idref="RowSchema0"/> 
@@ -643,21 +643,21 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FS_258_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_FS_255_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FS_258_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_FS_255_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FS_258_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_FS_255_TIME_TAKEN</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FS_258_FATAL_ERROR</string> 
+                   <string>CNTR_NAME_FS_255_FATAL_ERROR</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>FS_258</string> 
+                 <string>FS_255</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -726,21 +726,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_257_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_SEL_254_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_257_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_SEL_254_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_257_TIME_TAKEN</string> 
+               <string>CNTR_NAME_SEL_254_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_257_FATAL_ERROR</string> 
+               <string>CNTR_NAME_SEL_254_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>SEL_257</string> 
+             <string>SEL_254</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -801,16 +801,16 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_256_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_253_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_256_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_253_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_256_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_253_TIME_TAKEN</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_256_FATAL_ERROR</string> 
+           <string>CNTR_NAME_TS_253_FATAL_ERROR</string> 
           </void> 
          </object> 
         </void> 
@@ -822,7 +822,7 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_256</string> 
+         <string>TS_253</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
diff --git a/ql/src/test/results/compiler/plan/input8.q.xml b/ql/src/test/results/compiler/plan/input8.q.xml
index fd704e33d0..ce37b1b49a 100644
--- a/ql/src/test/results/compiler/plan/input8.q.xml
+++ b/ql/src/test/results/compiler/plan/input8.q.xml
@@ -201,21 +201,21 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FS_268_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_FS_265_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FS_268_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_FS_265_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FS_268_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_FS_265_TIME_TAKEN</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FS_268_FATAL_ERROR</string> 
+                   <string>CNTR_NAME_FS_265_FATAL_ERROR</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>FS_268</string> 
+                 <string>FS_265</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -438,21 +438,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_267_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_SEL_264_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_267_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_SEL_264_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_267_TIME_TAKEN</string> 
+               <string>CNTR_NAME_SEL_264_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_267_FATAL_ERROR</string> 
+               <string>CNTR_NAME_SEL_264_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>SEL_267</string> 
+             <string>SEL_264</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -525,16 +525,16 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_266_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_263_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_266_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_263_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_266_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_263_TIME_TAKEN</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_266_FATAL_ERROR</string> 
+           <string>CNTR_NAME_TS_263_FATAL_ERROR</string> 
           </void> 
          </object> 
         </void> 
@@ -546,7 +546,7 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_266</string> 
+         <string>TS_263</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
diff --git a/ql/src/test/results/compiler/plan/input9.q.xml b/ql/src/test/results/compiler/plan/input9.q.xml
index 3d51275fce..9e6f80f6d5 100644
--- a/ql/src/test/results/compiler/plan/input9.q.xml
+++ b/ql/src/test/results/compiler/plan/input9.q.xml
@@ -1,5 +1,5 @@
 <?xml version="1.0" encoding="UTF-8"?> 
-<java version="1.6.0_07" class="java.beans.XMLDecoder"> 
+<java version="1.6.0_01" class="java.beans.XMLDecoder"> 
  <object id="MapRedTask0" class="org.apache.hadoop.hive.ql.exec.MapRedTask"> 
   <void property="childTasks"> 
    <object class="java.util.ArrayList"> 
@@ -33,7 +33,7 @@
                   <void property="work"> 
                    <object class="org.apache.hadoop.hive.ql.plan.StatsWork"> 
                     <void property="aggKey"> 
-                     <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-55-13_445_1153330900988922829/-ext-10000/</string> 
+                     <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-05-25_965_5264708180261866853/-ext-10000/</string> 
                     </void> 
                    </object> 
                   </void> 
@@ -73,7 +73,7 @@
                     <void property="aliasToWork"> 
                      <object class="java.util.LinkedHashMap"> 
                       <void method="put"> 
-                       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-55-13_445_1153330900988922829/-ext-10002</string> 
+                       <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-05-25_965_5264708180261866853/-ext-10002</string> 
                        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                         <void property="childOperators"> 
                          <object class="java.util.ArrayList"> 
@@ -82,7 +82,7 @@
                             <void property="conf"> 
                              <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
                               <void property="dirName"> 
-                               <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-55-13_445_1153330900988922829/-ext-10000</string> 
+                               <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-05-25_965_5264708180261866853/-ext-10000</string> 
                               </void> 
                               <void property="numFiles"> 
                                <int>1</int> 
@@ -134,7 +134,7 @@
                                   </void> 
                                   <void method="put"> 
                                    <string>location</string> 
-                                   <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/dest1</string> 
+                                   <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/dest1</string> 
                                   </void> 
                                   <void method="put"> 
                                    <string>file.outputformat</string> 
@@ -142,7 +142,7 @@
                                   </void> 
                                   <void method="put"> 
                                    <string>transient_lastDdlTime</string> 
-                                   <string>1304060113</string> 
+                                   <string>1310382325</string> 
                                   </void> 
                                  </object> 
                                 </void> 
@@ -159,21 +159,21 @@
                             <void property="counterNames"> 
                              <object class="java.util.ArrayList"> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_278_NUM_INPUT_ROWS</string> 
+                               <string>CNTR_NAME_FS_275_NUM_INPUT_ROWS</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_278_NUM_OUTPUT_ROWS</string> 
+                               <string>CNTR_NAME_FS_275_NUM_OUTPUT_ROWS</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_278_TIME_TAKEN</string> 
+                               <string>CNTR_NAME_FS_275_TIME_TAKEN</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_278_FATAL_ERROR</string> 
+                               <string>CNTR_NAME_FS_275_FATAL_ERROR</string> 
                               </void> 
                              </object> 
                             </void> 
                             <void property="operatorId"> 
-                             <string>FS_278</string> 
+                             <string>FS_275</string> 
                             </void> 
                             <void property="parentOperators"> 
                              <object class="java.util.ArrayList"> 
@@ -227,21 +227,21 @@
                         <void property="counterNames"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_277_NUM_INPUT_ROWS</string> 
+                           <string>CNTR_NAME_TS_274_NUM_INPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_277_NUM_OUTPUT_ROWS</string> 
+                           <string>CNTR_NAME_TS_274_NUM_OUTPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_277_TIME_TAKEN</string> 
+                           <string>CNTR_NAME_TS_274_TIME_TAKEN</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_277_FATAL_ERROR</string> 
+                           <string>CNTR_NAME_TS_274_FATAL_ERROR</string> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="operatorId"> 
-                         <string>TS_277</string> 
+                         <string>TS_274</string> 
                         </void> 
                         <void property="schema"> 
                          <object idref="RowSchema0"/> 
@@ -262,10 +262,10 @@
                     <void property="pathToAliases"> 
                      <object class="java.util.LinkedHashMap"> 
                       <void method="put"> 
-                       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-55-13_445_1153330900988922829/-ext-10002</string> 
+                       <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-05-25_965_5264708180261866853/-ext-10002</string> 
                        <object class="java.util.ArrayList"> 
                         <void method="add"> 
-                         <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-55-13_445_1153330900988922829/-ext-10002</string> 
+                         <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-05-25_965_5264708180261866853/-ext-10002</string> 
                         </void> 
                        </object> 
                       </void> 
@@ -274,7 +274,7 @@
                     <void property="pathToPartitionInfo"> 
                      <object class="java.util.LinkedHashMap"> 
                       <void method="put"> 
-                       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-55-13_445_1153330900988922829/-ext-10002</string> 
+                       <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-05-25_965_5264708180261866853/-ext-10002</string> 
                        <object class="org.apache.hadoop.hive.ql.plan.PartitionDesc"> 
                         <void property="baseFileName"> 
                          <string>-ext-10002</string> 
@@ -328,11 +328,11 @@
                           </void> 
                           <void method="put"> 
                            <string>location</string> 
-                           <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/dest1</string> 
+                           <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/dest1</string> 
                           </void> 
                           <void method="put"> 
                            <string>transient_lastDdlTime</string> 
-                           <string>1304060113</string> 
+                           <string>1310382325</string> 
                           </void> 
                          </object> 
                         </void> 
@@ -382,13 +382,13 @@
                    <boolean>true</boolean> 
                   </void> 
                   <void property="sourceDir"> 
-                   <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-55-13_445_1153330900988922829/-ext-10000</string> 
+                   <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-05-25_965_5264708180261866853/-ext-10000</string> 
                   </void> 
                   <void property="table"> 
                    <object idref="TableDesc0"/> 
                   </void> 
                   <void property="tmpDir"> 
-                   <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-55-13_445_1153330900988922829/-ext-10001</string> 
+                   <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-05-25_965_5264708180261866853/-ext-10001</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -409,10 +409,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-55-13_445_1153330900988922829/-ext-10002</string> 
+               <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-05-25_965_5264708180261866853/-ext-10002</string> 
               </void> 
               <void property="targetDir"> 
-               <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-55-13_445_1153330900988922829/-ext-10000</string> 
+               <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-05-25_965_5264708180261866853/-ext-10000</string> 
               </void> 
              </object> 
             </void> 
@@ -438,7 +438,7 @@
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
         <void property="dir"> 
-         <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-55-13_445_1153330900988922829/-ext-10002</string> 
+         <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-05-25_965_5264708180261866853/-ext-10002</string> 
         </void> 
         <void property="listTasks"> 
          <object idref="ArrayList0"/> 
@@ -524,11 +524,11 @@
          </void> 
          <void method="put"> 
           <string>location</string> 
-          <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src1</string> 
+          <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src1</string> 
          </void> 
          <void method="put"> 
           <string>transient_lastDdlTime</string> 
-          <string>1304060111</string> 
+          <string>1310382325</string> 
          </void> 
         </object> 
        </void> 
@@ -586,11 +586,11 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src1</string> 
+            <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src1</string> 
            </void> 
            <void method="put"> 
             <string>transient_lastDdlTime</string> 
-            <string>1304060111</string> 
+            <string>1310382325</string> 
            </void> 
           </object> 
          </void> 
@@ -614,219 +614,114 @@
             <void property="childOperators"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+               <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                    <void property="childOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                        <void property="conf"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                          <void property="destTableId"> 
-                           <int>1</int> 
-                          </void> 
-                          <void property="dirName"> 
-                           <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-55-13_445_1153330900988922829/-ext-10002</string> 
-                          </void> 
-                          <void property="gatherStats"> 
-                           <boolean>true</boolean> 
-                          </void> 
-                          <void property="numFiles"> 
-                           <int>1</int> 
-                          </void> 
-                          <void property="statsAggPrefix"> 
-                           <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-55-13_445_1153330900988922829/-ext-10000/</string> 
-                          </void> 
-                          <void property="tableInfo"> 
-                           <object idref="TableDesc0"/> 
-                          </void> 
-                          <void property="totalFiles"> 
-                           <int>1</int> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="counterNames"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_275_NUM_INPUT_ROWS</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_275_NUM_OUTPUT_ROWS</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_275_TIME_TAKEN</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_275_FATAL_ERROR</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="operatorId"> 
-                         <string>FS_275</string> 
-                        </void> 
-                        <void property="parentOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object idref="SelectOperator0"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="schema"> 
-                         <object idref="RowSchema0"/> 
-                        </void> 
-                       </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                    <void property="conf"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                      <void property="destTableId"> 
+                       <int>1</int> 
                       </void> 
-                     </object> 
-                    </void> 
-                    <void property="columnExprMap"> 
-                     <object class="java.util.HashMap"> 
-                      <void method="put"> 
-                       <string>_col1</string> 
-                       <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src1</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
+                      <void property="dirName"> 
+                       <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-05-25_965_5264708180261866853/-ext-10002</string> 
                       </void> 
-                      <void method="put"> 
-                       <string>_col0</string> 
-                       <object id="ExprNodeConstantDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
+                      <void property="gatherStats"> 
+                       <boolean>true</boolean> 
                       </void> 
-                     </object> 
-                    </void> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                      <void property="colList"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object idref="ExprNodeConstantDesc0"/> 
-                        </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc0"/> 
-                        </void> 
-                       </object> 
+                      <void property="numFiles"> 
+                       <int>1</int> 
                       </void> 
-                      <void property="outputColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void method="add"> 
-                         <string>_col1</string> 
-                        </void> 
-                       </object> 
+                      <void property="statsAggPrefix"> 
+                       <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-05-25_965_5264708180261866853/-ext-10000/</string> 
+                      </void> 
+                      <void property="tableInfo"> 
+                       <object idref="TableDesc0"/> 
+                      </void> 
+                      <void property="totalFiles"> 
+                       <int>1</int> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_274_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_FS_272_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_274_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_FS_272_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_274_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_FS_272_TIME_TAKEN</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_274_FATAL_ERROR</string> 
+                       <string>CNTR_NAME_FS_272_FATAL_ERROR</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>SEL_274</string> 
+                     <string>FS_272</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object idref="FilterOperator1"/> 
+                       <object idref="SelectOperator0"/> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="schema"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                      <void property="signature"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col0</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                            <void property="typeName"> 
-                             <string>void</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col1</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string>src1</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                     <object idref="RowSchema0"/> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-                  <void property="predicate"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="childExprs"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeNullDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeNullDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                <void property="columnExprMap"> 
+                 <object class="java.util.HashMap"> 
+                  <void method="put"> 
+                   <string>_col1</string> 
+                   <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>key</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual"/> 
+                    <void property="tabAlias"> 
+                     <string>src1</string> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                      <void property="typeName"> 
-                       <string>boolean</string> 
-                      </void> 
-                     </object> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="put"> 
+                   <string>_col0</string> 
+                   <object id="ExprNodeConstantDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="conf"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                  <void property="colList"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object idref="ExprNodeConstantDesc0"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="ExprNodeColumnDesc0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void property="outputColumnNames"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <string>_col0</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col1</string> 
                     </void> 
                    </object> 
                   </void> 
@@ -835,21 +730,21 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_273_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_271_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_273_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_271_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_273_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_SEL_271_TIME_TAKEN</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_273_FATAL_ERROR</string> 
+                   <string>CNTR_NAME_SEL_271_FATAL_ERROR</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>FIL_273</string> 
+                 <string>SEL_271</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -863,9 +758,23 @@
                   <void property="signature"> 
                    <object class="java.util.ArrayList"> 
                     <void method="add"> 
-                     <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="internalName"> 
+                       <string>_col0</string> 
+                      </void> 
+                      <void property="type"> 
+                       <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                        <void property="typeName"> 
+                         <string>void</string> 
+                        </void> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                       <void property="internalName"> 
-                       <string>key</string> 
+                       <string>_col1</string> 
                       </void> 
                       <void property="tabAlias"> 
                        <string>src1</string> 
@@ -909,7 +818,11 @@
                  <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual"/> 
                 </void> 
                 <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo2"/> 
+                 <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                  <void property="typeName"> 
+                   <string>boolean</string> 
+                  </void> 
+                 </object> 
                 </void> 
                </object> 
               </void> 
@@ -918,21 +831,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_276_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_273_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_276_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_273_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_276_TIME_TAKEN</string> 
+               <string>CNTR_NAME_FIL_273_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_276_FATAL_ERROR</string> 
+               <string>CNTR_NAME_FIL_273_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>FIL_276</string> 
+             <string>FIL_273</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -946,7 +859,17 @@
               <void property="signature"> 
                <object id="ArrayList1" class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <object idref="ColumnInfo0"/> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>key</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>src1</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
                 </void> 
                 <void method="add"> 
                  <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
@@ -1018,16 +941,16 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_272_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_269_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_272_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_269_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_272_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_269_TIME_TAKEN</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_272_FATAL_ERROR</string> 
+           <string>CNTR_NAME_TS_269_FATAL_ERROR</string> 
           </void> 
          </object> 
         </void> 
@@ -1039,7 +962,7 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_272</string> 
+         <string>TS_269</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -1061,7 +984,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src1</string> 
+       <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src1</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>src1</string> 
@@ -1073,7 +996,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src1</string> 
+       <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src1</string> 
        <object class="org.apache.hadoop.hive.ql.plan.PartitionDesc"> 
         <void property="baseFileName"> 
          <string>src1</string> 
@@ -1130,11 +1053,11 @@
           </void> 
           <void method="put"> 
            <string>location</string> 
-           <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src1</string> 
+           <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src1</string> 
           </void> 
           <void method="put"> 
            <string>transient_lastDdlTime</string> 
-           <string>1304060111</string> 
+           <string>1310382325</string> 
           </void> 
          </object> 
         </void> 
@@ -1192,11 +1115,11 @@
             </void> 
             <void method="put"> 
              <string>location</string> 
-             <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src1</string> 
+             <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src1</string> 
             </void> 
             <void method="put"> 
              <string>transient_lastDdlTime</string> 
-             <string>1304060111</string> 
+             <string>1310382325</string> 
             </void> 
            </object> 
           </void> 
diff --git a/ql/src/test/results/compiler/plan/input_part1.q.xml b/ql/src/test/results/compiler/plan/input_part1.q.xml
index 12082ea8a8..3446e48b5c 100644
--- a/ql/src/test/results/compiler/plan/input_part1.q.xml
+++ b/ql/src/test/results/compiler/plan/input_part1.q.xml
@@ -1,5 +1,5 @@
 <?xml version="1.0" encoding="UTF-8"?> 
-<java version="1.6.0_07" class="java.beans.XMLDecoder"> 
+<java version="1.6.0_01" class="java.beans.XMLDecoder"> 
  <object class="org.apache.hadoop.hive.ql.exec.MapRedTask"> 
   <void property="id"> 
    <string>Stage-3</string> 
@@ -75,11 +75,11 @@
          </void> 
          <void method="put"> 
           <string>location</string> 
-          <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12</string> 
+          <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12</string> 
          </void> 
          <void method="put"> 
           <string>transient_lastDdlTime</string> 
-          <string>1304060114</string> 
+          <string>1310382326</string> 
          </void> 
         </object> 
        </void> 
@@ -141,11 +141,11 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcpart</string> 
+            <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcpart</string> 
            </void> 
            <void method="put"> 
             <string>transient_lastDdlTime</string> 
-            <string>1304060114</string> 
+            <string>1310382326</string> 
            </void> 
           </object> 
          </void> 
@@ -169,279 +169,79 @@
             <void property="childOperators"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+               <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                    <void property="childOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                        <void property="conf"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                          <void property="dirName"> 
-                           <string>file:/tmp/sdong/hive_2011-04-28_23-55-23_051_5537314784500823155/-ext-10001</string> 
-                          </void> 
-                          <void property="numFiles"> 
-                           <int>1</int> 
-                          </void> 
-                          <void property="statsAggPrefix"> 
-                           <string>file:/tmp/sdong/hive_2011-04-28_23-55-23_051_5537314784500823155/-ext-10001/</string> 
-                          </void> 
-                          <void property="tableInfo"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                            <void property="deserializerClass"> 
-                             <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
-                            </void> 
-                            <void property="inputFileFormatClass"> 
-                             <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-                            </void> 
-                            <void property="outputFileFormatClass"> 
-                             <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-                            </void> 
-                            <void property="properties"> 
-                             <object class="java.util.Properties"> 
-                              <void method="put"> 
-                               <string>columns</string> 
-                               <string>_col0,_col1,_col2,_col3</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>serialization.format</string> 
-                               <string>1</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>columns.types</string> 
-                               <string>string:string:string:string</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="totalFiles"> 
-                           <int>1</int> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="counterNames"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_289_NUM_INPUT_ROWS</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_289_NUM_OUTPUT_ROWS</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_289_TIME_TAKEN</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_289_FATAL_ERROR</string> 
+                   <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                    <void property="conf"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                      <void property="dirName"> 
+                       <string>file:/tmp/amarsri/hive_2011-07-11_04-05-29_362_7332883780675641825/-ext-10001</string> 
+                      </void> 
+                      <void property="numFiles"> 
+                       <int>1</int> 
+                      </void> 
+                      <void property="statsAggPrefix"> 
+                       <string>file:/tmp/amarsri/hive_2011-07-11_04-05-29_362_7332883780675641825/-ext-10001/</string> 
+                      </void> 
+                      <void property="tableInfo"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                        <void property="deserializerClass"> 
+                         <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
+                        </void> 
+                        <void property="inputFileFormatClass"> 
+                         <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                        </void> 
+                        <void property="outputFileFormatClass"> 
+                         <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                        </void> 
+                        <void property="properties"> 
+                         <object class="java.util.Properties"> 
+                          <void method="put"> 
+                           <string>columns</string> 
+                           <string>_col0,_col1,_col2,_col3</string> 
                           </void> 
-                         </object> 
-                        </void> 
-                        <void property="operatorId"> 
-                         <string>FS_289</string> 
-                        </void> 
-                        <void property="parentOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object idref="SelectOperator0"/> 
+                          <void method="put"> 
+                           <string>serialization.format</string> 
+                           <string>1</string> 
                           </void> 
-                         </object> 
-                        </void> 
-                        <void property="schema"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                          <void property="signature"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>_col0</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string></string> 
-                              </void> 
-                              <void property="type"> 
-                               <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                                <void property="typeName"> 
-                                 <string>string</string> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>_col1</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string></string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>_col2</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string></string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>_col3</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string></string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
+                          <void method="put"> 
+                           <string>columns.types</string> 
+                           <string>string:string:string:string</string> 
                           </void> 
                          </object> 
                         </void> 
                        </object> 
                       </void> 
-                     </object> 
-                    </void> 
-                    <void property="columnExprMap"> 
-                     <object class="java.util.HashMap"> 
-                      <void method="put"> 
-                       <string>_col3</string> 
-                       <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>ds</string> 
-                        </void> 
-                        <void property="isPartitionColOrVirtualCol"> 
-                         <boolean>true</boolean> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>srcpart</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="put"> 
-                       <string>_col2</string> 
-                       <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>hr</string> 
-                        </void> 
-                        <void property="isPartitionColOrVirtualCol"> 
-                         <boolean>true</boolean> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>srcpart</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="put"> 
-                       <string>_col1</string> 
-                       <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>value</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>srcpart</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="put"> 
-                       <string>_col0</string> 
-                       <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>srcpart</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                      <void property="colList"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc3"/> 
-                        </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc2"/> 
-                        </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc1"/> 
-                        </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="outputColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void method="add"> 
-                         <string>_col1</string> 
-                        </void> 
-                        <void method="add"> 
-                         <string>_col2</string> 
-                        </void> 
-                        <void method="add"> 
-                         <string>_col3</string> 
-                        </void> 
-                       </object> 
+                      <void property="totalFiles"> 
+                       <int>1</int> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_288_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_FS_285_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_288_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_FS_285_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_288_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_FS_285_TIME_TAKEN</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_288_FATAL_ERROR</string> 
+                       <string>CNTR_NAME_FS_285_FATAL_ERROR</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>SEL_288</string> 
+                     <string>FS_285</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object idref="FilterOperator1"/> 
+                       <object idref="SelectOperator0"/> 
                       </void> 
                      </object> 
                     </void> 
@@ -451,30 +251,28 @@
                        <object class="java.util.ArrayList"> 
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="alias"> 
-                           <string>key</string> 
-                          </void> 
                           <void property="internalName"> 
                            <string>_col0</string> 
                           </void> 
                           <void property="tabAlias"> 
-                           <string>srcpart</string> 
+                           <string></string> 
                           </void> 
                           <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
+                           <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                            <void property="typeName"> 
+                             <string>string</string> 
+                            </void> 
+                           </object> 
                           </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="alias"> 
-                           <string>value</string> 
-                          </void> 
                           <void property="internalName"> 
                            <string>_col1</string> 
                           </void> 
                           <void property="tabAlias"> 
-                           <string>srcpart</string> 
+                           <string></string> 
                           </void> 
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
@@ -483,14 +281,11 @@
                         </void> 
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="alias"> 
-                           <string>hr</string> 
-                          </void> 
                           <void property="internalName"> 
                            <string>_col2</string> 
                           </void> 
                           <void property="tabAlias"> 
-                           <string>srcpart</string> 
+                           <string></string> 
                           </void> 
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
@@ -499,14 +294,11 @@
                         </void> 
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="alias"> 
-                           <string>ds</string> 
-                          </void> 
                           <void property="internalName"> 
                            <string>_col3</string> 
                           </void> 
                           <void property="tabAlias"> 
-                           <string>srcpart</string> 
+                           <string></string> 
                           </void> 
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
@@ -521,158 +313,103 @@
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-                  <void property="predicate"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="childExprs"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                            <void property="childExprs"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                                <void property="column"> 
-                                 <string>key</string> 
-                                </void> 
-                                <void property="tabAlias"> 
-                                 <string>srcpart</string> 
-                                </void> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo0"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                                <void property="typeInfo"> 
-                                 <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                                  <void property="typeName"> 
-                                   <string>int</string> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void property="value"> 
-                                 <int>100</int> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="genericUDF"> 
-                             <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                              <void property="typeName"> 
-                               <string>boolean</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                            <void property="childExprs"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                                <void property="column"> 
-                                 <string>ds</string> 
-                                </void> 
-                                <void property="isPartitionColOrVirtualCol"> 
-                                 <boolean>true</boolean> 
-                                </void> 
-                                <void property="tabAlias"> 
-                                 <string>srcpart</string> 
-                                </void> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo0"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo0"/> 
-                                </void> 
-                                <void property="value"> 
-                                 <string>2008-04-08</string> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="genericUDF"> 
-                             <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual"/> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo2"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd"/> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo2"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>hr</string> 
-                            </void> 
-                            <void property="isPartitionColOrVirtualCol"> 
-                             <boolean>true</boolean> 
-                            </void> 
-                            <void property="tabAlias"> 
-                             <string>srcpart</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                            <void property="value"> 
-                             <string>12</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual"/> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo2"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                <void property="columnExprMap"> 
+                 <object class="java.util.HashMap"> 
+                  <void method="put"> 
+                   <string>_col3</string> 
+                   <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>ds</string> 
+                    </void> 
+                    <void property="isPartitionColOrVirtualCol"> 
+                     <boolean>true</boolean> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string>srcpart</string> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="put"> 
+                   <string>_col2</string> 
+                   <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>hr</string> 
+                    </void> 
+                    <void property="isPartitionColOrVirtualCol"> 
+                     <boolean>true</boolean> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string>srcpart</string> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="put"> 
+                   <string>_col1</string> 
+                   <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>value</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string>srcpart</string> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd"/> 
+                   </object> 
+                  </void> 
+                  <void method="put"> 
+                   <string>_col0</string> 
+                   <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>key</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string>srcpart</string> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="conf"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                  <void property="colList"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object idref="ExprNodeColumnDesc3"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="ExprNodeColumnDesc2"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="ExprNodeColumnDesc1"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="ExprNodeColumnDesc0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void property="outputColumnNames"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <string>_col0</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col1</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col2</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col3</string> 
                     </void> 
                    </object> 
                   </void> 
@@ -681,21 +418,21 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_287_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_284_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_287_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_284_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_287_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_SEL_284_TIME_TAKEN</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_287_FATAL_ERROR</string> 
+                   <string>CNTR_NAME_SEL_284_FATAL_ERROR</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>FIL_287</string> 
+                 <string>SEL_284</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -709,10 +446,13 @@
                   <void property="signature"> 
                    <object class="java.util.ArrayList"> 
                     <void method="add"> 
-                     <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="alias"> 
                        <string>key</string> 
                       </void> 
+                      <void property="internalName"> 
+                       <string>_col0</string> 
+                      </void> 
                       <void property="tabAlias"> 
                        <string>srcpart</string> 
                       </void> 
@@ -722,10 +462,13 @@
                      </object> 
                     </void> 
                     <void method="add"> 
-                     <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="alias"> 
                        <string>value</string> 
                       </void> 
+                      <void property="internalName"> 
+                       <string>_col1</string> 
+                      </void> 
                       <void property="tabAlias"> 
                        <string>srcpart</string> 
                       </void> 
@@ -735,9 +478,12 @@
                      </object> 
                     </void> 
                     <void method="add"> 
-                     <object id="ColumnInfo2" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="alias"> 
+                       <string>hr</string> 
+                      </void> 
                       <void property="internalName"> 
-                       <string>ds</string> 
+                       <string>_col2</string> 
                       </void> 
                       <void property="tabAlias"> 
                        <string>srcpart</string> 
@@ -748,9 +494,12 @@
                      </object> 
                     </void> 
                     <void method="add"> 
-                     <object id="ColumnInfo3" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="alias"> 
+                       <string>ds</string> 
+                      </void> 
                       <void property="internalName"> 
-                       <string>hr</string> 
+                       <string>_col3</string> 
                       </void> 
                       <void property="tabAlias"> 
                        <string>srcpart</string> 
@@ -790,7 +539,11 @@
                   <void method="add"> 
                    <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
+                     <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                      <void property="typeName"> 
+                       <string>int</string> 
+                      </void> 
+                     </object> 
                     </void> 
                     <void property="value"> 
                      <int>100</int> 
@@ -803,7 +556,11 @@
                  <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
                 </void> 
                 <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo2"/> 
+                 <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                  <void property="typeName"> 
+                   <string>boolean</string> 
+                  </void> 
+                 </object> 
                 </void> 
                </object> 
               </void> 
@@ -812,21 +569,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_290_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_286_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_290_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_286_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_290_TIME_TAKEN</string> 
+               <string>CNTR_NAME_FIL_286_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_290_FATAL_ERROR</string> 
+               <string>CNTR_NAME_FIL_286_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>FIL_290</string> 
+             <string>FIL_286</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -840,16 +597,56 @@
               <void property="signature"> 
                <object id="ArrayList0" class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <object idref="ColumnInfo0"/> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>key</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>srcpart</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
                 </void> 
                 <void method="add"> 
-                 <object idref="ColumnInfo1"/> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>value</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>srcpart</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
                 </void> 
                 <void method="add"> 
-                 <object idref="ColumnInfo2"/> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>ds</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>srcpart</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
                 </void> 
                 <void method="add"> 
-                 <object idref="ColumnInfo3"/> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>hr</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>srcpart</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
                 </void> 
                 <void method="add"> 
                  <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
@@ -908,16 +705,16 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_286_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_282_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_286_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_282_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_286_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_282_TIME_TAKEN</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_286_FATAL_ERROR</string> 
+           <string>CNTR_NAME_TS_282_FATAL_ERROR</string> 
           </void> 
          </object> 
         </void> 
@@ -932,7 +729,7 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_286</string> 
+         <string>TS_282</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -951,7 +748,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12</string> 
+       <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>srcpart</string> 
@@ -963,7 +760,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12</string> 
+       <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12</string> 
        <object class="org.apache.hadoop.hive.ql.plan.PartitionDesc"> 
         <void property="baseFileName"> 
          <string>hr=12</string> 
@@ -1033,11 +830,11 @@
           </void> 
           <void method="put"> 
            <string>location</string> 
-           <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12</string> 
+           <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12</string> 
           </void> 
           <void method="put"> 
            <string>transient_lastDdlTime</string> 
-           <string>1304060115</string> 
+           <string>1310382326</string> 
           </void> 
          </object> 
         </void> 
@@ -1099,11 +896,11 @@
             </void> 
             <void method="put"> 
              <string>location</string> 
-             <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcpart</string> 
+             <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcpart</string> 
             </void> 
             <void method="put"> 
              <string>transient_lastDdlTime</string> 
-             <string>1304060114</string> 
+             <string>1310382326</string> 
             </void> 
            </object> 
           </void> 
diff --git a/ql/src/test/results/compiler/plan/input_testsequencefile.q.xml b/ql/src/test/results/compiler/plan/input_testsequencefile.q.xml
index 65de167340..0cfff9260a 100644
--- a/ql/src/test/results/compiler/plan/input_testsequencefile.q.xml
+++ b/ql/src/test/results/compiler/plan/input_testsequencefile.q.xml
@@ -159,21 +159,21 @@
                             <void property="counterNames"> 
                              <object class="java.util.ArrayList"> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_300_NUM_INPUT_ROWS</string> 
+                               <string>CNTR_NAME_FS_295_NUM_INPUT_ROWS</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_300_NUM_OUTPUT_ROWS</string> 
+                               <string>CNTR_NAME_FS_295_NUM_OUTPUT_ROWS</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_300_TIME_TAKEN</string> 
+                               <string>CNTR_NAME_FS_295_TIME_TAKEN</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_300_FATAL_ERROR</string> 
+                               <string>CNTR_NAME_FS_295_FATAL_ERROR</string> 
                               </void> 
                              </object> 
                             </void> 
                             <void property="operatorId"> 
-                             <string>FS_300</string> 
+                             <string>FS_295</string> 
                             </void> 
                             <void property="parentOperators"> 
                              <object class="java.util.ArrayList"> 
@@ -227,21 +227,21 @@
                         <void property="counterNames"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_299_NUM_INPUT_ROWS</string> 
+                           <string>CNTR_NAME_TS_294_NUM_INPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_299_NUM_OUTPUT_ROWS</string> 
+                           <string>CNTR_NAME_TS_294_NUM_OUTPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_299_TIME_TAKEN</string> 
+                           <string>CNTR_NAME_TS_294_TIME_TAKEN</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_299_FATAL_ERROR</string> 
+                           <string>CNTR_NAME_TS_294_FATAL_ERROR</string> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="operatorId"> 
-                         <string>TS_299</string> 
+                         <string>TS_294</string> 
                         </void> 
                         <void property="schema"> 
                          <object idref="RowSchema0"/> 
@@ -643,21 +643,21 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FS_298_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_FS_293_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FS_298_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_FS_293_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FS_298_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_FS_293_TIME_TAKEN</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FS_298_FATAL_ERROR</string> 
+                   <string>CNTR_NAME_FS_293_FATAL_ERROR</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>FS_298</string> 
+                 <string>FS_293</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -732,21 +732,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_297_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_SEL_292_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_297_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_SEL_292_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_297_TIME_TAKEN</string> 
+               <string>CNTR_NAME_SEL_292_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_297_FATAL_ERROR</string> 
+               <string>CNTR_NAME_SEL_292_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>SEL_297</string> 
+             <string>SEL_292</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -806,16 +806,16 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_296_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_291_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_296_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_291_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_296_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_291_TIME_TAKEN</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_296_FATAL_ERROR</string> 
+           <string>CNTR_NAME_TS_291_FATAL_ERROR</string> 
           </void> 
          </object> 
         </void> 
@@ -830,7 +830,7 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_296</string> 
+         <string>TS_291</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
diff --git a/ql/src/test/results/compiler/plan/input_testxpath.q.xml b/ql/src/test/results/compiler/plan/input_testxpath.q.xml
index 36faf0a49a..73b07343c1 100644
--- a/ql/src/test/results/compiler/plan/input_testxpath.q.xml
+++ b/ql/src/test/results/compiler/plan/input_testxpath.q.xml
@@ -209,21 +209,21 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FS_308_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_FS_303_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FS_308_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_FS_303_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FS_308_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_FS_303_TIME_TAKEN</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FS_308_FATAL_ERROR</string> 
+                   <string>CNTR_NAME_FS_303_FATAL_ERROR</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>FS_308</string> 
+                 <string>FS_303</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -497,21 +497,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_307_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_SEL_302_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_307_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_SEL_302_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_307_TIME_TAKEN</string> 
+               <string>CNTR_NAME_SEL_302_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_307_FATAL_ERROR</string> 
+               <string>CNTR_NAME_SEL_302_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>SEL_307</string> 
+             <string>SEL_302</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -584,16 +584,16 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_306_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_301_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_306_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_301_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_306_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_301_TIME_TAKEN</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_306_FATAL_ERROR</string> 
+           <string>CNTR_NAME_TS_301_FATAL_ERROR</string> 
           </void> 
          </object> 
         </void> 
@@ -611,7 +611,7 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_306</string> 
+         <string>TS_301</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
diff --git a/ql/src/test/results/compiler/plan/input_testxpath2.q.xml b/ql/src/test/results/compiler/plan/input_testxpath2.q.xml
index e4e4c917ae..2125abf8b7 100644
--- a/ql/src/test/results/compiler/plan/input_testxpath2.q.xml
+++ b/ql/src/test/results/compiler/plan/input_testxpath2.q.xml
@@ -1,5 +1,5 @@
 <?xml version="1.0" encoding="UTF-8"?> 
-<java version="1.6.0_07" class="java.beans.XMLDecoder"> 
+<java version="1.6.0_01" class="java.beans.XMLDecoder"> 
  <object class="org.apache.hadoop.hive.ql.exec.MapRedTask"> 
   <void property="id"> 
    <string>Stage-3</string> 
@@ -66,11 +66,11 @@
          </void> 
          <void method="put"> 
           <string>location</string> 
-          <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src_thrift</string> 
+          <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src_thrift</string> 
          </void> 
          <void method="put"> 
           <string>transient_lastDdlTime</string> 
-          <string>1304060151</string> 
+          <string>1310382339</string> 
          </void> 
         </object> 
        </void> 
@@ -132,11 +132,11 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src_thrift</string> 
+            <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src_thrift</string> 
            </void> 
            <void method="put"> 
             <string>transient_lastDdlTime</string> 
-            <string>1304060151</string> 
+            <string>1310382339</string> 
            </void> 
           </object> 
          </void> 
@@ -160,328 +160,79 @@
             <void property="childOperators"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+               <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                    <void property="childOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                        <void property="conf"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                          <void property="dirName"> 
-                           <string>file:/tmp/sdong/hive_2011-04-28_23-55-52_168_749214230069396820/-ext-10001</string> 
-                          </void> 
-                          <void property="numFiles"> 
-                           <int>1</int> 
-                          </void> 
-                          <void property="statsAggPrefix"> 
-                           <string>file:/tmp/sdong/hive_2011-04-28_23-55-52_168_749214230069396820/-ext-10001/</string> 
-                          </void> 
-                          <void property="tableInfo"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                            <void property="deserializerClass"> 
-                             <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
-                            </void> 
-                            <void property="inputFileFormatClass"> 
-                             <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-                            </void> 
-                            <void property="outputFileFormatClass"> 
-                             <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-                            </void> 
-                            <void property="properties"> 
-                             <object class="java.util.Properties"> 
-                              <void method="put"> 
-                               <string>columns</string> 
-                               <string>_col0,_col1,_col2</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>serialization.format</string> 
-                               <string>1</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>columns.types</string> 
-                               <string>int:int:int</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="totalFiles"> 
-                           <int>1</int> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="counterNames"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_315_NUM_INPUT_ROWS</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_315_NUM_OUTPUT_ROWS</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_315_TIME_TAKEN</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_315_FATAL_ERROR</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="operatorId"> 
-                         <string>FS_315</string> 
-                        </void> 
-                        <void property="parentOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object idref="SelectOperator0"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="schema"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                          <void property="signature"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>_col0</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string></string> 
-                              </void> 
-                              <void property="type"> 
-                               <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                                <void property="typeName"> 
-                                 <string>int</string> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>_col1</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string></string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>_col2</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string></string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                    <void property="conf"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                      <void property="dirName"> 
+                       <string>file:/tmp/amarsri/hive_2011-07-11_04-05-39_617_1990531796790632873/-ext-10001</string> 
                       </void> 
-                     </object> 
-                    </void> 
-                    <void property="columnExprMap"> 
-                     <object class="java.util.HashMap"> 
-                      <void method="put"> 
-                       <string>_col2</string> 
-                       <object id="ExprNodeGenericFuncDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>mstringstring</string> 
-                            </void> 
-                            <void property="tabAlias"> 
-                             <string>src_thrift</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object id="MapTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.MapTypeInfo"> 
-                              <void property="mapKeyTypeInfo"> 
-                               <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                                <void property="typeName"> 
-                                 <string>string</string> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void property="mapValueTypeInfo"> 
-                               <object idref="PrimitiveTypeInfo1"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFSize"/> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
+                      <void property="numFiles"> 
+                       <int>1</int> 
                       </void> 
-                      <void method="put"> 
-                       <string>_col1</string> 
-                       <object id="ExprNodeGenericFuncDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>lintstring</string> 
-                            </void> 
-                            <void property="tabAlias"> 
-                             <string>src_thrift</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object id="ListTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.ListTypeInfo"> 
-                              <void property="listElementTypeInfo"> 
-                               <object class="org.apache.hadoop.hive.serde2.typeinfo.StructTypeInfo"> 
-                                <void property="allStructFieldNames"> 
-                                 <object class="java.util.ArrayList"> 
-                                  <void method="add"> 
-                                   <string>myint</string> 
-                                  </void> 
-                                  <void method="add"> 
-                                   <string>mystring</string> 
-                                  </void> 
-                                  <void method="add"> 
-                                   <string>underscore_int</string> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void property="allStructFieldTypeInfos"> 
-                                 <object class="java.util.ArrayList"> 
-                                  <void method="add"> 
-                                   <object idref="PrimitiveTypeInfo0"/> 
-                                  </void> 
-                                  <void method="add"> 
-                                   <object idref="PrimitiveTypeInfo1"/> 
-                                  </void> 
-                                  <void method="add"> 
-                                   <object idref="PrimitiveTypeInfo0"/> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFSize"/> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
+                      <void property="statsAggPrefix"> 
+                       <string>file:/tmp/amarsri/hive_2011-07-11_04-05-39_617_1990531796790632873/-ext-10001/</string> 
                       </void> 
-                      <void method="put"> 
-                       <string>_col0</string> 
-                       <object id="ExprNodeGenericFuncDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>lint</string> 
-                            </void> 
-                            <void property="tabAlias"> 
-                             <string>src_thrift</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object id="ListTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.ListTypeInfo"> 
-                              <void property="listElementTypeInfo"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
+                      <void property="tableInfo"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                        <void property="deserializerClass"> 
+                         <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
+                        </void> 
+                        <void property="inputFileFormatClass"> 
+                         <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                        </void> 
+                        <void property="outputFileFormatClass"> 
+                         <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                        </void> 
+                        <void property="properties"> 
+                         <object class="java.util.Properties"> 
+                          <void method="put"> 
+                           <string>columns</string> 
+                           <string>_col0,_col1,_col2</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>serialization.format</string> 
+                           <string>1</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>columns.types</string> 
+                           <string>int:int:int</string> 
                           </void> 
                          </object> 
                         </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFSize"/> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                      <void property="colList"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object idref="ExprNodeGenericFuncDesc2"/> 
-                        </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeGenericFuncDesc1"/> 
-                        </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeGenericFuncDesc0"/> 
-                        </void> 
                        </object> 
                       </void> 
-                      <void property="outputColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void method="add"> 
-                         <string>_col1</string> 
-                        </void> 
-                        <void method="add"> 
-                         <string>_col2</string> 
-                        </void> 
-                       </object> 
+                      <void property="totalFiles"> 
+                       <int>1</int> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_314_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_FS_310_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_314_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_FS_310_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_314_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_FS_310_TIME_TAKEN</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_314_FATAL_ERROR</string> 
+                       <string>CNTR_NAME_FS_310_FATAL_ERROR</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>SEL_314</string> 
+                     <string>FS_310</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object idref="FilterOperator1"/> 
+                       <object idref="SelectOperator0"/> 
                       </void> 
                      </object> 
                     </void> 
@@ -491,25 +242,29 @@
                        <object class="java.util.ArrayList"> 
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="alias"> 
-                           <string>_c0</string> 
-                          </void> 
                           <void property="internalName"> 
                            <string>_col0</string> 
                           </void> 
+                          <void property="tabAlias"> 
+                           <string></string> 
+                          </void> 
                           <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
+                           <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                            <void property="typeName"> 
+                             <string>int</string> 
+                            </void> 
+                           </object> 
                           </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="alias"> 
-                           <string>_c1</string> 
-                          </void> 
                           <void property="internalName"> 
                            <string>_col1</string> 
                           </void> 
+                          <void property="tabAlias"> 
+                           <string></string> 
+                          </void> 
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
@@ -517,12 +272,12 @@
                         </void> 
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="alias"> 
-                           <string>_c2</string> 
-                          </void> 
                           <void property="internalName"> 
                            <string>_col2</string> 
                           </void> 
+                          <void property="tabAlias"> 
+                           <string></string> 
+                          </void> 
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
@@ -536,91 +291,165 @@
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-                  <void property="predicate"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                <void property="columnExprMap"> 
+                 <object class="java.util.HashMap"> 
+                  <void method="put"> 
+                   <string>_col2</string> 
+                   <object id="ExprNodeGenericFuncDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
                     <void property="childExprs"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>lint</string> 
-                            </void> 
-                            <void property="tabAlias"> 
-                             <string>src_thrift</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="ListTypeInfo1"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                        <void property="column"> 
+                         <string>mstringstring</string> 
                         </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPNotNull"/> 
+                        <void property="tabAlias"> 
+                         <string>src_thrift</string> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>boolean</string> 
+                         <object id="MapTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.MapTypeInfo"> 
+                          <void property="mapKeyTypeInfo"> 
+                           <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                            <void property="typeName"> 
+                             <string>string</string> 
+                            </void> 
+                           </object> 
+                          </void> 
+                          <void property="mapValueTypeInfo"> 
+                           <object idref="PrimitiveTypeInfo1"/> 
                           </void> 
                          </object> 
                         </void> 
                        </object> 
                       </void> 
+                     </object> 
+                    </void> 
+                    <void property="genericUDF"> 
+                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFSize"/> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="put"> 
+                   <string>_col1</string> 
+                   <object id="ExprNodeGenericFuncDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                    <void property="childExprs"> 
+                     <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                            <void property="childExprs"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                        <void property="column"> 
+                         <string>lintstring</string> 
+                        </void> 
+                        <void property="tabAlias"> 
+                         <string>src_thrift</string> 
+                        </void> 
+                        <void property="typeInfo"> 
+                         <object id="ListTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.ListTypeInfo"> 
+                          <void property="listElementTypeInfo"> 
+                           <object class="org.apache.hadoop.hive.serde2.typeinfo.StructTypeInfo"> 
+                            <void property="allStructFieldNames"> 
                              <object class="java.util.ArrayList"> 
                               <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                                <void property="column"> 
-                                 <string>mstringstring</string> 
-                                </void> 
-                                <void property="tabAlias"> 
-                                 <string>src_thrift</string> 
-                                </void> 
-                                <void property="typeInfo"> 
-                                 <object idref="MapTypeInfo0"/> 
-                                </void> 
-                               </object> 
+                               <string>myint</string> 
+                              </void> 
+                              <void method="add"> 
+                               <string>mystring</string> 
+                              </void> 
+                              <void method="add"> 
+                               <string>underscore_int</string> 
                               </void> 
                              </object> 
                             </void> 
-                            <void property="genericUDF"> 
-                             <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPNull"/> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo2"/> 
+                            <void property="allStructFieldTypeInfos"> 
+                             <object class="java.util.ArrayList"> 
+                              <void method="add"> 
+                               <object idref="PrimitiveTypeInfo0"/> 
+                              </void> 
+                              <void method="add"> 
+                               <object idref="PrimitiveTypeInfo1"/> 
+                              </void> 
+                              <void method="add"> 
+                               <object idref="PrimitiveTypeInfo0"/> 
+                              </void> 
+                             </object> 
                             </void> 
                            </object> 
                           </void> 
                          </object> 
                         </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPNot"/> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="genericUDF"> 
+                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFSize"/> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="put"> 
+                   <string>_col0</string> 
+                   <object id="ExprNodeGenericFuncDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                    <void property="childExprs"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                        <void property="column"> 
+                         <string>lint</string> 
+                        </void> 
+                        <void property="tabAlias"> 
+                         <string>src_thrift</string> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo2"/> 
+                         <object id="ListTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.ListTypeInfo"> 
+                          <void property="listElementTypeInfo"> 
+                           <object idref="PrimitiveTypeInfo0"/> 
+                          </void> 
+                         </object> 
                         </void> 
                        </object> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd"/> 
+                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFSize"/> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="conf"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                  <void property="colList"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object idref="ExprNodeGenericFuncDesc2"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="ExprNodeGenericFuncDesc1"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="ExprNodeGenericFuncDesc0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void property="outputColumnNames"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <string>_col0</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col1</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col2</string> 
                     </void> 
                    </object> 
                   </void> 
@@ -629,21 +458,21 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_313_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_309_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_313_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_309_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_313_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_SEL_309_TIME_TAKEN</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_313_FATAL_ERROR</string> 
+                   <string>CNTR_NAME_SEL_309_FATAL_ERROR</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>FIL_313</string> 
+                 <string>SEL_309</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -657,41 +486,41 @@
                   <void property="signature"> 
                    <object class="java.util.ArrayList"> 
                     <void method="add"> 
-                     <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>lint</string> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="alias"> 
+                       <string>_c0</string> 
                       </void> 
-                      <void property="tabAlias"> 
-                       <string>src_thrift</string> 
+                      <void property="internalName"> 
+                       <string>_col0</string> 
                       </void> 
                       <void property="type"> 
-                       <object idref="ListTypeInfo1"/> 
+                       <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
-                     <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>lintstring</string> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="alias"> 
+                       <string>_c1</string> 
                       </void> 
-                      <void property="tabAlias"> 
-                       <string>src_thrift</string> 
+                      <void property="internalName"> 
+                       <string>_col1</string> 
                       </void> 
                       <void property="type"> 
-                       <object idref="ListTypeInfo0"/> 
+                       <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
-                     <object id="ColumnInfo2" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>mstringstring</string> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="alias"> 
+                       <string>_c2</string> 
                       </void> 
-                      <void property="tabAlias"> 
-                       <string>src_thrift</string> 
+                      <void property="internalName"> 
+                       <string>_col2</string> 
                       </void> 
                       <void property="type"> 
-                       <object idref="MapTypeInfo0"/> 
+                       <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
                      </object> 
                     </void> 
@@ -732,7 +561,11 @@
                      <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPNotNull"/> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                     <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                      <void property="typeName"> 
+                       <string>boolean</string> 
+                      </void> 
+                     </object> 
                     </void> 
                    </object> 
                   </void> 
@@ -792,21 +625,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_316_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_311_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_316_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_311_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_316_TIME_TAKEN</string> 
+               <string>CNTR_NAME_FIL_311_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_316_FATAL_ERROR</string> 
+               <string>CNTR_NAME_FIL_311_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>FIL_316</string> 
+             <string>FIL_311</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -846,7 +679,17 @@
                  </object> 
                 </void> 
                 <void method="add"> 
-                 <object idref="ColumnInfo0"/> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>lint</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>src_thrift</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="ListTypeInfo1"/> 
+                  </void> 
+                 </object> 
                 </void> 
                 <void method="add"> 
                  <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
@@ -866,10 +709,30 @@
                  </object> 
                 </void> 
                 <void method="add"> 
-                 <object idref="ColumnInfo1"/> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>lintstring</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>src_thrift</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="ListTypeInfo0"/> 
+                  </void> 
+                 </object> 
                 </void> 
                 <void method="add"> 
-                 <object idref="ColumnInfo2"/> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>mstringstring</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>src_thrift</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="MapTypeInfo0"/> 
+                  </void> 
+                 </object> 
                 </void> 
                 <void method="add"> 
                  <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
@@ -928,16 +791,16 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_312_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_307_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_312_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_307_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_312_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_307_TIME_TAKEN</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_312_FATAL_ERROR</string> 
+           <string>CNTR_NAME_TS_307_FATAL_ERROR</string> 
           </void> 
          </object> 
         </void> 
@@ -955,7 +818,7 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_312</string> 
+         <string>TS_307</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -974,7 +837,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src_thrift</string> 
+       <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src_thrift</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>src_thrift</string> 
@@ -986,7 +849,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src_thrift</string> 
+       <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src_thrift</string> 
        <object class="org.apache.hadoop.hive.ql.plan.PartitionDesc"> 
         <void property="baseFileName"> 
          <string>src_thrift</string> 
@@ -1047,11 +910,11 @@
           </void> 
           <void method="put"> 
            <string>location</string> 
-           <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src_thrift</string> 
+           <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src_thrift</string> 
           </void> 
           <void method="put"> 
            <string>transient_lastDdlTime</string> 
-           <string>1304060151</string> 
+           <string>1310382339</string> 
           </void> 
          </object> 
         </void> 
@@ -1113,11 +976,11 @@
             </void> 
             <void method="put"> 
              <string>location</string> 
-             <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src_thrift</string> 
+             <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src_thrift</string> 
             </void> 
             <void method="put"> 
              <string>transient_lastDdlTime</string> 
-             <string>1304060151</string> 
+             <string>1310382339</string> 
             </void> 
            </object> 
           </void> 
diff --git a/ql/src/test/results/compiler/plan/join1.q.xml b/ql/src/test/results/compiler/plan/join1.q.xml
index a1424f5f7a..1e905ed425 100644
--- a/ql/src/test/results/compiler/plan/join1.q.xml
+++ b/ql/src/test/results/compiler/plan/join1.q.xml
@@ -555,21 +555,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_RS_325_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_RS_319_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_RS_325_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_RS_319_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_RS_325_TIME_TAKEN</string> 
+               <string>CNTR_NAME_RS_319_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_RS_325_FATAL_ERROR</string> 
+               <string>CNTR_NAME_RS_319_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>RS_325</string> 
+             <string>RS_319</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -616,16 +616,16 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_322_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_316_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_322_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_316_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_322_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_316_TIME_TAKEN</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_322_FATAL_ERROR</string> 
+           <string>CNTR_NAME_TS_316_FATAL_ERROR</string> 
           </void> 
          </object> 
         </void> 
@@ -640,7 +640,7 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_322</string> 
+         <string>TS_316</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -854,21 +854,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_RS_324_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_RS_318_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_RS_324_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_RS_318_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_RS_324_TIME_TAKEN</string> 
+               <string>CNTR_NAME_RS_318_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_RS_324_FATAL_ERROR</string> 
+               <string>CNTR_NAME_RS_318_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>RS_324</string> 
+             <string>RS_318</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -915,16 +915,16 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_323_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_317_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_323_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_317_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_323_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_317_TIME_TAKEN</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_323_FATAL_ERROR</string> 
+           <string>CNTR_NAME_TS_317_FATAL_ERROR</string> 
           </void> 
          </object> 
         </void> 
@@ -936,7 +936,7 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_323</string> 
+         <string>TS_317</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -1215,21 +1215,21 @@
               <void property="counterNames"> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>CNTR_NAME_FS_328_NUM_INPUT_ROWS</string> 
+                 <string>CNTR_NAME_FS_322_NUM_INPUT_ROWS</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_FS_328_NUM_OUTPUT_ROWS</string> 
+                 <string>CNTR_NAME_FS_322_NUM_OUTPUT_ROWS</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_FS_328_TIME_TAKEN</string> 
+                 <string>CNTR_NAME_FS_322_TIME_TAKEN</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_FS_328_FATAL_ERROR</string> 
+                 <string>CNTR_NAME_FS_322_FATAL_ERROR</string> 
                 </void> 
                </object> 
               </void> 
               <void property="operatorId"> 
-               <string>FS_328</string> 
+               <string>FS_322</string> 
               </void> 
               <void property="parentOperators"> 
                <object class="java.util.ArrayList"> 
@@ -1335,21 +1335,21 @@
           <void property="counterNames"> 
            <object class="java.util.ArrayList"> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_327_NUM_INPUT_ROWS</string> 
+             <string>CNTR_NAME_SEL_321_NUM_INPUT_ROWS</string> 
             </void> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_327_NUM_OUTPUT_ROWS</string> 
+             <string>CNTR_NAME_SEL_321_NUM_OUTPUT_ROWS</string> 
             </void> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_327_TIME_TAKEN</string> 
+             <string>CNTR_NAME_SEL_321_TIME_TAKEN</string> 
             </void> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_327_FATAL_ERROR</string> 
+             <string>CNTR_NAME_SEL_321_FATAL_ERROR</string> 
             </void> 
            </object> 
           </void> 
           <void property="operatorId"> 
-           <string>SEL_327</string> 
+           <string>SEL_321</string> 
           </void> 
           <void property="parentOperators"> 
            <object class="java.util.ArrayList"> 
@@ -1537,21 +1537,21 @@
       <void property="counterNames"> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
-         <string>CNTR_NAME_JOIN_326_NUM_INPUT_ROWS</string> 
+         <string>CNTR_NAME_JOIN_320_NUM_INPUT_ROWS</string> 
         </void> 
         <void method="add"> 
-         <string>CNTR_NAME_JOIN_326_NUM_OUTPUT_ROWS</string> 
+         <string>CNTR_NAME_JOIN_320_NUM_OUTPUT_ROWS</string> 
         </void> 
         <void method="add"> 
-         <string>CNTR_NAME_JOIN_326_TIME_TAKEN</string> 
+         <string>CNTR_NAME_JOIN_320_TIME_TAKEN</string> 
         </void> 
         <void method="add"> 
-         <string>CNTR_NAME_JOIN_326_FATAL_ERROR</string> 
+         <string>CNTR_NAME_JOIN_320_FATAL_ERROR</string> 
         </void> 
        </object> 
       </void> 
       <void property="operatorId"> 
-       <string>JOIN_326</string> 
+       <string>JOIN_320</string> 
       </void> 
       <void property="parentOperators"> 
        <object class="java.util.ArrayList"> 
diff --git a/ql/src/test/results/compiler/plan/join2.q.xml b/ql/src/test/results/compiler/plan/join2.q.xml
index da824e8b92..75b43ad6d5 100644
--- a/ql/src/test/results/compiler/plan/join2.q.xml
+++ b/ql/src/test/results/compiler/plan/join2.q.xml
@@ -472,21 +472,21 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_RS_342_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_RS_336_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_RS_342_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_RS_336_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_RS_342_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_RS_336_TIME_TAKEN</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_RS_342_FATAL_ERROR</string> 
+                   <string>CNTR_NAME_RS_336_FATAL_ERROR</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>RS_342</string> 
+                 <string>RS_336</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -523,21 +523,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_TS_348_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_TS_342_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_TS_348_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_TS_342_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_TS_348_TIME_TAKEN</string> 
+               <string>CNTR_NAME_TS_342_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_TS_348_FATAL_ERROR</string> 
+               <string>CNTR_NAME_TS_342_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>TS_348</string> 
+             <string>TS_342</string> 
             </void> 
             <void property="schema"> 
              <object id="RowSchema0" class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -739,21 +739,21 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_RS_343_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_RS_337_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_RS_343_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_RS_337_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_RS_343_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_RS_337_TIME_TAKEN</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_RS_343_FATAL_ERROR</string> 
+                   <string>CNTR_NAME_RS_337_FATAL_ERROR</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>RS_343</string> 
+                 <string>RS_337</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -800,16 +800,16 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_TS_337_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_TS_331_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_TS_337_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_TS_331_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_TS_337_TIME_TAKEN</string> 
+               <string>CNTR_NAME_TS_331_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_TS_337_FATAL_ERROR</string> 
+               <string>CNTR_NAME_TS_331_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
@@ -824,7 +824,7 @@
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>TS_337</string> 
+             <string>TS_331</string> 
             </void> 
             <void property="schema"> 
              <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -1161,21 +1161,21 @@
                   <void property="counterNames"> 
                    <object class="java.util.ArrayList"> 
                     <void method="add"> 
-                     <string>CNTR_NAME_FS_346_NUM_INPUT_ROWS</string> 
+                     <string>CNTR_NAME_FS_340_NUM_INPUT_ROWS</string> 
                     </void> 
                     <void method="add"> 
-                     <string>CNTR_NAME_FS_346_NUM_OUTPUT_ROWS</string> 
+                     <string>CNTR_NAME_FS_340_NUM_OUTPUT_ROWS</string> 
                     </void> 
                     <void method="add"> 
-                     <string>CNTR_NAME_FS_346_TIME_TAKEN</string> 
+                     <string>CNTR_NAME_FS_340_TIME_TAKEN</string> 
                     </void> 
                     <void method="add"> 
-                     <string>CNTR_NAME_FS_346_FATAL_ERROR</string> 
+                     <string>CNTR_NAME_FS_340_FATAL_ERROR</string> 
                     </void> 
                    </object> 
                   </void> 
                   <void property="operatorId"> 
-                   <string>FS_346</string> 
+                   <string>FS_340</string> 
                   </void> 
                   <void property="parentOperators"> 
                    <object class="java.util.ArrayList"> 
@@ -1281,21 +1281,21 @@
               <void property="counterNames"> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>CNTR_NAME_SEL_345_NUM_INPUT_ROWS</string> 
+                 <string>CNTR_NAME_SEL_339_NUM_INPUT_ROWS</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_SEL_345_NUM_OUTPUT_ROWS</string> 
+                 <string>CNTR_NAME_SEL_339_NUM_OUTPUT_ROWS</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_SEL_345_TIME_TAKEN</string> 
+                 <string>CNTR_NAME_SEL_339_TIME_TAKEN</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_SEL_345_FATAL_ERROR</string> 
+                 <string>CNTR_NAME_SEL_339_FATAL_ERROR</string> 
                 </void> 
                </object> 
               </void> 
               <void property="operatorId"> 
-               <string>SEL_345</string> 
+               <string>SEL_339</string> 
               </void> 
               <void property="parentOperators"> 
                <object class="java.util.ArrayList"> 
@@ -1499,21 +1499,21 @@
           <void property="counterNames"> 
            <object class="java.util.ArrayList"> 
             <void method="add"> 
-             <string>CNTR_NAME_JOIN_344_NUM_INPUT_ROWS</string> 
+             <string>CNTR_NAME_JOIN_338_NUM_INPUT_ROWS</string> 
             </void> 
             <void method="add"> 
-             <string>CNTR_NAME_JOIN_344_NUM_OUTPUT_ROWS</string> 
+             <string>CNTR_NAME_JOIN_338_NUM_OUTPUT_ROWS</string> 
             </void> 
             <void method="add"> 
-             <string>CNTR_NAME_JOIN_344_TIME_TAKEN</string> 
+             <string>CNTR_NAME_JOIN_338_TIME_TAKEN</string> 
             </void> 
             <void method="add"> 
-             <string>CNTR_NAME_JOIN_344_FATAL_ERROR</string> 
+             <string>CNTR_NAME_JOIN_338_FATAL_ERROR</string> 
             </void> 
            </object> 
           </void> 
           <void property="operatorId"> 
-           <string>JOIN_344</string> 
+           <string>JOIN_338</string> 
           </void> 
           <void property="parentOperators"> 
            <object class="java.util.ArrayList"> 
@@ -2016,21 +2016,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_RS_340_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_RS_334_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_RS_340_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_RS_334_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_RS_340_TIME_TAKEN</string> 
+               <string>CNTR_NAME_RS_334_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_RS_340_FATAL_ERROR</string> 
+               <string>CNTR_NAME_RS_334_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>RS_340</string> 
+             <string>RS_334</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -2077,16 +2077,16 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_336_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_330_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_336_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_330_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_336_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_330_TIME_TAKEN</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_336_FATAL_ERROR</string> 
+           <string>CNTR_NAME_TS_330_FATAL_ERROR</string> 
           </void> 
          </object> 
         </void> 
@@ -2098,7 +2098,7 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_336</string> 
+         <string>TS_330</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -2308,21 +2308,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_RS_339_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_RS_333_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_RS_339_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_RS_333_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_RS_339_TIME_TAKEN</string> 
+               <string>CNTR_NAME_RS_333_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_RS_339_FATAL_ERROR</string> 
+               <string>CNTR_NAME_RS_333_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>RS_339</string> 
+             <string>RS_333</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -2369,16 +2369,16 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_338_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_332_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_338_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_332_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_338_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_332_TIME_TAKEN</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_338_FATAL_ERROR</string> 
+           <string>CNTR_NAME_TS_332_FATAL_ERROR</string> 
           </void> 
          </object> 
         </void> 
@@ -2390,7 +2390,7 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_338</string> 
+         <string>TS_332</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -2653,21 +2653,21 @@
           <void property="counterNames"> 
            <object class="java.util.ArrayList"> 
             <void method="add"> 
-             <string>CNTR_NAME_FS_347_NUM_INPUT_ROWS</string> 
+             <string>CNTR_NAME_FS_341_NUM_INPUT_ROWS</string> 
             </void> 
             <void method="add"> 
-             <string>CNTR_NAME_FS_347_NUM_OUTPUT_ROWS</string> 
+             <string>CNTR_NAME_FS_341_NUM_OUTPUT_ROWS</string> 
             </void> 
             <void method="add"> 
-             <string>CNTR_NAME_FS_347_TIME_TAKEN</string> 
+             <string>CNTR_NAME_FS_341_TIME_TAKEN</string> 
             </void> 
             <void method="add"> 
-             <string>CNTR_NAME_FS_347_FATAL_ERROR</string> 
+             <string>CNTR_NAME_FS_341_FATAL_ERROR</string> 
             </void> 
            </object> 
           </void> 
           <void property="operatorId"> 
-           <string>FS_347</string> 
+           <string>FS_341</string> 
           </void> 
           <void property="parentOperators"> 
            <object class="java.util.ArrayList"> 
@@ -2824,21 +2824,21 @@
       <void property="counterNames"> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
-         <string>CNTR_NAME_JOIN_341_NUM_INPUT_ROWS</string> 
+         <string>CNTR_NAME_JOIN_335_NUM_INPUT_ROWS</string> 
         </void> 
         <void method="add"> 
-         <string>CNTR_NAME_JOIN_341_NUM_OUTPUT_ROWS</string> 
+         <string>CNTR_NAME_JOIN_335_NUM_OUTPUT_ROWS</string> 
         </void> 
         <void method="add"> 
-         <string>CNTR_NAME_JOIN_341_TIME_TAKEN</string> 
+         <string>CNTR_NAME_JOIN_335_TIME_TAKEN</string> 
         </void> 
         <void method="add"> 
-         <string>CNTR_NAME_JOIN_341_FATAL_ERROR</string> 
+         <string>CNTR_NAME_JOIN_335_FATAL_ERROR</string> 
         </void> 
        </object> 
       </void> 
       <void property="operatorId"> 
-       <string>JOIN_341</string> 
+       <string>JOIN_335</string> 
       </void> 
       <void property="parentOperators"> 
        <object class="java.util.ArrayList"> 
diff --git a/ql/src/test/results/compiler/plan/join3.q.xml b/ql/src/test/results/compiler/plan/join3.q.xml
index af97eeb5c7..a927f07977 100644
--- a/ql/src/test/results/compiler/plan/join3.q.xml
+++ b/ql/src/test/results/compiler/plan/join3.q.xml
@@ -664,21 +664,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_RS_366_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_RS_360_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_RS_366_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_RS_360_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_RS_366_TIME_TAKEN</string> 
+               <string>CNTR_NAME_RS_360_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_RS_366_FATAL_ERROR</string> 
+               <string>CNTR_NAME_RS_360_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>RS_366</string> 
+             <string>RS_360</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -711,16 +711,16 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_362_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_356_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_362_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_356_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_362_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_356_TIME_TAKEN</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_362_FATAL_ERROR</string> 
+           <string>CNTR_NAME_TS_356_FATAL_ERROR</string> 
           </void> 
          </object> 
         </void> 
@@ -732,7 +732,7 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_362</string> 
+         <string>TS_356</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -949,21 +949,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_RS_367_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_RS_361_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_RS_367_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_RS_361_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_RS_367_TIME_TAKEN</string> 
+               <string>CNTR_NAME_RS_361_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_RS_367_FATAL_ERROR</string> 
+               <string>CNTR_NAME_RS_361_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>RS_367</string> 
+             <string>RS_361</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -1010,16 +1010,16 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_363_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_357_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_363_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_357_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_363_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_357_TIME_TAKEN</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_363_FATAL_ERROR</string> 
+           <string>CNTR_NAME_TS_357_FATAL_ERROR</string> 
           </void> 
          </object> 
         </void> 
@@ -1034,7 +1034,7 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_363</string> 
+         <string>TS_357</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -1244,21 +1244,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_RS_365_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_RS_359_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_RS_365_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_RS_359_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_RS_365_TIME_TAKEN</string> 
+               <string>CNTR_NAME_RS_359_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_RS_365_FATAL_ERROR</string> 
+               <string>CNTR_NAME_RS_359_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>RS_365</string> 
+             <string>RS_359</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -1305,16 +1305,16 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_364_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_358_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_364_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_358_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_364_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_358_TIME_TAKEN</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_364_FATAL_ERROR</string> 
+           <string>CNTR_NAME_TS_358_FATAL_ERROR</string> 
           </void> 
          </object> 
         </void> 
@@ -1326,7 +1326,7 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_364</string> 
+         <string>TS_358</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -1608,21 +1608,21 @@
               <void property="counterNames"> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>CNTR_NAME_FS_370_NUM_INPUT_ROWS</string> 
+                 <string>CNTR_NAME_FS_364_NUM_INPUT_ROWS</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_FS_370_NUM_OUTPUT_ROWS</string> 
+                 <string>CNTR_NAME_FS_364_NUM_OUTPUT_ROWS</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_FS_370_TIME_TAKEN</string> 
+                 <string>CNTR_NAME_FS_364_TIME_TAKEN</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_FS_370_FATAL_ERROR</string> 
+                 <string>CNTR_NAME_FS_364_FATAL_ERROR</string> 
                 </void> 
                </object> 
               </void> 
               <void property="operatorId"> 
-               <string>FS_370</string> 
+               <string>FS_364</string> 
               </void> 
               <void property="parentOperators"> 
                <object class="java.util.ArrayList"> 
@@ -1728,21 +1728,21 @@
           <void property="counterNames"> 
            <object class="java.util.ArrayList"> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_369_NUM_INPUT_ROWS</string> 
+             <string>CNTR_NAME_SEL_363_NUM_INPUT_ROWS</string> 
             </void> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_369_NUM_OUTPUT_ROWS</string> 
+             <string>CNTR_NAME_SEL_363_NUM_OUTPUT_ROWS</string> 
             </void> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_369_TIME_TAKEN</string> 
+             <string>CNTR_NAME_SEL_363_TIME_TAKEN</string> 
             </void> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_369_FATAL_ERROR</string> 
+             <string>CNTR_NAME_SEL_363_FATAL_ERROR</string> 
             </void> 
            </object> 
           </void> 
           <void property="operatorId"> 
-           <string>SEL_369</string> 
+           <string>SEL_363</string> 
           </void> 
           <void property="parentOperators"> 
            <object class="java.util.ArrayList"> 
@@ -1964,21 +1964,21 @@
       <void property="counterNames"> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
-         <string>CNTR_NAME_JOIN_368_NUM_INPUT_ROWS</string> 
+         <string>CNTR_NAME_JOIN_362_NUM_INPUT_ROWS</string> 
         </void> 
         <void method="add"> 
-         <string>CNTR_NAME_JOIN_368_NUM_OUTPUT_ROWS</string> 
+         <string>CNTR_NAME_JOIN_362_NUM_OUTPUT_ROWS</string> 
         </void> 
         <void method="add"> 
-         <string>CNTR_NAME_JOIN_368_TIME_TAKEN</string> 
+         <string>CNTR_NAME_JOIN_362_TIME_TAKEN</string> 
         </void> 
         <void method="add"> 
-         <string>CNTR_NAME_JOIN_368_FATAL_ERROR</string> 
+         <string>CNTR_NAME_JOIN_362_FATAL_ERROR</string> 
         </void> 
        </object> 
       </void> 
       <void property="operatorId"> 
-       <string>JOIN_368</string> 
+       <string>JOIN_362</string> 
       </void> 
       <void property="parentOperators"> 
        <object class="java.util.ArrayList"> 
diff --git a/ql/src/test/results/compiler/plan/join4.q.xml b/ql/src/test/results/compiler/plan/join4.q.xml
index 934b5571c0..cb23c83b88 100644
--- a/ql/src/test/results/compiler/plan/join4.q.xml
+++ b/ql/src/test/results/compiler/plan/join4.q.xml
@@ -284,248 +284,33 @@
             <void property="childOperators"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+               <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                    <void property="childOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object id="ReduceSinkOperator0" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
-                        <void property="columnExprMap"> 
-                         <object class="java.util.HashMap"> 
-                          <void method="put"> 
-                           <string>VALUE._col1</string> 
-                           <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>_col1</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                              <void property="typeName"> 
-                               <string>string</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="put"> 
-                           <string>VALUE._col0</string> 
-                           <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>_col0</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="conf"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
-                          <void property="distinctColumnIndices"> 
-                           <object class="java.util.ArrayList"/> 
-                          </void> 
-                          <void property="keyCols"> 
-                           <object id="ArrayList0" class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                              <void property="column"> 
-                               <string>_col0</string> 
-                              </void> 
-                              <void property="typeInfo"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="keySerializeInfo"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                            <void property="deserializerClass"> 
-                             <class>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</class> 
-                            </void> 
-                            <void property="inputFileFormatClass"> 
-                             <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                            </void> 
-                            <void property="outputFileFormatClass"> 
-                             <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                            </void> 
-                            <void property="properties"> 
-                             <object class="java.util.Properties"> 
-                              <void method="put"> 
-                               <string>columns</string> 
-                               <string>joinkey0</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>serialization.sort.order</string> 
-                               <string>+</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>columns.types</string> 
-                               <string>string</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="numDistributionKeys"> 
-                           <int>1</int> 
-                          </void> 
-                          <void property="numReducers"> 
-                           <int>-1</int> 
-                          </void> 
-                          <void property="outputKeyColumnNames"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <string>reducesinkkey0</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="outputValueColumnNames"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <string>_col0</string> 
-                            </void> 
-                            <void method="add"> 
-                             <string>_col1</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="partitionCols"> 
-                           <object idref="ArrayList0"/> 
-                          </void> 
-                          <void property="valueCols"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object idref="ExprNodeColumnDesc1"/> 
-                            </void> 
-                            <void method="add"> 
-                             <object idref="ExprNodeColumnDesc0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="valueSerializeInfo"> 
-                           <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                            <void property="deserializerClass"> 
-                             <class>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</class> 
-                            </void> 
-                            <void property="inputFileFormatClass"> 
-                             <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                            </void> 
-                            <void property="outputFileFormatClass"> 
-                             <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                            </void> 
-                            <void property="properties"> 
-                             <object class="java.util.Properties"> 
-                              <void method="put"> 
-                               <string>columns</string> 
-                               <string>_col0,_col1</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>columns.types</string> 
-                               <string>string,string</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>escape.delim</string> 
-                               <string>\</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="counterNames"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_RS_386_NUM_INPUT_ROWS</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_RS_386_NUM_OUTPUT_ROWS</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_RS_386_TIME_TAKEN</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_RS_386_FATAL_ERROR</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="operatorId"> 
-                         <string>RS_386</string> 
-                        </void> 
-                        <void property="parentOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object idref="SelectOperator0"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="schema"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                          <void property="signature"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>VALUE._col0</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string>a</string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>VALUE._col1</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string>a</string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
+                   <object id="ReduceSinkOperator0" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
                     <void property="columnExprMap"> 
                      <object class="java.util.HashMap"> 
                       <void method="put"> 
-                       <string>_col1</string> 
-                       <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <string>VALUE._col1</string> 
+                       <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
                         <void property="column"> 
-                         <string>value</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src1</string> 
+                         <string>_col1</string> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
+                         <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
+                         </object> 
                         </void> 
                        </object> 
                       </void> 
                       <void method="put"> 
-                       <string>_col0</string> 
-                       <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <string>VALUE._col0</string> 
+                       <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
                         <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src1</string> 
+                         <string>_col0</string> 
                         </void> 
                         <void property="typeInfo"> 
                          <object idref="PrimitiveTypeInfo0"/> 
@@ -535,18 +320,67 @@
                      </object> 
                     </void> 
                     <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                      <void property="colList"> 
-                       <object class="java.util.ArrayList"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
+                      <void property="distinctColumnIndices"> 
+                       <object class="java.util.ArrayList"/> 
+                      </void> 
+                      <void property="keyCols"> 
+                       <object id="ArrayList0" class="java.util.ArrayList"> 
                         <void method="add"> 
-                         <object idref="ExprNodeColumnDesc3"/> 
+                         <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                          <void property="column"> 
+                           <string>_col0</string> 
+                          </void> 
+                          <void property="typeInfo"> 
+                           <object idref="PrimitiveTypeInfo0"/> 
+                          </void> 
+                         </object> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="keySerializeInfo"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                        <void property="deserializerClass"> 
+                         <class>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</class> 
+                        </void> 
+                        <void property="inputFileFormatClass"> 
+                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                        </void> 
+                        <void property="outputFileFormatClass"> 
+                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                        </void> 
+                        <void property="properties"> 
+                         <object class="java.util.Properties"> 
+                          <void method="put"> 
+                           <string>columns</string> 
+                           <string>joinkey0</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>serialization.sort.order</string> 
+                           <string>+</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>columns.types</string> 
+                           <string>string</string> 
+                          </void> 
+                         </object> 
                         </void> 
+                       </object> 
+                      </void> 
+                      <void property="numDistributionKeys"> 
+                       <int>1</int> 
+                      </void> 
+                      <void property="numReducers"> 
+                       <int>-1</int> 
+                      </void> 
+                      <void property="outputKeyColumnNames"> 
+                       <object class="java.util.ArrayList"> 
                         <void method="add"> 
-                         <object idref="ExprNodeColumnDesc2"/> 
+                         <string>reducesinkkey0</string> 
                         </void> 
                        </object> 
                       </void> 
-                      <void property="outputColumnNames"> 
+                      <void property="outputValueColumnNames"> 
                        <object class="java.util.ArrayList"> 
                         <void method="add"> 
                          <string>_col0</string> 
@@ -556,31 +390,73 @@
                         </void> 
                        </object> 
                       </void> 
+                      <void property="partitionCols"> 
+                       <object idref="ArrayList0"/> 
+                      </void> 
+                      <void property="valueCols"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <object idref="ExprNodeColumnDesc1"/> 
+                        </void> 
+                        <void method="add"> 
+                         <object idref="ExprNodeColumnDesc0"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="valueSerializeInfo"> 
+                       <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                        <void property="deserializerClass"> 
+                         <class>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</class> 
+                        </void> 
+                        <void property="inputFileFormatClass"> 
+                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                        </void> 
+                        <void property="outputFileFormatClass"> 
+                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                        </void> 
+                        <void property="properties"> 
+                         <object class="java.util.Properties"> 
+                          <void method="put"> 
+                           <string>columns</string> 
+                           <string>_col0,_col1</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>columns.types</string> 
+                           <string>string,string</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>escape.delim</string> 
+                           <string>\</string> 
+                          </void> 
+                         </object> 
+                        </void> 
+                       </object> 
+                      </void> 
                      </object> 
                     </void> 
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_385_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_RS_380_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_385_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_RS_380_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_385_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_RS_380_TIME_TAKEN</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_385_FATAL_ERROR</string> 
+                       <string>CNTR_NAME_RS_380_FATAL_ERROR</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>SEL_385</string> 
+                     <string>RS_380</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object idref="FilterOperator1"/> 
+                       <object idref="SelectOperator0"/> 
                       </void> 
                      </object> 
                     </void> 
@@ -591,7 +467,10 @@
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                           <void property="internalName"> 
-                           <string>_col0</string> 
+                           <string>VALUE._col0</string> 
+                          </void> 
+                          <void property="tabAlias"> 
+                           <string>a</string> 
                           </void> 
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
@@ -601,7 +480,10 @@
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                           <void property="internalName"> 
-                           <string>_col1</string> 
+                           <string>VALUE._col1</string> 
+                          </void> 
+                          <void property="tabAlias"> 
+                           <string>a</string> 
                           </void> 
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
@@ -616,101 +498,57 @@
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-                  <void property="predicate"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="childExprs"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>key</string> 
-                            </void> 
-                            <void property="tabAlias"> 
-                             <string>src1</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                              <void property="typeName"> 
-                               <string>int</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="value"> 
-                             <int>10</int> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan"/> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>boolean</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>key</string> 
-                            </void> 
-                            <void property="tabAlias"> 
-                             <string>src1</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <int>20</int> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo2"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                <void property="columnExprMap"> 
+                 <object class="java.util.HashMap"> 
+                  <void method="put"> 
+                   <string>_col1</string> 
+                   <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>value</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd"/> 
+                    <void property="tabAlias"> 
+                     <string>src1</string> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="put"> 
+                   <string>_col0</string> 
+                   <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>key</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string>src1</string> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="conf"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                  <void property="colList"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object idref="ExprNodeColumnDesc3"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="ExprNodeColumnDesc2"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void property="outputColumnNames"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <string>_col0</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col1</string> 
                     </void> 
                    </object> 
                   </void> 
@@ -719,21 +557,21 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_384_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_379_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_384_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_379_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_384_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_SEL_379_TIME_TAKEN</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_384_FATAL_ERROR</string> 
+                   <string>CNTR_NAME_SEL_379_FATAL_ERROR</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>FIL_384</string> 
+                 <string>SEL_379</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -747,12 +585,9 @@
                   <void property="signature"> 
                    <object class="java.util.ArrayList"> 
                     <void method="add"> 
-                     <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                       <void property="internalName"> 
-                       <string>key</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>src1</string> 
+                       <string>_col0</string> 
                       </void> 
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
@@ -760,12 +595,9 @@
                      </object> 
                     </void> 
                     <void method="add"> 
-                     <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                       <void property="internalName"> 
-                       <string>value</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>src1</string> 
+                       <string>_col1</string> 
                       </void> 
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
@@ -806,7 +638,11 @@
                       <void method="add"> 
                        <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
+                         <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                          <void property="typeName"> 
+                           <string>int</string> 
+                          </void> 
+                         </object> 
                         </void> 
                         <void property="value"> 
                          <int>10</int> 
@@ -819,7 +655,11 @@
                      <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan"/> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                     <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                      <void property="typeName"> 
+                       <string>boolean</string> 
+                      </void> 
+                     </object> 
                     </void> 
                    </object> 
                   </void> 
@@ -875,21 +715,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_392_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_386_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_392_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_386_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_392_TIME_TAKEN</string> 
+               <string>CNTR_NAME_FIL_386_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_392_FATAL_ERROR</string> 
+               <string>CNTR_NAME_FIL_386_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>FIL_392</string> 
+             <string>FIL_386</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -903,10 +743,30 @@
               <void property="signature"> 
                <object id="ArrayList1" class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <object idref="ColumnInfo0"/> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>key</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>src1</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
                 </void> 
                 <void method="add"> 
-                 <object idref="ColumnInfo1"/> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>value</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>src1</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
                 </void> 
                 <void method="add"> 
                  <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
@@ -965,16 +825,16 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_383_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_377_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_383_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_377_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_383_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_377_TIME_TAKEN</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_383_FATAL_ERROR</string> 
+           <string>CNTR_NAME_TS_377_FATAL_ERROR</string> 
           </void> 
          </object> 
         </void> 
@@ -989,7 +849,7 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_383</string> 
+         <string>TS_377</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -1006,237 +866,22 @@
         <void property="childOperators"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <object id="FilterOperator2" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+           <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
             <void property="childOperators"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <object id="FilterOperator3" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+               <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                    <void property="childOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object id="ReduceSinkOperator1" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
-                        <void property="columnExprMap"> 
-                         <object class="java.util.HashMap"> 
-                          <void method="put"> 
-                           <string>VALUE._col1</string> 
-                           <object id="ExprNodeColumnDesc4" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>_col1</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="put"> 
-                           <string>VALUE._col0</string> 
-                           <object id="ExprNodeColumnDesc5" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>_col0</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="conf"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
-                          <void property="distinctColumnIndices"> 
-                           <object class="java.util.ArrayList"/> 
-                          </void> 
-                          <void property="keyCols"> 
-                           <object id="ArrayList2" class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                              <void property="column"> 
-                               <string>_col0</string> 
-                              </void> 
-                              <void property="typeInfo"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="keySerializeInfo"> 
-                           <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                            <void property="deserializerClass"> 
-                             <class>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</class> 
-                            </void> 
-                            <void property="inputFileFormatClass"> 
-                             <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                            </void> 
-                            <void property="outputFileFormatClass"> 
-                             <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                            </void> 
-                            <void property="properties"> 
-                             <object class="java.util.Properties"> 
-                              <void method="put"> 
-                               <string>columns</string> 
-                               <string>joinkey0</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>serialization.sort.order</string> 
-                               <string>+</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>columns.types</string> 
-                               <string>string</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="numDistributionKeys"> 
-                           <int>1</int> 
-                          </void> 
-                          <void property="numReducers"> 
-                           <int>-1</int> 
-                          </void> 
-                          <void property="outputKeyColumnNames"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <string>reducesinkkey0</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="outputValueColumnNames"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <string>_col0</string> 
-                            </void> 
-                            <void method="add"> 
-                             <string>_col1</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="partitionCols"> 
-                           <object idref="ArrayList2"/> 
-                          </void> 
-                          <void property="tag"> 
-                           <int>1</int> 
-                          </void> 
-                          <void property="valueCols"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object idref="ExprNodeColumnDesc5"/> 
-                            </void> 
-                            <void method="add"> 
-                             <object idref="ExprNodeColumnDesc4"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="valueSerializeInfo"> 
-                           <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                            <void property="deserializerClass"> 
-                             <class>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</class> 
-                            </void> 
-                            <void property="inputFileFormatClass"> 
-                             <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                            </void> 
-                            <void property="outputFileFormatClass"> 
-                             <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                            </void> 
-                            <void property="properties"> 
-                             <object class="java.util.Properties"> 
-                              <void method="put"> 
-                               <string>columns</string> 
-                               <string>_col0,_col1</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>columns.types</string> 
-                               <string>string,string</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>escape.delim</string> 
-                               <string>\</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="counterNames"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_RS_387_NUM_INPUT_ROWS</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_RS_387_NUM_OUTPUT_ROWS</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_RS_387_TIME_TAKEN</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_RS_387_FATAL_ERROR</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="operatorId"> 
-                         <string>RS_387</string> 
-                        </void> 
-                        <void property="parentOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object idref="SelectOperator1"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="schema"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                          <void property="signature"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>VALUE._col0</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string>b</string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>VALUE._col1</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string>b</string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
+                   <object id="ReduceSinkOperator1" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
                     <void property="columnExprMap"> 
                      <object class="java.util.HashMap"> 
                       <void method="put"> 
-                       <string>_col1</string> 
-                       <object id="ExprNodeColumnDesc6" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <string>VALUE._col1</string> 
+                       <object id="ExprNodeColumnDesc4" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
                         <void property="column"> 
-                         <string>value</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src2</string> 
+                         <string>_col1</string> 
                         </void> 
                         <void property="typeInfo"> 
                          <object idref="PrimitiveTypeInfo0"/> 
@@ -1244,13 +889,10 @@
                        </object> 
                       </void> 
                       <void method="put"> 
-                       <string>_col0</string> 
-                       <object id="ExprNodeColumnDesc7" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <string>VALUE._col0</string> 
+                       <object id="ExprNodeColumnDesc5" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
                         <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src2</string> 
+                         <string>_col0</string> 
                         </void> 
                         <void property="typeInfo"> 
                          <object idref="PrimitiveTypeInfo0"/> 
@@ -1260,18 +902,67 @@
                      </object> 
                     </void> 
                     <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                      <void property="colList"> 
-                       <object class="java.util.ArrayList"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
+                      <void property="distinctColumnIndices"> 
+                       <object class="java.util.ArrayList"/> 
+                      </void> 
+                      <void property="keyCols"> 
+                       <object id="ArrayList2" class="java.util.ArrayList"> 
                         <void method="add"> 
-                         <object idref="ExprNodeColumnDesc7"/> 
+                         <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                          <void property="column"> 
+                           <string>_col0</string> 
+                          </void> 
+                          <void property="typeInfo"> 
+                           <object idref="PrimitiveTypeInfo0"/> 
+                          </void> 
+                         </object> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="keySerializeInfo"> 
+                       <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                        <void property="deserializerClass"> 
+                         <class>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</class> 
+                        </void> 
+                        <void property="inputFileFormatClass"> 
+                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                        </void> 
+                        <void property="outputFileFormatClass"> 
+                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                        </void> 
+                        <void property="properties"> 
+                         <object class="java.util.Properties"> 
+                          <void method="put"> 
+                           <string>columns</string> 
+                           <string>joinkey0</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>serialization.sort.order</string> 
+                           <string>+</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>columns.types</string> 
+                           <string>string</string> 
+                          </void> 
+                         </object> 
                         </void> 
+                       </object> 
+                      </void> 
+                      <void property="numDistributionKeys"> 
+                       <int>1</int> 
+                      </void> 
+                      <void property="numReducers"> 
+                       <int>-1</int> 
+                      </void> 
+                      <void property="outputKeyColumnNames"> 
+                       <object class="java.util.ArrayList"> 
                         <void method="add"> 
-                         <object idref="ExprNodeColumnDesc6"/> 
+                         <string>reducesinkkey0</string> 
                         </void> 
                        </object> 
                       </void> 
-                      <void property="outputColumnNames"> 
+                      <void property="outputValueColumnNames"> 
                        <object class="java.util.ArrayList"> 
                         <void method="add"> 
                          <string>_col0</string> 
@@ -1281,31 +972,76 @@
                         </void> 
                        </object> 
                       </void> 
+                      <void property="partitionCols"> 
+                       <object idref="ArrayList2"/> 
+                      </void> 
+                      <void property="tag"> 
+                       <int>1</int> 
+                      </void> 
+                      <void property="valueCols"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <object idref="ExprNodeColumnDesc5"/> 
+                        </void> 
+                        <void method="add"> 
+                         <object idref="ExprNodeColumnDesc4"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="valueSerializeInfo"> 
+                       <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                        <void property="deserializerClass"> 
+                         <class>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</class> 
+                        </void> 
+                        <void property="inputFileFormatClass"> 
+                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                        </void> 
+                        <void property="outputFileFormatClass"> 
+                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                        </void> 
+                        <void property="properties"> 
+                         <object class="java.util.Properties"> 
+                          <void method="put"> 
+                           <string>columns</string> 
+                           <string>_col0,_col1</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>columns.types</string> 
+                           <string>string,string</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>escape.delim</string> 
+                           <string>\</string> 
+                          </void> 
+                         </object> 
+                        </void> 
+                       </object> 
+                      </void> 
                      </object> 
                     </void> 
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_382_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_RS_381_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_382_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_RS_381_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_382_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_RS_381_TIME_TAKEN</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_382_FATAL_ERROR</string> 
+                       <string>CNTR_NAME_RS_381_FATAL_ERROR</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>SEL_382</string> 
+                     <string>RS_381</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object idref="FilterOperator3"/> 
+                       <object idref="SelectOperator1"/> 
                       </void> 
                      </object> 
                     </void> 
@@ -1316,7 +1052,10 @@
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                           <void property="internalName"> 
-                           <string>_col0</string> 
+                           <string>VALUE._col0</string> 
+                          </void> 
+                          <void property="tabAlias"> 
+                           <string>b</string> 
                           </void> 
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
@@ -1326,7 +1065,10 @@
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                           <void property="internalName"> 
-                           <string>_col1</string> 
+                           <string>VALUE._col1</string> 
+                          </void> 
+                          <void property="tabAlias"> 
+                           <string>b</string> 
                           </void> 
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
@@ -1341,93 +1083,57 @@
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-                  <void property="predicate"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="childExprs"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>key</string> 
-                            </void> 
-                            <void property="tabAlias"> 
-                             <string>src2</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <int>15</int> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan"/> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo2"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>key</string> 
-                            </void> 
-                            <void property="tabAlias"> 
-                             <string>src2</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <int>25</int> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo2"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                <void property="columnExprMap"> 
+                 <object class="java.util.HashMap"> 
+                  <void method="put"> 
+                   <string>_col1</string> 
+                   <object id="ExprNodeColumnDesc6" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>value</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd"/> 
+                    <void property="tabAlias"> 
+                     <string>src2</string> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="put"> 
+                   <string>_col0</string> 
+                   <object id="ExprNodeColumnDesc7" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>key</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string>src2</string> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="conf"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                  <void property="colList"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object idref="ExprNodeColumnDesc7"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="ExprNodeColumnDesc6"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void property="outputColumnNames"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <string>_col0</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col1</string> 
                     </void> 
                    </object> 
                   </void> 
@@ -1436,26 +1142,26 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_381_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_376_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_381_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_376_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_381_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_SEL_376_TIME_TAKEN</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_381_FATAL_ERROR</string> 
+                   <string>CNTR_NAME_SEL_376_FATAL_ERROR</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>FIL_381</string> 
+                 <string>SEL_376</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object idref="FilterOperator2"/> 
+                   <object idref="FilterOperator1"/> 
                   </void> 
                  </object> 
                 </void> 
@@ -1464,12 +1170,9 @@
                   <void property="signature"> 
                    <object class="java.util.ArrayList"> 
                     <void method="add"> 
-                     <object id="ColumnInfo2" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                       <void property="internalName"> 
-                       <string>key</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>src2</string> 
+                       <string>_col0</string> 
                       </void> 
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
@@ -1477,12 +1180,9 @@
                      </object> 
                     </void> 
                     <void method="add"> 
-                     <object id="ColumnInfo3" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                       <void property="internalName"> 
-                       <string>value</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>src2</string> 
+                       <string>_col1</string> 
                       </void> 
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
@@ -1592,21 +1292,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_393_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_387_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_393_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_387_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_393_TIME_TAKEN</string> 
+               <string>CNTR_NAME_FIL_387_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_393_FATAL_ERROR</string> 
+               <string>CNTR_NAME_FIL_387_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>FIL_393</string> 
+             <string>FIL_387</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -1620,10 +1320,30 @@
               <void property="signature"> 
                <object id="ArrayList3" class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <object idref="ColumnInfo2"/> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>key</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>src2</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
                 </void> 
                 <void method="add"> 
-                 <object idref="ColumnInfo3"/> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>value</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>src2</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
                 </void> 
                 <void method="add"> 
                  <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
@@ -1678,16 +1398,16 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_380_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_374_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_380_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_374_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_380_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_374_TIME_TAKEN</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_380_FATAL_ERROR</string> 
+           <string>CNTR_NAME_TS_374_FATAL_ERROR</string> 
           </void> 
          </object> 
         </void> 
@@ -1702,7 +1422,7 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_380</string> 
+         <string>TS_374</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -1943,21 +1663,21 @@
                   <void property="counterNames"> 
                    <object class="java.util.ArrayList"> 
                     <void method="add"> 
-                     <string>CNTR_NAME_FS_391_NUM_INPUT_ROWS</string> 
+                     <string>CNTR_NAME_FS_385_NUM_INPUT_ROWS</string> 
                     </void> 
                     <void method="add"> 
-                     <string>CNTR_NAME_FS_391_NUM_OUTPUT_ROWS</string> 
+                     <string>CNTR_NAME_FS_385_NUM_OUTPUT_ROWS</string> 
                     </void> 
                     <void method="add"> 
-                     <string>CNTR_NAME_FS_391_TIME_TAKEN</string> 
+                     <string>CNTR_NAME_FS_385_TIME_TAKEN</string> 
                     </void> 
                     <void method="add"> 
-                     <string>CNTR_NAME_FS_391_FATAL_ERROR</string> 
+                     <string>CNTR_NAME_FS_385_FATAL_ERROR</string> 
                     </void> 
                    </object> 
                   </void> 
                   <void property="operatorId"> 
-                   <string>FS_391</string> 
+                   <string>FS_385</string> 
                   </void> 
                   <void property="parentOperators"> 
                    <object class="java.util.ArrayList"> 
@@ -2117,21 +1837,21 @@
               <void property="counterNames"> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>CNTR_NAME_SEL_390_NUM_INPUT_ROWS</string> 
+                 <string>CNTR_NAME_SEL_384_NUM_INPUT_ROWS</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_SEL_390_NUM_OUTPUT_ROWS</string> 
+                 <string>CNTR_NAME_SEL_384_NUM_OUTPUT_ROWS</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_SEL_390_TIME_TAKEN</string> 
+                 <string>CNTR_NAME_SEL_384_TIME_TAKEN</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_SEL_390_FATAL_ERROR</string> 
+                 <string>CNTR_NAME_SEL_384_FATAL_ERROR</string> 
                 </void> 
                </object> 
               </void> 
               <void property="operatorId"> 
-               <string>SEL_390</string> 
+               <string>SEL_384</string> 
               </void> 
               <void property="parentOperators"> 
                <object class="java.util.ArrayList"> 
@@ -2315,21 +2035,21 @@
           <void property="counterNames"> 
            <object class="java.util.ArrayList"> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_389_NUM_INPUT_ROWS</string> 
+             <string>CNTR_NAME_SEL_383_NUM_INPUT_ROWS</string> 
             </void> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_389_NUM_OUTPUT_ROWS</string> 
+             <string>CNTR_NAME_SEL_383_NUM_OUTPUT_ROWS</string> 
             </void> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_389_TIME_TAKEN</string> 
+             <string>CNTR_NAME_SEL_383_TIME_TAKEN</string> 
             </void> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_389_FATAL_ERROR</string> 
+             <string>CNTR_NAME_SEL_383_FATAL_ERROR</string> 
             </void> 
            </object> 
           </void> 
           <void property="operatorId"> 
-           <string>SEL_389</string> 
+           <string>SEL_383</string> 
           </void> 
           <void property="parentOperators"> 
            <object class="java.util.ArrayList"> 
@@ -2555,21 +2275,21 @@
       <void property="counterNames"> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
-         <string>CNTR_NAME_JOIN_388_NUM_INPUT_ROWS</string> 
+         <string>CNTR_NAME_JOIN_382_NUM_INPUT_ROWS</string> 
         </void> 
         <void method="add"> 
-         <string>CNTR_NAME_JOIN_388_NUM_OUTPUT_ROWS</string> 
+         <string>CNTR_NAME_JOIN_382_NUM_OUTPUT_ROWS</string> 
         </void> 
         <void method="add"> 
-         <string>CNTR_NAME_JOIN_388_TIME_TAKEN</string> 
+         <string>CNTR_NAME_JOIN_382_TIME_TAKEN</string> 
         </void> 
         <void method="add"> 
-         <string>CNTR_NAME_JOIN_388_FATAL_ERROR</string> 
+         <string>CNTR_NAME_JOIN_382_FATAL_ERROR</string> 
         </void> 
        </object> 
       </void> 
       <void property="operatorId"> 
-       <string>JOIN_388</string> 
+       <string>JOIN_382</string> 
       </void> 
       <void property="parentOperators"> 
        <object class="java.util.ArrayList"> 
diff --git a/ql/src/test/results/compiler/plan/join5.q.xml b/ql/src/test/results/compiler/plan/join5.q.xml
index eb52c4e699..8b4065494e 100644
--- a/ql/src/test/results/compiler/plan/join5.q.xml
+++ b/ql/src/test/results/compiler/plan/join5.q.xml
@@ -284,248 +284,33 @@
             <void property="childOperators"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+               <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                    <void property="childOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object id="ReduceSinkOperator0" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
-                        <void property="columnExprMap"> 
-                         <object class="java.util.HashMap"> 
-                          <void method="put"> 
-                           <string>VALUE._col1</string> 
-                           <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>_col1</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                              <void property="typeName"> 
-                               <string>string</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="put"> 
-                           <string>VALUE._col0</string> 
-                           <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>_col0</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="conf"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
-                          <void property="distinctColumnIndices"> 
-                           <object class="java.util.ArrayList"/> 
-                          </void> 
-                          <void property="keyCols"> 
-                           <object id="ArrayList0" class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                              <void property="column"> 
-                               <string>_col0</string> 
-                              </void> 
-                              <void property="typeInfo"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="keySerializeInfo"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                            <void property="deserializerClass"> 
-                             <class>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</class> 
-                            </void> 
-                            <void property="inputFileFormatClass"> 
-                             <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                            </void> 
-                            <void property="outputFileFormatClass"> 
-                             <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                            </void> 
-                            <void property="properties"> 
-                             <object class="java.util.Properties"> 
-                              <void method="put"> 
-                               <string>columns</string> 
-                               <string>joinkey0</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>serialization.sort.order</string> 
-                               <string>+</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>columns.types</string> 
-                               <string>string</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="numDistributionKeys"> 
-                           <int>1</int> 
-                          </void> 
-                          <void property="numReducers"> 
-                           <int>-1</int> 
-                          </void> 
-                          <void property="outputKeyColumnNames"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <string>reducesinkkey0</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="outputValueColumnNames"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <string>_col0</string> 
-                            </void> 
-                            <void method="add"> 
-                             <string>_col1</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="partitionCols"> 
-                           <object idref="ArrayList0"/> 
-                          </void> 
-                          <void property="valueCols"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object idref="ExprNodeColumnDesc1"/> 
-                            </void> 
-                            <void method="add"> 
-                             <object idref="ExprNodeColumnDesc0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="valueSerializeInfo"> 
-                           <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                            <void property="deserializerClass"> 
-                             <class>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</class> 
-                            </void> 
-                            <void property="inputFileFormatClass"> 
-                             <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                            </void> 
-                            <void property="outputFileFormatClass"> 
-                             <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                            </void> 
-                            <void property="properties"> 
-                             <object class="java.util.Properties"> 
-                              <void method="put"> 
-                               <string>columns</string> 
-                               <string>_col0,_col1</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>columns.types</string> 
-                               <string>string,string</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>escape.delim</string> 
-                               <string>\</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="counterNames"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_RS_414_NUM_INPUT_ROWS</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_RS_414_NUM_OUTPUT_ROWS</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_RS_414_TIME_TAKEN</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_RS_414_FATAL_ERROR</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="operatorId"> 
-                         <string>RS_414</string> 
-                        </void> 
-                        <void property="parentOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object idref="SelectOperator0"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="schema"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                          <void property="signature"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>VALUE._col0</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string>a</string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>VALUE._col1</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string>a</string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
+                   <object id="ReduceSinkOperator0" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
                     <void property="columnExprMap"> 
                      <object class="java.util.HashMap"> 
                       <void method="put"> 
-                       <string>_col1</string> 
-                       <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <string>VALUE._col1</string> 
+                       <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
                         <void property="column"> 
-                         <string>value</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src1</string> 
+                         <string>_col1</string> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
+                         <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
+                         </object> 
                         </void> 
                        </object> 
                       </void> 
                       <void method="put"> 
-                       <string>_col0</string> 
-                       <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <string>VALUE._col0</string> 
+                       <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
                         <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src1</string> 
+                         <string>_col0</string> 
                         </void> 
                         <void property="typeInfo"> 
                          <object idref="PrimitiveTypeInfo0"/> 
@@ -535,18 +320,67 @@
                      </object> 
                     </void> 
                     <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                      <void property="colList"> 
-                       <object class="java.util.ArrayList"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
+                      <void property="distinctColumnIndices"> 
+                       <object class="java.util.ArrayList"/> 
+                      </void> 
+                      <void property="keyCols"> 
+                       <object id="ArrayList0" class="java.util.ArrayList"> 
                         <void method="add"> 
-                         <object idref="ExprNodeColumnDesc3"/> 
+                         <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                          <void property="column"> 
+                           <string>_col0</string> 
+                          </void> 
+                          <void property="typeInfo"> 
+                           <object idref="PrimitiveTypeInfo0"/> 
+                          </void> 
+                         </object> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="keySerializeInfo"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                        <void property="deserializerClass"> 
+                         <class>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</class> 
+                        </void> 
+                        <void property="inputFileFormatClass"> 
+                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                        </void> 
+                        <void property="outputFileFormatClass"> 
+                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                        </void> 
+                        <void property="properties"> 
+                         <object class="java.util.Properties"> 
+                          <void method="put"> 
+                           <string>columns</string> 
+                           <string>joinkey0</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>serialization.sort.order</string> 
+                           <string>+</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>columns.types</string> 
+                           <string>string</string> 
+                          </void> 
+                         </object> 
                         </void> 
+                       </object> 
+                      </void> 
+                      <void property="numDistributionKeys"> 
+                       <int>1</int> 
+                      </void> 
+                      <void property="numReducers"> 
+                       <int>-1</int> 
+                      </void> 
+                      <void property="outputKeyColumnNames"> 
+                       <object class="java.util.ArrayList"> 
                         <void method="add"> 
-                         <object idref="ExprNodeColumnDesc2"/> 
+                         <string>reducesinkkey0</string> 
                         </void> 
                        </object> 
                       </void> 
-                      <void property="outputColumnNames"> 
+                      <void property="outputValueColumnNames"> 
                        <object class="java.util.ArrayList"> 
                         <void method="add"> 
                          <string>_col0</string> 
@@ -556,31 +390,73 @@
                         </void> 
                        </object> 
                       </void> 
+                      <void property="partitionCols"> 
+                       <object idref="ArrayList0"/> 
+                      </void> 
+                      <void property="valueCols"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <object idref="ExprNodeColumnDesc1"/> 
+                        </void> 
+                        <void method="add"> 
+                         <object idref="ExprNodeColumnDesc0"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="valueSerializeInfo"> 
+                       <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                        <void property="deserializerClass"> 
+                         <class>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</class> 
+                        </void> 
+                        <void property="inputFileFormatClass"> 
+                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                        </void> 
+                        <void property="outputFileFormatClass"> 
+                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                        </void> 
+                        <void property="properties"> 
+                         <object class="java.util.Properties"> 
+                          <void method="put"> 
+                           <string>columns</string> 
+                           <string>_col0,_col1</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>columns.types</string> 
+                           <string>string,string</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>escape.delim</string> 
+                           <string>\</string> 
+                          </void> 
+                         </object> 
+                        </void> 
+                       </object> 
+                      </void> 
                      </object> 
                     </void> 
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_413_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_RS_406_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_413_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_RS_406_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_413_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_RS_406_TIME_TAKEN</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_413_FATAL_ERROR</string> 
+                       <string>CNTR_NAME_RS_406_FATAL_ERROR</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>SEL_413</string> 
+                     <string>RS_406</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object idref="FilterOperator1"/> 
+                       <object idref="SelectOperator0"/> 
                       </void> 
                      </object> 
                     </void> 
@@ -591,7 +467,10 @@
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                           <void property="internalName"> 
-                           <string>_col0</string> 
+                           <string>VALUE._col0</string> 
+                          </void> 
+                          <void property="tabAlias"> 
+                           <string>a</string> 
                           </void> 
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
@@ -601,7 +480,10 @@
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                           <void property="internalName"> 
-                           <string>_col1</string> 
+                           <string>VALUE._col1</string> 
+                          </void> 
+                          <void property="tabAlias"> 
+                           <string>a</string> 
                           </void> 
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
@@ -616,101 +498,57 @@
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-                  <void property="predicate"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="childExprs"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>key</string> 
-                            </void> 
-                            <void property="tabAlias"> 
-                             <string>src1</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                              <void property="typeName"> 
-                               <string>int</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="value"> 
-                             <int>10</int> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan"/> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>boolean</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>key</string> 
-                            </void> 
-                            <void property="tabAlias"> 
-                             <string>src1</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <int>20</int> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo2"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                <void property="columnExprMap"> 
+                 <object class="java.util.HashMap"> 
+                  <void method="put"> 
+                   <string>_col1</string> 
+                   <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>value</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd"/> 
+                    <void property="tabAlias"> 
+                     <string>src1</string> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="put"> 
+                   <string>_col0</string> 
+                   <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>key</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string>src1</string> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="conf"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                  <void property="colList"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object idref="ExprNodeColumnDesc3"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="ExprNodeColumnDesc2"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void property="outputColumnNames"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <string>_col0</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col1</string> 
                     </void> 
                    </object> 
                   </void> 
@@ -719,21 +557,21 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_412_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_405_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_412_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_405_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_412_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_SEL_405_TIME_TAKEN</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_412_FATAL_ERROR</string> 
+                   <string>CNTR_NAME_SEL_405_FATAL_ERROR</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>FIL_412</string> 
+                 <string>SEL_405</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -747,12 +585,9 @@
                   <void property="signature"> 
                    <object class="java.util.ArrayList"> 
                     <void method="add"> 
-                     <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                       <void property="internalName"> 
-                       <string>key</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>src1</string> 
+                       <string>_col0</string> 
                       </void> 
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
@@ -760,12 +595,9 @@
                      </object> 
                     </void> 
                     <void method="add"> 
-                     <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                       <void property="internalName"> 
-                       <string>value</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>src1</string> 
+                       <string>_col1</string> 
                       </void> 
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
@@ -806,7 +638,11 @@
                       <void method="add"> 
                        <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
+                         <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                          <void property="typeName"> 
+                           <string>int</string> 
+                          </void> 
+                         </object> 
                         </void> 
                         <void property="value"> 
                          <int>10</int> 
@@ -819,7 +655,11 @@
                      <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan"/> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                     <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                      <void property="typeName"> 
+                       <string>boolean</string> 
+                      </void> 
+                     </object> 
                     </void> 
                    </object> 
                   </void> 
@@ -875,21 +715,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_420_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_412_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_420_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_412_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_420_TIME_TAKEN</string> 
+               <string>CNTR_NAME_FIL_412_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_420_FATAL_ERROR</string> 
+               <string>CNTR_NAME_FIL_412_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>FIL_420</string> 
+             <string>FIL_412</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -903,10 +743,30 @@
               <void property="signature"> 
                <object id="ArrayList1" class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <object idref="ColumnInfo0"/> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>key</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>src1</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
                 </void> 
                 <void method="add"> 
-                 <object idref="ColumnInfo1"/> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>value</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>src1</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
                 </void> 
                 <void method="add"> 
                  <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
@@ -965,16 +825,16 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_411_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_403_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_411_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_403_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_411_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_403_TIME_TAKEN</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_411_FATAL_ERROR</string> 
+           <string>CNTR_NAME_TS_403_FATAL_ERROR</string> 
           </void> 
          </object> 
         </void> 
@@ -989,7 +849,7 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_411</string> 
+         <string>TS_403</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -1006,237 +866,22 @@
         <void property="childOperators"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <object id="FilterOperator2" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+           <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
             <void property="childOperators"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <object id="FilterOperator3" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+               <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                    <void property="childOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object id="ReduceSinkOperator1" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
-                        <void property="columnExprMap"> 
-                         <object class="java.util.HashMap"> 
-                          <void method="put"> 
-                           <string>VALUE._col1</string> 
-                           <object id="ExprNodeColumnDesc4" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>_col1</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="put"> 
-                           <string>VALUE._col0</string> 
-                           <object id="ExprNodeColumnDesc5" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>_col0</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="conf"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
-                          <void property="distinctColumnIndices"> 
-                           <object class="java.util.ArrayList"/> 
-                          </void> 
-                          <void property="keyCols"> 
-                           <object id="ArrayList2" class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                              <void property="column"> 
-                               <string>_col0</string> 
-                              </void> 
-                              <void property="typeInfo"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="keySerializeInfo"> 
-                           <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                            <void property="deserializerClass"> 
-                             <class>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</class> 
-                            </void> 
-                            <void property="inputFileFormatClass"> 
-                             <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                            </void> 
-                            <void property="outputFileFormatClass"> 
-                             <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                            </void> 
-                            <void property="properties"> 
-                             <object class="java.util.Properties"> 
-                              <void method="put"> 
-                               <string>columns</string> 
-                               <string>joinkey0</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>serialization.sort.order</string> 
-                               <string>+</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>columns.types</string> 
-                               <string>string</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="numDistributionKeys"> 
-                           <int>1</int> 
-                          </void> 
-                          <void property="numReducers"> 
-                           <int>-1</int> 
-                          </void> 
-                          <void property="outputKeyColumnNames"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <string>reducesinkkey0</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="outputValueColumnNames"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <string>_col0</string> 
-                            </void> 
-                            <void method="add"> 
-                             <string>_col1</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="partitionCols"> 
-                           <object idref="ArrayList2"/> 
-                          </void> 
-                          <void property="tag"> 
-                           <int>1</int> 
-                          </void> 
-                          <void property="valueCols"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object idref="ExprNodeColumnDesc5"/> 
-                            </void> 
-                            <void method="add"> 
-                             <object idref="ExprNodeColumnDesc4"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="valueSerializeInfo"> 
-                           <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                            <void property="deserializerClass"> 
-                             <class>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</class> 
-                            </void> 
-                            <void property="inputFileFormatClass"> 
-                             <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                            </void> 
-                            <void property="outputFileFormatClass"> 
-                             <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                            </void> 
-                            <void property="properties"> 
-                             <object class="java.util.Properties"> 
-                              <void method="put"> 
-                               <string>columns</string> 
-                               <string>_col0,_col1</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>columns.types</string> 
-                               <string>string,string</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>escape.delim</string> 
-                               <string>\</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="counterNames"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_RS_415_NUM_INPUT_ROWS</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_RS_415_NUM_OUTPUT_ROWS</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_RS_415_TIME_TAKEN</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_RS_415_FATAL_ERROR</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="operatorId"> 
-                         <string>RS_415</string> 
-                        </void> 
-                        <void property="parentOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object idref="SelectOperator1"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="schema"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                          <void property="signature"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>VALUE._col0</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string>b</string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>VALUE._col1</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string>b</string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
+                   <object id="ReduceSinkOperator1" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
                     <void property="columnExprMap"> 
                      <object class="java.util.HashMap"> 
                       <void method="put"> 
-                       <string>_col1</string> 
-                       <object id="ExprNodeColumnDesc6" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <string>VALUE._col1</string> 
+                       <object id="ExprNodeColumnDesc4" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
                         <void property="column"> 
-                         <string>value</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src2</string> 
+                         <string>_col1</string> 
                         </void> 
                         <void property="typeInfo"> 
                          <object idref="PrimitiveTypeInfo0"/> 
@@ -1244,13 +889,10 @@
                        </object> 
                       </void> 
                       <void method="put"> 
-                       <string>_col0</string> 
-                       <object id="ExprNodeColumnDesc7" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <string>VALUE._col0</string> 
+                       <object id="ExprNodeColumnDesc5" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
                         <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src2</string> 
+                         <string>_col0</string> 
                         </void> 
                         <void property="typeInfo"> 
                          <object idref="PrimitiveTypeInfo0"/> 
@@ -1260,18 +902,67 @@
                      </object> 
                     </void> 
                     <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                      <void property="colList"> 
-                       <object class="java.util.ArrayList"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
+                      <void property="distinctColumnIndices"> 
+                       <object class="java.util.ArrayList"/> 
+                      </void> 
+                      <void property="keyCols"> 
+                       <object id="ArrayList2" class="java.util.ArrayList"> 
                         <void method="add"> 
-                         <object idref="ExprNodeColumnDesc7"/> 
+                         <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                          <void property="column"> 
+                           <string>_col0</string> 
+                          </void> 
+                          <void property="typeInfo"> 
+                           <object idref="PrimitiveTypeInfo0"/> 
+                          </void> 
+                         </object> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="keySerializeInfo"> 
+                       <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                        <void property="deserializerClass"> 
+                         <class>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</class> 
+                        </void> 
+                        <void property="inputFileFormatClass"> 
+                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                        </void> 
+                        <void property="outputFileFormatClass"> 
+                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                        </void> 
+                        <void property="properties"> 
+                         <object class="java.util.Properties"> 
+                          <void method="put"> 
+                           <string>columns</string> 
+                           <string>joinkey0</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>serialization.sort.order</string> 
+                           <string>+</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>columns.types</string> 
+                           <string>string</string> 
+                          </void> 
+                         </object> 
                         </void> 
+                       </object> 
+                      </void> 
+                      <void property="numDistributionKeys"> 
+                       <int>1</int> 
+                      </void> 
+                      <void property="numReducers"> 
+                       <int>-1</int> 
+                      </void> 
+                      <void property="outputKeyColumnNames"> 
+                       <object class="java.util.ArrayList"> 
                         <void method="add"> 
-                         <object idref="ExprNodeColumnDesc6"/> 
+                         <string>reducesinkkey0</string> 
                         </void> 
                        </object> 
                       </void> 
-                      <void property="outputColumnNames"> 
+                      <void property="outputValueColumnNames"> 
                        <object class="java.util.ArrayList"> 
                         <void method="add"> 
                          <string>_col0</string> 
@@ -1281,31 +972,76 @@
                         </void> 
                        </object> 
                       </void> 
+                      <void property="partitionCols"> 
+                       <object idref="ArrayList2"/> 
+                      </void> 
+                      <void property="tag"> 
+                       <int>1</int> 
+                      </void> 
+                      <void property="valueCols"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <object idref="ExprNodeColumnDesc5"/> 
+                        </void> 
+                        <void method="add"> 
+                         <object idref="ExprNodeColumnDesc4"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="valueSerializeInfo"> 
+                       <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                        <void property="deserializerClass"> 
+                         <class>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</class> 
+                        </void> 
+                        <void property="inputFileFormatClass"> 
+                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                        </void> 
+                        <void property="outputFileFormatClass"> 
+                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                        </void> 
+                        <void property="properties"> 
+                         <object class="java.util.Properties"> 
+                          <void method="put"> 
+                           <string>columns</string> 
+                           <string>_col0,_col1</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>columns.types</string> 
+                           <string>string,string</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>escape.delim</string> 
+                           <string>\</string> 
+                          </void> 
+                         </object> 
+                        </void> 
+                       </object> 
+                      </void> 
                      </object> 
                     </void> 
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_410_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_RS_407_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_410_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_RS_407_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_410_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_RS_407_TIME_TAKEN</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_410_FATAL_ERROR</string> 
+                       <string>CNTR_NAME_RS_407_FATAL_ERROR</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>SEL_410</string> 
+                     <string>RS_407</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object idref="FilterOperator3"/> 
+                       <object idref="SelectOperator1"/> 
                       </void> 
                      </object> 
                     </void> 
@@ -1316,7 +1052,10 @@
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                           <void property="internalName"> 
-                           <string>_col0</string> 
+                           <string>VALUE._col0</string> 
+                          </void> 
+                          <void property="tabAlias"> 
+                           <string>b</string> 
                           </void> 
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
@@ -1326,7 +1065,10 @@
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                           <void property="internalName"> 
-                           <string>_col1</string> 
+                           <string>VALUE._col1</string> 
+                          </void> 
+                          <void property="tabAlias"> 
+                           <string>b</string> 
                           </void> 
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
@@ -1341,93 +1083,57 @@
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-                  <void property="predicate"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="childExprs"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>key</string> 
-                            </void> 
-                            <void property="tabAlias"> 
-                             <string>src2</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <int>15</int> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan"/> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo2"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>key</string> 
-                            </void> 
-                            <void property="tabAlias"> 
-                             <string>src2</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <int>25</int> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo2"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                <void property="columnExprMap"> 
+                 <object class="java.util.HashMap"> 
+                  <void method="put"> 
+                   <string>_col1</string> 
+                   <object id="ExprNodeColumnDesc6" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>value</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd"/> 
+                    <void property="tabAlias"> 
+                     <string>src2</string> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="put"> 
+                   <string>_col0</string> 
+                   <object id="ExprNodeColumnDesc7" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>key</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string>src2</string> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="conf"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                  <void property="colList"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object idref="ExprNodeColumnDesc7"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="ExprNodeColumnDesc6"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void property="outputColumnNames"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <string>_col0</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col1</string> 
                     </void> 
                    </object> 
                   </void> 
@@ -1436,26 +1142,26 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_409_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_402_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_409_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_402_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_409_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_SEL_402_TIME_TAKEN</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_409_FATAL_ERROR</string> 
+                   <string>CNTR_NAME_SEL_402_FATAL_ERROR</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>FIL_409</string> 
+                 <string>SEL_402</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object idref="FilterOperator2"/> 
+                   <object idref="FilterOperator1"/> 
                   </void> 
                  </object> 
                 </void> 
@@ -1464,12 +1170,9 @@
                   <void property="signature"> 
                    <object class="java.util.ArrayList"> 
                     <void method="add"> 
-                     <object id="ColumnInfo2" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                       <void property="internalName"> 
-                       <string>key</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>src2</string> 
+                       <string>_col0</string> 
                       </void> 
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
@@ -1477,12 +1180,9 @@
                      </object> 
                     </void> 
                     <void method="add"> 
-                     <object id="ColumnInfo3" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                       <void property="internalName"> 
-                       <string>value</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>src2</string> 
+                       <string>_col1</string> 
                       </void> 
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
@@ -1592,21 +1292,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_421_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_413_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_421_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_413_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_421_TIME_TAKEN</string> 
+               <string>CNTR_NAME_FIL_413_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_421_FATAL_ERROR</string> 
+               <string>CNTR_NAME_FIL_413_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>FIL_421</string> 
+             <string>FIL_413</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -1620,10 +1320,30 @@
               <void property="signature"> 
                <object id="ArrayList3" class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <object idref="ColumnInfo2"/> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>key</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>src2</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
                 </void> 
                 <void method="add"> 
-                 <object idref="ColumnInfo3"/> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>value</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>src2</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
                 </void> 
                 <void method="add"> 
                  <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
@@ -1678,16 +1398,16 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_408_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_400_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_408_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_400_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_408_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_400_TIME_TAKEN</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_408_FATAL_ERROR</string> 
+           <string>CNTR_NAME_TS_400_FATAL_ERROR</string> 
           </void> 
          </object> 
         </void> 
@@ -1702,7 +1422,7 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_408</string> 
+         <string>TS_400</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -1943,21 +1663,21 @@
                   <void property="counterNames"> 
                    <object class="java.util.ArrayList"> 
                     <void method="add"> 
-                     <string>CNTR_NAME_FS_419_NUM_INPUT_ROWS</string> 
+                     <string>CNTR_NAME_FS_411_NUM_INPUT_ROWS</string> 
                     </void> 
                     <void method="add"> 
-                     <string>CNTR_NAME_FS_419_NUM_OUTPUT_ROWS</string> 
+                     <string>CNTR_NAME_FS_411_NUM_OUTPUT_ROWS</string> 
                     </void> 
                     <void method="add"> 
-                     <string>CNTR_NAME_FS_419_TIME_TAKEN</string> 
+                     <string>CNTR_NAME_FS_411_TIME_TAKEN</string> 
                     </void> 
                     <void method="add"> 
-                     <string>CNTR_NAME_FS_419_FATAL_ERROR</string> 
+                     <string>CNTR_NAME_FS_411_FATAL_ERROR</string> 
                     </void> 
                    </object> 
                   </void> 
                   <void property="operatorId"> 
-                   <string>FS_419</string> 
+                   <string>FS_411</string> 
                   </void> 
                   <void property="parentOperators"> 
                    <object class="java.util.ArrayList"> 
@@ -2117,21 +1837,21 @@
               <void property="counterNames"> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>CNTR_NAME_SEL_418_NUM_INPUT_ROWS</string> 
+                 <string>CNTR_NAME_SEL_410_NUM_INPUT_ROWS</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_SEL_418_NUM_OUTPUT_ROWS</string> 
+                 <string>CNTR_NAME_SEL_410_NUM_OUTPUT_ROWS</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_SEL_418_TIME_TAKEN</string> 
+                 <string>CNTR_NAME_SEL_410_TIME_TAKEN</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_SEL_418_FATAL_ERROR</string> 
+                 <string>CNTR_NAME_SEL_410_FATAL_ERROR</string> 
                 </void> 
                </object> 
               </void> 
               <void property="operatorId"> 
-               <string>SEL_418</string> 
+               <string>SEL_410</string> 
               </void> 
               <void property="parentOperators"> 
                <object class="java.util.ArrayList"> 
@@ -2315,21 +2035,21 @@
           <void property="counterNames"> 
            <object class="java.util.ArrayList"> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_417_NUM_INPUT_ROWS</string> 
+             <string>CNTR_NAME_SEL_409_NUM_INPUT_ROWS</string> 
             </void> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_417_NUM_OUTPUT_ROWS</string> 
+             <string>CNTR_NAME_SEL_409_NUM_OUTPUT_ROWS</string> 
             </void> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_417_TIME_TAKEN</string> 
+             <string>CNTR_NAME_SEL_409_TIME_TAKEN</string> 
             </void> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_417_FATAL_ERROR</string> 
+             <string>CNTR_NAME_SEL_409_FATAL_ERROR</string> 
             </void> 
            </object> 
           </void> 
           <void property="operatorId"> 
-           <string>SEL_417</string> 
+           <string>SEL_409</string> 
           </void> 
           <void property="parentOperators"> 
            <object class="java.util.ArrayList"> 
@@ -2555,21 +2275,21 @@
       <void property="counterNames"> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
-         <string>CNTR_NAME_JOIN_416_NUM_INPUT_ROWS</string> 
+         <string>CNTR_NAME_JOIN_408_NUM_INPUT_ROWS</string> 
         </void> 
         <void method="add"> 
-         <string>CNTR_NAME_JOIN_416_NUM_OUTPUT_ROWS</string> 
+         <string>CNTR_NAME_JOIN_408_NUM_OUTPUT_ROWS</string> 
         </void> 
         <void method="add"> 
-         <string>CNTR_NAME_JOIN_416_TIME_TAKEN</string> 
+         <string>CNTR_NAME_JOIN_408_TIME_TAKEN</string> 
         </void> 
         <void method="add"> 
-         <string>CNTR_NAME_JOIN_416_FATAL_ERROR</string> 
+         <string>CNTR_NAME_JOIN_408_FATAL_ERROR</string> 
         </void> 
        </object> 
       </void> 
       <void property="operatorId"> 
-       <string>JOIN_416</string> 
+       <string>JOIN_408</string> 
       </void> 
       <void property="parentOperators"> 
        <object class="java.util.ArrayList"> 
diff --git a/ql/src/test/results/compiler/plan/join6.q.xml b/ql/src/test/results/compiler/plan/join6.q.xml
index 82a56ed40a..03807ffe23 100644
--- a/ql/src/test/results/compiler/plan/join6.q.xml
+++ b/ql/src/test/results/compiler/plan/join6.q.xml
@@ -284,248 +284,33 @@
             <void property="childOperators"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+               <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                    <void property="childOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object id="ReduceSinkOperator0" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
-                        <void property="columnExprMap"> 
-                         <object class="java.util.HashMap"> 
-                          <void method="put"> 
-                           <string>VALUE._col1</string> 
-                           <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>_col1</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                              <void property="typeName"> 
-                               <string>string</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="put"> 
-                           <string>VALUE._col0</string> 
-                           <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>_col0</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="conf"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
-                          <void property="distinctColumnIndices"> 
-                           <object class="java.util.ArrayList"/> 
-                          </void> 
-                          <void property="keyCols"> 
-                           <object id="ArrayList0" class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                              <void property="column"> 
-                               <string>_col0</string> 
-                              </void> 
-                              <void property="typeInfo"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="keySerializeInfo"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                            <void property="deserializerClass"> 
-                             <class>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</class> 
-                            </void> 
-                            <void property="inputFileFormatClass"> 
-                             <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                            </void> 
-                            <void property="outputFileFormatClass"> 
-                             <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                            </void> 
-                            <void property="properties"> 
-                             <object class="java.util.Properties"> 
-                              <void method="put"> 
-                               <string>columns</string> 
-                               <string>joinkey0</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>serialization.sort.order</string> 
-                               <string>+</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>columns.types</string> 
-                               <string>string</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="numDistributionKeys"> 
-                           <int>1</int> 
-                          </void> 
-                          <void property="numReducers"> 
-                           <int>-1</int> 
-                          </void> 
-                          <void property="outputKeyColumnNames"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <string>reducesinkkey0</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="outputValueColumnNames"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <string>_col0</string> 
-                            </void> 
-                            <void method="add"> 
-                             <string>_col1</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="partitionCols"> 
-                           <object idref="ArrayList0"/> 
-                          </void> 
-                          <void property="valueCols"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object idref="ExprNodeColumnDesc1"/> 
-                            </void> 
-                            <void method="add"> 
-                             <object idref="ExprNodeColumnDesc0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="valueSerializeInfo"> 
-                           <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                            <void property="deserializerClass"> 
-                             <class>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</class> 
-                            </void> 
-                            <void property="inputFileFormatClass"> 
-                             <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                            </void> 
-                            <void property="outputFileFormatClass"> 
-                             <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                            </void> 
-                            <void property="properties"> 
-                             <object class="java.util.Properties"> 
-                              <void method="put"> 
-                               <string>columns</string> 
-                               <string>_col0,_col1</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>columns.types</string> 
-                               <string>string,string</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>escape.delim</string> 
-                               <string>\</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="counterNames"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_RS_442_NUM_INPUT_ROWS</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_RS_442_NUM_OUTPUT_ROWS</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_RS_442_TIME_TAKEN</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_RS_442_FATAL_ERROR</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="operatorId"> 
-                         <string>RS_442</string> 
-                        </void> 
-                        <void property="parentOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object idref="SelectOperator0"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="schema"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                          <void property="signature"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>VALUE._col0</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string>a</string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>VALUE._col1</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string>a</string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
+                   <object id="ReduceSinkOperator0" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
                     <void property="columnExprMap"> 
                      <object class="java.util.HashMap"> 
                       <void method="put"> 
-                       <string>_col1</string> 
-                       <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <string>VALUE._col1</string> 
+                       <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
                         <void property="column"> 
-                         <string>value</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src1</string> 
+                         <string>_col1</string> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
+                         <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
+                         </object> 
                         </void> 
                        </object> 
                       </void> 
                       <void method="put"> 
-                       <string>_col0</string> 
-                       <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <string>VALUE._col0</string> 
+                       <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
                         <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src1</string> 
+                         <string>_col0</string> 
                         </void> 
                         <void property="typeInfo"> 
                          <object idref="PrimitiveTypeInfo0"/> 
@@ -535,18 +320,67 @@
                      </object> 
                     </void> 
                     <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                      <void property="colList"> 
-                       <object class="java.util.ArrayList"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
+                      <void property="distinctColumnIndices"> 
+                       <object class="java.util.ArrayList"/> 
+                      </void> 
+                      <void property="keyCols"> 
+                       <object id="ArrayList0" class="java.util.ArrayList"> 
                         <void method="add"> 
-                         <object idref="ExprNodeColumnDesc3"/> 
+                         <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                          <void property="column"> 
+                           <string>_col0</string> 
+                          </void> 
+                          <void property="typeInfo"> 
+                           <object idref="PrimitiveTypeInfo0"/> 
+                          </void> 
+                         </object> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="keySerializeInfo"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                        <void property="deserializerClass"> 
+                         <class>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</class> 
+                        </void> 
+                        <void property="inputFileFormatClass"> 
+                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                        </void> 
+                        <void property="outputFileFormatClass"> 
+                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                        </void> 
+                        <void property="properties"> 
+                         <object class="java.util.Properties"> 
+                          <void method="put"> 
+                           <string>columns</string> 
+                           <string>joinkey0</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>serialization.sort.order</string> 
+                           <string>+</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>columns.types</string> 
+                           <string>string</string> 
+                          </void> 
+                         </object> 
                         </void> 
+                       </object> 
+                      </void> 
+                      <void property="numDistributionKeys"> 
+                       <int>1</int> 
+                      </void> 
+                      <void property="numReducers"> 
+                       <int>-1</int> 
+                      </void> 
+                      <void property="outputKeyColumnNames"> 
+                       <object class="java.util.ArrayList"> 
                         <void method="add"> 
-                         <object idref="ExprNodeColumnDesc2"/> 
+                         <string>reducesinkkey0</string> 
                         </void> 
                        </object> 
                       </void> 
-                      <void property="outputColumnNames"> 
+                      <void property="outputValueColumnNames"> 
                        <object class="java.util.ArrayList"> 
                         <void method="add"> 
                          <string>_col0</string> 
@@ -556,31 +390,73 @@
                         </void> 
                        </object> 
                       </void> 
+                      <void property="partitionCols"> 
+                       <object idref="ArrayList0"/> 
+                      </void> 
+                      <void property="valueCols"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <object idref="ExprNodeColumnDesc1"/> 
+                        </void> 
+                        <void method="add"> 
+                         <object idref="ExprNodeColumnDesc0"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="valueSerializeInfo"> 
+                       <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                        <void property="deserializerClass"> 
+                         <class>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</class> 
+                        </void> 
+                        <void property="inputFileFormatClass"> 
+                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                        </void> 
+                        <void property="outputFileFormatClass"> 
+                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                        </void> 
+                        <void property="properties"> 
+                         <object class="java.util.Properties"> 
+                          <void method="put"> 
+                           <string>columns</string> 
+                           <string>_col0,_col1</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>columns.types</string> 
+                           <string>string,string</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>escape.delim</string> 
+                           <string>\</string> 
+                          </void> 
+                         </object> 
+                        </void> 
+                       </object> 
+                      </void> 
                      </object> 
                     </void> 
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_441_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_RS_432_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_441_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_RS_432_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_441_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_RS_432_TIME_TAKEN</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_441_FATAL_ERROR</string> 
+                       <string>CNTR_NAME_RS_432_FATAL_ERROR</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>SEL_441</string> 
+                     <string>RS_432</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object idref="FilterOperator1"/> 
+                       <object idref="SelectOperator0"/> 
                       </void> 
                      </object> 
                     </void> 
@@ -591,7 +467,10 @@
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                           <void property="internalName"> 
-                           <string>_col0</string> 
+                           <string>VALUE._col0</string> 
+                          </void> 
+                          <void property="tabAlias"> 
+                           <string>a</string> 
                           </void> 
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
@@ -601,7 +480,10 @@
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                           <void property="internalName"> 
-                           <string>_col1</string> 
+                           <string>VALUE._col1</string> 
+                          </void> 
+                          <void property="tabAlias"> 
+                           <string>a</string> 
                           </void> 
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
@@ -616,101 +498,57 @@
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-                  <void property="predicate"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="childExprs"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>key</string> 
-                            </void> 
-                            <void property="tabAlias"> 
-                             <string>src1</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                              <void property="typeName"> 
-                               <string>int</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="value"> 
-                             <int>10</int> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan"/> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>boolean</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>key</string> 
-                            </void> 
-                            <void property="tabAlias"> 
-                             <string>src1</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <int>20</int> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo2"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                <void property="columnExprMap"> 
+                 <object class="java.util.HashMap"> 
+                  <void method="put"> 
+                   <string>_col1</string> 
+                   <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>value</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd"/> 
+                    <void property="tabAlias"> 
+                     <string>src1</string> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="put"> 
+                   <string>_col0</string> 
+                   <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>key</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string>src1</string> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="conf"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                  <void property="colList"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object idref="ExprNodeColumnDesc3"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="ExprNodeColumnDesc2"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void property="outputColumnNames"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <string>_col0</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col1</string> 
                     </void> 
                    </object> 
                   </void> 
@@ -719,21 +557,21 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_440_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_431_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_440_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_431_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_440_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_SEL_431_TIME_TAKEN</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_440_FATAL_ERROR</string> 
+                   <string>CNTR_NAME_SEL_431_FATAL_ERROR</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>FIL_440</string> 
+                 <string>SEL_431</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -747,12 +585,9 @@
                   <void property="signature"> 
                    <object class="java.util.ArrayList"> 
                     <void method="add"> 
-                     <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                       <void property="internalName"> 
-                       <string>key</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>src1</string> 
+                       <string>_col0</string> 
                       </void> 
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
@@ -760,12 +595,9 @@
                      </object> 
                     </void> 
                     <void method="add"> 
-                     <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                       <void property="internalName"> 
-                       <string>value</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>src1</string> 
+                       <string>_col1</string> 
                       </void> 
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
@@ -806,7 +638,11 @@
                       <void method="add"> 
                        <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
+                         <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                          <void property="typeName"> 
+                           <string>int</string> 
+                          </void> 
+                         </object> 
                         </void> 
                         <void property="value"> 
                          <int>10</int> 
@@ -819,7 +655,11 @@
                      <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan"/> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                     <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                      <void property="typeName"> 
+                       <string>boolean</string> 
+                      </void> 
+                     </object> 
                     </void> 
                    </object> 
                   </void> 
@@ -875,21 +715,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_448_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_438_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_448_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_438_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_448_TIME_TAKEN</string> 
+               <string>CNTR_NAME_FIL_438_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_448_FATAL_ERROR</string> 
+               <string>CNTR_NAME_FIL_438_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>FIL_448</string> 
+             <string>FIL_438</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -903,10 +743,30 @@
               <void property="signature"> 
                <object id="ArrayList1" class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <object idref="ColumnInfo0"/> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>key</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>src1</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
                 </void> 
                 <void method="add"> 
-                 <object idref="ColumnInfo1"/> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>value</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>src1</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
                 </void> 
                 <void method="add"> 
                  <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
@@ -965,16 +825,16 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_439_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_429_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_439_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_429_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_439_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_429_TIME_TAKEN</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_439_FATAL_ERROR</string> 
+           <string>CNTR_NAME_TS_429_FATAL_ERROR</string> 
           </void> 
          </object> 
         </void> 
@@ -989,7 +849,7 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_439</string> 
+         <string>TS_429</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -1006,237 +866,22 @@
         <void property="childOperators"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <object id="FilterOperator2" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+           <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
             <void property="childOperators"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <object id="FilterOperator3" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+               <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                    <void property="childOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object id="ReduceSinkOperator1" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
-                        <void property="columnExprMap"> 
-                         <object class="java.util.HashMap"> 
-                          <void method="put"> 
-                           <string>VALUE._col1</string> 
-                           <object id="ExprNodeColumnDesc4" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>_col1</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="put"> 
-                           <string>VALUE._col0</string> 
-                           <object id="ExprNodeColumnDesc5" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>_col0</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="conf"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
-                          <void property="distinctColumnIndices"> 
-                           <object class="java.util.ArrayList"/> 
-                          </void> 
-                          <void property="keyCols"> 
-                           <object id="ArrayList2" class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                              <void property="column"> 
-                               <string>_col0</string> 
-                              </void> 
-                              <void property="typeInfo"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="keySerializeInfo"> 
-                           <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                            <void property="deserializerClass"> 
-                             <class>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</class> 
-                            </void> 
-                            <void property="inputFileFormatClass"> 
-                             <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                            </void> 
-                            <void property="outputFileFormatClass"> 
-                             <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                            </void> 
-                            <void property="properties"> 
-                             <object class="java.util.Properties"> 
-                              <void method="put"> 
-                               <string>columns</string> 
-                               <string>joinkey0</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>serialization.sort.order</string> 
-                               <string>+</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>columns.types</string> 
-                               <string>string</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="numDistributionKeys"> 
-                           <int>1</int> 
-                          </void> 
-                          <void property="numReducers"> 
-                           <int>-1</int> 
-                          </void> 
-                          <void property="outputKeyColumnNames"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <string>reducesinkkey0</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="outputValueColumnNames"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <string>_col0</string> 
-                            </void> 
-                            <void method="add"> 
-                             <string>_col1</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="partitionCols"> 
-                           <object idref="ArrayList2"/> 
-                          </void> 
-                          <void property="tag"> 
-                           <int>1</int> 
-                          </void> 
-                          <void property="valueCols"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object idref="ExprNodeColumnDesc5"/> 
-                            </void> 
-                            <void method="add"> 
-                             <object idref="ExprNodeColumnDesc4"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="valueSerializeInfo"> 
-                           <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                            <void property="deserializerClass"> 
-                             <class>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</class> 
-                            </void> 
-                            <void property="inputFileFormatClass"> 
-                             <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                            </void> 
-                            <void property="outputFileFormatClass"> 
-                             <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                            </void> 
-                            <void property="properties"> 
-                             <object class="java.util.Properties"> 
-                              <void method="put"> 
-                               <string>columns</string> 
-                               <string>_col0,_col1</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>columns.types</string> 
-                               <string>string,string</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>escape.delim</string> 
-                               <string>\</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="counterNames"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_RS_443_NUM_INPUT_ROWS</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_RS_443_NUM_OUTPUT_ROWS</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_RS_443_TIME_TAKEN</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_RS_443_FATAL_ERROR</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="operatorId"> 
-                         <string>RS_443</string> 
-                        </void> 
-                        <void property="parentOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object idref="SelectOperator1"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="schema"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                          <void property="signature"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>VALUE._col0</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string>b</string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>VALUE._col1</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string>b</string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
+                   <object id="ReduceSinkOperator1" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
                     <void property="columnExprMap"> 
                      <object class="java.util.HashMap"> 
                       <void method="put"> 
-                       <string>_col1</string> 
-                       <object id="ExprNodeColumnDesc6" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <string>VALUE._col1</string> 
+                       <object id="ExprNodeColumnDesc4" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
                         <void property="column"> 
-                         <string>value</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src2</string> 
+                         <string>_col1</string> 
                         </void> 
                         <void property="typeInfo"> 
                          <object idref="PrimitiveTypeInfo0"/> 
@@ -1244,13 +889,10 @@
                        </object> 
                       </void> 
                       <void method="put"> 
-                       <string>_col0</string> 
-                       <object id="ExprNodeColumnDesc7" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <string>VALUE._col0</string> 
+                       <object id="ExprNodeColumnDesc5" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
                         <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src2</string> 
+                         <string>_col0</string> 
                         </void> 
                         <void property="typeInfo"> 
                          <object idref="PrimitiveTypeInfo0"/> 
@@ -1260,18 +902,67 @@
                      </object> 
                     </void> 
                     <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                      <void property="colList"> 
-                       <object class="java.util.ArrayList"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
+                      <void property="distinctColumnIndices"> 
+                       <object class="java.util.ArrayList"/> 
+                      </void> 
+                      <void property="keyCols"> 
+                       <object id="ArrayList2" class="java.util.ArrayList"> 
                         <void method="add"> 
-                         <object idref="ExprNodeColumnDesc7"/> 
+                         <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                          <void property="column"> 
+                           <string>_col0</string> 
+                          </void> 
+                          <void property="typeInfo"> 
+                           <object idref="PrimitiveTypeInfo0"/> 
+                          </void> 
+                         </object> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="keySerializeInfo"> 
+                       <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                        <void property="deserializerClass"> 
+                         <class>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</class> 
+                        </void> 
+                        <void property="inputFileFormatClass"> 
+                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                        </void> 
+                        <void property="outputFileFormatClass"> 
+                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                        </void> 
+                        <void property="properties"> 
+                         <object class="java.util.Properties"> 
+                          <void method="put"> 
+                           <string>columns</string> 
+                           <string>joinkey0</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>serialization.sort.order</string> 
+                           <string>+</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>columns.types</string> 
+                           <string>string</string> 
+                          </void> 
+                         </object> 
                         </void> 
+                       </object> 
+                      </void> 
+                      <void property="numDistributionKeys"> 
+                       <int>1</int> 
+                      </void> 
+                      <void property="numReducers"> 
+                       <int>-1</int> 
+                      </void> 
+                      <void property="outputKeyColumnNames"> 
+                       <object class="java.util.ArrayList"> 
                         <void method="add"> 
-                         <object idref="ExprNodeColumnDesc6"/> 
+                         <string>reducesinkkey0</string> 
                         </void> 
                        </object> 
                       </void> 
-                      <void property="outputColumnNames"> 
+                      <void property="outputValueColumnNames"> 
                        <object class="java.util.ArrayList"> 
                         <void method="add"> 
                          <string>_col0</string> 
@@ -1281,31 +972,76 @@
                         </void> 
                        </object> 
                       </void> 
+                      <void property="partitionCols"> 
+                       <object idref="ArrayList2"/> 
+                      </void> 
+                      <void property="tag"> 
+                       <int>1</int> 
+                      </void> 
+                      <void property="valueCols"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <object idref="ExprNodeColumnDesc5"/> 
+                        </void> 
+                        <void method="add"> 
+                         <object idref="ExprNodeColumnDesc4"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="valueSerializeInfo"> 
+                       <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                        <void property="deserializerClass"> 
+                         <class>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</class> 
+                        </void> 
+                        <void property="inputFileFormatClass"> 
+                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                        </void> 
+                        <void property="outputFileFormatClass"> 
+                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                        </void> 
+                        <void property="properties"> 
+                         <object class="java.util.Properties"> 
+                          <void method="put"> 
+                           <string>columns</string> 
+                           <string>_col0,_col1</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>columns.types</string> 
+                           <string>string,string</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>escape.delim</string> 
+                           <string>\</string> 
+                          </void> 
+                         </object> 
+                        </void> 
+                       </object> 
+                      </void> 
                      </object> 
                     </void> 
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_438_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_RS_433_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_438_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_RS_433_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_438_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_RS_433_TIME_TAKEN</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_438_FATAL_ERROR</string> 
+                       <string>CNTR_NAME_RS_433_FATAL_ERROR</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>SEL_438</string> 
+                     <string>RS_433</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object idref="FilterOperator3"/> 
+                       <object idref="SelectOperator1"/> 
                       </void> 
                      </object> 
                     </void> 
@@ -1316,7 +1052,10 @@
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                           <void property="internalName"> 
-                           <string>_col0</string> 
+                           <string>VALUE._col0</string> 
+                          </void> 
+                          <void property="tabAlias"> 
+                           <string>b</string> 
                           </void> 
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
@@ -1326,7 +1065,10 @@
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                           <void property="internalName"> 
-                           <string>_col1</string> 
+                           <string>VALUE._col1</string> 
+                          </void> 
+                          <void property="tabAlias"> 
+                           <string>b</string> 
                           </void> 
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
@@ -1341,93 +1083,57 @@
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-                  <void property="predicate"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="childExprs"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>key</string> 
-                            </void> 
-                            <void property="tabAlias"> 
-                             <string>src2</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <int>15</int> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan"/> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo2"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>key</string> 
-                            </void> 
-                            <void property="tabAlias"> 
-                             <string>src2</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <int>25</int> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo2"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                <void property="columnExprMap"> 
+                 <object class="java.util.HashMap"> 
+                  <void method="put"> 
+                   <string>_col1</string> 
+                   <object id="ExprNodeColumnDesc6" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>value</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd"/> 
+                    <void property="tabAlias"> 
+                     <string>src2</string> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="put"> 
+                   <string>_col0</string> 
+                   <object id="ExprNodeColumnDesc7" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>key</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string>src2</string> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="conf"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                  <void property="colList"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object idref="ExprNodeColumnDesc7"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="ExprNodeColumnDesc6"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void property="outputColumnNames"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <string>_col0</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col1</string> 
                     </void> 
                    </object> 
                   </void> 
@@ -1436,26 +1142,26 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_437_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_428_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_437_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_428_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_437_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_SEL_428_TIME_TAKEN</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_437_FATAL_ERROR</string> 
+                   <string>CNTR_NAME_SEL_428_FATAL_ERROR</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>FIL_437</string> 
+                 <string>SEL_428</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object idref="FilterOperator2"/> 
+                   <object idref="FilterOperator1"/> 
                   </void> 
                  </object> 
                 </void> 
@@ -1464,12 +1170,9 @@
                   <void property="signature"> 
                    <object class="java.util.ArrayList"> 
                     <void method="add"> 
-                     <object id="ColumnInfo2" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                       <void property="internalName"> 
-                       <string>key</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>src2</string> 
+                       <string>_col0</string> 
                       </void> 
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
@@ -1477,12 +1180,9 @@
                      </object> 
                     </void> 
                     <void method="add"> 
-                     <object id="ColumnInfo3" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                       <void property="internalName"> 
-                       <string>value</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>src2</string> 
+                       <string>_col1</string> 
                       </void> 
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
@@ -1592,21 +1292,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_449_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_439_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_449_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_439_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_449_TIME_TAKEN</string> 
+               <string>CNTR_NAME_FIL_439_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_449_FATAL_ERROR</string> 
+               <string>CNTR_NAME_FIL_439_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>FIL_449</string> 
+             <string>FIL_439</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -1620,10 +1320,30 @@
               <void property="signature"> 
                <object id="ArrayList3" class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <object idref="ColumnInfo2"/> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>key</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>src2</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
                 </void> 
                 <void method="add"> 
-                 <object idref="ColumnInfo3"/> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>value</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>src2</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
                 </void> 
                 <void method="add"> 
                  <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
@@ -1678,16 +1398,16 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_436_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_426_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_436_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_426_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_436_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_426_TIME_TAKEN</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_436_FATAL_ERROR</string> 
+           <string>CNTR_NAME_TS_426_FATAL_ERROR</string> 
           </void> 
          </object> 
         </void> 
@@ -1702,7 +1422,7 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_436</string> 
+         <string>TS_426</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -1943,21 +1663,21 @@
                   <void property="counterNames"> 
                    <object class="java.util.ArrayList"> 
                     <void method="add"> 
-                     <string>CNTR_NAME_FS_447_NUM_INPUT_ROWS</string> 
+                     <string>CNTR_NAME_FS_437_NUM_INPUT_ROWS</string> 
                     </void> 
                     <void method="add"> 
-                     <string>CNTR_NAME_FS_447_NUM_OUTPUT_ROWS</string> 
+                     <string>CNTR_NAME_FS_437_NUM_OUTPUT_ROWS</string> 
                     </void> 
                     <void method="add"> 
-                     <string>CNTR_NAME_FS_447_TIME_TAKEN</string> 
+                     <string>CNTR_NAME_FS_437_TIME_TAKEN</string> 
                     </void> 
                     <void method="add"> 
-                     <string>CNTR_NAME_FS_447_FATAL_ERROR</string> 
+                     <string>CNTR_NAME_FS_437_FATAL_ERROR</string> 
                     </void> 
                    </object> 
                   </void> 
                   <void property="operatorId"> 
-                   <string>FS_447</string> 
+                   <string>FS_437</string> 
                   </void> 
                   <void property="parentOperators"> 
                    <object class="java.util.ArrayList"> 
@@ -2117,21 +1837,21 @@
               <void property="counterNames"> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>CNTR_NAME_SEL_446_NUM_INPUT_ROWS</string> 
+                 <string>CNTR_NAME_SEL_436_NUM_INPUT_ROWS</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_SEL_446_NUM_OUTPUT_ROWS</string> 
+                 <string>CNTR_NAME_SEL_436_NUM_OUTPUT_ROWS</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_SEL_446_TIME_TAKEN</string> 
+                 <string>CNTR_NAME_SEL_436_TIME_TAKEN</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_SEL_446_FATAL_ERROR</string> 
+                 <string>CNTR_NAME_SEL_436_FATAL_ERROR</string> 
                 </void> 
                </object> 
               </void> 
               <void property="operatorId"> 
-               <string>SEL_446</string> 
+               <string>SEL_436</string> 
               </void> 
               <void property="parentOperators"> 
                <object class="java.util.ArrayList"> 
@@ -2315,21 +2035,21 @@
           <void property="counterNames"> 
            <object class="java.util.ArrayList"> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_445_NUM_INPUT_ROWS</string> 
+             <string>CNTR_NAME_SEL_435_NUM_INPUT_ROWS</string> 
             </void> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_445_NUM_OUTPUT_ROWS</string> 
+             <string>CNTR_NAME_SEL_435_NUM_OUTPUT_ROWS</string> 
             </void> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_445_TIME_TAKEN</string> 
+             <string>CNTR_NAME_SEL_435_TIME_TAKEN</string> 
             </void> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_445_FATAL_ERROR</string> 
+             <string>CNTR_NAME_SEL_435_FATAL_ERROR</string> 
             </void> 
            </object> 
           </void> 
           <void property="operatorId"> 
-           <string>SEL_445</string> 
+           <string>SEL_435</string> 
           </void> 
           <void property="parentOperators"> 
            <object class="java.util.ArrayList"> 
@@ -2555,21 +2275,21 @@
       <void property="counterNames"> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
-         <string>CNTR_NAME_JOIN_444_NUM_INPUT_ROWS</string> 
+         <string>CNTR_NAME_JOIN_434_NUM_INPUT_ROWS</string> 
         </void> 
         <void method="add"> 
-         <string>CNTR_NAME_JOIN_444_NUM_OUTPUT_ROWS</string> 
+         <string>CNTR_NAME_JOIN_434_NUM_OUTPUT_ROWS</string> 
         </void> 
         <void method="add"> 
-         <string>CNTR_NAME_JOIN_444_TIME_TAKEN</string> 
+         <string>CNTR_NAME_JOIN_434_TIME_TAKEN</string> 
         </void> 
         <void method="add"> 
-         <string>CNTR_NAME_JOIN_444_FATAL_ERROR</string> 
+         <string>CNTR_NAME_JOIN_434_FATAL_ERROR</string> 
         </void> 
        </object> 
       </void> 
       <void property="operatorId"> 
-       <string>JOIN_444</string> 
+       <string>JOIN_434</string> 
       </void> 
       <void property="parentOperators"> 
        <object class="java.util.ArrayList"> 
diff --git a/ql/src/test/results/compiler/plan/join7.q.xml b/ql/src/test/results/compiler/plan/join7.q.xml
index fab235f528..5bf71fad21 100644
--- a/ql/src/test/results/compiler/plan/join7.q.xml
+++ b/ql/src/test/results/compiler/plan/join7.q.xml
@@ -416,248 +416,33 @@
             <void property="childOperators"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+               <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                    <void property="childOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object id="ReduceSinkOperator0" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
-                        <void property="columnExprMap"> 
-                         <object class="java.util.HashMap"> 
-                          <void method="put"> 
-                           <string>VALUE._col1</string> 
-                           <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>_col1</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                              <void property="typeName"> 
-                               <string>string</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="put"> 
-                           <string>VALUE._col0</string> 
-                           <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>_col0</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="conf"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
-                          <void property="distinctColumnIndices"> 
-                           <object class="java.util.ArrayList"/> 
-                          </void> 
-                          <void property="keyCols"> 
-                           <object id="ArrayList0" class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                              <void property="column"> 
-                               <string>_col0</string> 
-                              </void> 
-                              <void property="typeInfo"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="keySerializeInfo"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                            <void property="deserializerClass"> 
-                             <class>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</class> 
-                            </void> 
-                            <void property="inputFileFormatClass"> 
-                             <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                            </void> 
-                            <void property="outputFileFormatClass"> 
-                             <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                            </void> 
-                            <void property="properties"> 
-                             <object class="java.util.Properties"> 
-                              <void method="put"> 
-                               <string>columns</string> 
-                               <string>joinkey0</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>serialization.sort.order</string> 
-                               <string>+</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>columns.types</string> 
-                               <string>string</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="numDistributionKeys"> 
-                           <int>1</int> 
-                          </void> 
-                          <void property="numReducers"> 
-                           <int>-1</int> 
-                          </void> 
-                          <void property="outputKeyColumnNames"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <string>reducesinkkey0</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="outputValueColumnNames"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <string>_col0</string> 
-                            </void> 
-                            <void method="add"> 
-                             <string>_col1</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="partitionCols"> 
-                           <object idref="ArrayList0"/> 
-                          </void> 
-                          <void property="valueCols"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object idref="ExprNodeColumnDesc1"/> 
-                            </void> 
-                            <void method="add"> 
-                             <object idref="ExprNodeColumnDesc0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="valueSerializeInfo"> 
-                           <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                            <void property="deserializerClass"> 
-                             <class>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</class> 
-                            </void> 
-                            <void property="inputFileFormatClass"> 
-                             <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                            </void> 
-                            <void property="outputFileFormatClass"> 
-                             <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                            </void> 
-                            <void property="properties"> 
-                             <object class="java.util.Properties"> 
-                              <void method="put"> 
-                               <string>columns</string> 
-                               <string>_col0,_col1</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>columns.types</string> 
-                               <string>string,string</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>escape.delim</string> 
-                               <string>\</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="counterNames"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_RS_473_NUM_INPUT_ROWS</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_RS_473_NUM_OUTPUT_ROWS</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_RS_473_TIME_TAKEN</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_RS_473_FATAL_ERROR</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="operatorId"> 
-                         <string>RS_473</string> 
-                        </void> 
-                        <void property="parentOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object idref="SelectOperator0"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="schema"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                          <void property="signature"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>VALUE._col0</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string>a</string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>VALUE._col1</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string>a</string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
+                   <object id="ReduceSinkOperator0" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
                     <void property="columnExprMap"> 
                      <object class="java.util.HashMap"> 
                       <void method="put"> 
-                       <string>_col1</string> 
-                       <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <string>VALUE._col1</string> 
+                       <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
                         <void property="column"> 
-                         <string>value</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src1</string> 
+                         <string>_col1</string> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
+                         <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
+                         </object> 
                         </void> 
                        </object> 
                       </void> 
                       <void method="put"> 
-                       <string>_col0</string> 
-                       <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <string>VALUE._col0</string> 
+                       <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
                         <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src1</string> 
+                         <string>_col0</string> 
                         </void> 
                         <void property="typeInfo"> 
                          <object idref="PrimitiveTypeInfo0"/> 
@@ -667,18 +452,67 @@
                      </object> 
                     </void> 
                     <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                      <void property="colList"> 
-                       <object class="java.util.ArrayList"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
+                      <void property="distinctColumnIndices"> 
+                       <object class="java.util.ArrayList"/> 
+                      </void> 
+                      <void property="keyCols"> 
+                       <object id="ArrayList0" class="java.util.ArrayList"> 
                         <void method="add"> 
-                         <object idref="ExprNodeColumnDesc3"/> 
+                         <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                          <void property="column"> 
+                           <string>_col0</string> 
+                          </void> 
+                          <void property="typeInfo"> 
+                           <object idref="PrimitiveTypeInfo0"/> 
+                          </void> 
+                         </object> 
                         </void> 
+                       </object> 
+                      </void> 
+                      <void property="keySerializeInfo"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                        <void property="deserializerClass"> 
+                         <class>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</class> 
+                        </void> 
+                        <void property="inputFileFormatClass"> 
+                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                        </void> 
+                        <void property="outputFileFormatClass"> 
+                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                        </void> 
+                        <void property="properties"> 
+                         <object class="java.util.Properties"> 
+                          <void method="put"> 
+                           <string>columns</string> 
+                           <string>joinkey0</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>serialization.sort.order</string> 
+                           <string>+</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>columns.types</string> 
+                           <string>string</string> 
+                          </void> 
+                         </object> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="numDistributionKeys"> 
+                       <int>1</int> 
+                      </void> 
+                      <void property="numReducers"> 
+                       <int>-1</int> 
+                      </void> 
+                      <void property="outputKeyColumnNames"> 
+                       <object class="java.util.ArrayList"> 
                         <void method="add"> 
-                         <object idref="ExprNodeColumnDesc2"/> 
+                         <string>reducesinkkey0</string> 
                         </void> 
                        </object> 
                       </void> 
-                      <void property="outputColumnNames"> 
+                      <void property="outputValueColumnNames"> 
                        <object class="java.util.ArrayList"> 
                         <void method="add"> 
                          <string>_col0</string> 
@@ -688,31 +522,73 @@
                         </void> 
                        </object> 
                       </void> 
+                      <void property="partitionCols"> 
+                       <object idref="ArrayList0"/> 
+                      </void> 
+                      <void property="valueCols"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <object idref="ExprNodeColumnDesc1"/> 
+                        </void> 
+                        <void method="add"> 
+                         <object idref="ExprNodeColumnDesc0"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="valueSerializeInfo"> 
+                       <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                        <void property="deserializerClass"> 
+                         <class>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</class> 
+                        </void> 
+                        <void property="inputFileFormatClass"> 
+                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                        </void> 
+                        <void property="outputFileFormatClass"> 
+                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                        </void> 
+                        <void property="properties"> 
+                         <object class="java.util.Properties"> 
+                          <void method="put"> 
+                           <string>columns</string> 
+                           <string>_col0,_col1</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>columns.types</string> 
+                           <string>string,string</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>escape.delim</string> 
+                           <string>\</string> 
+                          </void> 
+                         </object> 
+                        </void> 
+                       </object> 
+                      </void> 
                      </object> 
                     </void> 
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_472_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_RS_461_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_472_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_RS_461_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_472_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_RS_461_TIME_TAKEN</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_472_FATAL_ERROR</string> 
+                       <string>CNTR_NAME_RS_461_FATAL_ERROR</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>SEL_472</string> 
+                     <string>RS_461</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object idref="FilterOperator1"/> 
+                       <object idref="SelectOperator0"/> 
                       </void> 
                      </object> 
                     </void> 
@@ -723,7 +599,10 @@
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                           <void property="internalName"> 
-                           <string>_col0</string> 
+                           <string>VALUE._col0</string> 
+                          </void> 
+                          <void property="tabAlias"> 
+                           <string>a</string> 
                           </void> 
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
@@ -733,7 +612,10 @@
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                           <void property="internalName"> 
-                           <string>_col1</string> 
+                           <string>VALUE._col1</string> 
+                          </void> 
+                          <void property="tabAlias"> 
+                           <string>a</string> 
                           </void> 
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
@@ -748,101 +630,57 @@
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-                  <void property="predicate"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="childExprs"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>key</string> 
-                            </void> 
-                            <void property="tabAlias"> 
-                             <string>src1</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                              <void property="typeName"> 
-                               <string>int</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="value"> 
-                             <int>10</int> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan"/> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>boolean</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>key</string> 
-                            </void> 
-                            <void property="tabAlias"> 
-                             <string>src1</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <int>20</int> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo2"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                <void property="columnExprMap"> 
+                 <object class="java.util.HashMap"> 
+                  <void method="put"> 
+                   <string>_col1</string> 
+                   <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>value</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd"/> 
+                    <void property="tabAlias"> 
+                     <string>src1</string> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="put"> 
+                   <string>_col0</string> 
+                   <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>key</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string>src1</string> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="conf"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                  <void property="colList"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object idref="ExprNodeColumnDesc3"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="ExprNodeColumnDesc2"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void property="outputColumnNames"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <string>_col0</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col1</string> 
                     </void> 
                    </object> 
                   </void> 
@@ -851,21 +689,21 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_471_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_460_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_471_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_460_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_471_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_SEL_460_TIME_TAKEN</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_471_FATAL_ERROR</string> 
+                   <string>CNTR_NAME_SEL_460_FATAL_ERROR</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>FIL_471</string> 
+                 <string>SEL_460</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -879,12 +717,9 @@
                   <void property="signature"> 
                    <object class="java.util.ArrayList"> 
                     <void method="add"> 
-                     <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                       <void property="internalName"> 
-                       <string>key</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>src1</string> 
+                       <string>_col0</string> 
                       </void> 
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
@@ -892,12 +727,9 @@
                      </object> 
                     </void> 
                     <void method="add"> 
-                     <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                       <void property="internalName"> 
-                       <string>value</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>src1</string> 
+                       <string>_col1</string> 
                       </void> 
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
@@ -938,7 +770,11 @@
                       <void method="add"> 
                        <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
+                         <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                          <void property="typeName"> 
+                           <string>int</string> 
+                          </void> 
+                         </object> 
                         </void> 
                         <void property="value"> 
                          <int>10</int> 
@@ -951,7 +787,11 @@
                      <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan"/> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                     <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                      <void property="typeName"> 
+                       <string>boolean</string> 
+                      </void> 
+                     </object> 
                     </void> 
                    </object> 
                   </void> 
@@ -1007,21 +847,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_480_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_468_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_480_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_468_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_480_TIME_TAKEN</string> 
+               <string>CNTR_NAME_FIL_468_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_480_FATAL_ERROR</string> 
+               <string>CNTR_NAME_FIL_468_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>FIL_480</string> 
+             <string>FIL_468</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -1035,10 +875,30 @@
               <void property="signature"> 
                <object id="ArrayList1" class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <object idref="ColumnInfo0"/> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>key</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>src1</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
                 </void> 
                 <void method="add"> 
-                 <object idref="ColumnInfo1"/> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>value</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>src1</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
                 </void> 
                 <void method="add"> 
                  <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
@@ -1097,16 +957,16 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_470_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_458_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_470_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_458_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_470_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_458_TIME_TAKEN</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_470_FATAL_ERROR</string> 
+           <string>CNTR_NAME_TS_458_FATAL_ERROR</string> 
           </void> 
          </object> 
         </void> 
@@ -1121,7 +981,7 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_470</string> 
+         <string>TS_458</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -1138,237 +998,22 @@
         <void property="childOperators"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <object id="FilterOperator2" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+           <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
             <void property="childOperators"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <object id="FilterOperator3" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+               <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                    <void property="childOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object id="ReduceSinkOperator1" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
-                        <void property="columnExprMap"> 
-                         <object class="java.util.HashMap"> 
-                          <void method="put"> 
-                           <string>VALUE._col1</string> 
-                           <object id="ExprNodeColumnDesc4" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>_col1</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="put"> 
-                           <string>VALUE._col0</string> 
-                           <object id="ExprNodeColumnDesc5" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>_col0</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="conf"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
-                          <void property="distinctColumnIndices"> 
-                           <object class="java.util.ArrayList"/> 
-                          </void> 
-                          <void property="keyCols"> 
-                           <object id="ArrayList2" class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                              <void property="column"> 
-                               <string>_col0</string> 
-                              </void> 
-                              <void property="typeInfo"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="keySerializeInfo"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                            <void property="deserializerClass"> 
-                             <class>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</class> 
-                            </void> 
-                            <void property="inputFileFormatClass"> 
-                             <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                            </void> 
-                            <void property="outputFileFormatClass"> 
-                             <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                            </void> 
-                            <void property="properties"> 
-                             <object class="java.util.Properties"> 
-                              <void method="put"> 
-                               <string>columns</string> 
-                               <string>joinkey0</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>serialization.sort.order</string> 
-                               <string>+</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>columns.types</string> 
-                               <string>string</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="numDistributionKeys"> 
-                           <int>1</int> 
-                          </void> 
-                          <void property="numReducers"> 
-                           <int>-1</int> 
-                          </void> 
-                          <void property="outputKeyColumnNames"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <string>reducesinkkey0</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="outputValueColumnNames"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <string>_col0</string> 
-                            </void> 
-                            <void method="add"> 
-                             <string>_col1</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="partitionCols"> 
-                           <object idref="ArrayList2"/> 
-                          </void> 
-                          <void property="tag"> 
-                           <int>1</int> 
-                          </void> 
-                          <void property="valueCols"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object idref="ExprNodeColumnDesc5"/> 
-                            </void> 
-                            <void method="add"> 
-                             <object idref="ExprNodeColumnDesc4"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="valueSerializeInfo"> 
-                           <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                            <void property="deserializerClass"> 
-                             <class>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</class> 
-                            </void> 
-                            <void property="inputFileFormatClass"> 
-                             <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                            </void> 
-                            <void property="outputFileFormatClass"> 
-                             <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                            </void> 
-                            <void property="properties"> 
-                             <object class="java.util.Properties"> 
-                              <void method="put"> 
-                               <string>columns</string> 
-                               <string>_col0,_col1</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>columns.types</string> 
-                               <string>string,string</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>escape.delim</string> 
-                               <string>\</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="counterNames"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_RS_474_NUM_INPUT_ROWS</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_RS_474_NUM_OUTPUT_ROWS</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_RS_474_TIME_TAKEN</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_RS_474_FATAL_ERROR</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="operatorId"> 
-                         <string>RS_474</string> 
-                        </void> 
-                        <void property="parentOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object idref="SelectOperator1"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="schema"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                          <void property="signature"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>VALUE._col0</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string>b</string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>VALUE._col1</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string>b</string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
+                   <object id="ReduceSinkOperator1" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
                     <void property="columnExprMap"> 
                      <object class="java.util.HashMap"> 
                       <void method="put"> 
-                       <string>_col1</string> 
-                       <object id="ExprNodeColumnDesc6" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <string>VALUE._col1</string> 
+                       <object id="ExprNodeColumnDesc4" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
                         <void property="column"> 
-                         <string>value</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src2</string> 
+                         <string>_col1</string> 
                         </void> 
                         <void property="typeInfo"> 
                          <object idref="PrimitiveTypeInfo0"/> 
@@ -1376,13 +1021,10 @@
                        </object> 
                       </void> 
                       <void method="put"> 
-                       <string>_col0</string> 
-                       <object id="ExprNodeColumnDesc7" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <string>VALUE._col0</string> 
+                       <object id="ExprNodeColumnDesc5" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
                         <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src2</string> 
+                         <string>_col0</string> 
                         </void> 
                         <void property="typeInfo"> 
                          <object idref="PrimitiveTypeInfo0"/> 
@@ -1392,18 +1034,67 @@
                      </object> 
                     </void> 
                     <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                      <void property="colList"> 
-                       <object class="java.util.ArrayList"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
+                      <void property="distinctColumnIndices"> 
+                       <object class="java.util.ArrayList"/> 
+                      </void> 
+                      <void property="keyCols"> 
+                       <object id="ArrayList2" class="java.util.ArrayList"> 
                         <void method="add"> 
-                         <object idref="ExprNodeColumnDesc7"/> 
+                         <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                          <void property="column"> 
+                           <string>_col0</string> 
+                          </void> 
+                          <void property="typeInfo"> 
+                           <object idref="PrimitiveTypeInfo0"/> 
+                          </void> 
+                         </object> 
                         </void> 
+                       </object> 
+                      </void> 
+                      <void property="keySerializeInfo"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                        <void property="deserializerClass"> 
+                         <class>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</class> 
+                        </void> 
+                        <void property="inputFileFormatClass"> 
+                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                        </void> 
+                        <void property="outputFileFormatClass"> 
+                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                        </void> 
+                        <void property="properties"> 
+                         <object class="java.util.Properties"> 
+                          <void method="put"> 
+                           <string>columns</string> 
+                           <string>joinkey0</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>serialization.sort.order</string> 
+                           <string>+</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>columns.types</string> 
+                           <string>string</string> 
+                          </void> 
+                         </object> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="numDistributionKeys"> 
+                       <int>1</int> 
+                      </void> 
+                      <void property="numReducers"> 
+                       <int>-1</int> 
+                      </void> 
+                      <void property="outputKeyColumnNames"> 
+                       <object class="java.util.ArrayList"> 
                         <void method="add"> 
-                         <object idref="ExprNodeColumnDesc6"/> 
+                         <string>reducesinkkey0</string> 
                         </void> 
                        </object> 
                       </void> 
-                      <void property="outputColumnNames"> 
+                      <void property="outputValueColumnNames"> 
                        <object class="java.util.ArrayList"> 
                         <void method="add"> 
                          <string>_col0</string> 
@@ -1413,31 +1104,76 @@
                         </void> 
                        </object> 
                       </void> 
+                      <void property="partitionCols"> 
+                       <object idref="ArrayList2"/> 
+                      </void> 
+                      <void property="tag"> 
+                       <int>1</int> 
+                      </void> 
+                      <void property="valueCols"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <object idref="ExprNodeColumnDesc5"/> 
+                        </void> 
+                        <void method="add"> 
+                         <object idref="ExprNodeColumnDesc4"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="valueSerializeInfo"> 
+                       <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                        <void property="deserializerClass"> 
+                         <class>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</class> 
+                        </void> 
+                        <void property="inputFileFormatClass"> 
+                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                        </void> 
+                        <void property="outputFileFormatClass"> 
+                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                        </void> 
+                        <void property="properties"> 
+                         <object class="java.util.Properties"> 
+                          <void method="put"> 
+                           <string>columns</string> 
+                           <string>_col0,_col1</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>columns.types</string> 
+                           <string>string,string</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>escape.delim</string> 
+                           <string>\</string> 
+                          </void> 
+                         </object> 
+                        </void> 
+                       </object> 
+                      </void> 
                      </object> 
                     </void> 
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_466_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_RS_462_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_466_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_RS_462_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_466_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_RS_462_TIME_TAKEN</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_466_FATAL_ERROR</string> 
+                       <string>CNTR_NAME_RS_462_FATAL_ERROR</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>SEL_466</string> 
+                     <string>RS_462</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object idref="FilterOperator3"/> 
+                       <object idref="SelectOperator1"/> 
                       </void> 
                      </object> 
                     </void> 
@@ -1448,7 +1184,10 @@
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                           <void property="internalName"> 
-                           <string>_col0</string> 
+                           <string>VALUE._col0</string> 
+                          </void> 
+                          <void property="tabAlias"> 
+                           <string>b</string> 
                           </void> 
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
@@ -1458,108 +1197,75 @@
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                           <void property="internalName"> 
-                           <string>_col1</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-                  <void property="predicate"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="childExprs"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>key</string> 
-                            </void> 
-                            <void property="tabAlias"> 
-                             <string>src2</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <int>15</int> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan"/> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo2"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>key</string> 
-                            </void> 
-                            <void property="tabAlias"> 
-                             <string>src2</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
+                           <string>VALUE._col1</string> 
                           </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <int>25</int> 
-                            </void> 
-                           </object> 
+                          <void property="tabAlias"> 
+                           <string>b</string> 
+                          </void> 
+                          <void property="type"> 
+                           <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
                          </object> 
                         </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo2"/> 
-                        </void> 
                        </object> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd"/> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="columnExprMap"> 
+                 <object class="java.util.HashMap"> 
+                  <void method="put"> 
+                   <string>_col1</string> 
+                   <object id="ExprNodeColumnDesc6" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>value</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string>src2</string> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="put"> 
+                   <string>_col0</string> 
+                   <object id="ExprNodeColumnDesc7" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>key</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string>src2</string> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="conf"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                  <void property="colList"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object idref="ExprNodeColumnDesc7"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="ExprNodeColumnDesc6"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void property="outputColumnNames"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <string>_col0</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col1</string> 
                     </void> 
                    </object> 
                   </void> 
@@ -1568,26 +1274,26 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_465_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_454_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_465_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_454_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_465_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_SEL_454_TIME_TAKEN</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_465_FATAL_ERROR</string> 
+                   <string>CNTR_NAME_SEL_454_FATAL_ERROR</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>FIL_465</string> 
+                 <string>SEL_454</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object idref="FilterOperator2"/> 
+                   <object idref="FilterOperator1"/> 
                   </void> 
                  </object> 
                 </void> 
@@ -1596,12 +1302,9 @@
                   <void property="signature"> 
                    <object class="java.util.ArrayList"> 
                     <void method="add"> 
-                     <object id="ColumnInfo2" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                       <void property="internalName"> 
-                       <string>key</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>src2</string> 
+                       <string>_col0</string> 
                       </void> 
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
@@ -1609,12 +1312,9 @@
                      </object> 
                     </void> 
                     <void method="add"> 
-                     <object id="ColumnInfo3" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                       <void property="internalName"> 
-                       <string>value</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>src2</string> 
+                       <string>_col1</string> 
                       </void> 
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
@@ -1724,21 +1424,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_481_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_469_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_481_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_469_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_481_TIME_TAKEN</string> 
+               <string>CNTR_NAME_FIL_469_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_481_FATAL_ERROR</string> 
+               <string>CNTR_NAME_FIL_469_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>FIL_481</string> 
+             <string>FIL_469</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -1752,10 +1452,30 @@
               <void property="signature"> 
                <object id="ArrayList3" class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <object idref="ColumnInfo2"/> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>key</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>src2</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
                 </void> 
                 <void method="add"> 
-                 <object idref="ColumnInfo3"/> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>value</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>src2</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
                 </void> 
                 <void method="add"> 
                  <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
@@ -1810,16 +1530,16 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_464_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_452_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_464_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_452_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_464_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_452_TIME_TAKEN</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_464_FATAL_ERROR</string> 
+           <string>CNTR_NAME_TS_452_FATAL_ERROR</string> 
           </void> 
          </object> 
         </void> 
@@ -1834,7 +1554,7 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_464</string> 
+         <string>TS_452</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -1851,237 +1571,22 @@
         <void property="childOperators"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <object id="FilterOperator4" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+           <object id="FilterOperator2" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
             <void property="childOperators"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <object id="FilterOperator5" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+               <object id="SelectOperator2" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object id="SelectOperator2" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                    <void property="childOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object id="ReduceSinkOperator2" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
-                        <void property="columnExprMap"> 
-                         <object class="java.util.HashMap"> 
-                          <void method="put"> 
-                           <string>VALUE._col1</string> 
-                           <object id="ExprNodeColumnDesc8" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>_col1</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="put"> 
-                           <string>VALUE._col0</string> 
-                           <object id="ExprNodeColumnDesc9" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>_col0</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="conf"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
-                          <void property="distinctColumnIndices"> 
-                           <object class="java.util.ArrayList"/> 
-                          </void> 
-                          <void property="keyCols"> 
-                           <object id="ArrayList4" class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                              <void property="column"> 
-                               <string>_col0</string> 
-                              </void> 
-                              <void property="typeInfo"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="keySerializeInfo"> 
-                           <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                            <void property="deserializerClass"> 
-                             <class>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</class> 
-                            </void> 
-                            <void property="inputFileFormatClass"> 
-                             <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                            </void> 
-                            <void property="outputFileFormatClass"> 
-                             <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                            </void> 
-                            <void property="properties"> 
-                             <object class="java.util.Properties"> 
-                              <void method="put"> 
-                               <string>columns</string> 
-                               <string>joinkey0</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>serialization.sort.order</string> 
-                               <string>+</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>columns.types</string> 
-                               <string>string</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="numDistributionKeys"> 
-                           <int>1</int> 
-                          </void> 
-                          <void property="numReducers"> 
-                           <int>-1</int> 
-                          </void> 
-                          <void property="outputKeyColumnNames"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <string>reducesinkkey0</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="outputValueColumnNames"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <string>_col0</string> 
-                            </void> 
-                            <void method="add"> 
-                             <string>_col1</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="partitionCols"> 
-                           <object idref="ArrayList4"/> 
-                          </void> 
-                          <void property="tag"> 
-                           <int>2</int> 
-                          </void> 
-                          <void property="valueCols"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object idref="ExprNodeColumnDesc9"/> 
-                            </void> 
-                            <void method="add"> 
-                             <object idref="ExprNodeColumnDesc8"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="valueSerializeInfo"> 
-                           <object id="TableDesc3" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                            <void property="deserializerClass"> 
-                             <class>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</class> 
-                            </void> 
-                            <void property="inputFileFormatClass"> 
-                             <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                            </void> 
-                            <void property="outputFileFormatClass"> 
-                             <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                            </void> 
-                            <void property="properties"> 
-                             <object class="java.util.Properties"> 
-                              <void method="put"> 
-                               <string>columns</string> 
-                               <string>_col0,_col1</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>columns.types</string> 
-                               <string>string,string</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>escape.delim</string> 
-                               <string>\</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="counterNames"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_RS_475_NUM_INPUT_ROWS</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_RS_475_NUM_OUTPUT_ROWS</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_RS_475_TIME_TAKEN</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_RS_475_FATAL_ERROR</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="operatorId"> 
-                         <string>RS_475</string> 
-                        </void> 
-                        <void property="parentOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object idref="SelectOperator2"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="schema"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                          <void property="signature"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>VALUE._col0</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string>c</string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>VALUE._col1</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string>c</string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
+                   <object id="ReduceSinkOperator2" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
                     <void property="columnExprMap"> 
                      <object class="java.util.HashMap"> 
                       <void method="put"> 
-                       <string>_col1</string> 
-                       <object id="ExprNodeColumnDesc10" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <string>VALUE._col1</string> 
+                       <object id="ExprNodeColumnDesc8" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
                         <void property="column"> 
-                         <string>value</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src3</string> 
+                         <string>_col1</string> 
                         </void> 
                         <void property="typeInfo"> 
                          <object idref="PrimitiveTypeInfo0"/> 
@@ -2089,13 +1594,10 @@
                        </object> 
                       </void> 
                       <void method="put"> 
-                       <string>_col0</string> 
-                       <object id="ExprNodeColumnDesc11" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <string>VALUE._col0</string> 
+                       <object id="ExprNodeColumnDesc9" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
                         <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src3</string> 
+                         <string>_col0</string> 
                         </void> 
                         <void property="typeInfo"> 
                          <object idref="PrimitiveTypeInfo0"/> 
@@ -2105,18 +1607,67 @@
                      </object> 
                     </void> 
                     <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                      <void property="colList"> 
-                       <object class="java.util.ArrayList"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
+                      <void property="distinctColumnIndices"> 
+                       <object class="java.util.ArrayList"/> 
+                      </void> 
+                      <void property="keyCols"> 
+                       <object id="ArrayList4" class="java.util.ArrayList"> 
                         <void method="add"> 
-                         <object idref="ExprNodeColumnDesc11"/> 
+                         <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                          <void property="column"> 
+                           <string>_col0</string> 
+                          </void> 
+                          <void property="typeInfo"> 
+                           <object idref="PrimitiveTypeInfo0"/> 
+                          </void> 
+                         </object> 
                         </void> 
+                       </object> 
+                      </void> 
+                      <void property="keySerializeInfo"> 
+                       <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                        <void property="deserializerClass"> 
+                         <class>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</class> 
+                        </void> 
+                        <void property="inputFileFormatClass"> 
+                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                        </void> 
+                        <void property="outputFileFormatClass"> 
+                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                        </void> 
+                        <void property="properties"> 
+                         <object class="java.util.Properties"> 
+                          <void method="put"> 
+                           <string>columns</string> 
+                           <string>joinkey0</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>serialization.sort.order</string> 
+                           <string>+</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>columns.types</string> 
+                           <string>string</string> 
+                          </void> 
+                         </object> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="numDistributionKeys"> 
+                       <int>1</int> 
+                      </void> 
+                      <void property="numReducers"> 
+                       <int>-1</int> 
+                      </void> 
+                      <void property="outputKeyColumnNames"> 
+                       <object class="java.util.ArrayList"> 
                         <void method="add"> 
-                         <object idref="ExprNodeColumnDesc10"/> 
+                         <string>reducesinkkey0</string> 
                         </void> 
                        </object> 
                       </void> 
-                      <void property="outputColumnNames"> 
+                      <void property="outputValueColumnNames"> 
                        <object class="java.util.ArrayList"> 
                         <void method="add"> 
                          <string>_col0</string> 
@@ -2126,31 +1677,76 @@
                         </void> 
                        </object> 
                       </void> 
+                      <void property="partitionCols"> 
+                       <object idref="ArrayList4"/> 
+                      </void> 
+                      <void property="tag"> 
+                       <int>2</int> 
+                      </void> 
+                      <void property="valueCols"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <object idref="ExprNodeColumnDesc9"/> 
+                        </void> 
+                        <void method="add"> 
+                         <object idref="ExprNodeColumnDesc8"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="valueSerializeInfo"> 
+                       <object id="TableDesc3" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                        <void property="deserializerClass"> 
+                         <class>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</class> 
+                        </void> 
+                        <void property="inputFileFormatClass"> 
+                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                        </void> 
+                        <void property="outputFileFormatClass"> 
+                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                        </void> 
+                        <void property="properties"> 
+                         <object class="java.util.Properties"> 
+                          <void method="put"> 
+                           <string>columns</string> 
+                           <string>_col0,_col1</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>columns.types</string> 
+                           <string>string,string</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>escape.delim</string> 
+                           <string>\</string> 
+                          </void> 
+                         </object> 
+                        </void> 
+                       </object> 
+                      </void> 
                      </object> 
                     </void> 
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_469_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_RS_463_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_469_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_RS_463_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_469_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_RS_463_TIME_TAKEN</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_469_FATAL_ERROR</string> 
+                       <string>CNTR_NAME_RS_463_FATAL_ERROR</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>SEL_469</string> 
+                     <string>RS_463</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object idref="FilterOperator5"/> 
+                       <object idref="SelectOperator2"/> 
                       </void> 
                      </object> 
                     </void> 
@@ -2161,7 +1757,10 @@
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                           <void property="internalName"> 
-                           <string>_col0</string> 
+                           <string>VALUE._col0</string> 
+                          </void> 
+                          <void property="tabAlias"> 
+                           <string>c</string> 
                           </void> 
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
@@ -2171,7 +1770,10 @@
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                           <void property="internalName"> 
-                           <string>_col1</string> 
+                           <string>VALUE._col1</string> 
+                          </void> 
+                          <void property="tabAlias"> 
+                           <string>c</string> 
                           </void> 
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
@@ -2186,93 +1788,57 @@
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-                  <void property="predicate"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="childExprs"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>key</string> 
-                            </void> 
-                            <void property="tabAlias"> 
-                             <string>src3</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <int>20</int> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan"/> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo2"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>key</string> 
-                            </void> 
-                            <void property="tabAlias"> 
-                             <string>src3</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <int>25</int> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo2"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                <void property="columnExprMap"> 
+                 <object class="java.util.HashMap"> 
+                  <void method="put"> 
+                   <string>_col1</string> 
+                   <object id="ExprNodeColumnDesc10" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>value</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd"/> 
+                    <void property="tabAlias"> 
+                     <string>src3</string> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="put"> 
+                   <string>_col0</string> 
+                   <object id="ExprNodeColumnDesc11" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>key</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string>src3</string> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="conf"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                  <void property="colList"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object idref="ExprNodeColumnDesc11"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="ExprNodeColumnDesc10"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void property="outputColumnNames"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <string>_col0</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col1</string> 
                     </void> 
                    </object> 
                   </void> 
@@ -2281,26 +1847,26 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_468_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_457_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_468_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_457_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_468_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_SEL_457_TIME_TAKEN</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_468_FATAL_ERROR</string> 
+                   <string>CNTR_NAME_SEL_457_FATAL_ERROR</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>FIL_468</string> 
+                 <string>SEL_457</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object idref="FilterOperator4"/> 
+                   <object idref="FilterOperator2"/> 
                   </void> 
                  </object> 
                 </void> 
@@ -2309,12 +1875,9 @@
                   <void property="signature"> 
                    <object class="java.util.ArrayList"> 
                     <void method="add"> 
-                     <object id="ColumnInfo4" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                       <void property="internalName"> 
-                       <string>key</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>src3</string> 
+                       <string>_col0</string> 
                       </void> 
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
@@ -2322,12 +1885,9 @@
                      </object> 
                     </void> 
                     <void method="add"> 
-                     <object id="ColumnInfo5" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                       <void property="internalName"> 
-                       <string>value</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>src3</string> 
+                       <string>_col1</string> 
                       </void> 
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
@@ -2437,21 +1997,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_482_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_470_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_482_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_470_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_482_TIME_TAKEN</string> 
+               <string>CNTR_NAME_FIL_470_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_482_FATAL_ERROR</string> 
+               <string>CNTR_NAME_FIL_470_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>FIL_482</string> 
+             <string>FIL_470</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -2465,10 +2025,30 @@
               <void property="signature"> 
                <object id="ArrayList5" class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <object idref="ColumnInfo4"/> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>key</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>src3</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
                 </void> 
                 <void method="add"> 
-                 <object idref="ColumnInfo5"/> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>value</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>src3</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
                 </void> 
                 <void method="add"> 
                  <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
@@ -2523,16 +2103,16 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_467_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_455_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_467_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_455_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_467_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_455_TIME_TAKEN</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_467_FATAL_ERROR</string> 
+           <string>CNTR_NAME_TS_455_FATAL_ERROR</string> 
           </void> 
          </object> 
         </void> 
@@ -2547,7 +2127,7 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_467</string> 
+         <string>TS_455</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -2791,21 +2371,21 @@
                   <void property="counterNames"> 
                    <object class="java.util.ArrayList"> 
                     <void method="add"> 
-                     <string>CNTR_NAME_FS_479_NUM_INPUT_ROWS</string> 
+                     <string>CNTR_NAME_FS_467_NUM_INPUT_ROWS</string> 
                     </void> 
                     <void method="add"> 
-                     <string>CNTR_NAME_FS_479_NUM_OUTPUT_ROWS</string> 
+                     <string>CNTR_NAME_FS_467_NUM_OUTPUT_ROWS</string> 
                     </void> 
                     <void method="add"> 
-                     <string>CNTR_NAME_FS_479_TIME_TAKEN</string> 
+                     <string>CNTR_NAME_FS_467_TIME_TAKEN</string> 
                     </void> 
                     <void method="add"> 
-                     <string>CNTR_NAME_FS_479_FATAL_ERROR</string> 
+                     <string>CNTR_NAME_FS_467_FATAL_ERROR</string> 
                     </void> 
                    </object> 
                   </void> 
                   <void property="operatorId"> 
-                   <string>FS_479</string> 
+                   <string>FS_467</string> 
                   </void> 
                   <void property="parentOperators"> 
                    <object class="java.util.ArrayList"> 
@@ -3025,21 +2605,21 @@
               <void property="counterNames"> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>CNTR_NAME_SEL_478_NUM_INPUT_ROWS</string> 
+                 <string>CNTR_NAME_SEL_466_NUM_INPUT_ROWS</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_SEL_478_NUM_OUTPUT_ROWS</string> 
+                 <string>CNTR_NAME_SEL_466_NUM_OUTPUT_ROWS</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_SEL_478_TIME_TAKEN</string> 
+                 <string>CNTR_NAME_SEL_466_TIME_TAKEN</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_SEL_478_FATAL_ERROR</string> 
+                 <string>CNTR_NAME_SEL_466_FATAL_ERROR</string> 
                 </void> 
                </object> 
               </void> 
               <void property="operatorId"> 
-               <string>SEL_478</string> 
+               <string>SEL_466</string> 
               </void> 
               <void property="parentOperators"> 
                <object class="java.util.ArrayList"> 
@@ -3295,21 +2875,21 @@
           <void property="counterNames"> 
            <object class="java.util.ArrayList"> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_477_NUM_INPUT_ROWS</string> 
+             <string>CNTR_NAME_SEL_465_NUM_INPUT_ROWS</string> 
             </void> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_477_NUM_OUTPUT_ROWS</string> 
+             <string>CNTR_NAME_SEL_465_NUM_OUTPUT_ROWS</string> 
             </void> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_477_TIME_TAKEN</string> 
+             <string>CNTR_NAME_SEL_465_TIME_TAKEN</string> 
             </void> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_477_FATAL_ERROR</string> 
+             <string>CNTR_NAME_SEL_465_FATAL_ERROR</string> 
             </void> 
            </object> 
           </void> 
           <void property="operatorId"> 
-           <string>SEL_477</string> 
+           <string>SEL_465</string> 
           </void> 
           <void property="parentOperators"> 
            <object class="java.util.ArrayList"> 
@@ -3625,21 +3205,21 @@
       <void property="counterNames"> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
-         <string>CNTR_NAME_JOIN_476_NUM_INPUT_ROWS</string> 
+         <string>CNTR_NAME_JOIN_464_NUM_INPUT_ROWS</string> 
         </void> 
         <void method="add"> 
-         <string>CNTR_NAME_JOIN_476_NUM_OUTPUT_ROWS</string> 
+         <string>CNTR_NAME_JOIN_464_NUM_OUTPUT_ROWS</string> 
         </void> 
         <void method="add"> 
-         <string>CNTR_NAME_JOIN_476_TIME_TAKEN</string> 
+         <string>CNTR_NAME_JOIN_464_TIME_TAKEN</string> 
         </void> 
         <void method="add"> 
-         <string>CNTR_NAME_JOIN_476_FATAL_ERROR</string> 
+         <string>CNTR_NAME_JOIN_464_FATAL_ERROR</string> 
         </void> 
        </object> 
       </void> 
       <void property="operatorId"> 
-       <string>JOIN_476</string> 
+       <string>JOIN_464</string> 
       </void> 
       <void property="parentOperators"> 
        <object class="java.util.ArrayList"> 
diff --git a/ql/src/test/results/compiler/plan/join8.q.xml b/ql/src/test/results/compiler/plan/join8.q.xml
index 8078fd9855..de749e4986 100644
--- a/ql/src/test/results/compiler/plan/join8.q.xml
+++ b/ql/src/test/results/compiler/plan/join8.q.xml
@@ -284,248 +284,33 @@
             <void property="childOperators"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+               <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                    <void property="childOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object id="ReduceSinkOperator0" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
-                        <void property="columnExprMap"> 
-                         <object class="java.util.HashMap"> 
-                          <void method="put"> 
-                           <string>VALUE._col1</string> 
-                           <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>_col1</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                              <void property="typeName"> 
-                               <string>string</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="put"> 
-                           <string>VALUE._col0</string> 
-                           <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>_col0</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="conf"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
-                          <void property="distinctColumnIndices"> 
-                           <object class="java.util.ArrayList"/> 
-                          </void> 
-                          <void property="keyCols"> 
-                           <object id="ArrayList0" class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                              <void property="column"> 
-                               <string>_col0</string> 
-                              </void> 
-                              <void property="typeInfo"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="keySerializeInfo"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                            <void property="deserializerClass"> 
-                             <class>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</class> 
-                            </void> 
-                            <void property="inputFileFormatClass"> 
-                             <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                            </void> 
-                            <void property="outputFileFormatClass"> 
-                             <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                            </void> 
-                            <void property="properties"> 
-                             <object class="java.util.Properties"> 
-                              <void method="put"> 
-                               <string>columns</string> 
-                               <string>joinkey0</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>serialization.sort.order</string> 
-                               <string>+</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>columns.types</string> 
-                               <string>string</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="numDistributionKeys"> 
-                           <int>1</int> 
-                          </void> 
-                          <void property="numReducers"> 
-                           <int>-1</int> 
-                          </void> 
-                          <void property="outputKeyColumnNames"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <string>reducesinkkey0</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="outputValueColumnNames"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <string>_col0</string> 
-                            </void> 
-                            <void method="add"> 
-                             <string>_col1</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="partitionCols"> 
-                           <object idref="ArrayList0"/> 
-                          </void> 
-                          <void property="valueCols"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object idref="ExprNodeColumnDesc1"/> 
-                            </void> 
-                            <void method="add"> 
-                             <object idref="ExprNodeColumnDesc0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="valueSerializeInfo"> 
-                           <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                            <void property="deserializerClass"> 
-                             <class>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</class> 
-                            </void> 
-                            <void property="inputFileFormatClass"> 
-                             <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                            </void> 
-                            <void property="outputFileFormatClass"> 
-                             <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                            </void> 
-                            <void property="properties"> 
-                             <object class="java.util.Properties"> 
-                              <void method="put"> 
-                               <string>columns</string> 
-                               <string>_col0,_col1</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>columns.types</string> 
-                               <string>string,string</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>escape.delim</string> 
-                               <string>\</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="counterNames"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_RS_508_NUM_INPUT_ROWS</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_RS_508_NUM_OUTPUT_ROWS</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_RS_508_TIME_TAKEN</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_RS_508_FATAL_ERROR</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="operatorId"> 
-                         <string>RS_508</string> 
-                        </void> 
-                        <void property="parentOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object idref="SelectOperator0"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="schema"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                          <void property="signature"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>VALUE._col0</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string>a</string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>VALUE._col1</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string>a</string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
+                   <object id="ReduceSinkOperator0" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
                     <void property="columnExprMap"> 
                      <object class="java.util.HashMap"> 
                       <void method="put"> 
-                       <string>_col1</string> 
-                       <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <string>VALUE._col1</string> 
+                       <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
                         <void property="column"> 
-                         <string>value</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src1</string> 
+                         <string>_col1</string> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
+                         <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
+                         </object> 
                         </void> 
                        </object> 
                       </void> 
                       <void method="put"> 
-                       <string>_col0</string> 
-                       <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <string>VALUE._col0</string> 
+                       <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
                         <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src1</string> 
+                         <string>_col0</string> 
                         </void> 
                         <void property="typeInfo"> 
                          <object idref="PrimitiveTypeInfo0"/> 
@@ -535,18 +320,67 @@
                      </object> 
                     </void> 
                     <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                      <void property="colList"> 
-                       <object class="java.util.ArrayList"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
+                      <void property="distinctColumnIndices"> 
+                       <object class="java.util.ArrayList"/> 
+                      </void> 
+                      <void property="keyCols"> 
+                       <object id="ArrayList0" class="java.util.ArrayList"> 
                         <void method="add"> 
-                         <object idref="ExprNodeColumnDesc3"/> 
+                         <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                          <void property="column"> 
+                           <string>_col0</string> 
+                          </void> 
+                          <void property="typeInfo"> 
+                           <object idref="PrimitiveTypeInfo0"/> 
+                          </void> 
+                         </object> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="keySerializeInfo"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                        <void property="deserializerClass"> 
+                         <class>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</class> 
+                        </void> 
+                        <void property="inputFileFormatClass"> 
+                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
                         </void> 
+                        <void property="outputFileFormatClass"> 
+                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                        </void> 
+                        <void property="properties"> 
+                         <object class="java.util.Properties"> 
+                          <void method="put"> 
+                           <string>columns</string> 
+                           <string>joinkey0</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>serialization.sort.order</string> 
+                           <string>+</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>columns.types</string> 
+                           <string>string</string> 
+                          </void> 
+                         </object> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="numDistributionKeys"> 
+                       <int>1</int> 
+                      </void> 
+                      <void property="numReducers"> 
+                       <int>-1</int> 
+                      </void> 
+                      <void property="outputKeyColumnNames"> 
+                       <object class="java.util.ArrayList"> 
                         <void method="add"> 
-                         <object idref="ExprNodeColumnDesc2"/> 
+                         <string>reducesinkkey0</string> 
                         </void> 
                        </object> 
                       </void> 
-                      <void property="outputColumnNames"> 
+                      <void property="outputValueColumnNames"> 
                        <object class="java.util.ArrayList"> 
                         <void method="add"> 
                          <string>_col0</string> 
@@ -556,31 +390,73 @@
                         </void> 
                        </object> 
                       </void> 
+                      <void property="partitionCols"> 
+                       <object idref="ArrayList0"/> 
+                      </void> 
+                      <void property="valueCols"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <object idref="ExprNodeColumnDesc1"/> 
+                        </void> 
+                        <void method="add"> 
+                         <object idref="ExprNodeColumnDesc0"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="valueSerializeInfo"> 
+                       <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                        <void property="deserializerClass"> 
+                         <class>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</class> 
+                        </void> 
+                        <void property="inputFileFormatClass"> 
+                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                        </void> 
+                        <void property="outputFileFormatClass"> 
+                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                        </void> 
+                        <void property="properties"> 
+                         <object class="java.util.Properties"> 
+                          <void method="put"> 
+                           <string>columns</string> 
+                           <string>_col0,_col1</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>columns.types</string> 
+                           <string>string,string</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>escape.delim</string> 
+                           <string>\</string> 
+                          </void> 
+                         </object> 
+                        </void> 
+                       </object> 
+                      </void> 
                      </object> 
                     </void> 
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_507_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_RS_493_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_507_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_RS_493_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_507_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_RS_493_TIME_TAKEN</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_507_FATAL_ERROR</string> 
+                       <string>CNTR_NAME_RS_493_FATAL_ERROR</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>SEL_507</string> 
+                     <string>RS_493</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object idref="FilterOperator1"/> 
+                       <object idref="SelectOperator0"/> 
                       </void> 
                      </object> 
                     </void> 
@@ -591,7 +467,10 @@
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                           <void property="internalName"> 
-                           <string>_col0</string> 
+                           <string>VALUE._col0</string> 
+                          </void> 
+                          <void property="tabAlias"> 
+                           <string>a</string> 
                           </void> 
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
@@ -601,7 +480,10 @@
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                           <void property="internalName"> 
-                           <string>_col1</string> 
+                           <string>VALUE._col1</string> 
+                          </void> 
+                          <void property="tabAlias"> 
+                           <string>a</string> 
                           </void> 
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
@@ -616,101 +498,57 @@
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-                  <void property="predicate"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="childExprs"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>key</string> 
-                            </void> 
-                            <void property="tabAlias"> 
-                             <string>src1</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                              <void property="typeName"> 
-                               <string>int</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="value"> 
-                             <int>10</int> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan"/> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>boolean</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>key</string> 
-                            </void> 
-                            <void property="tabAlias"> 
-                             <string>src1</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <int>20</int> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo2"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                <void property="columnExprMap"> 
+                 <object class="java.util.HashMap"> 
+                  <void method="put"> 
+                   <string>_col1</string> 
+                   <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>value</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd"/> 
+                    <void property="tabAlias"> 
+                     <string>src1</string> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="put"> 
+                   <string>_col0</string> 
+                   <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>key</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string>src1</string> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="conf"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                  <void property="colList"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object idref="ExprNodeColumnDesc3"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="ExprNodeColumnDesc2"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void property="outputColumnNames"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <string>_col0</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col1</string> 
                     </void> 
                    </object> 
                   </void> 
@@ -719,21 +557,21 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_506_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_492_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_506_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_492_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_506_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_SEL_492_TIME_TAKEN</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_506_FATAL_ERROR</string> 
+                   <string>CNTR_NAME_SEL_492_FATAL_ERROR</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>FIL_506</string> 
+                 <string>SEL_492</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -747,12 +585,9 @@
                   <void property="signature"> 
                    <object class="java.util.ArrayList"> 
                     <void method="add"> 
-                     <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                       <void property="internalName"> 
-                       <string>key</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>src1</string> 
+                       <string>_col0</string> 
                       </void> 
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
@@ -760,12 +595,9 @@
                      </object> 
                     </void> 
                     <void method="add"> 
-                     <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                       <void property="internalName"> 
-                       <string>value</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>src1</string> 
+                       <string>_col1</string> 
                       </void> 
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
@@ -806,7 +638,11 @@
                       <void method="add"> 
                        <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
+                         <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                          <void property="typeName"> 
+                           <string>int</string> 
+                          </void> 
+                         </object> 
                         </void> 
                         <void property="value"> 
                          <int>10</int> 
@@ -819,7 +655,11 @@
                      <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan"/> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                     <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                      <void property="typeName"> 
+                       <string>boolean</string> 
+                      </void> 
+                     </object> 
                     </void> 
                    </object> 
                   </void> 
@@ -875,21 +715,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_515_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_501_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_515_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_501_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_515_TIME_TAKEN</string> 
+               <string>CNTR_NAME_FIL_501_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_515_FATAL_ERROR</string> 
+               <string>CNTR_NAME_FIL_501_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>FIL_515</string> 
+             <string>FIL_501</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -903,10 +743,30 @@
               <void property="signature"> 
                <object id="ArrayList1" class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <object idref="ColumnInfo0"/> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>key</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>src1</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
                 </void> 
                 <void method="add"> 
-                 <object idref="ColumnInfo1"/> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>value</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>src1</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
                 </void> 
                 <void method="add"> 
                  <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
@@ -965,16 +825,16 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_505_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_490_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_505_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_490_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_505_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_490_TIME_TAKEN</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_505_FATAL_ERROR</string> 
+           <string>CNTR_NAME_TS_490_FATAL_ERROR</string> 
           </void> 
          </object> 
         </void> 
@@ -989,7 +849,7 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_505</string> 
+         <string>TS_490</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -1006,237 +866,22 @@
         <void property="childOperators"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <object id="FilterOperator2" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+           <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
             <void property="childOperators"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <object id="FilterOperator3" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+               <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                    <void property="childOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object id="ReduceSinkOperator1" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
-                        <void property="columnExprMap"> 
-                         <object class="java.util.HashMap"> 
-                          <void method="put"> 
-                           <string>VALUE._col1</string> 
-                           <object id="ExprNodeColumnDesc4" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>_col1</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="put"> 
-                           <string>VALUE._col0</string> 
-                           <object id="ExprNodeColumnDesc5" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>_col0</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="conf"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
-                          <void property="distinctColumnIndices"> 
-                           <object class="java.util.ArrayList"/> 
-                          </void> 
-                          <void property="keyCols"> 
-                           <object id="ArrayList2" class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                              <void property="column"> 
-                               <string>_col0</string> 
-                              </void> 
-                              <void property="typeInfo"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="keySerializeInfo"> 
-                           <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                            <void property="deserializerClass"> 
-                             <class>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</class> 
-                            </void> 
-                            <void property="inputFileFormatClass"> 
-                             <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                            </void> 
-                            <void property="outputFileFormatClass"> 
-                             <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                            </void> 
-                            <void property="properties"> 
-                             <object class="java.util.Properties"> 
-                              <void method="put"> 
-                               <string>columns</string> 
-                               <string>joinkey0</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>serialization.sort.order</string> 
-                               <string>+</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>columns.types</string> 
-                               <string>string</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="numDistributionKeys"> 
-                           <int>1</int> 
-                          </void> 
-                          <void property="numReducers"> 
-                           <int>-1</int> 
-                          </void> 
-                          <void property="outputKeyColumnNames"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <string>reducesinkkey0</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="outputValueColumnNames"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <string>_col0</string> 
-                            </void> 
-                            <void method="add"> 
-                             <string>_col1</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="partitionCols"> 
-                           <object idref="ArrayList2"/> 
-                          </void> 
-                          <void property="tag"> 
-                           <int>1</int> 
-                          </void> 
-                          <void property="valueCols"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object idref="ExprNodeColumnDesc5"/> 
-                            </void> 
-                            <void method="add"> 
-                             <object idref="ExprNodeColumnDesc4"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="valueSerializeInfo"> 
-                           <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                            <void property="deserializerClass"> 
-                             <class>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</class> 
-                            </void> 
-                            <void property="inputFileFormatClass"> 
-                             <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                            </void> 
-                            <void property="outputFileFormatClass"> 
-                             <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                            </void> 
-                            <void property="properties"> 
-                             <object class="java.util.Properties"> 
-                              <void method="put"> 
-                               <string>columns</string> 
-                               <string>_col0,_col1</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>columns.types</string> 
-                               <string>string,string</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>escape.delim</string> 
-                               <string>\</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="counterNames"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_RS_509_NUM_INPUT_ROWS</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_RS_509_NUM_OUTPUT_ROWS</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_RS_509_TIME_TAKEN</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_RS_509_FATAL_ERROR</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="operatorId"> 
-                         <string>RS_509</string> 
-                        </void> 
-                        <void property="parentOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object idref="SelectOperator1"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="schema"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                          <void property="signature"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>VALUE._col0</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string>b</string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>VALUE._col1</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string>b</string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
+                   <object id="ReduceSinkOperator1" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
                     <void property="columnExprMap"> 
                      <object class="java.util.HashMap"> 
                       <void method="put"> 
-                       <string>_col1</string> 
-                       <object id="ExprNodeColumnDesc6" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <string>VALUE._col1</string> 
+                       <object id="ExprNodeColumnDesc4" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
                         <void property="column"> 
-                         <string>value</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src2</string> 
+                         <string>_col1</string> 
                         </void> 
                         <void property="typeInfo"> 
                          <object idref="PrimitiveTypeInfo0"/> 
@@ -1244,13 +889,10 @@
                        </object> 
                       </void> 
                       <void method="put"> 
-                       <string>_col0</string> 
-                       <object id="ExprNodeColumnDesc7" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <string>VALUE._col0</string> 
+                       <object id="ExprNodeColumnDesc5" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
                         <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src2</string> 
+                         <string>_col0</string> 
                         </void> 
                         <void property="typeInfo"> 
                          <object idref="PrimitiveTypeInfo0"/> 
@@ -1260,18 +902,67 @@
                      </object> 
                     </void> 
                     <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                      <void property="colList"> 
-                       <object class="java.util.ArrayList"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
+                      <void property="distinctColumnIndices"> 
+                       <object class="java.util.ArrayList"/> 
+                      </void> 
+                      <void property="keyCols"> 
+                       <object id="ArrayList2" class="java.util.ArrayList"> 
                         <void method="add"> 
-                         <object idref="ExprNodeColumnDesc7"/> 
+                         <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                          <void property="column"> 
+                           <string>_col0</string> 
+                          </void> 
+                          <void property="typeInfo"> 
+                           <object idref="PrimitiveTypeInfo0"/> 
+                          </void> 
+                         </object> 
                         </void> 
+                       </object> 
+                      </void> 
+                      <void property="keySerializeInfo"> 
+                       <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                        <void property="deserializerClass"> 
+                         <class>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</class> 
+                        </void> 
+                        <void property="inputFileFormatClass"> 
+                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                        </void> 
+                        <void property="outputFileFormatClass"> 
+                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                        </void> 
+                        <void property="properties"> 
+                         <object class="java.util.Properties"> 
+                          <void method="put"> 
+                           <string>columns</string> 
+                           <string>joinkey0</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>serialization.sort.order</string> 
+                           <string>+</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>columns.types</string> 
+                           <string>string</string> 
+                          </void> 
+                         </object> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="numDistributionKeys"> 
+                       <int>1</int> 
+                      </void> 
+                      <void property="numReducers"> 
+                       <int>-1</int> 
+                      </void> 
+                      <void property="outputKeyColumnNames"> 
+                       <object class="java.util.ArrayList"> 
                         <void method="add"> 
-                         <object idref="ExprNodeColumnDesc6"/> 
+                         <string>reducesinkkey0</string> 
                         </void> 
                        </object> 
                       </void> 
-                      <void property="outputColumnNames"> 
+                      <void property="outputValueColumnNames"> 
                        <object class="java.util.ArrayList"> 
                         <void method="add"> 
                          <string>_col0</string> 
@@ -1281,31 +972,76 @@
                         </void> 
                        </object> 
                       </void> 
+                      <void property="partitionCols"> 
+                       <object idref="ArrayList2"/> 
+                      </void> 
+                      <void property="tag"> 
+                       <int>1</int> 
+                      </void> 
+                      <void property="valueCols"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <object idref="ExprNodeColumnDesc5"/> 
+                        </void> 
+                        <void method="add"> 
+                         <object idref="ExprNodeColumnDesc4"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="valueSerializeInfo"> 
+                       <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                        <void property="deserializerClass"> 
+                         <class>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</class> 
+                        </void> 
+                        <void property="inputFileFormatClass"> 
+                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                        </void> 
+                        <void property="outputFileFormatClass"> 
+                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                        </void> 
+                        <void property="properties"> 
+                         <object class="java.util.Properties"> 
+                          <void method="put"> 
+                           <string>columns</string> 
+                           <string>_col0,_col1</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>columns.types</string> 
+                           <string>string,string</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>escape.delim</string> 
+                           <string>\</string> 
+                          </void> 
+                         </object> 
+                        </void> 
+                       </object> 
+                      </void> 
                      </object> 
                     </void> 
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_504_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_RS_494_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_504_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_RS_494_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_504_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_RS_494_TIME_TAKEN</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_504_FATAL_ERROR</string> 
+                       <string>CNTR_NAME_RS_494_FATAL_ERROR</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>SEL_504</string> 
+                     <string>RS_494</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object idref="FilterOperator3"/> 
+                       <object idref="SelectOperator1"/> 
                       </void> 
                      </object> 
                     </void> 
@@ -1316,7 +1052,10 @@
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                           <void property="internalName"> 
-                           <string>_col0</string> 
+                           <string>VALUE._col0</string> 
+                          </void> 
+                          <void property="tabAlias"> 
+                           <string>b</string> 
                           </void> 
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
@@ -1326,7 +1065,10 @@
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                           <void property="internalName"> 
-                           <string>_col1</string> 
+                           <string>VALUE._col1</string> 
+                          </void> 
+                          <void property="tabAlias"> 
+                           <string>b</string> 
                           </void> 
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
@@ -1341,93 +1083,57 @@
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-                  <void property="predicate"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="childExprs"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>key</string> 
-                            </void> 
-                            <void property="tabAlias"> 
-                             <string>src2</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <int>15</int> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan"/> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo2"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>key</string> 
-                            </void> 
-                            <void property="tabAlias"> 
-                             <string>src2</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <int>25</int> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo2"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                <void property="columnExprMap"> 
+                 <object class="java.util.HashMap"> 
+                  <void method="put"> 
+                   <string>_col1</string> 
+                   <object id="ExprNodeColumnDesc6" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>value</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd"/> 
+                    <void property="tabAlias"> 
+                     <string>src2</string> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="put"> 
+                   <string>_col0</string> 
+                   <object id="ExprNodeColumnDesc7" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>key</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string>src2</string> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="conf"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                  <void property="colList"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object idref="ExprNodeColumnDesc7"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="ExprNodeColumnDesc6"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void property="outputColumnNames"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <string>_col0</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col1</string> 
                     </void> 
                    </object> 
                   </void> 
@@ -1436,26 +1142,26 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_503_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_489_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_503_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_489_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_503_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_SEL_489_TIME_TAKEN</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_503_FATAL_ERROR</string> 
+                   <string>CNTR_NAME_SEL_489_FATAL_ERROR</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>FIL_503</string> 
+                 <string>SEL_489</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object idref="FilterOperator2"/> 
+                   <object idref="FilterOperator1"/> 
                   </void> 
                  </object> 
                 </void> 
@@ -1464,12 +1170,9 @@
                   <void property="signature"> 
                    <object class="java.util.ArrayList"> 
                     <void method="add"> 
-                     <object id="ColumnInfo2" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                       <void property="internalName"> 
-                       <string>key</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>src2</string> 
+                       <string>_col0</string> 
                       </void> 
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
@@ -1477,12 +1180,9 @@
                      </object> 
                     </void> 
                     <void method="add"> 
-                     <object id="ColumnInfo3" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                       <void property="internalName"> 
-                       <string>value</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>src2</string> 
+                       <string>_col1</string> 
                       </void> 
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo0"/> 
@@ -1592,21 +1292,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_516_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_502_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_516_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_502_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_516_TIME_TAKEN</string> 
+               <string>CNTR_NAME_FIL_502_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_516_FATAL_ERROR</string> 
+               <string>CNTR_NAME_FIL_502_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>FIL_516</string> 
+             <string>FIL_502</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -1620,10 +1320,30 @@
               <void property="signature"> 
                <object id="ArrayList3" class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <object idref="ColumnInfo2"/> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>key</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>src2</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
                 </void> 
                 <void method="add"> 
-                 <object idref="ColumnInfo3"/> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>value</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>src2</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
                 </void> 
                 <void method="add"> 
                  <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
@@ -1678,16 +1398,16 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_502_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_487_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_502_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_487_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_502_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_487_TIME_TAKEN</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_502_FATAL_ERROR</string> 
+           <string>CNTR_NAME_TS_487_FATAL_ERROR</string> 
           </void> 
          </object> 
         </void> 
@@ -1702,7 +1422,7 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_502</string> 
+         <string>TS_487</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -1886,11 +1606,11 @@
       <void property="childOperators"> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
-         <object id="SelectOperator2" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+         <object id="FilterOperator2" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
           <void property="childOperators"> 
            <object class="java.util.ArrayList"> 
             <void method="add"> 
-             <object id="FilterOperator4" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+             <object id="SelectOperator2" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
               <void property="childOperators"> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
@@ -1947,21 +1667,21 @@
                       <void property="counterNames"> 
                        <object class="java.util.ArrayList"> 
                         <void method="add"> 
-                         <string>CNTR_NAME_FS_514_NUM_INPUT_ROWS</string> 
+                         <string>CNTR_NAME_FS_499_NUM_INPUT_ROWS</string> 
                         </void> 
                         <void method="add"> 
-                         <string>CNTR_NAME_FS_514_NUM_OUTPUT_ROWS</string> 
+                         <string>CNTR_NAME_FS_499_NUM_OUTPUT_ROWS</string> 
                         </void> 
                         <void method="add"> 
-                         <string>CNTR_NAME_FS_514_TIME_TAKEN</string> 
+                         <string>CNTR_NAME_FS_499_TIME_TAKEN</string> 
                         </void> 
                         <void method="add"> 
-                         <string>CNTR_NAME_FS_514_FATAL_ERROR</string> 
+                         <string>CNTR_NAME_FS_499_FATAL_ERROR</string> 
                         </void> 
                        </object> 
                       </void> 
                       <void property="operatorId"> 
-                       <string>FS_514</string> 
+                       <string>FS_499</string> 
                       </void> 
                       <void property="parentOperators"> 
                        <object class="java.util.ArrayList"> 
@@ -2121,26 +1841,26 @@
                   <void property="counterNames"> 
                    <object class="java.util.ArrayList"> 
                     <void method="add"> 
-                     <string>CNTR_NAME_SEL_513_NUM_INPUT_ROWS</string> 
+                     <string>CNTR_NAME_SEL_498_NUM_INPUT_ROWS</string> 
                     </void> 
                     <void method="add"> 
-                     <string>CNTR_NAME_SEL_513_NUM_OUTPUT_ROWS</string> 
+                     <string>CNTR_NAME_SEL_498_NUM_OUTPUT_ROWS</string> 
                     </void> 
                     <void method="add"> 
-                     <string>CNTR_NAME_SEL_513_TIME_TAKEN</string> 
+                     <string>CNTR_NAME_SEL_498_TIME_TAKEN</string> 
                     </void> 
                     <void method="add"> 
-                     <string>CNTR_NAME_SEL_513_FATAL_ERROR</string> 
+                     <string>CNTR_NAME_SEL_498_FATAL_ERROR</string> 
                     </void> 
                    </object> 
                   </void> 
                   <void property="operatorId"> 
-                   <string>SEL_513</string> 
+                   <string>SEL_498</string> 
                   </void> 
                   <void property="parentOperators"> 
                    <object class="java.util.ArrayList"> 
                     <void method="add"> 
-                     <object idref="FilterOperator4"/> 
+                     <object idref="SelectOperator2"/> 
                     </void> 
                    </object> 
                   </void> 
@@ -2220,67 +1940,97 @@
                 </void> 
                </object> 
               </void> 
-              <void property="conf"> 
-               <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-                <void property="predicate"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                  <void property="childExprs"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                      <void property="childExprs"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                          <void property="column"> 
-                           <string>_col2</string> 
-                          </void> 
-                          <void property="typeInfo"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="genericUDF"> 
-                       <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPNull"/> 
-                      </void> 
-                      <void property="typeInfo"> 
-                       <object idref="PrimitiveTypeInfo2"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                      <void property="childExprs"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                          <void property="column"> 
-                           <string>_col0</string> 
-                          </void> 
-                          <void property="typeInfo"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="genericUDF"> 
-                       <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPNotNull"/> 
-                      </void> 
-                      <void property="typeInfo"> 
-                       <object idref="PrimitiveTypeInfo2"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+              <void property="columnExprMap"> 
+               <object class="java.util.HashMap"> 
+                <void method="put"> 
+                 <string>_col3</string> 
+                 <object id="ExprNodeColumnDesc12" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>_col3</string> 
                   </void> 
-                  <void property="genericUDF"> 
-                   <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd"/> 
+                  <void property="tabAlias"> 
+                   <string>b</string> 
                   </void> 
                   <void property="typeInfo"> 
-                   <object idref="PrimitiveTypeInfo2"/> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void method="put"> 
+                 <string>_col2</string> 
+                 <object id="ExprNodeColumnDesc13" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>_col2</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>b</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void method="put"> 
+                 <string>_col1</string> 
+                 <object id="ExprNodeColumnDesc14" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>_col1</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>a</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void method="put"> 
+                 <string>_col0</string> 
+                 <object id="ExprNodeColumnDesc15" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>_col0</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>a</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
+                </void> 
+               </object> 
+              </void> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                <void property="colList"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object idref="ExprNodeColumnDesc15"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object idref="ExprNodeColumnDesc14"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object idref="ExprNodeColumnDesc13"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object idref="ExprNodeColumnDesc12"/> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="outputColumnNames"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <string>_col0</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col1</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col2</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col3</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -2289,26 +2039,26 @@
               <void property="counterNames"> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>CNTR_NAME_FIL_512_NUM_INPUT_ROWS</string> 
+                 <string>CNTR_NAME_SEL_496_NUM_INPUT_ROWS</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_FIL_512_NUM_OUTPUT_ROWS</string> 
+                 <string>CNTR_NAME_SEL_496_NUM_OUTPUT_ROWS</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_FIL_512_TIME_TAKEN</string> 
+                 <string>CNTR_NAME_SEL_496_TIME_TAKEN</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_FIL_512_FATAL_ERROR</string> 
+                 <string>CNTR_NAME_SEL_496_FATAL_ERROR</string> 
                 </void> 
                </object> 
               </void> 
               <void property="operatorId"> 
-               <string>FIL_512</string> 
+               <string>SEL_496</string> 
               </void> 
               <void property="parentOperators"> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <object idref="SelectOperator2"/> 
+                 <object idref="FilterOperator2"/> 
                 </void> 
                </object> 
               </void> 
@@ -2317,7 +2067,7 @@
                 <void property="signature"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object id="ColumnInfo4" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                     <void property="internalName"> 
                      <string>_col0</string> 
                     </void> 
@@ -2327,7 +2077,7 @@
                    </object> 
                   </void> 
                   <void method="add"> 
-                   <object id="ColumnInfo5" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                     <void property="internalName"> 
                      <string>_col1</string> 
                     </void> 
@@ -2337,7 +2087,7 @@
                    </object> 
                   </void> 
                   <void method="add"> 
-                   <object id="ColumnInfo6" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                     <void property="internalName"> 
                      <string>_col2</string> 
                     </void> 
@@ -2347,7 +2097,7 @@
                    </object> 
                   </void> 
                   <void method="add"> 
-                   <object id="ColumnInfo7" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                     <void property="internalName"> 
                      <string>_col3</string> 
                     </void> 
@@ -2364,97 +2114,73 @@
             </void> 
            </object> 
           </void> 
-          <void property="columnExprMap"> 
-           <object class="java.util.HashMap"> 
-            <void method="put"> 
-             <string>_col3</string> 
-             <object id="ExprNodeColumnDesc12" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-              <void property="column"> 
-               <string>_col3</string> 
-              </void> 
-              <void property="tabAlias"> 
-               <string>b</string> 
-              </void> 
-              <void property="typeInfo"> 
-               <object idref="PrimitiveTypeInfo0"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void method="put"> 
-             <string>_col2</string> 
-             <object id="ExprNodeColumnDesc13" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-              <void property="column"> 
-               <string>_col2</string> 
-              </void> 
-              <void property="tabAlias"> 
-               <string>b</string> 
-              </void> 
-              <void property="typeInfo"> 
-               <object idref="PrimitiveTypeInfo0"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void method="put"> 
-             <string>_col1</string> 
-             <object id="ExprNodeColumnDesc14" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-              <void property="column"> 
-               <string>_col1</string> 
-              </void> 
-              <void property="tabAlias"> 
-               <string>a</string> 
-              </void> 
-              <void property="typeInfo"> 
-               <object idref="PrimitiveTypeInfo0"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void method="put"> 
-             <string>_col0</string> 
-             <object id="ExprNodeColumnDesc15" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-              <void property="column"> 
-               <string>_col0</string> 
-              </void> 
-              <void property="tabAlias"> 
-               <string>a</string> 
-              </void> 
-              <void property="typeInfo"> 
-               <object idref="PrimitiveTypeInfo0"/> 
-              </void> 
-             </object> 
-            </void> 
-           </object> 
-          </void> 
           <void property="conf"> 
-           <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-            <void property="colList"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="ExprNodeColumnDesc15"/> 
-              </void> 
-              <void method="add"> 
-               <object idref="ExprNodeColumnDesc14"/> 
-              </void> 
-              <void method="add"> 
-               <object idref="ExprNodeColumnDesc13"/> 
-              </void> 
-              <void method="add"> 
-               <object idref="ExprNodeColumnDesc12"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="outputColumnNames"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <string>_col0</string> 
-              </void> 
-              <void method="add"> 
-               <string>_col1</string> 
+           <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
+            <void property="predicate"> 
+             <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+              <void property="childExprs"> 
+               <object class="java.util.ArrayList"> 
+                <void method="add"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                  <void property="childExprs"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                      <void property="column"> 
+                       <string>_col2</string> 
+                      </void> 
+                      <void property="tabAlias"> 
+                       <string>b</string> 
+                      </void> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo0"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void property="genericUDF"> 
+                   <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPNull"/> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo2"/> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void method="add"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                  <void property="childExprs"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                      <void property="column"> 
+                       <string>_col0</string> 
+                      </void> 
+                      <void property="tabAlias"> 
+                       <string>a</string> 
+                      </void> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo0"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void property="genericUDF"> 
+                   <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPNotNull"/> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo2"/> 
+                  </void> 
+                 </object> 
+                </void> 
+               </object> 
               </void> 
-              <void method="add"> 
-               <string>_col2</string> 
+              <void property="genericUDF"> 
+               <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd"/> 
               </void> 
-              <void method="add"> 
-               <string>_col3</string> 
+              <void property="typeInfo"> 
+               <object idref="PrimitiveTypeInfo2"/> 
               </void> 
              </object> 
             </void> 
@@ -2463,21 +2189,21 @@
           <void property="counterNames"> 
            <object class="java.util.ArrayList"> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_511_NUM_INPUT_ROWS</string> 
+             <string>CNTR_NAME_FIL_500_NUM_INPUT_ROWS</string> 
             </void> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_511_NUM_OUTPUT_ROWS</string> 
+             <string>CNTR_NAME_FIL_500_NUM_OUTPUT_ROWS</string> 
             </void> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_511_TIME_TAKEN</string> 
+             <string>CNTR_NAME_FIL_500_TIME_TAKEN</string> 
             </void> 
             <void method="add"> 
-             <string>CNTR_NAME_SEL_511_FATAL_ERROR</string> 
+             <string>CNTR_NAME_FIL_500_FATAL_ERROR</string> 
             </void> 
            </object> 
           </void> 
           <void property="operatorId"> 
-           <string>SEL_511</string> 
+           <string>FIL_500</string> 
           </void> 
           <void property="parentOperators"> 
            <object class="java.util.ArrayList"> 
@@ -2491,16 +2217,56 @@
             <void property="signature"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <object idref="ColumnInfo4"/> 
+               <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                <void property="internalName"> 
+                 <string>_col0</string> 
+                </void> 
+                <void property="tabAlias"> 
+                 <string>a</string> 
+                </void> 
+                <void property="type"> 
+                 <object idref="PrimitiveTypeInfo0"/> 
+                </void> 
+               </object> 
               </void> 
               <void method="add"> 
-               <object idref="ColumnInfo5"/> 
+               <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                <void property="internalName"> 
+                 <string>_col1</string> 
+                </void> 
+                <void property="tabAlias"> 
+                 <string>a</string> 
+                </void> 
+                <void property="type"> 
+                 <object idref="PrimitiveTypeInfo0"/> 
+                </void> 
+               </object> 
               </void> 
               <void method="add"> 
-               <object idref="ColumnInfo6"/> 
+               <object id="ColumnInfo2" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                <void property="internalName"> 
+                 <string>_col2</string> 
+                </void> 
+                <void property="tabAlias"> 
+                 <string>b</string> 
+                </void> 
+                <void property="type"> 
+                 <object idref="PrimitiveTypeInfo0"/> 
+                </void> 
+               </object> 
               </void> 
               <void method="add"> 
-               <object idref="ColumnInfo7"/> 
+               <object id="ColumnInfo3" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                <void property="internalName"> 
+                 <string>_col3</string> 
+                </void> 
+                <void property="tabAlias"> 
+                 <string>b</string> 
+                </void> 
+                <void property="type"> 
+                 <object idref="PrimitiveTypeInfo0"/> 
+                </void> 
+               </object> 
               </void> 
              </object> 
             </void> 
@@ -2675,21 +2441,21 @@
       <void property="counterNames"> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
-         <string>CNTR_NAME_JOIN_510_NUM_INPUT_ROWS</string> 
+         <string>CNTR_NAME_JOIN_495_NUM_INPUT_ROWS</string> 
         </void> 
         <void method="add"> 
-         <string>CNTR_NAME_JOIN_510_NUM_OUTPUT_ROWS</string> 
+         <string>CNTR_NAME_JOIN_495_NUM_OUTPUT_ROWS</string> 
         </void> 
         <void method="add"> 
-         <string>CNTR_NAME_JOIN_510_TIME_TAKEN</string> 
+         <string>CNTR_NAME_JOIN_495_TIME_TAKEN</string> 
         </void> 
         <void method="add"> 
-         <string>CNTR_NAME_JOIN_510_FATAL_ERROR</string> 
+         <string>CNTR_NAME_JOIN_495_FATAL_ERROR</string> 
         </void> 
        </object> 
       </void> 
       <void property="operatorId"> 
-       <string>JOIN_510</string> 
+       <string>JOIN_495</string> 
       </void> 
       <void property="parentOperators"> 
        <object class="java.util.ArrayList"> 
@@ -2726,56 +2492,16 @@
         <void property="signature"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-            <void property="internalName"> 
-             <string>_col0</string> 
-            </void> 
-            <void property="tabAlias"> 
-             <string>a</string> 
-            </void> 
-            <void property="type"> 
-             <object idref="PrimitiveTypeInfo0"/> 
-            </void> 
-           </object> 
+           <object idref="ColumnInfo0"/> 
           </void> 
           <void method="add"> 
-           <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-            <void property="internalName"> 
-             <string>_col1</string> 
-            </void> 
-            <void property="tabAlias"> 
-             <string>a</string> 
-            </void> 
-            <void property="type"> 
-             <object idref="PrimitiveTypeInfo0"/> 
-            </void> 
-           </object> 
+           <object idref="ColumnInfo1"/> 
           </void> 
           <void method="add"> 
-           <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-            <void property="internalName"> 
-             <string>_col2</string> 
-            </void> 
-            <void property="tabAlias"> 
-             <string>b</string> 
-            </void> 
-            <void property="type"> 
-             <object idref="PrimitiveTypeInfo0"/> 
-            </void> 
-           </object> 
+           <object idref="ColumnInfo2"/> 
           </void> 
           <void method="add"> 
-           <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-            <void property="internalName"> 
-             <string>_col3</string> 
-            </void> 
-            <void property="tabAlias"> 
-             <string>b</string> 
-            </void> 
-            <void property="type"> 
-             <object idref="PrimitiveTypeInfo0"/> 
-            </void> 
-           </object> 
+           <object idref="ColumnInfo3"/> 
           </void> 
          </object> 
         </void> 
diff --git a/ql/src/test/results/compiler/plan/sample1.q.xml b/ql/src/test/results/compiler/plan/sample1.q.xml
index 4275f6ff4d..836be6cf29 100644
--- a/ql/src/test/results/compiler/plan/sample1.q.xml
+++ b/ql/src/test/results/compiler/plan/sample1.q.xml
@@ -1,5 +1,5 @@
 <?xml version="1.0" encoding="UTF-8"?> 
-<java version="1.6.0_07" class="java.beans.XMLDecoder"> 
+<java version="1.6.0_01" class="java.beans.XMLDecoder"> 
  <object class="org.apache.hadoop.hive.ql.exec.MapRedTask"> 
   <void property="id"> 
    <string>Stage-3</string> 
@@ -75,11 +75,11 @@
          </void> 
          <void method="put"> 
           <string>location</string> 
-          <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11</string> 
+          <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11</string> 
          </void> 
          <void method="put"> 
           <string>transient_lastDdlTime</string> 
-          <string>1304060232</string> 
+          <string>1310382369</string> 
          </void> 
         </object> 
        </void> 
@@ -141,11 +141,11 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcpart</string> 
+            <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcpart</string> 
            </void> 
            <void method="put"> 
             <string>transient_lastDdlTime</string> 
-            <string>1304060232</string> 
+            <string>1310382369</string> 
            </void> 
           </object> 
          </void> 
@@ -169,282 +169,79 @@
             <void property="childOperators"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+               <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                    <void property="childOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                        <void property="conf"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                          <void property="dirName"> 
-                           <string>file:/tmp/sdong/hive_2011-04-28_23-57-22_309_7605083373302035666/-ext-10001</string> 
-                          </void> 
-                          <void property="numFiles"> 
-                           <int>1</int> 
-                          </void> 
-                          <void property="statsAggPrefix"> 
-                           <string>file:/tmp/sdong/hive_2011-04-28_23-57-22_309_7605083373302035666/-ext-10001/</string> 
-                          </void> 
-                          <void property="tableInfo"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                            <void property="deserializerClass"> 
-                             <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
-                            </void> 
-                            <void property="inputFileFormatClass"> 
-                             <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-                            </void> 
-                            <void property="outputFileFormatClass"> 
-                             <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-                            </void> 
-                            <void property="properties"> 
-                             <object class="java.util.Properties"> 
-                              <void method="put"> 
-                               <string>columns</string> 
-                               <string>_col0,_col1,_col2,_col3</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>serialization.format</string> 
-                               <string>1</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>columns.types</string> 
-                               <string>string:string:string:string</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="totalFiles"> 
-                           <int>1</int> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="counterNames"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_536_NUM_INPUT_ROWS</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_536_NUM_OUTPUT_ROWS</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_536_TIME_TAKEN</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_536_FATAL_ERROR</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="operatorId"> 
-                         <string>FS_536</string> 
-                        </void> 
-                        <void property="parentOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object idref="SelectOperator0"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="schema"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                          <void property="signature"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>_col0</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string></string> 
-                              </void> 
-                              <void property="type"> 
-                               <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                                <void property="typeName"> 
-                                 <string>string</string> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>_col1</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string></string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>_col2</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string></string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>_col3</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string></string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="columnExprMap"> 
-                     <object class="java.util.HashMap"> 
-                      <void method="put"> 
-                       <string>_col3</string> 
-                       <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>hr</string> 
-                        </void> 
-                        <void property="isPartitionColOrVirtualCol"> 
-                         <boolean>true</boolean> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>s</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="put"> 
-                       <string>_col2</string> 
-                       <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>ds</string> 
-                        </void> 
-                        <void property="isPartitionColOrVirtualCol"> 
-                         <boolean>true</boolean> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>s</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="put"> 
-                       <string>_col1</string> 
-                       <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>value</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>s</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                    <void property="conf"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                      <void property="dirName"> 
+                       <string>file:/tmp/amarsri/hive_2011-07-11_04-06-12_350_8086266026815616219/-ext-10001</string> 
                       </void> 
-                      <void method="put"> 
-                       <string>_col0</string> 
-                       <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>s</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
+                      <void property="numFiles"> 
+                       <int>1</int> 
                       </void> 
-                     </object> 
-                    </void> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                      <void property="colList"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc3"/> 
-                        </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc2"/> 
-                        </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc1"/> 
-                        </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc0"/> 
-                        </void> 
-                       </object> 
+                      <void property="statsAggPrefix"> 
+                       <string>file:/tmp/amarsri/hive_2011-07-11_04-06-12_350_8086266026815616219/-ext-10001/</string> 
                       </void> 
-                      <void property="outputColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>_col0</string> 
+                      <void property="tableInfo"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                        <void property="deserializerClass"> 
+                         <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
                         </void> 
-                        <void method="add"> 
-                         <string>_col1</string> 
+                        <void property="inputFileFormatClass"> 
+                         <class>org.apache.hadoop.mapred.TextInputFormat</class> 
                         </void> 
-                        <void method="add"> 
-                         <string>_col2</string> 
+                        <void property="outputFileFormatClass"> 
+                         <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
                         </void> 
-                        <void method="add"> 
-                         <string>_col3</string> 
+                        <void property="properties"> 
+                         <object class="java.util.Properties"> 
+                          <void method="put"> 
+                           <string>columns</string> 
+                           <string>_col0,_col1,_col2,_col3</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>serialization.format</string> 
+                           <string>1</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>columns.types</string> 
+                           <string>string:string:string:string</string> 
+                          </void> 
+                         </object> 
                         </void> 
                        </object> 
                       </void> 
-                      <void property="selectStar"> 
-                       <boolean>true</boolean> 
+                      <void property="totalFiles"> 
+                       <int>1</int> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_535_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_FS_520_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_535_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_FS_520_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_535_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_FS_520_TIME_TAKEN</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_535_FATAL_ERROR</string> 
+                       <string>CNTR_NAME_FS_520_FATAL_ERROR</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>SEL_535</string> 
+                     <string>FS_520</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object idref="FilterOperator1"/> 
+                       <object idref="SelectOperator0"/> 
                       </void> 
                      </object> 
                     </void> 
@@ -454,30 +251,28 @@
                        <object class="java.util.ArrayList"> 
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="alias"> 
-                           <string>key</string> 
-                          </void> 
                           <void property="internalName"> 
                            <string>_col0</string> 
                           </void> 
                           <void property="tabAlias"> 
-                           <string>s</string> 
+                           <string></string> 
                           </void> 
                           <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
+                           <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                            <void property="typeName"> 
+                             <string>string</string> 
+                            </void> 
+                           </object> 
                           </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="alias"> 
-                           <string>value</string> 
-                          </void> 
                           <void property="internalName"> 
                            <string>_col1</string> 
                           </void> 
                           <void property="tabAlias"> 
-                           <string>s</string> 
+                           <string></string> 
                           </void> 
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
@@ -486,14 +281,11 @@
                         </void> 
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="alias"> 
-                           <string>ds</string> 
-                          </void> 
                           <void property="internalName"> 
                            <string>_col2</string> 
                           </void> 
                           <void property="tabAlias"> 
-                           <string>s</string> 
+                           <string></string> 
                           </void> 
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
@@ -502,14 +294,11 @@
                         </void> 
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="alias"> 
-                           <string>hr</string> 
-                          </void> 
                           <void property="internalName"> 
                            <string>_col3</string> 
                           </void> 
                           <void property="tabAlias"> 
-                           <string>s</string> 
+                           <string></string> 
                           </void> 
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
@@ -524,126 +313,129 @@
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-                  <void property="predicate"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="childExprs"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>ds</string> 
-                            </void> 
-                            <void property="isPartitionColOrVirtualCol"> 
-                             <boolean>true</boolean> 
-                            </void> 
-                            <void property="tabAlias"> 
-                             <string>s</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                            <void property="value"> 
-                             <string>2008-04-08</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual"/> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>boolean</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>hr</string> 
-                            </void> 
-                            <void property="isPartitionColOrVirtualCol"> 
-                             <boolean>true</boolean> 
-                            </void> 
-                            <void property="tabAlias"> 
-                             <string>s</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                            <void property="value"> 
-                             <string>11</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual"/> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                <void property="columnExprMap"> 
+                 <object class="java.util.HashMap"> 
+                  <void method="put"> 
+                   <string>_col3</string> 
+                   <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>hr</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd"/> 
+                    <void property="isPartitionColOrVirtualCol"> 
+                     <boolean>true</boolean> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string>s</string> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="put"> 
+                   <string>_col2</string> 
+                   <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>ds</string> 
+                    </void> 
+                    <void property="isPartitionColOrVirtualCol"> 
+                     <boolean>true</boolean> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string>s</string> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
                    </object> 
                   </void> 
+                  <void method="put"> 
+                   <string>_col1</string> 
+                   <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>value</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string>s</string> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="put"> 
+                   <string>_col0</string> 
+                   <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>key</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string>s</string> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="conf"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                  <void property="colList"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object idref="ExprNodeColumnDesc3"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="ExprNodeColumnDesc2"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="ExprNodeColumnDesc1"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="ExprNodeColumnDesc0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void property="outputColumnNames"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <string>_col0</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col1</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col2</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col3</string> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void property="selectStar"> 
+                   <boolean>true</boolean> 
+                  </void> 
                  </object> 
                 </void> 
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_534_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_519_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_534_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_519_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_534_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_SEL_519_TIME_TAKEN</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_534_FATAL_ERROR</string> 
+                   <string>CNTR_NAME_SEL_519_FATAL_ERROR</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>FIL_534</string> 
+                 <string>SEL_519</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -657,10 +449,13 @@
                   <void property="signature"> 
                    <object class="java.util.ArrayList"> 
                     <void method="add"> 
-                     <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="alias"> 
                        <string>key</string> 
                       </void> 
+                      <void property="internalName"> 
+                       <string>_col0</string> 
+                      </void> 
                       <void property="tabAlias"> 
                        <string>s</string> 
                       </void> 
@@ -670,10 +465,13 @@
                      </object> 
                     </void> 
                     <void method="add"> 
-                     <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="alias"> 
                        <string>value</string> 
                       </void> 
+                      <void property="internalName"> 
+                       <string>_col1</string> 
+                      </void> 
                       <void property="tabAlias"> 
                        <string>s</string> 
                       </void> 
@@ -683,10 +481,13 @@
                      </object> 
                     </void> 
                     <void method="add"> 
-                     <object id="ColumnInfo2" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="alias"> 
                        <string>ds</string> 
                       </void> 
+                      <void property="internalName"> 
+                       <string>_col2</string> 
+                      </void> 
                       <void property="tabAlias"> 
                        <string>s</string> 
                       </void> 
@@ -696,10 +497,13 @@
                      </object> 
                     </void> 
                     <void method="add"> 
-                     <object id="ColumnInfo3" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="alias"> 
                        <string>hr</string> 
                       </void> 
+                      <void property="internalName"> 
+                       <string>_col3</string> 
+                      </void> 
                       <void property="tabAlias"> 
                        <string>s</string> 
                       </void> 
@@ -767,7 +571,7 @@
                              <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFHash"/> 
                             </void> 
                             <void property="typeInfo"> 
-                             <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                             <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
                               <void property="typeName"> 
                                <string>int</string> 
                               </void> 
@@ -778,7 +582,7 @@
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo2"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                             <void property="value"> 
                              <int>2147483647</int> 
@@ -801,14 +605,14 @@
                          </object> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo2"/> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
                        </object> 
                       </void> 
                       <void method="add"> 
                        <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo2"/> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
                         <void property="value"> 
                          <int>1</int> 
@@ -831,14 +635,14 @@
                      </object> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                     <object idref="PrimitiveTypeInfo1"/> 
                     </void> 
                    </object> 
                   </void> 
                   <void method="add"> 
                    <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                     <object idref="PrimitiveTypeInfo1"/> 
                     </void> 
                     <void property="value"> 
                      <int>0</int> 
@@ -851,7 +655,11 @@
                  <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual"/> 
                 </void> 
                 <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo1"/> 
+                 <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                  <void property="typeName"> 
+                   <string>boolean</string> 
+                  </void> 
+                 </object> 
                 </void> 
                </object> 
               </void> 
@@ -860,21 +668,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_533_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_517_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_533_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_517_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_533_TIME_TAKEN</string> 
+               <string>CNTR_NAME_FIL_517_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_533_FATAL_ERROR</string> 
+               <string>CNTR_NAME_FIL_517_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>FIL_533</string> 
+             <string>FIL_517</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -888,16 +696,56 @@
               <void property="signature"> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <object idref="ColumnInfo0"/> 
+                 <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>key</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>s</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
                 </void> 
                 <void method="add"> 
-                 <object idref="ColumnInfo1"/> 
+                 <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>value</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>s</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
                 </void> 
                 <void method="add"> 
-                 <object idref="ColumnInfo2"/> 
+                 <object id="ColumnInfo2" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>ds</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>s</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
                 </void> 
                 <void method="add"> 
-                 <object idref="ColumnInfo3"/> 
+                 <object id="ColumnInfo3" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>hr</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>s</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
                 </void> 
                </object> 
               </void> 
@@ -920,16 +768,16 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_532_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_516_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_532_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_516_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_532_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_516_TIME_TAKEN</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_532_FATAL_ERROR</string> 
+           <string>CNTR_NAME_TS_516_FATAL_ERROR</string> 
           </void> 
          </object> 
         </void> 
@@ -944,7 +792,7 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_532</string> 
+         <string>TS_516</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -1012,7 +860,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11</string> 
+       <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>s</string> 
@@ -1024,7 +872,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11</string> 
+       <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11</string> 
        <object class="org.apache.hadoop.hive.ql.plan.PartitionDesc"> 
         <void property="baseFileName"> 
          <string>hr=11</string> 
@@ -1094,11 +942,11 @@
           </void> 
           <void method="put"> 
            <string>location</string> 
-           <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11</string> 
+           <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11</string> 
           </void> 
           <void method="put"> 
            <string>transient_lastDdlTime</string> 
-           <string>1304060233</string> 
+           <string>1310382369</string> 
           </void> 
          </object> 
         </void> 
@@ -1160,11 +1008,11 @@
             </void> 
             <void method="put"> 
              <string>location</string> 
-             <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcpart</string> 
+             <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcpart</string> 
             </void> 
             <void method="put"> 
              <string>transient_lastDdlTime</string> 
-             <string>1304060232</string> 
+             <string>1310382369</string> 
             </void> 
            </object> 
           </void> 
diff --git a/ql/src/test/results/compiler/plan/sample2.q.xml b/ql/src/test/results/compiler/plan/sample2.q.xml
index 993164b5d2..b3084c46e6 100644
--- a/ql/src/test/results/compiler/plan/sample2.q.xml
+++ b/ql/src/test/results/compiler/plan/sample2.q.xml
@@ -1,5 +1,5 @@
 <?xml version="1.0" encoding="UTF-8"?> 
-<java version="1.6.0_07" class="java.beans.XMLDecoder"> 
+<java version="1.6.0_01" class="java.beans.XMLDecoder"> 
  <object id="MapRedTask0" class="org.apache.hadoop.hive.ql.exec.MapRedTask"> 
   <void property="childTasks"> 
    <object class="java.util.ArrayList"> 
@@ -33,7 +33,7 @@
                   <void property="work"> 
                    <object class="org.apache.hadoop.hive.ql.plan.StatsWork"> 
                     <void property="aggKey"> 
-                     <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-57-32_320_4074994742709103859/-ext-10000/</string> 
+                     <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-15_772_2901808161378380637/-ext-10000/</string> 
                     </void> 
                    </object> 
                   </void> 
@@ -73,7 +73,7 @@
                     <void property="aliasToWork"> 
                      <object class="java.util.LinkedHashMap"> 
                       <void method="put"> 
-                       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-57-32_320_4074994742709103859/-ext-10002</string> 
+                       <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-15_772_2901808161378380637/-ext-10002</string> 
                        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                         <void property="childOperators"> 
                          <object class="java.util.ArrayList"> 
@@ -82,7 +82,7 @@
                             <void property="conf"> 
                              <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
                               <void property="dirName"> 
-                               <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-57-32_320_4074994742709103859/-ext-10000</string> 
+                               <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-15_772_2901808161378380637/-ext-10000</string> 
                               </void> 
                               <void property="numFiles"> 
                                <int>1</int> 
@@ -134,7 +134,7 @@
                                   </void> 
                                   <void method="put"> 
                                    <string>location</string> 
-                                   <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/dest1</string> 
+                                   <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/dest1</string> 
                                   </void> 
                                   <void method="put"> 
                                    <string>file.outputformat</string> 
@@ -142,7 +142,7 @@
                                   </void> 
                                   <void method="put"> 
                                    <string>transient_lastDdlTime</string> 
-                                   <string>1304060251</string> 
+                                   <string>1310382375</string> 
                                   </void> 
                                  </object> 
                                 </void> 
@@ -159,21 +159,21 @@
                             <void property="counterNames"> 
                              <object class="java.util.ArrayList"> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_549_NUM_INPUT_ROWS</string> 
+                               <string>CNTR_NAME_FS_531_NUM_INPUT_ROWS</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_549_NUM_OUTPUT_ROWS</string> 
+                               <string>CNTR_NAME_FS_531_NUM_OUTPUT_ROWS</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_549_TIME_TAKEN</string> 
+                               <string>CNTR_NAME_FS_531_TIME_TAKEN</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_549_FATAL_ERROR</string> 
+                               <string>CNTR_NAME_FS_531_FATAL_ERROR</string> 
                               </void> 
                              </object> 
                             </void> 
                             <void property="operatorId"> 
-                             <string>FS_549</string> 
+                             <string>FS_531</string> 
                             </void> 
                             <void property="parentOperators"> 
                              <object class="java.util.ArrayList"> 
@@ -227,21 +227,21 @@
                         <void property="counterNames"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_548_NUM_INPUT_ROWS</string> 
+                           <string>CNTR_NAME_TS_530_NUM_INPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_548_NUM_OUTPUT_ROWS</string> 
+                           <string>CNTR_NAME_TS_530_NUM_OUTPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_548_TIME_TAKEN</string> 
+                           <string>CNTR_NAME_TS_530_TIME_TAKEN</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_548_FATAL_ERROR</string> 
+                           <string>CNTR_NAME_TS_530_FATAL_ERROR</string> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="operatorId"> 
-                         <string>TS_548</string> 
+                         <string>TS_530</string> 
                         </void> 
                         <void property="schema"> 
                          <object idref="RowSchema0"/> 
@@ -262,10 +262,10 @@
                     <void property="pathToAliases"> 
                      <object class="java.util.LinkedHashMap"> 
                       <void method="put"> 
-                       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-57-32_320_4074994742709103859/-ext-10002</string> 
+                       <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-15_772_2901808161378380637/-ext-10002</string> 
                        <object class="java.util.ArrayList"> 
                         <void method="add"> 
-                         <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-57-32_320_4074994742709103859/-ext-10002</string> 
+                         <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-15_772_2901808161378380637/-ext-10002</string> 
                         </void> 
                        </object> 
                       </void> 
@@ -274,7 +274,7 @@
                     <void property="pathToPartitionInfo"> 
                      <object class="java.util.LinkedHashMap"> 
                       <void method="put"> 
-                       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-57-32_320_4074994742709103859/-ext-10002</string> 
+                       <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-15_772_2901808161378380637/-ext-10002</string> 
                        <object class="org.apache.hadoop.hive.ql.plan.PartitionDesc"> 
                         <void property="baseFileName"> 
                          <string>-ext-10002</string> 
@@ -328,11 +328,11 @@
                           </void> 
                           <void method="put"> 
                            <string>location</string> 
-                           <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/dest1</string> 
+                           <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/dest1</string> 
                           </void> 
                           <void method="put"> 
                            <string>transient_lastDdlTime</string> 
-                           <string>1304060251</string> 
+                           <string>1310382375</string> 
                           </void> 
                          </object> 
                         </void> 
@@ -382,13 +382,13 @@
                    <boolean>true</boolean> 
                   </void> 
                   <void property="sourceDir"> 
-                   <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-57-32_320_4074994742709103859/-ext-10000</string> 
+                   <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-15_772_2901808161378380637/-ext-10000</string> 
                   </void> 
                   <void property="table"> 
                    <object idref="TableDesc0"/> 
                   </void> 
                   <void property="tmpDir"> 
-                   <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-57-32_320_4074994742709103859/-ext-10001</string> 
+                   <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-15_772_2901808161378380637/-ext-10001</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -409,10 +409,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-57-32_320_4074994742709103859/-ext-10002</string> 
+               <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-15_772_2901808161378380637/-ext-10002</string> 
               </void> 
               <void property="targetDir"> 
-               <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-57-32_320_4074994742709103859/-ext-10000</string> 
+               <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-15_772_2901808161378380637/-ext-10000</string> 
               </void> 
              </object> 
             </void> 
@@ -438,7 +438,7 @@
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
         <void property="dir"> 
-         <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-57-32_320_4074994742709103859/-ext-10002</string> 
+         <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-15_772_2901808161378380637/-ext-10002</string> 
         </void> 
         <void property="listTasks"> 
          <object idref="ArrayList0"/> 
@@ -528,11 +528,11 @@
          </void> 
          <void method="put"> 
           <string>location</string> 
-          <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket</string> 
+          <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket</string> 
          </void> 
          <void method="put"> 
           <string>transient_lastDdlTime</string> 
-          <string>1304060246</string> 
+          <string>1310382373</string> 
          </void> 
         </object> 
        </void> 
@@ -594,11 +594,11 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket</string> 
+            <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket</string> 
            </void> 
            <void method="put"> 
             <string>transient_lastDdlTime</string> 
-            <string>1304060246</string> 
+            <string>1310382373</string> 
            </void> 
           </object> 
          </void> 
@@ -622,351 +622,150 @@
             <void property="childOperators"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+               <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                    <void property="childOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                        <void property="conf"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                          <void property="destTableId"> 
-                           <int>1</int> 
-                          </void> 
-                          <void property="dirName"> 
-                           <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-57-32_320_4074994742709103859/-ext-10002</string> 
-                          </void> 
-                          <void property="gatherStats"> 
-                           <boolean>true</boolean> 
-                          </void> 
-                          <void property="numFiles"> 
-                           <int>1</int> 
-                          </void> 
-                          <void property="statsAggPrefix"> 
-                           <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-57-32_320_4074994742709103859/-ext-10000/</string> 
-                          </void> 
-                          <void property="tableInfo"> 
-                           <object idref="TableDesc0"/> 
-                          </void> 
-                          <void property="totalFiles"> 
-                           <int>1</int> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="counterNames"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_546_NUM_INPUT_ROWS</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_546_NUM_OUTPUT_ROWS</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_546_TIME_TAKEN</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_546_FATAL_ERROR</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="operatorId"> 
-                         <string>FS_546</string> 
-                        </void> 
-                        <void property="parentOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object idref="SelectOperator0"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="schema"> 
-                         <object idref="RowSchema0"/> 
-                        </void> 
-                       </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                    <void property="conf"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                      <void property="destTableId"> 
+                       <int>1</int> 
                       </void> 
-                     </object> 
-                    </void> 
-                    <void property="columnExprMap"> 
-                     <object class="java.util.HashMap"> 
-                      <void method="put"> 
-                       <string>_col1</string> 
-                       <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>value</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>s</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
+                      <void property="dirName"> 
+                       <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-15_772_2901808161378380637/-ext-10002</string> 
                       </void> 
-                      <void method="put"> 
-                       <string>_col0</string> 
-                       <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>s</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>int</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
+                      <void property="gatherStats"> 
+                       <boolean>true</boolean> 
                       </void> 
-                     </object> 
-                    </void> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                      <void property="colList"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc1"/> 
-                        </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc0"/> 
-                        </void> 
-                       </object> 
+                      <void property="numFiles"> 
+                       <int>1</int> 
                       </void> 
-                      <void property="outputColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void method="add"> 
-                         <string>_col1</string> 
-                        </void> 
-                       </object> 
+                      <void property="statsAggPrefix"> 
+                       <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-15_772_2901808161378380637/-ext-10000/</string> 
                       </void> 
-                      <void property="selectStar"> 
-                       <boolean>true</boolean> 
+                      <void property="tableInfo"> 
+                       <object idref="TableDesc0"/> 
+                      </void> 
+                      <void property="totalFiles"> 
+                       <int>1</int> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_545_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_FS_529_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_545_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_FS_529_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_545_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_FS_529_TIME_TAKEN</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_545_FATAL_ERROR</string> 
+                       <string>CNTR_NAME_FS_529_FATAL_ERROR</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>SEL_545</string> 
+                     <string>FS_529</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object idref="FilterOperator1"/> 
+                       <object idref="SelectOperator0"/> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="schema"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                      <void property="signature"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col0</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string>s</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo1"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col1</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string>s</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                     <object idref="RowSchema0"/> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-                  <void property="isSamplingPred"> 
-                   <boolean>true</boolean> 
+                <void property="columnExprMap"> 
+                 <object class="java.util.HashMap"> 
+                  <void method="put"> 
+                   <string>_col1</string> 
+                   <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>value</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string>s</string> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
                   </void> 
-                  <void property="predicate"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="childExprs"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                            <void property="childExprs"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                                <void property="childExprs"> 
-                                 <object class="java.util.ArrayList"> 
-                                  <void method="add"> 
-                                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                                    <void property="column"> 
-                                     <string>key</string> 
-                                    </void> 
-                                    <void property="tabAlias"> 
-                                     <string>s</string> 
-                                    </void> 
-                                    <void property="typeInfo"> 
-                                     <object idref="PrimitiveTypeInfo1"/> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void property="genericUDF"> 
-                                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFHash"/> 
-                                </void> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo1"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo1"/> 
-                                </void> 
-                                <void property="value"> 
-                                 <int>2147483647</int> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="genericUDF"> 
-                             <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                              <void property="operator"> 
-                               <boolean>true</boolean> 
-                              </void> 
-                              <void property="udfClass"> 
-                               <class>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</class> 
-                              </void> 
-                              <void property="udfName"> 
-                               <string>&amp;</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <int>2</int> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                          <void property="operator"> 
-                           <boolean>true</boolean> 
-                          </void> 
-                          <void property="udfClass"> 
-                           <class>org.apache.hadoop.hive.ql.udf.UDFOPMod</class> 
-                          </void> 
-                          <void property="udfName"> 
-                           <string>%</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>0</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                  <void method="put"> 
+                   <string>_col0</string> 
+                   <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>key</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual"/> 
+                    <void property="tabAlias"> 
+                     <string>s</string> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                     <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
                       <void property="typeName"> 
-                       <string>boolean</string> 
+                       <string>int</string> 
                       </void> 
                      </object> 
                     </void> 
                    </object> 
                   </void> 
-                  <void property="sampleDescr"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.FilterDesc$sampleDesc"/> 
+                 </object> 
+                </void> 
+                <void property="conf"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                  <void property="colList"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object idref="ExprNodeColumnDesc1"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="ExprNodeColumnDesc0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void property="outputColumnNames"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <string>_col0</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col1</string> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void property="selectStar"> 
+                   <boolean>true</boolean> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_544_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_528_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_544_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_528_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_544_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_SEL_528_TIME_TAKEN</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_544_FATAL_ERROR</string> 
+                   <string>CNTR_NAME_SEL_528_FATAL_ERROR</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>FIL_544</string> 
+                 <string>SEL_528</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -980,9 +779,9 @@
                   <void property="signature"> 
                    <object class="java.util.ArrayList"> 
                     <void method="add"> 
-                     <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                       <void property="internalName"> 
-                       <string>key</string> 
+                       <string>_col0</string> 
                       </void> 
                       <void property="tabAlias"> 
                        <string>s</string> 
@@ -993,9 +792,9 @@
                      </object> 
                     </void> 
                     <void method="add"> 
-                     <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                       <void property="internalName"> 
-                       <string>value</string> 
+                       <string>_col1</string> 
                       </void> 
                       <void property="tabAlias"> 
                        <string>s</string> 
@@ -1015,6 +814,9 @@
             </void> 
             <void property="conf"> 
              <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
+              <void property="isSamplingPred"> 
+               <boolean>true</boolean> 
+              </void> 
               <void property="predicate"> 
                <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
                 <void property="childExprs"> 
@@ -1130,30 +932,37 @@
                  <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual"/> 
                 </void> 
                 <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo2"/> 
+                 <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                  <void property="typeName"> 
+                   <string>boolean</string> 
+                  </void> 
+                 </object> 
                 </void> 
                </object> 
               </void> 
+              <void property="sampleDescr"> 
+               <object class="org.apache.hadoop.hive.ql.plan.FilterDesc$sampleDesc"/> 
+              </void> 
              </object> 
             </void> 
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_547_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_527_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_547_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_527_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_547_TIME_TAKEN</string> 
+               <string>CNTR_NAME_FIL_527_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_547_FATAL_ERROR</string> 
+               <string>CNTR_NAME_FIL_527_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>FIL_547</string> 
+             <string>FIL_527</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -1165,40 +974,24 @@
             <void property="schema"> 
              <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
               <void property="signature"> 
-               <object id="ArrayList1" class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object idref="ColumnInfo0"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ColumnInfo1"/> 
-                </void> 
+               <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="hiddenVirtualCol"> 
-                   <boolean>true</boolean> 
-                  </void> 
+                 <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                   <void property="internalName"> 
-                   <string>BLOCK__OFFSET__INSIDE__FILE</string> 
+                   <string>key</string> 
                   </void> 
                   <void property="tabAlias"> 
                    <string>s</string> 
                   </void> 
                   <void property="type"> 
-                   <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                    <void property="typeName"> 
-                     <string>bigint</string> 
-                    </void> 
-                   </object> 
+                   <object idref="PrimitiveTypeInfo1"/> 
                   </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="hiddenVirtualCol"> 
-                   <boolean>true</boolean> 
-                  </void> 
+                 <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                   <void property="internalName"> 
-                   <string>INPUT__FILE__NAME</string> 
+                   <string>value</string> 
                   </void> 
                   <void property="tabAlias"> 
                    <string>s</string> 
@@ -1229,16 +1022,16 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_543_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_526_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_543_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_526_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_543_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_526_TIME_TAKEN</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_543_FATAL_ERROR</string> 
+           <string>CNTR_NAME_TS_526_FATAL_ERROR</string> 
           </void> 
          </object> 
         </void> 
@@ -1253,12 +1046,55 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_543</string> 
+         <string>TS_526</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
           <void property="signature"> 
-           <object idref="ArrayList1"/> 
+           <object class="java.util.ArrayList"> 
+            <void method="add"> 
+             <object idref="ColumnInfo0"/> 
+            </void> 
+            <void method="add"> 
+             <object idref="ColumnInfo1"/> 
+            </void> 
+            <void method="add"> 
+             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+              <void property="hiddenVirtualCol"> 
+               <boolean>true</boolean> 
+              </void> 
+              <void property="internalName"> 
+               <string>BLOCK__OFFSET__INSIDE__FILE</string> 
+              </void> 
+              <void property="tabAlias"> 
+               <string>s</string> 
+              </void> 
+              <void property="type"> 
+               <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                <void property="typeName"> 
+                 <string>bigint</string> 
+                </void> 
+               </object> 
+              </void> 
+             </object> 
+            </void> 
+            <void method="add"> 
+             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+              <void property="hiddenVirtualCol"> 
+               <boolean>true</boolean> 
+              </void> 
+              <void property="internalName"> 
+               <string>INPUT__FILE__NAME</string> 
+              </void> 
+              <void property="tabAlias"> 
+               <string>s</string> 
+              </void> 
+              <void property="type"> 
+               <object idref="PrimitiveTypeInfo0"/> 
+              </void> 
+             </object> 
+            </void> 
+           </object> 
           </void> 
          </object> 
         </void> 
@@ -1275,7 +1111,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt</string> 
+       <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>s</string> 
@@ -1287,10 +1123,10 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt</string> 
+       <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket</string> 
        <object class="org.apache.hadoop.hive.ql.plan.PartitionDesc"> 
         <void property="baseFileName"> 
-         <string>srcbucket0.txt</string> 
+         <string>srcbucket</string> 
         </void> 
         <void property="deserializerClass"> 
          <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
@@ -1348,11 +1184,11 @@
           </void> 
           <void method="put"> 
            <string>location</string> 
-           <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket</string> 
+           <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket</string> 
           </void> 
           <void method="put"> 
            <string>transient_lastDdlTime</string> 
-           <string>1304060246</string> 
+           <string>1310382373</string> 
           </void> 
          </object> 
         </void> 
@@ -1414,11 +1250,11 @@
             </void> 
             <void method="put"> 
              <string>location</string> 
-             <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket</string> 
+             <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket</string> 
             </void> 
             <void method="put"> 
              <string>transient_lastDdlTime</string> 
-             <string>1304060246</string> 
+             <string>1310382373</string> 
             </void> 
            </object> 
           </void> 
diff --git a/ql/src/test/results/compiler/plan/sample3.q.xml b/ql/src/test/results/compiler/plan/sample3.q.xml
index 2308c5667e..3746e0fd29 100644
--- a/ql/src/test/results/compiler/plan/sample3.q.xml
+++ b/ql/src/test/results/compiler/plan/sample3.q.xml
@@ -1,5 +1,5 @@
 <?xml version="1.0" encoding="UTF-8"?> 
-<java version="1.6.0_07" class="java.beans.XMLDecoder"> 
+<java version="1.6.0_01" class="java.beans.XMLDecoder"> 
  <object id="MapRedTask0" class="org.apache.hadoop.hive.ql.exec.MapRedTask"> 
   <void property="childTasks"> 
    <object class="java.util.ArrayList"> 
@@ -33,7 +33,7 @@
                   <void property="work"> 
                    <object class="org.apache.hadoop.hive.ql.plan.StatsWork"> 
                     <void property="aggKey"> 
-                     <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-57-42_366_4406586519555038916/-ext-10000/</string> 
+                     <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-19_243_2379834322132096386/-ext-10000/</string> 
                     </void> 
                    </object> 
                   </void> 
@@ -73,7 +73,7 @@
                     <void property="aliasToWork"> 
                      <object class="java.util.LinkedHashMap"> 
                       <void method="put"> 
-                       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-57-42_366_4406586519555038916/-ext-10002</string> 
+                       <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-19_243_2379834322132096386/-ext-10002</string> 
                        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                         <void property="childOperators"> 
                          <object class="java.util.ArrayList"> 
@@ -82,7 +82,7 @@
                             <void property="conf"> 
                              <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
                               <void property="dirName"> 
-                               <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-57-42_366_4406586519555038916/-ext-10000</string> 
+                               <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-19_243_2379834322132096386/-ext-10000</string> 
                               </void> 
                               <void property="numFiles"> 
                                <int>1</int> 
@@ -134,7 +134,7 @@
                                   </void> 
                                   <void method="put"> 
                                    <string>location</string> 
-                                   <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/dest1</string> 
+                                   <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/dest1</string> 
                                   </void> 
                                   <void method="put"> 
                                    <string>file.outputformat</string> 
@@ -142,7 +142,7 @@
                                   </void> 
                                   <void method="put"> 
                                    <string>transient_lastDdlTime</string> 
-                                   <string>1304060262</string> 
+                                   <string>1310382379</string> 
                                   </void> 
                                  </object> 
                                 </void> 
@@ -159,21 +159,21 @@
                             <void property="counterNames"> 
                              <object class="java.util.ArrayList"> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_563_NUM_INPUT_ROWS</string> 
+                               <string>CNTR_NAME_FS_543_NUM_INPUT_ROWS</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_563_NUM_OUTPUT_ROWS</string> 
+                               <string>CNTR_NAME_FS_543_NUM_OUTPUT_ROWS</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_563_TIME_TAKEN</string> 
+                               <string>CNTR_NAME_FS_543_TIME_TAKEN</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_563_FATAL_ERROR</string> 
+                               <string>CNTR_NAME_FS_543_FATAL_ERROR</string> 
                               </void> 
                              </object> 
                             </void> 
                             <void property="operatorId"> 
-                             <string>FS_563</string> 
+                             <string>FS_543</string> 
                             </void> 
                             <void property="parentOperators"> 
                              <object class="java.util.ArrayList"> 
@@ -227,21 +227,21 @@
                         <void property="counterNames"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_562_NUM_INPUT_ROWS</string> 
+                           <string>CNTR_NAME_TS_542_NUM_INPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_562_NUM_OUTPUT_ROWS</string> 
+                           <string>CNTR_NAME_TS_542_NUM_OUTPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_562_TIME_TAKEN</string> 
+                           <string>CNTR_NAME_TS_542_TIME_TAKEN</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_562_FATAL_ERROR</string> 
+                           <string>CNTR_NAME_TS_542_FATAL_ERROR</string> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="operatorId"> 
-                         <string>TS_562</string> 
+                         <string>TS_542</string> 
                         </void> 
                         <void property="schema"> 
                          <object idref="RowSchema0"/> 
@@ -262,10 +262,10 @@
                     <void property="pathToAliases"> 
                      <object class="java.util.LinkedHashMap"> 
                       <void method="put"> 
-                       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-57-42_366_4406586519555038916/-ext-10002</string> 
+                       <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-19_243_2379834322132096386/-ext-10002</string> 
                        <object class="java.util.ArrayList"> 
                         <void method="add"> 
-                         <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-57-42_366_4406586519555038916/-ext-10002</string> 
+                         <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-19_243_2379834322132096386/-ext-10002</string> 
                         </void> 
                        </object> 
                       </void> 
@@ -274,7 +274,7 @@
                     <void property="pathToPartitionInfo"> 
                      <object class="java.util.LinkedHashMap"> 
                       <void method="put"> 
-                       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-57-42_366_4406586519555038916/-ext-10002</string> 
+                       <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-19_243_2379834322132096386/-ext-10002</string> 
                        <object class="org.apache.hadoop.hive.ql.plan.PartitionDesc"> 
                         <void property="baseFileName"> 
                          <string>-ext-10002</string> 
@@ -328,11 +328,11 @@
                           </void> 
                           <void method="put"> 
                            <string>location</string> 
-                           <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/dest1</string> 
+                           <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/dest1</string> 
                           </void> 
                           <void method="put"> 
                            <string>transient_lastDdlTime</string> 
-                           <string>1304060262</string> 
+                           <string>1310382379</string> 
                           </void> 
                          </object> 
                         </void> 
@@ -382,13 +382,13 @@
                    <boolean>true</boolean> 
                   </void> 
                   <void property="sourceDir"> 
-                   <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-57-42_366_4406586519555038916/-ext-10000</string> 
+                   <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-19_243_2379834322132096386/-ext-10000</string> 
                   </void> 
                   <void property="table"> 
                    <object idref="TableDesc0"/> 
                   </void> 
                   <void property="tmpDir"> 
-                   <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-57-42_366_4406586519555038916/-ext-10001</string> 
+                   <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-19_243_2379834322132096386/-ext-10001</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -409,10 +409,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-57-42_366_4406586519555038916/-ext-10002</string> 
+               <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-19_243_2379834322132096386/-ext-10002</string> 
               </void> 
               <void property="targetDir"> 
-               <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-57-42_366_4406586519555038916/-ext-10000</string> 
+               <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-19_243_2379834322132096386/-ext-10000</string> 
               </void> 
              </object> 
             </void> 
@@ -438,7 +438,7 @@
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
         <void property="dir"> 
-         <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-57-42_366_4406586519555038916/-ext-10002</string> 
+         <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-19_243_2379834322132096386/-ext-10002</string> 
         </void> 
         <void property="listTasks"> 
          <object idref="ArrayList0"/> 
@@ -528,11 +528,11 @@
          </void> 
          <void method="put"> 
           <string>location</string> 
-          <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket</string> 
+          <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket</string> 
          </void> 
          <void method="put"> 
           <string>transient_lastDdlTime</string> 
-          <string>1304060256</string> 
+          <string>1310382377</string> 
          </void> 
         </object> 
        </void> 
@@ -594,11 +594,11 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket</string> 
+            <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket</string> 
            </void> 
            <void method="put"> 
             <string>transient_lastDdlTime</string> 
-            <string>1304060256</string> 
+            <string>1310382377</string> 
            </void> 
           </object> 
          </void> 
@@ -622,336 +622,98 @@
             <void property="childOperators"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+               <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                    <void property="childOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                        <void property="conf"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                          <void property="destTableId"> 
-                           <int>1</int> 
-                          </void> 
-                          <void property="dirName"> 
-                           <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-57-42_366_4406586519555038916/-ext-10002</string> 
-                          </void> 
-                          <void property="gatherStats"> 
-                           <boolean>true</boolean> 
-                          </void> 
-                          <void property="numFiles"> 
-                           <int>1</int> 
-                          </void> 
-                          <void property="statsAggPrefix"> 
-                           <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-57-42_366_4406586519555038916/-ext-10000/</string> 
-                          </void> 
-                          <void property="tableInfo"> 
-                           <object idref="TableDesc0"/> 
-                          </void> 
-                          <void property="totalFiles"> 
-                           <int>1</int> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="counterNames"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_560_NUM_INPUT_ROWS</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_560_NUM_OUTPUT_ROWS</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_560_TIME_TAKEN</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_560_FATAL_ERROR</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="operatorId"> 
-                         <string>FS_560</string> 
-                        </void> 
-                        <void property="parentOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object idref="SelectOperator0"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="schema"> 
-                         <object idref="RowSchema0"/> 
-                        </void> 
-                       </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                    <void property="conf"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                      <void property="destTableId"> 
+                       <int>1</int> 
                       </void> 
-                     </object> 
-                    </void> 
-                    <void property="columnExprMap"> 
-                     <object class="java.util.HashMap"> 
-                      <void method="put"> 
-                       <string>_col1</string> 
-                       <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>value</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>s</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
+                      <void property="dirName"> 
+                       <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-19_243_2379834322132096386/-ext-10002</string> 
                       </void> 
-                      <void method="put"> 
-                       <string>_col0</string> 
-                       <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>s</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>int</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
+                      <void property="gatherStats"> 
+                       <boolean>true</boolean> 
                       </void> 
-                     </object> 
-                    </void> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                      <void property="colList"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc1"/> 
-                        </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc0"/> 
-                        </void> 
-                       </object> 
+                      <void property="numFiles"> 
+                       <int>1</int> 
                       </void> 
-                      <void property="outputColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void method="add"> 
-                         <string>_col1</string> 
-                        </void> 
-                       </object> 
+                      <void property="statsAggPrefix"> 
+                       <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-19_243_2379834322132096386/-ext-10000/</string> 
                       </void> 
-                      <void property="selectStar"> 
-                       <boolean>true</boolean> 
+                      <void property="tableInfo"> 
+                       <object idref="TableDesc0"/> 
+                      </void> 
+                      <void property="totalFiles"> 
+                       <int>1</int> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_559_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_FS_541_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_559_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_FS_541_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_559_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_FS_541_TIME_TAKEN</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_559_FATAL_ERROR</string> 
+                       <string>CNTR_NAME_FS_541_FATAL_ERROR</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>SEL_559</string> 
+                     <string>FS_541</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object idref="FilterOperator1"/> 
+                       <object idref="SelectOperator0"/> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="schema"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                      <void property="signature"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col0</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string>s</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo1"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col1</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string>s</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                     <object idref="RowSchema0"/> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-                  <void property="isSamplingPred"> 
-                   <boolean>true</boolean> 
+                <void property="columnExprMap"> 
+                 <object class="java.util.HashMap"> 
+                  <void method="put"> 
+                   <string>_col1</string> 
+                   <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>value</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string>s</string> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
                   </void> 
-                  <void property="predicate"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="childExprs"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                            <void property="childExprs"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                                <void property="childExprs"> 
-                                 <object class="java.util.ArrayList"> 
-                                  <void method="add"> 
-                                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                                    <void property="column"> 
-                                     <string>key</string> 
-                                    </void> 
-                                    <void property="tabAlias"> 
-                                     <string>s</string> 
-                                    </void> 
-                                    <void property="typeInfo"> 
-                                     <object idref="PrimitiveTypeInfo1"/> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                  <void method="add"> 
-                                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                                    <void property="column"> 
-                                     <string>value</string> 
-                                    </void> 
-                                    <void property="tabAlias"> 
-                                     <string>s</string> 
-                                    </void> 
-                                    <void property="typeInfo"> 
-                                     <object idref="PrimitiveTypeInfo0"/> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void property="genericUDF"> 
-                                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFHash"/> 
-                                </void> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo1"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo1"/> 
-                                </void> 
-                                <void property="value"> 
-                                 <int>2147483647</int> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="genericUDF"> 
-                             <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                              <void property="operator"> 
-                               <boolean>true</boolean> 
-                              </void> 
-                              <void property="udfClass"> 
-                               <class>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</class> 
-                              </void> 
-                              <void property="udfName"> 
-                               <string>&amp;</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <int>2</int> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                          <void property="operator"> 
-                           <boolean>true</boolean> 
-                          </void> 
-                          <void property="udfClass"> 
-                           <class>org.apache.hadoop.hive.ql.udf.UDFOPMod</class> 
-                          </void> 
-                          <void property="udfName"> 
-                           <string>%</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>0</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                  <void method="put"> 
+                   <string>_col0</string> 
+                   <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>key</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual"/> 
+                    <void property="tabAlias"> 
+                     <string>s</string> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                     <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
                       <void property="typeName"> 
-                       <string>boolean</string> 
+                       <string>int</string> 
                       </void> 
                      </object> 
                     </void> 
@@ -959,24 +721,51 @@
                   </void> 
                  </object> 
                 </void> 
+                <void property="conf"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                  <void property="colList"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object idref="ExprNodeColumnDesc1"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="ExprNodeColumnDesc0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void property="outputColumnNames"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <string>_col0</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col1</string> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void property="selectStar"> 
+                   <boolean>true</boolean> 
+                  </void> 
+                 </object> 
+                </void> 
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_558_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_540_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_558_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_540_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_558_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_SEL_540_TIME_TAKEN</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_558_FATAL_ERROR</string> 
+                   <string>CNTR_NAME_SEL_540_FATAL_ERROR</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>FIL_558</string> 
+                 <string>SEL_540</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -990,9 +779,9 @@
                   <void property="signature"> 
                    <object class="java.util.ArrayList"> 
                     <void method="add"> 
-                     <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                       <void property="internalName"> 
-                       <string>key</string> 
+                       <string>_col0</string> 
                       </void> 
                       <void property="tabAlias"> 
                        <string>s</string> 
@@ -1003,9 +792,9 @@
                      </object> 
                     </void> 
                     <void method="add"> 
-                     <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                       <void property="internalName"> 
-                       <string>value</string> 
+                       <string>_col1</string> 
                       </void> 
                       <void property="tabAlias"> 
                        <string>s</string> 
@@ -1025,6 +814,9 @@
             </void> 
             <void property="conf"> 
              <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
+              <void property="isSamplingPred"> 
+               <boolean>true</boolean> 
+              </void> 
               <void property="predicate"> 
                <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
                 <void property="childExprs"> 
@@ -1153,7 +945,11 @@
                  <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual"/> 
                 </void> 
                 <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo2"/> 
+                 <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                  <void property="typeName"> 
+                   <string>boolean</string> 
+                  </void> 
+                 </object> 
                 </void> 
                </object> 
               </void> 
@@ -1162,21 +958,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_561_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_539_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_561_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_539_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_561_TIME_TAKEN</string> 
+               <string>CNTR_NAME_FIL_539_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_561_FATAL_ERROR</string> 
+               <string>CNTR_NAME_FIL_539_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>FIL_561</string> 
+             <string>FIL_539</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -1188,40 +984,24 @@
             <void property="schema"> 
              <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
               <void property="signature"> 
-               <object id="ArrayList1" class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object idref="ColumnInfo0"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ColumnInfo1"/> 
-                </void> 
+               <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="hiddenVirtualCol"> 
-                   <boolean>true</boolean> 
-                  </void> 
+                 <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                   <void property="internalName"> 
-                   <string>BLOCK__OFFSET__INSIDE__FILE</string> 
+                   <string>key</string> 
                   </void> 
                   <void property="tabAlias"> 
                    <string>s</string> 
                   </void> 
                   <void property="type"> 
-                   <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                    <void property="typeName"> 
-                     <string>bigint</string> 
-                    </void> 
-                   </object> 
+                   <object idref="PrimitiveTypeInfo1"/> 
                   </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="hiddenVirtualCol"> 
-                   <boolean>true</boolean> 
-                  </void> 
+                 <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                   <void property="internalName"> 
-                   <string>INPUT__FILE__NAME</string> 
+                   <string>value</string> 
                   </void> 
                   <void property="tabAlias"> 
                    <string>s</string> 
@@ -1252,16 +1032,16 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_557_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_538_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_557_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_538_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_557_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_538_TIME_TAKEN</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_557_FATAL_ERROR</string> 
+           <string>CNTR_NAME_TS_538_FATAL_ERROR</string> 
           </void> 
          </object> 
         </void> 
@@ -1276,12 +1056,55 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_557</string> 
+         <string>TS_538</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
           <void property="signature"> 
-           <object idref="ArrayList1"/> 
+           <object class="java.util.ArrayList"> 
+            <void method="add"> 
+             <object idref="ColumnInfo0"/> 
+            </void> 
+            <void method="add"> 
+             <object idref="ColumnInfo1"/> 
+            </void> 
+            <void method="add"> 
+             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+              <void property="hiddenVirtualCol"> 
+               <boolean>true</boolean> 
+              </void> 
+              <void property="internalName"> 
+               <string>BLOCK__OFFSET__INSIDE__FILE</string> 
+              </void> 
+              <void property="tabAlias"> 
+               <string>s</string> 
+              </void> 
+              <void property="type"> 
+               <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                <void property="typeName"> 
+                 <string>bigint</string> 
+                </void> 
+               </object> 
+              </void> 
+             </object> 
+            </void> 
+            <void method="add"> 
+             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+              <void property="hiddenVirtualCol"> 
+               <boolean>true</boolean> 
+              </void> 
+              <void property="internalName"> 
+               <string>INPUT__FILE__NAME</string> 
+              </void> 
+              <void property="tabAlias"> 
+               <string>s</string> 
+              </void> 
+              <void property="type"> 
+               <object idref="PrimitiveTypeInfo0"/> 
+              </void> 
+             </object> 
+            </void> 
+           </object> 
           </void> 
          </object> 
         </void> 
@@ -1298,7 +1121,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket</string> 
+       <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>s</string> 
@@ -1310,7 +1133,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket</string> 
+       <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket</string> 
        <object class="org.apache.hadoop.hive.ql.plan.PartitionDesc"> 
         <void property="baseFileName"> 
          <string>srcbucket</string> 
@@ -1371,11 +1194,11 @@
           </void> 
           <void method="put"> 
            <string>location</string> 
-           <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket</string> 
+           <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket</string> 
           </void> 
           <void method="put"> 
            <string>transient_lastDdlTime</string> 
-           <string>1304060256</string> 
+           <string>1310382377</string> 
           </void> 
          </object> 
         </void> 
@@ -1437,11 +1260,11 @@
             </void> 
             <void method="put"> 
              <string>location</string> 
-             <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket</string> 
+             <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket</string> 
             </void> 
             <void method="put"> 
              <string>transient_lastDdlTime</string> 
-             <string>1304060256</string> 
+             <string>1310382377</string> 
             </void> 
            </object> 
           </void> 
diff --git a/ql/src/test/results/compiler/plan/sample4.q.xml b/ql/src/test/results/compiler/plan/sample4.q.xml
index 68e4b18945..17c32b749d 100644
--- a/ql/src/test/results/compiler/plan/sample4.q.xml
+++ b/ql/src/test/results/compiler/plan/sample4.q.xml
@@ -1,5 +1,5 @@
 <?xml version="1.0" encoding="UTF-8"?> 
-<java version="1.6.0_07" class="java.beans.XMLDecoder"> 
+<java version="1.6.0_01" class="java.beans.XMLDecoder"> 
  <object id="MapRedTask0" class="org.apache.hadoop.hive.ql.exec.MapRedTask"> 
   <void property="childTasks"> 
    <object class="java.util.ArrayList"> 
@@ -33,7 +33,7 @@
                   <void property="work"> 
                    <object class="org.apache.hadoop.hive.ql.plan.StatsWork"> 
                     <void property="aggKey"> 
-                     <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-57-52_427_2529501116964601029/-ext-10000/</string> 
+                     <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-22_731_7652885142239938307/-ext-10000/</string> 
                     </void> 
                    </object> 
                   </void> 
@@ -73,7 +73,7 @@
                     <void property="aliasToWork"> 
                      <object class="java.util.LinkedHashMap"> 
                       <void method="put"> 
-                       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-57-52_427_2529501116964601029/-ext-10002</string> 
+                       <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-22_731_7652885142239938307/-ext-10002</string> 
                        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                         <void property="childOperators"> 
                          <object class="java.util.ArrayList"> 
@@ -82,7 +82,7 @@
                             <void property="conf"> 
                              <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
                               <void property="dirName"> 
-                               <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-57-52_427_2529501116964601029/-ext-10000</string> 
+                               <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-22_731_7652885142239938307/-ext-10000</string> 
                               </void> 
                               <void property="numFiles"> 
                                <int>1</int> 
@@ -134,7 +134,7 @@
                                   </void> 
                                   <void method="put"> 
                                    <string>location</string> 
-                                   <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/dest1</string> 
+                                   <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/dest1</string> 
                                   </void> 
                                   <void method="put"> 
                                    <string>file.outputformat</string> 
@@ -142,7 +142,7 @@
                                   </void> 
                                   <void method="put"> 
                                    <string>transient_lastDdlTime</string> 
-                                   <string>1304060272</string> 
+                                   <string>1310382382</string> 
                                   </void> 
                                  </object> 
                                 </void> 
@@ -159,21 +159,21 @@
                             <void property="counterNames"> 
                              <object class="java.util.ArrayList"> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_577_NUM_INPUT_ROWS</string> 
+                               <string>CNTR_NAME_FS_555_NUM_INPUT_ROWS</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_577_NUM_OUTPUT_ROWS</string> 
+                               <string>CNTR_NAME_FS_555_NUM_OUTPUT_ROWS</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_577_TIME_TAKEN</string> 
+                               <string>CNTR_NAME_FS_555_TIME_TAKEN</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_577_FATAL_ERROR</string> 
+                               <string>CNTR_NAME_FS_555_FATAL_ERROR</string> 
                               </void> 
                              </object> 
                             </void> 
                             <void property="operatorId"> 
-                             <string>FS_577</string> 
+                             <string>FS_555</string> 
                             </void> 
                             <void property="parentOperators"> 
                              <object class="java.util.ArrayList"> 
@@ -227,21 +227,21 @@
                         <void property="counterNames"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_576_NUM_INPUT_ROWS</string> 
+                           <string>CNTR_NAME_TS_554_NUM_INPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_576_NUM_OUTPUT_ROWS</string> 
+                           <string>CNTR_NAME_TS_554_NUM_OUTPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_576_TIME_TAKEN</string> 
+                           <string>CNTR_NAME_TS_554_TIME_TAKEN</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_576_FATAL_ERROR</string> 
+                           <string>CNTR_NAME_TS_554_FATAL_ERROR</string> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="operatorId"> 
-                         <string>TS_576</string> 
+                         <string>TS_554</string> 
                         </void> 
                         <void property="schema"> 
                          <object idref="RowSchema0"/> 
@@ -262,10 +262,10 @@
                     <void property="pathToAliases"> 
                      <object class="java.util.LinkedHashMap"> 
                       <void method="put"> 
-                       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-57-52_427_2529501116964601029/-ext-10002</string> 
+                       <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-22_731_7652885142239938307/-ext-10002</string> 
                        <object class="java.util.ArrayList"> 
                         <void method="add"> 
-                         <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-57-52_427_2529501116964601029/-ext-10002</string> 
+                         <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-22_731_7652885142239938307/-ext-10002</string> 
                         </void> 
                        </object> 
                       </void> 
@@ -274,7 +274,7 @@
                     <void property="pathToPartitionInfo"> 
                      <object class="java.util.LinkedHashMap"> 
                       <void method="put"> 
-                       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-57-52_427_2529501116964601029/-ext-10002</string> 
+                       <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-22_731_7652885142239938307/-ext-10002</string> 
                        <object class="org.apache.hadoop.hive.ql.plan.PartitionDesc"> 
                         <void property="baseFileName"> 
                          <string>-ext-10002</string> 
@@ -328,11 +328,11 @@
                           </void> 
                           <void method="put"> 
                            <string>location</string> 
-                           <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/dest1</string> 
+                           <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/dest1</string> 
                           </void> 
                           <void method="put"> 
                            <string>transient_lastDdlTime</string> 
-                           <string>1304060272</string> 
+                           <string>1310382382</string> 
                           </void> 
                          </object> 
                         </void> 
@@ -382,13 +382,13 @@
                    <boolean>true</boolean> 
                   </void> 
                   <void property="sourceDir"> 
-                   <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-57-52_427_2529501116964601029/-ext-10000</string> 
+                   <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-22_731_7652885142239938307/-ext-10000</string> 
                   </void> 
                   <void property="table"> 
                    <object idref="TableDesc0"/> 
                   </void> 
                   <void property="tmpDir"> 
-                   <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-57-52_427_2529501116964601029/-ext-10001</string> 
+                   <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-22_731_7652885142239938307/-ext-10001</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -409,10 +409,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-57-52_427_2529501116964601029/-ext-10002</string> 
+               <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-22_731_7652885142239938307/-ext-10002</string> 
               </void> 
               <void property="targetDir"> 
-               <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-57-52_427_2529501116964601029/-ext-10000</string> 
+               <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-22_731_7652885142239938307/-ext-10000</string> 
               </void> 
              </object> 
             </void> 
@@ -438,7 +438,7 @@
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
         <void property="dir"> 
-         <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-57-52_427_2529501116964601029/-ext-10002</string> 
+         <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-22_731_7652885142239938307/-ext-10002</string> 
         </void> 
         <void property="listTasks"> 
          <object idref="ArrayList0"/> 
@@ -528,11 +528,11 @@
          </void> 
          <void method="put"> 
           <string>location</string> 
-          <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket</string> 
+          <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket</string> 
          </void> 
          <void method="put"> 
           <string>transient_lastDdlTime</string> 
-          <string>1304060266</string> 
+          <string>1310382380</string> 
          </void> 
         </object> 
        </void> 
@@ -594,11 +594,11 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket</string> 
+            <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket</string> 
            </void> 
            <void method="put"> 
             <string>transient_lastDdlTime</string> 
-            <string>1304060266</string> 
+            <string>1310382380</string> 
            </void> 
           </object> 
          </void> 
@@ -622,351 +622,150 @@
             <void property="childOperators"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+               <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                    <void property="childOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                        <void property="conf"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                          <void property="destTableId"> 
-                           <int>1</int> 
-                          </void> 
-                          <void property="dirName"> 
-                           <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-57-52_427_2529501116964601029/-ext-10002</string> 
-                          </void> 
-                          <void property="gatherStats"> 
-                           <boolean>true</boolean> 
-                          </void> 
-                          <void property="numFiles"> 
-                           <int>1</int> 
-                          </void> 
-                          <void property="statsAggPrefix"> 
-                           <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-57-52_427_2529501116964601029/-ext-10000/</string> 
-                          </void> 
-                          <void property="tableInfo"> 
-                           <object idref="TableDesc0"/> 
-                          </void> 
-                          <void property="totalFiles"> 
-                           <int>1</int> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="counterNames"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_574_NUM_INPUT_ROWS</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_574_NUM_OUTPUT_ROWS</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_574_TIME_TAKEN</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_574_FATAL_ERROR</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="operatorId"> 
-                         <string>FS_574</string> 
-                        </void> 
-                        <void property="parentOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object idref="SelectOperator0"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="schema"> 
-                         <object idref="RowSchema0"/> 
-                        </void> 
-                       </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                    <void property="conf"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                      <void property="destTableId"> 
+                       <int>1</int> 
                       </void> 
-                     </object> 
-                    </void> 
-                    <void property="columnExprMap"> 
-                     <object class="java.util.HashMap"> 
-                      <void method="put"> 
-                       <string>_col1</string> 
-                       <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>value</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>s</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
+                      <void property="dirName"> 
+                       <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-22_731_7652885142239938307/-ext-10002</string> 
                       </void> 
-                      <void method="put"> 
-                       <string>_col0</string> 
-                       <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>s</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>int</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
+                      <void property="gatherStats"> 
+                       <boolean>true</boolean> 
                       </void> 
-                     </object> 
-                    </void> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                      <void property="colList"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc1"/> 
-                        </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc0"/> 
-                        </void> 
-                       </object> 
+                      <void property="numFiles"> 
+                       <int>1</int> 
                       </void> 
-                      <void property="outputColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void method="add"> 
-                         <string>_col1</string> 
-                        </void> 
-                       </object> 
+                      <void property="statsAggPrefix"> 
+                       <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-22_731_7652885142239938307/-ext-10000/</string> 
                       </void> 
-                      <void property="selectStar"> 
-                       <boolean>true</boolean> 
+                      <void property="tableInfo"> 
+                       <object idref="TableDesc0"/> 
+                      </void> 
+                      <void property="totalFiles"> 
+                       <int>1</int> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_573_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_FS_553_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_573_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_FS_553_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_573_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_FS_553_TIME_TAKEN</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_573_FATAL_ERROR</string> 
+                       <string>CNTR_NAME_FS_553_FATAL_ERROR</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>SEL_573</string> 
+                     <string>FS_553</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object idref="FilterOperator1"/> 
+                       <object idref="SelectOperator0"/> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="schema"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                      <void property="signature"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col0</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string>s</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo1"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col1</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string>s</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                     <object idref="RowSchema0"/> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-                  <void property="isSamplingPred"> 
-                   <boolean>true</boolean> 
+                <void property="columnExprMap"> 
+                 <object class="java.util.HashMap"> 
+                  <void method="put"> 
+                   <string>_col1</string> 
+                   <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>value</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string>s</string> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
                   </void> 
-                  <void property="predicate"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="childExprs"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                            <void property="childExprs"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                                <void property="childExprs"> 
-                                 <object class="java.util.ArrayList"> 
-                                  <void method="add"> 
-                                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                                    <void property="column"> 
-                                     <string>key</string> 
-                                    </void> 
-                                    <void property="tabAlias"> 
-                                     <string>s</string> 
-                                    </void> 
-                                    <void property="typeInfo"> 
-                                     <object idref="PrimitiveTypeInfo1"/> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void property="genericUDF"> 
-                                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFHash"/> 
-                                </void> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo1"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo1"/> 
-                                </void> 
-                                <void property="value"> 
-                                 <int>2147483647</int> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="genericUDF"> 
-                             <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                              <void property="operator"> 
-                               <boolean>true</boolean> 
-                              </void> 
-                              <void property="udfClass"> 
-                               <class>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</class> 
-                              </void> 
-                              <void property="udfName"> 
-                               <string>&amp;</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <int>2</int> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                          <void property="operator"> 
-                           <boolean>true</boolean> 
-                          </void> 
-                          <void property="udfClass"> 
-                           <class>org.apache.hadoop.hive.ql.udf.UDFOPMod</class> 
-                          </void> 
-                          <void property="udfName"> 
-                           <string>%</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>0</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                  <void method="put"> 
+                   <string>_col0</string> 
+                   <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>key</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual"/> 
+                    <void property="tabAlias"> 
+                     <string>s</string> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                     <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
                       <void property="typeName"> 
-                       <string>boolean</string> 
+                       <string>int</string> 
                       </void> 
                      </object> 
                     </void> 
                    </object> 
                   </void> 
-                  <void property="sampleDescr"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.FilterDesc$sampleDesc"/> 
+                 </object> 
+                </void> 
+                <void property="conf"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                  <void property="colList"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object idref="ExprNodeColumnDesc1"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="ExprNodeColumnDesc0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void property="outputColumnNames"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <string>_col0</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col1</string> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void property="selectStar"> 
+                   <boolean>true</boolean> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_572_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_552_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_572_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_552_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_572_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_SEL_552_TIME_TAKEN</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_572_FATAL_ERROR</string> 
+                   <string>CNTR_NAME_SEL_552_FATAL_ERROR</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>FIL_572</string> 
+                 <string>SEL_552</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -980,9 +779,9 @@
                   <void property="signature"> 
                    <object class="java.util.ArrayList"> 
                     <void method="add"> 
-                     <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                       <void property="internalName"> 
-                       <string>key</string> 
+                       <string>_col0</string> 
                       </void> 
                       <void property="tabAlias"> 
                        <string>s</string> 
@@ -993,9 +792,9 @@
                      </object> 
                     </void> 
                     <void method="add"> 
-                     <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                       <void property="internalName"> 
-                       <string>value</string> 
+                       <string>_col1</string> 
                       </void> 
                       <void property="tabAlias"> 
                        <string>s</string> 
@@ -1015,6 +814,9 @@
             </void> 
             <void property="conf"> 
              <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
+              <void property="isSamplingPred"> 
+               <boolean>true</boolean> 
+              </void> 
               <void property="predicate"> 
                <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
                 <void property="childExprs"> 
@@ -1130,30 +932,37 @@
                  <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual"/> 
                 </void> 
                 <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo2"/> 
+                 <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                  <void property="typeName"> 
+                   <string>boolean</string> 
+                  </void> 
+                 </object> 
                 </void> 
                </object> 
               </void> 
+              <void property="sampleDescr"> 
+               <object class="org.apache.hadoop.hive.ql.plan.FilterDesc$sampleDesc"/> 
+              </void> 
              </object> 
             </void> 
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_575_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_551_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_575_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_551_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_575_TIME_TAKEN</string> 
+               <string>CNTR_NAME_FIL_551_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_575_FATAL_ERROR</string> 
+               <string>CNTR_NAME_FIL_551_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>FIL_575</string> 
+             <string>FIL_551</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -1165,40 +974,24 @@
             <void property="schema"> 
              <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
               <void property="signature"> 
-               <object id="ArrayList1" class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object idref="ColumnInfo0"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ColumnInfo1"/> 
-                </void> 
+               <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="hiddenVirtualCol"> 
-                   <boolean>true</boolean> 
-                  </void> 
+                 <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                   <void property="internalName"> 
-                   <string>BLOCK__OFFSET__INSIDE__FILE</string> 
+                   <string>key</string> 
                   </void> 
                   <void property="tabAlias"> 
                    <string>s</string> 
                   </void> 
                   <void property="type"> 
-                   <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                    <void property="typeName"> 
-                     <string>bigint</string> 
-                    </void> 
-                   </object> 
+                   <object idref="PrimitiveTypeInfo1"/> 
                   </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="hiddenVirtualCol"> 
-                   <boolean>true</boolean> 
-                  </void> 
+                 <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                   <void property="internalName"> 
-                   <string>INPUT__FILE__NAME</string> 
+                   <string>value</string> 
                   </void> 
                   <void property="tabAlias"> 
                    <string>s</string> 
@@ -1229,16 +1022,16 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_571_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_550_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_571_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_550_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_571_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_550_TIME_TAKEN</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_571_FATAL_ERROR</string> 
+           <string>CNTR_NAME_TS_550_FATAL_ERROR</string> 
           </void> 
          </object> 
         </void> 
@@ -1253,12 +1046,55 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_571</string> 
+         <string>TS_550</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
           <void property="signature"> 
-           <object idref="ArrayList1"/> 
+           <object class="java.util.ArrayList"> 
+            <void method="add"> 
+             <object idref="ColumnInfo0"/> 
+            </void> 
+            <void method="add"> 
+             <object idref="ColumnInfo1"/> 
+            </void> 
+            <void method="add"> 
+             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+              <void property="hiddenVirtualCol"> 
+               <boolean>true</boolean> 
+              </void> 
+              <void property="internalName"> 
+               <string>BLOCK__OFFSET__INSIDE__FILE</string> 
+              </void> 
+              <void property="tabAlias"> 
+               <string>s</string> 
+              </void> 
+              <void property="type"> 
+               <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                <void property="typeName"> 
+                 <string>bigint</string> 
+                </void> 
+               </object> 
+              </void> 
+             </object> 
+            </void> 
+            <void method="add"> 
+             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+              <void property="hiddenVirtualCol"> 
+               <boolean>true</boolean> 
+              </void> 
+              <void property="internalName"> 
+               <string>INPUT__FILE__NAME</string> 
+              </void> 
+              <void property="tabAlias"> 
+               <string>s</string> 
+              </void> 
+              <void property="type"> 
+               <object idref="PrimitiveTypeInfo0"/> 
+              </void> 
+             </object> 
+            </void> 
+           </object> 
           </void> 
          </object> 
         </void> 
@@ -1275,7 +1111,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt</string> 
+       <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>s</string> 
@@ -1287,10 +1123,10 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt</string> 
+       <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket</string> 
        <object class="org.apache.hadoop.hive.ql.plan.PartitionDesc"> 
         <void property="baseFileName"> 
-         <string>srcbucket0.txt</string> 
+         <string>srcbucket</string> 
         </void> 
         <void property="deserializerClass"> 
          <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
@@ -1348,11 +1184,11 @@
           </void> 
           <void method="put"> 
            <string>location</string> 
-           <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket</string> 
+           <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket</string> 
           </void> 
           <void method="put"> 
            <string>transient_lastDdlTime</string> 
-           <string>1304060266</string> 
+           <string>1310382380</string> 
           </void> 
          </object> 
         </void> 
@@ -1414,11 +1250,11 @@
             </void> 
             <void method="put"> 
              <string>location</string> 
-             <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket</string> 
+             <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket</string> 
             </void> 
             <void method="put"> 
              <string>transient_lastDdlTime</string> 
-             <string>1304060266</string> 
+             <string>1310382380</string> 
             </void> 
            </object> 
           </void> 
diff --git a/ql/src/test/results/compiler/plan/sample5.q.xml b/ql/src/test/results/compiler/plan/sample5.q.xml
index 16f65731b7..49589cc513 100644
--- a/ql/src/test/results/compiler/plan/sample5.q.xml
+++ b/ql/src/test/results/compiler/plan/sample5.q.xml
@@ -1,5 +1,5 @@
 <?xml version="1.0" encoding="UTF-8"?> 
-<java version="1.6.0_07" class="java.beans.XMLDecoder"> 
+<java version="1.6.0_01" class="java.beans.XMLDecoder"> 
  <object id="MapRedTask0" class="org.apache.hadoop.hive.ql.exec.MapRedTask"> 
   <void property="childTasks"> 
    <object class="java.util.ArrayList"> 
@@ -33,7 +33,7 @@
                   <void property="work"> 
                    <object class="org.apache.hadoop.hive.ql.plan.StatsWork"> 
                     <void property="aggKey"> 
-                     <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-58-02_739_6497337761493060098/-ext-10000/</string> 
+                     <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-26_178_8445131308101140110/-ext-10000/</string> 
                     </void> 
                    </object> 
                   </void> 
@@ -73,7 +73,7 @@
                     <void property="aliasToWork"> 
                      <object class="java.util.LinkedHashMap"> 
                       <void method="put"> 
-                       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-58-02_739_6497337761493060098/-ext-10002</string> 
+                       <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-26_178_8445131308101140110/-ext-10002</string> 
                        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                         <void property="childOperators"> 
                          <object class="java.util.ArrayList"> 
@@ -82,7 +82,7 @@
                             <void property="conf"> 
                              <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
                               <void property="dirName"> 
-                               <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-58-02_739_6497337761493060098/-ext-10000</string> 
+                               <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-26_178_8445131308101140110/-ext-10000</string> 
                               </void> 
                               <void property="numFiles"> 
                                <int>1</int> 
@@ -134,7 +134,7 @@
                                   </void> 
                                   <void method="put"> 
                                    <string>location</string> 
-                                   <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/dest1</string> 
+                                   <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/dest1</string> 
                                   </void> 
                                   <void method="put"> 
                                    <string>file.outputformat</string> 
@@ -142,7 +142,7 @@
                                   </void> 
                                   <void method="put"> 
                                    <string>transient_lastDdlTime</string> 
-                                   <string>1304060282</string> 
+                                   <string>1310382386</string> 
                                   </void> 
                                  </object> 
                                 </void> 
@@ -159,21 +159,21 @@
                             <void property="counterNames"> 
                              <object class="java.util.ArrayList"> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_591_NUM_INPUT_ROWS</string> 
+                               <string>CNTR_NAME_FS_567_NUM_INPUT_ROWS</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_591_NUM_OUTPUT_ROWS</string> 
+                               <string>CNTR_NAME_FS_567_NUM_OUTPUT_ROWS</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_591_TIME_TAKEN</string> 
+                               <string>CNTR_NAME_FS_567_TIME_TAKEN</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_591_FATAL_ERROR</string> 
+                               <string>CNTR_NAME_FS_567_FATAL_ERROR</string> 
                               </void> 
                              </object> 
                             </void> 
                             <void property="operatorId"> 
-                             <string>FS_591</string> 
+                             <string>FS_567</string> 
                             </void> 
                             <void property="parentOperators"> 
                              <object class="java.util.ArrayList"> 
@@ -227,21 +227,21 @@
                         <void property="counterNames"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_590_NUM_INPUT_ROWS</string> 
+                           <string>CNTR_NAME_TS_566_NUM_INPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_590_NUM_OUTPUT_ROWS</string> 
+                           <string>CNTR_NAME_TS_566_NUM_OUTPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_590_TIME_TAKEN</string> 
+                           <string>CNTR_NAME_TS_566_TIME_TAKEN</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_590_FATAL_ERROR</string> 
+                           <string>CNTR_NAME_TS_566_FATAL_ERROR</string> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="operatorId"> 
-                         <string>TS_590</string> 
+                         <string>TS_566</string> 
                         </void> 
                         <void property="schema"> 
                          <object idref="RowSchema0"/> 
@@ -262,10 +262,10 @@
                     <void property="pathToAliases"> 
                      <object class="java.util.LinkedHashMap"> 
                       <void method="put"> 
-                       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-58-02_739_6497337761493060098/-ext-10002</string> 
+                       <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-26_178_8445131308101140110/-ext-10002</string> 
                        <object class="java.util.ArrayList"> 
                         <void method="add"> 
-                         <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-58-02_739_6497337761493060098/-ext-10002</string> 
+                         <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-26_178_8445131308101140110/-ext-10002</string> 
                         </void> 
                        </object> 
                       </void> 
@@ -274,7 +274,7 @@
                     <void property="pathToPartitionInfo"> 
                      <object class="java.util.LinkedHashMap"> 
                       <void method="put"> 
-                       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-58-02_739_6497337761493060098/-ext-10002</string> 
+                       <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-26_178_8445131308101140110/-ext-10002</string> 
                        <object class="org.apache.hadoop.hive.ql.plan.PartitionDesc"> 
                         <void property="baseFileName"> 
                          <string>-ext-10002</string> 
@@ -328,11 +328,11 @@
                           </void> 
                           <void method="put"> 
                            <string>location</string> 
-                           <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/dest1</string> 
+                           <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/dest1</string> 
                           </void> 
                           <void method="put"> 
                            <string>transient_lastDdlTime</string> 
-                           <string>1304060282</string> 
+                           <string>1310382386</string> 
                           </void> 
                          </object> 
                         </void> 
@@ -382,13 +382,13 @@
                    <boolean>true</boolean> 
                   </void> 
                   <void property="sourceDir"> 
-                   <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-58-02_739_6497337761493060098/-ext-10000</string> 
+                   <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-26_178_8445131308101140110/-ext-10000</string> 
                   </void> 
                   <void property="table"> 
                    <object idref="TableDesc0"/> 
                   </void> 
                   <void property="tmpDir"> 
-                   <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-58-02_739_6497337761493060098/-ext-10001</string> 
+                   <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-26_178_8445131308101140110/-ext-10001</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -409,10 +409,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-58-02_739_6497337761493060098/-ext-10002</string> 
+               <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-26_178_8445131308101140110/-ext-10002</string> 
               </void> 
               <void property="targetDir"> 
-               <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-58-02_739_6497337761493060098/-ext-10000</string> 
+               <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-26_178_8445131308101140110/-ext-10000</string> 
               </void> 
              </object> 
             </void> 
@@ -438,7 +438,7 @@
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
         <void property="dir"> 
-         <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-58-02_739_6497337761493060098/-ext-10002</string> 
+         <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-26_178_8445131308101140110/-ext-10002</string> 
         </void> 
         <void property="listTasks"> 
          <object idref="ArrayList0"/> 
@@ -528,11 +528,11 @@
          </void> 
          <void method="put"> 
           <string>location</string> 
-          <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket</string> 
+          <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket</string> 
          </void> 
          <void method="put"> 
           <string>transient_lastDdlTime</string> 
-          <string>1304060276</string> 
+          <string>1310382384</string> 
          </void> 
         </object> 
        </void> 
@@ -594,11 +594,11 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket</string> 
+            <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket</string> 
            </void> 
            <void method="put"> 
             <string>transient_lastDdlTime</string> 
-            <string>1304060276</string> 
+            <string>1310382384</string> 
            </void> 
           </object> 
          </void> 
@@ -622,323 +622,98 @@
             <void property="childOperators"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+               <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                    <void property="childOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                        <void property="conf"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                          <void property="destTableId"> 
-                           <int>1</int> 
-                          </void> 
-                          <void property="dirName"> 
-                           <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-58-02_739_6497337761493060098/-ext-10002</string> 
-                          </void> 
-                          <void property="gatherStats"> 
-                           <boolean>true</boolean> 
-                          </void> 
-                          <void property="numFiles"> 
-                           <int>1</int> 
-                          </void> 
-                          <void property="statsAggPrefix"> 
-                           <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-58-02_739_6497337761493060098/-ext-10000/</string> 
-                          </void> 
-                          <void property="tableInfo"> 
-                           <object idref="TableDesc0"/> 
-                          </void> 
-                          <void property="totalFiles"> 
-                           <int>1</int> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="counterNames"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_588_NUM_INPUT_ROWS</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_588_NUM_OUTPUT_ROWS</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_588_TIME_TAKEN</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_588_FATAL_ERROR</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="operatorId"> 
-                         <string>FS_588</string> 
-                        </void> 
-                        <void property="parentOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object idref="SelectOperator0"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="schema"> 
-                         <object idref="RowSchema0"/> 
-                        </void> 
-                       </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                    <void property="conf"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                      <void property="destTableId"> 
+                       <int>1</int> 
                       </void> 
-                     </object> 
-                    </void> 
-                    <void property="columnExprMap"> 
-                     <object class="java.util.HashMap"> 
-                      <void method="put"> 
-                       <string>_col1</string> 
-                       <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>value</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>s</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
+                      <void property="dirName"> 
+                       <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-26_178_8445131308101140110/-ext-10002</string> 
                       </void> 
-                      <void method="put"> 
-                       <string>_col0</string> 
-                       <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>s</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>int</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
+                      <void property="gatherStats"> 
+                       <boolean>true</boolean> 
                       </void> 
-                     </object> 
-                    </void> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                      <void property="colList"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc1"/> 
-                        </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc0"/> 
-                        </void> 
-                       </object> 
+                      <void property="numFiles"> 
+                       <int>1</int> 
                       </void> 
-                      <void property="outputColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void method="add"> 
-                         <string>_col1</string> 
-                        </void> 
-                       </object> 
+                      <void property="statsAggPrefix"> 
+                       <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-26_178_8445131308101140110/-ext-10000/</string> 
                       </void> 
-                      <void property="selectStar"> 
-                       <boolean>true</boolean> 
+                      <void property="tableInfo"> 
+                       <object idref="TableDesc0"/> 
+                      </void> 
+                      <void property="totalFiles"> 
+                       <int>1</int> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_587_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_FS_565_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_587_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_FS_565_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_587_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_FS_565_TIME_TAKEN</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_587_FATAL_ERROR</string> 
+                       <string>CNTR_NAME_FS_565_FATAL_ERROR</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>SEL_587</string> 
+                     <string>FS_565</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object idref="FilterOperator1"/> 
+                       <object idref="SelectOperator0"/> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="schema"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                      <void property="signature"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col0</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string>s</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo1"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col1</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string>s</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                     <object idref="RowSchema0"/> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-                  <void property="isSamplingPred"> 
-                   <boolean>true</boolean> 
+                <void property="columnExprMap"> 
+                 <object class="java.util.HashMap"> 
+                  <void method="put"> 
+                   <string>_col1</string> 
+                   <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>value</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string>s</string> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
                   </void> 
-                  <void property="predicate"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="childExprs"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                            <void property="childExprs"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                                <void property="childExprs"> 
-                                 <object class="java.util.ArrayList"> 
-                                  <void method="add"> 
-                                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                                    <void property="column"> 
-                                     <string>key</string> 
-                                    </void> 
-                                    <void property="tabAlias"> 
-                                     <string>s</string> 
-                                    </void> 
-                                    <void property="typeInfo"> 
-                                     <object idref="PrimitiveTypeInfo1"/> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void property="genericUDF"> 
-                                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFHash"/> 
-                                </void> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo1"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo1"/> 
-                                </void> 
-                                <void property="value"> 
-                                 <int>2147483647</int> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="genericUDF"> 
-                             <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                              <void property="operator"> 
-                               <boolean>true</boolean> 
-                              </void> 
-                              <void property="udfClass"> 
-                               <class>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</class> 
-                              </void> 
-                              <void property="udfName"> 
-                               <string>&amp;</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <int>5</int> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                          <void property="operator"> 
-                           <boolean>true</boolean> 
-                          </void> 
-                          <void property="udfClass"> 
-                           <class>org.apache.hadoop.hive.ql.udf.UDFOPMod</class> 
-                          </void> 
-                          <void property="udfName"> 
-                           <string>%</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>0</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                  <void method="put"> 
+                   <string>_col0</string> 
+                   <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>key</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual"/> 
+                    <void property="tabAlias"> 
+                     <string>s</string> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                     <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
                       <void property="typeName"> 
-                       <string>boolean</string> 
+                       <string>int</string> 
                       </void> 
                      </object> 
                     </void> 
@@ -946,24 +721,51 @@
                   </void> 
                  </object> 
                 </void> 
+                <void property="conf"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                  <void property="colList"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object idref="ExprNodeColumnDesc1"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="ExprNodeColumnDesc0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void property="outputColumnNames"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <string>_col0</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col1</string> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void property="selectStar"> 
+                   <boolean>true</boolean> 
+                  </void> 
+                 </object> 
+                </void> 
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_586_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_564_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_586_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_564_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_586_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_SEL_564_TIME_TAKEN</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_586_FATAL_ERROR</string> 
+                   <string>CNTR_NAME_SEL_564_FATAL_ERROR</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>FIL_586</string> 
+                 <string>SEL_564</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -977,9 +779,9 @@
                   <void property="signature"> 
                    <object class="java.util.ArrayList"> 
                     <void method="add"> 
-                     <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                       <void property="internalName"> 
-                       <string>key</string> 
+                       <string>_col0</string> 
                       </void> 
                       <void property="tabAlias"> 
                        <string>s</string> 
@@ -990,9 +792,9 @@
                      </object> 
                     </void> 
                     <void method="add"> 
-                     <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                       <void property="internalName"> 
-                       <string>value</string> 
+                       <string>_col1</string> 
                       </void> 
                       <void property="tabAlias"> 
                        <string>s</string> 
@@ -1012,6 +814,9 @@
             </void> 
             <void property="conf"> 
              <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
+              <void property="isSamplingPred"> 
+               <boolean>true</boolean> 
+              </void> 
               <void property="predicate"> 
                <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
                 <void property="childExprs"> 
@@ -1127,7 +932,11 @@
                  <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual"/> 
                 </void> 
                 <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo2"/> 
+                 <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                  <void property="typeName"> 
+                   <string>boolean</string> 
+                  </void> 
+                 </object> 
                 </void> 
                </object> 
               </void> 
@@ -1136,21 +945,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_589_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_563_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_589_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_563_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_589_TIME_TAKEN</string> 
+               <string>CNTR_NAME_FIL_563_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_589_FATAL_ERROR</string> 
+               <string>CNTR_NAME_FIL_563_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>FIL_589</string> 
+             <string>FIL_563</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -1162,40 +971,24 @@
             <void property="schema"> 
              <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
               <void property="signature"> 
-               <object id="ArrayList1" class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object idref="ColumnInfo0"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ColumnInfo1"/> 
-                </void> 
+               <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="hiddenVirtualCol"> 
-                   <boolean>true</boolean> 
-                  </void> 
+                 <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                   <void property="internalName"> 
-                   <string>BLOCK__OFFSET__INSIDE__FILE</string> 
+                   <string>key</string> 
                   </void> 
                   <void property="tabAlias"> 
                    <string>s</string> 
                   </void> 
                   <void property="type"> 
-                   <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                    <void property="typeName"> 
-                     <string>bigint</string> 
-                    </void> 
-                   </object> 
+                   <object idref="PrimitiveTypeInfo1"/> 
                   </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="hiddenVirtualCol"> 
-                   <boolean>true</boolean> 
-                  </void> 
+                 <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                   <void property="internalName"> 
-                   <string>INPUT__FILE__NAME</string> 
+                   <string>value</string> 
                   </void> 
                   <void property="tabAlias"> 
                    <string>s</string> 
@@ -1226,16 +1019,16 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_585_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_562_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_585_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_562_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_585_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_562_TIME_TAKEN</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_585_FATAL_ERROR</string> 
+           <string>CNTR_NAME_TS_562_FATAL_ERROR</string> 
           </void> 
          </object> 
         </void> 
@@ -1250,12 +1043,55 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_585</string> 
+         <string>TS_562</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
           <void property="signature"> 
-           <object idref="ArrayList1"/> 
+           <object class="java.util.ArrayList"> 
+            <void method="add"> 
+             <object idref="ColumnInfo0"/> 
+            </void> 
+            <void method="add"> 
+             <object idref="ColumnInfo1"/> 
+            </void> 
+            <void method="add"> 
+             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+              <void property="hiddenVirtualCol"> 
+               <boolean>true</boolean> 
+              </void> 
+              <void property="internalName"> 
+               <string>BLOCK__OFFSET__INSIDE__FILE</string> 
+              </void> 
+              <void property="tabAlias"> 
+               <string>s</string> 
+              </void> 
+              <void property="type"> 
+               <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                <void property="typeName"> 
+                 <string>bigint</string> 
+                </void> 
+               </object> 
+              </void> 
+             </object> 
+            </void> 
+            <void method="add"> 
+             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+              <void property="hiddenVirtualCol"> 
+               <boolean>true</boolean> 
+              </void> 
+              <void property="internalName"> 
+               <string>INPUT__FILE__NAME</string> 
+              </void> 
+              <void property="tabAlias"> 
+               <string>s</string> 
+              </void> 
+              <void property="type"> 
+               <object idref="PrimitiveTypeInfo0"/> 
+              </void> 
+             </object> 
+            </void> 
+           </object> 
           </void> 
          </object> 
         </void> 
@@ -1272,7 +1108,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket</string> 
+       <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>s</string> 
@@ -1284,7 +1120,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket</string> 
+       <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket</string> 
        <object class="org.apache.hadoop.hive.ql.plan.PartitionDesc"> 
         <void property="baseFileName"> 
          <string>srcbucket</string> 
@@ -1345,11 +1181,11 @@
           </void> 
           <void method="put"> 
            <string>location</string> 
-           <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket</string> 
+           <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket</string> 
           </void> 
           <void method="put"> 
            <string>transient_lastDdlTime</string> 
-           <string>1304060276</string> 
+           <string>1310382384</string> 
           </void> 
          </object> 
         </void> 
@@ -1411,11 +1247,11 @@
             </void> 
             <void method="put"> 
              <string>location</string> 
-             <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket</string> 
+             <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket</string> 
             </void> 
             <void method="put"> 
              <string>transient_lastDdlTime</string> 
-             <string>1304060276</string> 
+             <string>1310382384</string> 
             </void> 
            </object> 
           </void> 
diff --git a/ql/src/test/results/compiler/plan/sample6.q.xml b/ql/src/test/results/compiler/plan/sample6.q.xml
index 3be59c5149..d217778723 100644
--- a/ql/src/test/results/compiler/plan/sample6.q.xml
+++ b/ql/src/test/results/compiler/plan/sample6.q.xml
@@ -1,5 +1,5 @@
 <?xml version="1.0" encoding="UTF-8"?> 
-<java version="1.6.0_07" class="java.beans.XMLDecoder"> 
+<java version="1.6.0_01" class="java.beans.XMLDecoder"> 
  <object id="MapRedTask0" class="org.apache.hadoop.hive.ql.exec.MapRedTask"> 
   <void property="childTasks"> 
    <object class="java.util.ArrayList"> 
@@ -33,7 +33,7 @@
                   <void property="work"> 
                    <object class="org.apache.hadoop.hive.ql.plan.StatsWork"> 
                     <void property="aggKey"> 
-                     <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-58-12_841_9078625175194764446/-ext-10000/</string> 
+                     <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-29_716_3544047158874325131/-ext-10000/</string> 
                     </void> 
                    </object> 
                   </void> 
@@ -73,7 +73,7 @@
                     <void property="aliasToWork"> 
                      <object class="java.util.LinkedHashMap"> 
                       <void method="put"> 
-                       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-58-12_841_9078625175194764446/-ext-10002</string> 
+                       <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-29_716_3544047158874325131/-ext-10002</string> 
                        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                         <void property="childOperators"> 
                          <object class="java.util.ArrayList"> 
@@ -82,7 +82,7 @@
                             <void property="conf"> 
                              <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
                               <void property="dirName"> 
-                               <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-58-12_841_9078625175194764446/-ext-10000</string> 
+                               <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-29_716_3544047158874325131/-ext-10000</string> 
                               </void> 
                               <void property="numFiles"> 
                                <int>1</int> 
@@ -134,7 +134,7 @@
                                   </void> 
                                   <void method="put"> 
                                    <string>location</string> 
-                                   <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/dest1</string> 
+                                   <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/dest1</string> 
                                   </void> 
                                   <void method="put"> 
                                    <string>file.outputformat</string> 
@@ -142,7 +142,7 @@
                                   </void> 
                                   <void method="put"> 
                                    <string>transient_lastDdlTime</string> 
-                                   <string>1304060292</string> 
+                                   <string>1310382389</string> 
                                   </void> 
                                  </object> 
                                 </void> 
@@ -159,21 +159,21 @@
                             <void property="counterNames"> 
                              <object class="java.util.ArrayList"> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_605_NUM_INPUT_ROWS</string> 
+                               <string>CNTR_NAME_FS_579_NUM_INPUT_ROWS</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_605_NUM_OUTPUT_ROWS</string> 
+                               <string>CNTR_NAME_FS_579_NUM_OUTPUT_ROWS</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_605_TIME_TAKEN</string> 
+                               <string>CNTR_NAME_FS_579_TIME_TAKEN</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_605_FATAL_ERROR</string> 
+                               <string>CNTR_NAME_FS_579_FATAL_ERROR</string> 
                               </void> 
                              </object> 
                             </void> 
                             <void property="operatorId"> 
-                             <string>FS_605</string> 
+                             <string>FS_579</string> 
                             </void> 
                             <void property="parentOperators"> 
                              <object class="java.util.ArrayList"> 
@@ -227,21 +227,21 @@
                         <void property="counterNames"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_604_NUM_INPUT_ROWS</string> 
+                           <string>CNTR_NAME_TS_578_NUM_INPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_604_NUM_OUTPUT_ROWS</string> 
+                           <string>CNTR_NAME_TS_578_NUM_OUTPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_604_TIME_TAKEN</string> 
+                           <string>CNTR_NAME_TS_578_TIME_TAKEN</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_604_FATAL_ERROR</string> 
+                           <string>CNTR_NAME_TS_578_FATAL_ERROR</string> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="operatorId"> 
-                         <string>TS_604</string> 
+                         <string>TS_578</string> 
                         </void> 
                         <void property="schema"> 
                          <object idref="RowSchema0"/> 
@@ -262,10 +262,10 @@
                     <void property="pathToAliases"> 
                      <object class="java.util.LinkedHashMap"> 
                       <void method="put"> 
-                       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-58-12_841_9078625175194764446/-ext-10002</string> 
+                       <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-29_716_3544047158874325131/-ext-10002</string> 
                        <object class="java.util.ArrayList"> 
                         <void method="add"> 
-                         <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-58-12_841_9078625175194764446/-ext-10002</string> 
+                         <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-29_716_3544047158874325131/-ext-10002</string> 
                         </void> 
                        </object> 
                       </void> 
@@ -274,7 +274,7 @@
                     <void property="pathToPartitionInfo"> 
                      <object class="java.util.LinkedHashMap"> 
                       <void method="put"> 
-                       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-58-12_841_9078625175194764446/-ext-10002</string> 
+                       <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-29_716_3544047158874325131/-ext-10002</string> 
                        <object class="org.apache.hadoop.hive.ql.plan.PartitionDesc"> 
                         <void property="baseFileName"> 
                          <string>-ext-10002</string> 
@@ -328,11 +328,11 @@
                           </void> 
                           <void method="put"> 
                            <string>location</string> 
-                           <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/dest1</string> 
+                           <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/dest1</string> 
                           </void> 
                           <void method="put"> 
                            <string>transient_lastDdlTime</string> 
-                           <string>1304060292</string> 
+                           <string>1310382389</string> 
                           </void> 
                          </object> 
                         </void> 
@@ -382,13 +382,13 @@
                    <boolean>true</boolean> 
                   </void> 
                   <void property="sourceDir"> 
-                   <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-58-12_841_9078625175194764446/-ext-10000</string> 
+                   <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-29_716_3544047158874325131/-ext-10000</string> 
                   </void> 
                   <void property="table"> 
                    <object idref="TableDesc0"/> 
                   </void> 
                   <void property="tmpDir"> 
-                   <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-58-12_841_9078625175194764446/-ext-10001</string> 
+                   <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-29_716_3544047158874325131/-ext-10001</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -409,10 +409,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-58-12_841_9078625175194764446/-ext-10002</string> 
+               <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-29_716_3544047158874325131/-ext-10002</string> 
               </void> 
               <void property="targetDir"> 
-               <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-58-12_841_9078625175194764446/-ext-10000</string> 
+               <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-29_716_3544047158874325131/-ext-10000</string> 
               </void> 
              </object> 
             </void> 
@@ -438,7 +438,7 @@
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
         <void property="dir"> 
-         <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-58-12_841_9078625175194764446/-ext-10002</string> 
+         <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-29_716_3544047158874325131/-ext-10002</string> 
         </void> 
         <void property="listTasks"> 
          <object idref="ArrayList0"/> 
@@ -528,11 +528,11 @@
          </void> 
          <void method="put"> 
           <string>location</string> 
-          <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket</string> 
+          <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket</string> 
          </void> 
          <void method="put"> 
           <string>transient_lastDdlTime</string> 
-          <string>1304060287</string> 
+          <string>1310382387</string> 
          </void> 
         </object> 
        </void> 
@@ -594,11 +594,11 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket</string> 
+            <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket</string> 
            </void> 
            <void method="put"> 
             <string>transient_lastDdlTime</string> 
-            <string>1304060287</string> 
+            <string>1310382387</string> 
            </void> 
           </object> 
          </void> 
@@ -622,351 +622,150 @@
             <void property="childOperators"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+               <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                    <void property="childOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                        <void property="conf"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                          <void property="destTableId"> 
-                           <int>1</int> 
-                          </void> 
-                          <void property="dirName"> 
-                           <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-58-12_841_9078625175194764446/-ext-10002</string> 
-                          </void> 
-                          <void property="gatherStats"> 
-                           <boolean>true</boolean> 
-                          </void> 
-                          <void property="numFiles"> 
-                           <int>1</int> 
-                          </void> 
-                          <void property="statsAggPrefix"> 
-                           <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-58-12_841_9078625175194764446/-ext-10000/</string> 
-                          </void> 
-                          <void property="tableInfo"> 
-                           <object idref="TableDesc0"/> 
-                          </void> 
-                          <void property="totalFiles"> 
-                           <int>1</int> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="counterNames"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_602_NUM_INPUT_ROWS</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_602_NUM_OUTPUT_ROWS</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_602_TIME_TAKEN</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_602_FATAL_ERROR</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="operatorId"> 
-                         <string>FS_602</string> 
-                        </void> 
-                        <void property="parentOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object idref="SelectOperator0"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="schema"> 
-                         <object idref="RowSchema0"/> 
-                        </void> 
-                       </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                    <void property="conf"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                      <void property="destTableId"> 
+                       <int>1</int> 
                       </void> 
-                     </object> 
-                    </void> 
-                    <void property="columnExprMap"> 
-                     <object class="java.util.HashMap"> 
-                      <void method="put"> 
-                       <string>_col1</string> 
-                       <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>value</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>s</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
+                      <void property="dirName"> 
+                       <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-29_716_3544047158874325131/-ext-10002</string> 
                       </void> 
-                      <void method="put"> 
-                       <string>_col0</string> 
-                       <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>s</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>int</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
+                      <void property="gatherStats"> 
+                       <boolean>true</boolean> 
                       </void> 
-                     </object> 
-                    </void> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                      <void property="colList"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc1"/> 
-                        </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc0"/> 
-                        </void> 
-                       </object> 
+                      <void property="numFiles"> 
+                       <int>1</int> 
                       </void> 
-                      <void property="outputColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void method="add"> 
-                         <string>_col1</string> 
-                        </void> 
-                       </object> 
+                      <void property="statsAggPrefix"> 
+                       <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-29_716_3544047158874325131/-ext-10000/</string> 
                       </void> 
-                      <void property="selectStar"> 
-                       <boolean>true</boolean> 
+                      <void property="tableInfo"> 
+                       <object idref="TableDesc0"/> 
+                      </void> 
+                      <void property="totalFiles"> 
+                       <int>1</int> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_601_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_FS_577_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_601_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_FS_577_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_601_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_FS_577_TIME_TAKEN</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_601_FATAL_ERROR</string> 
+                       <string>CNTR_NAME_FS_577_FATAL_ERROR</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>SEL_601</string> 
+                     <string>FS_577</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object idref="FilterOperator1"/> 
+                       <object idref="SelectOperator0"/> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="schema"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                      <void property="signature"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col0</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string>s</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo1"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col1</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string>s</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                     <object idref="RowSchema0"/> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-                  <void property="isSamplingPred"> 
-                   <boolean>true</boolean> 
+                <void property="columnExprMap"> 
+                 <object class="java.util.HashMap"> 
+                  <void method="put"> 
+                   <string>_col1</string> 
+                   <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>value</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string>s</string> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
                   </void> 
-                  <void property="predicate"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="childExprs"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                            <void property="childExprs"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                                <void property="childExprs"> 
-                                 <object class="java.util.ArrayList"> 
-                                  <void method="add"> 
-                                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                                    <void property="column"> 
-                                     <string>key</string> 
-                                    </void> 
-                                    <void property="tabAlias"> 
-                                     <string>s</string> 
-                                    </void> 
-                                    <void property="typeInfo"> 
-                                     <object idref="PrimitiveTypeInfo1"/> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void property="genericUDF"> 
-                                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFHash"/> 
-                                </void> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo1"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo1"/> 
-                                </void> 
-                                <void property="value"> 
-                                 <int>2147483647</int> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="genericUDF"> 
-                             <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                              <void property="operator"> 
-                               <boolean>true</boolean> 
-                              </void> 
-                              <void property="udfClass"> 
-                               <class>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</class> 
-                              </void> 
-                              <void property="udfName"> 
-                               <string>&amp;</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <int>4</int> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                          <void property="operator"> 
-                           <boolean>true</boolean> 
-                          </void> 
-                          <void property="udfClass"> 
-                           <class>org.apache.hadoop.hive.ql.udf.UDFOPMod</class> 
-                          </void> 
-                          <void property="udfName"> 
-                           <string>%</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>0</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                  <void method="put"> 
+                   <string>_col0</string> 
+                   <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>key</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual"/> 
+                    <void property="tabAlias"> 
+                     <string>s</string> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                     <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
                       <void property="typeName"> 
-                       <string>boolean</string> 
+                       <string>int</string> 
                       </void> 
                      </object> 
                     </void> 
                    </object> 
                   </void> 
-                  <void property="sampleDescr"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.FilterDesc$sampleDesc"/> 
+                 </object> 
+                </void> 
+                <void property="conf"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                  <void property="colList"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object idref="ExprNodeColumnDesc1"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="ExprNodeColumnDesc0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void property="outputColumnNames"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <string>_col0</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col1</string> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void property="selectStar"> 
+                   <boolean>true</boolean> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_600_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_576_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_600_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_576_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_600_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_SEL_576_TIME_TAKEN</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_600_FATAL_ERROR</string> 
+                   <string>CNTR_NAME_SEL_576_FATAL_ERROR</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>FIL_600</string> 
+                 <string>SEL_576</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -980,9 +779,9 @@
                   <void property="signature"> 
                    <object class="java.util.ArrayList"> 
                     <void method="add"> 
-                     <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                       <void property="internalName"> 
-                       <string>key</string> 
+                       <string>_col0</string> 
                       </void> 
                       <void property="tabAlias"> 
                        <string>s</string> 
@@ -993,9 +792,9 @@
                      </object> 
                     </void> 
                     <void method="add"> 
-                     <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                       <void property="internalName"> 
-                       <string>value</string> 
+                       <string>_col1</string> 
                       </void> 
                       <void property="tabAlias"> 
                        <string>s</string> 
@@ -1015,6 +814,9 @@
             </void> 
             <void property="conf"> 
              <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
+              <void property="isSamplingPred"> 
+               <boolean>true</boolean> 
+              </void> 
               <void property="predicate"> 
                <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
                 <void property="childExprs"> 
@@ -1130,30 +932,37 @@
                  <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual"/> 
                 </void> 
                 <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo2"/> 
+                 <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                  <void property="typeName"> 
+                   <string>boolean</string> 
+                  </void> 
+                 </object> 
                 </void> 
                </object> 
               </void> 
+              <void property="sampleDescr"> 
+               <object class="org.apache.hadoop.hive.ql.plan.FilterDesc$sampleDesc"/> 
+              </void> 
              </object> 
             </void> 
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_603_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_575_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_603_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_575_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_603_TIME_TAKEN</string> 
+               <string>CNTR_NAME_FIL_575_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_603_FATAL_ERROR</string> 
+               <string>CNTR_NAME_FIL_575_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>FIL_603</string> 
+             <string>FIL_575</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -1165,40 +974,24 @@
             <void property="schema"> 
              <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
               <void property="signature"> 
-               <object id="ArrayList1" class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object idref="ColumnInfo0"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ColumnInfo1"/> 
-                </void> 
+               <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="hiddenVirtualCol"> 
-                   <boolean>true</boolean> 
-                  </void> 
+                 <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                   <void property="internalName"> 
-                   <string>BLOCK__OFFSET__INSIDE__FILE</string> 
+                   <string>key</string> 
                   </void> 
                   <void property="tabAlias"> 
                    <string>s</string> 
                   </void> 
                   <void property="type"> 
-                   <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                    <void property="typeName"> 
-                     <string>bigint</string> 
-                    </void> 
-                   </object> 
+                   <object idref="PrimitiveTypeInfo1"/> 
                   </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="hiddenVirtualCol"> 
-                   <boolean>true</boolean> 
-                  </void> 
+                 <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                   <void property="internalName"> 
-                   <string>INPUT__FILE__NAME</string> 
+                   <string>value</string> 
                   </void> 
                   <void property="tabAlias"> 
                    <string>s</string> 
@@ -1229,16 +1022,16 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_599_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_574_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_599_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_574_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_599_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_574_TIME_TAKEN</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_599_FATAL_ERROR</string> 
+           <string>CNTR_NAME_TS_574_FATAL_ERROR</string> 
           </void> 
          </object> 
         </void> 
@@ -1253,12 +1046,55 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_599</string> 
+         <string>TS_574</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
           <void property="signature"> 
-           <object idref="ArrayList1"/> 
+           <object class="java.util.ArrayList"> 
+            <void method="add"> 
+             <object idref="ColumnInfo0"/> 
+            </void> 
+            <void method="add"> 
+             <object idref="ColumnInfo1"/> 
+            </void> 
+            <void method="add"> 
+             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+              <void property="hiddenVirtualCol"> 
+               <boolean>true</boolean> 
+              </void> 
+              <void property="internalName"> 
+               <string>BLOCK__OFFSET__INSIDE__FILE</string> 
+              </void> 
+              <void property="tabAlias"> 
+               <string>s</string> 
+              </void> 
+              <void property="type"> 
+               <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                <void property="typeName"> 
+                 <string>bigint</string> 
+                </void> 
+               </object> 
+              </void> 
+             </object> 
+            </void> 
+            <void method="add"> 
+             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+              <void property="hiddenVirtualCol"> 
+               <boolean>true</boolean> 
+              </void> 
+              <void property="internalName"> 
+               <string>INPUT__FILE__NAME</string> 
+              </void> 
+              <void property="tabAlias"> 
+               <string>s</string> 
+              </void> 
+              <void property="type"> 
+               <object idref="PrimitiveTypeInfo0"/> 
+              </void> 
+             </object> 
+            </void> 
+           </object> 
           </void> 
          </object> 
         </void> 
@@ -1275,7 +1111,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt</string> 
+       <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>s</string> 
@@ -1287,10 +1123,10 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt</string> 
+       <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket</string> 
        <object class="org.apache.hadoop.hive.ql.plan.PartitionDesc"> 
         <void property="baseFileName"> 
-         <string>srcbucket0.txt</string> 
+         <string>srcbucket</string> 
         </void> 
         <void property="deserializerClass"> 
          <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
@@ -1348,11 +1184,11 @@
           </void> 
           <void method="put"> 
            <string>location</string> 
-           <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket</string> 
+           <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket</string> 
           </void> 
           <void method="put"> 
            <string>transient_lastDdlTime</string> 
-           <string>1304060287</string> 
+           <string>1310382387</string> 
           </void> 
          </object> 
         </void> 
@@ -1414,11 +1250,11 @@
             </void> 
             <void method="put"> 
              <string>location</string> 
-             <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket</string> 
+             <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket</string> 
             </void> 
             <void method="put"> 
              <string>transient_lastDdlTime</string> 
-             <string>1304060287</string> 
+             <string>1310382387</string> 
             </void> 
            </object> 
           </void> 
diff --git a/ql/src/test/results/compiler/plan/sample7.q.xml b/ql/src/test/results/compiler/plan/sample7.q.xml
index 07cbca04af..b3fa3911a3 100644
--- a/ql/src/test/results/compiler/plan/sample7.q.xml
+++ b/ql/src/test/results/compiler/plan/sample7.q.xml
@@ -1,5 +1,5 @@
 <?xml version="1.0" encoding="UTF-8"?> 
-<java version="1.6.0_07" class="java.beans.XMLDecoder"> 
+<java version="1.6.0_01" class="java.beans.XMLDecoder"> 
  <object id="MapRedTask0" class="org.apache.hadoop.hive.ql.exec.MapRedTask"> 
   <void property="childTasks"> 
    <object class="java.util.ArrayList"> 
@@ -33,7 +33,7 @@
                   <void property="work"> 
                    <object class="org.apache.hadoop.hive.ql.plan.StatsWork"> 
                     <void property="aggKey"> 
-                     <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-58-22_925_1445560214059395005/-ext-10000/</string> 
+                     <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-33_170_7666241259022167376/-ext-10000/</string> 
                     </void> 
                    </object> 
                   </void> 
@@ -73,7 +73,7 @@
                     <void property="aliasToWork"> 
                      <object class="java.util.LinkedHashMap"> 
                       <void method="put"> 
-                       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-58-22_925_1445560214059395005/-ext-10002</string> 
+                       <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-33_170_7666241259022167376/-ext-10002</string> 
                        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                         <void property="childOperators"> 
                          <object class="java.util.ArrayList"> 
@@ -82,7 +82,7 @@
                             <void property="conf"> 
                              <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
                               <void property="dirName"> 
-                               <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-58-22_925_1445560214059395005/-ext-10000</string> 
+                               <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-33_170_7666241259022167376/-ext-10000</string> 
                               </void> 
                               <void property="numFiles"> 
                                <int>1</int> 
@@ -134,7 +134,7 @@
                                   </void> 
                                   <void method="put"> 
                                    <string>location</string> 
-                                   <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/dest1</string> 
+                                   <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/dest1</string> 
                                   </void> 
                                   <void method="put"> 
                                    <string>file.outputformat</string> 
@@ -142,7 +142,7 @@
                                   </void> 
                                   <void method="put"> 
                                    <string>transient_lastDdlTime</string> 
-                                   <string>1304060302</string> 
+                                   <string>1310382393</string> 
                                   </void> 
                                  </object> 
                                 </void> 
@@ -159,21 +159,21 @@
                             <void property="counterNames"> 
                              <object class="java.util.ArrayList"> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_620_NUM_INPUT_ROWS</string> 
+                               <string>CNTR_NAME_FS_593_NUM_INPUT_ROWS</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_620_NUM_OUTPUT_ROWS</string> 
+                               <string>CNTR_NAME_FS_593_NUM_OUTPUT_ROWS</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_620_TIME_TAKEN</string> 
+                               <string>CNTR_NAME_FS_593_TIME_TAKEN</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_620_FATAL_ERROR</string> 
+                               <string>CNTR_NAME_FS_593_FATAL_ERROR</string> 
                               </void> 
                              </object> 
                             </void> 
                             <void property="operatorId"> 
-                             <string>FS_620</string> 
+                             <string>FS_593</string> 
                             </void> 
                             <void property="parentOperators"> 
                              <object class="java.util.ArrayList"> 
@@ -227,21 +227,21 @@
                         <void property="counterNames"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_619_NUM_INPUT_ROWS</string> 
+                           <string>CNTR_NAME_TS_592_NUM_INPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_619_NUM_OUTPUT_ROWS</string> 
+                           <string>CNTR_NAME_TS_592_NUM_OUTPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_619_TIME_TAKEN</string> 
+                           <string>CNTR_NAME_TS_592_TIME_TAKEN</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_619_FATAL_ERROR</string> 
+                           <string>CNTR_NAME_TS_592_FATAL_ERROR</string> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="operatorId"> 
-                         <string>TS_619</string> 
+                         <string>TS_592</string> 
                         </void> 
                         <void property="schema"> 
                          <object idref="RowSchema0"/> 
@@ -262,10 +262,10 @@
                     <void property="pathToAliases"> 
                      <object class="java.util.LinkedHashMap"> 
                       <void method="put"> 
-                       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-58-22_925_1445560214059395005/-ext-10002</string> 
+                       <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-33_170_7666241259022167376/-ext-10002</string> 
                        <object class="java.util.ArrayList"> 
                         <void method="add"> 
-                         <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-58-22_925_1445560214059395005/-ext-10002</string> 
+                         <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-33_170_7666241259022167376/-ext-10002</string> 
                         </void> 
                        </object> 
                       </void> 
@@ -274,7 +274,7 @@
                     <void property="pathToPartitionInfo"> 
                      <object class="java.util.LinkedHashMap"> 
                       <void method="put"> 
-                       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-58-22_925_1445560214059395005/-ext-10002</string> 
+                       <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-33_170_7666241259022167376/-ext-10002</string> 
                        <object class="org.apache.hadoop.hive.ql.plan.PartitionDesc"> 
                         <void property="baseFileName"> 
                          <string>-ext-10002</string> 
@@ -328,11 +328,11 @@
                           </void> 
                           <void method="put"> 
                            <string>location</string> 
-                           <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/dest1</string> 
+                           <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/dest1</string> 
                           </void> 
                           <void method="put"> 
                            <string>transient_lastDdlTime</string> 
-                           <string>1304060302</string> 
+                           <string>1310382393</string> 
                           </void> 
                          </object> 
                         </void> 
@@ -382,13 +382,13 @@
                    <boolean>true</boolean> 
                   </void> 
                   <void property="sourceDir"> 
-                   <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-58-22_925_1445560214059395005/-ext-10000</string> 
+                   <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-33_170_7666241259022167376/-ext-10000</string> 
                   </void> 
                   <void property="table"> 
                    <object idref="TableDesc0"/> 
                   </void> 
                   <void property="tmpDir"> 
-                   <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-58-22_925_1445560214059395005/-ext-10001</string> 
+                   <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-33_170_7666241259022167376/-ext-10001</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -409,10 +409,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-58-22_925_1445560214059395005/-ext-10002</string> 
+               <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-33_170_7666241259022167376/-ext-10002</string> 
               </void> 
               <void property="targetDir"> 
-               <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-58-22_925_1445560214059395005/-ext-10000</string> 
+               <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-33_170_7666241259022167376/-ext-10000</string> 
               </void> 
              </object> 
             </void> 
@@ -438,7 +438,7 @@
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
         <void property="dir"> 
-         <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-58-22_925_1445560214059395005/-ext-10002</string> 
+         <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-33_170_7666241259022167376/-ext-10002</string> 
         </void> 
         <void property="listTasks"> 
          <object idref="ArrayList0"/> 
@@ -528,11 +528,11 @@
          </void> 
          <void method="put"> 
           <string>location</string> 
-          <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket</string> 
+          <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket</string> 
          </void> 
          <void method="put"> 
           <string>transient_lastDdlTime</string> 
-          <string>1304060297</string> 
+          <string>1310382391</string> 
          </void> 
         </object> 
        </void> 
@@ -594,11 +594,11 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket</string> 
+            <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket</string> 
            </void> 
            <void method="put"> 
             <string>transient_lastDdlTime</string> 
-            <string>1304060297</string> 
+            <string>1310382391</string> 
            </void> 
           </object> 
          </void> 
@@ -626,238 +626,98 @@
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object id="FilterOperator2" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+                   <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
                     <void property="childOperators"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                        <void property="childOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                            <void property="conf"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                              <void property="destTableId"> 
-                               <int>1</int> 
-                              </void> 
-                              <void property="dirName"> 
-                               <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-58-22_925_1445560214059395005/-ext-10002</string> 
-                              </void> 
-                              <void property="gatherStats"> 
-                               <boolean>true</boolean> 
-                              </void> 
-                              <void property="numFiles"> 
-                               <int>1</int> 
-                              </void> 
-                              <void property="statsAggPrefix"> 
-                               <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-58-22_925_1445560214059395005/-ext-10000/</string> 
-                              </void> 
-                              <void property="tableInfo"> 
-                               <object idref="TableDesc0"/> 
-                              </void> 
-                              <void property="totalFiles"> 
-                               <int>1</int> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="counterNames"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <string>CNTR_NAME_FS_617_NUM_INPUT_ROWS</string> 
-                              </void> 
-                              <void method="add"> 
-                               <string>CNTR_NAME_FS_617_NUM_OUTPUT_ROWS</string> 
-                              </void> 
-                              <void method="add"> 
-                               <string>CNTR_NAME_FS_617_TIME_TAKEN</string> 
-                              </void> 
-                              <void method="add"> 
-                               <string>CNTR_NAME_FS_617_FATAL_ERROR</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="operatorId"> 
-                             <string>FS_617</string> 
-                            </void> 
-                            <void property="parentOperators"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object idref="SelectOperator0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="schema"> 
-                             <object idref="RowSchema0"/> 
-                            </void> 
-                           </object> 
+                       <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                        <void property="conf"> 
+                         <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                          <void property="destTableId"> 
+                           <int>1</int> 
                           </void> 
-                         </object> 
-                        </void> 
-                        <void property="columnExprMap"> 
-                         <object class="java.util.HashMap"> 
-                          <void method="put"> 
-                           <string>_col1</string> 
-                           <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>value</string> 
-                            </void> 
-                            <void property="tabAlias"> 
-                             <string>s</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
+                          <void property="dirName"> 
+                           <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-33_170_7666241259022167376/-ext-10002</string> 
                           </void> 
-                          <void method="put"> 
-                           <string>_col0</string> 
-                           <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>key</string> 
-                            </void> 
-                            <void property="tabAlias"> 
-                             <string>s</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                              <void property="typeName"> 
-                               <string>int</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
+                          <void property="gatherStats"> 
+                           <boolean>true</boolean> 
                           </void> 
-                         </object> 
-                        </void> 
-                        <void property="conf"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                          <void property="colList"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object idref="ExprNodeColumnDesc1"/> 
-                            </void> 
-                            <void method="add"> 
-                             <object idref="ExprNodeColumnDesc0"/> 
-                            </void> 
-                           </object> 
+                          <void property="numFiles"> 
+                           <int>1</int> 
                           </void> 
-                          <void property="outputColumnNames"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <string>_col0</string> 
-                            </void> 
-                            <void method="add"> 
-                             <string>_col1</string> 
-                            </void> 
-                           </object> 
+                          <void property="statsAggPrefix"> 
+                           <string>pfile:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-33_170_7666241259022167376/-ext-10000/</string> 
                           </void> 
-                          <void property="selectStar"> 
-                           <boolean>true</boolean> 
+                          <void property="tableInfo"> 
+                           <object idref="TableDesc0"/> 
+                          </void> 
+                          <void property="totalFiles"> 
+                           <int>1</int> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="counterNames"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <string>CNTR_NAME_SEL_616_NUM_INPUT_ROWS</string> 
+                           <string>CNTR_NAME_FS_590_NUM_INPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_SEL_616_NUM_OUTPUT_ROWS</string> 
+                           <string>CNTR_NAME_FS_590_NUM_OUTPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_SEL_616_TIME_TAKEN</string> 
+                           <string>CNTR_NAME_FS_590_TIME_TAKEN</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_SEL_616_FATAL_ERROR</string> 
+                           <string>CNTR_NAME_FS_590_FATAL_ERROR</string> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="operatorId"> 
-                         <string>SEL_616</string> 
+                         <string>FS_590</string> 
                         </void> 
                         <void property="parentOperators"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <object idref="FilterOperator2"/> 
+                           <object idref="SelectOperator0"/> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="schema"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                          <void property="signature"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>_col0</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string>s</string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo1"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>_col1</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string>s</string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
+                         <object idref="RowSchema0"/> 
                         </void> 
                        </object> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-                      <void property="predicate"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>key</string> 
-                            </void> 
-                            <void property="tabAlias"> 
-                             <string>s</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <int>100</int> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
+                    <void property="columnExprMap"> 
+                     <object class="java.util.HashMap"> 
+                      <void method="put"> 
+                       <string>_col1</string> 
+                       <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                        <void property="column"> 
+                         <string>value</string> 
                         </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan"/> 
+                        <void property="tabAlias"> 
+                         <string>s</string> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                         <object idref="PrimitiveTypeInfo0"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void method="put"> 
+                       <string>_col0</string> 
+                       <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                        <void property="column"> 
+                         <string>key</string> 
+                        </void> 
+                        <void property="tabAlias"> 
+                         <string>s</string> 
+                        </void> 
+                        <void property="typeInfo"> 
+                         <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
                           <void property="typeName"> 
-                           <string>boolean</string> 
+                           <string>int</string> 
                           </void> 
                          </object> 
                         </void> 
@@ -865,24 +725,51 @@
                       </void> 
                      </object> 
                     </void> 
+                    <void property="conf"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                      <void property="colList"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <object idref="ExprNodeColumnDesc1"/> 
+                        </void> 
+                        <void method="add"> 
+                         <object idref="ExprNodeColumnDesc0"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="outputColumnNames"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <string>_col0</string> 
+                        </void> 
+                        <void method="add"> 
+                         <string>_col1</string> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="selectStar"> 
+                       <boolean>true</boolean> 
+                      </void> 
+                     </object> 
+                    </void> 
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_FIL_615_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_SEL_589_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_FIL_615_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_SEL_589_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_FIL_615_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_SEL_589_TIME_TAKEN</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_FIL_615_FATAL_ERROR</string> 
+                       <string>CNTR_NAME_SEL_589_FATAL_ERROR</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>FIL_615</string> 
+                     <string>SEL_589</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
@@ -896,9 +783,9 @@
                       <void property="signature"> 
                        <object class="java.util.ArrayList"> 
                         <void method="add"> 
-                         <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                           <void property="internalName"> 
-                           <string>key</string> 
+                           <string>_col0</string> 
                           </void> 
                           <void property="tabAlias"> 
                            <string>s</string> 
@@ -909,9 +796,9 @@
                          </object> 
                         </void> 
                         <void method="add"> 
-                         <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                           <void property="internalName"> 
-                           <string>value</string> 
+                           <string>_col1</string> 
                           </void> 
                           <void property="tabAlias"> 
                            <string>s</string> 
@@ -1049,7 +936,11 @@
                      <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual"/> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                     <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                      <void property="typeName"> 
+                       <string>boolean</string> 
+                      </void> 
+                     </object> 
                     </void> 
                    </object> 
                   </void> 
@@ -1061,21 +952,21 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_614_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_FIL_587_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_614_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_FIL_587_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_614_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_FIL_587_TIME_TAKEN</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_614_FATAL_ERROR</string> 
+                   <string>CNTR_NAME_FIL_587_FATAL_ERROR</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>FIL_614</string> 
+                 <string>FIL_587</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -1089,10 +980,30 @@
                   <void property="signature"> 
                    <object class="java.util.ArrayList"> 
                     <void method="add"> 
-                     <object idref="ColumnInfo0"/> 
+                     <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="internalName"> 
+                       <string>key</string> 
+                      </void> 
+                      <void property="tabAlias"> 
+                       <string>s</string> 
+                      </void> 
+                      <void property="type"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
+                      </void> 
+                     </object> 
                     </void> 
                     <void method="add"> 
-                     <object idref="ColumnInfo1"/> 
+                     <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="internalName"> 
+                       <string>value</string> 
+                      </void> 
+                      <void property="tabAlias"> 
+                       <string>s</string> 
+                      </void> 
+                      <void property="type"> 
+                       <object idref="PrimitiveTypeInfo0"/> 
+                      </void> 
+                     </object> 
                     </void> 
                    </object> 
                   </void> 
@@ -1109,165 +1020,32 @@
                 <void property="childExprs"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="childExprs"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                            <void property="childExprs"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                                <void property="childExprs"> 
-                                 <object class="java.util.ArrayList"> 
-                                  <void method="add"> 
-                                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                                    <void property="column"> 
-                                     <string>key</string> 
-                                    </void> 
-                                    <void property="tabAlias"> 
-                                     <string>s</string> 
-                                    </void> 
-                                    <void property="typeInfo"> 
-                                     <object idref="PrimitiveTypeInfo1"/> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void property="genericUDF"> 
-                                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFHash"/> 
-                                </void> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo1"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo1"/> 
-                                </void> 
-                                <void property="value"> 
-                                 <int>2147483647</int> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="genericUDF"> 
-                             <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                              <void property="operator"> 
-                               <boolean>true</boolean> 
-                              </void> 
-                              <void property="udfClass"> 
-                               <class>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</class> 
-                              </void> 
-                              <void property="udfName"> 
-                               <string>&amp;</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <int>4</int> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                          <void property="operator"> 
-                           <boolean>true</boolean> 
-                          </void> 
-                          <void property="udfClass"> 
-                           <class>org.apache.hadoop.hive.ql.udf.UDFOPMod</class> 
-                          </void> 
-                          <void property="udfName"> 
-                           <string>%</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>0</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>key</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual"/> 
+                    <void property="tabAlias"> 
+                     <string>s</string> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                     <object idref="PrimitiveTypeInfo1"/> 
                     </void> 
                    </object> 
                   </void> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="childExprs"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>s</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>100</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan"/> 
-                    </void> 
+                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                     <object idref="PrimitiveTypeInfo1"/> 
+                    </void> 
+                    <void property="value"> 
+                     <int>100</int> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd"/> 
+                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan"/> 
                 </void> 
                 <void property="typeInfo"> 
                  <object idref="PrimitiveTypeInfo2"/> 
@@ -1279,21 +1057,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_618_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_591_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_618_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_591_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_618_TIME_TAKEN</string> 
+               <string>CNTR_NAME_FIL_591_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_618_FATAL_ERROR</string> 
+               <string>CNTR_NAME_FIL_591_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>FIL_618</string> 
+             <string>FIL_591</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -1369,16 +1147,16 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_613_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_586_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_613_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_586_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_613_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_586_TIME_TAKEN</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_613_FATAL_ERROR</string> 
+           <string>CNTR_NAME_TS_586_FATAL_ERROR</string> 
           </void> 
          </object> 
         </void> 
@@ -1393,7 +1171,7 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_613</string> 
+         <string>TS_586</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -1415,7 +1193,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt</string> 
+       <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>s</string> 
@@ -1427,7 +1205,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt</string> 
+       <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt</string> 
        <object class="org.apache.hadoop.hive.ql.plan.PartitionDesc"> 
         <void property="baseFileName"> 
          <string>srcbucket0.txt</string> 
@@ -1488,11 +1266,11 @@
           </void> 
           <void method="put"> 
            <string>location</string> 
-           <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket</string> 
+           <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket</string> 
           </void> 
           <void method="put"> 
            <string>transient_lastDdlTime</string> 
-           <string>1304060297</string> 
+           <string>1310382391</string> 
           </void> 
          </object> 
         </void> 
@@ -1554,11 +1332,11 @@
             </void> 
             <void method="put"> 
              <string>location</string> 
-             <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/srcbucket</string> 
+             <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/srcbucket</string> 
             </void> 
             <void method="put"> 
              <string>transient_lastDdlTime</string> 
-             <string>1304060297</string> 
+             <string>1310382391</string> 
             </void> 
            </object> 
           </void> 
diff --git a/ql/src/test/results/compiler/plan/subq.q.xml b/ql/src/test/results/compiler/plan/subq.q.xml
index 0b75a7319e..7ef078fb39 100644
--- a/ql/src/test/results/compiler/plan/subq.q.xml
+++ b/ql/src/test/results/compiler/plan/subq.q.xml
@@ -1,5 +1,5 @@
 <?xml version="1.0" encoding="UTF-8"?> 
-<java version="1.6.0_07" class="java.beans.XMLDecoder"> 
+<java version="1.6.0_01" class="java.beans.XMLDecoder"> 
  <object id="MapRedTask0" class="org.apache.hadoop.hive.ql.exec.MapRedTask"> 
   <void property="childTasks"> 
    <object class="java.util.ArrayList"> 
@@ -41,7 +41,7 @@
                     <void property="aliasToWork"> 
                      <object class="java.util.LinkedHashMap"> 
                       <void method="put"> 
-                       <string>file:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-58-33_025_4812811828316012703/-ext-10001</string> 
+                       <string>file:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-36_616_1136566510107816555/-ext-10001</string> 
                        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                         <void property="childOperators"> 
                          <object class="java.util.ArrayList"> 
@@ -50,7 +50,7 @@
                             <void property="conf"> 
                              <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
                               <void property="dirName"> 
-                               <string>file:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-58-33_025_4812811828316012703/-ext-10000</string> 
+                               <string>file:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-36_616_1136566510107816555/-ext-10000</string> 
                               </void> 
                               <void property="numFiles"> 
                                <int>1</int> 
@@ -92,21 +92,21 @@
                             <void property="counterNames"> 
                              <object class="java.util.ArrayList"> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_636_NUM_INPUT_ROWS</string> 
+                               <string>CNTR_NAME_FS_608_NUM_INPUT_ROWS</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_636_NUM_OUTPUT_ROWS</string> 
+                               <string>CNTR_NAME_FS_608_NUM_OUTPUT_ROWS</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_636_TIME_TAKEN</string> 
+                               <string>CNTR_NAME_FS_608_TIME_TAKEN</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_636_FATAL_ERROR</string> 
+                               <string>CNTR_NAME_FS_608_FATAL_ERROR</string> 
                               </void> 
                              </object> 
                             </void> 
                             <void property="operatorId"> 
-                             <string>FS_636</string> 
+                             <string>FS_608</string> 
                             </void> 
                             <void property="parentOperators"> 
                              <object class="java.util.ArrayList"> 
@@ -160,21 +160,21 @@
                         <void property="counterNames"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_635_NUM_INPUT_ROWS</string> 
+                           <string>CNTR_NAME_TS_607_NUM_INPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_635_NUM_OUTPUT_ROWS</string> 
+                           <string>CNTR_NAME_TS_607_NUM_OUTPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_635_TIME_TAKEN</string> 
+                           <string>CNTR_NAME_TS_607_TIME_TAKEN</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_635_FATAL_ERROR</string> 
+                           <string>CNTR_NAME_TS_607_FATAL_ERROR</string> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="operatorId"> 
-                         <string>TS_635</string> 
+                         <string>TS_607</string> 
                         </void> 
                         <void property="schema"> 
                          <object idref="RowSchema0"/> 
@@ -195,10 +195,10 @@
                     <void property="pathToAliases"> 
                      <object class="java.util.LinkedHashMap"> 
                       <void method="put"> 
-                       <string>file:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-58-33_025_4812811828316012703/-ext-10001</string> 
+                       <string>file:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-36_616_1136566510107816555/-ext-10001</string> 
                        <object class="java.util.ArrayList"> 
                         <void method="add"> 
-                         <string>file:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-58-33_025_4812811828316012703/-ext-10001</string> 
+                         <string>file:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-36_616_1136566510107816555/-ext-10001</string> 
                         </void> 
                        </object> 
                       </void> 
@@ -207,7 +207,7 @@
                     <void property="pathToPartitionInfo"> 
                      <object class="java.util.LinkedHashMap"> 
                       <void method="put"> 
-                       <string>file:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-58-33_025_4812811828316012703/-ext-10001</string> 
+                       <string>file:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-36_616_1136566510107816555/-ext-10001</string> 
                        <object class="org.apache.hadoop.hive.ql.plan.PartitionDesc"> 
                         <void property="baseFileName"> 
                          <string>-ext-10001</string> 
@@ -280,7 +280,7 @@
                    <boolean>true</boolean> 
                   </void> 
                   <void property="sourceDir"> 
-                   <string>file:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-58-33_025_4812811828316012703/-ext-10000</string> 
+                   <string>file:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-36_616_1136566510107816555/-ext-10000</string> 
                   </void> 
                   <void property="targetDir"> 
                    <string>../build/ql/test/data/warehouse/union.out</string> 
@@ -304,10 +304,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-58-33_025_4812811828316012703/-ext-10001</string> 
+               <string>file:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-36_616_1136566510107816555/-ext-10001</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-58-33_025_4812811828316012703/-ext-10000</string> 
+               <string>file:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-36_616_1136566510107816555/-ext-10000</string> 
               </void> 
              </object> 
             </void> 
@@ -333,7 +333,7 @@
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
         <void property="dir"> 
-         <string>file:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-58-33_025_4812811828316012703/-ext-10001</string> 
+         <string>file:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-36_616_1136566510107816555/-ext-10001</string> 
         </void> 
         <void property="listTasks"> 
          <object idref="ArrayList0"/> 
@@ -419,11 +419,11 @@
          </void> 
          <void method="put"> 
           <string>location</string> 
-          <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src</string> 
+          <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src</string> 
          </void> 
          <void method="put"> 
           <string>transient_lastDdlTime</string> 
-          <string>1304060310</string> 
+          <string>1310382395</string> 
          </void> 
         </object> 
        </void> 
@@ -481,11 +481,11 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src</string> 
+            <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src</string> 
            </void> 
            <void method="put"> 
             <string>transient_lastDdlTime</string> 
-            <string>1304060310</string> 
+            <string>1310382395</string> 
            </void> 
           </object> 
          </void> 
@@ -509,198 +509,65 @@
             <void property="childOperators"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+               <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+                   <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
                     <void property="childOperators"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                        <void property="childOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                            <void property="conf"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                              <void property="destTableId"> 
-                               <int>1</int> 
-                              </void> 
-                              <void property="dirName"> 
-                               <string>file:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-58-33_025_4812811828316012703/-ext-10001</string> 
-                              </void> 
-                              <void property="numFiles"> 
-                               <int>1</int> 
-                              </void> 
-                              <void property="statsAggPrefix"> 
-                               <string>file:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-58-33_025_4812811828316012703/-ext-10000/</string> 
-                              </void> 
-                              <void property="tableInfo"> 
-                               <object idref="TableDesc0"/> 
-                              </void> 
-                              <void property="totalFiles"> 
-                               <int>1</int> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="counterNames"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <string>CNTR_NAME_FS_633_NUM_INPUT_ROWS</string> 
-                              </void> 
-                              <void method="add"> 
-                               <string>CNTR_NAME_FS_633_NUM_OUTPUT_ROWS</string> 
-                              </void> 
-                              <void method="add"> 
-                               <string>CNTR_NAME_FS_633_TIME_TAKEN</string> 
-                              </void> 
-                              <void method="add"> 
-                               <string>CNTR_NAME_FS_633_FATAL_ERROR</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="operatorId"> 
-                             <string>FS_633</string> 
-                            </void> 
-                            <void property="parentOperators"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object idref="SelectOperator1"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="schema"> 
-                             <object idref="RowSchema0"/> 
-                            </void> 
-                           </object> 
+                       <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                        <void property="conf"> 
+                         <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                          <void property="destTableId"> 
+                           <int>1</int> 
                           </void> 
-                         </object> 
-                        </void> 
-                        <void property="columnExprMap"> 
-                         <object class="java.util.HashMap"> 
-                          <void method="put"> 
-                           <string>_col1</string> 
-                           <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>_col1</string> 
-                            </void> 
-                            <void property="tabAlias"> 
-                             <string>src</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
+                          <void property="dirName"> 
+                           <string>file:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-36_616_1136566510107816555/-ext-10001</string> 
                           </void> 
-                          <void method="put"> 
-                           <string>_col0</string> 
-                           <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>_col0</string> 
-                            </void> 
-                            <void property="tabAlias"> 
-                             <string>src</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
+                          <void property="numFiles"> 
+                           <int>1</int> 
                           </void> 
-                         </object> 
-                        </void> 
-                        <void property="conf"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                          <void property="colList"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object idref="ExprNodeColumnDesc1"/> 
-                            </void> 
-                            <void method="add"> 
-                             <object idref="ExprNodeColumnDesc0"/> 
-                            </void> 
-                           </object> 
+                          <void property="statsAggPrefix"> 
+                           <string>file:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-36_616_1136566510107816555/-ext-10000/</string> 
                           </void> 
-                          <void property="outputColumnNames"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <string>_col0</string> 
-                            </void> 
-                            <void method="add"> 
-                             <string>_col1</string> 
-                            </void> 
-                           </object> 
+                          <void property="tableInfo"> 
+                           <object idref="TableDesc0"/> 
                           </void> 
-                          <void property="selectStar"> 
-                           <boolean>true</boolean> 
+                          <void property="totalFiles"> 
+                           <int>1</int> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="counterNames"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <string>CNTR_NAME_SEL_632_NUM_INPUT_ROWS</string> 
+                           <string>CNTR_NAME_FS_605_NUM_INPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_SEL_632_NUM_OUTPUT_ROWS</string> 
+                           <string>CNTR_NAME_FS_605_NUM_OUTPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_SEL_632_TIME_TAKEN</string> 
+                           <string>CNTR_NAME_FS_605_TIME_TAKEN</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_SEL_632_FATAL_ERROR</string> 
+                           <string>CNTR_NAME_FS_605_FATAL_ERROR</string> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="operatorId"> 
-                         <string>SEL_632</string> 
+                         <string>FS_605</string> 
                         </void> 
                         <void property="parentOperators"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <object idref="SelectOperator0"/> 
+                           <object idref="SelectOperator1"/> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="schema"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                          <void property="signature"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="alias"> 
-                               <string>key</string> 
-                              </void> 
-                              <void property="internalName"> 
-                               <string>_col0</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string>src</string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="alias"> 
-                               <string>value</string> 
-                              </void> 
-                              <void property="internalName"> 
-                               <string>_col1</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string>src</string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
+                         <object idref="RowSchema0"/> 
                         </void> 
                        </object> 
                       </void> 
@@ -710,9 +577,9 @@
                      <object class="java.util.HashMap"> 
                       <void method="put"> 
                        <string>_col1</string> 
-                       <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
                         <void property="column"> 
-                         <string>value</string> 
+                         <string>_col1</string> 
                         </void> 
                         <void property="tabAlias"> 
                          <string>src</string> 
@@ -724,9 +591,9 @@
                       </void> 
                       <void method="put"> 
                        <string>_col0</string> 
-                       <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
                         <void property="column"> 
-                         <string>key</string> 
+                         <string>_col0</string> 
                         </void> 
                         <void property="tabAlias"> 
                          <string>src</string> 
@@ -743,10 +610,10 @@
                       <void property="colList"> 
                        <object class="java.util.ArrayList"> 
                         <void method="add"> 
-                         <object idref="ExprNodeColumnDesc3"/> 
+                         <object idref="ExprNodeColumnDesc1"/> 
                         </void> 
                         <void method="add"> 
-                         <object idref="ExprNodeColumnDesc2"/> 
+                         <object idref="ExprNodeColumnDesc0"/> 
                         </void> 
                        </object> 
                       </void> 
@@ -768,26 +635,26 @@
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_631_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_SEL_604_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_631_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_SEL_604_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_631_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_SEL_604_TIME_TAKEN</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_631_FATAL_ERROR</string> 
+                       <string>CNTR_NAME_SEL_604_FATAL_ERROR</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>SEL_631</string> 
+                     <string>SEL_604</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object idref="FilterOperator1"/> 
+                       <object idref="SelectOperator0"/> 
                       </void> 
                      </object> 
                     </void> 
@@ -797,6 +664,9 @@
                        <object class="java.util.ArrayList"> 
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                          <void property="alias"> 
+                           <string>key</string> 
+                          </void> 
                           <void property="internalName"> 
                            <string>_col0</string> 
                           </void> 
@@ -810,6 +680,9 @@
                         </void> 
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                          <void property="alias"> 
+                           <string>value</string> 
+                          </void> 
                           <void property="internalName"> 
                            <string>_col1</string> 
                           </void> 
@@ -829,73 +702,83 @@
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-                  <void property="predicate"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="childExprs"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>int</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="value"> 
-                         <int>100</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                <void property="columnExprMap"> 
+                 <object class="java.util.HashMap"> 
+                  <void method="put"> 
+                   <string>_col1</string> 
+                   <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>value</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
+                    <void property="tabAlias"> 
+                     <string>src</string> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                      <void property="typeName"> 
-                       <string>boolean</string> 
-                      </void> 
-                     </object> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="put"> 
+                   <string>_col0</string> 
+                   <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>key</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string>src</string> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
+                <void property="conf"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                  <void property="colList"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object idref="ExprNodeColumnDesc3"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="ExprNodeColumnDesc2"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void property="outputColumnNames"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <string>_col0</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col1</string> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void property="selectStar"> 
+                   <boolean>true</boolean> 
+                  </void> 
+                 </object> 
+                </void> 
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_630_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_603_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_630_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_603_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_630_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_SEL_603_TIME_TAKEN</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_630_FATAL_ERROR</string> 
+                   <string>CNTR_NAME_SEL_603_FATAL_ERROR</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>FIL_630</string> 
+                 <string>SEL_603</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -909,9 +792,9 @@
                   <void property="signature"> 
                    <object class="java.util.ArrayList"> 
                     <void method="add"> 
-                     <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                       <void property="internalName"> 
-                       <string>key</string> 
+                       <string>_col0</string> 
                       </void> 
                       <void property="tabAlias"> 
                        <string>src</string> 
@@ -922,9 +805,9 @@
                      </object> 
                     </void> 
                     <void method="add"> 
-                     <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                       <void property="internalName"> 
-                       <string>value</string> 
+                       <string>_col1</string> 
                       </void> 
                       <void property="tabAlias"> 
                        <string>src</string> 
@@ -964,7 +847,11 @@
                   <void method="add"> 
                    <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
+                     <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                      <void property="typeName"> 
+                       <string>int</string> 
+                      </void> 
+                     </object> 
                     </void> 
                     <void property="value"> 
                      <int>100</int> 
@@ -977,7 +864,11 @@
                  <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
                 </void> 
                 <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo2"/> 
+                 <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                  <void property="typeName"> 
+                   <string>boolean</string> 
+                  </void> 
+                 </object> 
                 </void> 
                </object> 
               </void> 
@@ -986,21 +877,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_634_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_606_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_634_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_606_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_634_TIME_TAKEN</string> 
+               <string>CNTR_NAME_FIL_606_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_634_FATAL_ERROR</string> 
+               <string>CNTR_NAME_FIL_606_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>FIL_634</string> 
+             <string>FIL_606</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -1014,10 +905,30 @@
               <void property="signature"> 
                <object id="ArrayList1" class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <object idref="ColumnInfo0"/> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>key</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>src</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
                 </void> 
                 <void method="add"> 
-                 <object idref="ColumnInfo1"/> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>value</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>src</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
                 </void> 
                 <void method="add"> 
                  <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
@@ -1076,16 +987,16 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_629_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_601_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_629_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_601_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_629_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_601_TIME_TAKEN</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_629_FATAL_ERROR</string> 
+           <string>CNTR_NAME_TS_601_FATAL_ERROR</string> 
           </void> 
          </object> 
         </void> 
@@ -1100,7 +1011,7 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_629</string> 
+         <string>TS_601</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -1119,7 +1030,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src</string> 
+       <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>unioninput:src</string> 
@@ -1131,7 +1042,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src</string> 
+       <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src</string> 
        <object class="org.apache.hadoop.hive.ql.plan.PartitionDesc"> 
         <void property="baseFileName"> 
          <string>src</string> 
@@ -1188,11 +1099,11 @@
           </void> 
           <void method="put"> 
            <string>location</string> 
-           <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src</string> 
+           <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src</string> 
           </void> 
           <void method="put"> 
            <string>transient_lastDdlTime</string> 
-           <string>1304060310</string> 
+           <string>1310382395</string> 
           </void> 
          </object> 
         </void> 
@@ -1250,11 +1161,11 @@
             </void> 
             <void method="put"> 
              <string>location</string> 
-             <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src</string> 
+             <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src</string> 
             </void> 
             <void method="put"> 
              <string>transient_lastDdlTime</string> 
-             <string>1304060310</string> 
+             <string>1310382395</string> 
             </void> 
            </object> 
           </void> 
diff --git a/ql/src/test/results/compiler/plan/udf1.q.xml b/ql/src/test/results/compiler/plan/udf1.q.xml
index 5ff16d7d5c..167fa8edcf 100644
--- a/ql/src/test/results/compiler/plan/udf1.q.xml
+++ b/ql/src/test/results/compiler/plan/udf1.q.xml
@@ -1,5 +1,5 @@
 <?xml version="1.0" encoding="UTF-8"?> 
-<java version="1.6.0_07" class="java.beans.XMLDecoder"> 
+<java version="1.6.0_01" class="java.beans.XMLDecoder"> 
  <object class="org.apache.hadoop.hive.ql.exec.MapRedTask"> 
   <void property="id"> 
    <string>Stage-3</string> 
@@ -62,11 +62,11 @@
          </void> 
          <void method="put"> 
           <string>location</string> 
-          <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src</string> 
+          <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src</string> 
          </void> 
          <void method="put"> 
           <string>transient_lastDdlTime</string> 
-          <string>1304060320</string> 
+          <string>1310382399</string> 
          </void> 
         </object> 
        </void> 
@@ -124,11 +124,11 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src</string> 
+            <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src</string> 
            </void> 
            <void method="put"> 
             <string>transient_lastDdlTime</string> 
-            <string>1304060320</string> 
+            <string>1310382399</string> 
            </void> 
           </object> 
          </void> 
@@ -152,1534 +152,1112 @@
             <void property="childOperators"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+               <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                    <void property="childOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                        <void property="conf"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                          <void property="dirName"> 
-                           <string>file:/tmp/sdong/hive_2011-04-28_23-58-42_926_5215082691597914017/-ext-10001</string> 
-                          </void> 
-                          <void property="numFiles"> 
-                           <int>1</int> 
-                          </void> 
-                          <void property="statsAggPrefix"> 
-                           <string>file:/tmp/sdong/hive_2011-04-28_23-58-42_926_5215082691597914017/-ext-10001/</string> 
-                          </void> 
-                          <void property="tableInfo"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                            <void property="deserializerClass"> 
-                             <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
-                            </void> 
-                            <void property="inputFileFormatClass"> 
-                             <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-                            </void> 
-                            <void property="outputFileFormatClass"> 
-                             <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-                            </void> 
-                            <void property="properties"> 
-                             <object class="java.util.Properties"> 
-                              <void method="put"> 
-                               <string>columns</string> 
-                               <string>_col0,_col1,_col2,_col3,_col4,_col5,_col6,_col7,_col8,_col9,_col10,_col11,_col12,_col13,_col14,_col15,_col16</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>serialization.format</string> 
-                               <string>1</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>columns.types</string> 
-                               <string>boolean:boolean:boolean:boolean:boolean:boolean:boolean:boolean:boolean:boolean:boolean:boolean:boolean:string:string:string:string</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="totalFiles"> 
-                           <int>1</int> 
-                          </void> 
-                         </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                    <void property="conf"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                      <void property="dirName"> 
+                       <string>file:/tmp/amarsri/hive_2011-07-11_04-06-40_095_2249714112585544624/-ext-10001</string> 
+                      </void> 
+                      <void property="numFiles"> 
+                       <int>1</int> 
+                      </void> 
+                      <void property="statsAggPrefix"> 
+                       <string>file:/tmp/amarsri/hive_2011-07-11_04-06-40_095_2249714112585544624/-ext-10001/</string> 
+                      </void> 
+                      <void property="tableInfo"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                        <void property="deserializerClass"> 
+                         <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
                         </void> 
-                        <void property="counterNames"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_648_NUM_INPUT_ROWS</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_648_NUM_OUTPUT_ROWS</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_648_TIME_TAKEN</string> 
-                          </void> 
-                          <void method="add"> 
-                           <string>CNTR_NAME_FS_648_FATAL_ERROR</string> 
-                          </void> 
-                         </object> 
+                        <void property="inputFileFormatClass"> 
+                         <class>org.apache.hadoop.mapred.TextInputFormat</class> 
                         </void> 
-                        <void property="operatorId"> 
-                         <string>FS_648</string> 
+                        <void property="outputFileFormatClass"> 
+                         <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
                         </void> 
-                        <void property="parentOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object idref="SelectOperator0"/> 
+                        <void property="properties"> 
+                         <object class="java.util.Properties"> 
+                          <void method="put"> 
+                           <string>columns</string> 
+                           <string>_col0,_col1,_col2,_col3,_col4,_col5,_col6,_col7,_col8,_col9,_col10,_col11,_col12,_col13,_col14,_col15,_col16</string> 
                           </void> 
-                         </object> 
-                        </void> 
-                        <void property="schema"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                          <void property="signature"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>_col0</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string></string> 
-                              </void> 
-                              <void property="type"> 
-                               <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                                <void property="typeName"> 
-                                 <string>boolean</string> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>_col1</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string></string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>_col2</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string></string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>_col3</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string></string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>_col4</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string></string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>_col5</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string></string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>_col6</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string></string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>_col7</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string></string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>_col8</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string></string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>_col9</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string></string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>_col10</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string></string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>_col11</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string></string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>_col12</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string></string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>_col13</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string></string> 
-                              </void> 
-                              <void property="type"> 
-                               <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                                <void property="typeName"> 
-                                 <string>string</string> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>_col14</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string></string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo1"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>_col15</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string></string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo1"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>_col16</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string></string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo1"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
+                          <void method="put"> 
+                           <string>serialization.format</string> 
+                           <string>1</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>columns.types</string> 
+                           <string>boolean:boolean:boolean:boolean:boolean:boolean:boolean:boolean:boolean:boolean:boolean:boolean:boolean:string:string:string:string</string> 
                           </void> 
                          </object> 
                         </void> 
                        </object> 
                       </void> 
+                      <void property="totalFiles"> 
+                       <int>1</int> 
+                      </void> 
                      </object> 
                     </void> 
-                    <void property="columnExprMap"> 
-                     <object class="java.util.HashMap"> 
-                      <void method="put"> 
-                       <string>_col8</string> 
-                       <object id="ExprNodeGenericFuncDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <string></string> 
-                            </void> 
-                           </object> 
+                    <void property="counterNames"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <string>CNTR_NAME_FS_619_NUM_INPUT_ROWS</string> 
+                      </void> 
+                      <void method="add"> 
+                       <string>CNTR_NAME_FS_619_NUM_OUTPUT_ROWS</string> 
+                      </void> 
+                      <void method="add"> 
+                       <string>CNTR_NAME_FS_619_TIME_TAKEN</string> 
+                      </void> 
+                      <void method="add"> 
+                       <string>CNTR_NAME_FS_619_FATAL_ERROR</string> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="operatorId"> 
+                     <string>FS_619</string> 
+                    </void> 
+                    <void property="parentOperators"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object idref="SelectOperator0"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="schema"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                      <void property="signature"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                          <void property="internalName"> 
+                           <string>_col0</string> 
                           </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <string>.*</string> 
+                          <void property="tabAlias"> 
+                           <string></string> 
+                          </void> 
+                          <void property="type"> 
+                           <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                            <void property="typeName"> 
+                             <string>boolean</string> 
                             </void> 
                            </object> 
                           </void> 
                          </object> 
                         </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                          <void property="operator"> 
-                           <boolean>true</boolean> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                          <void property="internalName"> 
+                           <string>_col1</string> 
                           </void> 
-                          <void property="udfClass"> 
-                           <class>org.apache.hadoop.hive.ql.udf.UDFRegExp</class> 
+                          <void property="tabAlias"> 
+                           <string></string> 
                           </void> 
-                          <void property="udfName"> 
-                           <string>rlike</string> 
+                          <void property="type"> 
+                           <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
                          </object> 
                         </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="put"> 
-                       <string>_col7</string> 
-                       <object id="ExprNodeGenericFuncDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <string>ab</string> 
-                            </void> 
-                           </object> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                          <void property="internalName"> 
+                           <string>_col2</string> 
                           </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <string>a</string> 
-                            </void> 
-                           </object> 
+                          <void property="tabAlias"> 
+                           <string></string> 
+                          </void> 
+                          <void property="type"> 
+                           <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
                          </object> 
                         </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                          <void property="operator"> 
-                           <boolean>true</boolean> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                          <void property="internalName"> 
+                           <string>_col3</string> 
                           </void> 
-                          <void property="udfClass"> 
-                           <class>org.apache.hadoop.hive.ql.udf.UDFLike</class> 
+                          <void property="tabAlias"> 
+                           <string></string> 
                           </void> 
-                          <void property="udfName"> 
-                           <string>like</string> 
+                          <void property="type"> 
+                           <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
                          </object> 
                         </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="put"> 
-                       <string>_col6</string> 
-                       <object id="ExprNodeGenericFuncDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <string>ab</string> 
-                            </void> 
-                           </object> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                          <void property="internalName"> 
+                           <string>_col4</string> 
                           </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <string>_a%</string> 
-                            </void> 
-                           </object> 
+                          <void property="tabAlias"> 
+                           <string></string> 
+                          </void> 
+                          <void property="type"> 
+                           <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
                          </object> 
                         </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                          <void property="operator"> 
-                           <boolean>true</boolean> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                          <void property="internalName"> 
+                           <string>_col5</string> 
                           </void> 
-                          <void property="udfClass"> 
-                           <class>org.apache.hadoop.hive.ql.udf.UDFLike</class> 
+                          <void property="tabAlias"> 
+                           <string></string> 
                           </void> 
-                          <void property="udfName"> 
-                           <string>like</string> 
+                          <void property="type"> 
+                           <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
                          </object> 
                         </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="put"> 
-                       <string>_col5</string> 
-                       <object id="ExprNodeGenericFuncDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <string>ab</string> 
-                            </void> 
-                           </object> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                          <void property="internalName"> 
+                           <string>_col6</string> 
                           </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <string>\%\_</string> 
-                            </void> 
-                           </object> 
+                          <void property="tabAlias"> 
+                           <string></string> 
+                          </void> 
+                          <void property="type"> 
+                           <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
                          </object> 
                         </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                          <void property="operator"> 
-                           <boolean>true</boolean> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                          <void property="internalName"> 
+                           <string>_col7</string> 
                           </void> 
-                          <void property="udfClass"> 
-                           <class>org.apache.hadoop.hive.ql.udf.UDFLike</class> 
+                          <void property="tabAlias"> 
+                           <string></string> 
                           </void> 
-                          <void property="udfName"> 
-                           <string>like</string> 
+                          <void property="type"> 
+                           <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
                          </object> 
                         </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="put"> 
-                       <string>_col4</string> 
-                       <object id="ExprNodeGenericFuncDesc4" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <string>%_</string> 
-                            </void> 
-                           </object> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                          <void property="internalName"> 
+                           <string>_col8</string> 
                           </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <string>\%\_</string> 
-                            </void> 
-                           </object> 
+                          <void property="tabAlias"> 
+                           <string></string> 
+                          </void> 
+                          <void property="type"> 
+                           <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
                          </object> 
                         </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                          <void property="operator"> 
-                           <boolean>true</boolean> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                          <void property="internalName"> 
+                           <string>_col9</string> 
                           </void> 
-                          <void property="udfClass"> 
-                           <class>org.apache.hadoop.hive.ql.udf.UDFLike</class> 
+                          <void property="tabAlias"> 
+                           <string></string> 
                           </void> 
-                          <void property="udfName"> 
-                           <string>like</string> 
+                          <void property="type"> 
+                           <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
                          </object> 
                         </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="put"> 
-                       <string>_col3</string> 
-                       <object id="ExprNodeGenericFuncDesc5" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <string>ab</string> 
-                            </void> 
-                           </object> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                          <void property="internalName"> 
+                           <string>_col10</string> 
                           </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <string>%a_</string> 
-                            </void> 
-                           </object> 
+                          <void property="tabAlias"> 
+                           <string></string> 
+                          </void> 
+                          <void property="type"> 
+                           <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
                          </object> 
                         </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                          <void property="operator"> 
-                           <boolean>true</boolean> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                          <void property="internalName"> 
+                           <string>_col11</string> 
                           </void> 
-                          <void property="udfClass"> 
-                           <class>org.apache.hadoop.hive.ql.udf.UDFLike</class> 
+                          <void property="tabAlias"> 
+                           <string></string> 
                           </void> 
-                          <void property="udfName"> 
-                           <string>like</string> 
+                          <void property="type"> 
+                           <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
                          </object> 
                         </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="put"> 
-                       <string>_col2</string> 
-                       <object id="ExprNodeGenericFuncDesc6" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <string>ab</string> 
-                            </void> 
-                           </object> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                          <void property="internalName"> 
+                           <string>_col12</string> 
                           </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <string>%a%</string> 
-                            </void> 
-                           </object> 
+                          <void property="tabAlias"> 
+                           <string></string> 
+                          </void> 
+                          <void property="type"> 
+                           <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
                          </object> 
                         </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                          <void property="operator"> 
-                           <boolean>true</boolean> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                          <void property="internalName"> 
+                           <string>_col13</string> 
                           </void> 
-                          <void property="udfClass"> 
-                           <class>org.apache.hadoop.hive.ql.udf.UDFLike</class> 
+                          <void property="tabAlias"> 
+                           <string></string> 
                           </void> 
-                          <void property="udfName"> 
-                           <string>like</string> 
+                          <void property="type"> 
+                           <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                            <void property="typeName"> 
+                             <string>string</string> 
+                            </void> 
+                           </object> 
                           </void> 
                          </object> 
                         </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="put"> 
-                       <string>_col1</string> 
-                       <object id="ExprNodeGenericFuncDesc7" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <string>b</string> 
-                            </void> 
-                           </object> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                          <void property="internalName"> 
+                           <string>_col14</string> 
                           </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <string>%a%</string> 
-                            </void> 
-                           </object> 
+                          <void property="tabAlias"> 
+                           <string></string> 
+                          </void> 
+                          <void property="type"> 
+                           <object idref="PrimitiveTypeInfo1"/> 
                           </void> 
                          </object> 
                         </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                          <void property="operator"> 
-                           <boolean>true</boolean> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                          <void property="internalName"> 
+                           <string>_col15</string> 
                           </void> 
-                          <void property="udfClass"> 
-                           <class>org.apache.hadoop.hive.ql.udf.UDFLike</class> 
+                          <void property="tabAlias"> 
+                           <string></string> 
                           </void> 
-                          <void property="udfName"> 
-                           <string>like</string> 
+                          <void property="type"> 
+                           <object idref="PrimitiveTypeInfo1"/> 
                           </void> 
                          </object> 
                         </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="put"> 
-                       <string>_col9</string> 
-                       <object id="ExprNodeGenericFuncDesc8" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <string>a</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <string>[ab]</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                          <void property="operator"> 
-                           <boolean>true</boolean> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                          <void property="internalName"> 
+                           <string>_col16</string> 
                           </void> 
-                          <void property="udfClass"> 
-                           <class>org.apache.hadoop.hive.ql.udf.UDFRegExp</class> 
+                          <void property="tabAlias"> 
+                           <string></string> 
                           </void> 
-                          <void property="udfName"> 
-                           <string>rlike</string> 
+                          <void property="type"> 
+                           <object idref="PrimitiveTypeInfo1"/> 
                           </void> 
                          </object> 
                         </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
                        </object> 
                       </void> 
-                      <void method="put"> 
-                       <string>_col13</string> 
-                       <object id="ExprNodeGenericFuncDesc9" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <string>abc</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <string>b</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <string>c</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                          <void property="udfClass"> 
-                           <class>org.apache.hadoop.hive.ql.udf.UDFRegExpReplace</class> 
-                          </void> 
-                          <void property="udfName"> 
-                           <string>regexp_replace</string> 
-                          </void> 
-                         </object> 
-                        </void> 
+                     </object> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="columnExprMap"> 
+                 <object class="java.util.HashMap"> 
+                  <void method="put"> 
+                   <string>_col8</string> 
+                   <object id="ExprNodeGenericFuncDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                    <void property="childExprs"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
                         <void property="typeInfo"> 
                          <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
+                        <void property="value"> 
+                         <string></string> 
+                        </void> 
                        </object> 
                       </void> 
-                      <void method="put"> 
-                       <string>_col12</string> 
-                       <object id="ExprNodeGenericFuncDesc10" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <string>hadoop</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <string>o*</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                          <void property="operator"> 
-                           <boolean>true</boolean> 
-                          </void> 
-                          <void property="udfClass"> 
-                           <class>org.apache.hadoop.hive.ql.udf.UDFRegExp</class> 
-                          </void> 
-                          <void property="udfName"> 
-                           <string>rlike</string> 
-                          </void> 
-                         </object> 
-                        </void> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
+                         <object idref="PrimitiveTypeInfo1"/> 
+                        </void> 
+                        <void property="value"> 
+                         <string>.*</string> 
                         </void> 
                        </object> 
                       </void> 
-                      <void method="put"> 
-                       <string>_col11</string> 
-                       <object id="ExprNodeGenericFuncDesc11" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <string>hadoop</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <string>[a-z]*</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                          <void property="operator"> 
-                           <boolean>true</boolean> 
-                          </void> 
-                          <void property="udfClass"> 
-                           <class>org.apache.hadoop.hive.ql.udf.UDFRegExp</class> 
-                          </void> 
-                          <void property="udfName"> 
-                           <string>rlike</string> 
-                          </void> 
-                         </object> 
-                        </void> 
+                     </object> 
+                    </void> 
+                    <void property="genericUDF"> 
+                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                      <void property="operator"> 
+                       <boolean>true</boolean> 
+                      </void> 
+                      <void property="udfClass"> 
+                       <class>org.apache.hadoop.hive.ql.udf.UDFRegExp</class> 
+                      </void> 
+                      <void property="udfName"> 
+                       <string>rlike</string> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="put"> 
+                   <string>_col7</string> 
+                   <object id="ExprNodeGenericFuncDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                    <void property="childExprs"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
+                         <object idref="PrimitiveTypeInfo1"/> 
+                        </void> 
+                        <void property="value"> 
+                         <string>ab</string> 
                         </void> 
                        </object> 
                       </void> 
-                      <void method="put"> 
-                       <string>_col10</string> 
-                       <object id="ExprNodeGenericFuncDesc12" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <string></string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <string>[ab]</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                          <void property="operator"> 
-                           <boolean>true</boolean> 
-                          </void> 
-                          <void property="udfClass"> 
-                           <class>org.apache.hadoop.hive.ql.udf.UDFRegExp</class> 
-                          </void> 
-                          <void property="udfName"> 
-                           <string>rlike</string> 
-                          </void> 
-                         </object> 
-                        </void> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
+                         <object idref="PrimitiveTypeInfo1"/> 
+                        </void> 
+                        <void property="value"> 
+                         <string>a</string> 
                         </void> 
                        </object> 
                       </void> 
-                      <void method="put"> 
-                       <string>_col16</string> 
-                       <object id="ExprNodeGenericFuncDesc13" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <string>hadoop</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <string>(.)[a-z]*</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <string>$1ive</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                          <void property="udfClass"> 
-                           <class>org.apache.hadoop.hive.ql.udf.UDFRegExpReplace</class> 
-                          </void> 
-                          <void property="udfName"> 
-                           <string>regexp_replace</string> 
-                          </void> 
-                         </object> 
-                        </void> 
+                     </object> 
+                    </void> 
+                    <void property="genericUDF"> 
+                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                      <void property="operator"> 
+                       <boolean>true</boolean> 
+                      </void> 
+                      <void property="udfClass"> 
+                       <class>org.apache.hadoop.hive.ql.udf.UDFLike</class> 
+                      </void> 
+                      <void property="udfName"> 
+                       <string>like</string> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="put"> 
+                   <string>_col6</string> 
+                   <object id="ExprNodeGenericFuncDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                    <void property="childExprs"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
                         <void property="typeInfo"> 
                          <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
+                        <void property="value"> 
+                         <string>ab</string> 
+                        </void> 
                        </object> 
                       </void> 
-                      <void method="put"> 
-                       <string>_col15</string> 
-                       <object id="ExprNodeGenericFuncDesc14" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <string>abbbb</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <string>bb</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <string>b</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                          <void property="udfClass"> 
-                           <class>org.apache.hadoop.hive.ql.udf.UDFRegExpReplace</class> 
-                          </void> 
-                          <void property="udfName"> 
-                           <string>regexp_replace</string> 
-                          </void> 
-                         </object> 
-                        </void> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
                         <void property="typeInfo"> 
                          <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
+                        <void property="value"> 
+                         <string>_a%</string> 
+                        </void> 
                        </object> 
                       </void> 
-                      <void method="put"> 
-                       <string>_col14</string> 
-                       <object id="ExprNodeGenericFuncDesc15" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <string>abc</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <string>z</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <string>a</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                          <void property="udfClass"> 
-                           <class>org.apache.hadoop.hive.ql.udf.UDFRegExpReplace</class> 
-                          </void> 
-                          <void property="udfName"> 
-                           <string>regexp_replace</string> 
-                          </void> 
-                         </object> 
-                        </void> 
+                     </object> 
+                    </void> 
+                    <void property="genericUDF"> 
+                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                      <void property="operator"> 
+                       <boolean>true</boolean> 
+                      </void> 
+                      <void property="udfClass"> 
+                       <class>org.apache.hadoop.hive.ql.udf.UDFLike</class> 
+                      </void> 
+                      <void property="udfName"> 
+                       <string>like</string> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="put"> 
+                   <string>_col5</string> 
+                   <object id="ExprNodeGenericFuncDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                    <void property="childExprs"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
                         <void property="typeInfo"> 
                          <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
+                        <void property="value"> 
+                         <string>ab</string> 
+                        </void> 
                        </object> 
                       </void> 
-                      <void method="put"> 
-                       <string>_col0</string> 
-                       <object id="ExprNodeGenericFuncDesc16" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <string>a</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <string>%a%</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                          <void property="operator"> 
-                           <boolean>true</boolean> 
-                          </void> 
-                          <void property="udfClass"> 
-                           <class>org.apache.hadoop.hive.ql.udf.UDFLike</class> 
-                          </void> 
-                          <void property="udfName"> 
-                           <string>like</string> 
-                          </void> 
-                         </object> 
-                        </void> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
+                         <object idref="PrimitiveTypeInfo1"/> 
+                        </void> 
+                        <void property="value"> 
+                         <string>\%\_</string> 
                         </void> 
                        </object> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                      <void property="colList"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object idref="ExprNodeGenericFuncDesc16"/> 
-                        </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeGenericFuncDesc7"/> 
-                        </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeGenericFuncDesc6"/> 
-                        </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeGenericFuncDesc5"/> 
-                        </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeGenericFuncDesc4"/> 
-                        </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeGenericFuncDesc3"/> 
-                        </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeGenericFuncDesc2"/> 
-                        </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeGenericFuncDesc1"/> 
+                    <void property="genericUDF"> 
+                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                      <void property="operator"> 
+                       <boolean>true</boolean> 
+                      </void> 
+                      <void property="udfClass"> 
+                       <class>org.apache.hadoop.hive.ql.udf.UDFLike</class> 
+                      </void> 
+                      <void property="udfName"> 
+                       <string>like</string> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="put"> 
+                   <string>_col4</string> 
+                   <object id="ExprNodeGenericFuncDesc4" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                    <void property="childExprs"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeGenericFuncDesc0"/> 
+                        <void property="value"> 
+                         <string>%_</string> 
                         </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeGenericFuncDesc8"/> 
+                       </object> 
+                      </void> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeGenericFuncDesc12"/> 
+                        <void property="value"> 
+                         <string>\%\_</string> 
                         </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeGenericFuncDesc11"/> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="genericUDF"> 
+                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                      <void property="operator"> 
+                       <boolean>true</boolean> 
+                      </void> 
+                      <void property="udfClass"> 
+                       <class>org.apache.hadoop.hive.ql.udf.UDFLike</class> 
+                      </void> 
+                      <void property="udfName"> 
+                       <string>like</string> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="put"> 
+                   <string>_col3</string> 
+                   <object id="ExprNodeGenericFuncDesc5" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                    <void property="childExprs"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeGenericFuncDesc10"/> 
+                        <void property="value"> 
+                         <string>ab</string> 
                         </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeGenericFuncDesc9"/> 
+                       </object> 
+                      </void> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeGenericFuncDesc15"/> 
+                        <void property="value"> 
+                         <string>%a_</string> 
                         </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeGenericFuncDesc14"/> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="genericUDF"> 
+                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                      <void property="operator"> 
+                       <boolean>true</boolean> 
+                      </void> 
+                      <void property="udfClass"> 
+                       <class>org.apache.hadoop.hive.ql.udf.UDFLike</class> 
+                      </void> 
+                      <void property="udfName"> 
+                       <string>like</string> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="put"> 
+                   <string>_col2</string> 
+                   <object id="ExprNodeGenericFuncDesc6" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                    <void property="childExprs"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeGenericFuncDesc13"/> 
+                        <void property="value"> 
+                         <string>ab</string> 
                         </void> 
                        </object> 
                       </void> 
-                      <void property="outputColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void method="add"> 
-                         <string>_col1</string> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
-                        <void method="add"> 
-                         <string>_col2</string> 
+                        <void property="value"> 
+                         <string>%a%</string> 
                         </void> 
-                        <void method="add"> 
-                         <string>_col3</string> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="genericUDF"> 
+                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                      <void property="operator"> 
+                       <boolean>true</boolean> 
+                      </void> 
+                      <void property="udfClass"> 
+                       <class>org.apache.hadoop.hive.ql.udf.UDFLike</class> 
+                      </void> 
+                      <void property="udfName"> 
+                       <string>like</string> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="put"> 
+                   <string>_col1</string> 
+                   <object id="ExprNodeGenericFuncDesc7" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                    <void property="childExprs"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
-                        <void method="add"> 
-                         <string>_col4</string> 
+                        <void property="value"> 
+                         <string>b</string> 
                         </void> 
-                        <void method="add"> 
-                         <string>_col5</string> 
+                       </object> 
+                      </void> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
-                        <void method="add"> 
-                         <string>_col6</string> 
+                        <void property="value"> 
+                         <string>%a%</string> 
                         </void> 
-                        <void method="add"> 
-                         <string>_col7</string> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="genericUDF"> 
+                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                      <void property="operator"> 
+                       <boolean>true</boolean> 
+                      </void> 
+                      <void property="udfClass"> 
+                       <class>org.apache.hadoop.hive.ql.udf.UDFLike</class> 
+                      </void> 
+                      <void property="udfName"> 
+                       <string>like</string> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="put"> 
+                   <string>_col9</string> 
+                   <object id="ExprNodeGenericFuncDesc8" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                    <void property="childExprs"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
-                        <void method="add"> 
-                         <string>_col8</string> 
+                        <void property="value"> 
+                         <string>a</string> 
                         </void> 
-                        <void method="add"> 
-                         <string>_col9</string> 
+                       </object> 
+                      </void> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
-                        <void method="add"> 
-                         <string>_col10</string> 
+                        <void property="value"> 
+                         <string>[ab]</string> 
                         </void> 
-                        <void method="add"> 
-                         <string>_col11</string> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="genericUDF"> 
+                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                      <void property="operator"> 
+                       <boolean>true</boolean> 
+                      </void> 
+                      <void property="udfClass"> 
+                       <class>org.apache.hadoop.hive.ql.udf.UDFRegExp</class> 
+                      </void> 
+                      <void property="udfName"> 
+                       <string>rlike</string> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="put"> 
+                   <string>_col13</string> 
+                   <object id="ExprNodeGenericFuncDesc9" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                    <void property="childExprs"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
-                        <void method="add"> 
-                         <string>_col12</string> 
+                        <void property="value"> 
+                         <string>abc</string> 
                         </void> 
-                        <void method="add"> 
-                         <string>_col13</string> 
+                       </object> 
+                      </void> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
-                        <void method="add"> 
-                         <string>_col14</string> 
+                        <void property="value"> 
+                         <string>b</string> 
                         </void> 
-                        <void method="add"> 
-                         <string>_col15</string> 
+                       </object> 
+                      </void> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
-                        <void method="add"> 
-                         <string>_col16</string> 
+                        <void property="value"> 
+                         <string>c</string> 
                         </void> 
                        </object> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="counterNames"> 
+                    <void property="genericUDF"> 
+                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                      <void property="udfClass"> 
+                       <class>org.apache.hadoop.hive.ql.udf.UDFRegExpReplace</class> 
+                      </void> 
+                      <void property="udfName"> 
+                       <string>regexp_replace</string> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo1"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="put"> 
+                   <string>_col12</string> 
+                   <object id="ExprNodeGenericFuncDesc10" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                    <void property="childExprs"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_647_NUM_INPUT_ROWS</string> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
+                        </void> 
+                        <void property="value"> 
+                         <string>hadoop</string> 
+                        </void> 
+                       </object> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_647_NUM_OUTPUT_ROWS</string> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
+                        </void> 
+                        <void property="value"> 
+                         <string>o*</string> 
+                        </void> 
+                       </object> 
                       </void> 
-                      <void method="add"> 
-                       <string>CNTR_NAME_SEL_647_TIME_TAKEN</string> 
+                     </object> 
+                    </void> 
+                    <void property="genericUDF"> 
+                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                      <void property="operator"> 
+                       <boolean>true</boolean> 
                       </void> 
-                      <void method="add"> 
-                       <string>CNTR_NAME_SEL_647_FATAL_ERROR</string> 
+                      <void property="udfClass"> 
+                       <class>org.apache.hadoop.hive.ql.udf.UDFRegExp</class> 
+                      </void> 
+                      <void property="udfName"> 
+                       <string>rlike</string> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="operatorId"> 
-                     <string>SEL_647</string> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                    <void property="parentOperators"> 
+                   </object> 
+                  </void> 
+                  <void method="put"> 
+                   <string>_col11</string> 
+                   <object id="ExprNodeGenericFuncDesc11" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                    <void property="childExprs"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object idref="FilterOperator1"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="schema"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                      <void property="signature"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="alias"> 
-                           <string>_c0</string> 
-                          </void> 
-                          <void property="internalName"> 
-                           <string>_col0</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                         </object> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="alias"> 
-                           <string>_c1</string> 
-                          </void> 
-                          <void property="internalName"> 
-                           <string>_col1</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                         </object> 
+                        <void property="value"> 
+                         <string>hadoop</string> 
                         </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="alias"> 
-                           <string>_c2</string> 
-                          </void> 
-                          <void property="internalName"> 
-                           <string>_col2</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                         </object> 
+                       </object> 
+                      </void> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="alias"> 
-                           <string>_c3</string> 
-                          </void> 
-                          <void property="internalName"> 
-                           <string>_col3</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                         </object> 
+                        <void property="value"> 
+                         <string>[a-z]*</string> 
                         </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="alias"> 
-                           <string>_c4</string> 
-                          </void> 
-                          <void property="internalName"> 
-                           <string>_col4</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                         </object> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="genericUDF"> 
+                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                      <void property="operator"> 
+                       <boolean>true</boolean> 
+                      </void> 
+                      <void property="udfClass"> 
+                       <class>org.apache.hadoop.hive.ql.udf.UDFRegExp</class> 
+                      </void> 
+                      <void property="udfName"> 
+                       <string>rlike</string> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="put"> 
+                   <string>_col10</string> 
+                   <object id="ExprNodeGenericFuncDesc12" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                    <void property="childExprs"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="alias"> 
-                           <string>_c5</string> 
-                          </void> 
-                          <void property="internalName"> 
-                           <string>_col5</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                         </object> 
+                        <void property="value"> 
+                         <string></string> 
                         </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="alias"> 
-                           <string>_c6</string> 
-                          </void> 
-                          <void property="internalName"> 
-                           <string>_col6</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                         </object> 
+                       </object> 
+                      </void> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="alias"> 
-                           <string>_c7</string> 
-                          </void> 
-                          <void property="internalName"> 
-                           <string>_col7</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                         </object> 
+                        <void property="value"> 
+                         <string>[ab]</string> 
                         </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="alias"> 
-                           <string>_c8</string> 
-                          </void> 
-                          <void property="internalName"> 
-                           <string>_col8</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                         </object> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="genericUDF"> 
+                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                      <void property="operator"> 
+                       <boolean>true</boolean> 
+                      </void> 
+                      <void property="udfClass"> 
+                       <class>org.apache.hadoop.hive.ql.udf.UDFRegExp</class> 
+                      </void> 
+                      <void property="udfName"> 
+                       <string>rlike</string> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="put"> 
+                   <string>_col16</string> 
+                   <object id="ExprNodeGenericFuncDesc13" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                    <void property="childExprs"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="alias"> 
-                           <string>_c9</string> 
-                          </void> 
-                          <void property="internalName"> 
-                           <string>_col9</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                         </object> 
+                        <void property="value"> 
+                         <string>hadoop</string> 
                         </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="alias"> 
-                           <string>_c10</string> 
-                          </void> 
-                          <void property="internalName"> 
-                           <string>_col10</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                         </object> 
+                       </object> 
+                      </void> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="alias"> 
-                           <string>_c11</string> 
-                          </void> 
-                          <void property="internalName"> 
-                           <string>_col11</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                         </object> 
+                        <void property="value"> 
+                         <string>(.)[a-z]*</string> 
                         </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="alias"> 
-                           <string>_c12</string> 
-                          </void> 
-                          <void property="internalName"> 
-                           <string>_col12</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                         </object> 
+                       </object> 
+                      </void> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="alias"> 
-                           <string>_c13</string> 
-                          </void> 
-                          <void property="internalName"> 
-                           <string>_col13</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo1"/> 
-                          </void> 
-                         </object> 
+                        <void property="value"> 
+                         <string>$1ive</string> 
                         </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="alias"> 
-                           <string>_c14</string> 
-                          </void> 
-                          <void property="internalName"> 
-                           <string>_col14</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo1"/> 
-                          </void> 
-                         </object> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="genericUDF"> 
+                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                      <void property="udfClass"> 
+                       <class>org.apache.hadoop.hive.ql.udf.UDFRegExpReplace</class> 
+                      </void> 
+                      <void property="udfName"> 
+                       <string>regexp_replace</string> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo1"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="put"> 
+                   <string>_col15</string> 
+                   <object id="ExprNodeGenericFuncDesc14" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                    <void property="childExprs"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="alias"> 
-                           <string>_c15</string> 
-                          </void> 
-                          <void property="internalName"> 
-                           <string>_col15</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo1"/> 
-                          </void> 
-                         </object> 
+                        <void property="value"> 
+                         <string>abbbb</string> 
                         </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="alias"> 
-                           <string>_c16</string> 
-                          </void> 
-                          <void property="internalName"> 
-                           <string>_col16</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo1"/> 
-                          </void> 
-                         </object> 
+                       </object> 
+                      </void> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
+                        </void> 
+                        <void property="value"> 
+                         <string>bb</string> 
                         </void> 
                        </object> 
                       </void> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
+                        </void> 
+                        <void property="value"> 
+                         <string>b</string> 
+                        </void> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="genericUDF"> 
+                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                      <void property="udfClass"> 
+                       <class>org.apache.hadoop.hive.ql.udf.UDFRegExpReplace</class> 
+                      </void> 
+                      <void property="udfName"> 
+                       <string>regexp_replace</string> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo1"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="put"> 
+                   <string>_col14</string> 
+                   <object id="ExprNodeGenericFuncDesc15" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                    <void property="childExprs"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
+                        </void> 
+                        <void property="value"> 
+                         <string>abc</string> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
+                        </void> 
+                        <void property="value"> 
+                         <string>z</string> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
+                        </void> 
+                        <void property="value"> 
+                         <string>a</string> 
+                        </void> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="genericUDF"> 
+                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                      <void property="udfClass"> 
+                       <class>org.apache.hadoop.hive.ql.udf.UDFRegExpReplace</class> 
+                      </void> 
+                      <void property="udfName"> 
+                       <string>regexp_replace</string> 
+                      </void> 
                      </object> 
                     </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo1"/> 
+                    </void> 
                    </object> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-                  <void property="predicate"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                  <void method="put"> 
+                   <string>_col0</string> 
+                   <object id="ExprNodeGenericFuncDesc16" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
                     <void property="childExprs"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src</string> 
-                        </void> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
                         <void property="typeInfo"> 
                          <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
+                        <void property="value"> 
+                         <string>a</string> 
+                        </void> 
                        </object> 
                       </void> 
                       <void method="add"> 
                        <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
                         <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>int</string> 
-                          </void> 
-                         </object> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
                         <void property="value"> 
-                         <int>86</int> 
+                         <string>%a%</string> 
                         </void> 
                        </object> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual"/> 
+                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                      <void property="operator"> 
+                       <boolean>true</boolean> 
+                      </void> 
+                      <void property="udfClass"> 
+                       <class>org.apache.hadoop.hive.ql.udf.UDFLike</class> 
+                      </void> 
+                      <void property="udfName"> 
+                       <string>like</string> 
+                      </void> 
+                     </object> 
                     </void> 
                     <void property="typeInfo"> 
                      <object idref="PrimitiveTypeInfo0"/> 
@@ -1688,24 +1266,138 @@
                   </void> 
                  </object> 
                 </void> 
+                <void property="conf"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                  <void property="colList"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object idref="ExprNodeGenericFuncDesc16"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="ExprNodeGenericFuncDesc7"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="ExprNodeGenericFuncDesc6"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="ExprNodeGenericFuncDesc5"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="ExprNodeGenericFuncDesc4"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="ExprNodeGenericFuncDesc3"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="ExprNodeGenericFuncDesc2"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="ExprNodeGenericFuncDesc1"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="ExprNodeGenericFuncDesc0"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="ExprNodeGenericFuncDesc8"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="ExprNodeGenericFuncDesc12"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="ExprNodeGenericFuncDesc11"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="ExprNodeGenericFuncDesc10"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="ExprNodeGenericFuncDesc9"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="ExprNodeGenericFuncDesc15"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="ExprNodeGenericFuncDesc14"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="ExprNodeGenericFuncDesc13"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void property="outputColumnNames"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <string>_col0</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col1</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col2</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col3</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col4</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col5</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col6</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col7</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col8</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col9</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col10</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col11</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col12</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col13</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col14</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col15</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col16</string> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_646_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_618_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_646_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_618_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_646_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_SEL_618_TIME_TAKEN</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_646_FATAL_ERROR</string> 
+                   <string>CNTR_NAME_SEL_618_FATAL_ERROR</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>FIL_646</string> 
+                 <string>SEL_618</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -1719,12 +1411,220 @@
                   <void property="signature"> 
                    <object class="java.util.ArrayList"> 
                     <void method="add"> 
-                     <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="alias"> 
+                       <string>_c0</string> 
+                      </void> 
+                      <void property="internalName"> 
+                       <string>_col0</string> 
+                      </void> 
+                      <void property="type"> 
+                       <object idref="PrimitiveTypeInfo0"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="alias"> 
+                       <string>_c1</string> 
+                      </void> 
+                      <void property="internalName"> 
+                       <string>_col1</string> 
+                      </void> 
+                      <void property="type"> 
+                       <object idref="PrimitiveTypeInfo0"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="alias"> 
+                       <string>_c2</string> 
+                      </void> 
+                      <void property="internalName"> 
+                       <string>_col2</string> 
+                      </void> 
+                      <void property="type"> 
+                       <object idref="PrimitiveTypeInfo0"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="alias"> 
+                       <string>_c3</string> 
+                      </void> 
+                      <void property="internalName"> 
+                       <string>_col3</string> 
+                      </void> 
+                      <void property="type"> 
+                       <object idref="PrimitiveTypeInfo0"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="alias"> 
+                       <string>_c4</string> 
+                      </void> 
+                      <void property="internalName"> 
+                       <string>_col4</string> 
+                      </void> 
+                      <void property="type"> 
+                       <object idref="PrimitiveTypeInfo0"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="alias"> 
+                       <string>_c5</string> 
+                      </void> 
+                      <void property="internalName"> 
+                       <string>_col5</string> 
+                      </void> 
+                      <void property="type"> 
+                       <object idref="PrimitiveTypeInfo0"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="alias"> 
+                       <string>_c6</string> 
+                      </void> 
+                      <void property="internalName"> 
+                       <string>_col6</string> 
+                      </void> 
+                      <void property="type"> 
+                       <object idref="PrimitiveTypeInfo0"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="alias"> 
+                       <string>_c7</string> 
+                      </void> 
+                      <void property="internalName"> 
+                       <string>_col7</string> 
+                      </void> 
+                      <void property="type"> 
+                       <object idref="PrimitiveTypeInfo0"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="alias"> 
+                       <string>_c8</string> 
+                      </void> 
+                      <void property="internalName"> 
+                       <string>_col8</string> 
+                      </void> 
+                      <void property="type"> 
+                       <object idref="PrimitiveTypeInfo0"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="alias"> 
+                       <string>_c9</string> 
+                      </void> 
+                      <void property="internalName"> 
+                       <string>_col9</string> 
+                      </void> 
+                      <void property="type"> 
+                       <object idref="PrimitiveTypeInfo0"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="alias"> 
+                       <string>_c10</string> 
+                      </void> 
+                      <void property="internalName"> 
+                       <string>_col10</string> 
+                      </void> 
+                      <void property="type"> 
+                       <object idref="PrimitiveTypeInfo0"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="alias"> 
+                       <string>_c11</string> 
+                      </void> 
+                      <void property="internalName"> 
+                       <string>_col11</string> 
+                      </void> 
+                      <void property="type"> 
+                       <object idref="PrimitiveTypeInfo0"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="alias"> 
+                       <string>_c12</string> 
+                      </void> 
+                      <void property="internalName"> 
+                       <string>_col12</string> 
+                      </void> 
+                      <void property="type"> 
+                       <object idref="PrimitiveTypeInfo0"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="alias"> 
+                       <string>_c13</string> 
+                      </void> 
+                      <void property="internalName"> 
+                       <string>_col13</string> 
+                      </void> 
+                      <void property="type"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="alias"> 
+                       <string>_c14</string> 
+                      </void> 
+                      <void property="internalName"> 
+                       <string>_col14</string> 
+                      </void> 
+                      <void property="type"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="alias"> 
+                       <string>_c15</string> 
+                      </void> 
                       <void property="internalName"> 
-                       <string>key</string> 
+                       <string>_col15</string> 
+                      </void> 
+                      <void property="type"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="alias"> 
+                       <string>_c16</string> 
                       </void> 
-                      <void property="tabAlias"> 
-                       <string>src</string> 
+                      <void property="internalName"> 
+                       <string>_col16</string> 
                       </void> 
                       <void property="type"> 
                        <object idref="PrimitiveTypeInfo1"/> 
@@ -1761,7 +1661,11 @@
                   <void method="add"> 
                    <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                     <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                      <void property="typeName"> 
+                       <string>int</string> 
+                      </void> 
+                     </object> 
                     </void> 
                     <void property="value"> 
                      <int>86</int> 
@@ -1783,21 +1687,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_649_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_620_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_649_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_620_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_649_TIME_TAKEN</string> 
+               <string>CNTR_NAME_FIL_620_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_649_FATAL_ERROR</string> 
+               <string>CNTR_NAME_FIL_620_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>FIL_649</string> 
+             <string>FIL_620</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -1811,7 +1715,17 @@
               <void property="signature"> 
                <object id="ArrayList0" class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <object idref="ColumnInfo0"/> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>key</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>src</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo1"/> 
+                  </void> 
+                 </object> 
                 </void> 
                 <void method="add"> 
                  <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
@@ -1883,16 +1797,16 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_645_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_616_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_645_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_616_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_645_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_616_TIME_TAKEN</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_645_FATAL_ERROR</string> 
+           <string>CNTR_NAME_TS_616_FATAL_ERROR</string> 
           </void> 
          </object> 
         </void> 
@@ -1904,7 +1818,7 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_645</string> 
+         <string>TS_616</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -1923,7 +1837,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src</string> 
+       <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>src</string> 
@@ -1935,7 +1849,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src</string> 
+       <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src</string> 
        <object class="org.apache.hadoop.hive.ql.plan.PartitionDesc"> 
         <void property="baseFileName"> 
          <string>src</string> 
@@ -1992,11 +1906,11 @@
           </void> 
           <void method="put"> 
            <string>location</string> 
-           <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src</string> 
+           <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src</string> 
           </void> 
           <void method="put"> 
            <string>transient_lastDdlTime</string> 
-           <string>1304060320</string> 
+           <string>1310382399</string> 
           </void> 
          </object> 
         </void> 
@@ -2054,11 +1968,11 @@
             </void> 
             <void method="put"> 
              <string>location</string> 
-             <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src</string> 
+             <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src</string> 
             </void> 
             <void method="put"> 
              <string>transient_lastDdlTime</string> 
-             <string>1304060320</string> 
+             <string>1310382399</string> 
             </void> 
            </object> 
           </void> 
diff --git a/ql/src/test/results/compiler/plan/udf4.q.xml b/ql/src/test/results/compiler/plan/udf4.q.xml
index 45cc9cf264..fda3fc4072 100644
--- a/ql/src/test/results/compiler/plan/udf4.q.xml
+++ b/ql/src/test/results/compiler/plan/udf4.q.xml
@@ -201,21 +201,21 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FS_657_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_FS_627_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FS_657_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_FS_627_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FS_657_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_FS_627_TIME_TAKEN</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FS_657_FATAL_ERROR</string> 
+                   <string>CNTR_NAME_FS_627_FATAL_ERROR</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>FS_657</string> 
+                 <string>FS_627</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -1367,21 +1367,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_656_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_SEL_626_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_656_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_SEL_626_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_656_TIME_TAKEN</string> 
+               <string>CNTR_NAME_SEL_626_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_656_FATAL_ERROR</string> 
+               <string>CNTR_NAME_SEL_626_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>SEL_656</string> 
+             <string>SEL_626</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -1662,16 +1662,16 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_655_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_625_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_655_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_625_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_655_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_625_TIME_TAKEN</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_655_FATAL_ERROR</string> 
+           <string>CNTR_NAME_TS_625_FATAL_ERROR</string> 
           </void> 
          </object> 
         </void> 
@@ -1679,7 +1679,7 @@
          <object class="java.util.ArrayList"/> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_655</string> 
+         <string>TS_625</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
diff --git a/ql/src/test/results/compiler/plan/udf6.q.xml b/ql/src/test/results/compiler/plan/udf6.q.xml
index ed162806dc..681dbcd621 100644
--- a/ql/src/test/results/compiler/plan/udf6.q.xml
+++ b/ql/src/test/results/compiler/plan/udf6.q.xml
@@ -201,21 +201,21 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FS_663_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_FS_633_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FS_663_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_FS_633_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FS_663_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_FS_633_TIME_TAKEN</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FS_663_FATAL_ERROR</string> 
+                   <string>CNTR_NAME_FS_633_FATAL_ERROR</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>FS_663</string> 
+                 <string>FS_633</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -392,21 +392,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_662_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_SEL_632_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_662_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_SEL_632_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_662_TIME_TAKEN</string> 
+               <string>CNTR_NAME_SEL_632_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_662_FATAL_ERROR</string> 
+               <string>CNTR_NAME_SEL_632_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>SEL_662</string> 
+             <string>SEL_632</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -466,16 +466,16 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_661_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_631_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_661_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_631_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_661_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_631_TIME_TAKEN</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_661_FATAL_ERROR</string> 
+           <string>CNTR_NAME_TS_631_FATAL_ERROR</string> 
           </void> 
          </object> 
         </void> 
@@ -483,7 +483,7 @@
          <object class="java.util.ArrayList"/> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_661</string> 
+         <string>TS_631</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
diff --git a/ql/src/test/results/compiler/plan/udf_case.q.xml b/ql/src/test/results/compiler/plan/udf_case.q.xml
index f0a76488f4..4fae62ef16 100644
--- a/ql/src/test/results/compiler/plan/udf_case.q.xml
+++ b/ql/src/test/results/compiler/plan/udf_case.q.xml
@@ -205,21 +205,21 @@
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_FS_670_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_FS_640_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_FS_670_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_FS_640_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_FS_670_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_FS_640_TIME_TAKEN</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_FS_670_FATAL_ERROR</string> 
+                       <string>CNTR_NAME_FS_640_FATAL_ERROR</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>FS_670</string> 
+                     <string>FS_640</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
@@ -280,21 +280,21 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_LIM_669_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_LIM_639_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_LIM_669_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_LIM_639_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_LIM_669_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_LIM_639_TIME_TAKEN</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_LIM_669_FATAL_ERROR</string> 
+                   <string>CNTR_NAME_LIM_639_FATAL_ERROR</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>LIM_669</string> 
+                 <string>LIM_639</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -512,21 +512,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_668_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_SEL_638_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_668_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_SEL_638_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_668_TIME_TAKEN</string> 
+               <string>CNTR_NAME_SEL_638_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_668_FATAL_ERROR</string> 
+               <string>CNTR_NAME_SEL_638_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>SEL_668</string> 
+             <string>SEL_638</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -559,16 +559,16 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_667_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_637_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_667_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_637_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_667_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_637_TIME_TAKEN</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_667_FATAL_ERROR</string> 
+           <string>CNTR_NAME_TS_637_FATAL_ERROR</string> 
           </void> 
          </object> 
         </void> 
@@ -576,7 +576,7 @@
          <object class="java.util.ArrayList"/> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_667</string> 
+         <string>TS_637</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
diff --git a/ql/src/test/results/compiler/plan/udf_when.q.xml b/ql/src/test/results/compiler/plan/udf_when.q.xml
index c7e259b762..3fb39d7c2b 100644
--- a/ql/src/test/results/compiler/plan/udf_when.q.xml
+++ b/ql/src/test/results/compiler/plan/udf_when.q.xml
@@ -205,21 +205,21 @@
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_FS_678_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_FS_648_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_FS_678_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_FS_648_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_FS_678_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_FS_648_TIME_TAKEN</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_FS_678_FATAL_ERROR</string> 
+                       <string>CNTR_NAME_FS_648_FATAL_ERROR</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>FS_678</string> 
+                     <string>FS_648</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
@@ -280,21 +280,21 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_LIM_677_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_LIM_647_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_LIM_677_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_LIM_647_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_LIM_677_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_LIM_647_TIME_TAKEN</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_LIM_677_FATAL_ERROR</string> 
+                   <string>CNTR_NAME_LIM_647_FATAL_ERROR</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>LIM_677</string> 
+                 <string>LIM_647</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -592,21 +592,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_676_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_SEL_646_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_676_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_SEL_646_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_676_TIME_TAKEN</string> 
+               <string>CNTR_NAME_SEL_646_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_676_FATAL_ERROR</string> 
+               <string>CNTR_NAME_SEL_646_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>SEL_676</string> 
+             <string>SEL_646</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -639,16 +639,16 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_675_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_645_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_675_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_645_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_675_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_645_TIME_TAKEN</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_675_FATAL_ERROR</string> 
+           <string>CNTR_NAME_TS_645_FATAL_ERROR</string> 
           </void> 
          </object> 
         </void> 
@@ -656,7 +656,7 @@
          <object class="java.util.ArrayList"/> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_675</string> 
+         <string>TS_645</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
diff --git a/ql/src/test/results/compiler/plan/union.q.xml b/ql/src/test/results/compiler/plan/union.q.xml
index 83d2356600..4902db691e 100644
--- a/ql/src/test/results/compiler/plan/union.q.xml
+++ b/ql/src/test/results/compiler/plan/union.q.xml
@@ -1,5 +1,5 @@
 <?xml version="1.0" encoding="UTF-8"?> 
-<java version="1.6.0_07" class="java.beans.XMLDecoder"> 
+<java version="1.6.0_01" class="java.beans.XMLDecoder"> 
  <object id="MapRedTask0" class="org.apache.hadoop.hive.ql.exec.MapRedTask"> 
   <void property="childTasks"> 
    <object class="java.util.ArrayList"> 
@@ -41,7 +41,7 @@
                     <void property="aliasToWork"> 
                      <object class="java.util.LinkedHashMap"> 
                       <void method="put"> 
-                       <string>file:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-59-33_025_642210603550334429/-ext-10001</string> 
+                       <string>file:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-57_227_5273764780066863405/-ext-10001</string> 
                        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                         <void property="childOperators"> 
                          <object class="java.util.ArrayList"> 
@@ -50,7 +50,7 @@
                             <void property="conf"> 
                              <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
                               <void property="dirName"> 
-                               <string>file:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-59-33_025_642210603550334429/-ext-10000</string> 
+                               <string>file:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-57_227_5273764780066863405/-ext-10000</string> 
                               </void> 
                               <void property="numFiles"> 
                                <int>1</int> 
@@ -92,21 +92,21 @@
                             <void property="counterNames"> 
                              <object class="java.util.ArrayList"> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_695_NUM_INPUT_ROWS</string> 
+                               <string>CNTR_NAME_FS_665_NUM_INPUT_ROWS</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_695_NUM_OUTPUT_ROWS</string> 
+                               <string>CNTR_NAME_FS_665_NUM_OUTPUT_ROWS</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_695_TIME_TAKEN</string> 
+                               <string>CNTR_NAME_FS_665_TIME_TAKEN</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_695_FATAL_ERROR</string> 
+                               <string>CNTR_NAME_FS_665_FATAL_ERROR</string> 
                               </void> 
                              </object> 
                             </void> 
                             <void property="operatorId"> 
-                             <string>FS_695</string> 
+                             <string>FS_665</string> 
                             </void> 
                             <void property="parentOperators"> 
                              <object class="java.util.ArrayList"> 
@@ -160,21 +160,21 @@
                         <void property="counterNames"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_694_NUM_INPUT_ROWS</string> 
+                           <string>CNTR_NAME_TS_664_NUM_INPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_694_NUM_OUTPUT_ROWS</string> 
+                           <string>CNTR_NAME_TS_664_NUM_OUTPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_694_TIME_TAKEN</string> 
+                           <string>CNTR_NAME_TS_664_TIME_TAKEN</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_TS_694_FATAL_ERROR</string> 
+                           <string>CNTR_NAME_TS_664_FATAL_ERROR</string> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="operatorId"> 
-                         <string>TS_694</string> 
+                         <string>TS_664</string> 
                         </void> 
                         <void property="schema"> 
                          <object idref="RowSchema0"/> 
@@ -195,10 +195,10 @@
                     <void property="pathToAliases"> 
                      <object class="java.util.LinkedHashMap"> 
                       <void method="put"> 
-                       <string>file:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-59-33_025_642210603550334429/-ext-10001</string> 
+                       <string>file:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-57_227_5273764780066863405/-ext-10001</string> 
                        <object class="java.util.ArrayList"> 
                         <void method="add"> 
-                         <string>file:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-59-33_025_642210603550334429/-ext-10001</string> 
+                         <string>file:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-57_227_5273764780066863405/-ext-10001</string> 
                         </void> 
                        </object> 
                       </void> 
@@ -207,7 +207,7 @@
                     <void property="pathToPartitionInfo"> 
                      <object class="java.util.LinkedHashMap"> 
                       <void method="put"> 
-                       <string>file:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-59-33_025_642210603550334429/-ext-10001</string> 
+                       <string>file:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-57_227_5273764780066863405/-ext-10001</string> 
                        <object class="org.apache.hadoop.hive.ql.plan.PartitionDesc"> 
                         <void property="baseFileName"> 
                          <string>-ext-10001</string> 
@@ -280,7 +280,7 @@
                    <boolean>true</boolean> 
                   </void> 
                   <void property="sourceDir"> 
-                   <string>file:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-59-33_025_642210603550334429/-ext-10000</string> 
+                   <string>file:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-57_227_5273764780066863405/-ext-10000</string> 
                   </void> 
                   <void property="targetDir"> 
                    <string>../build/ql/test/data/warehouse/union.out</string> 
@@ -304,10 +304,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-59-33_025_642210603550334429/-ext-10001</string> 
+               <string>file:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-57_227_5273764780066863405/-ext-10001</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-59-33_025_642210603550334429/-ext-10000</string> 
+               <string>file:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-57_227_5273764780066863405/-ext-10000</string> 
               </void> 
              </object> 
             </void> 
@@ -333,7 +333,7 @@
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
         <void property="dir"> 
-         <string>file:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-59-33_025_642210603550334429/-ext-10001</string> 
+         <string>file:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-57_227_5273764780066863405/-ext-10001</string> 
         </void> 
         <void property="listTasks"> 
          <object idref="ArrayList0"/> 
@@ -419,11 +419,11 @@
          </void> 
          <void method="put"> 
           <string>location</string> 
-          <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src</string> 
+          <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src</string> 
          </void> 
          <void method="put"> 
           <string>transient_lastDdlTime</string> 
-          <string>1304060370</string> 
+          <string>1310382416</string> 
          </void> 
         </object> 
        </void> 
@@ -481,11 +481,11 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src</string> 
+            <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src</string> 
            </void> 
            <void method="put"> 
             <string>transient_lastDdlTime</string> 
-            <string>1304060370</string> 
+            <string>1310382416</string> 
            </void> 
           </object> 
          </void> 
@@ -551,11 +551,11 @@
          </void> 
          <void method="put"> 
           <string>location</string> 
-          <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src</string> 
+          <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src</string> 
          </void> 
          <void method="put"> 
           <string>transient_lastDdlTime</string> 
-          <string>1304060370</string> 
+          <string>1310382416</string> 
          </void> 
         </object> 
        </void> 
@@ -613,11 +613,11 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src</string> 
+            <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src</string> 
            </void> 
            <void method="put"> 
             <string>transient_lastDdlTime</string> 
-            <string>1304060370</string> 
+            <string>1310382416</string> 
            </void> 
           </object> 
          </void> 
@@ -641,599 +641,509 @@
             <void property="childOperators"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+               <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+                   <object id="UnionOperator0" class="org.apache.hadoop.hive.ql.exec.UnionOperator"> 
                     <void property="childOperators"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object id="UnionOperator0" class="org.apache.hadoop.hive.ql.exec.UnionOperator"> 
+                       <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
                         <void property="childOperators"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                            <void property="childOperators"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                                <void property="conf"> 
-                                 <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                                  <void property="destTableId"> 
-                                   <int>1</int> 
-                                  </void> 
-                                  <void property="dirName"> 
-                                   <string>file:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-59-33_025_642210603550334429/-ext-10001</string> 
-                                  </void> 
-                                  <void property="numFiles"> 
-                                   <int>1</int> 
-                                  </void> 
-                                  <void property="statsAggPrefix"> 
-                                   <string>file:/data/users/sdong/www/open-source-hive1/build/ql/scratchdir/hive_2011-04-28_23-59-33_025_642210603550334429/-ext-10000/</string> 
-                                  </void> 
-                                  <void property="tableInfo"> 
-                                   <object idref="TableDesc0"/> 
-                                  </void> 
-                                  <void property="totalFiles"> 
-                                   <int>1</int> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void property="counterNames"> 
-                                 <object class="java.util.ArrayList"> 
-                                  <void method="add"> 
-                                   <string>CNTR_NAME_FS_691_NUM_INPUT_ROWS</string> 
-                                  </void> 
-                                  <void method="add"> 
-                                   <string>CNTR_NAME_FS_691_NUM_OUTPUT_ROWS</string> 
-                                  </void> 
-                                  <void method="add"> 
-                                   <string>CNTR_NAME_FS_691_TIME_TAKEN</string> 
-                                  </void> 
-                                  <void method="add"> 
-                                   <string>CNTR_NAME_FS_691_FATAL_ERROR</string> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void property="operatorId"> 
-                                 <string>FS_691</string> 
-                                </void> 
-                                <void property="parentOperators"> 
-                                 <object class="java.util.ArrayList"> 
-                                  <void method="add"> 
-                                   <object idref="SelectOperator1"/> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void property="schema"> 
-                                 <object idref="RowSchema0"/> 
-                                </void> 
-                               </object> 
+                           <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                            <void property="conf"> 
+                             <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                              <void property="destTableId"> 
+                               <int>1</int> 
                               </void> 
-                             </object> 
-                            </void> 
-                            <void property="columnExprMap"> 
-                             <object class="java.util.HashMap"> 
-                              <void method="put"> 
-                               <string>_col1</string> 
-                               <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                                <void property="column"> 
-                                 <string>_col1</string> 
-                                </void> 
-                                <void property="tabAlias"> 
-                                 <string>src</string> 
-                                </void> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo0"/> 
-                                </void> 
-                               </object> 
+                              <void property="dirName"> 
+                               <string>file:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-57_227_5273764780066863405/-ext-10001</string> 
                               </void> 
-                              <void method="put"> 
-                               <string>_col0</string> 
-                               <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                                <void property="column"> 
-                                 <string>_col0</string> 
-                                </void> 
-                                <void property="tabAlias"> 
-                                 <string>src</string> 
-                                </void> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo0"/> 
-                                </void> 
-                               </object> 
+                              <void property="numFiles"> 
+                               <int>1</int> 
                               </void> 
-                             </object> 
-                            </void> 
-                            <void property="conf"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                              <void property="colList"> 
-                               <object class="java.util.ArrayList"> 
-                                <void method="add"> 
-                                 <object idref="ExprNodeColumnDesc1"/> 
-                                </void> 
-                                <void method="add"> 
-                                 <object idref="ExprNodeColumnDesc0"/> 
-                                </void> 
-                               </object> 
+                              <void property="statsAggPrefix"> 
+                               <string>file:/home/amarsri/workspace/hive/build/ql/scratchdir/hive_2011-07-11_04-06-57_227_5273764780066863405/-ext-10000/</string> 
                               </void> 
-                              <void property="outputColumnNames"> 
-                               <object class="java.util.ArrayList"> 
-                                <void method="add"> 
-                                 <string>_col0</string> 
-                                </void> 
-                                <void method="add"> 
-                                 <string>_col1</string> 
-                                </void> 
-                               </object> 
+                              <void property="tableInfo"> 
+                               <object idref="TableDesc0"/> 
                               </void> 
-                              <void property="selectStar"> 
-                               <boolean>true</boolean> 
+                              <void property="totalFiles"> 
+                               <int>1</int> 
                               </void> 
                              </object> 
                             </void> 
                             <void property="counterNames"> 
                              <object class="java.util.ArrayList"> 
                               <void method="add"> 
-                               <string>CNTR_NAME_SEL_690_NUM_INPUT_ROWS</string> 
+                               <string>CNTR_NAME_FS_661_NUM_INPUT_ROWS</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_SEL_690_NUM_OUTPUT_ROWS</string> 
+                               <string>CNTR_NAME_FS_661_NUM_OUTPUT_ROWS</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_SEL_690_TIME_TAKEN</string> 
+                               <string>CNTR_NAME_FS_661_TIME_TAKEN</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_SEL_690_FATAL_ERROR</string> 
+                               <string>CNTR_NAME_FS_661_FATAL_ERROR</string> 
                               </void> 
                              </object> 
                             </void> 
                             <void property="operatorId"> 
-                             <string>SEL_690</string> 
+                             <string>FS_661</string> 
                             </void> 
                             <void property="parentOperators"> 
                              <object class="java.util.ArrayList"> 
                               <void method="add"> 
-                               <object idref="UnionOperator0"/> 
+                               <object idref="SelectOperator1"/> 
                               </void> 
                              </object> 
                             </void> 
                             <void property="schema"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                              <void property="signature"> 
-                               <object class="java.util.ArrayList"> 
-                                <void method="add"> 
-                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                  <void property="alias"> 
-                                   <string>key</string> 
-                                  </void> 
-                                  <void property="internalName"> 
-                                   <string>_col0</string> 
-                                  </void> 
-                                  <void property="tabAlias"> 
-                                   <string>src</string> 
-                                  </void> 
-                                  <void property="type"> 
-                                   <object idref="PrimitiveTypeInfo0"/> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void method="add"> 
-                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                  <void property="alias"> 
-                                   <string>value</string> 
-                                  </void> 
-                                  <void property="internalName"> 
-                                   <string>_col1</string> 
-                                  </void> 
-                                  <void property="tabAlias"> 
-                                   <string>src</string> 
-                                  </void> 
-                                  <void property="type"> 
-                                   <object idref="PrimitiveTypeInfo0"/> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
+                             <object idref="RowSchema0"/> 
+                            </void> 
+                           </object> 
+                          </void> 
+                         </object> 
+                        </void> 
+                        <void property="columnExprMap"> 
+                         <object class="java.util.HashMap"> 
+                          <void method="put"> 
+                           <string>_col1</string> 
+                           <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                            <void property="column"> 
+                             <string>_col1</string> 
+                            </void> 
+                            <void property="tabAlias"> 
+                             <string>src</string> 
+                            </void> 
+                            <void property="typeInfo"> 
+                             <object idref="PrimitiveTypeInfo0"/> 
+                            </void> 
+                           </object> 
+                          </void> 
+                          <void method="put"> 
+                           <string>_col0</string> 
+                           <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                            <void property="column"> 
+                             <string>_col0</string> 
+                            </void> 
+                            <void property="tabAlias"> 
+                             <string>src</string> 
+                            </void> 
+                            <void property="typeInfo"> 
+                             <object idref="PrimitiveTypeInfo0"/> 
                             </void> 
                            </object> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="conf"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.UnionDesc"/> 
+                         <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                          <void property="colList"> 
+                           <object class="java.util.ArrayList"> 
+                            <void method="add"> 
+                             <object idref="ExprNodeColumnDesc1"/> 
+                            </void> 
+                            <void method="add"> 
+                             <object idref="ExprNodeColumnDesc0"/> 
+                            </void> 
+                           </object> 
+                          </void> 
+                          <void property="outputColumnNames"> 
+                           <object class="java.util.ArrayList"> 
+                            <void method="add"> 
+                             <string>_col0</string> 
+                            </void> 
+                            <void method="add"> 
+                             <string>_col1</string> 
+                            </void> 
+                           </object> 
+                          </void> 
+                          <void property="selectStar"> 
+                           <boolean>true</boolean> 
+                          </void> 
+                         </object> 
                         </void> 
                         <void property="counterNames"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <string>CNTR_NAME_UNION_689_NUM_INPUT_ROWS</string> 
+                           <string>CNTR_NAME_SEL_660_NUM_INPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_UNION_689_NUM_OUTPUT_ROWS</string> 
+                           <string>CNTR_NAME_SEL_660_NUM_OUTPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_UNION_689_TIME_TAKEN</string> 
+                           <string>CNTR_NAME_SEL_660_TIME_TAKEN</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_UNION_689_FATAL_ERROR</string> 
+                           <string>CNTR_NAME_SEL_660_FATAL_ERROR</string> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="operatorId"> 
-                         <string>UNION_689</string> 
+                         <string>SEL_660</string> 
                         </void> 
                         <void property="parentOperators"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <object idref="SelectOperator0"/> 
+                           <object idref="UnionOperator0"/> 
+                          </void> 
+                         </object> 
+                        </void> 
+                        <void property="schema"> 
+                         <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                          <void property="signature"> 
+                           <object class="java.util.ArrayList"> 
+                            <void method="add"> 
+                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                              <void property="alias"> 
+                               <string>key</string> 
+                              </void> 
+                              <void property="internalName"> 
+                               <string>_col0</string> 
+                              </void> 
+                              <void property="tabAlias"> 
+                               <string>src</string> 
+                              </void> 
+                              <void property="type"> 
+                               <object idref="PrimitiveTypeInfo0"/> 
+                              </void> 
+                             </object> 
+                            </void> 
+                            <void method="add"> 
+                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                              <void property="alias"> 
+                               <string>value</string> 
+                              </void> 
+                              <void property="internalName"> 
+                               <string>_col1</string> 
+                              </void> 
+                              <void property="tabAlias"> 
+                               <string>src</string> 
+                              </void> 
+                              <void property="type"> 
+                               <object idref="PrimitiveTypeInfo0"/> 
+                              </void> 
+                             </object> 
+                            </void> 
+                           </object> 
+                          </void> 
+                         </object> 
+                        </void> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="conf"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.UnionDesc"/> 
+                    </void> 
+                    <void property="counterNames"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <string>CNTR_NAME_UNION_659_NUM_INPUT_ROWS</string> 
+                      </void> 
+                      <void method="add"> 
+                       <string>CNTR_NAME_UNION_659_NUM_OUTPUT_ROWS</string> 
+                      </void> 
+                      <void method="add"> 
+                       <string>CNTR_NAME_UNION_659_TIME_TAKEN</string> 
+                      </void> 
+                      <void method="add"> 
+                       <string>CNTR_NAME_UNION_659_FATAL_ERROR</string> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="operatorId"> 
+                     <string>UNION_659</string> 
+                    </void> 
+                    <void property="parentOperators"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object idref="SelectOperator0"/> 
+                      </void> 
+                      <void method="add"> 
+                       <object id="SelectOperator2" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+                        <void property="childOperators"> 
+                         <object class="java.util.ArrayList"> 
+                          <void method="add"> 
+                           <object idref="UnionOperator0"/> 
+                          </void> 
+                         </object> 
+                        </void> 
+                        <void property="columnExprMap"> 
+                         <object class="java.util.HashMap"> 
+                          <void method="put"> 
+                           <string>_col1</string> 
+                           <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                            <void property="column"> 
+                             <string>value</string> 
+                            </void> 
+                            <void property="tabAlias"> 
+                             <string>src</string> 
+                            </void> 
+                            <void property="typeInfo"> 
+                             <object idref="PrimitiveTypeInfo0"/> 
+                            </void> 
+                           </object> 
+                          </void> 
+                          <void method="put"> 
+                           <string>_col0</string> 
+                           <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                            <void property="column"> 
+                             <string>key</string> 
+                            </void> 
+                            <void property="tabAlias"> 
+                             <string>src</string> 
+                            </void> 
+                            <void property="typeInfo"> 
+                             <object idref="PrimitiveTypeInfo0"/> 
+                            </void> 
+                           </object> 
+                          </void> 
+                         </object> 
+                        </void> 
+                        <void property="conf"> 
+                         <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                          <void property="colList"> 
+                           <object class="java.util.ArrayList"> 
+                            <void method="add"> 
+                             <object idref="ExprNodeColumnDesc3"/> 
+                            </void> 
+                            <void method="add"> 
+                             <object idref="ExprNodeColumnDesc2"/> 
+                            </void> 
+                           </object> 
+                          </void> 
+                          <void property="outputColumnNames"> 
+                           <object class="java.util.ArrayList"> 
+                            <void method="add"> 
+                             <string>_col0</string> 
+                            </void> 
+                            <void method="add"> 
+                             <string>_col1</string> 
+                            </void> 
+                           </object> 
+                          </void> 
+                          <void property="selectStar"> 
+                           <boolean>true</boolean> 
+                          </void> 
+                         </object> 
+                        </void> 
+                        <void property="counterNames"> 
+                         <object class="java.util.ArrayList"> 
+                          <void method="add"> 
+                           <string>CNTR_NAME_SEL_658_NUM_INPUT_ROWS</string> 
+                          </void> 
+                          <void method="add"> 
+                           <string>CNTR_NAME_SEL_658_NUM_OUTPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <object id="SelectOperator2" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+                           <string>CNTR_NAME_SEL_658_TIME_TAKEN</string> 
+                          </void> 
+                          <void method="add"> 
+                           <string>CNTR_NAME_SEL_658_FATAL_ERROR</string> 
+                          </void> 
+                         </object> 
+                        </void> 
+                        <void property="operatorId"> 
+                         <string>SEL_658</string> 
+                        </void> 
+                        <void property="parentOperators"> 
+                         <object class="java.util.ArrayList"> 
+                          <void method="add"> 
+                           <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
                             <void property="childOperators"> 
                              <object class="java.util.ArrayList"> 
                               <void method="add"> 
-                               <object idref="UnionOperator0"/> 
+                               <object idref="SelectOperator2"/> 
                               </void> 
                              </object> 
                             </void> 
-                            <void property="columnExprMap"> 
-                             <object class="java.util.HashMap"> 
-                              <void method="put"> 
-                               <string>_col1</string> 
-                               <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                                <void property="column"> 
-                                 <string>value</string> 
-                                </void> 
-                                <void property="tabAlias"> 
-                                 <string>src</string> 
-                                </void> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo0"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void method="put"> 
-                               <string>_col0</string> 
-                               <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                                <void property="column"> 
-                                 <string>key</string> 
+                            <void property="conf"> 
+                             <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
+                              <void property="predicate"> 
+                               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                                <void property="childExprs"> 
+                                 <object class="java.util.ArrayList"> 
+                                  <void method="add"> 
+                                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                                    <void property="column"> 
+                                     <string>key</string> 
+                                    </void> 
+                                    <void property="tabAlias"> 
+                                     <string>src</string> 
+                                    </void> 
+                                    <void property="typeInfo"> 
+                                     <object idref="PrimitiveTypeInfo0"/> 
+                                    </void> 
+                                   </object> 
+                                  </void> 
+                                  <void method="add"> 
+                                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                                    <void property="typeInfo"> 
+                                     <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                                      <void property="typeName"> 
+                                       <string>int</string> 
+                                      </void> 
+                                     </object> 
+                                    </void> 
+                                    <void property="value"> 
+                                     <int>100</int> 
+                                    </void> 
+                                   </object> 
+                                  </void> 
+                                 </object> 
                                 </void> 
-                                <void property="tabAlias"> 
-                                 <string>src</string> 
+                                <void property="genericUDF"> 
+                                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan"/> 
                                 </void> 
                                 <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo0"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="conf"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                              <void property="colList"> 
-                               <object class="java.util.ArrayList"> 
-                                <void method="add"> 
-                                 <object idref="ExprNodeColumnDesc3"/> 
-                                </void> 
-                                <void method="add"> 
-                                 <object idref="ExprNodeColumnDesc2"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void property="outputColumnNames"> 
-                               <object class="java.util.ArrayList"> 
-                                <void method="add"> 
-                                 <string>_col0</string> 
-                                </void> 
-                                <void method="add"> 
-                                 <string>_col1</string> 
+                                 <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                                  <void property="typeName"> 
+                                   <string>boolean</string> 
+                                  </void> 
+                                 </object> 
                                 </void> 
                                </object> 
                               </void> 
-                              <void property="selectStar"> 
-                               <boolean>true</boolean> 
-                              </void> 
                              </object> 
                             </void> 
                             <void property="counterNames"> 
                              <object class="java.util.ArrayList"> 
                               <void method="add"> 
-                               <string>CNTR_NAME_SEL_688_NUM_INPUT_ROWS</string> 
+                               <string>CNTR_NAME_FIL_663_NUM_INPUT_ROWS</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_SEL_688_NUM_OUTPUT_ROWS</string> 
+                               <string>CNTR_NAME_FIL_663_NUM_OUTPUT_ROWS</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_SEL_688_TIME_TAKEN</string> 
+                               <string>CNTR_NAME_FIL_663_TIME_TAKEN</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_SEL_688_FATAL_ERROR</string> 
+                               <string>CNTR_NAME_FIL_663_FATAL_ERROR</string> 
                               </void> 
                              </object> 
                             </void> 
                             <void property="operatorId"> 
-                             <string>SEL_688</string> 
+                             <string>FIL_663</string> 
                             </void> 
                             <void property="parentOperators"> 
                              <object class="java.util.ArrayList"> 
                               <void method="add"> 
-                               <object id="FilterOperator2" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+                               <object id="TableScanOperator2" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                                 <void property="childOperators"> 
                                  <object class="java.util.ArrayList"> 
                                   <void method="add"> 
-                                   <object idref="SelectOperator2"/> 
+                                   <object idref="FilterOperator1"/> 
                                   </void> 
                                  </object> 
                                 </void> 
                                 <void property="conf"> 
-                                 <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-                                  <void property="predicate"> 
-                                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                                    <void property="childExprs"> 
-                                     <object class="java.util.ArrayList"> 
-                                      <void method="add"> 
-                                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                                        <void property="column"> 
-                                         <string>key</string> 
-                                        </void> 
-                                        <void property="tabAlias"> 
-                                         <string>src</string> 
-                                        </void> 
-                                        <void property="typeInfo"> 
-                                         <object idref="PrimitiveTypeInfo0"/> 
-                                        </void> 
-                                       </object> 
-                                      </void> 
-                                      <void method="add"> 
-                                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                                        <void property="typeInfo"> 
-                                         <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                                          <void property="typeName"> 
-                                           <string>int</string> 
-                                          </void> 
-                                         </object> 
-                                        </void> 
-                                        <void property="value"> 
-                                         <int>100</int> 
-                                        </void> 
-                                       </object> 
-                                      </void> 
-                                     </object> 
-                                    </void> 
-                                    <void property="genericUDF"> 
-                                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan"/> 
-                                    </void> 
-                                    <void property="typeInfo"> 
-                                     <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                                      <void property="typeName"> 
-                                       <string>boolean</string> 
-                                      </void> 
-                                     </object> 
-                                    </void> 
-                                   </object> 
+                                 <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
+                                  <void property="alias"> 
+                                   <string>src</string> 
+                                  </void> 
+                                  <void property="virtualCols"> 
+                                   <object class="java.util.ArrayList"/> 
                                   </void> 
                                  </object> 
                                 </void> 
                                 <void property="counterNames"> 
                                  <object class="java.util.ArrayList"> 
                                   <void method="add"> 
-                                   <string>CNTR_NAME_FIL_687_NUM_INPUT_ROWS</string> 
+                                   <string>CNTR_NAME_TS_656_NUM_INPUT_ROWS</string> 
                                   </void> 
                                   <void method="add"> 
-                                   <string>CNTR_NAME_FIL_687_NUM_OUTPUT_ROWS</string> 
+                                   <string>CNTR_NAME_TS_656_NUM_OUTPUT_ROWS</string> 
                                   </void> 
                                   <void method="add"> 
-                                   <string>CNTR_NAME_FIL_687_TIME_TAKEN</string> 
+                                   <string>CNTR_NAME_TS_656_TIME_TAKEN</string> 
                                   </void> 
                                   <void method="add"> 
-                                   <string>CNTR_NAME_FIL_687_FATAL_ERROR</string> 
+                                   <string>CNTR_NAME_TS_656_FATAL_ERROR</string> 
                                   </void> 
                                  </object> 
                                 </void> 
-                                <void property="operatorId"> 
-                                 <string>FIL_687</string> 
-                                </void> 
-                                <void property="parentOperators"> 
+                                <void property="neededColumnIDs"> 
                                  <object class="java.util.ArrayList"> 
                                   <void method="add"> 
-                                   <object id="FilterOperator3" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
-                                    <void property="childOperators"> 
-                                     <object class="java.util.ArrayList"> 
-                                      <void method="add"> 
-                                       <object idref="FilterOperator2"/> 
+                                   <int>0</int> 
+                                  </void> 
+                                  <void method="add"> 
+                                   <int>1</int> 
+                                  </void> 
+                                 </object> 
+                                </void> 
+                                <void property="operatorId"> 
+                                 <string>TS_656</string> 
+                                </void> 
+                                <void property="schema"> 
+                                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                                  <void property="signature"> 
+                                   <object id="ArrayList1" class="java.util.ArrayList"> 
+                                    <void method="add"> 
+                                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                      <void property="internalName"> 
+                                       <string>key</string> 
                                       </void> 
-                                     </object> 
-                                    </void> 
-                                    <void property="conf"> 
-                                     <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-                                      <void property="predicate"> 
-                                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                                        <void property="childExprs"> 
-                                         <object class="java.util.ArrayList"> 
-                                          <void method="add"> 
-                                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                                            <void property="column"> 
-                                             <string>key</string> 
-                                            </void> 
-                                            <void property="tabAlias"> 
-                                             <string>src</string> 
-                                            </void> 
-                                            <void property="typeInfo"> 
-                                             <object idref="PrimitiveTypeInfo0"/> 
-                                            </void> 
-                                           </object> 
-                                          </void> 
-                                          <void method="add"> 
-                                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                                            <void property="typeInfo"> 
-                                             <object idref="PrimitiveTypeInfo1"/> 
-                                            </void> 
-                                            <void property="value"> 
-                                             <int>100</int> 
-                                            </void> 
-                                           </object> 
-                                          </void> 
-                                         </object> 
-                                        </void> 
-                                        <void property="genericUDF"> 
-                                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan"/> 
-                                        </void> 
-                                        <void property="typeInfo"> 
-                                         <object idref="PrimitiveTypeInfo2"/> 
-                                        </void> 
-                                       </object> 
+                                      <void property="tabAlias"> 
+                                       <string>src</string> 
+                                      </void> 
+                                      <void property="type"> 
+                                       <object idref="PrimitiveTypeInfo0"/> 
                                       </void> 
                                      </object> 
                                     </void> 
-                                    <void property="counterNames"> 
-                                     <object class="java.util.ArrayList"> 
-                                      <void method="add"> 
-                                       <string>CNTR_NAME_FIL_693_NUM_INPUT_ROWS</string> 
-                                      </void> 
-                                      <void method="add"> 
-                                       <string>CNTR_NAME_FIL_693_NUM_OUTPUT_ROWS</string> 
+                                    <void method="add"> 
+                                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                      <void property="internalName"> 
+                                       <string>value</string> 
                                       </void> 
-                                      <void method="add"> 
-                                       <string>CNTR_NAME_FIL_693_TIME_TAKEN</string> 
+                                      <void property="tabAlias"> 
+                                       <string>src</string> 
                                       </void> 
-                                      <void method="add"> 
-                                       <string>CNTR_NAME_FIL_693_FATAL_ERROR</string> 
+                                      <void property="type"> 
+                                       <object idref="PrimitiveTypeInfo0"/> 
                                       </void> 
                                      </object> 
                                     </void> 
-                                    <void property="operatorId"> 
-                                     <string>FIL_693</string> 
-                                    </void> 
-                                    <void property="parentOperators"> 
-                                     <object class="java.util.ArrayList"> 
-                                      <void method="add"> 
-                                       <object id="TableScanOperator2" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
-                                        <void property="childOperators"> 
-                                         <object class="java.util.ArrayList"> 
-                                          <void method="add"> 
-                                           <object idref="FilterOperator3"/> 
-                                          </void> 
-                                         </object> 
-                                        </void> 
-                                        <void property="conf"> 
-                                         <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
-                                          <void property="alias"> 
-                                           <string>src</string> 
-                                          </void> 
-                                          <void property="virtualCols"> 
-                                           <object class="java.util.ArrayList"/> 
-                                          </void> 
-                                         </object> 
-                                        </void> 
-                                        <void property="counterNames"> 
-                                         <object class="java.util.ArrayList"> 
-                                          <void method="add"> 
-                                           <string>CNTR_NAME_TS_686_NUM_INPUT_ROWS</string> 
-                                          </void> 
-                                          <void method="add"> 
-                                           <string>CNTR_NAME_TS_686_NUM_OUTPUT_ROWS</string> 
-                                          </void> 
-                                          <void method="add"> 
-                                           <string>CNTR_NAME_TS_686_TIME_TAKEN</string> 
-                                          </void> 
-                                          <void method="add"> 
-                                           <string>CNTR_NAME_TS_686_FATAL_ERROR</string> 
-                                          </void> 
-                                         </object> 
-                                        </void> 
-                                        <void property="neededColumnIDs"> 
-                                         <object class="java.util.ArrayList"> 
-                                          <void method="add"> 
-                                           <int>0</int> 
-                                          </void> 
-                                          <void method="add"> 
-                                           <int>1</int> 
-                                          </void> 
-                                         </object> 
-                                        </void> 
-                                        <void property="operatorId"> 
-                                         <string>TS_686</string> 
-                                        </void> 
-                                        <void property="schema"> 
-                                         <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                                          <void property="signature"> 
-                                           <object id="ArrayList1" class="java.util.ArrayList"> 
-                                            <void method="add"> 
-                                             <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                              <void property="internalName"> 
-                                               <string>key</string> 
-                                              </void> 
-                                              <void property="tabAlias"> 
-                                               <string>src</string> 
-                                              </void> 
-                                              <void property="type"> 
-                                               <object idref="PrimitiveTypeInfo0"/> 
-                                              </void> 
-                                             </object> 
-                                            </void> 
-                                            <void method="add"> 
-                                             <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                              <void property="internalName"> 
-                                               <string>value</string> 
-                                              </void> 
-                                              <void property="tabAlias"> 
-                                               <string>src</string> 
-                                              </void> 
-                                              <void property="type"> 
-                                               <object idref="PrimitiveTypeInfo0"/> 
-                                              </void> 
-                                             </object> 
-                                            </void> 
-                                            <void method="add"> 
-                                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                              <void property="hiddenVirtualCol"> 
-                                               <boolean>true</boolean> 
-                                              </void> 
-                                              <void property="internalName"> 
-                                               <string>BLOCK__OFFSET__INSIDE__FILE</string> 
-                                              </void> 
-                                              <void property="tabAlias"> 
-                                               <string>src</string> 
-                                              </void> 
-                                              <void property="type"> 
-                                               <object id="PrimitiveTypeInfo3" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                                                <void property="typeName"> 
-                                                 <string>bigint</string> 
-                                                </void> 
-                                               </object> 
-                                              </void> 
-                                             </object> 
-                                            </void> 
-                                            <void method="add"> 
-                                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                              <void property="hiddenVirtualCol"> 
-                                               <boolean>true</boolean> 
-                                              </void> 
-                                              <void property="internalName"> 
-                                               <string>INPUT__FILE__NAME</string> 
-                                              </void> 
-                                              <void property="tabAlias"> 
-                                               <string>src</string> 
-                                              </void> 
-                                              <void property="type"> 
-                                               <object idref="PrimitiveTypeInfo0"/> 
-                                              </void> 
-                                             </object> 
-                                            </void> 
-                                           </object> 
-                                          </void> 
-                                         </object> 
+                                    <void method="add"> 
+                                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                      <void property="hiddenVirtualCol"> 
+                                       <boolean>true</boolean> 
+                                      </void> 
+                                      <void property="internalName"> 
+                                       <string>BLOCK__OFFSET__INSIDE__FILE</string> 
+                                      </void> 
+                                      <void property="tabAlias"> 
+                                       <string>src</string> 
+                                      </void> 
+                                      <void property="type"> 
+                                       <object id="PrimitiveTypeInfo3" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                                        <void property="typeName"> 
+                                         <string>bigint</string> 
                                         </void> 
                                        </object> 
                                       </void> 
                                      </object> 
                                     </void> 
-                                    <void property="schema"> 
-                                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                                      <void property="signature"> 
-                                       <object idref="ArrayList1"/> 
+                                    <void method="add"> 
+                                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                      <void property="hiddenVirtualCol"> 
+                                       <boolean>true</boolean> 
+                                      </void> 
+                                      <void property="internalName"> 
+                                       <string>INPUT__FILE__NAME</string> 
+                                      </void> 
+                                      <void property="tabAlias"> 
+                                       <string>src</string> 
+                                      </void> 
+                                      <void property="type"> 
+                                       <object idref="PrimitiveTypeInfo0"/> 
                                       </void> 
                                      </object> 
                                     </void> 
@@ -1241,20 +1151,6 @@
                                   </void> 
                                  </object> 
                                 </void> 
-                                <void property="schema"> 
-                                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                                  <void property="signature"> 
-                                   <object class="java.util.ArrayList"> 
-                                    <void method="add"> 
-                                     <object idref="ColumnInfo0"/> 
-                                    </void> 
-                                    <void method="add"> 
-                                     <object idref="ColumnInfo1"/> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                 </object> 
-                                </void> 
                                </object> 
                               </void> 
                              </object> 
@@ -1262,34 +1158,7 @@
                             <void property="schema"> 
                              <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
                               <void property="signature"> 
-                               <object class="java.util.ArrayList"> 
-                                <void method="add"> 
-                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                  <void property="internalName"> 
-                                   <string>_col0</string> 
-                                  </void> 
-                                  <void property="tabAlias"> 
-                                   <string>src</string> 
-                                  </void> 
-                                  <void property="type"> 
-                                   <object idref="PrimitiveTypeInfo0"/> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void method="add"> 
-                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                  <void property="internalName"> 
-                                   <string>_col1</string> 
-                                  </void> 
-                                  <void property="tabAlias"> 
-                                   <string>src</string> 
-                                  </void> 
-                                  <void property="type"> 
-                                   <object idref="PrimitiveTypeInfo0"/> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                               </object> 
+                               <object idref="ArrayList1"/> 
                               </void> 
                              </object> 
                             </void> 
@@ -1302,7 +1171,7 @@
                           <void property="signature"> 
                            <object class="java.util.ArrayList"> 
                             <void method="add"> 
-                             <object id="ColumnInfo2" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                               <void property="internalName"> 
                                <string>_col0</string> 
                               </void> 
@@ -1315,7 +1184,7 @@
                              </object> 
                             </void> 
                             <void method="add"> 
-                             <object id="ColumnInfo3" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                               <void property="internalName"> 
                                <string>_col1</string> 
                               </void> 
@@ -1335,142 +1204,95 @@
                       </void> 
                      </object> 
                     </void> 
-                    <void property="columnExprMap"> 
-                     <object class="java.util.HashMap"> 
-                      <void method="put"> 
-                       <string>_col1</string> 
-                       <object id="ExprNodeColumnDesc4" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>value</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="put"> 
-                       <string>_col0</string> 
-                       <object id="ExprNodeColumnDesc5" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                      <void property="colList"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc5"/> 
-                        </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc4"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="outputColumnNames"> 
+                    <void property="schema"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                      <void property="signature"> 
                        <object class="java.util.ArrayList"> 
                         <void method="add"> 
-                         <string>_col0</string> 
+                         <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                          <void property="internalName"> 
+                           <string>_col0</string> 
+                          </void> 
+                          <void property="tabAlias"> 
+                           <string>src</string> 
+                          </void> 
+                          <void property="type"> 
+                           <object idref="PrimitiveTypeInfo0"/> 
+                          </void> 
+                         </object> 
                         </void> 
                         <void method="add"> 
-                         <string>_col1</string> 
+                         <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                          <void property="internalName"> 
+                           <string>_col1</string> 
+                          </void> 
+                          <void property="tabAlias"> 
+                           <string>src</string> 
+                          </void> 
+                          <void property="type"> 
+                           <object idref="PrimitiveTypeInfo0"/> 
+                          </void> 
+                         </object> 
                         </void> 
                        </object> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="counterNames"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <string>CNTR_NAME_SEL_685_NUM_INPUT_ROWS</string> 
-                      </void> 
-                      <void method="add"> 
-                       <string>CNTR_NAME_SEL_685_NUM_OUTPUT_ROWS</string> 
-                      </void> 
-                      <void method="add"> 
-                       <string>CNTR_NAME_SEL_685_TIME_TAKEN</string> 
-                      </void> 
-                      <void method="add"> 
-                       <string>CNTR_NAME_SEL_685_FATAL_ERROR</string> 
-                      </void> 
-                     </object> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="columnExprMap"> 
+                 <object class="java.util.HashMap"> 
+                  <void method="put"> 
+                   <string>_col1</string> 
+                   <object id="ExprNodeColumnDesc4" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>value</string> 
                     </void> 
-                    <void property="operatorId"> 
-                     <string>SEL_685</string> 
+                    <void property="tabAlias"> 
+                     <string>src</string> 
                     </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="FilterOperator1"/> 
-                      </void> 
-                     </object> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                    <void property="schema"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                      <void property="signature"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object idref="ColumnInfo2"/> 
-                        </void> 
-                        <void method="add"> 
-                         <object idref="ColumnInfo3"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                   </object> 
+                  </void> 
+                  <void method="put"> 
+                   <string>_col0</string> 
+                   <object id="ExprNodeColumnDesc5" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>key</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string>src</string> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-                  <void property="predicate"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="childExprs"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>100</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                  <void property="colList"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object idref="ExprNodeColumnDesc5"/> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
+                    <void method="add"> 
+                     <object idref="ExprNodeColumnDesc4"/> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                   </object> 
+                  </void> 
+                  <void property="outputColumnNames"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <string>_col0</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col1</string> 
                     </void> 
                    </object> 
                   </void> 
@@ -1479,21 +1301,21 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_684_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_655_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_684_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_SEL_655_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_684_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_SEL_655_TIME_TAKEN</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_684_FATAL_ERROR</string> 
+                   <string>CNTR_NAME_SEL_655_FATAL_ERROR</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>FIL_684</string> 
+                 <string>SEL_655</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -1507,30 +1329,10 @@
                   <void property="signature"> 
                    <object class="java.util.ArrayList"> 
                     <void method="add"> 
-                     <object id="ColumnInfo4" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>key</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>src</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                     </object> 
+                     <object idref="ColumnInfo0"/> 
                     </void> 
                     <void method="add"> 
-                     <object id="ColumnInfo5" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>value</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>src</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                     </object> 
+                     <object idref="ColumnInfo1"/> 
                     </void> 
                    </object> 
                   </void> 
@@ -1584,21 +1386,21 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_692_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_662_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_692_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_662_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_692_TIME_TAKEN</string> 
+               <string>CNTR_NAME_FIL_662_TIME_TAKEN</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_692_FATAL_ERROR</string> 
+               <string>CNTR_NAME_FIL_662_FATAL_ERROR</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>FIL_692</string> 
+             <string>FIL_662</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -1612,10 +1414,30 @@
               <void property="signature"> 
                <object id="ArrayList2" class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <object idref="ColumnInfo4"/> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>key</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>src</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
                 </void> 
                 <void method="add"> 
-                 <object idref="ColumnInfo5"/> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>value</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>src</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
                 </void> 
                 <void method="add"> 
                  <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
@@ -1670,16 +1492,16 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_683_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_653_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_683_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_653_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_683_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_653_TIME_TAKEN</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_683_FATAL_ERROR</string> 
+           <string>CNTR_NAME_TS_653_FATAL_ERROR</string> 
           </void> 
          </object> 
         </void> 
@@ -1694,7 +1516,7 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_683</string> 
+         <string>TS_653</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -1717,7 +1539,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src</string> 
+       <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>null-subquery1:unioninput-subquery1:src</string> 
@@ -1732,7 +1554,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src</string> 
+       <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src</string> 
        <object class="org.apache.hadoop.hive.ql.plan.PartitionDesc"> 
         <void property="baseFileName"> 
          <string>src</string> 
@@ -1789,11 +1611,11 @@
           </void> 
           <void method="put"> 
            <string>location</string> 
-           <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src</string> 
+           <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src</string> 
           </void> 
           <void method="put"> 
            <string>transient_lastDdlTime</string> 
-           <string>1304060370</string> 
+           <string>1310382416</string> 
           </void> 
          </object> 
         </void> 
@@ -1851,11 +1673,11 @@
             </void> 
             <void method="put"> 
              <string>location</string> 
-             <string>pfile:/data/users/sdong/www/open-source-hive1/build/ql/test/data/warehouse/src</string> 
+             <string>pfile:/home/amarsri/workspace/hive/build/ql/test/data/warehouse/src</string> 
             </void> 
             <void method="put"> 
              <string>transient_lastDdlTime</string> 
-             <string>1304060370</string> 
+             <string>1310382416</string> 
             </void> 
            </object> 
           </void> 
