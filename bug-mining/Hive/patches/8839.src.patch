diff --git a/itests/src/test/resources/testconfiguration.properties b/itests/src/test/resources/testconfiguration.properties
index ceea0e477a..2f56c408fb 100644
--- a/itests/src/test/resources/testconfiguration.properties
+++ b/itests/src/test/resources/testconfiguration.properties
@@ -306,6 +306,7 @@ mr.query.files=\
   udaf_percentile_approx_23.q,\
   udf_context_aware.q,\
   udf_count.q,\
+  udf_dayofweek_with_tz.q,\
   udf_using.q,\
   uniquejoin.q,\
   windowing_windowspec.q
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/vector/expressions/VectorUDFDayOfWeekString.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/vector/expressions/VectorUDFDayOfWeekString.java
index 7f2fba448b..0e4ba86ac1 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/vector/expressions/VectorUDFDayOfWeekString.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/vector/expressions/VectorUDFDayOfWeekString.java
@@ -20,25 +20,18 @@
 
 import java.nio.charset.CharacterCodingException;
 import java.text.ParseException;
-import java.text.SimpleDateFormat;
-import java.util.Calendar;
-import java.util.Date;
-import java.util.TimeZone;
 
 import org.apache.hadoop.io.Text;
+import org.apache.hadoop.hive.common.type.Date;
+import org.apache.hive.common.util.DateParser;
 
 /**
  * Expression to get day of week.
  * Extends {@link VectorUDFTimestampFieldString}
  */
 public final class VectorUDFDayOfWeekString extends VectorUDFTimestampFieldString {
-
   private static final long serialVersionUID = 1L;
 
-  private transient final SimpleDateFormat format = new SimpleDateFormat("yyyy-MM-dd");
-  private transient final Calendar calendar = Calendar.getInstance(
-      TimeZone.getTimeZone("UTC"));
-
   public VectorUDFDayOfWeekString(int colNum, int outputColumnNum) {
     super(colNum, outputColumnNum, -1, -1);
   }
@@ -49,15 +42,16 @@ public VectorUDFDayOfWeekString() {
 
   @Override
   protected long getField(byte[] bytes, int start, int length) throws ParseException {
-    Date date = null;
     try {
       String decoded = Text.decode(bytes, start, length);
-      date = format.parse(decoded);
+      Date date = DateParser.parseDate(decoded);
+      if (date == null) {
+        throw new ParseException("Unable to parse date string", 0);
+      }
+      return date.getDayOfWeek();
     } catch (CharacterCodingException e) {
       throw new ParseException(e.getMessage(), 0);
     }
-    calendar.setTime(date);
-    return calendar.get(Calendar.DAY_OF_WEEK);
   }
 
 }
diff --git a/ql/src/test/queries/clientpositive/udf_dayofweek_with_tz.q b/ql/src/test/queries/clientpositive/udf_dayofweek_with_tz.q
new file mode 100644
index 0000000000..f5a301b0f8
--- /dev/null
+++ b/ql/src/test/queries/clientpositive/udf_dayofweek_with_tz.q
@@ -0,0 +1,31 @@
+--! qt:timezone:Asia/Shanghai
+
+CREATE EXTERNAL TABLE dayOfWeek_test(
+`fund_code` string,
+`test_date` string
+);
+
+INSERT INTO dayOfWeek_test(fund_code,test_date)
+values('SEC016210079','2023-04-13');
+
+set hive.vectorized.execution.enabled=false;
+
+SELECT fund_code,
+ test_date,
+ dayofweek(test_date) AS SR,
+ CASE
+     WHEN dayofweek(test_date) = 1 THEN 7
+     ELSE dayofweek(test_date) - 1
+ END AS week_day
+FROM dayOfWeek_test; 
+
+set hive.vectorized.execution.enabled=true;
+
+SELECT fund_code,
+ test_date,
+ dayofweek(test_date) AS SR,
+ CASE
+     WHEN dayofweek(test_date) = 1 THEN 7
+     ELSE dayofweek(test_date) - 1
+ END AS week_day
+FROM dayOfWeek_test; 
\ No newline at end of file
diff --git a/ql/src/test/results/clientpositive/udf_dayofweek_with_tz.q.out b/ql/src/test/results/clientpositive/udf_dayofweek_with_tz.q.out
new file mode 100644
index 0000000000..1811cd67dc
--- /dev/null
+++ b/ql/src/test/results/clientpositive/udf_dayofweek_with_tz.q.out
@@ -0,0 +1,72 @@
+PREHOOK: query: CREATE EXTERNAL TABLE dayOfWeek_test(
+`fund_code` string,
+`test_date` string
+)
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@dayOfWeek_test
+POSTHOOK: query: CREATE EXTERNAL TABLE dayOfWeek_test(
+`fund_code` string,
+`test_date` string
+)
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@dayOfWeek_test
+PREHOOK: query: INSERT INTO dayOfWeek_test(fund_code,test_date)
+values('SEC016210079','2023-04-13')
+PREHOOK: type: QUERY
+PREHOOK: Input: _dummy_database@_dummy_table
+PREHOOK: Output: default@dayofweek_test
+POSTHOOK: query: INSERT INTO dayOfWeek_test(fund_code,test_date)
+values('SEC016210079','2023-04-13')
+POSTHOOK: type: QUERY
+POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@dayofweek_test
+POSTHOOK: Lineage: dayofweek_test.fund_code SCRIPT []
+POSTHOOK: Lineage: dayofweek_test.test_date SCRIPT []
+PREHOOK: query: SELECT fund_code,
+ test_date,
+ dayofweek(test_date) AS SR,
+ CASE
+     WHEN dayofweek(test_date) = 1 THEN 7
+     ELSE dayofweek(test_date) - 1
+ END AS week_day
+FROM dayOfWeek_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@dayofweek_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT fund_code,
+ test_date,
+ dayofweek(test_date) AS SR,
+ CASE
+     WHEN dayofweek(test_date) = 1 THEN 7
+     ELSE dayofweek(test_date) - 1
+ END AS week_day
+FROM dayOfWeek_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@dayofweek_test
+#### A masked pattern was here ####
+SEC016210079	2023-04-13	5	4
+PREHOOK: query: SELECT fund_code,
+ test_date,
+ dayofweek(test_date) AS SR,
+ CASE
+     WHEN dayofweek(test_date) = 1 THEN 7
+     ELSE dayofweek(test_date) - 1
+ END AS week_day
+FROM dayOfWeek_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@dayofweek_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT fund_code,
+ test_date,
+ dayofweek(test_date) AS SR,
+ CASE
+     WHEN dayofweek(test_date) = 1 THEN 7
+     ELSE dayofweek(test_date) - 1
+ END AS week_day
+FROM dayOfWeek_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@dayofweek_test
+#### A masked pattern was here ####
+SEC016210079	2023-04-13	5	4
