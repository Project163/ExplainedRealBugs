diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java
index d8698dab07..ceba28dec0 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java
@@ -55,6 +55,8 @@
 import org.apache.hadoop.mapred.OutputCollector;
 import org.apache.hadoop.util.hash.MurmurHash;
 
+import static org.apache.hadoop.hive.ql.plan.ReduceSinkDesc.ReducerTraits.UNIFORM;
+
 /**
  * Reduce Sink Operator sends output to the reduce stage.
  **/
@@ -110,7 +112,7 @@ public class ReduceSinkOperator extends TerminalOperator<ReduceSinkDesc>
   protected transient int numDistributionKeys;
   protected transient int numDistinctExprs;
   protected transient String[] inputAliases;  // input aliases of this RS for join (used for PPD)
-  protected transient boolean autoParallel = false;
+  protected transient boolean useUniformHash = false;
   // picks topN K:V pairs from input.
   protected transient TopNHash reducerHash = new TopNHash();
   protected transient HiveKey keyWritable = new HiveKey();
@@ -217,7 +219,7 @@ protected void initializeOp(Configuration hconf) throws HiveException {
         reducerHash.initialize(limit, memUsage, conf.isMapGroupBy(), this);
       }
 
-      autoParallel = conf.isAutoParallel();
+      useUniformHash = conf.getReducerTraits().contains(UNIFORM);
 
       firstRow = true;
       initializeChildren(hconf);
@@ -339,7 +341,7 @@ public void processOp(Object row, int tag) throws HiveException {
       final int hashCode;
 
       // distKeyLength doesn't include tag, but includes buckNum in cachedKeys[0]
-      if (autoParallel && partitionEval.length > 0) {
+      if (useUniformHash && partitionEval.length > 0) {
         hashCode = computeMurmurHash(firstKey);
       } else {
         hashCode = computeHashCode(row);
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/ReduceSinkMapJoinProc.java b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/ReduceSinkMapJoinProc.java
index 65fb66ecfd..ed6f713207 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/ReduceSinkMapJoinProc.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/ReduceSinkMapJoinProc.java
@@ -19,6 +19,7 @@
 package org.apache.hadoop.hive.ql.optimizer;
 
 import java.util.ArrayList;
+import java.util.EnumSet;
 import java.util.HashMap;
 import java.util.List;
 import java.util.Map;
@@ -55,6 +56,8 @@
 import org.apache.hadoop.hive.ql.plan.TezWork.VertexType;
 import org.apache.hadoop.hive.ql.stats.StatsUtils;
 
+import static org.apache.hadoop.hive.ql.plan.ReduceSinkDesc.ReducerTraits.FIXED;
+
 public class ReduceSinkMapJoinProc implements NodeProcessor {
 
   protected transient Log LOG = LogFactory.getLog(this.getClass().getName());
@@ -167,7 +170,7 @@ public Object process(Node nd, Stack<Node> stack, NodeProcessorCtx procContext,
     if (joinConf.isBucketMapJoin()) {
 
       // disable auto parallelism for bucket map joins
-      parentRS.getConf().setAutoParallel(false);
+      parentRS.getConf().setReducerTraits(EnumSet.of(FIXED));
 
       numBuckets = (Integer) joinConf.getBigTableBucketNumMapping().values().toArray()[0];
       if (joinConf.getCustomBucketMapJoin()) {
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/SetReducerParallelism.java b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/SetReducerParallelism.java
index 625af85abc..fef2c296b3 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/SetReducerParallelism.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/SetReducerParallelism.java
@@ -18,6 +18,8 @@
 
 package org.apache.hadoop.hive.ql.optimizer;
 
+import java.util.Collection;
+import java.util.EnumSet;
 import java.util.Stack;
 
 import org.apache.commons.logging.Log;
@@ -31,9 +33,13 @@
 import org.apache.hadoop.hive.ql.lib.NodeProcessorCtx;
 import org.apache.hadoop.hive.ql.parse.OptimizeTezProcContext;
 import org.apache.hadoop.hive.ql.parse.SemanticException;
+import org.apache.hadoop.hive.ql.plan.ExprNodeDesc.ExprNodeDescEqualityWrapper;
 import org.apache.hadoop.hive.ql.plan.OperatorDesc;
 import org.apache.hadoop.hive.ql.plan.ReduceSinkDesc;
 
+import static org.apache.hadoop.hive.ql.plan.ReduceSinkDesc.ReducerTraits.AUTOPARALLEL;
+import static org.apache.hadoop.hive.ql.plan.ReduceSinkDesc.ReducerTraits.UNIFORM;
+
 /**
  * SetReducerParallelism determines how many reducers should
  * be run for a given reduce sink.
@@ -86,7 +92,14 @@ public Object process(Node nd, Stack<Node> stack,
             maxReducers, false);
         LOG.info("Set parallelism for reduce sink "+sink+" to: "+numReducers);
         desc.setNumReducers(numReducers);
-        desc.setAutoParallel(true);
+
+        final Collection<ExprNodeDescEqualityWrapper> keyCols = ExprNodeDescEqualityWrapper.transform(desc.getKeyCols());
+        final Collection<ExprNodeDescEqualityWrapper> partCols = ExprNodeDescEqualityWrapper.transform(desc.getPartitionCols());
+        if (keyCols != null && keyCols.equals(partCols)) {
+          desc.setReducerTraits(EnumSet.of(UNIFORM, AUTOPARALLEL));
+        } else {
+          desc.setReducerTraits(EnumSet.of(AUTOPARALLEL));
+        }
       }
     } else {
       LOG.info("Number of reducers determined to be: "+desc.getNumReducers());
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/GenTezUtils.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/GenTezUtils.java
index f2723ec267..627ca7b100 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/GenTezUtils.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/GenTezUtils.java
@@ -57,6 +57,8 @@
 import com.google.common.collect.BiMap;
 import com.google.common.collect.HashBiMap;
 
+import static org.apache.hadoop.hive.ql.plan.ReduceSinkDesc.ReducerTraits.AUTOPARALLEL;
+
 /**
  * GenTezUtils is a collection of shared helper methods to produce
  * TezWork
@@ -117,7 +119,7 @@ public ReduceWork createReduceWork(GenTezProcContext context, Operator<?> root,
 
     reduceWork.setNumReduceTasks(reduceSink.getConf().getNumReducers());
 
-    if (isAutoReduceParallelism && reduceSink.getConf().isAutoParallel()) {
+    if (isAutoReduceParallelism && reduceSink.getConf().getReducerTraits().contains(AUTOPARALLEL)) {
       reduceWork.setAutoReduceParallelism(true);
 
       // configured limit for reducers
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/plan/ExprNodeDesc.java b/ql/src/java/org/apache/hadoop/hive/ql/plan/ExprNodeDesc.java
index 82d86eed22..0fe9eda6e7 100755
--- a/ql/src/java/org/apache/hadoop/hive/ql/plan/ExprNodeDesc.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/plan/ExprNodeDesc.java
@@ -19,6 +19,8 @@
 package org.apache.hadoop.hive.ql.plan;
 
 import java.io.Serializable;
+import java.util.ArrayList;
+import java.util.Collection;
 import java.util.List;
 
 import org.apache.hadoop.hive.ql.lib.Node;
@@ -125,5 +127,19 @@ public boolean equals(Object other) {
     public int hashCode() {
       return exprNodeDesc == null ? 0 : exprNodeDesc.hashCode();
     }
+
+    /* helper function to allow Set()/Collection() operations with ExprNodeDesc */
+    public static Collection<ExprNodeDescEqualityWrapper> transform(
+        Collection<ExprNodeDesc> descs) {
+      if (descs == null) {
+        return null;
+      }
+      final Collection<ExprNodeDescEqualityWrapper> wrapped = new ArrayList<ExprNodeDesc.ExprNodeDescEqualityWrapper>(
+          descs.size());
+      for (ExprNodeDesc desc : descs) {
+        wrapped.add(new ExprNodeDescEqualityWrapper(desc));
+      }
+      return wrapped;
+    }
   }
 }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/plan/ReduceSinkDesc.java b/ql/src/java/org/apache/hadoop/hive/ql/plan/ReduceSinkDesc.java
index 2c4175aa29..57beb693ad 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/plan/ReduceSinkDesc.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/plan/ReduceSinkDesc.java
@@ -19,6 +19,7 @@
 package org.apache.hadoop.hive.ql.plan;
 
 import java.util.ArrayList;
+import java.util.EnumSet;
 import java.util.List;
 
 import org.apache.commons.logging.Log;
@@ -90,7 +91,22 @@ public class ReduceSinkDesc extends AbstractOperatorDesc {
   //flag used to control how TopN handled for PTF/Windowing partitions.
   private boolean isPTFReduceSink = false; 
   private boolean skipTag; // Skip writing tags when feeding into mapjoin hashtable
-  private Boolean autoParallel = null; // Is reducer auto-parallelism enabled, disabled or unset
+
+  public static enum ReducerTraits {
+    UNSET(0), // unset
+    FIXED(1), // distribution of keys is fixed
+    AUTOPARALLEL(2), // can change reducer count (ORDER BY can concat adjacent buckets)
+    UNIFORM(3); // can redistribute into buckets uniformly (GROUP BY can)
+
+    private final int trait;
+
+    private ReducerTraits(int trait) {
+      this.trait = trait;
+    }
+  };
+
+  // Is reducer auto-parallelism unset (FIXED, UNIFORM, PARALLEL)
+  private EnumSet<ReducerTraits> reduceTraits = EnumSet.of(ReducerTraits.UNSET);
 
   // Write type, since this needs to calculate buckets differently for updates and deletes
   private AcidUtils.Operation writeType;
@@ -148,7 +164,7 @@ public Object clone() {
     desc.setBucketCols(bucketCols);
     desc.setStatistics(this.getStatistics());
     desc.setSkipTag(skipTag);
-    desc.autoParallel = autoParallel;
+    desc.reduceTraits = reduceTraits.clone();
     return desc;
   }
 
@@ -361,16 +377,30 @@ public boolean getSkipTag() {
 
   @Explain(displayName = "auto parallelism", normalExplain = false)
   public final boolean isAutoParallel() {
-    return (autoParallel != null) && autoParallel;
+    return (this.reduceTraits.contains(ReducerTraits.AUTOPARALLEL));
+  }
+
+  public final EnumSet<ReducerTraits> getReducerTraits() {
+    return this.reduceTraits;
   }
 
-  public final void setAutoParallel(final boolean autoParallel) {
+  public final void setReducerTraits(EnumSet<ReducerTraits> traits) {
     // we don't allow turning on auto parallel once it has been
     // explicitly turned off. That is to avoid scenarios where
     // auto parallelism could break assumptions about number of
     // reducers or hash function.
-    if (this.autoParallel == null || this.autoParallel == true) {
-      this.autoParallel = autoParallel;
+
+    boolean wasUnset = this.reduceTraits.remove(ReducerTraits.UNSET);
+    
+    if (this.reduceTraits.contains(ReducerTraits.FIXED)) {
+      return;
+    } else if (traits.contains(ReducerTraits.FIXED)) {
+      this.reduceTraits.removeAll(EnumSet.of(
+          ReducerTraits.AUTOPARALLEL,
+          ReducerTraits.UNIFORM));
+      this.reduceTraits.addAll(traits);
+    } else {
+      this.reduceTraits.addAll(traits);
     }
   }
 
diff --git a/ql/src/test/results/compiler/plan/groupby1.q.xml b/ql/src/test/results/compiler/plan/groupby1.q.xml
index 4f2e1328eb..3b7e69b335 100755
--- a/ql/src/test/results/compiler/plan/groupby1.q.xml
+++ b/ql/src/test/results/compiler/plan/groupby1.q.xml
@@ -429,6 +429,14 @@
                      </void> 
                     </object> 
                    </void> 
+                   <void property="reducerTraits">
+                    <void method="clear"/>
+                    <void method="add">
+                     <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc$ReducerTraits" method="valueOf">
+                      <string>UNSET</string>
+                     </object>
+                    </void>
+                   </void>
                    <void property="tag"> 
                     <int>-1</int> 
                    </void> 
diff --git a/ql/src/test/results/compiler/plan/groupby2.q.xml b/ql/src/test/results/compiler/plan/groupby2.q.xml
index fe050e2a58..3a1164c59e 100755
--- a/ql/src/test/results/compiler/plan/groupby2.q.xml
+++ b/ql/src/test/results/compiler/plan/groupby2.q.xml
@@ -309,6 +309,14 @@
                      </void> 
                     </object> 
                    </void> 
+                   <void property="reducerTraits">
+                    <void method="clear"/>
+                    <void method="add">
+                     <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc$ReducerTraits" method="valueOf">
+                      <string>UNSET</string>
+                     </object>
+                    </void>
+                   </void>
                    <void property="tag"> 
                     <int>-1</int> 
                    </void> 
diff --git a/ql/src/test/results/compiler/plan/groupby3.q.xml b/ql/src/test/results/compiler/plan/groupby3.q.xml
index 2246a7bfc3..b33a2c64e4 100644
--- a/ql/src/test/results/compiler/plan/groupby3.q.xml
+++ b/ql/src/test/results/compiler/plan/groupby3.q.xml
@@ -364,6 +364,14 @@
                    <void property="partitionCols"> 
                     <object class="java.util.ArrayList"/> 
                    </void> 
+                   <void property="reducerTraits">
+                    <void method="clear"/>
+                    <void method="add">
+                     <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc$ReducerTraits" method="valueOf">
+                      <string>UNSET</string>
+                     </object>
+                    </void>
+                   </void>
                    <void property="tag"> 
                     <int>-1</int> 
                    </void> 
diff --git a/ql/src/test/results/compiler/plan/groupby4.q.xml b/ql/src/test/results/compiler/plan/groupby4.q.xml
index 909f6dddb2..a61b055db3 100644
--- a/ql/src/test/results/compiler/plan/groupby4.q.xml
+++ b/ql/src/test/results/compiler/plan/groupby4.q.xml
@@ -259,6 +259,14 @@
                      </void> 
                     </object> 
                    </void> 
+                   <void property="reducerTraits">
+                    <void method="clear"/>
+                    <void method="add">
+                     <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc$ReducerTraits" method="valueOf">
+                      <string>UNSET</string>
+                     </object>
+                    </void>
+                   </void>
                    <void property="tag"> 
                     <int>-1</int> 
                    </void> 
diff --git a/ql/src/test/results/compiler/plan/groupby5.q.xml b/ql/src/test/results/compiler/plan/groupby5.q.xml
index 1106075150..2946c67d95 100644
--- a/ql/src/test/results/compiler/plan/groupby5.q.xml
+++ b/ql/src/test/results/compiler/plan/groupby5.q.xml
@@ -281,6 +281,14 @@
                      </void> 
                     </object> 
                    </void> 
+                   <void property="reducerTraits">
+                    <void method="clear"/>
+                    <void method="add">
+                     <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc$ReducerTraits" method="valueOf">
+                      <string>UNSET</string>
+                     </object>
+                    </void>
+                   </void>
                    <void property="tag"> 
                     <int>-1</int> 
                    </void> 
diff --git a/ql/src/test/results/compiler/plan/groupby6.q.xml b/ql/src/test/results/compiler/plan/groupby6.q.xml
index 86c00eb171..08bf86fac8 100644
--- a/ql/src/test/results/compiler/plan/groupby6.q.xml
+++ b/ql/src/test/results/compiler/plan/groupby6.q.xml
@@ -259,6 +259,14 @@
                      </void> 
                     </object> 
                    </void> 
+                   <void property="reducerTraits">
+                    <void method="clear"/>
+                    <void method="add">
+                     <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc$ReducerTraits" method="valueOf">
+                      <string>UNSET</string>
+                     </object>
+                    </void>
+                   </void>
                    <void property="tag"> 
                     <int>-1</int> 
                    </void> 
diff --git a/ql/src/test/results/compiler/plan/input20.q.xml b/ql/src/test/results/compiler/plan/input20.q.xml
index 08d45a6163..845367d945 100644
--- a/ql/src/test/results/compiler/plan/input20.q.xml
+++ b/ql/src/test/results/compiler/plan/input20.q.xml
@@ -292,6 +292,14 @@
                      </void> 
                     </object> 
                    </void> 
+                   <void property="reducerTraits">
+                    <void method="clear"/>
+                    <void method="add">
+                     <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc$ReducerTraits" method="valueOf">
+                      <string>UNSET</string>
+                     </object>
+                    </void>
+                   </void>
                    <void property="tag"> 
                     <int>-1</int> 
                    </void> 
diff --git a/ql/src/test/results/compiler/plan/input4.q.xml b/ql/src/test/results/compiler/plan/input4.q.xml
index 2daf426b7a..f9d5340929 100755
--- a/ql/src/test/results/compiler/plan/input4.q.xml
+++ b/ql/src/test/results/compiler/plan/input4.q.xml
@@ -443,6 +443,14 @@
                         </void> 
                        </object> 
                       </void> 
+                      <void property="reducerTraits">
+                       <void method="clear"/>
+                       <void method="add">
+                        <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc$ReducerTraits" method="valueOf">
+                         <string>UNSET</string>
+                        </object>
+                       </void>
+                      </void>
                       <void property="tag"> 
                        <int>-1</int> 
                       </void> 
diff --git a/ql/src/test/results/compiler/plan/input5.q.xml b/ql/src/test/results/compiler/plan/input5.q.xml
index 22afeb1235..a211641585 100644
--- a/ql/src/test/results/compiler/plan/input5.q.xml
+++ b/ql/src/test/results/compiler/plan/input5.q.xml
@@ -448,6 +448,14 @@
                      </void> 
                     </object> 
                    </void> 
+                   <void property="reducerTraits">
+                    <void method="clear"/>
+                    <void method="add">
+                     <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc$ReducerTraits" method="valueOf">
+                      <string>UNSET</string>
+                     </object>
+                    </void>
+                   </void>
                    <void property="tag"> 
                     <int>-1</int> 
                    </void> 
diff --git a/ql/src/test/results/compiler/plan/join1.q.xml b/ql/src/test/results/compiler/plan/join1.q.xml
index a78972f409..9a1c202073 100644
--- a/ql/src/test/results/compiler/plan/join1.q.xml
+++ b/ql/src/test/results/compiler/plan/join1.q.xml
@@ -487,6 +487,14 @@
                   </void> 
                  </object> 
                 </void> 
+                <void property="reducerTraits">
+                 <void method="clear"/>
+                 <void method="add">
+                  <object id="ReduceSinkDesc$ReducerTraits0" class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc$ReducerTraits" method="valueOf">
+                   <string>UNSET</string>
+                  </object>
+                 </void>
+                </void>
                 <void property="tag"> 
                  <int>1</int> 
                 </void> 
@@ -890,6 +898,12 @@
                   </void> 
                  </object> 
                 </void> 
+                <void property="reducerTraits">
+                 <void method="clear"/>
+                 <void method="add">
+                  <object idref="ReduceSinkDesc$ReducerTraits0"/>
+                 </void>
+                </void>
                 <void property="valueCols"> 
                  <object class="java.util.ArrayList"/> 
                 </void> 
diff --git a/ql/src/test/results/compiler/plan/join2.q.xml b/ql/src/test/results/compiler/plan/join2.q.xml
index 2ee352c157..28a7d8fe63 100644
--- a/ql/src/test/results/compiler/plan/join2.q.xml
+++ b/ql/src/test/results/compiler/plan/join2.q.xml
@@ -465,6 +465,14 @@
                    </void> 
                   </object> 
                  </void> 
+                 <void property="reducerTraits">
+                  <void method="clear"/>
+                  <void method="add">
+                   <object id="ReduceSinkDesc$ReducerTraits0" class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc$ReducerTraits" method="valueOf">
+                    <string>UNSET</string>
+                   </object>
+                  </void>
+                 </void>
                  <void property="valueCols"> 
                   <object class="java.util.ArrayList"> 
                    <void method="add"> 
@@ -741,6 +749,12 @@
                       </void> 
                      </object> 
                     </void> 
+                    <void property="reducerTraits">
+                     <void method="clear"/>
+                     <void method="add">
+                      <object idref="ReduceSinkDesc$ReducerTraits0"/>
+                     </void>
+                    </void>
                     <void property="tag"> 
                      <int>1</int> 
                     </void> 
@@ -1944,6 +1958,12 @@
                   </void> 
                  </object> 
                 </void> 
+                <void property="reducerTraits">
+                 <void method="clear"/>
+                 <void method="add">
+                  <object idref="ReduceSinkDesc$ReducerTraits0"/>
+                 </void>
+                </void>
                 <void property="tag"> 
                  <int>1</int> 
                 </void> 
@@ -2273,6 +2293,12 @@
                   </void> 
                  </object> 
                 </void> 
+                <void property="reducerTraits">
+                 <void method="clear"/>
+                 <void method="add">
+                  <object idref="ReduceSinkDesc$ReducerTraits0"/>
+                 </void>
+                </void>
                 <void property="valueCols"> 
                  <object class="java.util.ArrayList"/> 
                 </void> 
diff --git a/ql/src/test/results/compiler/plan/join3.q.xml b/ql/src/test/results/compiler/plan/join3.q.xml
index a6e403ef19..93914dad24 100644
--- a/ql/src/test/results/compiler/plan/join3.q.xml
+++ b/ql/src/test/results/compiler/plan/join3.q.xml
@@ -534,6 +534,14 @@
                   </void> 
                  </object> 
                 </void> 
+                <void property="reducerTraits">
+                 <void method="clear"/>
+                 <void method="add">
+                  <object id="ReduceSinkDesc$ReducerTraits0" class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc$ReducerTraits" method="valueOf">
+                   <string>UNSET</string>
+                  </object>
+                 </void>
+                </void>
                 <void property="tag"> 
                  <int>1</int> 
                 </void> 
@@ -920,6 +928,12 @@
                   </void> 
                  </object> 
                 </void> 
+                <void property="reducerTraits">
+                 <void method="clear"/>
+                 <void method="add">
+                  <object idref="ReduceSinkDesc$ReducerTraits0"/>
+                 </void>
+                </void>
                 <void property="tag"> 
                  <int>2</int> 
                 </void> 
@@ -1284,6 +1298,12 @@
                   </void> 
                  </object> 
                 </void> 
+                <void property="reducerTraits">
+                 <void method="clear"/>
+                 <void method="add">
+                  <object idref="ReduceSinkDesc$ReducerTraits0"/>
+                 </void>
+                </void>
                 <void property="valueCols"> 
                  <object class="java.util.ArrayList"/> 
                 </void> 
diff --git a/ql/src/test/results/compiler/plan/join4.q.xml b/ql/src/test/results/compiler/plan/join4.q.xml
index d3e912795f..63fcd6449d 100644
--- a/ql/src/test/results/compiler/plan/join4.q.xml
+++ b/ql/src/test/results/compiler/plan/join4.q.xml
@@ -336,6 +336,14 @@
                      </void> 
                     </object> 
                    </void> 
+                   <void property="reducerTraits">
+                    <void method="clear"/>
+                    <void method="add">
+                     <object id="ReduceSinkDesc$ReducerTraits0" class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc$ReducerTraits" method="valueOf">
+                      <string>UNSET</string>
+                     </object>
+                    </void>
+                   </void>
                    <void property="valueCols"> 
                     <object class="java.util.ArrayList"> 
                      <void method="add"> 
@@ -911,6 +919,12 @@
                      </void> 
                     </object> 
                    </void> 
+                   <void property="reducerTraits">
+                    <void method="clear"/>
+                    <void method="add">
+                     <object idref="ReduceSinkDesc$ReducerTraits0"/>
+                    </void>
+                   </void>
                    <void property="tag"> 
                     <int>1</int> 
                    </void> 
diff --git a/ql/src/test/results/compiler/plan/join5.q.xml b/ql/src/test/results/compiler/plan/join5.q.xml
index 8615beb0f7..71487a66c2 100644
--- a/ql/src/test/results/compiler/plan/join5.q.xml
+++ b/ql/src/test/results/compiler/plan/join5.q.xml
@@ -336,6 +336,14 @@
                      </void> 
                     </object> 
                    </void> 
+                   <void property="reducerTraits">
+                    <void method="clear"/>
+                    <void method="add">
+                     <object id="ReduceSinkDesc$ReducerTraits0" class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc$ReducerTraits" method="valueOf">
+                      <string>UNSET</string>
+                     </object>
+                    </void>
+                   </void>
                    <void property="valueCols"> 
                     <object class="java.util.ArrayList"> 
                      <void method="add"> 
@@ -911,6 +919,12 @@
                      </void> 
                     </object> 
                    </void> 
+                   <void property="reducerTraits">
+                    <void method="clear"/>
+                    <void method="add">
+                     <object idref="ReduceSinkDesc$ReducerTraits0"/>
+                    </void>
+                   </void>
                    <void property="tag"> 
                     <int>1</int> 
                    </void> 
diff --git a/ql/src/test/results/compiler/plan/join6.q.xml b/ql/src/test/results/compiler/plan/join6.q.xml
index 473d2179e6..3ff26103e1 100644
--- a/ql/src/test/results/compiler/plan/join6.q.xml
+++ b/ql/src/test/results/compiler/plan/join6.q.xml
@@ -336,6 +336,14 @@
                      </void> 
                     </object> 
                    </void> 
+                   <void property="reducerTraits">
+                    <void method="clear"/>
+                    <void method="add">
+                     <object id="ReduceSinkDesc$ReducerTraits0" class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc$ReducerTraits" method="valueOf">
+                      <string>UNSET</string>
+                     </object>
+                    </void>
+                   </void>
                    <void property="valueCols"> 
                     <object class="java.util.ArrayList"> 
                      <void method="add"> 
@@ -911,6 +919,12 @@
                      </void> 
                     </object> 
                    </void> 
+                   <void property="reducerTraits">
+                    <void method="clear"/>
+                    <void method="add">
+                     <object idref="ReduceSinkDesc$ReducerTraits0"/>
+                    </void>
+                   </void>
                    <void property="tag"> 
                     <int>1</int> 
                    </void> 
diff --git a/ql/src/test/results/compiler/plan/join7.q.xml b/ql/src/test/results/compiler/plan/join7.q.xml
index 5568a7a8bb..279147a881 100644
--- a/ql/src/test/results/compiler/plan/join7.q.xml
+++ b/ql/src/test/results/compiler/plan/join7.q.xml
@@ -401,6 +401,14 @@
                      </void> 
                     </object> 
                    </void> 
+                   <void property="reducerTraits">
+                    <void method="clear"/>
+                    <void method="add">
+                     <object id="ReduceSinkDesc$ReducerTraits0" class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc$ReducerTraits" method="valueOf">
+                      <string>UNSET</string>
+                     </object>
+                    </void>
+                   </void>
                    <void property="valueCols"> 
                     <object class="java.util.ArrayList"> 
                      <void method="add"> 
@@ -976,6 +984,12 @@
                      </void> 
                     </object> 
                    </void> 
+                   <void property="reducerTraits">
+                    <void method="clear"/>
+                    <void method="add">
+                     <object idref="ReduceSinkDesc$ReducerTraits0"/>
+                    </void>
+                   </void>
                    <void property="tag"> 
                     <int>1</int> 
                    </void> 
@@ -1515,6 +1529,12 @@
                      </void> 
                     </object> 
                    </void> 
+                   <void property="reducerTraits">
+                    <void method="clear"/>
+                    <void method="add">
+                     <object idref="ReduceSinkDesc$ReducerTraits0"/>
+                    </void>
+                   </void>
                    <void property="tag"> 
                     <int>2</int> 
                    </void> 
diff --git a/ql/src/test/results/compiler/plan/join8.q.xml b/ql/src/test/results/compiler/plan/join8.q.xml
index 7ef3d43d74..c9a2de423c 100644
--- a/ql/src/test/results/compiler/plan/join8.q.xml
+++ b/ql/src/test/results/compiler/plan/join8.q.xml
@@ -336,6 +336,14 @@
                      </void> 
                     </object> 
                    </void> 
+                   <void property="reducerTraits">
+                    <void method="clear"/>
+                    <void method="add">
+                     <object id="ReduceSinkDesc$ReducerTraits0" class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc$ReducerTraits" method="valueOf">
+                      <string>UNSET</string>
+                     </object>
+                    </void>
+                   </void>
                    <void property="valueCols"> 
                     <object class="java.util.ArrayList"> 
                      <void method="add"> 
@@ -952,6 +960,12 @@
                      </void> 
                     </object> 
                    </void> 
+                   <void property="reducerTraits">
+                    <void method="clear"/>
+                    <void method="add">
+                     <object idref="ReduceSinkDesc$ReducerTraits0"/>
+                    </void>
+                   </void>
                    <void property="tag"> 
                     <int>1</int> 
                    </void> 
