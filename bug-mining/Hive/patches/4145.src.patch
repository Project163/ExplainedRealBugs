diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
index 945a6d76a4..27549dceac 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
@@ -531,6 +531,10 @@ private void doPhase1GetAllAggregations(ASTNode expressionTree,
       if (expressionTree.getChild(0).getType() == HiveParser.Identifier) {
         String functionName = unescapeIdentifier(expressionTree.getChild(0)
             .getText());
+        // Validate the function name
+        if (FunctionRegistry.getFunctionInfo(functionName) == null) {
+          throw new SemanticException(ErrorMsg.INVALID_FUNCTION.getMsg(functionName));
+        }
         if(FunctionRegistry.impliesOrder(functionName)) {
           throw new SemanticException(ErrorMsg.MISSING_OVER_CLAUSE.getMsg(functionName));
         }
diff --git a/ql/src/test/queries/clientnegative/invalid_select_fn.q b/ql/src/test/queries/clientnegative/invalid_select_fn.q
new file mode 100644
index 0000000000..b01d29bc1a
--- /dev/null
+++ b/ql/src/test/queries/clientnegative/invalid_select_fn.q
@@ -0,0 +1 @@
+explain create table src_invalid as select average(key) as key_avg from src group by value;
diff --git a/ql/src/test/results/clientnegative/invalid_select_fn.q.out b/ql/src/test/results/clientnegative/invalid_select_fn.q.out
new file mode 100644
index 0000000000..6023f55932
--- /dev/null
+++ b/ql/src/test/results/clientnegative/invalid_select_fn.q.out
@@ -0,0 +1 @@
+FAILED: SemanticException [Error 10011]: Invalid function average
diff --git a/ql/src/test/results/clientnegative/udf_invalid.q.out b/ql/src/test/results/clientnegative/udf_invalid.q.out
index c394cc86c9..29b6cc32ed 100644
--- a/ql/src/test/results/clientnegative/udf_invalid.q.out
+++ b/ql/src/test/results/clientnegative/udf_invalid.q.out
@@ -1 +1 @@
-FAILED: SemanticException Line 0:-1 Invalid function 'default.nonexistfunc'
+FAILED: SemanticException [Error 10011]: Invalid function default.nonexistfunc
diff --git a/ql/src/test/results/compiler/errors/unknown_function1.q.out b/ql/src/test/results/compiler/errors/unknown_function1.q.out
index c6af5152fc..8e1343b073 100644
--- a/ql/src/test/results/compiler/errors/unknown_function1.q.out
+++ b/ql/src/test/results/compiler/errors/unknown_function1.q.out
@@ -1,2 +1,2 @@
 Semantic Exception: 
-Line 2:44 Invalid function 'dummyfn'
\ No newline at end of file
+Invalid function dummyfn
\ No newline at end of file
diff --git a/ql/src/test/results/compiler/errors/unknown_function4.q.out b/ql/src/test/results/compiler/errors/unknown_function4.q.out
index c6af5152fc..8e1343b073 100644
--- a/ql/src/test/results/compiler/errors/unknown_function4.q.out
+++ b/ql/src/test/results/compiler/errors/unknown_function4.q.out
@@ -1,2 +1,2 @@
 Semantic Exception: 
-Line 2:44 Invalid function 'dummyfn'
\ No newline at end of file
+Invalid function dummyfn
\ No newline at end of file
