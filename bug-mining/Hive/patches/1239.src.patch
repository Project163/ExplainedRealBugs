diff --git a/build-common.xml b/build-common.xml
index f10f340f02..eee4197a66 100644
--- a/build-common.xml
+++ b/build-common.xml
@@ -406,9 +406,11 @@
       <equals arg1="${hadoop.mr.rev}" arg2="23" />
       <then>
         <property name="hadoop.opts" value="${hadoop.opts.23}" />
+        <property name="test.dfs.mkdir" value="-mkdir -p"/>
       </then>
       <else>
         <property name="hadoop.opts" value="${hadoop.opts.20}" />
+        <property name="test.dfs.mkdir" value="-mkdir"/>
       </else>
     </if>
     <!-- Set the OS specific settings to run junit tests on unix as well as on windows -->
@@ -438,6 +440,7 @@
       <env key="HADOOP_CLASSPATH" path="${test.src.data.dir}/conf:${build.dir.hive}/dist/lib/derby-${derby.version}.jar:${build.dir.hive}/dist/lib/JavaEWAH-${javaewah.version}.jar:${hadoop.root}/modules/*"/> <!-- Modules needed for Hadoop 0.23 -->
       <env key="TZ" value="US/Pacific"/>
       <sysproperty key="test.output.overwrite" value="${overwrite}"/>
+      <sysproperty key="test.dfs.mkdir" value="${test.dfs.mkdir}"/>
       <sysproperty key="test.service.standalone.server" value="${standalone}"/>
       <sysproperty key="test.service.disable.server" value="${disableserver}"/>
       <sysproperty key="log4j.configuration" value="file:///${test.src.data.dir}/conf/hive-log4j.properties"/>
diff --git a/build.properties b/build.properties
index bdbb2fcb2c..70b8a12a56 100644
--- a/build.properties
+++ b/build.properties
@@ -29,7 +29,7 @@ javac.args.warnings=
 
 hadoop-0.20.version=0.20.2
 hadoop-0.20S.version=1.1.2
-hadoop-0.23.version=2.0.0-alpha
+hadoop-0.23.version=2.0.3-alpha
 hadoop.version=${hadoop-0.20.version}
 hadoop.security.version=${hadoop-0.20S.version}
 # Used to determine which set of Hadoop artifacts we depend on.
diff --git a/ql/src/test/queries/clientnegative/exim_00_unsupported_schema.q b/ql/src/test/queries/clientnegative/exim_00_unsupported_schema.q
index 51b86b70a1..d86ecd5785 100644
--- a/ql/src/test/queries/clientnegative/exim_00_unsupported_schema.q
+++ b/ql/src/test/queries/clientnegative/exim_00_unsupported_schema.q
@@ -5,7 +5,7 @@ create table exim_department ( dep_id int comment "department id")
 	stored as textfile
 	tblproperties("creator"="krishna");
 load data local inpath "../data/files/test.dat" into table exim_department;	
-dfs -mkdir ../build/ql/test/data/exports/exim_department/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/exports/exim_department/temp;
 dfs -rmr ../build/ql/test/data/exports/exim_department;
 export table exim_department to 'nosuchschema://nosuchauthority/ql/test/data/exports/exim_department';
 drop table exim_department;
diff --git a/ql/src/test/queries/clientnegative/exim_01_nonpart_over_loaded.q b/ql/src/test/queries/clientnegative/exim_01_nonpart_over_loaded.q
index 28bc36f4d4..5f3223152f 100644
--- a/ql/src/test/queries/clientnegative/exim_01_nonpart_over_loaded.q
+++ b/ql/src/test/queries/clientnegative/exim_01_nonpart_over_loaded.q
@@ -5,7 +5,7 @@ create table exim_department ( dep_id int comment "department id")
 	stored as textfile
 	tblproperties("creator"="krishna");
 load data local inpath "../data/files/test.dat" into table exim_department;	
-dfs -mkdir ../build/ql/test/data/exports/exim_department/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/exports/exim_department/temp;
 dfs -rmr ../build/ql/test/data/exports/exim_department;
 export table exim_department to 'ql/test/data/exports/exim_department';
 drop table exim_department;
diff --git a/ql/src/test/queries/clientnegative/exim_02_all_part_over_overlap.q b/ql/src/test/queries/clientnegative/exim_02_all_part_over_overlap.q
index 8f61381504..d7204dc478 100644
--- a/ql/src/test/queries/clientnegative/exim_02_all_part_over_overlap.q
+++ b/ql/src/test/queries/clientnegative/exim_02_all_part_over_overlap.q
@@ -14,7 +14,7 @@ load data local inpath "../data/files/test.dat"
 	into table exim_employee partition (emp_country="us", emp_state="tn");	
 load data local inpath "../data/files/test.dat" 
 	into table exim_employee partition (emp_country="us", emp_state="ka");		
-dfs -mkdir ../build/ql/test/data/exports/exim_employee/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/exports/exim_employee/temp;
 dfs -rmr ../build/ql/test/data/exports/exim_employee;
 export table exim_employee to 'ql/test/data/exports/exim_employee';
 drop table exim_employee;
diff --git a/ql/src/test/queries/clientnegative/exim_03_nonpart_noncompat_colschema.q b/ql/src/test/queries/clientnegative/exim_03_nonpart_noncompat_colschema.q
index d3f7b495f9..6cd7eda455 100644
--- a/ql/src/test/queries/clientnegative/exim_03_nonpart_noncompat_colschema.q
+++ b/ql/src/test/queries/clientnegative/exim_03_nonpart_noncompat_colschema.q
@@ -5,7 +5,7 @@ create table exim_department ( dep_id int comment "department id")
 	stored as textfile	
 	tblproperties("creator"="krishna");
 load data local inpath "../data/files/test.dat" into table exim_department;	
-dfs -mkdir ../build/ql/test/data/exports/exim_department/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/exports/exim_department/temp;
 dfs -rmr ../build/ql/test/data/exports/exim_department;
 export table exim_department to 'ql/test/data/exports/exim_department';
 drop table exim_department;
diff --git a/ql/src/test/queries/clientnegative/exim_04_nonpart_noncompat_colnumber.q b/ql/src/test/queries/clientnegative/exim_04_nonpart_noncompat_colnumber.q
index e08155ff24..7f3f577c43 100644
--- a/ql/src/test/queries/clientnegative/exim_04_nonpart_noncompat_colnumber.q
+++ b/ql/src/test/queries/clientnegative/exim_04_nonpart_noncompat_colnumber.q
@@ -5,7 +5,7 @@ create table exim_department ( dep_id int comment "department id")
 	stored as textfile	
 	tblproperties("creator"="krishna");
 load data local inpath "../data/files/test.dat" into table exim_department;	
-dfs -mkdir ../build/ql/test/data/exports/exim_department/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/exports/exim_department/temp;
 dfs -rmr ../build/ql/test/data/exports/exim_department;
 export table exim_department to 'ql/test/data/exports/exim_department';
 drop table exim_department;
diff --git a/ql/src/test/queries/clientnegative/exim_05_nonpart_noncompat_coltype.q b/ql/src/test/queries/clientnegative/exim_05_nonpart_noncompat_coltype.q
index 6ea722a430..d3ec9fff82 100644
--- a/ql/src/test/queries/clientnegative/exim_05_nonpart_noncompat_coltype.q
+++ b/ql/src/test/queries/clientnegative/exim_05_nonpart_noncompat_coltype.q
@@ -5,7 +5,7 @@ create table exim_department ( dep_id int comment "department id")
 	stored as textfile	
 	tblproperties("creator"="krishna");
 load data local inpath "../data/files/test.dat" into table exim_department;	
-dfs -mkdir ../build/ql/test/data/exports/exim_department/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/exports/exim_department/temp;
 dfs -rmr ../build/ql/test/data/exports/exim_department;
 export table exim_department to 'ql/test/data/exports/exim_department';
 drop table exim_department;
diff --git a/ql/src/test/queries/clientnegative/exim_06_nonpart_noncompat_storage.q b/ql/src/test/queries/clientnegative/exim_06_nonpart_noncompat_storage.q
index 5cb4dd95b8..1cc691fc29 100644
--- a/ql/src/test/queries/clientnegative/exim_06_nonpart_noncompat_storage.q
+++ b/ql/src/test/queries/clientnegative/exim_06_nonpart_noncompat_storage.q
@@ -5,7 +5,7 @@ create table exim_department ( dep_id int comment "department id")
 	stored as textfile	
 	tblproperties("creator"="krishna");
 load data local inpath "../data/files/test.dat" into table exim_department;	
-dfs -mkdir ../build/ql/test/data/exports/exim_department/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/exports/exim_department/temp;
 dfs -rmr ../build/ql/test/data/exports/exim_department;
 export table exim_department to 'ql/test/data/exports/exim_department';
 drop table exim_department;
diff --git a/ql/src/test/queries/clientnegative/exim_07_nonpart_noncompat_ifof.q b/ql/src/test/queries/clientnegative/exim_07_nonpart_noncompat_ifof.q
index ad1748617a..27830ad5f9 100644
--- a/ql/src/test/queries/clientnegative/exim_07_nonpart_noncompat_ifof.q
+++ b/ql/src/test/queries/clientnegative/exim_07_nonpart_noncompat_ifof.q
@@ -5,7 +5,7 @@ create table exim_department ( dep_id int comment "department id")
 	stored as textfile	
 	tblproperties("creator"="krishna");
 load data local inpath "../data/files/test.dat" into table exim_department;	
-dfs -mkdir ../build/ql/test/data/exports/exim_department/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/exports/exim_department/temp;
 dfs -rmr ../build/ql/test/data/exports/exim_department;
 export table exim_department to 'ql/test/data/exports/exim_department';
 drop table exim_department;
diff --git a/ql/src/test/queries/clientnegative/exim_08_nonpart_noncompat_serde.q b/ql/src/test/queries/clientnegative/exim_08_nonpart_noncompat_serde.q
index 45ae707e4e..d85048a97a 100644
--- a/ql/src/test/queries/clientnegative/exim_08_nonpart_noncompat_serde.q
+++ b/ql/src/test/queries/clientnegative/exim_08_nonpart_noncompat_serde.q
@@ -5,7 +5,7 @@ create table exim_department ( dep_id int comment "department id")
 	stored as textfile	
 	tblproperties("creator"="krishna");
 load data local inpath "../data/files/test.dat" into table exim_department;	
-dfs -mkdir ../build/ql/test/data/exports/exim_department/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/exports/exim_department/temp;
 dfs -rmr ../build/ql/test/data/exports/exim_department;
 export table exim_department to 'ql/test/data/exports/exim_department';
 drop table exim_department;
diff --git a/ql/src/test/queries/clientnegative/exim_09_nonpart_noncompat_serdeparam.q b/ql/src/test/queries/clientnegative/exim_09_nonpart_noncompat_serdeparam.q
index 2b762c7e65..84b3786a16 100644
--- a/ql/src/test/queries/clientnegative/exim_09_nonpart_noncompat_serdeparam.q
+++ b/ql/src/test/queries/clientnegative/exim_09_nonpart_noncompat_serdeparam.q
@@ -5,7 +5,7 @@ create table exim_department ( dep_id int comment "department id")
 	stored as textfile	
 	tblproperties("creator"="krishna");
 load data local inpath "../data/files/test.dat" into table exim_department;	
-dfs -mkdir ../build/ql/test/data/exports/exim_department/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/exports/exim_department/temp;
 dfs -rmr ../build/ql/test/data/exports/exim_department;
 export table exim_department to 'ql/test/data/exports/exim_department';
 drop table exim_department;
diff --git a/ql/src/test/queries/clientnegative/exim_10_nonpart_noncompat_bucketing.q b/ql/src/test/queries/clientnegative/exim_10_nonpart_noncompat_bucketing.q
index ee29a57cbd..eaf9c579d5 100644
--- a/ql/src/test/queries/clientnegative/exim_10_nonpart_noncompat_bucketing.q
+++ b/ql/src/test/queries/clientnegative/exim_10_nonpart_noncompat_bucketing.q
@@ -5,7 +5,7 @@ create table exim_department ( dep_id int comment "department id")
 	stored as textfile	
 	tblproperties("creator"="krishna");
 load data local inpath "../data/files/test.dat" into table exim_department;	
-dfs -mkdir ../build/ql/test/data/exports/exim_department/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/exports/exim_department/temp;
 dfs -rmr ../build/ql/test/data/exports/exim_department;
 export table exim_department to 'ql/test/data/exports/exim_department';
 drop table exim_department;
diff --git a/ql/src/test/queries/clientnegative/exim_11_nonpart_noncompat_sorting.q b/ql/src/test/queries/clientnegative/exim_11_nonpart_noncompat_sorting.q
index 27d07ff65f..092fd77954 100644
--- a/ql/src/test/queries/clientnegative/exim_11_nonpart_noncompat_sorting.q
+++ b/ql/src/test/queries/clientnegative/exim_11_nonpart_noncompat_sorting.q
@@ -6,7 +6,7 @@ create table exim_department ( dep_id int comment "department id")
 	stored as textfile	
 	tblproperties("creator"="krishna");
 load data local inpath "../data/files/test.dat" into table exim_department;	
-dfs -mkdir ../build/ql/test/data/exports/exim_department/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/exports/exim_department/temp;
 dfs -rmr ../build/ql/test/data/exports/exim_department;
 export table exim_department to 'ql/test/data/exports/exim_department';
 drop table exim_department;
diff --git a/ql/src/test/queries/clientnegative/exim_13_nonnative_import.q b/ql/src/test/queries/clientnegative/exim_13_nonnative_import.q
index f7c410dcc8..05de3d77b0 100644
--- a/ql/src/test/queries/clientnegative/exim_13_nonnative_import.q
+++ b/ql/src/test/queries/clientnegative/exim_13_nonnative_import.q
@@ -5,7 +5,7 @@ create table exim_department ( dep_id int comment "department id")
 	stored as textfile	
 	tblproperties("creator"="krishna");
 load data local inpath "../data/files/test.dat" into table exim_department;		
-dfs -mkdir ../build/ql/test/data/exports/exim_department/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/exports/exim_department/temp;
 dfs -rmr ../build/ql/test/data/exports/exim_department;
 export table exim_department to 'ql/test/data/exports/exim_department';
 drop table exim_department;
diff --git a/ql/src/test/queries/clientnegative/exim_14_nonpart_part.q b/ql/src/test/queries/clientnegative/exim_14_nonpart_part.q
index e1b59100e4..dc194ca814 100644
--- a/ql/src/test/queries/clientnegative/exim_14_nonpart_part.q
+++ b/ql/src/test/queries/clientnegative/exim_14_nonpart_part.q
@@ -5,7 +5,7 @@ create table exim_department ( dep_id int comment "department id")
 	stored as textfile	
 	tblproperties("creator"="krishna");
 load data local inpath "../data/files/test.dat" into table exim_department;		
-dfs -mkdir ../build/ql/test/data/exports/exim_department/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/exports/exim_department/temp;
 dfs -rmr ../build/ql/test/data/exports/exim_department;
 export table exim_department to 'ql/test/data/exports/exim_department';
 drop table exim_department;
diff --git a/ql/src/test/queries/clientnegative/exim_15_part_nonpart.q b/ql/src/test/queries/clientnegative/exim_15_part_nonpart.q
index 1e09356464..e233707cc4 100644
--- a/ql/src/test/queries/clientnegative/exim_15_part_nonpart.q
+++ b/ql/src/test/queries/clientnegative/exim_15_part_nonpart.q
@@ -6,7 +6,7 @@ create table exim_department ( dep_id int comment "department id")
 	stored as textfile	
 	tblproperties("creator"="krishna");
 load data local inpath "../data/files/test.dat" into table exim_department partition (dep_org="hr");		
-dfs -mkdir ../build/ql/test/data/exports/exim_department/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/exports/exim_department/temp;
 dfs -rmr ../build/ql/test/data/exports/exim_department;
 export table exim_department to 'ql/test/data/exports/exim_department';
 drop table exim_department;
diff --git a/ql/src/test/queries/clientnegative/exim_16_part_noncompat_schema.q b/ql/src/test/queries/clientnegative/exim_16_part_noncompat_schema.q
index 83e94dc214..a10788e3e3 100644
--- a/ql/src/test/queries/clientnegative/exim_16_part_noncompat_schema.q
+++ b/ql/src/test/queries/clientnegative/exim_16_part_noncompat_schema.q
@@ -6,7 +6,7 @@ create table exim_department ( dep_id int comment "department id")
 	stored as textfile	
 	tblproperties("creator"="krishna");
 load data local inpath "../data/files/test.dat" into table exim_department partition (dep_org="hr");		
-dfs -mkdir ../build/ql/test/data/exports/exim_department/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/exports/exim_department/temp;
 dfs -rmr ../build/ql/test/data/exports/exim_department;
 export table exim_department to 'ql/test/data/exports/exim_department';
 drop table exim_department;
diff --git a/ql/src/test/queries/clientnegative/exim_17_part_spec_underspec.q b/ql/src/test/queries/clientnegative/exim_17_part_spec_underspec.q
index f394543ee6..cc4a56ca34 100644
--- a/ql/src/test/queries/clientnegative/exim_17_part_spec_underspec.q
+++ b/ql/src/test/queries/clientnegative/exim_17_part_spec_underspec.q
@@ -14,7 +14,7 @@ load data local inpath "../data/files/test.dat"
 	into table exim_employee partition (emp_country="us", emp_state="tn");	
 load data local inpath "../data/files/test.dat" 
 	into table exim_employee partition (emp_country="us", emp_state="ka");		
-dfs -mkdir ../build/ql/test/data/exports/exim_employee/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/exports/exim_employee/temp;
 dfs -rmr ../build/ql/test/data/exports/exim_employee;
 export table exim_employee to 'ql/test/data/exports/exim_employee';
 drop table exim_employee;
diff --git a/ql/src/test/queries/clientnegative/exim_18_part_spec_missing.q b/ql/src/test/queries/clientnegative/exim_18_part_spec_missing.q
index 8c1b315dd1..140e3bb3b1 100644
--- a/ql/src/test/queries/clientnegative/exim_18_part_spec_missing.q
+++ b/ql/src/test/queries/clientnegative/exim_18_part_spec_missing.q
@@ -14,7 +14,7 @@ load data local inpath "../data/files/test.dat"
 	into table exim_employee partition (emp_country="us", emp_state="tn");	
 load data local inpath "../data/files/test.dat" 
 	into table exim_employee partition (emp_country="us", emp_state="ka");		
-dfs -mkdir ../build/ql/test/data/exports/exim_employee/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/exports/exim_employee/temp;
 dfs -rmr ../build/ql/test/data/exports/exim_employee;
 export table exim_employee to 'ql/test/data/exports/exim_employee';
 drop table exim_employee;
diff --git a/ql/src/test/queries/clientnegative/exim_19_external_over_existing.q b/ql/src/test/queries/clientnegative/exim_19_external_over_existing.q
index 9c94f98c3a..048befe4d3 100644
--- a/ql/src/test/queries/clientnegative/exim_19_external_over_existing.q
+++ b/ql/src/test/queries/clientnegative/exim_19_external_over_existing.q
@@ -5,7 +5,7 @@ create table exim_department ( dep_id int comment "department id")
 	stored as textfile	
 	tblproperties("creator"="krishna");
 load data local inpath "../data/files/test.dat" into table exim_department;		
-dfs -mkdir ../build/ql/test/data/exports/exim_department/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/exports/exim_department/temp;
 dfs -rmr ../build/ql/test/data/exports/exim_department;
 export table exim_department to 'ql/test/data/exports/exim_department';
 drop table exim_department;
diff --git a/ql/src/test/queries/clientnegative/exim_20_managed_location_over_existing.q b/ql/src/test/queries/clientnegative/exim_20_managed_location_over_existing.q
index 7c12294a54..89cbb9ecd8 100644
--- a/ql/src/test/queries/clientnegative/exim_20_managed_location_over_existing.q
+++ b/ql/src/test/queries/clientnegative/exim_20_managed_location_over_existing.q
@@ -5,7 +5,7 @@ create table exim_department ( dep_id int comment "department id")
 	stored as textfile	
 	tblproperties("creator"="krishna");
 load data local inpath "../data/files/test.dat" into table exim_department;		
-dfs -mkdir ../build/ql/test/data/exports/exim_department/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/exports/exim_department/temp;
 dfs -rmr ../build/ql/test/data/exports/exim_department;
 export table exim_department to 'ql/test/data/exports/exim_department';
 drop table exim_department;
@@ -13,7 +13,7 @@ drop table exim_department;
 create database importer;
 use importer;
 
-dfs -mkdir ../build/ql/test/data/tablestore/exim_department/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/tablestore/exim_department/temp;
 dfs -rmr ../build/ql/test/data/tablestore/exim_department;
 
 create table exim_department ( dep_id int comment "department id") 	
diff --git a/ql/src/test/queries/clientnegative/exim_21_part_managed_external.q b/ql/src/test/queries/clientnegative/exim_21_part_managed_external.q
index d6a212f04a..0cbfc85258 100644
--- a/ql/src/test/queries/clientnegative/exim_21_part_managed_external.q
+++ b/ql/src/test/queries/clientnegative/exim_21_part_managed_external.q
@@ -14,7 +14,7 @@ load data local inpath "../data/files/test.dat"
 	into table exim_employee partition (emp_country="us", emp_state="tn");	
 load data local inpath "../data/files/test.dat" 
 	into table exim_employee partition (emp_country="us", emp_state="ka");		
-dfs -mkdir ../build/ql/test/data/exports/exim_employee/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/exports/exim_employee/temp;
 dfs -rmr ../build/ql/test/data/exports/exim_employee;
 export table exim_employee to 'ql/test/data/exports/exim_employee';
 drop table exim_employee;
diff --git a/ql/src/test/queries/clientnegative/exim_22_export_authfail.q b/ql/src/test/queries/clientnegative/exim_22_export_authfail.q
index 66e006c51e..d9ab0cf0e4 100644
--- a/ql/src/test/queries/clientnegative/exim_22_export_authfail.q
+++ b/ql/src/test/queries/clientnegative/exim_22_export_authfail.q
@@ -5,7 +5,7 @@ create table exim_department ( dep_id int) stored as textfile;
 
 set hive.security.authorization.enabled=true;
 
-dfs -mkdir ../build/ql/test/data/exports/exim_department/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/exports/exim_department/temp;
 dfs -rmr ../build/ql/test/data/exports/exim_department;
 export table exim_department to 'ql/test/data/exports/exim_department';
 
diff --git a/ql/src/test/queries/clientnegative/exim_23_import_exist_authfail.q b/ql/src/test/queries/clientnegative/exim_23_import_exist_authfail.q
index 757143616c..2dbd534074 100644
--- a/ql/src/test/queries/clientnegative/exim_23_import_exist_authfail.q
+++ b/ql/src/test/queries/clientnegative/exim_23_import_exist_authfail.q
@@ -3,7 +3,7 @@ set hive.test.mode.prefix=;
 
 create table exim_department ( dep_id int) stored as textfile;
 load data local inpath "../data/files/test.dat" into table exim_department;
-dfs -mkdir ../build/ql/test/data/exports/exim_department/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/exports/exim_department/temp;
 dfs -rmr ../build/ql/test/data/exports/exim_department;
 export table exim_department to 'ql/test/data/exports/exim_department';
 drop table exim_department;
diff --git a/ql/src/test/queries/clientnegative/exim_24_import_part_authfail.q b/ql/src/test/queries/clientnegative/exim_24_import_part_authfail.q
index e4898a4dbf..ccbcee3698 100644
--- a/ql/src/test/queries/clientnegative/exim_24_import_part_authfail.q
+++ b/ql/src/test/queries/clientnegative/exim_24_import_part_authfail.q
@@ -9,7 +9,7 @@ create table exim_employee ( emp_id int comment "employee id")
 	tblproperties("creator"="krishna");
 load data local inpath "../data/files/test.dat" 
 	into table exim_employee partition (emp_country="in", emp_state="tn");		
-dfs -mkdir ../build/ql/test/data/exports/exim_employee/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/exports/exim_employee/temp;
 dfs -rmr ../build/ql/test/data/exports/exim_employee;
 export table exim_employee to 'ql/test/data/exports/exim_employee';
 drop table exim_employee;
diff --git a/ql/src/test/queries/clientnegative/exim_25_import_nonexist_authfail.q b/ql/src/test/queries/clientnegative/exim_25_import_nonexist_authfail.q
index 974b63d5cb..50bfe005c4 100644
--- a/ql/src/test/queries/clientnegative/exim_25_import_nonexist_authfail.q
+++ b/ql/src/test/queries/clientnegative/exim_25_import_nonexist_authfail.q
@@ -4,7 +4,7 @@ set hive.test.mode.nosamplelist=exim_department,exim_employee;
 
 create table exim_department ( dep_id int) stored as textfile;
 load data local inpath "../data/files/test.dat" into table exim_department;
-dfs -mkdir ../build/ql/test/data/exports/exim_department/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/exports/exim_department/temp;
 dfs -rmr ../build/ql/test/data/exports/exim_department;
 export table exim_department to 'ql/test/data/exports/exim_department';
 drop table exim_department;
diff --git a/ql/src/test/queries/clientpositive/database_drop.q b/ql/src/test/queries/clientpositive/database_drop.q
index 3a5d294954..4e17c7ad5a 100644
--- a/ql/src/test/queries/clientpositive/database_drop.q
+++ b/ql/src/test/queries/clientpositive/database_drop.q
@@ -8,9 +8,9 @@ CREATE DATABASE db5;
 SHOW DATABASES;
 USE db5;
 
-dfs -mkdir ${system:test.tmp.dir}/dbcascade/temp;
+dfs ${system:test.dfs.mkdir} ${system:test.tmp.dir}/dbcascade/temp;
 dfs -rmr ${system:test.tmp.dir}/dbcascade;
-dfs -mkdir ${system:test.tmp.dir}/dbcascade;
+dfs ${system:test.dfs.mkdir} ${system:test.tmp.dir}/dbcascade;
 
 -- add a table, index and view
 CREATE TABLE temp_tbl (id INT, name STRING);
@@ -19,8 +19,8 @@ CREATE VIEW temp_tbl_view AS SELECT * FROM temp_tbl;
 CREATE INDEX idx1 ON TABLE temp_tbl(id) AS 'COMPACT' with DEFERRED REBUILD;
 ALTER INDEX idx1 ON temp_tbl REBUILD;
 
-dfs -mkdir ${system:test.tmp.dir}/dbcascade/temp_tbl2;
-dfs -mkdir ${system:test.tmp.dir}/dbcascade/temp_tbl2_idx2;
+dfs ${system:test.dfs.mkdir} ${system:test.tmp.dir}/dbcascade/temp_tbl2;
+dfs ${system:test.dfs.mkdir} ${system:test.tmp.dir}/dbcascade/temp_tbl2_idx2;
 -- add a table, index and view with a different storage location
 CREATE TABLE temp_tbl2 (id INT, name STRING) LOCATION 'file:${system:test.tmp.dir}/dbcascade/temp_tbl2';
 LOAD DATA LOCAL INPATH '../data/files/kv1.txt' into table temp_tbl2;
@@ -36,8 +36,8 @@ CREATE INDEX idx3 ON TABLE part_tab(id) AS 'COMPACT' with DEFERRED REBUILD;
 ALTER INDEX idx3 ON part_tab PARTITION (ds='2008-04-09') REBUILD;
 ALTER INDEX idx3 ON part_tab PARTITION (ds='2009-04-09') REBUILD;
 
-dfs -mkdir ${system:test.tmp.dir}/dbcascade/part_tab2;
-dfs -mkdir ${system:test.tmp.dir}/dbcascade/part_tab2_idx4;
+dfs ${system:test.dfs.mkdir} ${system:test.tmp.dir}/dbcascade/part_tab2;
+dfs ${system:test.dfs.mkdir} ${system:test.tmp.dir}/dbcascade/part_tab2_idx4;
 -- add a partitioned table, index and view with a different storage location
 CREATE TABLE part_tab2 (id INT, name STRING)  PARTITIONED BY (ds string)
 		LOCATION 'file:${system:test.tmp.dir}/dbcascade/part_tab2';
@@ -49,9 +49,9 @@ ALTER INDEX idx4 ON part_tab2 PARTITION (ds='2008-04-09') REBUILD;
 ALTER INDEX idx4 ON part_tab2 PARTITION (ds='2009-04-09') REBUILD;
 
 
-dfs -mkdir ${system:test.tmp.dir}/dbcascade/part_tab3;
-dfs -mkdir ${system:test.tmp.dir}/dbcascade/part_tab3_p1;
-dfs -mkdir ${system:test.tmp.dir}/dbcascade/part_tab3_idx5;
+dfs ${system:test.dfs.mkdir} ${system:test.tmp.dir}/dbcascade/part_tab3;
+dfs ${system:test.dfs.mkdir} ${system:test.tmp.dir}/dbcascade/part_tab3_p1;
+dfs ${system:test.dfs.mkdir} ${system:test.tmp.dir}/dbcascade/part_tab3_idx5;
 -- add a partitioned table, index and view with a different storage location
 CREATE TABLE part_tab3 (id INT, name STRING)  PARTITIONED BY (ds string)
 		LOCATION 'file:${system:test.tmp.dir}/dbcascade/part_tab3';
@@ -65,7 +65,7 @@ ALTER INDEX idx5 ON part_tab3 PARTITION (ds='2009-04-09') REBUILD;
 
 
 
-dfs -mkdir ${system:test.tmp.dir}/dbcascade/extab1;
+dfs ${system:test.dfs.mkdir} ${system:test.tmp.dir}/dbcascade/extab1;
 dfs -touchz ${system:test.tmp.dir}/dbcascade/extab1/file1.txt;
 -- add an external table
 CREATE EXTERNAL TABLE extab1(id INT, name STRING) ROW FORMAT
diff --git a/ql/src/test/queries/clientpositive/exim_00_nonpart_empty.q b/ql/src/test/queries/clientpositive/exim_00_nonpart_empty.q
index d4ef0da410..7fa96b629a 100644
--- a/ql/src/test/queries/clientpositive/exim_00_nonpart_empty.q
+++ b/ql/src/test/queries/clientpositive/exim_00_nonpart_empty.q
@@ -5,7 +5,7 @@ set hive.test.mode.nosamplelist=exim_department,exim_employee;
 create table exim_department ( dep_id int comment "department id") 	
 	stored as textfile	
 	tblproperties("creator"="krishna");
-dfs -mkdir ../build/ql/test/data/exports/exim_department/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/exports/exim_department/temp;
 dfs -rmr ../build/ql/test/data/exports/exim_department;
 export table exim_department to 'ql/test/data/exports/exim_department';
 drop table exim_department;
diff --git a/ql/src/test/queries/clientpositive/exim_01_nonpart.q b/ql/src/test/queries/clientpositive/exim_01_nonpart.q
index 0c2e1686c0..9920e778d1 100644
--- a/ql/src/test/queries/clientpositive/exim_01_nonpart.q
+++ b/ql/src/test/queries/clientpositive/exim_01_nonpart.q
@@ -6,7 +6,7 @@ create table exim_department ( dep_id int comment "department id")
 	stored as textfile	
 	tblproperties("creator"="krishna");
 load data local inpath "../data/files/test.dat" into table exim_department;		
-dfs -mkdir ../build/ql/test/data/exports/exim_department/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/exports/exim_department/temp;
 dfs -rmr ../build/ql/test/data/exports/exim_department;
 export table exim_department to 'ql/test/data/exports/exim_department';
 drop table exim_department;
diff --git a/ql/src/test/queries/clientpositive/exim_02_00_part_empty.q b/ql/src/test/queries/clientpositive/exim_02_00_part_empty.q
index 2d4eabd6b3..4017c83aa3 100644
--- a/ql/src/test/queries/clientpositive/exim_02_00_part_empty.q
+++ b/ql/src/test/queries/clientpositive/exim_02_00_part_empty.q
@@ -7,7 +7,7 @@ create table exim_employee ( emp_id int comment "employee id")
 	partitioned by (emp_country string comment "two char iso code", emp_state string comment "free text")
 	stored as textfile	
 	tblproperties("creator"="krishna");
-dfs -mkdir ../build/ql/test/data/exports/exim_employee/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/exports/exim_employee/temp;
 dfs -rmr ../build/ql/test/data/exports/exim_employee;
 export table exim_employee to 'ql/test/data/exports/exim_employee';
 drop table exim_employee;
diff --git a/ql/src/test/queries/clientpositive/exim_02_part.q b/ql/src/test/queries/clientpositive/exim_02_part.q
index 02086faf68..21138f0263 100644
--- a/ql/src/test/queries/clientpositive/exim_02_part.q
+++ b/ql/src/test/queries/clientpositive/exim_02_part.q
@@ -9,7 +9,7 @@ create table exim_employee ( emp_id int comment "employee id")
 	tblproperties("creator"="krishna");
 load data local inpath "../data/files/test.dat" 
 	into table exim_employee partition (emp_country="in", emp_state="tn");		
-dfs -mkdir ../build/ql/test/data/exports/exim_employee/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/exports/exim_employee/temp;
 dfs -rmr ../build/ql/test/data/exports/exim_employee;
 export table exim_employee to 'ql/test/data/exports/exim_employee';
 drop table exim_employee;
diff --git a/ql/src/test/queries/clientpositive/exim_03_nonpart_over_compat.q b/ql/src/test/queries/clientpositive/exim_03_nonpart_over_compat.q
index e20357407a..5f6bdee83c 100644
--- a/ql/src/test/queries/clientpositive/exim_03_nonpart_over_compat.q
+++ b/ql/src/test/queries/clientpositive/exim_03_nonpart_over_compat.q
@@ -6,7 +6,7 @@ create table exim_department ( dep_id int comment "department id")
 	stored as textfile	
 	tblproperties("creator"="krishna");
 load data local inpath "../data/files/test.dat" into table exim_department;
-dfs -mkdir ../build/ql/test/data/exports/exim_department/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/exports/exim_department/temp;
 dfs -rmr ../build/ql/test/data/exports/exim_department;
 export table exim_department to 'ql/test/data/exports/exim_department';
 drop table exim_department;
diff --git a/ql/src/test/queries/clientpositive/exim_04_all_part.q b/ql/src/test/queries/clientpositive/exim_04_all_part.q
index fa6cc245ec..69c6faa30a 100644
--- a/ql/src/test/queries/clientpositive/exim_04_all_part.q
+++ b/ql/src/test/queries/clientpositive/exim_04_all_part.q
@@ -15,7 +15,7 @@ load data local inpath "../data/files/test.dat"
 	into table exim_employee partition (emp_country="us", emp_state="tn");	
 load data local inpath "../data/files/test.dat" 
 	into table exim_employee partition (emp_country="us", emp_state="ka");		
-dfs -mkdir ../build/ql/test/data/exports/exim_employee/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/exports/exim_employee/temp;
 dfs -rmr ../build/ql/test/data/exports/exim_employee;
 export table exim_employee to 'ql/test/data/exports/exim_employee';
 drop table exim_employee;
diff --git a/ql/src/test/queries/clientpositive/exim_04_evolved_parts.q b/ql/src/test/queries/clientpositive/exim_04_evolved_parts.q
index ae1ed6fc42..cdc02fa25c 100644
--- a/ql/src/test/queries/clientpositive/exim_04_evolved_parts.q
+++ b/ql/src/test/queries/clientpositive/exim_04_evolved_parts.q
@@ -19,7 +19,7 @@ alter table exim_employee set fileformat
 	outputformat "org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat";
 
 alter table exim_employee add partition (emp_country='in', emp_state='ka');
-dfs -mkdir ../build/ql/test/data/exports/exim_employee/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/exports/exim_employee/temp;
 dfs -rmr ../build/ql/test/data/exports/exim_employee;
 export table exim_employee to 'ql/test/data/exports/exim_employee';
 drop table exim_employee;
diff --git a/ql/src/test/queries/clientpositive/exim_05_some_part.q b/ql/src/test/queries/clientpositive/exim_05_some_part.q
index 254901fe55..50a59463b1 100644
--- a/ql/src/test/queries/clientpositive/exim_05_some_part.q
+++ b/ql/src/test/queries/clientpositive/exim_05_some_part.q
@@ -15,7 +15,7 @@ load data local inpath "../data/files/test.dat"
 	into table exim_employee partition (emp_country="us", emp_state="tn");	
 load data local inpath "../data/files/test.dat" 
 	into table exim_employee partition (emp_country="us", emp_state="ka");		
-dfs -mkdir ../build/ql/test/data/exports/exim_employee/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/exports/exim_employee/temp;
 dfs -rmr ../build/ql/test/data/exports/exim_employee;
 export table exim_employee partition (emp_state="ka") to 'ql/test/data/exports/exim_employee';
 drop table exim_employee;
diff --git a/ql/src/test/queries/clientpositive/exim_06_one_part.q b/ql/src/test/queries/clientpositive/exim_06_one_part.q
index e6010eb2ec..5136090929 100644
--- a/ql/src/test/queries/clientpositive/exim_06_one_part.q
+++ b/ql/src/test/queries/clientpositive/exim_06_one_part.q
@@ -15,7 +15,7 @@ load data local inpath "../data/files/test.dat"
 	into table exim_employee partition (emp_country="us", emp_state="tn");	
 load data local inpath "../data/files/test.dat" 
 	into table exim_employee partition (emp_country="us", emp_state="ka");		
-dfs -mkdir ../build/ql/test/data/exports/exim_employee/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/exports/exim_employee/temp;
 dfs -rmr ../build/ql/test/data/exports/exim_employee;
 export table exim_employee partition (emp_country="in",emp_state="ka") to 'ql/test/data/exports/exim_employee';
 drop table exim_employee;
diff --git a/ql/src/test/queries/clientpositive/exim_07_all_part_over_nonoverlap.q b/ql/src/test/queries/clientpositive/exim_07_all_part_over_nonoverlap.q
index aa8d739342..5b9d4ddc03 100644
--- a/ql/src/test/queries/clientpositive/exim_07_all_part_over_nonoverlap.q
+++ b/ql/src/test/queries/clientpositive/exim_07_all_part_over_nonoverlap.q
@@ -15,7 +15,7 @@ load data local inpath "../data/files/test.dat"
 	into table exim_employee partition (emp_country="us", emp_state="tn");	
 load data local inpath "../data/files/test.dat" 
 	into table exim_employee partition (emp_country="us", emp_state="ka");		
-dfs -mkdir ../build/ql/test/data/exports/exim_employee/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/exports/exim_employee/temp;
 dfs -rmr ../build/ql/test/data/exports/exim_employee;
 export table exim_employee to 'ql/test/data/exports/exim_employee';
 drop table exim_employee;
diff --git a/ql/src/test/queries/clientpositive/exim_08_nonpart_rename.q b/ql/src/test/queries/clientpositive/exim_08_nonpart_rename.q
index 759b0eb565..173f1569c5 100644
--- a/ql/src/test/queries/clientpositive/exim_08_nonpart_rename.q
+++ b/ql/src/test/queries/clientpositive/exim_08_nonpart_rename.q
@@ -6,7 +6,7 @@ create table exim_department ( dep_id int comment "department id")
 	stored as textfile	
 	tblproperties("creator"="krishna");
 load data local inpath "../data/files/test.dat" into table exim_department;		
-dfs -mkdir ../build/ql/test/data/exports/exim_department/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/exports/exim_department/temp;
 dfs -rmr ../build/ql/test/data/exports/exim_department;
 export table exim_department to 'ql/test/data/exports/exim_department';
 drop table exim_department;
diff --git a/ql/src/test/queries/clientpositive/exim_09_part_spec_nonoverlap.q b/ql/src/test/queries/clientpositive/exim_09_part_spec_nonoverlap.q
index 293ea91a58..178b76674d 100644
--- a/ql/src/test/queries/clientpositive/exim_09_part_spec_nonoverlap.q
+++ b/ql/src/test/queries/clientpositive/exim_09_part_spec_nonoverlap.q
@@ -15,7 +15,7 @@ load data local inpath "../data/files/test.dat"
 	into table exim_employee partition (emp_country="us", emp_state="tn");	
 load data local inpath "../data/files/test.dat" 
 	into table exim_employee partition (emp_country="us", emp_state="ka");		
-dfs -mkdir ../build/ql/test/data/exports/exim_employee/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/exports/exim_employee/temp;
 dfs -rmr ../build/ql/test/data/exports/exim_employee;
 export table exim_employee to 'ql/test/data/exports/exim_employee';
 drop table exim_employee;
diff --git a/ql/src/test/queries/clientpositive/exim_10_external_managed.q b/ql/src/test/queries/clientpositive/exim_10_external_managed.q
index 75254a20a2..413f2aa476 100644
--- a/ql/src/test/queries/clientpositive/exim_10_external_managed.q
+++ b/ql/src/test/queries/clientpositive/exim_10_external_managed.q
@@ -2,14 +2,14 @@ set hive.test.mode=true;
 set hive.test.mode.prefix=;
 set hive.test.mode.nosamplelist=exim_department,exim_employee;
 
-dfs -mkdir ../build/ql/test/data/tablestore/exim_department/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/tablestore/exim_department/temp;
 dfs -rmr ../build/ql/test/data/tablestore/exim_department;
 create external table exim_department ( dep_id int comment "department id") 	
 	stored as textfile	
 	location 'ql/test/data/tablestore/exim_department'
 	tblproperties("creator"="krishna");
 load data local inpath "../data/files/test.dat" into table exim_department;		
-dfs -mkdir ../build/ql/test/data/exports/exim_department/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/exports/exim_department/temp;
 dfs -rmr ../build/ql/test/data/exports/exim_department;
 export table exim_department to 'ql/test/data/exports/exim_department';
 drop table exim_department;
diff --git a/ql/src/test/queries/clientpositive/exim_11_managed_external.q b/ql/src/test/queries/clientpositive/exim_11_managed_external.q
index b53bc0aa9f..f3b2896a32 100644
--- a/ql/src/test/queries/clientpositive/exim_11_managed_external.q
+++ b/ql/src/test/queries/clientpositive/exim_11_managed_external.q
@@ -6,7 +6,7 @@ create table exim_department ( dep_id int comment "department id")
 	stored as textfile	
 	tblproperties("creator"="krishna");
 load data local inpath "../data/files/test.dat" into table exim_department;		
-dfs -mkdir ../build/ql/test/data/exports/exim_department/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/exports/exim_department/temp;
 dfs -rmr ../build/ql/test/data/exports/exim_department;
 export table exim_department to 'ql/test/data/exports/exim_department';
 drop table exim_department;
diff --git a/ql/src/test/queries/clientpositive/exim_12_external_location.q b/ql/src/test/queries/clientpositive/exim_12_external_location.q
index 314956a7e7..37d063432e 100644
--- a/ql/src/test/queries/clientpositive/exim_12_external_location.q
+++ b/ql/src/test/queries/clientpositive/exim_12_external_location.q
@@ -6,7 +6,7 @@ create table exim_department ( dep_id int comment "department id")
 	stored as textfile	
 	tblproperties("creator"="krishna");
 load data local inpath "../data/files/test.dat" into table exim_department;		
-dfs -mkdir ../build/ql/test/data/exports/exim_department/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/exports/exim_department/temp;
 dfs -rmr ../build/ql/test/data/exports/exim_department;
 export table exim_department to 'ql/test/data/exports/exim_department';
 drop table exim_department;
@@ -14,7 +14,7 @@ drop table exim_department;
 create database importer;
 use importer;
 
-dfs -mkdir ../build/ql/test/data/tablestore/exim_department/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/tablestore/exim_department/temp;
 dfs -rmr ../build/ql/test/data/tablestore/exim_department;
 
 import external table exim_department from 'ql/test/data/exports/exim_department' 
diff --git a/ql/src/test/queries/clientpositive/exim_13_managed_location.q b/ql/src/test/queries/clientpositive/exim_13_managed_location.q
index 24363691dc..fb5058b840 100644
--- a/ql/src/test/queries/clientpositive/exim_13_managed_location.q
+++ b/ql/src/test/queries/clientpositive/exim_13_managed_location.q
@@ -6,7 +6,7 @@ create table exim_department ( dep_id int comment "department id")
 	stored as textfile	
 	tblproperties("creator"="krishna");
 load data local inpath "../data/files/test.dat" into table exim_department;		
-dfs -mkdir ../build/ql/test/data/exports/exim_department/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/exports/exim_department/temp;
 dfs -rmr ../build/ql/test/data/exports/exim_department;
 export table exim_department to 'ql/test/data/exports/exim_department';
 drop table exim_department;
@@ -14,7 +14,7 @@ drop table exim_department;
 create database importer;
 use importer;
 
-dfs -mkdir ../build/ql/test/data/tablestore/exim_department/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/tablestore/exim_department/temp;
 dfs -rmr ../build/ql/test/data/tablestore/exim_department;
 
 import table exim_department from 'ql/test/data/exports/exim_department' 
diff --git a/ql/src/test/queries/clientpositive/exim_14_managed_location_over_existing.q b/ql/src/test/queries/clientpositive/exim_14_managed_location_over_existing.q
index d227eb3e78..031b6bda6c 100644
--- a/ql/src/test/queries/clientpositive/exim_14_managed_location_over_existing.q
+++ b/ql/src/test/queries/clientpositive/exim_14_managed_location_over_existing.q
@@ -6,7 +6,7 @@ create table exim_department ( dep_id int comment "department id")
 	stored as textfile	
 	tblproperties("creator"="krishna");
 load data local inpath "../data/files/test.dat" into table exim_department;		
-dfs -mkdir ../build/ql/test/data/exports/exim_department/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/exports/exim_department/temp;
 dfs -rmr ../build/ql/test/data/exports/exim_department;
 export table exim_department to 'ql/test/data/exports/exim_department';
 drop table exim_department;
@@ -14,7 +14,7 @@ drop table exim_department;
 create database importer;
 use importer;
 
-dfs -mkdir ../build/ql/test/data/tablestore/exim_department/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/tablestore/exim_department/temp;
 dfs -rmr ../build/ql/test/data/tablestore/exim_department;
 
 create table exim_department ( dep_id int comment "department id") 	
diff --git a/ql/src/test/queries/clientpositive/exim_15_external_part.q b/ql/src/test/queries/clientpositive/exim_15_external_part.q
index a4778dfd69..ff088c70d7 100644
--- a/ql/src/test/queries/clientpositive/exim_15_external_part.q
+++ b/ql/src/test/queries/clientpositive/exim_15_external_part.q
@@ -15,7 +15,7 @@ load data local inpath "../data/files/test.dat"
 	into table exim_employee partition (emp_country="us", emp_state="tn");	
 load data local inpath "../data/files/test.dat" 
 	into table exim_employee partition (emp_country="us", emp_state="ka");		
-dfs -mkdir ../build/ql/test/data/exports/exim_employee/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/exports/exim_employee/temp;
 dfs -rmr ../build/ql/test/data/exports/exim_employee;
 export table exim_employee to 'ql/test/data/exports/exim_employee';
 drop table exim_employee;
@@ -23,7 +23,7 @@ drop table exim_employee;
 create database importer;
 use importer;
 
-dfs -mkdir ../build/ql/test/data/tablestore/exim_employee/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/tablestore/exim_employee/temp;
 dfs -rmr ../build/ql/test/data/tablestore/exim_employee;
 
 create external table exim_employee ( emp_id int comment "employee id") 	
diff --git a/ql/src/test/queries/clientpositive/exim_16_part_external.q b/ql/src/test/queries/clientpositive/exim_16_part_external.q
index e02ad5d003..6f4ee7a01c 100644
--- a/ql/src/test/queries/clientpositive/exim_16_part_external.q
+++ b/ql/src/test/queries/clientpositive/exim_16_part_external.q
@@ -15,7 +15,7 @@ load data local inpath "../data/files/test.dat"
 	into table exim_employee partition (emp_country="us", emp_state="tn");	
 load data local inpath "../data/files/test.dat" 
 	into table exim_employee partition (emp_country="us", emp_state="ka");		
-dfs -mkdir ../build/ql/test/data/exports/exim_employee/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/exports/exim_employee/temp;
 dfs -rmr ../build/ql/test/data/exports/exim_employee;
 export table exim_employee to 'ql/test/data/exports/exim_employee';
 drop table exim_employee;
@@ -23,9 +23,9 @@ drop table exim_employee;
 create database importer;
 use importer;
 
-dfs -mkdir ../build/ql/test/data/tablestore/exim_employee/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/tablestore/exim_employee/temp;
 dfs -rmr ../build/ql/test/data/tablestore/exim_employee;
-dfs -mkdir ../build/ql/test/data/tablestore2/exim_employee/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/tablestore2/exim_employee/temp;
 dfs -rmr ../build/ql/test/data/tablestore2/exim_employee;
 
 create external table exim_employee ( emp_id int comment "employee id") 	
diff --git a/ql/src/test/queries/clientpositive/exim_17_part_managed.q b/ql/src/test/queries/clientpositive/exim_17_part_managed.q
index ce2df6dee6..56ec152948 100644
--- a/ql/src/test/queries/clientpositive/exim_17_part_managed.q
+++ b/ql/src/test/queries/clientpositive/exim_17_part_managed.q
@@ -15,7 +15,7 @@ load data local inpath "../data/files/test.dat"
 	into table exim_employee partition (emp_country="us", emp_state="tn");	
 load data local inpath "../data/files/test.dat" 
 	into table exim_employee partition (emp_country="us", emp_state="ka");		
-dfs -mkdir ../build/ql/test/data/exports/exim_employee/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/exports/exim_employee/temp;
 dfs -rmr ../build/ql/test/data/exports/exim_employee;
 export table exim_employee to 'ql/test/data/exports/exim_employee';
 drop table exim_employee;
@@ -23,7 +23,7 @@ drop table exim_employee;
 create database importer;
 use importer;
 
-dfs -mkdir ../build/ql/test/data/tablestore/exim_employee/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/tablestore/exim_employee/temp;
 dfs -rmr ../build/ql/test/data/tablestore/exim_employee;
 
 create table exim_employee ( emp_id int comment "employee id") 	
diff --git a/ql/src/test/queries/clientpositive/exim_18_part_external.q b/ql/src/test/queries/clientpositive/exim_18_part_external.q
index 9d094e5098..7aa1297dc7 100644
--- a/ql/src/test/queries/clientpositive/exim_18_part_external.q
+++ b/ql/src/test/queries/clientpositive/exim_18_part_external.q
@@ -15,7 +15,7 @@ load data local inpath "../data/files/test.dat"
 	into table exim_employee partition (emp_country="us", emp_state="tn");	
 load data local inpath "../data/files/test.dat" 
 	into table exim_employee partition (emp_country="us", emp_state="ka");		
-dfs -mkdir ../build/ql/test/data/exports/exim_employee/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/exports/exim_employee/temp;
 dfs -rmr ../build/ql/test/data/exports/exim_employee;
 export table exim_employee to 'ql/test/data/exports/exim_employee';
 drop table exim_employee;
diff --git a/ql/src/test/queries/clientpositive/exim_19_00_part_external_location.q b/ql/src/test/queries/clientpositive/exim_19_00_part_external_location.q
index 1193b95358..cb9f8efc08 100644
--- a/ql/src/test/queries/clientpositive/exim_19_00_part_external_location.q
+++ b/ql/src/test/queries/clientpositive/exim_19_00_part_external_location.q
@@ -11,7 +11,7 @@ load data local inpath "../data/files/test.dat"
 	into table exim_employee partition (emp_country="in", emp_state="tn");	
 load data local inpath "../data/files/test2.dat" 
 	into table exim_employee partition (emp_country="in", emp_state="ka");	
-dfs -mkdir ../build/ql/test/data/exports/exim_employee/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/exports/exim_employee/temp;
 dfs -rmr ../build/ql/test/data/exports/exim_employee;
 export table exim_employee to 'ql/test/data/exports/exim_employee';
 drop table exim_employee;
@@ -19,7 +19,7 @@ drop table exim_employee;
 create database importer;
 use importer;
 
-dfs -mkdir ../build/ql/test/data/tablestore/exim_employee/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/tablestore/exim_employee/temp;
 dfs -rmr ../build/ql/test/data/tablestore/exim_employee;
 
 import external table exim_employee 
diff --git a/ql/src/test/queries/clientpositive/exim_19_part_external_location.q b/ql/src/test/queries/clientpositive/exim_19_part_external_location.q
index e8cab5a4f8..bdbd19df70 100644
--- a/ql/src/test/queries/clientpositive/exim_19_part_external_location.q
+++ b/ql/src/test/queries/clientpositive/exim_19_part_external_location.q
@@ -15,7 +15,7 @@ load data local inpath "../data/files/test.dat"
 	into table exim_employee partition (emp_country="us", emp_state="tn");	
 load data local inpath "../data/files/test.dat" 
 	into table exim_employee partition (emp_country="us", emp_state="ka");		
-dfs -mkdir ../build/ql/test/data/exports/exim_employee/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/exports/exim_employee/temp;
 dfs -rmr ../build/ql/test/data/exports/exim_employee;
 export table exim_employee to 'ql/test/data/exports/exim_employee';
 drop table exim_employee;
@@ -23,7 +23,7 @@ drop table exim_employee;
 create database importer;
 use importer;
 
-dfs -mkdir ../build/ql/test/data/tablestore/exim_employee/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/tablestore/exim_employee/temp;
 dfs -rmr ../build/ql/test/data/tablestore/exim_employee;
 
 import external table exim_employee partition (emp_country="us", emp_state="tn") 
diff --git a/ql/src/test/queries/clientpositive/exim_20_part_managed_location.q b/ql/src/test/queries/clientpositive/exim_20_part_managed_location.q
index 385dcba02a..eb44961a9b 100644
--- a/ql/src/test/queries/clientpositive/exim_20_part_managed_location.q
+++ b/ql/src/test/queries/clientpositive/exim_20_part_managed_location.q
@@ -15,7 +15,7 @@ load data local inpath "../data/files/test.dat"
 	into table exim_employee partition (emp_country="us", emp_state="tn");	
 load data local inpath "../data/files/test.dat" 
 	into table exim_employee partition (emp_country="us", emp_state="ka");		
-dfs -mkdir ../build/ql/test/data/exports/exim_employee/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/exports/exim_employee/temp;
 dfs -rmr ../build/ql/test/data/exports/exim_employee;
 export table exim_employee to 'ql/test/data/exports/exim_employee';
 drop table exim_employee;
@@ -23,7 +23,7 @@ drop table exim_employee;
 create database importer;
 use importer;
 
-dfs -mkdir ../build/ql/test/data/tablestore/exim_employee/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/tablestore/exim_employee/temp;
 dfs -rmr ../build/ql/test/data/tablestore/exim_employee;
 
 import table exim_employee partition (emp_country="us", emp_state="tn") 
diff --git a/ql/src/test/queries/clientpositive/exim_21_export_authsuccess.q b/ql/src/test/queries/clientpositive/exim_21_export_authsuccess.q
index e61f388698..822ed70a38 100644
--- a/ql/src/test/queries/clientpositive/exim_21_export_authsuccess.q
+++ b/ql/src/test/queries/clientpositive/exim_21_export_authsuccess.q
@@ -7,7 +7,7 @@ load data local inpath "../data/files/test.dat" into table exim_department;
 set hive.security.authorization.enabled=true;
 
 grant Select on table exim_department to user hive_test_user;
-dfs -mkdir ../build/ql/test/data/exports/exim_department/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/exports/exim_department/temp;
 dfs -rmr ../build/ql/test/data/exports/exim_department;
 export table exim_department to 'ql/test/data/exports/exim_department';
 
diff --git a/ql/src/test/queries/clientpositive/exim_22_import_exist_authsuccess.q b/ql/src/test/queries/clientpositive/exim_22_import_exist_authsuccess.q
index 74d1391163..440d08d2dc 100644
--- a/ql/src/test/queries/clientpositive/exim_22_import_exist_authsuccess.q
+++ b/ql/src/test/queries/clientpositive/exim_22_import_exist_authsuccess.q
@@ -4,7 +4,7 @@ set hive.test.mode.nosamplelist=exim_department,exim_employee;
 
 create table exim_department ( dep_id int) stored as textfile;
 load data local inpath "../data/files/test.dat" into table exim_department;
-dfs -mkdir ../build/ql/test/data/exports/exim_department/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/exports/exim_department/temp;
 dfs -rmr ../build/ql/test/data/exports/exim_department;
 export table exim_department to 'ql/test/data/exports/exim_department';
 drop table exim_department;
diff --git a/ql/src/test/queries/clientpositive/exim_23_import_part_authsuccess.q b/ql/src/test/queries/clientpositive/exim_23_import_part_authsuccess.q
index f0e5a68452..30fc343dd8 100644
--- a/ql/src/test/queries/clientpositive/exim_23_import_part_authsuccess.q
+++ b/ql/src/test/queries/clientpositive/exim_23_import_part_authsuccess.q
@@ -9,7 +9,7 @@ create table exim_employee ( emp_id int comment "employee id")
 	tblproperties("creator"="krishna");
 load data local inpath "../data/files/test.dat" 
 	into table exim_employee partition (emp_country="in", emp_state="tn");
-dfs -mkdir ../build/ql/test/data/exports/exim_employee/temp;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/exports/exim_employee/temp;
 dfs -rmr ../build/ql/test/data/exports/exim_employee;
 export table exim_employee to 'ql/test/data/exports/exim_employee';
 drop table exim_employee;
diff --git a/ql/src/test/queries/clientpositive/exim_24_import_nonexist_authsuccess.q b/ql/src/test/queries/clientpositive/exim_24_import_nonexist_authsuccess.q
index eb981fe8a3..2dc5af6ce4 100644
--- a/ql/src/test/queries/clientpositive/exim_24_import_nonexist_authsuccess.q
+++ b/ql/src/test/queries/clientpositive/exim_24_import_nonexist_authsuccess.q
@@ -4,7 +4,7 @@ set hive.test.mode.nosamplelist=exim_department,exim_employee;
 
 create table exim_department ( dep_id int) stored as textfile;
 load data local inpath "../data/files/test.dat" into table exim_department;
-dfs -mkdir ../build/ql/test/data/exports/exim_department/test;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/exports/exim_department/test;
 dfs -rmr ../build/ql/test/data/exports/exim_department;
 export table exim_department to 'ql/test/data/exports/exim_department';
 drop table exim_department;
diff --git a/ql/src/test/queries/clientpositive/insertexternal1.q b/ql/src/test/queries/clientpositive/insertexternal1.q
index 52b0680b0c..9004a0cce8 100644
--- a/ql/src/test/queries/clientpositive/insertexternal1.q
+++ b/ql/src/test/queries/clientpositive/insertexternal1.q
@@ -2,9 +2,9 @@
 
 create table texternal(key string, val string) partitioned by (insertdate string);
 
-dfs -mkdir ${system:test.tmp.dir}/texternal/temp;
+dfs ${system:test.dfs.mkdir} ${system:test.tmp.dir}/texternal/temp;
 dfs -rmr ${system:test.tmp.dir}/texternal;
-dfs -mkdir ${system:test.tmp.dir}/texternal/2008-01-01;
+dfs ${system:test.dfs.mkdir} ${system:test.tmp.dir}/texternal/2008-01-01;
 
 alter table texternal add partition (insertdate='2008-01-01') location 'pfile://${system:test.tmp.dir}/texternal/2008-01-01';
 from src insert overwrite table texternal partition (insertdate='2008-01-01') select *;
diff --git a/ql/src/test/queries/clientpositive/metadata_export_drop.q b/ql/src/test/queries/clientpositive/metadata_export_drop.q
index e971884bec..41be152e78 100644
--- a/ql/src/test/queries/clientpositive/metadata_export_drop.q
+++ b/ql/src/test/queries/clientpositive/metadata_export_drop.q
@@ -1,5 +1,5 @@
 create table tmp_meta_export_listener_drop_test (foo string);
-dfs -mkdir ../build/ql/test/data/exports/HIVE-3427;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/exports/HIVE-3427;
 set hive.metastore.pre.event.listeners=org.apache.hadoop.hive.ql.parse.MetaDataExportListener;
 set hive.metadata.export.location=../build/ql/test/data/exports/HIVE-3427;
 set hive.move.exported.metadata.to.trash=false;
diff --git a/ql/src/test/queries/clientpositive/multi_insert.q b/ql/src/test/queries/clientpositive/multi_insert.q
index c8e60505dd..718211b968 100644
--- a/ql/src/test/queries/clientpositive/multi_insert.q
+++ b/ql/src/test/queries/clientpositive/multi_insert.q
@@ -196,7 +196,7 @@ select * from src_multi2 order by key, value;
 set hive.merge.mapfiles=false;
 set hive.merge.mapredfiles=false;
 
-dfs -mkdir ${system:test.tmp.dir}/hive_test/multiins_local/temp;
+dfs ${system:test.dfs.mkdir} ${system:test.tmp.dir}/hive_test/multiins_local/temp;
 dfs -rmr ${system:test.tmp.dir}/hive_test/multiins_local;
 
 explain
diff --git a/ql/src/test/queries/clientpositive/multi_insert_move_tasks_share_dependencies.q b/ql/src/test/queries/clientpositive/multi_insert_move_tasks_share_dependencies.q
index 4ac55b8fa2..e30992b2cd 100644
--- a/ql/src/test/queries/clientpositive/multi_insert_move_tasks_share_dependencies.q
+++ b/ql/src/test/queries/clientpositive/multi_insert_move_tasks_share_dependencies.q
@@ -196,7 +196,7 @@ select * from src_multi2 order by key, value;
 set hive.merge.mapfiles=false;
 set hive.merge.mapredfiles=false;
 
-dfs -mkdir ${system:test.tmp.dir}/hive_test/multiins_local/temp;
+dfs ${system:test.dfs.mkdir} ${system:test.tmp.dir}/hive_test/multiins_local/temp;
 dfs -rmr ${system:test.tmp.dir}/hive_test/multiins_local;
 
 explain
diff --git a/ql/src/test/queries/clientpositive/rename_external_partition_location.q b/ql/src/test/queries/clientpositive/rename_external_partition_location.q
index a49a425481..faebd55b05 100644
--- a/ql/src/test/queries/clientpositive/rename_external_partition_location.q
+++ b/ql/src/test/queries/clientpositive/rename_external_partition_location.q
@@ -1,5 +1,5 @@
 
-dfs -mkdir ${system:test.tmp.dir}/ex_table;
+dfs ${system:test.dfs.mkdir} ${system:test.tmp.dir}/ex_table;
 
 CREATE EXTERNAL TABLE ex_table ( key INT, value STRING)
     PARTITIONED BY (part STRING)
diff --git a/ql/src/test/queries/clientpositive/repair.q b/ql/src/test/queries/clientpositive/repair.q
index 2720d1f780..8d04d3e991 100644
--- a/ql/src/test/queries/clientpositive/repair.q
+++ b/ql/src/test/queries/clientpositive/repair.q
@@ -2,8 +2,8 @@ CREATE TABLE repairtable(col STRING) PARTITIONED BY (p1 STRING, p2 STRING);
 
 MSCK TABLE repairtable;
 
-dfs -mkdir ../build/ql/test/data/warehouse/repairtable/p1=a/p2=a;
-dfs -mkdir ../build/ql/test/data/warehouse/repairtable/p1=b/p2=a;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/warehouse/repairtable/p1=a/p2=a;
+dfs ${system:test.dfs.mkdir} ../build/ql/test/data/warehouse/repairtable/p1=b/p2=a;
 dfs -touchz ../build/ql/test/data/warehouse/repairtable/p1=b/p2=a/datafile;
 
 MSCK TABLE repairtable;
diff --git a/ql/src/test/queries/clientpositive/schemeAuthority.q b/ql/src/test/queries/clientpositive/schemeAuthority.q
index 22d6c37f74..c0e18c5688 100644
--- a/ql/src/test/queries/clientpositive/schemeAuthority.q
+++ b/ql/src/test/queries/clientpositive/schemeAuthority.q
@@ -1,5 +1,5 @@
-dfs -mkdir file:///tmp/test;
-dfs -mkdir hdfs:///tmp/test;
+dfs ${system:test.dfs.mkdir} file:///tmp/test;
+dfs ${system:test.dfs.mkdir} hdfs:///tmp/test;
 
 create external table dynPart (key string) partitioned by (value string) row format delimited fields terminated by '\\t' stored as textfile;
 insert overwrite local directory "/tmp/test" select key from src where (key = 10) order by key;
diff --git a/ql/src/test/queries/clientpositive/stats_noscan_2.q b/ql/src/test/queries/clientpositive/stats_noscan_2.q
index a1bdc604eb..c934fb2051 100644
--- a/ql/src/test/queries/clientpositive/stats_noscan_2.q
+++ b/ql/src/test/queries/clientpositive/stats_noscan_2.q
@@ -12,7 +12,7 @@ drop table anaylyze_external;
 -- 2 test partition
 -- prepare data
 create table texternal(key string, val string) partitioned by (insertdate string);
-dfs -mkdir ${system:test.tmp.dir}/texternal/2008-01-01;
+dfs ${system:test.dfs.mkdir} ${system:test.tmp.dir}/texternal/2008-01-01;
 alter table texternal add partition (insertdate='2008-01-01') location 'pfile://${system:test.tmp.dir}/texternal/2008-01-01';
 from src insert overwrite table texternal partition (insertdate='2008-01-01') select *;
 select count(*) from texternal where insertdate='2008-01-01';
