diff --git a/CHANGES.txt b/CHANGES.txt
index 3be7caa412..490a4675bf 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -199,3 +199,6 @@ Trunk (unreleased changes)
 
     HIVE-220. Incorrect log directory in TestMTQueries causing null pointer
     exception.  (Prasad Chakka via dhruba)
+
+    HIVE-230.  Fix for a Null Pointer Exception that occured while loading a 
+    table from a query that returns empty data.  (Prasad Chakka via dhruba)
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/MoveTask.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/MoveTask.java
index 846c673ce1..9fef655f65 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/MoveTask.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/MoveTask.java
@@ -124,7 +124,7 @@ public int execute() {
               Hive.get().getConf());
           dirs = fs.globStatus(new Path(tbd.getSourceDir()));
           files = new ArrayList<FileStatus>();
-          for (int i=0; i<dirs.length; i++) {
+          for (int i=0; (dirs != null && i<dirs.length); i++) {
             files.addAll(Arrays.asList(fs.listStatus(dirs[i].getPath())));
             // We only check one file, so exit the loop when we have at least one.
             if (files.size()>0) break;
diff --git a/ql/src/test/queries/clientpositive/insert1.q b/ql/src/test/queries/clientpositive/insert1.q
new file mode 100644
index 0000000000..b747f91320
--- /dev/null
+++ b/ql/src/test/queries/clientpositive/insert1.q
@@ -0,0 +1,7 @@
+drop table insert1;
+drop table insert2;
+create table insert1(key int, value string) stored as textfile;
+create table insert2(key int, value string) stored as textfile;
+insert overwrite table insert1 select a.key, a.value from insert2 a WHERE (a.key=-1);
+drop table insert1;
+drop table insert2;
diff --git a/ql/src/test/results/clientpositive/insert1.q.out b/ql/src/test/results/clientpositive/insert1.q.out
new file mode 100644
index 0000000000..e69de29bb2
