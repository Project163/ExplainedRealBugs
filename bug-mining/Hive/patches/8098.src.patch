diff --git a/itests/hive-unit/src/test/java/org/apache/hadoop/hive/ql/security/authorization/plugin/TestHiveAuthorizerCheckInvocation.java b/itests/hive-unit/src/test/java/org/apache/hadoop/hive/ql/security/authorization/plugin/TestHiveAuthorizerCheckInvocation.java
index 241ec9f6f0..3b7980d841 100644
--- a/itests/hive-unit/src/test/java/org/apache/hadoop/hive/ql/security/authorization/plugin/TestHiveAuthorizerCheckInvocation.java
+++ b/itests/hive-unit/src/test/java/org/apache/hadoop/hive/ql/security/authorization/plugin/TestHiveAuthorizerCheckInvocation.java
@@ -737,4 +737,28 @@ public void testKillQueryAuthorization() throws Exception {
     assertEquals("object name","hiveservice", dbObj.getObjectName());
   }
 
+  @Test
+  public void AddDropConstraints() throws Exception{
+    reset(mockedAuthorizer);
+    final String tableName = "foo_constraint_tbl";
+    driver.run("create table " + dbName+"."+tableName + "(eid int, yoj int)");
+
+    reset(mockedAuthorizer);
+    int status = driver.compile("Alter table "+dbName+"."+tableName +" ADD constraint c1_unique UNIQUE(eid) disable novalidate", true);
+    assertEquals(0, status);
+    Pair<List<HivePrivilegeObject>, List<HivePrivilegeObject>> io = getHivePrivilegeObjectInputs();
+    List<HivePrivilegeObject> inputs = io.getLeft();
+    assertEquals(1, inputs.size());
+    HivePrivilegeObject tableObj = inputs.get(0);
+    assertEquals("input type", HivePrivilegeObjectType.TABLE_OR_VIEW, tableObj.getType());
+
+    reset(mockedAuthorizer);
+    status = driver.compile("Alter table "+dbName+"."+tableName +" DROP constraint c1_unique", true);
+    assertEquals(0, status);
+    io = getHivePrivilegeObjectInputs();
+    inputs = io.getLeft();
+    assertEquals(1, inputs.size());
+    tableObj = inputs.get(0);
+    assertEquals("input type", HivePrivilegeObjectType.TABLE_OR_VIEW, tableObj.getType());
+  }
 }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/ddl/table/constraint/add/AlterTableAddConstraintAnalyzer.java b/ql/src/java/org/apache/hadoop/hive/ql/ddl/table/constraint/add/AlterTableAddConstraintAnalyzer.java
index 420ef53198..97022c1157 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/ddl/table/constraint/add/AlterTableAddConstraintAnalyzer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/ddl/table/constraint/add/AlterTableAddConstraintAnalyzer.java
@@ -82,11 +82,12 @@ protected void analyzeCommand(TableName tableName, Map<String, String> partition
     Constraints constraints =
         new Constraints(primaryKeys, foreignKeys, null, uniqueConstraints, null, checkConstraints);
     AlterTableAddConstraintDesc desc = new AlterTableAddConstraintDesc(tableName, null, constraints);
-    rootTasks.add(TaskFactory.get(new DDLWork(getInputs(), getOutputs(), desc)));
 
     Table table = getTable(tableName);
     if (AcidUtils.isTransactionalTable(table)) {
       setAcidDdlDesc(desc);
     }
+    addInputsOutputsAlterTable(tableName, partitionSpec, desc, desc.getType(), false);
+    rootTasks.add(TaskFactory.get(new DDLWork(getInputs(), getOutputs(), desc)));
   }
 }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/ddl/table/constraint/drop/AlterTableDropConstraintAnalyzer.java b/ql/src/java/org/apache/hadoop/hive/ql/ddl/table/constraint/drop/AlterTableDropConstraintAnalyzer.java
index 7e739aa72d..2dfa4c48de 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/ddl/table/constraint/drop/AlterTableDropConstraintAnalyzer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/ddl/table/constraint/drop/AlterTableDropConstraintAnalyzer.java
@@ -24,8 +24,12 @@
 import org.apache.hadoop.hive.ql.QueryState;
 import org.apache.hadoop.hive.ql.ddl.DDLWork;
 import org.apache.hadoop.hive.ql.ddl.table.AbstractAlterTableAnalyzer;
+import org.apache.hadoop.hive.ql.ddl.table.AlterTableType;
 import org.apache.hadoop.hive.ql.ddl.DDLSemanticAnalyzerFactory.DDLType;
 import org.apache.hadoop.hive.ql.exec.TaskFactory;
+import org.apache.hadoop.hive.ql.hooks.ReadEntity;
+import org.apache.hadoop.hive.ql.hooks.WriteEntity;
+import org.apache.hadoop.hive.ql.hooks.WriteEntity.WriteType;
 import org.apache.hadoop.hive.ql.io.AcidUtils;
 import org.apache.hadoop.hive.ql.metadata.Table;
 import org.apache.hadoop.hive.ql.parse.ASTNode;
@@ -47,11 +51,18 @@ protected void analyzeCommand(TableName tableName, Map<String, String> partition
     String constraintName = unescapeIdentifier(command.getChild(0).getText());
 
     AlterTableDropConstraintDesc desc = new AlterTableDropConstraintDesc(tableName, null, constraintName);
-    rootTasks.add(TaskFactory.get(new DDLWork(getInputs(), getOutputs(), desc)));
 
     Table table = getTable(tableName);
+    WriteEntity.WriteType writeType = null;
     if (AcidUtils.isTransactionalTable(table)) {
       setAcidDdlDesc(desc);
+      writeType = WriteType.DDL_EXCLUSIVE;
+    } else {
+      writeType = WriteEntity.determineAlterTableWriteType(AlterTableType.DROP_CONSTRAINT);
     }
+    inputs.add(new ReadEntity(table));
+    WriteEntity alterTableOutput = new WriteEntity(table, writeType);
+    outputs.add(alterTableOutput);
+    rootTasks.add(TaskFactory.get(new DDLWork(getInputs(), getOutputs(), desc)));
   }
 }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/hooks/WriteEntity.java b/ql/src/java/org/apache/hadoop/hive/ql/hooks/WriteEntity.java
index e383c345e9..677ef3062e 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/hooks/WriteEntity.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/hooks/WriteEntity.java
@@ -225,6 +225,7 @@ public static WriteType determineAlterTableWriteType(AlterTableType op) {
     case RENAME:
     case TRUNCATE:
     case MERGEFILES:
+    case ADD_CONSTRAINT:
     case DROP_CONSTRAINT:
     case OWNER:
       return WriteType.DDL_EXCLUSIVE;
diff --git a/ql/src/test/queries/clientpositive/groupby_join_pushdown.q b/ql/src/test/queries/clientpositive/groupby_join_pushdown.q
index 37ecd90bdb..e46afd2f12 100644
--- a/ql/src/test/queries/clientpositive/groupby_join_pushdown.q
+++ b/ql/src/test/queries/clientpositive/groupby_join_pushdown.q
@@ -56,20 +56,22 @@ SELECT   sum(f.cint), f.ctinyint
 FROM alltypesorc f JOIN alltypesorc g ON(f.ctinyint = g.ctinyint)
 GROUP BY f.ctinyint, g.ctinyint;
 
-ALTER TABLE alltypesorc ADD CONSTRAINT pk_alltypesorc_1 PRIMARY KEY (ctinyint) DISABLE RELY;
+CREATE TABLE alltypesorc_new AS SELECT * from alltypesorc;
+
+ALTER TABLE alltypesorc_new ADD CONSTRAINT pk_alltypesorc_1 PRIMARY KEY (ctinyint) DISABLE RELY;
 
 -- COLUMNS ARE UNIQUE, OPTIMIZATION IS NOT TRIGGERED
 explain
 SELECT sum(f.cint), f.ctinyint            
-FROM alltypesorc f JOIN alltypesorc g ON(f.ctinyint = g.ctinyint)
+FROM alltypesorc_new f JOIN alltypesorc_new g ON(f.ctinyint = g.ctinyint)
 GROUP BY f.ctinyint, g.ctinyint;
 
-ALTER TABLE alltypesorc DROP CONSTRAINT pk_alltypesorc_1;
+ALTER TABLE alltypesorc_new DROP CONSTRAINT pk_alltypesorc_1;
 
-ALTER TABLE alltypesorc ADD CONSTRAINT uk_alltypesorc_1 UNIQUE (ctinyint) DISABLE RELY;
+ALTER TABLE alltypesorc_new ADD CONSTRAINT uk_alltypesorc_1 UNIQUE (ctinyint) DISABLE RELY;
 
 -- COLUMNS ARE UNIQUE, OPTIMIZATION IS NOT TRIGGERED
 explain
 SELECT sum(f.cint), f.ctinyint            
-FROM alltypesorc f JOIN alltypesorc g ON(f.ctinyint = g.ctinyint)
+FROM alltypesorc_new f JOIN alltypesorc_new g ON(f.ctinyint = g.ctinyint)
 GROUP BY f.ctinyint, g.ctinyint;
diff --git a/ql/src/test/results/clientnegative/alter_table_constraint_duplicate_pk.q.out b/ql/src/test/results/clientnegative/alter_table_constraint_duplicate_pk.q.out
index 2417cdfbdb..6a5a746af8 100644
--- a/ql/src/test/results/clientnegative/alter_table_constraint_duplicate_pk.q.out
+++ b/ql/src/test/results/clientnegative/alter_table_constraint_duplicate_pk.q.out
@@ -8,4 +8,6 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@table1
 PREHOOK: query: alter table table1 add constraint pk4 primary key (b) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@table1
+PREHOOK: Output: default@table1
 FAILED: Execution Error, return code 40000 from org.apache.hadoop.hive.ql.ddl.DDLTask. MetaException(message: Primary key already exists for: hive.default.table1)
diff --git a/ql/src/test/results/clientnegative/alter_table_constraint_invalid_fk_col1.q.out b/ql/src/test/results/clientnegative/alter_table_constraint_invalid_fk_col1.q.out
index 2c319c9aae..94c0648a90 100644
--- a/ql/src/test/results/clientnegative/alter_table_constraint_invalid_fk_col1.q.out
+++ b/ql/src/test/results/clientnegative/alter_table_constraint_invalid_fk_col1.q.out
@@ -16,4 +16,6 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@table2
 PREHOOK: query: alter table table2 add constraint fk1 foreign key (c) references table1(a) disable novalidate
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@table2
+PREHOOK: Output: default@table2
 FAILED: Execution Error, return code 40000 from org.apache.hadoop.hive.ql.ddl.DDLTask. InvalidObjectException(message:Child column not found: c)
diff --git a/ql/src/test/results/clientnegative/alter_table_constraint_invalid_fk_col2.q.out b/ql/src/test/results/clientnegative/alter_table_constraint_invalid_fk_col2.q.out
index b0476811bc..9f584b8df7 100644
--- a/ql/src/test/results/clientnegative/alter_table_constraint_invalid_fk_col2.q.out
+++ b/ql/src/test/results/clientnegative/alter_table_constraint_invalid_fk_col2.q.out
@@ -16,4 +16,6 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@table2
 PREHOOK: query: alter table table2 add constraint fk1 foreign key (b) references table1(c) disable novalidate
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@table2
+PREHOOK: Output: default@table2
 FAILED: Execution Error, return code 40000 from org.apache.hadoop.hive.ql.ddl.DDLTask. InvalidObjectException(message:Parent column not found: c)
diff --git a/ql/src/test/results/clientnegative/alter_table_constraint_invalid_fk_tbl2.q.out b/ql/src/test/results/clientnegative/alter_table_constraint_invalid_fk_tbl2.q.out
index 2604954e3f..bff24a42af 100644
--- a/ql/src/test/results/clientnegative/alter_table_constraint_invalid_fk_tbl2.q.out
+++ b/ql/src/test/results/clientnegative/alter_table_constraint_invalid_fk_tbl2.q.out
@@ -16,4 +16,6 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@table2
 PREHOOK: query: alter table table2 add constraint fk1 foreign key (b) references table3(a) disable novalidate
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@table2
+PREHOOK: Output: default@table2
 FAILED: Execution Error, return code 40000 from org.apache.hadoop.hive.ql.ddl.DDLTask. InvalidObjectException(message:Parent table not found: table3)
diff --git a/ql/src/test/results/clientnegative/alter_table_constraint_invalid_pk_col.q.out b/ql/src/test/results/clientnegative/alter_table_constraint_invalid_pk_col.q.out
index 090fc654b4..3437e5fb32 100644
--- a/ql/src/test/results/clientnegative/alter_table_constraint_invalid_pk_col.q.out
+++ b/ql/src/test/results/clientnegative/alter_table_constraint_invalid_pk_col.q.out
@@ -8,4 +8,6 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@table1
 PREHOOK: query: alter table table1 add constraint pk1  primary key (c) disable novalidate
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@table1
+PREHOOK: Output: default@table1
 FAILED: Execution Error, return code 40000 from org.apache.hadoop.hive.ql.ddl.DDLTask. InvalidObjectException(message:Parent column not found: c)
diff --git a/ql/src/test/results/clientnegative/alter_table_constraint_invalid_ref.q.out b/ql/src/test/results/clientnegative/alter_table_constraint_invalid_ref.q.out
index 0cda4547af..c609812282 100644
--- a/ql/src/test/results/clientnegative/alter_table_constraint_invalid_ref.q.out
+++ b/ql/src/test/results/clientnegative/alter_table_constraint_invalid_ref.q.out
@@ -16,4 +16,6 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@table2
 PREHOOK: query: alter table table2 add constraint fk1 foreign key (a) references table1(b) disable novalidate
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@table2
+PREHOOK: Output: default@table2
 FAILED: Execution Error, return code 40000 from org.apache.hadoop.hive.ql.ddl.DDLTask. MetaException(message:Foreign key references b:string; but no corresponding primary key or unique key exists. Possible keys: [a:string;])
diff --git a/ql/src/test/results/clientnegative/create_with_constraints_duplicate_name.q.out b/ql/src/test/results/clientnegative/create_with_constraints_duplicate_name.q.out
index 38fbbc28bc..7369b73c8f 100644
--- a/ql/src/test/results/clientnegative/create_with_constraints_duplicate_name.q.out
+++ b/ql/src/test/results/clientnegative/create_with_constraints_duplicate_name.q.out
@@ -48,4 +48,6 @@ POSTHOOK: Output: database:db2
 POSTHOOK: Output: db2@t2
 PREHOOK: query: alter table t1 add constraint constraint_name foreign key (x) references t2(x) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: db2@t1
+PREHOOK: Output: db2@t1
 FAILED: Execution Error, return code 40000 from org.apache.hadoop.hive.ql.ddl.DDLTask. InvalidObjectException(message:Constraint name already exists: db2.t2.constraint_name)
diff --git a/ql/src/test/results/clientnegative/drop_invalid_constraint1.q.out b/ql/src/test/results/clientnegative/drop_invalid_constraint1.q.out
index c43be9486e..de89fab84a 100644
--- a/ql/src/test/results/clientnegative/drop_invalid_constraint1.q.out
+++ b/ql/src/test/results/clientnegative/drop_invalid_constraint1.q.out
@@ -8,8 +8,14 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@table1
 PREHOOK: query: ALTER TABLE table1 DROP CONSTRAINT pk1
 PREHOOK: type: ALTERTABLE_DROPCONSTRAINT
+PREHOOK: Input: default@table1
+PREHOOK: Output: default@table1
 POSTHOOK: query: ALTER TABLE table1 DROP CONSTRAINT pk1
 POSTHOOK: type: ALTERTABLE_DROPCONSTRAINT
+POSTHOOK: Input: default@table1
+POSTHOOK: Output: default@table1
 PREHOOK: query: ALTER TABLE table1 DROP CONSTRAINT pk1
 PREHOOK: type: ALTERTABLE_DROPCONSTRAINT
+PREHOOK: Input: default@table1
+PREHOOK: Output: default@table1
 FAILED: Execution Error, return code 40000 from org.apache.hadoop.hive.ql.ddl.DDLTask. InvalidObjectException(message:The constraint: pk1 does not exist for the associated table: default.table1)
diff --git a/ql/src/test/results/clientnegative/drop_invalid_constraint3.q.out b/ql/src/test/results/clientnegative/drop_invalid_constraint3.q.out
index 181153fcb2..c6409292a0 100644
--- a/ql/src/test/results/clientnegative/drop_invalid_constraint3.q.out
+++ b/ql/src/test/results/clientnegative/drop_invalid_constraint3.q.out
@@ -8,4 +8,6 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@table2
 PREHOOK: query: ALTER TABLE table2 DROP CONSTRAINT pk2
 PREHOOK: type: ALTERTABLE_DROPCONSTRAINT
+PREHOOK: Input: default@table2
+PREHOOK: Output: default@table2
 FAILED: Execution Error, return code 40000 from org.apache.hadoop.hive.ql.ddl.DDLTask. InvalidObjectException(message:The constraint: pk2 does not exist for the associated table: default.table2)
diff --git a/ql/src/test/results/clientnegative/drop_invalid_constraint4.q.out b/ql/src/test/results/clientnegative/drop_invalid_constraint4.q.out
index ed39a44053..447774f86d 100644
--- a/ql/src/test/results/clientnegative/drop_invalid_constraint4.q.out
+++ b/ql/src/test/results/clientnegative/drop_invalid_constraint4.q.out
@@ -16,4 +16,6 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@table2
 PREHOOK: query: ALTER TABLE table1 DROP CONSTRAINT pk2
 PREHOOK: type: ALTERTABLE_DROPCONSTRAINT
+PREHOOK: Input: default@table1
+PREHOOK: Output: default@table1
 FAILED: Execution Error, return code 40000 from org.apache.hadoop.hive.ql.ddl.DDLTask. InvalidObjectException(message:The constraint: pk2 does not exist for the associated table: default.table1)
diff --git a/ql/src/test/results/clientpositive/llap/acid_stats4.q.out b/ql/src/test/results/clientpositive/llap/acid_stats4.q.out
index d72773df0d..8a4299edb7 100644
--- a/ql/src/test/results/clientpositive/llap/acid_stats4.q.out
+++ b/ql/src/test/results/clientpositive/llap/acid_stats4.q.out
@@ -352,12 +352,20 @@ STAGE PLANS:
 
 PREHOOK: query: alter table stats_nonpart2 add constraint primary_key primary key (key2) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@stats_nonpart2
+PREHOOK: Output: default@stats_nonpart2
 POSTHOOK: query: alter table stats_nonpart2 add constraint primary_key primary key (key2) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@stats_nonpart2
+POSTHOOK: Output: default@stats_nonpart2
 PREHOOK: query: alter table stats_nonpart2 drop constraint primary_key
 PREHOOK: type: ALTERTABLE_DROPCONSTRAINT
+PREHOOK: Input: default@stats_nonpart2
+PREHOOK: Output: default@stats_nonpart2
 POSTHOOK: query: alter table stats_nonpart2 drop constraint primary_key
 POSTHOOK: type: ALTERTABLE_DROPCONSTRAINT
+POSTHOOK: Input: default@stats_nonpart2
+POSTHOOK: Output: default@stats_nonpart2
 PREHOOK: query: explain select count(key2) from stats_nonpart2
 PREHOOK: type: QUERY
 PREHOOK: Input: default@stats_nonpart2
diff --git a/ql/src/test/results/clientpositive/llap/cardinality_preserving_join_opt.q.out b/ql/src/test/results/clientpositive/llap/cardinality_preserving_join_opt.q.out
index 8dcb67dfd2..69dea69e50 100644
--- a/ql/src/test/results/clientpositive/llap/cardinality_preserving_join_opt.q.out
+++ b/ql/src/test/results/clientpositive/llap/cardinality_preserving_join_opt.q.out
@@ -122,8 +122,12 @@ POSTHOOK: Input: default@store_sales
 John	John Doe Doe	42.5	1	1
 PREHOOK: query: alter table store_sales add constraint pk_c primary key (ss_customer_sk) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@store_sales
+PREHOOK: Output: default@store_sales
 POSTHOOK: query: alter table store_sales add constraint pk_c primary key (ss_customer_sk) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@store_sales
+POSTHOOK: Output: default@store_sales
 PREHOOK: query: explain cbo
 select
     c_first_name,
@@ -192,12 +196,20 @@ POSTHOOK: Input: default@store_sales
 John	John Doe Doe	42.5	1	1
 PREHOOK: query: alter table store_sales drop constraint pk_c
 PREHOOK: type: ALTERTABLE_DROPCONSTRAINT
+PREHOOK: Input: default@store_sales
+PREHOOK: Output: default@store_sales
 POSTHOOK: query: alter table store_sales drop constraint pk_c
 POSTHOOK: type: ALTERTABLE_DROPCONSTRAINT
+POSTHOOK: Input: default@store_sales
+POSTHOOK: Output: default@store_sales
 PREHOOK: query: alter table customer add constraint pk_c primary key (c_customer_sk) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@customer
+PREHOOK: Output: default@customer
 POSTHOOK: query: alter table customer add constraint pk_c primary key (c_customer_sk) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@customer
+POSTHOOK: Output: default@customer
 PREHOOK: query: explain cbo
 select
     c_first_name,
@@ -264,8 +276,12 @@ POSTHOOK: Input: default@store_sales
 John	John Doe Doe	42.5	1	1
 PREHOOK: query: alter table store_sales add constraint pk_c primary key (ss_customer_sk) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@store_sales
+PREHOOK: Output: default@store_sales
 POSTHOOK: query: alter table store_sales add constraint pk_c primary key (ss_customer_sk) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@store_sales
+POSTHOOK: Output: default@store_sales
 PREHOOK: query: explain cbo
 select
     c_first_name,
diff --git a/ql/src/test/results/clientpositive/llap/check_constraint.q.out b/ql/src/test/results/clientpositive/llap/check_constraint.q.out
index 12d823a5de..9da980246b 100644
--- a/ql/src/test/results/clientpositive/llap/check_constraint.q.out
+++ b/ql/src/test/results/clientpositive/llap/check_constraint.q.out
@@ -420,8 +420,12 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@tmulti
 PREHOOK: query: explain alter table tmulti add constraint un1 UNIQUE (userName, numClicks) DISABLE
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@tmulti
+PREHOOK: Output: default@tmulti
 POSTHOOK: query: explain alter table tmulti add constraint un1 UNIQUE (userName, numClicks) DISABLE
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@tmulti
+POSTHOOK: Output: default@tmulti
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
@@ -432,8 +436,12 @@ STAGE PLANS:
 
 PREHOOK: query: alter table tmulti add constraint un1 UNIQUE (userName, numClicks) DISABLE
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@tmulti
+PREHOOK: Output: default@tmulti
 POSTHOOK: query: alter table tmulti add constraint un1 UNIQUE (userName, numClicks) DISABLE
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@tmulti
+POSTHOOK: Output: default@tmulti
 PREHOOK: query: DESC formatted tmulti
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@tmulti
@@ -582,12 +590,20 @@ POSTHOOK: type: TRUNCATETABLE
 POSTHOOK: Output: default@tmulti
 PREHOOK: query: alter table tmulti add constraint chk1 CHECK (userName != NULL)
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@tmulti
+PREHOOK: Output: default@tmulti
 POSTHOOK: query: alter table tmulti add constraint chk1 CHECK (userName != NULL)
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@tmulti
+POSTHOOK: Output: default@tmulti
 PREHOOK: query: alter table tmulti add constraint chk2 CHECK (numClicks <= 10000 AND userName != '')
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@tmulti
+PREHOOK: Output: default@tmulti
 POSTHOOK: query: alter table tmulti add constraint chk2 CHECK (numClicks <= 10000 AND userName != '')
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@tmulti
+POSTHOOK: Output: default@tmulti
 PREHOOK: query: DESC formatted tmulti
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@tmulti
@@ -2147,8 +2163,12 @@ POSTHOOK: Input: default@acid_uami_n0
 #### A masked pattern was here ####
 PREHOOK: query: explain ALTER table acid_uami_n0 drop constraint ch2
 PREHOOK: type: ALTERTABLE_DROPCONSTRAINT
+PREHOOK: Input: default@acid_uami_n0
+PREHOOK: Output: default@acid_uami_n0
 POSTHOOK: query: explain ALTER table acid_uami_n0 drop constraint ch2
 POSTHOOK: type: ALTERTABLE_DROPCONSTRAINT
+POSTHOOK: Input: default@acid_uami_n0
+POSTHOOK: Output: default@acid_uami_n0
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
@@ -2160,8 +2180,12 @@ STAGE PLANS:
 
 PREHOOK: query: ALTER table acid_uami_n0 drop constraint ch2
 PREHOOK: type: ALTERTABLE_DROPCONSTRAINT
+PREHOOK: Input: default@acid_uami_n0
+PREHOOK: Output: default@acid_uami_n0
 POSTHOOK: query: ALTER table acid_uami_n0 drop constraint ch2
 POSTHOOK: type: ALTERTABLE_DROPCONSTRAINT
+POSTHOOK: Input: default@acid_uami_n0
+POSTHOOK: Output: default@acid_uami_n0
 PREHOOK: query: explain update acid_uami_n0 set vc = 'apache_hive' where de = 893.14
 PREHOOK: type: QUERY
 PREHOOK: Input: default@acid_uami_n0
@@ -3170,8 +3194,12 @@ Column Name:b       	Check Value:b in(4,5)
 	 	 
 PREHOOK: query: ALTER TABLE numericDataType DROP CONSTRAINT check1
 PREHOOK: type: ALTERTABLE_DROPCONSTRAINT
+PREHOOK: Input: default@numericdatatype
+PREHOOK: Output: default@numericdatatype
 POSTHOOK: query: ALTER TABLE numericDataType DROP CONSTRAINT check1
 POSTHOOK: type: ALTERTABLE_DROPCONSTRAINT
+POSTHOOK: Input: default@numericdatatype
+POSTHOOK: Output: default@numericdatatype
 PREHOOK: query: DESC FORMATTED numericDataType
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@numericdatatype
@@ -3897,8 +3925,12 @@ POSTHOOK: Input: default@tbl1_n1
 a	69
 PREHOOK: query: ALTER TABLE tbl1_n1 add constraint chk2 CHECK (b < 100)
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@tbl1_n1
+PREHOOK: Output: default@tbl1_n1
 POSTHOOK: query: ALTER TABLE tbl1_n1 add constraint chk2 CHECK (b < 100)
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@tbl1_n1
+POSTHOOK: Output: default@tbl1_n1
 PREHOOK: query: desc formatted tbl1_n1
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@tbl1_n1
diff --git a/ql/src/test/results/clientpositive/llap/constraints_alter.q.out b/ql/src/test/results/clientpositive/llap/constraints_alter.q.out
index a66d148a14..ff198e9b6e 100644
--- a/ql/src/test/results/clientpositive/llap/constraints_alter.q.out
+++ b/ql/src/test/results/clientpositive/llap/constraints_alter.q.out
@@ -166,8 +166,12 @@ POSTHOOK: Input: default@key_constraints
 #### A masked pattern was here ####
 PREHOOK: query: alter table t1_n2939 add constraint t1_n2939_pk primary key (a_n2939) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@t1_n2939
+PREHOOK: Output: default@t1_n2939
 POSTHOOK: query: alter table t1_n2939 add constraint t1_n2939_pk primary key (a_n2939) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@t1_n2939
+POSTHOOK: Output: default@t1_n2939
 PREHOOK: query: select COLUMN_NAME from columns_v2 where column_name = 'a_n2939' or column_name = 'b_n2939' or column_name = 'c_n2939'
 PREHOOK: type: QUERY
 PREHOOK: Input: default@columns_v2
diff --git a/ql/src/test/results/clientpositive/llap/constraints_explain_ddl.q.out b/ql/src/test/results/clientpositive/llap/constraints_explain_ddl.q.out
index f217ec7a95..cdce79afe9 100644
--- a/ql/src/test/results/clientpositive/llap/constraints_explain_ddl.q.out
+++ b/ql/src/test/results/clientpositive/llap/constraints_explain_ddl.q.out
@@ -3555,8 +3555,12 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@store_sales
 PREHOOK: query: alter table customer add constraint pk_c primary key (c_customer_sk) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@customer
+PREHOOK: Output: default@customer
 POSTHOOK: query: alter table customer add constraint pk_c primary key (c_customer_sk) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@customer
+POSTHOOK: Output: default@customer
 PREHOOK: query: alter table customer change column c_customer_id c_customer_id string constraint cid_nn not null disable novalidate rely
 PREHOOK: type: ALTERTABLE_RENAMECOL
 PREHOOK: Input: default@customer
@@ -3567,16 +3571,28 @@ POSTHOOK: Input: default@customer
 POSTHOOK: Output: default@customer
 PREHOOK: query: alter table customer add constraint uk1 UNIQUE(c_customer_id) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@customer
+PREHOOK: Output: default@customer
 POSTHOOK: query: alter table customer add constraint uk1 UNIQUE(c_customer_id) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@customer
+POSTHOOK: Output: default@customer
 PREHOOK: query: alter table store_sales add constraint pk_ss primary key (ss_item_sk, ss_ticket_number) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@store_sales
+PREHOOK: Output: default@store_sales
 POSTHOOK: query: alter table store_sales add constraint pk_ss primary key (ss_item_sk, ss_ticket_number) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@store_sales
+POSTHOOK: Output: default@store_sales
 PREHOOK: query: alter table store_sales add constraint ss_c foreign key  (ss_customer_sk) references customer (c_customer_sk) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@store_sales
+PREHOOK: Output: default@store_sales
 POSTHOOK: query: alter table store_sales add constraint ss_c foreign key  (ss_customer_sk) references customer (c_customer_sk) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@store_sales
+POSTHOOK: Output: default@store_sales
 PREHOOK: query: explain ddl
 select c_customer_id
 from customer
@@ -9718,32 +9734,60 @@ STAGE PLANS:
 
 PREHOOK: query: ALTER TABLE table2_n8 DROP CONSTRAINT pk1
 PREHOOK: type: ALTERTABLE_DROPCONSTRAINT
+PREHOOK: Input: default@table2_n8
+PREHOOK: Output: default@table2_n8
 POSTHOOK: query: ALTER TABLE table2_n8 DROP CONSTRAINT pk1
 POSTHOOK: type: ALTERTABLE_DROPCONSTRAINT
+POSTHOOK: Input: default@table2_n8
+POSTHOOK: Output: default@table2_n8
 PREHOOK: query: ALTER TABLE table3_n1 DROP CONSTRAINT fk1
 PREHOOK: type: ALTERTABLE_DROPCONSTRAINT
+PREHOOK: Input: default@table3_n1
+PREHOOK: Output: default@table3_n1
 POSTHOOK: query: ALTER TABLE table3_n1 DROP CONSTRAINT fk1
 POSTHOOK: type: ALTERTABLE_DROPCONSTRAINT
+POSTHOOK: Input: default@table3_n1
+POSTHOOK: Output: default@table3_n1
 PREHOOK: query: ALTER TABLE table4_n0 DROP CONSTRAINT nn4_1
 PREHOOK: type: ALTERTABLE_DROPCONSTRAINT
+PREHOOK: Input: default@table4_n0
+PREHOOK: Output: default@table4_n0
 POSTHOOK: query: ALTER TABLE table4_n0 DROP CONSTRAINT nn4_1
 POSTHOOK: type: ALTERTABLE_DROPCONSTRAINT
+POSTHOOK: Input: default@table4_n0
+POSTHOOK: Output: default@table4_n0
 PREHOOK: query: ALTER TABLE table6_n3 DROP CONSTRAINT fk4
 PREHOOK: type: ALTERTABLE_DROPCONSTRAINT
+PREHOOK: Input: default@table6_n3
+PREHOOK: Output: default@table6_n3
 POSTHOOK: query: ALTER TABLE table6_n3 DROP CONSTRAINT fk4
 POSTHOOK: type: ALTERTABLE_DROPCONSTRAINT
+POSTHOOK: Input: default@table6_n3
+POSTHOOK: Output: default@table6_n3
 PREHOOK: query: ALTER TABLE table8 DROP CONSTRAINT pk8
 PREHOOK: type: ALTERTABLE_DROPCONSTRAINT
+PREHOOK: Input: default@table8
+PREHOOK: Output: default@table8
 POSTHOOK: query: ALTER TABLE table8 DROP CONSTRAINT pk8
 POSTHOOK: type: ALTERTABLE_DROPCONSTRAINT
+POSTHOOK: Input: default@table8
+POSTHOOK: Output: default@table8
 PREHOOK: query: ALTER TABLE table16 DROP CONSTRAINT nn16_1
 PREHOOK: type: ALTERTABLE_DROPCONSTRAINT
+PREHOOK: Input: default@table16
+PREHOOK: Output: default@table16
 POSTHOOK: query: ALTER TABLE table16 DROP CONSTRAINT nn16_1
 POSTHOOK: type: ALTERTABLE_DROPCONSTRAINT
+POSTHOOK: Input: default@table16
+POSTHOOK: Output: default@table16
 PREHOOK: query: ALTER TABLE table18 DROP CONSTRAINT uk18_1
 PREHOOK: type: ALTERTABLE_DROPCONSTRAINT
+PREHOOK: Input: default@table18
+PREHOOK: Output: default@table18
 POSTHOOK: query: ALTER TABLE table18 DROP CONSTRAINT uk18_1
 POSTHOOK: type: ALTERTABLE_DROPCONSTRAINT
+POSTHOOK: Input: default@table18
+POSTHOOK: Output: default@table18
 PREHOOK: query: explain ddl select * from table2_n8
 PREHOOK: type: QUERY
 PREHOOK: Input: default@table2_n8
@@ -10508,20 +10552,36 @@ STAGE PLANS:
 
 PREHOOK: query: ALTER TABLE table2_n8 ADD CONSTRAINT pkt2 PRIMARY KEY (a) DISABLE NOVALIDATE
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@table2_n8
+PREHOOK: Output: default@table2_n8
 POSTHOOK: query: ALTER TABLE table2_n8 ADD CONSTRAINT pkt2 PRIMARY KEY (a) DISABLE NOVALIDATE
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@table2_n8
+POSTHOOK: Output: default@table2_n8
 PREHOOK: query: ALTER TABLE table3_n1 ADD CONSTRAINT fk1 FOREIGN KEY (x) REFERENCES table2_n8(a) DISABLE NOVALIDATE RELY
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@table3_n1
+PREHOOK: Output: default@table3_n1
 POSTHOOK: query: ALTER TABLE table3_n1 ADD CONSTRAINT fk1 FOREIGN KEY (x) REFERENCES table2_n8(a) DISABLE NOVALIDATE RELY
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@table3_n1
+POSTHOOK: Output: default@table3_n1
 PREHOOK: query: ALTER TABLE table6_n3 ADD CONSTRAINT fk4 FOREIGN KEY (y) REFERENCES table1_n13(a) DISABLE NOVALIDATE
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@table6_n3
+PREHOOK: Output: default@table6_n3
 POSTHOOK: query: ALTER TABLE table6_n3 ADD CONSTRAINT fk4 FOREIGN KEY (y) REFERENCES table1_n13(a) DISABLE NOVALIDATE
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@table6_n3
+POSTHOOK: Output: default@table6_n3
 PREHOOK: query: ALTER TABLE table8 ADD CONSTRAINT pk8_2 PRIMARY KEY (a, b) DISABLE NOVALIDATE RELY
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@table8
+PREHOOK: Output: default@table8
 POSTHOOK: query: ALTER TABLE table8 ADD CONSTRAINT pk8_2 PRIMARY KEY (a, b) DISABLE NOVALIDATE RELY
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@table8
+POSTHOOK: Output: default@table8
 PREHOOK: query: ALTER TABLE table16 CHANGE a a STRING REFERENCES table4_n0(x) DISABLE NOVALIDATE
 PREHOOK: type: ALTERTABLE_RENAMECOL
 PREHOOK: Input: default@table16
@@ -10532,8 +10592,12 @@ POSTHOOK: Input: default@table16
 POSTHOOK: Output: default@table16
 PREHOOK: query: ALTER TABLE table18 ADD CONSTRAINT uk18_2 UNIQUE (a, b) DISABLE NOVALIDATE
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@table18
+PREHOOK: Output: default@table18
 POSTHOOK: query: ALTER TABLE table18 ADD CONSTRAINT uk18_2 UNIQUE (a, b) DISABLE NOVALIDATE
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@table18
+POSTHOOK: Output: default@table18
 PREHOOK: query: explain ddl select * from table2_n8
 PREHOOK: type: QUERY
 PREHOOK: Input: default@table2_n8
@@ -10992,8 +11056,12 @@ STAGE PLANS:
 
 PREHOOK: query: ALTER TABLE table12 DROP CONSTRAINT nn12_2
 PREHOOK: type: ALTERTABLE_DROPCONSTRAINT
+PREHOOK: Input: default@table12
+PREHOOK: Output: default@table12
 POSTHOOK: query: ALTER TABLE table12 DROP CONSTRAINT nn12_2
 POSTHOOK: type: ALTERTABLE_DROPCONSTRAINT
+POSTHOOK: Input: default@table12
+POSTHOOK: Output: default@table12
 PREHOOK: query: explain ddl select * from table12
 PREHOOK: type: QUERY
 PREHOOK: Input: default@table12
@@ -11190,8 +11258,12 @@ STAGE PLANS:
 
 PREHOOK: query: ALTER TABLE DbConstraint.Table2 DROP CONSTRAINT Pk1
 PREHOOK: type: ALTERTABLE_DROPCONSTRAINT
+PREHOOK: Input: dbconstraint@table2
+PREHOOK: Output: dbconstraint@table2
 POSTHOOK: query: ALTER TABLE DbConstraint.Table2 DROP CONSTRAINT Pk1
 POSTHOOK: type: ALTERTABLE_DROPCONSTRAINT
+POSTHOOK: Input: dbconstraint@table2
+POSTHOOK: Output: dbconstraint@table2
 PREHOOK: query: explain ddl select * from DbConstraint.Table2
 PREHOOK: type: QUERY
 PREHOOK: Input: dbconstraint@table2
@@ -11305,8 +11377,12 @@ STAGE PLANS:
 
 PREHOOK: query: ALTER TABLE DbConstraint.Table2 ADD CONSTRAINT Pk1 PRIMARY KEY (a) DISABLE NOVALIDATE
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: dbconstraint@table2
+PREHOOK: Output: dbconstraint@table2
 POSTHOOK: query: ALTER TABLE DbConstraint.Table2 ADD CONSTRAINT Pk1 PRIMARY KEY (a) DISABLE NOVALIDATE
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: dbconstraint@table2
+POSTHOOK: Output: dbconstraint@table2
 PREHOOK: query: explain ddl select * from DbConstraint.Table2
 PREHOOK: type: QUERY
 PREHOOK: Input: dbconstraint@table2
@@ -11363,8 +11439,12 @@ STAGE PLANS:
 
 PREHOOK: query: ALTER TABLE DbConstraint.Table2 ADD CONSTRAINT fkx FOREIGN KEY (b) REFERENCES table1_n13(a) DISABLE NOVALIDATE
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: dbconstraint@table2
+PREHOOK: Output: dbconstraint@table2
 POSTHOOK: query: ALTER TABLE DbConstraint.Table2 ADD CONSTRAINT fkx FOREIGN KEY (b) REFERENCES table1_n13(a) DISABLE NOVALIDATE
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: dbconstraint@table2
+POSTHOOK: Output: dbconstraint@table2
 PREHOOK: query: explain ddl select * from DbConstraint.Table2
 PREHOOK: type: QUERY
 PREHOOK: Input: dbconstraint@table2
@@ -11429,12 +11509,20 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@table23
 PREHOOK: query: ALTER TABLE table23 ADD CONSTRAINT fk23_1 FOREIGN KEY (a,b) REFERENCES table21(a,b) DISABLE NOVALIDATE RELY
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@table23
+PREHOOK: Output: default@table23
 POSTHOOK: query: ALTER TABLE table23 ADD CONSTRAINT fk23_1 FOREIGN KEY (a,b) REFERENCES table21(a,b) DISABLE NOVALIDATE RELY
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@table23
+POSTHOOK: Output: default@table23
 PREHOOK: query: ALTER TABLE table23 ADD CONSTRAINT pk23_1 PRIMARY KEY (b) DISABLE RELY
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@table23
+PREHOOK: Output: default@table23
 POSTHOOK: query: ALTER TABLE table23 ADD CONSTRAINT pk23_1 PRIMARY KEY (b) DISABLE RELY
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@table23
+POSTHOOK: Output: default@table23
 PREHOOK: query: explain ddl select * from table23
 PREHOOK: type: QUERY
 PREHOOK: Input: default@table23
diff --git a/ql/src/test/results/clientpositive/llap/constraints_optimization.q.out b/ql/src/test/results/clientpositive/llap/constraints_optimization.q.out
index 8cbf43b118..1e42b6da4e 100644
--- a/ql/src/test/results/clientpositive/llap/constraints_optimization.q.out
+++ b/ql/src/test/results/clientpositive/llap/constraints_optimization.q.out
@@ -2156,8 +2156,12 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@store_sales
 PREHOOK: query: alter table customer add constraint pk_c primary key (c_customer_sk) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@customer
+PREHOOK: Output: default@customer
 POSTHOOK: query: alter table customer add constraint pk_c primary key (c_customer_sk) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@customer
+POSTHOOK: Output: default@customer
 PREHOOK: query: alter table customer change column c_customer_id c_customer_id string constraint cid_nn not null disable novalidate rely
 PREHOOK: type: ALTERTABLE_RENAMECOL
 PREHOOK: Input: default@customer
@@ -2168,16 +2172,28 @@ POSTHOOK: Input: default@customer
 POSTHOOK: Output: default@customer
 PREHOOK: query: alter table customer add constraint uk1 UNIQUE(c_customer_id) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@customer
+PREHOOK: Output: default@customer
 POSTHOOK: query: alter table customer add constraint uk1 UNIQUE(c_customer_id) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@customer
+POSTHOOK: Output: default@customer
 PREHOOK: query: alter table store_sales add constraint pk_ss primary key (ss_item_sk, ss_ticket_number) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@store_sales
+PREHOOK: Output: default@store_sales
 POSTHOOK: query: alter table store_sales add constraint pk_ss primary key (ss_item_sk, ss_ticket_number) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@store_sales
+POSTHOOK: Output: default@store_sales
 PREHOOK: query: alter table store_sales add constraint ss_c foreign key  (ss_customer_sk) references customer (c_customer_sk) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@store_sales
+PREHOOK: Output: default@store_sales
 POSTHOOK: query: alter table store_sales add constraint ss_c foreign key  (ss_customer_sk) references customer (c_customer_sk) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@store_sales
+POSTHOOK: Output: default@store_sales
 PREHOOK: query: explain cbo
      select c_customer_id
      from customer
diff --git a/ql/src/test/results/clientpositive/llap/create_with_constraints.q.out b/ql/src/test/results/clientpositive/llap/create_with_constraints.q.out
index ba317581d5..db31de9806 100644
--- a/ql/src/test/results/clientpositive/llap/create_with_constraints.q.out
+++ b/ql/src/test/results/clientpositive/llap/create_with_constraints.q.out
@@ -1430,32 +1430,60 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: ALTER TABLE table2_n8 DROP CONSTRAINT pk1
 PREHOOK: type: ALTERTABLE_DROPCONSTRAINT
+PREHOOK: Input: default@table2_n8
+PREHOOK: Output: default@table2_n8
 POSTHOOK: query: ALTER TABLE table2_n8 DROP CONSTRAINT pk1
 POSTHOOK: type: ALTERTABLE_DROPCONSTRAINT
+POSTHOOK: Input: default@table2_n8
+POSTHOOK: Output: default@table2_n8
 PREHOOK: query: ALTER TABLE table3_n1 DROP CONSTRAINT fk1
 PREHOOK: type: ALTERTABLE_DROPCONSTRAINT
+PREHOOK: Input: default@table3_n1
+PREHOOK: Output: default@table3_n1
 POSTHOOK: query: ALTER TABLE table3_n1 DROP CONSTRAINT fk1
 POSTHOOK: type: ALTERTABLE_DROPCONSTRAINT
+POSTHOOK: Input: default@table3_n1
+POSTHOOK: Output: default@table3_n1
 PREHOOK: query: ALTER TABLE table4_n0 DROP CONSTRAINT nn4_1
 PREHOOK: type: ALTERTABLE_DROPCONSTRAINT
+PREHOOK: Input: default@table4_n0
+PREHOOK: Output: default@table4_n0
 POSTHOOK: query: ALTER TABLE table4_n0 DROP CONSTRAINT nn4_1
 POSTHOOK: type: ALTERTABLE_DROPCONSTRAINT
+POSTHOOK: Input: default@table4_n0
+POSTHOOK: Output: default@table4_n0
 PREHOOK: query: ALTER TABLE table6_n3 DROP CONSTRAINT fk4
 PREHOOK: type: ALTERTABLE_DROPCONSTRAINT
+PREHOOK: Input: default@table6_n3
+PREHOOK: Output: default@table6_n3
 POSTHOOK: query: ALTER TABLE table6_n3 DROP CONSTRAINT fk4
 POSTHOOK: type: ALTERTABLE_DROPCONSTRAINT
+POSTHOOK: Input: default@table6_n3
+POSTHOOK: Output: default@table6_n3
 PREHOOK: query: ALTER TABLE table8 DROP CONSTRAINT pk8
 PREHOOK: type: ALTERTABLE_DROPCONSTRAINT
+PREHOOK: Input: default@table8
+PREHOOK: Output: default@table8
 POSTHOOK: query: ALTER TABLE table8 DROP CONSTRAINT pk8
 POSTHOOK: type: ALTERTABLE_DROPCONSTRAINT
+POSTHOOK: Input: default@table8
+POSTHOOK: Output: default@table8
 PREHOOK: query: ALTER TABLE table16 DROP CONSTRAINT nn16_1
 PREHOOK: type: ALTERTABLE_DROPCONSTRAINT
+PREHOOK: Input: default@table16
+PREHOOK: Output: default@table16
 POSTHOOK: query: ALTER TABLE table16 DROP CONSTRAINT nn16_1
 POSTHOOK: type: ALTERTABLE_DROPCONSTRAINT
+POSTHOOK: Input: default@table16
+POSTHOOK: Output: default@table16
 PREHOOK: query: ALTER TABLE table18 DROP CONSTRAINT uk18_1
 PREHOOK: type: ALTERTABLE_DROPCONSTRAINT
+PREHOOK: Input: default@table18
+PREHOOK: Output: default@table18
 POSTHOOK: query: ALTER TABLE table18 DROP CONSTRAINT uk18_1
 POSTHOOK: type: ALTERTABLE_DROPCONSTRAINT
+POSTHOOK: Input: default@table18
+POSTHOOK: Output: default@table18
 PREHOOK: query: DESCRIBE EXTENDED table2_n8
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@table2_n8
@@ -1818,20 +1846,36 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: ALTER TABLE table2_n8 ADD CONSTRAINT pkt2 PRIMARY KEY (a) DISABLE NOVALIDATE
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@table2_n8
+PREHOOK: Output: default@table2_n8
 POSTHOOK: query: ALTER TABLE table2_n8 ADD CONSTRAINT pkt2 PRIMARY KEY (a) DISABLE NOVALIDATE
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@table2_n8
+POSTHOOK: Output: default@table2_n8
 PREHOOK: query: ALTER TABLE table3_n1 ADD CONSTRAINT fk1 FOREIGN KEY (x) REFERENCES table2_n8(a) DISABLE NOVALIDATE RELY
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@table3_n1
+PREHOOK: Output: default@table3_n1
 POSTHOOK: query: ALTER TABLE table3_n1 ADD CONSTRAINT fk1 FOREIGN KEY (x) REFERENCES table2_n8(a) DISABLE NOVALIDATE RELY
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@table3_n1
+POSTHOOK: Output: default@table3_n1
 PREHOOK: query: ALTER TABLE table6_n3 ADD CONSTRAINT fk4 FOREIGN KEY (y) REFERENCES table1_n13(a) DISABLE NOVALIDATE
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@table6_n3
+PREHOOK: Output: default@table6_n3
 POSTHOOK: query: ALTER TABLE table6_n3 ADD CONSTRAINT fk4 FOREIGN KEY (y) REFERENCES table1_n13(a) DISABLE NOVALIDATE
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@table6_n3
+POSTHOOK: Output: default@table6_n3
 PREHOOK: query: ALTER TABLE table8 ADD CONSTRAINT pk8_2 PRIMARY KEY (a, b) DISABLE NOVALIDATE RELY
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@table8
+PREHOOK: Output: default@table8
 POSTHOOK: query: ALTER TABLE table8 ADD CONSTRAINT pk8_2 PRIMARY KEY (a, b) DISABLE NOVALIDATE RELY
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@table8
+POSTHOOK: Output: default@table8
 PREHOOK: query: ALTER TABLE table16 CHANGE a a STRING REFERENCES table4_n0(x) DISABLE NOVALIDATE
 PREHOOK: type: ALTERTABLE_RENAMECOL
 PREHOOK: Input: default@table16
@@ -1842,8 +1886,12 @@ POSTHOOK: Input: default@table16
 POSTHOOK: Output: default@table16
 PREHOOK: query: ALTER TABLE table18 ADD CONSTRAINT uk18_2 UNIQUE (a, b) DISABLE NOVALIDATE
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@table18
+PREHOOK: Output: default@table18
 POSTHOOK: query: ALTER TABLE table18 ADD CONSTRAINT uk18_2 UNIQUE (a, b) DISABLE NOVALIDATE
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@table18
+POSTHOOK: Output: default@table18
 PREHOOK: query: DESCRIBE FORMATTED table2_n8
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@table2_n8
@@ -2233,8 +2281,12 @@ Column Name:        	b
 	 	 
 PREHOOK: query: ALTER TABLE table12 DROP CONSTRAINT nn12_2
 PREHOOK: type: ALTERTABLE_DROPCONSTRAINT
+PREHOOK: Input: default@table12
+PREHOOK: Output: default@table12
 POSTHOOK: query: ALTER TABLE table12 DROP CONSTRAINT nn12_2
 POSTHOOK: type: ALTERTABLE_DROPCONSTRAINT
+POSTHOOK: Input: default@table12
+POSTHOOK: Output: default@table12
 PREHOOK: query: DESCRIBE FORMATTED table12
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@table12
@@ -2367,8 +2419,12 @@ Column Name:        	b
 	 	 
 PREHOOK: query: ALTER TABLE DbConstraint.Table2 DROP CONSTRAINT Pk1
 PREHOOK: type: ALTERTABLE_DROPCONSTRAINT
+PREHOOK: Input: dbconstraint@table2
+PREHOOK: Output: dbconstraint@table2
 POSTHOOK: query: ALTER TABLE DbConstraint.Table2 DROP CONSTRAINT Pk1
 POSTHOOK: type: ALTERTABLE_DROPCONSTRAINT
+POSTHOOK: Input: dbconstraint@table2
+POSTHOOK: Output: dbconstraint@table2
 PREHOOK: query: DESCRIBE EXTENDED DbConstraint.Table2
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: dbconstraint@table2
@@ -2425,8 +2481,12 @@ Column Name:        	b
 	 	 
 PREHOOK: query: ALTER TABLE DbConstraint.Table2 ADD CONSTRAINT Pk1 PRIMARY KEY (a) DISABLE NOVALIDATE
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: dbconstraint@table2
+PREHOOK: Output: dbconstraint@table2
 POSTHOOK: query: ALTER TABLE DbConstraint.Table2 ADD CONSTRAINT Pk1 PRIMARY KEY (a) DISABLE NOVALIDATE
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: dbconstraint@table2
+POSTHOOK: Output: dbconstraint@table2
 PREHOOK: query: DESCRIBE FORMATTED DbConstraint.Table2
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: dbconstraint@table2
@@ -2477,8 +2537,12 @@ Column Name:        	b
 	 	 
 PREHOOK: query: ALTER TABLE DbConstraint.Table2 ADD CONSTRAINT fkx FOREIGN KEY (b) REFERENCES table1_n13(a) DISABLE NOVALIDATE
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: dbconstraint@table2
+PREHOOK: Output: dbconstraint@table2
 POSTHOOK: query: ALTER TABLE DbConstraint.Table2 ADD CONSTRAINT fkx FOREIGN KEY (b) REFERENCES table1_n13(a) DISABLE NOVALIDATE
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: dbconstraint@table2
+POSTHOOK: Output: dbconstraint@table2
 PREHOOK: query: DESCRIBE FORMATTED DbConstraint.Table2
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: dbconstraint@table2
@@ -2543,12 +2607,20 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@table23
 PREHOOK: query: ALTER TABLE table23 ADD CONSTRAINT fk23_1 FOREIGN KEY (a,b) REFERENCES table21(a,b) DISABLE NOVALIDATE RELY
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@table23
+PREHOOK: Output: default@table23
 POSTHOOK: query: ALTER TABLE table23 ADD CONSTRAINT fk23_1 FOREIGN KEY (a,b) REFERENCES table21(a,b) DISABLE NOVALIDATE RELY
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@table23
+POSTHOOK: Output: default@table23
 PREHOOK: query: ALTER TABLE table23 ADD CONSTRAINT pk23_1 PRIMARY KEY (b) DISABLE RELY
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@table23
+PREHOOK: Output: default@table23
 POSTHOOK: query: ALTER TABLE table23 ADD CONSTRAINT pk23_1 PRIMARY KEY (b) DISABLE RELY
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@table23
+POSTHOOK: Output: default@table23
 PREHOOK: query: DESCRIBE FORMATTED table23
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@table23
@@ -2621,8 +2693,12 @@ POSTHOOK: Lineage: numericdatatype_n0.e SCRIPT []
 POSTHOOK: Lineage: numericdatatype_n0.f SCRIPT []
 PREHOOK: query: ALTER TABLE numericDataType_n0 ADD CONSTRAINT uk1 UNIQUE(a,b) DISABLE NOVALIDATE
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@numericdatatype_n0
+PREHOOK: Output: default@numericdatatype_n0
 POSTHOOK: query: ALTER TABLE numericDataType_n0 ADD CONSTRAINT uk1 UNIQUE(a,b) DISABLE NOVALIDATE
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@numericdatatype_n0
+POSTHOOK: Output: default@numericdatatype_n0
 PREHOOK: query: DESC FORMATTED numericDataType_n0
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@numericdatatype_n0
diff --git a/ql/src/test/results/clientpositive/llap/default_constraint.q.out b/ql/src/test/results/clientpositive/llap/default_constraint.q.out
index 9cf320a8d3..48347175aa 100644
--- a/ql/src/test/results/clientpositive/llap/default_constraint.q.out
+++ b/ql/src/test/results/clientpositive/llap/default_constraint.q.out
@@ -1364,8 +1364,12 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@numericDataType_n1
 PREHOOK: query: ALTER TABLE numericDataType_n1 DROP CONSTRAINT tinyint_constraint
 PREHOOK: type: ALTERTABLE_DROPCONSTRAINT
+PREHOOK: Input: default@numericdatatype_n1
+PREHOOK: Output: default@numericdatatype_n1
 POSTHOOK: query: ALTER TABLE numericDataType_n1 DROP CONSTRAINT tinyint_constraint
 POSTHOOK: type: ALTERTABLE_DROPCONSTRAINT
+POSTHOOK: Input: default@numericdatatype_n1
+POSTHOOK: Output: default@numericdatatype_n1
 PREHOOK: query: DESC FORMATTED numericDataType_n1
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@numericdatatype_n1
@@ -1523,8 +1527,12 @@ POSTHOOK: Input: default@numericdatatype_n1
 NULL	456	2147483647	9223372036854775807	3.4E38	1234567.89
 PREHOOK: query: ALTER TABLE numericDataType_n1 ADD CONSTRAINT uk1 UNIQUE(a,b) DISABLE NOVALIDATE
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@numericdatatype_n1
+PREHOOK: Output: default@numericdatatype_n1
 POSTHOOK: query: ALTER TABLE numericDataType_n1 ADD CONSTRAINT uk1 UNIQUE(a,b) DISABLE NOVALIDATE
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@numericdatatype_n1
+POSTHOOK: Output: default@numericdatatype_n1
 PREHOOK: query: DESC FORMATTED numericDataType_n1
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@numericdatatype_n1
@@ -2036,8 +2044,12 @@ Column Name:a       	Default Value:127Y
 	 	 
 PREHOOK: query: ALTER TABLE numericDataType_n1 DROP CONSTRAINT default_constraint
 PREHOOK: type: ALTERTABLE_DROPCONSTRAINT
+PREHOOK: Input: default@numericdatatype_n1
+PREHOOK: Output: default@numericdatatype_n1
 POSTHOOK: query: ALTER TABLE numericDataType_n1 DROP CONSTRAINT default_constraint
 POSTHOOK: type: ALTERTABLE_DROPCONSTRAINT
+POSTHOOK: Input: default@numericdatatype_n1
+POSTHOOK: Output: default@numericdatatype_n1
 PREHOOK: query: DESC FORMATTED numericDataType_n1
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@numericdatatype_n1
@@ -2552,8 +2564,12 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@numericDataType_n1
 PREHOOK: query: ALTER TABLE numericDataType_n1 DROP CONSTRAINT tinyint_constraint
 PREHOOK: type: ALTERTABLE_DROPCONSTRAINT
+PREHOOK: Input: default@numericdatatype_n1
+PREHOOK: Output: default@numericdatatype_n1
 POSTHOOK: query: ALTER TABLE numericDataType_n1 DROP CONSTRAINT tinyint_constraint
 POSTHOOK: type: ALTERTABLE_DROPCONSTRAINT
+POSTHOOK: Input: default@numericdatatype_n1
+POSTHOOK: Output: default@numericdatatype_n1
 PREHOOK: query: DESC FORMATTED numericDataType_n1
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@numericdatatype_n1
@@ -2711,8 +2727,12 @@ POSTHOOK: Input: default@numericdatatype_n1
 NULL	456	2147483647	9223372036854775807	3.4E38	1234567.89
 PREHOOK: query: ALTER TABLE numericDataType_n1 ADD CONSTRAINT uk1 UNIQUE(a,b) DISABLE NOVALIDATE
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@numericdatatype_n1
+PREHOOK: Output: default@numericdatatype_n1
 POSTHOOK: query: ALTER TABLE numericDataType_n1 ADD CONSTRAINT uk1 UNIQUE(a,b) DISABLE NOVALIDATE
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@numericdatatype_n1
+POSTHOOK: Output: default@numericdatatype_n1
 PREHOOK: query: DESC FORMATTED numericDataType_n1
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@numericdatatype_n1
diff --git a/ql/src/test/results/clientpositive/llap/enforce_constraint_notnull.q.out b/ql/src/test/results/clientpositive/llap/enforce_constraint_notnull.q.out
index 21684e4177..1049fa41a2 100644
--- a/ql/src/test/results/clientpositive/llap/enforce_constraint_notnull.q.out
+++ b/ql/src/test/results/clientpositive/llap/enforce_constraint_notnull.q.out
@@ -3513,8 +3513,12 @@ POSTHOOK: Input: default@acid_uami_n1
 POSTHOOK: Output: default@acid_uami_n1
 PREHOOK: query: ALTER table acid_uami_n1 drop constraint nn1
 PREHOOK: type: ALTERTABLE_DROPCONSTRAINT
+PREHOOK: Input: default@acid_uami_n1
+PREHOOK: Output: default@acid_uami_n1
 POSTHOOK: query: ALTER table acid_uami_n1 drop constraint nn1
 POSTHOOK: type: ALTERTABLE_DROPCONSTRAINT
+POSTHOOK: Input: default@acid_uami_n1
+POSTHOOK: Output: default@acid_uami_n1
 PREHOOK: query: ALTER table acid_uami_n1 CHANGE i i int constraint nn0 not null enforced
 PREHOOK: type: ALTERTABLE_RENAMECOL
 PREHOOK: Input: default@acid_uami_n1
@@ -5941,8 +5945,12 @@ STAGE PLANS:
 
 PREHOOK: query: alter table table2_n3 drop constraint nn5
 PREHOOK: type: ALTERTABLE_DROPCONSTRAINT
+PREHOOK: Input: default@table2_n3
+PREHOOK: Output: default@table2_n3
 POSTHOOK: query: alter table table2_n3 drop constraint nn5
 POSTHOOK: type: ALTERTABLE_DROPCONSTRAINT
+POSTHOOK: Input: default@table2_n3
+POSTHOOK: Output: default@table2_n3
 PREHOOK: query: explain insert into table2_n3 values(2, 3)
 PREHOOK: type: QUERY
 PREHOOK: Input: _dummy_database@_dummy_table
diff --git a/ql/src/test/results/clientpositive/llap/groupby_join_pushdown.q.out b/ql/src/test/results/clientpositive/llap/groupby_join_pushdown.q.out
index 716ae9b149..a67ac4a71f 100644
--- a/ql/src/test/results/clientpositive/llap/groupby_join_pushdown.q.out
+++ b/ql/src/test/results/clientpositive/llap/groupby_join_pushdown.q.out
@@ -1356,23 +1356,49 @@ STAGE PLANS:
       Processor Tree:
         ListSink
 
-PREHOOK: query: ALTER TABLE alltypesorc ADD CONSTRAINT pk_alltypesorc_1 PRIMARY KEY (ctinyint) DISABLE RELY
+PREHOOK: query: CREATE TABLE alltypesorc_new AS SELECT * from alltypesorc
+PREHOOK: type: CREATETABLE_AS_SELECT
+PREHOOK: Input: default@alltypesorc
+PREHOOK: Output: database:default
+PREHOOK: Output: default@alltypesorc_new
+POSTHOOK: query: CREATE TABLE alltypesorc_new AS SELECT * from alltypesorc
+POSTHOOK: type: CREATETABLE_AS_SELECT
+POSTHOOK: Input: default@alltypesorc
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@alltypesorc_new
+POSTHOOK: Lineage: alltypesorc_new.cbigint SIMPLE [(alltypesorc)alltypesorc.FieldSchema(name:cbigint, type:bigint, comment:null), ]
+POSTHOOK: Lineage: alltypesorc_new.cboolean1 SIMPLE [(alltypesorc)alltypesorc.FieldSchema(name:cboolean1, type:boolean, comment:null), ]
+POSTHOOK: Lineage: alltypesorc_new.cboolean2 SIMPLE [(alltypesorc)alltypesorc.FieldSchema(name:cboolean2, type:boolean, comment:null), ]
+POSTHOOK: Lineage: alltypesorc_new.cdouble SIMPLE [(alltypesorc)alltypesorc.FieldSchema(name:cdouble, type:double, comment:null), ]
+POSTHOOK: Lineage: alltypesorc_new.cfloat SIMPLE [(alltypesorc)alltypesorc.FieldSchema(name:cfloat, type:float, comment:null), ]
+POSTHOOK: Lineage: alltypesorc_new.cint SIMPLE [(alltypesorc)alltypesorc.FieldSchema(name:cint, type:int, comment:null), ]
+POSTHOOK: Lineage: alltypesorc_new.csmallint SIMPLE [(alltypesorc)alltypesorc.FieldSchema(name:csmallint, type:smallint, comment:null), ]
+POSTHOOK: Lineage: alltypesorc_new.cstring1 SIMPLE [(alltypesorc)alltypesorc.FieldSchema(name:cstring1, type:string, comment:null), ]
+POSTHOOK: Lineage: alltypesorc_new.cstring2 SIMPLE [(alltypesorc)alltypesorc.FieldSchema(name:cstring2, type:string, comment:null), ]
+POSTHOOK: Lineage: alltypesorc_new.ctimestamp1 SIMPLE [(alltypesorc)alltypesorc.FieldSchema(name:ctimestamp1, type:timestamp, comment:null), ]
+POSTHOOK: Lineage: alltypesorc_new.ctimestamp2 SIMPLE [(alltypesorc)alltypesorc.FieldSchema(name:ctimestamp2, type:timestamp, comment:null), ]
+POSTHOOK: Lineage: alltypesorc_new.ctinyint SIMPLE [(alltypesorc)alltypesorc.FieldSchema(name:ctinyint, type:tinyint, comment:null), ]
+PREHOOK: query: ALTER TABLE alltypesorc_new ADD CONSTRAINT pk_alltypesorc_1 PRIMARY KEY (ctinyint) DISABLE RELY
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
-POSTHOOK: query: ALTER TABLE alltypesorc ADD CONSTRAINT pk_alltypesorc_1 PRIMARY KEY (ctinyint) DISABLE RELY
+PREHOOK: Input: default@alltypesorc_new
+PREHOOK: Output: default@alltypesorc_new
+POSTHOOK: query: ALTER TABLE alltypesorc_new ADD CONSTRAINT pk_alltypesorc_1 PRIMARY KEY (ctinyint) DISABLE RELY
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@alltypesorc_new
+POSTHOOK: Output: default@alltypesorc_new
 PREHOOK: query: explain
 SELECT sum(f.cint), f.ctinyint            
-FROM alltypesorc f JOIN alltypesorc g ON(f.ctinyint = g.ctinyint)
+FROM alltypesorc_new f JOIN alltypesorc_new g ON(f.ctinyint = g.ctinyint)
 GROUP BY f.ctinyint, g.ctinyint
 PREHOOK: type: QUERY
-PREHOOK: Input: default@alltypesorc
+PREHOOK: Input: default@alltypesorc_new
 #### A masked pattern was here ####
 POSTHOOK: query: explain
 SELECT sum(f.cint), f.ctinyint            
-FROM alltypesorc f JOIN alltypesorc g ON(f.ctinyint = g.ctinyint)
+FROM alltypesorc_new f JOIN alltypesorc_new g ON(f.ctinyint = g.ctinyint)
 GROUP BY f.ctinyint, g.ctinyint
 POSTHOOK: type: QUERY
-POSTHOOK: Input: default@alltypesorc
+POSTHOOK: Input: default@alltypesorc_new
 #### A masked pattern was here ####
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
@@ -1474,27 +1500,35 @@ STAGE PLANS:
       Processor Tree:
         ListSink
 
-PREHOOK: query: ALTER TABLE alltypesorc DROP CONSTRAINT pk_alltypesorc_1
+PREHOOK: query: ALTER TABLE alltypesorc_new DROP CONSTRAINT pk_alltypesorc_1
 PREHOOK: type: ALTERTABLE_DROPCONSTRAINT
-POSTHOOK: query: ALTER TABLE alltypesorc DROP CONSTRAINT pk_alltypesorc_1
+PREHOOK: Input: default@alltypesorc_new
+PREHOOK: Output: default@alltypesorc_new
+POSTHOOK: query: ALTER TABLE alltypesorc_new DROP CONSTRAINT pk_alltypesorc_1
 POSTHOOK: type: ALTERTABLE_DROPCONSTRAINT
-PREHOOK: query: ALTER TABLE alltypesorc ADD CONSTRAINT uk_alltypesorc_1 UNIQUE (ctinyint) DISABLE RELY
+POSTHOOK: Input: default@alltypesorc_new
+POSTHOOK: Output: default@alltypesorc_new
+PREHOOK: query: ALTER TABLE alltypesorc_new ADD CONSTRAINT uk_alltypesorc_1 UNIQUE (ctinyint) DISABLE RELY
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
-POSTHOOK: query: ALTER TABLE alltypesorc ADD CONSTRAINT uk_alltypesorc_1 UNIQUE (ctinyint) DISABLE RELY
+PREHOOK: Input: default@alltypesorc_new
+PREHOOK: Output: default@alltypesorc_new
+POSTHOOK: query: ALTER TABLE alltypesorc_new ADD CONSTRAINT uk_alltypesorc_1 UNIQUE (ctinyint) DISABLE RELY
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@alltypesorc_new
+POSTHOOK: Output: default@alltypesorc_new
 PREHOOK: query: explain
 SELECT sum(f.cint), f.ctinyint            
-FROM alltypesorc f JOIN alltypesorc g ON(f.ctinyint = g.ctinyint)
+FROM alltypesorc_new f JOIN alltypesorc_new g ON(f.ctinyint = g.ctinyint)
 GROUP BY f.ctinyint, g.ctinyint
 PREHOOK: type: QUERY
-PREHOOK: Input: default@alltypesorc
+PREHOOK: Input: default@alltypesorc_new
 #### A masked pattern was here ####
 POSTHOOK: query: explain
 SELECT sum(f.cint), f.ctinyint            
-FROM alltypesorc f JOIN alltypesorc g ON(f.ctinyint = g.ctinyint)
+FROM alltypesorc_new f JOIN alltypesorc_new g ON(f.ctinyint = g.ctinyint)
 GROUP BY f.ctinyint, g.ctinyint
 POSTHOOK: type: QUERY
-POSTHOOK: Input: default@alltypesorc
+POSTHOOK: Input: default@alltypesorc_new
 #### A masked pattern was here ####
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_parquet.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_parquet.q.out
index fb800e99fa..e6ba6642c6 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_parquet.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_parquet.q.out
@@ -110,28 +110,52 @@ POSTHOOK: Lineage: locations_parquet_n2.locationid SCRIPT []
 POSTHOOK: Lineage: locations_parquet_n2.name SCRIPT []
 PREHOOK: query: alter table emps_parquet_n3 add constraint pk1 primary key (empid) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@emps_parquet_n3
+PREHOOK: Output: default@emps_parquet_n3
 POSTHOOK: query: alter table emps_parquet_n3 add constraint pk1 primary key (empid) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@emps_parquet_n3
+POSTHOOK: Output: default@emps_parquet_n3
 PREHOOK: query: alter table depts_parquet_n2 add constraint pk2 primary key (deptno) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@depts_parquet_n2
+PREHOOK: Output: default@depts_parquet_n2
 POSTHOOK: query: alter table depts_parquet_n2 add constraint pk2 primary key (deptno) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@depts_parquet_n2
+POSTHOOK: Output: default@depts_parquet_n2
 PREHOOK: query: alter table dependents_parquet_n2 add constraint pk3 primary key (empid) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@dependents_parquet_n2
+PREHOOK: Output: default@dependents_parquet_n2
 POSTHOOK: query: alter table dependents_parquet_n2 add constraint pk3 primary key (empid) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@dependents_parquet_n2
+POSTHOOK: Output: default@dependents_parquet_n2
 PREHOOK: query: alter table locations_parquet_n2 add constraint pk4 primary key (locationid) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@locations_parquet_n2
+PREHOOK: Output: default@locations_parquet_n2
 POSTHOOK: query: alter table locations_parquet_n2 add constraint pk4 primary key (locationid) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@locations_parquet_n2
+POSTHOOK: Output: default@locations_parquet_n2
 PREHOOK: query: alter table emps_parquet_n3 add constraint fk1 foreign key (deptno) references depts_parquet_n2(deptno) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@emps_parquet_n3
+PREHOOK: Output: default@emps_parquet_n3
 POSTHOOK: query: alter table emps_parquet_n3 add constraint fk1 foreign key (deptno) references depts_parquet_n2(deptno) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@emps_parquet_n3
+POSTHOOK: Output: default@emps_parquet_n3
 PREHOOK: query: alter table depts_parquet_n2 add constraint fk2 foreign key (locationid) references locations_parquet_n2(locationid) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@depts_parquet_n2
+PREHOOK: Output: default@depts_parquet_n2
 POSTHOOK: query: alter table depts_parquet_n2 add constraint fk2 foreign key (locationid) references locations_parquet_n2(locationid) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@depts_parquet_n2
+POSTHOOK: Output: default@depts_parquet_n2
 PREHOOK: query: create materialized view mv1_parquet_n2
 TBLPROPERTIES ('transactional'='true', 'transactional_properties'='insert_only') as
 select * from emps_parquet_n3 where empid < 150
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_1.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_1.q.out
index c301a18a80..51054527a2 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_1.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_1.q.out
@@ -110,28 +110,52 @@ POSTHOOK: Lineage: locations_n2.locationid SCRIPT []
 POSTHOOK: Lineage: locations_n2.name SCRIPT []
 PREHOOK: query: alter table emps_n3 add constraint pk1 primary key (empid) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@emps_n3
+PREHOOK: Output: default@emps_n3
 POSTHOOK: query: alter table emps_n3 add constraint pk1 primary key (empid) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@emps_n3
+POSTHOOK: Output: default@emps_n3
 PREHOOK: query: alter table depts_n2 add constraint pk2 primary key (deptno) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@depts_n2
+PREHOOK: Output: default@depts_n2
 POSTHOOK: query: alter table depts_n2 add constraint pk2 primary key (deptno) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@depts_n2
+POSTHOOK: Output: default@depts_n2
 PREHOOK: query: alter table dependents_n2 add constraint pk3 primary key (empid) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@dependents_n2
+PREHOOK: Output: default@dependents_n2
 POSTHOOK: query: alter table dependents_n2 add constraint pk3 primary key (empid) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@dependents_n2
+POSTHOOK: Output: default@dependents_n2
 PREHOOK: query: alter table locations_n2 add constraint pk4 primary key (locationid) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@locations_n2
+PREHOOK: Output: default@locations_n2
 POSTHOOK: query: alter table locations_n2 add constraint pk4 primary key (locationid) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@locations_n2
+POSTHOOK: Output: default@locations_n2
 PREHOOK: query: alter table emps_n3 add constraint fk1 foreign key (deptno) references depts_n2(deptno) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@emps_n3
+PREHOOK: Output: default@emps_n3
 POSTHOOK: query: alter table emps_n3 add constraint fk1 foreign key (deptno) references depts_n2(deptno) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@emps_n3
+POSTHOOK: Output: default@emps_n3
 PREHOOK: query: alter table depts_n2 add constraint fk2 foreign key (locationid) references locations_n2(locationid) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@depts_n2
+PREHOOK: Output: default@depts_n2
 POSTHOOK: query: alter table depts_n2 add constraint fk2 foreign key (locationid) references locations_n2(locationid) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@depts_n2
+POSTHOOK: Output: default@depts_n2
 PREHOOK: query: create materialized view mv1_n2 as
 select * from emps_n3 where empid < 150
 PREHOOK: type: CREATE_MATERIALIZED_VIEW
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_2.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_2.q.out
index 4d1e85d9ce..a1a0352d0d 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_2.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_2.q.out
@@ -110,28 +110,52 @@ POSTHOOK: Lineage: locations_n0.locationid SCRIPT []
 POSTHOOK: Lineage: locations_n0.name SCRIPT []
 PREHOOK: query: alter table emps_n0 add constraint pk1 primary key (empid) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@emps_n0
+PREHOOK: Output: default@emps_n0
 POSTHOOK: query: alter table emps_n0 add constraint pk1 primary key (empid) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@emps_n0
+POSTHOOK: Output: default@emps_n0
 PREHOOK: query: alter table depts_n0 add constraint pk2 primary key (deptno) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@depts_n0
+PREHOOK: Output: default@depts_n0
 POSTHOOK: query: alter table depts_n0 add constraint pk2 primary key (deptno) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@depts_n0
+POSTHOOK: Output: default@depts_n0
 PREHOOK: query: alter table dependents_n0 add constraint pk3 primary key (empid) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@dependents_n0
+PREHOOK: Output: default@dependents_n0
 POSTHOOK: query: alter table dependents_n0 add constraint pk3 primary key (empid) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@dependents_n0
+POSTHOOK: Output: default@dependents_n0
 PREHOOK: query: alter table locations_n0 add constraint pk4 primary key (locationid) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@locations_n0
+PREHOOK: Output: default@locations_n0
 POSTHOOK: query: alter table locations_n0 add constraint pk4 primary key (locationid) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@locations_n0
+POSTHOOK: Output: default@locations_n0
 PREHOOK: query: alter table emps_n0 add constraint fk1 foreign key (deptno) references depts_n0(deptno) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@emps_n0
+PREHOOK: Output: default@emps_n0
 POSTHOOK: query: alter table emps_n0 add constraint fk1 foreign key (deptno) references depts_n0(deptno) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@emps_n0
+POSTHOOK: Output: default@emps_n0
 PREHOOK: query: alter table depts_n0 add constraint fk2 foreign key (locationid) references locations_n0(locationid) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@depts_n0
+PREHOOK: Output: default@depts_n0
 POSTHOOK: query: alter table depts_n0 add constraint fk2 foreign key (locationid) references locations_n0(locationid) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@depts_n0
+POSTHOOK: Output: default@depts_n0
 PREHOOK: query: create materialized view mv1_n0 as
 select empid, depts_n0.deptno from emps_n0
 join depts_n0 using (deptno) where depts_n0.deptno > 10
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_3.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_3.q.out
index b77f6922f7..94af6c969e 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_3.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_3.q.out
@@ -110,28 +110,52 @@ POSTHOOK: Lineage: locations_n5.locationid SCRIPT []
 POSTHOOK: Lineage: locations_n5.name SCRIPT []
 PREHOOK: query: alter table emps_n9 add constraint pk1 primary key (empid) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@emps_n9
+PREHOOK: Output: default@emps_n9
 POSTHOOK: query: alter table emps_n9 add constraint pk1 primary key (empid) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@emps_n9
+POSTHOOK: Output: default@emps_n9
 PREHOOK: query: alter table depts_n7 add constraint pk2 primary key (deptno) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@depts_n7
+PREHOOK: Output: default@depts_n7
 POSTHOOK: query: alter table depts_n7 add constraint pk2 primary key (deptno) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@depts_n7
+POSTHOOK: Output: default@depts_n7
 PREHOOK: query: alter table dependents_n5 add constraint pk3 primary key (empid) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@dependents_n5
+PREHOOK: Output: default@dependents_n5
 POSTHOOK: query: alter table dependents_n5 add constraint pk3 primary key (empid) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@dependents_n5
+POSTHOOK: Output: default@dependents_n5
 PREHOOK: query: alter table locations_n5 add constraint pk4 primary key (locationid) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@locations_n5
+PREHOOK: Output: default@locations_n5
 POSTHOOK: query: alter table locations_n5 add constraint pk4 primary key (locationid) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@locations_n5
+POSTHOOK: Output: default@locations_n5
 PREHOOK: query: alter table emps_n9 add constraint fk1 foreign key (deptno) references depts_n7(deptno) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@emps_n9
+PREHOOK: Output: default@emps_n9
 POSTHOOK: query: alter table emps_n9 add constraint fk1 foreign key (deptno) references depts_n7(deptno) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@emps_n9
+POSTHOOK: Output: default@emps_n9
 PREHOOK: query: alter table depts_n7 add constraint fk2 foreign key (locationid) references locations_n5(locationid) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@depts_n7
+PREHOOK: Output: default@depts_n7
 POSTHOOK: query: alter table depts_n7 add constraint fk2 foreign key (locationid) references locations_n5(locationid) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@depts_n7
+POSTHOOK: Output: default@depts_n7
 PREHOOK: query: create materialized view mv1_n5 as
 select empid deptno from emps_n9
 join depts_n7 using (deptno)
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_4.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_4.q.out
index 5294f265f7..88450e726c 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_4.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_4.q.out
@@ -110,28 +110,52 @@ POSTHOOK: Lineage: locations_n3.locationid SCRIPT []
 POSTHOOK: Lineage: locations_n3.name SCRIPT []
 PREHOOK: query: alter table emps_n5 add constraint pk1 primary key (empid) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@emps_n5
+PREHOOK: Output: default@emps_n5
 POSTHOOK: query: alter table emps_n5 add constraint pk1 primary key (empid) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@emps_n5
+POSTHOOK: Output: default@emps_n5
 PREHOOK: query: alter table depts_n4 add constraint pk2 primary key (deptno) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@depts_n4
+PREHOOK: Output: default@depts_n4
 POSTHOOK: query: alter table depts_n4 add constraint pk2 primary key (deptno) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@depts_n4
+POSTHOOK: Output: default@depts_n4
 PREHOOK: query: alter table dependents_n3 add constraint pk3 primary key (empid) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@dependents_n3
+PREHOOK: Output: default@dependents_n3
 POSTHOOK: query: alter table dependents_n3 add constraint pk3 primary key (empid) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@dependents_n3
+POSTHOOK: Output: default@dependents_n3
 PREHOOK: query: alter table locations_n3 add constraint pk4 primary key (locationid) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@locations_n3
+PREHOOK: Output: default@locations_n3
 POSTHOOK: query: alter table locations_n3 add constraint pk4 primary key (locationid) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@locations_n3
+POSTHOOK: Output: default@locations_n3
 PREHOOK: query: alter table emps_n5 add constraint fk1 foreign key (deptno) references depts_n4(deptno) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@emps_n5
+PREHOOK: Output: default@emps_n5
 POSTHOOK: query: alter table emps_n5 add constraint fk1 foreign key (deptno) references depts_n4(deptno) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@emps_n5
+POSTHOOK: Output: default@emps_n5
 PREHOOK: query: alter table depts_n4 add constraint fk2 foreign key (locationid) references locations_n3(locationid) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@depts_n4
+PREHOOK: Output: default@depts_n4
 POSTHOOK: query: alter table depts_n4 add constraint fk2 foreign key (locationid) references locations_n3(locationid) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@depts_n4
+POSTHOOK: Output: default@depts_n4
 PREHOOK: query: create materialized view mv1_n3 as
 select name, salary, count(*) as c, sum(empid) as s
 from emps_n5 group by name, salary
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_5.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_5.q.out
index 2e8e80f04b..1d5de69e74 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_5.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_5.q.out
@@ -110,28 +110,52 @@ POSTHOOK: Lineage: locations_n1.locationid SCRIPT []
 POSTHOOK: Lineage: locations_n1.name SCRIPT []
 PREHOOK: query: alter table emps_n2 add constraint pk1 primary key (empid) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@emps_n2
+PREHOOK: Output: default@emps_n2
 POSTHOOK: query: alter table emps_n2 add constraint pk1 primary key (empid) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@emps_n2
+POSTHOOK: Output: default@emps_n2
 PREHOOK: query: alter table depts_n1 add constraint pk2 primary key (deptno) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@depts_n1
+PREHOOK: Output: default@depts_n1
 POSTHOOK: query: alter table depts_n1 add constraint pk2 primary key (deptno) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@depts_n1
+POSTHOOK: Output: default@depts_n1
 PREHOOK: query: alter table dependents_n1 add constraint pk3 primary key (empid) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@dependents_n1
+PREHOOK: Output: default@dependents_n1
 POSTHOOK: query: alter table dependents_n1 add constraint pk3 primary key (empid) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@dependents_n1
+POSTHOOK: Output: default@dependents_n1
 PREHOOK: query: alter table locations_n1 add constraint pk4 primary key (locationid) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@locations_n1
+PREHOOK: Output: default@locations_n1
 POSTHOOK: query: alter table locations_n1 add constraint pk4 primary key (locationid) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@locations_n1
+POSTHOOK: Output: default@locations_n1
 PREHOOK: query: alter table emps_n2 add constraint fk1 foreign key (deptno) references depts_n1(deptno) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@emps_n2
+PREHOOK: Output: default@emps_n2
 POSTHOOK: query: alter table emps_n2 add constraint fk1 foreign key (deptno) references depts_n1(deptno) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@emps_n2
+POSTHOOK: Output: default@emps_n2
 PREHOOK: query: alter table depts_n1 add constraint fk2 foreign key (locationid) references locations_n1(locationid) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@depts_n1
+PREHOOK: Output: default@depts_n1
 POSTHOOK: query: alter table depts_n1 add constraint fk2 foreign key (locationid) references locations_n1(locationid) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@depts_n1
+POSTHOOK: Output: default@depts_n1
 PREHOOK: query: alter table emps_n2 change column deptno deptno int constraint nn1 not null disable novalidate rely
 PREHOOK: type: ALTERTABLE_RENAMECOL
 PREHOOK: Input: default@emps_n2
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_6.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_6.q.out
index b43f1d62e1..9dfcf4b262 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_6.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_6.q.out
@@ -110,28 +110,52 @@ POSTHOOK: Lineage: locations.locationid SCRIPT []
 POSTHOOK: Lineage: locations.name SCRIPT []
 PREHOOK: query: alter table emps add constraint pk1 primary key (empid) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@emps
+PREHOOK: Output: default@emps
 POSTHOOK: query: alter table emps add constraint pk1 primary key (empid) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@emps
+POSTHOOK: Output: default@emps
 PREHOOK: query: alter table depts add constraint pk2 primary key (deptno) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@depts
+PREHOOK: Output: default@depts
 POSTHOOK: query: alter table depts add constraint pk2 primary key (deptno) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@depts
+POSTHOOK: Output: default@depts
 PREHOOK: query: alter table dependents add constraint pk3 primary key (empid) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@dependents
+PREHOOK: Output: default@dependents
 POSTHOOK: query: alter table dependents add constraint pk3 primary key (empid) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@dependents
+POSTHOOK: Output: default@dependents
 PREHOOK: query: alter table locations add constraint pk4 primary key (locationid) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@locations
+PREHOOK: Output: default@locations
 POSTHOOK: query: alter table locations add constraint pk4 primary key (locationid) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@locations
+POSTHOOK: Output: default@locations
 PREHOOK: query: alter table emps add constraint fk1 foreign key (deptno) references depts(deptno) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@emps
+PREHOOK: Output: default@emps
 POSTHOOK: query: alter table emps add constraint fk1 foreign key (deptno) references depts(deptno) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@emps
+POSTHOOK: Output: default@emps
 PREHOOK: query: alter table depts add constraint fk2 foreign key (locationid) references locations(locationid) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@depts
+PREHOOK: Output: default@depts
 POSTHOOK: query: alter table depts add constraint fk2 foreign key (locationid) references locations(locationid) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@depts
+POSTHOOK: Output: default@depts
 PREHOOK: query: alter table emps change column deptno deptno int constraint nn1 not null disable novalidate rely
 PREHOOK: type: ALTERTABLE_RENAMECOL
 PREHOOK: Input: default@emps
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_7.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_7.q.out
index 2d4b26ead2..8da9a81d7c 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_7.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_7.q.out
@@ -110,28 +110,52 @@ POSTHOOK: Lineage: locations_n4.locationid SCRIPT []
 POSTHOOK: Lineage: locations_n4.name SCRIPT []
 PREHOOK: query: alter table emps_n8 add constraint pk1 primary key (empid) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@emps_n8
+PREHOOK: Output: default@emps_n8
 POSTHOOK: query: alter table emps_n8 add constraint pk1 primary key (empid) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@emps_n8
+POSTHOOK: Output: default@emps_n8
 PREHOOK: query: alter table depts_n6 add constraint pk2 primary key (deptno) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@depts_n6
+PREHOOK: Output: default@depts_n6
 POSTHOOK: query: alter table depts_n6 add constraint pk2 primary key (deptno) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@depts_n6
+POSTHOOK: Output: default@depts_n6
 PREHOOK: query: alter table dependents_n4 add constraint pk3 primary key (empid) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@dependents_n4
+PREHOOK: Output: default@dependents_n4
 POSTHOOK: query: alter table dependents_n4 add constraint pk3 primary key (empid) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@dependents_n4
+POSTHOOK: Output: default@dependents_n4
 PREHOOK: query: alter table locations_n4 add constraint pk4 primary key (locationid) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@locations_n4
+PREHOOK: Output: default@locations_n4
 POSTHOOK: query: alter table locations_n4 add constraint pk4 primary key (locationid) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@locations_n4
+POSTHOOK: Output: default@locations_n4
 PREHOOK: query: alter table emps_n8 add constraint fk1 foreign key (deptno) references depts_n6(deptno) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@emps_n8
+PREHOOK: Output: default@emps_n8
 POSTHOOK: query: alter table emps_n8 add constraint fk1 foreign key (deptno) references depts_n6(deptno) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@emps_n8
+POSTHOOK: Output: default@emps_n8
 PREHOOK: query: alter table depts_n6 add constraint fk2 foreign key (locationid) references locations_n4(locationid) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@depts_n6
+PREHOOK: Output: default@depts_n6
 POSTHOOK: query: alter table depts_n6 add constraint fk2 foreign key (locationid) references locations_n4(locationid) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@depts_n6
+POSTHOOK: Output: default@depts_n6
 PREHOOK: query: alter table emps_n8 change column deptno deptno int constraint nn1 not null disable novalidate rely
 PREHOOK: type: ALTERTABLE_RENAMECOL
 PREHOOK: Input: default@emps_n8
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_no_join_opt.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_no_join_opt.q.out
index 8bd0230b68..80f9e78136 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_no_join_opt.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_no_join_opt.q.out
@@ -110,28 +110,52 @@ POSTHOOK: Lineage: locations_n20.locationid SCRIPT []
 POSTHOOK: Lineage: locations_n20.name SCRIPT []
 PREHOOK: query: alter table emps_n30 add constraint pk1 primary key (empid) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@emps_n30
+PREHOOK: Output: default@emps_n30
 POSTHOOK: query: alter table emps_n30 add constraint pk1 primary key (empid) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@emps_n30
+POSTHOOK: Output: default@emps_n30
 PREHOOK: query: alter table depts_n20 add constraint pk2 primary key (deptno) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@depts_n20
+PREHOOK: Output: default@depts_n20
 POSTHOOK: query: alter table depts_n20 add constraint pk2 primary key (deptno) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@depts_n20
+POSTHOOK: Output: default@depts_n20
 PREHOOK: query: alter table dependents_n20 add constraint pk3 primary key (empid) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@dependents_n20
+PREHOOK: Output: default@dependents_n20
 POSTHOOK: query: alter table dependents_n20 add constraint pk3 primary key (empid) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@dependents_n20
+POSTHOOK: Output: default@dependents_n20
 PREHOOK: query: alter table locations_n20 add constraint pk4 primary key (locationid) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@locations_n20
+PREHOOK: Output: default@locations_n20
 POSTHOOK: query: alter table locations_n20 add constraint pk4 primary key (locationid) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@locations_n20
+POSTHOOK: Output: default@locations_n20
 PREHOOK: query: alter table emps_n30 add constraint fk1 foreign key (deptno) references depts_n20(deptno) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@emps_n30
+PREHOOK: Output: default@emps_n30
 POSTHOOK: query: alter table emps_n30 add constraint fk1 foreign key (deptno) references depts_n20(deptno) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@emps_n30
+POSTHOOK: Output: default@emps_n30
 PREHOOK: query: alter table depts_n20 add constraint fk2 foreign key (locationid) references locations_n20(locationid) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@depts_n20
+PREHOOK: Output: default@depts_n20
 POSTHOOK: query: alter table depts_n20 add constraint fk2 foreign key (locationid) references locations_n20(locationid) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@depts_n20
+POSTHOOK: Output: default@depts_n20
 PREHOOK: query: create materialized view mv1_n20 as
 select deptno, name, salary, commission
 from emps_n30
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_no_join_opt_2.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_no_join_opt_2.q.out
index 2a67a98ad5..c36c1c3fc0 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_no_join_opt_2.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_no_join_opt_2.q.out
@@ -110,28 +110,52 @@ POSTHOOK: Lineage: locations_n20.locationid SCRIPT []
 POSTHOOK: Lineage: locations_n20.name SCRIPT []
 PREHOOK: query: alter table emps_n30 add constraint pk1 primary key (empid) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@emps_n30
+PREHOOK: Output: default@emps_n30
 POSTHOOK: query: alter table emps_n30 add constraint pk1 primary key (empid) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@emps_n30
+POSTHOOK: Output: default@emps_n30
 PREHOOK: query: alter table depts_n20 add constraint pk2 primary key (deptno) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@depts_n20
+PREHOOK: Output: default@depts_n20
 POSTHOOK: query: alter table depts_n20 add constraint pk2 primary key (deptno) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@depts_n20
+POSTHOOK: Output: default@depts_n20
 PREHOOK: query: alter table dependents_n20 add constraint pk3 primary key (empid) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@dependents_n20
+PREHOOK: Output: default@dependents_n20
 POSTHOOK: query: alter table dependents_n20 add constraint pk3 primary key (empid) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@dependents_n20
+POSTHOOK: Output: default@dependents_n20
 PREHOOK: query: alter table locations_n20 add constraint pk4 primary key (locationid) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@locations_n20
+PREHOOK: Output: default@locations_n20
 POSTHOOK: query: alter table locations_n20 add constraint pk4 primary key (locationid) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@locations_n20
+POSTHOOK: Output: default@locations_n20
 PREHOOK: query: alter table emps_n30 add constraint fk1 foreign key (deptno) references depts_n20(deptno) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@emps_n30
+PREHOOK: Output: default@emps_n30
 POSTHOOK: query: alter table emps_n30 add constraint fk1 foreign key (deptno) references depts_n20(deptno) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@emps_n30
+POSTHOOK: Output: default@emps_n30
 PREHOOK: query: alter table depts_n20 add constraint fk2 foreign key (locationid) references locations_n20(locationid) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@depts_n20
+PREHOOK: Output: default@depts_n20
 POSTHOOK: query: alter table depts_n20 add constraint fk2 foreign key (locationid) references locations_n20(locationid) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@depts_n20
+POSTHOOK: Output: default@depts_n20
 PREHOOK: query: create materialized view mv1_part_n2 partitioned on (deptno) as
 select * from emps_n30 where empid < 150
 PREHOOK: type: CREATE_MATERIALIZED_VIEW
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_part_1.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_part_1.q.out
index 91f8bbdb88..6a6f085381 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_part_1.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_part_1.q.out
@@ -110,28 +110,52 @@ POSTHOOK: Lineage: locations_n20.locationid SCRIPT []
 POSTHOOK: Lineage: locations_n20.name SCRIPT []
 PREHOOK: query: alter table emps_n30 add constraint pk1 primary key (empid) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@emps_n30
+PREHOOK: Output: default@emps_n30
 POSTHOOK: query: alter table emps_n30 add constraint pk1 primary key (empid) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@emps_n30
+POSTHOOK: Output: default@emps_n30
 PREHOOK: query: alter table depts_n20 add constraint pk2 primary key (deptno) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@depts_n20
+PREHOOK: Output: default@depts_n20
 POSTHOOK: query: alter table depts_n20 add constraint pk2 primary key (deptno) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@depts_n20
+POSTHOOK: Output: default@depts_n20
 PREHOOK: query: alter table dependents_n20 add constraint pk3 primary key (empid) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@dependents_n20
+PREHOOK: Output: default@dependents_n20
 POSTHOOK: query: alter table dependents_n20 add constraint pk3 primary key (empid) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@dependents_n20
+POSTHOOK: Output: default@dependents_n20
 PREHOOK: query: alter table locations_n20 add constraint pk4 primary key (locationid) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@locations_n20
+PREHOOK: Output: default@locations_n20
 POSTHOOK: query: alter table locations_n20 add constraint pk4 primary key (locationid) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@locations_n20
+POSTHOOK: Output: default@locations_n20
 PREHOOK: query: alter table emps_n30 add constraint fk1 foreign key (deptno) references depts_n20(deptno) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@emps_n30
+PREHOOK: Output: default@emps_n30
 POSTHOOK: query: alter table emps_n30 add constraint fk1 foreign key (deptno) references depts_n20(deptno) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@emps_n30
+POSTHOOK: Output: default@emps_n30
 PREHOOK: query: alter table depts_n20 add constraint fk2 foreign key (locationid) references locations_n20(locationid) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@depts_n20
+PREHOOK: Output: default@depts_n20
 POSTHOOK: query: alter table depts_n20 add constraint fk2 foreign key (locationid) references locations_n20(locationid) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@depts_n20
+POSTHOOK: Output: default@depts_n20
 PREHOOK: query: create materialized view mv1_part_n2 partitioned on (deptno) as
 select * from emps_n30 where empid < 150
 PREHOOK: type: CREATE_MATERIALIZED_VIEW
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_part_2.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_part_2.q.out
index 9b254ffb3d..c34a24738f 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_part_2.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_part_2.q.out
@@ -110,28 +110,52 @@ POSTHOOK: Lineage: locations_n00.locationid SCRIPT []
 POSTHOOK: Lineage: locations_n00.name SCRIPT []
 PREHOOK: query: alter table emps_n00 add constraint pk1 primary key (empid) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@emps_n00
+PREHOOK: Output: default@emps_n00
 POSTHOOK: query: alter table emps_n00 add constraint pk1 primary key (empid) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@emps_n00
+POSTHOOK: Output: default@emps_n00
 PREHOOK: query: alter table depts_n00 add constraint pk2 primary key (deptno) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@depts_n00
+PREHOOK: Output: default@depts_n00
 POSTHOOK: query: alter table depts_n00 add constraint pk2 primary key (deptno) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@depts_n00
+POSTHOOK: Output: default@depts_n00
 PREHOOK: query: alter table dependents_n00 add constraint pk3 primary key (empid) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@dependents_n00
+PREHOOK: Output: default@dependents_n00
 POSTHOOK: query: alter table dependents_n00 add constraint pk3 primary key (empid) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@dependents_n00
+POSTHOOK: Output: default@dependents_n00
 PREHOOK: query: alter table locations_n00 add constraint pk4 primary key (locationid) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@locations_n00
+PREHOOK: Output: default@locations_n00
 POSTHOOK: query: alter table locations_n00 add constraint pk4 primary key (locationid) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@locations_n00
+POSTHOOK: Output: default@locations_n00
 PREHOOK: query: alter table emps_n00 add constraint fk1 foreign key (deptno) references depts_n00(deptno) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@emps_n00
+PREHOOK: Output: default@emps_n00
 POSTHOOK: query: alter table emps_n00 add constraint fk1 foreign key (deptno) references depts_n00(deptno) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@emps_n00
+POSTHOOK: Output: default@emps_n00
 PREHOOK: query: alter table depts_n00 add constraint fk2 foreign key (locationid) references locations_n00(locationid) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@depts_n00
+PREHOOK: Output: default@depts_n00
 POSTHOOK: query: alter table depts_n00 add constraint fk2 foreign key (locationid) references locations_n00(locationid) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@depts_n00
+POSTHOOK: Output: default@depts_n00
 PREHOOK: query: create materialized view mv1_part_n0 partitioned on (deptno) as
 select empid, depts_n00.deptno as deptno from emps_n00
 join depts_n00 using (deptno) where depts_n00.deptno > 10
diff --git a/ql/src/test/results/clientpositive/llap/nullability_transitive_inference.q.out b/ql/src/test/results/clientpositive/llap/nullability_transitive_inference.q.out
index 8c9985e970..422903960e 100644
--- a/ql/src/test/results/clientpositive/llap/nullability_transitive_inference.q.out
+++ b/ql/src/test/results/clientpositive/llap/nullability_transitive_inference.q.out
@@ -82,16 +82,28 @@ POSTHOOK: Output: default@depts_n5
 #### A masked pattern was here ####
 PREHOOK: query: alter table emps_n6 add constraint pk1 primary key (empid) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@emps_n6
+PREHOOK: Output: default@emps_n6
 POSTHOOK: query: alter table emps_n6 add constraint pk1 primary key (empid) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@emps_n6
+POSTHOOK: Output: default@emps_n6
 PREHOOK: query: alter table depts_n5 add constraint pk2 primary key (deptno) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@depts_n5
+PREHOOK: Output: default@depts_n5
 POSTHOOK: query: alter table depts_n5 add constraint pk2 primary key (deptno) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@depts_n5
+POSTHOOK: Output: default@depts_n5
 PREHOOK: query: alter table emps_n6 add constraint fk1 foreign key (deptno) references depts_n5(deptno) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@emps_n6
+PREHOOK: Output: default@emps_n6
 POSTHOOK: query: alter table emps_n6 add constraint fk1 foreign key (deptno) references depts_n5(deptno) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@emps_n6
+POSTHOOK: Output: default@emps_n6
 PREHOOK: query: explain
 select empid from emps_n6
 join depts_n5 using (deptno) where depts_n5.deptno >= 20
diff --git a/ql/src/test/results/clientpositive/llap/q93_with_constraints.q.out b/ql/src/test/results/clientpositive/llap/q93_with_constraints.q.out
index 84f6724966..2f7012bf32 100644
--- a/ql/src/test/results/clientpositive/llap/q93_with_constraints.q.out
+++ b/ql/src/test/results/clientpositive/llap/q93_with_constraints.q.out
@@ -176,8 +176,12 @@ POSTHOOK: Input: default@reason
 POSTHOOK: Output: default@reason
 PREHOOK: query: alter table store_returns add constraint tpcds_pk_sr primary key (sr_item_sk, sr_ticket_number) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@store_returns
+PREHOOK: Output: default@store_returns
 POSTHOOK: query: alter table store_returns add constraint tpcds_pk_sr primary key (sr_item_sk, sr_ticket_number) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@store_returns
+POSTHOOK: Output: default@store_returns
 PREHOOK: query: explain
 select  ss_customer_sk
             ,sum(act_sales) sumsales
diff --git a/ql/src/test/results/clientpositive/llap/topnkey_inner_join.q.out b/ql/src/test/results/clientpositive/llap/topnkey_inner_join.q.out
index 63580ee82f..00fda6974d 100644
--- a/ql/src/test/results/clientpositive/llap/topnkey_inner_join.q.out
+++ b/ql/src/test/results/clientpositive/llap/topnkey_inner_join.q.out
@@ -24,12 +24,20 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@orders
 PREHOOK: query: alter table customer add constraint pk_customer_id primary key (id) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@customer
+PREHOOK: Output: default@customer
 POSTHOOK: query: alter table customer add constraint pk_customer_id primary key (id) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@customer
+POSTHOOK: Output: default@customer
 PREHOOK: query: alter table orders add constraint fk_order_customer_id foreign key (customer_id) references customer(id) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@orders
+PREHOOK: Output: default@orders
 POSTHOOK: query: alter table orders add constraint fk_order_customer_id foreign key (customer_id) references customer(id) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@orders
+POSTHOOK: Output: default@orders
 PREHOOK: query: insert into customer values
   (4, 'Heisenberg', 'heisenberg@email.com'),
   (3, 'Smith', 'smith@email.com'),
@@ -1121,12 +1129,20 @@ POSTHOOK: Input: _dummy_database@_dummy_table
 negative: no PK/FK
 PREHOOK: query: alter table customer drop constraint pk_customer_id
 PREHOOK: type: ALTERTABLE_DROPCONSTRAINT
+PREHOOK: Input: default@customer
+PREHOOK: Output: default@customer
 POSTHOOK: query: alter table customer drop constraint pk_customer_id
 POSTHOOK: type: ALTERTABLE_DROPCONSTRAINT
+POSTHOOK: Input: default@customer
+POSTHOOK: Output: default@customer
 PREHOOK: query: alter table orders drop constraint fk_order_customer_id
 PREHOOK: type: ALTERTABLE_DROPCONSTRAINT
+PREHOOK: Input: default@orders
+PREHOOK: Output: default@orders
 POSTHOOK: query: alter table orders drop constraint fk_order_customer_id
 POSTHOOK: type: ALTERTABLE_DROPCONSTRAINT
+POSTHOOK: Input: default@orders
+POSTHOOK: Output: default@orders
 PREHOOK: query: explain select * from customer join orders on customer.id = orders.customer_id order by customer.id limit 3
 PREHOOK: type: QUERY
 PREHOOK: Input: default@customer
@@ -1265,12 +1281,20 @@ POSTHOOK: Input: _dummy_database@_dummy_table
 negatie: no RELY
 PREHOOK: query: alter table customer add constraint pk_customer_id primary key (id) disable novalidate
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@customer
+PREHOOK: Output: default@customer
 POSTHOOK: query: alter table customer add constraint pk_customer_id primary key (id) disable novalidate
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@customer
+POSTHOOK: Output: default@customer
 PREHOOK: query: alter table orders add constraint fk_order_customer_id foreign key (customer_id) references customer(id) disable novalidate
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@orders
+PREHOOK: Output: default@orders
 POSTHOOK: query: alter table orders add constraint fk_order_customer_id foreign key (customer_id) references customer(id) disable novalidate
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@orders
+POSTHOOK: Output: default@orders
 PREHOOK: query: explain select * from customer join orders on customer.id = orders.customer_id order by customer.id limit 3
 PREHOOK: type: QUERY
 PREHOOK: Input: default@customer
diff --git a/ql/src/test/results/clientpositive/llap/topnkey_inner_join2.q.out b/ql/src/test/results/clientpositive/llap/topnkey_inner_join2.q.out
index ebfe6ebde2..33055605c7 100644
--- a/ql/src/test/results/clientpositive/llap/topnkey_inner_join2.q.out
+++ b/ql/src/test/results/clientpositive/llap/topnkey_inner_join2.q.out
@@ -24,12 +24,20 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@address
 PREHOOK: query: alter table address add constraint pk_ca1 primary key (id) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@address
+PREHOOK: Output: default@address
 POSTHOOK: query: alter table address add constraint pk_ca1 primary key (id) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@address
+POSTHOOK: Output: default@address
 PREHOOK: query: alter table customer add constraint fk_ca1 foreign key (address_id) references address (id) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: default@customer
+PREHOOK: Output: default@customer
 POSTHOOK: query: alter table customer add constraint fk_ca1 foreign key (address_id) references address (id) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: default@customer
+POSTHOOK: Output: default@customer
 PREHOOK: query: insert into address values
   (1, 'London'),
   (2, 'Washington'),
diff --git a/ql/src/test/results/clientpositive/llap/tpch18.q.out b/ql/src/test/results/clientpositive/llap/tpch18.q.out
index 3a837b04aa..4880cbb5a2 100644
--- a/ql/src/test/results/clientpositive/llap/tpch18.q.out
+++ b/ql/src/test/results/clientpositive/llap/tpch18.q.out
@@ -142,16 +142,28 @@ POSTHOOK: Input: _dummy_database@_dummy_table
 add constraints
 PREHOOK: query: alter table orders add constraint pk_o primary key (o_orderkey) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: tpch_0_001@orders
+PREHOOK: Output: tpch_0_001@orders
 POSTHOOK: query: alter table orders add constraint pk_o primary key (o_orderkey) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: tpch_0_001@orders
+POSTHOOK: Output: tpch_0_001@orders
 PREHOOK: query: alter table customer add constraint pk_c primary key (c_custkey) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: tpch_0_001@customer
+PREHOOK: Output: tpch_0_001@customer
 POSTHOOK: query: alter table customer add constraint pk_c primary key (c_custkey) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: tpch_0_001@customer
+POSTHOOK: Output: tpch_0_001@customer
 PREHOOK: query: alter table lineitem add constraint pk_l primary key (l_orderkey,l_linenumber) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: tpch_0_001@lineitem
+PREHOOK: Output: tpch_0_001@lineitem
 POSTHOOK: query: alter table lineitem add constraint pk_l primary key (l_orderkey,l_linenumber) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: tpch_0_001@lineitem
+POSTHOOK: Output: tpch_0_001@lineitem
 PREHOOK: query: alter table lineitem change column L_ORDERKEY L_ORDERKEY int constraint li_ok_nn not null disable novalidate rely
 PREHOOK: type: ALTERTABLE_RENAMECOL
 PREHOOK: Input: tpch_0_001@lineitem
@@ -162,12 +174,20 @@ POSTHOOK: Input: tpch_0_001@lineitem
 POSTHOOK: Output: tpch_0_001@lineitem
 PREHOOK: query: alter table lineitem add constraint li_o foreign key  (l_orderkey) references orders (o_orderkey) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: tpch_0_001@lineitem
+PREHOOK: Output: tpch_0_001@lineitem
 POSTHOOK: query: alter table lineitem add constraint li_o foreign key  (l_orderkey) references orders (o_orderkey) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: tpch_0_001@lineitem
+POSTHOOK: Output: tpch_0_001@lineitem
 PREHOOK: query: alter table orders   add constraint or_c foreign key  (o_custkey) references customer (c_custkey) disable novalidate rely
 PREHOOK: type: ALTERTABLE_ADDCONSTRAINT
+PREHOOK: Input: tpch_0_001@orders
+PREHOOK: Output: tpch_0_001@orders
 POSTHOOK: query: alter table orders   add constraint or_c foreign key  (o_custkey) references customer (c_custkey) disable novalidate rely
 POSTHOOK: type: ALTERTABLE_ADDCONSTRAINT
+POSTHOOK: Input: tpch_0_001@orders
+POSTHOOK: Output: tpch_0_001@orders
 PREHOOK: query: explain cbo select
 c_name,
 c_custkey,
