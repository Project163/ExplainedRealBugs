diff --git a/beeline/src/java/org/apache/hive/beeline/BeeLine.java b/beeline/src/java/org/apache/hive/beeline/BeeLine.java
index 09c4758d2e..83293627a1 100644
--- a/beeline/src/java/org/apache/hive/beeline/BeeLine.java
+++ b/beeline/src/java/org/apache/hive/beeline/BeeLine.java
@@ -96,6 +96,7 @@
 import org.apache.hive.beeline.hs2connection.HiveSiteHS2ConnectionFileParser;
 import org.apache.hive.beeline.hs2connection.UserHS2ConnectionFileParser;
 import org.apache.hive.common.util.ShutdownHookManager;
+import org.apache.hive.common.util.HiveStringUtils;
 import org.apache.hive.jdbc.HiveConnection;
 import org.apache.hive.jdbc.JdbcUriParseException;
 import org.apache.hive.jdbc.Utils;
@@ -1488,11 +1489,9 @@ boolean dispatch(String line) {
       return true;
     }
 
-    if (line.trim().length() == 0) {
-      return true;
-    }
+    line = HiveStringUtils.removeComments(line);
 
-    if (isComment(line)) {
+    if (line.trim().length() == 0) {
       return true;
     }
 
diff --git a/beeline/src/java/org/apache/hive/beeline/Commands.java b/beeline/src/java/org/apache/hive/beeline/Commands.java
index 45f3008f20..5d9701b856 100644
--- a/beeline/src/java/org/apache/hive/beeline/Commands.java
+++ b/beeline/src/java/org/apache/hive/beeline/Commands.java
@@ -1088,8 +1088,7 @@ private boolean showReport() {
    * Check if the input line is a multi-line command which needs to read further
    */
   public String handleMultiLineCmd(String line) throws IOException {
-    int[] startQuote = {-1};
-    line = HiveStringUtils.removeComments(line, startQuote);
+    line = HiveStringUtils.removeComments(line);
     Character mask = (System.getProperty("jline.terminal", "").equals("jline.UnsupportedTerminal")) ? null
                        : jline.console.ConsoleReader.NULL_MASK;
 
@@ -1117,7 +1116,7 @@ public String handleMultiLineCmd(String line) throws IOException {
       if (extra == null) { //it happens when using -f and the line of cmds does not end with ;
         break;
       }
-      extra = HiveStringUtils.removeComments(extra, startQuote);
+      extra = HiveStringUtils.removeComments(extra);
       if (extra != null && !extra.isEmpty()) {
         line += "\n" + extra;
       }
diff --git a/beeline/src/test/org/apache/hive/beeline/TestCommands.java b/beeline/src/test/org/apache/hive/beeline/TestCommands.java
index 2145b5c83a..2bd71b05a6 100644
--- a/beeline/src/test/org/apache/hive/beeline/TestCommands.java
+++ b/beeline/src/test/org/apache/hive/beeline/TestCommands.java
@@ -30,21 +30,53 @@ public class TestCommands {
 
   @Test
   public void testLinesEndingWithComments() {
-    int[] escape = {-1};
-    assertEquals("show tables;", removeComments("show tables;",escape));
-    assertEquals("show tables;", removeComments("show tables; --comments",escape));
-    assertEquals("show tables;", removeComments("show tables; -------comments",escape));
-    assertEquals("show tables;", removeComments("show tables; -------comments;one;two;three;;;;",escape));
-    assertEquals("show", removeComments("show-- tables; -------comments",escape));
-    assertEquals("show", removeComments("show --tables; -------comments",escape));
-    assertEquals("s", removeComments("s--how --tables; -------comments",escape));
-    assertEquals("", removeComments("-- show tables; -------comments",escape));
+    assertEquals("show tables;", removeComments("show tables;"));
+    assertEquals("show tables;", removeComments("show tables; --comments"));
+    assertEquals("show tables;", removeComments("show tables; -------comments"));
+    assertEquals("show tables;", removeComments("show tables; -------comments;one;two;three;;;;"));
+    assertEquals("show", removeComments("show-- tables; -------comments"));
+    assertEquals("show", removeComments("show --tables; -------comments"));
+    assertEquals("s", removeComments("s--how --tables; -------comments"));
+    assertEquals("", removeComments("-- show tables; -------comments"));
 
-    assertEquals("\"show tables\"", removeComments("\"show tables\" --comments",escape));
-    assertEquals("\"show --comments tables\"", removeComments("\"show --comments tables\" --comments",escape));
-    assertEquals("\"'show --comments' tables\"", removeComments("\"'show --comments' tables\" --comments",escape));
-    assertEquals("'show --comments tables'", removeComments("'show --comments tables' --comments",escape));
-    assertEquals("'\"show --comments tables\"'", removeComments("'\"show --comments tables\"' --comments",escape));
+    assertEquals("\"show tables\"", removeComments("\"show tables\" --comments"));
+    assertEquals("\"show --comments tables\"", removeComments("\"show --comments tables\" --comments"));
+    assertEquals("\"'show --comments' tables\"", removeComments("\"'show --comments' tables\" --comments"));
+    assertEquals("'show --comments tables'", removeComments("'show --comments tables' --comments"));
+    assertEquals("'\"show --comments tables\"'", removeComments("'\"show --comments tables\"' --comments"));
+
+    assertEquals("show tables;", removeComments("--comments\nshow tables;"));
+    assertEquals("show tables;", removeComments("--comments\nshow tables; --comments"));
+    assertEquals("show tables;", removeComments("--comments\nshow tables; -------comments"));
+    assertEquals("show tables;", removeComments("--comments\nshow tables; -------comments;one;two;three;;;;"));
+    assertEquals("show", removeComments("--comments\nshow-- tables; -------comments"));
+    assertEquals("show", removeComments("--comments\nshow --tables; -------comments"));
+    assertEquals("s", removeComments("--comments\ns--how --tables; -------comments"));
+    assertEquals("", removeComments("--comments\n-- show tables; -------comments"));
+
+    assertEquals("\"show tables\"", removeComments("--comments\n\"show tables\" --comments"));
+    assertEquals("\"show --comments tables\"", removeComments("--comments\n\"show --comments tables\" --comments"));
+    assertEquals("\"'show --comments' tables\"", removeComments("--comments\n\"'show --comments' tables\" --comments"));
+    assertEquals("'show --comments tables'", removeComments("--comments\n'show --comments tables' --comments"));
+    assertEquals("'\"show --comments tables\"'", removeComments("--comments\n'\"show --comments tables\"' --comments"));
+    assertEquals( "select col1, \n" +
+                  "       year,\n" +
+                  "       month,\n" +
+                  "       date\n" +
+                  "  from test_table\n" +
+                  " where\n" +
+                  "   username = 'foo';",
+        removeComments("select col1, -- comments\n" +
+                       "       --partitioned year column\n" +
+                       "       year,\n" +
+                       "       --partitioned month column\n" +
+                       "       month,\n" +
+                       "       --partitioned date column\n" +
+                       "       date\n" +
+                       "  from test_table\n" +
+                       " where\n" +
+                       "   --for a particular user\n" +
+                       "   username = 'foo';"));
   }
 
   /**
diff --git a/beeline/src/test/org/apache/hive/beeline/cli/TestHiveCli.java b/beeline/src/test/org/apache/hive/beeline/cli/TestHiveCli.java
index 144cdc237f..1e68405129 100644
--- a/beeline/src/test/org/apache/hive/beeline/cli/TestHiveCli.java
+++ b/beeline/src/test/org/apache/hive/beeline/cli/TestHiveCli.java
@@ -145,6 +145,22 @@ public void testSqlFromCmd() {
     verifyCMD(null, "", out, new String[] { "-e", "show databases;" }, ERRNO_OK, true);
   }
 
+  @Test
+  public void testSqlFromCmdWithComments1() {
+    verifyCMD(null, "", out, new String[] { "-e", "show databases; --comment" }, ERRNO_OK, true);
+  }
+
+  @Test
+  public void testSqlFromCmdWithComments2() {
+    verifyCMD(null, "", out, new String[] { "-e", "--comment\n show database;" }, ERRNO_ARGS, true);
+  }
+
+  @Test
+  public void testSqlFromCmdWithComments3() {
+    verifyCMD(null, "", out, 
+      new String[] { "-e", "--comment \nshow databases; -------comments;one;two;three;;;;" }, ERRNO_OK, true);
+  }
+
   @Test
   public void testSqlFromCmdWithDBName() {
     verifyCMD(null, "testtbl", out,
diff --git a/common/src/java/org/apache/hive/common/util/HiveStringUtils.java b/common/src/java/org/apache/hive/common/util/HiveStringUtils.java
index 6499ac1639..55abd03c50 100644
--- a/common/src/java/org/apache/hive/common/util/HiveStringUtils.java
+++ b/common/src/java/org/apache/hive/common/util/HiveStringUtils.java
@@ -1116,7 +1116,7 @@ public static String removeComments(String statement) {
         ret.append("\n");
       }
     }
-    return ret.toString();
+    return ret.toString().trim();
   }
 
   /**
@@ -1158,7 +1158,7 @@ public static String removeComments(String line, int[] startQuote) {
       index++;
     }
 
-    return builder.toString().trim();
+    return builder.toString();
   }
 
   /**
diff --git a/common/src/test/org/apache/hive/common/util/TestHiveStringUtils.java b/common/src/test/org/apache/hive/common/util/TestHiveStringUtils.java
index 5783a1f877..22d5bc489e 100644
--- a/common/src/test/org/apache/hive/common/util/TestHiveStringUtils.java
+++ b/common/src/test/org/apache/hive/common/util/TestHiveStringUtils.java
@@ -90,19 +90,19 @@ public void testStripComments() throws Exception {
   public void testLinesEndingWithComments() {
     int[] escape = {-1};
     assertEquals("show tables;", removeComments("show tables;",escape));
-    assertEquals("show tables;", removeComments("show tables; --comments",escape));
-    assertEquals("show tables;", removeComments("show tables; -------comments",escape));
-    assertEquals("show tables;", removeComments("show tables; -------comments;one;two;three;;;;",escape));
+    assertEquals("show tables; ", removeComments("show tables; --comments",escape));
+    assertEquals("show tables; ", removeComments("show tables; -------comments",escape));
+    assertEquals("show tables; ", removeComments("show tables; -------comments;one;two;three;;;;",escape));
     assertEquals("show", removeComments("show-- tables; -------comments",escape));
-    assertEquals("show", removeComments("show --tables; -------comments",escape));
+    assertEquals("show ", removeComments("show --tables; -------comments",escape));
     assertEquals("s", removeComments("s--how --tables; -------comments",escape));
     assertEquals("", removeComments("-- show tables; -------comments",escape));
 
-    assertEquals("\"show tables\"", removeComments("\"show tables\" --comments",escape));
-    assertEquals("\"show --comments tables\"", removeComments("\"show --comments tables\" --comments",escape));
-    assertEquals("\"'show --comments' tables\"", removeComments("\"'show --comments' tables\" --comments",escape));
-    assertEquals("'show --comments tables'", removeComments("'show --comments tables' --comments",escape));
-    assertEquals("'\"show --comments tables\"'", removeComments("'\"show --comments tables\"' --comments",escape));
+    assertEquals("\"show tables\" ", removeComments("\"show tables\" --comments",escape));
+    assertEquals("\"show --comments tables\" ", removeComments("\"show --comments tables\" --comments",escape));
+    assertEquals("\"'show --comments' tables\" ", removeComments("\"'show --comments' tables\" --comments",escape));
+    assertEquals("'show --comments tables' ", removeComments("'show --comments tables' --comments",escape));
+    assertEquals("'\"show --comments tables\"' ", removeComments("'\"show --comments tables\"' --comments",escape));
   }
 
   /**
