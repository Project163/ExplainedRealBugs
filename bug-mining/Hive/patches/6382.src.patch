diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/repl/load/message/CreateFunctionHandler.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/repl/load/message/CreateFunctionHandler.java
index f7c90409b7..a3331b4e13 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/repl/load/message/CreateFunctionHandler.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/repl/load/message/CreateFunctionHandler.java
@@ -190,7 +190,7 @@ ResourceUri destinationResourceUri(ResourceUri resourceUri)
               .addDescendant(String.valueOf(System.nanoTime()))
               .addDescendant(ReplChangeManager.getFileWithChksumFromURI(split[split.length - 1])[0])
               .build(),
-          FileSystem.get(context.hiveConf)
+          new Path(functionsRootDir).getFileSystem(context.hiveConf)
       );
 
       Task<?> copyTask = ReplCopyTask.getLoadCopyTask(
diff --git a/ql/src/test/org/apache/hadoop/hive/ql/parse/repl/load/message/TestPrimaryToReplicaResourceFunction.java b/ql/src/test/org/apache/hadoop/hive/ql/parse/repl/load/message/TestPrimaryToReplicaResourceFunction.java
index 49620f90a4..7b6c3e7507 100644
--- a/ql/src/test/org/apache/hadoop/hive/ql/parse/repl/load/message/TestPrimaryToReplicaResourceFunction.java
+++ b/ql/src/test/org/apache/hadoop/hive/ql/parse/repl/load/message/TestPrimaryToReplicaResourceFunction.java
@@ -83,6 +83,7 @@ public void setup() {
   public void createDestinationPath() throws IOException, SemanticException, URISyntaxException {
     mockStatic(FileSystem.class);
     when(FileSystem.get(any(Configuration.class))).thenReturn(mockFs);
+    when(FileSystem.get(any(URI.class), any(Configuration.class))).thenReturn(mockFs);
     when(mockFs.getScheme()).thenReturn("hdfs");
     when(mockFs.getUri()).thenReturn(new URI("hdfs", "somehost:9000", null, null, null));
     mockStatic(System.class);
