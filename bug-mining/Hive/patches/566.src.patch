diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
index 683415f0c9..1c28ac4536 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
@@ -962,7 +962,7 @@ public Object dispatch(Node nd, java.util.Stack<Node> stack,
 
   private boolean isPresent(String[] list, String elem) {
     for (String s : list) {
-      if (s.equals(elem)) {
+      if (s.toLowerCase().equals(elem)) {
         return true;
       }
     }
@@ -4518,7 +4518,7 @@ private Operator genJoinOperator(QB qb, QBJoinTree joinTree,
     int pos = 0;
     for (String src : joinTree.getBaseSrc()) {
       if (src != null) {
-        Operator srcOp = map.get(src);
+        Operator srcOp = map.get(src.toLowerCase());
 
         // for left-semi join, generate an additional selection & group-by
         // operator before ReduceSink
diff --git a/ql/src/test/queries/clientpositive/join_casesensitive.q b/ql/src/test/queries/clientpositive/join_casesensitive.q
new file mode 100644
index 0000000000..cd4344b9a1
--- /dev/null
+++ b/ql/src/test/queries/clientpositive/join_casesensitive.q
@@ -0,0 +1,8 @@
+
+CREATE TABLE joinone(key1 int, key2 int, value int);
+LOAD DATA LOCAL INPATH '../data/files/in5.txt' INTO TABLE joinone;
+
+CREATE TABLE joinTwo(key1 int, key2 int, value int);
+LOAD DATA LOCAL INPATH '../data/files/in6.txt' INTO TABLE joinTwo;
+
+SELECT * FROM joinone JOIN joinTwo ON(joinone.key2=joinTwo.key2);
diff --git a/ql/src/test/results/clientpositive/join_casesensitive.q.out b/ql/src/test/results/clientpositive/join_casesensitive.q.out
new file mode 100644
index 0000000000..db2c76593c
--- /dev/null
+++ b/ql/src/test/results/clientpositive/join_casesensitive.q.out
@@ -0,0 +1,115 @@
+PREHOOK: query: CREATE TABLE joinone(key1 int, key2 int, value int)
+PREHOOK: type: CREATETABLE
+POSTHOOK: query: CREATE TABLE joinone(key1 int, key2 int, value int)
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: default@joinone
+PREHOOK: query: LOAD DATA LOCAL INPATH '../data/files/in5.txt' INTO TABLE joinone
+PREHOOK: type: LOAD
+POSTHOOK: query: LOAD DATA LOCAL INPATH '../data/files/in5.txt' INTO TABLE joinone
+POSTHOOK: type: LOAD
+POSTHOOK: Output: default@joinone
+PREHOOK: query: CREATE TABLE joinTwo(key1 int, key2 int, value int)
+PREHOOK: type: CREATETABLE
+POSTHOOK: query: CREATE TABLE joinTwo(key1 int, key2 int, value int)
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: default@joinTwo
+PREHOOK: query: LOAD DATA LOCAL INPATH '../data/files/in6.txt' INTO TABLE joinTwo
+PREHOOK: type: LOAD
+POSTHOOK: query: LOAD DATA LOCAL INPATH '../data/files/in6.txt' INTO TABLE joinTwo
+POSTHOOK: type: LOAD
+POSTHOOK: Output: default@jointwo
+PREHOOK: query: SELECT * FROM joinone JOIN joinTwo ON(joinone.key2=joinTwo.key2)
+PREHOOK: type: QUERY
+PREHOOK: Input: default@joinone
+PREHOOK: Input: default@jointwo
+PREHOOK: Output: file:/tmp/root/hive_2011-02-22_06-34-20_426_5844000716324948890/-mr-10000
+POSTHOOK: query: SELECT * FROM joinone JOIN joinTwo ON(joinone.key2=joinTwo.key2)
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@joinone
+POSTHOOK: Input: default@jointwo
+POSTHOOK: Output: file:/tmp/root/hive_2011-02-22_06-34-20_426_5844000716324948890/-mr-10000
+5	10005	66	5	10005	66
+20	10020	66	20	10020	66
+25	10025	88	25	10025	66
+30	10030	66	30	10030	88
+35	10035	88	35	10035	88
+80	10040	88	80	10040	66
+80	10040	88	80	10040	66
+80	10040	88	40	10040	66
+80	10040	88	40	10040	88
+80	10040	88	60	10040	66
+80	10040	88	60	10040	66
+80	10040	88	70	10040	88
+80	10040	88	70	10040	88
+80	10040	88	80	10040	66
+80	10040	88	80	10040	66
+80	10040	88	40	10040	66
+80	10040	88	40	10040	88
+80	10040	88	60	10040	66
+80	10040	88	60	10040	66
+80	10040	88	70	10040	88
+80	10040	88	70	10040	88
+40	10040	66	80	10040	66
+40	10040	66	80	10040	66
+40	10040	66	40	10040	66
+40	10040	66	40	10040	88
+40	10040	66	60	10040	66
+40	10040	66	60	10040	66
+40	10040	66	70	10040	88
+40	10040	66	70	10040	88
+40	10040	88	80	10040	66
+40	10040	88	80	10040	66
+40	10040	88	40	10040	66
+40	10040	88	40	10040	88
+40	10040	88	60	10040	66
+40	10040	88	60	10040	66
+40	10040	88	70	10040	88
+40	10040	88	70	10040	88
+60	10040	66	80	10040	66
+60	10040	66	80	10040	66
+60	10040	66	40	10040	66
+60	10040	66	40	10040	88
+60	10040	66	60	10040	66
+60	10040	66	60	10040	66
+60	10040	66	70	10040	88
+60	10040	66	70	10040	88
+60	10040	66	80	10040	66
+60	10040	66	80	10040	66
+60	10040	66	40	10040	66
+60	10040	66	40	10040	88
+60	10040	66	60	10040	66
+60	10040	66	60	10040	66
+60	10040	66	70	10040	88
+60	10040	66	70	10040	88
+70	10040	66	80	10040	66
+70	10040	66	80	10040	66
+70	10040	66	40	10040	66
+70	10040	66	40	10040	88
+70	10040	66	60	10040	66
+70	10040	66	60	10040	66
+70	10040	66	70	10040	88
+70	10040	66	70	10040	88
+70	10040	66	80	10040	66
+70	10040	66	80	10040	66
+70	10040	66	40	10040	66
+70	10040	66	40	10040	88
+70	10040	66	60	10040	66
+70	10040	66	60	10040	66
+70	10040	66	70	10040	88
+70	10040	66	70	10040	88
+50	10050	88	50	10050	66
+50	10050	88	50	10050	66
+50	10050	88	NULL	10050	66
+50	10050	88	50	10050	88
+50	10050	88	50	10050	66
+50	10050	88	50	10050	66
+50	10050	88	NULL	10050	66
+50	10050	88	50	10050	88
+NULL	10050	66	50	10050	66
+NULL	10050	66	50	10050	66
+NULL	10050	66	NULL	10050	66
+NULL	10050	66	50	10050	88
+50	10050	66	50	10050	66
+50	10050	66	50	10050	66
+50	10050	66	NULL	10050	66
+50	10050	66	50	10050	88
