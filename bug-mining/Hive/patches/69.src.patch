diff --git a/CHANGES.txt b/CHANGES.txt
index c1fd9f1f22..f36701e413 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -14,6 +14,9 @@ Trunk (unreleased changes)
 
   BUG FIXES
 
+    HIVE-271. Move test-udfs creation to build-common in order to
+    fix broken 0.17 build. (athusoo)
+
 Release 0.2.0 - Unreleased
 
   INCOMPATIBLE CHANGES
diff --git a/build-common.xml b/build-common.xml
index ae6ffdb100..7bbe0cb692 100644
--- a/build-common.xml
+++ b/build-common.xml
@@ -195,7 +195,12 @@
     </javac>
   </target>
 	
-  <target name="test-jar" depends="compile-test"/>
+  <target name="test-jar" depends="compile-test">
+    <delete file="${test.build.dir}/test-udfs.jar"/>
+    <jar jarfile="${test.build.dir}/test-udfs.jar">
+        <fileset dir="${test.build.classes}" includes="**/udf/*.class"/>
+    </jar>
+  </target>
 
   <target name="test-conditions">
     <condition property="qfile" value="">
@@ -246,7 +251,7 @@
       <sysproperty key="test.service.standalone.server" value="${standalone}"/>
       <sysproperty key="log4j.configuration" value="file://${test.data.dir}/conf/hive-log4j.properties"/>
       <sysproperty key="derby.stream.error.file" value="${test.build.dir}/derby.log"/>
-      <sysproperty key="hive.aux.jars.path" value="${build.dir.hive}/ql/test/test-udfs.jar,${test.src.data.dir}/files/TestSerDe.jar"/>
+      <sysproperty key="hive.aux.jars.path" value="${test.build.dir}/test-udfs.jar,${test.src.data.dir}/files/TestSerDe.jar"/>
       <sysproperty key="ql.test.query.clientpositive.dir" value="${ql.test.query.clientpositive.dir}"/>
       <sysproperty key="ql.test.results.clientpositive.dir" value="${ql.test.results.clientpositive.dir}"/>
       <sysproperty key="test.log.dir" value="${test.log.dir}"/>
diff --git a/ql/build.xml b/ql/build.xml
index a50f963c80..32d0cdc8d8 100644
--- a/ql/build.xml
+++ b/ql/build.xml
@@ -138,13 +138,6 @@
     </javac>
   </target>
 	
-  <target name="test-jar" depends="compile-test">
-    <delete file="${test.build.dir}/test-udfs.jar"/> 
-    <jar jarfile="${test.build.dir}/test-udfs.jar">
-    	<fileset dir="${test.build.classes}" includes="**/udf/*.class"/>
-    </jar>
-  </target>
- 
   <!-- Override jar target to specify main class and compiler stuff -->
 
   <target name="jar" depends="compile">
