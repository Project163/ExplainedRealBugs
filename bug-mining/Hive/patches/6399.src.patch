diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/ColumnStatsSemanticAnalyzer.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/ColumnStatsSemanticAnalyzer.java
index 2780be2518..7cb17241db 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/ColumnStatsSemanticAnalyzer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/ColumnStatsSemanticAnalyzer.java
@@ -35,6 +35,7 @@
 import org.apache.hadoop.hive.ql.exec.Utilities;
 import org.apache.hadoop.hive.ql.metadata.HiveException;
 import org.apache.hadoop.hive.ql.metadata.Table;
+import org.apache.hadoop.hive.ql.plan.HiveOperation;
 import org.apache.hadoop.hive.ql.session.SessionState;
 import org.apache.hadoop.hive.ql.session.SessionState.LogHelper;
 import org.apache.hadoop.hive.serde.serdeConstants;
@@ -236,7 +237,7 @@ private List<String> getColumnTypes(List<String> colNames)
         }
       }
     }
-    
+
     return colTypes;
   }
 
@@ -403,6 +404,9 @@ public void analyze(ASTNode ast, Context origCtx) throws SemanticException {
       ctx.setExplainConfig(origCtx.getExplainConfig());
       LOG.info("Invoking analyze on rewritten query");
       analyzeInternal(rewrittenTree);
+      // After analyzeInternal() Hiveop get set as Query
+      // since we are passing in AST for select query, so reset it.
+      this.queryState.setCommandType(HiveOperation.ANALYZE_TABLE);
     } else {
       initCtx(origCtx);
       LOG.info("Invoking analyze on original query");
diff --git a/ql/src/test/results/clientnegative/insertsel_fail.q.out b/ql/src/test/results/clientnegative/insertsel_fail.q.out
index f8cc7048c4..347e1b1e92 100644
--- a/ql/src/test/results/clientnegative/insertsel_fail.q.out
+++ b/ql/src/test/results/clientnegative/insertsel_fail.q.out
@@ -1 +1 @@
-FAILED: ParseException line 1:72 extraneous input 'a' expecting EOF near '<EOF>'
+FAILED: ParseException line 2:72 extraneous input 'a' expecting EOF near '<EOF>'
diff --git a/ql/src/test/results/clientnegative/load_data_parquet_empty.q.out b/ql/src/test/results/clientnegative/load_data_parquet_empty.q.out
index be0f0e689e..aa632f8da3 100644
--- a/ql/src/test/results/clientnegative/load_data_parquet_empty.q.out
+++ b/ql/src/test/results/clientnegative/load_data_parquet_empty.q.out
@@ -6,4 +6,4 @@ POSTHOOK: query: CREATE TABLE emptyparquet ( i int) PARTITIONED BY (s string) ST
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@emptyparquet
-FAILED: SemanticException Unable to load data to destination table. Error: The file that you are trying to load does not match the file format of the destination table.
+#### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/acid_table_stats.q.out b/ql/src/test/results/clientpositive/acid_table_stats.q.out
index 42c2a79879..2596922fff 100644
--- a/ql/src/test/results/clientpositive/acid_table_stats.q.out
+++ b/ql/src/test/results/clientpositive/acid_table_stats.q.out
@@ -224,14 +224,14 @@ Sort Columns:       	[]
 Storage Desc Params:	 	 
 	serialization.format	1                   
 PREHOOK: query: analyze table acid partition(ds='2008-04-08') compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@acid
 PREHOOK: Input: default@acid@ds=2008-04-08
 PREHOOK: Output: default@acid
 PREHOOK: Output: default@acid@ds=2008-04-08
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table acid partition(ds='2008-04-08') compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@acid
 POSTHOOK: Input: default@acid@ds=2008-04-08
 POSTHOOK: Output: default@acid
@@ -504,14 +504,14 @@ POSTHOOK: Input: default@acid@ds=2008-04-08
 #### A masked pattern was here ####
 2000
 PREHOOK: query: analyze table acid partition(ds='2008-04-08') compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@acid
 PREHOOK: Input: default@acid@ds=2008-04-08
 PREHOOK: Output: default@acid
 PREHOOK: Output: default@acid@ds=2008-04-08
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table acid partition(ds='2008-04-08') compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@acid
 POSTHOOK: Input: default@acid@ds=2008-04-08
 POSTHOOK: Output: default@acid
diff --git a/ql/src/test/results/clientpositive/alterColumnStatsPart.q.out b/ql/src/test/results/clientpositive/alterColumnStatsPart.q.out
index ab253738ee..d5975e1a09 100644
--- a/ql/src/test/results/clientpositive/alterColumnStatsPart.q.out
+++ b/ql/src/test/results/clientpositive/alterColumnStatsPart.q.out
@@ -155,14 +155,14 @@ STAGE PLANS:
         ListSink
 
 PREHOOK: query: analyze table p partition(c=1) compute statistics for columns a
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@p
 PREHOOK: Input: default@p@c=1
 PREHOOK: Output: default@p
 PREHOOK: Output: default@p@c=1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table p partition(c=1) compute statistics for columns a
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@p
 POSTHOOK: Input: default@p@c=1
 POSTHOOK: Output: default@p
@@ -382,14 +382,14 @@ STAGE PLANS:
         ListSink
 
 PREHOOK: query: analyze table p partition(c=100) compute statistics for columns a
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@p
 PREHOOK: Input: default@p@c=100
 PREHOOK: Output: default@p
 PREHOOK: Output: default@p@c=100
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table p partition(c=100) compute statistics for columns a
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@p
 POSTHOOK: Input: default@p@c=100
 POSTHOOK: Output: default@p
@@ -492,14 +492,14 @@ POSTHOOK: Output: default@p@c=100
 POSTHOOK: Lineage: p PARTITION(c=100).a SCRIPT []
 POSTHOOK: Lineage: p PARTITION(c=100).b SCRIPT []
 PREHOOK: query: analyze table p partition(c=100) compute statistics for columns a
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@p
 PREHOOK: Input: default@p@c=100
 PREHOOK: Output: default@p
 PREHOOK: Output: default@p@c=100
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table p partition(c=100) compute statistics for columns a
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@p
 POSTHOOK: Input: default@p@c=100
 POSTHOOK: Output: default@p
diff --git a/ql/src/test/results/clientpositive/alter_partition_update_status.q.out b/ql/src/test/results/clientpositive/alter_partition_update_status.q.out
index 9aab9b2436..09dda34817 100644
--- a/ql/src/test/results/clientpositive/alter_partition_update_status.q.out
+++ b/ql/src/test/results/clientpositive/alter_partition_update_status.q.out
@@ -19,14 +19,14 @@ POSTHOOK: Output: default@src_stat_part_one@partitionid=1
 POSTHOOK: Lineage: src_stat_part_one PARTITION(partitionid=1).key SIMPLE [(src1)src1.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: src_stat_part_one PARTITION(partitionid=1).value SIMPLE [(src1)src1.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: ANALYZE TABLE src_stat_part_one PARTITION(partitionId=1) COMPUTE STATISTICS for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@src_stat_part_one
 PREHOOK: Input: default@src_stat_part_one@partitionid=1
 PREHOOK: Output: default@src_stat_part_one
 PREHOOK: Output: default@src_stat_part_one@partitionid=1
 #### A masked pattern was here ####
 POSTHOOK: query: ANALYZE TABLE src_stat_part_one PARTITION(partitionId=1) COMPUTE STATISTICS for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@src_stat_part_one
 POSTHOOK: Input: default@src_stat_part_one@partitionid=1
 POSTHOOK: Output: default@src_stat_part_one
@@ -93,14 +93,14 @@ POSTHOOK: Output: default@src_stat_part_two@px=1/py=a
 POSTHOOK: Lineage: src_stat_part_two PARTITION(px=1,py=a).key SIMPLE [(src1)src1.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: src_stat_part_two PARTITION(px=1,py=a).value SIMPLE [(src1)src1.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: ANALYZE TABLE src_stat_part_two PARTITION(px=1) COMPUTE STATISTICS for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@src_stat_part_two
 PREHOOK: Input: default@src_stat_part_two@px=1/py=a
 PREHOOK: Output: default@src_stat_part_two
 PREHOOK: Output: default@src_stat_part_two@px=1/py=a
 #### A masked pattern was here ####
 POSTHOOK: query: ANALYZE TABLE src_stat_part_two PARTITION(px=1) COMPUTE STATISTICS for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@src_stat_part_two
 POSTHOOK: Input: default@src_stat_part_two@px=1/py=a
 POSTHOOK: Output: default@src_stat_part_two
diff --git a/ql/src/test/results/clientpositive/alter_rename_table.q.out b/ql/src/test/results/clientpositive/alter_rename_table.q.out
index 9ac8fd2f9b..f16b95b2ca 100644
--- a/ql/src/test/results/clientpositive/alter_rename_table.q.out
+++ b/ql/src/test/results/clientpositive/alter_rename_table.q.out
@@ -278,12 +278,12 @@ POSTHOOK: type: LOAD
 #### A masked pattern was here ####
 POSTHOOK: Output: source@src2
 PREHOOK: query: ANALYZE TABlE source.src2 COMPUTE STATISTICS FOR COLUMNS
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: source@src2
 #### A masked pattern was here ####
 PREHOOK: Output: source@src2
 POSTHOOK: query: ANALYZE TABlE source.src2 COMPUTE STATISTICS FOR COLUMNS
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: source@src2
 #### A masked pattern was here ####
 POSTHOOK: Output: source@src2
diff --git a/ql/src/test/results/clientpositive/alter_table_column_stats.q.out b/ql/src/test/results/clientpositive/alter_table_column_stats.q.out
index e7d37f1f00..f8c91d3e14 100644
--- a/ql/src/test/results/clientpositive/alter_table_column_stats.q.out
+++ b/ql/src/test/results/clientpositive/alter_table_column_stats.q.out
@@ -74,12 +74,12 @@ POSTHOOK: query: use statsdb1
 POSTHOOK: type: SWITCHDATABASE
 POSTHOOK: Input: database:statsdb1
 PREHOOK: query: analyze table testtable0 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: statsdb1@testtable0
 #### A masked pattern was here ####
 PREHOOK: Output: statsdb1@testtable0
 POSTHOOK: query: analyze table testtable0 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: statsdb1@testtable0
 #### A masked pattern was here ####
 POSTHOOK: Output: statsdb1@testtable0
@@ -587,7 +587,7 @@ bitVector
 comment             	from deserializer   	 	 	 	 	 	 	 	 	 	 
 COLUMN_STATS_ACCURATE	{\"BASIC_STATS\":\"true\",\"COLUMN_STATS\":{\"col2\":\"true\"}}	 	 	 	 	 	 	 	 	 	 
 PREHOOK: query: analyze table testpart0 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: statsdb1@testpart0
 PREHOOK: Input: statsdb1@testpart0@part=part1
 PREHOOK: Input: statsdb1@testpart0@part=part2
@@ -596,7 +596,7 @@ PREHOOK: Output: statsdb1@testpart0
 PREHOOK: Output: statsdb1@testpart0@part=part1
 PREHOOK: Output: statsdb1@testpart0@part=part2
 POSTHOOK: query: analyze table testpart0 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: statsdb1@testpart0
 POSTHOOK: Input: statsdb1@testpart0@part=part1
 POSTHOOK: Input: statsdb1@testpart0@part=part2
@@ -1955,12 +1955,12 @@ POSTHOOK: query: use statsdb1
 POSTHOOK: type: SWITCHDATABASE
 POSTHOOK: Input: database:statsdb1
 PREHOOK: query: analyze table testtable0 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: statsdb1@testtable0
 #### A masked pattern was here ####
 PREHOOK: Output: statsdb1@testtable0
 POSTHOOK: query: analyze table testtable0 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: statsdb1@testtable0
 #### A masked pattern was here ####
 POSTHOOK: Output: statsdb1@testtable0
@@ -2468,7 +2468,7 @@ bitVector
 comment             	from deserializer   	 	 	 	 	 	 	 	 	 	 
 COLUMN_STATS_ACCURATE	{\"BASIC_STATS\":\"true\",\"COLUMN_STATS\":{\"col2\":\"true\"}}	 	 	 	 	 	 	 	 	 	 
 PREHOOK: query: analyze table testpart0 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: statsdb1@testpart0
 PREHOOK: Input: statsdb1@testpart0@part=part1
 PREHOOK: Input: statsdb1@testpart0@part=part2
@@ -2477,7 +2477,7 @@ PREHOOK: Output: statsdb1@testpart0
 PREHOOK: Output: statsdb1@testpart0@part=part1
 PREHOOK: Output: statsdb1@testpart0@part=part2
 POSTHOOK: query: analyze table testpart0 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: statsdb1@testpart0
 POSTHOOK: Input: statsdb1@testpart0@part=part1
 POSTHOOK: Input: statsdb1@testpart0@part=part2
diff --git a/ql/src/test/results/clientpositive/alter_table_update_status.q.out b/ql/src/test/results/clientpositive/alter_table_update_status.q.out
index baf43c1d30..3d63e13aa5 100644
--- a/ql/src/test/results/clientpositive/alter_table_update_status.q.out
+++ b/ql/src/test/results/clientpositive/alter_table_update_status.q.out
@@ -33,12 +33,12 @@ POSTHOOK: type: LOAD
 #### A masked pattern was here ####
 POSTHOOK: Output: default@src_stat_int
 PREHOOK: query: ANALYZE TABLE src_stat COMPUTE STATISTICS for columns key
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@src_stat
 PREHOOK: Output: default@src_stat
 #### A masked pattern was here ####
 POSTHOOK: query: ANALYZE TABLE src_stat COMPUTE STATISTICS for columns key
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@src_stat
 POSTHOOK: Output: default@src_stat
 #### A masked pattern was here ####
@@ -108,12 +108,12 @@ bitVector
 comment             	from deserializer   	 	 	 	 	 	 	 	 	 	 
 COLUMN_STATS_ACCURATE	{\"BASIC_STATS\":\"true\",\"COLUMN_STATS\":{\"key\":\"true\",\"value\":\"true\"}}	 	 	 	 	 	 	 	 	 	 
 PREHOOK: query: ANALYZE TABLE src_stat_int COMPUTE STATISTICS for columns key
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@src_stat_int
 PREHOOK: Output: default@src_stat_int
 #### A masked pattern was here ####
 POSTHOOK: query: ANALYZE TABLE src_stat_int COMPUTE STATISTICS for columns key
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@src_stat_int
 POSTHOOK: Output: default@src_stat_int
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/alter_table_update_status_disable_bitvector.q.out b/ql/src/test/results/clientpositive/alter_table_update_status_disable_bitvector.q.out
index 5735065d4d..726ec1b0d0 100644
--- a/ql/src/test/results/clientpositive/alter_table_update_status_disable_bitvector.q.out
+++ b/ql/src/test/results/clientpositive/alter_table_update_status_disable_bitvector.q.out
@@ -33,12 +33,12 @@ POSTHOOK: type: LOAD
 #### A masked pattern was here ####
 POSTHOOK: Output: default@src_stat_int
 PREHOOK: query: ANALYZE TABLE src_stat COMPUTE STATISTICS for columns key
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@src_stat
 PREHOOK: Output: default@src_stat
 #### A masked pattern was here ####
 POSTHOOK: query: ANALYZE TABLE src_stat COMPUTE STATISTICS for columns key
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@src_stat
 POSTHOOK: Output: default@src_stat
 #### A masked pattern was here ####
@@ -108,12 +108,12 @@ bitVector
 comment             	from deserializer   	 	 	 	 	 	 	 	 	 	 
 COLUMN_STATS_ACCURATE	{\"BASIC_STATS\":\"true\",\"COLUMN_STATS\":{\"key\":\"true\",\"value\":\"true\"}}	 	 	 	 	 	 	 	 	 	 
 PREHOOK: query: ANALYZE TABLE src_stat_int COMPUTE STATISTICS for columns key
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@src_stat_int
 PREHOOK: Output: default@src_stat_int
 #### A masked pattern was here ####
 POSTHOOK: query: ANALYZE TABLE src_stat_int COMPUTE STATISTICS for columns key
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@src_stat_int
 POSTHOOK: Output: default@src_stat_int
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/analyze_tbl_date.q.out b/ql/src/test/results/clientpositive/analyze_tbl_date.q.out
index 6cd878df1b..bd8db9f1c6 100644
--- a/ql/src/test/results/clientpositive/analyze_tbl_date.q.out
+++ b/ql/src/test/results/clientpositive/analyze_tbl_date.q.out
@@ -16,12 +16,12 @@ POSTHOOK: Input: _dummy_database@_dummy_table
 POSTHOOK: Output: default@test_table
 POSTHOOK: Lineage: test_table.d EXPRESSION []
 PREHOOK: query: analyze table test_table compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@test_table
 PREHOOK: Output: default@test_table
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table test_table compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@test_table
 POSTHOOK: Output: default@test_table
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/analyze_tbl_part.q.out b/ql/src/test/results/clientpositive/analyze_tbl_part.q.out
index c2380eee32..74c8beee61 100644
--- a/ql/src/test/results/clientpositive/analyze_tbl_part.q.out
+++ b/ql/src/test/results/clientpositive/analyze_tbl_part.q.out
@@ -31,7 +31,7 @@ POSTHOOK: Output: default@src_stat_part@partitionid=2
 POSTHOOK: Lineage: src_stat_part PARTITION(partitionid=2).key SIMPLE [(src1)src1.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: src_stat_part PARTITION(partitionid=2).value SIMPLE [(src1)src1.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: ANALYZE TABLE src_stat_part partition (partitionId) COMPUTE STATISTICS for columns key
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@src_stat_part
 PREHOOK: Input: default@src_stat_part@partitionid=1
 PREHOOK: Input: default@src_stat_part@partitionid=2
@@ -40,7 +40,7 @@ PREHOOK: Output: default@src_stat_part@partitionid=1
 PREHOOK: Output: default@src_stat_part@partitionid=2
 #### A masked pattern was here ####
 POSTHOOK: query: ANALYZE TABLE src_stat_part partition (partitionId) COMPUTE STATISTICS for columns key
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@src_stat_part
 POSTHOOK: Input: default@src_stat_part@partitionid=1
 POSTHOOK: Input: default@src_stat_part@partitionid=2
@@ -67,7 +67,7 @@ num_falses
 bitVector           	HL                  	 	 	 	 	 	 	 	 	 	 
 comment             	from deserializer   	 	 	 	 	 	 	 	 	 	 
 PREHOOK: query: ANALYZE TABLE src_stat_part partition (partitionId) COMPUTE STATISTICS for columns key, value
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@src_stat_part
 PREHOOK: Input: default@src_stat_part@partitionid=1
 PREHOOK: Input: default@src_stat_part@partitionid=2
@@ -76,7 +76,7 @@ PREHOOK: Output: default@src_stat_part@partitionid=1
 PREHOOK: Output: default@src_stat_part@partitionid=2
 #### A masked pattern was here ####
 POSTHOOK: query: ANALYZE TABLE src_stat_part partition (partitionId) COMPUTE STATISTICS for columns key, value
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@src_stat_part
 POSTHOOK: Input: default@src_stat_part@partitionid=1
 POSTHOOK: Input: default@src_stat_part@partitionid=2
@@ -153,35 +153,35 @@ POSTHOOK: Output: default@src_stat_string_part@partitionname=p%221
 POSTHOOK: Lineage: src_stat_string_part PARTITION(partitionname=p"1).key SIMPLE [(src1)src1.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: src_stat_string_part PARTITION(partitionname=p"1).value SIMPLE [(src1)src1.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: ANALYZE TABLE src_stat_string_part partition (partitionName="p\'1") COMPUTE STATISTICS for columns key, value
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@src_stat_string_part
 PREHOOK: Input: default@src_stat_string_part@partitionname=p%271
 PREHOOK: Output: default@src_stat_string_part
 PREHOOK: Output: default@src_stat_string_part@partitionname=p%271
 #### A masked pattern was here ####
 POSTHOOK: query: ANALYZE TABLE src_stat_string_part partition (partitionName="p\'1") COMPUTE STATISTICS for columns key, value
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@src_stat_string_part
 POSTHOOK: Input: default@src_stat_string_part@partitionname=p%271
 POSTHOOK: Output: default@src_stat_string_part
 POSTHOOK: Output: default@src_stat_string_part@partitionname=p%271
 #### A masked pattern was here ####
 PREHOOK: query: ANALYZE TABLE src_stat_string_part partition (partitionName="p\"1") COMPUTE STATISTICS for columns key, value
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@src_stat_string_part
 PREHOOK: Input: default@src_stat_string_part@partitionname=p%221
 PREHOOK: Output: default@src_stat_string_part
 PREHOOK: Output: default@src_stat_string_part@partitionname=p%221
 #### A masked pattern was here ####
 POSTHOOK: query: ANALYZE TABLE src_stat_string_part partition (partitionName="p\"1") COMPUTE STATISTICS for columns key, value
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@src_stat_string_part
 POSTHOOK: Input: default@src_stat_string_part@partitionname=p%221
 POSTHOOK: Output: default@src_stat_string_part
 POSTHOOK: Output: default@src_stat_string_part@partitionname=p%221
 #### A masked pattern was here ####
 PREHOOK: query: ANALYZE TABLE src_stat_string_part COMPUTE STATISTICS for columns key, value
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@src_stat_string_part
 PREHOOK: Input: default@src_stat_string_part@partitionname=p%221
 PREHOOK: Input: default@src_stat_string_part@partitionname=p%271
@@ -190,7 +190,7 @@ PREHOOK: Output: default@src_stat_string_part@partitionname=p%221
 PREHOOK: Output: default@src_stat_string_part@partitionname=p%271
 #### A masked pattern was here ####
 POSTHOOK: query: ANALYZE TABLE src_stat_string_part COMPUTE STATISTICS for columns key, value
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@src_stat_string_part
 POSTHOOK: Input: default@src_stat_string_part@partitionname=p%221
 POSTHOOK: Input: default@src_stat_string_part@partitionname=p%271
diff --git a/ql/src/test/results/clientpositive/annotate_stats_deep_filters.q.out b/ql/src/test/results/clientpositive/annotate_stats_deep_filters.q.out
index dfeb5406ea..2cde0f912c 100644
--- a/ql/src/test/results/clientpositive/annotate_stats_deep_filters.q.out
+++ b/ql/src/test/results/clientpositive/annotate_stats_deep_filters.q.out
@@ -57,12 +57,12 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k
 POSTHOOK: Output: default@over1k
 PREHOOK: query: analyze table over1k compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@over1k
 PREHOOK: Output: default@over1k
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table over1k compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@over1k
 POSTHOOK: Output: default@over1k
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/annotate_stats_filter.q.out b/ql/src/test/results/clientpositive/annotate_stats_filter.q.out
index 2e4a1325bf..59df9b2d6d 100644
--- a/ql/src/test/results/clientpositive/annotate_stats_filter.q.out
+++ b/ql/src/test/results/clientpositive/annotate_stats_filter.q.out
@@ -111,12 +111,12 @@ STAGE PLANS:
         ListSink
 
 PREHOOK: query: analyze table loc_orc compute statistics for columns state,locid,zip,year
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@loc_orc
 PREHOOK: Output: default@loc_orc
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table loc_orc compute statistics for columns state,locid,zip,year
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@loc_orc
 POSTHOOK: Output: default@loc_orc
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/annotate_stats_groupby.q.out b/ql/src/test/results/clientpositive/annotate_stats_groupby.q.out
index 166cd29375..7748ae057a 100644
--- a/ql/src/test/results/clientpositive/annotate_stats_groupby.q.out
+++ b/ql/src/test/results/clientpositive/annotate_stats_groupby.q.out
@@ -74,12 +74,12 @@ STAGE PLANS:
             ListSink
 
 PREHOOK: query: analyze table loc_orc compute statistics for columns state
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@loc_orc
 PREHOOK: Output: default@loc_orc
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table loc_orc compute statistics for columns state
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@loc_orc
 POSTHOOK: Output: default@loc_orc
 #### A masked pattern was here ####
@@ -179,12 +179,12 @@ STAGE PLANS:
         ListSink
 
 PREHOOK: query: analyze table loc_orc compute statistics for columns state,locid,year
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@loc_orc
 PREHOOK: Output: default@loc_orc
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table loc_orc compute statistics for columns state,locid,year
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@loc_orc
 POSTHOOK: Output: default@loc_orc
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/annotate_stats_groupby2.q.out b/ql/src/test/results/clientpositive/annotate_stats_groupby2.q.out
index 588ffe29f7..745fdce5d8 100644
--- a/ql/src/test/results/clientpositive/annotate_stats_groupby2.q.out
+++ b/ql/src/test/results/clientpositive/annotate_stats_groupby2.q.out
@@ -27,12 +27,12 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@location
 POSTHOOK: Output: default@location
 PREHOOK: query: analyze table location compute statistics for columns state, country
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@location
 PREHOOK: Output: default@location
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table location compute statistics for columns state, country
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@location
 POSTHOOK: Output: default@location
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/annotate_stats_join.q.out b/ql/src/test/results/clientpositive/annotate_stats_join.q.out
index 9173e7acf1..5eed9bf103 100644
--- a/ql/src/test/results/clientpositive/annotate_stats_join.q.out
+++ b/ql/src/test/results/clientpositive/annotate_stats_join.q.out
@@ -95,32 +95,32 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@loc
 POSTHOOK: Output: default@loc
 PREHOOK: query: analyze table emp compute statistics for columns lastname,deptid,locid
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@emp
 PREHOOK: Output: default@emp
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table emp compute statistics for columns lastname,deptid,locid
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@emp
 POSTHOOK: Output: default@emp
 #### A masked pattern was here ####
 PREHOOK: query: analyze table dept compute statistics for columns deptname,deptid
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@dept
 PREHOOK: Output: default@dept
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table dept compute statistics for columns deptname,deptid
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@dept
 POSTHOOK: Output: default@dept
 #### A masked pattern was here ####
 PREHOOK: query: analyze table loc compute statistics for columns state,locid,zip,year
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@loc
 PREHOOK: Output: default@loc
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table loc compute statistics for columns state,locid,zip,year
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@loc
 POSTHOOK: Output: default@loc
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/annotate_stats_join_pkfk.q.out b/ql/src/test/results/clientpositive/annotate_stats_join_pkfk.q.out
index bec98d0874..8778b83126 100644
--- a/ql/src/test/results/clientpositive/annotate_stats_join_pkfk.q.out
+++ b/ql/src/test/results/clientpositive/annotate_stats_join_pkfk.q.out
@@ -295,12 +295,12 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@store
 POSTHOOK: Output: default@store
 PREHOOK: query: analyze table store compute statistics for columns s_store_sk, s_floor_space
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@store
 PREHOOK: Output: default@store
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table store compute statistics for columns s_store_sk, s_floor_space
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@store
 POSTHOOK: Output: default@store
 #### A masked pattern was here ####
@@ -313,12 +313,12 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@store_bigint
 POSTHOOK: Output: default@store_bigint
 PREHOOK: query: analyze table store_bigint compute statistics for columns s_store_sk, s_floor_space
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@store_bigint
 PREHOOK: Output: default@store_bigint
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table store_bigint compute statistics for columns s_store_sk, s_floor_space
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@store_bigint
 POSTHOOK: Output: default@store_bigint
 #### A masked pattern was here ####
@@ -331,12 +331,12 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@store_sales
 POSTHOOK: Output: default@store_sales
 PREHOOK: query: analyze table store_sales compute statistics for columns ss_store_sk, ss_addr_sk, ss_quantity
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@store_sales
 PREHOOK: Output: default@store_sales
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table store_sales compute statistics for columns ss_store_sk, ss_addr_sk, ss_quantity
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@store_sales
 POSTHOOK: Output: default@store_sales
 #### A masked pattern was here ####
@@ -349,12 +349,12 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@customer_address
 POSTHOOK: Output: default@customer_address
 PREHOOK: query: analyze table customer_address compute statistics for columns ca_address_sk
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@customer_address
 PREHOOK: Output: default@customer_address
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table customer_address compute statistics for columns ca_address_sk
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@customer_address
 POSTHOOK: Output: default@customer_address
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/annotate_stats_limit.q.out b/ql/src/test/results/clientpositive/annotate_stats_limit.q.out
index 5139db4d64..98da1404af 100644
--- a/ql/src/test/results/clientpositive/annotate_stats_limit.q.out
+++ b/ql/src/test/results/clientpositive/annotate_stats_limit.q.out
@@ -53,12 +53,12 @@ POSTHOOK: Lineage: loc_orc.state SIMPLE [(loc_staging)loc_staging.FieldSchema(na
 POSTHOOK: Lineage: loc_orc.year SIMPLE [(loc_staging)loc_staging.FieldSchema(name:year, type:int, comment:null), ]
 POSTHOOK: Lineage: loc_orc.zip SIMPLE [(loc_staging)loc_staging.FieldSchema(name:zip, type:bigint, comment:null), ]
 PREHOOK: query: analyze table loc_orc compute statistics for columns state, locid, zip, year
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@loc_orc
 PREHOOK: Output: default@loc_orc
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table loc_orc compute statistics for columns state, locid, zip, year
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@loc_orc
 POSTHOOK: Output: default@loc_orc
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/annotate_stats_part.q.out b/ql/src/test/results/clientpositive/annotate_stats_part.q.out
index 399ddb6f66..a65bde5570 100644
--- a/ql/src/test/results/clientpositive/annotate_stats_part.q.out
+++ b/ql/src/test/results/clientpositive/annotate_stats_part.q.out
@@ -270,14 +270,14 @@ STAGE PLANS:
               ListSink
 
 PREHOOK: query: analyze table loc_orc partition(year='2001') compute statistics for columns state,locid
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@loc_orc
 PREHOOK: Input: default@loc_orc@year=2001
 PREHOOK: Output: default@loc_orc
 PREHOOK: Output: default@loc_orc@year=2001
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table loc_orc partition(year='2001') compute statistics for columns state,locid
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@loc_orc
 POSTHOOK: Input: default@loc_orc@year=2001
 POSTHOOK: Output: default@loc_orc
diff --git a/ql/src/test/results/clientpositive/annotate_stats_select.q.out b/ql/src/test/results/clientpositive/annotate_stats_select.q.out
index cfec34649d..b740f9926b 100644
--- a/ql/src/test/results/clientpositive/annotate_stats_select.q.out
+++ b/ql/src/test/results/clientpositive/annotate_stats_select.q.out
@@ -111,12 +111,12 @@ STAGE PLANS:
             ListSink
 
 PREHOOK: query: analyze table alltypes_orc compute statistics for columns bo1, ti1, si1, i1, bi1, f1, d1, s1, vc1
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@alltypes_orc
 PREHOOK: Output: default@alltypes_orc
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table alltypes_orc compute statistics for columns bo1, ti1, si1, i1, bi1, f1, d1, s1, vc1
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@alltypes_orc
 POSTHOOK: Output: default@alltypes_orc
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/annotate_stats_table.q.out b/ql/src/test/results/clientpositive/annotate_stats_table.q.out
index 433a06b0ff..a457312379 100644
--- a/ql/src/test/results/clientpositive/annotate_stats_table.q.out
+++ b/ql/src/test/results/clientpositive/annotate_stats_table.q.out
@@ -118,12 +118,12 @@ STAGE PLANS:
             ListSink
 
 PREHOOK: query: analyze table emp_orc compute statistics for columns deptid
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@emp_orc
 PREHOOK: Output: default@emp_orc
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table emp_orc compute statistics for columns deptid
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@emp_orc
 POSTHOOK: Output: default@emp_orc
 #### A masked pattern was here ####
@@ -170,12 +170,12 @@ STAGE PLANS:
             ListSink
 
 PREHOOK: query: analyze table emp_orc compute statistics for columns lastname,deptid
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@emp_orc
 PREHOOK: Output: default@emp_orc
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table emp_orc compute statistics for columns lastname,deptid
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@emp_orc
 POSTHOOK: Output: default@emp_orc
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/annotate_stats_union.q.out b/ql/src/test/results/clientpositive/annotate_stats_union.q.out
index 3b4b169dc8..cf77fc06a6 100644
--- a/ql/src/test/results/clientpositive/annotate_stats_union.q.out
+++ b/ql/src/test/results/clientpositive/annotate_stats_union.q.out
@@ -53,12 +53,12 @@ POSTHOOK: Lineage: loc_orc.state SIMPLE [(loc_staging)loc_staging.FieldSchema(na
 POSTHOOK: Lineage: loc_orc.year SIMPLE [(loc_staging)loc_staging.FieldSchema(name:year, type:int, comment:null), ]
 POSTHOOK: Lineage: loc_orc.zip SIMPLE [(loc_staging)loc_staging.FieldSchema(name:zip, type:bigint, comment:null), ]
 PREHOOK: query: analyze table loc_orc compute statistics for columns state,locid,zip,year
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@loc_orc
 PREHOOK: Output: default@loc_orc
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table loc_orc compute statistics for columns state,locid,zip,year
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@loc_orc
 POSTHOOK: Output: default@loc_orc
 #### A masked pattern was here ####
@@ -281,22 +281,22 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: test@loc_staging
 POSTHOOK: Output: test@loc_staging
 PREHOOK: query: analyze table loc_staging compute statistics for columns state,locid,zip,year
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: test@loc_staging
 #### A masked pattern was here ####
 PREHOOK: Output: test@loc_staging
 POSTHOOK: query: analyze table loc_staging compute statistics for columns state,locid,zip,year
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: test@loc_staging
 #### A masked pattern was here ####
 POSTHOOK: Output: test@loc_staging
 PREHOOK: query: analyze table loc_orc compute statistics for columns state,locid,zip,year
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: test@loc_orc
 #### A masked pattern was here ####
 PREHOOK: Output: test@loc_orc
 POSTHOOK: query: analyze table loc_orc compute statistics for columns state,locid,zip,year
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: test@loc_orc
 #### A masked pattern was here ####
 POSTHOOK: Output: test@loc_orc
diff --git a/ql/src/test/results/clientpositive/autoColumnStats_3.q.out b/ql/src/test/results/clientpositive/autoColumnStats_3.q.out
index cae5ebf7ac..73f6f8735f 100644
--- a/ql/src/test/results/clientpositive/autoColumnStats_3.q.out
+++ b/ql/src/test/results/clientpositive/autoColumnStats_3.q.out
@@ -11,12 +11,12 @@ POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@src_multi1
 PREHOOK: query: analyze table src_multi1 compute statistics for columns key
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@src_multi1
 PREHOOK: Output: default@src_multi1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table src_multi1 compute statistics for columns key
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@src_multi1
 POSTHOOK: Output: default@src_multi1
 #### A masked pattern was here ####
@@ -222,14 +222,14 @@ Sort Columns:       	[]
 Storage Desc Params:	 	 
 	serialization.format	1                   
 PREHOOK: query: analyze table nzhang_part14 partition(ds='1', hr='3') compute statistics for columns value
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@nzhang_part14
 PREHOOK: Input: default@nzhang_part14@ds=1/hr=3
 PREHOOK: Output: default@nzhang_part14
 PREHOOK: Output: default@nzhang_part14@ds=1/hr=3
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table nzhang_part14 partition(ds='1', hr='3') compute statistics for columns value
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@nzhang_part14
 POSTHOOK: Input: default@nzhang_part14@ds=1/hr=3
 POSTHOOK: Output: default@nzhang_part14
diff --git a/ql/src/test/results/clientpositive/avro_decimal.q.out b/ql/src/test/results/clientpositive/avro_decimal.q.out
index 4d69221851..25a7065883 100644
--- a/ql/src/test/results/clientpositive/avro_decimal.q.out
+++ b/ql/src/test/results/clientpositive/avro_decimal.q.out
@@ -19,12 +19,12 @@ POSTHOOK: type: LOAD
 #### A masked pattern was here ####
 POSTHOOK: Output: default@dec
 PREHOOK: query: ANALYZE TABLE `dec` COMPUTE STATISTICS FOR COLUMNS value
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@dec
 PREHOOK: Output: default@dec
 #### A masked pattern was here ####
 POSTHOOK: query: ANALYZE TABLE `dec` COMPUTE STATISTICS FOR COLUMNS value
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@dec
 POSTHOOK: Output: default@dec
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/avro_decimal_native.q.out b/ql/src/test/results/clientpositive/avro_decimal_native.q.out
index e4b1739150..3d890ef443 100644
--- a/ql/src/test/results/clientpositive/avro_decimal_native.q.out
+++ b/ql/src/test/results/clientpositive/avro_decimal_native.q.out
@@ -23,12 +23,12 @@ POSTHOOK: type: LOAD
 #### A masked pattern was here ####
 POSTHOOK: Output: default@dec
 PREHOOK: query: ANALYZE TABLE `dec` COMPUTE STATISTICS FOR COLUMNS value
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@dec
 PREHOOK: Output: default@dec
 #### A masked pattern was here ####
 POSTHOOK: query: ANALYZE TABLE `dec` COMPUTE STATISTICS FOR COLUMNS value
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@dec
 POSTHOOK: Output: default@dec
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/beeline/colstats_all_nulls.q.out b/ql/src/test/results/clientpositive/beeline/colstats_all_nulls.q.out
index 49af8f6bc4..7c6c655574 100644
--- a/ql/src/test/results/clientpositive/beeline/colstats_all_nulls.q.out
+++ b/ql/src/test/results/clientpositive/beeline/colstats_all_nulls.q.out
@@ -28,12 +28,12 @@ POSTHOOK: Lineage: all_nulls.a SIMPLE []
 POSTHOOK: Lineage: all_nulls.b SIMPLE []
 POSTHOOK: Lineage: all_nulls.c SIMPLE []
 PREHOOK: query: analyze table all_nulls compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@all_nulls
 #### A masked pattern was here ####
 PREHOOK: Output: default@all_nulls
 POSTHOOK: query: analyze table all_nulls compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@all_nulls
 #### A masked pattern was here ####
 POSTHOOK: Output: default@all_nulls
diff --git a/ql/src/test/results/clientpositive/beeline/materialized_view_create_rewrite.q.out b/ql/src/test/results/clientpositive/beeline/materialized_view_create_rewrite.q.out
index ce03b7ff32..cceaed1470 100644
--- a/ql/src/test/results/clientpositive/beeline/materialized_view_create_rewrite.q.out
+++ b/ql/src/test/results/clientpositive/beeline/materialized_view_create_rewrite.q.out
@@ -29,12 +29,12 @@ POSTHOOK: Lineage: cmv_basetable.b SCRIPT []
 POSTHOOK: Lineage: cmv_basetable.c SCRIPT []
 POSTHOOK: Lineage: cmv_basetable.d SCRIPT []
 PREHOOK: query: analyze table cmv_basetable compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@cmv_basetable
 #### A masked pattern was here ####
 PREHOOK: Output: default@cmv_basetable
 POSTHOOK: query: analyze table cmv_basetable compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@cmv_basetable
 #### A masked pattern was here ####
 POSTHOOK: Output: default@cmv_basetable
diff --git a/ql/src/test/results/clientpositive/beeline/smb_mapjoin_13.q.out b/ql/src/test/results/clientpositive/beeline/smb_mapjoin_13.q.out
index 1204572992..cf36279bac 100644
--- a/ql/src/test/results/clientpositive/beeline/smb_mapjoin_13.q.out
+++ b/ql/src/test/results/clientpositive/beeline/smb_mapjoin_13.q.out
@@ -298,7 +298,7 @@ STAGE PLANS:
               COLUMN_STATS_ACCURATE {"BASIC_STATS":"true","COLUMN_STATS":{"key":"true","value":"true"}}
               SORTBUCKETCOLSPREFIX TRUE
               bucket_count 16
-              bucket_field_name key
+              bucket_field_name key,value
               bucketing_version 2
               column.name.delimiter ,
               columns key,value
@@ -322,7 +322,7 @@ STAGE PLANS:
                 COLUMN_STATS_ACCURATE {"BASIC_STATS":"true","COLUMN_STATS":{"key":"true","value":"true"}}
                 SORTBUCKETCOLSPREFIX TRUE
                 bucket_count 16
-                bucket_field_name key
+                bucket_field_name key,value
                 bucketing_version 2
                 column.name.delimiter ,
                 columns key,value
diff --git a/ql/src/test/results/clientpositive/bucket_map_join_1.q.out b/ql/src/test/results/clientpositive/bucket_map_join_1.q.out
index a09faa1f41..43112a0fc5 100644
--- a/ql/src/test/results/clientpositive/bucket_map_join_1.q.out
+++ b/ql/src/test/results/clientpositive/bucket_map_join_1.q.out
@@ -121,7 +121,7 @@ STAGE PLANS:
             properties:
               SORTBUCKETCOLSPREFIX TRUE
               bucket_count 1
-              bucket_field_name key
+              bucket_field_name key,value
               bucketing_version 2
               column.name.delimiter ,
               columns key,value
@@ -144,7 +144,7 @@ STAGE PLANS:
               properties:
                 SORTBUCKETCOLSPREFIX TRUE
                 bucket_count 1
-                bucket_field_name key
+                bucket_field_name key,value
                 bucketing_version 2
                 column.name.delimiter ,
                 columns key,value
diff --git a/ql/src/test/results/clientpositive/bucket_map_join_2.q.out b/ql/src/test/results/clientpositive/bucket_map_join_2.q.out
index c94dfdabdc..0761f2fb12 100644
--- a/ql/src/test/results/clientpositive/bucket_map_join_2.q.out
+++ b/ql/src/test/results/clientpositive/bucket_map_join_2.q.out
@@ -121,7 +121,7 @@ STAGE PLANS:
             properties:
               SORTBUCKETCOLSPREFIX TRUE
               bucket_count 1
-              bucket_field_name key
+              bucket_field_name key,value
               bucketing_version 2
               column.name.delimiter ,
               columns key,value
@@ -144,7 +144,7 @@ STAGE PLANS:
               properties:
                 SORTBUCKETCOLSPREFIX TRUE
                 bucket_count 1
-                bucket_field_name key
+                bucket_field_name key,value
                 bucketing_version 2
                 column.name.delimiter ,
                 columns key,value
diff --git a/ql/src/test/results/clientpositive/bucketmapjoin_negative3.q.out b/ql/src/test/results/clientpositive/bucketmapjoin_negative3.q.out
index 83e74a5e62..d0ad82b601 100644
--- a/ql/src/test/results/clientpositive/bucketmapjoin_negative3.q.out
+++ b/ql/src/test/results/clientpositive/bucketmapjoin_negative3.q.out
@@ -1394,7 +1394,7 @@ STAGE PLANS:
             properties:
               SORTBUCKETCOLSPREFIX TRUE
               bucket_count 3
-              bucket_field_name key
+              bucket_field_name key,value
               bucketing_version 2
               column.name.delimiter ,
               columns key,value
@@ -1417,7 +1417,7 @@ STAGE PLANS:
               properties:
                 SORTBUCKETCOLSPREFIX TRUE
                 bucket_count 3
-                bucket_field_name key
+                bucket_field_name key,value
                 bucketing_version 2
                 column.name.delimiter ,
                 columns key,value
diff --git a/ql/src/test/results/clientpositive/cbo_rp_annotate_stats_groupby.q.out b/ql/src/test/results/clientpositive/cbo_rp_annotate_stats_groupby.q.out
index c2fd98ab43..cc41758350 100644
--- a/ql/src/test/results/clientpositive/cbo_rp_annotate_stats_groupby.q.out
+++ b/ql/src/test/results/clientpositive/cbo_rp_annotate_stats_groupby.q.out
@@ -74,12 +74,12 @@ STAGE PLANS:
             ListSink
 
 PREHOOK: query: analyze table loc_orc compute statistics for columns state
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@loc_orc
 PREHOOK: Output: default@loc_orc
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table loc_orc compute statistics for columns state
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@loc_orc
 POSTHOOK: Output: default@loc_orc
 #### A masked pattern was here ####
@@ -179,12 +179,12 @@ STAGE PLANS:
         ListSink
 
 PREHOOK: query: analyze table loc_orc compute statistics for columns state,locid,year
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@loc_orc
 PREHOOK: Output: default@loc_orc
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table loc_orc compute statistics for columns state,locid,year
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@loc_orc
 POSTHOOK: Output: default@loc_orc
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/cbo_rp_auto_join1.q.out b/ql/src/test/results/clientpositive/cbo_rp_auto_join1.q.out
index 905887489c..26ae2aa68b 100644
--- a/ql/src/test/results/clientpositive/cbo_rp_auto_join1.q.out
+++ b/ql/src/test/results/clientpositive/cbo_rp_auto_join1.q.out
@@ -47,12 +47,12 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@tbl1
 POSTHOOK: Output: default@tbl1
 PREHOOK: query: analyze table tbl1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@tbl1
 PREHOOK: Output: default@tbl1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table tbl1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@tbl1
 POSTHOOK: Output: default@tbl1
 #### A masked pattern was here ####
@@ -65,12 +65,12 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@tbl2
 POSTHOOK: Output: default@tbl2
 PREHOOK: query: analyze table tbl2 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@tbl2
 PREHOOK: Output: default@tbl2
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table tbl2 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@tbl2
 POSTHOOK: Output: default@tbl2
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/colstats_all_nulls.q.out b/ql/src/test/results/clientpositive/colstats_all_nulls.q.out
index 77e4bf926d..e9525126e1 100644
--- a/ql/src/test/results/clientpositive/colstats_all_nulls.q.out
+++ b/ql/src/test/results/clientpositive/colstats_all_nulls.q.out
@@ -28,12 +28,12 @@ POSTHOOK: Lineage: all_nulls.a SIMPLE []
 POSTHOOK: Lineage: all_nulls.b SIMPLE []
 POSTHOOK: Lineage: all_nulls.c SIMPLE []
 PREHOOK: query: analyze table all_nulls compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@all_nulls
 PREHOOK: Output: default@all_nulls
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table all_nulls compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@all_nulls
 POSTHOOK: Output: default@all_nulls
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/columnStatsUpdateForStatsOptimizer_2.q.out b/ql/src/test/results/clientpositive/columnStatsUpdateForStatsOptimizer_2.q.out
index 7399821f30..fa58add84d 100644
--- a/ql/src/test/results/clientpositive/columnStatsUpdateForStatsOptimizer_2.q.out
+++ b/ql/src/test/results/clientpositive/columnStatsUpdateForStatsOptimizer_2.q.out
@@ -56,12 +56,12 @@ Sort Columns:       	[]
 Storage Desc Params:	 	 
 	serialization.format	1                   
 PREHOOK: query: analyze table calendar compute statistics for columns year
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@calendar
 PREHOOK: Output: default@calendar
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table calendar compute statistics for columns year
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@calendar
 POSTHOOK: Output: default@calendar
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/columnstats_infinity.q.out b/ql/src/test/results/clientpositive/columnstats_infinity.q.out
index e06ff95133..81b4d4f25e 100644
--- a/ql/src/test/results/clientpositive/columnstats_infinity.q.out
+++ b/ql/src/test/results/clientpositive/columnstats_infinity.q.out
@@ -116,12 +116,12 @@ Sort Columns:       	[]
 Storage Desc Params:	 	 
 	serialization.format	1                   
 PREHOOK: query: analyze table table_change_numeric_group_string_group_floating_string_group compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@table_change_numeric_group_string_group_floating_string_group
 PREHOOK: Output: default@table_change_numeric_group_string_group_floating_string_group
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table table_change_numeric_group_string_group_floating_string_group compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@table_change_numeric_group_string_group_floating_string_group
 POSTHOOK: Output: default@table_change_numeric_group_string_group_floating_string_group
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/columnstats_partlvl.q.out b/ql/src/test/results/clientpositive/columnstats_partlvl.q.out
index 602714bc6d..ca07f615d1 100644
--- a/ql/src/test/results/clientpositive/columnstats_partlvl.q.out
+++ b/ql/src/test/results/clientpositive/columnstats_partlvl.q.out
@@ -32,10 +32,10 @@ POSTHOOK: Output: default@employee_part
 POSTHOOK: Output: default@employee_part@employeesalary=4000.0
 PREHOOK: query: explain 
 analyze table Employee_Part partition (employeeSalary=2000.0) compute statistics for columns employeeID
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 POSTHOOK: query: explain 
 analyze table Employee_Part partition (employeeSalary=2000.0) compute statistics for columns employeeID
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-1 depends on stages: Stage-0
@@ -92,10 +92,10 @@ STAGE PLANS:
 
 PREHOOK: query: explain extended
 analyze table Employee_Part partition (employeeSalary=2000.0) compute statistics for columns employeeID
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 POSTHOOK: query: explain extended
 analyze table Employee_Part partition (employeeSalary=2000.0) compute statistics for columns employeeID
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-1 depends on stages: Stage-0
@@ -228,14 +228,14 @@ STAGE PLANS:
           Is Table Level Stats: false
 
 PREHOOK: query: analyze table Employee_Part partition (employeeSalary=2000.0) compute statistics for columns employeeID
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@employee_part
 PREHOOK: Input: default@employee_part@employeesalary=2000.0
 PREHOOK: Output: default@employee_part
 PREHOOK: Output: default@employee_part@employeesalary=2000.0
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table Employee_Part partition (employeeSalary=2000.0) compute statistics for columns employeeID
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@employee_part
 POSTHOOK: Input: default@employee_part@employeesalary=2000.0
 POSTHOOK: Output: default@employee_part
@@ -281,10 +281,10 @@ Storage Desc Params:
 	serialization.format	|                   
 PREHOOK: query: explain 
 analyze table Employee_Part partition (employeeSalary=4000.0) compute statistics for columns employeeID
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 POSTHOOK: query: explain 
 analyze table Employee_Part partition (employeeSalary=4000.0) compute statistics for columns employeeID
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-1 depends on stages: Stage-0
@@ -341,10 +341,10 @@ STAGE PLANS:
 
 PREHOOK: query: explain extended
 analyze table Employee_Part partition (employeeSalary=4000.0) compute statistics for columns employeeID
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 POSTHOOK: query: explain extended
 analyze table Employee_Part partition (employeeSalary=4000.0) compute statistics for columns employeeID
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-1 depends on stages: Stage-0
@@ -477,14 +477,14 @@ STAGE PLANS:
           Is Table Level Stats: false
 
 PREHOOK: query: analyze table Employee_Part partition (employeeSalary=4000.0) compute statistics for columns employeeID
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@employee_part
 PREHOOK: Input: default@employee_part@employeesalary=4000.0
 PREHOOK: Output: default@employee_part
 PREHOOK: Output: default@employee_part@employeesalary=4000.0
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table Employee_Part partition (employeeSalary=4000.0) compute statistics for columns employeeID
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@employee_part
 POSTHOOK: Input: default@employee_part@employeesalary=4000.0
 POSTHOOK: Output: default@employee_part
@@ -492,10 +492,10 @@ POSTHOOK: Output: default@employee_part@employeesalary=4000.0
 #### A masked pattern was here ####
 PREHOOK: query: explain 
 analyze table Employee_Part partition (employeeSalary=2000.0) compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 POSTHOOK: query: explain 
 analyze table Employee_Part partition (employeeSalary=2000.0) compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-1 depends on stages: Stage-0
@@ -551,14 +551,14 @@ STAGE PLANS:
           Table: default.employee_part
 
 PREHOOK: query: analyze table Employee_Part partition (employeeSalary=2000.0) compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@employee_part
 PREHOOK: Input: default@employee_part@employeesalary=2000.0
 PREHOOK: Output: default@employee_part
 PREHOOK: Output: default@employee_part@employeesalary=2000.0
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table Employee_Part partition (employeeSalary=2000.0) compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@employee_part
 POSTHOOK: Input: default@employee_part@employeesalary=2000.0
 POSTHOOK: Output: default@employee_part
@@ -602,10 +602,10 @@ bitVector           	HL
 comment             	from deserializer   	 	 	 	 	 	 	 	 	 	 
 PREHOOK: query: explain 
 analyze table Employee_Part  compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 POSTHOOK: query: explain 
 analyze table Employee_Part  compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-1 depends on stages: Stage-0
@@ -661,7 +661,7 @@ STAGE PLANS:
           Table: default.employee_part
 
 PREHOOK: query: analyze table Employee_Part  compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@employee_part
 PREHOOK: Input: default@employee_part@employeesalary=2000.0
 PREHOOK: Input: default@employee_part@employeesalary=4000.0
@@ -670,7 +670,7 @@ PREHOOK: Output: default@employee_part@employeesalary=2000.0
 PREHOOK: Output: default@employee_part@employeesalary=4000.0
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table Employee_Part  compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@employee_part
 POSTHOOK: Input: default@employee_part@employeesalary=2000.0
 POSTHOOK: Input: default@employee_part@employeesalary=4000.0
@@ -716,10 +716,10 @@ bitVector           	HL
 comment             	from deserializer   	 	 	 	 	 	 	 	 	 	 
 PREHOOK: query: explain 
 analyze table Employee_Part  compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 POSTHOOK: query: explain 
 analyze table Employee_Part  compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-1 depends on stages: Stage-0
@@ -767,7 +767,7 @@ STAGE PLANS:
           Table: default.employee_part
 
 PREHOOK: query: analyze table Employee_Part  compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@employee_part
 PREHOOK: Input: default@employee_part@employeesalary=2000.0
 PREHOOK: Input: default@employee_part@employeesalary=4000.0
@@ -776,7 +776,7 @@ PREHOOK: Output: default@employee_part@employeesalary=2000.0
 PREHOOK: Output: default@employee_part@employeesalary=4000.0
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table Employee_Part  compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@employee_part
 POSTHOOK: Input: default@employee_part@employeesalary=2000.0
 POSTHOOK: Input: default@employee_part@employeesalary=4000.0
@@ -816,14 +816,14 @@ POSTHOOK: query: use dummydb
 POSTHOOK: type: SWITCHDATABASE
 POSTHOOK: Input: database:dummydb
 PREHOOK: query: analyze table default.Employee_Part partition (employeeSalary=2000.0) compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@employee_part
 PREHOOK: Input: default@employee_part@employeesalary=2000.0
 PREHOOK: Output: default@employee_part
 PREHOOK: Output: default@employee_part@employeesalary=2000.0
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table default.Employee_Part partition (employeeSalary=2000.0) compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@employee_part
 POSTHOOK: Input: default@employee_part@employeesalary=2000.0
 POSTHOOK: Output: default@employee_part
@@ -849,7 +849,7 @@ bitVector           	HL
 comment             	from deserializer   	 	 	 	 	 	 	 	 	 	 
 COLUMN_STATS_ACCURATE	{\"COLUMN_STATS\":{\"employeeid\":\"true\",\"employeename\":\"true\"}}	 	 	 	 	 	 	 	 	 	 
 PREHOOK: query: analyze table default.Employee_Part  compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@employee_part
 PREHOOK: Input: default@employee_part@employeesalary=2000.0
 PREHOOK: Input: default@employee_part@employeesalary=4000.0
@@ -858,7 +858,7 @@ PREHOOK: Output: default@employee_part@employeesalary=2000.0
 PREHOOK: Output: default@employee_part@employeesalary=4000.0
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table default.Employee_Part  compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@employee_part
 POSTHOOK: Input: default@employee_part@employeesalary=2000.0
 POSTHOOK: Input: default@employee_part@employeesalary=4000.0
diff --git a/ql/src/test/results/clientpositive/columnstats_partlvl_dp.q.out b/ql/src/test/results/clientpositive/columnstats_partlvl_dp.q.out
index 66b44bfbab..b45249ce52 100644
--- a/ql/src/test/results/clientpositive/columnstats_partlvl_dp.q.out
+++ b/ql/src/test/results/clientpositive/columnstats_partlvl_dp.q.out
@@ -68,10 +68,10 @@ POSTHOOK: Output: default@employee_part
 POSTHOOK: Output: default@employee_part@employeesalary=3000.0/country=UK
 PREHOOK: query: explain 
 analyze table Employee_Part partition (employeeSalary='4000.0', country) compute statistics for columns employeeName, employeeID
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 POSTHOOK: query: explain 
 analyze table Employee_Part partition (employeeSalary='4000.0', country) compute statistics for columns employeeName, employeeID
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-1 depends on stages: Stage-0
@@ -127,14 +127,14 @@ STAGE PLANS:
           Table: default.employee_part
 
 PREHOOK: query: analyze table Employee_Part partition (employeeSalary='4000.0', country) compute statistics for columns employeeName, employeeID
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@employee_part
 PREHOOK: Input: default@employee_part@employeesalary=4000.0/country=USA
 PREHOOK: Output: default@employee_part
 PREHOOK: Output: default@employee_part@employeesalary=4000.0/country=USA
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table Employee_Part partition (employeeSalary='4000.0', country) compute statistics for columns employeeName, employeeID
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@employee_part
 POSTHOOK: Input: default@employee_part@employeesalary=4000.0/country=USA
 POSTHOOK: Output: default@employee_part
@@ -199,10 +199,10 @@ bitVector           	HL
 comment             	from deserializer   	 	 	 	 	 	 	 	 	 	 
 PREHOOK: query: explain	
 analyze table Employee_Part partition (employeeSalary='2000.0') compute statistics for columns employeeID
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 POSTHOOK: query: explain	
 analyze table Employee_Part partition (employeeSalary='2000.0') compute statistics for columns employeeID
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-1 depends on stages: Stage-0
@@ -258,7 +258,7 @@ STAGE PLANS:
           Table: default.employee_part
 
 PREHOOK: query: analyze table Employee_Part partition (employeeSalary='2000.0') compute statistics for columns employeeID
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@employee_part
 PREHOOK: Input: default@employee_part@employeesalary=2000.0/country=UK
 PREHOOK: Input: default@employee_part@employeesalary=2000.0/country=USA
@@ -267,7 +267,7 @@ PREHOOK: Output: default@employee_part@employeesalary=2000.0/country=UK
 PREHOOK: Output: default@employee_part@employeesalary=2000.0/country=USA
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table Employee_Part partition (employeeSalary='2000.0') compute statistics for columns employeeID
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@employee_part
 POSTHOOK: Input: default@employee_part@employeesalary=2000.0/country=UK
 POSTHOOK: Input: default@employee_part@employeesalary=2000.0/country=USA
@@ -313,10 +313,10 @@ bitVector           	HL
 comment             	from deserializer   	 	 	 	 	 	 	 	 	 	 
 PREHOOK: query: explain	
 analyze table Employee_Part partition (employeeSalary) compute statistics for columns employeeID
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 POSTHOOK: query: explain	
 analyze table Employee_Part partition (employeeSalary) compute statistics for columns employeeID
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-1 depends on stages: Stage-0
@@ -372,7 +372,7 @@ STAGE PLANS:
           Table: default.employee_part
 
 PREHOOK: query: analyze table Employee_Part partition (employeeSalary) compute statistics for columns employeeID
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@employee_part
 PREHOOK: Input: default@employee_part@employeesalary=2000.0/country=UK
 PREHOOK: Input: default@employee_part@employeesalary=2000.0/country=USA
@@ -389,7 +389,7 @@ PREHOOK: Output: default@employee_part@employeesalary=3500.0/country=UK
 PREHOOK: Output: default@employee_part@employeesalary=4000.0/country=USA
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table Employee_Part partition (employeeSalary) compute statistics for columns employeeID
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@employee_part
 POSTHOOK: Input: default@employee_part@employeesalary=2000.0/country=UK
 POSTHOOK: Input: default@employee_part@employeesalary=2000.0/country=USA
@@ -425,10 +425,10 @@ bitVector           	HL
 comment             	from deserializer   	 	 	 	 	 	 	 	 	 	 
 PREHOOK: query: explain	
 analyze table Employee_Part partition (employeeSalary,country) compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 POSTHOOK: query: explain	
 analyze table Employee_Part partition (employeeSalary,country) compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-1 depends on stages: Stage-0
@@ -484,7 +484,7 @@ STAGE PLANS:
           Table: default.employee_part
 
 PREHOOK: query: analyze table Employee_Part partition (employeeSalary,country) compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@employee_part
 PREHOOK: Input: default@employee_part@employeesalary=2000.0/country=UK
 PREHOOK: Input: default@employee_part@employeesalary=2000.0/country=USA
@@ -501,7 +501,7 @@ PREHOOK: Output: default@employee_part@employeesalary=3500.0/country=UK
 PREHOOK: Output: default@employee_part@employeesalary=4000.0/country=USA
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table Employee_Part partition (employeeSalary,country) compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@employee_part
 POSTHOOK: Input: default@employee_part@employeesalary=2000.0/country=UK
 POSTHOOK: Input: default@employee_part@employeesalary=2000.0/country=USA
@@ -586,7 +586,7 @@ POSTHOOK: type: LOAD
 POSTHOOK: Output: default@employee
 POSTHOOK: Output: default@employee@employeesalary=3000.0/country=UK
 PREHOOK: query: analyze table Employee partition (employeeSalary,country) compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@employee
 PREHOOK: Input: default@employee@employeesalary=2000.0/country=UK
 PREHOOK: Input: default@employee@employeesalary=2000.0/country=USA
@@ -599,7 +599,7 @@ PREHOOK: Output: default@employee@employeesalary=3000.0/country=UK
 PREHOOK: Output: default@employee@employeesalary=3500.0/country=UK
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table Employee partition (employeeSalary,country) compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@employee
 POSTHOOK: Input: default@employee@employeesalary=2000.0/country=UK
 POSTHOOK: Input: default@employee@employeesalary=2000.0/country=USA
@@ -648,7 +648,7 @@ POSTHOOK: type: LOAD
 POSTHOOK: Output: default@employee
 POSTHOOK: Output: default@employee@employeesalary=4000.0/country=USA
 PREHOOK: query: analyze table Employee partition (employeeSalary) compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@employee
 PREHOOK: Input: default@employee@employeesalary=2000.0/country=UK
 PREHOOK: Input: default@employee@employeesalary=2000.0/country=USA
@@ -665,7 +665,7 @@ PREHOOK: Output: default@employee@employeesalary=3500.0/country=UK
 PREHOOK: Output: default@employee@employeesalary=4000.0/country=USA
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table Employee partition (employeeSalary) compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@employee
 POSTHOOK: Input: default@employee@employeesalary=2000.0/country=UK
 POSTHOOK: Input: default@employee@employeesalary=2000.0/country=USA
@@ -717,14 +717,14 @@ POSTHOOK: type: LOAD
 POSTHOOK: Output: default@employee
 POSTHOOK: Output: default@employee@employeesalary=6000.0/country=UK
 PREHOOK: query: analyze table Employee partition (employeeSalary='6000.0',country='UK') compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@employee
 PREHOOK: Input: default@employee@employeesalary=6000.0/country=UK
 PREHOOK: Output: default@employee
 PREHOOK: Output: default@employee@employeesalary=6000.0/country=UK
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table Employee partition (employeeSalary='6000.0',country='UK') compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@employee
 POSTHOOK: Input: default@employee@employeesalary=6000.0/country=UK
 POSTHOOK: Output: default@employee
diff --git a/ql/src/test/results/clientpositive/columnstats_quoting.q.out b/ql/src/test/results/clientpositive/columnstats_quoting.q.out
index 00fd199d80..8ed8239711 100644
--- a/ql/src/test/results/clientpositive/columnstats_quoting.q.out
+++ b/ql/src/test/results/clientpositive/columnstats_quoting.q.out
@@ -11,9 +11,9 @@ POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@user_web_events
 PREHOOK: query: explain analyze table user_web_events compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 POSTHOOK: query: explain analyze table user_web_events compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-1 depends on stages: Stage-0
@@ -61,19 +61,19 @@ STAGE PLANS:
           Table: default.user_web_events
 
 PREHOOK: query: analyze table user_web_events compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@user_web_events
 PREHOOK: Output: default@user_web_events
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table user_web_events compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@user_web_events
 POSTHOOK: Output: default@user_web_events
 #### A masked pattern was here ####
 PREHOOK: query: explain analyze table user_web_events compute statistics for columns `user id`
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 POSTHOOK: query: explain analyze table user_web_events compute statistics for columns `user id`
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-1 depends on stages: Stage-0
@@ -121,12 +121,12 @@ STAGE PLANS:
           Table: default.user_web_events
 
 PREHOOK: query: analyze table user_web_events compute statistics for columns `user id`
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@user_web_events
 PREHOOK: Output: default@user_web_events
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table user_web_events compute statistics for columns `user id`
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@user_web_events
 POSTHOOK: Output: default@user_web_events
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/columnstats_tbllvl.q.out b/ql/src/test/results/clientpositive/columnstats_tbllvl.q.out
index 6cbcab0447..0b4bb47988 100644
--- a/ql/src/test/results/clientpositive/columnstats_tbllvl.q.out
+++ b/ql/src/test/results/clientpositive/columnstats_tbllvl.q.out
@@ -40,10 +40,10 @@ POSTHOOK: type: LOAD
 POSTHOOK: Output: default@uservisits_web_text_none
 PREHOOK: query: explain 
 analyze table UserVisits_web_text_none compute statistics for columns sourceIP, avgTimeOnSite, adRevenue
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 POSTHOOK: query: explain 
 analyze table UserVisits_web_text_none compute statistics for columns sourceIP, avgTimeOnSite, adRevenue
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-1 depends on stages: Stage-0
@@ -92,10 +92,10 @@ STAGE PLANS:
 
 PREHOOK: query: explain extended
 analyze table UserVisits_web_text_none compute statistics for columns sourceIP, avgTimeOnSite, adRevenue
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 POSTHOOK: query: explain extended
 analyze table UserVisits_web_text_none compute statistics for columns sourceIP, avgTimeOnSite, adRevenue
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-1 depends on stages: Stage-0
@@ -219,21 +219,21 @@ STAGE PLANS:
           Is Table Level Stats: true
 
 PREHOOK: query: analyze table UserVisits_web_text_none compute statistics for columns sourceIP, avgTimeOnSite, adRevenue
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@uservisits_web_text_none
 PREHOOK: Output: default@uservisits_web_text_none
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table UserVisits_web_text_none compute statistics for columns sourceIP, avgTimeOnSite, adRevenue
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@uservisits_web_text_none
 POSTHOOK: Output: default@uservisits_web_text_none
 #### A masked pattern was here ####
 PREHOOK: query: explain 
 analyze table default.UserVisits_web_text_none compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 POSTHOOK: query: explain 
 analyze table default.UserVisits_web_text_none compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-1 depends on stages: Stage-0
@@ -281,12 +281,12 @@ STAGE PLANS:
           Table: default.uservisits_web_text_none
 
 PREHOOK: query: analyze table default.UserVisits_web_text_none compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@uservisits_web_text_none
 PREHOOK: Output: default@uservisits_web_text_none
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table default.UserVisits_web_text_none compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@uservisits_web_text_none
 POSTHOOK: Output: default@uservisits_web_text_none
 #### A masked pattern was here ####
@@ -369,10 +369,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@empty_tab
 PREHOOK: query: explain 
 analyze table empty_tab compute statistics for columns a,b,c,d,e
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 POSTHOOK: query: explain 
 analyze table empty_tab compute statistics for columns a,b,c,d,e
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-1 depends on stages: Stage-0
@@ -420,12 +420,12 @@ STAGE PLANS:
           Table: default.empty_tab
 
 PREHOOK: query: analyze table empty_tab compute statistics for columns a,b,c,d,e
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@empty_tab
 PREHOOK: Output: default@empty_tab
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table empty_tab compute statistics for columns a,b,c,d,e
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@empty_tab
 POSTHOOK: Output: default@empty_tab
 #### A masked pattern was here ####
@@ -442,12 +442,12 @@ POSTHOOK: query: use dummydb
 POSTHOOK: type: SWITCHDATABASE
 POSTHOOK: Input: database:dummydb
 PREHOOK: query: analyze table default.UserVisits_web_text_none compute statistics for columns destURL
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@uservisits_web_text_none
 PREHOOK: Output: default@uservisits_web_text_none
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table default.UserVisits_web_text_none compute statistics for columns destURL
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@uservisits_web_text_none
 POSTHOOK: Output: default@uservisits_web_text_none
 #### A masked pattern was here ####
@@ -514,10 +514,10 @@ POSTHOOK: type: SWITCHDATABASE
 POSTHOOK: Input: database:default
 PREHOOK: query: explain 
 analyze table dummydb.UserVisits_in_dummy_db compute statistics for columns sourceIP, avgTimeOnSite, adRevenue
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 POSTHOOK: query: explain 
 analyze table dummydb.UserVisits_in_dummy_db compute statistics for columns sourceIP, avgTimeOnSite, adRevenue
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-1 depends on stages: Stage-0
@@ -566,10 +566,10 @@ STAGE PLANS:
 
 PREHOOK: query: explain extended
 analyze table dummydb.UserVisits_in_dummy_db compute statistics for columns sourceIP, avgTimeOnSite, adRevenue
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 POSTHOOK: query: explain extended
 analyze table dummydb.UserVisits_in_dummy_db compute statistics for columns sourceIP, avgTimeOnSite, adRevenue
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-1 depends on stages: Stage-0
@@ -693,21 +693,21 @@ STAGE PLANS:
           Is Table Level Stats: true
 
 PREHOOK: query: analyze table dummydb.UserVisits_in_dummy_db compute statistics for columns sourceIP, avgTimeOnSite, adRevenue
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: dummydb@uservisits_in_dummy_db
 PREHOOK: Output: dummydb@uservisits_in_dummy_db
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table dummydb.UserVisits_in_dummy_db compute statistics for columns sourceIP, avgTimeOnSite, adRevenue
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: dummydb@uservisits_in_dummy_db
 POSTHOOK: Output: dummydb@uservisits_in_dummy_db
 #### A masked pattern was here ####
 PREHOOK: query: explain 
 analyze table dummydb.UserVisits_in_dummy_db compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 POSTHOOK: query: explain 
 analyze table dummydb.UserVisits_in_dummy_db compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-1 depends on stages: Stage-0
@@ -755,12 +755,12 @@ STAGE PLANS:
           Table: dummydb.uservisits_in_dummy_db
 
 PREHOOK: query: analyze table dummydb.UserVisits_in_dummy_db compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: dummydb@uservisits_in_dummy_db
 PREHOOK: Output: dummydb@uservisits_in_dummy_db
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table dummydb.UserVisits_in_dummy_db compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: dummydb@uservisits_in_dummy_db
 POSTHOOK: Output: dummydb@uservisits_in_dummy_db
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/compustat_avro.q.out b/ql/src/test/results/clientpositive/compustat_avro.q.out
index f168cc5d50..45fd76495b 100644
--- a/ql/src/test/results/clientpositive/compustat_avro.q.out
+++ b/ql/src/test/results/clientpositive/compustat_avro.q.out
@@ -44,12 +44,12 @@ bitVector
 comment             	from deserializer   	 	 	 	 	 	 	 	 	 	 
 COLUMN_STATS_ACCURATE	{\"BASIC_STATS\":\"true\",\"COLUMN_STATS\":{\"col1\":\"true\",\"col2\":\"true\",\"col3\":\"true\",\"col4\":\"true\",\"col5\":\"true\",\"col6\":\"true\"}}	 	 	 	 	 	 	 	 	 	 
 PREHOOK: query: analyze table testAvro compute statistics for columns col1,col3
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@testavro
 PREHOOK: Output: default@testavro
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table testAvro compute statistics for columns col1,col3
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@testavro
 POSTHOOK: Output: default@testavro
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/compute_stats_date.q.out b/ql/src/test/results/clientpositive/compute_stats_date.q.out
index 1c12421259..35c0f8d41a 100644
--- a/ql/src/test/results/clientpositive/compute_stats_date.q.out
+++ b/ql/src/test/results/clientpositive/compute_stats_date.q.out
@@ -46,10 +46,10 @@ POSTHOOK: Input: default@tab_date
 {"columntype":"Date","min":"2000-11-20","max":"2010-10-29","countnulls":0,"numdistinctvalues":19,"ndvbitvector":HLL!]YTPRWN}
 PREHOOK: query: explain
 analyze table tab_date compute statistics for columns fl_date
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 POSTHOOK: query: explain
 analyze table tab_date compute statistics for columns fl_date
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-1 depends on stages: Stage-0
@@ -97,12 +97,12 @@ STAGE PLANS:
           Table: default.tab_date
 
 PREHOOK: query: analyze table tab_date compute statistics for columns fl_date
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@tab_date
 PREHOOK: Output: default@tab_date
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table tab_date compute statistics for columns fl_date
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@tab_date
 POSTHOOK: Output: default@tab_date
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/constGby.q.out b/ql/src/test/results/clientpositive/constGby.q.out
index bd63ec210d..e5c60352e2 100644
--- a/ql/src/test/results/clientpositive/constGby.q.out
+++ b/ql/src/test/results/clientpositive/constGby.q.out
@@ -15,12 +15,12 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@t1
 POSTHOOK: Output: default@t1
 PREHOOK: query: analyze table t1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@t1
 PREHOOK: Output: default@t1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table t1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@t1
 POSTHOOK: Output: default@t1
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/constant_prop_2.q.out b/ql/src/test/results/clientpositive/constant_prop_2.q.out
index 7c452451bd..cdd3913665 100644
--- a/ql/src/test/results/clientpositive/constant_prop_2.q.out
+++ b/ql/src/test/results/clientpositive/constant_prop_2.q.out
@@ -23,10 +23,10 @@ POSTHOOK: Input: default@src
 500
 PREHOOK: query: explain 
 analyze table srcpart partition (ds='2008-04-08',hr=11) compute statistics for columns key, value
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 POSTHOOK: query: explain 
 analyze table srcpart partition (ds='2008-04-08',hr=11) compute statistics for columns key, value
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-1 depends on stages: Stage-0
diff --git a/ql/src/test/results/clientpositive/constant_prop_3.q.out b/ql/src/test/results/clientpositive/constant_prop_3.q.out
index f3b12667ae..3ac1991fd7 100644
--- a/ql/src/test/results/clientpositive/constant_prop_3.q.out
+++ b/ql/src/test/results/clientpositive/constant_prop_3.q.out
@@ -49,12 +49,12 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@part_hive
 POSTHOOK: Output: default@part_hive
 PREHOOK: query: analyze table part_hive compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@part_hive
 PREHOOK: Output: default@part_hive
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table part_hive compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@part_hive
 POSTHOOK: Output: default@part_hive
 #### A masked pattern was here ####
@@ -67,12 +67,12 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@partsupp_hive
 POSTHOOK: Output: default@partsupp_hive
 PREHOOK: query: analyze table partsupp_hive compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@partsupp_hive
 PREHOOK: Output: default@partsupp_hive
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table partsupp_hive compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@partsupp_hive
 POSTHOOK: Output: default@partsupp_hive
 #### A masked pattern was here ####
@@ -85,12 +85,12 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@supplier_hive
 POSTHOOK: Output: default@supplier_hive
 PREHOOK: query: analyze table supplier_hive compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@supplier_hive
 PREHOOK: Output: default@supplier_hive
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table supplier_hive compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@supplier_hive
 POSTHOOK: Output: default@supplier_hive
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/correlated_join_keys.q.out b/ql/src/test/results/clientpositive/correlated_join_keys.q.out
index c6e1ee186b..08c3145600 100644
--- a/ql/src/test/results/clientpositive/correlated_join_keys.q.out
+++ b/ql/src/test/results/clientpositive/correlated_join_keys.q.out
@@ -59,12 +59,12 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@customer_address
 POSTHOOK: Output: default@customer_address
 PREHOOK: query: analyze table customer_address compute statistics for columns ca_state, ca_zip
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@customer_address
 PREHOOK: Output: default@customer_address
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table customer_address compute statistics for columns ca_state, ca_zip
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@customer_address
 POSTHOOK: Output: default@customer_address
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/decimal_stats.q.out b/ql/src/test/results/clientpositive/decimal_stats.q.out
index af48956147..63b16bc3a1 100644
--- a/ql/src/test/results/clientpositive/decimal_stats.q.out
+++ b/ql/src/test/results/clientpositive/decimal_stats.q.out
@@ -33,12 +33,12 @@ POSTHOOK: Lineage: decimal_1.t SIMPLE []
 POSTHOOK: Lineage: decimal_1.u EXPRESSION []
 POSTHOOK: Lineage: decimal_1.v EXPRESSION []
 PREHOOK: query: analyze table decimal_1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@decimal_1
 PREHOOK: Output: default@decimal_1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table decimal_1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@decimal_1
 POSTHOOK: Output: default@decimal_1
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/deleteAnalyze.q.out b/ql/src/test/results/clientpositive/deleteAnalyze.q.out
index be45b7580e..4925a12e48 100644
--- a/ql/src/test/results/clientpositive/deleteAnalyze.q.out
+++ b/ql/src/test/results/clientpositive/deleteAnalyze.q.out
@@ -88,12 +88,12 @@ bitVector           	HL
 comment             	from deserializer   	 	 	 	 	 	 	 	 	 	 
 COLUMN_STATS_ACCURATE	{\"BASIC_STATS\":\"true\",\"COLUMN_STATS\":{\"amount\":\"true\",\"id\":\"true\",\"item\":\"true\",\"sales_tax\":\"true\"}}	 	 	 	 	 	 	 	 	 	 
 PREHOOK: query: analyze table testdeci2 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@testdeci2
 PREHOOK: Output: default@testdeci2
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table testdeci2 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@testdeci2
 POSTHOOK: Output: default@testdeci2
 #### A masked pattern was here ####
@@ -135,12 +135,12 @@ Sort Columns:       	[]
 Storage Desc Params:	 	 
 	serialization.format	1                   
 PREHOOK: query: analyze table testdeci2 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@testdeci2
 PREHOOK: Output: default@testdeci2
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table testdeci2 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@testdeci2
 POSTHOOK: Output: default@testdeci2
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/display_colstats_tbllvl.q.out b/ql/src/test/results/clientpositive/display_colstats_tbllvl.q.out
index 927c27ee93..51cc2778a4 100644
--- a/ql/src/test/results/clientpositive/display_colstats_tbllvl.q.out
+++ b/ql/src/test/results/clientpositive/display_colstats_tbllvl.q.out
@@ -65,10 +65,10 @@ bitVector
 comment             	from deserializer   	 	 	 	 	 	 	 	 	 	 
 PREHOOK: query: explain
 analyze table UserVisits_web_text_none compute statistics for columns sourceIP, avgTimeOnSite, adRevenue
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 POSTHOOK: query: explain
 analyze table UserVisits_web_text_none compute statistics for columns sourceIP, avgTimeOnSite, adRevenue
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-1 depends on stages: Stage-0
@@ -117,10 +117,10 @@ STAGE PLANS:
 
 PREHOOK: query: explain extended
 analyze table UserVisits_web_text_none compute statistics for columns sourceIP, avgTimeOnSite, adRevenue
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 POSTHOOK: query: explain extended
 analyze table UserVisits_web_text_none compute statistics for columns sourceIP, avgTimeOnSite, adRevenue
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-1 depends on stages: Stage-0
@@ -244,12 +244,12 @@ STAGE PLANS:
           Is Table Level Stats: true
 
 PREHOOK: query: analyze table UserVisits_web_text_none compute statistics for columns sourceIP, avgTimeOnSite, adRevenue
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@uservisits_web_text_none
 PREHOOK: Output: default@uservisits_web_text_none
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table UserVisits_web_text_none compute statistics for columns sourceIP, avgTimeOnSite, adRevenue
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@uservisits_web_text_none
 POSTHOOK: Output: default@uservisits_web_text_none
 #### A masked pattern was here ####
@@ -351,10 +351,10 @@ comment             	from deserializer
 COLUMN_STATS_ACCURATE	{\"BASIC_STATS\":\"true\",\"COLUMN_STATS\":{\"a\":\"true\",\"b\":\"true\",\"c\":\"true\",\"d\":\"true\",\"e\":\"true\"}}	 	 	 	 	 	 	 	 	 	 
 PREHOOK: query: explain
 analyze table empty_tab compute statistics for columns a,b,c,d,e
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 POSTHOOK: query: explain
 analyze table empty_tab compute statistics for columns a,b,c,d,e
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-1 depends on stages: Stage-0
@@ -402,12 +402,12 @@ STAGE PLANS:
           Table: default.empty_tab
 
 PREHOOK: query: analyze table empty_tab compute statistics for columns a,b,c,d,e
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@empty_tab
 PREHOOK: Output: default@empty_tab
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table empty_tab compute statistics for columns a,b,c,d,e
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@empty_tab
 POSTHOOK: Output: default@empty_tab
 #### A masked pattern was here ####
@@ -575,12 +575,12 @@ bitVector           	HL
 comment             	from deserializer   	 	 	 	 	 	 	 	 	 	 
 COLUMN_STATS_ACCURATE	{\"BASIC_STATS\":\"true\",\"COLUMN_STATS\":{\"adrevenue\":\"true\",\"avgtimeonsite\":\"true\",\"sourceip\":\"true\"}}	 	 	 	 	 	 	 	 	 	 
 PREHOOK: query: analyze table UserVisits_web_text_none compute statistics for columns sKeyword
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: test@uservisits_web_text_none
 #### A masked pattern was here ####
 PREHOOK: Output: test@uservisits_web_text_none
 POSTHOOK: query: analyze table UserVisits_web_text_none compute statistics for columns sKeyword
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: test@uservisits_web_text_none
 #### A masked pattern was here ####
 POSTHOOK: Output: test@uservisits_web_text_none
diff --git a/ql/src/test/results/clientpositive/distinct_stats.q.out b/ql/src/test/results/clientpositive/distinct_stats.q.out
index 4121b7d8a2..eac0bb94eb 100644
--- a/ql/src/test/results/clientpositive/distinct_stats.q.out
+++ b/ql/src/test/results/clientpositive/distinct_stats.q.out
@@ -17,12 +17,12 @@ POSTHOOK: Output: default@t1
 POSTHOOK: Lineage: t1.a SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: t1.b SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: analyze table t1 compute statistics for columns a,b
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@t1
 PREHOOK: Output: default@t1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table t1 compute statistics for columns a,b
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@t1
 POSTHOOK: Output: default@t1
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/drop_table_with_stats.q.out b/ql/src/test/results/clientpositive/drop_table_with_stats.q.out
index 119f74a87e..161a84c52d 100644
--- a/ql/src/test/results/clientpositive/drop_table_with_stats.q.out
+++ b/ql/src/test/results/clientpositive/drop_table_with_stats.q.out
@@ -27,12 +27,12 @@ POSTHOOK: type: LOAD
 #### A masked pattern was here ####
 POSTHOOK: Output: tblstatsdb1@testtable
 PREHOOK: query: ANALYZE TABLE testtable COMPUTE STATISTICS FOR COLUMNS key
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: tblstatsdb1@testtable
 #### A masked pattern was here ####
 PREHOOK: Output: tblstatsdb1@testtable
 POSTHOOK: query: ANALYZE TABLE testtable COMPUTE STATISTICS FOR COLUMNS key
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: tblstatsdb1@testtable
 #### A masked pattern was here ####
 POSTHOOK: Output: tblstatsdb1@testtable
@@ -53,12 +53,12 @@ POSTHOOK: type: LOAD
 #### A masked pattern was here ####
 POSTHOOK: Output: tblstatsdb1@testtable1
 PREHOOK: query: ANALYZE TABLE TestTable1 COMPUTE STATISTICS FOR COLUMNS key
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: tblstatsdb1@testtable1
 #### A masked pattern was here ####
 PREHOOK: Output: tblstatsdb1@testtable1
 POSTHOOK: query: ANALYZE TABLE TestTable1 COMPUTE STATISTICS FOR COLUMNS key
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: tblstatsdb1@testtable1
 #### A masked pattern was here ####
 POSTHOOK: Output: tblstatsdb1@testtable1
@@ -79,12 +79,12 @@ POSTHOOK: type: LOAD
 #### A masked pattern was here ####
 POSTHOOK: Output: tblstatsdb1@testtable2
 PREHOOK: query: ANALYZE TABLE TESTTABLE2 COMPUTE STATISTICS FOR COLUMNS key
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: tblstatsdb1@testtable2
 #### A masked pattern was here ####
 PREHOOK: Output: tblstatsdb1@testtable2
 POSTHOOK: query: ANALYZE TABLE TESTTABLE2 COMPUTE STATISTICS FOR COLUMNS key
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: tblstatsdb1@testtable2
 #### A masked pattern was here ####
 POSTHOOK: Output: tblstatsdb1@testtable2
@@ -149,12 +149,12 @@ POSTHOOK: type: LOAD
 #### A masked pattern was here ####
 POSTHOOK: Output: tblstatsdb2@testtable
 PREHOOK: query: ANALYZE TABLE testtable COMPUTE STATISTICS FOR COLUMNS key
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: tblstatsdb2@testtable
 #### A masked pattern was here ####
 PREHOOK: Output: tblstatsdb2@testtable
 POSTHOOK: query: ANALYZE TABLE testtable COMPUTE STATISTICS FOR COLUMNS key
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: tblstatsdb2@testtable
 #### A masked pattern was here ####
 POSTHOOK: Output: tblstatsdb2@testtable
@@ -175,12 +175,12 @@ POSTHOOK: type: LOAD
 #### A masked pattern was here ####
 POSTHOOK: Output: tblstatsdb2@testtable1
 PREHOOK: query: ANALYZE TABLE TestTable1 COMPUTE STATISTICS FOR COLUMNS key
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: tblstatsdb2@testtable1
 #### A masked pattern was here ####
 PREHOOK: Output: tblstatsdb2@testtable1
 POSTHOOK: query: ANALYZE TABLE TestTable1 COMPUTE STATISTICS FOR COLUMNS key
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: tblstatsdb2@testtable1
 #### A masked pattern was here ####
 POSTHOOK: Output: tblstatsdb2@testtable1
@@ -201,12 +201,12 @@ POSTHOOK: type: LOAD
 #### A masked pattern was here ####
 POSTHOOK: Output: tblstatsdb2@testtable2
 PREHOOK: query: ANALYZE TABLE TESTTABLE2 COMPUTE STATISTICS FOR COLUMNS key
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: tblstatsdb2@testtable2
 #### A masked pattern was here ####
 PREHOOK: Output: tblstatsdb2@testtable2
 POSTHOOK: query: ANALYZE TABLE TESTTABLE2 COMPUTE STATISTICS FOR COLUMNS key
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: tblstatsdb2@testtable2
 #### A masked pattern was here ####
 POSTHOOK: Output: tblstatsdb2@testtable2
diff --git a/ql/src/test/results/clientpositive/encrypted/encryption_move_tbl.q.out b/ql/src/test/results/clientpositive/encrypted/encryption_move_tbl.q.out
index 0f652b5795..096f4915e9 100644
--- a/ql/src/test/results/clientpositive/encrypted/encryption_move_tbl.q.out
+++ b/ql/src/test/results/clientpositive/encrypted/encryption_move_tbl.q.out
@@ -46,12 +46,12 @@ POSTHOOK: type: SHOWTABLES
 POSTHOOK: Input: database:default
 encrypted_table
 PREHOOK: query: ANALYZE TABLE encrypted_table COMPUTE STATISTICS FOR COLUMNS
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@encrypted_table
 PREHOOK: Output: default@encrypted_table
 #### A PARTIAL masked pattern was here #### data/warehouse/encrypted_table/.hive-staging
 POSTHOOK: query: ANALYZE TABLE encrypted_table COMPUTE STATISTICS FOR COLUMNS
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@encrypted_table
 POSTHOOK: Output: default@encrypted_table
 #### A PARTIAL masked pattern was here #### data/warehouse/encrypted_table/.hive-staging
diff --git a/ql/src/test/results/clientpositive/exec_parallel_column_stats.q.out b/ql/src/test/results/clientpositive/exec_parallel_column_stats.q.out
index 90d42fb468..c9ebe27330 100644
--- a/ql/src/test/results/clientpositive/exec_parallel_column_stats.q.out
+++ b/ql/src/test/results/clientpositive/exec_parallel_column_stats.q.out
@@ -11,9 +11,9 @@ POSTHOOK: Output: default@t
 POSTHOOK: Lineage: t.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: t.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: explain analyze table t compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 POSTHOOK: query: explain analyze table t compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-1 depends on stages: Stage-0
@@ -61,12 +61,12 @@ STAGE PLANS:
           Table: default.t
 
 PREHOOK: query: analyze table t compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@t
 PREHOOK: Output: default@t
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table t compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@t
 POSTHOOK: Output: default@t
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/extrapolate_part_stats_date.q.out b/ql/src/test/results/clientpositive/extrapolate_part_stats_date.q.out
index 58f887bff9..c8d994e741 100644
--- a/ql/src/test/results/clientpositive/extrapolate_part_stats_date.q.out
+++ b/ql/src/test/results/clientpositive/extrapolate_part_stats_date.q.out
@@ -34,7 +34,7 @@ POSTHOOK: Input: _dummy_database@_dummy_table
 POSTHOOK: Output: default@date_dim@d_date_sk=2416947
 POSTHOOK: Lineage: date_dim PARTITION(d_date_sk=2416947).d_date SCRIPT []
 PREHOOK: query: analyze table date_dim partition(d_date_sk) compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@date_dim
 PREHOOK: Input: default@date_dim@d_date_sk=2416945
 PREHOOK: Input: default@date_dim@d_date_sk=2416946
@@ -45,7 +45,7 @@ PREHOOK: Output: default@date_dim@d_date_sk=2416946
 PREHOOK: Output: default@date_dim@d_date_sk=2416947
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table date_dim partition(d_date_sk) compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@date_dim
 POSTHOOK: Input: default@date_dim@d_date_sk=2416945
 POSTHOOK: Input: default@date_dim@d_date_sk=2416946
diff --git a/ql/src/test/results/clientpositive/extrapolate_part_stats_full.q.out b/ql/src/test/results/clientpositive/extrapolate_part_stats_full.q.out
index 67506bf0c4..bec6dd4a0e 100644
--- a/ql/src/test/results/clientpositive/extrapolate_part_stats_full.q.out
+++ b/ql/src/test/results/clientpositive/extrapolate_part_stats_full.q.out
@@ -56,28 +56,28 @@ POSTHOOK: Lineage: loc_orc_1d PARTITION(year=2001).locid SIMPLE [(ext_loc)ext_lo
 POSTHOOK: Lineage: loc_orc_1d PARTITION(year=2001).state SIMPLE [(ext_loc)ext_loc.FieldSchema(name:state, type:string, comment:null), ]
 POSTHOOK: Lineage: loc_orc_1d PARTITION(year=2001).zip SIMPLE [(ext_loc)ext_loc.FieldSchema(name:zip, type:int, comment:null), ]
 PREHOOK: query: analyze table loc_orc_1d partition(year='2000') compute statistics for columns state,locid
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@loc_orc_1d
 PREHOOK: Input: default@loc_orc_1d@year=2000
 PREHOOK: Output: default@loc_orc_1d
 PREHOOK: Output: default@loc_orc_1d@year=2000
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table loc_orc_1d partition(year='2000') compute statistics for columns state,locid
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@loc_orc_1d
 POSTHOOK: Input: default@loc_orc_1d@year=2000
 POSTHOOK: Output: default@loc_orc_1d
 POSTHOOK: Output: default@loc_orc_1d@year=2000
 #### A masked pattern was here ####
 PREHOOK: query: analyze table loc_orc_1d partition(year='2001') compute statistics for columns state,locid
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@loc_orc_1d
 PREHOOK: Input: default@loc_orc_1d@year=2001
 PREHOOK: Output: default@loc_orc_1d
 PREHOOK: Output: default@loc_orc_1d@year=2001
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table loc_orc_1d partition(year='2001') compute statistics for columns state,locid
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@loc_orc_1d
 POSTHOOK: Input: default@loc_orc_1d@year=2001
 POSTHOOK: Output: default@loc_orc_1d
@@ -365,56 +365,56 @@ POSTHOOK: Lineage: loc_orc_2d PARTITION(zip=94087,year=2000).state SIMPLE [(ext_
 POSTHOOK: Lineage: loc_orc_2d PARTITION(zip=94087,year=2001).locid SIMPLE [(ext_loc)ext_loc.FieldSchema(name:locid, type:int, comment:null), ]
 POSTHOOK: Lineage: loc_orc_2d PARTITION(zip=94087,year=2001).state SIMPLE [(ext_loc)ext_loc.FieldSchema(name:state, type:string, comment:null), ]
 PREHOOK: query: analyze table loc_orc_2d partition(zip=94086, year='2000') compute statistics for columns state,locid
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@loc_orc_2d
 PREHOOK: Input: default@loc_orc_2d@zip=94086/year=2000
 PREHOOK: Output: default@loc_orc_2d
 PREHOOK: Output: default@loc_orc_2d@zip=94086/year=2000
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table loc_orc_2d partition(zip=94086, year='2000') compute statistics for columns state,locid
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@loc_orc_2d
 POSTHOOK: Input: default@loc_orc_2d@zip=94086/year=2000
 POSTHOOK: Output: default@loc_orc_2d
 POSTHOOK: Output: default@loc_orc_2d@zip=94086/year=2000
 #### A masked pattern was here ####
 PREHOOK: query: analyze table loc_orc_2d partition(zip=94087, year='2000') compute statistics for columns state,locid
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@loc_orc_2d
 PREHOOK: Input: default@loc_orc_2d@zip=94087/year=2000
 PREHOOK: Output: default@loc_orc_2d
 PREHOOK: Output: default@loc_orc_2d@zip=94087/year=2000
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table loc_orc_2d partition(zip=94087, year='2000') compute statistics for columns state,locid
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@loc_orc_2d
 POSTHOOK: Input: default@loc_orc_2d@zip=94087/year=2000
 POSTHOOK: Output: default@loc_orc_2d
 POSTHOOK: Output: default@loc_orc_2d@zip=94087/year=2000
 #### A masked pattern was here ####
 PREHOOK: query: analyze table loc_orc_2d partition(zip=94086, year='2001') compute statistics for columns state,locid
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@loc_orc_2d
 PREHOOK: Input: default@loc_orc_2d@zip=94086/year=2001
 PREHOOK: Output: default@loc_orc_2d
 PREHOOK: Output: default@loc_orc_2d@zip=94086/year=2001
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table loc_orc_2d partition(zip=94086, year='2001') compute statistics for columns state,locid
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@loc_orc_2d
 POSTHOOK: Input: default@loc_orc_2d@zip=94086/year=2001
 POSTHOOK: Output: default@loc_orc_2d
 POSTHOOK: Output: default@loc_orc_2d@zip=94086/year=2001
 #### A masked pattern was here ####
 PREHOOK: query: analyze table loc_orc_2d partition(zip=94087, year='2001') compute statistics for columns state,locid
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@loc_orc_2d
 PREHOOK: Input: default@loc_orc_2d@zip=94087/year=2001
 PREHOOK: Output: default@loc_orc_2d
 PREHOOK: Output: default@loc_orc_2d@zip=94087/year=2001
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table loc_orc_2d partition(zip=94087, year='2001') compute statistics for columns state,locid
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@loc_orc_2d
 POSTHOOK: Input: default@loc_orc_2d@zip=94087/year=2001
 POSTHOOK: Output: default@loc_orc_2d
diff --git a/ql/src/test/results/clientpositive/extrapolate_part_stats_partial.q.out b/ql/src/test/results/clientpositive/extrapolate_part_stats_partial.q.out
index d77286c734..d6e1a7ed24 100644
--- a/ql/src/test/results/clientpositive/extrapolate_part_stats_partial.q.out
+++ b/ql/src/test/results/clientpositive/extrapolate_part_stats_partial.q.out
@@ -64,28 +64,28 @@ POSTHOOK: Lineage: loc_orc_1d PARTITION(year=2003).locid SIMPLE [(ext_loc)ext_lo
 POSTHOOK: Lineage: loc_orc_1d PARTITION(year=2003).state SIMPLE [(ext_loc)ext_loc.FieldSchema(name:state, type:string, comment:null), ]
 POSTHOOK: Lineage: loc_orc_1d PARTITION(year=2003).zip SIMPLE [(ext_loc)ext_loc.FieldSchema(name:zip, type:int, comment:null), ]
 PREHOOK: query: analyze table loc_orc_1d partition(year='2001') compute statistics for columns state,locid
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@loc_orc_1d
 PREHOOK: Input: default@loc_orc_1d@year=2001
 PREHOOK: Output: default@loc_orc_1d
 PREHOOK: Output: default@loc_orc_1d@year=2001
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table loc_orc_1d partition(year='2001') compute statistics for columns state,locid
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@loc_orc_1d
 POSTHOOK: Input: default@loc_orc_1d@year=2001
 POSTHOOK: Output: default@loc_orc_1d
 POSTHOOK: Output: default@loc_orc_1d@year=2001
 #### A masked pattern was here ####
 PREHOOK: query: analyze table loc_orc_1d partition(year='2002') compute statistics for columns state,locid
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@loc_orc_1d
 PREHOOK: Input: default@loc_orc_1d@year=2002
 PREHOOK: Output: default@loc_orc_1d
 PREHOOK: Output: default@loc_orc_1d@year=2002
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table loc_orc_1d partition(year='2002') compute statistics for columns state,locid
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@loc_orc_1d
 POSTHOOK: Input: default@loc_orc_1d@year=2002
 POSTHOOK: Output: default@loc_orc_1d
@@ -542,28 +542,28 @@ STAGE PLANS:
             ListSink
 
 PREHOOK: query: analyze table loc_orc_1d partition(year='2000') compute statistics for columns state
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@loc_orc_1d
 PREHOOK: Input: default@loc_orc_1d@year=2000
 PREHOOK: Output: default@loc_orc_1d
 PREHOOK: Output: default@loc_orc_1d@year=2000
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table loc_orc_1d partition(year='2000') compute statistics for columns state
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@loc_orc_1d
 POSTHOOK: Input: default@loc_orc_1d@year=2000
 POSTHOOK: Output: default@loc_orc_1d
 POSTHOOK: Output: default@loc_orc_1d@year=2000
 #### A masked pattern was here ####
 PREHOOK: query: analyze table loc_orc_1d partition(year='2003') compute statistics for columns state
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@loc_orc_1d
 PREHOOK: Input: default@loc_orc_1d@year=2003
 PREHOOK: Output: default@loc_orc_1d
 PREHOOK: Output: default@loc_orc_1d@year=2003
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table loc_orc_1d partition(year='2003') compute statistics for columns state
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@loc_orc_1d
 POSTHOOK: Input: default@loc_orc_1d@year=2003
 POSTHOOK: Output: default@loc_orc_1d
@@ -1038,28 +1038,28 @@ POSTHOOK: Lineage: loc_orc_2d PARTITION(zip=94087,year=2002).state SIMPLE [(ext_
 POSTHOOK: Lineage: loc_orc_2d PARTITION(zip=94087,year=2003).locid SIMPLE [(ext_loc)ext_loc.FieldSchema(name:locid, type:int, comment:null), ]
 POSTHOOK: Lineage: loc_orc_2d PARTITION(zip=94087,year=2003).state SIMPLE [(ext_loc)ext_loc.FieldSchema(name:state, type:string, comment:null), ]
 PREHOOK: query: analyze table loc_orc_2d partition(zip=94086, year='2001') compute statistics for columns state,locid
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@loc_orc_2d
 PREHOOK: Input: default@loc_orc_2d@zip=94086/year=2001
 PREHOOK: Output: default@loc_orc_2d
 PREHOOK: Output: default@loc_orc_2d@zip=94086/year=2001
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table loc_orc_2d partition(zip=94086, year='2001') compute statistics for columns state,locid
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@loc_orc_2d
 POSTHOOK: Input: default@loc_orc_2d@zip=94086/year=2001
 POSTHOOK: Output: default@loc_orc_2d
 POSTHOOK: Output: default@loc_orc_2d@zip=94086/year=2001
 #### A masked pattern was here ####
 PREHOOK: query: analyze table loc_orc_2d partition(zip=94087, year='2002') compute statistics for columns state,locid
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@loc_orc_2d
 PREHOOK: Input: default@loc_orc_2d@zip=94087/year=2002
 PREHOOK: Output: default@loc_orc_2d
 PREHOOK: Output: default@loc_orc_2d@zip=94087/year=2002
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table loc_orc_2d partition(zip=94087, year='2002') compute statistics for columns state,locid
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@loc_orc_2d
 POSTHOOK: Input: default@loc_orc_2d@zip=94087/year=2002
 POSTHOOK: Output: default@loc_orc_2d
diff --git a/ql/src/test/results/clientpositive/fm-sketch.q.out b/ql/src/test/results/clientpositive/fm-sketch.q.out
index a67fb07ae3..2ef59c41d6 100644
--- a/ql/src/test/results/clientpositive/fm-sketch.q.out
+++ b/ql/src/test/results/clientpositive/fm-sketch.q.out
@@ -16,9 +16,9 @@ POSTHOOK: Input: default@src
 POSTHOOK: Output: default@n
 POSTHOOK: Lineage: n.key EXPRESSION []
 PREHOOK: query: explain analyze table n compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 POSTHOOK: query: explain analyze table n compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-1 depends on stages: Stage-0
@@ -66,12 +66,12 @@ STAGE PLANS:
           Table: default.n
 
 PREHOOK: query: analyze table n compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@n
 PREHOOK: Output: default@n
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table n compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@n
 POSTHOOK: Output: default@n
 #### A masked pattern was here ####
@@ -112,9 +112,9 @@ POSTHOOK: Input: default@src
 POSTHOOK: Output: default@i
 POSTHOOK: Lineage: i.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: explain analyze table i compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 POSTHOOK: query: explain analyze table i compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-1 depends on stages: Stage-0
@@ -162,12 +162,12 @@ STAGE PLANS:
           Table: default.i
 
 PREHOOK: query: analyze table i compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@i
 PREHOOK: Output: default@i
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table i compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@i
 POSTHOOK: Output: default@i
 #### A masked pattern was here ####
@@ -216,12 +216,12 @@ POSTHOOK: Input: default@src
 POSTHOOK: Output: default@i
 POSTHOOK: Lineage: i.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: analyze table i compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@i
 PREHOOK: Output: default@i
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table i compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@i
 POSTHOOK: Output: default@i
 #### A masked pattern was here ####
@@ -270,12 +270,12 @@ POSTHOOK: Input: default@src
 POSTHOOK: Output: default@i
 POSTHOOK: Lineage: i.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: analyze table i compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@i
 PREHOOK: Output: default@i
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table i compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@i
 POSTHOOK: Output: default@i
 #### A masked pattern was here ####
@@ -360,12 +360,12 @@ POSTHOOK: Input: _dummy_database@_dummy_table
 POSTHOOK: Output: default@i
 POSTHOOK: Lineage: i.key SCRIPT []
 PREHOOK: query: analyze table i compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@i
 PREHOOK: Output: default@i
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table i compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@i
 POSTHOOK: Output: default@i
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/groupby_sort_1_23.q.out b/ql/src/test/results/clientpositive/groupby_sort_1_23.q.out
index 11ef8b1afb..c82aad621b 100644
--- a/ql/src/test/results/clientpositive/groupby_sort_1_23.q.out
+++ b/ql/src/test/results/clientpositive/groupby_sort_1_23.q.out
@@ -4936,7 +4936,7 @@ STAGE PLANS:
               COLUMN_STATS_ACCURATE {"BASIC_STATS":"true","COLUMN_STATS":{"key":"true","val":"true"}}
               SORTBUCKETCOLSPREFIX TRUE
               bucket_count 2
-              bucket_field_name key
+              bucket_field_name key,val
               bucketing_version 2
               column.name.delimiter ,
               columns key,val
@@ -4960,7 +4960,7 @@ STAGE PLANS:
                 COLUMN_STATS_ACCURATE {"BASIC_STATS":"true","COLUMN_STATS":{"key":"true","val":"true"}}
                 SORTBUCKETCOLSPREFIX TRUE
                 bucket_count 2
-                bucket_field_name key
+                bucket_field_name key,val
                 bucketing_version 2
                 column.name.delimiter ,
                 columns key,val
@@ -5289,7 +5289,7 @@ STAGE PLANS:
               COLUMN_STATS_ACCURATE {"BASIC_STATS":"true","COLUMN_STATS":{"key":"true","val":"true"}}
               SORTBUCKETCOLSPREFIX TRUE
               bucket_count 2
-              bucket_field_name key
+              bucket_field_name key,val
               bucketing_version 2
               column.name.delimiter ,
               columns key,val
@@ -5313,7 +5313,7 @@ STAGE PLANS:
                 COLUMN_STATS_ACCURATE {"BASIC_STATS":"true","COLUMN_STATS":{"key":"true","val":"true"}}
                 SORTBUCKETCOLSPREFIX TRUE
                 bucket_count 2
-                bucket_field_name key
+                bucket_field_name key,val
                 bucketing_version 2
                 column.name.delimiter ,
                 columns key,val
@@ -5735,7 +5735,7 @@ STAGE PLANS:
               COLUMN_STATS_ACCURATE {"BASIC_STATS":"true","COLUMN_STATS":{"key":"true","val":"true"}}
               SORTBUCKETCOLSPREFIX TRUE
               bucket_count 2
-              bucket_field_name key
+              bucket_field_name key,val
               bucketing_version 2
               column.name.delimiter ,
               columns key,val
@@ -5759,7 +5759,7 @@ STAGE PLANS:
                 COLUMN_STATS_ACCURATE {"BASIC_STATS":"true","COLUMN_STATS":{"key":"true","val":"true"}}
                 SORTBUCKETCOLSPREFIX TRUE
                 bucket_count 2
-                bucket_field_name key
+                bucket_field_name key,val
                 bucketing_version 2
                 column.name.delimiter ,
                 columns key,val
@@ -6180,7 +6180,7 @@ STAGE PLANS:
               COLUMN_STATS_ACCURATE {"BASIC_STATS":"true","COLUMN_STATS":{"key":"true","val":"true"}}
               SORTBUCKETCOLSPREFIX TRUE
               bucket_count 2
-              bucket_field_name key
+              bucket_field_name key,val
               bucketing_version 2
               column.name.delimiter ,
               columns key,val
@@ -6204,7 +6204,7 @@ STAGE PLANS:
                 COLUMN_STATS_ACCURATE {"BASIC_STATS":"true","COLUMN_STATS":{"key":"true","val":"true"}}
                 SORTBUCKETCOLSPREFIX TRUE
                 bucket_count 2
-                bucket_field_name key
+                bucket_field_name key,val
                 bucketing_version 2
                 column.name.delimiter ,
                 columns key,val
@@ -6632,7 +6632,7 @@ STAGE PLANS:
               COLUMN_STATS_ACCURATE {"BASIC_STATS":"true","COLUMN_STATS":{"key":"true","val":"true"}}
               SORTBUCKETCOLSPREFIX TRUE
               bucket_count 2
-              bucket_field_name key
+              bucket_field_name key,val
               bucketing_version 2
               column.name.delimiter ,
               columns key,val
@@ -6656,7 +6656,7 @@ STAGE PLANS:
                 COLUMN_STATS_ACCURATE {"BASIC_STATS":"true","COLUMN_STATS":{"key":"true","val":"true"}}
                 SORTBUCKETCOLSPREFIX TRUE
                 bucket_count 2
-                bucket_field_name key
+                bucket_field_name key,val
                 bucketing_version 2
                 column.name.delimiter ,
                 columns key,val
diff --git a/ql/src/test/results/clientpositive/groupby_sort_skew_1_23.q.out b/ql/src/test/results/clientpositive/groupby_sort_skew_1_23.q.out
index 5a00d105e6..79228cf1ad 100644
--- a/ql/src/test/results/clientpositive/groupby_sort_skew_1_23.q.out
+++ b/ql/src/test/results/clientpositive/groupby_sort_skew_1_23.q.out
@@ -5357,7 +5357,7 @@ STAGE PLANS:
               COLUMN_STATS_ACCURATE {"BASIC_STATS":"true","COLUMN_STATS":{"key":"true","val":"true"}}
               SORTBUCKETCOLSPREFIX TRUE
               bucket_count 2
-              bucket_field_name key
+              bucket_field_name key,val
               bucketing_version 2
               column.name.delimiter ,
               columns key,val
@@ -5381,7 +5381,7 @@ STAGE PLANS:
                 COLUMN_STATS_ACCURATE {"BASIC_STATS":"true","COLUMN_STATS":{"key":"true","val":"true"}}
                 SORTBUCKETCOLSPREFIX TRUE
                 bucket_count 2
-                bucket_field_name key
+                bucket_field_name key,val
                 bucketing_version 2
                 column.name.delimiter ,
                 columns key,val
@@ -5779,7 +5779,7 @@ STAGE PLANS:
               COLUMN_STATS_ACCURATE {"BASIC_STATS":"true","COLUMN_STATS":{"key":"true","val":"true"}}
               SORTBUCKETCOLSPREFIX TRUE
               bucket_count 2
-              bucket_field_name key
+              bucket_field_name key,val
               bucketing_version 2
               column.name.delimiter ,
               columns key,val
@@ -5803,7 +5803,7 @@ STAGE PLANS:
                 COLUMN_STATS_ACCURATE {"BASIC_STATS":"true","COLUMN_STATS":{"key":"true","val":"true"}}
                 SORTBUCKETCOLSPREFIX TRUE
                 bucket_count 2
-                bucket_field_name key
+                bucket_field_name key,val
                 bucketing_version 2
                 column.name.delimiter ,
                 columns key,val
@@ -6225,7 +6225,7 @@ STAGE PLANS:
               COLUMN_STATS_ACCURATE {"BASIC_STATS":"true","COLUMN_STATS":{"key":"true","val":"true"}}
               SORTBUCKETCOLSPREFIX TRUE
               bucket_count 2
-              bucket_field_name key
+              bucket_field_name key,val
               bucketing_version 2
               column.name.delimiter ,
               columns key,val
@@ -6249,7 +6249,7 @@ STAGE PLANS:
                 COLUMN_STATS_ACCURATE {"BASIC_STATS":"true","COLUMN_STATS":{"key":"true","val":"true"}}
                 SORTBUCKETCOLSPREFIX TRUE
                 bucket_count 2
-                bucket_field_name key
+                bucket_field_name key,val
                 bucketing_version 2
                 column.name.delimiter ,
                 columns key,val
@@ -6670,7 +6670,7 @@ STAGE PLANS:
               COLUMN_STATS_ACCURATE {"BASIC_STATS":"true","COLUMN_STATS":{"key":"true","val":"true"}}
               SORTBUCKETCOLSPREFIX TRUE
               bucket_count 2
-              bucket_field_name key
+              bucket_field_name key,val
               bucketing_version 2
               column.name.delimiter ,
               columns key,val
@@ -6694,7 +6694,7 @@ STAGE PLANS:
                 COLUMN_STATS_ACCURATE {"BASIC_STATS":"true","COLUMN_STATS":{"key":"true","val":"true"}}
                 SORTBUCKETCOLSPREFIX TRUE
                 bucket_count 2
-                bucket_field_name key
+                bucket_field_name key,val
                 bucketing_version 2
                 column.name.delimiter ,
                 columns key,val
@@ -7122,7 +7122,7 @@ STAGE PLANS:
               COLUMN_STATS_ACCURATE {"BASIC_STATS":"true","COLUMN_STATS":{"key":"true","val":"true"}}
               SORTBUCKETCOLSPREFIX TRUE
               bucket_count 2
-              bucket_field_name key
+              bucket_field_name key,val
               bucketing_version 2
               column.name.delimiter ,
               columns key,val
@@ -7146,7 +7146,7 @@ STAGE PLANS:
                 COLUMN_STATS_ACCURATE {"BASIC_STATS":"true","COLUMN_STATS":{"key":"true","val":"true"}}
                 SORTBUCKETCOLSPREFIX TRUE
                 bucket_count 2
-                bucket_field_name key
+                bucket_field_name key,val
                 bucketing_version 2
                 column.name.delimiter ,
                 columns key,val
diff --git a/ql/src/test/results/clientpositive/hll.q.out b/ql/src/test/results/clientpositive/hll.q.out
index d0be4c438a..12f6a36417 100644
--- a/ql/src/test/results/clientpositive/hll.q.out
+++ b/ql/src/test/results/clientpositive/hll.q.out
@@ -16,9 +16,9 @@ POSTHOOK: Input: default@src
 POSTHOOK: Output: default@n
 POSTHOOK: Lineage: n.key EXPRESSION []
 PREHOOK: query: explain analyze table n compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 POSTHOOK: query: explain analyze table n compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-1 depends on stages: Stage-0
@@ -66,12 +66,12 @@ STAGE PLANS:
           Table: default.n
 
 PREHOOK: query: analyze table n compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@n
 PREHOOK: Output: default@n
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table n compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@n
 POSTHOOK: Output: default@n
 #### A masked pattern was here ####
@@ -112,9 +112,9 @@ POSTHOOK: Input: default@src
 POSTHOOK: Output: default@i
 POSTHOOK: Lineage: i.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: explain analyze table i compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 POSTHOOK: query: explain analyze table i compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-1 depends on stages: Stage-0
@@ -162,12 +162,12 @@ STAGE PLANS:
           Table: default.i
 
 PREHOOK: query: analyze table i compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@i
 PREHOOK: Output: default@i
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table i compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@i
 POSTHOOK: Output: default@i
 #### A masked pattern was here ####
@@ -216,12 +216,12 @@ POSTHOOK: Input: default@src
 POSTHOOK: Output: default@i
 POSTHOOK: Lineage: i.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: analyze table i compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@i
 PREHOOK: Output: default@i
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table i compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@i
 POSTHOOK: Output: default@i
 #### A masked pattern was here ####
@@ -270,12 +270,12 @@ POSTHOOK: Input: default@src
 POSTHOOK: Output: default@i
 POSTHOOK: Lineage: i.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: analyze table i compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@i
 PREHOOK: Output: default@i
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table i compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@i
 POSTHOOK: Output: default@i
 #### A masked pattern was here ####
@@ -360,12 +360,12 @@ POSTHOOK: Input: _dummy_database@_dummy_table
 POSTHOOK: Output: default@i
 POSTHOOK: Lineage: i.key SCRIPT []
 PREHOOK: query: analyze table i compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@i
 PREHOOK: Output: default@i
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table i compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@i
 POSTHOOK: Output: default@i
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/llap/acid_no_buckets.q.out b/ql/src/test/results/clientpositive/llap/acid_no_buckets.q.out
index 89b716956c..f03e64b8bb 100644
--- a/ql/src/test/results/clientpositive/llap/acid_no_buckets.q.out
+++ b/ql/src/test/results/clientpositive/llap/acid_no_buckets.q.out
@@ -72,7 +72,7 @@ POSTHOOK: Output: default@srcpart_acid@ds=2008-04-08/hr=12
 POSTHOOK: Output: default@srcpart_acid@ds=2008-04-09/hr=11
 POSTHOOK: Output: default@srcpart_acid@ds=2008-04-09/hr=12
 PREHOOK: query: analyze table srcpart_acid PARTITION(ds, hr) compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@srcpart_acid
 PREHOOK: Input: default@srcpart_acid@ds=2008-04-08/hr=11
 PREHOOK: Input: default@srcpart_acid@ds=2008-04-08/hr=12
@@ -85,7 +85,7 @@ PREHOOK: Output: default@srcpart_acid@ds=2008-04-09/hr=11
 PREHOOK: Output: default@srcpart_acid@ds=2008-04-09/hr=12
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table srcpart_acid PARTITION(ds, hr) compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@srcpart_acid
 POSTHOOK: Input: default@srcpart_acid@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart_acid@ds=2008-04-08/hr=12
@@ -254,7 +254,7 @@ POSTHOOK: Output: default@srcpart_acid@ds=2008-04-08/hr=12
 POSTHOOK: Output: default@srcpart_acid@ds=2008-04-09/hr=11
 POSTHOOK: Output: default@srcpart_acid@ds=2008-04-09/hr=12
 PREHOOK: query: analyze table srcpart_acid PARTITION(ds, hr) compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@srcpart_acid
 PREHOOK: Input: default@srcpart_acid@ds=2008-04-08/hr=11
 PREHOOK: Input: default@srcpart_acid@ds=2008-04-08/hr=12
@@ -267,7 +267,7 @@ PREHOOK: Output: default@srcpart_acid@ds=2008-04-09/hr=11
 PREHOOK: Output: default@srcpart_acid@ds=2008-04-09/hr=12
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table srcpart_acid PARTITION(ds, hr) compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@srcpart_acid
 POSTHOOK: Input: default@srcpart_acid@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart_acid@ds=2008-04-08/hr=12
@@ -571,7 +571,7 @@ POSTHOOK: Output: default@srcpart_acidb@ds=2008-04-08/hr=12
 POSTHOOK: Output: default@srcpart_acidb@ds=2008-04-09/hr=11
 POSTHOOK: Output: default@srcpart_acidb@ds=2008-04-09/hr=12
 PREHOOK: query: analyze table srcpart_acidb PARTITION(ds, hr) compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@srcpart_acidb
 PREHOOK: Input: default@srcpart_acidb@ds=2008-04-08/hr=11
 PREHOOK: Input: default@srcpart_acidb@ds=2008-04-08/hr=12
@@ -584,7 +584,7 @@ PREHOOK: Output: default@srcpart_acidb@ds=2008-04-09/hr=11
 PREHOOK: Output: default@srcpart_acidb@ds=2008-04-09/hr=12
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table srcpart_acidb PARTITION(ds, hr) compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@srcpart_acidb
 POSTHOOK: Input: default@srcpart_acidb@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart_acidb@ds=2008-04-08/hr=12
@@ -754,7 +754,7 @@ POSTHOOK: Output: default@srcpart_acidb@ds=2008-04-08/hr=12
 POSTHOOK: Output: default@srcpart_acidb@ds=2008-04-09/hr=11
 POSTHOOK: Output: default@srcpart_acidb@ds=2008-04-09/hr=12
 PREHOOK: query: analyze table srcpart_acidb PARTITION(ds, hr) compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@srcpart_acidb
 PREHOOK: Input: default@srcpart_acidb@ds=2008-04-08/hr=11
 PREHOOK: Input: default@srcpart_acidb@ds=2008-04-08/hr=12
@@ -767,7 +767,7 @@ PREHOOK: Output: default@srcpart_acidb@ds=2008-04-09/hr=11
 PREHOOK: Output: default@srcpart_acidb@ds=2008-04-09/hr=12
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table srcpart_acidb PARTITION(ds, hr) compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@srcpart_acidb
 POSTHOOK: Input: default@srcpart_acidb@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart_acidb@ds=2008-04-08/hr=12
@@ -1072,7 +1072,7 @@ POSTHOOK: Output: default@srcpart_acidv@ds=2008-04-08/hr=12
 POSTHOOK: Output: default@srcpart_acidv@ds=2008-04-09/hr=11
 POSTHOOK: Output: default@srcpart_acidv@ds=2008-04-09/hr=12
 PREHOOK: query: analyze table srcpart_acidv PARTITION(ds, hr) compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@srcpart_acidv
 PREHOOK: Input: default@srcpart_acidv@ds=2008-04-08/hr=11
 PREHOOK: Input: default@srcpart_acidv@ds=2008-04-08/hr=12
@@ -1085,7 +1085,7 @@ PREHOOK: Output: default@srcpart_acidv@ds=2008-04-09/hr=11
 PREHOOK: Output: default@srcpart_acidv@ds=2008-04-09/hr=12
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table srcpart_acidv PARTITION(ds, hr) compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@srcpart_acidv
 POSTHOOK: Input: default@srcpart_acidv@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart_acidv@ds=2008-04-08/hr=12
@@ -1271,7 +1271,7 @@ POSTHOOK: Output: default@srcpart_acidv@ds=2008-04-08/hr=12
 POSTHOOK: Output: default@srcpart_acidv@ds=2008-04-09/hr=11
 POSTHOOK: Output: default@srcpart_acidv@ds=2008-04-09/hr=12
 PREHOOK: query: analyze table srcpart_acidv PARTITION(ds, hr) compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@srcpart_acidv
 PREHOOK: Input: default@srcpart_acidv@ds=2008-04-08/hr=11
 PREHOOK: Input: default@srcpart_acidv@ds=2008-04-08/hr=12
@@ -1284,7 +1284,7 @@ PREHOOK: Output: default@srcpart_acidv@ds=2008-04-09/hr=11
 PREHOOK: Output: default@srcpart_acidv@ds=2008-04-09/hr=12
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table srcpart_acidv PARTITION(ds, hr) compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@srcpart_acidv
 POSTHOOK: Input: default@srcpart_acidv@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart_acidv@ds=2008-04-08/hr=12
@@ -1856,7 +1856,7 @@ POSTHOOK: Output: default@srcpart_acidvb@ds=2008-04-08/hr=12
 POSTHOOK: Output: default@srcpart_acidvb@ds=2008-04-09/hr=11
 POSTHOOK: Output: default@srcpart_acidvb@ds=2008-04-09/hr=12
 PREHOOK: query: analyze table srcpart_acidvb PARTITION(ds, hr) compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@srcpart_acidvb
 PREHOOK: Input: default@srcpart_acidvb@ds=2008-04-08/hr=11
 PREHOOK: Input: default@srcpart_acidvb@ds=2008-04-08/hr=12
@@ -1869,7 +1869,7 @@ PREHOOK: Output: default@srcpart_acidvb@ds=2008-04-09/hr=11
 PREHOOK: Output: default@srcpart_acidvb@ds=2008-04-09/hr=12
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table srcpart_acidvb PARTITION(ds, hr) compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@srcpart_acidvb
 POSTHOOK: Input: default@srcpart_acidvb@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart_acidvb@ds=2008-04-08/hr=12
@@ -2056,7 +2056,7 @@ POSTHOOK: Output: default@srcpart_acidvb@ds=2008-04-08/hr=12
 POSTHOOK: Output: default@srcpart_acidvb@ds=2008-04-09/hr=11
 POSTHOOK: Output: default@srcpart_acidvb@ds=2008-04-09/hr=12
 PREHOOK: query: analyze table srcpart_acidvb PARTITION(ds, hr) compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@srcpart_acidvb
 PREHOOK: Input: default@srcpart_acidvb@ds=2008-04-08/hr=11
 PREHOOK: Input: default@srcpart_acidvb@ds=2008-04-08/hr=12
@@ -2069,7 +2069,7 @@ PREHOOK: Output: default@srcpart_acidvb@ds=2008-04-09/hr=11
 PREHOOK: Output: default@srcpart_acidvb@ds=2008-04-09/hr=12
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table srcpart_acidvb PARTITION(ds, hr) compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@srcpart_acidvb
 POSTHOOK: Input: default@srcpart_acidvb@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart_acidvb@ds=2008-04-08/hr=12
diff --git a/ql/src/test/results/clientpositive/llap/bucket_map_join_tez1.q.out b/ql/src/test/results/clientpositive/llap/bucket_map_join_tez1.q.out
index 3338ec29ae..116e00be01 100644
--- a/ql/src/test/results/clientpositive/llap/bucket_map_join_tez1.q.out
+++ b/ql/src/test/results/clientpositive/llap/bucket_map_join_tez1.q.out
@@ -109,56 +109,56 @@ POSTHOOK: Output: default@tab@ds=2008-04-08
 POSTHOOK: Lineage: tab PARTITION(ds=2008-04-08).key SIMPLE [(srcbucket_mapjoin)srcbucket_mapjoin.FieldSchema(name:key, type:int, comment:null), ]
 POSTHOOK: Lineage: tab PARTITION(ds=2008-04-08).value SIMPLE [(srcbucket_mapjoin)srcbucket_mapjoin.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: analyze table srcbucket_mapjoin compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@srcbucket_mapjoin
 PREHOOK: Input: default@srcbucket_mapjoin@ds=2008-04-08
 PREHOOK: Output: default@srcbucket_mapjoin
 PREHOOK: Output: default@srcbucket_mapjoin@ds=2008-04-08
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table srcbucket_mapjoin compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@srcbucket_mapjoin
 POSTHOOK: Input: default@srcbucket_mapjoin@ds=2008-04-08
 POSTHOOK: Output: default@srcbucket_mapjoin
 POSTHOOK: Output: default@srcbucket_mapjoin@ds=2008-04-08
 #### A masked pattern was here ####
 PREHOOK: query: analyze table srcbucket_mapjoin_part compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@srcbucket_mapjoin_part
 PREHOOK: Input: default@srcbucket_mapjoin_part@ds=2008-04-08
 PREHOOK: Output: default@srcbucket_mapjoin_part
 PREHOOK: Output: default@srcbucket_mapjoin_part@ds=2008-04-08
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table srcbucket_mapjoin_part compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@srcbucket_mapjoin_part
 POSTHOOK: Input: default@srcbucket_mapjoin_part@ds=2008-04-08
 POSTHOOK: Output: default@srcbucket_mapjoin_part
 POSTHOOK: Output: default@srcbucket_mapjoin_part@ds=2008-04-08
 #### A masked pattern was here ####
 PREHOOK: query: analyze table tab compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@tab
 PREHOOK: Input: default@tab@ds=2008-04-08
 PREHOOK: Output: default@tab
 PREHOOK: Output: default@tab@ds=2008-04-08
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table tab compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@tab
 POSTHOOK: Input: default@tab@ds=2008-04-08
 POSTHOOK: Output: default@tab
 POSTHOOK: Output: default@tab@ds=2008-04-08
 #### A masked pattern was here ####
 PREHOOK: query: analyze table tab_part compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@tab_part
 PREHOOK: Input: default@tab_part@ds=2008-04-08
 PREHOOK: Output: default@tab_part
 PREHOOK: Output: default@tab_part@ds=2008-04-08
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table tab_part compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@tab_part
 POSTHOOK: Input: default@tab_part@ds=2008-04-08
 POSTHOOK: Output: default@tab_part
@@ -235,25 +235,25 @@ STAGE PLANS:
                   0 _col0 (type: int)
                   1 _col0 (type: int)
                 outputColumnNames: _col0, _col1, _col3
-                Statistics: Num rows: 391 Data size: 72726 Basic stats: COMPLETE Column stats: COMPLETE
+                Statistics: Num rows: 400 Data size: 74400 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
                   expressions: _col0 (type: int), _col1 (type: string), _col3 (type: string)
                   outputColumnNames: _col0, _col1, _col2
-                  Statistics: Num rows: 391 Data size: 72726 Basic stats: COMPLETE Column stats: COMPLETE
+                  Statistics: Num rows: 400 Data size: 74400 Basic stats: COMPLETE Column stats: COMPLETE
                   Reduce Output Operator
                     key expressions: _col0 (type: int), _col1 (type: string), _col2 (type: string)
                     sort order: +++
-                    Statistics: Num rows: 391 Data size: 72726 Basic stats: COMPLETE Column stats: COMPLETE
+                    Statistics: Num rows: 400 Data size: 74400 Basic stats: COMPLETE Column stats: COMPLETE
         Reducer 3 
             Execution mode: vectorized, llap
             Reduce Operator Tree:
               Select Operator
                 expressions: KEY.reducesinkkey0 (type: int), KEY.reducesinkkey1 (type: string), KEY.reducesinkkey2 (type: string)
                 outputColumnNames: _col0, _col1, _col2
-                Statistics: Num rows: 391 Data size: 72726 Basic stats: COMPLETE Column stats: COMPLETE
+                Statistics: Num rows: 400 Data size: 74400 Basic stats: COMPLETE Column stats: COMPLETE
                 File Output Operator
                   compressed: false
-                  Statistics: Num rows: 391 Data size: 72726 Basic stats: COMPLETE Column stats: COMPLETE
+                  Statistics: Num rows: 400 Data size: 74400 Basic stats: COMPLETE Column stats: COMPLETE
                   table:
                       input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                       output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
@@ -823,15 +823,15 @@ STAGE PLANS:
                         outputColumnNames: _col0, _col1, _col3
                         input vertices:
                           0 Map 1
-                        Statistics: Num rows: 391 Data size: 72726 Basic stats: COMPLETE Column stats: COMPLETE
+                        Statistics: Num rows: 400 Data size: 74400 Basic stats: COMPLETE Column stats: COMPLETE
                         Select Operator
                           expressions: _col0 (type: int), _col1 (type: string), _col3 (type: string)
                           outputColumnNames: _col0, _col1, _col2
-                          Statistics: Num rows: 391 Data size: 72726 Basic stats: COMPLETE Column stats: COMPLETE
+                          Statistics: Num rows: 400 Data size: 74400 Basic stats: COMPLETE Column stats: COMPLETE
                           Reduce Output Operator
                             key expressions: _col0 (type: int), _col1 (type: string), _col2 (type: string)
                             sort order: +++
-                            Statistics: Num rows: 391 Data size: 72726 Basic stats: COMPLETE Column stats: COMPLETE
+                            Statistics: Num rows: 400 Data size: 74400 Basic stats: COMPLETE Column stats: COMPLETE
             Execution mode: vectorized, llap
             LLAP IO: no inputs
         Reducer 3 
@@ -840,10 +840,10 @@ STAGE PLANS:
               Select Operator
                 expressions: KEY.reducesinkkey0 (type: int), KEY.reducesinkkey1 (type: string), KEY.reducesinkkey2 (type: string)
                 outputColumnNames: _col0, _col1, _col2
-                Statistics: Num rows: 391 Data size: 72726 Basic stats: COMPLETE Column stats: COMPLETE
+                Statistics: Num rows: 400 Data size: 74400 Basic stats: COMPLETE Column stats: COMPLETE
                 File Output Operator
                   compressed: false
-                  Statistics: Num rows: 391 Data size: 72726 Basic stats: COMPLETE Column stats: COMPLETE
+                  Statistics: Num rows: 400 Data size: 74400 Basic stats: COMPLETE Column stats: COMPLETE
                   table:
                       input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                       output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
@@ -1436,7 +1436,7 @@ STAGE PLANS:
                 keys:
                   0 _col0 (type: int)
                   1 _col0 (type: int)
-                Statistics: Num rows: 195 Data size: 1560 Basic stats: COMPLETE Column stats: COMPLETE
+                Statistics: Num rows: 200 Data size: 1600 Basic stats: COMPLETE Column stats: COMPLETE
                 Group By Operator
                   aggregations: count()
                   mode: hash
@@ -1565,7 +1565,7 @@ STAGE PLANS:
                     1 _col0 (type: int)
                   input vertices:
                     1 Map 4
-                  Statistics: Num rows: 195 Data size: 1560 Basic stats: COMPLETE Column stats: COMPLETE
+                  Statistics: Num rows: 200 Data size: 1600 Basic stats: COMPLETE Column stats: COMPLETE
                   Group By Operator
                     aggregations: count()
                     mode: hash
@@ -1696,7 +1696,7 @@ STAGE PLANS:
                 keys:
                   0 _col0 (type: int)
                   1 _col0 (type: int)
-                Statistics: Num rows: 632 Data size: 5056 Basic stats: COMPLETE Column stats: COMPLETE
+                Statistics: Num rows: 662 Data size: 5296 Basic stats: COMPLETE Column stats: COMPLETE
                 Group By Operator
                   aggregations: count()
                   mode: hash
@@ -1731,16 +1731,16 @@ STAGE PLANS:
                   0 _col0 (type: int)
                   1 _col0 (type: int)
                 outputColumnNames: _col1
-                Statistics: Num rows: 391 Data size: 1564 Basic stats: COMPLETE Column stats: COMPLETE
+                Statistics: Num rows: 400 Data size: 1600 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
                   expressions: _col1 (type: int)
                   outputColumnNames: _col0
-                  Statistics: Num rows: 391 Data size: 1564 Basic stats: COMPLETE Column stats: COMPLETE
+                  Statistics: Num rows: 400 Data size: 1600 Basic stats: COMPLETE Column stats: COMPLETE
                   Reduce Output Operator
                     key expressions: _col0 (type: int)
                     sort order: +
                     Map-reduce partition columns: _col0 (type: int)
-                    Statistics: Num rows: 391 Data size: 1564 Basic stats: COMPLETE Column stats: COMPLETE
+                    Statistics: Num rows: 400 Data size: 1600 Basic stats: COMPLETE Column stats: COMPLETE
 
   Stage: Stage-0
     Fetch Operator
@@ -1838,11 +1838,11 @@ STAGE PLANS:
                         outputColumnNames: _col1
                         input vertices:
                           1 Map 4
-                        Statistics: Num rows: 391 Data size: 1564 Basic stats: COMPLETE Column stats: COMPLETE
+                        Statistics: Num rows: 400 Data size: 1600 Basic stats: COMPLETE Column stats: COMPLETE
                         Select Operator
                           expressions: _col1 (type: int)
                           outputColumnNames: _col0
-                          Statistics: Num rows: 391 Data size: 1564 Basic stats: COMPLETE Column stats: COMPLETE
+                          Statistics: Num rows: 400 Data size: 1600 Basic stats: COMPLETE Column stats: COMPLETE
                           Map Join Operator
                             condition map:
                                  Inner Join 0 to 1
@@ -1851,7 +1851,7 @@ STAGE PLANS:
                               1 _col0 (type: int)
                             input vertices:
                               0 Map 1
-                            Statistics: Num rows: 632 Data size: 5056 Basic stats: COMPLETE Column stats: COMPLETE
+                            Statistics: Num rows: 662 Data size: 5296 Basic stats: COMPLETE Column stats: COMPLETE
                             Group By Operator
                               aggregations: count()
                               mode: hash
@@ -2007,7 +2007,7 @@ STAGE PLANS:
                 keys:
                   0 _col0 (type: int)
                   1 _col0 (type: int)
-                Statistics: Num rows: 632 Data size: 5056 Basic stats: COMPLETE Column stats: COMPLETE
+                Statistics: Num rows: 662 Data size: 5296 Basic stats: COMPLETE Column stats: COMPLETE
                 Group By Operator
                   aggregations: count()
                   mode: hash
@@ -2042,16 +2042,16 @@ STAGE PLANS:
                   0 _col0 (type: int)
                   1 _col0 (type: int)
                 outputColumnNames: _col1
-                Statistics: Num rows: 391 Data size: 1564 Basic stats: COMPLETE Column stats: COMPLETE
+                Statistics: Num rows: 400 Data size: 1600 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
                   expressions: _col1 (type: int)
                   outputColumnNames: _col0
-                  Statistics: Num rows: 391 Data size: 1564 Basic stats: COMPLETE Column stats: COMPLETE
+                  Statistics: Num rows: 400 Data size: 1600 Basic stats: COMPLETE Column stats: COMPLETE
                   Reduce Output Operator
                     key expressions: _col0 (type: int)
                     sort order: +
                     Map-reduce partition columns: _col0 (type: int)
-                    Statistics: Num rows: 391 Data size: 1564 Basic stats: COMPLETE Column stats: COMPLETE
+                    Statistics: Num rows: 400 Data size: 1600 Basic stats: COMPLETE Column stats: COMPLETE
 
   Stage: Stage-0
     Fetch Operator
@@ -2149,11 +2149,11 @@ STAGE PLANS:
                         outputColumnNames: _col1
                         input vertices:
                           1 Map 4
-                        Statistics: Num rows: 391 Data size: 1564 Basic stats: COMPLETE Column stats: COMPLETE
+                        Statistics: Num rows: 400 Data size: 1600 Basic stats: COMPLETE Column stats: COMPLETE
                         Select Operator
                           expressions: _col1 (type: int)
                           outputColumnNames: _col0
-                          Statistics: Num rows: 391 Data size: 1564 Basic stats: COMPLETE Column stats: COMPLETE
+                          Statistics: Num rows: 400 Data size: 1600 Basic stats: COMPLETE Column stats: COMPLETE
                           Map Join Operator
                             condition map:
                                  Inner Join 0 to 1
@@ -2162,7 +2162,7 @@ STAGE PLANS:
                               1 _col0 (type: int)
                             input vertices:
                               0 Map 1
-                            Statistics: Num rows: 632 Data size: 5056 Basic stats: COMPLETE Column stats: COMPLETE
+                            Statistics: Num rows: 662 Data size: 5296 Basic stats: COMPLETE Column stats: COMPLETE
                             Group By Operator
                               aggregations: count()
                               mode: hash
@@ -2566,11 +2566,11 @@ STAGE PLANS:
                   0 _col0 (type: int)
                   1 _col0 (type: int)
                 outputColumnNames: _col1, _col2
-                Statistics: Num rows: 391 Data size: 37145 Basic stats: COMPLETE Column stats: COMPLETE
+                Statistics: Num rows: 400 Data size: 38000 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
                   expressions: _col1 (type: int), substr(_col2, 5) (type: string)
                   outputColumnNames: _col0, _col1
-                  Statistics: Num rows: 391 Data size: 37145 Basic stats: COMPLETE Column stats: COMPLETE
+                  Statistics: Num rows: 400 Data size: 38000 Basic stats: COMPLETE Column stats: COMPLETE
                   Group By Operator
                     aggregations: sum(_col1)
                     keys: _col0 (type: int)
@@ -2708,11 +2708,11 @@ STAGE PLANS:
                         outputColumnNames: _col1, _col2
                         input vertices:
                           0 Map 2
-                        Statistics: Num rows: 391 Data size: 37145 Basic stats: COMPLETE Column stats: COMPLETE
+                        Statistics: Num rows: 400 Data size: 38000 Basic stats: COMPLETE Column stats: COMPLETE
                         Select Operator
                           expressions: _col1 (type: int), substr(_col2, 5) (type: string)
                           outputColumnNames: _col0, _col1
-                          Statistics: Num rows: 391 Data size: 37145 Basic stats: COMPLETE Column stats: COMPLETE
+                          Statistics: Num rows: 400 Data size: 38000 Basic stats: COMPLETE Column stats: COMPLETE
                           Group By Operator
                             aggregations: sum(_col1)
                             keys: _col0 (type: int)
@@ -2866,14 +2866,14 @@ STAGE PLANS:
                   0 _col0 (type: int)
                   1 _col1 (type: int)
                 outputColumnNames: _col1, _col2, _col3
-                Statistics: Num rows: 247 Data size: 25441 Basic stats: COMPLETE Column stats: COMPLETE
+                Statistics: Num rows: 253 Data size: 26059 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
                   expressions: _col3 (type: int), _col2 (type: double), _col1 (type: string)
                   outputColumnNames: _col0, _col1, _col2
-                  Statistics: Num rows: 247 Data size: 25441 Basic stats: COMPLETE Column stats: COMPLETE
+                  Statistics: Num rows: 253 Data size: 26059 Basic stats: COMPLETE Column stats: COMPLETE
                   File Output Operator
                     compressed: false
-                    Statistics: Num rows: 247 Data size: 25441 Basic stats: COMPLETE Column stats: COMPLETE
+                    Statistics: Num rows: 253 Data size: 26059 Basic stats: COMPLETE Column stats: COMPLETE
                     table:
                         input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                         output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
@@ -2949,14 +2949,14 @@ STAGE PLANS:
                         outputColumnNames: _col1, _col2, _col3
                         input vertices:
                           1 Reducer 3
-                        Statistics: Num rows: 247 Data size: 25441 Basic stats: COMPLETE Column stats: COMPLETE
+                        Statistics: Num rows: 253 Data size: 26059 Basic stats: COMPLETE Column stats: COMPLETE
                         Select Operator
                           expressions: _col3 (type: int), _col2 (type: double), _col1 (type: string)
                           outputColumnNames: _col0, _col1, _col2
-                          Statistics: Num rows: 247 Data size: 25441 Basic stats: COMPLETE Column stats: COMPLETE
+                          Statistics: Num rows: 253 Data size: 26059 Basic stats: COMPLETE Column stats: COMPLETE
                           File Output Operator
                             compressed: false
-                            Statistics: Num rows: 247 Data size: 25441 Basic stats: COMPLETE Column stats: COMPLETE
+                            Statistics: Num rows: 253 Data size: 26059 Basic stats: COMPLETE Column stats: COMPLETE
                             table:
                                 input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                                 output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
@@ -3139,14 +3139,14 @@ STAGE PLANS:
                   1 _col0 (type: int)
                   2 _col0 (type: int)
                 outputColumnNames: _col0, _col1, _col4
-                Statistics: Num rows: 619 Data size: 115134 Basic stats: COMPLETE Column stats: COMPLETE
+                Statistics: Num rows: 633 Data size: 117738 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
                   expressions: _col0 (type: int), _col1 (type: string), _col4 (type: string)
                   outputColumnNames: _col0, _col1, _col2
-                  Statistics: Num rows: 619 Data size: 115134 Basic stats: COMPLETE Column stats: COMPLETE
+                  Statistics: Num rows: 633 Data size: 117738 Basic stats: COMPLETE Column stats: COMPLETE
                   File Output Operator
                     compressed: false
-                    Statistics: Num rows: 619 Data size: 115134 Basic stats: COMPLETE Column stats: COMPLETE
+                    Statistics: Num rows: 633 Data size: 117738 Basic stats: COMPLETE Column stats: COMPLETE
                     table:
                         input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                         output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
@@ -3202,14 +3202,14 @@ STAGE PLANS:
                         input vertices:
                           1 Map 2
                           2 Map 3
-                        Statistics: Num rows: 619 Data size: 115134 Basic stats: COMPLETE Column stats: COMPLETE
+                        Statistics: Num rows: 633 Data size: 117738 Basic stats: COMPLETE Column stats: COMPLETE
                         Select Operator
                           expressions: _col0 (type: int), _col1 (type: string), _col4 (type: string)
                           outputColumnNames: _col0, _col1, _col2
-                          Statistics: Num rows: 619 Data size: 115134 Basic stats: COMPLETE Column stats: COMPLETE
+                          Statistics: Num rows: 633 Data size: 117738 Basic stats: COMPLETE Column stats: COMPLETE
                           File Output Operator
                             compressed: false
-                            Statistics: Num rows: 619 Data size: 115134 Basic stats: COMPLETE Column stats: COMPLETE
+                            Statistics: Num rows: 633 Data size: 117738 Basic stats: COMPLETE Column stats: COMPLETE
                             table:
                                 input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                                 output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
@@ -3304,12 +3304,12 @@ STAGE PLANS:
                         outputColumnNames: _col0, _col1
                         input vertices:
                           1 Map 3
-                        Statistics: Num rows: 391 Data size: 37145 Basic stats: COMPLETE Column stats: COMPLETE
+                        Statistics: Num rows: 400 Data size: 38000 Basic stats: COMPLETE Column stats: COMPLETE
                         Reduce Output Operator
                           key expressions: _col0 (type: int)
                           sort order: +
                           Map-reduce partition columns: _col0 (type: int)
-                          Statistics: Num rows: 391 Data size: 37145 Basic stats: COMPLETE Column stats: COMPLETE
+                          Statistics: Num rows: 400 Data size: 38000 Basic stats: COMPLETE Column stats: COMPLETE
                           value expressions: _col1 (type: string)
             Execution mode: vectorized, llap
             LLAP IO: no inputs
@@ -3362,14 +3362,14 @@ STAGE PLANS:
                   0 _col0 (type: int)
                   1 _col0 (type: int)
                 outputColumnNames: _col0, _col1, _col3
-                Statistics: Num rows: 618 Data size: 114948 Basic stats: COMPLETE Column stats: COMPLETE
+                Statistics: Num rows: 632 Data size: 117552 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
                   expressions: _col0 (type: int), _col1 (type: string), _col3 (type: string)
                   outputColumnNames: _col0, _col1, _col2
-                  Statistics: Num rows: 618 Data size: 114948 Basic stats: COMPLETE Column stats: COMPLETE
+                  Statistics: Num rows: 632 Data size: 117552 Basic stats: COMPLETE Column stats: COMPLETE
                   File Output Operator
                     compressed: false
-                    Statistics: Num rows: 618 Data size: 114948 Basic stats: COMPLETE Column stats: COMPLETE
+                    Statistics: Num rows: 632 Data size: 117552 Basic stats: COMPLETE Column stats: COMPLETE
                     table:
                         input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                         output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
@@ -3422,7 +3422,7 @@ STAGE PLANS:
                         outputColumnNames: _col0, _col1
                         input vertices:
                           1 Map 2
-                        Statistics: Num rows: 391 Data size: 37145 Basic stats: COMPLETE Column stats: COMPLETE
+                        Statistics: Num rows: 400 Data size: 38000 Basic stats: COMPLETE Column stats: COMPLETE
                         Map Join Operator
                           condition map:
                                Inner Join 0 to 1
@@ -3432,14 +3432,14 @@ STAGE PLANS:
                           outputColumnNames: _col0, _col1, _col3
                           input vertices:
                             1 Map 3
-                          Statistics: Num rows: 618 Data size: 114948 Basic stats: COMPLETE Column stats: COMPLETE
+                          Statistics: Num rows: 632 Data size: 117552 Basic stats: COMPLETE Column stats: COMPLETE
                           Select Operator
                             expressions: _col0 (type: int), _col1 (type: string), _col3 (type: string)
                             outputColumnNames: _col0, _col1, _col2
-                            Statistics: Num rows: 618 Data size: 114948 Basic stats: COMPLETE Column stats: COMPLETE
+                            Statistics: Num rows: 632 Data size: 117552 Basic stats: COMPLETE Column stats: COMPLETE
                             File Output Operator
                               compressed: false
-                              Statistics: Num rows: 618 Data size: 114948 Basic stats: COMPLETE Column stats: COMPLETE
+                              Statistics: Num rows: 632 Data size: 117552 Basic stats: COMPLETE Column stats: COMPLETE
                               table:
                                   input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                                   output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
@@ -3586,14 +3586,14 @@ STAGE PLANS:
                   0 _col0 (type: int)
                   1 _col0 (type: int)
                 outputColumnNames: _col0, _col1, _col3
-                Statistics: Num rows: 195 Data size: 20085 Basic stats: COMPLETE Column stats: COMPLETE
+                Statistics: Num rows: 200 Data size: 20600 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
                   expressions: _col0 (type: int), _col1 (type: double), _col3 (type: string)
                   outputColumnNames: _col0, _col1, _col2
-                  Statistics: Num rows: 195 Data size: 20085 Basic stats: COMPLETE Column stats: COMPLETE
+                  Statistics: Num rows: 200 Data size: 20600 Basic stats: COMPLETE Column stats: COMPLETE
                   File Output Operator
                     compressed: false
-                    Statistics: Num rows: 195 Data size: 20085 Basic stats: COMPLETE Column stats: COMPLETE
+                    Statistics: Num rows: 200 Data size: 20600 Basic stats: COMPLETE Column stats: COMPLETE
                     table:
                         input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                         output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
@@ -3675,14 +3675,14 @@ STAGE PLANS:
                         outputColumnNames: _col0, _col1, _col3
                         input vertices:
                           0 Reducer 2
-                        Statistics: Num rows: 195 Data size: 20085 Basic stats: COMPLETE Column stats: COMPLETE
+                        Statistics: Num rows: 200 Data size: 20600 Basic stats: COMPLETE Column stats: COMPLETE
                         Select Operator
                           expressions: _col0 (type: int), _col1 (type: double), _col3 (type: string)
                           outputColumnNames: _col0, _col1, _col2
-                          Statistics: Num rows: 195 Data size: 20085 Basic stats: COMPLETE Column stats: COMPLETE
+                          Statistics: Num rows: 200 Data size: 20600 Basic stats: COMPLETE Column stats: COMPLETE
                           File Output Operator
                             compressed: false
-                            Statistics: Num rows: 195 Data size: 20085 Basic stats: COMPLETE Column stats: COMPLETE
+                            Statistics: Num rows: 200 Data size: 20600 Basic stats: COMPLETE Column stats: COMPLETE
                             table:
                                 input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                                 output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
@@ -3799,14 +3799,14 @@ STAGE PLANS:
                   0 _col0 (type: int)
                   1 _col0 (type: int)
                 outputColumnNames: _col0, _col1, _col3
-                Statistics: Num rows: 247 Data size: 25441 Basic stats: COMPLETE Column stats: COMPLETE
+                Statistics: Num rows: 253 Data size: 26059 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
                   expressions: _col0 (type: int), _col1 (type: double), _col3 (type: string)
                   outputColumnNames: _col0, _col1, _col2
-                  Statistics: Num rows: 247 Data size: 25441 Basic stats: COMPLETE Column stats: COMPLETE
+                  Statistics: Num rows: 253 Data size: 26059 Basic stats: COMPLETE Column stats: COMPLETE
                   File Output Operator
                     compressed: false
-                    Statistics: Num rows: 247 Data size: 25441 Basic stats: COMPLETE Column stats: COMPLETE
+                    Statistics: Num rows: 253 Data size: 26059 Basic stats: COMPLETE Column stats: COMPLETE
                     table:
                         input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                         output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
@@ -3882,14 +3882,14 @@ STAGE PLANS:
                         outputColumnNames: _col0, _col1, _col3
                         input vertices:
                           0 Reducer 2
-                        Statistics: Num rows: 247 Data size: 25441 Basic stats: COMPLETE Column stats: COMPLETE
+                        Statistics: Num rows: 253 Data size: 26059 Basic stats: COMPLETE Column stats: COMPLETE
                         Select Operator
                           expressions: _col0 (type: int), _col1 (type: double), _col3 (type: string)
                           outputColumnNames: _col0, _col1, _col2
-                          Statistics: Num rows: 247 Data size: 25441 Basic stats: COMPLETE Column stats: COMPLETE
+                          Statistics: Num rows: 253 Data size: 26059 Basic stats: COMPLETE Column stats: COMPLETE
                           File Output Operator
                             compressed: false
-                            Statistics: Num rows: 247 Data size: 25441 Basic stats: COMPLETE Column stats: COMPLETE
+                            Statistics: Num rows: 253 Data size: 26059 Basic stats: COMPLETE Column stats: COMPLETE
                             table:
                                 input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                                 output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
@@ -4178,14 +4178,14 @@ STAGE PLANS:
                   0 _col0 (type: int)
                   1 _col0 (type: int)
                 outputColumnNames: _col0, _col1, _col3
-                Statistics: Num rows: 391 Data size: 72726 Basic stats: COMPLETE Column stats: COMPLETE
+                Statistics: Num rows: 400 Data size: 74400 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
                   expressions: _col0 (type: int), _col1 (type: string), _col3 (type: string)
                   outputColumnNames: _col0, _col1, _col2
-                  Statistics: Num rows: 391 Data size: 72726 Basic stats: COMPLETE Column stats: COMPLETE
+                  Statistics: Num rows: 400 Data size: 74400 Basic stats: COMPLETE Column stats: COMPLETE
                   File Output Operator
                     compressed: false
-                    Statistics: Num rows: 391 Data size: 72726 Basic stats: COMPLETE Column stats: COMPLETE
+                    Statistics: Num rows: 400 Data size: 74400 Basic stats: COMPLETE Column stats: COMPLETE
                     table:
                         input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                         output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
@@ -4258,14 +4258,14 @@ STAGE PLANS:
                         outputColumnNames: _col0, _col1, _col3
                         input vertices:
                           0 Map 1
-                        Statistics: Num rows: 391 Data size: 72726 Basic stats: COMPLETE Column stats: COMPLETE
+                        Statistics: Num rows: 400 Data size: 74400 Basic stats: COMPLETE Column stats: COMPLETE
                         Select Operator
                           expressions: _col0 (type: int), _col1 (type: string), _col3 (type: string)
                           outputColumnNames: _col0, _col1, _col2
-                          Statistics: Num rows: 391 Data size: 72726 Basic stats: COMPLETE Column stats: COMPLETE
+                          Statistics: Num rows: 400 Data size: 74400 Basic stats: COMPLETE Column stats: COMPLETE
                           File Output Operator
                             compressed: false
-                            Statistics: Num rows: 391 Data size: 72726 Basic stats: COMPLETE Column stats: COMPLETE
+                            Statistics: Num rows: 400 Data size: 74400 Basic stats: COMPLETE Column stats: COMPLETE
                             table:
                                 input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                                 output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
@@ -4292,8 +4292,7 @@ STAGE PLANS:
     Tez
 #### A masked pattern was here ####
       Edges:
-        Map 1 <- Map 3 (BROADCAST_EDGE)
-        Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 4 (SIMPLE_EDGE)
+        Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 3 (SIMPLE_EDGE), Map 4 (BROADCAST_EDGE)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -4308,44 +4307,15 @@ STAGE PLANS:
                       expressions: key (type: int), value (type: string)
                       outputColumnNames: _col0, _col1
                       Statistics: Num rows: 500 Data size: 47500 Basic stats: COMPLETE Column stats: COMPLETE
-                      Map Join Operator
-                        condition map:
-                             Inner Join 0 to 1
-                        keys:
-                          0 _col0 (type: int)
-                          1 _col0 (type: int)
-                        outputColumnNames: _col0, _col1
-                        input vertices:
-                          1 Map 3
-                        Statistics: Num rows: 809 Data size: 76855 Basic stats: COMPLETE Column stats: COMPLETE
-                        Reduce Output Operator
-                          key expressions: _col1 (type: string)
-                          sort order: +
-                          Map-reduce partition columns: _col1 (type: string)
-                          Statistics: Num rows: 809 Data size: 76855 Basic stats: COMPLETE Column stats: COMPLETE
-                          value expressions: _col0 (type: int)
-            Execution mode: vectorized, llap
-            LLAP IO: no inputs
-        Map 3 
-            Map Operator Tree:
-                TableScan
-                  alias: c
-                  Statistics: Num rows: 500 Data size: 2000 Basic stats: COMPLETE Column stats: COMPLETE
-                  Filter Operator
-                    predicate: key is not null (type: boolean)
-                    Statistics: Num rows: 500 Data size: 2000 Basic stats: COMPLETE Column stats: COMPLETE
-                    Select Operator
-                      expressions: key (type: int)
-                      outputColumnNames: _col0
-                      Statistics: Num rows: 500 Data size: 2000 Basic stats: COMPLETE Column stats: COMPLETE
                       Reduce Output Operator
-                        key expressions: _col0 (type: int)
+                        key expressions: _col1 (type: string)
                         sort order: +
-                        Map-reduce partition columns: _col0 (type: int)
-                        Statistics: Num rows: 500 Data size: 2000 Basic stats: COMPLETE Column stats: COMPLETE
+                        Map-reduce partition columns: _col1 (type: string)
+                        Statistics: Num rows: 500 Data size: 47500 Basic stats: COMPLETE Column stats: COMPLETE
+                        value expressions: _col0 (type: int)
             Execution mode: vectorized, llap
             LLAP IO: no inputs
-        Map 4 
+        Map 3 
             Map Operator Tree:
                 TableScan
                   alias: b
@@ -4365,6 +4335,25 @@ STAGE PLANS:
                         value expressions: _col0 (type: int)
             Execution mode: vectorized, llap
             LLAP IO: no inputs
+        Map 4 
+            Map Operator Tree:
+                TableScan
+                  alias: c
+                  Statistics: Num rows: 500 Data size: 2000 Basic stats: COMPLETE Column stats: COMPLETE
+                  Filter Operator
+                    predicate: key is not null (type: boolean)
+                    Statistics: Num rows: 500 Data size: 2000 Basic stats: COMPLETE Column stats: COMPLETE
+                    Select Operator
+                      expressions: key (type: int)
+                      outputColumnNames: _col0
+                      Statistics: Num rows: 500 Data size: 2000 Basic stats: COMPLETE Column stats: COMPLETE
+                      Reduce Output Operator
+                        key expressions: _col0 (type: int)
+                        sort order: +
+                        Map-reduce partition columns: _col0 (type: int)
+                        Statistics: Num rows: 500 Data size: 2000 Basic stats: COMPLETE Column stats: COMPLETE
+            Execution mode: vectorized, llap
+            LLAP IO: no inputs
         Reducer 2 
             Execution mode: llap
             Reduce Operator Tree:
@@ -4374,19 +4363,29 @@ STAGE PLANS:
                 keys:
                   0 _col1 (type: string)
                   1 _col1 (type: string)
-                outputColumnNames: _col0, _col3
-                Statistics: Num rows: 1309 Data size: 10472 Basic stats: COMPLETE Column stats: COMPLETE
-                Select Operator
-                  expressions: _col0 (type: int), _col3 (type: int)
-                  outputColumnNames: _col0, _col1
-                  Statistics: Num rows: 1309 Data size: 10472 Basic stats: COMPLETE Column stats: COMPLETE
-                  File Output Operator
-                    compressed: false
-                    Statistics: Num rows: 1309 Data size: 10472 Basic stats: COMPLETE Column stats: COMPLETE
-                    table:
-                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
-                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
-                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                outputColumnNames: _col0, _col2
+                Statistics: Num rows: 809 Data size: 6472 Basic stats: COMPLETE Column stats: COMPLETE
+                Map Join Operator
+                  condition map:
+                       Inner Join 0 to 1
+                  keys:
+                    0 _col0 (type: int)
+                    1 _col0 (type: int)
+                  outputColumnNames: _col0, _col2
+                  input vertices:
+                    1 Map 4
+                  Statistics: Num rows: 1339 Data size: 10712 Basic stats: COMPLETE Column stats: COMPLETE
+                  Select Operator
+                    expressions: _col0 (type: int), _col2 (type: int)
+                    outputColumnNames: _col0, _col1
+                    Statistics: Num rows: 1339 Data size: 10712 Basic stats: COMPLETE Column stats: COMPLETE
+                    File Output Operator
+                      compressed: false
+                      Statistics: Num rows: 1339 Data size: 10712 Basic stats: COMPLETE Column stats: COMPLETE
+                      table:
+                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
 
   Stage: Stage-0
     Fetch Operator
@@ -4407,7 +4406,7 @@ STAGE PLANS:
     Tez
 #### A masked pattern was here ####
       Edges:
-        Map 1 <- Map 2 (CUSTOM_EDGE), Map 3 (CUSTOM_EDGE)
+        Map 1 <- Map 2 (CUSTOM_EDGE), Map 3 (BROADCAST_EDGE)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -4426,29 +4425,29 @@ STAGE PLANS:
                         condition map:
                              Inner Join 0 to 1
                         keys:
-                          0 _col0 (type: int)
-                          1 _col0 (type: int)
-                        outputColumnNames: _col0, _col1
+                          0 _col1 (type: string)
+                          1 _col1 (type: string)
+                        outputColumnNames: _col0, _col2
                         input vertices:
                           1 Map 2
-                        Statistics: Num rows: 809 Data size: 76855 Basic stats: COMPLETE Column stats: COMPLETE
+                        Statistics: Num rows: 809 Data size: 6472 Basic stats: COMPLETE Column stats: COMPLETE
                         Map Join Operator
                           condition map:
                                Inner Join 0 to 1
                           keys:
-                            0 _col1 (type: string)
-                            1 _col1 (type: string)
-                          outputColumnNames: _col0, _col3
+                            0 _col0 (type: int)
+                            1 _col0 (type: int)
+                          outputColumnNames: _col0, _col2
                           input vertices:
                             1 Map 3
-                          Statistics: Num rows: 1309 Data size: 10472 Basic stats: COMPLETE Column stats: COMPLETE
+                          Statistics: Num rows: 1339 Data size: 10712 Basic stats: COMPLETE Column stats: COMPLETE
                           Select Operator
-                            expressions: _col0 (type: int), _col3 (type: int)
+                            expressions: _col0 (type: int), _col2 (type: int)
                             outputColumnNames: _col0, _col1
-                            Statistics: Num rows: 1309 Data size: 10472 Basic stats: COMPLETE Column stats: COMPLETE
+                            Statistics: Num rows: 1339 Data size: 10712 Basic stats: COMPLETE Column stats: COMPLETE
                             File Output Operator
                               compressed: false
-                              Statistics: Num rows: 1309 Data size: 10472 Basic stats: COMPLETE Column stats: COMPLETE
+                              Statistics: Num rows: 1339 Data size: 10712 Basic stats: COMPLETE Column stats: COMPLETE
                               table:
                                   input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                                   output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
@@ -4456,25 +4455,6 @@ STAGE PLANS:
             Execution mode: vectorized, llap
             LLAP IO: no inputs
         Map 2 
-            Map Operator Tree:
-                TableScan
-                  alias: c
-                  Statistics: Num rows: 500 Data size: 2000 Basic stats: COMPLETE Column stats: COMPLETE
-                  Filter Operator
-                    predicate: key is not null (type: boolean)
-                    Statistics: Num rows: 500 Data size: 2000 Basic stats: COMPLETE Column stats: COMPLETE
-                    Select Operator
-                      expressions: key (type: int)
-                      outputColumnNames: _col0
-                      Statistics: Num rows: 500 Data size: 2000 Basic stats: COMPLETE Column stats: COMPLETE
-                      Reduce Output Operator
-                        key expressions: _col0 (type: int)
-                        sort order: +
-                        Map-reduce partition columns: _col0 (type: int)
-                        Statistics: Num rows: 500 Data size: 2000 Basic stats: COMPLETE Column stats: COMPLETE
-            Execution mode: vectorized, llap
-            LLAP IO: no inputs
-        Map 3 
             Map Operator Tree:
                 TableScan
                   alias: b
@@ -4494,6 +4474,25 @@ STAGE PLANS:
                         value expressions: _col0 (type: int)
             Execution mode: vectorized, llap
             LLAP IO: no inputs
+        Map 3 
+            Map Operator Tree:
+                TableScan
+                  alias: c
+                  Statistics: Num rows: 500 Data size: 2000 Basic stats: COMPLETE Column stats: COMPLETE
+                  Filter Operator
+                    predicate: key is not null (type: boolean)
+                    Statistics: Num rows: 500 Data size: 2000 Basic stats: COMPLETE Column stats: COMPLETE
+                    Select Operator
+                      expressions: key (type: int)
+                      outputColumnNames: _col0
+                      Statistics: Num rows: 500 Data size: 2000 Basic stats: COMPLETE Column stats: COMPLETE
+                      Reduce Output Operator
+                        key expressions: _col0 (type: int)
+                        sort order: +
+                        Map-reduce partition columns: _col0 (type: int)
+                        Statistics: Num rows: 500 Data size: 2000 Basic stats: COMPLETE Column stats: COMPLETE
+            Execution mode: vectorized, llap
+            LLAP IO: no inputs
 
   Stage: Stage-0
     Fetch Operator
@@ -4586,14 +4585,14 @@ STAGE PLANS:
                   0 _col0 (type: int), _col2 (type: string)
                   1 _col0 (type: int), _col2 (type: string)
                 outputColumnNames: _col0, _col1, _col4
-                Statistics: Num rows: 391 Data size: 72726 Basic stats: COMPLETE Column stats: COMPLETE
+                Statistics: Num rows: 400 Data size: 74400 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
                   expressions: _col0 (type: int), _col1 (type: string), _col4 (type: string)
                   outputColumnNames: _col0, _col1, _col2
-                  Statistics: Num rows: 391 Data size: 72726 Basic stats: COMPLETE Column stats: COMPLETE
+                  Statistics: Num rows: 400 Data size: 74400 Basic stats: COMPLETE Column stats: COMPLETE
                   File Output Operator
                     compressed: false
-                    Statistics: Num rows: 391 Data size: 72726 Basic stats: COMPLETE Column stats: COMPLETE
+                    Statistics: Num rows: 400 Data size: 74400 Basic stats: COMPLETE Column stats: COMPLETE
                     table:
                         input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                         output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
@@ -4690,14 +4689,14 @@ STAGE PLANS:
                   0 _col0 (type: int), _col2 (type: string)
                   1 _col0 (type: int), _col2 (type: string)
                 outputColumnNames: _col0, _col1, _col4
-                Statistics: Num rows: 391 Data size: 72726 Basic stats: COMPLETE Column stats: COMPLETE
+                Statistics: Num rows: 400 Data size: 74400 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
                   expressions: _col0 (type: int), _col1 (type: string), _col4 (type: string)
                   outputColumnNames: _col0, _col1, _col2
-                  Statistics: Num rows: 391 Data size: 72726 Basic stats: COMPLETE Column stats: COMPLETE
+                  Statistics: Num rows: 400 Data size: 74400 Basic stats: COMPLETE Column stats: COMPLETE
                   File Output Operator
                     compressed: false
-                    Statistics: Num rows: 391 Data size: 72726 Basic stats: COMPLETE Column stats: COMPLETE
+                    Statistics: Num rows: 400 Data size: 74400 Basic stats: COMPLETE Column stats: COMPLETE
                     table:
                         input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                         output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
@@ -5892,14 +5891,14 @@ POSTHOOK: Output: default@tab2@ds=2008-04-08
 POSTHOOK: Lineage: tab2 PARTITION(ds=2008-04-08).key SIMPLE [(srcbucket_mapjoin)srcbucket_mapjoin.FieldSchema(name:key, type:int, comment:null), ]
 POSTHOOK: Lineage: tab2 PARTITION(ds=2008-04-08).value SIMPLE [(srcbucket_mapjoin)srcbucket_mapjoin.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: analyze table tab2 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@tab2
 PREHOOK: Input: default@tab2@ds=2008-04-08
 PREHOOK: Output: default@tab2
 PREHOOK: Output: default@tab2@ds=2008-04-08
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table tab2 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@tab2
 POSTHOOK: Input: default@tab2@ds=2008-04-08
 POSTHOOK: Output: default@tab2
diff --git a/ql/src/test/results/clientpositive/llap/bucket_map_join_tez2.q.out b/ql/src/test/results/clientpositive/llap/bucket_map_join_tez2.q.out
index 5aa247840a..51b138a0f1 100644
--- a/ql/src/test/results/clientpositive/llap/bucket_map_join_tez2.q.out
+++ b/ql/src/test/results/clientpositive/llap/bucket_map_join_tez2.q.out
@@ -109,56 +109,56 @@ POSTHOOK: Output: default@tab@ds=2008-04-08
 POSTHOOK: Lineage: tab PARTITION(ds=2008-04-08).key SIMPLE [(srcbucket_mapjoin)srcbucket_mapjoin.FieldSchema(name:key, type:int, comment:null), ]
 POSTHOOK: Lineage: tab PARTITION(ds=2008-04-08).value SIMPLE [(srcbucket_mapjoin)srcbucket_mapjoin.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: analyze table srcbucket_mapjoin compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@srcbucket_mapjoin
 PREHOOK: Input: default@srcbucket_mapjoin@ds=2008-04-08
 PREHOOK: Output: default@srcbucket_mapjoin
 PREHOOK: Output: default@srcbucket_mapjoin@ds=2008-04-08
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table srcbucket_mapjoin compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@srcbucket_mapjoin
 POSTHOOK: Input: default@srcbucket_mapjoin@ds=2008-04-08
 POSTHOOK: Output: default@srcbucket_mapjoin
 POSTHOOK: Output: default@srcbucket_mapjoin@ds=2008-04-08
 #### A masked pattern was here ####
 PREHOOK: query: analyze table srcbucket_mapjoin_part compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@srcbucket_mapjoin_part
 PREHOOK: Input: default@srcbucket_mapjoin_part@ds=2008-04-08
 PREHOOK: Output: default@srcbucket_mapjoin_part
 PREHOOK: Output: default@srcbucket_mapjoin_part@ds=2008-04-08
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table srcbucket_mapjoin_part compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@srcbucket_mapjoin_part
 POSTHOOK: Input: default@srcbucket_mapjoin_part@ds=2008-04-08
 POSTHOOK: Output: default@srcbucket_mapjoin_part
 POSTHOOK: Output: default@srcbucket_mapjoin_part@ds=2008-04-08
 #### A masked pattern was here ####
 PREHOOK: query: analyze table tab compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@tab
 PREHOOK: Input: default@tab@ds=2008-04-08
 PREHOOK: Output: default@tab
 PREHOOK: Output: default@tab@ds=2008-04-08
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table tab compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@tab
 POSTHOOK: Input: default@tab@ds=2008-04-08
 POSTHOOK: Output: default@tab
 POSTHOOK: Output: default@tab@ds=2008-04-08
 #### A masked pattern was here ####
 PREHOOK: query: analyze table tab_part compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@tab_part
 PREHOOK: Input: default@tab_part@ds=2008-04-08
 PREHOOK: Output: default@tab_part
 PREHOOK: Output: default@tab_part@ds=2008-04-08
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table tab_part compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@tab_part
 POSTHOOK: Input: default@tab_part@ds=2008-04-08
 POSTHOOK: Output: default@tab_part
@@ -178,7 +178,7 @@ STAGE PLANS:
 #### A masked pattern was here ####
       Edges:
         Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 4 (SIMPLE_EDGE)
-        Reducer 3 <- Map 1 (SIMPLE_EDGE), Reducer 2 (SIMPLE_EDGE)
+        Reducer 3 <- Map 5 (SIMPLE_EDGE), Reducer 2 (SIMPLE_EDGE)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -194,11 +194,18 @@ STAGE PLANS:
                       outputColumnNames: _col0, _col1
                       Statistics: Num rows: 500 Data size: 47500 Basic stats: COMPLETE Column stats: COMPLETE
                       Reduce Output Operator
-                        key expressions: _col0 (type: int)
+                        key expressions: _col1 (type: string)
                         sort order: +
-                        Map-reduce partition columns: _col0 (type: int)
+                        Map-reduce partition columns: _col1 (type: string)
                         Statistics: Num rows: 500 Data size: 47500 Basic stats: COMPLETE Column stats: COMPLETE
-                        value expressions: _col1 (type: string)
+                        value expressions: _col0 (type: int)
+            Execution mode: vectorized, llap
+            LLAP IO: no inputs
+        Map 4 
+            Map Operator Tree:
+                TableScan
+                  alias: b
+                  Statistics: Num rows: 500 Data size: 47500 Basic stats: COMPLETE Column stats: COMPLETE
                   Filter Operator
                     predicate: value is not null (type: boolean)
                     Statistics: Num rows: 500 Data size: 47500 Basic stats: COMPLETE Column stats: COMPLETE
@@ -214,7 +221,7 @@ STAGE PLANS:
                         value expressions: _col0 (type: int)
             Execution mode: vectorized, llap
             LLAP IO: no inputs
-        Map 4 
+        Map 5 
             Map Operator Tree:
                 TableScan
                   alias: c
@@ -240,16 +247,16 @@ STAGE PLANS:
                 condition map:
                      Inner Join 0 to 1
                 keys:
-                  0 _col0 (type: int)
-                  1 _col0 (type: int)
-                outputColumnNames: _col0, _col1
-                Statistics: Num rows: 809 Data size: 76855 Basic stats: COMPLETE Column stats: COMPLETE
+                  0 _col1 (type: string)
+                  1 _col1 (type: string)
+                outputColumnNames: _col0, _col2
+                Statistics: Num rows: 809 Data size: 6472 Basic stats: COMPLETE Column stats: COMPLETE
                 Reduce Output Operator
-                  key expressions: _col1 (type: string)
+                  key expressions: _col0 (type: int)
                   sort order: +
-                  Map-reduce partition columns: _col1 (type: string)
-                  Statistics: Num rows: 809 Data size: 76855 Basic stats: COMPLETE Column stats: COMPLETE
-                  value expressions: _col0 (type: int)
+                  Map-reduce partition columns: _col0 (type: int)
+                  Statistics: Num rows: 809 Data size: 6472 Basic stats: COMPLETE Column stats: COMPLETE
+                  value expressions: _col2 (type: int)
         Reducer 3 
             Execution mode: llap
             Reduce Operator Tree:
@@ -257,17 +264,17 @@ STAGE PLANS:
                 condition map:
                      Inner Join 0 to 1
                 keys:
-                  0 _col1 (type: string)
-                  1 _col1 (type: string)
-                outputColumnNames: _col0, _col3
-                Statistics: Num rows: 1309 Data size: 10472 Basic stats: COMPLETE Column stats: COMPLETE
+                  0 _col0 (type: int)
+                  1 _col0 (type: int)
+                outputColumnNames: _col0, _col2
+                Statistics: Num rows: 1339 Data size: 10712 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: _col0 (type: int), _col3 (type: int)
+                  expressions: _col0 (type: int), _col2 (type: int)
                   outputColumnNames: _col0, _col1
-                  Statistics: Num rows: 1309 Data size: 10472 Basic stats: COMPLETE Column stats: COMPLETE
+                  Statistics: Num rows: 1339 Data size: 10712 Basic stats: COMPLETE Column stats: COMPLETE
                   File Output Operator
                     compressed: false
-                    Statistics: Num rows: 1309 Data size: 10472 Basic stats: COMPLETE Column stats: COMPLETE
+                    Statistics: Num rows: 1339 Data size: 10712 Basic stats: COMPLETE Column stats: COMPLETE
                     table:
                         input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                         output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
@@ -292,8 +299,8 @@ STAGE PLANS:
     Tez
 #### A masked pattern was here ####
       Edges:
-        Map 1 <- Map 3 (CUSTOM_EDGE)
         Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 4 (SIMPLE_EDGE)
+        Reducer 3 <- Map 5 (SIMPLE_EDGE), Reducer 2 (SIMPLE_EDGE)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -308,41 +315,12 @@ STAGE PLANS:
                       expressions: key (type: int), value (type: string)
                       outputColumnNames: _col0, _col1
                       Statistics: Num rows: 500 Data size: 47500 Basic stats: COMPLETE Column stats: COMPLETE
-                      Map Join Operator
-                        condition map:
-                             Inner Join 0 to 1
-                        keys:
-                          0 _col0 (type: int)
-                          1 _col0 (type: int)
-                        outputColumnNames: _col0, _col1
-                        input vertices:
-                          1 Map 3
-                        Statistics: Num rows: 809 Data size: 76855 Basic stats: COMPLETE Column stats: COMPLETE
-                        Reduce Output Operator
-                          key expressions: _col1 (type: string)
-                          sort order: +
-                          Map-reduce partition columns: _col1 (type: string)
-                          Statistics: Num rows: 809 Data size: 76855 Basic stats: COMPLETE Column stats: COMPLETE
-                          value expressions: _col0 (type: int)
-            Execution mode: vectorized, llap
-            LLAP IO: no inputs
-        Map 3 
-            Map Operator Tree:
-                TableScan
-                  alias: c
-                  Statistics: Num rows: 500 Data size: 2000 Basic stats: COMPLETE Column stats: COMPLETE
-                  Filter Operator
-                    predicate: key is not null (type: boolean)
-                    Statistics: Num rows: 500 Data size: 2000 Basic stats: COMPLETE Column stats: COMPLETE
-                    Select Operator
-                      expressions: key (type: int)
-                      outputColumnNames: _col0
-                      Statistics: Num rows: 500 Data size: 2000 Basic stats: COMPLETE Column stats: COMPLETE
                       Reduce Output Operator
-                        key expressions: _col0 (type: int)
+                        key expressions: _col1 (type: string)
                         sort order: +
-                        Map-reduce partition columns: _col0 (type: int)
-                        Statistics: Num rows: 500 Data size: 2000 Basic stats: COMPLETE Column stats: COMPLETE
+                        Map-reduce partition columns: _col1 (type: string)
+                        Statistics: Num rows: 500 Data size: 47500 Basic stats: COMPLETE Column stats: COMPLETE
+                        value expressions: _col0 (type: int)
             Execution mode: vectorized, llap
             LLAP IO: no inputs
         Map 4 
@@ -365,6 +343,25 @@ STAGE PLANS:
                         value expressions: _col0 (type: int)
             Execution mode: vectorized, llap
             LLAP IO: no inputs
+        Map 5 
+            Map Operator Tree:
+                TableScan
+                  alias: c
+                  Statistics: Num rows: 500 Data size: 2000 Basic stats: COMPLETE Column stats: COMPLETE
+                  Filter Operator
+                    predicate: key is not null (type: boolean)
+                    Statistics: Num rows: 500 Data size: 2000 Basic stats: COMPLETE Column stats: COMPLETE
+                    Select Operator
+                      expressions: key (type: int)
+                      outputColumnNames: _col0
+                      Statistics: Num rows: 500 Data size: 2000 Basic stats: COMPLETE Column stats: COMPLETE
+                      Reduce Output Operator
+                        key expressions: _col0 (type: int)
+                        sort order: +
+                        Map-reduce partition columns: _col0 (type: int)
+                        Statistics: Num rows: 500 Data size: 2000 Basic stats: COMPLETE Column stats: COMPLETE
+            Execution mode: vectorized, llap
+            LLAP IO: no inputs
         Reducer 2 
             Execution mode: llap
             Reduce Operator Tree:
@@ -374,15 +371,32 @@ STAGE PLANS:
                 keys:
                   0 _col1 (type: string)
                   1 _col1 (type: string)
-                outputColumnNames: _col0, _col3
-                Statistics: Num rows: 1309 Data size: 10472 Basic stats: COMPLETE Column stats: COMPLETE
+                outputColumnNames: _col0, _col2
+                Statistics: Num rows: 809 Data size: 6472 Basic stats: COMPLETE Column stats: COMPLETE
+                Reduce Output Operator
+                  key expressions: _col0 (type: int)
+                  sort order: +
+                  Map-reduce partition columns: _col0 (type: int)
+                  Statistics: Num rows: 809 Data size: 6472 Basic stats: COMPLETE Column stats: COMPLETE
+                  value expressions: _col2 (type: int)
+        Reducer 3 
+            Execution mode: llap
+            Reduce Operator Tree:
+              Merge Join Operator
+                condition map:
+                     Inner Join 0 to 1
+                keys:
+                  0 _col0 (type: int)
+                  1 _col0 (type: int)
+                outputColumnNames: _col0, _col2
+                Statistics: Num rows: 1339 Data size: 10712 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: _col0 (type: int), _col3 (type: int)
+                  expressions: _col0 (type: int), _col2 (type: int)
                   outputColumnNames: _col0, _col1
-                  Statistics: Num rows: 1309 Data size: 10472 Basic stats: COMPLETE Column stats: COMPLETE
+                  Statistics: Num rows: 1339 Data size: 10712 Basic stats: COMPLETE Column stats: COMPLETE
                   File Output Operator
                     compressed: false
-                    Statistics: Num rows: 1309 Data size: 10472 Basic stats: COMPLETE Column stats: COMPLETE
+                    Statistics: Num rows: 1339 Data size: 10712 Basic stats: COMPLETE Column stats: COMPLETE
                     table:
                         input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                         output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
@@ -417,12 +431,12 @@ POSTHOOK: Output: default@tab1
 POSTHOOK: Lineage: tab1.key SIMPLE [(srcbucket_mapjoin)srcbucket_mapjoin.FieldSchema(name:key, type:int, comment:null), ]
 POSTHOOK: Lineage: tab1.value SIMPLE [(srcbucket_mapjoin)srcbucket_mapjoin.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: analyze table tab1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@tab1
 PREHOOK: Output: default@tab1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table tab1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@tab1
 POSTHOOK: Output: default@tab1
 #### A masked pattern was here ####
@@ -670,10 +684,10 @@ STAGE PLANS:
                   0 _col0 (type: int)
                   1 _col0 (type: int)
                 outputColumnNames: _col0, _col1
-                Statistics: Num rows: 267 Data size: 2136 Basic stats: COMPLETE Column stats: COMPLETE
+                Statistics: Num rows: 272 Data size: 2176 Basic stats: COMPLETE Column stats: COMPLETE
                 File Output Operator
                   compressed: false
-                  Statistics: Num rows: 267 Data size: 2136 Basic stats: COMPLETE Column stats: COMPLETE
+                  Statistics: Num rows: 272 Data size: 2176 Basic stats: COMPLETE Column stats: COMPLETE
                   table:
                       input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                       output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
@@ -724,10 +738,10 @@ STAGE PLANS:
                         outputColumnNames: _col0, _col1
                         input vertices:
                           1 Map 2
-                        Statistics: Num rows: 267 Data size: 2136 Basic stats: COMPLETE Column stats: COMPLETE
+                        Statistics: Num rows: 272 Data size: 2176 Basic stats: COMPLETE Column stats: COMPLETE
                         File Output Operator
                           compressed: false
-                          Statistics: Num rows: 267 Data size: 2136 Basic stats: COMPLETE Column stats: COMPLETE
+                          Statistics: Num rows: 272 Data size: 2176 Basic stats: COMPLETE Column stats: COMPLETE
                           table:
                               input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                               output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
@@ -826,10 +840,10 @@ STAGE PLANS:
                   0 _col0 (type: int)
                   1 _col0 (type: int)
                 outputColumnNames: _col0, _col1
-                Statistics: Num rows: 267 Data size: 2136 Basic stats: COMPLETE Column stats: COMPLETE
+                Statistics: Num rows: 272 Data size: 2176 Basic stats: COMPLETE Column stats: COMPLETE
                 File Output Operator
                   compressed: false
-                  Statistics: Num rows: 267 Data size: 2136 Basic stats: COMPLETE Column stats: COMPLETE
+                  Statistics: Num rows: 272 Data size: 2176 Basic stats: COMPLETE Column stats: COMPLETE
                   table:
                       input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                       output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
@@ -880,10 +894,10 @@ STAGE PLANS:
                         outputColumnNames: _col0, _col1
                         input vertices:
                           1 Map 2
-                        Statistics: Num rows: 267 Data size: 2136 Basic stats: COMPLETE Column stats: COMPLETE
+                        Statistics: Num rows: 272 Data size: 2176 Basic stats: COMPLETE Column stats: COMPLETE
                         File Output Operator
                           compressed: false
-                          Statistics: Num rows: 267 Data size: 2136 Basic stats: COMPLETE Column stats: COMPLETE
+                          Statistics: Num rows: 272 Data size: 2176 Basic stats: COMPLETE Column stats: COMPLETE
                           table:
                               input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                               output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
@@ -982,10 +996,10 @@ STAGE PLANS:
                   0 _col0 (type: int)
                   1 _col0 (type: int)
                 outputColumnNames: _col0, _col1
-                Statistics: Num rows: 267 Data size: 2136 Basic stats: COMPLETE Column stats: COMPLETE
+                Statistics: Num rows: 272 Data size: 2176 Basic stats: COMPLETE Column stats: COMPLETE
                 File Output Operator
                   compressed: false
-                  Statistics: Num rows: 267 Data size: 2136 Basic stats: COMPLETE Column stats: COMPLETE
+                  Statistics: Num rows: 272 Data size: 2176 Basic stats: COMPLETE Column stats: COMPLETE
                   table:
                       input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                       output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
@@ -1055,10 +1069,10 @@ STAGE PLANS:
                         outputColumnNames: _col0, _col1
                         input vertices:
                           0 Map 1
-                        Statistics: Num rows: 267 Data size: 2136 Basic stats: COMPLETE Column stats: COMPLETE
+                        Statistics: Num rows: 272 Data size: 2176 Basic stats: COMPLETE Column stats: COMPLETE
                         File Output Operator
                           compressed: false
-                          Statistics: Num rows: 267 Data size: 2136 Basic stats: COMPLETE Column stats: COMPLETE
+                          Statistics: Num rows: 272 Data size: 2176 Basic stats: COMPLETE Column stats: COMPLETE
                           table:
                               input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                               output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
@@ -1467,14 +1481,14 @@ POSTHOOK: Output: default@tab_part1@ds=2008-04-08
 POSTHOOK: Lineage: tab_part1 PARTITION(ds=2008-04-08).key SIMPLE [(srcbucket_mapjoin_part)srcbucket_mapjoin_part.FieldSchema(name:key, type:int, comment:null), ]
 POSTHOOK: Lineage: tab_part1 PARTITION(ds=2008-04-08).value SIMPLE [(srcbucket_mapjoin_part)srcbucket_mapjoin_part.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: analyze table tab_part1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@tab_part1
 PREHOOK: Input: default@tab_part1@ds=2008-04-08
 PREHOOK: Output: default@tab_part1
 PREHOOK: Output: default@tab_part1@ds=2008-04-08
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table tab_part1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@tab_part1
 POSTHOOK: Input: default@tab_part1@ds=2008-04-08
 POSTHOOK: Output: default@tab_part1
diff --git a/ql/src/test/results/clientpositive/llap/columnStatsUpdateForStatsOptimizer_1.q.out b/ql/src/test/results/clientpositive/llap/columnStatsUpdateForStatsOptimizer_1.q.out
index 2a9f3391dc..c3a37872b1 100644
--- a/ql/src/test/results/clientpositive/llap/columnStatsUpdateForStatsOptimizer_1.q.out
+++ b/ql/src/test/results/clientpositive/llap/columnStatsUpdateForStatsOptimizer_1.q.out
@@ -189,12 +189,12 @@ POSTHOOK: Input: default@calendar
 #### A masked pattern was here ####
 12
 PREHOOK: query: analyze table calendar compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@calendar
 PREHOOK: Output: default@calendar
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table calendar compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@calendar
 POSTHOOK: Output: default@calendar
 #### A masked pattern was here ####
@@ -436,12 +436,12 @@ POSTHOOK: Input: default@calendar
 #### A masked pattern was here ####
 15
 PREHOOK: query: analyze table calendar compute statistics for columns year
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@calendar
 PREHOOK: Output: default@calendar
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table calendar compute statistics for columns year
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@calendar
 POSTHOOK: Output: default@calendar
 #### A masked pattern was here ####
@@ -571,12 +571,12 @@ POSTHOOK: Input: default@calendar
 #### A masked pattern was here ####
 15
 PREHOOK: query: analyze table calendar compute statistics for columns month
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@calendar
 PREHOOK: Output: default@calendar
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table calendar compute statistics for columns month
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@calendar
 POSTHOOK: Output: default@calendar
 #### A masked pattern was here ####
@@ -761,14 +761,14 @@ POSTHOOK: Input: default@calendarp@p=1
 #### A masked pattern was here ####
 2012
 PREHOOK: query: analyze table calendarp partition (p=1) compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@calendarp
 PREHOOK: Input: default@calendarp@p=1
 PREHOOK: Output: default@calendarp
 PREHOOK: Output: default@calendarp@p=1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table calendarp partition (p=1) compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@calendarp
 POSTHOOK: Input: default@calendarp@p=1
 POSTHOOK: Output: default@calendarp
diff --git a/ql/src/test/results/clientpositive/llap/column_table_stats.q.out b/ql/src/test/results/clientpositive/llap/column_table_stats.q.out
index 1457932726..52c23a4fad 100644
--- a/ql/src/test/results/clientpositive/llap/column_table_stats.q.out
+++ b/ql/src/test/results/clientpositive/llap/column_table_stats.q.out
@@ -53,9 +53,9 @@ Sort Columns:       	[]
 Storage Desc Params:	 	 
 	serialization.format	1                   
 PREHOOK: query: explain extended analyze table s compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 POSTHOOK: query: explain extended analyze table s compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-2 depends on stages: Stage-0
@@ -187,12 +187,12 @@ STAGE PLANS:
           Is Table Level Stats: true
 
 PREHOOK: query: analyze table s compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@s
 PREHOOK: Output: default@s
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table s compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@s
 POSTHOOK: Output: default@s
 #### A masked pattern was here ####
@@ -310,9 +310,9 @@ Sort Columns:       	[]
 Storage Desc Params:	 	 
 	serialization.format	1                   
 PREHOOK: query: explain extended analyze table spart compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 POSTHOOK: query: explain extended analyze table spart compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-2 depends on stages: Stage-0
@@ -503,7 +503,7 @@ STAGE PLANS:
           Is Table Level Stats: false
 
 PREHOOK: query: analyze table spart compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@spart
 PREHOOK: Input: default@spart@ds=2008-04-08/hr=11
 PREHOOK: Input: default@spart@ds=2008-04-08/hr=12
@@ -512,7 +512,7 @@ PREHOOK: Output: default@spart@ds=2008-04-08/hr=11
 PREHOOK: Output: default@spart@ds=2008-04-08/hr=12
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table spart compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@spart
 POSTHOOK: Input: default@spart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@spart@ds=2008-04-08/hr=12
@@ -720,9 +720,9 @@ Sort Columns:       	[]
 Storage Desc Params:	 	 
 	serialization.format	1                   
 PREHOOK: query: explain extended analyze table spart partition(ds,hr) compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 POSTHOOK: query: explain extended analyze table spart partition(ds,hr) compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-2 depends on stages: Stage-0
@@ -913,7 +913,7 @@ STAGE PLANS:
           Is Table Level Stats: false
 
 PREHOOK: query: analyze table spart partition(ds,hr) compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@spart
 PREHOOK: Input: default@spart@ds=2008-04-08/hr=11
 PREHOOK: Input: default@spart@ds=2008-04-08/hr=12
@@ -922,7 +922,7 @@ PREHOOK: Output: default@spart@ds=2008-04-08/hr=11
 PREHOOK: Output: default@spart@ds=2008-04-08/hr=12
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table spart partition(ds,hr) compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@spart
 POSTHOOK: Input: default@spart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@spart@ds=2008-04-08/hr=12
@@ -1130,9 +1130,9 @@ Sort Columns:       	[]
 Storage Desc Params:	 	 
 	serialization.format	1                   
 PREHOOK: query: explain extended analyze table spart partition(hr="11") compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 POSTHOOK: query: explain extended analyze table spart partition(hr="11") compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-2 depends on stages: Stage-0
@@ -1274,14 +1274,14 @@ STAGE PLANS:
           Is Table Level Stats: false
 
 PREHOOK: query: analyze table spart partition(hr="11") compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@spart
 PREHOOK: Input: default@spart@ds=2008-04-08/hr=11
 PREHOOK: Output: default@spart
 PREHOOK: Output: default@spart@ds=2008-04-08/hr=11
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table spart partition(hr="11") compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@spart
 POSTHOOK: Input: default@spart@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@spart
diff --git a/ql/src/test/results/clientpositive/llap/column_table_stats_orc.q.out b/ql/src/test/results/clientpositive/llap/column_table_stats_orc.q.out
index 5ed5dbf96d..b539651cb0 100644
--- a/ql/src/test/results/clientpositive/llap/column_table_stats_orc.q.out
+++ b/ql/src/test/results/clientpositive/llap/column_table_stats_orc.q.out
@@ -56,9 +56,9 @@ Sort Columns:       	[]
 Storage Desc Params:	 	 
 	serialization.format	1                   
 PREHOOK: query: explain extended analyze table s compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 POSTHOOK: query: explain extended analyze table s compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-2 depends on stages: Stage-0
@@ -191,12 +191,12 @@ STAGE PLANS:
           Is Table Level Stats: true
 
 PREHOOK: query: analyze table s compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@s
 PREHOOK: Output: default@s
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table s compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@s
 POSTHOOK: Output: default@s
 #### A masked pattern was here ####
@@ -313,9 +313,9 @@ Sort Columns:       	[]
 Storage Desc Params:	 	 
 	serialization.format	1                   
 PREHOOK: query: explain extended analyze table spart compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 POSTHOOK: query: explain extended analyze table spart compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-2 depends on stages: Stage-0
@@ -499,7 +499,7 @@ STAGE PLANS:
           Is Table Level Stats: false
 
 PREHOOK: query: analyze table spart compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@spart
 PREHOOK: Input: default@spart@ds=2008-04-08/hr=11
 PREHOOK: Input: default@spart@ds=2008-04-08/hr=12
@@ -508,7 +508,7 @@ PREHOOK: Output: default@spart@ds=2008-04-08/hr=11
 PREHOOK: Output: default@spart@ds=2008-04-08/hr=12
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table spart compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@spart
 POSTHOOK: Input: default@spart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@spart@ds=2008-04-08/hr=12
@@ -715,9 +715,9 @@ Sort Columns:       	[]
 Storage Desc Params:	 	 
 	serialization.format	1                   
 PREHOOK: query: explain extended analyze table spart partition(hr="11") compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 POSTHOOK: query: explain extended analyze table spart partition(hr="11") compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-2 depends on stages: Stage-0
@@ -855,14 +855,14 @@ STAGE PLANS:
           Is Table Level Stats: false
 
 PREHOOK: query: analyze table spart partition(hr="11") compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@spart
 PREHOOK: Input: default@spart@ds=2008-04-08/hr=11
 PREHOOK: Output: default@spart
 PREHOOK: Output: default@spart@ds=2008-04-08/hr=11
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table spart partition(hr="11") compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@spart
 POSTHOOK: Input: default@spart@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@spart
diff --git a/ql/src/test/results/clientpositive/llap/columnstats_part_coltype.q.out b/ql/src/test/results/clientpositive/llap/columnstats_part_coltype.q.out
index fff076e6a7..3b3843ac69 100644
--- a/ql/src/test/results/clientpositive/llap/columnstats_part_coltype.q.out
+++ b/ql/src/test/results/clientpositive/llap/columnstats_part_coltype.q.out
@@ -61,14 +61,14 @@ POSTHOOK: Output: default@partcolstats@ds=2015-04-03/hr=3/part=partB
 POSTHOOK: Lineage: partcolstats PARTITION(ds=2015-04-03,hr=3,part=partB).key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: partcolstats PARTITION(ds=2015-04-03,hr=3,part=partB).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: analyze table partcolstats partition (ds=date '2015-04-02', hr=2, part='partA') compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@partcolstats
 PREHOOK: Input: default@partcolstats@ds=2015-04-02/hr=2/part=partA
 PREHOOK: Output: default@partcolstats
 PREHOOK: Output: default@partcolstats@ds=2015-04-02/hr=2/part=partA
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table partcolstats partition (ds=date '2015-04-02', hr=2, part='partA') compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@partcolstats
 POSTHOOK: Input: default@partcolstats@ds=2015-04-02/hr=2/part=partA
 POSTHOOK: Output: default@partcolstats
@@ -147,7 +147,7 @@ num_falses
 bitVector           	HL                  	 	 	 	 	 	 	 	 	 	 
 comment             	from deserializer   	 	 	 	 	 	 	 	 	 	 
 PREHOOK: query: analyze table partcolstats partition (ds=date '2015-04-02', hr=2, part) compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@partcolstats
 PREHOOK: Input: default@partcolstats@ds=2015-04-02/hr=2/part=partA
 PREHOOK: Input: default@partcolstats@ds=2015-04-02/hr=2/part=partB
@@ -156,7 +156,7 @@ PREHOOK: Output: default@partcolstats@ds=2015-04-02/hr=2/part=partA
 PREHOOK: Output: default@partcolstats@ds=2015-04-02/hr=2/part=partB
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table partcolstats partition (ds=date '2015-04-02', hr=2, part) compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@partcolstats
 POSTHOOK: Input: default@partcolstats@ds=2015-04-02/hr=2/part=partA
 POSTHOOK: Input: default@partcolstats@ds=2015-04-02/hr=2/part=partB
@@ -237,7 +237,7 @@ num_falses
 bitVector           	HL                  	 	 	 	 	 	 	 	 	 	 
 comment             	from deserializer   	 	 	 	 	 	 	 	 	 	 
 PREHOOK: query: analyze table partcolstats partition (ds=date '2015-04-02', hr, part) compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@partcolstats
 PREHOOK: Input: default@partcolstats@ds=2015-04-02/hr=2/part=partA
 PREHOOK: Input: default@partcolstats@ds=2015-04-02/hr=2/part=partB
@@ -248,7 +248,7 @@ PREHOOK: Output: default@partcolstats@ds=2015-04-02/hr=2/part=partB
 PREHOOK: Output: default@partcolstats@ds=2015-04-02/hr=3/part=partA
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table partcolstats partition (ds=date '2015-04-02', hr, part) compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@partcolstats
 POSTHOOK: Input: default@partcolstats@ds=2015-04-02/hr=2/part=partA
 POSTHOOK: Input: default@partcolstats@ds=2015-04-02/hr=2/part=partB
@@ -367,7 +367,7 @@ num_falses
 bitVector           	HL                  	 	 	 	 	 	 	 	 	 	 
 comment             	from deserializer   	 	 	 	 	 	 	 	 	 	 
 PREHOOK: query: analyze table partcolstats partition (ds, hr, part) compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@partcolstats
 PREHOOK: Input: default@partcolstats@ds=2015-04-02/hr=2/part=partA
 PREHOOK: Input: default@partcolstats@ds=2015-04-02/hr=2/part=partB
@@ -382,7 +382,7 @@ PREHOOK: Output: default@partcolstats@ds=2015-04-03/hr=3/part=partA
 PREHOOK: Output: default@partcolstats@ds=2015-04-03/hr=3/part=partB
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table partcolstats partition (ds, hr, part) compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@partcolstats
 POSTHOOK: Input: default@partcolstats@ds=2015-04-02/hr=2/part=partA
 POSTHOOK: Input: default@partcolstats@ds=2015-04-02/hr=2/part=partB
@@ -499,14 +499,14 @@ POSTHOOK: Output: default@partcolstatsnum@tint=100/sint=1000/bint=1000000
 POSTHOOK: Lineage: partcolstatsnum PARTITION(tint=100,sint=1000,bint=1000000).key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: partcolstatsnum PARTITION(tint=100,sint=1000,bint=1000000).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: analyze table partcolstatsnum partition (tint=100, sint=1000, bint=1000000) compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@partcolstatsnum
 PREHOOK: Input: default@partcolstatsnum@tint=100/sint=1000/bint=1000000
 PREHOOK: Output: default@partcolstatsnum
 PREHOOK: Output: default@partcolstatsnum@tint=100/sint=1000/bint=1000000
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table partcolstatsnum partition (tint=100, sint=1000, bint=1000000) compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@partcolstatsnum
 POSTHOOK: Input: default@partcolstatsnum@tint=100/sint=1000/bint=1000000
 POSTHOOK: Output: default@partcolstatsnum
@@ -561,14 +561,14 @@ POSTHOOK: Output: default@partcolstatsdec@decpart=1000.0001
 POSTHOOK: Lineage: partcolstatsdec PARTITION(decpart=1000.0001).key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: partcolstatsdec PARTITION(decpart=1000.0001).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: analyze table partcolstatsdec partition (decpart='1000.0001') compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@partcolstatsdec
 PREHOOK: Input: default@partcolstatsdec@decpart=1000.0001
 PREHOOK: Output: default@partcolstatsdec
 PREHOOK: Output: default@partcolstatsdec@decpart=1000.0001
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table partcolstatsdec partition (decpart='1000.0001') compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@partcolstatsdec
 POSTHOOK: Input: default@partcolstatsdec@decpart=1000.0001
 POSTHOOK: Output: default@partcolstatsdec
@@ -623,14 +623,14 @@ POSTHOOK: Output: default@partcolstatschar@varpart=part1/charpart=aaa
 POSTHOOK: Lineage: partcolstatschar PARTITION(varpart=part1,charpart=aaa).key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: partcolstatschar PARTITION(varpart=part1,charpart=aaa).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: analyze table partcolstatschar partition (varpart='part1', charpart='aaa') compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@partcolstatschar
 PREHOOK: Input: default@partcolstatschar@varpart=part1/charpart=aaa
 PREHOOK: Output: default@partcolstatschar
 PREHOOK: Output: default@partcolstatschar@varpart=part1/charpart=aaa
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table partcolstatschar partition (varpart='part1', charpart='aaa') compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@partcolstatschar
 POSTHOOK: Input: default@partcolstatschar@varpart=part1/charpart=aaa
 POSTHOOK: Output: default@partcolstatschar
diff --git a/ql/src/test/results/clientpositive/llap/deleteAnalyze.q.out b/ql/src/test/results/clientpositive/llap/deleteAnalyze.q.out
index 0d8ad05b12..fe6b6e2ee6 100644
--- a/ql/src/test/results/clientpositive/llap/deleteAnalyze.q.out
+++ b/ql/src/test/results/clientpositive/llap/deleteAnalyze.q.out
@@ -88,12 +88,12 @@ bitVector           	HL
 comment             	from deserializer   	 	 	 	 	 	 	 	 	 	 
 COLUMN_STATS_ACCURATE	{\"BASIC_STATS\":\"true\",\"COLUMN_STATS\":{\"amount\":\"true\",\"id\":\"true\",\"item\":\"true\",\"sales_tax\":\"true\"}}	 	 	 	 	 	 	 	 	 	 
 PREHOOK: query: analyze table testdeci2 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@testdeci2
 PREHOOK: Output: default@testdeci2
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table testdeci2 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@testdeci2
 POSTHOOK: Output: default@testdeci2
 #### A masked pattern was here ####
@@ -135,12 +135,12 @@ Sort Columns:       	[]
 Storage Desc Params:	 	 
 	serialization.format	1                   
 PREHOOK: query: analyze table testdeci2 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@testdeci2
 PREHOOK: Output: default@testdeci2
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table testdeci2 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@testdeci2
 POSTHOOK: Output: default@testdeci2
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/llap/drop_partition_with_stats.q.out b/ql/src/test/results/clientpositive/llap/drop_partition_with_stats.q.out
index 2d68334166..430f781262 100644
--- a/ql/src/test/results/clientpositive/llap/drop_partition_with_stats.q.out
+++ b/ql/src/test/results/clientpositive/llap/drop_partition_with_stats.q.out
@@ -37,7 +37,7 @@ POSTHOOK: type: LOAD
 POSTHOOK: Output: partstatsdb1@testtable
 POSTHOOK: Output: partstatsdb1@testtable@part1=p21/part2=P22
 PREHOOK: query: ANALYZE TABLE testtable COMPUTE STATISTICS FOR COLUMNS key
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: partstatsdb1@testtable
 PREHOOK: Input: partstatsdb1@testtable@part1=p11/part2=P12
 PREHOOK: Input: partstatsdb1@testtable@part1=p21/part2=P22
@@ -46,7 +46,7 @@ PREHOOK: Output: partstatsdb1@testtable
 PREHOOK: Output: partstatsdb1@testtable@part1=p11/part2=P12
 PREHOOK: Output: partstatsdb1@testtable@part1=p21/part2=P22
 POSTHOOK: query: ANALYZE TABLE testtable COMPUTE STATISTICS FOR COLUMNS key
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: partstatsdb1@testtable
 POSTHOOK: Input: partstatsdb1@testtable@part1=p11/part2=P12
 POSTHOOK: Input: partstatsdb1@testtable@part1=p21/part2=P22
@@ -55,14 +55,14 @@ POSTHOOK: Output: partstatsdb1@testtable
 POSTHOOK: Output: partstatsdb1@testtable@part1=p11/part2=P12
 POSTHOOK: Output: partstatsdb1@testtable@part1=p21/part2=P22
 PREHOOK: query: ANALYZE TABLE testtable PARTITION (part1='p11', Part2='P12') COMPUTE STATISTICS FOR COLUMNS key
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: partstatsdb1@testtable
 PREHOOK: Input: partstatsdb1@testtable@part1=p11/part2=P12
 #### A masked pattern was here ####
 PREHOOK: Output: partstatsdb1@testtable
 PREHOOK: Output: partstatsdb1@testtable@part1=p11/part2=P12
 POSTHOOK: query: ANALYZE TABLE testtable PARTITION (part1='p11', Part2='P12') COMPUTE STATISTICS FOR COLUMNS key
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: partstatsdb1@testtable
 POSTHOOK: Input: partstatsdb1@testtable@part1=p11/part2=P12
 #### A masked pattern was here ####
@@ -113,7 +113,7 @@ POSTHOOK: type: LOAD
 POSTHOOK: Output: partstatsdb1@testtable1
 POSTHOOK: Output: partstatsdb1@testtable1@part1=p31/part2=P32
 PREHOOK: query: ANALYZE TABLE TestTable1 COMPUTE STATISTICS FOR COLUMNS key
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: partstatsdb1@testtable1
 PREHOOK: Input: partstatsdb1@testtable1@part1=p11/part2=P11
 PREHOOK: Input: partstatsdb1@testtable1@part1=p11/part2=P12
@@ -126,7 +126,7 @@ PREHOOK: Output: partstatsdb1@testtable1@part1=p11/part2=P12
 PREHOOK: Output: partstatsdb1@testtable1@part1=p21/part2=P22
 PREHOOK: Output: partstatsdb1@testtable1@part1=p31/part2=P32
 POSTHOOK: query: ANALYZE TABLE TestTable1 COMPUTE STATISTICS FOR COLUMNS key
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: partstatsdb1@testtable1
 POSTHOOK: Input: partstatsdb1@testtable1@part1=p11/part2=P11
 POSTHOOK: Input: partstatsdb1@testtable1@part1=p11/part2=P12
@@ -139,7 +139,7 @@ POSTHOOK: Output: partstatsdb1@testtable1@part1=p11/part2=P12
 POSTHOOK: Output: partstatsdb1@testtable1@part1=p21/part2=P22
 POSTHOOK: Output: partstatsdb1@testtable1@part1=p31/part2=P32
 PREHOOK: query: ANALYZE TABLE TestTable1 PARTITION (part1='p11') COMPUTE STATISTICS FOR COLUMNS key
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: partstatsdb1@testtable1
 PREHOOK: Input: partstatsdb1@testtable1@part1=p11/part2=P11
 PREHOOK: Input: partstatsdb1@testtable1@part1=p11/part2=P12
@@ -148,7 +148,7 @@ PREHOOK: Output: partstatsdb1@testtable1
 PREHOOK: Output: partstatsdb1@testtable1@part1=p11/part2=P11
 PREHOOK: Output: partstatsdb1@testtable1@part1=p11/part2=P12
 POSTHOOK: query: ANALYZE TABLE TestTable1 PARTITION (part1='p11') COMPUTE STATISTICS FOR COLUMNS key
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: partstatsdb1@testtable1
 POSTHOOK: Input: partstatsdb1@testtable1@part1=p11/part2=P11
 POSTHOOK: Input: partstatsdb1@testtable1@part1=p11/part2=P12
@@ -157,14 +157,14 @@ POSTHOOK: Output: partstatsdb1@testtable1
 POSTHOOK: Output: partstatsdb1@testtable1@part1=p11/part2=P11
 POSTHOOK: Output: partstatsdb1@testtable1@part1=p11/part2=P12
 PREHOOK: query: ANALYZE TABLE TestTable1 PARTITION (part1='p11', Part2='P12') COMPUTE STATISTICS FOR COLUMNS key
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: partstatsdb1@testtable1
 PREHOOK: Input: partstatsdb1@testtable1@part1=p11/part2=P12
 #### A masked pattern was here ####
 PREHOOK: Output: partstatsdb1@testtable1
 PREHOOK: Output: partstatsdb1@testtable1@part1=p11/part2=P12
 POSTHOOK: query: ANALYZE TABLE TestTable1 PARTITION (part1='p11', Part2='P12') COMPUTE STATISTICS FOR COLUMNS key
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: partstatsdb1@testtable1
 POSTHOOK: Input: partstatsdb1@testtable1@part1=p11/part2=P12
 #### A masked pattern was here ####
@@ -197,7 +197,7 @@ POSTHOOK: type: LOAD
 POSTHOOK: Output: partstatsdb1@testtable2
 POSTHOOK: Output: partstatsdb1@testtable2@part1=p21/part2=P22
 PREHOOK: query: ANALYZE TABLE TESTTABLE2 COMPUTE STATISTICS FOR COLUMNS key
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: partstatsdb1@testtable2
 PREHOOK: Input: partstatsdb1@testtable2@part1=p11/part2=P12
 PREHOOK: Input: partstatsdb1@testtable2@part1=p21/part2=P22
@@ -206,7 +206,7 @@ PREHOOK: Output: partstatsdb1@testtable2
 PREHOOK: Output: partstatsdb1@testtable2@part1=p11/part2=P12
 PREHOOK: Output: partstatsdb1@testtable2@part1=p21/part2=P22
 POSTHOOK: query: ANALYZE TABLE TESTTABLE2 COMPUTE STATISTICS FOR COLUMNS key
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: partstatsdb1@testtable2
 POSTHOOK: Input: partstatsdb1@testtable2@part1=p11/part2=P12
 POSTHOOK: Input: partstatsdb1@testtable2@part1=p21/part2=P22
@@ -215,14 +215,14 @@ POSTHOOK: Output: partstatsdb1@testtable2
 POSTHOOK: Output: partstatsdb1@testtable2@part1=p11/part2=P12
 POSTHOOK: Output: partstatsdb1@testtable2@part1=p21/part2=P22
 PREHOOK: query: ANALYZE TABLE TESTTABLE2 PARTITION (part1='p11', Part2='P12') COMPUTE STATISTICS FOR COLUMNS key
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: partstatsdb1@testtable2
 PREHOOK: Input: partstatsdb1@testtable2@part1=p11/part2=P12
 #### A masked pattern was here ####
 PREHOOK: Output: partstatsdb1@testtable2
 PREHOOK: Output: partstatsdb1@testtable2@part1=p11/part2=P12
 POSTHOOK: query: ANALYZE TABLE TESTTABLE2 PARTITION (part1='p11', Part2='P12') COMPUTE STATISTICS FOR COLUMNS key
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: partstatsdb1@testtable2
 POSTHOOK: Input: partstatsdb1@testtable2@part1=p11/part2=P12
 #### A masked pattern was here ####
@@ -323,7 +323,7 @@ POSTHOOK: type: LOAD
 POSTHOOK: Output: partstatsdb2@testtable
 POSTHOOK: Output: partstatsdb2@testtable@part1=p21/part2=P22
 PREHOOK: query: ANALYZE TABLE testtable COMPUTE STATISTICS FOR COLUMNS key
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: partstatsdb2@testtable
 PREHOOK: Input: partstatsdb2@testtable@part1=p11/part2=P12
 PREHOOK: Input: partstatsdb2@testtable@part1=p21/part2=P22
@@ -332,7 +332,7 @@ PREHOOK: Output: partstatsdb2@testtable
 PREHOOK: Output: partstatsdb2@testtable@part1=p11/part2=P12
 PREHOOK: Output: partstatsdb2@testtable@part1=p21/part2=P22
 POSTHOOK: query: ANALYZE TABLE testtable COMPUTE STATISTICS FOR COLUMNS key
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: partstatsdb2@testtable
 POSTHOOK: Input: partstatsdb2@testtable@part1=p11/part2=P12
 POSTHOOK: Input: partstatsdb2@testtable@part1=p21/part2=P22
@@ -341,14 +341,14 @@ POSTHOOK: Output: partstatsdb2@testtable
 POSTHOOK: Output: partstatsdb2@testtable@part1=p11/part2=P12
 POSTHOOK: Output: partstatsdb2@testtable@part1=p21/part2=P22
 PREHOOK: query: ANALYZE TABLE testtable PARTITION (part1='p11', Part2='P12') COMPUTE STATISTICS FOR COLUMNS key
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: partstatsdb2@testtable
 PREHOOK: Input: partstatsdb2@testtable@part1=p11/part2=P12
 #### A masked pattern was here ####
 PREHOOK: Output: partstatsdb2@testtable
 PREHOOK: Output: partstatsdb2@testtable@part1=p11/part2=P12
 POSTHOOK: query: ANALYZE TABLE testtable PARTITION (part1='p11', Part2='P12') COMPUTE STATISTICS FOR COLUMNS key
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: partstatsdb2@testtable
 POSTHOOK: Input: partstatsdb2@testtable@part1=p11/part2=P12
 #### A masked pattern was here ####
@@ -399,7 +399,7 @@ POSTHOOK: type: LOAD
 POSTHOOK: Output: partstatsdb2@testtable1
 POSTHOOK: Output: partstatsdb2@testtable1@part1=p31/part2=P32
 PREHOOK: query: ANALYZE TABLE TestTable1 COMPUTE STATISTICS FOR COLUMNS key
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: partstatsdb2@testtable1
 PREHOOK: Input: partstatsdb2@testtable1@part1=p11/part2=P11
 PREHOOK: Input: partstatsdb2@testtable1@part1=p11/part2=P12
@@ -412,7 +412,7 @@ PREHOOK: Output: partstatsdb2@testtable1@part1=p11/part2=P12
 PREHOOK: Output: partstatsdb2@testtable1@part1=p21/part2=P22
 PREHOOK: Output: partstatsdb2@testtable1@part1=p31/part2=P32
 POSTHOOK: query: ANALYZE TABLE TestTable1 COMPUTE STATISTICS FOR COLUMNS key
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: partstatsdb2@testtable1
 POSTHOOK: Input: partstatsdb2@testtable1@part1=p11/part2=P11
 POSTHOOK: Input: partstatsdb2@testtable1@part1=p11/part2=P12
@@ -425,7 +425,7 @@ POSTHOOK: Output: partstatsdb2@testtable1@part1=p11/part2=P12
 POSTHOOK: Output: partstatsdb2@testtable1@part1=p21/part2=P22
 POSTHOOK: Output: partstatsdb2@testtable1@part1=p31/part2=P32
 PREHOOK: query: ANALYZE TABLE TestTable1 PARTITION (part1='p11') COMPUTE STATISTICS FOR COLUMNS key
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: partstatsdb2@testtable1
 PREHOOK: Input: partstatsdb2@testtable1@part1=p11/part2=P11
 PREHOOK: Input: partstatsdb2@testtable1@part1=p11/part2=P12
@@ -434,7 +434,7 @@ PREHOOK: Output: partstatsdb2@testtable1
 PREHOOK: Output: partstatsdb2@testtable1@part1=p11/part2=P11
 PREHOOK: Output: partstatsdb2@testtable1@part1=p11/part2=P12
 POSTHOOK: query: ANALYZE TABLE TestTable1 PARTITION (part1='p11') COMPUTE STATISTICS FOR COLUMNS key
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: partstatsdb2@testtable1
 POSTHOOK: Input: partstatsdb2@testtable1@part1=p11/part2=P11
 POSTHOOK: Input: partstatsdb2@testtable1@part1=p11/part2=P12
@@ -443,14 +443,14 @@ POSTHOOK: Output: partstatsdb2@testtable1
 POSTHOOK: Output: partstatsdb2@testtable1@part1=p11/part2=P11
 POSTHOOK: Output: partstatsdb2@testtable1@part1=p11/part2=P12
 PREHOOK: query: ANALYZE TABLE TestTable1 PARTITION (part1='p11', Part2='P12') COMPUTE STATISTICS FOR COLUMNS key
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: partstatsdb2@testtable1
 PREHOOK: Input: partstatsdb2@testtable1@part1=p11/part2=P12
 #### A masked pattern was here ####
 PREHOOK: Output: partstatsdb2@testtable1
 PREHOOK: Output: partstatsdb2@testtable1@part1=p11/part2=P12
 POSTHOOK: query: ANALYZE TABLE TestTable1 PARTITION (part1='p11', Part2='P12') COMPUTE STATISTICS FOR COLUMNS key
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: partstatsdb2@testtable1
 POSTHOOK: Input: partstatsdb2@testtable1@part1=p11/part2=P12
 #### A masked pattern was here ####
@@ -483,7 +483,7 @@ POSTHOOK: type: LOAD
 POSTHOOK: Output: partstatsdb2@testtable2
 POSTHOOK: Output: partstatsdb2@testtable2@part1=p21/part2=P22
 PREHOOK: query: ANALYZE TABLE TESTTABLE2 COMPUTE STATISTICS FOR COLUMNS key
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: partstatsdb2@testtable2
 PREHOOK: Input: partstatsdb2@testtable2@part1=p11/part2=P12
 PREHOOK: Input: partstatsdb2@testtable2@part1=p21/part2=P22
@@ -492,7 +492,7 @@ PREHOOK: Output: partstatsdb2@testtable2
 PREHOOK: Output: partstatsdb2@testtable2@part1=p11/part2=P12
 PREHOOK: Output: partstatsdb2@testtable2@part1=p21/part2=P22
 POSTHOOK: query: ANALYZE TABLE TESTTABLE2 COMPUTE STATISTICS FOR COLUMNS key
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: partstatsdb2@testtable2
 POSTHOOK: Input: partstatsdb2@testtable2@part1=p11/part2=P12
 POSTHOOK: Input: partstatsdb2@testtable2@part1=p21/part2=P22
@@ -501,14 +501,14 @@ POSTHOOK: Output: partstatsdb2@testtable2
 POSTHOOK: Output: partstatsdb2@testtable2@part1=p11/part2=P12
 POSTHOOK: Output: partstatsdb2@testtable2@part1=p21/part2=P22
 PREHOOK: query: ANALYZE TABLE TESTTABLE2 PARTITION (part1='p11', Part2='P12') COMPUTE STATISTICS FOR COLUMNS key
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: partstatsdb2@testtable2
 PREHOOK: Input: partstatsdb2@testtable2@part1=p11/part2=P12
 #### A masked pattern was here ####
 PREHOOK: Output: partstatsdb2@testtable2
 PREHOOK: Output: partstatsdb2@testtable2@part1=p11/part2=P12
 POSTHOOK: query: ANALYZE TABLE TESTTABLE2 PARTITION (part1='p11', Part2='P12') COMPUTE STATISTICS FOR COLUMNS key
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: partstatsdb2@testtable2
 POSTHOOK: Input: partstatsdb2@testtable2@part1=p11/part2=P12
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/llap/dynamic_semijoin_reduction.q.out b/ql/src/test/results/clientpositive/llap/dynamic_semijoin_reduction.q.out
index c6098202a8..72e34e4780 100644
--- a/ql/src/test/results/clientpositive/llap/dynamic_semijoin_reduction.q.out
+++ b/ql/src/test/results/clientpositive/llap/dynamic_semijoin_reduction.q.out
@@ -103,17 +103,17 @@ POSTHOOK: Output: default@srcpart_small@ds=2008-04-09
 POSTHOOK: Lineage: srcpart_small PARTITION(ds=2008-04-09).key1 SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: srcpart_small PARTITION(ds=2008-04-09).value1 SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: analyze table alltypesorc_int compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@alltypesorc_int
 PREHOOK: Output: default@alltypesorc_int
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table alltypesorc_int compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@alltypesorc_int
 POSTHOOK: Output: default@alltypesorc_int
 #### A masked pattern was here ####
 PREHOOK: query: analyze table srcpart_date compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@srcpart_date
 PREHOOK: Input: default@srcpart_date@ds=2008-04-08
 PREHOOK: Input: default@srcpart_date@ds=2008-04-09
@@ -122,7 +122,7 @@ PREHOOK: Output: default@srcpart_date@ds=2008-04-08
 PREHOOK: Output: default@srcpart_date@ds=2008-04-09
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table srcpart_date compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@srcpart_date
 POSTHOOK: Input: default@srcpart_date@ds=2008-04-08
 POSTHOOK: Input: default@srcpart_date@ds=2008-04-09
@@ -131,7 +131,7 @@ POSTHOOK: Output: default@srcpart_date@ds=2008-04-08
 POSTHOOK: Output: default@srcpart_date@ds=2008-04-09
 #### A masked pattern was here ####
 PREHOOK: query: analyze table srcpart_small compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@srcpart_small
 PREHOOK: Input: default@srcpart_small@ds=2008-04-08
 PREHOOK: Input: default@srcpart_small@ds=2008-04-09
@@ -140,7 +140,7 @@ PREHOOK: Output: default@srcpart_small@ds=2008-04-08
 PREHOOK: Output: default@srcpart_small@ds=2008-04-09
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table srcpart_small compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@srcpart_small
 POSTHOOK: Input: default@srcpart_small@ds=2008-04-08
 POSTHOOK: Input: default@srcpart_small@ds=2008-04-09
@@ -3068,12 +3068,12 @@ POSTHOOK: Lineage: srcpart_small10.ds SIMPLE [(srcpart_small)srcpart_small.Field
 POSTHOOK: Lineage: srcpart_small10.key1 SIMPLE [(srcpart_small)srcpart_small.FieldSchema(name:key1, type:string, comment:null), ]
 POSTHOOK: Lineage: srcpart_small10.value1 SIMPLE [(srcpart_small)srcpart_small.FieldSchema(name:value1, type:string, comment:null), ]
 PREHOOK: query: analyze table srcpart_small10 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@srcpart_small10
 PREHOOK: Output: default@srcpart_small10
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table srcpart_small10 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@srcpart_small10
 POSTHOOK: Output: default@srcpart_small10
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/llap/dynamic_semijoin_reduction_2.q.out b/ql/src/test/results/clientpositive/llap/dynamic_semijoin_reduction_2.q.out
index b720bca0c0..5924743a3b 100644
--- a/ql/src/test/results/clientpositive/llap/dynamic_semijoin_reduction_2.q.out
+++ b/ql/src/test/results/clientpositive/llap/dynamic_semijoin_reduction_2.q.out
@@ -489,12 +489,12 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@tab2
 POSTHOOK: Output: default@tab2
 PREHOOK: query: analyze table tab2 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@tab2
 PREHOOK: Output: default@tab2
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table tab2 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@tab2
 POSTHOOK: Output: default@tab2
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/llap/dynamic_semijoin_reduction_4.q.out b/ql/src/test/results/clientpositive/llap/dynamic_semijoin_reduction_4.q.out
index d33c6cd696..9af2f38f6a 100644
--- a/ql/src/test/results/clientpositive/llap/dynamic_semijoin_reduction_4.q.out
+++ b/ql/src/test/results/clientpositive/llap/dynamic_semijoin_reduction_4.q.out
@@ -171,7 +171,7 @@ POSTHOOK: Output: default@srcpart_small_ext@ds=2008-04-09
 POSTHOOK: Lineage: srcpart_small_ext PARTITION(ds=2008-04-09).key1 SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: srcpart_small_ext PARTITION(ds=2008-04-09).value1 SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: analyze table srcpart_date compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@srcpart_date
 PREHOOK: Input: default@srcpart_date@ds=2008-04-08
 PREHOOK: Input: default@srcpart_date@ds=2008-04-09
@@ -180,7 +180,7 @@ PREHOOK: Output: default@srcpart_date@ds=2008-04-08
 PREHOOK: Output: default@srcpart_date@ds=2008-04-09
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table srcpart_date compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@srcpart_date
 POSTHOOK: Input: default@srcpart_date@ds=2008-04-08
 POSTHOOK: Input: default@srcpart_date@ds=2008-04-09
@@ -189,7 +189,7 @@ POSTHOOK: Output: default@srcpart_date@ds=2008-04-08
 POSTHOOK: Output: default@srcpart_date@ds=2008-04-09
 #### A masked pattern was here ####
 PREHOOK: query: analyze table srcpart_small compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@srcpart_small
 PREHOOK: Input: default@srcpart_small@ds=2008-04-08
 PREHOOK: Input: default@srcpart_small@ds=2008-04-09
@@ -198,7 +198,7 @@ PREHOOK: Output: default@srcpart_small@ds=2008-04-08
 PREHOOK: Output: default@srcpart_small@ds=2008-04-09
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table srcpart_small compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@srcpart_small
 POSTHOOK: Input: default@srcpart_small@ds=2008-04-08
 POSTHOOK: Input: default@srcpart_small@ds=2008-04-09
@@ -207,7 +207,7 @@ POSTHOOK: Output: default@srcpart_small@ds=2008-04-08
 POSTHOOK: Output: default@srcpart_small@ds=2008-04-09
 #### A masked pattern was here ####
 PREHOOK: query: analyze table srcpart_date_ext compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@srcpart_date_ext
 PREHOOK: Input: default@srcpart_date_ext@ds=2008-04-08
 PREHOOK: Input: default@srcpart_date_ext@ds=2008-04-09
@@ -216,7 +216,7 @@ PREHOOK: Output: default@srcpart_date_ext@ds=2008-04-08
 PREHOOK: Output: default@srcpart_date_ext@ds=2008-04-09
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table srcpart_date_ext compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@srcpart_date_ext
 POSTHOOK: Input: default@srcpart_date_ext@ds=2008-04-08
 POSTHOOK: Input: default@srcpart_date_ext@ds=2008-04-09
@@ -225,7 +225,7 @@ POSTHOOK: Output: default@srcpart_date_ext@ds=2008-04-08
 POSTHOOK: Output: default@srcpart_date_ext@ds=2008-04-09
 #### A masked pattern was here ####
 PREHOOK: query: analyze table srcpart_small_ext compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@srcpart_small_ext
 PREHOOK: Input: default@srcpart_small_ext@ds=2008-04-08
 PREHOOK: Input: default@srcpart_small_ext@ds=2008-04-09
@@ -234,7 +234,7 @@ PREHOOK: Output: default@srcpart_small_ext@ds=2008-04-08
 PREHOOK: Output: default@srcpart_small_ext@ds=2008-04-09
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table srcpart_small_ext compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@srcpart_small_ext
 POSTHOOK: Input: default@srcpart_small_ext@ds=2008-04-08
 POSTHOOK: Input: default@srcpart_small_ext@ds=2008-04-09
diff --git a/ql/src/test/results/clientpositive/llap/dynamic_semijoin_reduction_sw.q.out b/ql/src/test/results/clientpositive/llap/dynamic_semijoin_reduction_sw.q.out
index 3cab3b3d81..618f0184f7 100644
--- a/ql/src/test/results/clientpositive/llap/dynamic_semijoin_reduction_sw.q.out
+++ b/ql/src/test/results/clientpositive/llap/dynamic_semijoin_reduction_sw.q.out
@@ -103,17 +103,17 @@ POSTHOOK: Output: default@srcpart_small@ds1=2008-04-09
 POSTHOOK: Lineage: srcpart_small PARTITION(ds1=2008-04-09).key1 SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: srcpart_small PARTITION(ds1=2008-04-09).value1 SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: analyze table alltypesorc_int compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@alltypesorc_int
 PREHOOK: Output: default@alltypesorc_int
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table alltypesorc_int compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@alltypesorc_int
 POSTHOOK: Output: default@alltypesorc_int
 #### A masked pattern was here ####
 PREHOOK: query: analyze table srcpart_date compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@srcpart_date
 PREHOOK: Input: default@srcpart_date@ds=2008-04-08
 PREHOOK: Input: default@srcpart_date@ds=2008-04-09
@@ -122,7 +122,7 @@ PREHOOK: Output: default@srcpart_date@ds=2008-04-08
 PREHOOK: Output: default@srcpart_date@ds=2008-04-09
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table srcpart_date compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@srcpart_date
 POSTHOOK: Input: default@srcpart_date@ds=2008-04-08
 POSTHOOK: Input: default@srcpart_date@ds=2008-04-09
@@ -131,7 +131,7 @@ POSTHOOK: Output: default@srcpart_date@ds=2008-04-08
 POSTHOOK: Output: default@srcpart_date@ds=2008-04-09
 #### A masked pattern was here ####
 PREHOOK: query: analyze table srcpart_small compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@srcpart_small
 PREHOOK: Input: default@srcpart_small@ds1=2008-04-08
 PREHOOK: Input: default@srcpart_small@ds1=2008-04-09
@@ -140,7 +140,7 @@ PREHOOK: Output: default@srcpart_small@ds1=2008-04-08
 PREHOOK: Output: default@srcpart_small@ds1=2008-04-09
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table srcpart_small compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@srcpart_small
 POSTHOOK: Input: default@srcpart_small@ds1=2008-04-08
 POSTHOOK: Input: default@srcpart_small@ds1=2008-04-09
diff --git a/ql/src/test/results/clientpositive/llap/dynamic_semijoin_user_level.q.out b/ql/src/test/results/clientpositive/llap/dynamic_semijoin_user_level.q.out
index 9b73c3440d..2ed71f8ee1 100644
--- a/ql/src/test/results/clientpositive/llap/dynamic_semijoin_user_level.q.out
+++ b/ql/src/test/results/clientpositive/llap/dynamic_semijoin_user_level.q.out
@@ -103,17 +103,17 @@ POSTHOOK: Output: default@srcpart_small@ds=2008-04-09
 POSTHOOK: Lineage: srcpart_small PARTITION(ds=2008-04-09).key1 SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: srcpart_small PARTITION(ds=2008-04-09).value1 SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: analyze table alltypesorc_int compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@alltypesorc_int
 PREHOOK: Output: default@alltypesorc_int
 PREHOOK: Output: hdfs://### HDFS PATH ###
 POSTHOOK: query: analyze table alltypesorc_int compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@alltypesorc_int
 POSTHOOK: Output: default@alltypesorc_int
 POSTHOOK: Output: hdfs://### HDFS PATH ###
 PREHOOK: query: analyze table srcpart_date compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@srcpart_date
 PREHOOK: Input: default@srcpart_date@ds=2008-04-08
 PREHOOK: Input: default@srcpart_date@ds=2008-04-09
@@ -122,7 +122,7 @@ PREHOOK: Output: default@srcpart_date@ds=2008-04-08
 PREHOOK: Output: default@srcpart_date@ds=2008-04-09
 PREHOOK: Output: hdfs://### HDFS PATH ###
 POSTHOOK: query: analyze table srcpart_date compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@srcpart_date
 POSTHOOK: Input: default@srcpart_date@ds=2008-04-08
 POSTHOOK: Input: default@srcpart_date@ds=2008-04-09
@@ -131,7 +131,7 @@ POSTHOOK: Output: default@srcpart_date@ds=2008-04-08
 POSTHOOK: Output: default@srcpart_date@ds=2008-04-09
 POSTHOOK: Output: hdfs://### HDFS PATH ###
 PREHOOK: query: analyze table srcpart_small compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@srcpart_small
 PREHOOK: Input: default@srcpart_small@ds=2008-04-08
 PREHOOK: Input: default@srcpart_small@ds=2008-04-09
@@ -140,7 +140,7 @@ PREHOOK: Output: default@srcpart_small@ds=2008-04-08
 PREHOOK: Output: default@srcpart_small@ds=2008-04-09
 PREHOOK: Output: hdfs://### HDFS PATH ###
 POSTHOOK: query: analyze table srcpart_small compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@srcpart_small
 POSTHOOK: Input: default@srcpart_small@ds=2008-04-08
 POSTHOOK: Input: default@srcpart_small@ds=2008-04-09
diff --git a/ql/src/test/results/clientpositive/llap/explainuser_2.q.out b/ql/src/test/results/clientpositive/llap/explainuser_2.q.out
index ef09e273cc..6d77406d17 100644
--- a/ql/src/test/results/clientpositive/llap/explainuser_2.q.out
+++ b/ql/src/test/results/clientpositive/llap/explainuser_2.q.out
@@ -125,12 +125,12 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@ss
 POSTHOOK: Output: default@ss
 PREHOOK: query: ANALYZE TABLE ss COMPUTE STATISTICS FOR COLUMNS k1,v1,k2,v2,k3,v3
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@ss
 PREHOOK: Output: default@ss
 PREHOOK: Output: hdfs://### HDFS PATH ###
 POSTHOOK: query: ANALYZE TABLE ss COMPUTE STATISTICS FOR COLUMNS k1,v1,k2,v2,k3,v3
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@ss
 POSTHOOK: Output: default@ss
 POSTHOOK: Output: hdfs://### HDFS PATH ###
@@ -143,12 +143,12 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@sr
 POSTHOOK: Output: default@sr
 PREHOOK: query: ANALYZE TABLE sr COMPUTE STATISTICS FOR COLUMNS k1,v1,k2,v2,k3,v3
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@sr
 PREHOOK: Output: default@sr
 PREHOOK: Output: hdfs://### HDFS PATH ###
 POSTHOOK: query: ANALYZE TABLE sr COMPUTE STATISTICS FOR COLUMNS k1,v1,k2,v2,k3,v3
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@sr
 POSTHOOK: Output: default@sr
 POSTHOOK: Output: hdfs://### HDFS PATH ###
@@ -161,12 +161,12 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@cs
 POSTHOOK: Output: default@cs
 PREHOOK: query: ANALYZE TABLE cs COMPUTE STATISTICS FOR COLUMNS k1,v1,k2,v2,k3,v3
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@cs
 PREHOOK: Output: default@cs
 PREHOOK: Output: hdfs://### HDFS PATH ###
 POSTHOOK: query: ANALYZE TABLE cs COMPUTE STATISTICS FOR COLUMNS k1,v1,k2,v2,k3,v3
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@cs
 POSTHOOK: Output: default@cs
 POSTHOOK: Output: hdfs://### HDFS PATH ###
diff --git a/ql/src/test/results/clientpositive/llap/extrapolate_part_stats_partial_ndv.q.out b/ql/src/test/results/clientpositive/llap/extrapolate_part_stats_partial_ndv.q.out
index 2b1ec3c326..3f51e76e31 100644
--- a/ql/src/test/results/clientpositive/llap/extrapolate_part_stats_partial_ndv.q.out
+++ b/ql/src/test/results/clientpositive/llap/extrapolate_part_stats_partial_ndv.q.out
@@ -80,28 +80,28 @@ POSTHOOK: Lineage: loc_orc_1d PARTITION(year=2003).locid SIMPLE [(ext_loc)ext_lo
 POSTHOOK: Lineage: loc_orc_1d PARTITION(year=2003).state SIMPLE [(ext_loc)ext_loc.FieldSchema(name:state, type:string, comment:null), ]
 POSTHOOK: Lineage: loc_orc_1d PARTITION(year=2003).zip SIMPLE [(ext_loc)ext_loc.FieldSchema(name:zip, type:int, comment:null), ]
 PREHOOK: query: analyze table loc_orc_1d partition(year='2001') compute statistics for columns state,locid,cnt,zip
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@loc_orc_1d
 PREHOOK: Input: default@loc_orc_1d@year=2001
 PREHOOK: Output: default@loc_orc_1d
 PREHOOK: Output: default@loc_orc_1d@year=2001
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table loc_orc_1d partition(year='2001') compute statistics for columns state,locid,cnt,zip
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@loc_orc_1d
 POSTHOOK: Input: default@loc_orc_1d@year=2001
 POSTHOOK: Output: default@loc_orc_1d
 POSTHOOK: Output: default@loc_orc_1d@year=2001
 #### A masked pattern was here ####
 PREHOOK: query: analyze table loc_orc_1d partition(year='2002') compute statistics for columns state,locid,cnt,zip
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@loc_orc_1d
 PREHOOK: Input: default@loc_orc_1d@year=2002
 PREHOOK: Output: default@loc_orc_1d
 PREHOOK: Output: default@loc_orc_1d@year=2002
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table loc_orc_1d partition(year='2002') compute statistics for columns state,locid,cnt,zip
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@loc_orc_1d
 POSTHOOK: Input: default@loc_orc_1d@year=2002
 POSTHOOK: Output: default@loc_orc_1d
@@ -457,28 +457,28 @@ STAGE PLANS:
             ListSink
 
 PREHOOK: query: analyze table loc_orc_1d partition(year='2000') compute statistics for columns state,locid,cnt,zip
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@loc_orc_1d
 PREHOOK: Input: default@loc_orc_1d@year=2000
 PREHOOK: Output: default@loc_orc_1d
 PREHOOK: Output: default@loc_orc_1d@year=2000
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table loc_orc_1d partition(year='2000') compute statistics for columns state,locid,cnt,zip
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@loc_orc_1d
 POSTHOOK: Input: default@loc_orc_1d@year=2000
 POSTHOOK: Output: default@loc_orc_1d
 POSTHOOK: Output: default@loc_orc_1d@year=2000
 #### A masked pattern was here ####
 PREHOOK: query: analyze table loc_orc_1d partition(year='2003') compute statistics for columns state,locid,cnt,zip
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@loc_orc_1d
 PREHOOK: Input: default@loc_orc_1d@year=2003
 PREHOOK: Output: default@loc_orc_1d
 PREHOOK: Output: default@loc_orc_1d@year=2003
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table loc_orc_1d partition(year='2003') compute statistics for columns state,locid,cnt,zip
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@loc_orc_1d
 POSTHOOK: Input: default@loc_orc_1d@year=2003
 POSTHOOK: Output: default@loc_orc_1d
@@ -905,28 +905,28 @@ POSTHOOK: Lineage: loc_orc_2d PARTITION(zip=94087,year=2003).cnt SIMPLE [(ext_lo
 POSTHOOK: Lineage: loc_orc_2d PARTITION(zip=94087,year=2003).locid EXPRESSION [(ext_loc)ext_loc.FieldSchema(name:locid, type:double, comment:null), ]
 POSTHOOK: Lineage: loc_orc_2d PARTITION(zip=94087,year=2003).state SIMPLE [(ext_loc)ext_loc.FieldSchema(name:state, type:string, comment:null), ]
 PREHOOK: query: analyze table loc_orc_2d partition(zip=94086, year='2001') compute statistics for columns state,locid,cnt
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@loc_orc_2d
 PREHOOK: Input: default@loc_orc_2d@zip=94086/year=2001
 PREHOOK: Output: default@loc_orc_2d
 PREHOOK: Output: default@loc_orc_2d@zip=94086/year=2001
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table loc_orc_2d partition(zip=94086, year='2001') compute statistics for columns state,locid,cnt
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@loc_orc_2d
 POSTHOOK: Input: default@loc_orc_2d@zip=94086/year=2001
 POSTHOOK: Output: default@loc_orc_2d
 POSTHOOK: Output: default@loc_orc_2d@zip=94086/year=2001
 #### A masked pattern was here ####
 PREHOOK: query: analyze table loc_orc_2d partition(zip=94087, year='2002') compute statistics for columns state,locid,cnt
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@loc_orc_2d
 PREHOOK: Input: default@loc_orc_2d@zip=94087/year=2002
 PREHOOK: Output: default@loc_orc_2d
 PREHOOK: Output: default@loc_orc_2d@zip=94087/year=2002
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table loc_orc_2d partition(zip=94087, year='2002') compute statistics for columns state,locid,cnt
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@loc_orc_2d
 POSTHOOK: Input: default@loc_orc_2d@zip=94087/year=2002
 POSTHOOK: Output: default@loc_orc_2d
diff --git a/ql/src/test/results/clientpositive/llap/llap_stats.q.out b/ql/src/test/results/clientpositive/llap/llap_stats.q.out
index 6c139c72b7..87cf04fdb3 100644
--- a/ql/src/test/results/clientpositive/llap/llap_stats.q.out
+++ b/ql/src/test/results/clientpositive/llap/llap_stats.q.out
@@ -88,9 +88,9 @@ POSTHOOK: Output: hdfs://### HDFS PATH ###
 -17	31	4963
 -17	29	7021
 PREHOOK: query: explain analyze table llap_stats partition (cint) compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 POSTHOOK: query: explain analyze table llap_stats partition (cint) compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-2 depends on stages: Stage-0
@@ -156,7 +156,7 @@ STAGE PLANS:
           Table: default.llap_stats
 
 PREHOOK: query: analyze table llap_stats partition (cint) compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@llap_stats
 PREHOOK: Input: default@llap_stats@cint=-13326
 PREHOOK: Input: default@llap_stats@cint=-15431
@@ -181,7 +181,7 @@ PREHOOK: Output: default@llap_stats@cint=4963
 PREHOOK: Output: default@llap_stats@cint=7021
 PREHOOK: Output: hdfs://### HDFS PATH ###
 POSTHOOK: query: analyze table llap_stats partition (cint) compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@llap_stats
 POSTHOOK: Input: default@llap_stats@cint=-13326
 POSTHOOK: Input: default@llap_stats@cint=-15431
diff --git a/ql/src/test/results/clientpositive/llap/llapdecider.q.out b/ql/src/test/results/clientpositive/llap/llapdecider.q.out
index 1ef9267d89..b13134f7ba 100644
--- a/ql/src/test/results/clientpositive/llap/llapdecider.q.out
+++ b/ql/src/test/results/clientpositive/llap/llapdecider.q.out
@@ -234,12 +234,12 @@ STAGE PLANS:
         ListSink
 
 PREHOOK: query: analyze table src_orc compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@src_orc
 PREHOOK: Output: default@src_orc
 PREHOOK: Output: hdfs://### HDFS PATH ###
 POSTHOOK: query: analyze table src_orc compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@src_orc
 POSTHOOK: Output: default@src_orc
 POSTHOOK: Output: hdfs://### HDFS PATH ###
diff --git a/ql/src/test/results/clientpositive/llap/mapjoin_hint.q.out b/ql/src/test/results/clientpositive/llap/mapjoin_hint.q.out
index 3751b1589d..a44dcb307b 100644
--- a/ql/src/test/results/clientpositive/llap/mapjoin_hint.q.out
+++ b/ql/src/test/results/clientpositive/llap/mapjoin_hint.q.out
@@ -85,7 +85,7 @@ POSTHOOK: Output: default@srcpart_small@ds=2008-04-09
 POSTHOOK: Lineage: srcpart_small PARTITION(ds=2008-04-09).key1 SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: srcpart_small PARTITION(ds=2008-04-09).value1 SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: analyze table srcpart_date compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@srcpart_date
 PREHOOK: Input: default@srcpart_date@ds=2008-04-08
 PREHOOK: Input: default@srcpart_date@ds=2008-04-09
@@ -94,7 +94,7 @@ PREHOOK: Output: default@srcpart_date@ds=2008-04-08
 PREHOOK: Output: default@srcpart_date@ds=2008-04-09
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table srcpart_date compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@srcpart_date
 POSTHOOK: Input: default@srcpart_date@ds=2008-04-08
 POSTHOOK: Input: default@srcpart_date@ds=2008-04-09
@@ -103,7 +103,7 @@ POSTHOOK: Output: default@srcpart_date@ds=2008-04-08
 POSTHOOK: Output: default@srcpart_date@ds=2008-04-09
 #### A masked pattern was here ####
 PREHOOK: query: analyze table srcpart_small compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@srcpart_small
 PREHOOK: Input: default@srcpart_small@ds=2008-04-08
 PREHOOK: Input: default@srcpart_small@ds=2008-04-09
@@ -112,7 +112,7 @@ PREHOOK: Output: default@srcpart_small@ds=2008-04-08
 PREHOOK: Output: default@srcpart_small@ds=2008-04-09
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table srcpart_small compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@srcpart_small
 POSTHOOK: Input: default@srcpart_small@ds=2008-04-08
 POSTHOOK: Input: default@srcpart_small@ds=2008-04-09
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite.q.out
index 654a15cb43..fa7dc27182 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite.q.out
@@ -29,12 +29,12 @@ POSTHOOK: Lineage: cmv_basetable.b SCRIPT []
 POSTHOOK: Lineage: cmv_basetable.c SCRIPT []
 POSTHOOK: Lineage: cmv_basetable.d SCRIPT []
 PREHOOK: query: analyze table cmv_basetable compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@cmv_basetable
 PREHOOK: Output: default@cmv_basetable
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table cmv_basetable compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@cmv_basetable
 POSTHOOK: Output: default@cmv_basetable
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_2.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_2.q.out
index 66431a5ba5..0bd74dda37 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_2.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_2.q.out
@@ -29,12 +29,12 @@ POSTHOOK: Lineage: cmv_basetable.b SCRIPT []
 POSTHOOK: Lineage: cmv_basetable.c SCRIPT []
 POSTHOOK: Lineage: cmv_basetable.d SCRIPT []
 PREHOOK: query: analyze table cmv_basetable compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@cmv_basetable
 PREHOOK: Output: default@cmv_basetable
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table cmv_basetable compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@cmv_basetable
 POSTHOOK: Output: default@cmv_basetable
 #### A masked pattern was here ####
@@ -423,12 +423,12 @@ POSTHOOK: Lineage: cmv_basetable_2.b SCRIPT []
 POSTHOOK: Lineage: cmv_basetable_2.c SCRIPT []
 POSTHOOK: Lineage: cmv_basetable_2.d SCRIPT []
 PREHOOK: query: analyze table cmv_basetable_2 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@cmv_basetable_2
 PREHOOK: Output: default@cmv_basetable_2
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table cmv_basetable_2 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@cmv_basetable_2
 POSTHOOK: Output: default@cmv_basetable_2
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_3.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_3.q.out
index dad8ebe871..cca7d9f2d6 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_3.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_3.q.out
@@ -29,12 +29,12 @@ POSTHOOK: Lineage: cmv_basetable.b SCRIPT []
 POSTHOOK: Lineage: cmv_basetable.c SCRIPT []
 POSTHOOK: Lineage: cmv_basetable.d SCRIPT []
 PREHOOK: query: analyze table cmv_basetable compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@cmv_basetable
 PREHOOK: Output: default@cmv_basetable
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table cmv_basetable compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@cmv_basetable
 POSTHOOK: Output: default@cmv_basetable
 #### A masked pattern was here ####
@@ -63,12 +63,12 @@ POSTHOOK: Lineage: cmv_basetable_2.b SCRIPT []
 POSTHOOK: Lineage: cmv_basetable_2.c SCRIPT []
 POSTHOOK: Lineage: cmv_basetable_2.d SCRIPT []
 PREHOOK: query: analyze table cmv_basetable_2 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@cmv_basetable_2
 PREHOOK: Output: default@cmv_basetable_2
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table cmv_basetable_2 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@cmv_basetable_2
 POSTHOOK: Output: default@cmv_basetable_2
 #### A masked pattern was here ####
@@ -295,12 +295,12 @@ POSTHOOK: Lineage: cmv_basetable_2.b SCRIPT []
 POSTHOOK: Lineage: cmv_basetable_2.c SCRIPT []
 POSTHOOK: Lineage: cmv_basetable_2.d SCRIPT []
 PREHOOK: query: analyze table cmv_basetable_2 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@cmv_basetable_2
 PREHOOK: Output: default@cmv_basetable_2
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table cmv_basetable_2 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@cmv_basetable_2
 POSTHOOK: Output: default@cmv_basetable_2
 #### A masked pattern was here ####
@@ -914,12 +914,12 @@ POSTHOOK: Lineage: cmv_irrelevant_table.b SCRIPT []
 POSTHOOK: Lineage: cmv_irrelevant_table.c SCRIPT []
 POSTHOOK: Lineage: cmv_irrelevant_table.d SCRIPT []
 PREHOOK: query: analyze table cmv_irrelevant_table compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@cmv_irrelevant_table
 PREHOOK: Output: default@cmv_irrelevant_table
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table cmv_irrelevant_table compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@cmv_irrelevant_table
 POSTHOOK: Output: default@cmv_irrelevant_table
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_4.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_4.q.out
index 918ceaadd9..c0862b070e 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_4.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_4.q.out
@@ -29,12 +29,12 @@ POSTHOOK: Lineage: cmv_basetable.b SCRIPT []
 POSTHOOK: Lineage: cmv_basetable.c SCRIPT []
 POSTHOOK: Lineage: cmv_basetable.d SCRIPT []
 PREHOOK: query: analyze table cmv_basetable compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@cmv_basetable
 PREHOOK: Output: default@cmv_basetable
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table cmv_basetable compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@cmv_basetable
 POSTHOOK: Output: default@cmv_basetable
 #### A masked pattern was here ####
@@ -63,12 +63,12 @@ POSTHOOK: Lineage: cmv_basetable_2.b SCRIPT []
 POSTHOOK: Lineage: cmv_basetable_2.c SCRIPT []
 POSTHOOK: Lineage: cmv_basetable_2.d SCRIPT []
 PREHOOK: query: analyze table cmv_basetable_2 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@cmv_basetable_2
 PREHOOK: Output: default@cmv_basetable_2
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table cmv_basetable_2 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@cmv_basetable_2
 POSTHOOK: Output: default@cmv_basetable_2
 #### A masked pattern was here ####
@@ -236,12 +236,12 @@ POSTHOOK: Input: default@cmv_basetable_2
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cmv_mat_view
 PREHOOK: query: analyze table cmv_mat_view compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@cmv_mat_view
 PREHOOK: Output: default@cmv_mat_view
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table cmv_mat_view compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@cmv_mat_view
 POSTHOOK: Output: default@cmv_mat_view
 #### A masked pattern was here ####
@@ -439,12 +439,12 @@ POSTHOOK: Lineage: cmv_basetable_2.b SCRIPT []
 POSTHOOK: Lineage: cmv_basetable_2.c SCRIPT []
 POSTHOOK: Lineage: cmv_basetable_2.d SCRIPT []
 PREHOOK: query: analyze table cmv_basetable_2 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@cmv_basetable_2
 PREHOOK: Output: default@cmv_basetable_2
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table cmv_basetable_2 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@cmv_basetable_2
 POSTHOOK: Output: default@cmv_basetable_2
 #### A masked pattern was here ####
@@ -659,47 +659,22 @@ POSTHOOK: query: EXPLAIN
 ALTER MATERIALIZED VIEW cmv_mat_view REBUILD
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
-  Stage-2 is a root stage
-  Stage-3 depends on stages: Stage-2
-  Stage-0 depends on stages: Stage-3
-  Stage-4 depends on stages: Stage-0
-  Stage-6 depends on stages: Stage-4, Stage-5
-  Stage-1 depends on stages: Stage-3
-  Stage-5 depends on stages: Stage-1
+  Stage-1 is a root stage
+  Stage-2 depends on stages: Stage-1
+  Stage-0 depends on stages: Stage-2
+  Stage-3 depends on stages: Stage-0
+  Stage-4 depends on stages: Stage-3
 
 STAGE PLANS:
-  Stage: Stage-2
+  Stage: Stage-1
     Tez
 #### A masked pattern was here ####
       Edges:
-        Reducer 2 <- Map 1 (SIMPLE_EDGE), Reducer 7 (ONE_TO_ONE_EDGE)
-        Reducer 3 <- Reducer 2 (CUSTOM_SIMPLE_EDGE)
-        Reducer 4 <- Reducer 2 (SIMPLE_EDGE)
-        Reducer 6 <- Map 5 (SIMPLE_EDGE), Map 8 (SIMPLE_EDGE)
-        Reducer 7 <- Reducer 6 (SIMPLE_EDGE)
+        Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 4 (SIMPLE_EDGE)
+        Reducer 3 <- Reducer 2 (SIMPLE_EDGE)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
-            Map Operator Tree:
-                TableScan
-                  alias: default.cmv_mat_view
-                  Statistics: Num rows: 2 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
-                  Filter Operator
-                    predicate: ((c > 10) and a is not null) (type: boolean)
-                    Statistics: Num rows: 1 Data size: 124 Basic stats: COMPLETE Column stats: COMPLETE
-                    Select Operator
-                      expressions: a (type: int), c (type: decimal(10,2)), _c2 (type: bigint), ROW__ID (type: struct<writeid:bigint,bucketid:int,rowid:bigint>)
-                      outputColumnNames: _col0, _col1, _col2, _col3
-                      Statistics: Num rows: 1 Data size: 200 Basic stats: COMPLETE Column stats: COMPLETE
-                      Reduce Output Operator
-                        key expressions: _col0 (type: int), _col1 (type: decimal(10,2))
-                        sort order: ++
-                        Map-reduce partition columns: _col0 (type: int), _col1 (type: decimal(10,2))
-                        Statistics: Num rows: 1 Data size: 200 Basic stats: COMPLETE Column stats: COMPLETE
-                        value expressions: _col2 (type: bigint), _col3 (type: struct<writeid:bigint,bucketid:int,rowid:bigint>)
-            Execution mode: llap
-            LLAP IO: may be used (ACID table)
-        Map 5 
             Map Operator Tree:
                 TableScan
                   alias: cmv_basetable
@@ -718,110 +693,27 @@ STAGE PLANS:
                         Statistics: Num rows: 5 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
             Execution mode: llap
             LLAP IO: may be used (ACID table)
-        Map 8 
+        Map 4 
             Map Operator Tree:
                 TableScan
                   alias: cmv_basetable_2
                   Statistics: Num rows: 3 Data size: 360 Basic stats: COMPLETE Column stats: COMPLETE
                   Filter Operator
-                    predicate: ((ROW__ID.writeid > 1) and (c > 10) and a is not null) (type: boolean)
+                    predicate: ((c > 10) and a is not null) (type: boolean)
                     Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                     Select Operator
                       expressions: a (type: int), c (type: decimal(10,2)), d (type: int)
                       outputColumnNames: _col0, _col1, _col2
-                      Statistics: Num rows: 1 Data size: 196 Basic stats: COMPLETE Column stats: COMPLETE
+                      Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                       Reduce Output Operator
                         key expressions: _col0 (type: int)
                         sort order: +
                         Map-reduce partition columns: _col0 (type: int)
-                        Statistics: Num rows: 1 Data size: 196 Basic stats: COMPLETE Column stats: COMPLETE
+                        Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                         value expressions: _col1 (type: decimal(10,2)), _col2 (type: int)
             Execution mode: llap
             LLAP IO: may be used (ACID table)
         Reducer 2 
-            Execution mode: llap
-            Reduce Operator Tree:
-              Merge Join Operator
-                condition map:
-                     Right Outer Join 0 to 1
-                keys:
-                  0 _col0 (type: int), _col1 (type: decimal(10,2))
-                  1 _col0 (type: int), _col1 (type: decimal(10,2))
-                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
-                Statistics: Num rows: 1 Data size: 324 Basic stats: COMPLETE Column stats: COMPLETE
-                Filter Operator
-                  predicate: (_col0 is null and _col1 is null) (type: boolean)
-                  Statistics: Num rows: 1 Data size: 324 Basic stats: COMPLETE Column stats: COMPLETE
-                  Select Operator
-                    expressions: _col4 (type: int), _col5 (type: decimal(10,2)), CASE WHEN ((_col0 is null and _col1 is null)) THEN (_col6) ELSE ((_col6 + _col2)) END (type: bigint)
-                    outputColumnNames: _col0, _col1, _col2
-                    Statistics: Num rows: 1 Data size: 124 Basic stats: COMPLETE Column stats: COMPLETE
-                    File Output Operator
-                      compressed: false
-                      Statistics: Num rows: 1 Data size: 124 Basic stats: COMPLETE Column stats: COMPLETE
-                      table:
-                          input format: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
-                          output format: org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat
-                          serde: org.apache.hadoop.hive.ql.io.orc.OrcSerde
-                          name: default.cmv_mat_view
-                      Write Type: INSERT
-                    Select Operator
-                      expressions: _col0 (type: int), _col1 (type: decimal(10,2)), _col2 (type: bigint)
-                      outputColumnNames: a, c, _c2
-                      Statistics: Num rows: 1 Data size: 124 Basic stats: COMPLETE Column stats: COMPLETE
-                      Group By Operator
-                        aggregations: compute_stats(a, 'hll'), compute_stats(c, 'hll'), compute_stats(_c2, 'hll')
-                        mode: hash
-                        outputColumnNames: _col0, _col1, _col2
-                        Statistics: Num rows: 1 Data size: 1480 Basic stats: COMPLETE Column stats: COMPLETE
-                        Reduce Output Operator
-                          sort order: 
-                          Statistics: Num rows: 1 Data size: 1480 Basic stats: COMPLETE Column stats: COMPLETE
-                          value expressions: _col0 (type: struct<columntype:string,min:bigint,max:bigint,countnulls:bigint,bitvector:binary>), _col1 (type: struct<columntype:string,min:decimal(10,2),max:decimal(10,2),countnulls:bigint,bitvector:binary>), _col2 (type: struct<columntype:string,min:bigint,max:bigint,countnulls:bigint,bitvector:binary>)
-                Filter Operator
-                  predicate: ((_col0 = _col4) and (_col1 = _col5)) (type: boolean)
-                  Statistics: Num rows: 1 Data size: 324 Basic stats: COMPLETE Column stats: COMPLETE
-                  Select Operator
-                    expressions: _col3 (type: struct<writeid:bigint,bucketid:int,rowid:bigint>), _col4 (type: int), _col5 (type: decimal(10,2)), CASE WHEN ((_col0 is null and _col1 is null)) THEN (_col6) ELSE ((_col6 + _col2)) END (type: bigint)
-                    outputColumnNames: _col0, _col1, _col2, _col3
-                    Statistics: Num rows: 1 Data size: 200 Basic stats: COMPLETE Column stats: COMPLETE
-                    Reduce Output Operator
-                      key expressions: _col0 (type: struct<writeid:bigint,bucketid:int,rowid:bigint>)
-                      sort order: +
-                      Statistics: Num rows: 1 Data size: 200 Basic stats: COMPLETE Column stats: COMPLETE
-                      value expressions: _col1 (type: int), _col2 (type: decimal(10,2)), _col3 (type: bigint)
-        Reducer 3 
-            Execution mode: llap
-            Reduce Operator Tree:
-              Group By Operator
-                aggregations: compute_stats(VALUE._col0), compute_stats(VALUE._col1), compute_stats(VALUE._col2)
-                mode: mergepartial
-                outputColumnNames: _col0, _col1, _col2
-                Statistics: Num rows: 1 Data size: 1528 Basic stats: COMPLETE Column stats: COMPLETE
-                File Output Operator
-                  compressed: false
-                  Statistics: Num rows: 1 Data size: 1528 Basic stats: COMPLETE Column stats: COMPLETE
-                  table:
-                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
-                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
-                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-        Reducer 4 
-            Execution mode: llap
-            Reduce Operator Tree:
-              Select Operator
-                expressions: KEY.reducesinkkey0 (type: struct<writeid:bigint,bucketid:int,rowid:bigint>), VALUE._col0 (type: int), VALUE._col1 (type: decimal(10,2)), VALUE._col2 (type: bigint)
-                outputColumnNames: _col0, _col1, _col2, _col3
-                Statistics: Num rows: 1 Data size: 200 Basic stats: COMPLETE Column stats: COMPLETE
-                File Output Operator
-                  compressed: false
-                  Statistics: Num rows: 1 Data size: 200 Basic stats: COMPLETE Column stats: COMPLETE
-                  table:
-                      input format: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
-                      output format: org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat
-                      serde: org.apache.hadoop.hive.ql.io.orc.OrcSerde
-                      name: default.cmv_mat_view
-                  Write Type: UPDATE
-        Reducer 6 
             Execution mode: llap
             Reduce Operator Tree:
               Merge Join Operator
@@ -844,7 +736,7 @@ STAGE PLANS:
                     Map-reduce partition columns: _col0 (type: int), _col1 (type: decimal(10,2))
                     Statistics: Num rows: 1 Data size: 124 Basic stats: COMPLETE Column stats: COMPLETE
                     value expressions: _col2 (type: bigint)
-        Reducer 7 
+        Reducer 3 
             Execution mode: llap
             Reduce Operator Tree:
               Group By Operator
@@ -853,14 +745,37 @@ STAGE PLANS:
                 mode: mergepartial
                 outputColumnNames: _col0, _col1, _col2
                 Statistics: Num rows: 1 Data size: 124 Basic stats: COMPLETE Column stats: COMPLETE
-                Reduce Output Operator
-                  key expressions: _col0 (type: int), _col1 (type: decimal(10,2))
-                  sort order: ++
-                  Map-reduce partition columns: _col0 (type: int), _col1 (type: decimal(10,2))
+                File Output Operator
+                  compressed: false
                   Statistics: Num rows: 1 Data size: 124 Basic stats: COMPLETE Column stats: COMPLETE
-                  value expressions: _col2 (type: bigint)
+                  table:
+                      input format: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat
+                      serde: org.apache.hadoop.hive.ql.io.orc.OrcSerde
+                      name: default.cmv_mat_view
+                  Write Type: INSERT
+                Select Operator
+                  expressions: _col0 (type: int), _col1 (type: decimal(10,2)), _col2 (type: bigint)
+                  outputColumnNames: a, c, _c2
+                  Statistics: Num rows: 1 Data size: 124 Basic stats: COMPLETE Column stats: COMPLETE
+                  Group By Operator
+                    aggregations: compute_stats(a, 'hll'), compute_stats(c, 'hll'), compute_stats(_c2, 'hll')
+                    mode: complete
+                    outputColumnNames: _col0, _col1, _col2
+                    Statistics: Num rows: 1 Data size: 1480 Basic stats: COMPLETE Column stats: COMPLETE
+                    Select Operator
+                      expressions: _col0 (type: struct<columntype:string,min:bigint,max:bigint,countnulls:bigint,numdistinctvalues:bigint,ndvbitvector:binary>), _col1 (type: struct<columntype:string,min:decimal(10,2),max:decimal(10,2),countnulls:bigint,numdistinctvalues:bigint,ndvbitvector:binary>), _col2 (type: struct<columntype:string,min:bigint,max:bigint,countnulls:bigint,numdistinctvalues:bigint,ndvbitvector:binary>)
+                      outputColumnNames: _col0, _col1, _col2
+                      Statistics: Num rows: 1 Data size: 1480 Basic stats: COMPLETE Column stats: COMPLETE
+                      File Output Operator
+                        compressed: false
+                        Statistics: Num rows: 1 Data size: 1480 Basic stats: COMPLETE Column stats: COMPLETE
+                        table:
+                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+                            serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
 
-  Stage: Stage-3
+  Stage: Stage-2
     Dependency Collection
 
   Stage: Stage-0
@@ -874,25 +789,7 @@ STAGE PLANS:
               name: default.cmv_mat_view
           Write Type: INSERT
 
-  Stage: Stage-4
-    Stats Work
-      Basic Stats Work:
-
-  Stage: Stage-6
-    Materialized View Work
-
-  Stage: Stage-1
-    Move Operator
-      tables:
-          replace: false
-          table:
-              input format: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
-              output format: org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat
-              serde: org.apache.hadoop.hive.ql.io.orc.OrcSerde
-              name: default.cmv_mat_view
-          Write Type: UPDATE
-
-  Stage: Stage-5
+  Stage: Stage-3
     Stats Work
       Basic Stats Work:
       Column Stats Desc:
@@ -900,21 +797,20 @@ STAGE PLANS:
           Column Types: int, decimal(10,2), bigint
           Table: default.cmv_mat_view
 
+  Stage: Stage-4
+    Materialized View Work
+
 PREHOOK: query: ALTER MATERIALIZED VIEW cmv_mat_view REBUILD
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cmv_basetable
 PREHOOK: Input: default@cmv_basetable_2
-PREHOOK: Input: default@cmv_mat_view
-PREHOOK: Output: default@cmv_mat_view
 PREHOOK: Output: default@cmv_mat_view
 POSTHOOK: query: ALTER MATERIALIZED VIEW cmv_mat_view REBUILD
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@cmv_basetable
 POSTHOOK: Input: default@cmv_basetable_2
-POSTHOOK: Input: default@cmv_mat_view
-POSTHOOK: Output: default@cmv_mat_view
 POSTHOOK: Output: default@cmv_mat_view
-POSTHOOK: Lineage: cmv_mat_view._c2 EXPRESSION [(cmv_mat_view)default.cmv_mat_view.FieldSchema(name:a, type:int, comment:null), (cmv_mat_view)default.cmv_mat_view.FieldSchema(name:c, type:decimal(10,2), comment:null), (cmv_basetable_2)cmv_basetable_2.FieldSchema(name:d, type:int, comment:null), (cmv_mat_view)default.cmv_mat_view.FieldSchema(name:_c2, type:bigint, comment:null), ]
+POSTHOOK: Lineage: cmv_mat_view._c2 EXPRESSION [(cmv_basetable_2)cmv_basetable_2.FieldSchema(name:d, type:int, comment:null), ]
 POSTHOOK: Lineage: cmv_mat_view.a SIMPLE [(cmv_basetable)cmv_basetable.FieldSchema(name:a, type:int, comment:null), ]
 POSTHOOK: Lineage: cmv_mat_view.c SIMPLE [(cmv_basetable_2)cmv_basetable_2.FieldSchema(name:c, type:decimal(10,2), comment:null), ]
 PREHOOK: query: DESCRIBE FORMATTED cmv_mat_view
@@ -935,9 +831,12 @@ Retention:          	0
 #### A masked pattern was here ####
 Table Type:         	MATERIALIZED_VIEW   	 
 Table Parameters:	 	 
+	COLUMN_STATS_ACCURATE	{\"COLUMN_STATS\":{\"_c2\":\"true\",\"a\":\"true\",\"c\":\"true\"}}
 	bucketing_version   	2                   
-	numFiles            	3                   
-	totalSize           	1451                
+	numFiles            	1                   
+	numRows             	3                   
+	rawDataSize         	0                   
+	totalSize           	805                 
 	transactional       	true                
 	transactional_properties	default             
 #### A masked pattern was here ####
@@ -974,21 +873,106 @@ WHERE cmv_basetable_2.c > 10.10
 GROUP BY cmv_basetable.a, cmv_basetable_2.c
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
-  Stage-0 is a root stage
+  Stage-1 is a root stage
+  Stage-0 depends on stages: Stage-1
 
 STAGE PLANS:
+  Stage: Stage-1
+    Tez
+#### A masked pattern was here ####
+      Edges:
+        Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 4 (SIMPLE_EDGE)
+        Reducer 3 <- Reducer 2 (SIMPLE_EDGE)
+#### A masked pattern was here ####
+      Vertices:
+        Map 1 
+            Map Operator Tree:
+                TableScan
+                  alias: cmv_basetable
+                  Statistics: Num rows: 5 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
+                  Filter Operator
+                    predicate: a is not null (type: boolean)
+                    Statistics: Num rows: 5 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
+                    Select Operator
+                      expressions: a (type: int)
+                      outputColumnNames: _col0
+                      Statistics: Num rows: 5 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
+                      Reduce Output Operator
+                        key expressions: _col0 (type: int)
+                        sort order: +
+                        Map-reduce partition columns: _col0 (type: int)
+                        Statistics: Num rows: 5 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
+            Execution mode: llap
+            LLAP IO: may be used (ACID table)
+        Map 4 
+            Map Operator Tree:
+                TableScan
+                  alias: cmv_basetable_2
+                  Statistics: Num rows: 3 Data size: 360 Basic stats: COMPLETE Column stats: COMPLETE
+                  Filter Operator
+                    predicate: ((c > 10.1) and a is not null) (type: boolean)
+                    Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
+                    Select Operator
+                      expressions: a (type: int), c (type: decimal(10,2)), d (type: int)
+                      outputColumnNames: _col0, _col1, _col2
+                      Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
+                      Reduce Output Operator
+                        key expressions: _col0 (type: int)
+                        sort order: +
+                        Map-reduce partition columns: _col0 (type: int)
+                        Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
+                        value expressions: _col1 (type: decimal(10,2)), _col2 (type: int)
+            Execution mode: llap
+            LLAP IO: may be used (ACID table)
+        Reducer 2 
+            Execution mode: llap
+            Reduce Operator Tree:
+              Merge Join Operator
+                condition map:
+                     Inner Join 0 to 1
+                keys:
+                  0 _col0 (type: int)
+                  1 _col0 (type: int)
+                outputColumnNames: _col0, _col2, _col3
+                Statistics: Num rows: 2 Data size: 240 Basic stats: COMPLETE Column stats: COMPLETE
+                Group By Operator
+                  aggregations: sum(_col3)
+                  keys: _col0 (type: int), _col2 (type: decimal(10,2))
+                  mode: hash
+                  outputColumnNames: _col0, _col1, _col2
+                  Statistics: Num rows: 1 Data size: 124 Basic stats: COMPLETE Column stats: COMPLETE
+                  Reduce Output Operator
+                    key expressions: _col0 (type: int), _col1 (type: decimal(10,2))
+                    sort order: ++
+                    Map-reduce partition columns: _col0 (type: int), _col1 (type: decimal(10,2))
+                    Statistics: Num rows: 1 Data size: 124 Basic stats: COMPLETE Column stats: COMPLETE
+                    value expressions: _col2 (type: bigint)
+        Reducer 3 
+            Execution mode: llap
+            Reduce Operator Tree:
+              Group By Operator
+                aggregations: sum(VALUE._col0)
+                keys: KEY._col0 (type: int), KEY._col1 (type: decimal(10,2))
+                mode: mergepartial
+                outputColumnNames: _col0, _col1, _col2
+                Statistics: Num rows: 1 Data size: 124 Basic stats: COMPLETE Column stats: COMPLETE
+                Select Operator
+                  expressions: _col0 (type: int), _col2 (type: bigint)
+                  outputColumnNames: _col0, _col1
+                  Statistics: Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: COMPLETE
+                  File Output Operator
+                    compressed: false
+                    Statistics: Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: COMPLETE
+                    table:
+                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+
   Stage: Stage-0
     Fetch Operator
       limit: -1
       Processor Tree:
-        TableScan
-          alias: default.cmv_mat_view
-          Filter Operator
-            predicate: (c > 10.1) (type: boolean)
-            Select Operator
-              expressions: a (type: int), _c2 (type: bigint)
-              outputColumnNames: _col0, _col1
-              ListSink
+        ListSink
 
 PREHOOK: query: SELECT cmv_basetable.a, sum(cmv_basetable_2.d)
 FROM cmv_basetable JOIN cmv_basetable_2 ON (cmv_basetable.a = cmv_basetable_2.a)
@@ -997,7 +981,6 @@ GROUP BY cmv_basetable.a, cmv_basetable_2.c
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cmv_basetable
 PREHOOK: Input: default@cmv_basetable_2
-PREHOOK: Input: default@cmv_mat_view
 #### A masked pattern was here ####
 POSTHOOK: query: SELECT cmv_basetable.a, sum(cmv_basetable_2.d)
 FROM cmv_basetable JOIN cmv_basetable_2 ON (cmv_basetable.a = cmv_basetable_2.a)
@@ -1006,11 +989,10 @@ GROUP BY cmv_basetable.a, cmv_basetable_2.c
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@cmv_basetable
 POSTHOOK: Input: default@cmv_basetable_2
-POSTHOOK: Input: default@cmv_mat_view
 #### A masked pattern was here ####
 1	2
-3	6
 3	2
+3	6
 PREHOOK: query: UPDATE cmv_basetable_2 SET a=2 WHERE a=1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cmv_basetable_2
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_5.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_5.q.out
index 4a3fba920c..c292baa682 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_5.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_5.q.out
@@ -29,12 +29,12 @@ POSTHOOK: Lineage: cmv_basetable.b SCRIPT []
 POSTHOOK: Lineage: cmv_basetable.c SCRIPT []
 POSTHOOK: Lineage: cmv_basetable.d SCRIPT []
 PREHOOK: query: analyze table cmv_basetable compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@cmv_basetable
 PREHOOK: Output: default@cmv_basetable
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table cmv_basetable compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@cmv_basetable
 POSTHOOK: Output: default@cmv_basetable
 #### A masked pattern was here ####
@@ -63,12 +63,12 @@ POSTHOOK: Lineage: cmv_basetable_2.b SCRIPT []
 POSTHOOK: Lineage: cmv_basetable_2.c SCRIPT []
 POSTHOOK: Lineage: cmv_basetable_2.d SCRIPT []
 PREHOOK: query: analyze table cmv_basetable_2 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@cmv_basetable_2
 PREHOOK: Output: default@cmv_basetable_2
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table cmv_basetable_2 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@cmv_basetable_2
 POSTHOOK: Output: default@cmv_basetable_2
 #### A masked pattern was here ####
@@ -93,12 +93,12 @@ POSTHOOK: Input: default@cmv_basetable_2
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cmv_mat_view
 PREHOOK: query: analyze table cmv_mat_view compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@cmv_mat_view
 PREHOOK: Output: default@cmv_mat_view
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table cmv_mat_view compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@cmv_mat_view
 POSTHOOK: Output: default@cmv_mat_view
 #### A masked pattern was here ####
@@ -117,12 +117,12 @@ POSTHOOK: Lineage: cmv_basetable_2.b SCRIPT []
 POSTHOOK: Lineage: cmv_basetable_2.c SCRIPT []
 POSTHOOK: Lineage: cmv_basetable_2.d SCRIPT []
 PREHOOK: query: analyze table cmv_basetable_2 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@cmv_basetable_2
 PREHOOK: Output: default@cmv_basetable_2
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table cmv_basetable_2 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@cmv_basetable_2
 POSTHOOK: Output: default@cmv_basetable_2
 #### A masked pattern was here ####
@@ -178,12 +178,12 @@ STAGE PLANS:
                     Select Operator
                       expressions: a (type: int)
                       outputColumnNames: _col0
-                      Statistics: Num rows: 1 Data size: 4 Basic stats: COMPLETE Column stats: COMPLETE
+                      Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: COMPLETE
                       Reduce Output Operator
                         key expressions: _col0 (type: int)
                         sort order: +
                         Map-reduce partition columns: _col0 (type: int)
-                        Statistics: Num rows: 1 Data size: 4 Basic stats: COMPLETE Column stats: COMPLETE
+                        Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: COMPLETE
             Execution mode: llap
             LLAP IO: may be used (ACID table)
         Reducer 2 
@@ -277,17 +277,17 @@ STAGE PLANS:
                   alias: cmv_basetable_2
                   Statistics: Num rows: 3 Data size: 348 Basic stats: COMPLETE Column stats: COMPLETE
                   Filter Operator
-                    predicate: ((ROW__ID.writeid > 1) and (c > 10) and a is not null) (type: boolean)
+                    predicate: ((c > 10) and a is not null) (type: boolean)
                     Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: COMPLETE
                     Select Operator
                       expressions: a (type: int), c (type: decimal(10,2))
                       outputColumnNames: _col0, _col1
-                      Statistics: Num rows: 1 Data size: 192 Basic stats: COMPLETE Column stats: COMPLETE
+                      Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: COMPLETE
                       Reduce Output Operator
                         key expressions: _col0 (type: int)
                         sort order: +
                         Map-reduce partition columns: _col0 (type: int)
-                        Statistics: Num rows: 1 Data size: 192 Basic stats: COMPLETE Column stats: COMPLETE
+                        Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: COMPLETE
                         value expressions: _col1 (type: decimal(10,2))
             Execution mode: llap
             LLAP IO: may be used (ACID table)
@@ -398,9 +398,12 @@ Retention:          	0
 #### A masked pattern was here ####
 Table Type:         	MATERIALIZED_VIEW   	 
 Table Parameters:	 	 
+	COLUMN_STATS_ACCURATE	{\"COLUMN_STATS\":{\"a\":\"true\",\"c\":\"true\"}}
 	bucketing_version   	2                   
-	numFiles            	2                   
-	totalSize           	1053                
+	numFiles            	1                   
+	numRows             	5                   
+	rawDataSize         	0                   
+	totalSize           	761                 
 	transactional       	true                
 	transactional_properties	default             
 #### A masked pattern was here ####
@@ -433,21 +436,79 @@ FROM cmv_basetable join cmv_basetable_2 ON (cmv_basetable.a = cmv_basetable_2.a)
 WHERE cmv_basetable_2.c > 10.10
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
-  Stage-0 is a root stage
+  Stage-1 is a root stage
+  Stage-0 depends on stages: Stage-1
 
 STAGE PLANS:
+  Stage: Stage-1
+    Tez
+#### A masked pattern was here ####
+      Edges:
+        Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 3 (SIMPLE_EDGE)
+#### A masked pattern was here ####
+      Vertices:
+        Map 1 
+            Map Operator Tree:
+                TableScan
+                  alias: cmv_basetable
+                  Statistics: Num rows: 5 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
+                  Filter Operator
+                    predicate: a is not null (type: boolean)
+                    Statistics: Num rows: 5 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
+                    Select Operator
+                      expressions: a (type: int)
+                      outputColumnNames: _col0
+                      Statistics: Num rows: 5 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
+                      Reduce Output Operator
+                        key expressions: _col0 (type: int)
+                        sort order: +
+                        Map-reduce partition columns: _col0 (type: int)
+                        Statistics: Num rows: 5 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
+            Execution mode: llap
+            LLAP IO: may be used (ACID table)
+        Map 3 
+            Map Operator Tree:
+                TableScan
+                  alias: cmv_basetable_2
+                  Statistics: Num rows: 3 Data size: 348 Basic stats: COMPLETE Column stats: COMPLETE
+                  Filter Operator
+                    predicate: ((c > 10.1) and a is not null) (type: boolean)
+                    Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: COMPLETE
+                    Select Operator
+                      expressions: a (type: int)
+                      outputColumnNames: _col0
+                      Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: COMPLETE
+                      Reduce Output Operator
+                        key expressions: _col0 (type: int)
+                        sort order: +
+                        Map-reduce partition columns: _col0 (type: int)
+                        Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: COMPLETE
+            Execution mode: llap
+            LLAP IO: may be used (ACID table)
+        Reducer 2 
+            Execution mode: llap
+            Reduce Operator Tree:
+              Merge Join Operator
+                condition map:
+                     Inner Join 0 to 1
+                keys:
+                  0 _col0 (type: int)
+                  1 _col0 (type: int)
+                outputColumnNames: _col0
+                Statistics: Num rows: 2 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
+                File Output Operator
+                  compressed: false
+                  Statistics: Num rows: 2 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
+                  table:
+                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+
   Stage: Stage-0
     Fetch Operator
       limit: -1
       Processor Tree:
-        TableScan
-          alias: default.cmv_mat_view
-          Filter Operator
-            predicate: (c > 10.1) (type: boolean)
-            Select Operator
-              expressions: a (type: int)
-              outputColumnNames: _col0
-              ListSink
+        ListSink
 
 PREHOOK: query: SELECT cmv_basetable.a
 FROM cmv_basetable JOIN cmv_basetable_2 ON (cmv_basetable.a = cmv_basetable_2.a)
@@ -455,7 +516,6 @@ WHERE cmv_basetable_2.c > 10.10
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cmv_basetable
 PREHOOK: Input: default@cmv_basetable_2
-PREHOOK: Input: default@cmv_mat_view
 #### A masked pattern was here ####
 POSTHOOK: query: SELECT cmv_basetable.a
 FROM cmv_basetable JOIN cmv_basetable_2 ON (cmv_basetable.a = cmv_basetable_2.a)
@@ -463,7 +523,6 @@ WHERE cmv_basetable_2.c > 10.10
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@cmv_basetable
 POSTHOOK: Input: default@cmv_basetable_2
-POSTHOOK: Input: default@cmv_mat_view
 #### A masked pattern was here ####
 1
 3
@@ -640,21 +699,79 @@ FROM cmv_basetable join cmv_basetable_2 ON (cmv_basetable.a = cmv_basetable_2.a)
 WHERE cmv_basetable_2.c > 10.10
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
-  Stage-0 is a root stage
+  Stage-1 is a root stage
+  Stage-0 depends on stages: Stage-1
 
 STAGE PLANS:
+  Stage: Stage-1
+    Tez
+#### A masked pattern was here ####
+      Edges:
+        Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 3 (SIMPLE_EDGE)
+#### A masked pattern was here ####
+      Vertices:
+        Map 1 
+            Map Operator Tree:
+                TableScan
+                  alias: cmv_basetable
+                  Statistics: Num rows: 5 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
+                  Filter Operator
+                    predicate: a is not null (type: boolean)
+                    Statistics: Num rows: 5 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
+                    Select Operator
+                      expressions: a (type: int)
+                      outputColumnNames: _col0
+                      Statistics: Num rows: 5 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
+                      Reduce Output Operator
+                        key expressions: _col0 (type: int)
+                        sort order: +
+                        Map-reduce partition columns: _col0 (type: int)
+                        Statistics: Num rows: 5 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
+            Execution mode: llap
+            LLAP IO: may be used (ACID table)
+        Map 3 
+            Map Operator Tree:
+                TableScan
+                  alias: cmv_basetable_2
+                  Statistics: Num rows: 60 Data size: 6960 Basic stats: COMPLETE Column stats: COMPLETE
+                  Filter Operator
+                    predicate: ((c > 10.1) and a is not null) (type: boolean)
+                    Statistics: Num rows: 20 Data size: 2320 Basic stats: COMPLETE Column stats: COMPLETE
+                    Select Operator
+                      expressions: a (type: int)
+                      outputColumnNames: _col0
+                      Statistics: Num rows: 20 Data size: 2320 Basic stats: COMPLETE Column stats: COMPLETE
+                      Reduce Output Operator
+                        key expressions: _col0 (type: int)
+                        sort order: +
+                        Map-reduce partition columns: _col0 (type: int)
+                        Statistics: Num rows: 20 Data size: 2320 Basic stats: COMPLETE Column stats: COMPLETE
+            Execution mode: llap
+            LLAP IO: may be used (ACID table)
+        Reducer 2 
+            Execution mode: llap
+            Reduce Operator Tree:
+              Merge Join Operator
+                condition map:
+                     Inner Join 0 to 1
+                keys:
+                  0 _col0 (type: int)
+                  1 _col0 (type: int)
+                outputColumnNames: _col0
+                Statistics: Num rows: 33 Data size: 132 Basic stats: COMPLETE Column stats: COMPLETE
+                File Output Operator
+                  compressed: false
+                  Statistics: Num rows: 33 Data size: 132 Basic stats: COMPLETE Column stats: COMPLETE
+                  table:
+                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+
   Stage: Stage-0
     Fetch Operator
       limit: -1
       Processor Tree:
-        TableScan
-          alias: default.cmv_mat_view
-          Filter Operator
-            predicate: (c > 10.1) (type: boolean)
-            Select Operator
-              expressions: a (type: int)
-              outputColumnNames: _col0
-              ListSink
+        ListSink
 
 PREHOOK: query: SELECT cmv_basetable.a
 FROM cmv_basetable JOIN cmv_basetable_2 ON (cmv_basetable.a = cmv_basetable_2.a)
@@ -662,7 +779,6 @@ WHERE cmv_basetable_2.c > 10.10
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cmv_basetable
 PREHOOK: Input: default@cmv_basetable_2
-PREHOOK: Input: default@cmv_mat_view
 #### A masked pattern was here ####
 POSTHOOK: query: SELECT cmv_basetable.a
 FROM cmv_basetable JOIN cmv_basetable_2 ON (cmv_basetable.a = cmv_basetable_2.a)
@@ -670,7 +786,6 @@ WHERE cmv_basetable_2.c > 10.10
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@cmv_basetable
 POSTHOOK: Input: default@cmv_basetable_2
-POSTHOOK: Input: default@cmv_mat_view
 #### A masked pattern was here ####
 2
 2
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_dummy.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_dummy.q.out
index 654a15cb43..fa7dc27182 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_dummy.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_dummy.q.out
@@ -29,12 +29,12 @@ POSTHOOK: Lineage: cmv_basetable.b SCRIPT []
 POSTHOOK: Lineage: cmv_basetable.c SCRIPT []
 POSTHOOK: Lineage: cmv_basetable.d SCRIPT []
 PREHOOK: query: analyze table cmv_basetable compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@cmv_basetable
 PREHOOK: Output: default@cmv_basetable
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table cmv_basetable compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@cmv_basetable
 POSTHOOK: Output: default@cmv_basetable
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_multi_db.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_multi_db.q.out
index c728546220..fae153d9a0 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_multi_db.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_multi_db.q.out
@@ -41,12 +41,12 @@ POSTHOOK: Lineage: cmv_basetable.b SCRIPT []
 POSTHOOK: Lineage: cmv_basetable.c SCRIPT []
 POSTHOOK: Lineage: cmv_basetable.d SCRIPT []
 PREHOOK: query: analyze table cmv_basetable compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: db1@cmv_basetable
 PREHOOK: Output: db1@cmv_basetable
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table cmv_basetable compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: db1@cmv_basetable
 POSTHOOK: Output: db1@cmv_basetable
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_rebuild_dummy.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_rebuild_dummy.q.out
index dad8ebe871..8445aedf38 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_rebuild_dummy.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_rebuild_dummy.q.out
@@ -29,12 +29,12 @@ POSTHOOK: Lineage: cmv_basetable.b SCRIPT []
 POSTHOOK: Lineage: cmv_basetable.c SCRIPT []
 POSTHOOK: Lineage: cmv_basetable.d SCRIPT []
 PREHOOK: query: analyze table cmv_basetable compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@cmv_basetable
 PREHOOK: Output: default@cmv_basetable
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table cmv_basetable compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@cmv_basetable
 POSTHOOK: Output: default@cmv_basetable
 #### A masked pattern was here ####
@@ -63,12 +63,12 @@ POSTHOOK: Lineage: cmv_basetable_2.b SCRIPT []
 POSTHOOK: Lineage: cmv_basetable_2.c SCRIPT []
 POSTHOOK: Lineage: cmv_basetable_2.d SCRIPT []
 PREHOOK: query: analyze table cmv_basetable_2 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@cmv_basetable_2
 PREHOOK: Output: default@cmv_basetable_2
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table cmv_basetable_2 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@cmv_basetable_2
 POSTHOOK: Output: default@cmv_basetable_2
 #### A masked pattern was here ####
@@ -244,21 +244,103 @@ WHERE cmv_basetable_2.c > 10.10
 GROUP BY cmv_basetable.a, cmv_basetable_2.c
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
-  Stage-0 is a root stage
+  Stage-1 is a root stage
+  Stage-0 depends on stages: Stage-1
 
 STAGE PLANS:
+  Stage: Stage-1
+    Tez
+#### A masked pattern was here ####
+      Edges:
+        Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 4 (SIMPLE_EDGE)
+        Reducer 3 <- Reducer 2 (SIMPLE_EDGE)
+#### A masked pattern was here ####
+      Vertices:
+        Map 1 
+            Map Operator Tree:
+                TableScan
+                  alias: cmv_basetable
+                  Statistics: Num rows: 5 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
+                  Filter Operator
+                    predicate: a is not null (type: boolean)
+                    Statistics: Num rows: 5 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
+                    Select Operator
+                      expressions: a (type: int)
+                      outputColumnNames: _col0
+                      Statistics: Num rows: 5 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
+                      Reduce Output Operator
+                        key expressions: _col0 (type: int)
+                        sort order: +
+                        Map-reduce partition columns: _col0 (type: int)
+                        Statistics: Num rows: 5 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
+            Execution mode: llap
+            LLAP IO: may be used (ACID table)
+        Map 4 
+            Map Operator Tree:
+                TableScan
+                  alias: cmv_basetable_2
+                  Statistics: Num rows: 2 Data size: 232 Basic stats: COMPLETE Column stats: COMPLETE
+                  Filter Operator
+                    predicate: ((c > 10.1) and a is not null) (type: boolean)
+                    Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: COMPLETE
+                    Select Operator
+                      expressions: a (type: int), c (type: decimal(10,2))
+                      outputColumnNames: _col0, _col1
+                      Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: COMPLETE
+                      Reduce Output Operator
+                        key expressions: _col0 (type: int)
+                        sort order: +
+                        Map-reduce partition columns: _col0 (type: int)
+                        Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: COMPLETE
+                        value expressions: _col1 (type: decimal(10,2))
+            Execution mode: llap
+            LLAP IO: may be used (ACID table)
+        Reducer 2 
+            Execution mode: llap
+            Reduce Operator Tree:
+              Merge Join Operator
+                condition map:
+                     Inner Join 0 to 1
+                keys:
+                  0 _col0 (type: int)
+                  1 _col0 (type: int)
+                outputColumnNames: _col0, _col2
+                Statistics: Num rows: 3 Data size: 348 Basic stats: COMPLETE Column stats: COMPLETE
+                Group By Operator
+                  keys: _col0 (type: int), _col2 (type: decimal(10,2))
+                  mode: hash
+                  outputColumnNames: _col0, _col1
+                  Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: COMPLETE
+                  Reduce Output Operator
+                    key expressions: _col0 (type: int), _col1 (type: decimal(10,2))
+                    sort order: ++
+                    Map-reduce partition columns: _col0 (type: int), _col1 (type: decimal(10,2))
+                    Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: COMPLETE
+        Reducer 3 
+            Execution mode: llap
+            Reduce Operator Tree:
+              Group By Operator
+                keys: KEY._col0 (type: int), KEY._col1 (type: decimal(10,2))
+                mode: mergepartial
+                outputColumnNames: _col0, _col1
+                Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: COMPLETE
+                Select Operator
+                  expressions: _col0 (type: int)
+                  outputColumnNames: _col0
+                  Statistics: Num rows: 1 Data size: 4 Basic stats: COMPLETE Column stats: COMPLETE
+                  File Output Operator
+                    compressed: false
+                    Statistics: Num rows: 1 Data size: 4 Basic stats: COMPLETE Column stats: COMPLETE
+                    table:
+                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+
   Stage: Stage-0
     Fetch Operator
       limit: -1
       Processor Tree:
-        TableScan
-          alias: default.cmv_mat_view
-          Filter Operator
-            predicate: (c > 10.1) (type: boolean)
-            Select Operator
-              expressions: a (type: int)
-              outputColumnNames: _col0
-              ListSink
+        ListSink
 
 PREHOOK: query: SELECT cmv_basetable.a
 FROM cmv_basetable JOIN cmv_basetable_2 ON (cmv_basetable.a = cmv_basetable_2.a)
@@ -267,7 +349,6 @@ GROUP BY cmv_basetable.a, cmv_basetable_2.c
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cmv_basetable
 PREHOOK: Input: default@cmv_basetable_2
-PREHOOK: Input: default@cmv_mat_view
 #### A masked pattern was here ####
 POSTHOOK: query: SELECT cmv_basetable.a
 FROM cmv_basetable JOIN cmv_basetable_2 ON (cmv_basetable.a = cmv_basetable_2.a)
@@ -276,7 +357,6 @@ GROUP BY cmv_basetable.a, cmv_basetable_2.c
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@cmv_basetable
 POSTHOOK: Input: default@cmv_basetable_2
-POSTHOOK: Input: default@cmv_mat_view
 #### A masked pattern was here ####
 1
 3
@@ -295,12 +375,12 @@ POSTHOOK: Lineage: cmv_basetable_2.b SCRIPT []
 POSTHOOK: Lineage: cmv_basetable_2.c SCRIPT []
 POSTHOOK: Lineage: cmv_basetable_2.d SCRIPT []
 PREHOOK: query: analyze table cmv_basetable_2 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@cmv_basetable_2
 PREHOOK: Output: default@cmv_basetable_2
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table cmv_basetable_2 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@cmv_basetable_2
 POSTHOOK: Output: default@cmv_basetable_2
 #### A masked pattern was here ####
@@ -452,11 +532,9 @@ STAGE PLANS:
     Tez
 #### A masked pattern was here ####
       Edges:
-        Map 8 <- Union 4 (CONTAINS)
-        Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 7 (SIMPLE_EDGE)
-        Reducer 3 <- Reducer 2 (SIMPLE_EDGE), Union 4 (CONTAINS)
-        Reducer 5 <- Union 4 (SIMPLE_EDGE)
-        Reducer 6 <- Reducer 5 (CUSTOM_SIMPLE_EDGE)
+        Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 5 (SIMPLE_EDGE)
+        Reducer 3 <- Reducer 2 (SIMPLE_EDGE)
+        Reducer 4 <- Reducer 3 (CUSTOM_SIMPLE_EDGE)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -478,47 +556,26 @@ STAGE PLANS:
                         Statistics: Num rows: 5 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
             Execution mode: llap
             LLAP IO: may be used (ACID table)
-        Map 7 
+        Map 5 
             Map Operator Tree:
                 TableScan
                   alias: cmv_basetable_2
                   Statistics: Num rows: 3 Data size: 348 Basic stats: COMPLETE Column stats: COMPLETE
                   Filter Operator
-                    predicate: ((ROW__ID.writeid > 1) and (c > 10) and a is not null) (type: boolean)
+                    predicate: ((c > 10) and a is not null) (type: boolean)
                     Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: COMPLETE
                     Select Operator
                       expressions: a (type: int), c (type: decimal(10,2))
                       outputColumnNames: _col0, _col1
-                      Statistics: Num rows: 1 Data size: 192 Basic stats: COMPLETE Column stats: COMPLETE
+                      Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: COMPLETE
                       Reduce Output Operator
                         key expressions: _col0 (type: int)
                         sort order: +
                         Map-reduce partition columns: _col0 (type: int)
-                        Statistics: Num rows: 1 Data size: 192 Basic stats: COMPLETE Column stats: COMPLETE
+                        Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: COMPLETE
                         value expressions: _col1 (type: decimal(10,2))
             Execution mode: llap
             LLAP IO: may be used (ACID table)
-        Map 8 
-            Map Operator Tree:
-                TableScan
-                  alias: default.cmv_mat_view
-                  Statistics: Num rows: 2 Data size: 232 Basic stats: COMPLETE Column stats: NONE
-                  Select Operator
-                    expressions: a (type: int), c (type: decimal(10,2))
-                    outputColumnNames: _col0, _col1
-                    Statistics: Num rows: 2 Data size: 232 Basic stats: COMPLETE Column stats: NONE
-                    Group By Operator
-                      keys: _col0 (type: int), _col1 (type: decimal(10,2))
-                      mode: hash
-                      outputColumnNames: _col0, _col1
-                      Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: PARTIAL
-                      Reduce Output Operator
-                        key expressions: _col0 (type: int), _col1 (type: decimal(10,2))
-                        sort order: ++
-                        Map-reduce partition columns: _col0 (type: int), _col1 (type: decimal(10,2))
-                        Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: PARTIAL
-            Execution mode: llap
-            LLAP IO: all inputs
         Reducer 2 
             Execution mode: llap
             Reduce Operator Tree:
@@ -548,27 +605,9 @@ STAGE PLANS:
                 mode: mergepartial
                 outputColumnNames: _col0, _col1
                 Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: COMPLETE
-                Group By Operator
-                  keys: _col0 (type: int), _col1 (type: decimal(10,2))
-                  mode: hash
-                  outputColumnNames: _col0, _col1
-                  Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: PARTIAL
-                  Reduce Output Operator
-                    key expressions: _col0 (type: int), _col1 (type: decimal(10,2))
-                    sort order: ++
-                    Map-reduce partition columns: _col0 (type: int), _col1 (type: decimal(10,2))
-                    Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: PARTIAL
-        Reducer 5 
-            Execution mode: llap
-            Reduce Operator Tree:
-              Group By Operator
-                keys: KEY._col0 (type: int), KEY._col1 (type: decimal(10,2))
-                mode: mergepartial
-                outputColumnNames: _col0, _col1
-                Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: PARTIAL
                 File Output Operator
                   compressed: false
-                  Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: PARTIAL
+                  Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: COMPLETE
                   table:
                       input format: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
                       output format: org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat
@@ -577,33 +616,31 @@ STAGE PLANS:
                 Select Operator
                   expressions: _col0 (type: int), _col1 (type: decimal(10,2))
                   outputColumnNames: a, c
-                  Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: PARTIAL
+                  Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: COMPLETE
                   Group By Operator
                     aggregations: compute_stats(a, 'hll'), compute_stats(c, 'hll')
                     mode: hash
                     outputColumnNames: _col0, _col1
-                    Statistics: Num rows: 1 Data size: 1056 Basic stats: COMPLETE Column stats: PARTIAL
+                    Statistics: Num rows: 1 Data size: 1056 Basic stats: COMPLETE Column stats: COMPLETE
                     Reduce Output Operator
                       sort order: 
-                      Statistics: Num rows: 1 Data size: 1056 Basic stats: COMPLETE Column stats: PARTIAL
+                      Statistics: Num rows: 1 Data size: 1056 Basic stats: COMPLETE Column stats: COMPLETE
                       value expressions: _col0 (type: struct<columntype:string,min:bigint,max:bigint,countnulls:bigint,bitvector:binary>), _col1 (type: struct<columntype:string,min:decimal(10,2),max:decimal(10,2),countnulls:bigint,bitvector:binary>)
-        Reducer 6 
+        Reducer 4 
             Execution mode: llap
             Reduce Operator Tree:
               Group By Operator
                 aggregations: compute_stats(VALUE._col0), compute_stats(VALUE._col1)
                 mode: mergepartial
                 outputColumnNames: _col0, _col1
-                Statistics: Num rows: 1 Data size: 1088 Basic stats: COMPLETE Column stats: PARTIAL
+                Statistics: Num rows: 1 Data size: 1088 Basic stats: COMPLETE Column stats: COMPLETE
                 File Output Operator
                   compressed: false
-                  Statistics: Num rows: 1 Data size: 1088 Basic stats: COMPLETE Column stats: PARTIAL
+                  Statistics: Num rows: 1 Data size: 1088 Basic stats: COMPLETE Column stats: COMPLETE
                   table:
                       input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                       output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-        Union 4 
-            Vertex: Union 4
 
   Stage: Stage-2
     Dependency Collection
@@ -633,16 +670,14 @@ PREHOOK: query: ALTER MATERIALIZED VIEW cmv_mat_view REBUILD
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cmv_basetable
 PREHOOK: Input: default@cmv_basetable_2
-PREHOOK: Input: default@cmv_mat_view
 PREHOOK: Output: default@cmv_mat_view
 POSTHOOK: query: ALTER MATERIALIZED VIEW cmv_mat_view REBUILD
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@cmv_basetable
 POSTHOOK: Input: default@cmv_basetable_2
-POSTHOOK: Input: default@cmv_mat_view
 POSTHOOK: Output: default@cmv_mat_view
-POSTHOOK: Lineage: cmv_mat_view.a EXPRESSION [(cmv_basetable)cmv_basetable.FieldSchema(name:a, type:int, comment:null), (cmv_mat_view)default.cmv_mat_view.FieldSchema(name:a, type:int, comment:null), ]
-POSTHOOK: Lineage: cmv_mat_view.c EXPRESSION [(cmv_basetable_2)cmv_basetable_2.FieldSchema(name:c, type:decimal(10,2), comment:null), (cmv_mat_view)default.cmv_mat_view.FieldSchema(name:c, type:decimal(10,2), comment:null), ]
+POSTHOOK: Lineage: cmv_mat_view.a SIMPLE [(cmv_basetable)cmv_basetable.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: cmv_mat_view.c SIMPLE [(cmv_basetable_2)cmv_basetable_2.FieldSchema(name:c, type:decimal(10,2), comment:null), ]
 PREHOOK: query: EXPLAIN
 SELECT cmv_basetable.a
 FROM cmv_basetable join cmv_basetable_2 ON (cmv_basetable.a = cmv_basetable_2.a)
@@ -656,21 +691,103 @@ WHERE cmv_basetable_2.c > 10.10
 GROUP BY cmv_basetable.a, cmv_basetable_2.c
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
-  Stage-0 is a root stage
+  Stage-1 is a root stage
+  Stage-0 depends on stages: Stage-1
 
 STAGE PLANS:
+  Stage: Stage-1
+    Tez
+#### A masked pattern was here ####
+      Edges:
+        Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 4 (SIMPLE_EDGE)
+        Reducer 3 <- Reducer 2 (SIMPLE_EDGE)
+#### A masked pattern was here ####
+      Vertices:
+        Map 1 
+            Map Operator Tree:
+                TableScan
+                  alias: cmv_basetable
+                  Statistics: Num rows: 5 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
+                  Filter Operator
+                    predicate: a is not null (type: boolean)
+                    Statistics: Num rows: 5 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
+                    Select Operator
+                      expressions: a (type: int)
+                      outputColumnNames: _col0
+                      Statistics: Num rows: 5 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
+                      Reduce Output Operator
+                        key expressions: _col0 (type: int)
+                        sort order: +
+                        Map-reduce partition columns: _col0 (type: int)
+                        Statistics: Num rows: 5 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
+            Execution mode: llap
+            LLAP IO: may be used (ACID table)
+        Map 4 
+            Map Operator Tree:
+                TableScan
+                  alias: cmv_basetable_2
+                  Statistics: Num rows: 3 Data size: 348 Basic stats: COMPLETE Column stats: COMPLETE
+                  Filter Operator
+                    predicate: ((c > 10.1) and a is not null) (type: boolean)
+                    Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: COMPLETE
+                    Select Operator
+                      expressions: a (type: int), c (type: decimal(10,2))
+                      outputColumnNames: _col0, _col1
+                      Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: COMPLETE
+                      Reduce Output Operator
+                        key expressions: _col0 (type: int)
+                        sort order: +
+                        Map-reduce partition columns: _col0 (type: int)
+                        Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: COMPLETE
+                        value expressions: _col1 (type: decimal(10,2))
+            Execution mode: llap
+            LLAP IO: may be used (ACID table)
+        Reducer 2 
+            Execution mode: llap
+            Reduce Operator Tree:
+              Merge Join Operator
+                condition map:
+                     Inner Join 0 to 1
+                keys:
+                  0 _col0 (type: int)
+                  1 _col0 (type: int)
+                outputColumnNames: _col0, _col2
+                Statistics: Num rows: 2 Data size: 232 Basic stats: COMPLETE Column stats: COMPLETE
+                Group By Operator
+                  keys: _col0 (type: int), _col2 (type: decimal(10,2))
+                  mode: hash
+                  outputColumnNames: _col0, _col1
+                  Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: COMPLETE
+                  Reduce Output Operator
+                    key expressions: _col0 (type: int), _col1 (type: decimal(10,2))
+                    sort order: ++
+                    Map-reduce partition columns: _col0 (type: int), _col1 (type: decimal(10,2))
+                    Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: COMPLETE
+        Reducer 3 
+            Execution mode: llap
+            Reduce Operator Tree:
+              Group By Operator
+                keys: KEY._col0 (type: int), KEY._col1 (type: decimal(10,2))
+                mode: mergepartial
+                outputColumnNames: _col0, _col1
+                Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: COMPLETE
+                Select Operator
+                  expressions: _col0 (type: int)
+                  outputColumnNames: _col0
+                  Statistics: Num rows: 1 Data size: 4 Basic stats: COMPLETE Column stats: COMPLETE
+                  File Output Operator
+                    compressed: false
+                    Statistics: Num rows: 1 Data size: 4 Basic stats: COMPLETE Column stats: COMPLETE
+                    table:
+                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+
   Stage: Stage-0
     Fetch Operator
       limit: -1
       Processor Tree:
-        TableScan
-          alias: default.cmv_mat_view
-          Filter Operator
-            predicate: (c > 10.1) (type: boolean)
-            Select Operator
-              expressions: a (type: int)
-              outputColumnNames: _col0
-              ListSink
+        ListSink
 
 PREHOOK: query: SELECT cmv_basetable.a
 FROM cmv_basetable JOIN cmv_basetable_2 ON (cmv_basetable.a = cmv_basetable_2.a)
@@ -679,7 +796,6 @@ GROUP BY cmv_basetable.a, cmv_basetable_2.c
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cmv_basetable
 PREHOOK: Input: default@cmv_basetable_2
-PREHOOK: Input: default@cmv_mat_view
 #### A masked pattern was here ####
 POSTHOOK: query: SELECT cmv_basetable.a
 FROM cmv_basetable JOIN cmv_basetable_2 ON (cmv_basetable.a = cmv_basetable_2.a)
@@ -688,7 +804,6 @@ GROUP BY cmv_basetable.a, cmv_basetable_2.c
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@cmv_basetable
 POSTHOOK: Input: default@cmv_basetable_2
-POSTHOOK: Input: default@cmv_mat_view
 #### A masked pattern was here ####
 1
 3
@@ -854,21 +969,103 @@ WHERE cmv_basetable_2.c > 10.10
 GROUP BY cmv_basetable.a, cmv_basetable_2.c
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
-  Stage-0 is a root stage
+  Stage-1 is a root stage
+  Stage-0 depends on stages: Stage-1
 
 STAGE PLANS:
+  Stage: Stage-1
+    Tez
+#### A masked pattern was here ####
+      Edges:
+        Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 4 (SIMPLE_EDGE)
+        Reducer 3 <- Reducer 2 (SIMPLE_EDGE)
+#### A masked pattern was here ####
+      Vertices:
+        Map 1 
+            Map Operator Tree:
+                TableScan
+                  alias: cmv_basetable
+                  Statistics: Num rows: 5 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
+                  Filter Operator
+                    predicate: a is not null (type: boolean)
+                    Statistics: Num rows: 5 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
+                    Select Operator
+                      expressions: a (type: int)
+                      outputColumnNames: _col0
+                      Statistics: Num rows: 5 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
+                      Reduce Output Operator
+                        key expressions: _col0 (type: int)
+                        sort order: +
+                        Map-reduce partition columns: _col0 (type: int)
+                        Statistics: Num rows: 5 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
+            Execution mode: llap
+            LLAP IO: may be used (ACID table)
+        Map 4 
+            Map Operator Tree:
+                TableScan
+                  alias: cmv_basetable_2
+                  Statistics: Num rows: 42 Data size: 4872 Basic stats: COMPLETE Column stats: COMPLETE
+                  Filter Operator
+                    predicate: ((c > 10.1) and a is not null) (type: boolean)
+                    Statistics: Num rows: 14 Data size: 1624 Basic stats: COMPLETE Column stats: COMPLETE
+                    Select Operator
+                      expressions: a (type: int), c (type: decimal(10,2))
+                      outputColumnNames: _col0, _col1
+                      Statistics: Num rows: 14 Data size: 1624 Basic stats: COMPLETE Column stats: COMPLETE
+                      Reduce Output Operator
+                        key expressions: _col0 (type: int)
+                        sort order: +
+                        Map-reduce partition columns: _col0 (type: int)
+                        Statistics: Num rows: 14 Data size: 1624 Basic stats: COMPLETE Column stats: COMPLETE
+                        value expressions: _col1 (type: decimal(10,2))
+            Execution mode: llap
+            LLAP IO: may be used (ACID table)
+        Reducer 2 
+            Execution mode: llap
+            Reduce Operator Tree:
+              Merge Join Operator
+                condition map:
+                     Inner Join 0 to 1
+                keys:
+                  0 _col0 (type: int)
+                  1 _col0 (type: int)
+                outputColumnNames: _col0, _col2
+                Statistics: Num rows: 23 Data size: 2668 Basic stats: COMPLETE Column stats: COMPLETE
+                Group By Operator
+                  keys: _col0 (type: int), _col2 (type: decimal(10,2))
+                  mode: hash
+                  outputColumnNames: _col0, _col1
+                  Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: COMPLETE
+                  Reduce Output Operator
+                    key expressions: _col0 (type: int), _col1 (type: decimal(10,2))
+                    sort order: ++
+                    Map-reduce partition columns: _col0 (type: int), _col1 (type: decimal(10,2))
+                    Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: COMPLETE
+        Reducer 3 
+            Execution mode: llap
+            Reduce Operator Tree:
+              Group By Operator
+                keys: KEY._col0 (type: int), KEY._col1 (type: decimal(10,2))
+                mode: mergepartial
+                outputColumnNames: _col0, _col1
+                Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: COMPLETE
+                Select Operator
+                  expressions: _col0 (type: int)
+                  outputColumnNames: _col0
+                  Statistics: Num rows: 1 Data size: 4 Basic stats: COMPLETE Column stats: COMPLETE
+                  File Output Operator
+                    compressed: false
+                    Statistics: Num rows: 1 Data size: 4 Basic stats: COMPLETE Column stats: COMPLETE
+                    table:
+                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+
   Stage: Stage-0
     Fetch Operator
       limit: -1
       Processor Tree:
-        TableScan
-          alias: default.cmv_mat_view
-          Filter Operator
-            predicate: (c > 10.1) (type: boolean)
-            Select Operator
-              expressions: a (type: int)
-              outputColumnNames: _col0
-              ListSink
+        ListSink
 
 PREHOOK: query: SELECT cmv_basetable.a
 FROM cmv_basetable JOIN cmv_basetable_2 ON (cmv_basetable.a = cmv_basetable_2.a)
@@ -877,7 +1074,6 @@ GROUP BY cmv_basetable.a, cmv_basetable_2.c
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cmv_basetable
 PREHOOK: Input: default@cmv_basetable_2
-PREHOOK: Input: default@cmv_mat_view
 #### A masked pattern was here ####
 POSTHOOK: query: SELECT cmv_basetable.a
 FROM cmv_basetable JOIN cmv_basetable_2 ON (cmv_basetable.a = cmv_basetable_2.a)
@@ -886,7 +1082,6 @@ GROUP BY cmv_basetable.a, cmv_basetable_2.c
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@cmv_basetable
 POSTHOOK: Input: default@cmv_basetable_2
-POSTHOOK: Input: default@cmv_mat_view
 #### A masked pattern was here ####
 1
 PREHOOK: query: create table cmv_irrelevant_table (a int, b varchar(256), c decimal(10,2), d int) stored as orc TBLPROPERTIES ('transactional'='true')
@@ -914,12 +1109,12 @@ POSTHOOK: Lineage: cmv_irrelevant_table.b SCRIPT []
 POSTHOOK: Lineage: cmv_irrelevant_table.c SCRIPT []
 POSTHOOK: Lineage: cmv_irrelevant_table.d SCRIPT []
 PREHOOK: query: analyze table cmv_irrelevant_table compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@cmv_irrelevant_table
 PREHOOK: Output: default@cmv_irrelevant_table
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table cmv_irrelevant_table compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@cmv_irrelevant_table
 POSTHOOK: Output: default@cmv_irrelevant_table
 #### A masked pattern was here ####
@@ -936,21 +1131,103 @@ WHERE cmv_basetable_2.c > 10.10
 GROUP BY cmv_basetable.a, cmv_basetable_2.c
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
-  Stage-0 is a root stage
+  Stage-1 is a root stage
+  Stage-0 depends on stages: Stage-1
 
 STAGE PLANS:
+  Stage: Stage-1
+    Tez
+#### A masked pattern was here ####
+      Edges:
+        Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 4 (SIMPLE_EDGE)
+        Reducer 3 <- Reducer 2 (SIMPLE_EDGE)
+#### A masked pattern was here ####
+      Vertices:
+        Map 1 
+            Map Operator Tree:
+                TableScan
+                  alias: cmv_basetable
+                  Statistics: Num rows: 5 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
+                  Filter Operator
+                    predicate: a is not null (type: boolean)
+                    Statistics: Num rows: 5 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
+                    Select Operator
+                      expressions: a (type: int)
+                      outputColumnNames: _col0
+                      Statistics: Num rows: 5 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
+                      Reduce Output Operator
+                        key expressions: _col0 (type: int)
+                        sort order: +
+                        Map-reduce partition columns: _col0 (type: int)
+                        Statistics: Num rows: 5 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
+            Execution mode: llap
+            LLAP IO: may be used (ACID table)
+        Map 4 
+            Map Operator Tree:
+                TableScan
+                  alias: cmv_basetable_2
+                  Statistics: Num rows: 42 Data size: 4872 Basic stats: COMPLETE Column stats: COMPLETE
+                  Filter Operator
+                    predicate: ((c > 10.1) and a is not null) (type: boolean)
+                    Statistics: Num rows: 14 Data size: 1624 Basic stats: COMPLETE Column stats: COMPLETE
+                    Select Operator
+                      expressions: a (type: int), c (type: decimal(10,2))
+                      outputColumnNames: _col0, _col1
+                      Statistics: Num rows: 14 Data size: 1624 Basic stats: COMPLETE Column stats: COMPLETE
+                      Reduce Output Operator
+                        key expressions: _col0 (type: int)
+                        sort order: +
+                        Map-reduce partition columns: _col0 (type: int)
+                        Statistics: Num rows: 14 Data size: 1624 Basic stats: COMPLETE Column stats: COMPLETE
+                        value expressions: _col1 (type: decimal(10,2))
+            Execution mode: llap
+            LLAP IO: may be used (ACID table)
+        Reducer 2 
+            Execution mode: llap
+            Reduce Operator Tree:
+              Merge Join Operator
+                condition map:
+                     Inner Join 0 to 1
+                keys:
+                  0 _col0 (type: int)
+                  1 _col0 (type: int)
+                outputColumnNames: _col0, _col2
+                Statistics: Num rows: 23 Data size: 2668 Basic stats: COMPLETE Column stats: COMPLETE
+                Group By Operator
+                  keys: _col0 (type: int), _col2 (type: decimal(10,2))
+                  mode: hash
+                  outputColumnNames: _col0, _col1
+                  Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: COMPLETE
+                  Reduce Output Operator
+                    key expressions: _col0 (type: int), _col1 (type: decimal(10,2))
+                    sort order: ++
+                    Map-reduce partition columns: _col0 (type: int), _col1 (type: decimal(10,2))
+                    Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: COMPLETE
+        Reducer 3 
+            Execution mode: llap
+            Reduce Operator Tree:
+              Group By Operator
+                keys: KEY._col0 (type: int), KEY._col1 (type: decimal(10,2))
+                mode: mergepartial
+                outputColumnNames: _col0, _col1
+                Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: COMPLETE
+                Select Operator
+                  expressions: _col0 (type: int)
+                  outputColumnNames: _col0
+                  Statistics: Num rows: 1 Data size: 4 Basic stats: COMPLETE Column stats: COMPLETE
+                  File Output Operator
+                    compressed: false
+                    Statistics: Num rows: 1 Data size: 4 Basic stats: COMPLETE Column stats: COMPLETE
+                    table:
+                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+
   Stage: Stage-0
     Fetch Operator
       limit: -1
       Processor Tree:
-        TableScan
-          alias: default.cmv_mat_view
-          Filter Operator
-            predicate: (c > 10.1) (type: boolean)
-            Select Operator
-              expressions: a (type: int)
-              outputColumnNames: _col0
-              ListSink
+        ListSink
 
 PREHOOK: query: SELECT cmv_basetable.a
 FROM cmv_basetable JOIN cmv_basetable_2 ON (cmv_basetable.a = cmv_basetable_2.a)
@@ -959,7 +1236,6 @@ GROUP BY cmv_basetable.a, cmv_basetable_2.c
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cmv_basetable
 PREHOOK: Input: default@cmv_basetable_2
-PREHOOK: Input: default@cmv_mat_view
 #### A masked pattern was here ####
 POSTHOOK: query: SELECT cmv_basetable.a
 FROM cmv_basetable JOIN cmv_basetable_2 ON (cmv_basetable.a = cmv_basetable_2.a)
@@ -968,7 +1244,6 @@ GROUP BY cmv_basetable.a, cmv_basetable_2.c
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@cmv_basetable
 POSTHOOK: Input: default@cmv_basetable_2
-POSTHOOK: Input: default@cmv_mat_view
 #### A masked pattern was here ####
 1
 PREHOOK: query: drop materialized view cmv_mat_view
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_time_window.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_time_window.q.out
index d45ccded2c..097da95923 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_time_window.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_time_window.q.out
@@ -29,12 +29,12 @@ POSTHOOK: Lineage: cmv_basetable.b SCRIPT []
 POSTHOOK: Lineage: cmv_basetable.c SCRIPT []
 POSTHOOK: Lineage: cmv_basetable.d SCRIPT []
 PREHOOK: query: analyze table cmv_basetable compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@cmv_basetable
 PREHOOK: Output: default@cmv_basetable
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table cmv_basetable compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@cmv_basetable
 POSTHOOK: Output: default@cmv_basetable
 #### A masked pattern was here ####
@@ -63,12 +63,12 @@ POSTHOOK: Lineage: cmv_basetable_2.b SCRIPT []
 POSTHOOK: Lineage: cmv_basetable_2.c SCRIPT []
 POSTHOOK: Lineage: cmv_basetable_2.d SCRIPT []
 PREHOOK: query: analyze table cmv_basetable_2 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@cmv_basetable_2
 PREHOOK: Output: default@cmv_basetable_2
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table cmv_basetable_2 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@cmv_basetable_2
 POSTHOOK: Output: default@cmv_basetable_2
 #### A masked pattern was here ####
@@ -421,12 +421,12 @@ POSTHOOK: Lineage: cmv_basetable_2.b SCRIPT []
 POSTHOOK: Lineage: cmv_basetable_2.c SCRIPT []
 POSTHOOK: Lineage: cmv_basetable_2.d SCRIPT []
 PREHOOK: query: analyze table cmv_basetable_2 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@cmv_basetable_2
 PREHOOK: Output: default@cmv_basetable_2
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table cmv_basetable_2 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@cmv_basetable_2
 POSTHOOK: Output: default@cmv_basetable_2
 #### A masked pattern was here ####
@@ -566,11 +566,9 @@ STAGE PLANS:
     Tez
 #### A masked pattern was here ####
       Edges:
-        Map 8 <- Union 4 (CONTAINS)
-        Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 7 (SIMPLE_EDGE)
-        Reducer 3 <- Reducer 2 (SIMPLE_EDGE), Union 4 (CONTAINS)
-        Reducer 5 <- Union 4 (SIMPLE_EDGE)
-        Reducer 6 <- Reducer 5 (CUSTOM_SIMPLE_EDGE)
+        Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 5 (SIMPLE_EDGE)
+        Reducer 3 <- Reducer 2 (SIMPLE_EDGE)
+        Reducer 4 <- Reducer 3 (CUSTOM_SIMPLE_EDGE)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -592,47 +590,26 @@ STAGE PLANS:
                         Statistics: Num rows: 5 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
             Execution mode: llap
             LLAP IO: may be used (ACID table)
-        Map 7 
+        Map 5 
             Map Operator Tree:
                 TableScan
                   alias: cmv_basetable_2
                   Statistics: Num rows: 3 Data size: 348 Basic stats: COMPLETE Column stats: COMPLETE
                   Filter Operator
-                    predicate: ((ROW__ID.writeid > 1) and (c > 10) and a is not null) (type: boolean)
+                    predicate: ((c > 10) and a is not null) (type: boolean)
                     Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: COMPLETE
                     Select Operator
                       expressions: a (type: int), c (type: decimal(10,2))
                       outputColumnNames: _col0, _col1
-                      Statistics: Num rows: 1 Data size: 192 Basic stats: COMPLETE Column stats: COMPLETE
+                      Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: COMPLETE
                       Reduce Output Operator
                         key expressions: _col0 (type: int)
                         sort order: +
                         Map-reduce partition columns: _col0 (type: int)
-                        Statistics: Num rows: 1 Data size: 192 Basic stats: COMPLETE Column stats: COMPLETE
+                        Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: COMPLETE
                         value expressions: _col1 (type: decimal(10,2))
             Execution mode: llap
             LLAP IO: may be used (ACID table)
-        Map 8 
-            Map Operator Tree:
-                TableScan
-                  alias: default.cmv_mat_view
-                  Statistics: Num rows: 2 Data size: 232 Basic stats: COMPLETE Column stats: NONE
-                  Select Operator
-                    expressions: a (type: int), c (type: decimal(10,2))
-                    outputColumnNames: _col0, _col1
-                    Statistics: Num rows: 2 Data size: 232 Basic stats: COMPLETE Column stats: NONE
-                    Group By Operator
-                      keys: _col0 (type: int), _col1 (type: decimal(10,2))
-                      mode: hash
-                      outputColumnNames: _col0, _col1
-                      Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: PARTIAL
-                      Reduce Output Operator
-                        key expressions: _col0 (type: int), _col1 (type: decimal(10,2))
-                        sort order: ++
-                        Map-reduce partition columns: _col0 (type: int), _col1 (type: decimal(10,2))
-                        Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: PARTIAL
-            Execution mode: llap
-            LLAP IO: all inputs
         Reducer 2 
             Execution mode: llap
             Reduce Operator Tree:
@@ -662,27 +639,9 @@ STAGE PLANS:
                 mode: mergepartial
                 outputColumnNames: _col0, _col1
                 Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: COMPLETE
-                Group By Operator
-                  keys: _col0 (type: int), _col1 (type: decimal(10,2))
-                  mode: hash
-                  outputColumnNames: _col0, _col1
-                  Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: PARTIAL
-                  Reduce Output Operator
-                    key expressions: _col0 (type: int), _col1 (type: decimal(10,2))
-                    sort order: ++
-                    Map-reduce partition columns: _col0 (type: int), _col1 (type: decimal(10,2))
-                    Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: PARTIAL
-        Reducer 5 
-            Execution mode: llap
-            Reduce Operator Tree:
-              Group By Operator
-                keys: KEY._col0 (type: int), KEY._col1 (type: decimal(10,2))
-                mode: mergepartial
-                outputColumnNames: _col0, _col1
-                Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: PARTIAL
                 File Output Operator
                   compressed: false
-                  Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: PARTIAL
+                  Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: COMPLETE
                   table:
                       input format: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
                       output format: org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat
@@ -691,33 +650,31 @@ STAGE PLANS:
                 Select Operator
                   expressions: _col0 (type: int), _col1 (type: decimal(10,2))
                   outputColumnNames: a, c
-                  Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: PARTIAL
+                  Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: COMPLETE
                   Group By Operator
                     aggregations: compute_stats(a, 'hll'), compute_stats(c, 'hll')
                     mode: hash
                     outputColumnNames: _col0, _col1
-                    Statistics: Num rows: 1 Data size: 1056 Basic stats: COMPLETE Column stats: PARTIAL
+                    Statistics: Num rows: 1 Data size: 1056 Basic stats: COMPLETE Column stats: COMPLETE
                     Reduce Output Operator
                       sort order: 
-                      Statistics: Num rows: 1 Data size: 1056 Basic stats: COMPLETE Column stats: PARTIAL
+                      Statistics: Num rows: 1 Data size: 1056 Basic stats: COMPLETE Column stats: COMPLETE
                       value expressions: _col0 (type: struct<columntype:string,min:bigint,max:bigint,countnulls:bigint,bitvector:binary>), _col1 (type: struct<columntype:string,min:decimal(10,2),max:decimal(10,2),countnulls:bigint,bitvector:binary>)
-        Reducer 6 
+        Reducer 4 
             Execution mode: llap
             Reduce Operator Tree:
               Group By Operator
                 aggregations: compute_stats(VALUE._col0), compute_stats(VALUE._col1)
                 mode: mergepartial
                 outputColumnNames: _col0, _col1
-                Statistics: Num rows: 1 Data size: 1088 Basic stats: COMPLETE Column stats: PARTIAL
+                Statistics: Num rows: 1 Data size: 1088 Basic stats: COMPLETE Column stats: COMPLETE
                 File Output Operator
                   compressed: false
-                  Statistics: Num rows: 1 Data size: 1088 Basic stats: COMPLETE Column stats: PARTIAL
+                  Statistics: Num rows: 1 Data size: 1088 Basic stats: COMPLETE Column stats: COMPLETE
                   table:
                       input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                       output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-        Union 4 
-            Vertex: Union 4
 
   Stage: Stage-2
     Dependency Collection
@@ -747,16 +704,14 @@ PREHOOK: query: ALTER MATERIALIZED VIEW cmv_mat_view REBUILD
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cmv_basetable
 PREHOOK: Input: default@cmv_basetable_2
-PREHOOK: Input: default@cmv_mat_view
 PREHOOK: Output: default@cmv_mat_view
 POSTHOOK: query: ALTER MATERIALIZED VIEW cmv_mat_view REBUILD
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@cmv_basetable
 POSTHOOK: Input: default@cmv_basetable_2
-POSTHOOK: Input: default@cmv_mat_view
 POSTHOOK: Output: default@cmv_mat_view
-POSTHOOK: Lineage: cmv_mat_view.a EXPRESSION [(cmv_basetable)cmv_basetable.FieldSchema(name:a, type:int, comment:null), (cmv_mat_view)default.cmv_mat_view.FieldSchema(name:a, type:int, comment:null), ]
-POSTHOOK: Lineage: cmv_mat_view.c EXPRESSION [(cmv_basetable_2)cmv_basetable_2.FieldSchema(name:c, type:decimal(10,2), comment:null), (cmv_mat_view)default.cmv_mat_view.FieldSchema(name:c, type:decimal(10,2), comment:null), ]
+POSTHOOK: Lineage: cmv_mat_view.a SIMPLE [(cmv_basetable)cmv_basetable.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: cmv_mat_view.c SIMPLE [(cmv_basetable_2)cmv_basetable_2.FieldSchema(name:c, type:decimal(10,2), comment:null), ]
 PREHOOK: query: DESCRIBE FORMATTED cmv_mat_view
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@cmv_mat_view
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_1.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_1.q.out
index 675fe28921..87c0fd61ea 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_1.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_1.q.out
@@ -34,12 +34,12 @@ POSTHOOK: Lineage: emps.empid SCRIPT []
 POSTHOOK: Lineage: emps.name SCRIPT []
 POSTHOOK: Lineage: emps.salary SCRIPT []
 PREHOOK: query: analyze table emps compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@emps
 PREHOOK: Output: default@emps
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table emps compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@emps
 POSTHOOK: Output: default@emps
 #### A masked pattern was here ####
@@ -71,12 +71,12 @@ POSTHOOK: Lineage: depts.deptno SCRIPT []
 POSTHOOK: Lineage: depts.locationid SCRIPT []
 POSTHOOK: Lineage: depts.name SCRIPT []
 PREHOOK: query: analyze table depts compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@depts
 PREHOOK: Output: default@depts
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table depts compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@depts
 POSTHOOK: Output: default@depts
 #### A masked pattern was here ####
@@ -105,12 +105,12 @@ POSTHOOK: Output: default@dependents
 POSTHOOK: Lineage: dependents.empid SCRIPT []
 POSTHOOK: Lineage: dependents.name SCRIPT []
 PREHOOK: query: analyze table dependents compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@dependents
 PREHOOK: Output: default@dependents
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table dependents compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@dependents
 POSTHOOK: Output: default@dependents
 #### A masked pattern was here ####
@@ -139,12 +139,12 @@ POSTHOOK: Output: default@locations
 POSTHOOK: Lineage: locations.locationid SCRIPT []
 POSTHOOK: Lineage: locations.name SCRIPT []
 PREHOOK: query: analyze table locations compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@locations
 PREHOOK: Output: default@locations
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table locations compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@locations
 POSTHOOK: Output: default@locations
 #### A masked pattern was here ####
@@ -185,12 +185,12 @@ POSTHOOK: Input: default@emps
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
 PREHOOK: query: analyze table mv1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@mv1
 PREHOOK: Output: default@mv1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table mv1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@mv1
 POSTHOOK: Output: default@mv1
 #### A masked pattern was here ####
@@ -324,12 +324,12 @@ POSTHOOK: Input: default@emps
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
 PREHOOK: query: analyze table mv1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@mv1
 PREHOOK: Output: default@mv1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table mv1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@mv1
 POSTHOOK: Output: default@mv1
 #### A masked pattern was here ####
@@ -466,12 +466,12 @@ POSTHOOK: Input: default@emps
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
 PREHOOK: query: analyze table mv1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@mv1
 PREHOOK: Output: default@mv1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table mv1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@mv1
 POSTHOOK: Output: default@mv1
 #### A masked pattern was here ####
@@ -535,12 +535,12 @@ POSTHOOK: Input: default@emps
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
 PREHOOK: query: analyze table mv1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@mv1
 PREHOOK: Output: default@mv1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table mv1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@mv1
 POSTHOOK: Output: default@mv1
 #### A masked pattern was here ####
@@ -654,12 +654,12 @@ POSTHOOK: Input: default@emps
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
 PREHOOK: query: analyze table mv1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@mv1
 PREHOOK: Output: default@mv1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table mv1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@mv1
 POSTHOOK: Output: default@mv1
 #### A masked pattern was here ####
@@ -718,12 +718,12 @@ POSTHOOK: Input: default@emps
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
 PREHOOK: query: analyze table mv1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@mv1
 PREHOOK: Output: default@mv1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table mv1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@mv1
 POSTHOOK: Output: default@mv1
 #### A masked pattern was here ####
@@ -782,12 +782,12 @@ POSTHOOK: Input: default@emps
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
 PREHOOK: query: analyze table mv1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@mv1
 PREHOOK: Output: default@mv1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table mv1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@mv1
 POSTHOOK: Output: default@mv1
 #### A masked pattern was here ####
@@ -847,12 +847,12 @@ POSTHOOK: Input: default@emps
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
 PREHOOK: query: analyze table mv1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@mv1
 PREHOOK: Output: default@mv1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table mv1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@mv1
 POSTHOOK: Output: default@mv1
 #### A masked pattern was here ####
@@ -952,12 +952,12 @@ POSTHOOK: Input: default@emps
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
 PREHOOK: query: analyze table mv1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@mv1
 PREHOOK: Output: default@mv1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table mv1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@mv1
 POSTHOOK: Output: default@mv1
 #### A masked pattern was here ####
@@ -1058,12 +1058,12 @@ POSTHOOK: Input: default@emps
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
 PREHOOK: query: analyze table mv1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@mv1
 PREHOOK: Output: default@mv1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table mv1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@mv1
 POSTHOOK: Output: default@mv1
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_2.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_2.q.out
index e8fe69f32c..2dc76a80d1 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_2.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_2.q.out
@@ -34,12 +34,12 @@ POSTHOOK: Lineage: emps.empid SCRIPT []
 POSTHOOK: Lineage: emps.name SCRIPT []
 POSTHOOK: Lineage: emps.salary SCRIPT []
 PREHOOK: query: analyze table emps compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@emps
 PREHOOK: Output: default@emps
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table emps compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@emps
 POSTHOOK: Output: default@emps
 #### A masked pattern was here ####
@@ -71,12 +71,12 @@ POSTHOOK: Lineage: depts.deptno SCRIPT []
 POSTHOOK: Lineage: depts.locationid SCRIPT []
 POSTHOOK: Lineage: depts.name SCRIPT []
 PREHOOK: query: analyze table depts compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@depts
 PREHOOK: Output: default@depts
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table depts compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@depts
 POSTHOOK: Output: default@depts
 #### A masked pattern was here ####
@@ -105,12 +105,12 @@ POSTHOOK: Output: default@dependents
 POSTHOOK: Lineage: dependents.empid SCRIPT []
 POSTHOOK: Lineage: dependents.name SCRIPT []
 PREHOOK: query: analyze table dependents compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@dependents
 PREHOOK: Output: default@dependents
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table dependents compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@dependents
 POSTHOOK: Output: default@dependents
 #### A masked pattern was here ####
@@ -139,12 +139,12 @@ POSTHOOK: Output: default@locations
 POSTHOOK: Lineage: locations.locationid SCRIPT []
 POSTHOOK: Lineage: locations.name SCRIPT []
 PREHOOK: query: analyze table locations compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@locations
 PREHOOK: Output: default@locations
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table locations compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@locations
 POSTHOOK: Output: default@locations
 #### A masked pattern was here ####
@@ -191,12 +191,12 @@ POSTHOOK: Input: default@emps
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
 PREHOOK: query: analyze table mv1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@mv1
 PREHOOK: Output: default@mv1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table mv1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@mv1
 POSTHOOK: Output: default@mv1
 #### A masked pattern was here ####
@@ -270,12 +270,12 @@ POSTHOOK: Input: default@emps
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
 PREHOOK: query: analyze table mv1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@mv1
 PREHOOK: Output: default@mv1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table mv1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@mv1
 POSTHOOK: Output: default@mv1
 #### A masked pattern was here ####
@@ -349,12 +349,12 @@ POSTHOOK: Input: default@emps
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
 PREHOOK: query: analyze table mv1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@mv1
 PREHOOK: Output: default@mv1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table mv1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@mv1
 POSTHOOK: Output: default@mv1
 #### A masked pattern was here ####
@@ -428,12 +428,12 @@ POSTHOOK: Input: default@emps
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
 PREHOOK: query: analyze table mv1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@mv1
 PREHOOK: Output: default@mv1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table mv1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@mv1
 POSTHOOK: Output: default@mv1
 #### A masked pattern was here ####
@@ -512,12 +512,12 @@ POSTHOOK: Input: default@emps
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
 PREHOOK: query: analyze table mv1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@mv1
 PREHOOK: Output: default@mv1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table mv1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@mv1
 POSTHOOK: Output: default@mv1
 #### A masked pattern was here ####
@@ -639,12 +639,12 @@ POSTHOOK: Input: default@emps
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
 PREHOOK: query: analyze table mv1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@mv1
 PREHOOK: Output: default@mv1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table mv1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@mv1
 POSTHOOK: Output: default@mv1
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_3.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_3.q.out
index 353a5d8acb..f2c7ee4b12 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_3.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_3.q.out
@@ -34,12 +34,12 @@ POSTHOOK: Lineage: emps.empid SCRIPT []
 POSTHOOK: Lineage: emps.name SCRIPT []
 POSTHOOK: Lineage: emps.salary SCRIPT []
 PREHOOK: query: analyze table emps compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@emps
 PREHOOK: Output: default@emps
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table emps compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@emps
 POSTHOOK: Output: default@emps
 #### A masked pattern was here ####
@@ -71,12 +71,12 @@ POSTHOOK: Lineage: depts.deptno SCRIPT []
 POSTHOOK: Lineage: depts.locationid SCRIPT []
 POSTHOOK: Lineage: depts.name SCRIPT []
 PREHOOK: query: analyze table depts compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@depts
 PREHOOK: Output: default@depts
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table depts compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@depts
 POSTHOOK: Output: default@depts
 #### A masked pattern was here ####
@@ -105,12 +105,12 @@ POSTHOOK: Output: default@dependents
 POSTHOOK: Lineage: dependents.empid SCRIPT []
 POSTHOOK: Lineage: dependents.name SCRIPT []
 PREHOOK: query: analyze table dependents compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@dependents
 PREHOOK: Output: default@dependents
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table dependents compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@dependents
 POSTHOOK: Output: default@dependents
 #### A masked pattern was here ####
@@ -139,12 +139,12 @@ POSTHOOK: Output: default@locations
 POSTHOOK: Lineage: locations.locationid SCRIPT []
 POSTHOOK: Lineage: locations.name SCRIPT []
 PREHOOK: query: analyze table locations compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@locations
 PREHOOK: Output: default@locations
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table locations compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@locations
 POSTHOOK: Output: default@locations
 #### A masked pattern was here ####
@@ -189,12 +189,12 @@ POSTHOOK: Input: default@emps
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
 PREHOOK: query: analyze table mv1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@mv1
 PREHOOK: Output: default@mv1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table mv1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@mv1
 POSTHOOK: Output: default@mv1
 #### A masked pattern was here ####
@@ -262,12 +262,12 @@ POSTHOOK: Input: default@emps
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
 PREHOOK: query: analyze table mv1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@mv1
 PREHOOK: Output: default@mv1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table mv1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@mv1
 POSTHOOK: Output: default@mv1
 #### A masked pattern was here ####
@@ -339,12 +339,12 @@ POSTHOOK: Input: default@emps
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
 PREHOOK: query: analyze table mv1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@mv1
 PREHOOK: Output: default@mv1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table mv1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@mv1
 POSTHOOK: Output: default@mv1
 #### A masked pattern was here ####
@@ -414,12 +414,12 @@ POSTHOOK: Input: default@emps
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
 PREHOOK: query: analyze table mv1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@mv1
 PREHOOK: Output: default@mv1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table mv1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@mv1
 POSTHOOK: Output: default@mv1
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_4.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_4.q.out
index 4da2ed316d..e043441118 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_4.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_4.q.out
@@ -34,12 +34,12 @@ POSTHOOK: Lineage: emps.empid SCRIPT []
 POSTHOOK: Lineage: emps.name SCRIPT []
 POSTHOOK: Lineage: emps.salary SCRIPT []
 PREHOOK: query: analyze table emps compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@emps
 PREHOOK: Output: default@emps
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table emps compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@emps
 POSTHOOK: Output: default@emps
 #### A masked pattern was here ####
@@ -71,12 +71,12 @@ POSTHOOK: Lineage: depts.deptno SCRIPT []
 POSTHOOK: Lineage: depts.locationid SCRIPT []
 POSTHOOK: Lineage: depts.name SCRIPT []
 PREHOOK: query: analyze table depts compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@depts
 PREHOOK: Output: default@depts
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table depts compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@depts
 POSTHOOK: Output: default@depts
 #### A masked pattern was here ####
@@ -105,12 +105,12 @@ POSTHOOK: Output: default@dependents
 POSTHOOK: Lineage: dependents.empid SCRIPT []
 POSTHOOK: Lineage: dependents.name SCRIPT []
 PREHOOK: query: analyze table dependents compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@dependents
 PREHOOK: Output: default@dependents
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table dependents compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@dependents
 POSTHOOK: Output: default@dependents
 #### A masked pattern was here ####
@@ -139,12 +139,12 @@ POSTHOOK: Output: default@locations
 POSTHOOK: Lineage: locations.locationid SCRIPT []
 POSTHOOK: Lineage: locations.name SCRIPT []
 PREHOOK: query: analyze table locations compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@locations
 PREHOOK: Output: default@locations
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table locations compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@locations
 POSTHOOK: Output: default@locations
 #### A masked pattern was here ####
@@ -187,12 +187,12 @@ POSTHOOK: Input: default@emps
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
 PREHOOK: query: analyze table mv1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@mv1
 PREHOOK: Output: default@mv1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table mv1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@mv1
 POSTHOOK: Output: default@mv1
 #### A masked pattern was here ####
@@ -301,12 +301,12 @@ POSTHOOK: Input: default@emps
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
 PREHOOK: query: analyze table mv1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@mv1
 PREHOOK: Output: default@mv1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table mv1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@mv1
 POSTHOOK: Output: default@mv1
 #### A masked pattern was here ####
@@ -376,12 +376,12 @@ POSTHOOK: Input: default@emps
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
 PREHOOK: query: analyze table mv1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@mv1
 PREHOOK: Output: default@mv1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table mv1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@mv1
 POSTHOOK: Output: default@mv1
 #### A masked pattern was here ####
@@ -498,12 +498,12 @@ POSTHOOK: Input: default@emps
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
 PREHOOK: query: analyze table mv1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@mv1
 PREHOOK: Output: default@mv1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table mv1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@mv1
 POSTHOOK: Output: default@mv1
 #### A masked pattern was here ####
@@ -618,12 +618,12 @@ POSTHOOK: Input: default@emps
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
 PREHOOK: query: analyze table mv1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@mv1
 PREHOOK: Output: default@mv1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table mv1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@mv1
 POSTHOOK: Output: default@mv1
 #### A masked pattern was here ####
@@ -748,12 +748,12 @@ POSTHOOK: Input: default@emps
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
 PREHOOK: query: analyze table mv1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@mv1
 PREHOOK: Output: default@mv1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table mv1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@mv1
 POSTHOOK: Output: default@mv1
 #### A masked pattern was here ####
@@ -921,12 +921,12 @@ POSTHOOK: Input: default@emps
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
 PREHOOK: query: analyze table mv1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@mv1
 PREHOOK: Output: default@mv1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table mv1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@mv1
 POSTHOOK: Output: default@mv1
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_5.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_5.q.out
index ceb5900d4b..a50e67f186 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_5.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_5.q.out
@@ -34,12 +34,12 @@ POSTHOOK: Lineage: emps.empid SCRIPT []
 POSTHOOK: Lineage: emps.name SCRIPT []
 POSTHOOK: Lineage: emps.salary SCRIPT []
 PREHOOK: query: analyze table emps compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@emps
 PREHOOK: Output: default@emps
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table emps compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@emps
 POSTHOOK: Output: default@emps
 #### A masked pattern was here ####
@@ -71,12 +71,12 @@ POSTHOOK: Lineage: depts.deptno SCRIPT []
 POSTHOOK: Lineage: depts.locationid SCRIPT []
 POSTHOOK: Lineage: depts.name SCRIPT []
 PREHOOK: query: analyze table depts compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@depts
 PREHOOK: Output: default@depts
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table depts compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@depts
 POSTHOOK: Output: default@depts
 #### A masked pattern was here ####
@@ -105,12 +105,12 @@ POSTHOOK: Output: default@dependents
 POSTHOOK: Lineage: dependents.empid SCRIPT []
 POSTHOOK: Lineage: dependents.name SCRIPT []
 PREHOOK: query: analyze table dependents compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@dependents
 PREHOOK: Output: default@dependents
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table dependents compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@dependents
 POSTHOOK: Output: default@dependents
 #### A masked pattern was here ####
@@ -139,12 +139,12 @@ POSTHOOK: Output: default@locations
 POSTHOOK: Lineage: locations.locationid SCRIPT []
 POSTHOOK: Lineage: locations.name SCRIPT []
 PREHOOK: query: analyze table locations compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@locations
 PREHOOK: Output: default@locations
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table locations compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@locations
 POSTHOOK: Output: default@locations
 #### A masked pattern was here ####
@@ -201,12 +201,12 @@ POSTHOOK: Input: default@emps
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
 PREHOOK: query: analyze table mv1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@mv1
 PREHOOK: Output: default@mv1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table mv1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@mv1
 POSTHOOK: Output: default@mv1
 #### A masked pattern was here ####
@@ -308,12 +308,12 @@ POSTHOOK: Input: default@emps
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
 PREHOOK: query: analyze table mv1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@mv1
 PREHOOK: Output: default@mv1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table mv1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@mv1
 POSTHOOK: Output: default@mv1
 #### A masked pattern was here ####
@@ -438,12 +438,12 @@ POSTHOOK: Input: default@locations
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
 PREHOOK: query: analyze table mv1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@mv1
 PREHOOK: Output: default@mv1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table mv1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@mv1
 POSTHOOK: Output: default@mv1
 #### A masked pattern was here ####
@@ -578,12 +578,12 @@ POSTHOOK: Input: default@emps
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
 PREHOOK: query: analyze table mv1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@mv1
 PREHOOK: Output: default@mv1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table mv1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@mv1
 POSTHOOK: Output: default@mv1
 #### A masked pattern was here ####
@@ -687,12 +687,12 @@ POSTHOOK: Input: default@emps
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
 PREHOOK: query: analyze table mv1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@mv1
 PREHOOK: Output: default@mv1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table mv1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@mv1
 POSTHOOK: Output: default@mv1
 #### A masked pattern was here ####
@@ -764,12 +764,12 @@ POSTHOOK: Input: default@emps
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
 PREHOOK: query: analyze table mv1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@mv1
 PREHOOK: Output: default@mv1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table mv1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@mv1
 POSTHOOK: Output: default@mv1
 #### A masked pattern was here ####
@@ -930,12 +930,12 @@ POSTHOOK: Input: default@emps
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
 PREHOOK: query: analyze table mv1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@mv1
 PREHOOK: Output: default@mv1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table mv1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@mv1
 POSTHOOK: Output: default@mv1
 #### A masked pattern was here ####
@@ -1100,12 +1100,12 @@ POSTHOOK: Input: default@emps
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
 PREHOOK: query: analyze table mv1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@mv1
 PREHOOK: Output: default@mv1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table mv1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@mv1
 POSTHOOK: Output: default@mv1
 #### A masked pattern was here ####
@@ -1182,12 +1182,12 @@ POSTHOOK: Input: default@emps
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
 PREHOOK: query: analyze table mv1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@mv1
 PREHOOK: Output: default@mv1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table mv1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@mv1
 POSTHOOK: Output: default@mv1
 #### A masked pattern was here ####
@@ -1259,12 +1259,12 @@ POSTHOOK: Input: default@emps
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
 PREHOOK: query: analyze table mv1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@mv1
 PREHOOK: Output: default@mv1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table mv1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@mv1
 POSTHOOK: Output: default@mv1
 #### A masked pattern was here ####
@@ -1331,12 +1331,12 @@ POSTHOOK: Input: default@emps
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
 PREHOOK: query: analyze table mv1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@mv1
 PREHOOK: Output: default@mv1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table mv1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@mv1
 POSTHOOK: Output: default@mv1
 #### A masked pattern was here ####
@@ -1415,12 +1415,12 @@ POSTHOOK: Input: default@emps
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
 PREHOOK: query: analyze table mv1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@mv1
 PREHOOK: Output: default@mv1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table mv1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@mv1
 POSTHOOK: Output: default@mv1
 #### A masked pattern was here ####
@@ -1498,12 +1498,12 @@ POSTHOOK: Input: default@emps
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
 PREHOOK: query: analyze table mv1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@mv1
 PREHOOK: Output: default@mv1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table mv1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@mv1
 POSTHOOK: Output: default@mv1
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_6.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_6.q.out
index 80c21eda9f..4cb36a09de 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_6.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_6.q.out
@@ -34,12 +34,12 @@ POSTHOOK: Lineage: emps.empid SCRIPT []
 POSTHOOK: Lineage: emps.name SCRIPT []
 POSTHOOK: Lineage: emps.salary SCRIPT []
 PREHOOK: query: analyze table emps compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@emps
 PREHOOK: Output: default@emps
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table emps compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@emps
 POSTHOOK: Output: default@emps
 #### A masked pattern was here ####
@@ -71,12 +71,12 @@ POSTHOOK: Lineage: depts.deptno SCRIPT []
 POSTHOOK: Lineage: depts.locationid SCRIPT []
 POSTHOOK: Lineage: depts.name SCRIPT []
 PREHOOK: query: analyze table depts compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@depts
 PREHOOK: Output: default@depts
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table depts compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@depts
 POSTHOOK: Output: default@depts
 #### A masked pattern was here ####
@@ -105,12 +105,12 @@ POSTHOOK: Output: default@dependents
 POSTHOOK: Lineage: dependents.empid SCRIPT []
 POSTHOOK: Lineage: dependents.name SCRIPT []
 PREHOOK: query: analyze table dependents compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@dependents
 PREHOOK: Output: default@dependents
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table dependents compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@dependents
 POSTHOOK: Output: default@dependents
 #### A masked pattern was here ####
@@ -139,12 +139,12 @@ POSTHOOK: Output: default@locations
 POSTHOOK: Lineage: locations.locationid SCRIPT []
 POSTHOOK: Lineage: locations.name SCRIPT []
 PREHOOK: query: analyze table locations compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@locations
 PREHOOK: Output: default@locations
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table locations compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@locations
 POSTHOOK: Output: default@locations
 #### A masked pattern was here ####
@@ -203,12 +203,12 @@ POSTHOOK: Input: default@emps
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
 PREHOOK: query: analyze table mv1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@mv1
 PREHOOK: Output: default@mv1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table mv1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@mv1
 POSTHOOK: Output: default@mv1
 #### A masked pattern was here ####
@@ -321,12 +321,12 @@ POSTHOOK: Input: default@emps
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
 PREHOOK: query: analyze table mv1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@mv1
 PREHOOK: Output: default@mv1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table mv1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@mv1
 POSTHOOK: Output: default@mv1
 #### A masked pattern was here ####
@@ -443,12 +443,12 @@ POSTHOOK: Input: default@emps
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
 PREHOOK: query: analyze table mv1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@mv1
 PREHOOK: Output: default@mv1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table mv1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@mv1
 POSTHOOK: Output: default@mv1
 #### A masked pattern was here ####
@@ -591,12 +591,12 @@ POSTHOOK: Input: default@emps
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
 PREHOOK: query: analyze table mv1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@mv1
 PREHOOK: Output: default@mv1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table mv1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@mv1
 POSTHOOK: Output: default@mv1
 #### A masked pattern was here ####
@@ -764,12 +764,12 @@ POSTHOOK: Input: default@emps
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
 PREHOOK: query: analyze table mv1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@mv1
 PREHOOK: Output: default@mv1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table mv1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@mv1
 POSTHOOK: Output: default@mv1
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_7.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_7.q.out
index a199902f0b..05a4b55c39 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_7.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_7.q.out
@@ -34,12 +34,12 @@ POSTHOOK: Lineage: emps.empid SCRIPT []
 POSTHOOK: Lineage: emps.name SCRIPT []
 POSTHOOK: Lineage: emps.salary SCRIPT []
 PREHOOK: query: analyze table emps compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@emps
 PREHOOK: Output: default@emps
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table emps compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@emps
 POSTHOOK: Output: default@emps
 #### A masked pattern was here ####
@@ -71,12 +71,12 @@ POSTHOOK: Lineage: depts.deptno SCRIPT []
 POSTHOOK: Lineage: depts.locationid SCRIPT []
 POSTHOOK: Lineage: depts.name SCRIPT []
 PREHOOK: query: analyze table depts compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@depts
 PREHOOK: Output: default@depts
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table depts compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@depts
 POSTHOOK: Output: default@depts
 #### A masked pattern was here ####
@@ -105,12 +105,12 @@ POSTHOOK: Output: default@dependents
 POSTHOOK: Lineage: dependents.empid SCRIPT []
 POSTHOOK: Lineage: dependents.name SCRIPT []
 PREHOOK: query: analyze table dependents compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@dependents
 PREHOOK: Output: default@dependents
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table dependents compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@dependents
 POSTHOOK: Output: default@dependents
 #### A masked pattern was here ####
@@ -139,12 +139,12 @@ POSTHOOK: Output: default@locations
 POSTHOOK: Lineage: locations.locationid SCRIPT []
 POSTHOOK: Lineage: locations.name SCRIPT []
 PREHOOK: query: analyze table locations compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@locations
 PREHOOK: Output: default@locations
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table locations compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@locations
 POSTHOOK: Output: default@locations
 #### A masked pattern was here ####
@@ -219,12 +219,12 @@ POSTHOOK: Input: default@locations
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
 PREHOOK: query: analyze table mv1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@mv1
 PREHOOK: Output: default@mv1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table mv1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@mv1
 POSTHOOK: Output: default@mv1
 #### A masked pattern was here ####
@@ -510,12 +510,12 @@ POSTHOOK: Input: default@locations
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
 PREHOOK: query: analyze table mv1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@mv1
 PREHOOK: Output: default@mv1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table mv1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@mv1
 POSTHOOK: Output: default@mv1
 #### A masked pattern was here ####
@@ -829,12 +829,12 @@ POSTHOOK: Input: default@emps
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
 PREHOOK: query: analyze table mv1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@mv1
 PREHOOK: Output: default@mv1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table mv1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@mv1
 POSTHOOK: Output: default@mv1
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_8.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_8.q.out
index 3dcbd5575e..5ac648478e 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_8.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_8.q.out
@@ -41,12 +41,12 @@ POSTHOOK: Lineage: source_table_001.my_id SCRIPT []
 POSTHOOK: Lineage: source_table_001.my_id2 SCRIPT []
 POSTHOOK: Lineage: source_table_001.up_volume SCRIPT []
 PREHOOK: query: analyze table source_table_001 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@source_table_001
 PREHOOK: Output: default@source_table_001
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table source_table_001 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@source_table_001
 POSTHOOK: Output: default@source_table_001
 #### A masked pattern was here ####
@@ -73,12 +73,12 @@ POSTHOOK: Input: default@source_table_001
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@source_table_001_mv
 PREHOOK: query: analyze table source_table_001_mv compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@source_table_001_mv
 PREHOOK: Output: default@source_table_001_mv
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table source_table_001_mv compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@source_table_001_mv
 POSTHOOK: Output: default@source_table_001_mv
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_9.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_9.q.out
index 63daf6ccb0..8626288e90 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_9.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_9.q.out
@@ -41,12 +41,12 @@ POSTHOOK: Lineage: source_table_001.my_id SCRIPT []
 POSTHOOK: Lineage: source_table_001.my_id2 SCRIPT []
 POSTHOOK: Lineage: source_table_001.up_volume SCRIPT []
 PREHOOK: query: analyze table source_table_001 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@source_table_001
 PREHOOK: Output: default@source_table_001
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table source_table_001 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@source_table_001
 POSTHOOK: Output: default@source_table_001
 #### A masked pattern was here ####
@@ -73,12 +73,12 @@ POSTHOOK: Input: default@source_table_001
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@source_table_001_mv
 PREHOOK: query: analyze table source_table_001_mv compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@source_table_001_mv
 PREHOOK: Output: default@source_table_001_mv
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table source_table_001_mv compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@source_table_001_mv
 POSTHOOK: Output: default@source_table_001_mv
 #### A masked pattern was here ####
@@ -189,12 +189,12 @@ POSTHOOK: Input: default@source_table_001
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@source_table_001_mv
 PREHOOK: query: analyze table source_table_001_mv compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@source_table_001_mv
 PREHOOK: Output: default@source_table_001_mv
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table source_table_001_mv compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@source_table_001_mv
 POSTHOOK: Output: default@source_table_001_mv
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_ssb.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_ssb.q.out
index 3236d00e2c..665395e2b0 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_ssb.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_ssb.q.out
@@ -529,52 +529,52 @@ POSTHOOK: Lineage: lineorder.lo_suppkey SIMPLE [(lineorder_ext)lineorder_ext.Fie
 POSTHOOK: Lineage: lineorder.lo_supplycost SIMPLE [(lineorder_ext)lineorder_ext.FieldSchema(name:lo_supplycost, type:double, comment:null), ]
 POSTHOOK: Lineage: lineorder.lo_tax SIMPLE [(lineorder_ext)lineorder_ext.FieldSchema(name:lo_tax, type:double, comment:null), ]
 PREHOOK: query: analyze table customer compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@customer
 PREHOOK: Output: default@customer
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table customer compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@customer
 POSTHOOK: Output: default@customer
 #### A masked pattern was here ####
 PREHOOK: query: analyze table dates compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@dates
 PREHOOK: Output: default@dates
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table dates compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@dates
 POSTHOOK: Output: default@dates
 #### A masked pattern was here ####
 PREHOOK: query: analyze table ssb_part compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@ssb_part
 PREHOOK: Output: default@ssb_part
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table ssb_part compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@ssb_part
 POSTHOOK: Output: default@ssb_part
 #### A masked pattern was here ####
 PREHOOK: query: analyze table supplier compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@supplier
 PREHOOK: Output: default@supplier
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table supplier compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@supplier
 POSTHOOK: Output: default@supplier
 #### A masked pattern was here ####
 PREHOOK: query: analyze table lineorder compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@lineorder
 PREHOOK: Output: default@lineorder
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table lineorder compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@lineorder
 POSTHOOK: Output: default@lineorder
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_ssb_2.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_ssb_2.q.out
index 36ecc1388a..7189a02cae 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_ssb_2.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_ssb_2.q.out
@@ -529,52 +529,52 @@ POSTHOOK: Lineage: lineorder.lo_suppkey SIMPLE [(lineorder_ext)lineorder_ext.Fie
 POSTHOOK: Lineage: lineorder.lo_supplycost SIMPLE [(lineorder_ext)lineorder_ext.FieldSchema(name:lo_supplycost, type:double, comment:null), ]
 POSTHOOK: Lineage: lineorder.lo_tax SIMPLE [(lineorder_ext)lineorder_ext.FieldSchema(name:lo_tax, type:double, comment:null), ]
 PREHOOK: query: analyze table customer compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@customer
 PREHOOK: Output: default@customer
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table customer compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@customer
 POSTHOOK: Output: default@customer
 #### A masked pattern was here ####
 PREHOOK: query: analyze table dates compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@dates
 PREHOOK: Output: default@dates
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table dates compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@dates
 POSTHOOK: Output: default@dates
 #### A masked pattern was here ####
 PREHOOK: query: analyze table ssb_part compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@ssb_part
 PREHOOK: Output: default@ssb_part
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table ssb_part compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@ssb_part
 POSTHOOK: Output: default@ssb_part
 #### A masked pattern was here ####
 PREHOOK: query: analyze table supplier compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@supplier
 PREHOOK: Output: default@supplier
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table supplier compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@supplier
 POSTHOOK: Output: default@supplier
 #### A masked pattern was here ####
 PREHOOK: query: analyze table lineorder compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@lineorder
 PREHOOK: Output: default@lineorder
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table lineorder compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@lineorder
 POSTHOOK: Output: default@lineorder
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/llap/metadata_only_queries.q.out b/ql/src/test/results/clientpositive/llap/metadata_only_queries.q.out
index ed26c0378a..2a74d829a2 100644
--- a/ql/src/test/results/clientpositive/llap/metadata_only_queries.q.out
+++ b/ql/src/test/results/clientpositive/llap/metadata_only_queries.q.out
@@ -433,52 +433,52 @@ STAGE PLANS:
         ListSink
 
 PREHOOK: query: analyze table stats_tbl compute statistics for columns t,si,i,b,f,d,bo,s,bin
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@stats_tbl
 PREHOOK: Output: default@stats_tbl
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table stats_tbl compute statistics for columns t,si,i,b,f,d,bo,s,bin
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@stats_tbl
 POSTHOOK: Output: default@stats_tbl
 #### A masked pattern was here ####
 PREHOOK: query: analyze table stats_tbl_part partition(dt='2010') compute statistics for columns t,si,i,b,f,d,bo,s,bin
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@stats_tbl_part
 PREHOOK: Input: default@stats_tbl_part@dt=2010
 PREHOOK: Output: default@stats_tbl_part
 PREHOOK: Output: default@stats_tbl_part@dt=2010
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table stats_tbl_part partition(dt='2010') compute statistics for columns t,si,i,b,f,d,bo,s,bin
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@stats_tbl_part
 POSTHOOK: Input: default@stats_tbl_part@dt=2010
 POSTHOOK: Output: default@stats_tbl_part
 POSTHOOK: Output: default@stats_tbl_part@dt=2010
 #### A masked pattern was here ####
 PREHOOK: query: analyze table stats_tbl_part partition(dt='2011') compute statistics for columns t,si,i,b,f,d,bo,s,bin
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@stats_tbl_part
 PREHOOK: Input: default@stats_tbl_part@dt=2011
 PREHOOK: Output: default@stats_tbl_part
 PREHOOK: Output: default@stats_tbl_part@dt=2011
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table stats_tbl_part partition(dt='2011') compute statistics for columns t,si,i,b,f,d,bo,s,bin
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@stats_tbl_part
 POSTHOOK: Input: default@stats_tbl_part@dt=2011
 POSTHOOK: Output: default@stats_tbl_part
 POSTHOOK: Output: default@stats_tbl_part@dt=2011
 #### A masked pattern was here ####
 PREHOOK: query: analyze table stats_tbl_part partition(dt='2012') compute statistics for columns t,si,i,b,f,d,bo,s,bin
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@stats_tbl_part
 PREHOOK: Input: default@stats_tbl_part@dt=2012
 PREHOOK: Output: default@stats_tbl_part
 PREHOOK: Output: default@stats_tbl_part@dt=2012
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table stats_tbl_part partition(dt='2012') compute statistics for columns t,si,i,b,f,d,bo,s,bin
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@stats_tbl_part
 POSTHOOK: Input: default@stats_tbl_part@dt=2012
 POSTHOOK: Output: default@stats_tbl_part
diff --git a/ql/src/test/results/clientpositive/llap/metadata_only_queries_with_filters.q.out b/ql/src/test/results/clientpositive/llap/metadata_only_queries_with_filters.q.out
index 79d9d27203..244afcf0a2 100644
--- a/ql/src/test/results/clientpositive/llap/metadata_only_queries_with_filters.q.out
+++ b/ql/src/test/results/clientpositive/llap/metadata_only_queries_with_filters.q.out
@@ -123,28 +123,28 @@ POSTHOOK: Output: default@stats_tbl_part
 POSTHOOK: Output: default@stats_tbl_part@dt=2010
 POSTHOOK: Output: default@stats_tbl_part@dt=2014
 PREHOOK: query: analyze table stats_tbl_part partition(dt=2010) compute statistics for columns t,si,i,b,f,d,bo,s,bin
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@stats_tbl_part
 PREHOOK: Input: default@stats_tbl_part@dt=2010
 PREHOOK: Output: default@stats_tbl_part
 PREHOOK: Output: default@stats_tbl_part@dt=2010
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table stats_tbl_part partition(dt=2010) compute statistics for columns t,si,i,b,f,d,bo,s,bin
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@stats_tbl_part
 POSTHOOK: Input: default@stats_tbl_part@dt=2010
 POSTHOOK: Output: default@stats_tbl_part
 POSTHOOK: Output: default@stats_tbl_part@dt=2010
 #### A masked pattern was here ####
 PREHOOK: query: analyze table stats_tbl_part partition(dt=2014) compute statistics for columns t,si,i,b,f,d,bo,s,bin
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@stats_tbl_part
 PREHOOK: Input: default@stats_tbl_part@dt=2014
 PREHOOK: Output: default@stats_tbl_part
 PREHOOK: Output: default@stats_tbl_part@dt=2014
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table stats_tbl_part partition(dt=2014) compute statistics for columns t,si,i,b,f,d,bo,s,bin
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@stats_tbl_part
 POSTHOOK: Input: default@stats_tbl_part@dt=2014
 POSTHOOK: Output: default@stats_tbl_part
diff --git a/ql/src/test/results/clientpositive/llap/schema_evol_stats.q.out b/ql/src/test/results/clientpositive/llap/schema_evol_stats.q.out
index 2aff794bcf..a90743f422 100644
--- a/ql/src/test/results/clientpositive/llap/schema_evol_stats.q.out
+++ b/ql/src/test/results/clientpositive/llap/schema_evol_stats.q.out
@@ -37,7 +37,7 @@ POSTHOOK: Lineage: partitioned1 PARTITION(part=2).b SCRIPT []
 POSTHOOK: Lineage: partitioned1 PARTITION(part=2).c SCRIPT []
 POSTHOOK: Lineage: partitioned1 PARTITION(part=2).d SCRIPT []
 PREHOOK: query: analyze table partitioned1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@partitioned1
 PREHOOK: Input: default@partitioned1@part=1
 PREHOOK: Input: default@partitioned1@part=2
@@ -46,7 +46,7 @@ PREHOOK: Output: default@partitioned1@part=1
 PREHOOK: Output: default@partitioned1@part=2
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table partitioned1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@partitioned1
 POSTHOOK: Input: default@partitioned1@part=1
 POSTHOOK: Input: default@partitioned1@part=2
@@ -243,7 +243,7 @@ POSTHOOK: Lineage: partitioned1 PARTITION(part=2).b SCRIPT []
 POSTHOOK: Lineage: partitioned1 PARTITION(part=2).c SCRIPT []
 POSTHOOK: Lineage: partitioned1 PARTITION(part=2).d SCRIPT []
 PREHOOK: query: analyze table partitioned1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@partitioned1
 PREHOOK: Input: default@partitioned1@part=1
 PREHOOK: Input: default@partitioned1@part=2
@@ -252,7 +252,7 @@ PREHOOK: Output: default@partitioned1@part=1
 PREHOOK: Output: default@partitioned1@part=2
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table partitioned1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@partitioned1
 POSTHOOK: Input: default@partitioned1@part=1
 POSTHOOK: Input: default@partitioned1@part=2
diff --git a/ql/src/test/results/clientpositive/llap/semijoin_hint.q.out b/ql/src/test/results/clientpositive/llap/semijoin_hint.q.out
index d532feec4f..f2cef7a773 100644
--- a/ql/src/test/results/clientpositive/llap/semijoin_hint.q.out
+++ b/ql/src/test/results/clientpositive/llap/semijoin_hint.q.out
@@ -103,17 +103,17 @@ POSTHOOK: Output: default@srcpart_small@ds=2008-04-09
 POSTHOOK: Lineage: srcpart_small PARTITION(ds=2008-04-09).key1 SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: srcpart_small PARTITION(ds=2008-04-09).value1 SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: analyze table alltypesorc_int compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@alltypesorc_int
 PREHOOK: Output: default@alltypesorc_int
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table alltypesorc_int compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@alltypesorc_int
 POSTHOOK: Output: default@alltypesorc_int
 #### A masked pattern was here ####
 PREHOOK: query: analyze table srcpart_date compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@srcpart_date
 PREHOOK: Input: default@srcpart_date@ds=2008-04-08
 PREHOOK: Input: default@srcpart_date@ds=2008-04-09
@@ -122,7 +122,7 @@ PREHOOK: Output: default@srcpart_date@ds=2008-04-08
 PREHOOK: Output: default@srcpart_date@ds=2008-04-09
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table srcpart_date compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@srcpart_date
 POSTHOOK: Input: default@srcpart_date@ds=2008-04-08
 POSTHOOK: Input: default@srcpart_date@ds=2008-04-09
@@ -131,7 +131,7 @@ POSTHOOK: Output: default@srcpart_date@ds=2008-04-08
 POSTHOOK: Output: default@srcpart_date@ds=2008-04-09
 #### A masked pattern was here ####
 PREHOOK: query: analyze table srcpart_small compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@srcpart_small
 PREHOOK: Input: default@srcpart_small@ds=2008-04-08
 PREHOOK: Input: default@srcpart_small@ds=2008-04-09
@@ -140,7 +140,7 @@ PREHOOK: Output: default@srcpart_small@ds=2008-04-08
 PREHOOK: Output: default@srcpart_small@ds=2008-04-09
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table srcpart_small compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@srcpart_small
 POSTHOOK: Input: default@srcpart_small@ds=2008-04-08
 POSTHOOK: Input: default@srcpart_small@ds=2008-04-09
diff --git a/ql/src/test/results/clientpositive/llap/special_character_in_tabnames_1.q.out b/ql/src/test/results/clientpositive/llap/special_character_in_tabnames_1.q.out
index 31c97b0c6f..2faff5593f 100644
--- a/ql/src/test/results/clientpositive/llap/special_character_in_tabnames_1.q.out
+++ b/ql/src/test/results/clientpositive/llap/special_character_in_tabnames_1.q.out
@@ -159,14 +159,14 @@ POSTHOOK: Input: default@c/b/o_t1@dt=2014
 POSTHOOK: Output: default@c/b/o_t1
 POSTHOOK: Output: default@c/b/o_t1@dt=2014
 PREHOOK: query: analyze table `c/b/o_t1` compute statistics for columns key, value, c_int, c_float, c_boolean
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@c/b/o_t1
 PREHOOK: Input: default@c/b/o_t1@dt=2014
 PREHOOK: Output: default@c/b/o_t1
 PREHOOK: Output: default@c/b/o_t1@dt=2014
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table `c/b/o_t1` compute statistics for columns key, value, c_int, c_float, c_boolean
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@c/b/o_t1
 POSTHOOK: Input: default@c/b/o_t1@dt=2014
 POSTHOOK: Output: default@c/b/o_t1
@@ -185,14 +185,14 @@ POSTHOOK: Input: default@//cbo_t2@dt=2014
 POSTHOOK: Output: default@//cbo_t2
 POSTHOOK: Output: default@//cbo_t2@dt=2014
 PREHOOK: query: analyze table `//cbo_t2` compute statistics for columns key, value, c_int, c_float, c_boolean
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@//cbo_t2
 PREHOOK: Input: default@//cbo_t2@dt=2014
 PREHOOK: Output: default@//cbo_t2
 PREHOOK: Output: default@//cbo_t2@dt=2014
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table `//cbo_t2` compute statistics for columns key, value, c_int, c_float, c_boolean
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@//cbo_t2
 POSTHOOK: Input: default@//cbo_t2@dt=2014
 POSTHOOK: Output: default@//cbo_t2
@@ -207,12 +207,12 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@cbo_/t3////
 POSTHOOK: Output: default@cbo_/t3////
 PREHOOK: query: analyze table `cbo_/t3////` compute statistics for columns key, value, c_int, c_float, c_boolean
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@cbo_/t3////
 PREHOOK: Output: default@cbo_/t3////
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table `cbo_/t3////` compute statistics for columns key, value, c_int, c_float, c_boolean
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@cbo_/t3////
 POSTHOOK: Output: default@cbo_/t3////
 #### A masked pattern was here ####
@@ -225,12 +225,12 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src/_/cbo
 POSTHOOK: Output: default@src/_/cbo
 PREHOOK: query: analyze table `src/_/cbo` compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@src/_/cbo
 PREHOOK: Output: default@src/_/cbo
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table `src/_/cbo` compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@src/_/cbo
 POSTHOOK: Output: default@src/_/cbo
 #### A masked pattern was here ####
@@ -243,12 +243,12 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@p/a/r/t
 POSTHOOK: Output: default@p/a/r/t
 PREHOOK: query: analyze table `p/a/r/t` compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@p/a/r/t
 PREHOOK: Output: default@p/a/r/t
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table `p/a/r/t` compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@p/a/r/t
 POSTHOOK: Output: default@p/a/r/t
 #### A masked pattern was here ####
@@ -261,12 +261,12 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@line/item
 POSTHOOK: Output: default@line/item
 PREHOOK: query: analyze table `line/item` compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@line/item
 PREHOOK: Output: default@line/item
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table `line/item` compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@line/item
 POSTHOOK: Output: default@line/item
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/llap/stats_date.q.out b/ql/src/test/results/clientpositive/llap/stats_date.q.out
index 3ccf400afa..a4431e33e2 100644
--- a/ql/src/test/results/clientpositive/llap/stats_date.q.out
+++ b/ql/src/test/results/clientpositive/llap/stats_date.q.out
@@ -17,12 +17,12 @@ POSTHOOK: Output: default@foo
 POSTHOOK: Lineage: foo.x SCRIPT []
 POSTHOOK: Lineage: foo.y SCRIPT []
 PREHOOK: query: analyze table foo compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@foo
 PREHOOK: Output: default@foo
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table foo compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@foo
 POSTHOOK: Output: default@foo
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/llap/stats_only_null.q.out b/ql/src/test/results/clientpositive/llap/stats_only_null.q.out
index 9b54ddbe03..82738729b5 100644
--- a/ql/src/test/results/clientpositive/llap/stats_only_null.q.out
+++ b/ql/src/test/results/clientpositive/llap/stats_only_null.q.out
@@ -187,38 +187,38 @@ STAGE PLANS:
         ListSink
 
 PREHOOK: query: analyze table stats_null compute statistics for columns a,b,c,d
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@stats_null
 PREHOOK: Output: default@stats_null
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table stats_null compute statistics for columns a,b,c,d
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@stats_null
 POSTHOOK: Output: default@stats_null
 #### A masked pattern was here ####
 PREHOOK: query: analyze table stats_null_part partition(dt='2010') compute statistics for columns a,b,c,d
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@stats_null_part
 PREHOOK: Input: default@stats_null_part@dt=2010
 PREHOOK: Output: default@stats_null_part
 PREHOOK: Output: default@stats_null_part@dt=2010
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table stats_null_part partition(dt='2010') compute statistics for columns a,b,c,d
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@stats_null_part
 POSTHOOK: Input: default@stats_null_part@dt=2010
 POSTHOOK: Output: default@stats_null_part
 POSTHOOK: Output: default@stats_null_part@dt=2010
 #### A masked pattern was here ####
 PREHOOK: query: analyze table stats_null_part partition(dt='2011') compute statistics for columns a,b,c,d
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@stats_null_part
 PREHOOK: Input: default@stats_null_part@dt=2011
 PREHOOK: Output: default@stats_null_part
 PREHOOK: Output: default@stats_null_part@dt=2011
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table stats_null_part partition(dt='2011') compute statistics for columns a,b,c,d
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@stats_null_part
 POSTHOOK: Input: default@stats_null_part@dt=2011
 POSTHOOK: Output: default@stats_null_part
@@ -386,7 +386,7 @@ POSTHOOK: Lineage: stats_null_part PARTITION(dt=__HIVE_DEFAULT_PARTITION__).b SI
 POSTHOOK: Lineage: stats_null_part PARTITION(dt=__HIVE_DEFAULT_PARTITION__).c SIMPLE [(temps_null)temps_null.FieldSchema(name:c, type:string, comment:null), ]
 POSTHOOK: Lineage: stats_null_part PARTITION(dt=__HIVE_DEFAULT_PARTITION__).d SIMPLE [(temps_null)temps_null.FieldSchema(name:d, type:smallint, comment:null), ]
 PREHOOK: query: analyze table stats_null_part compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@stats_null_part
 PREHOOK: Input: default@stats_null_part@dt=1
 PREHOOK: Input: default@stats_null_part@dt=__HIVE_DEFAULT_PARTITION__
@@ -395,7 +395,7 @@ PREHOOK: Output: default@stats_null_part@dt=1
 PREHOOK: Output: default@stats_null_part@dt=__HIVE_DEFAULT_PARTITION__
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table stats_null_part compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@stats_null_part
 POSTHOOK: Input: default@stats_null_part@dt=1
 POSTHOOK: Input: default@stats_null_part@dt=__HIVE_DEFAULT_PARTITION__
diff --git a/ql/src/test/results/clientpositive/llap/tez_smb_main.q.out b/ql/src/test/results/clientpositive/llap/tez_smb_main.q.out
index ee5638245e..76e2dd0960 100644
--- a/ql/src/test/results/clientpositive/llap/tez_smb_main.q.out
+++ b/ql/src/test/results/clientpositive/llap/tez_smb_main.q.out
@@ -263,19 +263,19 @@ STAGE PLANS:
             Map Operator Tree:
                 TableScan
                   alias: a
-                  Statistics: Num rows: 242 Data size: 968 Basic stats: COMPLETE Column stats: COMPLETE
+                  Statistics: Num rows: 242 Data size: 3490 Basic stats: COMPLETE Column stats: NONE
                   Filter Operator
                     predicate: key is not null (type: boolean)
-                    Statistics: Num rows: 242 Data size: 968 Basic stats: COMPLETE Column stats: COMPLETE
+                    Statistics: Num rows: 230 Data size: 3316 Basic stats: COMPLETE Column stats: NONE
                     Select Operator
                       expressions: key (type: int)
                       outputColumnNames: _col0
-                      Statistics: Num rows: 242 Data size: 968 Basic stats: COMPLETE Column stats: COMPLETE
+                      Statistics: Num rows: 230 Data size: 3316 Basic stats: COMPLETE Column stats: NONE
                       Reduce Output Operator
                         key expressions: _col0 (type: int)
                         sort order: +
                         Map-reduce partition columns: _col0 (type: int)
-                        Statistics: Num rows: 242 Data size: 968 Basic stats: COMPLETE Column stats: COMPLETE
+                        Statistics: Num rows: 230 Data size: 3316 Basic stats: COMPLETE Column stats: NONE
             Execution mode: vectorized, llap
             LLAP IO: no inputs
         Map 2 
@@ -1838,8 +1838,7 @@ STAGE PLANS:
     Tez
 #### A masked pattern was here ####
       Edges:
-        Reducer 2 <- Map 1 (SIMPLE_EDGE)
-        Reducer 4 <- Map 3 (SIMPLE_EDGE), Reducer 2 (CUSTOM_SIMPLE_EDGE)
+        Reducer 4 <- Map 1 (SIMPLE_EDGE), Map 3 (SIMPLE_EDGE)
         Reducer 5 <- Reducer 4 (CUSTOM_SIMPLE_EDGE)
 #### A masked pattern was here ####
       Vertices:
@@ -1879,33 +1878,24 @@ STAGE PLANS:
                         Statistics: Num rows: 475 Data size: 90060 Basic stats: COMPLETE Column stats: NONE
             Execution mode: vectorized, llap
             LLAP IO: no inputs
-        Reducer 2 
-            Execution mode: vectorized, llap
+        Reducer 4 
             Reduce Operator Tree:
               Select Operator
                 expressions: KEY.reducesinkkey0 (type: int)
                 outputColumnNames: _col0
-                Statistics: Num rows: 242 Data size: 968 Basic stats: COMPLETE Column stats: COMPLETE
-                Reduce Output Operator
-                  key expressions: _col0 (type: int)
-                  sort order: +
-                  Map-reduce partition columns: _col0 (type: int)
-                  Statistics: Num rows: 242 Data size: 968 Basic stats: COMPLETE Column stats: COMPLETE
-        Reducer 4 
-            Execution mode: vectorized, llap
+                Statistics: Num rows: 230 Data size: 43713 Basic stats: COMPLETE Column stats: NONE
+            Execution mode: llap
             Reduce Operator Tree:
               Select Operator
                 expressions: KEY.reducesinkkey0 (type: int)
                 outputColumnNames: _col0
                 Statistics: Num rows: 475 Data size: 90060 Basic stats: COMPLETE Column stats: NONE
-                Map Join Operator
+                Merge Join Operator
                   condition map:
                        Inner Join 0 to 1
                   keys:
                     0 _col0 (type: int)
                     1 _col0 (type: int)
-                  input vertices:
-                    0 Reducer 2
                   Statistics: Num rows: 522 Data size: 99066 Basic stats: COMPLETE Column stats: NONE
                   Group By Operator
                     aggregations: count()
diff --git a/ql/src/test/results/clientpositive/llap/union_fast_stats.q.out b/ql/src/test/results/clientpositive/llap/union_fast_stats.q.out
index 4ca5f47a85..4f80cbfff9 100644
--- a/ql/src/test/results/clientpositive/llap/union_fast_stats.q.out
+++ b/ql/src/test/results/clientpositive/llap/union_fast_stats.q.out
@@ -178,8 +178,8 @@ Table Parameters:
 	COLUMN_STATS_ACCURATE	{\"BASIC_STATS\":\"true\"}
 	bucketing_version   	2                   
 	numFiles            	3                   
-	numRows             	15                  
-	rawDataSize         	3483                
+	numRows             	5                   
+	rawDataSize         	1069                
 	totalSize           	4033                
 #### A masked pattern was here ####
 	 	 
diff --git a/ql/src/test/results/clientpositive/llap/union_remove_26.q.out b/ql/src/test/results/clientpositive/llap/union_remove_26.q.out
index 05c5e04043..eee93a64de 100644
--- a/ql/src/test/results/clientpositive/llap/union_remove_26.q.out
+++ b/ql/src/test/results/clientpositive/llap/union_remove_26.q.out
@@ -101,22 +101,22 @@ POSTHOOK: Output: default@inputtbl3
 POSTHOOK: Lineage: inputtbl3.key SIMPLE [(inputsrctbl3)inputsrctbl3.FieldSchema(name:key, type:string, comment:null), ]
 POSTHOOK: Lineage: inputtbl3.val SIMPLE [(inputsrctbl3)inputsrctbl3.FieldSchema(name:val, type:int, comment:null), ]
 PREHOOK: query: analyze table inputTbl1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@inputtbl1
 PREHOOK: Output: default@inputtbl1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table inputTbl1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@inputtbl1
 POSTHOOK: Output: default@inputtbl1
 #### A masked pattern was here ####
 PREHOOK: query: analyze table inputTbl3 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@inputtbl3
 PREHOOK: Output: default@inputtbl3
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table inputTbl3 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@inputtbl3
 POSTHOOK: Output: default@inputtbl3
 #### A masked pattern was here ####
@@ -284,12 +284,12 @@ POSTHOOK: Input: default@inputtbl3
 #### A masked pattern was here ####
 3
 PREHOOK: query: analyze table inputTbl2 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@inputtbl2
 PREHOOK: Output: default@inputtbl2
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table inputTbl2 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@inputtbl2
 POSTHOOK: Output: default@inputtbl2
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/llap/vector_annotate_stats_select.q.out b/ql/src/test/results/clientpositive/llap/vector_annotate_stats_select.q.out
index 5613b6db9a..109fe3fa1c 100644
--- a/ql/src/test/results/clientpositive/llap/vector_annotate_stats_select.q.out
+++ b/ql/src/test/results/clientpositive/llap/vector_annotate_stats_select.q.out
@@ -128,12 +128,12 @@ STAGE PLANS:
         ListSink
 
 PREHOOK: query: analyze table alltypes_orc compute statistics for columns bo1, ti1, si1, i1, bi1, f1, d1, s1, vc1
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@alltypes_orc
 PREHOOK: Output: default@alltypes_orc
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table alltypes_orc compute statistics for columns bo1, ti1, si1, i1, bi1, f1, d1, s1, vc1
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@alltypes_orc
 POSTHOOK: Output: default@alltypes_orc
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/llap/vector_outer_join1.q.out b/ql/src/test/results/clientpositive/llap/vector_outer_join1.q.out
index 4901e834ad..0bce01dab6 100644
--- a/ql/src/test/results/clientpositive/llap/vector_outer_join1.q.out
+++ b/ql/src/test/results/clientpositive/llap/vector_outer_join1.q.out
@@ -184,12 +184,12 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@small_alltypesorc_a
 POSTHOOK: Output: default@small_alltypesorc_a
 PREHOOK: query: ANALYZE TABLE small_alltypesorc_a COMPUTE STATISTICS FOR COLUMNS
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@small_alltypesorc_a
 PREHOOK: Output: default@small_alltypesorc_a
 #### A masked pattern was here ####
 POSTHOOK: query: ANALYZE TABLE small_alltypesorc_a COMPUTE STATISTICS FOR COLUMNS
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@small_alltypesorc_a
 POSTHOOK: Output: default@small_alltypesorc_a
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/llap/vector_outer_join2.q.out b/ql/src/test/results/clientpositive/llap/vector_outer_join2.q.out
index a841d4cb8c..bfafc4e686 100644
--- a/ql/src/test/results/clientpositive/llap/vector_outer_join2.q.out
+++ b/ql/src/test/results/clientpositive/llap/vector_outer_join2.q.out
@@ -189,12 +189,12 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@small_alltypesorc_a
 POSTHOOK: Output: default@small_alltypesorc_a
 PREHOOK: query: ANALYZE TABLE small_alltypesorc_a COMPUTE STATISTICS FOR COLUMNS
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@small_alltypesorc_a
 PREHOOK: Output: default@small_alltypesorc_a
 #### A masked pattern was here ####
 POSTHOOK: query: ANALYZE TABLE small_alltypesorc_a COMPUTE STATISTICS FOR COLUMNS
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@small_alltypesorc_a
 POSTHOOK: Output: default@small_alltypesorc_a
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/llap/vector_outer_join3.q.out b/ql/src/test/results/clientpositive/llap/vector_outer_join3.q.out
index f8d1ec2425..428a63b399 100644
--- a/ql/src/test/results/clientpositive/llap/vector_outer_join3.q.out
+++ b/ql/src/test/results/clientpositive/llap/vector_outer_join3.q.out
@@ -189,12 +189,12 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@small_alltypesorc_a
 POSTHOOK: Output: default@small_alltypesorc_a
 PREHOOK: query: ANALYZE TABLE small_alltypesorc_a COMPUTE STATISTICS FOR COLUMNS
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@small_alltypesorc_a
 PREHOOK: Output: default@small_alltypesorc_a
 #### A masked pattern was here ####
 POSTHOOK: query: ANALYZE TABLE small_alltypesorc_a COMPUTE STATISTICS FOR COLUMNS
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@small_alltypesorc_a
 POSTHOOK: Output: default@small_alltypesorc_a
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/llap/vector_outer_join4.q.out b/ql/src/test/results/clientpositive/llap/vector_outer_join4.q.out
index a55250b9f4..8b2d98951a 100644
--- a/ql/src/test/results/clientpositive/llap/vector_outer_join4.q.out
+++ b/ql/src/test/results/clientpositive/llap/vector_outer_join4.q.out
@@ -199,12 +199,12 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@small_alltypesorc_b
 POSTHOOK: Output: default@small_alltypesorc_b
 PREHOOK: query: ANALYZE TABLE small_alltypesorc_b COMPUTE STATISTICS FOR COLUMNS
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@small_alltypesorc_b
 PREHOOK: Output: default@small_alltypesorc_b
 #### A masked pattern was here ####
 POSTHOOK: query: ANALYZE TABLE small_alltypesorc_b COMPUTE STATISTICS FOR COLUMNS
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@small_alltypesorc_b
 POSTHOOK: Output: default@small_alltypesorc_b
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/llap/vector_outer_join5.q.out b/ql/src/test/results/clientpositive/llap/vector_outer_join5.q.out
index 680ee42bb6..12dade0c2a 100644
--- a/ql/src/test/results/clientpositive/llap/vector_outer_join5.q.out
+++ b/ql/src/test/results/clientpositive/llap/vector_outer_join5.q.out
@@ -25,12 +25,12 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@sorted_mod_4
 POSTHOOK: Output: default@sorted_mod_4
 PREHOOK: query: ANALYZE TABLE sorted_mod_4 COMPUTE STATISTICS FOR COLUMNS
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@sorted_mod_4
 PREHOOK: Output: default@sorted_mod_4
 #### A masked pattern was here ####
 POSTHOOK: query: ANALYZE TABLE sorted_mod_4 COMPUTE STATISTICS FOR COLUMNS
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@sorted_mod_4
 POSTHOOK: Output: default@sorted_mod_4
 #### A masked pattern was here ####
@@ -57,12 +57,12 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@small_table
 POSTHOOK: Output: default@small_table
 PREHOOK: query: ANALYZE TABLE small_table COMPUTE STATISTICS FOR COLUMNS
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@small_table
 PREHOOK: Output: default@small_table
 #### A masked pattern was here ####
 POSTHOOK: query: ANALYZE TABLE small_table COMPUTE STATISTICS FOR COLUMNS
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@small_table
 POSTHOOK: Output: default@small_table
 #### A masked pattern was here ####
@@ -269,12 +269,12 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@mod_8_mod_4
 POSTHOOK: Output: default@mod_8_mod_4
 PREHOOK: query: ANALYZE TABLE mod_8_mod_4 COMPUTE STATISTICS FOR COLUMNS
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@mod_8_mod_4
 PREHOOK: Output: default@mod_8_mod_4
 #### A masked pattern was here ####
 POSTHOOK: query: ANALYZE TABLE mod_8_mod_4 COMPUTE STATISTICS FOR COLUMNS
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@mod_8_mod_4
 POSTHOOK: Output: default@mod_8_mod_4
 #### A masked pattern was here ####
@@ -301,12 +301,12 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@small_table2
 POSTHOOK: Output: default@small_table2
 PREHOOK: query: ANALYZE TABLE small_table2 COMPUTE STATISTICS FOR COLUMNS
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@small_table2
 PREHOOK: Output: default@small_table2
 #### A masked pattern was here ####
 POSTHOOK: query: ANALYZE TABLE small_table2 COMPUTE STATISTICS FOR COLUMNS
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@small_table2
 POSTHOOK: Output: default@small_table2
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/llap/vector_outer_reference_windowed.q.out b/ql/src/test/results/clientpositive/llap/vector_outer_reference_windowed.q.out
index b1209d91cf..5175cd0b92 100644
--- a/ql/src/test/results/clientpositive/llap/vector_outer_reference_windowed.q.out
+++ b/ql/src/test/results/clientpositive/llap/vector_outer_reference_windowed.q.out
@@ -175,67 +175,67 @@ POSTHOOK: Lineage: e011_03_small.c1 SIMPLE [(e011_01_small)e011_01_small.FieldSc
 POSTHOOK: Lineage: e011_03_small.c2 SIMPLE [(e011_01_small)e011_01_small.FieldSchema(name:c2, type:decimal(7,2), comment:null), ]
 c1	c2
 PREHOOK: query: ANALYZE TABLE e011_01 COMPUTE STATISTICS FOR COLUMNS
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@e011_01
 PREHOOK: Output: default@e011_01
 #### A masked pattern was here ####
 POSTHOOK: query: ANALYZE TABLE e011_01 COMPUTE STATISTICS FOR COLUMNS
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@e011_01
 POSTHOOK: Output: default@e011_01
 #### A masked pattern was here ####
 _c0	_c1
 PREHOOK: query: ANALYZE TABLE e011_02 COMPUTE STATISTICS FOR COLUMNS
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@e011_02
 PREHOOK: Output: default@e011_02
 #### A masked pattern was here ####
 POSTHOOK: query: ANALYZE TABLE e011_02 COMPUTE STATISTICS FOR COLUMNS
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@e011_02
 POSTHOOK: Output: default@e011_02
 #### A masked pattern was here ####
 _c0	_c1
 PREHOOK: query: ANALYZE TABLE e011_03 COMPUTE STATISTICS FOR COLUMNS
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@e011_03
 PREHOOK: Output: default@e011_03
 #### A masked pattern was here ####
 POSTHOOK: query: ANALYZE TABLE e011_03 COMPUTE STATISTICS FOR COLUMNS
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@e011_03
 POSTHOOK: Output: default@e011_03
 #### A masked pattern was here ####
 _c0	_c1
 PREHOOK: query: ANALYZE TABLE e011_01_small COMPUTE STATISTICS FOR COLUMNS
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@e011_01_small
 PREHOOK: Output: default@e011_01_small
 #### A masked pattern was here ####
 POSTHOOK: query: ANALYZE TABLE e011_01_small COMPUTE STATISTICS FOR COLUMNS
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@e011_01_small
 POSTHOOK: Output: default@e011_01_small
 #### A masked pattern was here ####
 _c0	_c1
 PREHOOK: query: ANALYZE TABLE e011_02_small COMPUTE STATISTICS FOR COLUMNS
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@e011_02_small
 PREHOOK: Output: default@e011_02_small
 #### A masked pattern was here ####
 POSTHOOK: query: ANALYZE TABLE e011_02_small COMPUTE STATISTICS FOR COLUMNS
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@e011_02_small
 POSTHOOK: Output: default@e011_02_small
 #### A masked pattern was here ####
 _c0	_c1
 PREHOOK: query: ANALYZE TABLE e011_03_small COMPUTE STATISTICS FOR COLUMNS
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@e011_03_small
 PREHOOK: Output: default@e011_03_small
 #### A masked pattern was here ####
 POSTHOOK: query: ANALYZE TABLE e011_03_small COMPUTE STATISTICS FOR COLUMNS
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@e011_03_small
 POSTHOOK: Output: default@e011_03_small
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/llap/vectorized_dynamic_semijoin_reduction.q.out b/ql/src/test/results/clientpositive/llap/vectorized_dynamic_semijoin_reduction.q.out
index 228bd9de1b..76d368c174 100644
--- a/ql/src/test/results/clientpositive/llap/vectorized_dynamic_semijoin_reduction.q.out
+++ b/ql/src/test/results/clientpositive/llap/vectorized_dynamic_semijoin_reduction.q.out
@@ -1598,12 +1598,12 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@dsrv_small
 POSTHOOK: Output: default@dsrv_small
 PREHOOK: query: analyze table dsrv_small compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@dsrv_small
 PREHOOK: Output: default@dsrv_small
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table dsrv_small compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@dsrv_small
 POSTHOOK: Output: default@dsrv_small
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/llap/vectorized_dynamic_semijoin_reduction2.q.out b/ql/src/test/results/clientpositive/llap/vectorized_dynamic_semijoin_reduction2.q.out
index c3b980dd26..37eebe4492 100644
--- a/ql/src/test/results/clientpositive/llap/vectorized_dynamic_semijoin_reduction2.q.out
+++ b/ql/src/test/results/clientpositive/llap/vectorized_dynamic_semijoin_reduction2.q.out
@@ -71,22 +71,22 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@dsrv2_small
 POSTHOOK: Output: default@dsrv2_small
 PREHOOK: query: analyze table dsrv2_big compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@dsrv2_big
 PREHOOK: Output: default@dsrv2_big
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table dsrv2_big compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@dsrv2_big
 POSTHOOK: Output: default@dsrv2_big
 #### A masked pattern was here ####
 PREHOOK: query: analyze table dsrv2_small compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@dsrv2_small
 PREHOOK: Output: default@dsrv2_small
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table dsrv2_small compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@dsrv2_small
 POSTHOOK: Output: default@dsrv2_small
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/masking_11.q.out b/ql/src/test/results/clientpositive/masking_11.q.out
index 0941b8c2ab..bcf8932ebc 100644
--- a/ql/src/test/results/clientpositive/masking_11.q.out
+++ b/ql/src/test/results/clientpositive/masking_11.q.out
@@ -11,12 +11,12 @@ POSTHOOK: Output: default@masking_test
 POSTHOOK: Lineage: masking_test.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: masking_test.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: analyze table `masking_test` compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@masking_test
 PREHOOK: Output: default@masking_test
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table `masking_test` compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@masking_test
 POSTHOOK: Output: default@masking_test
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/metadata_only_queries.q.out b/ql/src/test/results/clientpositive/metadata_only_queries.q.out
index edcf5c1932..cf3f7c0e4b 100644
--- a/ql/src/test/results/clientpositive/metadata_only_queries.q.out
+++ b/ql/src/test/results/clientpositive/metadata_only_queries.q.out
@@ -397,52 +397,52 @@ STAGE PLANS:
         ListSink
 
 PREHOOK: query: analyze table stats_tbl compute statistics for columns t,si,i,b,f,d,bo,s,bin
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@stats_tbl
 PREHOOK: Output: default@stats_tbl
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table stats_tbl compute statistics for columns t,si,i,b,f,d,bo,s,bin
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@stats_tbl
 POSTHOOK: Output: default@stats_tbl
 #### A masked pattern was here ####
 PREHOOK: query: analyze table stats_tbl_part partition(dt='2010') compute statistics for columns t,si,i,b,f,d,bo,s,bin
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@stats_tbl_part
 PREHOOK: Input: default@stats_tbl_part@dt=2010
 PREHOOK: Output: default@stats_tbl_part
 PREHOOK: Output: default@stats_tbl_part@dt=2010
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table stats_tbl_part partition(dt='2010') compute statistics for columns t,si,i,b,f,d,bo,s,bin
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@stats_tbl_part
 POSTHOOK: Input: default@stats_tbl_part@dt=2010
 POSTHOOK: Output: default@stats_tbl_part
 POSTHOOK: Output: default@stats_tbl_part@dt=2010
 #### A masked pattern was here ####
 PREHOOK: query: analyze table stats_tbl_part partition(dt='2011') compute statistics for columns t,si,i,b,f,d,bo,s,bin
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@stats_tbl_part
 PREHOOK: Input: default@stats_tbl_part@dt=2011
 PREHOOK: Output: default@stats_tbl_part
 PREHOOK: Output: default@stats_tbl_part@dt=2011
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table stats_tbl_part partition(dt='2011') compute statistics for columns t,si,i,b,f,d,bo,s,bin
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@stats_tbl_part
 POSTHOOK: Input: default@stats_tbl_part@dt=2011
 POSTHOOK: Output: default@stats_tbl_part
 POSTHOOK: Output: default@stats_tbl_part@dt=2011
 #### A masked pattern was here ####
 PREHOOK: query: analyze table stats_tbl_part partition(dt='2012') compute statistics for columns t,si,i,b,f,d,bo,s,bin
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@stats_tbl_part
 PREHOOK: Input: default@stats_tbl_part@dt=2012
 PREHOOK: Output: default@stats_tbl_part
 PREHOOK: Output: default@stats_tbl_part@dt=2012
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table stats_tbl_part partition(dt='2012') compute statistics for columns t,si,i,b,f,d,bo,s,bin
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@stats_tbl_part
 POSTHOOK: Input: default@stats_tbl_part@dt=2012
 POSTHOOK: Output: default@stats_tbl_part
diff --git a/ql/src/test/results/clientpositive/metadata_only_queries_with_filters.q.out b/ql/src/test/results/clientpositive/metadata_only_queries_with_filters.q.out
index 79d9d27203..244afcf0a2 100644
--- a/ql/src/test/results/clientpositive/metadata_only_queries_with_filters.q.out
+++ b/ql/src/test/results/clientpositive/metadata_only_queries_with_filters.q.out
@@ -123,28 +123,28 @@ POSTHOOK: Output: default@stats_tbl_part
 POSTHOOK: Output: default@stats_tbl_part@dt=2010
 POSTHOOK: Output: default@stats_tbl_part@dt=2014
 PREHOOK: query: analyze table stats_tbl_part partition(dt=2010) compute statistics for columns t,si,i,b,f,d,bo,s,bin
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@stats_tbl_part
 PREHOOK: Input: default@stats_tbl_part@dt=2010
 PREHOOK: Output: default@stats_tbl_part
 PREHOOK: Output: default@stats_tbl_part@dt=2010
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table stats_tbl_part partition(dt=2010) compute statistics for columns t,si,i,b,f,d,bo,s,bin
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@stats_tbl_part
 POSTHOOK: Input: default@stats_tbl_part@dt=2010
 POSTHOOK: Output: default@stats_tbl_part
 POSTHOOK: Output: default@stats_tbl_part@dt=2010
 #### A masked pattern was here ####
 PREHOOK: query: analyze table stats_tbl_part partition(dt=2014) compute statistics for columns t,si,i,b,f,d,bo,s,bin
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@stats_tbl_part
 PREHOOK: Input: default@stats_tbl_part@dt=2014
 PREHOOK: Output: default@stats_tbl_part
 PREHOOK: Output: default@stats_tbl_part@dt=2014
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table stats_tbl_part partition(dt=2014) compute statistics for columns t,si,i,b,f,d,bo,s,bin
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@stats_tbl_part
 POSTHOOK: Input: default@stats_tbl_part@dt=2014
 POSTHOOK: Output: default@stats_tbl_part
diff --git a/ql/src/test/results/clientpositive/nullability_transitive_inference.q.out b/ql/src/test/results/clientpositive/nullability_transitive_inference.q.out
index 37cec81e95..97a7f2ebf4 100644
--- a/ql/src/test/results/clientpositive/nullability_transitive_inference.q.out
+++ b/ql/src/test/results/clientpositive/nullability_transitive_inference.q.out
@@ -34,12 +34,12 @@ POSTHOOK: Lineage: emps.empid SCRIPT []
 POSTHOOK: Lineage: emps.name SCRIPT []
 POSTHOOK: Lineage: emps.salary SCRIPT []
 PREHOOK: query: analyze table emps compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@emps
 PREHOOK: Output: default@emps
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table emps compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@emps
 POSTHOOK: Output: default@emps
 #### A masked pattern was here ####
@@ -71,12 +71,12 @@ POSTHOOK: Lineage: depts.deptno SCRIPT []
 POSTHOOK: Lineage: depts.locationid SCRIPT []
 POSTHOOK: Lineage: depts.name SCRIPT []
 PREHOOK: query: analyze table depts compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@depts
 PREHOOK: Output: default@depts
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table depts compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@depts
 POSTHOOK: Output: default@depts
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/optimize_filter_literal.q.out b/ql/src/test/results/clientpositive/optimize_filter_literal.q.out
index 7854e02d7a..bb4f27d832 100644
--- a/ql/src/test/results/clientpositive/optimize_filter_literal.q.out
+++ b/ql/src/test/results/clientpositive/optimize_filter_literal.q.out
@@ -87,14 +87,14 @@ POSTHOOK: Output: default@tab_part@ds=2008-04-08
 POSTHOOK: Lineage: tab_part PARTITION(ds=2008-04-08).key SIMPLE [(srcbucket_mapjoin_part)srcbucket_mapjoin_part.FieldSchema(name:key, type:int, comment:null), ]
 POSTHOOK: Lineage: tab_part PARTITION(ds=2008-04-08).value SIMPLE [(srcbucket_mapjoin_part)srcbucket_mapjoin_part.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: analyze table tab_part partition (ds='2008-04-08') compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@tab_part
 PREHOOK: Input: default@tab_part@ds=2008-04-08
 PREHOOK: Output: default@tab_part
 PREHOOK: Output: default@tab_part@ds=2008-04-08
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table tab_part partition (ds='2008-04-08') compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@tab_part
 POSTHOOK: Input: default@tab_part@ds=2008-04-08
 POSTHOOK: Output: default@tab_part
@@ -123,14 +123,14 @@ POSTHOOK: Output: default@tab@ds=2008-04-08
 POSTHOOK: Lineage: tab PARTITION(ds=2008-04-08).key SIMPLE [(srcbucket_mapjoin)srcbucket_mapjoin.FieldSchema(name:key, type:int, comment:null), ]
 POSTHOOK: Lineage: tab PARTITION(ds=2008-04-08).value SIMPLE [(srcbucket_mapjoin)srcbucket_mapjoin.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: analyze table tab partition (ds='2008-04-08') compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@tab
 PREHOOK: Input: default@tab@ds=2008-04-08
 PREHOOK: Output: default@tab
 PREHOOK: Output: default@tab@ds=2008-04-08
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table tab partition (ds='2008-04-08') compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@tab
 POSTHOOK: Input: default@tab@ds=2008-04-08
 POSTHOOK: Output: default@tab
diff --git a/ql/src/test/results/clientpositive/outer_reference_windowed.q.out b/ql/src/test/results/clientpositive/outer_reference_windowed.q.out
index c6351eb76c..87cadb3317 100644
--- a/ql/src/test/results/clientpositive/outer_reference_windowed.q.out
+++ b/ql/src/test/results/clientpositive/outer_reference_windowed.q.out
@@ -91,32 +91,32 @@ POSTHOOK: Output: default@e011_03
 POSTHOOK: Lineage: e011_03.c1 SIMPLE [(e011_01)e011_01.FieldSchema(name:c1, type:decimal(15,2), comment:null), ]
 POSTHOOK: Lineage: e011_03.c2 SIMPLE [(e011_01)e011_01.FieldSchema(name:c2, type:decimal(15,2), comment:null), ]
 PREHOOK: query: ANALYZE TABLE e011_01 COMPUTE STATISTICS FOR COLUMNS
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@e011_01
 PREHOOK: Output: default@e011_01
 #### A masked pattern was here ####
 POSTHOOK: query: ANALYZE TABLE e011_01 COMPUTE STATISTICS FOR COLUMNS
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@e011_01
 POSTHOOK: Output: default@e011_01
 #### A masked pattern was here ####
 PREHOOK: query: ANALYZE TABLE e011_02 COMPUTE STATISTICS FOR COLUMNS
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@e011_02
 PREHOOK: Output: default@e011_02
 #### A masked pattern was here ####
 POSTHOOK: query: ANALYZE TABLE e011_02 COMPUTE STATISTICS FOR COLUMNS
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@e011_02
 POSTHOOK: Output: default@e011_02
 #### A masked pattern was here ####
 PREHOOK: query: ANALYZE TABLE e011_03 COMPUTE STATISTICS FOR COLUMNS
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@e011_03
 PREHOOK: Output: default@e011_03
 #### A masked pattern was here ####
 POSTHOOK: query: ANALYZE TABLE e011_03 COMPUTE STATISTICS FOR COLUMNS
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@e011_03
 POSTHOOK: Output: default@e011_03
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/partial_column_stats.q.out b/ql/src/test/results/clientpositive/partial_column_stats.q.out
index 528eaf16c6..1e640438b4 100644
--- a/ql/src/test/results/clientpositive/partial_column_stats.q.out
+++ b/ql/src/test/results/clientpositive/partial_column_stats.q.out
@@ -7,9 +7,9 @@ POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@t1
 PREHOOK: query: explain analyze table t1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 POSTHOOK: query: explain analyze table t1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-1 depends on stages: Stage-0
@@ -57,12 +57,12 @@ STAGE PLANS:
           Table: default.t1
 
 PREHOOK: query: analyze table t1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@t1
 PREHOOK: Output: default@t1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table t1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@t1
 POSTHOOK: Output: default@t1
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/partition_coltype_literals.q.out b/ql/src/test/results/clientpositive/partition_coltype_literals.q.out
index adabbb2e10..d98cce50b0 100644
--- a/ql/src/test/results/clientpositive/partition_coltype_literals.q.out
+++ b/ql/src/test/results/clientpositive/partition_coltype_literals.q.out
@@ -278,14 +278,14 @@ bint                	bigint
 	 	 
 #### A masked pattern was here ####
 PREHOOK: query: analyze table partcoltypenum partition (tint=110Y, sint=22000S, bint=330000000000L) compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@partcoltypenum
 PREHOOK: Input: default@partcoltypenum@tint=110/sint=22000/bint=330000000000
 PREHOOK: Output: default@partcoltypenum
 PREHOOK: Output: default@partcoltypenum@tint=110/sint=22000/bint=330000000000
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table partcoltypenum partition (tint=110Y, sint=22000S, bint=330000000000L) compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@partcoltypenum
 POSTHOOK: Input: default@partcoltypenum@tint=110/sint=22000/bint=330000000000
 POSTHOOK: Output: default@partcoltypenum
diff --git a/ql/src/test/results/clientpositive/pcs.q.out b/ql/src/test/results/clientpositive/pcs.q.out
index 54f802bee2..872fb27984 100644
--- a/ql/src/test/results/clientpositive/pcs.q.out
+++ b/ql/src/test/results/clientpositive/pcs.q.out
@@ -65,7 +65,7 @@ POSTHOOK: Output: default@pcs_t1@ds=2000-04-08
 POSTHOOK: Output: default@pcs_t1@ds=2000-04-09
 POSTHOOK: Output: default@pcs_t1@ds=2000-04-10
 PREHOOK: query: analyze table pcs_t1 partition(ds) compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@pcs_t1
 PREHOOK: Input: default@pcs_t1@ds=2000-04-08
 PREHOOK: Input: default@pcs_t1@ds=2000-04-09
@@ -76,7 +76,7 @@ PREHOOK: Output: default@pcs_t1@ds=2000-04-09
 PREHOOK: Output: default@pcs_t1@ds=2000-04-10
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table pcs_t1 partition(ds) compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@pcs_t1
 POSTHOOK: Input: default@pcs_t1@ds=2000-04-08
 POSTHOOK: Input: default@pcs_t1@ds=2000-04-09
diff --git a/ql/src/test/results/clientpositive/quotedid_stats.q.out b/ql/src/test/results/clientpositive/quotedid_stats.q.out
index 8f1464a1fe..4804a61b70 100644
--- a/ql/src/test/results/clientpositive/quotedid_stats.q.out
+++ b/ql/src/test/results/clientpositive/quotedid_stats.q.out
@@ -42,12 +42,12 @@ Sort Columns:       	[]
 Storage Desc Params:	 	 
 	serialization.format	1                   
 PREHOOK: query: analyze table t4 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@t4
 PREHOOK: Output: default@t4
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table t4 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@t4
 POSTHOOK: Output: default@t4
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/remove_exprs_stats.q.out b/ql/src/test/results/clientpositive/remove_exprs_stats.q.out
index 15c2c6de50..dc663bb721 100644
--- a/ql/src/test/results/clientpositive/remove_exprs_stats.q.out
+++ b/ql/src/test/results/clientpositive/remove_exprs_stats.q.out
@@ -53,12 +53,12 @@ POSTHOOK: Lineage: loc_orc.state SIMPLE [(loc_staging)loc_staging.FieldSchema(na
 POSTHOOK: Lineage: loc_orc.year SIMPLE [(loc_staging)loc_staging.FieldSchema(name:year, type:int, comment:null), ]
 POSTHOOK: Lineage: loc_orc.zip SIMPLE [(loc_staging)loc_staging.FieldSchema(name:zip, type:bigint, comment:null), ]
 PREHOOK: query: analyze table loc_orc compute statistics for columns state,locid,zip,year
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@loc_orc
 PREHOOK: Output: default@loc_orc
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table loc_orc compute statistics for columns state,locid,zip,year
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@loc_orc
 POSTHOOK: Output: default@loc_orc
 #### A masked pattern was here ####
@@ -608,12 +608,12 @@ POSTHOOK: Input: _dummy_database@_dummy_table
 POSTHOOK: Output: default@t
 POSTHOOK: Lineage: t.s EXPRESSION []
 PREHOOK: query: analyze table t compute statistics for columns s
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@t
 PREHOOK: Output: default@t
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table t compute statistics for columns s
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@t
 POSTHOOK: Output: default@t
 #### A masked pattern was here ####
@@ -743,12 +743,12 @@ POSTHOOK: Input: _dummy_database@_dummy_table
 POSTHOOK: Output: default@t
 POSTHOOK: Lineage: t.s SCRIPT []
 PREHOOK: query: analyze table t compute statistics for columns s
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@t
 PREHOOK: Output: default@t
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table t compute statistics for columns s
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@t
 POSTHOOK: Output: default@t
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/rename_external_partition_location.q.out b/ql/src/test/results/clientpositive/rename_external_partition_location.q.out
index 85a4739bad..02cd814dfe 100644
--- a/ql/src/test/results/clientpositive/rename_external_partition_location.q.out
+++ b/ql/src/test/results/clientpositive/rename_external_partition_location.q.out
@@ -66,14 +66,14 @@ Found 1 items
 5val_5
 9val_9
 PREHOOK: query: ANALYZE TABLE ex_table PARTITION (part='part1') COMPUTE STATISTICS FOR COLUMNS
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@ex_table
 PREHOOK: Input: default@ex_table@part=part1
 PREHOOK: Output: default@ex_table
 PREHOOK: Output: default@ex_table@part=part1
 #### A masked pattern was here ####
 POSTHOOK: query: ANALYZE TABLE ex_table PARTITION (part='part1') COMPUTE STATISTICS FOR COLUMNS
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@ex_table
 POSTHOOK: Input: default@ex_table@part=part1
 POSTHOOK: Output: default@ex_table
diff --git a/ql/src/test/results/clientpositive/rename_table_update_column_stats.q.out b/ql/src/test/results/clientpositive/rename_table_update_column_stats.q.out
index b0f9069407..51add9e04d 100644
--- a/ql/src/test/results/clientpositive/rename_table_update_column_stats.q.out
+++ b/ql/src/test/results/clientpositive/rename_table_update_column_stats.q.out
@@ -44,12 +44,12 @@ POSTHOOK: query: use statsdb1
 POSTHOOK: type: SWITCHDATABASE
 POSTHOOK: Input: database:statsdb1
 PREHOOK: query: analyze table testtable1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: statsdb1@testtable1
 #### A masked pattern was here ####
 PREHOOK: Output: statsdb1@testtable1
 POSTHOOK: query: analyze table testtable1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: statsdb1@testtable1
 #### A masked pattern was here ####
 POSTHOOK: Output: statsdb1@testtable1
@@ -246,12 +246,12 @@ POSTHOOK: query: use statsdb1
 POSTHOOK: type: SWITCHDATABASE
 POSTHOOK: Input: database:statsdb1
 PREHOOK: query: analyze table testtable1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: statsdb1@testtable1
 #### A masked pattern was here ####
 PREHOOK: Output: statsdb1@testtable1
 POSTHOOK: query: analyze table testtable1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: statsdb1@testtable1
 #### A masked pattern was here ####
 POSTHOOK: Output: statsdb1@testtable1
diff --git a/ql/src/test/results/clientpositive/smb_mapjoin_13.q.out b/ql/src/test/results/clientpositive/smb_mapjoin_13.q.out
index 1204572992..cf36279bac 100644
--- a/ql/src/test/results/clientpositive/smb_mapjoin_13.q.out
+++ b/ql/src/test/results/clientpositive/smb_mapjoin_13.q.out
@@ -298,7 +298,7 @@ STAGE PLANS:
               COLUMN_STATS_ACCURATE {"BASIC_STATS":"true","COLUMN_STATS":{"key":"true","value":"true"}}
               SORTBUCKETCOLSPREFIX TRUE
               bucket_count 16
-              bucket_field_name key
+              bucket_field_name key,value
               bucketing_version 2
               column.name.delimiter ,
               columns key,value
@@ -322,7 +322,7 @@ STAGE PLANS:
                 COLUMN_STATS_ACCURATE {"BASIC_STATS":"true","COLUMN_STATS":{"key":"true","value":"true"}}
                 SORTBUCKETCOLSPREFIX TRUE
                 bucket_count 16
-                bucket_field_name key
+                bucket_field_name key,value
                 bucketing_version 2
                 column.name.delimiter ,
                 columns key,value
diff --git a/ql/src/test/results/clientpositive/sort_merge_join_desc_7.q.out b/ql/src/test/results/clientpositive/sort_merge_join_desc_7.q.out
index 77f7792952..c5e8605f33 100644
--- a/ql/src/test/results/clientpositive/sort_merge_join_desc_7.q.out
+++ b/ql/src/test/results/clientpositive/sort_merge_join_desc_7.q.out
@@ -113,7 +113,7 @@ STAGE PLANS:
                   properties:
                     COLUMN_STATS_ACCURATE {"BASIC_STATS":"true","COLUMN_STATS":{"key":"true","value":"true"}}
                     bucket_count 2
-                    bucket_field_name key
+                    bucket_field_name key,value
                     column.name.delimiter ,
                     columns key,value
                     columns.comments 
@@ -136,7 +136,7 @@ STAGE PLANS:
                     output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                     properties:
                       bucket_count 2
-                      bucket_field_name key
+                      bucket_field_name key,value
                       bucketing_version 2
                       column.name.delimiter ,
                       columns key,value
@@ -161,7 +161,7 @@ STAGE PLANS:
                   properties:
                     COLUMN_STATS_ACCURATE {"BASIC_STATS":"true","COLUMN_STATS":{"key":"true","value":"true"}}
                     bucket_count 2
-                    bucket_field_name key
+                    bucket_field_name key,value
                     column.name.delimiter ,
                     columns key,value
                     columns.comments 
@@ -184,7 +184,7 @@ STAGE PLANS:
                     output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                     properties:
                       bucket_count 2
-                      bucket_field_name key
+                      bucket_field_name key,value
                       bucketing_version 2
                       column.name.delimiter ,
                       columns key,value
@@ -264,7 +264,7 @@ STAGE PLANS:
             properties:
               COLUMN_STATS_ACCURATE {"BASIC_STATS":"true","COLUMN_STATS":{"key":"true","value":"true"}}
               bucket_count 2
-              bucket_field_name key
+              bucket_field_name key,value
               column.name.delimiter ,
               columns key,value
               columns.comments 
@@ -287,7 +287,7 @@ STAGE PLANS:
               output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
               properties:
                 bucket_count 2
-                bucket_field_name key
+                bucket_field_name key,value
                 bucketing_version 2
                 column.name.delimiter ,
                 columns key,value
@@ -314,7 +314,7 @@ STAGE PLANS:
             properties:
               COLUMN_STATS_ACCURATE {"BASIC_STATS":"true","COLUMN_STATS":{"key":"true","value":"true"}}
               bucket_count 2
-              bucket_field_name key
+              bucket_field_name key,value
               column.name.delimiter ,
               columns key,value
               columns.comments 
@@ -337,7 +337,7 @@ STAGE PLANS:
               output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
               properties:
                 bucket_count 2
-                bucket_field_name key
+                bucket_field_name key,value
                 bucketing_version 2
                 column.name.delimiter ,
                 columns key,value
diff --git a/ql/src/test/results/clientpositive/spark/annotate_stats_join.q.out b/ql/src/test/results/clientpositive/spark/annotate_stats_join.q.out
index 860b67476b..d0f5695f32 100644
--- a/ql/src/test/results/clientpositive/spark/annotate_stats_join.q.out
+++ b/ql/src/test/results/clientpositive/spark/annotate_stats_join.q.out
@@ -95,32 +95,32 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@loc
 POSTHOOK: Output: default@loc
 PREHOOK: query: analyze table emp compute statistics for columns lastname,deptid,locid
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@emp
 PREHOOK: Output: default@emp
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table emp compute statistics for columns lastname,deptid,locid
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@emp
 POSTHOOK: Output: default@emp
 #### A masked pattern was here ####
 PREHOOK: query: analyze table dept compute statistics for columns deptname,deptid
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@dept
 PREHOOK: Output: default@dept
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table dept compute statistics for columns deptname,deptid
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@dept
 POSTHOOK: Output: default@dept
 #### A masked pattern was here ####
 PREHOOK: query: analyze table loc compute statistics for columns state,locid,zip,year
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@loc
 PREHOOK: Output: default@loc
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table loc compute statistics for columns state,locid,zip,year
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@loc
 POSTHOOK: Output: default@loc
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/spark/avro_decimal_native.q.out b/ql/src/test/results/clientpositive/spark/avro_decimal_native.q.out
index 16666c9277..37edb50e35 100644
--- a/ql/src/test/results/clientpositive/spark/avro_decimal_native.q.out
+++ b/ql/src/test/results/clientpositive/spark/avro_decimal_native.q.out
@@ -23,12 +23,12 @@ POSTHOOK: type: LOAD
 #### A masked pattern was here ####
 POSTHOOK: Output: default@dec
 PREHOOK: query: ANALYZE TABLE `dec` COMPUTE STATISTICS FOR COLUMNS value
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@dec
 PREHOOK: Output: default@dec
 #### A masked pattern was here ####
 POSTHOOK: query: ANALYZE TABLE `dec` COMPUTE STATISTICS FOR COLUMNS value
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@dec
 POSTHOOK: Output: default@dec
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/spark/bucket_map_join_1.q.out b/ql/src/test/results/clientpositive/spark/bucket_map_join_1.q.out
index bc7702d8e0..3f21785887 100644
--- a/ql/src/test/results/clientpositive/spark/bucket_map_join_1.q.out
+++ b/ql/src/test/results/clientpositive/spark/bucket_map_join_1.q.out
@@ -87,7 +87,7 @@ STAGE PLANS:
                   properties:
                     SORTBUCKETCOLSPREFIX TRUE
                     bucket_count 1
-                    bucket_field_name value
+                    bucket_field_name value,key
                     bucketing_version 2
                     column.name.delimiter ,
                     columns key,value
@@ -110,7 +110,7 @@ STAGE PLANS:
                     properties:
                       SORTBUCKETCOLSPREFIX TRUE
                       bucket_count 1
-                      bucket_field_name value
+                      bucket_field_name value,key
                       bucketing_version 2
                       column.name.delimiter ,
                       columns key,value
@@ -184,7 +184,7 @@ STAGE PLANS:
                   properties:
                     SORTBUCKETCOLSPREFIX TRUE
                     bucket_count 1
-                    bucket_field_name key
+                    bucket_field_name key,value
                     bucketing_version 2
                     column.name.delimiter ,
                     columns key,value
@@ -207,7 +207,7 @@ STAGE PLANS:
                     properties:
                       SORTBUCKETCOLSPREFIX TRUE
                       bucket_count 1
-                      bucket_field_name key
+                      bucket_field_name key,value
                       bucketing_version 2
                       column.name.delimiter ,
                       columns key,value
diff --git a/ql/src/test/results/clientpositive/spark/bucket_map_join_2.q.out b/ql/src/test/results/clientpositive/spark/bucket_map_join_2.q.out
index 21b6fc1c26..19abb96999 100644
--- a/ql/src/test/results/clientpositive/spark/bucket_map_join_2.q.out
+++ b/ql/src/test/results/clientpositive/spark/bucket_map_join_2.q.out
@@ -87,7 +87,7 @@ STAGE PLANS:
                   properties:
                     SORTBUCKETCOLSPREFIX TRUE
                     bucket_count 1
-                    bucket_field_name value
+                    bucket_field_name value,key
                     bucketing_version 2
                     column.name.delimiter ,
                     columns key,value
@@ -110,7 +110,7 @@ STAGE PLANS:
                     properties:
                       SORTBUCKETCOLSPREFIX TRUE
                       bucket_count 1
-                      bucket_field_name value
+                      bucket_field_name value,key
                       bucketing_version 2
                       column.name.delimiter ,
                       columns key,value
@@ -184,7 +184,7 @@ STAGE PLANS:
                   properties:
                     SORTBUCKETCOLSPREFIX TRUE
                     bucket_count 1
-                    bucket_field_name key
+                    bucket_field_name key,value
                     bucketing_version 2
                     column.name.delimiter ,
                     columns key,value
@@ -207,7 +207,7 @@ STAGE PLANS:
                     properties:
                       SORTBUCKETCOLSPREFIX TRUE
                       bucket_count 1
-                      bucket_field_name key
+                      bucket_field_name key,value
                       bucketing_version 2
                       column.name.delimiter ,
                       columns key,value
diff --git a/ql/src/test/results/clientpositive/spark/bucket_map_join_tez1.q.out b/ql/src/test/results/clientpositive/spark/bucket_map_join_tez1.q.out
index 987a98c0e4..c5af083876 100644
--- a/ql/src/test/results/clientpositive/spark/bucket_map_join_tez1.q.out
+++ b/ql/src/test/results/clientpositive/spark/bucket_map_join_tez1.q.out
@@ -109,56 +109,56 @@ POSTHOOK: Output: default@tab@ds=2008-04-08
 POSTHOOK: Lineage: tab PARTITION(ds=2008-04-08).key SIMPLE [(srcbucket_mapjoin)srcbucket_mapjoin.FieldSchema(name:key, type:int, comment:null), ]
 POSTHOOK: Lineage: tab PARTITION(ds=2008-04-08).value SIMPLE [(srcbucket_mapjoin)srcbucket_mapjoin.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: analyze table srcbucket_mapjoin compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@srcbucket_mapjoin
 PREHOOK: Input: default@srcbucket_mapjoin@ds=2008-04-08
 PREHOOK: Output: default@srcbucket_mapjoin
 PREHOOK: Output: default@srcbucket_mapjoin@ds=2008-04-08
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table srcbucket_mapjoin compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@srcbucket_mapjoin
 POSTHOOK: Input: default@srcbucket_mapjoin@ds=2008-04-08
 POSTHOOK: Output: default@srcbucket_mapjoin
 POSTHOOK: Output: default@srcbucket_mapjoin@ds=2008-04-08
 #### A masked pattern was here ####
 PREHOOK: query: analyze table srcbucket_mapjoin_part compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@srcbucket_mapjoin_part
 PREHOOK: Input: default@srcbucket_mapjoin_part@ds=2008-04-08
 PREHOOK: Output: default@srcbucket_mapjoin_part
 PREHOOK: Output: default@srcbucket_mapjoin_part@ds=2008-04-08
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table srcbucket_mapjoin_part compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@srcbucket_mapjoin_part
 POSTHOOK: Input: default@srcbucket_mapjoin_part@ds=2008-04-08
 POSTHOOK: Output: default@srcbucket_mapjoin_part
 POSTHOOK: Output: default@srcbucket_mapjoin_part@ds=2008-04-08
 #### A masked pattern was here ####
 PREHOOK: query: analyze table tab compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@tab
 PREHOOK: Input: default@tab@ds=2008-04-08
 PREHOOK: Output: default@tab
 PREHOOK: Output: default@tab@ds=2008-04-08
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table tab compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@tab
 POSTHOOK: Input: default@tab@ds=2008-04-08
 POSTHOOK: Output: default@tab
 POSTHOOK: Output: default@tab@ds=2008-04-08
 #### A masked pattern was here ####
 PREHOOK: query: analyze table tab_part compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@tab_part
 PREHOOK: Input: default@tab_part@ds=2008-04-08
 PREHOOK: Output: default@tab_part
 PREHOOK: Output: default@tab_part@ds=2008-04-08
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table tab_part compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@tab_part
 POSTHOOK: Input: default@tab_part@ds=2008-04-08
 POSTHOOK: Output: default@tab_part
@@ -5893,14 +5893,14 @@ POSTHOOK: Output: default@tab2@ds=2008-04-08
 POSTHOOK: Lineage: tab2 PARTITION(ds=2008-04-08).key SIMPLE [(srcbucket_mapjoin)srcbucket_mapjoin.FieldSchema(name:key, type:int, comment:null), ]
 POSTHOOK: Lineage: tab2 PARTITION(ds=2008-04-08).value SIMPLE [(srcbucket_mapjoin)srcbucket_mapjoin.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: analyze table tab2 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@tab2
 PREHOOK: Input: default@tab2@ds=2008-04-08
 PREHOOK: Output: default@tab2
 PREHOOK: Output: default@tab2@ds=2008-04-08
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table tab2 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@tab2
 POSTHOOK: Input: default@tab2@ds=2008-04-08
 POSTHOOK: Output: default@tab2
diff --git a/ql/src/test/results/clientpositive/spark/bucket_map_join_tez2.q.out b/ql/src/test/results/clientpositive/spark/bucket_map_join_tez2.q.out
index 33c802ce03..8e946d82cc 100644
--- a/ql/src/test/results/clientpositive/spark/bucket_map_join_tez2.q.out
+++ b/ql/src/test/results/clientpositive/spark/bucket_map_join_tez2.q.out
@@ -109,56 +109,56 @@ POSTHOOK: Output: default@tab@ds=2008-04-08
 POSTHOOK: Lineage: tab PARTITION(ds=2008-04-08).key SIMPLE [(srcbucket_mapjoin)srcbucket_mapjoin.FieldSchema(name:key, type:int, comment:null), ]
 POSTHOOK: Lineage: tab PARTITION(ds=2008-04-08).value SIMPLE [(srcbucket_mapjoin)srcbucket_mapjoin.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: analyze table srcbucket_mapjoin compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@srcbucket_mapjoin
 PREHOOK: Input: default@srcbucket_mapjoin@ds=2008-04-08
 PREHOOK: Output: default@srcbucket_mapjoin
 PREHOOK: Output: default@srcbucket_mapjoin@ds=2008-04-08
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table srcbucket_mapjoin compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@srcbucket_mapjoin
 POSTHOOK: Input: default@srcbucket_mapjoin@ds=2008-04-08
 POSTHOOK: Output: default@srcbucket_mapjoin
 POSTHOOK: Output: default@srcbucket_mapjoin@ds=2008-04-08
 #### A masked pattern was here ####
 PREHOOK: query: analyze table srcbucket_mapjoin_part compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@srcbucket_mapjoin_part
 PREHOOK: Input: default@srcbucket_mapjoin_part@ds=2008-04-08
 PREHOOK: Output: default@srcbucket_mapjoin_part
 PREHOOK: Output: default@srcbucket_mapjoin_part@ds=2008-04-08
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table srcbucket_mapjoin_part compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@srcbucket_mapjoin_part
 POSTHOOK: Input: default@srcbucket_mapjoin_part@ds=2008-04-08
 POSTHOOK: Output: default@srcbucket_mapjoin_part
 POSTHOOK: Output: default@srcbucket_mapjoin_part@ds=2008-04-08
 #### A masked pattern was here ####
 PREHOOK: query: analyze table tab compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@tab
 PREHOOK: Input: default@tab@ds=2008-04-08
 PREHOOK: Output: default@tab
 PREHOOK: Output: default@tab@ds=2008-04-08
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table tab compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@tab
 POSTHOOK: Input: default@tab@ds=2008-04-08
 POSTHOOK: Output: default@tab
 POSTHOOK: Output: default@tab@ds=2008-04-08
 #### A masked pattern was here ####
 PREHOOK: query: analyze table tab_part compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@tab_part
 PREHOOK: Input: default@tab_part@ds=2008-04-08
 PREHOOK: Output: default@tab_part
 PREHOOK: Output: default@tab_part@ds=2008-04-08
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table tab_part compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@tab_part
 POSTHOOK: Input: default@tab_part@ds=2008-04-08
 POSTHOOK: Output: default@tab_part
@@ -419,12 +419,12 @@ POSTHOOK: Output: default@tab1
 POSTHOOK: Lineage: tab1.key SIMPLE [(srcbucket_mapjoin)srcbucket_mapjoin.FieldSchema(name:key, type:int, comment:null), ]
 POSTHOOK: Lineage: tab1.value SIMPLE [(srcbucket_mapjoin)srcbucket_mapjoin.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: analyze table tab1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@tab1
 PREHOOK: Output: default@tab1
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table tab1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@tab1
 POSTHOOK: Output: default@tab1
 #### A masked pattern was here ####
@@ -1455,14 +1455,14 @@ POSTHOOK: Output: default@tab_part1@ds=2008-04-08
 POSTHOOK: Lineage: tab_part1 PARTITION(ds=2008-04-08).key SIMPLE [(srcbucket_mapjoin_part)srcbucket_mapjoin_part.FieldSchema(name:key, type:int, comment:null), ]
 POSTHOOK: Lineage: tab_part1 PARTITION(ds=2008-04-08).value SIMPLE [(srcbucket_mapjoin_part)srcbucket_mapjoin_part.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: analyze table tab_part1 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@tab_part1
 PREHOOK: Input: default@tab_part1@ds=2008-04-08
 PREHOOK: Output: default@tab_part1
 PREHOOK: Output: default@tab_part1@ds=2008-04-08
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table tab_part1 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@tab_part1
 POSTHOOK: Input: default@tab_part1@ds=2008-04-08
 POSTHOOK: Output: default@tab_part1
diff --git a/ql/src/test/results/clientpositive/spark/bucketmapjoin_negative3.q.out b/ql/src/test/results/clientpositive/spark/bucketmapjoin_negative3.q.out
index 0dbf8a3893..47fb891589 100644
--- a/ql/src/test/results/clientpositive/spark/bucketmapjoin_negative3.q.out
+++ b/ql/src/test/results/clientpositive/spark/bucketmapjoin_negative3.q.out
@@ -1023,7 +1023,7 @@ STAGE PLANS:
                   properties:
                     SORTBUCKETCOLSPREFIX TRUE
                     bucket_count 3
-                    bucket_field_name key
+                    bucket_field_name key,value
                     bucketing_version 2
                     column.name.delimiter ,
                     columns key,value
@@ -1046,7 +1046,7 @@ STAGE PLANS:
                     properties:
                       SORTBUCKETCOLSPREFIX TRUE
                       bucket_count 3
-                      bucket_field_name key
+                      bucket_field_name key,value
                       bucketing_version 2
                       column.name.delimiter ,
                       columns key,value
@@ -1227,7 +1227,7 @@ STAGE PLANS:
                   properties:
                     SORTBUCKETCOLSPREFIX TRUE
                     bucket_count 3
-                    bucket_field_name value
+                    bucket_field_name value,key
                     bucketing_version 2
                     column.name.delimiter ,
                     columns key,value
@@ -1250,7 +1250,7 @@ STAGE PLANS:
                     properties:
                       SORTBUCKETCOLSPREFIX TRUE
                       bucket_count 3
-                      bucket_field_name value
+                      bucket_field_name value,key
                       bucketing_version 2
                       column.name.delimiter ,
                       columns key,value
@@ -1431,7 +1431,7 @@ STAGE PLANS:
                   properties:
                     SORTBUCKETCOLSPREFIX TRUE
                     bucket_count 3
-                    bucket_field_name key
+                    bucket_field_name key,value
                     bucketing_version 2
                     column.name.delimiter ,
                     columns key,value
@@ -1454,7 +1454,7 @@ STAGE PLANS:
                     properties:
                       SORTBUCKETCOLSPREFIX TRUE
                       bucket_count 3
-                      bucket_field_name key
+                      bucket_field_name key,value
                       bucketing_version 2
                       column.name.delimiter ,
                       columns key,value
@@ -1635,7 +1635,7 @@ STAGE PLANS:
                   properties:
                     SORTBUCKETCOLSPREFIX TRUE
                     bucket_count 3
-                    bucket_field_name value
+                    bucket_field_name value,key
                     bucketing_version 2
                     column.name.delimiter ,
                     columns key,value
@@ -1658,7 +1658,7 @@ STAGE PLANS:
                     properties:
                       SORTBUCKETCOLSPREFIX TRUE
                       bucket_count 3
-                      bucket_field_name value
+                      bucket_field_name value,key
                       bucketing_version 2
                       column.name.delimiter ,
                       columns key,value
@@ -1839,7 +1839,7 @@ STAGE PLANS:
                   properties:
                     SORTBUCKETCOLSPREFIX TRUE
                     bucket_count 3
-                    bucket_field_name value
+                    bucket_field_name value,key
                     bucketing_version 2
                     column.name.delimiter ,
                     columns key,value
@@ -1862,7 +1862,7 @@ STAGE PLANS:
                     properties:
                       SORTBUCKETCOLSPREFIX TRUE
                       bucket_count 3
-                      bucket_field_name value
+                      bucket_field_name value,key
                       bucketing_version 2
                       column.name.delimiter ,
                       columns key,value
@@ -1949,7 +1949,7 @@ STAGE PLANS:
                   properties:
                     SORTBUCKETCOLSPREFIX TRUE
                     bucket_count 3
-                    bucket_field_name key
+                    bucket_field_name key,value
                     bucketing_version 2
                     column.name.delimiter ,
                     columns key,value
@@ -1972,7 +1972,7 @@ STAGE PLANS:
                     properties:
                       SORTBUCKETCOLSPREFIX TRUE
                       bucket_count 3
-                      bucket_field_name key
+                      bucket_field_name key,value
                       bucketing_version 2
                       column.name.delimiter ,
                       columns key,value
diff --git a/ql/src/test/results/clientpositive/spark/groupby_sort_1_23.q.out b/ql/src/test/results/clientpositive/spark/groupby_sort_1_23.q.out
index 85595ca470..6e53f3cf11 100644
--- a/ql/src/test/results/clientpositive/spark/groupby_sort_1_23.q.out
+++ b/ql/src/test/results/clientpositive/spark/groupby_sort_1_23.q.out
@@ -2986,7 +2986,7 @@ STAGE PLANS:
                     COLUMN_STATS_ACCURATE {"BASIC_STATS":"true"}
                     SORTBUCKETCOLSPREFIX TRUE
                     bucket_count 2
-                    bucket_field_name key
+                    bucket_field_name key,val
                     bucketing_version 2
                     column.name.delimiter ,
                     columns key,val
@@ -3010,7 +3010,7 @@ STAGE PLANS:
                       COLUMN_STATS_ACCURATE {"BASIC_STATS":"true"}
                       SORTBUCKETCOLSPREFIX TRUE
                       bucket_count 2
-                      bucket_field_name key
+                      bucket_field_name key,val
                       bucketing_version 2
                       column.name.delimiter ,
                       columns key,val
@@ -3222,7 +3222,7 @@ STAGE PLANS:
                     COLUMN_STATS_ACCURATE {"BASIC_STATS":"true"}
                     SORTBUCKETCOLSPREFIX TRUE
                     bucket_count 2
-                    bucket_field_name key
+                    bucket_field_name key,val
                     bucketing_version 2
                     column.name.delimiter ,
                     columns key,val
@@ -3246,7 +3246,7 @@ STAGE PLANS:
                       COLUMN_STATS_ACCURATE {"BASIC_STATS":"true"}
                       SORTBUCKETCOLSPREFIX TRUE
                       bucket_count 2
-                      bucket_field_name key
+                      bucket_field_name key,val
                       bucketing_version 2
                       column.name.delimiter ,
                       columns key,val
@@ -3422,7 +3422,7 @@ STAGE PLANS:
                     COLUMN_STATS_ACCURATE {"BASIC_STATS":"true"}
                     SORTBUCKETCOLSPREFIX TRUE
                     bucket_count 2
-                    bucket_field_name key
+                    bucket_field_name key,val
                     bucketing_version 2
                     column.name.delimiter ,
                     columns key,val
@@ -3446,7 +3446,7 @@ STAGE PLANS:
                       COLUMN_STATS_ACCURATE {"BASIC_STATS":"true"}
                       SORTBUCKETCOLSPREFIX TRUE
                       bucket_count 2
-                      bucket_field_name key
+                      bucket_field_name key,val
                       bucketing_version 2
                       column.name.delimiter ,
                       columns key,val
@@ -3621,7 +3621,7 @@ STAGE PLANS:
                     COLUMN_STATS_ACCURATE {"BASIC_STATS":"true"}
                     SORTBUCKETCOLSPREFIX TRUE
                     bucket_count 2
-                    bucket_field_name key
+                    bucket_field_name key,val
                     bucketing_version 2
                     column.name.delimiter ,
                     columns key,val
@@ -3645,7 +3645,7 @@ STAGE PLANS:
                       COLUMN_STATS_ACCURATE {"BASIC_STATS":"true"}
                       SORTBUCKETCOLSPREFIX TRUE
                       bucket_count 2
-                      bucket_field_name key
+                      bucket_field_name key,val
                       bucketing_version 2
                       column.name.delimiter ,
                       columns key,val
@@ -3827,7 +3827,7 @@ STAGE PLANS:
                     COLUMN_STATS_ACCURATE {"BASIC_STATS":"true"}
                     SORTBUCKETCOLSPREFIX TRUE
                     bucket_count 2
-                    bucket_field_name key
+                    bucket_field_name key,val
                     bucketing_version 2
                     column.name.delimiter ,
                     columns key,val
@@ -3851,7 +3851,7 @@ STAGE PLANS:
                       COLUMN_STATS_ACCURATE {"BASIC_STATS":"true"}
                       SORTBUCKETCOLSPREFIX TRUE
                       bucket_count 2
-                      bucket_field_name key
+                      bucket_field_name key,val
                       bucketing_version 2
                       column.name.delimiter ,
                       columns key,val
diff --git a/ql/src/test/results/clientpositive/spark/groupby_sort_skew_1_23.q.out b/ql/src/test/results/clientpositive/spark/groupby_sort_skew_1_23.q.out
index d8b9dca659..092866d8e3 100644
--- a/ql/src/test/results/clientpositive/spark/groupby_sort_skew_1_23.q.out
+++ b/ql/src/test/results/clientpositive/spark/groupby_sort_skew_1_23.q.out
@@ -3107,7 +3107,7 @@ STAGE PLANS:
                     COLUMN_STATS_ACCURATE {"BASIC_STATS":"true"}
                     SORTBUCKETCOLSPREFIX TRUE
                     bucket_count 2
-                    bucket_field_name key
+                    bucket_field_name key,val
                     bucketing_version 2
                     column.name.delimiter ,
                     columns key,val
@@ -3131,7 +3131,7 @@ STAGE PLANS:
                       COLUMN_STATS_ACCURATE {"BASIC_STATS":"true"}
                       SORTBUCKETCOLSPREFIX TRUE
                       bucket_count 2
-                      bucket_field_name key
+                      bucket_field_name key,val
                       bucketing_version 2
                       column.name.delimiter ,
                       columns key,val
@@ -3362,7 +3362,7 @@ STAGE PLANS:
                     COLUMN_STATS_ACCURATE {"BASIC_STATS":"true"}
                     SORTBUCKETCOLSPREFIX TRUE
                     bucket_count 2
-                    bucket_field_name key
+                    bucket_field_name key,val
                     bucketing_version 2
                     column.name.delimiter ,
                     columns key,val
@@ -3386,7 +3386,7 @@ STAGE PLANS:
                       COLUMN_STATS_ACCURATE {"BASIC_STATS":"true"}
                       SORTBUCKETCOLSPREFIX TRUE
                       bucket_count 2
-                      bucket_field_name key
+                      bucket_field_name key,val
                       bucketing_version 2
                       column.name.delimiter ,
                       columns key,val
@@ -3562,7 +3562,7 @@ STAGE PLANS:
                     COLUMN_STATS_ACCURATE {"BASIC_STATS":"true"}
                     SORTBUCKETCOLSPREFIX TRUE
                     bucket_count 2
-                    bucket_field_name key
+                    bucket_field_name key,val
                     bucketing_version 2
                     column.name.delimiter ,
                     columns key,val
@@ -3586,7 +3586,7 @@ STAGE PLANS:
                       COLUMN_STATS_ACCURATE {"BASIC_STATS":"true"}
                       SORTBUCKETCOLSPREFIX TRUE
                       bucket_count 2
-                      bucket_field_name key
+                      bucket_field_name key,val
                       bucketing_version 2
                       column.name.delimiter ,
                       columns key,val
@@ -3761,7 +3761,7 @@ STAGE PLANS:
                     COLUMN_STATS_ACCURATE {"BASIC_STATS":"true"}
                     SORTBUCKETCOLSPREFIX TRUE
                     bucket_count 2
-                    bucket_field_name key
+                    bucket_field_name key,val
                     bucketing_version 2
                     column.name.delimiter ,
                     columns key,val
@@ -3785,7 +3785,7 @@ STAGE PLANS:
                       COLUMN_STATS_ACCURATE {"BASIC_STATS":"true"}
                       SORTBUCKETCOLSPREFIX TRUE
                       bucket_count 2
-                      bucket_field_name key
+                      bucket_field_name key,val
                       bucketing_version 2
                       column.name.delimiter ,
                       columns key,val
@@ -3967,7 +3967,7 @@ STAGE PLANS:
                     COLUMN_STATS_ACCURATE {"BASIC_STATS":"true"}
                     SORTBUCKETCOLSPREFIX TRUE
                     bucket_count 2
-                    bucket_field_name key
+                    bucket_field_name key,val
                     bucketing_version 2
                     column.name.delimiter ,
                     columns key,val
@@ -3991,7 +3991,7 @@ STAGE PLANS:
                       COLUMN_STATS_ACCURATE {"BASIC_STATS":"true"}
                       SORTBUCKETCOLSPREFIX TRUE
                       bucket_count 2
-                      bucket_field_name key
+                      bucket_field_name key,val
                       bucketing_version 2
                       column.name.delimiter ,
                       columns key,val
diff --git a/ql/src/test/results/clientpositive/spark/metadata_only_queries.q.out b/ql/src/test/results/clientpositive/spark/metadata_only_queries.q.out
index eca9b8b621..828a8a4477 100644
--- a/ql/src/test/results/clientpositive/spark/metadata_only_queries.q.out
+++ b/ql/src/test/results/clientpositive/spark/metadata_only_queries.q.out
@@ -425,52 +425,52 @@ STAGE PLANS:
         ListSink
 
 PREHOOK: query: analyze table stats_tbl compute statistics for columns t,si,i,b,f,d,bo,s,bin
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@stats_tbl
 PREHOOK: Output: default@stats_tbl
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table stats_tbl compute statistics for columns t,si,i,b,f,d,bo,s,bin
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@stats_tbl
 POSTHOOK: Output: default@stats_tbl
 #### A masked pattern was here ####
 PREHOOK: query: analyze table stats_tbl_part partition(dt='2010') compute statistics for columns t,si,i,b,f,d,bo,s,bin
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@stats_tbl_part
 PREHOOK: Input: default@stats_tbl_part@dt=2010
 PREHOOK: Output: default@stats_tbl_part
 PREHOOK: Output: default@stats_tbl_part@dt=2010
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table stats_tbl_part partition(dt='2010') compute statistics for columns t,si,i,b,f,d,bo,s,bin
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@stats_tbl_part
 POSTHOOK: Input: default@stats_tbl_part@dt=2010
 POSTHOOK: Output: default@stats_tbl_part
 POSTHOOK: Output: default@stats_tbl_part@dt=2010
 #### A masked pattern was here ####
 PREHOOK: query: analyze table stats_tbl_part partition(dt='2011') compute statistics for columns t,si,i,b,f,d,bo,s,bin
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@stats_tbl_part
 PREHOOK: Input: default@stats_tbl_part@dt=2011
 PREHOOK: Output: default@stats_tbl_part
 PREHOOK: Output: default@stats_tbl_part@dt=2011
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table stats_tbl_part partition(dt='2011') compute statistics for columns t,si,i,b,f,d,bo,s,bin
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@stats_tbl_part
 POSTHOOK: Input: default@stats_tbl_part@dt=2011
 POSTHOOK: Output: default@stats_tbl_part
 POSTHOOK: Output: default@stats_tbl_part@dt=2011
 #### A masked pattern was here ####
 PREHOOK: query: analyze table stats_tbl_part partition(dt='2012') compute statistics for columns t,si,i,b,f,d,bo,s,bin
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@stats_tbl_part
 PREHOOK: Input: default@stats_tbl_part@dt=2012
 PREHOOK: Output: default@stats_tbl_part
 PREHOOK: Output: default@stats_tbl_part@dt=2012
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table stats_tbl_part partition(dt='2012') compute statistics for columns t,si,i,b,f,d,bo,s,bin
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@stats_tbl_part
 POSTHOOK: Input: default@stats_tbl_part@dt=2012
 POSTHOOK: Output: default@stats_tbl_part
diff --git a/ql/src/test/results/clientpositive/spark/metadata_only_queries_with_filters.q.out b/ql/src/test/results/clientpositive/spark/metadata_only_queries_with_filters.q.out
index 79d9d27203..244afcf0a2 100644
--- a/ql/src/test/results/clientpositive/spark/metadata_only_queries_with_filters.q.out
+++ b/ql/src/test/results/clientpositive/spark/metadata_only_queries_with_filters.q.out
@@ -123,28 +123,28 @@ POSTHOOK: Output: default@stats_tbl_part
 POSTHOOK: Output: default@stats_tbl_part@dt=2010
 POSTHOOK: Output: default@stats_tbl_part@dt=2014
 PREHOOK: query: analyze table stats_tbl_part partition(dt=2010) compute statistics for columns t,si,i,b,f,d,bo,s,bin
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@stats_tbl_part
 PREHOOK: Input: default@stats_tbl_part@dt=2010
 PREHOOK: Output: default@stats_tbl_part
 PREHOOK: Output: default@stats_tbl_part@dt=2010
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table stats_tbl_part partition(dt=2010) compute statistics for columns t,si,i,b,f,d,bo,s,bin
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@stats_tbl_part
 POSTHOOK: Input: default@stats_tbl_part@dt=2010
 POSTHOOK: Output: default@stats_tbl_part
 POSTHOOK: Output: default@stats_tbl_part@dt=2010
 #### A masked pattern was here ####
 PREHOOK: query: analyze table stats_tbl_part partition(dt=2014) compute statistics for columns t,si,i,b,f,d,bo,s,bin
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@stats_tbl_part
 PREHOOK: Input: default@stats_tbl_part@dt=2014
 PREHOOK: Output: default@stats_tbl_part
 PREHOOK: Output: default@stats_tbl_part@dt=2014
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table stats_tbl_part partition(dt=2014) compute statistics for columns t,si,i,b,f,d,bo,s,bin
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@stats_tbl_part
 POSTHOOK: Input: default@stats_tbl_part@dt=2014
 POSTHOOK: Output: default@stats_tbl_part
diff --git a/ql/src/test/results/clientpositive/spark/smb_mapjoin_13.q.out b/ql/src/test/results/clientpositive/spark/smb_mapjoin_13.q.out
index a364374312..26c9594ce0 100644
--- a/ql/src/test/results/clientpositive/spark/smb_mapjoin_13.q.out
+++ b/ql/src/test/results/clientpositive/spark/smb_mapjoin_13.q.out
@@ -274,7 +274,7 @@ STAGE PLANS:
                     COLUMN_STATS_ACCURATE {"BASIC_STATS":"true"}
                     SORTBUCKETCOLSPREFIX TRUE
                     bucket_count 16
-                    bucket_field_name key
+                    bucket_field_name key,value
                     bucketing_version 2
                     column.name.delimiter ,
                     columns key,value
@@ -298,7 +298,7 @@ STAGE PLANS:
                       COLUMN_STATS_ACCURATE {"BASIC_STATS":"true"}
                       SORTBUCKETCOLSPREFIX TRUE
                       bucket_count 16
-                      bucket_field_name key
+                      bucket_field_name key,value
                       bucketing_version 2
                       column.name.delimiter ,
                       columns key,value
@@ -376,7 +376,7 @@ STAGE PLANS:
                     COLUMN_STATS_ACCURATE {"BASIC_STATS":"true"}
                     SORTBUCKETCOLSPREFIX TRUE
                     bucket_count 16
-                    bucket_field_name key
+                    bucket_field_name key,value
                     bucketing_version 2
                     column.name.delimiter ,
                     columns key,value
@@ -400,7 +400,7 @@ STAGE PLANS:
                       COLUMN_STATS_ACCURATE {"BASIC_STATS":"true"}
                       SORTBUCKETCOLSPREFIX TRUE
                       bucket_count 16
-                      bucket_field_name key
+                      bucket_field_name key,value
                       bucketing_version 2
                       column.name.delimiter ,
                       columns key,value
diff --git a/ql/src/test/results/clientpositive/spark/stats_only_null.q.out b/ql/src/test/results/clientpositive/spark/stats_only_null.q.out
index 698c10051a..cd67fd82c7 100644
--- a/ql/src/test/results/clientpositive/spark/stats_only_null.q.out
+++ b/ql/src/test/results/clientpositive/spark/stats_only_null.q.out
@@ -183,38 +183,38 @@ STAGE PLANS:
         ListSink
 
 PREHOOK: query: analyze table stats_null compute statistics for columns a,b,c,d
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@stats_null
 PREHOOK: Output: default@stats_null
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table stats_null compute statistics for columns a,b,c,d
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@stats_null
 POSTHOOK: Output: default@stats_null
 #### A masked pattern was here ####
 PREHOOK: query: analyze table stats_null_part partition(dt='2010') compute statistics for columns a,b,c,d
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@stats_null_part
 PREHOOK: Input: default@stats_null_part@dt=2010
 PREHOOK: Output: default@stats_null_part
 PREHOOK: Output: default@stats_null_part@dt=2010
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table stats_null_part partition(dt='2010') compute statistics for columns a,b,c,d
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@stats_null_part
 POSTHOOK: Input: default@stats_null_part@dt=2010
 POSTHOOK: Output: default@stats_null_part
 POSTHOOK: Output: default@stats_null_part@dt=2010
 #### A masked pattern was here ####
 PREHOOK: query: analyze table stats_null_part partition(dt='2011') compute statistics for columns a,b,c,d
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@stats_null_part
 PREHOOK: Input: default@stats_null_part@dt=2011
 PREHOOK: Output: default@stats_null_part
 PREHOOK: Output: default@stats_null_part@dt=2011
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table stats_null_part partition(dt='2011') compute statistics for columns a,b,c,d
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@stats_null_part
 POSTHOOK: Input: default@stats_null_part@dt=2011
 POSTHOOK: Output: default@stats_null_part
@@ -382,7 +382,7 @@ POSTHOOK: Lineage: stats_null_part PARTITION(dt=__HIVE_DEFAULT_PARTITION__).b SI
 POSTHOOK: Lineage: stats_null_part PARTITION(dt=__HIVE_DEFAULT_PARTITION__).c SIMPLE [(temps_null)temps_null.FieldSchema(name:c, type:string, comment:null), ]
 POSTHOOK: Lineage: stats_null_part PARTITION(dt=__HIVE_DEFAULT_PARTITION__).d SIMPLE [(temps_null)temps_null.FieldSchema(name:d, type:smallint, comment:null), ]
 PREHOOK: query: analyze table stats_null_part compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@stats_null_part
 PREHOOK: Input: default@stats_null_part@dt=1
 PREHOOK: Input: default@stats_null_part@dt=__HIVE_DEFAULT_PARTITION__
@@ -391,7 +391,7 @@ PREHOOK: Output: default@stats_null_part@dt=1
 PREHOOK: Output: default@stats_null_part@dt=__HIVE_DEFAULT_PARTITION__
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table stats_null_part compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@stats_null_part
 POSTHOOK: Input: default@stats_null_part@dt=1
 POSTHOOK: Input: default@stats_null_part@dt=__HIVE_DEFAULT_PARTITION__
diff --git a/ql/src/test/results/clientpositive/spark/vector_outer_join1.q.out b/ql/src/test/results/clientpositive/spark/vector_outer_join1.q.out
index 9a1fa539f4..16c1650930 100644
--- a/ql/src/test/results/clientpositive/spark/vector_outer_join1.q.out
+++ b/ql/src/test/results/clientpositive/spark/vector_outer_join1.q.out
@@ -184,12 +184,12 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@small_alltypesorc_a
 POSTHOOK: Output: default@small_alltypesorc_a
 PREHOOK: query: ANALYZE TABLE small_alltypesorc_a COMPUTE STATISTICS FOR COLUMNS
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@small_alltypesorc_a
 PREHOOK: Output: default@small_alltypesorc_a
 PREHOOK: Output: hdfs://### HDFS PATH ###
 POSTHOOK: query: ANALYZE TABLE small_alltypesorc_a COMPUTE STATISTICS FOR COLUMNS
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@small_alltypesorc_a
 POSTHOOK: Output: default@small_alltypesorc_a
 POSTHOOK: Output: hdfs://### HDFS PATH ###
diff --git a/ql/src/test/results/clientpositive/spark/vector_outer_join2.q.out b/ql/src/test/results/clientpositive/spark/vector_outer_join2.q.out
index 32bcc9b85e..fc9ffad6d2 100644
--- a/ql/src/test/results/clientpositive/spark/vector_outer_join2.q.out
+++ b/ql/src/test/results/clientpositive/spark/vector_outer_join2.q.out
@@ -189,12 +189,12 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@small_alltypesorc_a
 POSTHOOK: Output: default@small_alltypesorc_a
 PREHOOK: query: ANALYZE TABLE small_alltypesorc_a COMPUTE STATISTICS FOR COLUMNS
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@small_alltypesorc_a
 PREHOOK: Output: default@small_alltypesorc_a
 PREHOOK: Output: hdfs://### HDFS PATH ###
 POSTHOOK: query: ANALYZE TABLE small_alltypesorc_a COMPUTE STATISTICS FOR COLUMNS
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@small_alltypesorc_a
 POSTHOOK: Output: default@small_alltypesorc_a
 POSTHOOK: Output: hdfs://### HDFS PATH ###
diff --git a/ql/src/test/results/clientpositive/spark/vector_outer_join3.q.out b/ql/src/test/results/clientpositive/spark/vector_outer_join3.q.out
index c5568b6300..c47c6874f2 100644
--- a/ql/src/test/results/clientpositive/spark/vector_outer_join3.q.out
+++ b/ql/src/test/results/clientpositive/spark/vector_outer_join3.q.out
@@ -189,12 +189,12 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@small_alltypesorc_a
 POSTHOOK: Output: default@small_alltypesorc_a
 PREHOOK: query: ANALYZE TABLE small_alltypesorc_a COMPUTE STATISTICS FOR COLUMNS
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@small_alltypesorc_a
 PREHOOK: Output: default@small_alltypesorc_a
 PREHOOK: Output: hdfs://### HDFS PATH ###
 POSTHOOK: query: ANALYZE TABLE small_alltypesorc_a COMPUTE STATISTICS FOR COLUMNS
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@small_alltypesorc_a
 POSTHOOK: Output: default@small_alltypesorc_a
 POSTHOOK: Output: hdfs://### HDFS PATH ###
diff --git a/ql/src/test/results/clientpositive/spark/vector_outer_join4.q.out b/ql/src/test/results/clientpositive/spark/vector_outer_join4.q.out
index 9872ab1077..9be72eaeb3 100644
--- a/ql/src/test/results/clientpositive/spark/vector_outer_join4.q.out
+++ b/ql/src/test/results/clientpositive/spark/vector_outer_join4.q.out
@@ -199,12 +199,12 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@small_alltypesorc_b
 POSTHOOK: Output: default@small_alltypesorc_b
 PREHOOK: query: ANALYZE TABLE small_alltypesorc_b COMPUTE STATISTICS FOR COLUMNS
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@small_alltypesorc_b
 PREHOOK: Output: default@small_alltypesorc_b
 PREHOOK: Output: hdfs://### HDFS PATH ###
 POSTHOOK: query: ANALYZE TABLE small_alltypesorc_b COMPUTE STATISTICS FOR COLUMNS
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@small_alltypesorc_b
 POSTHOOK: Output: default@small_alltypesorc_b
 POSTHOOK: Output: hdfs://### HDFS PATH ###
diff --git a/ql/src/test/results/clientpositive/spark/vector_outer_join5.q.out b/ql/src/test/results/clientpositive/spark/vector_outer_join5.q.out
index baf720471c..6ad6a7b8eb 100644
--- a/ql/src/test/results/clientpositive/spark/vector_outer_join5.q.out
+++ b/ql/src/test/results/clientpositive/spark/vector_outer_join5.q.out
@@ -25,12 +25,12 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@sorted_mod_4
 POSTHOOK: Output: default@sorted_mod_4
 PREHOOK: query: ANALYZE TABLE sorted_mod_4 COMPUTE STATISTICS FOR COLUMNS
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@sorted_mod_4
 PREHOOK: Output: default@sorted_mod_4
 PREHOOK: Output: hdfs://### HDFS PATH ###
 POSTHOOK: query: ANALYZE TABLE sorted_mod_4 COMPUTE STATISTICS FOR COLUMNS
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@sorted_mod_4
 POSTHOOK: Output: default@sorted_mod_4
 POSTHOOK: Output: hdfs://### HDFS PATH ###
@@ -57,12 +57,12 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@small_table
 POSTHOOK: Output: default@small_table
 PREHOOK: query: ANALYZE TABLE small_table COMPUTE STATISTICS FOR COLUMNS
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@small_table
 PREHOOK: Output: default@small_table
 PREHOOK: Output: hdfs://### HDFS PATH ###
 POSTHOOK: query: ANALYZE TABLE small_table COMPUTE STATISTICS FOR COLUMNS
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@small_table
 POSTHOOK: Output: default@small_table
 POSTHOOK: Output: hdfs://### HDFS PATH ###
@@ -269,12 +269,12 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@mod_8_mod_4
 POSTHOOK: Output: default@mod_8_mod_4
 PREHOOK: query: ANALYZE TABLE mod_8_mod_4 COMPUTE STATISTICS FOR COLUMNS
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@mod_8_mod_4
 PREHOOK: Output: default@mod_8_mod_4
 PREHOOK: Output: hdfs://### HDFS PATH ###
 POSTHOOK: query: ANALYZE TABLE mod_8_mod_4 COMPUTE STATISTICS FOR COLUMNS
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@mod_8_mod_4
 POSTHOOK: Output: default@mod_8_mod_4
 POSTHOOK: Output: hdfs://### HDFS PATH ###
@@ -301,12 +301,12 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@small_table2
 POSTHOOK: Output: default@small_table2
 PREHOOK: query: ANALYZE TABLE small_table2 COMPUTE STATISTICS FOR COLUMNS
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@small_table2
 PREHOOK: Output: default@small_table2
 PREHOOK: Output: hdfs://### HDFS PATH ###
 POSTHOOK: query: ANALYZE TABLE small_table2 COMPUTE STATISTICS FOR COLUMNS
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@small_table2
 POSTHOOK: Output: default@small_table2
 POSTHOOK: Output: hdfs://### HDFS PATH ###
diff --git a/ql/src/test/results/clientpositive/special_character_in_tabnames_2.q.out b/ql/src/test/results/clientpositive/special_character_in_tabnames_2.q.out
index 57fdb54c46..e7cd36b67d 100644
--- a/ql/src/test/results/clientpositive/special_character_in_tabnames_2.q.out
+++ b/ql/src/test/results/clientpositive/special_character_in_tabnames_2.q.out
@@ -27,12 +27,12 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@s/c
 POSTHOOK: Output: default@s/c
 PREHOOK: query: ANALYZE TABLE `s/c` COMPUTE STATISTICS FOR COLUMNS key,value
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@s/c
 PREHOOK: Output: default@s/c
 #### A masked pattern was here ####
 POSTHOOK: query: ANALYZE TABLE `s/c` COMPUTE STATISTICS FOR COLUMNS key,value
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@s/c
 POSTHOOK: Output: default@s/c
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/stats_analyze_empty.q.out b/ql/src/test/results/clientpositive/stats_analyze_empty.q.out
index 6eb51e950d..fac846b8dc 100644
--- a/ql/src/test/results/clientpositive/stats_analyze_empty.q.out
+++ b/ql/src/test/results/clientpositive/stats_analyze_empty.q.out
@@ -25,12 +25,12 @@ POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@testdeci2
 PREHOOK: query: analyze table testdeci2 compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@testdeci2
 PREHOOK: Output: default@testdeci2
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table testdeci2 compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@testdeci2
 POSTHOOK: Output: default@testdeci2
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/stats_invalidation.q.out b/ql/src/test/results/clientpositive/stats_invalidation.q.out
index 7843852da0..0b647a9e5d 100644
--- a/ql/src/test/results/clientpositive/stats_invalidation.q.out
+++ b/ql/src/test/results/clientpositive/stats_invalidation.q.out
@@ -19,12 +19,12 @@ POSTHOOK: Output: default@stats_invalid
 POSTHOOK: Lineage: stats_invalid.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_invalid.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: analyze table stats_invalid compute statistics for columns key,value
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@stats_invalid
 PREHOOK: Output: default@stats_invalid
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table stats_invalid compute statistics for columns key,value
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@stats_invalid
 POSTHOOK: Output: default@stats_invalid
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/stats_missing_warning.q.out b/ql/src/test/results/clientpositive/stats_missing_warning.q.out
index b90578597b..5df424395b 100644
--- a/ql/src/test/results/clientpositive/stats_missing_warning.q.out
+++ b/ql/src/test/results/clientpositive/stats_missing_warning.q.out
@@ -115,32 +115,32 @@ POSTHOOK: Input: default@missing_stats_t3
 #### A masked pattern was here ####
 0
 PREHOOK: query: ANALYZE TABLE missing_stats_t1 COMPUTE STATISTICS FOR COLUMNS
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@missing_stats_t1
 PREHOOK: Output: default@missing_stats_t1
 #### A masked pattern was here ####
 POSTHOOK: query: ANALYZE TABLE missing_stats_t1 COMPUTE STATISTICS FOR COLUMNS
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@missing_stats_t1
 POSTHOOK: Output: default@missing_stats_t1
 #### A masked pattern was here ####
 PREHOOK: query: ANALYZE TABLE missing_stats_t2 COMPUTE STATISTICS FOR COLUMNS
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@missing_stats_t2
 PREHOOK: Output: default@missing_stats_t2
 #### A masked pattern was here ####
 POSTHOOK: query: ANALYZE TABLE missing_stats_t2 COMPUTE STATISTICS FOR COLUMNS
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@missing_stats_t2
 POSTHOOK: Output: default@missing_stats_t2
 #### A masked pattern was here ####
 PREHOOK: query: ANALYZE TABLE missing_stats_t3 COMPUTE STATISTICS FOR COLUMNS
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@missing_stats_t3
 PREHOOK: Output: default@missing_stats_t3
 #### A masked pattern was here ####
 POSTHOOK: query: ANALYZE TABLE missing_stats_t3 COMPUTE STATISTICS FOR COLUMNS
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@missing_stats_t3
 POSTHOOK: Output: default@missing_stats_t3
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/stats_only_null.q.out b/ql/src/test/results/clientpositive/stats_only_null.q.out
index 116c431f37..66d67a32e7 100644
--- a/ql/src/test/results/clientpositive/stats_only_null.q.out
+++ b/ql/src/test/results/clientpositive/stats_only_null.q.out
@@ -169,38 +169,38 @@ STAGE PLANS:
         ListSink
 
 PREHOOK: query: analyze table stats_null compute statistics for columns a,b,c,d
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@stats_null
 PREHOOK: Output: default@stats_null
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table stats_null compute statistics for columns a,b,c,d
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@stats_null
 POSTHOOK: Output: default@stats_null
 #### A masked pattern was here ####
 PREHOOK: query: analyze table stats_null_part partition(dt='2010') compute statistics for columns a,b,c,d
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@stats_null_part
 PREHOOK: Input: default@stats_null_part@dt=2010
 PREHOOK: Output: default@stats_null_part
 PREHOOK: Output: default@stats_null_part@dt=2010
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table stats_null_part partition(dt='2010') compute statistics for columns a,b,c,d
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@stats_null_part
 POSTHOOK: Input: default@stats_null_part@dt=2010
 POSTHOOK: Output: default@stats_null_part
 POSTHOOK: Output: default@stats_null_part@dt=2010
 #### A masked pattern was here ####
 PREHOOK: query: analyze table stats_null_part partition(dt='2011') compute statistics for columns a,b,c,d
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@stats_null_part
 PREHOOK: Input: default@stats_null_part@dt=2011
 PREHOOK: Output: default@stats_null_part
 PREHOOK: Output: default@stats_null_part@dt=2011
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table stats_null_part partition(dt='2011') compute statistics for columns a,b,c,d
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@stats_null_part
 POSTHOOK: Input: default@stats_null_part@dt=2011
 POSTHOOK: Output: default@stats_null_part
@@ -368,7 +368,7 @@ POSTHOOK: Lineage: stats_null_part PARTITION(dt=__HIVE_DEFAULT_PARTITION__).b SI
 POSTHOOK: Lineage: stats_null_part PARTITION(dt=__HIVE_DEFAULT_PARTITION__).c SIMPLE [(temps_null)temps_null.FieldSchema(name:c, type:string, comment:null), ]
 POSTHOOK: Lineage: stats_null_part PARTITION(dt=__HIVE_DEFAULT_PARTITION__).d SIMPLE [(temps_null)temps_null.FieldSchema(name:d, type:smallint, comment:null), ]
 PREHOOK: query: analyze table stats_null_part compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@stats_null_part
 PREHOOK: Input: default@stats_null_part@dt=1
 PREHOOK: Input: default@stats_null_part@dt=__HIVE_DEFAULT_PARTITION__
@@ -377,7 +377,7 @@ PREHOOK: Output: default@stats_null_part@dt=1
 PREHOOK: Output: default@stats_null_part@dt=__HIVE_DEFAULT_PARTITION__
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table stats_null_part compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@stats_null_part
 POSTHOOK: Input: default@stats_null_part@dt=1
 POSTHOOK: Input: default@stats_null_part@dt=__HIVE_DEFAULT_PARTITION__
diff --git a/ql/src/test/results/clientpositive/stats_partial_size.q.out b/ql/src/test/results/clientpositive/stats_partial_size.q.out
index ba34f44b07..8be5d386f6 100644
--- a/ql/src/test/results/clientpositive/stats_partial_size.q.out
+++ b/ql/src/test/results/clientpositive/stats_partial_size.q.out
@@ -28,12 +28,12 @@ POSTHOOK: Input: default@sample_partitioned@y=1
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@sample
 PREHOOK: query: analyze table sample compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@sample
 PREHOOK: Output: default@sample
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table sample compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@sample
 POSTHOOK: Output: default@sample
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/stats_ppr_all.q.out b/ql/src/test/results/clientpositive/stats_ppr_all.q.out
index d9597513f2..3b52a15b1a 100644
--- a/ql/src/test/results/clientpositive/stats_ppr_all.q.out
+++ b/ql/src/test/results/clientpositive/stats_ppr_all.q.out
@@ -47,7 +47,7 @@ POSTHOOK: Output: default@ss@country=US/year=2015/month=1/day=2
 POSTHOOK: Lineage: ss PARTITION(country=US,year=2015,month=1,day=2).order_amount SCRIPT []
 POSTHOOK: Lineage: ss PARTITION(country=US,year=2015,month=1,day=2).sales_order_id SCRIPT []
 PREHOOK: query: ANALYZE TABLE ss PARTITION(country,year,month,day) compute statistics for columns
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@ss
 PREHOOK: Input: default@ss@country=US/year=2015/month=1/day=1
 PREHOOK: Input: default@ss@country=US/year=2015/month=1/day=2
@@ -58,7 +58,7 @@ PREHOOK: Output: default@ss@country=US/year=2015/month=1/day=2
 PREHOOK: Output: default@ss@country=US/year=2015/month=2/day=1
 #### A masked pattern was here ####
 POSTHOOK: query: ANALYZE TABLE ss PARTITION(country,year,month,day) compute statistics for columns
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@ss
 POSTHOOK: Input: default@ss@country=US/year=2015/month=1/day=1
 POSTHOOK: Input: default@ss@country=US/year=2015/month=1/day=2
diff --git a/ql/src/test/results/clientpositive/temp_table_display_colstats_tbllvl.q.out b/ql/src/test/results/clientpositive/temp_table_display_colstats_tbllvl.q.out
index 598bf8efaa..707306c24e 100644
--- a/ql/src/test/results/clientpositive/temp_table_display_colstats_tbllvl.q.out
+++ b/ql/src/test/results/clientpositive/temp_table_display_colstats_tbllvl.q.out
@@ -154,10 +154,10 @@ bitVector
 comment             	from deserializer   	 	 	 	 	 	 	 	 	 	 
 PREHOOK: query: explain
 analyze table UserVisits_web_text_none compute statistics for columns sourceIP, avgTimeOnSite, adRevenue
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 POSTHOOK: query: explain
 analyze table UserVisits_web_text_none compute statistics for columns sourceIP, avgTimeOnSite, adRevenue
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-1 depends on stages: Stage-0
@@ -206,10 +206,10 @@ STAGE PLANS:
 
 PREHOOK: query: explain extended
 analyze table UserVisits_web_text_none compute statistics for columns sourceIP, avgTimeOnSite, adRevenue
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 POSTHOOK: query: explain extended
 analyze table UserVisits_web_text_none compute statistics for columns sourceIP, avgTimeOnSite, adRevenue
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-1 depends on stages: Stage-0
@@ -333,12 +333,12 @@ STAGE PLANS:
           Is Table Level Stats: true
 
 PREHOOK: query: analyze table UserVisits_web_text_none compute statistics for columns sourceIP, avgTimeOnSite, adRevenue
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@uservisits_web_text_none
 PREHOOK: Output: default@uservisits_web_text_none
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table UserVisits_web_text_none compute statistics for columns sourceIP, avgTimeOnSite, adRevenue
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@uservisits_web_text_none
 POSTHOOK: Output: default@uservisits_web_text_none
 #### A masked pattern was here ####
@@ -483,10 +483,10 @@ comment             	from deserializer
 COLUMN_STATS_ACCURATE	{\"BASIC_STATS\":\"true\",\"COLUMN_STATS\":{\"a\":\"true\",\"b\":\"true\",\"c\":\"true\",\"d\":\"true\",\"e\":\"true\"}}	 	 	 	 	 	 	 	 	 	 
 PREHOOK: query: explain
 analyze table empty_tab compute statistics for columns a,b,c,d,e
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 POSTHOOK: query: explain
 analyze table empty_tab compute statistics for columns a,b,c,d,e
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-1 depends on stages: Stage-0
@@ -534,12 +534,12 @@ STAGE PLANS:
           Table: default.empty_tab
 
 PREHOOK: query: analyze table empty_tab compute statistics for columns a,b,c,d,e
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@empty_tab
 PREHOOK: Output: default@empty_tab
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table empty_tab compute statistics for columns a,b,c,d,e
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@empty_tab
 POSTHOOK: Output: default@empty_tab
 #### A masked pattern was here ####
@@ -707,12 +707,12 @@ bitVector           	HL
 comment             	from deserializer   	 	 	 	 	 	 	 	 	 	 
 COLUMN_STATS_ACCURATE	{\"BASIC_STATS\":\"true\",\"COLUMN_STATS\":{\"adRevenue\":\"true\",\"avgTimeOnSite\":\"true\",\"sourceIP\":\"true\"}}	 	 	 	 	 	 	 	 	 	 
 PREHOOK: query: analyze table UserVisits_web_text_none compute statistics for columns sKeyword
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: test@uservisits_web_text_none
 #### A masked pattern was here ####
 PREHOOK: Output: test@uservisits_web_text_none
 POSTHOOK: query: analyze table UserVisits_web_text_none compute statistics for columns sKeyword
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: test@uservisits_web_text_none
 #### A masked pattern was here ####
 POSTHOOK: Output: test@uservisits_web_text_none
diff --git a/ql/src/test/results/clientpositive/tunable_ndv.q.out b/ql/src/test/results/clientpositive/tunable_ndv.q.out
index a232eaaf09..551591e60d 100644
--- a/ql/src/test/results/clientpositive/tunable_ndv.q.out
+++ b/ql/src/test/results/clientpositive/tunable_ndv.q.out
@@ -56,7 +56,7 @@ POSTHOOK: Lineage: loc_orc_1d PARTITION(year=2001).locid SIMPLE [(ext_loc)ext_lo
 POSTHOOK: Lineage: loc_orc_1d PARTITION(year=2001).state SIMPLE [(ext_loc)ext_loc.FieldSchema(name:state, type:string, comment:null), ]
 POSTHOOK: Lineage: loc_orc_1d PARTITION(year=2001).zip SIMPLE [(ext_loc)ext_loc.FieldSchema(name:zip, type:int, comment:null), ]
 PREHOOK: query: analyze table loc_orc_1d compute statistics for columns state,locid
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@loc_orc_1d
 PREHOOK: Input: default@loc_orc_1d@year=2000
 PREHOOK: Input: default@loc_orc_1d@year=2001
@@ -65,7 +65,7 @@ PREHOOK: Output: default@loc_orc_1d@year=2000
 PREHOOK: Output: default@loc_orc_1d@year=2001
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table loc_orc_1d compute statistics for columns state,locid
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@loc_orc_1d
 POSTHOOK: Input: default@loc_orc_1d@year=2000
 POSTHOOK: Input: default@loc_orc_1d@year=2001
@@ -200,56 +200,56 @@ POSTHOOK: Lineage: loc_orc_2d PARTITION(zip=94087,year=2000).state SIMPLE [(ext_
 POSTHOOK: Lineage: loc_orc_2d PARTITION(zip=94087,year=2001).locid SIMPLE [(ext_loc)ext_loc.FieldSchema(name:locid, type:int, comment:null), ]
 POSTHOOK: Lineage: loc_orc_2d PARTITION(zip=94087,year=2001).state SIMPLE [(ext_loc)ext_loc.FieldSchema(name:state, type:string, comment:null), ]
 PREHOOK: query: analyze table loc_orc_2d partition(zip=94086, year='2000') compute statistics for columns state,locid
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@loc_orc_2d
 PREHOOK: Input: default@loc_orc_2d@zip=94086/year=2000
 PREHOOK: Output: default@loc_orc_2d
 PREHOOK: Output: default@loc_orc_2d@zip=94086/year=2000
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table loc_orc_2d partition(zip=94086, year='2000') compute statistics for columns state,locid
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@loc_orc_2d
 POSTHOOK: Input: default@loc_orc_2d@zip=94086/year=2000
 POSTHOOK: Output: default@loc_orc_2d
 POSTHOOK: Output: default@loc_orc_2d@zip=94086/year=2000
 #### A masked pattern was here ####
 PREHOOK: query: analyze table loc_orc_2d partition(zip=94087, year='2000') compute statistics for columns state,locid
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@loc_orc_2d
 PREHOOK: Input: default@loc_orc_2d@zip=94087/year=2000
 PREHOOK: Output: default@loc_orc_2d
 PREHOOK: Output: default@loc_orc_2d@zip=94087/year=2000
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table loc_orc_2d partition(zip=94087, year='2000') compute statistics for columns state,locid
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@loc_orc_2d
 POSTHOOK: Input: default@loc_orc_2d@zip=94087/year=2000
 POSTHOOK: Output: default@loc_orc_2d
 POSTHOOK: Output: default@loc_orc_2d@zip=94087/year=2000
 #### A masked pattern was here ####
 PREHOOK: query: analyze table loc_orc_2d partition(zip=94086, year='2001') compute statistics for columns state,locid
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@loc_orc_2d
 PREHOOK: Input: default@loc_orc_2d@zip=94086/year=2001
 PREHOOK: Output: default@loc_orc_2d
 PREHOOK: Output: default@loc_orc_2d@zip=94086/year=2001
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table loc_orc_2d partition(zip=94086, year='2001') compute statistics for columns state,locid
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@loc_orc_2d
 POSTHOOK: Input: default@loc_orc_2d@zip=94086/year=2001
 POSTHOOK: Output: default@loc_orc_2d
 POSTHOOK: Output: default@loc_orc_2d@zip=94086/year=2001
 #### A masked pattern was here ####
 PREHOOK: query: analyze table loc_orc_2d partition(zip=94087, year='2001') compute statistics for columns state,locid
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@loc_orc_2d
 PREHOOK: Input: default@loc_orc_2d@zip=94087/year=2001
 PREHOOK: Output: default@loc_orc_2d
 PREHOOK: Output: default@loc_orc_2d@zip=94087/year=2001
 #### A masked pattern was here ####
 POSTHOOK: query: analyze table loc_orc_2d partition(zip=94087, year='2001') compute statistics for columns state,locid
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@loc_orc_2d
 POSTHOOK: Input: default@loc_orc_2d@zip=94087/year=2001
 POSTHOOK: Output: default@loc_orc_2d
diff --git a/ql/src/test/results/clientpositive/updateAccessTime.q.out b/ql/src/test/results/clientpositive/updateAccessTime.q.out
index 62e9f74aac..d7b96301a0 100644
--- a/ql/src/test/results/clientpositive/updateAccessTime.q.out
+++ b/ql/src/test/results/clientpositive/updateAccessTime.q.out
@@ -218,12 +218,12 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Output: default@src
 PREHOOK: query: ANALYZE TABLE src COMPUTE STATISTICS FOR COLUMNS key,value
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@src
 PREHOOK: Output: default@src
 #### A masked pattern was here ####
 POSTHOOK: query: ANALYZE TABLE src COMPUTE STATISTICS FOR COLUMNS key,value
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@src
 POSTHOOK: Output: default@src
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/vector_outer_join1.q.out b/ql/src/test/results/clientpositive/vector_outer_join1.q.out
index a6d87c2d5c..5096b51f0b 100644
--- a/ql/src/test/results/clientpositive/vector_outer_join1.q.out
+++ b/ql/src/test/results/clientpositive/vector_outer_join1.q.out
@@ -184,12 +184,12 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@small_alltypesorc_a
 POSTHOOK: Output: default@small_alltypesorc_a
 PREHOOK: query: ANALYZE TABLE small_alltypesorc_a COMPUTE STATISTICS FOR COLUMNS
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@small_alltypesorc_a
 PREHOOK: Output: default@small_alltypesorc_a
 #### A masked pattern was here ####
 POSTHOOK: query: ANALYZE TABLE small_alltypesorc_a COMPUTE STATISTICS FOR COLUMNS
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@small_alltypesorc_a
 POSTHOOK: Output: default@small_alltypesorc_a
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/vector_outer_join2.q.out b/ql/src/test/results/clientpositive/vector_outer_join2.q.out
index 77a5bc753e..9a74003bdf 100644
--- a/ql/src/test/results/clientpositive/vector_outer_join2.q.out
+++ b/ql/src/test/results/clientpositive/vector_outer_join2.q.out
@@ -189,12 +189,12 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@small_alltypesorc_a
 POSTHOOK: Output: default@small_alltypesorc_a
 PREHOOK: query: ANALYZE TABLE small_alltypesorc_a COMPUTE STATISTICS FOR COLUMNS
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@small_alltypesorc_a
 PREHOOK: Output: default@small_alltypesorc_a
 #### A masked pattern was here ####
 POSTHOOK: query: ANALYZE TABLE small_alltypesorc_a COMPUTE STATISTICS FOR COLUMNS
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@small_alltypesorc_a
 POSTHOOK: Output: default@small_alltypesorc_a
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/vector_outer_join3.q.out b/ql/src/test/results/clientpositive/vector_outer_join3.q.out
index 20f8f4b6d5..d82eeba71c 100644
--- a/ql/src/test/results/clientpositive/vector_outer_join3.q.out
+++ b/ql/src/test/results/clientpositive/vector_outer_join3.q.out
@@ -189,12 +189,12 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@small_alltypesorc_a
 POSTHOOK: Output: default@small_alltypesorc_a
 PREHOOK: query: ANALYZE TABLE small_alltypesorc_a COMPUTE STATISTICS FOR COLUMNS
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@small_alltypesorc_a
 PREHOOK: Output: default@small_alltypesorc_a
 #### A masked pattern was here ####
 POSTHOOK: query: ANALYZE TABLE small_alltypesorc_a COMPUTE STATISTICS FOR COLUMNS
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@small_alltypesorc_a
 POSTHOOK: Output: default@small_alltypesorc_a
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/vector_outer_join4.q.out b/ql/src/test/results/clientpositive/vector_outer_join4.q.out
index 51ed3a2b7d..f26cfeecde 100644
--- a/ql/src/test/results/clientpositive/vector_outer_join4.q.out
+++ b/ql/src/test/results/clientpositive/vector_outer_join4.q.out
@@ -199,12 +199,12 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@small_alltypesorc_b
 POSTHOOK: Output: default@small_alltypesorc_b
 PREHOOK: query: ANALYZE TABLE small_alltypesorc_b COMPUTE STATISTICS FOR COLUMNS
-PREHOOK: type: QUERY
+PREHOOK: type: ANALYZE_TABLE
 PREHOOK: Input: default@small_alltypesorc_b
 PREHOOK: Output: default@small_alltypesorc_b
 #### A masked pattern was here ####
 POSTHOOK: query: ANALYZE TABLE small_alltypesorc_b COMPUTE STATISTICS FOR COLUMNS
-POSTHOOK: type: QUERY
+POSTHOOK: type: ANALYZE_TABLE
 POSTHOOK: Input: default@small_alltypesorc_b
 POSTHOOK: Output: default@small_alltypesorc_b
 #### A masked pattern was here ####
