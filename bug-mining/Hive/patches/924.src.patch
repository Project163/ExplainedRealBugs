diff --git a/ql/src/java/org/apache/hadoop/hive/ql/history/HiveHistory.java b/ql/src/java/org/apache/hadoop/hive/ql/history/HiveHistory.java
index e2f3ea5c3d..7e80c2d6bd 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/history/HiveHistory.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/history/HiveHistory.java
@@ -409,6 +409,9 @@ public void setTaskCounters(String queryId, String taskId, Counters ctrs) {
 
   public void printRowCount(String queryId) {
     QueryInfo ji = queryInfoMap.get(queryId);
+    if (ji == null) {
+      return;
+    }
     for (String tab : ji.rowCountMap.keySet()) {
       console.printInfo(ji.rowCountMap.get(tab) + " Rows loaded to " + tab);
     }
@@ -420,7 +423,6 @@ public void printRowCount(String queryId) {
    * @param queryId
    */
   public void endQuery(String queryId) {
-
     QueryInfo ji = queryInfoMap.get(queryId);
     if (ji == null) {
       return;
