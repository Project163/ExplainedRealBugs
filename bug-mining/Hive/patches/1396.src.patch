diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/FileSinkOperator.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/FileSinkOperator.java
index ab197f0ee1..ac3d6867d4 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/FileSinkOperator.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/FileSinkOperator.java
@@ -34,7 +34,6 @@
 import org.apache.hadoop.fs.FileSystem;
 import org.apache.hadoop.fs.Path;
 import org.apache.hadoop.hive.common.FileUtils;
-import org.apache.hadoop.hive.metastore.api.SkewedValueList;
 import org.apache.hadoop.hive.ql.ErrorMsg;
 import org.apache.hadoop.hive.ql.io.HiveFileFormatUtils;
 import org.apache.hadoop.hive.ql.io.HiveKey;
@@ -709,7 +708,7 @@ private String generateListBucketingDirName(Object row) {
     List<String> skewedCols = lbCtx.getSkewedColNames();
     List<List<String>> allSkewedVals = lbCtx.getSkewedColValues();
     List<String> skewedValsCandidate = null;
-    Map<SkewedValueList, String> locationMap = lbCtx.getLbLocationMap();
+    Map<List<String>, String> locationMap = lbCtx.getLbLocationMap();
 
     /* Convert input row to standard objects. */
     ObjectInspectorUtils.copyToStandardObject(standObjs, row,
@@ -727,14 +726,14 @@ private String generateListBucketingDirName(Object row) {
     if (allSkewedVals.contains(skewedValsCandidate)) {
       /* matches skewed values. */
       lbDirName = FileUtils.makeListBucketingDirName(skewedCols, skewedValsCandidate);
-      locationMap.put(new SkewedValueList(skewedValsCandidate), lbDirName);
+      locationMap.put(skewedValsCandidate, lbDirName);
     } else {
       /* create default directory. */
       lbDirName = FileUtils.makeDefaultListBucketingDirName(skewedCols,
           lbCtx.getDefaultDirName());
       List<String> defaultKey = Arrays.asList(lbCtx.getDefaultKey());
       if (!locationMap.containsKey(defaultKey)) {
-        locationMap.put(new SkewedValueList(defaultKey), lbDirName);
+        locationMap.put(defaultKey, lbDirName);
       }
     }
     return lbDirName;
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/BaseSemanticAnalyzer.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/BaseSemanticAnalyzer.java
index 6a5efaabf9..fa2c1e2028 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/BaseSemanticAnalyzer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/BaseSemanticAnalyzer.java
@@ -986,13 +986,26 @@ protected ListBucketingCtx constructListBucketingCtx(List<String> skewedColNames
     ListBucketingCtx lbCtx = new ListBucketingCtx();
     lbCtx.setSkewedColNames(skewedColNames);
     lbCtx.setSkewedColValues(skewedValues);
-    lbCtx.setLbLocationMap(skewedColValueLocationMaps);
+    lbCtx.setLbLocationMap(convertSkewedValueListToSimpleList(skewedColValueLocationMaps));
     lbCtx.setStoredAsSubDirectories(isStoredAsSubDirectories);
     lbCtx.setDefaultKey(ListBucketingPrunerUtils.HIVE_LIST_BUCKETING_DEFAULT_KEY);
     lbCtx.setDefaultDirName(ListBucketingPrunerUtils.HIVE_LIST_BUCKETING_DEFAULT_DIR_NAME);
     return lbCtx;
   }
 
+ // This is done to avoid the need of sending metastore jars to task nodes.
+  private Map<List<String>, String> convertSkewedValueListToSimpleList(
+      Map<SkewedValueList, String> skewedColValueLocationMaps) {
+    if (skewedColValueLocationMaps == null) {
+      return null;
+    }
+    Map<List<String>, String> converted = new HashMap<List<String>, String>();
+    for (Map.Entry<SkewedValueList, String> entry : skewedColValueLocationMaps.entrySet()) {
+      converted.put(entry.getKey().getSkewedValueList(), entry.getValue());
+    }
+    return converted;
+  }
+
   /**
    * Given a ASTNode, return list of values.
    *
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/plan/ListBucketingCtx.java b/ql/src/java/org/apache/hadoop/hive/ql/plan/ListBucketingCtx.java
index cf6ede1dc5..31fcaeb86d 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/plan/ListBucketingCtx.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/plan/ListBucketingCtx.java
@@ -23,7 +23,6 @@
 import java.util.Map;
 
 import org.apache.hadoop.hive.common.FileUtils;
-import org.apache.hadoop.hive.metastore.api.SkewedValueList;
 import org.apache.hadoop.hive.ql.exec.ColumnInfo;
 import org.apache.hadoop.hive.ql.exec.FileSinkOperator;
 import org.apache.hadoop.hive.ql.exec.RowSchema;
@@ -40,7 +39,7 @@ public class ListBucketingCtx implements Serializable {
   private static final long serialVersionUID = 1L;
   private List<String> skewedColNames;
   private List<List<String>> skewedColValues;
-  private Map<SkewedValueList, String> lbLocationMap;
+  private Map<List<String>, String> lbLocationMap;
   private List<SkewedColumnPositionPair> rowSkewedIndex;
   private boolean isStoredAsSubDirectories;
   private String defaultKey;
@@ -83,14 +82,14 @@ public void setSkewedColValues(List<List<String>> skewedColValues) {
   /**
    * @return the lbLocationMap
    */
-  public Map<SkewedValueList, String> getLbLocationMap() {
+  public Map<List<String>, String> getLbLocationMap() {
     return lbLocationMap;
   }
 
   /**
    * @param lbLocationMap the lbLocationMap to set
    */
-  public void setLbLocationMap(Map<SkewedValueList, String> lbLocationMap) {
+  public void setLbLocationMap(Map<List<String>, String> lbLocationMap) {
     this.lbLocationMap = lbLocationMap;
   }
 
