diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/TezCompiler.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/TezCompiler.java
index cfc34eb66b..fa16d0c026 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/TezCompiler.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/TezCompiler.java
@@ -60,6 +60,7 @@
 import org.apache.hadoop.hive.ql.optimizer.SetReducerParallelism;
 import org.apache.hadoop.hive.ql.optimizer.physical.PhysicalContext;
 import org.apache.hadoop.hive.ql.optimizer.physical.Vectorizer;
+import org.apache.hadoop.hive.ql.optimizer.physical.StageIDsRearranger;
 import org.apache.hadoop.hive.ql.plan.BaseWork;
 import org.apache.hadoop.hive.ql.plan.MapWork;
 import org.apache.hadoop.hive.ql.plan.MoveWork;
@@ -251,6 +252,9 @@ protected void optimizeTaskPlan(List<Task<? extends Serializable>> rootTasks, Pa
     if (conf.getBoolVar(HiveConf.ConfVars.HIVE_VECTORIZATION_ENABLED)) {
       (new Vectorizer()).resolve(physicalCtx);
     }
+    if (!"none".equalsIgnoreCase(conf.getVar(HiveConf.ConfVars.HIVESTAGEIDREARRANGE))) {
+      (new StageIDsRearranger()).resolve(physicalCtx);
+    }
     return;
   }
 }
diff --git a/ql/src/test/results/clientpositive/tez/insert1.q.out b/ql/src/test/results/clientpositive/tez/insert1.q.out
index 0009d7156e..3027079f32 100644
--- a/ql/src/test/results/clientpositive/tez/insert1.q.out
+++ b/ql/src/test/results/clientpositive/tez/insert1.q.out
@@ -264,10 +264,10 @@ POSTHOOK: Lineage: insert1.value SIMPLE [(insert2)a.FieldSchema(name:value, type
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-3 depends on stages: Stage-2
-  Stage-1 depends on stages: Stage-3
-  Stage-4 depends on stages: Stage-1
   Stage-0 depends on stages: Stage-3
-  Stage-5 depends on stages: Stage-0
+  Stage-4 depends on stages: Stage-0
+  Stage-1 depends on stages: Stage-3
+  Stage-5 depends on stages: Stage-1
 
 STAGE PLANS:
   Stage: Stage-2
@@ -313,28 +313,28 @@ STAGE PLANS:
   Stage: Stage-3
     Dependency Collection
 
-  Stage: Stage-1
+  Stage: Stage-0
     Move Operator
       tables:
-          replace: true
+          replace: false
           table:
               input format: org.apache.hadoop.mapred.TextInputFormat
               output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-              name: x.insert1
+              name: default.insert1
 
   Stage: Stage-4
     Stats-Aggr Operator
 
-  Stage: Stage-0
+  Stage: Stage-1
     Move Operator
       tables:
-          replace: false
+          replace: true
           table:
               input format: org.apache.hadoop.mapred.TextInputFormat
               output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-              name: default.insert1
+              name: x.insert1
 
   Stage: Stage-5
     Stats-Aggr Operator
diff --git a/ql/src/test/results/clientpositive/tez/load_dyn_part1.q.out b/ql/src/test/results/clientpositive/tez/load_dyn_part1.q.out
index 0a36484281..898091a3a9 100644
--- a/ql/src/test/results/clientpositive/tez/load_dyn_part1.q.out
+++ b/ql/src/test/results/clientpositive/tez/load_dyn_part1.q.out
@@ -45,10 +45,10 @@ POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-3 depends on stages: Stage-2
-  Stage-1 depends on stages: Stage-3
-  Stage-4 depends on stages: Stage-1
   Stage-0 depends on stages: Stage-3
-  Stage-5 depends on stages: Stage-0
+  Stage-4 depends on stages: Stage-0
+  Stage-1 depends on stages: Stage-3
+  Stage-5 depends on stages: Stage-1
 
 STAGE PLANS:
   Stage: Stage-2
@@ -94,34 +94,34 @@ STAGE PLANS:
   Stage: Stage-3
     Dependency Collection
 
-  Stage: Stage-1
+  Stage: Stage-0
     Move Operator
       tables:
           partition:
-            ds 2008-12-31
+            ds 
             hr 
           replace: true
           table:
               input format: org.apache.hadoop.mapred.TextInputFormat
               output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-              name: default.nzhang_part2
+              name: default.nzhang_part1
 
   Stage: Stage-4
     Stats-Aggr Operator
 
-  Stage: Stage-0
+  Stage: Stage-1
     Move Operator
       tables:
           partition:
-            ds 
+            ds 2008-12-31
             hr 
           replace: true
           table:
               input format: org.apache.hadoop.mapred.TextInputFormat
               output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-              name: default.nzhang_part1
+              name: default.nzhang_part2
 
   Stage: Stage-5
     Stats-Aggr Operator
