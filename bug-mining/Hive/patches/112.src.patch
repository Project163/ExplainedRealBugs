diff --git a/CHANGES.txt b/CHANGES.txt
index cd28b72d53..cc67466a07 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -447,3 +447,6 @@ Release 0.2.0 - Unreleased
 
     HIVE-399. Fix timeout problems caused due to the bigdata test.
     (Namit Jain via athusoo)
+
+    HIVE-397. Make union tests deterministic by ordering the
+    output results. (Namit Jain via athusoo)
diff --git a/ql/src/test/queries/clientpositive/union10.q b/ql/src/test/queries/clientpositive/union10.q
index 0498bc9eb6..bb7f72f5b4 100644
--- a/ql/src/test/queries/clientpositive/union10.q
+++ b/ql/src/test/queries/clientpositive/union10.q
@@ -2,7 +2,11 @@ set hive.map.aggr = true;
 
 -- union case: all subqueries are a map-reduce jobs, 3 way union, same input for all sub-queries, followed by filesink
 
+drop table tmptable;
+create table tmptable(key string, value int);
+
 explain 
+insert overwrite table tmptable
   select unionsrc.key, unionsrc.value FROM (select 'tst1' as key, count(1) as value from src s1
                                         UNION  ALL  
                                             select 'tst2' as key, count(1) as value from src s2
@@ -10,7 +14,7 @@ explain
                                             select 'tst3' as key, count(1) as value from src s3) unionsrc;
 
 
-
+insert overwrite table tmptable
   select unionsrc.key, unionsrc.value FROM (select 'tst1' as key, count(1) as value from src s1
                                         UNION  ALL  
                                             select 'tst2' as key, count(1) as value from src s2
@@ -18,4 +22,7 @@ explain
                                             select 'tst3' as key, count(1) as value from src s3) unionsrc;
 
 
+select * from tmptable x sort by x.key;
+
+drop table tmptable;
 
diff --git a/ql/src/test/queries/clientpositive/union12.q b/ql/src/test/queries/clientpositive/union12.q
index 13296f2522..412d0dcf92 100644
--- a/ql/src/test/queries/clientpositive/union12.q
+++ b/ql/src/test/queries/clientpositive/union12.q
@@ -2,7 +2,11 @@ set hive.map.aggr = true;
 
 -- union case: all subqueries are a map-reduce jobs, 3 way union, different inputs for all sub-queries, followed by filesink
 
+drop table tmptable;
+create table tmptable(key string, value int);
+
 explain 
+insert overwrite table tmptable
   select unionsrc.key, unionsrc.value FROM (select 'tst1' as key, count(1) as value from src s1
                                         UNION  ALL  
                                             select 'tst2' as key, count(1) as value from src1 s2
@@ -10,12 +14,13 @@ explain
                                             select 'tst3' as key, count(1) as value from srcbucket s3) unionsrc;
 
 
-
+insert overwrite table tmptable
   select unionsrc.key, unionsrc.value FROM (select 'tst1' as key, count(1) as value from src s1
                                         UNION  ALL  
                                             select 'tst2' as key, count(1) as value from src1 s2
                                         UNION ALL
                                             select 'tst3' as key, count(1) as value from srcbucket s3) unionsrc;
 
+select * from tmptable x sort by x.key;
 
-
+drop table tmptable;
diff --git a/ql/src/test/queries/clientpositive/union4.q b/ql/src/test/queries/clientpositive/union4.q
index 2838904be7..98ddfcbb24 100644
--- a/ql/src/test/queries/clientpositive/union4.q
+++ b/ql/src/test/queries/clientpositive/union4.q
@@ -2,11 +2,20 @@ set hive.map.aggr = true;
 
 -- union case: both subqueries are map-reduce jobs on same input, followed by filesink
 
+drop table tmptable;
+create table tmptable(key string, value int);
+
 explain 
+insert overwrite table tmptable
   select unionsrc.key, unionsrc.value FROM (select 'tst1' as key, count(1) as value from src s1
                                         UNION  ALL  
                                             select 'tst2' as key, count(1) as value from src s2) unionsrc;
 
+insert overwrite table tmptable
 select unionsrc.key, unionsrc.value FROM (select 'tst1' as key, count(1) as value from src s1
                                         UNION  ALL  
                                           select 'tst2' as key, count(1) as value from src s2) unionsrc;
+
+select * from tmptable x sort by x.key;
+
+drop table tmptable;
diff --git a/ql/src/test/queries/clientpositive/union6.q b/ql/src/test/queries/clientpositive/union6.q
index 54f72415c5..6d872d83de 100644
--- a/ql/src/test/queries/clientpositive/union6.q
+++ b/ql/src/test/queries/clientpositive/union6.q
@@ -2,13 +2,20 @@ set hive.map.aggr = true;
 
 -- union case: 1 subquery is a map-reduce job, different inputs for sub-queries, followed by filesink
 
+drop table tmptable;
+create table tmptable(key string, value string);
+
 explain 
+insert overwrite table tmptable
   select unionsrc.key, unionsrc.value FROM (select 'tst1' as key, cast(count(1) as string) as value from src s1
                                         UNION  ALL  
                                             select s2.key as key, s2.value as value from src1 s2) unionsrc;
 
-
+insert overwrite table tmptable
 select unionsrc.key, unionsrc.value FROM (select 'tst1' as key, cast(count(1) as string) as value from src s1
                                       UNION  ALL  
                                           select s2.key as key, s2.value as value from src1 s2) unionsrc;
 
+select * from tmptable x sort by x.key;
+
+drop table tmptable;
diff --git a/ql/src/test/results/clientpositive/union10.q.out b/ql/src/test/results/clientpositive/union10.q.out
index 58e63f979d..4473adc832 100644
--- a/ql/src/test/results/clientpositive/union10.q.out
+++ b/ql/src/test/results/clientpositive/union10.q.out
@@ -1,14 +1,16 @@
 ABSTRACT SYNTAX TREE:
-  (TOK_QUERY (TOK_FROM (TOK_SUBQUERY (TOK_UNION (TOK_QUERY (TOK_FROM (TOK_TABREF src s1)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR 'tst1' key) (TOK_SELEXPR (TOK_FUNCTION count 1) value)))) (TOK_UNION (TOK_QUERY (TOK_FROM (TOK_TABREF src s2)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR 'tst2' key) (TOK_SELEXPR (TOK_FUNCTION count 1) value)))) (TOK_QUERY (TOK_FROM (TOK_TABREF src s3)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR 'tst3' key) (TOK_SELEXPR (TOK_FUNCTION count 1) value)))))) unionsrc)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_COLREF unionsrc key)) (TOK_SELEXPR (TOK_COLREF unionsrc value)))))
+  (TOK_QUERY (TOK_FROM (TOK_SUBQUERY (TOK_UNION (TOK_QUERY (TOK_FROM (TOK_TABREF src s1)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR 'tst1' key) (TOK_SELEXPR (TOK_FUNCTION count 1) value)))) (TOK_UNION (TOK_QUERY (TOK_FROM (TOK_TABREF src s2)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR 'tst2' key) (TOK_SELEXPR (TOK_FUNCTION count 1) value)))) (TOK_QUERY (TOK_FROM (TOK_TABREF src s3)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR 'tst3' key) (TOK_SELEXPR (TOK_FUNCTION count 1) value)))))) unionsrc)) (TOK_INSERT (TOK_DESTINATION (TOK_TAB tmptable)) (TOK_SELECT (TOK_SELEXPR (TOK_COLREF unionsrc key)) (TOK_SELEXPR (TOK_COLREF unionsrc value)))))
 
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1, Stage-3, Stage-4
+  Stage-0 depends on stages: Stage-2
   Stage-3 is a root stage
   Stage-2 depends on stages: Stage-1, Stage-3, Stage-4
+  Stage-0 depends on stages: Stage-2
   Stage-4 is a root stage
   Stage-2 depends on stages: Stage-1, Stage-3, Stage-4
-  Stage-0 is a root stage
+  Stage-0 depends on stages: Stage-2
 
 STAGE PLANS:
   Stage: Stage-1
@@ -48,7 +50,7 @@ STAGE PLANS:
   Stage: Stage-2
     Map Reduce
       Alias -> Map Operator Tree:
-        /data/users/njain/hive1/hive/build/ql/tmp/303193293/170242382.10004 
+        /data/users/njain/hive1/hive/build/ql/tmp/696551718/22206266.10001 
           Union
             Select Operator
               expressions:
@@ -56,13 +58,21 @@ STAGE PLANS:
                     type: string
                     expr: 1
                     type: bigint
-              File Output Operator
-                compressed: false
-                GlobalTableId: 0
-                table:
-                    input format: org.apache.hadoop.mapred.TextInputFormat
-                    output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
-        /data/users/njain/hive1/hive/build/ql/tmp/303193293/170242382.10002 
+              Select Operator
+                expressions:
+                      expr: 0
+                      type: string
+                      expr: UDFToInteger(1)
+                      type: int
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 1
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
+                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                      name: tmptable
+        /data/users/njain/hive1/hive/build/ql/tmp/696551718/22206266.10003 
           Union
             Select Operator
               expressions:
@@ -70,13 +80,21 @@ STAGE PLANS:
                     type: string
                     expr: 1
                     type: bigint
-              File Output Operator
-                compressed: false
-                GlobalTableId: 0
-                table:
-                    input format: org.apache.hadoop.mapred.TextInputFormat
-                    output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
-        /data/users/njain/hive1/hive/build/ql/tmp/303193293/170242382.10003 
+              Select Operator
+                expressions:
+                      expr: 0
+                      type: string
+                      expr: UDFToInteger(1)
+                      type: int
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 1
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
+                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                      name: tmptable
+        /data/users/njain/hive1/hive/build/ql/tmp/696551718/22206266.10002 
           Union
             Select Operator
               expressions:
@@ -84,12 +102,30 @@ STAGE PLANS:
                     type: string
                     expr: 1
                     type: bigint
-              File Output Operator
-                compressed: false
-                GlobalTableId: 0
-                table:
-                    input format: org.apache.hadoop.mapred.TextInputFormat
-                    output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
+              Select Operator
+                expressions:
+                      expr: 0
+                      type: string
+                      expr: UDFToInteger(1)
+                      type: int
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 1
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
+                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                      name: tmptable
+
+  Stage: Stage-0
+    Move Operator
+      tables:
+            replace: true
+            table:
+                input format: org.apache.hadoop.mapred.TextInputFormat
+                output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
+                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                name: tmptable
 
   Stage: Stage-3
     Map Reduce
@@ -159,11 +195,7 @@ STAGE PLANS:
                   output format: org.apache.hadoop.mapred.SequenceFileOutputFormat
                   name: binary_table
 
-  Stage: Stage-0
-    Fetch Operator
-      limit: -1
-
 
-tst2	500
 tst1	500
+tst2	500
 tst3	500
diff --git a/ql/src/test/results/clientpositive/union12.q.out b/ql/src/test/results/clientpositive/union12.q.out
index 685a90e785..2c0d5ea0ca 100644
--- a/ql/src/test/results/clientpositive/union12.q.out
+++ b/ql/src/test/results/clientpositive/union12.q.out
@@ -1,14 +1,16 @@
 ABSTRACT SYNTAX TREE:
-  (TOK_QUERY (TOK_FROM (TOK_SUBQUERY (TOK_UNION (TOK_QUERY (TOK_FROM (TOK_TABREF src s1)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR 'tst1' key) (TOK_SELEXPR (TOK_FUNCTION count 1) value)))) (TOK_UNION (TOK_QUERY (TOK_FROM (TOK_TABREF src1 s2)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR 'tst2' key) (TOK_SELEXPR (TOK_FUNCTION count 1) value)))) (TOK_QUERY (TOK_FROM (TOK_TABREF srcbucket s3)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR 'tst3' key) (TOK_SELEXPR (TOK_FUNCTION count 1) value)))))) unionsrc)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_COLREF unionsrc key)) (TOK_SELEXPR (TOK_COLREF unionsrc value)))))
+  (TOK_QUERY (TOK_FROM (TOK_SUBQUERY (TOK_UNION (TOK_QUERY (TOK_FROM (TOK_TABREF src s1)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR 'tst1' key) (TOK_SELEXPR (TOK_FUNCTION count 1) value)))) (TOK_UNION (TOK_QUERY (TOK_FROM (TOK_TABREF src1 s2)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR 'tst2' key) (TOK_SELEXPR (TOK_FUNCTION count 1) value)))) (TOK_QUERY (TOK_FROM (TOK_TABREF srcbucket s3)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR 'tst3' key) (TOK_SELEXPR (TOK_FUNCTION count 1) value)))))) unionsrc)) (TOK_INSERT (TOK_DESTINATION (TOK_TAB tmptable)) (TOK_SELECT (TOK_SELEXPR (TOK_COLREF unionsrc key)) (TOK_SELEXPR (TOK_COLREF unionsrc value)))))
 
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1, Stage-3, Stage-4
+  Stage-0 depends on stages: Stage-2
   Stage-3 is a root stage
   Stage-2 depends on stages: Stage-1, Stage-3, Stage-4
+  Stage-0 depends on stages: Stage-2
   Stage-4 is a root stage
   Stage-2 depends on stages: Stage-1, Stage-3, Stage-4
-  Stage-0 is a root stage
+  Stage-0 depends on stages: Stage-2
 
 STAGE PLANS:
   Stage: Stage-1
@@ -48,7 +50,7 @@ STAGE PLANS:
   Stage: Stage-2
     Map Reduce
       Alias -> Map Operator Tree:
-        /data/users/njain/hive1/hive/build/ql/tmp/215277211/396097616.10003 
+        /data/users/njain/hive1/hive/build/ql/tmp/939524149/1568103970.10002 
           Union
             Select Operator
               expressions:
@@ -56,13 +58,21 @@ STAGE PLANS:
                     type: string
                     expr: 1
                     type: bigint
-              File Output Operator
-                compressed: false
-                GlobalTableId: 0
-                table:
-                    input format: org.apache.hadoop.mapred.TextInputFormat
-                    output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
-        /data/users/njain/hive1/hive/build/ql/tmp/215277211/396097616.10004 
+              Select Operator
+                expressions:
+                      expr: 0
+                      type: string
+                      expr: UDFToInteger(1)
+                      type: int
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 1
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
+                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                      name: tmptable
+        /data/users/njain/hive1/hive/build/ql/tmp/939524149/1568103970.10003 
           Union
             Select Operator
               expressions:
@@ -70,13 +80,21 @@ STAGE PLANS:
                     type: string
                     expr: 1
                     type: bigint
-              File Output Operator
-                compressed: false
-                GlobalTableId: 0
-                table:
-                    input format: org.apache.hadoop.mapred.TextInputFormat
-                    output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
-        /data/users/njain/hive1/hive/build/ql/tmp/215277211/396097616.10002 
+              Select Operator
+                expressions:
+                      expr: 0
+                      type: string
+                      expr: UDFToInteger(1)
+                      type: int
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 1
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
+                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                      name: tmptable
+        /data/users/njain/hive1/hive/build/ql/tmp/939524149/1568103970.10001 
           Union
             Select Operator
               expressions:
@@ -84,12 +102,30 @@ STAGE PLANS:
                     type: string
                     expr: 1
                     type: bigint
-              File Output Operator
-                compressed: false
-                GlobalTableId: 0
-                table:
-                    input format: org.apache.hadoop.mapred.TextInputFormat
-                    output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
+              Select Operator
+                expressions:
+                      expr: 0
+                      type: string
+                      expr: UDFToInteger(1)
+                      type: int
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 1
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
+                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                      name: tmptable
+
+  Stage: Stage-0
+    Move Operator
+      tables:
+            replace: true
+            table:
+                input format: org.apache.hadoop.mapred.TextInputFormat
+                output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
+                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                name: tmptable
 
   Stage: Stage-3
     Map Reduce
@@ -159,11 +195,7 @@ STAGE PLANS:
                   output format: org.apache.hadoop.mapred.SequenceFileOutputFormat
                   name: binary_table
 
-  Stage: Stage-0
-    Fetch Operator
-      limit: -1
-
 
-tst2	25
 tst1	500
+tst2	25
 tst3	1000
diff --git a/ql/src/test/results/clientpositive/union4.q.out b/ql/src/test/results/clientpositive/union4.q.out
index 992cf02cd0..5460698e3b 100644
--- a/ql/src/test/results/clientpositive/union4.q.out
+++ b/ql/src/test/results/clientpositive/union4.q.out
@@ -1,12 +1,13 @@
 ABSTRACT SYNTAX TREE:
-  (TOK_QUERY (TOK_FROM (TOK_SUBQUERY (TOK_UNION (TOK_QUERY (TOK_FROM (TOK_TABREF src s1)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR 'tst1' key) (TOK_SELEXPR (TOK_FUNCTION count 1) value)))) (TOK_QUERY (TOK_FROM (TOK_TABREF src s2)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR 'tst2' key) (TOK_SELEXPR (TOK_FUNCTION count 1) value))))) unionsrc)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_COLREF unionsrc key)) (TOK_SELEXPR (TOK_COLREF unionsrc value)))))
+  (TOK_QUERY (TOK_FROM (TOK_SUBQUERY (TOK_UNION (TOK_QUERY (TOK_FROM (TOK_TABREF src s1)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR 'tst1' key) (TOK_SELEXPR (TOK_FUNCTION count 1) value)))) (TOK_QUERY (TOK_FROM (TOK_TABREF src s2)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR 'tst2' key) (TOK_SELEXPR (TOK_FUNCTION count 1) value))))) unionsrc)) (TOK_INSERT (TOK_DESTINATION (TOK_TAB tmptable)) (TOK_SELECT (TOK_SELEXPR (TOK_COLREF unionsrc key)) (TOK_SELEXPR (TOK_COLREF unionsrc value)))))
 
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1, Stage-3
+  Stage-0 depends on stages: Stage-2
   Stage-3 is a root stage
   Stage-2 depends on stages: Stage-1, Stage-3
-  Stage-0 is a root stage
+  Stage-0 depends on stages: Stage-2
 
 STAGE PLANS:
   Stage: Stage-1
@@ -46,7 +47,7 @@ STAGE PLANS:
   Stage: Stage-2
     Map Reduce
       Alias -> Map Operator Tree:
-        /data/users/njain/hive1/hive/build/ql/tmp/663543405/51390228.10003 
+        /data/users/njain/hive1/hive/build/ql/tmp/454950299/344236938.10001 
           Union
             Select Operator
               expressions:
@@ -54,13 +55,21 @@ STAGE PLANS:
                     type: string
                     expr: 1
                     type: bigint
-              File Output Operator
-                compressed: false
-                GlobalTableId: 0
-                table:
-                    input format: org.apache.hadoop.mapred.TextInputFormat
-                    output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
-        /data/users/njain/hive1/hive/build/ql/tmp/663543405/51390228.10002 
+              Select Operator
+                expressions:
+                      expr: 0
+                      type: string
+                      expr: UDFToInteger(1)
+                      type: int
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 1
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
+                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                      name: tmptable
+        /data/users/njain/hive1/hive/build/ql/tmp/454950299/344236938.10002 
           Union
             Select Operator
               expressions:
@@ -68,12 +77,30 @@ STAGE PLANS:
                     type: string
                     expr: 1
                     type: bigint
-              File Output Operator
-                compressed: false
-                GlobalTableId: 0
-                table:
-                    input format: org.apache.hadoop.mapred.TextInputFormat
-                    output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
+              Select Operator
+                expressions:
+                      expr: 0
+                      type: string
+                      expr: UDFToInteger(1)
+                      type: int
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 1
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
+                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                      name: tmptable
+
+  Stage: Stage-0
+    Move Operator
+      tables:
+            replace: true
+            table:
+                input format: org.apache.hadoop.mapred.TextInputFormat
+                output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
+                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                name: tmptable
 
   Stage: Stage-3
     Map Reduce
@@ -109,10 +136,6 @@ STAGE PLANS:
                   output format: org.apache.hadoop.mapred.SequenceFileOutputFormat
                   name: binary_table
 
-  Stage: Stage-0
-    Fetch Operator
-      limit: -1
-
 
 tst1	500
 tst2	500
diff --git a/ql/src/test/results/clientpositive/union6.q.out b/ql/src/test/results/clientpositive/union6.q.out
index 926c3b529a..5918597921 100644
--- a/ql/src/test/results/clientpositive/union6.q.out
+++ b/ql/src/test/results/clientpositive/union6.q.out
@@ -1,12 +1,13 @@
 ABSTRACT SYNTAX TREE:
-  (TOK_QUERY (TOK_FROM (TOK_SUBQUERY (TOK_UNION (TOK_QUERY (TOK_FROM (TOK_TABREF src s1)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR 'tst1' key) (TOK_SELEXPR (TOK_FUNCTION TOK_STRING (TOK_FUNCTION count 1)) value)))) (TOK_QUERY (TOK_FROM (TOK_TABREF src1 s2)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_COLREF s2 key) key) (TOK_SELEXPR (TOK_COLREF s2 value) value))))) unionsrc)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_COLREF unionsrc key)) (TOK_SELEXPR (TOK_COLREF unionsrc value)))))
+  (TOK_QUERY (TOK_FROM (TOK_SUBQUERY (TOK_UNION (TOK_QUERY (TOK_FROM (TOK_TABREF src s1)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR 'tst1' key) (TOK_SELEXPR (TOK_FUNCTION TOK_STRING (TOK_FUNCTION count 1)) value)))) (TOK_QUERY (TOK_FROM (TOK_TABREF src1 s2)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_COLREF s2 key) key) (TOK_SELEXPR (TOK_COLREF s2 value) value))))) unionsrc)) (TOK_INSERT (TOK_DESTINATION (TOK_TAB tmptable)) (TOK_SELECT (TOK_SELEXPR (TOK_COLREF unionsrc key)) (TOK_SELEXPR (TOK_COLREF unionsrc value)))))
 
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1, Stage-3
+  Stage-0 depends on stages: Stage-2
   Stage-3 is a root stage
   Stage-2 depends on stages: Stage-1, Stage-3
-  Stage-0 is a root stage
+  Stage-0 depends on stages: Stage-2
 
 STAGE PLANS:
   Stage: Stage-1
@@ -46,7 +47,7 @@ STAGE PLANS:
   Stage: Stage-2
     Map Reduce
       Alias -> Map Operator Tree:
-        /data/users/njain/hive1/hive/build/ql/tmp/139790801/454578640.10003 
+        /data/users/njain/hive1/hive/build/ql/tmp/307930301/298785353.10001 
           Union
             Select Operator
               expressions:
@@ -56,11 +57,13 @@ STAGE PLANS:
                     type: string
               File Output Operator
                 compressed: false
-                GlobalTableId: 0
+                GlobalTableId: 1
                 table:
                     input format: org.apache.hadoop.mapred.TextInputFormat
                     output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
-        /data/users/njain/hive1/hive/build/ql/tmp/139790801/454578640.10002 
+                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                    name: tmptable
+        /data/users/njain/hive1/hive/build/ql/tmp/307930301/298785353.10002 
           Union
             Select Operator
               expressions:
@@ -70,10 +73,22 @@ STAGE PLANS:
                     type: string
               File Output Operator
                 compressed: false
-                GlobalTableId: 0
+                GlobalTableId: 1
                 table:
                     input format: org.apache.hadoop.mapred.TextInputFormat
                     output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
+                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                    name: tmptable
+
+  Stage: Stage-0
+    Move Operator
+      tables:
+            replace: true
+            table:
+                input format: org.apache.hadoop.mapred.TextInputFormat
+                output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
+                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                name: tmptable
 
   Stage: Stage-3
     Map Reduce
@@ -93,34 +108,30 @@ STAGE PLANS:
                     output format: org.apache.hadoop.mapred.SequenceFileOutputFormat
                     name: binary_table
 
-  Stage: Stage-0
-    Fetch Operator
-      limit: -1
-
 
-tst1	500
-238	val_238
+	val_193
+	
 	
-311	val_311
 	val_27
 	val_165
 	val_409
-255	val_255
-278	val_278
-98	val_98
+	
+	
 	val_484
 	val_265
-	val_193
-401	val_401
+128	
+146	val_146
 150	val_150
-273	val_273
+213	val_213
 224	
+238	val_238
+255	val_255
+273	val_273
+278	val_278
+311	val_311
 369	
-66	val_66
-128	
-213	val_213
-146	val_146
+401	val_401
 406	val_406
-	
-	
-	
+66	val_66
+98	val_98
+tst1	500
