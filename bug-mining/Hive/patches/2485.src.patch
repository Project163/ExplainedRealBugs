diff --git a/contrib/src/test/results/clientnegative/serde_regex.q.out b/contrib/src/test/results/clientnegative/serde_regex.q.out
index c5a22b05e7..988bf10706 100644
--- a/contrib/src/test/results/clientnegative/serde_regex.q.out
+++ b/contrib/src/test/results/clientnegative/serde_regex.q.out
@@ -56,7 +56,7 @@ STAGE PLANS:
           serde properties:
             input.regex ([^ ]*) ([^ ]*) ([^ ]*) (-|\[[^\]]*\]) ([^ "]*|"[^"]*") (-|[0-9]*) (-|[0-9]*)(?: ([^ "]*|"[^"]*") ([^ "]*|"[^"]*"))?
             output.format.string %1$s %2$s %3$s %4$s %5$s %6$s %7$s %8$s %9$s
-          name: serde_regex
+          name: default.serde_regex
 
 PREHOOK: query: CREATE TABLE serde_regex(
   host STRING,
diff --git a/contrib/src/test/results/clientpositive/fileformat_base64.q.out b/contrib/src/test/results/clientpositive/fileformat_base64.q.out
index 852e351156..1be29952d7 100644
--- a/contrib/src/test/results/clientpositive/fileformat_base64.q.out
+++ b/contrib/src/test/results/clientpositive/fileformat_base64.q.out
@@ -22,7 +22,7 @@ STAGE PLANS:
           columns: key int, value string
           input format: org.apache.hadoop.hive.contrib.fileformat.base64.Base64TextInputFormat
           output format: org.apache.hadoop.hive.contrib.fileformat.base64.Base64TextOutputFormat
-          name: base64_test
+          name: default.base64_test
 
 PREHOOK: query: CREATE TABLE base64_test(key INT, value STRING) STORED AS
   INPUTFORMAT 'org.apache.hadoop.hive.contrib.fileformat.base64.Base64TextInputFormat'
diff --git a/contrib/src/test/results/clientpositive/serde_regex.q.out b/contrib/src/test/results/clientpositive/serde_regex.q.out
index 13019eb05d..dc97cb3f46 100644
--- a/contrib/src/test/results/clientpositive/serde_regex.q.out
+++ b/contrib/src/test/results/clientpositive/serde_regex.q.out
@@ -48,7 +48,7 @@ STAGE PLANS:
           serde properties:
             input.regex ([^ ]*) ([^ ]*) ([^ ]*) (-|\[[^\]]*\]) ([^ "]*|"[^"]*") (-|[0-9]*) (-|[0-9]*)(?: ([^ "]*|"[^"]*") ([^ "]*|"[^"]*"))?
             output.format.string %1$s %2$s %3$s %4$s %5$s %6$s %7$s %8$s %9$s
-          name: serde_regex
+          name: default.serde_regex
 
 PREHOOK: query: CREATE TABLE serde_regex(
   host STRING,
diff --git a/hbase-handler/src/test/results/negative/cascade_dbdrop.q.out b/hbase-handler/src/test/results/negative/cascade_dbdrop.q.out
index 61e333c164..d2e0b81ebe 100644
--- a/hbase-handler/src/test/results/negative/cascade_dbdrop.q.out
+++ b/hbase-handler/src/test/results/negative/cascade_dbdrop.q.out
@@ -20,7 +20,7 @@ WITH SERDEPROPERTIES ("hbase.columns.mapping" = ":key,cf:string")
 TBLPROPERTIES ("hbase.table.name" = "hbase_table_0")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:hbasedb
-PREHOOK: Output: hbaseDB@hbaseDB.hbase_table_0
+PREHOOK: Output: hbaseDB@hbase_table_0
 POSTHOOK: query: -- EXCLUDE_HADOOP_MAJOR_VERSIONS(0.20, 0.20S)
 -- Hadoop 0.23 changes the behavior FsShell on Exit Codes
 -- In Hadoop 0.20
@@ -37,7 +37,6 @@ WITH SERDEPROPERTIES ("hbase.columns.mapping" = ":key,cf:string")
 TBLPROPERTIES ("hbase.table.name" = "hbase_table_0")
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:hbasedb
-POSTHOOK: Output: hbaseDB@hbaseDB.hbase_table_0
 POSTHOOK: Output: hbaseDB@hbase_table_0
 Found 3 items
 #### A masked pattern was here ####
diff --git a/itests/hive-unit/src/test/java/org/apache/hadoop/hive/ql/security/authorization/plugin/TestHiveAuthorizerCheckInvocation.java b/itests/hive-unit/src/test/java/org/apache/hadoop/hive/ql/security/authorization/plugin/TestHiveAuthorizerCheckInvocation.java
index 9bda95d162..53d88b08b6 100644
--- a/itests/hive-unit/src/test/java/org/apache/hadoop/hive/ql/security/authorization/plugin/TestHiveAuthorizerCheckInvocation.java
+++ b/itests/hive-unit/src/test/java/org/apache/hadoop/hive/ql/security/authorization/plugin/TestHiveAuthorizerCheckInvocation.java
@@ -21,6 +21,7 @@
 import static org.junit.Assert.assertEquals;
 import static org.junit.Assert.assertNull;
 import static org.junit.Assert.assertTrue;
+import static org.junit.Assert.fail;
 import static org.mockito.Matchers.any;
 import static org.mockito.Mockito.reset;
 import static org.mockito.Mockito.verify;
@@ -140,6 +141,47 @@ public void testInputAllColumnsUsed() throws HiveAuthzPluginException, HiveAcces
         getSortedList(tableObj.getColumns()));
   }
 
+  @Test
+  public void testCreateTableWithDb() throws HiveAuthzPluginException, HiveAccessControlException,
+      CommandNeedRetryException {
+    final String newTable = "ctTableWithDb";
+    checkCreateViewOrTableWithDb(newTable, "create table " + dbName + "." + newTable + "(i int)");
+  }
+
+  @Test
+  public void testCreateViewWithDb() throws HiveAuthzPluginException, HiveAccessControlException,
+      CommandNeedRetryException {
+    final String newTable = "ctViewWithDb";
+    checkCreateViewOrTableWithDb(newTable, "create table " + dbName + "." + newTable + "(i int)");
+  }
+
+  private void checkCreateViewOrTableWithDb(String newTable, String cmd)
+      throws HiveAuthzPluginException, HiveAccessControlException {
+    reset(mockedAuthorizer);
+    int status = driver.compile(cmd);
+    assertEquals(0, status);
+
+    List<HivePrivilegeObject> outputs = getHivePrivilegeObjectInputs().getRight();
+    assertEquals("num outputs", 2, outputs.size());
+    for (HivePrivilegeObject output : outputs) {
+      switch (output.getType()) {
+      case DATABASE:
+        assertTrue("database name", output.getDbname().equalsIgnoreCase(dbName));
+        break;
+      case TABLE_OR_VIEW:
+        assertTrue("database name", output.getDbname().equalsIgnoreCase(dbName));
+        assertEqualsIgnoreCase("table name", output.getObjectName(), newTable);
+        break;
+      default:
+        fail("Unexpected type : " + output.getType());
+      }
+    }
+  }
+
+  private void assertEqualsIgnoreCase(String msg, String expected, String actual) {
+    assertEquals(msg, expected.toLowerCase(), actual.toLowerCase());
+  }
+
   @Test
   public void testInputNoColumnsUsed() throws HiveAuthzPluginException, HiveAccessControlException,
       CommandNeedRetryException {
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/BaseSemanticAnalyzer.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/BaseSemanticAnalyzer.java
index 424ca508a8..b5b2b609b2 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/BaseSemanticAnalyzer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/BaseSemanticAnalyzer.java
@@ -48,6 +48,7 @@
 import org.apache.hadoop.hive.ql.exec.ExprNodeEvaluatorFactory;
 import org.apache.hadoop.hive.ql.exec.FetchTask;
 import org.apache.hadoop.hive.ql.exec.Task;
+import org.apache.hadoop.hive.ql.exec.Utilities;
 import org.apache.hadoop.hive.ql.hooks.LineageInfo;
 import org.apache.hadoop.hive.ql.hooks.ReadEntity;
 import org.apache.hadoop.hive.ql.hooks.WriteEntity;
@@ -61,7 +62,6 @@
 import org.apache.hadoop.hive.ql.plan.ExprNodeDesc;
 import org.apache.hadoop.hive.ql.plan.ListBucketingCtx;
 import org.apache.hadoop.hive.ql.plan.PlanUtils;
-import org.apache.hadoop.hive.ql.session.SessionState;
 import org.apache.hadoop.hive.ql.session.SessionState.LogHelper;
 import org.apache.hadoop.hive.serde.serdeConstants;
 import org.apache.hadoop.hive.serde2.io.DateWritable;
@@ -317,7 +317,7 @@ public static String[] getQualifiedTableName(ASTNode tabNameNode) throws Semanti
       return new String[] {dbName, tableName};
     }
     String tableName = unescapeIdentifier(tabNameNode.getChild(0).getText());
-    return new String[]{SessionState.get().getCurrentDatabase(), tableName};
+    return Utilities.getDbTableName(tableName);
   }
 
   public static String getDotName(String[] qname) throws SemanticException {
@@ -1218,6 +1218,10 @@ protected Table getTable(String[] qualified) throws SemanticException {
     return getTable(qualified[0], qualified[1], true);
   }
 
+  protected Table getTable(String[] qualified, boolean throwException) throws SemanticException {
+    return getTable(qualified[0], qualified[1], throwException);
+  }
+
   protected Table getTable(String tblName) throws SemanticException {
     return getTable(null, tblName, true);
   }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
index e6b4422053..6285950780 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
@@ -9416,7 +9416,7 @@ public void analyzeInternal(ASTNode ast) throws SemanticException {
       }
       viewSelect = child;
       // prevent view from referencing itself
-      viewsExpanded.add(SessionState.get().getCurrentDatabase() + "." + createVwDesc.getViewName());
+      viewsExpanded.add(createVwDesc.getViewName());
     }
 
     // continue analyzing from the child ASTNode.
@@ -9998,7 +9998,9 @@ private Map<String, String> addDefaultProperties(Map<String, String> tblProp) {
    */
   private ASTNode analyzeCreateTable(ASTNode ast, QB qb)
       throws SemanticException {
-    String tableName = getUnescapedName((ASTNode) ast.getChild(0));
+    String[] qualifiedTabName = getQualifiedTableName((ASTNode) ast.getChild(0));
+    String dbDotTab = getDotName(qualifiedTabName);
+
     String likeTableName = null;
     List<FieldSchema> cols = new ArrayList<FieldSchema>();
     List<FieldSchema> partCols = new ArrayList<FieldSchema>();
@@ -10024,7 +10026,7 @@ private ASTNode analyzeCreateTable(ASTNode ast, QB qb)
     RowFormatParams rowFormatParams = new RowFormatParams();
     StorageFormat storageFormat = new StorageFormat(conf);
 
-    LOG.info("Creating table " + tableName + " position="
+    LOG.info("Creating table " + dbDotTab + " position="
         + ast.getCharPositionInLine());
     int numCh = ast.getChildCount();
 
@@ -10155,7 +10157,7 @@ private ASTNode analyzeCreateTable(ASTNode ast, QB qb)
     // check for existence of table
     if (ifNotExists) {
       try {
-        Table table = getTable(tableName, false);
+        Table table = getTable(qualifiedTabName, false);
         if (table != null) { // table exists
           return null;
         }
@@ -10165,11 +10167,7 @@ private ASTNode analyzeCreateTable(ASTNode ast, QB qb)
       }
     }
 
-    String[] qualified = Hive.getQualifiedNames(tableName);
-    String dbName = qualified.length == 1 ? SessionState.get().getCurrentDatabase() : qualified[0];
-    Database database  = getDatabase(dbName);
-    outputs.add(new WriteEntity(database, WriteEntity.WriteType.DDL_SHARED));
-    outputs.add(new WriteEntity(new Table(dbName, tableName), WriteEntity.WriteType.DDL_NO_LOCK));
+    addDbAndTabToOutputs(qualifiedTabName);
 
     if (isTemporary) {
       if (partCols.size() > 0) {
@@ -10198,7 +10196,7 @@ private ASTNode analyzeCreateTable(ASTNode ast, QB qb)
     case CREATE_TABLE: // REGULAR CREATE TABLE DDL
       tblProps = addDefaultProperties(tblProps);
 
-      crtTblDesc = new CreateTableDesc(tableName, isExt, isTemporary, cols, partCols,
+      crtTblDesc = new CreateTableDesc(dbDotTab, isExt, isTemporary, cols, partCols,
           bucketCols, sortCols, numBuckets, rowFormatParams.fieldDelim,
           rowFormatParams.fieldEscape,
           rowFormatParams.collItemDelim, rowFormatParams.mapKeyDelim, rowFormatParams.lineDelim,
@@ -10227,7 +10225,7 @@ private ASTNode analyzeCreateTable(ASTNode ast, QB qb)
               + "and source table in CREATE TABLE LIKE is partitioned.");
         }
       }
-      CreateTableLikeDesc crtTblLikeDesc = new CreateTableLikeDesc(tableName, isExt, isTemporary,
+      CreateTableLikeDesc crtTblLikeDesc = new CreateTableLikeDesc(dbDotTab, isExt, isTemporary,
           storageFormat.getInputFormat(), storageFormat.getOutputFormat(), location,
           storageFormat.getSerde(), storageFormat.getSerdeProps(), tblProps, ifNotExists,
           likeTableName);
@@ -10240,9 +10238,9 @@ private ASTNode analyzeCreateTable(ASTNode ast, QB qb)
 
       // Verify that the table does not already exist
       try {
-        Table dumpTable = db.newTable(tableName);
+        Table dumpTable = db.newTable(dbDotTab);
         if (null != db.getTable(dumpTable.getDbName(), dumpTable.getTableName(), false)) {
-          throw new SemanticException(ErrorMsg.TABLE_ALREADY_EXISTS.getMsg(tableName));
+          throw new SemanticException(ErrorMsg.TABLE_ALREADY_EXISTS.getMsg(dbDotTab));
         }
       } catch (HiveException e) {
         throw new SemanticException(e);
@@ -10250,11 +10248,10 @@ private ASTNode analyzeCreateTable(ASTNode ast, QB qb)
 
       tblProps = addDefaultProperties(tblProps);
 
-      crtTblDesc = new CreateTableDesc(dbName, tableName, isExt, isTemporary, cols, partCols,
-          bucketCols, sortCols, numBuckets, rowFormatParams.fieldDelim,
-          rowFormatParams.fieldEscape,
-          rowFormatParams.collItemDelim, rowFormatParams.mapKeyDelim, rowFormatParams.lineDelim,
-          comment, storageFormat.getInputFormat(),
+      crtTblDesc = new CreateTableDesc(qualifiedTabName[0], dbDotTab, isExt, isTemporary, cols,
+          partCols, bucketCols, sortCols, numBuckets, rowFormatParams.fieldDelim,
+          rowFormatParams.fieldEscape, rowFormatParams.collItemDelim, rowFormatParams.mapKeyDelim,
+          rowFormatParams.lineDelim, comment, storageFormat.getInputFormat(),
           storageFormat.getOutputFormat(), location, storageFormat.getSerde(),
           storageFormat.getStorageHandler(), storageFormat.getSerdeProps(), tblProps, ifNotExists,
           skewedColNames, skewedValues);
@@ -10271,9 +10268,17 @@ private ASTNode analyzeCreateTable(ASTNode ast, QB qb)
     return null;
   }
 
+  private void addDbAndTabToOutputs(String[] qualifiedTabName) throws SemanticException {
+    Database database  = getDatabase(qualifiedTabName[0]);
+    outputs.add(new WriteEntity(database, WriteEntity.WriteType.DDL_SHARED));
+    outputs.add(new WriteEntity(new Table(qualifiedTabName[0], qualifiedTabName[1]),
+        WriteEntity.WriteType.DDL_NO_LOCK));
+  }
+
   private ASTNode analyzeCreateView(ASTNode ast, QB qb)
       throws SemanticException {
-    String tableName = getUnescapedName((ASTNode) ast.getChild(0));
+    String[] qualTabName = getQualifiedTableName((ASTNode) ast.getChild(0));
+    String dbDotTable = getDotName(qualTabName);
     List<FieldSchema> cols = null;
     boolean ifNotExists = false;
     boolean orReplace = false;
@@ -10283,7 +10288,7 @@ private ASTNode analyzeCreateView(ASTNode ast, QB qb)
     Map<String, String> tblProps = null;
     List<String> partColNames = null;
 
-    LOG.info("Creating view " + tableName + " position="
+    LOG.info("Creating view " + dbDotTable + " position="
         + ast.getCharPositionInLine());
     int numCh = ast.getChildCount();
     for (int num = 1; num < numCh; num++) {
@@ -10326,13 +10331,14 @@ private ASTNode analyzeCreateView(ASTNode ast, QB qb)
     }
 
     createVwDesc = new CreateViewDesc(
-      tableName, cols, comment, tblProps, partColNames,
+      dbDotTable, cols, comment, tblProps, partColNames,
       ifNotExists, orReplace, isAlterViewAs);
 
     unparseTranslator.enable();
     rootTasks.add(TaskFactory.get(new DDLWork(getInputs(), getOutputs(),
         createVwDesc), conf));
 
+    addDbAndTabToOutputs(qualTabName);
     return selectStmt;
   }
 
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/TaskCompiler.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/TaskCompiler.java
index a8d9a15726..0f714b57ef 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/TaskCompiler.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/TaskCompiler.java
@@ -21,6 +21,7 @@
 import java.io.Serializable;
 import java.util.ArrayList;
 import java.util.HashSet;
+import java.util.Iterator;
 import java.util.LinkedHashSet;
 import java.util.List;
 import java.util.Set;
@@ -227,11 +228,19 @@ public void compile(final ParseContext pCtx, final List<Task<? extends Serializa
 
       crtTblDesc.validate(conf);
 
-      // Clear the output for CTAS since we don't need the output from the
-      // mapredWork, the
+      // clear the mapredWork output file from outputs for CTAS
       // DDLWork at the tail of the chain will have the output
-      outputs.clear();
-
+      Iterator<WriteEntity> outIter = outputs.iterator();
+      while (outIter.hasNext()) {
+        switch (outIter.next().getType()) {
+        case DFS_DIR:
+        case LOCAL_DIR:
+          outIter.remove();
+          break;
+        default:
+          break;
+        }
+      }
       Task<? extends Serializable> crtTblTask = TaskFactory.get(new DDLWork(
           inputs, outputs, crtTblDesc), conf);
 
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/plan/PlanUtils.java b/ql/src/java/org/apache/hadoop/hive/ql/plan/PlanUtils.java
index 5b48ea25d7..6dce30c9bd 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/plan/PlanUtils.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/plan/PlanUtils.java
@@ -347,7 +347,7 @@ public static TableDesc getTableDesc(CreateTableDesc crtTblDesc, String cols,
 
       if (crtTblDesc.getTableName() != null && crtTblDesc.getDatabaseName() != null) {
         properties.setProperty(org.apache.hadoop.hive.metastore.api.hive_metastoreConstants.META_TABLE_NAME,
-            crtTblDesc.getDatabaseName() + "." + crtTblDesc.getTableName());
+            crtTblDesc.getTableName());
       }
 
       if (crtTblDesc.getTblProps() != null) {
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/security/authorization/plugin/sqlstd/Operation2Privilege.java b/ql/src/java/org/apache/hadoop/hive/ql/security/authorization/plugin/sqlstd/Operation2Privilege.java
index f1fbf9ff5f..ebe67d94a2 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/security/authorization/plugin/sqlstd/Operation2Privilege.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/security/authorization/plugin/sqlstd/Operation2Privilege.java
@@ -278,8 +278,9 @@ public HivePrivilegeObjectType getObjectType() {
 (SEL_NOGRANT_AR, null));
     op2Priv.put(HiveOperationType.SHOW_TBLPROPERTIES, PrivRequirement.newIOPrivRequirement
 (SEL_NOGRANT_AR, null));
-    op2Priv.put(HiveOperationType.CREATETABLE_AS_SELECT, PrivRequirement.newIOPrivRequirement
-(SEL_NOGRANT_AR, null));
+    op2Priv.put(HiveOperationType.CREATETABLE_AS_SELECT, PrivRequirement.newPrivRequirementList(
+        new PrivRequirement(SEL_NOGRANT_AR, IOType.INPUT),
+        new PrivRequirement(OWNER_PRIV_AR, HivePrivilegeObjectType.DATABASE)));
 
     // QUERY,LOAD op can contain an insert & overwrite,
     // require delete privilege if this is an insert-overwrite
@@ -302,8 +303,9 @@ public HivePrivilegeObjectType getObjectType() {
 
     // for now allow only create-view with 'select with grant'
     // the owner will also have select with grant privileges on new view
-    op2Priv.put(HiveOperationType.CREATEVIEW, PrivRequirement.newIOPrivRequirement
-(SEL_GRANT_AR, null));
+    op2Priv.put(HiveOperationType.CREATEVIEW, PrivRequirement.newPrivRequirementList(
+        new PrivRequirement(SEL_GRANT_AR, IOType.INPUT),
+        new PrivRequirement(OWNER_PRIV_AR, HivePrivilegeObjectType.DATABASE)));
 
     op2Priv.put(HiveOperationType.SHOWFUNCTIONS, PrivRequirement.newIOPrivRequirement
 (null, null));
diff --git a/ql/src/test/queries/clientnegative/authorize_create_tbl.q b/ql/src/test/queries/clientnegative/authorization_create_tbl.q
similarity index 100%
rename from ql/src/test/queries/clientnegative/authorize_create_tbl.q
rename to ql/src/test/queries/clientnegative/authorization_create_tbl.q
diff --git a/ql/src/test/queries/clientnegative/authorization_create_view.q b/ql/src/test/queries/clientnegative/authorization_create_view.q
new file mode 100644
index 0000000000..6438cdd141
--- /dev/null
+++ b/ql/src/test/queries/clientnegative/authorization_create_view.q
@@ -0,0 +1,13 @@
+set hive.test.authz.sstd.hs2.mode=true;
+set hive.security.authorization.manager=org.apache.hadoop.hive.ql.security.authorization.plugin.sqlstd.SQLStdHiveAuthorizerFactoryForTest;
+set hive.security.authenticator.manager=org.apache.hadoop.hive.ql.security.SessionStateConfigUserAuthenticator;
+set hive.security.authorization.enabled=true;
+
+set user.name=user3;
+create database db1;
+use db1;
+create table tab1(i int);
+
+set user.name=user4;
+-- create view should fail as view is being created in db that it does not own
+create view db1.view1(i) as select * from tab1;
diff --git a/ql/src/test/queries/clientnegative/authorization_ctas2.q b/ql/src/test/queries/clientnegative/authorization_ctas2.q
new file mode 100644
index 0000000000..0bf634c769
--- /dev/null
+++ b/ql/src/test/queries/clientnegative/authorization_ctas2.q
@@ -0,0 +1,14 @@
+set hive.test.authz.sstd.hs2.mode=true;
+set hive.security.authorization.manager=org.apache.hadoop.hive.ql.security.authorization.plugin.sqlstd.SQLStdHiveAuthorizerFactoryForTest;
+set hive.security.authenticator.manager=org.apache.hadoop.hive.ql.security.SessionStateConfigUserAuthenticator;
+set hive.security.authorization.enabled=true;
+
+set user.name=user_dbowner;
+-- check ctas without db ownership
+create database ctas_auth;
+
+set user.name=user_unauth;
+create table t1(i int);
+use ctas_auth;
+show tables;
+create table t2 as select * from default.t1;
diff --git a/ql/src/test/queries/clientpositive/input46.q b/ql/src/test/queries/clientpositive/input46.q
index 06291d0d66..ab863dc394 100644
--- a/ql/src/test/queries/clientpositive/input46.q
+++ b/ql/src/test/queries/clientpositive/input46.q
@@ -1,6 +1,6 @@
 create database if not exists table_in_database_creation;
 create table table_in_database_creation.test1  as select * from src limit 1;
-create table `table_in_database_creation.test2` as select * from src limit 1;
+create table `table_in_database_creation`.`test2` as select * from src limit 1;
 create table table_in_database_creation.test3 (a string);
-create table `table_in_database_creation.test4` (a string);
+create table `table_in_database_creation`.`test4` (a string);
 drop database table_in_database_creation cascade;
\ No newline at end of file
diff --git a/ql/src/test/results/clientnegative/alter_view_as_select_not_exist.q.out b/ql/src/test/results/clientnegative/alter_view_as_select_not_exist.q.out
index 66deaace6d..5ec4563b3d 100644
--- a/ql/src/test/results/clientnegative/alter_view_as_select_not_exist.q.out
+++ b/ql/src/test/results/clientnegative/alter_view_as_select_not_exist.q.out
@@ -3,4 +3,4 @@ PREHOOK: type: DROPVIEW
 POSTHOOK: query: DROP VIEW testView
 POSTHOOK: type: DROPVIEW
 FAILED: SemanticException [Error 10216]: Cannot ALTER VIEW AS SELECT if view currently does not exist
- The following view does not exist: testView
+ The following view does not exist: default.testView
diff --git a/ql/src/test/results/clientnegative/alter_view_as_select_with_partition.q.out b/ql/src/test/results/clientnegative/alter_view_as_select_with_partition.q.out
index 051fc90fa6..447dc3aeba 100644
--- a/ql/src/test/results/clientnegative/alter_view_as_select_with_partition.q.out
+++ b/ql/src/test/results/clientnegative/alter_view_as_select_with_partition.q.out
@@ -5,6 +5,8 @@ FROM src
 WHERE key=86
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@testViewPart
 POSTHOOK: query: CREATE VIEW testViewPart PARTITIONED ON (value)
 AS
 SELECT key, value
@@ -12,6 +14,7 @@ FROM src
 WHERE key=86
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@testViewPart
 PREHOOK: query: ALTER VIEW testViewPart 
 ADD PARTITION (value='val_86') PARTITION (value='val_xyz')
@@ -68,4 +71,4 @@ View Expanded Text: 	SELECT `src`.`key`, `src`.`value`
 FROM `default`.`src`	 	 
 WHERE `src`.`key`=86	 	 
 FAILED: SemanticException [Error 10217]: Cannot replace a view with CREATE VIEW or REPLACE VIEW or ALTER VIEW AS SELECT if the view has partitions
- The following view has partition, it could not be replaced: testViewPart
+ The following view has partition, it could not be replaced: default.testViewPart
diff --git a/ql/src/test/results/clientnegative/alter_view_failure.q.out b/ql/src/test/results/clientnegative/alter_view_failure.q.out
index d52f72a434..b1a56b43af 100644
--- a/ql/src/test/results/clientnegative/alter_view_failure.q.out
+++ b/ql/src/test/results/clientnegative/alter_view_failure.q.out
@@ -5,8 +5,11 @@ POSTHOOK: type: DROPVIEW
 PREHOOK: query: CREATE VIEW xxx3 AS SELECT * FROM src
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@xxx3
 POSTHOOK: query: CREATE VIEW xxx3 AS SELECT * FROM src
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@xxx3
 FAILED: SemanticException [Error 10131]: To alter a view you need to use the ALTER VIEW command.
diff --git a/ql/src/test/results/clientnegative/alter_view_failure2.q.out b/ql/src/test/results/clientnegative/alter_view_failure2.q.out
index 4e258748e5..755299db36 100644
--- a/ql/src/test/results/clientnegative/alter_view_failure2.q.out
+++ b/ql/src/test/results/clientnegative/alter_view_failure2.q.out
@@ -8,11 +8,14 @@ AS
 SELECT * FROM src
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@xxx4
 POSTHOOK: query: CREATE VIEW xxx4 
 PARTITIONED ON (value)
 AS 
 SELECT * FROM src
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@xxx4
 FAILED: SemanticException [Error 10131]: To alter a view you need to use the ALTER VIEW command.
diff --git a/ql/src/test/results/clientnegative/alter_view_failure4.q.out b/ql/src/test/results/clientnegative/alter_view_failure4.q.out
index bad15b2e29..2efa54c966 100644
--- a/ql/src/test/results/clientnegative/alter_view_failure4.q.out
+++ b/ql/src/test/results/clientnegative/alter_view_failure4.q.out
@@ -8,11 +8,14 @@ AS
 SELECT * FROM src
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@xxx5
 POSTHOOK: query: CREATE VIEW xxx5
 PARTITIONED ON (value)
 AS 
 SELECT * FROM src
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@xxx5
 FAILED: SemanticException LOCATION clause illegal for view partition
diff --git a/ql/src/test/results/clientnegative/alter_view_failure5.q.out b/ql/src/test/results/clientnegative/alter_view_failure5.q.out
index fdaa937b9f..d439037715 100644
--- a/ql/src/test/results/clientnegative/alter_view_failure5.q.out
+++ b/ql/src/test/results/clientnegative/alter_view_failure5.q.out
@@ -8,11 +8,14 @@ AS
 SELECT * FROM src
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@xxx6
 POSTHOOK: query: CREATE VIEW xxx6
 PARTITIONED ON (value)
 AS 
 SELECT * FROM src
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@xxx6
 FAILED: SemanticException Partition spec {v=val_86} contains non-partition columns
diff --git a/ql/src/test/results/clientnegative/alter_view_failure6.q.out b/ql/src/test/results/clientnegative/alter_view_failure6.q.out
index 564b78b6f2..8726ca0c53 100644
--- a/ql/src/test/results/clientnegative/alter_view_failure6.q.out
+++ b/ql/src/test/results/clientnegative/alter_view_failure6.q.out
@@ -8,12 +8,15 @@ AS
 SELECT hr,key FROM srcpart
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@srcpart
+PREHOOK: Output: database:default
+PREHOOK: Output: default@xxx7
 POSTHOOK: query: CREATE VIEW xxx7
 PARTITIONED ON (key)
 AS 
 SELECT hr,key FROM srcpart
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@srcpart
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@xxx7
 FAILED: SemanticException [Error 10041]: No partition predicate found for Alias "default.xxx7:srcpart" Table "srcpart"
 FAILED: SemanticException [Error 10056]: The query does not reference any valid partition. To run this query, set hive.mapred.mode=nonstrict
diff --git a/ql/src/test/results/clientnegative/alter_view_failure7.q.out b/ql/src/test/results/clientnegative/alter_view_failure7.q.out
index 63041728ee..c28587fc9e 100644
--- a/ql/src/test/results/clientnegative/alter_view_failure7.q.out
+++ b/ql/src/test/results/clientnegative/alter_view_failure7.q.out
@@ -8,11 +8,14 @@ AS
 SELECT key,ds,hr FROM srcpart
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@srcpart
+PREHOOK: Output: database:default
+PREHOOK: Output: default@xxx8
 POSTHOOK: query: CREATE VIEW xxx8
 PARTITIONED ON (ds,hr)
 AS 
 SELECT key,ds,hr FROM srcpart
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@srcpart
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@xxx8
 FAILED: SemanticException partition spec {ds=2011-01-01} doesn't contain all (2) partition columns
diff --git a/ql/src/test/results/clientnegative/alter_view_failure9.q.out b/ql/src/test/results/clientnegative/alter_view_failure9.q.out
index 398718b0b4..0afae119f0 100644
--- a/ql/src/test/results/clientnegative/alter_view_failure9.q.out
+++ b/ql/src/test/results/clientnegative/alter_view_failure9.q.out
@@ -7,10 +7,13 @@ AS
 SELECT * FROM src
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@xxx4
 POSTHOOK: query: CREATE VIEW xxx4 
 AS 
 SELECT * FROM src
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@xxx4
 FAILED: SemanticException [Error 10131]: To alter a view you need to use the ALTER VIEW command.
diff --git a/ql/src/test/results/clientnegative/analyze_view.q.out b/ql/src/test/results/clientnegative/analyze_view.q.out
index 6ed1e18cc4..95bdde8bb1 100644
--- a/ql/src/test/results/clientnegative/analyze_view.q.out
+++ b/ql/src/test/results/clientnegative/analyze_view.q.out
@@ -5,8 +5,11 @@ POSTHOOK: type: DROPVIEW
 PREHOOK: query: CREATE VIEW av AS SELECT * FROM src
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@av
 POSTHOOK: query: CREATE VIEW av AS SELECT * FROM src
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@av
 FAILED: SemanticException [Error 10091]: ANALYZE is not supported for views
diff --git a/ql/src/test/results/clientnegative/authorize_create_tbl.q.out b/ql/src/test/results/clientnegative/authorization_create_tbl.q.out
similarity index 100%
rename from ql/src/test/results/clientnegative/authorize_create_tbl.q.out
rename to ql/src/test/results/clientnegative/authorization_create_tbl.q.out
diff --git a/ql/src/test/results/clientnegative/authorization_create_view.q.out b/ql/src/test/results/clientnegative/authorization_create_view.q.out
new file mode 100644
index 0000000000..f272aec3fb
--- /dev/null
+++ b/ql/src/test/results/clientnegative/authorization_create_view.q.out
@@ -0,0 +1,21 @@
+PREHOOK: query: create database db1
+PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:db1
+POSTHOOK: query: create database db1
+POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:db1
+PREHOOK: query: use db1
+PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:db1
+POSTHOOK: query: use db1
+POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:db1
+PREHOOK: query: create table tab1(i int)
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:db1
+PREHOOK: Output: db1@tab1
+POSTHOOK: query: create table tab1(i int)
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:db1
+POSTHOOK: Output: db1@tab1
+FAILED: HiveAccessControlException Permission denied: Principal [name=user4, type=USER] does not have following privileges for operation CREATEVIEW [[OBJECT OWNERSHIP] on Object [type=DATABASE, name=db1], [SELECT with grant] on Object [type=TABLE_OR_VIEW, name=db1.tab1]]
diff --git a/ql/src/test/results/clientnegative/authorization_ctas2.q.out b/ql/src/test/results/clientnegative/authorization_ctas2.q.out
new file mode 100644
index 0000000000..6b6a50b9d8
--- /dev/null
+++ b/ql/src/test/results/clientnegative/authorization_ctas2.q.out
@@ -0,0 +1,27 @@
+#### A masked pattern was here ####
+create database ctas_auth
+PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:ctas_auth
+#### A masked pattern was here ####
+create database ctas_auth
+POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:ctas_auth
+PREHOOK: query: create table t1(i int)
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
+POSTHOOK: query: create table t1(i int)
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@t1
+PREHOOK: query: use ctas_auth
+PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:ctas_auth
+POSTHOOK: query: use ctas_auth
+POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:ctas_auth
+PREHOOK: query: show tables
+PREHOOK: type: SHOWTABLES
+POSTHOOK: query: show tables
+POSTHOOK: type: SHOWTABLES
+FAILED: HiveAccessControlException Permission denied: Principal [name=user_unauth, type=USER] does not have following privileges for operation CREATETABLE_AS_SELECT [[OBJECT OWNERSHIP] on Object [type=DATABASE, name=ctas_auth]]
diff --git a/ql/src/test/results/clientnegative/authorization_drop_db_cascade.q.out b/ql/src/test/results/clientnegative/authorization_drop_db_cascade.q.out
index 8ffa555f1a..d267a89a65 100644
--- a/ql/src/test/results/clientnegative/authorization_drop_db_cascade.q.out
+++ b/ql/src/test/results/clientnegative/authorization_drop_db_cascade.q.out
@@ -9,11 +9,10 @@ POSTHOOK: Output: database:dba1
 PREHOOK: query: create table dba1.tab1(i int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:dba1
-PREHOOK: Output: dba1@dba1.tab1
+PREHOOK: Output: dba1@tab1
 POSTHOOK: query: create table dba1.tab1(i int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:dba1
-POSTHOOK: Output: dba1@dba1.tab1
 POSTHOOK: Output: dba1@tab1
 PREHOOK: query: drop database dba1 cascade
 PREHOOK: type: DROPDATABASE
@@ -36,11 +35,10 @@ POSTHOOK: Output: database:dba2
 PREHOOK: query: create table dba2.tab2(i int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:dba2
-PREHOOK: Output: dba2@dba2.tab2
+PREHOOK: Output: dba2@tab2
 POSTHOOK: query: create table dba2.tab2(i int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:dba2
-POSTHOOK: Output: dba2@dba2.tab2
 POSTHOOK: Output: dba2@tab2
 PREHOOK: query: set role ADMIN
 PREHOOK: type: SHOW_ROLES
diff --git a/ql/src/test/results/clientnegative/authorization_not_owner_drop_view.q.out b/ql/src/test/results/clientnegative/authorization_not_owner_drop_view.q.out
index 305d6d8d8e..9a79b7d3d6 100644
--- a/ql/src/test/results/clientnegative/authorization_not_owner_drop_view.q.out
+++ b/ql/src/test/results/clientnegative/authorization_not_owner_drop_view.q.out
@@ -11,8 +11,11 @@ POSTHOOK: Output: default@t1
 PREHOOK: query: create view vt1 as select * from t1
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@t1
+PREHOOK: Output: database:default
+PREHOOK: Output: default@vt1
 POSTHOOK: query: create view vt1 as select * from t1
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@t1
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@vt1
 FAILED: HiveAccessControlException Permission denied: Principal [name=user2, type=USER] does not have following privileges for operation DROPVIEW [[OBJECT OWNERSHIP] on Object [type=TABLE_OR_VIEW, name=default.vt1], [OBJECT OWNERSHIP] on Object [type=TABLE_OR_VIEW, name=default.vt1]]
diff --git a/ql/src/test/results/clientnegative/authorization_part.q.out b/ql/src/test/results/clientnegative/authorization_part.q.out
index 26e645b07b..62387823d2 100644
--- a/ql/src/test/results/clientnegative/authorization_part.q.out
+++ b/ql/src/test/results/clientnegative/authorization_part.q.out
@@ -21,9 +21,12 @@ POSTHOOK: Output: default@authorization_part_fail
 PREHOOK: query: create table src_auth as select * from src
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@src_auth
 POSTHOOK: query: create table src_auth as select * from src
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@src_auth
 PREHOOK: query: grant Create on table authorization_part_fail to user hive_test_user
 PREHOOK: type: GRANT_PRIVILEGE
diff --git a/ql/src/test/results/clientnegative/authorization_select_view.q.out b/ql/src/test/results/clientnegative/authorization_select_view.q.out
index ba1fc89636..a2a6b663a3 100644
--- a/ql/src/test/results/clientnegative/authorization_select_view.q.out
+++ b/ql/src/test/results/clientnegative/authorization_select_view.q.out
@@ -11,8 +11,11 @@ POSTHOOK: Output: default@t1
 PREHOOK: query: create view v1 as select * from t1
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@t1
+PREHOOK: Output: database:default
+PREHOOK: Output: default@v1
 POSTHOOK: query: create view v1 as select * from t1
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@t1
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v1
 FAILED: HiveAccessControlException Permission denied: Principal [name=user1, type=USER] does not have following privileges for operation QUERY [[SELECT] on Object [type=TABLE_OR_VIEW, name=default.v1]]
diff --git a/ql/src/test/results/clientnegative/create_or_replace_view1.q.out b/ql/src/test/results/clientnegative/create_or_replace_view1.q.out
index 6db38a96a8..a96064b49c 100644
--- a/ql/src/test/results/clientnegative/create_or_replace_view1.q.out
+++ b/ql/src/test/results/clientnegative/create_or_replace_view1.q.out
@@ -9,9 +9,12 @@ POSTHOOK: type: DROPVIEW
 PREHOOK: query: create view v partitioned on (ds, hr) as select * from srcpart
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@srcpart
+PREHOOK: Output: database:default
+PREHOOK: Output: default@v
 POSTHOOK: query: create view v partitioned on (ds, hr) as select * from srcpart
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@srcpart
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v
 PREHOOK: query: alter view v add partition (ds='1',hr='2')
 PREHOOK: type: ALTERTABLE_ADDPARTS
@@ -25,4 +28,4 @@ POSTHOOK: Input: default@v
 POSTHOOK: Output: default@v
 POSTHOOK: Output: default@v@ds=1/hr=2
 FAILED: SemanticException [Error 10217]: Cannot replace a view with CREATE VIEW or REPLACE VIEW or ALTER VIEW AS SELECT if the view has partitions
- The following view has partition, it could not be replaced: v
+ The following view has partition, it could not be replaced: default.v
diff --git a/ql/src/test/results/clientnegative/create_or_replace_view2.q.out b/ql/src/test/results/clientnegative/create_or_replace_view2.q.out
index 94ca0ef6a1..8233a4e624 100644
--- a/ql/src/test/results/clientnegative/create_or_replace_view2.q.out
+++ b/ql/src/test/results/clientnegative/create_or_replace_view2.q.out
@@ -9,9 +9,12 @@ POSTHOOK: type: DROPVIEW
 PREHOOK: query: create view v partitioned on (ds, hr) as select * from srcpart
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@srcpart
+PREHOOK: Output: database:default
+PREHOOK: Output: default@v
 POSTHOOK: query: create view v partitioned on (ds, hr) as select * from srcpart
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@srcpart
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v
 PREHOOK: query: alter view v add partition (ds='1',hr='2')
 PREHOOK: type: ALTERTABLE_ADDPARTS
@@ -25,4 +28,4 @@ POSTHOOK: Input: default@v
 POSTHOOK: Output: default@v
 POSTHOOK: Output: default@v@ds=1/hr=2
 FAILED: SemanticException [Error 10217]: Cannot replace a view with CREATE VIEW or REPLACE VIEW or ALTER VIEW AS SELECT if the view has partitions
- The following view has partition, it could not be replaced: v
+ The following view has partition, it could not be replaced: default.v
diff --git a/ql/src/test/results/clientnegative/create_or_replace_view3.q.out b/ql/src/test/results/clientnegative/create_or_replace_view3.q.out
index f19dcf1526..114691e501 100644
--- a/ql/src/test/results/clientnegative/create_or_replace_view3.q.out
+++ b/ql/src/test/results/clientnegative/create_or_replace_view3.q.out
@@ -1,2 +1,2 @@
 FAILED: SemanticException [Error 10218]: Existing table is not a view
- The following is an existing table, not a view: src
+ The following is an existing table, not a view: default.src
diff --git a/ql/src/test/results/clientnegative/create_or_replace_view4.q.out b/ql/src/test/results/clientnegative/create_or_replace_view4.q.out
index 49ebe844d9..289a664021 100644
--- a/ql/src/test/results/clientnegative/create_or_replace_view4.q.out
+++ b/ql/src/test/results/clientnegative/create_or_replace_view4.q.out
@@ -9,8 +9,11 @@ POSTHOOK: type: DROPVIEW
 PREHOOK: query: create view v partitioned on (ds, hr) as select * from srcpart
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@srcpart
+PREHOOK: Output: database:default
+PREHOOK: Output: default@v
 POSTHOOK: query: create view v partitioned on (ds, hr) as select * from srcpart
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@srcpart
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v
 FAILED: SemanticException [Error 10092]: At least one non-partitioning column must be present in view
diff --git a/ql/src/test/results/clientnegative/create_or_replace_view5.q.out b/ql/src/test/results/clientnegative/create_or_replace_view5.q.out
index ddac913475..68213f497b 100644
--- a/ql/src/test/results/clientnegative/create_or_replace_view5.q.out
+++ b/ql/src/test/results/clientnegative/create_or_replace_view5.q.out
@@ -9,8 +9,11 @@ POSTHOOK: type: DROPVIEW
 PREHOOK: query: create view v partitioned on (ds, hr) as select * from srcpart
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@srcpart
+PREHOOK: Output: database:default
+PREHOOK: Output: default@v
 POSTHOOK: query: create view v partitioned on (ds, hr) as select * from srcpart
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@srcpart
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v
 FAILED: SemanticException Can't combine IF NOT EXISTS and OR REPLACE.
diff --git a/ql/src/test/results/clientnegative/create_or_replace_view6.q.out b/ql/src/test/results/clientnegative/create_or_replace_view6.q.out
index 486dbb9834..b919e728ff 100644
--- a/ql/src/test/results/clientnegative/create_or_replace_view6.q.out
+++ b/ql/src/test/results/clientnegative/create_or_replace_view6.q.out
@@ -9,8 +9,11 @@ POSTHOOK: type: DROPVIEW
 PREHOOK: query: create view v partitioned on (ds, hr) as select * from srcpart
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@srcpart
+PREHOOK: Output: database:default
+PREHOOK: Output: default@v
 POSTHOOK: query: create view v partitioned on (ds, hr) as select * from srcpart
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@srcpart
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v
 FAILED: ParseException line 2:52 cannot recognize input near 'blah' '<EOF>' '<EOF>' in select clause
diff --git a/ql/src/test/results/clientnegative/create_or_replace_view7.q.out b/ql/src/test/results/clientnegative/create_or_replace_view7.q.out
index 22824803cd..ccc1f661e2 100644
--- a/ql/src/test/results/clientnegative/create_or_replace_view7.q.out
+++ b/ql/src/test/results/clientnegative/create_or_replace_view7.q.out
@@ -9,28 +9,37 @@ POSTHOOK: type: DROPVIEW
 PREHOOK: query: create view v1 partitioned on (ds, hr) as select * from srcpart
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@srcpart
+PREHOOK: Output: database:default
+PREHOOK: Output: default@v1
 POSTHOOK: query: create view v1 partitioned on (ds, hr) as select * from srcpart
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@srcpart
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v1
 PREHOOK: query: create view v2 partitioned on (ds, hr) as select * from v1
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@srcpart
 PREHOOK: Input: default@v1
+PREHOOK: Output: database:default
+PREHOOK: Output: default@v2
 POSTHOOK: query: create view v2 partitioned on (ds, hr) as select * from v1
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@srcpart
 POSTHOOK: Input: default@v1
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v2
 PREHOOK: query: create view v3 partitioned on (ds, hr) as select * from v2
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@srcpart
 PREHOOK: Input: default@v1
 PREHOOK: Input: default@v2
+PREHOOK: Output: database:default
+PREHOOK: Output: default@v3
 POSTHOOK: query: create view v3 partitioned on (ds, hr) as select * from v2
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@srcpart
 POSTHOOK: Input: default@v1
 POSTHOOK: Input: default@v2
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v3
 FAILED: SemanticException Recursive view default.v1 detected (cycle: default.v1 -> default.v3 -> default.v2 -> default.v1).
diff --git a/ql/src/test/results/clientnegative/create_or_replace_view8.q.out b/ql/src/test/results/clientnegative/create_or_replace_view8.q.out
index ea0310b835..4a65a3adfb 100644
--- a/ql/src/test/results/clientnegative/create_or_replace_view8.q.out
+++ b/ql/src/test/results/clientnegative/create_or_replace_view8.q.out
@@ -9,8 +9,11 @@ POSTHOOK: type: DROPVIEW
 PREHOOK: query: create view v1 partitioned on (ds, hr) as select * from srcpart
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@srcpart
+PREHOOK: Output: database:default
+PREHOOK: Output: default@v1
 POSTHOOK: query: create view v1 partitioned on (ds, hr) as select * from srcpart
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@srcpart
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v1
 FAILED: SemanticException Recursive view default.v1 detected (cycle: default.v1 -> default.v1).
diff --git a/ql/src/test/results/clientnegative/create_view_failure1.q.out b/ql/src/test/results/clientnegative/create_view_failure1.q.out
index 5609590fde..4be288600e 100644
--- a/ql/src/test/results/clientnegative/create_view_failure1.q.out
+++ b/ql/src/test/results/clientnegative/create_view_failure1.q.out
@@ -15,4 +15,6 @@ POSTHOOK: Output: default@xxx12
 PREHOOK: query: CREATE VIEW xxx12 AS SELECT key FROM src
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@xxx12
 FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask. AlreadyExistsException(message:Table xxx12 already exists)
diff --git a/ql/src/test/results/clientnegative/create_view_failure2.q.out b/ql/src/test/results/clientnegative/create_view_failure2.q.out
index cfe318ab89..aadceebfe8 100644
--- a/ql/src/test/results/clientnegative/create_view_failure2.q.out
+++ b/ql/src/test/results/clientnegative/create_view_failure2.q.out
@@ -6,10 +6,13 @@ PREHOOK: query: -- views and tables share the same namespace
 CREATE VIEW xxx4 AS SELECT key FROM src
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@xxx4
 POSTHOOK: query: -- views and tables share the same namespace
 CREATE VIEW xxx4 AS SELECT key FROM src
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@xxx4
 PREHOOK: query: CREATE TABLE xxx4(key int)
 PREHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientnegative/create_view_failure4.q.out b/ql/src/test/results/clientnegative/create_view_failure4.q.out
index 339eb042d5..8e47735b74 100644
--- a/ql/src/test/results/clientnegative/create_view_failure4.q.out
+++ b/ql/src/test/results/clientnegative/create_view_failure4.q.out
@@ -7,4 +7,6 @@ CREATE VIEW xxx5(x,x) AS
 SELECT key,value FROM src
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@xxx5
 FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask. org.apache.hadoop.hive.ql.metadata.HiveException: Duplicate column name x in the table definition.
diff --git a/ql/src/test/results/clientnegative/desc_failure3.q.out b/ql/src/test/results/clientnegative/desc_failure3.q.out
index ce77731bd8..443857b819 100644
--- a/ql/src/test/results/clientnegative/desc_failure3.q.out
+++ b/ql/src/test/results/clientnegative/desc_failure3.q.out
@@ -7,10 +7,9 @@ POSTHOOK: Output: database:db1
 PREHOOK: query: CREATE TABLE db1.t1(key1 INT, value1 STRING) PARTITIONED BY (ds STRING, part STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:db1
-PREHOOK: Output: db1@db1.t1
+PREHOOK: Output: db1@t1
 POSTHOOK: query: CREATE TABLE db1.t1(key1 INT, value1 STRING) PARTITIONED BY (ds STRING, part STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:db1
-POSTHOOK: Output: db1@db1.t1
 POSTHOOK: Output: db1@t1
 FAILED: SemanticException [Error 10004]: Invalid table alias or column reference db1.t1.key1
diff --git a/ql/src/test/results/clientnegative/drop_table_failure2.q.out b/ql/src/test/results/clientnegative/drop_table_failure2.q.out
index adad9f431e..956ed8b642 100644
--- a/ql/src/test/results/clientnegative/drop_table_failure2.q.out
+++ b/ql/src/test/results/clientnegative/drop_table_failure2.q.out
@@ -1,9 +1,12 @@
 PREHOOK: query: CREATE VIEW xxx6 AS SELECT key FROM src
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@xxx6
 POSTHOOK: query: CREATE VIEW xxx6 AS SELECT key FROM src
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@xxx6
 PREHOOK: query: -- Can't use DROP TABLE on a view
 DROP TABLE xxx6
diff --git a/ql/src/test/results/clientnegative/insert_view_failure.q.out b/ql/src/test/results/clientnegative/insert_view_failure.q.out
index 05d0b75236..7bc52cbab1 100644
--- a/ql/src/test/results/clientnegative/insert_view_failure.q.out
+++ b/ql/src/test/results/clientnegative/insert_view_failure.q.out
@@ -5,8 +5,11 @@ POSTHOOK: type: DROPVIEW
 PREHOOK: query: CREATE VIEW xxx2 AS SELECT * FROM src
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@xxx2
 POSTHOOK: query: CREATE VIEW xxx2 AS SELECT * FROM src
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@xxx2
 FAILED: SemanticException [Error 10090]: A view cannot be used as target table for LOAD or INSERT
diff --git a/ql/src/test/results/clientnegative/invalidate_view1.q.out b/ql/src/test/results/clientnegative/invalidate_view1.q.out
index 59caaafdb8..7eff2b2a38 100644
--- a/ql/src/test/results/clientnegative/invalidate_view1.q.out
+++ b/ql/src/test/results/clientnegative/invalidate_view1.q.out
@@ -23,18 +23,24 @@ POSTHOOK: Output: default@xxx10
 PREHOOK: query: CREATE VIEW xxx9 AS SELECT * FROM xxx10
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@xxx10
+PREHOOK: Output: database:default
+PREHOOK: Output: default@xxx9
 POSTHOOK: query: CREATE VIEW xxx9 AS SELECT * FROM xxx10
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@xxx10
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@xxx9
 PREHOOK: query: CREATE VIEW xxx8 AS SELECT * FROM xxx9 xxx
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@xxx10
 PREHOOK: Input: default@xxx9
+PREHOOK: Output: database:default
+PREHOOK: Output: default@xxx8
 POSTHOOK: query: CREATE VIEW xxx8 AS SELECT * FROM xxx9 xxx
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@xxx10
 POSTHOOK: Input: default@xxx9
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@xxx8
 PREHOOK: query: ALTER TABLE xxx10 REPLACE COLUMNS (key int)
 PREHOOK: type: ALTERTABLE_REPLACECOLS
diff --git a/ql/src/test/results/clientnegative/load_view_failure.q.out b/ql/src/test/results/clientnegative/load_view_failure.q.out
index d21c9bf09f..ba1e507045 100644
--- a/ql/src/test/results/clientnegative/load_view_failure.q.out
+++ b/ql/src/test/results/clientnegative/load_view_failure.q.out
@@ -5,8 +5,11 @@ POSTHOOK: type: DROPVIEW
 PREHOOK: query: CREATE VIEW xxx11 AS SELECT * FROM src
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@xxx11
 POSTHOOK: query: CREATE VIEW xxx11 AS SELECT * FROM src
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@xxx11
 FAILED: SemanticException [Error 10090]: A view cannot be used as target table for LOAD or INSERT
diff --git a/ql/src/test/results/clientnegative/recursive_view.q.out b/ql/src/test/results/clientnegative/recursive_view.q.out
index 9dc22d3083..f51453c07a 100644
--- a/ql/src/test/results/clientnegative/recursive_view.q.out
+++ b/ql/src/test/results/clientnegative/recursive_view.q.out
@@ -33,29 +33,38 @@ POSTHOOK: Output: default@t
 PREHOOK: query: create view r0 as select * from t
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@t
+PREHOOK: Output: database:default
+PREHOOK: Output: default@r0
 POSTHOOK: query: create view r0 as select * from t
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@t
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@r0
 PREHOOK: query: create view r1 as select * from r0
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@r0
 PREHOOK: Input: default@t
+PREHOOK: Output: database:default
+PREHOOK: Output: default@r1
 POSTHOOK: query: create view r1 as select * from r0
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@r0
 POSTHOOK: Input: default@t
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@r1
 PREHOOK: query: create view r2 as select * from r1
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@r0
 PREHOOK: Input: default@r1
 PREHOOK: Input: default@t
+PREHOOK: Output: database:default
+PREHOOK: Output: default@r2
 POSTHOOK: query: create view r2 as select * from r1
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@r0
 POSTHOOK: Input: default@r1
 POSTHOOK: Input: default@t
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@r2
 PREHOOK: query: create view r3 as select * from r2
 PREHOOK: type: CREATEVIEW
@@ -63,12 +72,15 @@ PREHOOK: Input: default@r0
 PREHOOK: Input: default@r1
 PREHOOK: Input: default@r2
 PREHOOK: Input: default@t
+PREHOOK: Output: database:default
+PREHOOK: Output: default@r3
 POSTHOOK: query: create view r3 as select * from r2
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@r0
 POSTHOOK: Input: default@r1
 POSTHOOK: Input: default@r2
 POSTHOOK: Input: default@t
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@r3
 PREHOOK: query: drop view r0
 PREHOOK: type: DROPVIEW
diff --git a/ql/src/test/results/clientnegative/unset_view_property.q.out b/ql/src/test/results/clientnegative/unset_view_property.q.out
index 46860b3273..4c94e25603 100644
--- a/ql/src/test/results/clientnegative/unset_view_property.q.out
+++ b/ql/src/test/results/clientnegative/unset_view_property.q.out
@@ -1,9 +1,12 @@
 PREHOOK: query: CREATE VIEW testView AS SELECT value FROM src WHERE key=86
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@testView
 POSTHOOK: query: CREATE VIEW testView AS SELECT value FROM src WHERE key=86
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@testView
 PREHOOK: query: ALTER VIEW testView SET TBLPROPERTIES ('propA'='100', 'propB'='200')
 PREHOOK: type: ALTERVIEW_PROPERTIES
diff --git a/ql/src/test/results/clientpositive/add_part_exist.q.out b/ql/src/test/results/clientpositive/add_part_exist.q.out
index 3af23600c3..107cfdb9ad 100644
--- a/ql/src/test/results/clientpositive/add_part_exist.q.out
+++ b/ql/src/test/results/clientpositive/add_part_exist.q.out
@@ -101,12 +101,11 @@ POSTHOOK: type: CREATEDATABASE
 POSTHOOK: Output: database:add_part_test_db
 PREHOOK: query: CREATE TABLE add_part_test_db.add_part_test (key STRING, value STRING) PARTITIONED BY (ds STRING)
 PREHOOK: type: CREATETABLE
-PREHOOK: Output: add_part_test_db@add_part_test_db.add_part_test
+PREHOOK: Output: add_part_test_db@add_part_test
 PREHOOK: Output: database:add_part_test_db
 POSTHOOK: query: CREATE TABLE add_part_test_db.add_part_test (key STRING, value STRING) PARTITIONED BY (ds STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: add_part_test_db@add_part_test
-POSTHOOK: Output: add_part_test_db@add_part_test_db.add_part_test
 POSTHOOK: Output: database:add_part_test_db
 PREHOOK: query: SHOW PARTITIONS add_part_test_db.add_part_test
 PREHOOK: type: SHOWPARTITIONS
diff --git a/ql/src/test/results/clientpositive/allcolref_in_udf.q.out b/ql/src/test/results/clientpositive/allcolref_in_udf.q.out
index 3e918bea2b..dd1e9e3cb2 100644
--- a/ql/src/test/results/clientpositive/allcolref_in_udf.q.out
+++ b/ql/src/test/results/clientpositive/allcolref_in_udf.q.out
@@ -164,10 +164,13 @@ PREHOOK: query: -- HIVE-4181 TOK_FUNCTIONSTAR for UDTF
 create table allcolref as select array(key, value) from src
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@allcolref
 POSTHOOK: query: -- HIVE-4181 TOK_FUNCTIONSTAR for UDTF
 create table allcolref as select array(key, value) from src
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@allcolref
 PREHOOK: query: explain select explode(*) as x from allcolref limit 10
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/alter1.q.out b/ql/src/test/results/clientpositive/alter1.q.out
index e34e27b388..7c78410f3d 100644
--- a/ql/src/test/results/clientpositive/alter1.q.out
+++ b/ql/src/test/results/clientpositive/alter1.q.out
@@ -216,12 +216,11 @@ POSTHOOK: query: SHOW TABLES alter1_db
 POSTHOOK: type: SHOWTABLES
 PREHOOK: query: CREATE TABLE alter1_db.alter1(a INT, b INT)
 PREHOOK: type: CREATETABLE
-PREHOOK: Output: alter1_db@alter1_db.alter1
+PREHOOK: Output: alter1_db@alter1
 PREHOOK: Output: database:alter1_db
 POSTHOOK: query: CREATE TABLE alter1_db.alter1(a INT, b INT)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: alter1_db@alter1
-POSTHOOK: Output: alter1_db@alter1_db.alter1
 POSTHOOK: Output: database:alter1_db
 PREHOOK: query: DESCRIBE EXTENDED alter1_db.alter1
 PREHOOK: type: DESCTABLE
diff --git a/ql/src/test/results/clientpositive/alter_char1.q.out b/ql/src/test/results/clientpositive/alter_char1.q.out
index 71113622bb..b1a88dfb42 100644
--- a/ql/src/test/results/clientpositive/alter_char1.q.out
+++ b/ql/src/test/results/clientpositive/alter_char1.q.out
@@ -10,11 +10,10 @@ POSTHOOK: type: CREATEDATABASE
 POSTHOOK: Output: database:ac
 PREHOOK: query: create table ac.alter_char_1 (key string, value string)
 PREHOOK: type: CREATETABLE
-PREHOOK: Output: ac@ac.alter_char_1
+PREHOOK: Output: ac@alter_char_1
 PREHOOK: Output: database:ac
 POSTHOOK: query: create table ac.alter_char_1 (key string, value string)
 POSTHOOK: type: CREATETABLE
-POSTHOOK: Output: ac@ac.alter_char_1
 POSTHOOK: Output: ac@alter_char_1
 POSTHOOK: Output: database:ac
 PREHOOK: query: insert overwrite table ac.alter_char_1
diff --git a/ql/src/test/results/clientpositive/alter_partition_coltype.q.out b/ql/src/test/results/clientpositive/alter_partition_coltype.q.out
index aab29df741..4f26fec8a5 100644
--- a/ql/src/test/results/clientpositive/alter_partition_coltype.q.out
+++ b/ql/src/test/results/clientpositive/alter_partition_coltype.q.out
@@ -948,12 +948,11 @@ POSTHOOK: Output: database:pt
 PREHOOK: query: create table pt.alterdynamic_part_table(intcol string) partitioned by (partcol1 string, partcol2 string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:pt
-PREHOOK: Output: pt@pt.alterdynamic_part_table
+PREHOOK: Output: pt@alterdynamic_part_table
 POSTHOOK: query: create table pt.alterdynamic_part_table(intcol string) partitioned by (partcol1 string, partcol2 string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:pt
 POSTHOOK: Output: pt@alterdynamic_part_table
-POSTHOOK: Output: pt@pt.alterdynamic_part_table
 PREHOOK: query: insert into table pt.alterdynamic_part_table partition(partcol1, partcol2) select '1', '1', '1' from src where key=150 limit 5
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
diff --git a/ql/src/test/results/clientpositive/alter_rename_partition_authorization.q.out b/ql/src/test/results/clientpositive/alter_rename_partition_authorization.q.out
index 5e7c3e2283..d35bf402a8 100644
--- a/ql/src/test/results/clientpositive/alter_rename_partition_authorization.q.out
+++ b/ql/src/test/results/clientpositive/alter_rename_partition_authorization.q.out
@@ -3,11 +3,14 @@ PREHOOK: query: -- SORT_BEFORE_DIFF
 create table src_auth_tmp as select * from src
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@src_auth_tmp
 POSTHOOK: query: -- SORT_BEFORE_DIFF
 
 create table src_auth_tmp as select * from src
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@src_auth_tmp
 PREHOOK: query: create table authorization_part (key int, value string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/alter_rename_table.q.out b/ql/src/test/results/clientpositive/alter_rename_table.q.out
index 970b43b396..732d8a28d8 100644
--- a/ql/src/test/results/clientpositive/alter_rename_table.q.out
+++ b/ql/src/test/results/clientpositive/alter_rename_table.q.out
@@ -13,11 +13,10 @@ POSTHOOK: Output: database:target
 PREHOOK: query: create table source.src like default.src
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:source
-PREHOOK: Output: source@source.src
+PREHOOK: Output: source@src
 POSTHOOK: query: create table source.src like default.src
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:source
-POSTHOOK: Output: source@source.src
 POSTHOOK: Output: source@src
 PREHOOK: query: load data local inpath '../../data/files/kv1.txt' overwrite into table source.src
 PREHOOK: type: LOAD
@@ -30,11 +29,10 @@ POSTHOOK: Output: source@src
 PREHOOK: query: create table source.srcpart like default.srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:source
-PREHOOK: Output: source@source.srcpart
+PREHOOK: Output: source@srcpart
 POSTHOOK: query: create table source.srcpart like default.srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:source
-POSTHOOK: Output: source@source.srcpart
 POSTHOOK: Output: source@srcpart
 PREHOOK: query: load data local inpath '../../data/files/kv1.txt' overwrite into table source.srcpart partition (ds='2008-04-08', hr='11')
 PREHOOK: type: LOAD
@@ -215,20 +213,18 @@ POSTHOOK: Input: target@srcpart@ds=2008-04-09/hr=12
 PREHOOK: query: create table source.src like default.src
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:source
-PREHOOK: Output: source@source.src
+PREHOOK: Output: source@src
 POSTHOOK: query: create table source.src like default.src
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:source
-POSTHOOK: Output: source@source.src
 POSTHOOK: Output: source@src
 PREHOOK: query: create table source.src1 like default.src
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:source
-PREHOOK: Output: source@source.src1
+PREHOOK: Output: source@src1
 POSTHOOK: query: create table source.src1 like default.src
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:source
-POSTHOOK: Output: source@source.src1
 POSTHOOK: Output: source@src1
 PREHOOK: query: load data local inpath '../../data/files/kv1.txt' overwrite into table source.src
 PREHOOK: type: LOAD
diff --git a/ql/src/test/results/clientpositive/alter_skewed_table.q.out b/ql/src/test/results/clientpositive/alter_skewed_table.q.out
index 3e09f7863c..0e0c5b0524 100644
--- a/ql/src/test/results/clientpositive/alter_skewed_table.q.out
+++ b/ql/src/test/results/clientpositive/alter_skewed_table.q.out
@@ -101,12 +101,11 @@ POSTHOOK: Output: database:skew_test
 PREHOOK: query: create table skew_test.original2 (key STRING, value STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:skew_test
-PREHOOK: Output: skew_test@skew_test.original2
+PREHOOK: Output: skew_test@original2
 POSTHOOK: query: create table skew_test.original2 (key STRING, value STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:skew_test
 POSTHOOK: Output: skew_test@original2
-POSTHOOK: Output: skew_test@skew_test.original2
 PREHOOK: query: describe formatted skew_test.original2
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: skew_test@original2
@@ -196,12 +195,11 @@ POSTHOOK: Output: skew_test@original2
 PREHOOK: query: create table skew_test.original3 (key STRING, value STRING) SKEWED BY (key, value) ON ((1,1),(5,6))
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:skew_test
-PREHOOK: Output: skew_test@skew_test.original3
+PREHOOK: Output: skew_test@original3
 POSTHOOK: query: create table skew_test.original3 (key STRING, value STRING) SKEWED BY (key, value) ON ((1,1),(5,6))
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:skew_test
 POSTHOOK: Output: skew_test@original3
-POSTHOOK: Output: skew_test@skew_test.original3
 PREHOOK: query: describe formatted skew_test.original3
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: skew_test@original3
diff --git a/ql/src/test/results/clientpositive/alter_table_update_status.q.out b/ql/src/test/results/clientpositive/alter_table_update_status.q.out
index 14940af40b..361359807b 100644
--- a/ql/src/test/results/clientpositive/alter_table_update_status.q.out
+++ b/ql/src/test/results/clientpositive/alter_table_update_status.q.out
@@ -1,9 +1,12 @@
 PREHOOK: query: create table src_stat as select * from src1
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src1
+PREHOOK: Output: database:default
+PREHOOK: Output: default@src_stat
 POSTHOOK: query: create table src_stat as select * from src1
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src1
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@src_stat
 PREHOOK: query: create table src_stat_int (
   key         double,
diff --git a/ql/src/test/results/clientpositive/alter_varchar1.q.out b/ql/src/test/results/clientpositive/alter_varchar1.q.out
index 558d39295f..d1928ef82a 100644
--- a/ql/src/test/results/clientpositive/alter_varchar1.q.out
+++ b/ql/src/test/results/clientpositive/alter_varchar1.q.out
@@ -10,12 +10,11 @@ POSTHOOK: type: CREATEDATABASE
 POSTHOOK: Output: database:avc
 PREHOOK: query: create table avc.alter_varchar_1 (key string, value string)
 PREHOOK: type: CREATETABLE
-PREHOOK: Output: avc@avc.alter_varchar_1
+PREHOOK: Output: avc@alter_varchar_1
 PREHOOK: Output: database:avc
 POSTHOOK: query: create table avc.alter_varchar_1 (key string, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: avc@alter_varchar_1
-POSTHOOK: Output: avc@avc.alter_varchar_1
 POSTHOOK: Output: database:avc
 PREHOOK: query: insert overwrite table avc.alter_varchar_1
   select key, value from src order by key limit 5
diff --git a/ql/src/test/results/clientpositive/alter_view_as_select.q.out b/ql/src/test/results/clientpositive/alter_view_as_select.q.out
index b3d42cdbf7..ff2d860e06 100644
--- a/ql/src/test/results/clientpositive/alter_view_as_select.q.out
+++ b/ql/src/test/results/clientpositive/alter_view_as_select.q.out
@@ -7,9 +7,12 @@ POSTHOOK: Output: database:tv
 PREHOOK: query: CREATE VIEW tv.testView as SELECT * FROM srcpart
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@srcpart
+PREHOOK: Output: database:tv
+PREHOOK: Output: tv@testView
 POSTHOOK: query: CREATE VIEW tv.testView as SELECT * FROM srcpart
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@srcpart
+POSTHOOK: Output: database:tv
 POSTHOOK: Output: tv@testView
 PREHOOK: query: DESCRIBE FORMATTED tv.testView
 PREHOOK: type: DESCTABLE
@@ -48,9 +51,13 @@ View Expanded Text: 	SELECT `srcpart`.`key`, `srcpart`.`value`, `srcpart`.`ds`,
 PREHOOK: query: ALTER VIEW tv.testView AS SELECT value FROM src WHERE key=86
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
+PREHOOK: Output: database:tv
+PREHOOK: Output: tv@testView
 POSTHOOK: query: ALTER VIEW tv.testView AS SELECT value FROM src WHERE key=86
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:tv
+POSTHOOK: Output: tv@testView
 POSTHOOK: Output: tv@testview
 PREHOOK: query: DESCRIBE FORMATTED tv.testView
 PREHOOK: type: DESCTABLE
@@ -90,6 +97,8 @@ ORDER BY key, value
 LIMIT 10
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
+PREHOOK: Output: database:tv
+PREHOOK: Output: tv@testView
 POSTHOOK: query: ALTER VIEW tv.testView AS
 SELECT * FROM src
 WHERE key > 80 AND key < 100
@@ -97,6 +106,8 @@ ORDER BY key, value
 LIMIT 10
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:tv
+POSTHOOK: Output: tv@testView
 POSTHOOK: Output: tv@testview
 PREHOOK: query: DESCRIBE FORMATTED tv.testView
 PREHOOK: type: DESCTABLE
diff --git a/ql/src/test/results/clientpositive/alter_view_rename.q.out b/ql/src/test/results/clientpositive/alter_view_rename.q.out
index 43c4422a1c..300b96c685 100644
--- a/ql/src/test/results/clientpositive/alter_view_rename.q.out
+++ b/ql/src/test/results/clientpositive/alter_view_rename.q.out
@@ -21,9 +21,12 @@ POSTHOOK: Output: default@invites
 PREHOOK: query: CREATE VIEW tv1.view1 as SELECT * FROM invites
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@invites
+PREHOOK: Output: database:tv1
+PREHOOK: Output: tv1@view1
 POSTHOOK: query: CREATE VIEW tv1.view1 as SELECT * FROM invites
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@invites
+POSTHOOK: Output: database:tv1
 POSTHOOK: Output: tv1@view1
 PREHOOK: query: DESCRIBE EXTENDED tv1.view1
 PREHOOK: type: DESCTABLE
diff --git a/ql/src/test/results/clientpositive/archive_multi.q.out b/ql/src/test/results/clientpositive/archive_multi.q.out
index d0346d3ad3..0ad29d1221 100644
--- a/ql/src/test/results/clientpositive/archive_multi.q.out
+++ b/ql/src/test/results/clientpositive/archive_multi.q.out
@@ -6,11 +6,10 @@ POSTHOOK: type: CREATEDATABASE
 POSTHOOK: Output: database:ac_test
 PREHOOK: query: create table ac_test.tstsrc like default.src
 PREHOOK: type: CREATETABLE
-PREHOOK: Output: ac_test@ac_test.tstsrc
+PREHOOK: Output: ac_test@tstsrc
 PREHOOK: Output: database:ac_test
 POSTHOOK: query: create table ac_test.tstsrc like default.src
 POSTHOOK: type: CREATETABLE
-POSTHOOK: Output: ac_test@ac_test.tstsrc
 POSTHOOK: Output: ac_test@tstsrc
 POSTHOOK: Output: database:ac_test
 PREHOOK: query: insert overwrite table ac_test.tstsrc select key, value from default.src
@@ -25,11 +24,10 @@ POSTHOOK: Lineage: tstsrc.key SIMPLE [(src)src.FieldSchema(name:key, type:string
 POSTHOOK: Lineage: tstsrc.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: create table ac_test.tstsrcpart like default.srcpart
 PREHOOK: type: CREATETABLE
-PREHOOK: Output: ac_test@ac_test.tstsrcpart
+PREHOOK: Output: ac_test@tstsrcpart
 PREHOOK: Output: database:ac_test
 POSTHOOK: query: create table ac_test.tstsrcpart like default.srcpart
 POSTHOOK: type: CREATETABLE
-POSTHOOK: Output: ac_test@ac_test.tstsrcpart
 POSTHOOK: Output: ac_test@tstsrcpart
 POSTHOOK: Output: database:ac_test
 PREHOOK: query: insert overwrite table ac_test.tstsrcpart partition (ds='2008-04-08', hr='11')
diff --git a/ql/src/test/results/clientpositive/authorization_1.q.out b/ql/src/test/results/clientpositive/authorization_1.q.out
index dac0820927..ef741678cd 100644
--- a/ql/src/test/results/clientpositive/authorization_1.q.out
+++ b/ql/src/test/results/clientpositive/authorization_1.q.out
@@ -3,11 +3,14 @@ PREHOOK: query: -- SORT_BEFORE_DIFF
 create table src_autho_test as select * from src
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@src_autho_test
 POSTHOOK: query: -- SORT_BEFORE_DIFF
 
 create table src_autho_test as select * from src
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@src_autho_test
 PREHOOK: query: --table grant to user
 
diff --git a/ql/src/test/results/clientpositive/authorization_2.q.out b/ql/src/test/results/clientpositive/authorization_2.q.out
index 0da0ec2d61..e92763caa9 100644
--- a/ql/src/test/results/clientpositive/authorization_2.q.out
+++ b/ql/src/test/results/clientpositive/authorization_2.q.out
@@ -13,9 +13,12 @@ POSTHOOK: Output: default@authorization_part
 PREHOOK: query: create table src_auth_tmp as select * from src
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@src_auth_tmp
 POSTHOOK: query: create table src_auth_tmp as select * from src
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@src_auth_tmp
 PREHOOK: query: ALTER TABLE authorization_part SET TBLPROPERTIES ("PARTITION_LEVEL_PRIVILEGE"="TRUE")
 PREHOOK: type: ALTERTABLE_PROPERTIES
diff --git a/ql/src/test/results/clientpositive/authorization_3.q.out b/ql/src/test/results/clientpositive/authorization_3.q.out
index 8de1daf8c9..2b532333cf 100644
--- a/ql/src/test/results/clientpositive/authorization_3.q.out
+++ b/ql/src/test/results/clientpositive/authorization_3.q.out
@@ -3,11 +3,14 @@ PREHOOK: query: -- SORT_BEFORE_DIFF
 create table src_autho_test as select * from src
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@src_autho_test
 POSTHOOK: query: -- SORT_BEFORE_DIFF
 
 create table src_autho_test as select * from src
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@src_autho_test
 PREHOOK: query: grant drop on table src_autho_test to user hive_test_user
 PREHOOK: type: GRANT_PRIVILEGE
diff --git a/ql/src/test/results/clientpositive/authorization_4.q.out b/ql/src/test/results/clientpositive/authorization_4.q.out
index 881c128eb5..67a30fd562 100644
--- a/ql/src/test/results/clientpositive/authorization_4.q.out
+++ b/ql/src/test/results/clientpositive/authorization_4.q.out
@@ -3,11 +3,14 @@ PREHOOK: query: -- SORT_BEFORE_DIFF
 create table src_autho_test as select * from src
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@src_autho_test
 POSTHOOK: query: -- SORT_BEFORE_DIFF
 
 create table src_autho_test as select * from src
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@src_autho_test
 PREHOOK: query: grant All on table src_autho_test to user hive_test_user
 PREHOOK: type: GRANT_PRIVILEGE
diff --git a/ql/src/test/results/clientpositive/authorization_6.q.out b/ql/src/test/results/clientpositive/authorization_6.q.out
index 02c4109dce..0341094256 100644
--- a/ql/src/test/results/clientpositive/authorization_6.q.out
+++ b/ql/src/test/results/clientpositive/authorization_6.q.out
@@ -3,11 +3,14 @@ PREHOOK: query: -- SORT_BEFORE_DIFF
 create table src_auth_tmp as select * from src
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@src_auth_tmp
 POSTHOOK: query: -- SORT_BEFORE_DIFF
 
 create table src_auth_tmp as select * from src
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@src_auth_tmp
 PREHOOK: query: create table authorization_part (key int, value string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/authorization_8.q.out b/ql/src/test/results/clientpositive/authorization_8.q.out
index 47791fd4c1..9fed5dcb9d 100644
--- a/ql/src/test/results/clientpositive/authorization_8.q.out
+++ b/ql/src/test/results/clientpositive/authorization_8.q.out
@@ -13,9 +13,12 @@ POSTHOOK: Output: default@tbl_j5jbymsx8e
 PREHOOK: query: CREATE VIEW view_j5jbymsx8e_1 as SELECT * FROM tbl_j5jbymsx8e
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@tbl_j5jbymsx8e
+PREHOOK: Output: database:default
+PREHOOK: Output: default@view_j5jbymsx8e_1
 POSTHOOK: query: CREATE VIEW view_j5jbymsx8e_1 as SELECT * FROM tbl_j5jbymsx8e
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@tbl_j5jbymsx8e
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@view_j5jbymsx8e_1
 PREHOOK: query: DESCRIBE view_j5jbymsx8e_1
 PREHOOK: type: DESCTABLE
diff --git a/ql/src/test/results/clientpositive/authorization_cli_createtab.q.out b/ql/src/test/results/clientpositive/authorization_cli_createtab.q.out
index 79a0a9541d..a75d64b4b1 100644
--- a/ql/src/test/results/clientpositive/authorization_cli_createtab.q.out
+++ b/ql/src/test/results/clientpositive/authorization_cli_createtab.q.out
@@ -23,9 +23,12 @@ default	t_cli			hive_test_user	USER	UPDATE	true	-1	hive_test_user
 PREHOOK: query: create view v_cli (i) as select i from t_cli
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@t_cli
+PREHOOK: Output: database:default
+PREHOOK: Output: default@v_cli
 POSTHOOK: query: create view v_cli (i) as select i from t_cli
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@t_cli
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v_cli
 PREHOOK: query: show grant user hive_test_user on v_cli
 PREHOOK: type: SHOW_GRANT
diff --git a/ql/src/test/results/clientpositive/authorization_create_temp_table.q.out b/ql/src/test/results/clientpositive/authorization_create_temp_table.q.out
index b171d6cf8d..c87862d048 100644
--- a/ql/src/test/results/clientpositive/authorization_create_temp_table.q.out
+++ b/ql/src/test/results/clientpositive/authorization_create_temp_table.q.out
@@ -1,9 +1,12 @@
 PREHOOK: query: create table authorization_create_temp_table_1 as select * from src limit 10
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@authorization_create_temp_table_1
 POSTHOOK: query: create table authorization_create_temp_table_1 as select * from src limit 10
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@authorization_create_temp_table_1
 PREHOOK: query: grant select on authorization_create_temp_table_1 to user user1
 PREHOOK: type: GRANT_PRIVILEGE
diff --git a/ql/src/test/results/clientpositive/authorization_owner_actions.q.out b/ql/src/test/results/clientpositive/authorization_owner_actions.q.out
index ad818884d8..41d339c6ae 100644
--- a/ql/src/test/results/clientpositive/authorization_owner_actions.q.out
+++ b/ql/src/test/results/clientpositive/authorization_owner_actions.q.out
@@ -35,9 +35,12 @@ POSTHOOK: Output: default@t1
 PREHOOK: query: create view vt1 as select * from t1
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@t1
+PREHOOK: Output: database:default
+PREHOOK: Output: default@vt1
 POSTHOOK: query: create view vt1 as select * from t1
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@t1
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@vt1
 PREHOOK: query: drop view vt1
 PREHOOK: type: DROPVIEW
diff --git a/ql/src/test/results/clientpositive/authorization_view_sqlstd.q.out b/ql/src/test/results/clientpositive/authorization_view_sqlstd.q.out
index 279554d31d..39367be930 100644
--- a/ql/src/test/results/clientpositive/authorization_view_sqlstd.q.out
+++ b/ql/src/test/results/clientpositive/authorization_view_sqlstd.q.out
@@ -22,19 +22,25 @@ PREHOOK: query: -- protecting certain columns
 create view vt1 as select i,k from t1
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@t1
+PREHOOK: Output: database:default
+PREHOOK: Output: default@vt1
 POSTHOOK: query: -- protecting certain columns
 create view vt1 as select i,k from t1
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@t1
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@vt1
 PREHOOK: query: -- protecting certain rows
 create view vt2 as select * from t1 where i > 1
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@t1
+PREHOOK: Output: database:default
+PREHOOK: Output: default@vt2
 POSTHOOK: query: -- protecting certain rows
 create view vt2 as select * from t1 where i > 1
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@t1
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@vt2
 PREHOOK: query: show grant user user1 on all
 PREHOOK: type: SHOW_GRANT
diff --git a/ql/src/test/results/clientpositive/autogen_colalias.q.out b/ql/src/test/results/clientpositive/autogen_colalias.q.out
index 925b3b5ff2..c748b2768e 100644
--- a/ql/src/test/results/clientpositive/autogen_colalias.q.out
+++ b/ql/src/test/results/clientpositive/autogen_colalias.q.out
@@ -10,12 +10,15 @@ PREHOOK: query: create table dest_grouped_old1 as select 1+1, 2+2 as zz, src.key
  from src group by src.key
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_grouped_old1
 POSTHOOK: query: create table dest_grouped_old1 as select 1+1, 2+2 as zz, src.key, test_max(length(src.value)), count(src.value), sin(count(src.value)), count(sin(src.value)), unix_timestamp(), CAST(SUM(IF(value > 10, value, 1)) AS INT), if(src.key > 1,
 1,
 0)
  from src group by src.key
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@dest_grouped_old1
 PREHOOK: query: describe dest_grouped_old1
 PREHOOK: type: DESCTABLE
@@ -36,9 +39,12 @@ _c9                 	int
 PREHOOK: query: create table dest_grouped_old2 as select distinct src.key from src
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_grouped_old2
 POSTHOOK: query: create table dest_grouped_old2 as select distinct src.key from src
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@dest_grouped_old2
 PREHOOK: query: describe dest_grouped_old2
 PREHOOK: type: DESCTABLE
@@ -53,12 +59,15 @@ PREHOOK: query: create table dest_grouped_new1 as select 1+1, 2+2 as zz, ((src.k
 from src group by src.key
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_grouped_new1
 POSTHOOK: query: create table dest_grouped_new1 as select 1+1, 2+2 as zz, ((src.key % 2)+2)/2, test_max(length(src.value)), count(src.value), sin(count(src.value)), count(sin(src.value)), unix_timestamp(), CAST(SUM(IF(value > 10, value, 1)) AS INT), if(src.key > 10,
 	(src.key +5) % 2,
 0)
 from src group by src.key
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@dest_grouped_new1
 PREHOOK: query: describe dest_grouped_new1
 PREHOOK: type: DESCTABLE
@@ -79,9 +88,12 @@ if_src_key_10_src_ke_9	double
 PREHOOK: query: create table dest_grouped_new2 as select distinct src.key from src
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_grouped_new2
 POSTHOOK: query: create table dest_grouped_new2 as select distinct src.key from src
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@dest_grouped_new2
 PREHOOK: query: describe dest_grouped_new2
 PREHOOK: type: DESCTABLE
diff --git a/ql/src/test/results/clientpositive/char_nested_types.q.out b/ql/src/test/results/clientpositive/char_nested_types.q.out
index 66b7bb61c8..07bf3c3a8e 100644
--- a/ql/src/test/results/clientpositive/char_nested_types.q.out
+++ b/ql/src/test/results/clientpositive/char_nested_types.q.out
@@ -164,11 +164,14 @@ create table char_nested_cta as
   select * from char_nested_struct
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@char_nested_struct
+PREHOOK: Output: database:default
+PREHOOK: Output: default@char_nested_cta
 POSTHOOK: query: -- nested type with create table as
 create table char_nested_cta as 
   select * from char_nested_struct
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@char_nested_struct
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@char_nested_cta
 PREHOOK: query: describe char_nested_cta
 PREHOOK: type: DESCTABLE
@@ -191,11 +194,14 @@ create table char_nested_view as
   select * from char_nested_struct
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@char_nested_struct
+PREHOOK: Output: database:default
+PREHOOK: Output: default@char_nested_view
 POSTHOOK: query: -- nested type with view
 create table char_nested_view as 
   select * from char_nested_struct
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@char_nested_struct
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@char_nested_view
 PREHOOK: query: describe char_nested_view
 PREHOOK: type: DESCTABLE
diff --git a/ql/src/test/results/clientpositive/colstats_all_nulls.q.out b/ql/src/test/results/clientpositive/colstats_all_nulls.q.out
index 1186aa8b9e..a16680b81b 100644
--- a/ql/src/test/results/clientpositive/colstats_all_nulls.q.out
+++ b/ql/src/test/results/clientpositive/colstats_all_nulls.q.out
@@ -17,9 +17,12 @@ POSTHOOK: Output: default@src_null
 PREHOOK: query: create table all_nulls as SELECT a, cast(a as double) as b, cast(a as decimal) as c  FROM src_null where a is null limit 5
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src_null
+PREHOOK: Output: database:default
+PREHOOK: Output: default@all_nulls
 POSTHOOK: query: create table all_nulls as SELECT a, cast(a as double) as b, cast(a as decimal) as c  FROM src_null where a is null limit 5
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src_null
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@all_nulls
 PREHOOK: query: analyze table all_nulls compute statistics for columns
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/create_big_view.q.out b/ql/src/test/results/clientpositive/create_big_view.q.out
index 9efa517ef5..020ac90ae5 100644
--- a/ql/src/test/results/clientpositive/create_big_view.q.out
+++ b/ql/src/test/results/clientpositive/create_big_view.q.out
@@ -243,6 +243,8 @@ CREATE VIEW big_view AS SELECT
 FROM src
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@big_view
 POSTHOOK: query: -- Define a view with long SQL text to test metastore and other limits.
 
 CREATE VIEW big_view AS SELECT 
@@ -484,6 +486,7 @@ CREATE VIEW big_view AS SELECT
 FROM src
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@big_view
 PREHOOK: query: SELECT a FROM big_view
 LIMIT 1
diff --git a/ql/src/test/results/clientpositive/create_default_prop.q.out b/ql/src/test/results/clientpositive/create_default_prop.q.out
index c841407b22..4b267ae1ae 100644
--- a/ql/src/test/results/clientpositive/create_default_prop.q.out
+++ b/ql/src/test/results/clientpositive/create_default_prop.q.out
@@ -35,9 +35,12 @@ a                   	string
 PREHOOK: query: CREATE TABLE table_p3 AS SELECT * FROM table_p1
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@table_p1
+PREHOOK: Output: database:default
+PREHOOK: Output: default@table_p3
 POSTHOOK: query: CREATE TABLE table_p3 AS SELECT * FROM table_p1
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@table_p1
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@table_p3
 PREHOOK: query: DESC EXTENDED table_p3
 PREHOOK: type: DESCTABLE
diff --git a/ql/src/test/results/clientpositive/create_like_tbl_props.q.out b/ql/src/test/results/clientpositive/create_like_tbl_props.q.out
index 2ac28472ca..e151897bc2 100644
--- a/ql/src/test/results/clientpositive/create_like_tbl_props.q.out
+++ b/ql/src/test/results/clientpositive/create_like_tbl_props.q.out
@@ -181,11 +181,14 @@ PREHOOK: query: --Test that CREATE TALBE LIKE on a view can take explicit table
 CREATE VIEW test_view (key, value) AS SELECT * FROM src
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@test_view
 POSTHOOK: query: --Test that CREATE TALBE LIKE on a view can take explicit table properties
 
 CREATE VIEW test_view (key, value) AS SELECT * FROM src
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@test_view
 PREHOOK: query: CREATE TABLE test_table4 LIKE test_view TBLPROPERTIES('key'='value')
 PREHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/create_like_view.q.out b/ql/src/test/results/clientpositive/create_like_view.q.out
index bcd35d6c62..0978fcfa37 100644
--- a/ql/src/test/results/clientpositive/create_like_view.q.out
+++ b/ql/src/test/results/clientpositive/create_like_view.q.out
@@ -68,9 +68,12 @@ Storage Desc Params:
 PREHOOK: query: CREATE VIEW view1 AS SELECT * FROM table1
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@table1
+PREHOOK: Output: database:default
+PREHOOK: Output: default@view1
 POSTHOOK: query: CREATE VIEW view1 AS SELECT * FROM table1
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@table1
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@view1
 PREHOOK: query: CREATE TABLE table2 LIKE view1
 PREHOOK: type: CREATETABLE
@@ -242,10 +245,13 @@ PREHOOK: query: -- check partitions
 create view view1 partitioned on (ds, hr) as select * from srcpart
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@srcpart
+PREHOOK: Output: database:default
+PREHOOK: Output: default@view1
 POSTHOOK: query: -- check partitions
 create view view1 partitioned on (ds, hr) as select * from srcpart
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@srcpart
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@view1
 PREHOOK: query: create table table1 like view1
 PREHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/create_or_replace_view.q.out b/ql/src/test/results/clientpositive/create_or_replace_view.q.out
index 7dd554e3ad..aab78ba2ac 100644
--- a/ql/src/test/results/clientpositive/create_or_replace_view.q.out
+++ b/ql/src/test/results/clientpositive/create_or_replace_view.q.out
@@ -7,9 +7,12 @@ POSTHOOK: Output: database:vt
 PREHOOK: query: create view vt.v as select * from srcpart
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@srcpart
+PREHOOK: Output: database:vt
+PREHOOK: Output: vt@v
 POSTHOOK: query: create view vt.v as select * from srcpart
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@srcpart
+POSTHOOK: Output: database:vt
 POSTHOOK: Output: vt@v
 PREHOOK: query: describe formatted vt.v
 PREHOOK: type: DESCTABLE
@@ -49,10 +52,13 @@ PREHOOK: query: -- modifying definition of unpartitioned view
 create or replace view vt.v partitioned on (ds, hr) as select * from srcpart
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@srcpart
+PREHOOK: Output: database:vt
+PREHOOK: Output: vt@v
 POSTHOOK: query: -- modifying definition of unpartitioned view
 create or replace view vt.v partitioned on (ds, hr) as select * from srcpart
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@srcpart
+POSTHOOK: Output: database:vt
 POSTHOOK: Output: vt@v
 PREHOOK: query: alter view vt.v add partition (ds='2008-04-08',hr='11')
 PREHOOK: type: ALTERTABLE_ADDPARTS
@@ -167,10 +173,13 @@ PREHOOK: query: -- altering partitioned view 1
 create or replace view vt.v partitioned on (ds, hr) as select value, ds, hr from srcpart
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@srcpart
+PREHOOK: Output: database:vt
+PREHOOK: Output: vt@v
 POSTHOOK: query: -- altering partitioned view 1
 create or replace view vt.v partitioned on (ds, hr) as select value, ds, hr from srcpart
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@srcpart
+POSTHOOK: Output: database:vt
 POSTHOOK: Output: vt@v
 PREHOOK: query: select * from vt.v where value='val_409' and ds='2008-04-08' and hr='11'
 PREHOOK: type: QUERY
@@ -234,10 +243,13 @@ PREHOOK: query: -- altering partitioned view 2
 create or replace view vt.v partitioned on (ds, hr) as select key, value, ds, hr from srcpart
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@srcpart
+PREHOOK: Output: database:vt
+PREHOOK: Output: vt@v
 POSTHOOK: query: -- altering partitioned view 2
 create or replace view vt.v partitioned on (ds, hr) as select key, value, ds, hr from srcpart
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@srcpart
+POSTHOOK: Output: database:vt
 POSTHOOK: Output: vt@v
 PREHOOK: query: select * from vt.v where value='val_409' and ds='2008-04-08' and hr='11'
 PREHOOK: type: QUERY
@@ -319,9 +331,12 @@ POSTHOOK: Output: default@srcpart_temp
 PREHOOK: query: create view vt.v partitioned on (ds, hr) as select * from srcpart_temp
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@srcpart_temp
+PREHOOK: Output: database:vt
+PREHOOK: Output: vt@v
 POSTHOOK: query: create view vt.v partitioned on (ds, hr) as select * from srcpart_temp
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@srcpart_temp
+POSTHOOK: Output: database:vt
 POSTHOOK: Output: vt@v
 PREHOOK: query: drop table srcpart_temp
 PREHOOK: type: DROPTABLE
@@ -335,10 +350,13 @@ PREHOOK: query: -- vt.v is now invalid
 create or replace view vt.v partitioned on (ds, hr) as select * from srcpart
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@srcpart
+PREHOOK: Output: database:vt
+PREHOOK: Output: vt@v
 POSTHOOK: query: -- vt.v is now invalid
 create or replace view vt.v partitioned on (ds, hr) as select * from srcpart
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@srcpart
+POSTHOOK: Output: database:vt
 POSTHOOK: Output: vt@v
 PREHOOK: query: describe formatted vt.v
 PREHOOK: type: DESCTABLE
diff --git a/ql/src/test/results/clientpositive/create_union_table.q.out b/ql/src/test/results/clientpositive/create_union_table.q.out
index a3f0918a24..f2aedd17ae 100644
--- a/ql/src/test/results/clientpositive/create_union_table.q.out
+++ b/ql/src/test/results/clientpositive/create_union_table.q.out
@@ -15,7 +15,7 @@ STAGE PLANS:
           input format: org.apache.hadoop.mapred.TextInputFormat
           output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
           serde name: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-          name: abc
+          name: default.abc
 
 PREHOOK: query: create table abc(mydata uniontype<int,double,array<string>,struct<a:int,b:string>>,
 strct struct<a:int, b:string, c:string>)
diff --git a/ql/src/test/results/clientpositive/create_view.q.out b/ql/src/test/results/clientpositive/create_view.q.out
index 45bae20de5..9f665d6447 100644
--- a/ql/src/test/results/clientpositive/create_view.q.out
+++ b/ql/src/test/results/clientpositive/create_view.q.out
@@ -86,27 +86,36 @@ POSTHOOK: Input: default@src
 PREHOOK: query: CREATE VIEW view1 AS SELECT value FROM src WHERE key=86
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@view1
 POSTHOOK: query: CREATE VIEW view1 AS SELECT value FROM src WHERE key=86
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@view1
 PREHOOK: query: CREATE VIEW view2 AS SELECT * FROM src
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@view2
 POSTHOOK: query: CREATE VIEW view2 AS SELECT * FROM src
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@view2
 PREHOOK: query: CREATE VIEW view3(valoo) 
 TBLPROPERTIES ("fear" = "factor")
 AS SELECT upper(value) FROM src WHERE key=86
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@view3
 POSTHOOK: query: CREATE VIEW view3(valoo) 
 TBLPROPERTIES ("fear" = "factor")
 AS SELECT upper(value) FROM src WHERE key=86
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@view3
 PREHOOK: query: SELECT * from view1
 PREHOOK: type: QUERY
@@ -159,8 +168,8 @@ STAGE PLANS:
         Create View
           or replace: false
           columns: valoo string
-          expanded text: SELECT `_c0` AS `valoo` FROM (SELECT upper(`src`.`value`) FROM `default`.`src` WHERE `src`.`key`=86) `view0`
-          name: view0
+          expanded text: SELECT `_c0` AS `valoo` FROM (SELECT upper(`src`.`value`) FROM `default`.`src` WHERE `src`.`key`=86) `default.view0`
+          name: default.view0
           original text: SELECT upper(value) FROM src WHERE key=86
 
 PREHOOK: query: -- make sure EXPLAIN works with a query which references a view
@@ -354,7 +363,7 @@ Sort Columns:       	[]
 	 	 
 # View Information	 	 
 View Original Text: 	SELECT upper(value) FROM src WHERE key=86	 
-View Expanded Text: 	SELECT `_c0` AS `valoo` FROM (SELECT upper(`src`.`value`) FROM `default`.`src` WHERE `src`.`key`=86) `view3`	 
+View Expanded Text: 	SELECT `_c0` AS `valoo` FROM (SELECT upper(`src`.`value`) FROM `default`.`src` WHERE `src`.`key`=86) `default.view3`	 
 PREHOOK: query: ALTER VIEW view3 SET TBLPROPERTIES ("biggest" = "loser")
 PREHOOK: type: ALTERVIEW_PROPERTIES
 PREHOOK: Input: default@view3
@@ -404,7 +413,7 @@ Sort Columns:       	[]
 	 	 
 # View Information	 	 
 View Original Text: 	SELECT upper(value) FROM src WHERE key=86	 
-View Expanded Text: 	SELECT `_c0` AS `valoo` FROM (SELECT upper(`src`.`value`) FROM `default`.`src` WHERE `src`.`key`=86) `view3`	 
+View Expanded Text: 	SELECT `_c0` AS `valoo` FROM (SELECT upper(`src`.`value`) FROM `default`.`src` WHERE `src`.`key`=86) `default.view3`	 
 PREHOOK: query: CREATE TABLE table1 (key int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
@@ -470,9 +479,12 @@ POSTHOOK: Input: default@table1
 PREHOOK: query: CREATE VIEW view4 AS SELECT * FROM table1
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@table1
+PREHOOK: Output: database:default
+PREHOOK: Output: default@view4
 POSTHOOK: query: CREATE VIEW view4 AS SELECT * FROM table1
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@table1
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@view4
 PREHOOK: query: SELECT * FROM view4
 PREHOOK: type: QUERY
@@ -540,11 +552,14 @@ FROM view4 v1 join view4 v2
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@table1
 PREHOOK: Input: default@view4
+PREHOOK: Output: database:default
+PREHOOK: Output: default@view5
 POSTHOOK: query: CREATE VIEW view5 AS SELECT v1.key as key1, v2.key as key2
 FROM view4 v1 join view4 v2
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@table1
 POSTHOOK: Input: default@view4
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@view5
 Warning: Shuffle Join JOIN[6][tables = [v1, v2]] in Stage 'Stage-1:MAPRED' is a cross product
 PREHOOK: query: SELECT * FROM view5
@@ -574,12 +589,15 @@ CREATE VIEW view6(valoo COMMENT 'I cannot spell') AS
 SELECT upper(value) as blarg FROM src WHERE key=86
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@view6
 POSTHOOK: query: -- verify that column name and comment in DDL portion
 -- overrides column alias in SELECT
 CREATE VIEW view6(valoo COMMENT 'I cannot spell') AS
 SELECT upper(value) as blarg FROM src WHERE key=86
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@view6
 PREHOOK: query: DESCRIBE view6
 PREHOOK: type: DESCTABLE
@@ -596,6 +614,8 @@ ORDER BY key, value
 LIMIT 10
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@view7
 POSTHOOK: query: -- verify that ORDER BY and LIMIT are both supported in view def
 CREATE VIEW view7 AS
 SELECT * FROM src
@@ -604,6 +624,7 @@ ORDER BY key, value
 LIMIT 10
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@view7
 PREHOOK: query: SELECT * FROM view7
 PREHOOK: type: QUERY
@@ -705,11 +726,14 @@ SELECT test_translate('abc', 'a', 'b')
 FROM table1
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@table1
+PREHOOK: Output: database:default
+PREHOOK: Output: default@view8
 POSTHOOK: query: CREATE VIEW view8(c) AS
 SELECT test_translate('abc', 'a', 'b')
 FROM table1
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@table1
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@view8
 PREHOOK: query: DESCRIBE EXTENDED view8
 PREHOOK: type: DESCTABLE
@@ -721,7 +745,7 @@ c                   	string
 	 	 
 #### A masked pattern was here ####
 FROM table1, viewExpandedText:SELECT `_c0` AS `c` FROM (SELECT `test_translate`('abc', 'a', 'b')	 	 
-FROM `default`.`table1`) `view8`, tableType:VIRTUAL_VIEW)		 
+FROM `default`.`table1`) `default.view8`, tableType:VIRTUAL_VIEW)		 
 PREHOOK: query: DESCRIBE FORMATTED view8
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@view8
@@ -754,7 +778,7 @@ Sort Columns:       	[]
 View Original Text: 	SELECT test_translate('abc', 'a', 'b')	 
 FROM table1	 	 
 View Expanded Text: 	SELECT `_c0` AS `c` FROM (SELECT `test_translate`('abc', 'a', 'b')	 
-FROM `default`.`table1`) `view8`	 	 
+FROM `default`.`table1`) `default.view8`	 	 
 PREHOOK: query: SELECT * FROM view8
 PREHOOK: type: QUERY
 PREHOOK: Input: default@table1
@@ -782,12 +806,15 @@ SELECT test_max(length(value))
 FROM src
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@view9
 POSTHOOK: query: -- disable map-side aggregation
 CREATE VIEW view9(m) AS
 SELECT test_max(length(value))
 FROM src
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@view9
 PREHOOK: query: DESCRIBE EXTENDED view9
 PREHOOK: type: DESCTABLE
@@ -799,7 +826,7 @@ m                   	int
 	 	 
 #### A masked pattern was here ####
 FROM src, viewExpandedText:SELECT `_c0` AS `m` FROM (SELECT `test_max`(length(`src`.`value`))	 	 
-FROM `default`.`src`) `view9`, tableType:VIRTUAL_VIEW)		 
+FROM `default`.`src`) `default.view9`, tableType:VIRTUAL_VIEW)		 
 PREHOOK: query: DESCRIBE FORMATTED view9
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@view9
@@ -832,7 +859,7 @@ Sort Columns:       	[]
 View Original Text: 	SELECT test_max(length(value))	 
 FROM src	 	 
 View Expanded Text: 	SELECT `_c0` AS `m` FROM (SELECT `test_max`(length(`src`.`value`))	 
-FROM `default`.`src`) `view9`	 	 
+FROM `default`.`src`) `default.view9`	 	 
 PREHOOK: query: SELECT * FROM view9
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
@@ -858,12 +885,15 @@ SELECT test_max(length(value))
 FROM src
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@view9
 POSTHOOK: query: -- enable map-side aggregation
 CREATE VIEW view9(m) AS
 SELECT test_max(length(value))
 FROM src
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@view9
 PREHOOK: query: DESCRIBE EXTENDED view9
 PREHOOK: type: DESCTABLE
@@ -875,7 +905,7 @@ m                   	int
 	 	 
 #### A masked pattern was here ####
 FROM src, viewExpandedText:SELECT `_c0` AS `m` FROM (SELECT `test_max`(length(`src`.`value`))	 	 
-FROM `default`.`src`) `view9`, tableType:VIRTUAL_VIEW)		 
+FROM `default`.`src`) `default.view9`, tableType:VIRTUAL_VIEW)		 
 PREHOOK: query: DESCRIBE FORMATTED view9
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@view9
@@ -908,7 +938,7 @@ Sort Columns:       	[]
 View Original Text: 	SELECT test_max(length(value))	 
 FROM src	 	 
 View Expanded Text: 	SELECT `_c0` AS `m` FROM (SELECT `test_max`(length(`src`.`value`))	 
-FROM `default`.`src`) `view9`	 	 
+FROM `default`.`src`) `default.view9`	 	 
 PREHOOK: query: SELECT * FROM view9
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
@@ -925,11 +955,14 @@ CREATE VIEW view10 AS
 SELECT slurp.* FROM (SELECT * FROM src WHERE key=86) slurp
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@view10
 POSTHOOK: query: -- test usage of a subselect within a view
 CREATE VIEW view10 AS
 SELECT slurp.* FROM (SELECT * FROM src WHERE key=86) slurp
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@view10
 PREHOOK: query: DESCRIBE EXTENDED view10
 PREHOOK: type: DESCTABLE
@@ -999,11 +1032,14 @@ SELECT test_explode(array(1,2,3)) AS (boom)
 FROM table1
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@table1
+PREHOOK: Output: database:default
+PREHOOK: Output: default@view11
 POSTHOOK: query: CREATE VIEW view11 AS
 SELECT test_explode(array(1,2,3)) AS (boom)
 FROM table1
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@table1
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@view11
 PREHOOK: query: DESCRIBE EXTENDED view11
 PREHOOK: type: DESCTABLE
@@ -1067,11 +1103,14 @@ CREATE VIEW view12 AS
 SELECT * FROM src LATERAL VIEW explode(array(1,2,3)) myTable AS myCol
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@view12
 POSTHOOK: query: -- test usage of LATERAL within a view
 CREATE VIEW view12 AS
 SELECT * FROM src LATERAL VIEW explode(array(1,2,3)) myTable AS myCol
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@view12
 PREHOOK: query: DESCRIBE EXTENDED view12
 PREHOOK: type: DESCTABLE
@@ -1151,12 +1190,15 @@ SELECT s.key
 FROM srcbucket TABLESAMPLE (BUCKET 1 OUT OF 5 ON key) s
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@srcbucket
+PREHOOK: Output: database:default
+PREHOOK: Output: default@view13
 POSTHOOK: query: -- test usage of TABLESAMPLE within a view
 CREATE VIEW view13 AS
 SELECT s.key
 FROM srcbucket TABLESAMPLE (BUCKET 1 OUT OF 5 ON key) s
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@srcbucket
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@view13
 PREHOOK: query: DESCRIBE EXTENDED view13
 PREHOOK: type: DESCTABLE
@@ -1240,6 +1282,8 @@ JOIN
 ON (unionsrc1.key = unionsrc2.key)
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@view14
 POSTHOOK: query: -- test usage of JOIN+UNION+AGG all within same view
 CREATE VIEW view14 AS
 SELECT unionsrc1.key as k1, unionsrc1.value as v1,
@@ -1254,6 +1298,7 @@ JOIN
 ON (unionsrc1.key = unionsrc2.key)
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@view14
 PREHOOK: query: DESCRIBE EXTENDED view14
 PREHOOK: type: DESCTABLE
@@ -1379,6 +1424,8 @@ FROM src
 GROUP BY key
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@view15
 POSTHOOK: query: -- test usage of GROUP BY within view
 CREATE VIEW view15 AS
 SELECT key,COUNT(value) AS value_count
@@ -1386,6 +1433,7 @@ FROM src
 GROUP BY key
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@view15
 PREHOOK: query: DESCRIBE EXTENDED view15
 PREHOOK: type: DESCTABLE
@@ -1467,12 +1515,15 @@ SELECT DISTINCT value
 FROM src
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@view16
 POSTHOOK: query: -- test usage of DISTINCT within view
 CREATE VIEW view16 AS
 SELECT DISTINCT value
 FROM src
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@view16
 PREHOOK: query: DESCRIBE EXTENDED view16
 PREHOOK: type: DESCTABLE
diff --git a/ql/src/test/results/clientpositive/create_view_partitioned.q.out b/ql/src/test/results/clientpositive/create_view_partitioned.q.out
index 021639554d..ebf9a6bc4f 100644
--- a/ql/src/test/results/clientpositive/create_view_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/create_view_partitioned.q.out
@@ -20,6 +20,8 @@ FROM src
 WHERE key=86
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@vp1
 POSTHOOK: query: -- test partitioned view definition
 -- (underlying table is not actually partitioned)
 CREATE VIEW vp1
@@ -30,6 +32,7 @@ FROM src
 WHERE key=86
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@vp1
 PREHOOK: query: DESCRIBE EXTENDED vp1
 PREHOOK: type: DESCTABLE
@@ -245,6 +248,8 @@ PARTITIONED ON (hr)
 AS SELECT * FROM srcpart WHERE key < 10
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@srcpart
+PREHOOK: Output: database:default
+PREHOOK: Output: default@vp2
 POSTHOOK: query: -- test a partitioned view on top of an underlying partitioned table,
 -- but with only a suffix of the partitioning columns
 CREATE VIEW vp2
@@ -252,6 +257,7 @@ PARTITIONED ON (hr)
 AS SELECT * FROM srcpart WHERE key < 10
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@srcpart
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@vp2
 PREHOOK: query: DESCRIBE FORMATTED vp2
 PREHOOK: type: DESCTABLE
@@ -355,6 +361,8 @@ FROM src
 WHERE key=86
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@vp3
 POSTHOOK: query: -- test a partitioned view where the PARTITIONED ON clause references
 -- an imposed column name
 CREATE VIEW vp3(k,v)
@@ -365,6 +373,7 @@ FROM src
 WHERE key=86
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@vp3
 PREHOOK: query: DESCRIBE FORMATTED vp3
 PREHOOK: type: DESCTABLE
@@ -405,7 +414,7 @@ FROM src
 WHERE key=86	 	 
 View Expanded Text: 	SELECT `key` AS `k`, `value` AS `v` FROM (SELECT `src`.`key`, `src`.`value`	 
 FROM `default`.`src`	 	 
-WHERE `src`.`key`=86) `vp3`	 	 
+WHERE `src`.`key`=86) `default.vp3`	 	 
 PREHOOK: query: ALTER VIEW vp3
 ADD PARTITION (v='val_86')
 PREHOOK: type: ALTERTABLE_ADDPARTS
diff --git a/ql/src/test/results/clientpositive/create_view_translate.q.out b/ql/src/test/results/clientpositive/create_view_translate.q.out
index 94b4dd6444..30a407b072 100644
--- a/ql/src/test/results/clientpositive/create_view_translate.q.out
+++ b/ql/src/test/results/clientpositive/create_view_translate.q.out
@@ -9,9 +9,12 @@ POSTHOOK: type: DROPVIEW
 PREHOOK: query: create view v as select cast(key as string) from src
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@v
 POSTHOOK: query: create view v as select cast(key as string) from src
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v
 PREHOOK: query: describe formatted v
 PREHOOK: type: DESCTABLE
@@ -49,11 +52,14 @@ PREHOOK: query: create view w as select key, value from (
 ) a
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@w
 POSTHOOK: query: create view w as select key, value from (
   select key, value from src
 ) a
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@w
 PREHOOK: query: describe formatted w
 PREHOOK: type: DESCTABLE
@@ -135,15 +141,18 @@ STAGE PLANS:
           or replace: false
           columns: id int, _c1 string
           expanded text: SELECT `items`.`id`, `items`.`info`['price'] FROM `default`.`items`
-          name: priceview
+          name: default.priceview
           original text: SELECT items.id, items.info['price'] FROM items
 
 PREHOOK: query: CREATE VIEW priceview AS SELECT items.id, items.info['price'] FROM items
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@items
+PREHOOK: Output: database:default
+PREHOOK: Output: default@priceview
 POSTHOOK: query: CREATE VIEW priceview AS SELECT items.id, items.info['price'] FROM items
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@items
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@priceview
 PREHOOK: query: select * from priceview
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/cross_product_check_1.q.out b/ql/src/test/results/clientpositive/cross_product_check_1.q.out
index bc7551cc82..87e356d153 100644
--- a/ql/src/test/results/clientpositive/cross_product_check_1.q.out
+++ b/ql/src/test/results/clientpositive/cross_product_check_1.q.out
@@ -2,21 +2,27 @@ PREHOOK: query: create table A as
 select * from src
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@A
 POSTHOOK: query: create table A as
 select * from src
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@A
 PREHOOK: query: create table B as
 select * from src
 limit 10
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@B
 POSTHOOK: query: create table B as
 select * from src
 limit 10
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@B
 Warning: Shuffle Join JOIN[4][tables = [a, b]] in Stage 'Stage-1:MAPRED' is a cross product
 PREHOOK: query: explain select * from A join B
diff --git a/ql/src/test/results/clientpositive/cross_product_check_2.q.out b/ql/src/test/results/clientpositive/cross_product_check_2.q.out
index 29e9c7ad9c..32d94a654b 100644
--- a/ql/src/test/results/clientpositive/cross_product_check_2.q.out
+++ b/ql/src/test/results/clientpositive/cross_product_check_2.q.out
@@ -2,21 +2,27 @@ PREHOOK: query: create table A as
 select * from src
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@A
 POSTHOOK: query: create table A as
 select * from src
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@A
 PREHOOK: query: create table B as
 select * from src
 limit 10
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@B
 POSTHOOK: query: create table B as
 select * from src
 limit 10
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@B
 Warning: Map Join MAPJOIN[7][bigTable=a] in task 'Stage-3:MAPRED' is a cross product
 PREHOOK: query: explain select * from A join B
diff --git a/ql/src/test/results/clientpositive/ctas.q.out b/ql/src/test/results/clientpositive/ctas.q.out
index 3c3d22b603..079118e53a 100644
--- a/ql/src/test/results/clientpositive/ctas.q.out
+++ b/ql/src/test/results/clientpositive/ctas.q.out
@@ -97,7 +97,7 @@ STAGE PLANS:
           input format: org.apache.hadoop.mapred.TextInputFormat
           output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
           serde name: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-          name: nzhang_CTAS1
+          name: default.nzhang_CTAS1
 
   Stage: Stage-3
     Stats-Aggr Operator
@@ -105,9 +105,12 @@ STAGE PLANS:
 PREHOOK: query: create table nzhang_CTAS1 as select key k, value from src sort by k, value limit 10
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@nzhang_CTAS1
 POSTHOOK: query: create table nzhang_CTAS1 as select key k, value from src sort by k, value limit 10
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@nzhang_CTAS1
 PREHOOK: query: select * from nzhang_CTAS1
 PREHOOK: type: QUERY
@@ -242,7 +245,7 @@ STAGE PLANS:
           input format: org.apache.hadoop.mapred.TextInputFormat
           output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
           serde name: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-          name: nzhang_ctas2
+          name: default.nzhang_ctas2
 
   Stage: Stage-3
     Stats-Aggr Operator
@@ -250,9 +253,12 @@ STAGE PLANS:
 PREHOOK: query: create table nzhang_ctas2 as select * from src sort by key, value limit 10
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@nzhang_ctas2
 POSTHOOK: query: create table nzhang_ctas2 as select * from src sort by key, value limit 10
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@nzhang_ctas2
 PREHOOK: query: select * from nzhang_ctas2
 PREHOOK: type: QUERY
@@ -387,7 +393,7 @@ STAGE PLANS:
           input format: org.apache.hadoop.hive.ql.io.RCFileInputFormat
           output format: org.apache.hadoop.hive.ql.io.RCFileOutputFormat
           serde name: org.apache.hadoop.hive.serde2.columnar.ColumnarSerDe
-          name: nzhang_ctas3
+          name: default.nzhang_ctas3
 
   Stage: Stage-3
     Stats-Aggr Operator
@@ -395,9 +401,12 @@ STAGE PLANS:
 PREHOOK: query: create table nzhang_ctas3 row format serde "org.apache.hadoop.hive.serde2.columnar.ColumnarSerDe" stored as RCFile as select key/2 half_key, concat(value, "_con") conb  from src sort by half_key, conb limit 10
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@nzhang_ctas3
 POSTHOOK: query: create table nzhang_ctas3 row format serde "org.apache.hadoop.hive.serde2.columnar.ColumnarSerDe" stored as RCFile as select key/2 half_key, concat(value, "_con") conb  from src sort by half_key, conb limit 10
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@nzhang_ctas3
 PREHOOK: query: select * from nzhang_ctas3
 PREHOOK: type: QUERY
@@ -598,7 +607,7 @@ STAGE PLANS:
           input format: org.apache.hadoop.mapred.TextInputFormat
           output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
           serde name: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-          name: nzhang_ctas4
+          name: default.nzhang_ctas4
 
   Stage: Stage-3
     Stats-Aggr Operator
@@ -606,9 +615,12 @@ STAGE PLANS:
 PREHOOK: query: create table nzhang_ctas4 row format delimited fields terminated by ',' stored as textfile as select key, value from src sort by key, value limit 10
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@nzhang_ctas4
 POSTHOOK: query: create table nzhang_ctas4 row format delimited fields terminated by ',' stored as textfile as select key, value from src sort by key, value limit 10
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@nzhang_ctas4
 PREHOOK: query: select * from nzhang_ctas4
 PREHOOK: type: QUERY
@@ -897,7 +909,7 @@ STAGE PLANS:
 
           output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
           serde name: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-          name: nzhang_ctas5
+          name: default.nzhang_ctas5
 
   Stage: Stage-3
     Stats-Aggr Operator
@@ -906,9 +918,12 @@ STAGE PLANS:
 PREHOOK: query: create table nzhang_ctas5 row format delimited fields terminated by ',' lines terminated by '\012' stored as textfile as select key, value from src sort by key, value limit 10
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@nzhang_ctas5
 POSTHOOK: query: create table nzhang_ctas5 row format delimited fields terminated by ',' lines terminated by '\012' stored as textfile as select key, value from src sort by key, value limit 10
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@nzhang_ctas5
 PREHOOK: query: create table nzhang_ctas6 (key string, `to` string)
 PREHOOK: type: CREATETABLE
@@ -931,7 +946,10 @@ POSTHOOK: Lineage: nzhang_ctas6.to SIMPLE [(src)src.FieldSchema(name:value, type
 PREHOOK: query: create table nzhang_ctas7 as select key, `to` from nzhang_ctas6
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@nzhang_ctas6
+PREHOOK: Output: database:default
+PREHOOK: Output: default@nzhang_ctas7
 POSTHOOK: query: create table nzhang_ctas7 as select key, `to` from nzhang_ctas6
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@nzhang_ctas6
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@nzhang_ctas7
diff --git a/ql/src/test/results/clientpositive/ctas_char.q.out b/ql/src/test/results/clientpositive/ctas_char.q.out
index 071034f079..e8d5c413ef 100644
--- a/ql/src/test/results/clientpositive/ctas_char.q.out
+++ b/ql/src/test/results/clientpositive/ctas_char.q.out
@@ -34,19 +34,25 @@ PREHOOK: query: -- create table as with char column
 create table ctas_char_2 as select key, value from ctas_char_1
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@ctas_char_1
+PREHOOK: Output: database:default
+PREHOOK: Output: default@ctas_char_2
 POSTHOOK: query: -- create table as with char column
 create table ctas_char_2 as select key, value from ctas_char_1
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@ctas_char_1
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@ctas_char_2
 PREHOOK: query: -- view with char column
 create view ctas_char_3 as select key, value from ctas_char_2
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@ctas_char_2
+PREHOOK: Output: database:default
+PREHOOK: Output: default@ctas_char_3
 POSTHOOK: query: -- view with char column
 create view ctas_char_3 as select key, value from ctas_char_2
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@ctas_char_2
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@ctas_char_3
 PREHOOK: query: select key, value from ctas_char_1
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/ctas_colname.q.out b/ql/src/test/results/clientpositive/ctas_colname.q.out
index 1da8dcd9eb..bcd42dcaca 100644
--- a/ql/src/test/results/clientpositive/ctas_colname.q.out
+++ b/ql/src/test/results/clientpositive/ctas_colname.q.out
@@ -72,7 +72,7 @@ STAGE PLANS:
           input format: org.apache.hadoop.mapred.TextInputFormat
           output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
           serde name: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-          name: summary
+          name: default.summary
 
   Stage: Stage-2
     Stats-Aggr Operator
@@ -80,9 +80,12 @@ STAGE PLANS:
 PREHOOK: query: create table summary as select *, sum(key), count(value) from src
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@summary
 POSTHOOK: query: create table summary as select *, sum(key), count(value) from src
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@summary
 PREHOOK: query: describe formatted summary
 PREHOOK: type: DESCTABLE
@@ -189,7 +192,7 @@ STAGE PLANS:
           input format: org.apache.hadoop.mapred.TextInputFormat
           output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
           serde name: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-          name: x4
+          name: default.x4
 
   Stage: Stage-2
     Stats-Aggr Operator
@@ -197,9 +200,12 @@ STAGE PLANS:
 PREHOOK: query: create table x4 as select *, rank() over(partition by key order by value) as rr from src1
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src1
+PREHOOK: Output: database:default
+PREHOOK: Output: default@x4
 POSTHOOK: query: create table x4 as select *, rank() over(partition by key order by value) as rr from src1
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src1
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@x4
 PREHOOK: query: describe formatted x4
 PREHOOK: type: DESCTABLE
@@ -354,7 +360,7 @@ STAGE PLANS:
           input format: org.apache.hadoop.mapred.TextInputFormat
           output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
           serde name: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-          name: x5
+          name: default.x5
 
   Stage: Stage-3
     Stats-Aggr Operator
@@ -362,9 +368,12 @@ STAGE PLANS:
 PREHOOK: query: create table x5 as select *, lead(key,1) over(partition by key order by value) as lead1 from src limit 20
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@x5
 POSTHOOK: query: create table x5 as select *, lead(key,1) over(partition by key order by value) as lead1 from src limit 20
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@x5
 PREHOOK: query: describe formatted x5
 PREHOOK: type: DESCTABLE
@@ -497,7 +506,7 @@ STAGE PLANS:
           input format: org.apache.hadoop.mapred.TextInputFormat
           output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
           serde name: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-          name: x6
+          name: default.x6
 
   Stage: Stage-2
     Stats-Aggr Operator
@@ -505,9 +514,12 @@ STAGE PLANS:
 PREHOOK: query: create table x6 as select * from (select *, max(key) from src1) a
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src1
+PREHOOK: Output: database:default
+PREHOOK: Output: default@x6
 POSTHOOK: query: create table x6 as select * from (select *, max(key) from src1) a
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src1
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@x6
 PREHOOK: query: describe formatted x6
 PREHOOK: type: DESCTABLE
@@ -619,7 +631,7 @@ STAGE PLANS:
           input format: org.apache.hadoop.mapred.TextInputFormat
           output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
           serde name: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-          name: x7
+          name: default.x7
 
   Stage: Stage-2
     Stats-Aggr Operator
@@ -627,9 +639,12 @@ STAGE PLANS:
 PREHOOK: query: create table x7 as select * from (select * from src group by key) a
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@x7
 POSTHOOK: query: create table x7 as select * from (select * from src group by key) a
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@x7
 PREHOOK: query: describe formatted x7
 PREHOOK: type: DESCTABLE
@@ -1051,7 +1066,7 @@ STAGE PLANS:
           input format: org.apache.hadoop.mapred.TextInputFormat
           output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
           serde name: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-          name: x8
+          name: default.x8
 
   Stage: Stage-2
     Stats-Aggr Operator
@@ -1059,9 +1074,12 @@ STAGE PLANS:
 PREHOOK: query: create table x8 as select * from (select * from src group by key having key < 9) a
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@x8
 POSTHOOK: query: create table x8 as select * from (select * from src group by key having key < 9) a
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@x8
 PREHOOK: query: describe formatted x8
 PREHOOK: type: DESCTABLE
@@ -1185,7 +1203,7 @@ STAGE PLANS:
           input format: org.apache.hadoop.mapred.TextInputFormat
           output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
           serde name: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-          name: x9
+          name: default.x9
 
   Stage: Stage-2
     Stats-Aggr Operator
@@ -1193,9 +1211,12 @@ STAGE PLANS:
 PREHOOK: query: create table x9 as select * from (select max(value),key from src group by key having key < 9 AND max(value) IS NOT NULL) a
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@x9
 POSTHOOK: query: create table x9 as select * from (select max(value),key from src group by key having key < 9 AND max(value) IS NOT NULL) a
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@x9
 PREHOOK: query: describe formatted x9
 PREHOOK: type: DESCTABLE
diff --git a/ql/src/test/results/clientpositive/ctas_date.q.out b/ql/src/test/results/clientpositive/ctas_date.q.out
index 97bcff905b..884e64989d 100644
--- a/ql/src/test/results/clientpositive/ctas_date.q.out
+++ b/ql/src/test/results/clientpositive/ctas_date.q.out
@@ -39,26 +39,35 @@ PREHOOK: query: -- create table as with date column
 create table ctas_date_2 as select key, value, dd, date '1980-12-12' from ctas_date_1
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@ctas_date_1
+PREHOOK: Output: database:default
+PREHOOK: Output: default@ctas_date_2
 POSTHOOK: query: -- create table as with date column
 create table ctas_date_2 as select key, value, dd, date '1980-12-12' from ctas_date_1
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@ctas_date_1
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@ctas_date_2
 PREHOOK: query: -- view with date column
 create view ctas_date_3 as select * from ctas_date_2 where dd > date '2000-01-01'
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@ctas_date_2
+PREHOOK: Output: database:default
+PREHOOK: Output: default@ctas_date_3
 POSTHOOK: query: -- view with date column
 create view ctas_date_3 as select * from ctas_date_2 where dd > date '2000-01-01'
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@ctas_date_2
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@ctas_date_3
 PREHOOK: query: create view ctas_date_4 as select * from ctas_date_2 where dd < date '2000-01-01'
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@ctas_date_2
+PREHOOK: Output: database:default
+PREHOOK: Output: default@ctas_date_4
 POSTHOOK: query: create view ctas_date_4 as select * from ctas_date_2 where dd < date '2000-01-01'
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@ctas_date_2
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@ctas_date_4
 PREHOOK: query: select key, value, dd, date '1980-12-12' from ctas_date_1
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/ctas_uses_database_location.q.out b/ql/src/test/results/clientpositive/ctas_uses_database_location.q.out
index c1ee330b75..286b0019d5 100644
--- a/ql/src/test/results/clientpositive/ctas_uses_database_location.q.out
+++ b/ql/src/test/results/clientpositive/ctas_uses_database_location.q.out
@@ -79,7 +79,7 @@ STAGE PLANS:
           input format: org.apache.hadoop.mapred.TextInputFormat
           output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
           serde name: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-          name: table_db1
+          name: db1.table_db1
 
   Stage: Stage-2
     Stats-Aggr Operator
@@ -117,9 +117,12 @@ STAGE PLANS:
 PREHOOK: query: CREATE TABLE table_db1 AS SELECT * FROM default.src
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:db1
+PREHOOK: Output: db1@table_db1
 POSTHOOK: query: CREATE TABLE table_db1 AS SELECT * FROM default.src
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:db1
 POSTHOOK: Output: db1@table_db1
 PREHOOK: query: DESCRIBE FORMATTED table_db1
 PREHOOK: type: DESCTABLE
diff --git a/ql/src/test/results/clientpositive/ctas_varchar.q.out b/ql/src/test/results/clientpositive/ctas_varchar.q.out
index 6a2116f0fc..9ceb64a904 100644
--- a/ql/src/test/results/clientpositive/ctas_varchar.q.out
+++ b/ql/src/test/results/clientpositive/ctas_varchar.q.out
@@ -34,19 +34,25 @@ PREHOOK: query: -- create table as with varchar column
 create table ctas_varchar_2 as select key, value from ctas_varchar_1
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@ctas_varchar_1
+PREHOOK: Output: database:default
+PREHOOK: Output: default@ctas_varchar_2
 POSTHOOK: query: -- create table as with varchar column
 create table ctas_varchar_2 as select key, value from ctas_varchar_1
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@ctas_varchar_1
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@ctas_varchar_2
 PREHOOK: query: -- view with varchar column
 create view ctas_varchar_3 as select key, value from ctas_varchar_2
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@ctas_varchar_2
+PREHOOK: Output: database:default
+PREHOOK: Output: default@ctas_varchar_3
 POSTHOOK: query: -- view with varchar column
 create view ctas_varchar_3 as select key, value from ctas_varchar_2
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@ctas_varchar_2
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@ctas_varchar_3
 PREHOOK: query: select key, value from ctas_varchar_1
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/cte_2.q.out b/ql/src/test/results/clientpositive/cte_2.q.out
index 75398644b1..a8bc760120 100644
--- a/ql/src/test/results/clientpositive/cte_2.q.out
+++ b/ql/src/test/results/clientpositive/cte_2.q.out
@@ -84,12 +84,15 @@ with q1 as ( select key from src where key = '4')
 select * from q1
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@s2
 POSTHOOK: query: -- ctas
 create table s2 as
 with q1 as ( select key from src where key = '4')
 select * from q1
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@s2
 PREHOOK: query: select * from s2
 PREHOOK: type: QUERY
@@ -114,12 +117,15 @@ with q1 as ( select key from src where key = '5')
 select * from q1
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@v1
 POSTHOOK: query: -- view test
 create view v1 as
 with q1 as ( select key from src where key = '5')
 select * from q1
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v1
 PREHOOK: query: select * from v1
 PREHOOK: type: QUERY
@@ -148,12 +154,15 @@ with q1 as ( select key from src where key = '5')
 select * from q1
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@v1
 POSTHOOK: query: -- view test, name collision
 create view v1 as
 with q1 as ( select key from src where key = '5')
 select * from q1
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v1
 PREHOOK: query: with q1 as ( select key from src where key = '4')
 select * from v1
diff --git a/ql/src/test/results/clientpositive/database.q.out b/ql/src/test/results/clientpositive/database.q.out
index 00041196bf..ad25cd5aeb 100644
--- a/ql/src/test/results/clientpositive/database.q.out
+++ b/ql/src/test/results/clientpositive/database.q.out
@@ -585,13 +585,12 @@ CREATE TABLE db1.src(key STRING, value STRING)
 STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:db1
-PREHOOK: Output: db1@db1.src
+PREHOOK: Output: db1@src
 POSTHOOK: query: -- CREATE foreign table
 CREATE TABLE db1.src(key STRING, value STRING)
 STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:db1
-POSTHOOK: Output: db1@db1.src
 POSTHOOK: Output: db1@src
 PREHOOK: query: -- LOAD into foreign table
 LOAD DATA LOCAL INPATH '../../data/files/kv1.txt'
@@ -1121,14 +1120,13 @@ PARTITIONED BY (ds STRING, hr STRING)
 STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:db1
-PREHOOK: Output: db1@db1.srcpart
+PREHOOK: Output: db1@srcpart
 POSTHOOK: query: -- CREATE Partitioned foreign table
 CREATE TABLE db1.srcpart(key STRING, value STRING)
 PARTITIONED BY (ds STRING, hr STRING)
 STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:db1
-POSTHOOK: Output: db1@db1.srcpart
 POSTHOOK: Output: db1@srcpart
 PREHOOK: query: -- LOAD data into Partitioned foreign table
 LOAD DATA LOCAL INPATH '../../data/files/kv1.txt'
@@ -1305,22 +1303,28 @@ CREATE TABLE conflict_name AS
 SELECT value FROM default.src WHERE key = 66
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:db2
+PREHOOK: Output: db2@conflict_name
 POSTHOOK: query: -- CREATE TABLE AS SELECT from foreign table
 CREATE TABLE conflict_name AS
 SELECT value FROM default.src WHERE key = 66
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:db2
 POSTHOOK: Output: db2@conflict_name
 PREHOOK: query: -- CREATE foreign table
 CREATE TABLE db1.conflict_name AS
 SELECT value FROM db1.src WHERE key = 8
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: db1@src
+PREHOOK: Output: database:db1
+PREHOOK: Output: db1@conflict_name
 POSTHOOK: query: -- CREATE foreign table
 CREATE TABLE db1.conflict_name AS
 SELECT value FROM db1.src WHERE key = 8
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: db1@src
+POSTHOOK: Output: database:db1
 POSTHOOK: Output: db1@conflict_name
 PREHOOK: query: -- query tables with the same names in different DBs
 SELECT * FROM (
@@ -1407,12 +1411,11 @@ PREHOOK: query: -- CREATE TABLE LIKE
 CREATE TABLE db2.src1 LIKE default.src
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:db2
-PREHOOK: Output: db2@db2.src1
+PREHOOK: Output: db2@src1
 POSTHOOK: query: -- CREATE TABLE LIKE
 CREATE TABLE db2.src1 LIKE default.src
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:db2
-POSTHOOK: Output: db2@db2.src1
 POSTHOOK: Output: db2@src1
 PREHOOK: query: USE db2
 PREHOOK: type: SWITCHDATABASE
diff --git a/ql/src/test/results/clientpositive/database_drop.q.out b/ql/src/test/results/clientpositive/database_drop.q.out
index bc78c94d14..f483c06038 100644
--- a/ql/src/test/results/clientpositive/database_drop.q.out
+++ b/ql/src/test/results/clientpositive/database_drop.q.out
@@ -50,9 +50,12 @@ POSTHOOK: Output: db5@temp_tbl
 PREHOOK: query: CREATE VIEW temp_tbl_view AS SELECT * FROM temp_tbl
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: db5@temp_tbl
+PREHOOK: Output: database:db5
+PREHOOK: Output: db5@temp_tbl_view
 POSTHOOK: query: CREATE VIEW temp_tbl_view AS SELECT * FROM temp_tbl
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: db5@temp_tbl
+POSTHOOK: Output: database:db5
 POSTHOOK: Output: db5@temp_tbl_view
 PREHOOK: query: CREATE INDEX idx1 ON TABLE temp_tbl(id) AS 'COMPACT' with DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
@@ -95,9 +98,12 @@ POSTHOOK: Output: db5@temp_tbl2
 PREHOOK: query: CREATE VIEW temp_tbl2_view AS SELECT * FROM temp_tbl2
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: db5@temp_tbl2
+PREHOOK: Output: database:db5
+PREHOOK: Output: db5@temp_tbl2_view
 POSTHOOK: query: CREATE VIEW temp_tbl2_view AS SELECT * FROM temp_tbl2
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: db5@temp_tbl2
+POSTHOOK: Output: database:db5
 POSTHOOK: Output: db5@temp_tbl2_view
 #### A masked pattern was here ####
 PREHOOK: type: CREATEINDEX
diff --git a/ql/src/test/results/clientpositive/dbtxnmgr_ddl1.q.out b/ql/src/test/results/clientpositive/dbtxnmgr_ddl1.q.out
index bdf3c34cf1..b147c02dd3 100644
--- a/ql/src/test/results/clientpositive/dbtxnmgr_ddl1.q.out
+++ b/ql/src/test/results/clientpositive/dbtxnmgr_ddl1.q.out
@@ -59,9 +59,12 @@ POSTHOOK: Input: default@t1
 PREHOOK: query: create table T3 as select * from T1
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@t1
+PREHOOK: Output: database:default
+PREHOOK: Output: default@T3
 POSTHOOK: query: create table T3 as select * from T1
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@t1
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@T3
 PREHOOK: query: create table T4 (key char(10), val decimal(5,2), b int)
     partitioned by (ds string)
@@ -221,9 +224,12 @@ POSTHOOK: Output: default@t4@ds=tomorrow
 PREHOOK: query: create view V1 as select key from T1
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@t1
+PREHOOK: Output: database:default
+PREHOOK: Output: default@V1
 POSTHOOK: query: create view V1 as select key from T1
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@t1
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@V1
 PREHOOK: query: alter view V1 set tblproperties ('test'='thisisatest')
 PREHOOK: type: ALTERVIEW_PROPERTIES
diff --git a/ql/src/test/results/clientpositive/dbtxnmgr_query5.q.out b/ql/src/test/results/clientpositive/dbtxnmgr_query5.q.out
index 5ce9780be7..071a015228 100644
--- a/ql/src/test/results/clientpositive/dbtxnmgr_query5.q.out
+++ b/ql/src/test/results/clientpositive/dbtxnmgr_query5.q.out
@@ -28,9 +28,12 @@ POSTHOOK: Output: foo@t1@ds=today
 PREHOOK: query: create view V1 as select key from T1
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: foo@t1
+PREHOOK: Output: database:foo
+PREHOOK: Output: foo@V1
 POSTHOOK: query: create view V1 as select key from T1
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: foo@t1
+POSTHOOK: Output: database:foo
 POSTHOOK: Output: foo@V1
 PREHOOK: query: show tables
 PREHOOK: type: SHOWTABLES
diff --git a/ql/src/test/results/clientpositive/decimal_6.q.out b/ql/src/test/results/clientpositive/decimal_6.q.out
index 720966f1a0..2bbd48ad0d 100644
--- a/ql/src/test/results/clientpositive/decimal_6.q.out
+++ b/ql/src/test/results/clientpositive/decimal_6.q.out
@@ -129,9 +129,12 @@ NULL
 PREHOOK: query: CREATE TABLE DECIMAL_6_3 AS SELECT key + 5.5 AS k, value * 11 AS v from DECIMAL_6_1 ORDER BY v
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@decimal_6_1
+PREHOOK: Output: database:default
+PREHOOK: Output: default@DECIMAL_6_3
 POSTHOOK: query: CREATE TABLE DECIMAL_6_3 AS SELECT key + 5.5 AS k, value * 11 AS v from DECIMAL_6_1 ORDER BY v
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@decimal_6_1
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@DECIMAL_6_3
 PREHOOK: query: desc DECIMAL_6_3
 PREHOOK: type: DESCTABLE
diff --git a/ql/src/test/results/clientpositive/decimal_serde.q.out b/ql/src/test/results/clientpositive/decimal_serde.q.out
index 194d2ca4eb..e461c2ef64 100644
--- a/ql/src/test/results/clientpositive/decimal_serde.q.out
+++ b/ql/src/test/results/clientpositive/decimal_serde.q.out
@@ -87,11 +87,14 @@ STORED AS RCFile AS
 SELECT * FROM DECIMAL_TEXT
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@decimal_text
+PREHOOK: Output: database:default
+PREHOOK: Output: default@DECIMAL_RC
 POSTHOOK: query: CREATE TABLE DECIMAL_RC
 STORED AS RCFile AS
 SELECT * FROM DECIMAL_TEXT
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@decimal_text
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@DECIMAL_RC
 PREHOOK: query: CREATE TABLE DECIMAL_LAZY_COL
 ROW FORMAT SERDE "org.apache.hadoop.hive.serde2.columnar.ColumnarSerDe"
@@ -99,12 +102,15 @@ STORED AS RCFile AS
 SELECT * FROM DECIMAL_RC
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@decimal_rc
+PREHOOK: Output: database:default
+PREHOOK: Output: default@DECIMAL_LAZY_COL
 POSTHOOK: query: CREATE TABLE DECIMAL_LAZY_COL
 ROW FORMAT SERDE "org.apache.hadoop.hive.serde2.columnar.ColumnarSerDe"
 STORED AS RCFile AS
 SELECT * FROM DECIMAL_RC
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@decimal_rc
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@DECIMAL_LAZY_COL
 PREHOOK: query: CREATE TABLE DECIMAL_SEQUENCE
 ROW FORMAT DELIMITED
@@ -115,6 +121,8 @@ STORED AS SEQUENCEFILE AS
 SELECT * FROM DECIMAL_LAZY_COL ORDER BY key
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@decimal_lazy_col
+PREHOOK: Output: database:default
+PREHOOK: Output: default@DECIMAL_SEQUENCE
 POSTHOOK: query: CREATE TABLE DECIMAL_SEQUENCE
 ROW FORMAT DELIMITED
 FIELDS TERMINATED BY '\001'
@@ -124,6 +132,7 @@ STORED AS SEQUENCEFILE AS
 SELECT * FROM DECIMAL_LAZY_COL ORDER BY key
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@decimal_lazy_col
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@DECIMAL_SEQUENCE
 PREHOOK: query: SELECT * FROM DECIMAL_SEQUENCE ORDER BY key, value
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/describe_formatted_view_partitioned.q.out b/ql/src/test/results/clientpositive/describe_formatted_view_partitioned.q.out
index 73d4389204..18768d95af 100644
--- a/ql/src/test/results/clientpositive/describe_formatted_view_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/describe_formatted_view_partitioned.q.out
@@ -10,6 +10,8 @@ FROM src
 WHERE key=86
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@view_partitioned
 POSTHOOK: query: CREATE VIEW view_partitioned
 PARTITIONED ON (value)
 AS
@@ -18,6 +20,7 @@ FROM src
 WHERE key=86
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@view_partitioned
 PREHOOK: query: ALTER VIEW view_partitioned
 ADD PARTITION (value='val_86')
diff --git a/ql/src/test/results/clientpositive/describe_formatted_view_partitioned_json.q.out b/ql/src/test/results/clientpositive/describe_formatted_view_partitioned_json.q.out
index 8435ebeb76..b0bac90eeb 100644
--- a/ql/src/test/results/clientpositive/describe_formatted_view_partitioned_json.q.out
+++ b/ql/src/test/results/clientpositive/describe_formatted_view_partitioned_json.q.out
@@ -10,6 +10,8 @@ FROM src
 WHERE key=86
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@view_partitioned
 POSTHOOK: query: CREATE VIEW view_partitioned
 PARTITIONED ON (value)
 AS
@@ -18,6 +20,7 @@ FROM src
 WHERE key=86
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@view_partitioned
 PREHOOK: query: ALTER VIEW view_partitioned
 ADD PARTITION (value='val_86')
diff --git a/ql/src/test/results/clientpositive/describe_syntax.q.out b/ql/src/test/results/clientpositive/describe_syntax.q.out
index 3e445f5155..cb6f40e484 100644
--- a/ql/src/test/results/clientpositive/describe_syntax.q.out
+++ b/ql/src/test/results/clientpositive/describe_syntax.q.out
@@ -7,11 +7,10 @@ POSTHOOK: Output: database:db1
 PREHOOK: query: CREATE TABLE db1.t1(key1 INT, value1 STRING) PARTITIONED BY (ds STRING, part STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:db1
-PREHOOK: Output: db1@db1.t1
+PREHOOK: Output: db1@t1
 POSTHOOK: query: CREATE TABLE db1.t1(key1 INT, value1 STRING) PARTITIONED BY (ds STRING, part STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:db1
-POSTHOOK: Output: db1@db1.t1
 POSTHOOK: Output: db1@t1
 PREHOOK: query: use db1
 PREHOOK: type: SWITCHDATABASE
diff --git a/ql/src/test/results/clientpositive/drop_multi_partitions.q.out b/ql/src/test/results/clientpositive/drop_multi_partitions.q.out
index f2a14824de..f723635f9f 100644
--- a/ql/src/test/results/clientpositive/drop_multi_partitions.q.out
+++ b/ql/src/test/results/clientpositive/drop_multi_partitions.q.out
@@ -7,11 +7,10 @@ POSTHOOK: Output: database:dmp
 PREHOOK: query: create table dmp.mp (a string) partitioned by (b string, c string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:dmp
-PREHOOK: Output: dmp@dmp.mp
+PREHOOK: Output: dmp@mp
 POSTHOOK: query: create table dmp.mp (a string) partitioned by (b string, c string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:dmp
-POSTHOOK: Output: dmp@dmp.mp
 POSTHOOK: Output: dmp@mp
 PREHOOK: query: alter table dmp.mp add partition (b='1', c='1')
 PREHOOK: type: ALTERTABLE_ADDPARTS
diff --git a/ql/src/test/results/clientpositive/exchange_partition.q.out b/ql/src/test/results/clientpositive/exchange_partition.q.out
index 79458bcde4..4ff1f6ca48 100644
--- a/ql/src/test/results/clientpositive/exchange_partition.q.out
+++ b/ql/src/test/results/clientpositive/exchange_partition.q.out
@@ -13,20 +13,18 @@ POSTHOOK: Output: database:ex2
 PREHOOK: query: CREATE TABLE ex1.exchange_part_test1 (f1 string) PARTITIONED BY (ds STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:ex1
-PREHOOK: Output: ex1@ex1.exchange_part_test1
+PREHOOK: Output: ex1@exchange_part_test1
 POSTHOOK: query: CREATE TABLE ex1.exchange_part_test1 (f1 string) PARTITIONED BY (ds STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:ex1
-POSTHOOK: Output: ex1@ex1.exchange_part_test1
 POSTHOOK: Output: ex1@exchange_part_test1
 PREHOOK: query: CREATE TABLE ex2.exchange_part_test2 (f1 string) PARTITIONED BY (ds STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:ex2
-PREHOOK: Output: ex2@ex2.exchange_part_test2
+PREHOOK: Output: ex2@exchange_part_test2
 POSTHOOK: query: CREATE TABLE ex2.exchange_part_test2 (f1 string) PARTITIONED BY (ds STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:ex2
-POSTHOOK: Output: ex2@ex2.exchange_part_test2
 POSTHOOK: Output: ex2@exchange_part_test2
 PREHOOK: query: SHOW PARTITIONS ex1.exchange_part_test1
 PREHOOK: type: SHOWPARTITIONS
diff --git a/ql/src/test/results/clientpositive/explain_dependency.q.out b/ql/src/test/results/clientpositive/explain_dependency.q.out
index 8f2ab34df7..cb98d54cc9 100644
--- a/ql/src/test/results/clientpositive/explain_dependency.q.out
+++ b/ql/src/test/results/clientpositive/explain_dependency.q.out
@@ -4,19 +4,25 @@ PREHOOK: query: -- This test is used for testing EXPLAIN DEPENDENCY command
 CREATE VIEW V1 AS SELECT key, value from src
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@V1
 POSTHOOK: query: -- This test is used for testing EXPLAIN DEPENDENCY command
 
 -- Create some views
 CREATE VIEW V1 AS SELECT key, value from src
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@V1
 PREHOOK: query: CREATE VIEW V2 AS SELECT ds, key, value FROM srcpart WHERE ds IS NOT NULL
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@srcpart
+PREHOOK: Output: database:default
+PREHOOK: Output: default@V2
 POSTHOOK: query: CREATE VIEW V2 AS SELECT ds, key, value FROM srcpart WHERE ds IS NOT NULL
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@srcpart
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@V2
 PREHOOK: query: CREATE VIEW V3 AS 
   SELECT src1.key, src2.value FROM V2 src1 
@@ -25,6 +31,8 @@ PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
 PREHOOK: Input: default@srcpart
 PREHOOK: Input: default@v2
+PREHOOK: Output: database:default
+PREHOOK: Output: default@V3
 POSTHOOK: query: CREATE VIEW V3 AS 
   SELECT src1.key, src2.value FROM V2 src1 
   JOIN src src2 ON src1.key = src2.key WHERE src1.ds IS NOT NULL
@@ -32,6 +40,7 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Input: default@srcpart
 POSTHOOK: Input: default@v2
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@V3
 PREHOOK: query: CREATE VIEW V4 AS 
   SELECT src1.key, src2.value as value1, src3.value as value2 
@@ -41,6 +50,8 @@ PREHOOK: Input: default@src
 PREHOOK: Input: default@srcpart
 PREHOOK: Input: default@v1
 PREHOOK: Input: default@v2
+PREHOOK: Output: database:default
+PREHOOK: Output: default@V4
 POSTHOOK: query: CREATE VIEW V4 AS 
   SELECT src1.key, src2.value as value1, src3.value as value2 
   FROM V1 src1 JOIN V2 src2 on src1.key = src2.key JOIN src src3 ON src2.key = src3.key
@@ -49,6 +60,7 @@ POSTHOOK: Input: default@src
 POSTHOOK: Input: default@srcpart
 POSTHOOK: Input: default@v1
 POSTHOOK: Input: default@v2
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@V4
 PREHOOK: query: -- Simple select queries, union queries and join queries
 EXPLAIN DEPENDENCY 
@@ -111,11 +123,14 @@ PREHOOK: query: -- The table should show up in the explain dependency even if no
 CREATE VIEW V5 as SELECT * FROM srcpart where ds = '10'
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@srcpart
+PREHOOK: Output: database:default
+PREHOOK: Output: default@V5
 POSTHOOK: query: -- The table should show up in the explain dependency even if none
 -- of the partitions are selected.
 CREATE VIEW V5 as SELECT * FROM srcpart where ds = '10'
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@srcpart
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@V5
 PREHOOK: query: EXPLAIN DEPENDENCY SELECT * FROM V5
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/explain_logical.q.out b/ql/src/test/results/clientpositive/explain_logical.q.out
index 862422a791..55637776da 100644
--- a/ql/src/test/results/clientpositive/explain_logical.q.out
+++ b/ql/src/test/results/clientpositive/explain_logical.q.out
@@ -4,19 +4,25 @@ PREHOOK: query: -- This test is used for testing EXPLAIN LOGICAL command
 CREATE VIEW V1 AS SELECT key, value from src
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@V1
 POSTHOOK: query: -- This test is used for testing EXPLAIN LOGICAL command
 
 -- Create some views
 CREATE VIEW V1 AS SELECT key, value from src
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@V1
 PREHOOK: query: CREATE VIEW V2 AS SELECT ds, key, value FROM srcpart WHERE ds IS NOT NULL
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@srcpart
+PREHOOK: Output: database:default
+PREHOOK: Output: default@V2
 POSTHOOK: query: CREATE VIEW V2 AS SELECT ds, key, value FROM srcpart WHERE ds IS NOT NULL
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@srcpart
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@V2
 PREHOOK: query: CREATE VIEW V3 AS 
   SELECT src1.key, src2.value FROM V2 src1 
@@ -25,6 +31,8 @@ PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
 PREHOOK: Input: default@srcpart
 PREHOOK: Input: default@v2
+PREHOOK: Output: database:default
+PREHOOK: Output: default@V3
 POSTHOOK: query: CREATE VIEW V3 AS 
   SELECT src1.key, src2.value FROM V2 src1 
   JOIN src src2 ON src1.key = src2.key WHERE src1.ds IS NOT NULL
@@ -32,6 +40,7 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Input: default@srcpart
 POSTHOOK: Input: default@v2
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@V3
 PREHOOK: query: CREATE VIEW V4 AS 
   SELECT src1.key, src2.value as value1, src3.value as value2 
@@ -41,6 +50,8 @@ PREHOOK: Input: default@src
 PREHOOK: Input: default@srcpart
 PREHOOK: Input: default@v1
 PREHOOK: Input: default@v2
+PREHOOK: Output: database:default
+PREHOOK: Output: default@V4
 POSTHOOK: query: CREATE VIEW V4 AS 
   SELECT src1.key, src2.value as value1, src3.value as value2 
   FROM V1 src1 JOIN V2 src2 on src1.key = src2.key JOIN src src3 ON src2.key = src3.key
@@ -49,6 +60,7 @@ POSTHOOK: Input: default@src
 POSTHOOK: Input: default@srcpart
 POSTHOOK: Input: default@v1
 POSTHOOK: Input: default@v2
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@V4
 PREHOOK: query: -- Simple select queries, union queries and join queries
 EXPLAIN LOGICAL 
@@ -678,11 +690,14 @@ PREHOOK: query: -- The table should show up in the explain logical even if none
 CREATE VIEW V5 as SELECT * FROM srcpart where ds = '10'
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@srcpart
+PREHOOK: Output: database:default
+PREHOOK: Output: default@V5
 POSTHOOK: query: -- The table should show up in the explain logical even if none
 -- of the partitions are selected.
 CREATE VIEW V5 as SELECT * FROM srcpart where ds = '10'
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@srcpart
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@V5
 PREHOOK: query: EXPLAIN LOGICAL SELECT * FROM V5
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/fileformat_sequencefile.q.out b/ql/src/test/results/clientpositive/fileformat_sequencefile.q.out
index 94a88701ec..44c1030827 100644
--- a/ql/src/test/results/clientpositive/fileformat_sequencefile.q.out
+++ b/ql/src/test/results/clientpositive/fileformat_sequencefile.q.out
@@ -18,7 +18,7 @@ STAGE PLANS:
           columns: key int, value string
           input format: org.apache.hadoop.mapred.SequenceFileInputFormat
           output format: org.apache.hadoop.mapred.SequenceFileOutputFormat
-          name: dest1
+          name: default.dest1
 
 PREHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS
   INPUTFORMAT 'org.apache.hadoop.mapred.SequenceFileInputFormat'
diff --git a/ql/src/test/results/clientpositive/fileformat_text.q.out b/ql/src/test/results/clientpositive/fileformat_text.q.out
index 4815d05bc9..a6f8889294 100644
--- a/ql/src/test/results/clientpositive/fileformat_text.q.out
+++ b/ql/src/test/results/clientpositive/fileformat_text.q.out
@@ -18,7 +18,7 @@ STAGE PLANS:
           columns: key int, value string
           input format: org.apache.hadoop.mapred.TextInputFormat
           output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
-          name: dest1
+          name: default.dest1
 
 PREHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS
   INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat'
diff --git a/ql/src/test/results/clientpositive/global_limit.q.out b/ql/src/test/results/clientpositive/global_limit.q.out
index 31cbeb1247..a4923a34aa 100644
--- a/ql/src/test/results/clientpositive/global_limit.q.out
+++ b/ql/src/test/results/clientpositive/global_limit.q.out
@@ -50,10 +50,13 @@ PREHOOK: query: -- need one file
 create table gl_tgt as select key from gl_src1 limit 1
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@gl_src1
+PREHOOK: Output: database:default
+PREHOOK: Output: default@gl_tgt
 POSTHOOK: query: -- need one file
 create table gl_tgt as select key from gl_src1 limit 1
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@gl_src1
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@gl_tgt
 PREHOOK: query: select * from gl_tgt ORDER BY key ASC
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/groupby_duplicate_key.q.out b/ql/src/test/results/clientpositive/groupby_duplicate_key.q.out
index 2dd4156a31..b468e707f6 100644
--- a/ql/src/test/results/clientpositive/groupby_duplicate_key.q.out
+++ b/ql/src/test/results/clientpositive/groupby_duplicate_key.q.out
@@ -140,7 +140,7 @@ STAGE PLANS:
           input format: org.apache.hadoop.mapred.TextInputFormat
           output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
           serde name: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-          name: dummy
+          name: default.dummy
 
   Stage: Stage-2
     Stats-Aggr Operator
@@ -149,10 +149,13 @@ PREHOOK: query: create table dummy as
 select distinct key, "X" as dummy1, "X" as dummy2 from src tablesample (10 rows)
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@dummy
 POSTHOOK: query: create table dummy as
 select distinct key, "X" as dummy1, "X" as dummy2 from src tablesample (10 rows)
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@dummy
 PREHOOK: query: select key,dummy1,dummy2 from dummy
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/index_auto_empty.q.out b/ql/src/test/results/clientpositive/index_auto_empty.q.out
index 3512fe25d5..50390242dd 100644
--- a/ql/src/test/results/clientpositive/index_auto_empty.q.out
+++ b/ql/src/test/results/clientpositive/index_auto_empty.q.out
@@ -12,12 +12,11 @@ PREHOOK: query: -- Create temp, and populate it with some values in src.
 CREATE TABLE it.temp(key STRING, val STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:it
-PREHOOK: Output: it@it.temp
+PREHOOK: Output: it@temp
 POSTHOOK: query: -- Create temp, and populate it with some values in src.
 CREATE TABLE it.temp(key STRING, val STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:it
-POSTHOOK: Output: it@it.temp
 POSTHOOK: Output: it@temp
 PREHOOK: query: -- Build an index on it.temp.
 CREATE INDEX temp_index ON TABLE it.temp(key) as 'COMPACT' WITH DEFERRED REBUILD
diff --git a/ql/src/test/results/clientpositive/input15.q.out b/ql/src/test/results/clientpositive/input15.q.out
index adfc307e3b..13bdbf21e6 100644
--- a/ql/src/test/results/clientpositive/input15.q.out
+++ b/ql/src/test/results/clientpositive/input15.q.out
@@ -16,7 +16,7 @@ STAGE PLANS:
           input format: org.apache.hadoop.mapred.TextInputFormat
           output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
           serde name: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-          name: TEST15
+          name: default.TEST15
 
 PREHOOK: query: CREATE TABLE TEST15(key INT, value STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/input46.q.out b/ql/src/test/results/clientpositive/input46.q.out
index c2ac3963e5..424056651f 100644
--- a/ql/src/test/results/clientpositive/input46.q.out
+++ b/ql/src/test/results/clientpositive/input46.q.out
@@ -7,34 +7,38 @@ POSTHOOK: Output: database:table_in_database_creation
 PREHOOK: query: create table table_in_database_creation.test1  as select * from src limit 1
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:table_in_database_creation
+PREHOOK: Output: table_in_database_creation@test1
 POSTHOOK: query: create table table_in_database_creation.test1  as select * from src limit 1
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:table_in_database_creation
 POSTHOOK: Output: table_in_database_creation@test1
-PREHOOK: query: create table `table_in_database_creation.test2` as select * from src limit 1
+PREHOOK: query: create table `table_in_database_creation`.`test2` as select * from src limit 1
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
-POSTHOOK: query: create table `table_in_database_creation.test2` as select * from src limit 1
+PREHOOK: Output: database:table_in_database_creation
+PREHOOK: Output: table_in_database_creation@test2
+POSTHOOK: query: create table `table_in_database_creation`.`test2` as select * from src limit 1
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:table_in_database_creation
 POSTHOOK: Output: table_in_database_creation@test2
 PREHOOK: query: create table table_in_database_creation.test3 (a string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:table_in_database_creation
-PREHOOK: Output: table_in_database_creation@table_in_database_creation.test3
+PREHOOK: Output: table_in_database_creation@test3
 POSTHOOK: query: create table table_in_database_creation.test3 (a string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:table_in_database_creation
-POSTHOOK: Output: table_in_database_creation@table_in_database_creation.test3
 POSTHOOK: Output: table_in_database_creation@test3
-PREHOOK: query: create table `table_in_database_creation.test4` (a string)
+PREHOOK: query: create table `table_in_database_creation`.`test4` (a string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:table_in_database_creation
-PREHOOK: Output: table_in_database_creation@table_in_database_creation.test4
-POSTHOOK: query: create table `table_in_database_creation.test4` (a string)
+PREHOOK: Output: table_in_database_creation@test4
+POSTHOOK: query: create table `table_in_database_creation`.`test4` (a string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:table_in_database_creation
-POSTHOOK: Output: table_in_database_creation@table_in_database_creation.test4
 POSTHOOK: Output: table_in_database_creation@test4
 PREHOOK: query: drop database table_in_database_creation cascade
 PREHOOK: type: DROPDATABASE
diff --git a/ql/src/test/results/clientpositive/inputddl1.q.out b/ql/src/test/results/clientpositive/inputddl1.q.out
index e3d21bf464..12d655dec5 100644
--- a/ql/src/test/results/clientpositive/inputddl1.q.out
+++ b/ql/src/test/results/clientpositive/inputddl1.q.out
@@ -15,7 +15,7 @@ STAGE PLANS:
           input format: org.apache.hadoop.mapred.TextInputFormat
           output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
           serde name: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-          name: INPUTDDL1
+          name: default.INPUTDDL1
 
 PREHOOK: query: CREATE TABLE INPUTDDL1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/inputddl2.q.out b/ql/src/test/results/clientpositive/inputddl2.q.out
index f5c36c34f7..3d344d524b 100644
--- a/ql/src/test/results/clientpositive/inputddl2.q.out
+++ b/ql/src/test/results/clientpositive/inputddl2.q.out
@@ -16,7 +16,7 @@ STAGE PLANS:
           output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
           partition columns: ds string, country string
           serde name: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-          name: INPUTDDL2
+          name: default.INPUTDDL2
 
 PREHOOK: query: CREATE TABLE INPUTDDL2(key INT, value STRING) PARTITIONED BY(ds STRING, country STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/inputddl3.q.out b/ql/src/test/results/clientpositive/inputddl3.q.out
index e1ca708b3f..035cbe9d4d 100644
--- a/ql/src/test/results/clientpositive/inputddl3.q.out
+++ b/ql/src/test/results/clientpositive/inputddl3.q.out
@@ -16,7 +16,7 @@ STAGE PLANS:
           input format: org.apache.hadoop.mapred.TextInputFormat
           output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
           serde name: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-          name: INPUTDDL3
+          name: default.INPUTDDL3
 
 PREHOOK: query: CREATE TABLE INPUTDDL3(key INT, value STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/insert1.q.out b/ql/src/test/results/clientpositive/insert1.q.out
index 1486b86ab8..5816a2c7cc 100644
--- a/ql/src/test/results/clientpositive/insert1.q.out
+++ b/ql/src/test/results/clientpositive/insert1.q.out
@@ -217,12 +217,11 @@ POSTHOOK: Output: database:x
 PREHOOK: query: create table x.insert1(key int, value string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:x
-PREHOOK: Output: x@x.insert1
+PREHOOK: Output: x@insert1
 POSTHOOK: query: create table x.insert1(key int, value string) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:x
 POSTHOOK: Output: x@insert1
-POSTHOOK: Output: x@x.insert1
 PREHOOK: query: explain insert into table x.INSERT1 select a.key, a.value from insert2 a WHERE (a.key=-1)
 PREHOOK: type: QUERY
 POSTHOOK: query: explain insert into table x.INSERT1 select a.key, a.value from insert2 a WHERE (a.key=-1)
@@ -635,11 +634,10 @@ POSTHOOK: Output: database:db1
 PREHOOK: query: CREATE TABLE db1.result(col1 STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:db1
-PREHOOK: Output: db1@db1.result
+PREHOOK: Output: db1@result
 POSTHOOK: query: CREATE TABLE db1.result(col1 STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:db1
-POSTHOOK: Output: db1@db1.result
 POSTHOOK: Output: db1@result
 PREHOOK: query: INSERT OVERWRITE TABLE db1.result SELECT 'db1_insert1' FROM src LIMIT 1
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/insert2_overwrite_partitions.q.out b/ql/src/test/results/clientpositive/insert2_overwrite_partitions.q.out
index ee7e1e8860..25c438fa8b 100644
--- a/ql/src/test/results/clientpositive/insert2_overwrite_partitions.q.out
+++ b/ql/src/test/results/clientpositive/insert2_overwrite_partitions.q.out
@@ -13,11 +13,10 @@ POSTHOOK: Output: database:db2
 PREHOOK: query: CREATE TABLE db1.sourceTable (one string,two string) PARTITIONED BY (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:db1
-PREHOOK: Output: db1@db1.sourceTable
+PREHOOK: Output: db1@sourceTable
 POSTHOOK: query: CREATE TABLE db1.sourceTable (one string,two string) PARTITIONED BY (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:db1
-POSTHOOK: Output: db1@db1.sourceTable
 POSTHOOK: Output: db1@sourceTable
 PREHOOK: query: load data local inpath '../../data/files/kv1.txt' INTO TABLE db1.sourceTable partition(ds='2011-11-11')
 PREHOOK: type: LOAD
@@ -39,11 +38,10 @@ POSTHOOK: Output: db1@sourcetable@ds=2011-11-11
 PREHOOK: query: CREATE TABLE db2.destinTable (one string,two string) PARTITIONED BY (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:db2
-PREHOOK: Output: db2@db2.destinTable
+PREHOOK: Output: db2@destinTable
 POSTHOOK: query: CREATE TABLE db2.destinTable (one string,two string) PARTITIONED BY (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:db2
-POSTHOOK: Output: db2@db2.destinTable
 POSTHOOK: Output: db2@destinTable
 PREHOOK: query: EXPLAIN INSERT OVERWRITE TABLE db2.destinTable PARTITION (ds='2011-11-11')
 SELECT one,two FROM db1.sourceTable WHERE ds='2011-11-11' order by one desc, two desc limit 5
diff --git a/ql/src/test/results/clientpositive/join41.q.out b/ql/src/test/results/clientpositive/join41.q.out
index cfb41fd179..b4641808f0 100644
--- a/ql/src/test/results/clientpositive/join41.q.out
+++ b/ql/src/test/results/clientpositive/join41.q.out
@@ -1,9 +1,12 @@
 PREHOOK: query: create table s1 as select * from src where key = 0
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@s1
 POSTHOOK: query: create table s1 as select * from src where key = 0
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@s1
 PREHOOK: query: EXPLAIN
 SELECT * FROM s1 src1 LEFT OUTER JOIN s1 src2 ON (src1.key = src2.key AND src2.key > 10)
diff --git a/ql/src/test/results/clientpositive/join_filters_overlap.q.out b/ql/src/test/results/clientpositive/join_filters_overlap.q.out
index 5ec5e28192..51b408987a 100644
--- a/ql/src/test/results/clientpositive/join_filters_overlap.q.out
+++ b/ql/src/test/results/clientpositive/join_filters_overlap.q.out
@@ -4,12 +4,15 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 create table a as SELECT 100 as key, a.value as value FROM src LATERAL VIEW explode(array(40, 50, 60)) a as value limit 3
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@a
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 -- HIVE-3411 Filter predicates on outer join overlapped on single alias is not handled properly
 
 create table a as SELECT 100 as key, a.value as value FROM src LATERAL VIEW explode(array(40, 50, 60)) a as value limit 3
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@a
 PREHOOK: query: -- overlap on a
 explain extended select * from a left outer join a b on (a.key=b.key AND a.value=50 AND b.value=50) left outer join a c on (a.key=c.key AND a.value=60 AND c.value=60)
diff --git a/ql/src/test/results/clientpositive/join_view.q.out b/ql/src/test/results/clientpositive/join_view.q.out
index 2f4b8c4df8..3e54177251 100644
--- a/ql/src/test/results/clientpositive/join_view.q.out
+++ b/ql/src/test/results/clientpositive/join_view.q.out
@@ -28,12 +28,15 @@ create view v as select invites.bar, invites2.foo, invites2.ds from invites join
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@invites
 PREHOOK: Input: default@invites2
+PREHOOK: Output: database:default
+PREHOOK: Output: default@v
 POSTHOOK: query: -- test join views: see HIVE-1989
 
 create view v as select invites.bar, invites2.foo, invites2.ds from invites join invites2 on invites.ds=invites2.ds
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@invites
 POSTHOOK: Input: default@invites2
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v
 PREHOOK: query: explain select * from v where ds='2011-09-01'
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/lateral_view_noalias.q.out b/ql/src/test/results/clientpositive/lateral_view_noalias.q.out
index 8141d5c473..55e1a4c0a9 100644
--- a/ql/src/test/results/clientpositive/lateral_view_noalias.q.out
+++ b/ql/src/test/results/clientpositive/lateral_view_noalias.q.out
@@ -130,10 +130,13 @@ PREHOOK: query: -- view
 create view lv_noalias as SELECT myTab.* from src LATERAL VIEW explode(map('key1', 100, 'key2', 200)) myTab limit 2
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@lv_noalias
 POSTHOOK: query: -- view
 create view lv_noalias as SELECT myTab.* from src LATERAL VIEW explode(map('key1', 100, 'key2', 200)) myTab limit 2
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@lv_noalias
 PREHOOK: query: explain select * from lv_noalias a join lv_noalias b on a.key=b.key
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/lateral_view_outer.q.out b/ql/src/test/results/clientpositive/lateral_view_outer.q.out
index e39b0f84e4..236c5c363c 100644
--- a/ql/src/test/results/clientpositive/lateral_view_outer.q.out
+++ b/ql/src/test/results/clientpositive/lateral_view_outer.q.out
@@ -185,9 +185,12 @@ POSTHOOK: Input: default@src
 PREHOOK: query: create table array_valued as select key, if (key > 300, array(value, value), null) as value from src
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@array_valued
 POSTHOOK: query: create table array_valued as select key, if (key > 300, array(value, value), null) as value from src
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@array_valued
 PREHOOK: query: explain
 select * from array_valued LATERAL VIEW OUTER explode(value) C AS a limit 10
diff --git a/ql/src/test/results/clientpositive/merge3.q.out b/ql/src/test/results/clientpositive/merge3.q.out
index ad666e21e5..1701be10b2 100644
--- a/ql/src/test/results/clientpositive/merge3.q.out
+++ b/ql/src/test/results/clientpositive/merge3.q.out
@@ -8,6 +8,8 @@ PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 PREHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
 PREHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
+PREHOOK: Output: database:default
+PREHOOK: Output: default@merge_src
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 create table merge_src as
@@ -18,6 +20,7 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@merge_src
 PREHOOK: query: create table merge_src_part (key string, value string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
@@ -196,7 +199,7 @@ STAGE PLANS:
           input format: org.apache.hadoop.mapred.TextInputFormat
           output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
           serde name: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-          name: merge_src2
+          name: default.merge_src2
 
   Stage: Stage-2
     Stats-Aggr Operator
@@ -320,10 +323,13 @@ PREHOOK: query: create table merge_src2 as
 select key, value from merge_src
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@merge_src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@merge_src2
 POSTHOOK: query: create table merge_src2 as 
 select key, value from merge_src
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@merge_src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@merge_src2
 PREHOOK: query: select * from merge_src2
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/multi_insert_lateral_view.q.out b/ql/src/test/results/clientpositive/multi_insert_lateral_view.q.out
index 7d84614b8e..0006ce9106 100644
--- a/ql/src/test/results/clientpositive/multi_insert_lateral_view.q.out
+++ b/ql/src/test/results/clientpositive/multi_insert_lateral_view.q.out
@@ -3,11 +3,14 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 create table src_10 as select * from src limit 10
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@src_10
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 create table src_10 as select * from src limit 10
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@src_10
 PREHOOK: query: create table src_lv1 (key string, value string)
 PREHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/multi_join_union.q.out b/ql/src/test/results/clientpositive/multi_join_union.q.out
index 3e52390a4a..2ed267d420 100644
--- a/ql/src/test/results/clientpositive/multi_join_union.q.out
+++ b/ql/src/test/results/clientpositive/multi_join_union.q.out
@@ -1,30 +1,42 @@
 PREHOOK: query: CREATE TABLE src11 as SELECT * FROM src
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@src11
 POSTHOOK: query: CREATE TABLE src11 as SELECT * FROM src
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@src11
 PREHOOK: query: CREATE TABLE src12 as SELECT * FROM src
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@src12
 POSTHOOK: query: CREATE TABLE src12 as SELECT * FROM src
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@src12
 PREHOOK: query: CREATE TABLE src13 as SELECT * FROM src
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@src13
 POSTHOOK: query: CREATE TABLE src13 as SELECT * FROM src
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@src13
 PREHOOK: query: CREATE TABLE src14 as SELECT * FROM src
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@src14
 POSTHOOK: query: CREATE TABLE src14 as SELECT * FROM src
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@src14
 PREHOOK: query: EXPLAIN SELECT * FROM 
 src11 a JOIN
diff --git a/ql/src/test/results/clientpositive/nestedvirtual.q.out b/ql/src/test/results/clientpositive/nestedvirtual.q.out
index bc0be7c79a..05af502eda 100644
--- a/ql/src/test/results/clientpositive/nestedvirtual.q.out
+++ b/ql/src/test/results/clientpositive/nestedvirtual.q.out
@@ -18,10 +18,13 @@ PREHOOK: query: create table jssarma_nilzma_bad as select a.val, a.filename, a.o
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@pokes
 PREHOOK: Input: default@pokes2
+PREHOOK: Output: database:default
+PREHOOK: Output: default@jssarma_nilzma_bad
 POSTHOOK: query: create table jssarma_nilzma_bad as select a.val, a.filename, a.offset from (select hash(foo) as val, INPUT__FILE__NAME as filename, BLOCK__OFFSET__INSIDE__FILE as  offset from pokes) a join pokes2 b on (a.val = b.foo)
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@pokes
 POSTHOOK: Input: default@pokes2
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@jssarma_nilzma_bad
 PREHOOK: query: drop table jssarma_nilzma_bad
 PREHOOK: type: DROPTABLE
@@ -67,10 +70,13 @@ PREHOOK: query: create table jssarma_nilzma_bad as select a.val, a.filename, a.o
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@pokes
 PREHOOK: Input: default@pokes2
+PREHOOK: Output: database:default
+PREHOOK: Output: default@jssarma_nilzma_bad
 POSTHOOK: query: create table jssarma_nilzma_bad as select a.val, a.filename, a.offset from (select hash(foo) as val, INPUT__FILE__NAME as filename, BLOCK__OFFSET__INSIDE__FILE as  offset from pokes) a join pokes2 b on (a.val = b.foo)
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@pokes
 POSTHOOK: Input: default@pokes2
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@jssarma_nilzma_bad
 PREHOOK: query: drop table jssarma_nilzma_bad
 PREHOOK: type: DROPTABLE
@@ -116,10 +122,13 @@ PREHOOK: query: create table jssarma_nilzma_bad as select a.val, a.filename, a.o
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@pokes
 PREHOOK: Input: default@pokes2
+PREHOOK: Output: database:default
+PREHOOK: Output: default@jssarma_nilzma_bad
 POSTHOOK: query: create table jssarma_nilzma_bad as select a.val, a.filename, a.offset from (select hash(foo) as val, INPUT__FILE__NAME as filename, BLOCK__OFFSET__INSIDE__FILE as  offset from pokes) a join pokes2 b on (a.val = b.foo)
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@pokes
 POSTHOOK: Input: default@pokes2
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@jssarma_nilzma_bad
 PREHOOK: query: drop table jssarma_nilzma_bad
 PREHOOK: type: DROPTABLE
diff --git a/ql/src/test/results/clientpositive/nonmr_fetch.q.out b/ql/src/test/results/clientpositive/nonmr_fetch.q.out
index 2d7496b7c5..48850197ac 100644
--- a/ql/src/test/results/clientpositive/nonmr_fetch.q.out
+++ b/ql/src/test/results/clientpositive/nonmr_fetch.q.out
@@ -1015,7 +1015,7 @@ STAGE PLANS:
           input format: org.apache.hadoop.mapred.TextInputFormat
           output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
           serde name: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-          name: srcx
+          name: default.srcx
 
   Stage: Stage-2
     Stats-Aggr Operator
diff --git a/ql/src/test/results/clientpositive/nullformat.q.out b/ql/src/test/results/clientpositive/nullformat.q.out
index 553b129304..6cfc2b8f13 100644
--- a/ql/src/test/results/clientpositive/nullformat.q.out
+++ b/ql/src/test/results/clientpositive/nullformat.q.out
@@ -53,7 +53,7 @@ STAGE PLANS:
           input format: org.apache.hadoop.mapred.TextInputFormat
           output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
           serde name: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-          name: null_tab1
+          name: default.null_tab1
 
 PREHOOK: query: CREATE TABLE null_tab1(a STRING, b STRING) ROW FORMAT DELIMITED NULL DEFINED AS 'fooNull'
 PREHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/nullformatCTAS.q.out b/ql/src/test/results/clientpositive/nullformatCTAS.q.out
index 1d76a6d293..892de6ede0 100644
--- a/ql/src/test/results/clientpositive/nullformatCTAS.q.out
+++ b/ql/src/test/results/clientpositive/nullformatCTAS.q.out
@@ -97,7 +97,7 @@ STAGE PLANS:
           input format: org.apache.hadoop.mapred.TextInputFormat
           output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
           serde name: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-          name: null_tab3
+          name: default.null_tab3
 
   Stage: Stage-2
     Stats-Aggr Operator
@@ -136,10 +136,13 @@ PREHOOK: query: CREATE TABLE null_tab3 ROW FORMAT DELIMITED NULL DEFINED AS 'foo
    AS SELECT a, b FROM base_tab
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@base_tab
+PREHOOK: Output: database:default
+PREHOOK: Output: default@null_tab3
 POSTHOOK: query: CREATE TABLE null_tab3 ROW FORMAT DELIMITED NULL DEFINED AS 'fooNull'
    AS SELECT a, b FROM base_tab
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@base_tab
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@null_tab3
 PREHOOK: query: DESCRIBE EXTENDED null_tab3
 PREHOOK: type: DESCTABLE
diff --git a/ql/src/test/results/clientpositive/orc_createas1.q.out b/ql/src/test/results/clientpositive/orc_createas1.q.out
index a1044803b7..b0c58dd078 100644
--- a/ql/src/test/results/clientpositive/orc_createas1.q.out
+++ b/ql/src/test/results/clientpositive/orc_createas1.q.out
@@ -105,7 +105,7 @@ STAGE PLANS:
           input format: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
           output format: org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat
           serde name: org.apache.hadoop.hive.ql.io.orc.OrcSerde
-          name: orc_createas1b
+          name: default.orc_createas1b
 
   Stage: Stage-2
     Stats-Aggr Operator
@@ -131,11 +131,14 @@ PREHOOK: query: CREATE TABLE orc_createas1b
     SELECT * FROM src
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@orc_createas1b
 POSTHOOK: query: CREATE TABLE orc_createas1b
     STORED AS ORC AS
     SELECT * FROM src
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@orc_createas1b
 PREHOOK: query: EXPLAIN SELECT * FROM orc_createas1b ORDER BY key LIMIT 5
 PREHOOK: type: QUERY
@@ -261,7 +264,7 @@ STAGE PLANS:
           input format: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
           output format: org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat
           serde name: org.apache.hadoop.hive.ql.io.orc.OrcSerde
-          name: orc_createas1c
+          name: default.orc_createas1c
 
   Stage: Stage-2
     Stats-Aggr Operator
@@ -290,6 +293,8 @@ PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@orc_createas1a
 PREHOOK: Input: default@orc_createas1a@ds=1
 PREHOOK: Input: default@orc_createas1a@ds=2
+PREHOOK: Output: database:default
+PREHOOK: Output: default@orc_createas1c
 POSTHOOK: query: CREATE TABLE orc_createas1c
     STORED AS ORC AS 
         SELECT key, value, PMOD(HASH(key), 50) as part
@@ -298,6 +303,7 @@ POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@orc_createas1a
 POSTHOOK: Input: default@orc_createas1a@ds=1
 POSTHOOK: Input: default@orc_createas1a@ds=2
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@orc_createas1c
 PREHOOK: query: SELECT SUM(HASH(c)) FROM (
     SELECT TRANSFORM(key, value) USING 'tr \t _' AS (c)
diff --git a/ql/src/test/results/clientpositive/parallel_orderby.q.out b/ql/src/test/results/clientpositive/parallel_orderby.q.out
index 2b3c145f24..2f4ac8f999 100644
--- a/ql/src/test/results/clientpositive/parallel_orderby.q.out
+++ b/ql/src/test/results/clientpositive/parallel_orderby.q.out
@@ -76,7 +76,7 @@ STAGE PLANS:
           input format: org.apache.hadoop.mapred.TextInputFormat
           output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
           serde name: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-          name: total_ordered
+          name: default.total_ordered
 
   Stage: Stage-2
     Stats-Aggr Operator
@@ -84,9 +84,12 @@ STAGE PLANS:
 PREHOOK: query: create table total_ordered as select * from src5 order by key, value
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src5
+PREHOOK: Output: database:default
+PREHOOK: Output: default@total_ordered
 POSTHOOK: query: create table total_ordered as select * from src5 order by key, value
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src5
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@total_ordered
 PREHOOK: query: desc formatted total_ordered
 PREHOOK: type: DESCTABLE
@@ -195,9 +198,12 @@ POSTHOOK: Output: default@total_ordered
 PREHOOK: query: create table total_ordered as select * from src5 order by key, value
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src5
+PREHOOK: Output: database:default
+PREHOOK: Output: default@total_ordered
 POSTHOOK: query: create table total_ordered as select * from src5 order by key, value
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src5
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@total_ordered
 PREHOOK: query: desc formatted total_ordered
 PREHOOK: type: DESCTABLE
diff --git a/ql/src/test/results/clientpositive/parquet_ctas.q.out b/ql/src/test/results/clientpositive/parquet_ctas.q.out
index ad3210fc5a..363db53c1a 100644
--- a/ql/src/test/results/clientpositive/parquet_ctas.q.out
+++ b/ql/src/test/results/clientpositive/parquet_ctas.q.out
@@ -39,9 +39,12 @@ POSTHOOK: Lineage: staging.value SIMPLE [(src)src.FieldSchema(name:value, type:s
 PREHOOK: query: create table parquet_ctas stored as parquet as select * from staging
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@staging
+PREHOOK: Output: database:default
+PREHOOK: Output: default@parquet_ctas
 POSTHOOK: query: create table parquet_ctas stored as parquet as select * from staging
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@staging
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@parquet_ctas
 PREHOOK: query: describe parquet_ctas
 PREHOOK: type: DESCTABLE
@@ -72,9 +75,12 @@ POSTHOOK: Input: default@parquet_ctas
 PREHOOK: query: create table parquet_ctas_advanced stored as parquet as select key+1,concat(value,"value") from staging
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@staging
+PREHOOK: Output: database:default
+PREHOOK: Output: default@parquet_ctas_advanced
 POSTHOOK: query: create table parquet_ctas_advanced stored as parquet as select key+1,concat(value,"value") from staging
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@staging
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@parquet_ctas_advanced
 PREHOOK: query: describe parquet_ctas_advanced
 PREHOOK: type: DESCTABLE
@@ -105,9 +111,12 @@ POSTHOOK: Input: default@parquet_ctas_advanced
 PREHOOK: query: create table parquet_ctas_alias stored as parquet as select key+1 as mykey,concat(value,"value") as myvalue from staging
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@staging
+PREHOOK: Output: database:default
+PREHOOK: Output: default@parquet_ctas_alias
 POSTHOOK: query: create table parquet_ctas_alias stored as parquet as select key+1 as mykey,concat(value,"value") as myvalue from staging
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@staging
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@parquet_ctas_alias
 PREHOOK: query: describe parquet_ctas_alias
 PREHOOK: type: DESCTABLE
@@ -138,9 +147,12 @@ POSTHOOK: Input: default@parquet_ctas_alias
 PREHOOK: query: create table parquet_ctas_mixed stored as parquet as select key,key+1,concat(value,"value") as myvalue from staging
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@staging
+PREHOOK: Output: database:default
+PREHOOK: Output: default@parquet_ctas_mixed
 POSTHOOK: query: create table parquet_ctas_mixed stored as parquet as select key,key+1,concat(value,"value") as myvalue from staging
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@staging
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@parquet_ctas_mixed
 PREHOOK: query: describe parquet_ctas_mixed
 PREHOOK: type: DESCTABLE
diff --git a/ql/src/test/results/clientpositive/parquet_join.q.out b/ql/src/test/results/clientpositive/parquet_join.q.out
index f3caae77fa..15524e5a60 100644
--- a/ql/src/test/results/clientpositive/parquet_join.q.out
+++ b/ql/src/test/results/clientpositive/parquet_join.q.out
@@ -39,16 +39,22 @@ POSTHOOK: Lineage: staging.value SIMPLE [(src)src.FieldSchema(name:value, type:s
 PREHOOK: query: create table parquet_jointable1 stored as parquet as select * from staging
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@staging
+PREHOOK: Output: database:default
+PREHOOK: Output: default@parquet_jointable1
 POSTHOOK: query: create table parquet_jointable1 stored as parquet as select * from staging
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@staging
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@parquet_jointable1
 PREHOOK: query: create table parquet_jointable2 stored as parquet as select key,key+1,concat(value,"value") as myvalue from staging
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@staging
+PREHOOK: Output: database:default
+PREHOOK: Output: default@parquet_jointable2
 POSTHOOK: query: create table parquet_jointable2 stored as parquet as select key,key+1,concat(value,"value") as myvalue from staging
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@staging
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@parquet_jointable2
 PREHOOK: query: -- MR join
 
diff --git a/ql/src/test/results/clientpositive/partition_decode_name.q.out b/ql/src/test/results/clientpositive/partition_decode_name.q.out
index 3730f69c0b..e1d06bb8ec 100644
--- a/ql/src/test/results/clientpositive/partition_decode_name.q.out
+++ b/ql/src/test/results/clientpositive/partition_decode_name.q.out
@@ -6,6 +6,8 @@ from (select '2011-01-11', '2011-01-11+14:18:26' from src tablesample (1 rows)
       select '2011-01-11', '2011-01-11+16:18:26' from src tablesample (1 rows) ) s
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@sc
 POSTHOOK: query: create table sc as select * 
 from (select '2011-01-11', '2011-01-11+14:18:26' from src tablesample (1 rows)
       union all 
@@ -14,6 +16,7 @@ from (select '2011-01-11', '2011-01-11+14:18:26' from src tablesample (1 rows)
       select '2011-01-11', '2011-01-11+16:18:26' from src tablesample (1 rows) ) s
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@sc
 PREHOOK: query: create table sc_part (key string) partitioned by (ts string) stored as rcfile
 PREHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/partition_special_char.q.out b/ql/src/test/results/clientpositive/partition_special_char.q.out
index d45d9e4ee9..846f6f81c9 100644
--- a/ql/src/test/results/clientpositive/partition_special_char.q.out
+++ b/ql/src/test/results/clientpositive/partition_special_char.q.out
@@ -6,6 +6,8 @@ from (select '2011-01-11', '2011-01-11+14:18:26' from src tablesample (1 rows)
       select '2011-01-11', '2011-01-11+16:18:26' from src tablesample (1 rows) ) s
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@sc
 POSTHOOK: query: create table sc as select * 
 from (select '2011-01-11', '2011-01-11+14:18:26' from src tablesample (1 rows)
       union all 
@@ -14,6 +16,7 @@ from (select '2011-01-11', '2011-01-11+14:18:26' from src tablesample (1 rows)
       select '2011-01-11', '2011-01-11+16:18:26' from src tablesample (1 rows) ) s
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@sc
 PREHOOK: query: create table sc_part (key string) partitioned by (ts string) stored as rcfile
 PREHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/ppd_field_garbage.q.out b/ql/src/test/results/clientpositive/ppd_field_garbage.q.out
index e99c305362..86eca5bb42 100644
--- a/ql/src/test/results/clientpositive/ppd_field_garbage.q.out
+++ b/ql/src/test/results/clientpositive/ppd_field_garbage.q.out
@@ -11,9 +11,12 @@ POSTHOOK: Output: default@test_issue
 PREHOOK: query: CREATE VIEW v_test_issue AS SELECT fileid, i.user, test_c.user_c.age FROM test_issue LATERAL VIEW explode(infos) info AS i
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@test_issue
+PREHOOK: Output: database:default
+PREHOOK: Output: default@v_test_issue
 POSTHOOK: query: CREATE VIEW v_test_issue AS SELECT fileid, i.user, test_c.user_c.age FROM test_issue LATERAL VIEW explode(infos) info AS i
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@test_issue
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v_test_issue
 PREHOOK: query: -- dummy data
 LOAD DATA LOCAL INPATH '../../data/files/kv1.txt' INTO TABLE test_issue
diff --git a/ql/src/test/results/clientpositive/ppd_union_view.q.out b/ql/src/test/results/clientpositive/ppd_union_view.q.out
index 0c24d3ef38..e41959e8a5 100644
--- a/ql/src/test/results/clientpositive/ppd_union_view.q.out
+++ b/ql/src/test/results/clientpositive/ppd_union_view.q.out
@@ -115,6 +115,8 @@ PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@t1_mapping
 PREHOOK: Input: default@t1_new
 PREHOOK: Input: default@t1_old
+PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
 POSTHOOK: query: create view t1 partitioned on (ds) as
 select * from
 (
@@ -128,6 +130,7 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@t1_mapping
 POSTHOOK: Input: default@t1_new
 POSTHOOK: Input: default@t1_old
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@t1
 PREHOOK: query: explain extended
 select * from t1 where ds = '2011-10-13'
diff --git a/ql/src/test/results/clientpositive/ptf.q.out b/ql/src/test/results/clientpositive/ptf.q.out
index 218245003d..75b2ffe126 100644
--- a/ql/src/test/results/clientpositive/ptf.q.out
+++ b/ql/src/test/results/clientpositive/ptf.q.out
@@ -772,6 +772,8 @@ from part
 group by p_mfgr, p_brand
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@part
+PREHOOK: Output: database:default
+PREHOOK: Output: default@mfgr_price_view
 POSTHOOK: query: -- 16. testViewAsTableInputToPTF
 create view IF NOT EXISTS mfgr_price_view as 
 select p_mfgr, p_brand, 
@@ -780,6 +782,7 @@ from part
 group by p_mfgr, p_brand
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@part
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mfgr_price_view
 PREHOOK: query: select p_mfgr, p_brand, s, 
 sum(s) over w1  as s1
diff --git a/ql/src/test/results/clientpositive/query_result_fileformat.q.out b/ql/src/test/results/clientpositive/query_result_fileformat.q.out
index 014c7a1113..3848bd4507 100644
--- a/ql/src/test/results/clientpositive/query_result_fileformat.q.out
+++ b/ql/src/test/results/clientpositive/query_result_fileformat.q.out
@@ -4,12 +4,15 @@ PREHOOK: query: create table nzhang_test1 stored as sequencefile as select 'key1
 http://asdf' value from src limit 1
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@nzhang_test1
 POSTHOOK: query: create table nzhang_test1 stored as sequencefile as select 'key1' as key, 'value
 1
 
 http://asdf' value from src limit 1
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@nzhang_test1
 PREHOOK: query: select * from nzhang_test1
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/quotedid_basic.q.out b/ql/src/test/results/clientpositive/quotedid_basic.q.out
index 095ad186ea..612a46ec31 100644
--- a/ql/src/test/results/clientpositive/quotedid_basic.q.out
+++ b/ql/src/test/results/clientpositive/quotedid_basic.q.out
@@ -359,12 +359,15 @@ select `x+1```, `y&y`
 from t4 where `x+1``` < '200'
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@t4
+PREHOOK: Output: database:default
+PREHOOK: Output: default@v1
 POSTHOOK: query: -- view
 create view v1 as 
 select `x+1```, `y&y`
 from t4 where `x+1``` < '200'
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@t4
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v1
 PREHOOK: query: select `x+1```, `y&y`, rank() over(partition by `x+1``` order by  `y&y`)
 from v1
diff --git a/ql/src/test/results/clientpositive/rcfile_createas1.q.out b/ql/src/test/results/clientpositive/rcfile_createas1.q.out
index c8d65c9549..cdfa036958 100644
--- a/ql/src/test/results/clientpositive/rcfile_createas1.q.out
+++ b/ql/src/test/results/clientpositive/rcfile_createas1.q.out
@@ -105,7 +105,7 @@ STAGE PLANS:
           input format: org.apache.hadoop.hive.ql.io.RCFileInputFormat
           output format: org.apache.hadoop.hive.ql.io.RCFileOutputFormat
           serde name: org.apache.hadoop.hive.serde2.columnar.ColumnarSerDe
-          name: rcfile_createas1b
+          name: default.rcfile_createas1b
 
   Stage: Stage-2
     Stats-Aggr Operator
@@ -134,6 +134,8 @@ PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@rcfile_createas1a
 PREHOOK: Input: default@rcfile_createas1a@ds=1
 PREHOOK: Input: default@rcfile_createas1a@ds=2
+PREHOOK: Output: database:default
+PREHOOK: Output: default@rcfile_createas1b
 POSTHOOK: query: CREATE TABLE rcfile_createas1b
     STORED AS RCFILE AS 
         SELECT key, value, PMOD(HASH(key), 50) as part
@@ -142,6 +144,7 @@ POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@rcfile_createas1a
 POSTHOOK: Input: default@rcfile_createas1a@ds=1
 POSTHOOK: Input: default@rcfile_createas1a@ds=2
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@rcfile_createas1b
 PREHOOK: query: SELECT SUM(HASH(c)) FROM (
     SELECT TRANSFORM(key, value) USING 'tr \t _' AS (c)
diff --git a/ql/src/test/results/clientpositive/rcfile_default_format.q.out b/ql/src/test/results/clientpositive/rcfile_default_format.q.out
index 243cb7907e..e584c8b327 100644
--- a/ql/src/test/results/clientpositive/rcfile_default_format.q.out
+++ b/ql/src/test/results/clientpositive/rcfile_default_format.q.out
@@ -39,9 +39,12 @@ Storage Desc Params:
 PREHOOK: query: CREATE TABLE rcfile_default_format_ctas AS SELECT key,value FROM src
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@rcfile_default_format_ctas
 POSTHOOK: query: CREATE TABLE rcfile_default_format_ctas AS SELECT key,value FROM src
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@rcfile_default_format_ctas
 PREHOOK: query: DESCRIBE FORMATTED rcfile_default_format_ctas
 PREHOOK: type: DESCTABLE
@@ -134,9 +137,12 @@ Storage Desc Params:
 PREHOOK: query: CREATE TABLE textfile_default_format_ctas AS SELECT key,value FROM rcfile_default_format_ctas
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@rcfile_default_format_ctas
+PREHOOK: Output: database:default
+PREHOOK: Output: default@textfile_default_format_ctas
 POSTHOOK: query: CREATE TABLE textfile_default_format_ctas AS SELECT key,value FROM rcfile_default_format_ctas
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@rcfile_default_format_ctas
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@textfile_default_format_ctas
 PREHOOK: query: DESCRIBE FORMATTED textfile_default_format_ctas
 PREHOOK: type: DESCTABLE
@@ -177,9 +183,12 @@ Storage Desc Params:
 PREHOOK: query: CREATE TABLE rcfile_default_format_ctas_default_serde AS SELECT key,value FROM rcfile_default_format_ctas
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@rcfile_default_format_ctas
+PREHOOK: Output: database:default
+PREHOOK: Output: default@rcfile_default_format_ctas_default_serde
 POSTHOOK: query: CREATE TABLE rcfile_default_format_ctas_default_serde AS SELECT key,value FROM rcfile_default_format_ctas
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@rcfile_default_format_ctas
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@rcfile_default_format_ctas_default_serde
 PREHOOK: query: DESCRIBE FORMATTED rcfile_default_format_ctas_default_serde
 PREHOOK: type: DESCTABLE
@@ -258,9 +267,12 @@ Storage Desc Params:
 PREHOOK: query: CREATE TABLE rcfile_ctas_default_serde STORED AS rcfile AS SELECT key,value FROM rcfile_default_format_ctas
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@rcfile_default_format_ctas
+PREHOOK: Output: database:default
+PREHOOK: Output: default@rcfile_ctas_default_serde
 POSTHOOK: query: CREATE TABLE rcfile_ctas_default_serde STORED AS rcfile AS SELECT key,value FROM rcfile_default_format_ctas
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@rcfile_default_format_ctas
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@rcfile_ctas_default_serde
 PREHOOK: query: DESCRIBE FORMATTED rcfile_ctas_default_serde
 PREHOOK: type: DESCTABLE
diff --git a/ql/src/test/results/clientpositive/sample_islocalmode_hook.q.out b/ql/src/test/results/clientpositive/sample_islocalmode_hook.q.out
index 99bc23b419..39de7fee3b 100644
--- a/ql/src/test/results/clientpositive/sample_islocalmode_hook.q.out
+++ b/ql/src/test/results/clientpositive/sample_islocalmode_hook.q.out
@@ -48,19 +48,25 @@ PREHOOK: Input: default@sih_i_part
 PREHOOK: Input: default@sih_i_part@p=1
 PREHOOK: Input: default@sih_i_part@p=2
 PREHOOK: Input: default@sih_i_part@p=3
+PREHOOK: Output: database:default
+PREHOOK: Output: default@sih_src
 POSTHOOK: query: create table sih_src as select key, value from sih_i_part order by key, value
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@sih_i_part
 POSTHOOK: Input: default@sih_i_part@p=1
 POSTHOOK: Input: default@sih_i_part@p=2
 POSTHOOK: Input: default@sih_i_part@p=3
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@sih_src
 PREHOOK: query: create table sih_src2 as select key, value from sih_src order by key, value
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@sih_src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@sih_src2
 POSTHOOK: query: create table sih_src2 as select key, value from sih_src order by key, value
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@sih_src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@sih_src2
 PREHOOK: query: -- Relaxing hive.exec.mode.local.auto.input.files.max=1.
 -- Hadoop20 will not generate more splits than there are files (one).
diff --git a/ql/src/test/results/clientpositive/semijoin.q.out b/ql/src/test/results/clientpositive/semijoin.q.out
index 68c6bf87ec..a9a9b8699d 100644
--- a/ql/src/test/results/clientpositive/semijoin.q.out
+++ b/ql/src/test/results/clientpositive/semijoin.q.out
@@ -1,9 +1,12 @@
 PREHOOK: query: create table t1 as select cast(key as int) key, value from src where key <= 10
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
 POSTHOOK: query: create table t1 as select cast(key as int) key, value from src where key <= 10
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@t1
 PREHOOK: query: select * from t1 sort by key
 PREHOOK: type: QUERY
@@ -27,9 +30,12 @@ POSTHOOK: Input: default@t1
 PREHOOK: query: create table t2 as select cast(2*key as int) key, value from t1
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@t1
+PREHOOK: Output: database:default
+PREHOOK: Output: default@t2
 POSTHOOK: query: create table t2 as select cast(2*key as int) key, value from t1
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@t1
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@t2
 PREHOOK: query: select * from t2 sort by key
 PREHOOK: type: QUERY
@@ -54,10 +60,13 @@ PREHOOK: query: create table t3 as select * from (select * from t1 union all sel
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@t1
 PREHOOK: Input: default@t2
+PREHOOK: Output: database:default
+PREHOOK: Output: default@t3
 POSTHOOK: query: create table t3 as select * from (select * from t1 union all select * from t2) b
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@t1
 POSTHOOK: Input: default@t2
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@t3
 PREHOOK: query: select * from t3 sort by key, value
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/serde_regex.q.out b/ql/src/test/results/clientpositive/serde_regex.q.out
index 60182b75a9..65eef4f212 100644
--- a/ql/src/test/results/clientpositive/serde_regex.q.out
+++ b/ql/src/test/results/clientpositive/serde_regex.q.out
@@ -45,7 +45,7 @@ STAGE PLANS:
           serde name: org.apache.hadoop.hive.serde2.RegexSerDe
           serde properties:
             input.regex ([^ ]*) ([^ ]*) ([^ ]*) (-|\[[^\]]*\]) ([^ "]*|"[^"]*") (-|[0-9]*) (-|[0-9]*)(?: ([^ "]*|"[^"]*") ([^ "]*|"[^"]*"))?
-          name: serde_regex
+          name: default.serde_regex
 
 PREHOOK: query: CREATE TABLE serde_regex(
   host STRING,
@@ -160,7 +160,7 @@ STAGE PLANS:
           serde name: org.apache.hadoop.hive.serde2.RegexSerDe
           serde properties:
             input.regex ([^ ]*) ([^ ]*)
-          name: serde_regex1
+          name: default.serde_regex1
 
 PREHOOK: query: CREATE TABLE serde_regex1(
   key decimal(38,18),
diff --git a/ql/src/test/results/clientpositive/show_create_table_db_table.q.out b/ql/src/test/results/clientpositive/show_create_table_db_table.q.out
index cf0a88dcbc..495f4b5080 100644
--- a/ql/src/test/results/clientpositive/show_create_table_db_table.q.out
+++ b/ql/src/test/results/clientpositive/show_create_table_db_table.q.out
@@ -17,11 +17,10 @@ tmp_feng
 PREHOOK: query: CREATE TABLE tmp_feng.tmp_showcrt (key string, value int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:tmp_feng
-PREHOOK: Output: tmp_feng@tmp_feng.tmp_showcrt
+PREHOOK: Output: tmp_feng@tmp_showcrt
 POSTHOOK: query: CREATE TABLE tmp_feng.tmp_showcrt (key string, value int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:tmp_feng
-POSTHOOK: Output: tmp_feng@tmp_feng.tmp_showcrt
 POSTHOOK: Output: tmp_feng@tmp_showcrt
 PREHOOK: query: USE default
 PREHOOK: type: SWITCHDATABASE
diff --git a/ql/src/test/results/clientpositive/show_create_table_temp_table.q.out b/ql/src/test/results/clientpositive/show_create_table_temp_table.q.out
index 0d9d0c772c..d98225afa1 100644
--- a/ql/src/test/results/clientpositive/show_create_table_temp_table.q.out
+++ b/ql/src/test/results/clientpositive/show_create_table_temp_table.q.out
@@ -7,12 +7,11 @@ POSTHOOK: Output: database:tmpdb
 PREHOOK: query: create temporary table tmpdb.tmp1 (c1 string, c2 string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:tmpdb
-PREHOOK: Output: tmpdb@tmpdb.tmp1
+PREHOOK: Output: tmpdb@tmp1
 POSTHOOK: query: create temporary table tmpdb.tmp1 (c1 string, c2 string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:tmpdb
 POSTHOOK: Output: tmpdb@tmp1
-POSTHOOK: Output: tmpdb@tmpdb.tmp1
 PREHOOK: query: show create table tmpdb.tmp1
 PREHOOK: type: SHOW_CREATETABLE
 PREHOOK: Input: tmpdb@tmp1
diff --git a/ql/src/test/results/clientpositive/show_create_table_view.q.out b/ql/src/test/results/clientpositive/show_create_table_view.q.out
index 1ee4aa282f..94f33cfce4 100644
--- a/ql/src/test/results/clientpositive/show_create_table_view.q.out
+++ b/ql/src/test/results/clientpositive/show_create_table_view.q.out
@@ -3,11 +3,14 @@ PREHOOK: query: -- Test SHOW CREATE TABLE on a view name.
 CREATE VIEW tmp_copy_src AS SELECT * FROM src
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@tmp_copy_src
 POSTHOOK: query: -- Test SHOW CREATE TABLE on a view name.
 
 CREATE VIEW tmp_copy_src AS SELECT * FROM src
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@tmp_copy_src
 PREHOOK: query: SHOW CREATE TABLE tmp_copy_src
 PREHOOK: type: SHOW_CREATETABLE
diff --git a/ql/src/test/results/clientpositive/skewjoin_noskew.q.out b/ql/src/test/results/clientpositive/skewjoin_noskew.q.out
index 9b937b6eb1..ad9c405d6d 100644
--- a/ql/src/test/results/clientpositive/skewjoin_noskew.q.out
+++ b/ql/src/test/results/clientpositive/skewjoin_noskew.q.out
@@ -147,7 +147,7 @@ STAGE PLANS:
           input format: org.apache.hadoop.mapred.TextInputFormat
           output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
           serde name: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-          name: noskew
+          name: default.noskew
 
   Stage: Stage-3
     Stats-Aggr Operator
@@ -155,9 +155,12 @@ STAGE PLANS:
 PREHOOK: query: create table noskew as select a.* from src a join src b on a.key=b.key order by a.key limit 30
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@noskew
 POSTHOOK: query: create table noskew as select a.* from src a join src b on a.key=b.key order by a.key limit 30
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@noskew
 PREHOOK: query: select * from noskew
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/smb_mapjoin9.q.out b/ql/src/test/results/clientpositive/smb_mapjoin9.q.out
index e39475f970..fcf0a58301 100644
--- a/ql/src/test/results/clientpositive/smb_mapjoin9.q.out
+++ b/ql/src/test/results/clientpositive/smb_mapjoin9.q.out
@@ -352,7 +352,7 @@ STAGE PLANS:
           input format: org.apache.hadoop.mapred.TextInputFormat
           output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
           serde name: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-          name: smb_mapjoin9_results
+          name: default.smb_mapjoin9_results
 
   Stage: Stage-3
     Stats-Aggr Operator
@@ -397,6 +397,8 @@ PREHOOK: Input: default@hive_test_smb_bucket1
 PREHOOK: Input: default@hive_test_smb_bucket1@ds=2010-10-15
 PREHOOK: Input: default@hive_test_smb_bucket2
 PREHOOK: Input: default@hive_test_smb_bucket2@ds=2010-10-15
+PREHOOK: Output: database:default
+PREHOOK: Output: default@smb_mapjoin9_results
 POSTHOOK: query: create table smb_mapjoin9_results as
 SELECT /* + MAPJOIN(b) */ b.key as k1, b.value, b.ds, a.key as k2
 FROM hive_test_smb_bucket1 a JOIN 
@@ -407,6 +409,7 @@ POSTHOOK: Input: default@hive_test_smb_bucket1
 POSTHOOK: Input: default@hive_test_smb_bucket1@ds=2010-10-15
 POSTHOOK: Input: default@hive_test_smb_bucket2
 POSTHOOK: Input: default@hive_test_smb_bucket2@ds=2010-10-15
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@smb_mapjoin9_results
 PREHOOK: query: drop table smb_mapjoin9_results
 PREHOOK: type: DROPTABLE
diff --git a/ql/src/test/results/clientpositive/stats5.q.out b/ql/src/test/results/clientpositive/stats5.q.out
index 6e4820dc4a..484e834787 100644
--- a/ql/src/test/results/clientpositive/stats5.q.out
+++ b/ql/src/test/results/clientpositive/stats5.q.out
@@ -1,9 +1,12 @@
 PREHOOK: query: create table analyze_src as select * from src
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@analyze_src
 POSTHOOK: query: create table analyze_src as select * from src
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@analyze_src
 PREHOOK: query: explain analyze table analyze_src compute statistics
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/stats_counter.q.out b/ql/src/test/results/clientpositive/stats_counter.q.out
index b1d5b8f0a4..e2980e87a9 100644
--- a/ql/src/test/results/clientpositive/stats_counter.q.out
+++ b/ql/src/test/results/clientpositive/stats_counter.q.out
@@ -2,10 +2,13 @@ PREHOOK: query: -- by analyze
 create table dummy1 as select * from src
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@dummy1
 POSTHOOK: query: -- by analyze
 create table dummy1 as select * from src
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@dummy1
 PREHOOK: query: analyze table dummy1 compute statistics
 PREHOOK: type: QUERY
@@ -55,10 +58,13 @@ PREHOOK: query: -- by autogather
 create table dummy2 as select * from src
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@dummy2
 POSTHOOK: query: -- by autogather
 create table dummy2 as select * from src
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@dummy2
 PREHOOK: query: desc formatted dummy2
 PREHOOK: type: DESCTABLE
diff --git a/ql/src/test/results/clientpositive/str_to_map.q.out b/ql/src/test/results/clientpositive/str_to_map.q.out
index a6358dfa9b..2483d5bd7f 100644
--- a/ql/src/test/results/clientpositive/str_to_map.q.out
+++ b/ql/src/test/results/clientpositive/str_to_map.q.out
@@ -187,9 +187,12 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table tbl_s2m as select 'ABC=CC_333=444' as t from src tablesample (3 rows)
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl_s2m
 POSTHOOK: query: create table tbl_s2m as select 'ABC=CC_333=444' as t from src tablesample (3 rows)
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@tbl_s2m
 PREHOOK: query: select str_to_map(t,'_','=')['333'] from tbl_s2m
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/subquery_exists.q.out b/ql/src/test/results/clientpositive/subquery_exists.q.out
index 1dd9cf458d..93e9fd9e70 100644
--- a/ql/src/test/results/clientpositive/subquery_exists.q.out
+++ b/ql/src/test/results/clientpositive/subquery_exists.q.out
@@ -125,6 +125,8 @@ where exists
   where b.value = a.value  and a.key = b.key and a.value > 'val_9')
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@cv1
 POSTHOOK: query: -- view test
 create view cv1 as 
 select * 
@@ -135,6 +137,7 @@ where exists
   where b.value = a.value  and a.key = b.key and a.value > 'val_9')
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cv1
 PREHOOK: query: select * from cv1
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/subquery_exists_having.q.out b/ql/src/test/results/clientpositive/subquery_exists_having.q.out
index 003ae751ef..765e2369bc 100644
--- a/ql/src/test/results/clientpositive/subquery_exists_having.q.out
+++ b/ql/src/test/results/clientpositive/subquery_exists_having.q.out
@@ -320,6 +320,8 @@ having exists
   )
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@cv1
 POSTHOOK: query: -- view test
 create view cv1 as 
 select b.key, count(*) as c
@@ -332,6 +334,7 @@ having exists
   )
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cv1
 PREHOOK: query: select * from cv1
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/subquery_notin.q.out b/ql/src/test/results/clientpositive/subquery_notin.q.out
index 7b8e9749a1..dc6fe7803f 100644
--- a/ql/src/test/results/clientpositive/subquery_notin.q.out
+++ b/ql/src/test/results/clientpositive/subquery_notin.q.out
@@ -1413,22 +1413,28 @@ create view T1_v as
 select key from src where key <'11'
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@T1_v
 POSTHOOK: query: -- null check
 create view T1_v as 
 select key from src where key <'11'
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@T1_v
 PREHOOK: query: create view T2_v as 
 select case when key > '104' then null else key end as key from T1_v
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
 PREHOOK: Input: default@t1_v
+PREHOOK: Output: database:default
+PREHOOK: Output: default@T2_v
 POSTHOOK: query: create view T2_v as 
 select case when key > '104' then null else key end as key from T1_v
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Input: default@t1_v
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@T2_v
 Warning: Shuffle Join JOIN[24][tables = [t1_v, sq_1_notin_nullcheck]] in Stage 'Stage-2:MAPRED' is a cross product
 PREHOOK: query: explain
diff --git a/ql/src/test/results/clientpositive/subquery_views.q.out b/ql/src/test/results/clientpositive/subquery_views.q.out
index 5e33699c28..9844d99840 100644
--- a/ql/src/test/results/clientpositive/subquery_views.q.out
+++ b/ql/src/test/results/clientpositive/subquery_views.q.out
@@ -10,6 +10,8 @@ where exists
   where b.value = a.value  and a.key = b.key and a.value > 'val_9')
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@cv1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 -- exists test
@@ -22,6 +24,7 @@ where exists
   where b.value = a.value  and a.key = b.key and a.value > 'val_9')
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cv1
 PREHOOK: query: select * 
 from cv1 where cv1.key in (select key from cv1 c where c.key > '95')
@@ -51,6 +54,8 @@ where b.key not in
   )
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@cv2
 POSTHOOK: query: -- not in test
 create view cv2 as 
 select * 
@@ -62,6 +67,7 @@ where b.key not in
   )
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cv2
 Warning: Shuffle Join JOIN[42][tables = [b, sq_1_notin_nullcheck]] in Stage 'Stage-5:MAPRED' is a cross product
 Warning: Shuffle Join JOIN[18][tables = [b, sq_1_notin_nullcheck]] in Stage 'Stage-1:MAPRED' is a cross product
@@ -416,6 +422,8 @@ group by key, value
 having count(*) in (select count(*) from src s1 where s1.key > '9' group by s1.key )
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@cv3
 POSTHOOK: query: -- in where + having
 create view cv3 as
 select key, value, count(*) 
@@ -425,6 +433,7 @@ group by key, value
 having count(*) in (select count(*) from src s1 where s1.key > '9' group by s1.key )
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cv3
 PREHOOK: query: select * from cv3
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/symlink_text_input_format.q.out b/ql/src/test/results/clientpositive/symlink_text_input_format.q.out
index 65d9a894e6..f9d517ccbd 100644
--- a/ql/src/test/results/clientpositive/symlink_text_input_format.q.out
+++ b/ql/src/test/results/clientpositive/symlink_text_input_format.q.out
@@ -18,7 +18,7 @@ STAGE PLANS:
           columns: key string, value string
           input format: org.apache.hadoop.hive.ql.io.SymlinkTextInputFormat
           output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
-          name: symlink_text_input_format
+          name: default.symlink_text_input_format
 
 PREHOOK: query: CREATE TABLE symlink_text_input_format (key STRING, value STRING) STORED AS INPUTFORMAT 'org.apache.hadoop.hive.ql.io.SymlinkTextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat'
 PREHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/temp_table.q.out b/ql/src/test/results/clientpositive/temp_table.q.out
index b2dc8b33c5..0fa24dd859 100644
--- a/ql/src/test/results/clientpositive/temp_table.q.out
+++ b/ql/src/test/results/clientpositive/temp_table.q.out
@@ -59,7 +59,7 @@ STAGE PLANS:
 #### A masked pattern was here ####
           output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
           serde name: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-          name: foo
+          name: default.foo
           isTemporary: true
 
   Stage: Stage-2
@@ -98,9 +98,12 @@ STAGE PLANS:
 PREHOOK: query: CREATE TEMPORARY TABLE foo AS SELECT * FROM src WHERE key % 2 = 0
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@foo
 POSTHOOK: query: CREATE TEMPORARY TABLE foo AS SELECT * FROM src WHERE key % 2 = 0
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@foo
 PREHOOK: query: EXPLAIN CREATE TEMPORARY TABLE bar AS SELECT * FROM src WHERE key % 2 = 1
 PREHOOK: type: CREATETABLE_AS_SELECT
@@ -163,7 +166,7 @@ STAGE PLANS:
 #### A masked pattern was here ####
           output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
           serde name: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-          name: bar
+          name: default.bar
           isTemporary: true
 
   Stage: Stage-2
@@ -202,9 +205,12 @@ STAGE PLANS:
 PREHOOK: query: CREATE TEMPORARY TABLE bar AS SELECT * FROM src WHERE key % 2 = 1
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@bar
 POSTHOOK: query: CREATE TEMPORARY TABLE bar AS SELECT * FROM src WHERE key % 2 = 1
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@bar
 PREHOOK: query: DESCRIBE foo
 PREHOOK: type: DESCTABLE
@@ -452,9 +458,12 @@ POSTHOOK: type: SHOWTABLES
 PREHOOK: query: CREATE TEMPORARY TABLE foo AS SELECT * FROM default.foo
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@foo
+PREHOOK: Output: database:two
+PREHOOK: Output: two@foo
 POSTHOOK: query: CREATE TEMPORARY TABLE foo AS SELECT * FROM default.foo
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@foo
+POSTHOOK: Output: database:two
 POSTHOOK: Output: two@foo
 PREHOOK: query: SHOW TABLES
 PREHOOK: type: SHOWTABLES
diff --git a/ql/src/test/results/clientpositive/temp_table_gb1.q.out b/ql/src/test/results/clientpositive/temp_table_gb1.q.out
index eaaf561005..573acce51b 100644
--- a/ql/src/test/results/clientpositive/temp_table_gb1.q.out
+++ b/ql/src/test/results/clientpositive/temp_table_gb1.q.out
@@ -11,9 +11,12 @@ POSTHOOK: Output: default@dest_g2
 PREHOOK: query: CREATE TEMPORARY TABLE src_temp AS SELECT * FROM src
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@src_temp
 POSTHOOK: query: CREATE TEMPORARY TABLE src_temp AS SELECT * FROM src
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@src_temp
 PREHOOK: query: FROM src_temp
 INSERT OVERWRITE TABLE dest_g2 SELECT substr(src_temp.key,1,1), count(DISTINCT substr(src_temp.value,5)), concat(substr(src_temp.key,1,1),sum(substr(src_temp.value,5))) GROUP BY substr(src_temp.key,1,1)
diff --git a/ql/src/test/results/clientpositive/temp_table_join1.q.out b/ql/src/test/results/clientpositive/temp_table_join1.q.out
index 86ce39cf8b..79d5774b62 100644
--- a/ql/src/test/results/clientpositive/temp_table_join1.q.out
+++ b/ql/src/test/results/clientpositive/temp_table_join1.q.out
@@ -1,16 +1,22 @@
 PREHOOK: query: CREATE TABLE src_nontemp AS SELECT * FROM src limit 10
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@src_nontemp
 POSTHOOK: query: CREATE TABLE src_nontemp AS SELECT * FROM src limit 10
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@src_nontemp
 PREHOOK: query: CREATE TEMPORARY TABLE src_temp AS SELECT * FROM src limit 10
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@src_temp
 POSTHOOK: query: CREATE TEMPORARY TABLE src_temp AS SELECT * FROM src limit 10
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@src_temp
 PREHOOK: query: -- Non temp table join
 EXPLAIN
diff --git a/ql/src/test/results/clientpositive/temp_table_names.q.out b/ql/src/test/results/clientpositive/temp_table_names.q.out
index 7c79777404..890ab14867 100644
--- a/ql/src/test/results/clientpositive/temp_table_names.q.out
+++ b/ql/src/test/results/clientpositive/temp_table_names.q.out
@@ -1,12 +1,11 @@
 PREHOOK: query: -- Test temp tables with upper/lower case names
 create temporary table Default.Temp_Table_Names (C1 string, c2 string)
 PREHOOK: type: CREATETABLE
-PREHOOK: Output: Default@Default.Temp_Table_Names
+PREHOOK: Output: Default@Temp_Table_Names
 PREHOOK: Output: database:default
 POSTHOOK: query: -- Test temp tables with upper/lower case names
 create temporary table Default.Temp_Table_Names (C1 string, c2 string)
 POSTHOOK: type: CREATETABLE
-POSTHOOK: Output: Default@Default.Temp_Table_Names
 POSTHOOK: Output: Default@Temp_Table_Names
 POSTHOOK: Output: database:default
 PREHOOK: query: show tables 'Temp_Table*'
diff --git a/ql/src/test/results/clientpositive/temp_table_precedence.q.out b/ql/src/test/results/clientpositive/temp_table_precedence.q.out
index b4b003e18e..2b2e0aa718 100644
--- a/ql/src/test/results/clientpositive/temp_table_precedence.q.out
+++ b/ql/src/test/results/clientpositive/temp_table_precedence.q.out
@@ -8,13 +8,12 @@ PREHOOK: query: -- Create non-temp tables
 create table ttp.tab1 (a1 string, a2 string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:ttp
-PREHOOK: Output: ttp@ttp.tab1
+PREHOOK: Output: ttp@tab1
 POSTHOOK: query: -- Create non-temp tables
 create table ttp.tab1 (a1 string, a2 string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:ttp
 POSTHOOK: Output: ttp@tab1
-POSTHOOK: Output: ttp@ttp.tab1
 PREHOOK: query: insert overwrite table ttp.tab1 select * from src where key = 5 limit 5
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
@@ -47,12 +46,11 @@ POSTHOOK: Input: ttp@tab1
 PREHOOK: query: create table ttp.tab2 (b1 string, b2 string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:ttp
-PREHOOK: Output: ttp@ttp.tab2
+PREHOOK: Output: ttp@tab2
 POSTHOOK: query: create table ttp.tab2 (b1 string, b2 string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:ttp
 POSTHOOK: Output: ttp@tab2
-POSTHOOK: Output: ttp@ttp.tab2
 PREHOOK: query: insert overwrite table ttp.tab2 select * from src where key = 2 limit 5
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
@@ -84,13 +82,12 @@ PREHOOK: query: -- Now create temp table with same name
 create temporary table ttp.tab1 (c1 int, c2 string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:ttp
-PREHOOK: Output: ttp@ttp.tab1
+PREHOOK: Output: ttp@tab1
 POSTHOOK: query: -- Now create temp table with same name
 create temporary table ttp.tab1 (c1 int, c2 string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:ttp
 POSTHOOK: Output: ttp@tab1
-POSTHOOK: Output: ttp@ttp.tab1
 PREHOOK: query: insert overwrite table ttp.tab1 select * from src where key = 0 limit 5
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
diff --git a/ql/src/test/results/clientpositive/temp_table_subquery1.q.out b/ql/src/test/results/clientpositive/temp_table_subquery1.q.out
index 3301890b73..8a9c5371f8 100644
--- a/ql/src/test/results/clientpositive/temp_table_subquery1.q.out
+++ b/ql/src/test/results/clientpositive/temp_table_subquery1.q.out
@@ -1,9 +1,12 @@
 PREHOOK: query: create temporary table src_temp as select * from src
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@src_temp
 POSTHOOK: query: create temporary table src_temp as select * from src
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@src_temp
 PREHOOK: query: -- subquery exists
 select *
diff --git a/ql/src/test/results/clientpositive/tez/cross_product_check_1.q.out b/ql/src/test/results/clientpositive/tez/cross_product_check_1.q.out
index fd7eff98a4..ba8613788e 100644
--- a/ql/src/test/results/clientpositive/tez/cross_product_check_1.q.out
+++ b/ql/src/test/results/clientpositive/tez/cross_product_check_1.q.out
@@ -2,21 +2,27 @@ PREHOOK: query: create table A as
 select * from src
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@A
 POSTHOOK: query: create table A as
 select * from src
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@A
 PREHOOK: query: create table B as
 select * from src
 limit 10
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@B
 POSTHOOK: query: create table B as
 select * from src
 limit 10
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@B
 Warning: Shuffle Join JOIN[4][tables = [a, b]] in Stage 'Reducer 2' is a cross product
 PREHOOK: query: explain select * from A join B
diff --git a/ql/src/test/results/clientpositive/tez/cross_product_check_2.q.out b/ql/src/test/results/clientpositive/tez/cross_product_check_2.q.out
index 7774945de3..21e1a6d1aa 100644
--- a/ql/src/test/results/clientpositive/tez/cross_product_check_2.q.out
+++ b/ql/src/test/results/clientpositive/tez/cross_product_check_2.q.out
@@ -2,21 +2,27 @@ PREHOOK: query: create table A as
 select * from src
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@A
 POSTHOOK: query: create table A as
 select * from src
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@A
 PREHOOK: query: create table B as
 select * from src
 limit 10
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@B
 POSTHOOK: query: create table B as
 select * from src
 limit 10
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@B
 Warning: Map Join MAPJOIN[7][bigTable=a] in task 'Map 2' is a cross product
 PREHOOK: query: explain select * from A join B
diff --git a/ql/src/test/results/clientpositive/tez/ctas.q.out b/ql/src/test/results/clientpositive/tez/ctas.q.out
index 5ff7981326..e1feeac6a3 100644
--- a/ql/src/test/results/clientpositive/tez/ctas.q.out
+++ b/ql/src/test/results/clientpositive/tez/ctas.q.out
@@ -91,7 +91,7 @@ STAGE PLANS:
           input format: org.apache.hadoop.mapred.TextInputFormat
           output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
           serde name: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-          name: nzhang_CTAS1
+          name: default.nzhang_CTAS1
 
   Stage: Stage-3
     Stats-Aggr Operator
@@ -105,9 +105,12 @@ STAGE PLANS:
 PREHOOK: query: create table nzhang_CTAS1 as select key k, value from src sort by k, value limit 10
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@nzhang_CTAS1
 POSTHOOK: query: create table nzhang_CTAS1 as select key k, value from src sort by k, value limit 10
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@nzhang_CTAS1
 PREHOOK: query: select * from nzhang_CTAS1
 PREHOOK: type: QUERY
@@ -236,7 +239,7 @@ STAGE PLANS:
           input format: org.apache.hadoop.mapred.TextInputFormat
           output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
           serde name: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-          name: nzhang_ctas2
+          name: default.nzhang_ctas2
 
   Stage: Stage-3
     Stats-Aggr Operator
@@ -250,9 +253,12 @@ STAGE PLANS:
 PREHOOK: query: create table nzhang_ctas2 as select * from src sort by key, value limit 10
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@nzhang_ctas2
 POSTHOOK: query: create table nzhang_ctas2 as select * from src sort by key, value limit 10
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@nzhang_ctas2
 PREHOOK: query: select * from nzhang_ctas2
 PREHOOK: type: QUERY
@@ -381,7 +387,7 @@ STAGE PLANS:
           input format: org.apache.hadoop.hive.ql.io.RCFileInputFormat
           output format: org.apache.hadoop.hive.ql.io.RCFileOutputFormat
           serde name: org.apache.hadoop.hive.serde2.columnar.ColumnarSerDe
-          name: nzhang_ctas3
+          name: default.nzhang_ctas3
 
   Stage: Stage-3
     Stats-Aggr Operator
@@ -395,9 +401,12 @@ STAGE PLANS:
 PREHOOK: query: create table nzhang_ctas3 row format serde "org.apache.hadoop.hive.serde2.columnar.ColumnarSerDe" stored as RCFile as select key/2 half_key, concat(value, "_con") conb  from src sort by half_key, conb limit 10
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@nzhang_ctas3
 POSTHOOK: query: create table nzhang_ctas3 row format serde "org.apache.hadoop.hive.serde2.columnar.ColumnarSerDe" stored as RCFile as select key/2 half_key, concat(value, "_con") conb  from src sort by half_key, conb limit 10
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@nzhang_ctas3
 PREHOOK: query: select * from nzhang_ctas3
 PREHOOK: type: QUERY
@@ -592,7 +601,7 @@ STAGE PLANS:
           input format: org.apache.hadoop.mapred.TextInputFormat
           output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
           serde name: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-          name: nzhang_ctas4
+          name: default.nzhang_ctas4
 
   Stage: Stage-3
     Stats-Aggr Operator
@@ -606,9 +615,12 @@ STAGE PLANS:
 PREHOOK: query: create table nzhang_ctas4 row format delimited fields terminated by ',' stored as textfile as select key, value from src sort by key, value limit 10
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@nzhang_ctas4
 POSTHOOK: query: create table nzhang_ctas4 row format delimited fields terminated by ',' stored as textfile as select key, value from src sort by key, value limit 10
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@nzhang_ctas4
 PREHOOK: query: select * from nzhang_ctas4
 PREHOOK: type: QUERY
@@ -854,7 +866,7 @@ STAGE PLANS:
 
           output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
           serde name: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-          name: nzhang_ctas5
+          name: default.nzhang_ctas5
 
   Stage: Stage-3
     Stats-Aggr Operator
@@ -869,9 +881,12 @@ STAGE PLANS:
 PREHOOK: query: create table nzhang_ctas5 row format delimited fields terminated by ',' lines terminated by '\012' stored as textfile as select key, value from src sort by key, value limit 10
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@nzhang_ctas5
 POSTHOOK: query: create table nzhang_ctas5 row format delimited fields terminated by ',' lines terminated by '\012' stored as textfile as select key, value from src sort by key, value limit 10
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@nzhang_ctas5
 PREHOOK: query: create table nzhang_ctas6 (key string, `to` string)
 PREHOOK: type: CREATETABLE
@@ -894,7 +909,10 @@ POSTHOOK: Lineage: nzhang_ctas6.to SIMPLE [(src)src.FieldSchema(name:value, type
 PREHOOK: query: create table nzhang_ctas7 as select key, `to` from nzhang_ctas6
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@nzhang_ctas6
+PREHOOK: Output: database:default
+PREHOOK: Output: default@nzhang_ctas7
 POSTHOOK: query: create table nzhang_ctas7 as select key, `to` from nzhang_ctas6
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@nzhang_ctas6
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@nzhang_ctas7
diff --git a/ql/src/test/results/clientpositive/tez/insert1.q.out b/ql/src/test/results/clientpositive/tez/insert1.q.out
index e15b224df0..e3088e0b73 100644
--- a/ql/src/test/results/clientpositive/tez/insert1.q.out
+++ b/ql/src/test/results/clientpositive/tez/insert1.q.out
@@ -143,12 +143,11 @@ POSTHOOK: Output: database:x
 PREHOOK: query: create table x.insert1(key int, value string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:x
-PREHOOK: Output: x@x.insert1
+PREHOOK: Output: x@insert1
 POSTHOOK: query: create table x.insert1(key int, value string) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:x
 POSTHOOK: Output: x@insert1
-POSTHOOK: Output: x@x.insert1
 PREHOOK: query: explain insert into table x.INSERT1 select a.key, a.value from insert2 a WHERE (a.key=-1)
 PREHOOK: type: QUERY
 POSTHOOK: query: explain insert into table x.INSERT1 select a.key, a.value from insert2 a WHERE (a.key=-1)
@@ -406,11 +405,10 @@ POSTHOOK: Output: database:db1
 PREHOOK: query: CREATE TABLE db1.result(col1 STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:db1
-PREHOOK: Output: db1@db1.result
+PREHOOK: Output: db1@result
 POSTHOOK: query: CREATE TABLE db1.result(col1 STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:db1
-POSTHOOK: Output: db1@db1.result
 POSTHOOK: Output: db1@result
 PREHOOK: query: INSERT OVERWRITE TABLE db1.result SELECT 'db1_insert1' FROM src LIMIT 1
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/tez/ptf.q.out b/ql/src/test/results/clientpositive/tez/ptf.q.out
index 218245003d..75b2ffe126 100644
--- a/ql/src/test/results/clientpositive/tez/ptf.q.out
+++ b/ql/src/test/results/clientpositive/tez/ptf.q.out
@@ -772,6 +772,8 @@ from part
 group by p_mfgr, p_brand
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@part
+PREHOOK: Output: database:default
+PREHOOK: Output: default@mfgr_price_view
 POSTHOOK: query: -- 16. testViewAsTableInputToPTF
 create view IF NOT EXISTS mfgr_price_view as 
 select p_mfgr, p_brand, 
@@ -780,6 +782,7 @@ from part
 group by p_mfgr, p_brand
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@part
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mfgr_price_view
 PREHOOK: query: select p_mfgr, p_brand, s, 
 sum(s) over w1  as s1
diff --git a/ql/src/test/results/clientpositive/tez/stats_counter.q.out b/ql/src/test/results/clientpositive/tez/stats_counter.q.out
index b1d5b8f0a4..e2980e87a9 100644
--- a/ql/src/test/results/clientpositive/tez/stats_counter.q.out
+++ b/ql/src/test/results/clientpositive/tez/stats_counter.q.out
@@ -2,10 +2,13 @@ PREHOOK: query: -- by analyze
 create table dummy1 as select * from src
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@dummy1
 POSTHOOK: query: -- by analyze
 create table dummy1 as select * from src
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@dummy1
 PREHOOK: query: analyze table dummy1 compute statistics
 PREHOOK: type: QUERY
@@ -55,10 +58,13 @@ PREHOOK: query: -- by autogather
 create table dummy2 as select * from src
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@dummy2
 POSTHOOK: query: -- by autogather
 create table dummy2 as select * from src
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@dummy2
 PREHOOK: query: desc formatted dummy2
 PREHOOK: type: DESCTABLE
diff --git a/ql/src/test/results/clientpositive/tez/subquery_exists.q.out b/ql/src/test/results/clientpositive/tez/subquery_exists.q.out
index d90d1dc329..654563dade 100644
--- a/ql/src/test/results/clientpositive/tez/subquery_exists.q.out
+++ b/ql/src/test/results/clientpositive/tez/subquery_exists.q.out
@@ -133,6 +133,8 @@ where exists
   where b.value = a.value  and a.key = b.key and a.value > 'val_9')
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@cv1
 POSTHOOK: query: -- view test
 create view cv1 as 
 select * 
@@ -143,6 +145,7 @@ where exists
   where b.value = a.value  and a.key = b.key and a.value > 'val_9')
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cv1
 PREHOOK: query: select * from cv1
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/tez/temp_table.q.out b/ql/src/test/results/clientpositive/tez/temp_table.q.out
index eba40b5ae0..53445df339 100644
--- a/ql/src/test/results/clientpositive/tez/temp_table.q.out
+++ b/ql/src/test/results/clientpositive/tez/temp_table.q.out
@@ -46,7 +46,7 @@ STAGE PLANS:
 #### A masked pattern was here ####
           output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
           serde name: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-          name: foo
+          name: default.foo
           isTemporary: true
 
   Stage: Stage-3
@@ -61,9 +61,12 @@ STAGE PLANS:
 PREHOOK: query: CREATE TEMPORARY TABLE foo AS SELECT * FROM src WHERE key % 2 = 0
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@foo
 POSTHOOK: query: CREATE TEMPORARY TABLE foo AS SELECT * FROM src WHERE key % 2 = 0
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@foo
 PREHOOK: query: EXPLAIN CREATE TEMPORARY TABLE bar AS SELECT * FROM src WHERE key % 2 = 1
 PREHOOK: type: CREATETABLE_AS_SELECT
@@ -113,7 +116,7 @@ STAGE PLANS:
 #### A masked pattern was here ####
           output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
           serde name: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-          name: bar
+          name: default.bar
           isTemporary: true
 
   Stage: Stage-3
@@ -128,9 +131,12 @@ STAGE PLANS:
 PREHOOK: query: CREATE TEMPORARY TABLE bar AS SELECT * FROM src WHERE key % 2 = 1
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@bar
 POSTHOOK: query: CREATE TEMPORARY TABLE bar AS SELECT * FROM src WHERE key % 2 = 1
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@bar
 PREHOOK: query: DESCRIBE foo
 PREHOOK: type: DESCTABLE
@@ -378,9 +384,12 @@ POSTHOOK: type: SHOWTABLES
 PREHOOK: query: CREATE TEMPORARY TABLE foo AS SELECT * FROM default.foo
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@foo
+PREHOOK: Output: database:two
+PREHOOK: Output: two@foo
 POSTHOOK: query: CREATE TEMPORARY TABLE foo AS SELECT * FROM default.foo
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@foo
+POSTHOOK: Output: database:two
 POSTHOOK: Output: two@foo
 PREHOOK: query: SHOW TABLES
 PREHOOK: type: SHOWTABLES
diff --git a/ql/src/test/results/clientpositive/tez/tez_dml.q.out b/ql/src/test/results/clientpositive/tez/tez_dml.q.out
index 625ce0e5c8..5aa56317dd 100644
--- a/ql/src/test/results/clientpositive/tez/tez_dml.q.out
+++ b/ql/src/test/results/clientpositive/tez/tez_dml.q.out
@@ -82,7 +82,7 @@ STAGE PLANS:
           input format: org.apache.hadoop.mapred.TextInputFormat
           output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
           serde name: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-          name: tmp_src
+          name: default.tmp_src
 
   Stage: Stage-3
     Stats-Aggr Operator
@@ -96,9 +96,12 @@ STAGE PLANS:
 PREHOOK: query: CREATE TABLE tmp_src AS SELECT * FROM (SELECT value, count(value) AS cnt FROM src GROUP BY value) f1 ORDER BY cnt
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@tmp_src
 POSTHOOK: query: CREATE TABLE tmp_src AS SELECT * FROM (SELECT value, count(value) AS cnt FROM src GROUP BY value) f1 ORDER BY cnt
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@tmp_src
 PREHOOK: query: SELECT * FROM tmp_src
 PREHOOK: type: QUERY
@@ -1478,10 +1481,13 @@ PREHOOK: query: -- create empty table
 CREATE TABLE empty STORED AS orc AS SELECT * FROM tmp_src_part WHERE d = -1000
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@tmp_src_part
+PREHOOK: Output: database:default
+PREHOOK: Output: default@empty
 POSTHOOK: query: -- create empty table
 CREATE TABLE empty STORED AS orc AS SELECT * FROM tmp_src_part WHERE d = -1000
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@tmp_src_part
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@empty
 PREHOOK: query: SELECT * FROM empty
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/tez/tez_union.q.out b/ql/src/test/results/clientpositive/tez/tez_union.q.out
index 0fc9b78d39..7f94016174 100644
--- a/ql/src/test/results/clientpositive/tez/tez_union.q.out
+++ b/ql/src/test/results/clientpositive/tez/tez_union.q.out
@@ -92,12 +92,15 @@ UNION  ALL
 select s2.key as key, s2.value as value from src s2
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@ut
 POSTHOOK: query: create table ut as
 select s1.key as key, s1.value as value from src s1 join src s3 on s1.key=s3.key
 UNION  ALL  
 select s2.key as key, s2.value as value from src s2
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@ut
 PREHOOK: query: select * from ut order by key, value limit 20
 PREHOOK: type: QUERY
@@ -268,12 +271,15 @@ select count(*) as cnt from (select u1.key as k1, u2.key as k2 from
 u as u1 join u as u2 on (u1.key = u2.key)) a
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@ut
 POSTHOOK: query: create table ut as
 with u as (select * from src union all select * from src)
 select count(*) as cnt from (select u1.key as k1, u2.key as k2 from
 u as u1 join u as u2 on (u1.key = u2.key)) a
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@ut
 PREHOOK: query: select * from ut order by cnt limit 20
 PREHOOK: type: QUERY
@@ -401,12 +407,15 @@ src s1
 join (select * from src union all select * from src) u1 on s1.key = u1.key
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@ut
 POSTHOOK: query: create table ut as
 select s1.key as skey, u1.key as ukey from
 src s1
 join (select * from src union all select * from src) u1 on s1.key = u1.key
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@ut
 PREHOOK: query: select * from ut order by skey, ukey limit 20
 PREHOOK: type: QUERY
@@ -708,6 +717,8 @@ join src s8 on (u1.key = s8.key)
 order by lkey
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@ut
 POSTHOOK: query: create table ut as
 select s1.key as skey, u1.key as ukey, s8.key as lkey from 
 src s1
@@ -718,6 +729,7 @@ join src s8 on (u1.key = s8.key)
 order by lkey
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@ut
 PREHOOK: query: select * from ut order by skey, ukey, lkey limit 100
 PREHOOK: type: QUERY
@@ -951,11 +963,14 @@ select s2.key as key from src s2 join src s3 on s2.key = s3.key
 union all select s4.key from src s4 join src s5 on s4.key = s5.key
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@ut
 POSTHOOK: query: create table ut as
 select s2.key as key from src s2 join src s3 on s2.key = s3.key
 union all select s4.key from src s4 join src s5 on s4.key = s5.key
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@ut
 PREHOOK: query: select * from ut order by key limit 30
 PREHOOK: type: QUERY
@@ -1190,12 +1205,15 @@ select u.key as ukey, s.key as skey from
 right outer join src s on u.key = s.key
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@ut
 POSTHOOK: query: create table ut as
 select u.key as ukey, s.key as skey from
 (select * from src union all select * from src) u
 right outer join src s on u.key = s.key
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@ut
 PREHOOK: query: select * from ut order by ukey, skey limit 20
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/tez/vector_decimal_aggregate.q.out b/ql/src/test/results/clientpositive/tez/vector_decimal_aggregate.q.out
index d6b80b3ee6..5a3aac19ff 100644
--- a/ql/src/test/results/clientpositive/tez/vector_decimal_aggregate.q.out
+++ b/ql/src/test/results/clientpositive/tez/vector_decimal_aggregate.q.out
@@ -5,6 +5,8 @@ PREHOOK: query: CREATE TABLE decimal_vgby STORED AS ORC AS
 	FROM alltypesorc
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@alltypesorc
+PREHOOK: Output: database:default
+PREHOOK: Output: default@decimal_vgby
 POSTHOOK: query: CREATE TABLE decimal_vgby STORED AS ORC AS 
 	SELECT cdouble, CAST (((cdouble*22.1)/37) AS DECIMAL(20,10)) AS cdecimal1, 
 	CAST (((cdouble*9.3)/13) AS DECIMAL(23,14)) AS cdecimal2,
@@ -12,6 +14,7 @@ POSTHOOK: query: CREATE TABLE decimal_vgby STORED AS ORC AS
 	FROM alltypesorc
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@alltypesorc
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@decimal_vgby
 PREHOOK: query: EXPLAIN SELECT cint,
 	COUNT(cdecimal1), MAX(cdecimal1), MIN(cdecimal1), SUM(cdecimal1), AVG(cdecimal1), STDDEV_POP(cdecimal1), STDDEV_SAMP(cdecimal1),
diff --git a/ql/src/test/results/clientpositive/tez/vectorized_ptf.q.out b/ql/src/test/results/clientpositive/tez/vectorized_ptf.q.out
index 88f9e5f9dc..982e8ba4e4 100644
--- a/ql/src/test/results/clientpositive/tez/vectorized_ptf.q.out
+++ b/ql/src/test/results/clientpositive/tez/vectorized_ptf.q.out
@@ -4633,6 +4633,8 @@ from part
 group by p_mfgr, p_brand
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@part
+PREHOOK: Output: database:default
+PREHOOK: Output: default@mfgr_price_view
 POSTHOOK: query: -- 16. testViewAsTableInputToPTF
 create view IF NOT EXISTS mfgr_price_view as 
 select p_mfgr, p_brand, 
@@ -4641,6 +4643,7 @@ from part
 group by p_mfgr, p_brand
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@part
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mfgr_price_view
 PREHOOK: query: explain extended
 select p_mfgr, p_brand, s, 
diff --git a/ql/src/test/results/clientpositive/touch.q.out b/ql/src/test/results/clientpositive/touch.q.out
index 7abec01819..c239715299 100644
--- a/ql/src/test/results/clientpositive/touch.q.out
+++ b/ql/src/test/results/clientpositive/touch.q.out
@@ -7,11 +7,10 @@ POSTHOOK: Output: database:tc
 PREHOOK: query: create table tc.tstsrc like default.src
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:tc
-PREHOOK: Output: tc@tc.tstsrc
+PREHOOK: Output: tc@tstsrc
 POSTHOOK: query: create table tc.tstsrc like default.src
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:tc
-POSTHOOK: Output: tc@tc.tstsrc
 POSTHOOK: Output: tc@tstsrc
 PREHOOK: query: insert overwrite table tc.tstsrc select key, value from default.src
 PREHOOK: type: QUERY
@@ -26,11 +25,10 @@ POSTHOOK: Lineage: tstsrc.value SIMPLE [(src)src.FieldSchema(name:value, type:st
 PREHOOK: query: create table tc.tstsrcpart like default.srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:tc
-PREHOOK: Output: tc@tc.tstsrcpart
+PREHOOK: Output: tc@tstsrcpart
 POSTHOOK: query: create table tc.tstsrcpart like default.srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:tc
-POSTHOOK: Output: tc@tc.tstsrcpart
 POSTHOOK: Output: tc@tstsrcpart
 PREHOOK: query: insert overwrite table tc.tstsrcpart partition (ds='2008-04-08', hr='12')
 select key, value from default.srcpart where ds='2008-04-08' and hr='12'
diff --git a/ql/src/test/results/clientpositive/union24.q.out b/ql/src/test/results/clientpositive/union24.q.out
index 76c1adbcaa..77ae018168 100644
--- a/ql/src/test/results/clientpositive/union24.q.out
+++ b/ql/src/test/results/clientpositive/union24.q.out
@@ -3,32 +3,44 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 create table src2 as select key, count(1) as count from src group by key
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@src2
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 create table src2 as select key, count(1) as count from src group by key
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@src2
 PREHOOK: query: create table src3 as select * from src2
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src2
+PREHOOK: Output: database:default
+PREHOOK: Output: default@src3
 POSTHOOK: query: create table src3 as select * from src2
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src2
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@src3
 PREHOOK: query: create table src4 as select * from src2
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src2
+PREHOOK: Output: database:default
+PREHOOK: Output: default@src4
 POSTHOOK: query: create table src4 as select * from src2
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src2
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@src4
 PREHOOK: query: create table src5 as select * from src2
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src2
+PREHOOK: Output: database:default
+PREHOOK: Output: default@src5
 POSTHOOK: query: create table src5 as select * from src2
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src2
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@src5
 PREHOOK: query: explain extended
 select s.key, s.count from (
diff --git a/ql/src/test/results/clientpositive/union25.q.out b/ql/src/test/results/clientpositive/union25.q.out
index 5be298e945..01f4fcc550 100644
--- a/ql/src/test/results/clientpositive/union25.q.out
+++ b/ql/src/test/results/clientpositive/union25.q.out
@@ -210,7 +210,7 @@ STAGE PLANS:
           input format: org.apache.hadoop.mapred.TextInputFormat
           output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
           serde name: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-          name: tmp_unionall
+          name: default.tmp_unionall
 
   Stage: Stage-3
     Stats-Aggr Operator
diff --git a/ql/src/test/results/clientpositive/union27.q.out b/ql/src/test/results/clientpositive/union27.q.out
index 99cfa6f91b..da37707c97 100644
--- a/ql/src/test/results/clientpositive/union27.q.out
+++ b/ql/src/test/results/clientpositive/union27.q.out
@@ -2,24 +2,33 @@ PREHOOK: query: -- SORT_BEFORE_DIFF
 create table jackson_sev_same as select * from src
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@jackson_sev_same
 POSTHOOK: query: -- SORT_BEFORE_DIFF
 create table jackson_sev_same as select * from src
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@jackson_sev_same
 PREHOOK: query: create table dim_pho as select * from src
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@dim_pho
 POSTHOOK: query: create table dim_pho as select * from src
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@dim_pho
 PREHOOK: query: create table jackson_sev_add as select * from src
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@jackson_sev_add
 POSTHOOK: query: create table jackson_sev_add as select * from src
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@jackson_sev_add
 PREHOOK: query: explain select b.* from jackson_sev_same a join (select * from dim_pho union all select * from jackson_sev_add)b on a.key=b.key and b.key=97
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/union31.q.out b/ql/src/test/results/clientpositive/union31.q.out
index 97bb535bba..faf17f455a 100644
--- a/ql/src/test/results/clientpositive/union31.q.out
+++ b/ql/src/test/results/clientpositive/union31.q.out
@@ -13,16 +13,22 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table t1 as select * from src where key < 10
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
 POSTHOOK: query: create table t1 as select * from src where key < 10
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@t1
 PREHOOK: query: create table t2 as select * from src where key < 10
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@t2
 POSTHOOK: query: create table t2 as select * from src where key < 10
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@t2
 PREHOOK: query: create table t3(key string, cnt int)
 PREHOOK: type: CREATETABLE
@@ -598,16 +604,22 @@ POSTHOOK: Output: default@t2
 PREHOOK: query: create table t1 as select * from src where key < 10
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
 POSTHOOK: query: create table t1 as select * from src where key < 10
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@t1
 PREHOOK: query: create table t2 as select key, count(1) as cnt from src where key < 10 group by key
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@t2
 POSTHOOK: query: create table t2 as select key, count(1) as cnt from src where key < 10 group by key
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@t2
 PREHOOK: query: create table t7(c1 string, cnt int)
 PREHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/union32.q.out b/ql/src/test/results/clientpositive/union32.q.out
index b353db9f73..046a9fc9ed 100644
--- a/ql/src/test/results/clientpositive/union32.q.out
+++ b/ql/src/test/results/clientpositive/union32.q.out
@@ -6,6 +6,8 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE t1 AS SELECT * FROM src WHERE key < 10
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 -- This tests various union queries which have columns on one side of the query
@@ -14,13 +16,17 @@ POSTHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE t1 AS SELECT * FROM src WHERE key < 10
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@t1
 PREHOOK: query: CREATE TABLE t2 AS SELECT * FROM src WHERE key < 10
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@t2
 POSTHOOK: query: CREATE TABLE t2 AS SELECT * FROM src WHERE key < 10
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@t2
 PREHOOK: query: -- Test simple union with double
 EXPLAIN
diff --git a/ql/src/test/results/clientpositive/union_top_level.q.out b/ql/src/test/results/clientpositive/union_top_level.q.out
index 10694b2556..1799d9d76c 100644
--- a/ql/src/test/results/clientpositive/union_top_level.q.out
+++ b/ql/src/test/results/clientpositive/union_top_level.q.out
@@ -580,7 +580,7 @@ STAGE PLANS:
           input format: org.apache.hadoop.mapred.TextInputFormat
           output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
           serde name: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-          name: union_top
+          name: default.union_top
 
   Stage: Stage-3
     Stats-Aggr Operator
@@ -693,6 +693,8 @@ union all
 select key, 2 as value from src where key % 3 == 2 limit 3
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@union_top
 POSTHOOK: query: create table union_top as
 select key, 0 as value from src where key % 3 == 0 limit 3
 union all
@@ -701,6 +703,7 @@ union all
 select key, 2 as value from src where key % 3 == 2 limit 3
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@union_top
 PREHOOK: query: select * from union_top
 PREHOOK: type: QUERY
@@ -1305,7 +1308,7 @@ union all
 select `src`.`key`, 1 as `value` from `default`.`src` where `src`.`key` % 3 == 1 limit 3
 union all
 select `src`.`key`, 2 as `value` from `default`.`src` where `src`.`key` % 3 == 2 limit 3
-          name: union_top_view
+          name: default.union_top_view
           original text: select key, 0 as value from src where key % 3 == 0 limit 3
 union all
 select key, 1 as value from src where key % 3 == 1 limit 3
@@ -1320,6 +1323,8 @@ union all
 select key, 2 as value from src where key % 3 == 2 limit 3
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@union_top_view
 POSTHOOK: query: create view union_top_view as
 select key, 0 as value from src where key % 3 == 0 limit 3
 union all
@@ -1328,6 +1333,7 @@ union all
 select key, 2 as value from src where key % 3 == 2 limit 3
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@union_top_view
 PREHOOK: query: select * from union_top_view
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/unset_table_view_property.q.out b/ql/src/test/results/clientpositive/unset_table_view_property.q.out
index 92dfadb1fe..8249246983 100644
--- a/ql/src/test/results/clientpositive/unset_table_view_property.q.out
+++ b/ql/src/test/results/clientpositive/unset_table_view_property.q.out
@@ -7,12 +7,11 @@ POSTHOOK: Output: database:vt
 PREHOOK: query: CREATE TABLE vt.testTable(col1 INT, col2 INT)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:vt
-PREHOOK: Output: vt@vt.testTable
+PREHOOK: Output: vt@testTable
 POSTHOOK: query: CREATE TABLE vt.testTable(col1 INT, col2 INT)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:vt
 POSTHOOK: Output: vt@testTable
-POSTHOOK: Output: vt@vt.testTable
 PREHOOK: query: SHOW TBLPROPERTIES vt.testTable
 PREHOOK: type: SHOW_TBLPROPERTIES
 POSTHOOK: query: SHOW TBLPROPERTIES vt.testTable
@@ -207,10 +206,13 @@ PREHOOK: query: -- UNSET VIEW PROPERTIES
 CREATE VIEW vt.testView AS SELECT value FROM src WHERE key=86
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
+PREHOOK: Output: database:vt
+PREHOOK: Output: vt@testView
 POSTHOOK: query: -- UNSET VIEW PROPERTIES
 CREATE VIEW vt.testView AS SELECT value FROM src WHERE key=86
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:vt
 POSTHOOK: Output: vt@testView
 PREHOOK: query: ALTER VIEW vt.testView SET TBLPROPERTIES ('propA'='100', 'propB'='200')
 PREHOOK: type: ALTERVIEW_PROPERTIES
diff --git a/ql/src/test/results/clientpositive/updateAccessTime.q.out b/ql/src/test/results/clientpositive/updateAccessTime.q.out
index 08d697c5fd..104e155c08 100644
--- a/ql/src/test/results/clientpositive/updateAccessTime.q.out
+++ b/ql/src/test/results/clientpositive/updateAccessTime.q.out
@@ -5,9 +5,12 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table tstsrc as select * from src
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@tstsrc
 POSTHOOK: query: create table tstsrc as select * from src
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@tstsrc
 PREHOOK: query: desc extended tstsrc
 PREHOOK: type: DESCTABLE
diff --git a/ql/src/test/results/clientpositive/varchar_nested_types.q.out b/ql/src/test/results/clientpositive/varchar_nested_types.q.out
index 55bd96702e..1cd232aad2 100644
--- a/ql/src/test/results/clientpositive/varchar_nested_types.q.out
+++ b/ql/src/test/results/clientpositive/varchar_nested_types.q.out
@@ -164,11 +164,14 @@ create table varchar_nested_cta as
   select * from varchar_nested_struct
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@varchar_nested_struct
+PREHOOK: Output: database:default
+PREHOOK: Output: default@varchar_nested_cta
 POSTHOOK: query: -- nested type with create table as
 create table varchar_nested_cta as 
   select * from varchar_nested_struct
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@varchar_nested_struct
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@varchar_nested_cta
 PREHOOK: query: describe varchar_nested_cta
 PREHOOK: type: DESCTABLE
@@ -191,11 +194,14 @@ create table varchar_nested_view as
   select * from varchar_nested_struct
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@varchar_nested_struct
+PREHOOK: Output: database:default
+PREHOOK: Output: default@varchar_nested_view
 POSTHOOK: query: -- nested type with view
 create table varchar_nested_view as 
   select * from varchar_nested_struct
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@varchar_nested_struct
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@varchar_nested_view
 PREHOOK: query: describe varchar_nested_view
 PREHOOK: type: DESCTABLE
diff --git a/ql/src/test/results/clientpositive/vector_between_in.q.out b/ql/src/test/results/clientpositive/vector_between_in.q.out
index e7b64e244a..631ac19521 100644
--- a/ql/src/test/results/clientpositive/vector_between_in.q.out
+++ b/ql/src/test/results/clientpositive/vector_between_in.q.out
@@ -1,9 +1,12 @@
 PREHOOK: query: CREATE TABLE decimal_date_test STORED AS ORC AS SELECT cdouble, CAST (((cdouble*22.1)/37) AS DECIMAL(20,10)) AS cdecimal1, CAST (((cdouble*9.3)/13) AS DECIMAL(23,14)) AS cdecimal2, CAST(CAST((CAST(cint AS BIGINT) *ctinyint) AS TIMESTAMP) AS DATE) AS cdate FROM alltypesorc ORDER BY cdate
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@alltypesorc
+PREHOOK: Output: database:default
+PREHOOK: Output: default@decimal_date_test
 POSTHOOK: query: CREATE TABLE decimal_date_test STORED AS ORC AS SELECT cdouble, CAST (((cdouble*22.1)/37) AS DECIMAL(20,10)) AS cdecimal1, CAST (((cdouble*9.3)/13) AS DECIMAL(23,14)) AS cdecimal2, CAST(CAST((CAST(cint AS BIGINT) *ctinyint) AS TIMESTAMP) AS DATE) AS cdate FROM alltypesorc ORDER BY cdate
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@alltypesorc
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@decimal_date_test
 PREHOOK: query: EXPLAIN SELECT cdate FROM decimal_date_test WHERE cdate IN (CAST("1969-10-26" AS DATE), CAST("1969-07-14" AS DATE)) ORDER BY cdate
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/vector_decimal_aggregate.q.out b/ql/src/test/results/clientpositive/vector_decimal_aggregate.q.out
index 874836d168..c412782a80 100644
--- a/ql/src/test/results/clientpositive/vector_decimal_aggregate.q.out
+++ b/ql/src/test/results/clientpositive/vector_decimal_aggregate.q.out
@@ -5,6 +5,8 @@ PREHOOK: query: CREATE TABLE decimal_vgby STORED AS ORC AS
 	FROM alltypesorc
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@alltypesorc
+PREHOOK: Output: database:default
+PREHOOK: Output: default@decimal_vgby
 POSTHOOK: query: CREATE TABLE decimal_vgby STORED AS ORC AS 
 	SELECT cdouble, CAST (((cdouble*22.1)/37) AS DECIMAL(20,10)) AS cdecimal1, 
 	CAST (((cdouble*9.3)/13) AS DECIMAL(23,14)) AS cdecimal2,
@@ -12,6 +14,7 @@ POSTHOOK: query: CREATE TABLE decimal_vgby STORED AS ORC AS
 	FROM alltypesorc
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@alltypesorc
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@decimal_vgby
 PREHOOK: query: EXPLAIN SELECT cint,
 	COUNT(cdecimal1), MAX(cdecimal1), MIN(cdecimal1), SUM(cdecimal1), AVG(cdecimal1), STDDEV_POP(cdecimal1), STDDEV_SAMP(cdecimal1),
diff --git a/ql/src/test/results/clientpositive/vector_decimal_expressions.q.out b/ql/src/test/results/clientpositive/vector_decimal_expressions.q.out
index def9f8d89e..ca94561451 100644
--- a/ql/src/test/results/clientpositive/vector_decimal_expressions.q.out
+++ b/ql/src/test/results/clientpositive/vector_decimal_expressions.q.out
@@ -1,9 +1,12 @@
 PREHOOK: query: CREATE TABLE decimal_test STORED AS ORC AS SELECT cdouble, CAST (((cdouble*22.1)/37) AS DECIMAL(20,10)) AS cdecimal1, CAST (((cdouble*9.3)/13) AS DECIMAL(23,14)) AS cdecimal2 FROM alltypesorc
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@alltypesorc
+PREHOOK: Output: database:default
+PREHOOK: Output: default@decimal_test
 POSTHOOK: query: CREATE TABLE decimal_test STORED AS ORC AS SELECT cdouble, CAST (((cdouble*22.1)/37) AS DECIMAL(20,10)) AS cdecimal1, CAST (((cdouble*9.3)/13) AS DECIMAL(23,14)) AS cdecimal2 FROM alltypesorc
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@alltypesorc
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@decimal_test
 PREHOOK: query: EXPLAIN SELECT cdecimal1 + cdecimal2, cdecimal1 - (2*cdecimal2), ((cdecimal1+2.34)/cdecimal2), (cdecimal1 * (cdecimal2/3.4)), cdecimal1 % 10, CAST(cdecimal1 AS INT), CAST(cdecimal2 AS SMALLINT), CAST(cdecimal2 AS TINYINT), CAST(cdecimal1 AS BIGINT), CAST (cdecimal1 AS BOOLEAN), CAST(cdecimal2 AS DOUBLE), CAST(cdecimal1 AS FLOAT), CAST(cdecimal2 AS STRING), CAST(cdecimal1 AS TIMESTAMP) FROM decimal_test WHERE cdecimal1 > 0 AND cdecimal1 < 12345.5678 AND cdecimal2 != 0 AND cdecimal2 > 1000 AND cdouble IS NOT NULL LIMIT 10
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/vector_decimal_mapjoin.q.out b/ql/src/test/results/clientpositive/vector_decimal_mapjoin.q.out
index 4a90849efd..d9eb311aaf 100644
--- a/ql/src/test/results/clientpositive/vector_decimal_mapjoin.q.out
+++ b/ql/src/test/results/clientpositive/vector_decimal_mapjoin.q.out
@@ -5,6 +5,8 @@ PREHOOK: query: CREATE TABLE decimal_mapjoin STORED AS ORC AS
   FROM alltypesorc
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@alltypesorc
+PREHOOK: Output: database:default
+PREHOOK: Output: default@decimal_mapjoin
 POSTHOOK: query: CREATE TABLE decimal_mapjoin STORED AS ORC AS 
   SELECT cdouble, CAST (((cdouble*22.1)/37) AS DECIMAL(20,10)) AS cdecimal1, 
   CAST (((cdouble*9.3)/13) AS DECIMAL(23,14)) AS cdecimal2,
@@ -12,6 +14,7 @@ POSTHOOK: query: CREATE TABLE decimal_mapjoin STORED AS ORC AS
   FROM alltypesorc
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@alltypesorc
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@decimal_mapjoin
 PREHOOK: query: EXPLAIN SELECT l.cint, r.cint, l.cdecimal1, r.cdecimal2
   FROM decimal_mapjoin l
diff --git a/ql/src/test/results/clientpositive/vector_decimal_math_funcs.q.out b/ql/src/test/results/clientpositive/vector_decimal_math_funcs.q.out
index 2e98ceb597..2cfa45a9a1 100644
--- a/ql/src/test/results/clientpositive/vector_decimal_math_funcs.q.out
+++ b/ql/src/test/results/clientpositive/vector_decimal_math_funcs.q.out
@@ -1,9 +1,12 @@
 PREHOOK: query: CREATE TABLE decimal_test STORED AS ORC AS SELECT cbigint, cdouble, CAST (((cdouble*22.1)/37) AS DECIMAL(20,10)) AS cdecimal1, CAST (((cdouble*9.3)/13) AS DECIMAL(23,14)) AS cdecimal2 FROM alltypesorc
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@alltypesorc
+PREHOOK: Output: database:default
+PREHOOK: Output: default@decimal_test
 POSTHOOK: query: CREATE TABLE decimal_test STORED AS ORC AS SELECT cbigint, cdouble, CAST (((cdouble*22.1)/37) AS DECIMAL(20,10)) AS cdecimal1, CAST (((cdouble*9.3)/13) AS DECIMAL(23,14)) AS cdecimal2 FROM alltypesorc
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@alltypesorc
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@decimal_test
 PREHOOK: query: -- Test math functions in vectorized mode to verify they run correctly end-to-end.
 
diff --git a/ql/src/test/results/clientpositive/vectorization_decimal_date.q.out b/ql/src/test/results/clientpositive/vectorization_decimal_date.q.out
index 6c89f713ad..ebbb24fab9 100644
--- a/ql/src/test/results/clientpositive/vectorization_decimal_date.q.out
+++ b/ql/src/test/results/clientpositive/vectorization_decimal_date.q.out
@@ -1,9 +1,12 @@
 PREHOOK: query: CREATE TABLE date_decimal_test STORED AS ORC AS SELECT cint, cdouble, CAST (CAST (cint AS TIMESTAMP) AS DATE) AS cdate, CAST (((cdouble*22.1)/37) AS DECIMAL(20,10)) AS cdecimal FROM alltypesorc
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@alltypesorc
+PREHOOK: Output: database:default
+PREHOOK: Output: default@date_decimal_test
 POSTHOOK: query: CREATE TABLE date_decimal_test STORED AS ORC AS SELECT cint, cdouble, CAST (CAST (cint AS TIMESTAMP) AS DATE) AS cdate, CAST (((cdouble*22.1)/37) AS DECIMAL(20,10)) AS cdecimal FROM alltypesorc
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@alltypesorc
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@date_decimal_test
 PREHOOK: query: EXPLAIN SELECT cdate, cdecimal from date_decimal_test where cint IS NOT NULL AND cdouble IS NOT NULL LIMIT 10
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/vectorized_ptf.q.out b/ql/src/test/results/clientpositive/vectorized_ptf.q.out
index 202ec400e6..c81a214fc9 100644
--- a/ql/src/test/results/clientpositive/vectorized_ptf.q.out
+++ b/ql/src/test/results/clientpositive/vectorized_ptf.q.out
@@ -5316,6 +5316,8 @@ from part
 group by p_mfgr, p_brand
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@part
+PREHOOK: Output: database:default
+PREHOOK: Output: default@mfgr_price_view
 POSTHOOK: query: -- 16. testViewAsTableInputToPTF
 create view IF NOT EXISTS mfgr_price_view as 
 select p_mfgr, p_brand, 
@@ -5324,6 +5326,7 @@ from part
 group by p_mfgr, p_brand
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@part
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mfgr_price_view
 PREHOOK: query: explain extended
 select p_mfgr, p_brand, s, 
diff --git a/ql/src/test/results/clientpositive/view.q.out b/ql/src/test/results/clientpositive/view.q.out
index 0dce318b65..c7505b821f 100644
--- a/ql/src/test/results/clientpositive/view.q.out
+++ b/ql/src/test/results/clientpositive/view.q.out
@@ -54,77 +54,101 @@ PREHOOK: query: -- relative reference, no alias
 CREATE VIEW v1 AS SELECT * FROM table1
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: db1@table1
+PREHOOK: Output: database:db1
+PREHOOK: Output: db1@v1
 POSTHOOK: query: -- relative reference, no alias
 CREATE VIEW v1 AS SELECT * FROM table1
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: db1@table1
+POSTHOOK: Output: database:db1
 POSTHOOK: Output: db1@v1
 PREHOOK: query: -- relative reference, aliased
 CREATE VIEW v2 AS SELECT t1.* FROM table1 t1
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: db1@table1
+PREHOOK: Output: database:db1
+PREHOOK: Output: db1@v2
 POSTHOOK: query: -- relative reference, aliased
 CREATE VIEW v2 AS SELECT t1.* FROM table1 t1
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: db1@table1
+POSTHOOK: Output: database:db1
 POSTHOOK: Output: db1@v2
 PREHOOK: query: -- relative reference, multiple tables
 CREATE VIEW v3 AS SELECT t1.*, t2.key k FROM table1 t1 JOIN table2 t2 ON t1.key = t2.key
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: db1@table1
 PREHOOK: Input: db1@table2
+PREHOOK: Output: database:db1
+PREHOOK: Output: db1@v3
 POSTHOOK: query: -- relative reference, multiple tables
 CREATE VIEW v3 AS SELECT t1.*, t2.key k FROM table1 t1 JOIN table2 t2 ON t1.key = t2.key
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: db1@table1
 POSTHOOK: Input: db1@table2
+POSTHOOK: Output: database:db1
 POSTHOOK: Output: db1@v3
 PREHOOK: query: -- absolute reference, no alias
 CREATE VIEW v4 AS SELECT * FROM db1.table1
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: db1@table1
+PREHOOK: Output: database:db1
+PREHOOK: Output: db1@v4
 POSTHOOK: query: -- absolute reference, no alias
 CREATE VIEW v4 AS SELECT * FROM db1.table1
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: db1@table1
+POSTHOOK: Output: database:db1
 POSTHOOK: Output: db1@v4
 PREHOOK: query: -- absolute reference, aliased
 CREATE VIEW v5 AS SELECT t1.* FROM db1.table1 t1
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: db1@table1
+PREHOOK: Output: database:db1
+PREHOOK: Output: db1@v5
 POSTHOOK: query: -- absolute reference, aliased
 CREATE VIEW v5 AS SELECT t1.* FROM db1.table1 t1
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: db1@table1
+POSTHOOK: Output: database:db1
 POSTHOOK: Output: db1@v5
 PREHOOK: query: -- absolute reference, multiple tables
 CREATE VIEW v6 AS SELECT t1.*, t2.key k FROM db1.table1 t1 JOIN db1.table2 t2 ON t1.key = t2.key
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: db1@table1
 PREHOOK: Input: db1@table2
+PREHOOK: Output: database:db1
+PREHOOK: Output: db1@v6
 POSTHOOK: query: -- absolute reference, multiple tables
 CREATE VIEW v6 AS SELECT t1.*, t2.key k FROM db1.table1 t1 JOIN db1.table2 t2 ON t1.key = t2.key
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: db1@table1
 POSTHOOK: Input: db1@table2
+POSTHOOK: Output: database:db1
 POSTHOOK: Output: db1@v6
 PREHOOK: query: -- relative reference, explicit column
 CREATE VIEW v7 AS SELECT key from table1
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: db1@table1
+PREHOOK: Output: database:db1
+PREHOOK: Output: db1@v7
 POSTHOOK: query: -- relative reference, explicit column
 CREATE VIEW v7 AS SELECT key from table1
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: db1@table1
+POSTHOOK: Output: database:db1
 POSTHOOK: Output: db1@v7
 PREHOOK: query: -- absolute reference, explicit column
 CREATE VIEW v8 AS SELECT key from db1.table1
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: db1@table1
+PREHOOK: Output: database:db1
+PREHOOK: Output: db1@v8
 POSTHOOK: query: -- absolute reference, explicit column
 CREATE VIEW v8 AS SELECT key from db1.table1
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: db1@table1
+POSTHOOK: Output: database:db1
 POSTHOOK: Output: db1@v8
 PREHOOK: query: CREATE DATABASE db2
 PREHOOK: type: CREATEDATABASE
diff --git a/ql/src/test/results/clientpositive/view_cast.q.out b/ql/src/test/results/clientpositive/view_cast.q.out
index cf4a1f453a..34444ae745 100644
--- a/ql/src/test/results/clientpositive/view_cast.q.out
+++ b/ql/src/test/results/clientpositive/view_cast.q.out
@@ -56,9 +56,12 @@ POSTHOOK: type: DROPVIEW
 PREHOOK: query: CREATE VIEW aa_view_tw AS SELECT ks_uid, sr_id, act, at_ks_uid, at_sr_uid, from_unixtime(CAST(CAST( tstamp as BIGINT)/1000 AS BIGINT),'yyyyMMdd') AS act_date, from_unixtime(CAST(CAST( original_tstamp AS BIGINT)/1000 AS BIGINT),'yyyyMMdd') AS content_creation_date FROM atab WHERE dt='20130312' AND nt='tw' AND ks_uid != at_ks_uid
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@atab
+PREHOOK: Output: database:default
+PREHOOK: Output: default@aa_view_tw
 POSTHOOK: query: CREATE VIEW aa_view_tw AS SELECT ks_uid, sr_id, act, at_ks_uid, at_sr_uid, from_unixtime(CAST(CAST( tstamp as BIGINT)/1000 AS BIGINT),'yyyyMMdd') AS act_date, from_unixtime(CAST(CAST( original_tstamp AS BIGINT)/1000 AS BIGINT),'yyyyMMdd') AS content_creation_date FROM atab WHERE dt='20130312' AND nt='tw' AND ks_uid != at_ks_uid
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@atab
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@aa_view_tw
 PREHOOK: query: DROP VIEW IF EXISTS joined_aa_view_tw
 PREHOOK: type: DROPVIEW
@@ -69,11 +72,14 @@ PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@aa_view_tw
 PREHOOK: Input: default@atab
 PREHOOK: Input: default@mstab
+PREHOOK: Output: database:default
+PREHOOK: Output: default@joined_aa_view_tw
 POSTHOOK: query: CREATE VIEW joined_aa_view_tw AS SELECT aa.ks_uid, aa.sr_id, aa.act, at_sr_uid, aa.act_date, aa.at_ks_uid, aa.content_creation_date, coalesce( other.ksc, 10.0) AS at_ksc, coalesce( self.ksc , 10.0 ) AS self_ksc FROM aa_view_tw aa LEFT OUTER JOIN ( SELECT ks_uid, csc AS ksc FROM mstab WHERE dt='20130311' ) self ON ( CAST(aa.ks_uid AS BIGINT) = CAST(self.ks_uid AS BIGINT) ) LEFT OUTER JOIN ( SELECT ks_uid, csc AS ksc FROM mstab WHERE dt='20130311' ) other ON ( CAST(aa.at_ks_uid AS BIGINT) = CAST(other.ks_uid AS BIGINT) )
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@aa_view_tw
 POSTHOOK: Input: default@atab
 POSTHOOK: Input: default@mstab
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@joined_aa_view_tw
 PREHOOK: query: SELECT * FROM joined_aa_view_tw
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/view_inputs.q.out b/ql/src/test/results/clientpositive/view_inputs.q.out
index 0df9a4c1dd..e9160f3692 100644
--- a/ql/src/test/results/clientpositive/view_inputs.q.out
+++ b/ql/src/test/results/clientpositive/view_inputs.q.out
@@ -3,20 +3,26 @@ PREHOOK: query: -- Tests that selecting from a view and another view that select
 CREATE VIEW test_view1 AS SELECT * FROM src
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@test_view1
 POSTHOOK: query: -- Tests that selecting from a view and another view that selects from that same view
 
 CREATE VIEW test_view1 AS SELECT * FROM src
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@test_view1
 PREHOOK: query: CREATE VIEW test_view2 AS SELECT * FROM test_view1
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
 PREHOOK: Input: default@test_view1
+PREHOOK: Output: database:default
+PREHOOK: Output: default@test_view2
 POSTHOOK: query: CREATE VIEW test_view2 AS SELECT * FROM test_view1
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Input: default@test_view1
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@test_view2
 PREHOOK: query: SELECT COUNT(*) FROM test_view1 a JOIN test_view2 b ON a.key = b.key
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/windowing.q.out b/ql/src/test/results/clientpositive/windowing.q.out
index b72f4c0377..31d0511c3d 100644
--- a/ql/src/test/results/clientpositive/windowing.q.out
+++ b/ql/src/test/results/clientpositive/windowing.q.out
@@ -1024,6 +1024,8 @@ from part
 group by p_mfgr, p_brand
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@part
+PREHOOK: Output: database:default
+PREHOOK: Output: default@mfgr_price_view
 POSTHOOK: query: -- 22. testViewAsTableInputWithWindowing
 create view IF NOT EXISTS mfgr_price_view as 
 select p_mfgr, p_brand, 
@@ -1032,6 +1034,7 @@ from part
 group by p_mfgr, p_brand
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@part
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mfgr_price_view
 PREHOOK: query: select * 
 from (
@@ -1113,6 +1116,8 @@ from part
 window w1 as (distribute by p_mfgr sort by p_name rows between 2 preceding and current row)
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@part
+PREHOOK: Output: database:default
+PREHOOK: Output: default@mfgr_brand_price_view
 POSTHOOK: query: -- 23. testCreateViewWithWindowingQuery
 create view IF NOT EXISTS mfgr_brand_price_view as 
 select p_mfgr, p_brand, 
@@ -1121,6 +1126,7 @@ from part
 window w1 as (distribute by p_mfgr sort by p_name rows between 2 preceding and current row)
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@part
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mfgr_brand_price_view
 PREHOOK: query: select * from mfgr_brand_price_view
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/windowing_navfn.q.out b/ql/src/test/results/clientpositive/windowing_navfn.q.out
index e5bc4f435b..4256640dbd 100644
--- a/ql/src/test/results/clientpositive/windowing_navfn.q.out
+++ b/ql/src/test/results/clientpositive/windowing_navfn.q.out
@@ -614,6 +614,8 @@ SELECT explode(
   ) s1 lateral view explode(barr) arr as b
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
+PREHOOK: Output: database:default
+PREHOOK: Output: default@wtest
 POSTHOOK: query: create table wtest as
 select a, b
 from
@@ -628,6 +630,7 @@ SELECT explode(
   ) s1 lateral view explode(barr) arr as b
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@wtest
 PREHOOK: query: select a, b,
 first_value(b) over (partition by a order by b rows between 1 preceding and 1 following ) ,
diff --git a/ql/src/test/results/clientpositive/windowing_streaming.q.out b/ql/src/test/results/clientpositive/windowing_streaming.q.out
index 90ba45ab7d..6765247df0 100644
--- a/ql/src/test/results/clientpositive/windowing_streaming.q.out
+++ b/ql/src/test/results/clientpositive/windowing_streaming.q.out
@@ -347,10 +347,13 @@ PREHOOK: query: create table sB ROW FORMAT DELIMITED FIELDS TERMINATED BY ','  S
 select * from (select ctinyint, cdouble, rank() over(partition by ctinyint order by cdouble) r from  alltypesorc) a where r < 5
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@alltypesorc
+PREHOOK: Output: database:default
+PREHOOK: Output: default@sB
 POSTHOOK: query: create table sB ROW FORMAT DELIMITED FIELDS TERMINATED BY ','  STORED AS TEXTFILE as  
 select * from (select ctinyint, cdouble, rank() over(partition by ctinyint order by cdouble) r from  alltypesorc) a where r < 5
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@alltypesorc
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@sB
 PREHOOK: query: select * from sB
 where ctinyint is null
@@ -412,10 +415,13 @@ PREHOOK: query: create table sD ROW FORMAT DELIMITED FIELDS TERMINATED BY ','  S
 select * from (select ctinyint, cdouble, rank() over(partition by ctinyint order by cdouble) r from  alltypesorc) a where r < 5
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@alltypesorc
+PREHOOK: Output: database:default
+PREHOOK: Output: default@sD
 POSTHOOK: query: create table sD ROW FORMAT DELIMITED FIELDS TERMINATED BY ','  STORED AS TEXTFILE as  
 select * from (select ctinyint, cdouble, rank() over(partition by ctinyint order by cdouble) r from  alltypesorc) a where r < 5
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@alltypesorc
+POSTHOOK: Output: database:default
 POSTHOOK: Output: default@sD
 PREHOOK: query: select * from sD
 where ctinyint is null
