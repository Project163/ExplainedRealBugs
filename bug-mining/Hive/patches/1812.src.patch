diff --git a/cli/src/java/org/apache/hadoop/hive/cli/CliDriver.java b/cli/src/java/org/apache/hadoop/hive/cli/CliDriver.java
index f08a8b65d0..21ba38cc6a 100644
--- a/cli/src/java/org/apache/hadoop/hive/cli/CliDriver.java
+++ b/cli/src/java/org/apache/hadoop/hive/cli/CliDriver.java
@@ -27,12 +27,12 @@
 import java.io.IOException;
 import java.io.PrintStream;
 import java.io.UnsupportedEncodingException;
+import java.sql.SQLException;
 import java.util.ArrayList;
 import java.util.Arrays;
 import java.util.List;
 import java.util.Map;
 import java.util.Set;
-import java.sql.SQLException;
 
 import jline.ArgumentCompletor;
 import jline.ArgumentCompletor.AbstractArgumentDelimiter;
@@ -271,10 +271,15 @@ int processLocalCmd(String cmd, CommandProcessor proc, CliSessionState ss) {
               return ret;
             }
 
+            // query has run capture the time
+            long end = System.currentTimeMillis();
+            double timeTaken = (end - start) / 1000.0;
+
             ArrayList<String> res = new ArrayList<String>();
 
             printHeader(qp, out);
 
+            // print the results
             int counter = 0;
             try {
               while (qp.getResults(res)) {
@@ -299,11 +304,8 @@ int processLocalCmd(String cmd, CommandProcessor proc, CliSessionState ss) {
               ret = cret;
             }
 
-            long end = System.currentTimeMillis();
-            double timeTaken = (end - start) / 1000.0;
             console.printInfo("Time taken: " + timeTaken + " seconds" +
                 (counter == 0 ? "" : ", Fetched: " + counter + " row(s)"));
-
           } else {
             String firstToken = tokenizeCmd(cmd.trim())[0];
             String cmd_1 = getFirstCmd(cmd.trim(), firstToken.length());
diff --git a/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java b/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java
index 1f242ea321..9e6c3a5a1f 100644
--- a/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java
+++ b/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java
@@ -520,6 +520,10 @@ public static enum ConfVars {
 
     HIVE_ORC_DICTIONARY_KEY_SIZE_THRESHOLD("hive.exec.orc.dictionary.key.size.threshold", 0.8f),
 
+    HIVE_ORC_INCLUDE_FILE_FOOTER_IN_SPLITS("hive.orc.splits.include.file.footer", false),
+    HIVE_ORC_CACHE_STRIPE_DETAILS_SIZE("hive.orc.cache.stripe.details.size", 10000),
+    HIVE_ORC_COMPUTE_SPLITS_NUM_THREADS("hive.orc.compute.splits.num.threads", 10),
+
     HIVESKEWJOIN("hive.optimize.skewjoin", false),
     HIVECONVERTJOIN("hive.auto.convert.join", true),
     HIVECONVERTJOINNOCONDITIONALTASK("hive.auto.convert.join.noconditionaltask", true),
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/HashTableLoaderFactory.java b/ql/src/java/org/apache/hadoop/hive/ql/HashTableLoaderFactory.java
new file mode 100644
index 0000000000..e17d193d6d
--- /dev/null
+++ b/ql/src/java/org/apache/hadoop/hive/ql/HashTableLoaderFactory.java
@@ -0,0 +1,38 @@
+/**
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.apache.hadoop.hive.ql;
+
+import org.apache.hadoop.conf.Configuration;
+import org.apache.hadoop.hive.conf.HiveConf;
+import org.apache.hadoop.hive.conf.HiveConf.ConfVars;
+import org.apache.hadoop.hive.ql.exec.HashTableLoader;
+
+/**
+ * HashTableLoaderFactory is used to determine the strategy
+ * of loading the hashtables for the MapJoinOperator
+ */
+public class HashTableLoaderFactory {
+
+  private HashTableLoaderFactory() {
+  }
+
+  public static HashTableLoader getLoader(Configuration hconf) {
+    return new org.apache.hadoop.hive.ql.exec.mr.HashTableLoader();
+  }
+
+}
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/AbstractMapJoinOperator.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/AbstractMapJoinOperator.java
index 8815c397d4..d8f4eb4c6f 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/AbstractMapJoinOperator.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/AbstractMapJoinOperator.java
@@ -149,4 +149,11 @@ protected boolean hasAnyNulls(Object[] key) {
   protected boolean hasAnyNulls(MapJoinKey key) {
     return key.hasAnyNulls(nullsafes);
   }
+
+  @Override
+  public void closeOp(boolean abort) throws HiveException {
+    super.closeOp(abort);
+    emptyList = null;
+    joinKeys = null;
+  }
 }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/HashTableLoader.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/HashTableLoader.java
new file mode 100644
index 0000000000..a080fccc55
--- /dev/null
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/HashTableLoader.java
@@ -0,0 +1,36 @@
+/**
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.apache.hadoop.hive.ql.exec;
+
+import org.apache.hadoop.conf.Configuration;
+import org.apache.hadoop.hive.ql.exec.mr.ExecMapperContext;
+import org.apache.hadoop.hive.ql.exec.persistence.MapJoinTableContainer;
+import org.apache.hadoop.hive.ql.exec.persistence.MapJoinTableContainerSerDe;
+import org.apache.hadoop.hive.ql.metadata.HiveException;
+import org.apache.hadoop.hive.ql.plan.MapJoinDesc;
+
+/**
+ * HashTableLoader is an interface used by MapJoinOperator used to load the hashtables
+ * needed to process the join.
+ */
+public interface HashTableLoader {
+
+  void load(ExecMapperContext context, Configuration hconf, MapJoinDesc desc, byte posBigTable,
+      MapJoinTableContainer[] mapJoinTables, MapJoinTableContainerSerDe[] mapJoinTableSerdes)
+      throws HiveException;
+}
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/MapJoinOperator.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/MapJoinOperator.java
index 4b21f4caa3..bdc85b95bf 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/MapJoinOperator.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/MapJoinOperator.java
@@ -18,30 +18,25 @@
 
 package org.apache.hadoop.hive.ql.exec;
 
-import java.io.BufferedInputStream;
-import java.io.FileInputStream;
-import java.io.ObjectInputStream;
 import java.io.Serializable;
 import java.util.List;
 
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
 import org.apache.hadoop.conf.Configuration;
-import org.apache.hadoop.filecache.DistributedCache;
-import org.apache.hadoop.fs.FileSystem;
-import org.apache.hadoop.fs.Path;
+import org.apache.hadoop.hive.ql.HashTableLoaderFactory;
 import org.apache.hadoop.hive.ql.exec.persistence.MapJoinKey;
 import org.apache.hadoop.hive.ql.exec.persistence.MapJoinObjectSerDeContext;
 import org.apache.hadoop.hive.ql.exec.persistence.MapJoinRowContainer;
 import org.apache.hadoop.hive.ql.exec.persistence.MapJoinTableContainer;
 import org.apache.hadoop.hive.ql.exec.persistence.MapJoinTableContainerSerDe;
+import org.apache.hadoop.hive.ql.log.PerfLogger;
 import org.apache.hadoop.hive.ql.metadata.HiveException;
 import org.apache.hadoop.hive.ql.plan.MapJoinDesc;
 import org.apache.hadoop.hive.ql.plan.TableDesc;
 import org.apache.hadoop.hive.ql.plan.api.OperatorType;
 import org.apache.hadoop.hive.serde2.SerDe;
 import org.apache.hadoop.hive.serde2.SerDeException;
-import org.apache.hadoop.hive.shims.ShimLoader;
 import org.apache.hadoop.util.ReflectionUtils;
 
 /**
@@ -51,6 +46,14 @@ public class MapJoinOperator extends AbstractMapJoinOperator<MapJoinDesc> implem
 
   private static final long serialVersionUID = 1L;
   private static final Log LOG = LogFactory.getLog(MapJoinOperator.class.getName());
+  private static final String CLASS_NAME = MapJoinOperator.class.getName();
+  private final PerfLogger perfLogger = PerfLogger.getPerfLogger();
+
+  private transient String tableKey;
+  private transient String serdeKey;
+  private transient ObjectCache cache;
+
+  private HashTableLoader loader;
 
   protected transient MapJoinTableContainer[] mapJoinTables;
   private transient MapJoinTableContainerSerDe[] mapJoinTableSerdes;
@@ -64,13 +67,44 @@ public MapJoinOperator(AbstractMapJoinOperator<? extends MapJoinDesc> mjop) {
     super(mjop);
   }
 
+  /*
+   * We need the base (operator.java) implementation of start/endGroup.
+   * The parent class has functionality in those that map join can't use.
+   * Note: The mapjoin can be run in the reducer only on Tez.
+   */
+  @Override
+  public void endGroup() throws HiveException {
+    defaultEndGroup();
+  }
+
+  @Override
+  public void startGroup() throws HiveException {
+    defaultStartGroup();
+  }
+
   @Override
   protected void initializeOp(Configuration hconf) throws HiveException {
     super.initializeOp(hconf);
+
     int tagLen = conf.getTagLength();
-    mapJoinTables = new MapJoinTableContainer[tagLen];
-    mapJoinTableSerdes = new MapJoinTableContainerSerDe[tagLen];
-    hashTblInitedOnce = false;
+
+    // On Tez only: The hash map might already be cached in the container we run
+    // the task in. On MR: The cache is a no-op.
+    tableKey = "__HASH_MAP_"+this.getOperatorId()+"_container";
+    serdeKey = "__HASH_MAP_"+this.getOperatorId()+"_serde";
+
+    cache = ObjectCacheFactory.getCache(hconf);
+    loader = HashTableLoaderFactory.getLoader(hconf);
+
+    mapJoinTables = (MapJoinTableContainer[]) cache.retrieve(tableKey);
+    mapJoinTableSerdes = (MapJoinTableContainerSerDe[]) cache.retrieve(serdeKey);
+    hashTblInitedOnce = true;
+
+    if (mapJoinTables == null || mapJoinTableSerdes == null) {
+      mapJoinTables = new MapJoinTableContainer[tagLen];
+      mapJoinTableSerdes = new MapJoinTableContainerSerDe[tagLen];
+      hashTblInitedOnce = false;
+    }
   }
 
   public void generateMapMetaData() throws HiveException, SerDeException {
@@ -101,58 +135,21 @@ public void generateMapMetaData() throws HiveException, SerDeException {
   }
 
   private void loadHashTable() throws HiveException {
-    if (!this.getExecContext().getLocalWork().getInputFileChangeSensitive()) {
+
+    if (this.getExecContext().getLocalWork() == null
+        || !this.getExecContext().getLocalWork().getInputFileChangeSensitive()) {
       if (hashTblInitedOnce) {
         return;
       } else {
         hashTblInitedOnce = true;
       }
     }
-
-    String baseDir = null;
-    String currentInputFile = getExecContext().getCurrentInputPath().toString();
-    LOG.info("******* Load from HashTable File: input : " + currentInputFile);
-    String fileName = getExecContext().getLocalWork().getBucketFileName(currentInputFile);
-    try {
-      if (ShimLoader.getHadoopShims().isLocalMode(hconf)) {
-        baseDir = this.getExecContext().getLocalWork().getTmpFileURI();
-      } else {
-        Path[] localArchives;
-        String stageID = this.getExecContext().getLocalWork().getStageID();
-        String suffix = Utilities.generateTarFileName(stageID);
-        FileSystem localFs = FileSystem.getLocal(hconf);
-        localArchives = DistributedCache.getLocalCacheArchives(this.hconf);
-        Path archive;
-        for (int j = 0; j < localArchives.length; j++) {
-          archive = localArchives[j];
-          if (!archive.getName().endsWith(suffix)) {
-            continue;
-          }
-          Path archiveLocalLink = archive.makeQualified(localFs);
-          baseDir = archiveLocalLink.toUri().getPath();
-        }
-      }
-      for (int pos = 0; pos < mapJoinTables.length; pos++) {
-        if (pos == posBigTable) {
-          continue;
-        }
-        if(baseDir == null) {
-          throw new IllegalStateException("baseDir cannot be null");
-        }
-        String filePath = Utilities.generatePath(baseDir, conf.getDumpFilePrefix(), (byte)pos, fileName);
-        Path path = new Path(filePath);
-        LOG.info("\tLoad back 1 hashtable file from tmp file uri:" + path);
-        ObjectInputStream in = new ObjectInputStream(new BufferedInputStream(
-            new FileInputStream(path.toUri().getPath()), 4096));
-        try{
-          mapJoinTables[pos] = mapJoinTableSerdes[pos].load(in);
-        } finally {
-          in.close();
-        }
-      }
-    } catch (Exception e) {
-      throw new HiveException(e);
-    }
+    perfLogger.PerfLogBegin(CLASS_NAME, PerfLogger.LOAD_HASHTABLE);
+    loader.load(this.getExecContext(), hconf, this.getConf(),
+        posBigTable, mapJoinTables, mapJoinTableSerdes);
+    cache.cache(tableKey, mapJoinTables);
+    cache.cache(serdeKey, mapJoinTableSerdes);
+    perfLogger.PerfLogEnd(CLASS_NAME, PerfLogger.LOAD_HASHTABLE);
   }
 
   // Load the hash table
@@ -179,8 +176,8 @@ protected MapJoinKey computeMapJoinKey(Object row, byte alias) throws HiveExcept
   public void processOp(Object row, int tag) throws HiveException {
     try {
       if (firstRow) {
-        // generate the map metadata
         generateMapMetaData();
+        loadHashTable();
         firstRow = false;
       }
       alias = (byte)tag;
@@ -227,7 +224,9 @@ public void processOp(Object row, int tag) throws HiveException {
 
   @Override
   public void closeOp(boolean abort) throws HiveException {
-    if (mapJoinTables != null) {
+    if ((this.getExecContext().getLocalWork() != null
+        && this.getExecContext().getLocalWork().getInputFileChangeSensitive())
+        && mapJoinTables != null) {
       for (MapJoinTableContainer tableContainer : mapJoinTables) {
         if (tableContainer != null) {
           tableContainer.clear();
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/MapOperator.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/MapOperator.java
index bf97dcdc45..5b6dd6a6c5 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/MapOperator.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/MapOperator.java
@@ -33,6 +33,7 @@
 import org.apache.hadoop.fs.Path;
 import org.apache.hadoop.hive.conf.HiveConf;
 import org.apache.hadoop.hive.metastore.api.hive_metastoreConstants;
+import org.apache.hadoop.hive.ql.io.IOContext;
 import org.apache.hadoop.hive.ql.exec.mr.ExecMapperContext;
 import org.apache.hadoop.hive.ql.metadata.HiveException;
 import org.apache.hadoop.hive.ql.metadata.VirtualColumn;
@@ -326,8 +327,7 @@ private boolean isPartitioned(PartitionDesc pd) {
 
   public void setChildren(Configuration hconf) throws HiveException {
 
-    Path fpath = new Path(HiveConf.getVar(hconf,
-        HiveConf.ConfVars.HADOOPMAPFILENAME));
+    Path fpath = IOContext.get().getInputPath();
 
     boolean schemeless = fpath.toUri().getScheme() == null;
 
@@ -350,8 +350,10 @@ public void setChildren(Configuration hconf) throws HiveException {
 
         for (String onealias : aliases) {
           Operator<? extends OperatorDesc> op = conf.getAliasToWork().get(onealias);
-          LOG.info("Adding alias " + onealias + " to work list for file "
-            + onefile);
+          if (LOG.isDebugEnabled()) {
+            LOG.debug("Adding alias " + onealias + " to work list for file "
+               + onefile);
+          }
           MapInputPath inp = new MapInputPath(onefile, onealias, op, partDesc);
           if (opCtxMap.containsKey(inp)) {
             continue;
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/MapredContext.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/MapredContext.java
index fbe8d6c434..81d0eda5d6 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/MapredContext.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/MapredContext.java
@@ -64,7 +64,7 @@ public static void close() {
 
   private Reporter reporter;
 
-  private MapredContext(boolean isMap, JobConf jobConf) {
+  protected MapredContext(boolean isMap, JobConf jobConf) {
     this.isMap = isMap;
     this.jobConf = jobConf;
     this.udfs = new ArrayList<Closeable>();
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/MuxOperator.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/MuxOperator.java
index 687034264d..b10a7fab0e 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/MuxOperator.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/MuxOperator.java
@@ -215,7 +215,7 @@ protected void initializeOp(Configuration hconf) throws HiveException {
   protected void initializeChildren(Configuration hconf) throws HiveException {
     state = State.INIT;
     LOG.info("Operator " + id + " " + getName() + " initialized");
-    if (childOperators == null) {
+    if (childOperators == null || childOperators.isEmpty()) {
       return;
     }
     LOG.info("Initializing children of " + id + " " + getName());
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/ObjectCache.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/ObjectCache.java
new file mode 100644
index 0000000000..f2b374cafa
--- /dev/null
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/ObjectCache.java
@@ -0,0 +1,37 @@
+/**
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.apache.hadoop.hive.ql.exec;
+
+/**
+ * ObjectCache. Interface for maintaining objects associated with a task.
+ */
+public interface ObjectCache {
+  /**
+   * Add an object to the cache
+   * @param key
+   * @param value
+   */
+  public void cache(String key, Object value);
+
+  /**
+   * Retrieve object from cache.
+   * @param key
+   * @return the last cached object with the key, null if none.
+   */
+  public Object retrieve(String key);
+}
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/ObjectCacheFactory.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/ObjectCacheFactory.java
new file mode 100644
index 0000000000..6d7fd121e3
--- /dev/null
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/ObjectCacheFactory.java
@@ -0,0 +1,40 @@
+/**
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.hadoop.hive.ql.exec;
+
+import org.apache.hadoop.conf.Configuration;
+import org.apache.hadoop.hive.conf.HiveConf;
+
+/**
+ * ObjectCacheFactory returns the appropriate cache depending on settings in
+ * the hive conf.
+ */
+public class ObjectCacheFactory {
+
+  private ObjectCacheFactory() {
+    // avoid instantiation
+  }
+
+  /**
+   * Returns the appropriate cache
+   */
+  public static ObjectCache getCache(Configuration conf) {
+    return new org.apache.hadoop.hive.ql.exec.mr.ObjectCache();
+  }
+}
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/Operator.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/Operator.java
index 85d19b9077..aa96d23ef0 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/Operator.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/Operator.java
@@ -32,6 +32,7 @@
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
 import org.apache.hadoop.conf.Configuration;
+import org.apache.hadoop.hive.conf.HiveConf;
 import org.apache.hadoop.hive.ql.exec.mr.ExecMapperContext;
 import org.apache.hadoop.hive.ql.lib.Node;
 import org.apache.hadoop.hive.ql.metadata.HiveException;
@@ -98,6 +99,8 @@ public static enum State {
 
   public Operator() {
     id = String.valueOf(seqId.getAndIncrement());
+    childOperators = new ArrayList<Operator<? extends OperatorDesc>>();
+    parentOperators = new ArrayList<Operator<? extends OperatorDesc>>();
     initOperatorId();
   }
 
@@ -118,6 +121,9 @@ public Operator(Reporter reporter) {
 
   public void setChildOperators(
       List<Operator<? extends OperatorDesc>> childOperators) {
+    if (childOperators == null) {
+      childOperators = new ArrayList<Operator<? extends OperatorDesc>>();
+    }
     this.childOperators = childOperators;
   }
 
@@ -151,6 +157,9 @@ public ArrayList<Node> getChildren() {
 
   public void setParentOperators(
       List<Operator<? extends OperatorDesc>> parentOperators) {
+    if (parentOperators == null) {
+      parentOperators = new ArrayList<Operator<? extends OperatorDesc>>();
+    }
     this.parentOperators = parentOperators;
   }
 
@@ -333,7 +342,7 @@ public void initialize(Configuration hconf, ObjectInspector[] inputOIs)
     // initialize structure to maintain child op info. operator tree changes
     // while
     // initializing so this need to be done here instead of initialize() method
-    if (childOperators != null) {
+    if (childOperators != null && !childOperators.isEmpty()) {
       childOperatorsArray = new Operator[childOperators.size()];
       for (int i = 0; i < childOperatorsArray.length; i++) {
         childOperatorsArray[i] = childOperators.get(i);
@@ -364,6 +373,14 @@ public void initialize(Configuration hconf, ObjectInspector[] inputOIs)
     passExecContext(this.execContext);
 
     initializeOp(hconf);
+
+    // sanity check
+    if (childOperatorsArray == null
+        && !(childOperators == null || childOperators.isEmpty())) {
+      throw new HiveException(
+          "Internal Hive error during operator initialization.");
+    }
+
     LOG.info("Initialization Done " + id + " " + getName());
   }
 
@@ -390,7 +407,7 @@ protected void initializeOp(Configuration hconf) throws HiveException {
   protected void initializeChildren(Configuration hconf) throws HiveException {
     state = State.INIT;
     LOG.info("Operator " + id + " " + getName() + " initialized");
-    if (childOperators == null) {
+    if (childOperators == null || childOperators.isEmpty()) {
       return;
     }
     LOG.info("Initializing children of " + id + " " + getName());
@@ -466,8 +483,7 @@ public ObjectInspector getOutputObjInspector() {
    */
   public abstract void processOp(Object row, int tag) throws HiveException;
 
-  // If a operator wants to do some work at the beginning of a group
-  public void startGroup() throws HiveException {
+  protected final void defaultStartGroup() throws HiveException {
     LOG.debug("Starting group");
 
     if (childOperators == null) {
@@ -482,8 +498,7 @@ public void startGroup() throws HiveException {
     LOG.debug("Start group Done");
   }
 
-  // If an operator wants to do some work at the end of a group
-  public void endGroup() throws HiveException {
+  protected final void defaultEndGroup() throws HiveException {
     LOG.debug("Ending group");
 
     if (childOperators == null) {
@@ -498,13 +513,23 @@ public void endGroup() throws HiveException {
     LOG.debug("End group Done");
   }
 
+  // If a operator wants to do some work at the beginning of a group
+  public void startGroup() throws HiveException {
+    defaultStartGroup();
+  }
+
+  // If an operator wants to do some work at the end of a group
+  public void endGroup() throws HiveException {
+    defaultEndGroup();
+  }
+
   // an blocking operator (e.g. GroupByOperator and JoinOperator) can
   // override this method to forward its outputs
   public void flush() throws HiveException {
   }
 
   public void processGroup(int tag) throws HiveException {
-    if (childOperators == null) {
+    if (childOperators == null || childOperators.isEmpty()) {
       return;
     }
     for (int i = 0; i < childOperatorsArray.length; i++) {
@@ -548,6 +573,8 @@ public void close(boolean abort) throws HiveException {
     // call the operator specific close routine
     closeOp(abort);
 
+    reporter = null;
+
     try {
       logStats();
       if (childOperators == null) {
@@ -632,7 +659,7 @@ public void removeChild(Operator<? extends OperatorDesc> child) {
     int childIndex = childOperators.indexOf(child);
     assert childIndex != -1;
     if (childOperators.size() == 1) {
-      childOperators = null;
+      setChildOperators(null);
     } else {
       childOperators.remove(childIndex);
     }
@@ -681,7 +708,7 @@ public void removeParent(Operator<? extends OperatorDesc> parent) {
     int parentIndex = parentOperators.indexOf(parent);
     assert parentIndex != -1;
     if (parentOperators.size() == 1) {
-      parentOperators = null;
+      setParentOperators(null);
     } else {
       parentOperators.remove(parentIndex);
     }
@@ -701,7 +728,7 @@ public boolean removeChildren(int depth) {
     Operator<? extends OperatorDesc> currOp = this;
     for (int i = 0; i < depth; i++) {
       // If there are more than 1 children at any level, don't do anything
-      if ((currOp.getChildOperators() == null) ||
+      if ((currOp.getChildOperators() == null) || (currOp.getChildOperators().isEmpty()) ||
           (currOp.getChildOperators().size() > 1)) {
         return false;
       }
@@ -750,11 +777,6 @@ protected long getNextCntr(long cntr) {
   protected void forward(Object row, ObjectInspector rowInspector)
       throws HiveException {
 
-    if (childOperatorsArray == null && childOperators != null) {
-      throw new HiveException(
-          "Internal Hive error during operator initialization.");
-    }
-
     if ((childOperatorsArray == null) || (getDone())) {
       return;
     }
@@ -1223,8 +1245,13 @@ public Statistics getStatistics() {
   }
 
   public void setStatistics(Statistics stats) {
+    if (LOG.isDebugEnabled()) {
+      LOG.debug("Setting stats ("+stats+") on "+this);
+    }
     if (conf != null) {
       conf.setStatistics(stats);
+    } else {
+      LOG.warn("Cannot set stats when there's no descriptor: "+this);
     }
   }
 }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/OperatorUtils.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/OperatorUtils.java
index 1070d164b0..9caf79e8c6 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/OperatorUtils.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/OperatorUtils.java
@@ -21,13 +21,18 @@
 import java.util.Collection;
 import java.util.HashSet;
 import java.util.List;
+import java.util.Map;
 import java.util.Set;
 
+import org.apache.commons.logging.Log;
+import org.apache.commons.logging.LogFactory;
 import org.apache.hadoop.hive.ql.plan.OperatorDesc;
 import org.apache.hadoop.mapred.OutputCollector;
 
 public class OperatorUtils {
 
+  private static final Log LOG = LogFactory.getLog(OperatorUtils.class);
+
   public static <T> Set<T> findOperators(Operator<?> start, Class<T> clazz) {
     return findOperators(start, clazz, new HashSet<T>());
   }
@@ -63,11 +68,29 @@ public static void setChildrenCollector(List<Operator<? extends OperatorDesc>> c
       return;
     }
     for (Operator<? extends OperatorDesc> op : childOperators) {
-      if(op.getName().equals(ReduceSinkOperator.getOperatorName())) { //TODO:
+      if(op.getName().equals(ReduceSinkOperator.getOperatorName())) {
         ((ReduceSinkOperator)op).setOutputCollector(out);
       } else {
         setChildrenCollector(op.getChildOperators(), out);
       }
     }
   }
+
+  public static void setChildrenCollector(List<Operator<? extends OperatorDesc>> childOperators, Map<String, OutputCollector> outMap) {
+    if (childOperators == null) {
+      return;
+    }
+    for (Operator<? extends OperatorDesc> op : childOperators) {
+      if(op.getName().equals(ReduceSinkOperator.getOperatorName())) {
+        ReduceSinkOperator rs = ((ReduceSinkOperator)op);
+        if (outMap.containsKey(rs.getConf().getOutputName())) {
+          LOG.info("Setting output collector: " + rs + " --> " 
+            + rs.getConf().getOutputName());
+          rs.setOutputCollector(outMap.get(rs.getConf().getOutputName()));
+        }
+      } else {
+        setChildrenCollector(op.getChildOperators(), outMap);
+      }
+    }
+  }
 }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/Task.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/Task.java
index 655395c926..56676df958 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/Task.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/Task.java
@@ -504,10 +504,16 @@ public List<FieldSchema> getResultSchema() {
   Throwable getException() {
     return exception;
   }
+
   void setException(Throwable ex) {
     exception = ex;
   }
 
+  public void setConsole(LogHelper console) {
+    this.console = console;
+  }
+
+  @Override
   public String toString() {
     return getId() + ":" + getType();
   }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/Utilities.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/Utilities.java
index f78df45ce0..7dc3d59755 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/Utilities.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/Utilities.java
@@ -262,14 +262,30 @@ public static MapredWork getMapRedWork(Configuration conf) {
     return w;
   }
 
+  public static void setMapWork(Configuration conf, MapWork work) {
+    setBaseWork(conf, MAP_PLAN_NAME, work);
+  }
+
   public static MapWork getMapWork(Configuration conf) {
     return (MapWork) getBaseWork(conf, MAP_PLAN_NAME);
   }
 
+  public static void setReduceWork(Configuration conf, ReduceWork work) {
+    setBaseWork(conf, REDUCE_PLAN_NAME, work);
+  }
+
   public static ReduceWork getReduceWork(Configuration conf) {
     return (ReduceWork) getBaseWork(conf, REDUCE_PLAN_NAME);
   }
 
+  /**
+   * Pushes work into the global work map
+   */
+  public static void setBaseWork(Configuration conf, String name, BaseWork work) {
+    Path path = getPlanPath(conf, name);
+    gWorkMap.put(path, work);
+  }
+
   /**
    * Returns the Map or Reduce plan
    * Side effect: the BaseWork returned is also placed in the gWorkMap
@@ -2724,22 +2740,30 @@ public static int estimateNumberOfReducers(HiveConf conf, ContentSummary inputSu
         + maxReducers + " totalInputFileSize=" + totalInputFileSize);
     }
 
+    // If this map reduce job writes final data to a table and bucketing is being inferred,
+    // and the user has configured Hive to do this, make sure the number of reducers is a
+    // power of two
+    boolean powersOfTwo = conf.getBoolVar(HiveConf.ConfVars.HIVE_INFER_BUCKET_SORT_NUM_BUCKETS_POWER_TWO) &&
+        finalMapRed && !work.getBucketedColsByDirectory().isEmpty();
+
+    return estimateReducers(totalInputFileSize, bytesPerReducer, maxReducers, powersOfTwo);
+  }
+
+  public static int estimateReducers(long totalInputFileSize, long bytesPerReducer,
+      int maxReducers, boolean powersOfTwo) {
+
     int reducers = (int) ((totalInputFileSize + bytesPerReducer - 1) / bytesPerReducer);
     reducers = Math.max(1, reducers);
     reducers = Math.min(maxReducers, reducers);
 
-    // If this map reduce job writes final data to a table and bucketing is being inferred,
-    // and the user has configured Hive to do this, make sure the number of reducers is a
-    // power of two
-    if (conf.getBoolVar(HiveConf.ConfVars.HIVE_INFER_BUCKET_SORT_NUM_BUCKETS_POWER_TWO) &&
-        finalMapRed && !work.getBucketedColsByDirectory().isEmpty()) {
 
-      int reducersLog = (int)(Math.log(reducers) / Math.log(2)) + 1;
-      int reducersPowerTwo = (int)Math.pow(2, reducersLog);
+    int reducersLog = (int)(Math.log(reducers) / Math.log(2)) + 1;
+    int reducersPowerTwo = (int)Math.pow(2, reducersLog);
 
+    if (powersOfTwo) {
       // If the original number of reducers was a power of two, use that
       if (reducersPowerTwo / 2 == reducers) {
-        return reducers;
+        // nothing to do
       } else if (reducersPowerTwo > maxReducers) {
         // If the next power of two greater than the original number of reducers is greater
         // than the max number of reducers, use the preceding power of two, which is strictly
@@ -2750,7 +2774,6 @@ public static int estimateNumberOfReducers(HiveConf conf, ContentSummary inputSu
         reducers = reducersPowerTwo;
       }
     }
-
     return reducers;
   }
 
@@ -3107,6 +3130,10 @@ private static void createTmpDirs(Configuration conf,
     }
   }
 
+  public static void clearWorkMap() {
+    gWorkMap.clear();
+  }
+
   /**
    * Create a temp dir in specified baseDir
    * This can go away once hive moves to support only JDK 7
@@ -3202,4 +3229,3 @@ public static int getFooterCount(TableDesc table, JobConf job) throws IOExceptio
     return footerCount;
   }
 }
-
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/mr/ExecMapper.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/mr/ExecMapper.java
index ffae20497a..2f5f60c37d 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/mr/ExecMapper.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/mr/ExecMapper.java
@@ -31,6 +31,8 @@
 import org.apache.hadoop.hive.ql.exec.FetchOperator;
 import org.apache.hadoop.hive.ql.exec.MapOperator;
 import org.apache.hadoop.hive.ql.exec.MapredContext;
+import org.apache.hadoop.hive.ql.exec.ObjectCache;
+import org.apache.hadoop.hive.ql.exec.ObjectCacheFactory;
 import org.apache.hadoop.hive.ql.exec.Operator;
 import org.apache.hadoop.hive.ql.exec.OperatorUtils;
 import org.apache.hadoop.hive.ql.exec.Utilities;
@@ -59,6 +61,7 @@
  */
 public class ExecMapper extends MapReduceBase implements Mapper {
 
+  private static final String PLAN_KEY = "__MAP_PLAN__";
   private MapOperator mo;
   private Map<String, FetchOperator> fetchOperators;
   private OutputCollector oc;
@@ -94,11 +97,22 @@ public void configure(JobConf job) {
     } catch (Exception e) {
       l4j.info("cannot get classpath: " + e.getMessage());
     }
+
+    setDone(false);
+
+    ObjectCache cache = ObjectCacheFactory.getCache(job);
+
     try {
       jc = job;
       execContext.setJc(jc);
       // create map and fetch operators
-      MapWork mrwork = Utilities.getMapWork(job);
+      MapWork mrwork = (MapWork) cache.retrieve(PLAN_KEY);
+      if (mrwork == null) {
+        mrwork = Utilities.getMapWork(job);
+        cache.cache(PLAN_KEY, mrwork);
+      } else {
+        Utilities.setMapWork(job, mrwork);
+      }
       if (mrwork.getVectorMode()) {
         mo = new VectorMapOperator();
       } else {
@@ -247,6 +261,7 @@ public void close() {
       }
     } finally {
       MapredContext.close();
+      Utilities.clearWorkMap();
     }
   }
 
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/mr/ExecReducer.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/mr/ExecReducer.java
index c1ad5c9a4f..fa662c8c6e 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/mr/ExecReducer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/mr/ExecReducer.java
@@ -30,6 +30,8 @@
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
 import org.apache.hadoop.hive.ql.exec.MapredContext;
+import org.apache.hadoop.hive.ql.exec.ObjectCache;
+import org.apache.hadoop.hive.ql.exec.ObjectCacheFactory;
 import org.apache.hadoop.hive.ql.exec.Operator;
 import org.apache.hadoop.hive.ql.exec.Utilities;
 import org.apache.hadoop.hive.ql.exec.mr.ExecMapper.reportStats;
@@ -64,6 +66,8 @@
  */
 public class ExecReducer extends MapReduceBase implements Reducer {
 
+  private static final String PLAN_KEY = "__REDUCE_PLAN__";
+
   private JobConf jc;
   private OutputCollector<?, ?> oc;
   private Operator<?> reducer;
@@ -112,7 +116,16 @@ public void configure(JobConf job) {
       l4j.info("cannot get classpath: " + e.getMessage());
     }
     jc = job;
-    ReduceWork gWork = Utilities.getReduceWork(job);
+
+    ObjectCache cache = ObjectCacheFactory.getCache(jc);
+    ReduceWork gWork = (ReduceWork) cache.retrieve(PLAN_KEY);
+    if (gWork == null) {
+      gWork = Utilities.getReduceWork(job);
+      cache.cache(PLAN_KEY, gWork);
+    } else {
+      Utilities.setReduceWork(job, gWork);
+    }
+
     reducer = gWork.getReducer();
     reducer.setParentOperators(null); // clear out any parents as reducer is the
     // root
@@ -314,6 +327,7 @@ public void close() {
       }
     } finally {
       MapredContext.close();
+      Utilities.clearWorkMap();
     }
   }
 }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/mr/HadoopJobExecHelper.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/mr/HadoopJobExecHelper.java
index ee3ad96b1d..bd7aec2f9c 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/mr/HadoopJobExecHelper.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/mr/HadoopJobExecHelper.java
@@ -128,10 +128,6 @@ public void setJobId(String jobId) {
     this.jobId = jobId;
   }
 
-
-  public HadoopJobExecHelper() {
-  }
-
   public HadoopJobExecHelper(JobConf job, LogHelper console,
       Task<? extends Serializable> task, HadoopJobExecHook hookCallBack) {
     this.job = job;
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/mr/HashTableLoader.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/mr/HashTableLoader.java
new file mode 100644
index 0000000000..efe5710092
--- /dev/null
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/mr/HashTableLoader.java
@@ -0,0 +1,104 @@
+/**
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.apache.hadoop.hive.ql.exec.mr;
+
+import java.io.BufferedInputStream;
+import java.io.FileInputStream;
+import java.io.ObjectInputStream;
+
+import org.apache.commons.logging.Log;
+import org.apache.commons.logging.LogFactory;
+import org.apache.hadoop.conf.Configuration;
+import org.apache.hadoop.filecache.DistributedCache;
+import org.apache.hadoop.fs.FileSystem;
+import org.apache.hadoop.fs.Path;
+import org.apache.hadoop.hive.ql.exec.MapJoinOperator;
+import org.apache.hadoop.hive.ql.exec.Utilities;
+import org.apache.hadoop.hive.ql.exec.persistence.MapJoinTableContainer;
+import org.apache.hadoop.hive.ql.exec.persistence.MapJoinTableContainerSerDe;
+import org.apache.hadoop.hive.ql.metadata.HiveException;
+import org.apache.hadoop.hive.ql.plan.MapJoinDesc;
+import org.apache.hadoop.hive.shims.ShimLoader;
+
+/**
+ * HashTableLoader for MR loads the hashtable for MapJoins from local disk (hashtables
+ * are distributed by using the DistributedCache.
+ *
+ */
+public class HashTableLoader implements org.apache.hadoop.hive.ql.exec.HashTableLoader {
+
+  private static final Log LOG = LogFactory.getLog(MapJoinOperator.class.getName());
+
+  public HashTableLoader() {
+  }
+
+  @Override
+  public void load(ExecMapperContext context,
+      Configuration hconf,
+      MapJoinDesc desc,
+      byte posBigTable,
+      MapJoinTableContainer[] mapJoinTables,
+      MapJoinTableContainerSerDe[] mapJoinTableSerdes) throws HiveException {
+
+    String baseDir = null;
+    Path currentInputPath = context.getCurrentInputPath();
+    LOG.info("******* Load from HashTable File: input : " + currentInputPath);
+    String fileName = context.getLocalWork().getBucketFileName(currentInputPath.toString());
+    try {
+      if (ShimLoader.getHadoopShims().isLocalMode(hconf)) {
+        baseDir = context.getLocalWork().getTmpFileURI();
+      } else {
+        Path[] localArchives;
+        String stageID = context.getLocalWork().getStageID();
+        String suffix = Utilities.generateTarFileName(stageID);
+        FileSystem localFs = FileSystem.getLocal(hconf);
+        localArchives = DistributedCache.getLocalCacheArchives(hconf);
+        Path archive;
+        for (int j = 0; j < localArchives.length; j++) {
+          archive = localArchives[j];
+          if (!archive.getName().endsWith(suffix)) {
+            continue;
+          }
+          Path archiveLocalLink = archive.makeQualified(localFs);
+          baseDir = archiveLocalLink.toUri().getPath();
+        }
+      }
+      for (int pos = 0; pos < mapJoinTables.length; pos++) {
+        if (pos == posBigTable) {
+          continue;
+        }
+        if(baseDir == null) {
+          throw new IllegalStateException("baseDir cannot be null");
+        }
+        String filePath = Utilities.generatePath(baseDir, desc.getDumpFilePrefix(), (byte)pos, fileName);
+        Path path = new Path(filePath);
+        LOG.info("\tLoad back 1 hashtable file from tmp file uri:" + path);
+        ObjectInputStream in = new ObjectInputStream(new BufferedInputStream(
+            new FileInputStream(path.toUri().getPath()), 4096));
+        try{
+          mapJoinTables[pos] = mapJoinTableSerdes[pos].load(in);
+        } finally {
+          in.close();
+        }
+      }
+    } catch (Exception e) {
+      throw new HiveException(e);
+    }
+  }
+
+}
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/mr/ObjectCache.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/mr/ObjectCache.java
new file mode 100644
index 0000000000..79736ef93d
--- /dev/null
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/mr/ObjectCache.java
@@ -0,0 +1,45 @@
+/**
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.hadoop.hive.ql.exec.mr;
+
+import org.apache.commons.logging.Log;
+import org.apache.commons.logging.LogFactory;
+
+
+/**
+ * ObjectCache. No-op implementation on MR we don't have a means to reuse
+ * Objects between runs of the same task.
+ *
+ */
+public class ObjectCache implements org.apache.hadoop.hive.ql.exec.ObjectCache {
+
+  private static final Log LOG = LogFactory.getLog(ObjectCache.class.getName());
+
+  @Override
+  public void cache(String key, Object value) {
+    LOG.info("Ignoring cache key: "+key);
+  }
+
+  @Override
+  public Object retrieve(String key) {
+    LOG.info("Ignoring retrieval request: "+key);
+    return null;
+  }
+
+}
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/persistence/MapJoinKey.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/persistence/MapJoinKey.java
index b2c5ddc5fa..2ac092863b 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/persistence/MapJoinKey.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/persistence/MapJoinKey.java
@@ -79,21 +79,27 @@ public boolean equals(Object obj) {
       return false;
     return true;
   }
-  @SuppressWarnings("unchecked")
-  public void read(MapJoinObjectSerDeContext context, ObjectInputStream in, Writable container) 
+
+  public void read(MapJoinObjectSerDeContext context, ObjectInputStream in, Writable container)
   throws IOException, SerDeException {
-    SerDe serde = context.getSerDe();
     container.readFields(in);
+    read(context, container);
+  }
+
+  @SuppressWarnings("unchecked")
+  public void read(MapJoinObjectSerDeContext context, Writable container) throws SerDeException {
+    SerDe serde = context.getSerDe();
     List<Object> value = (List<Object>)ObjectInspectorUtils.copyToStandardObject(serde.deserialize(container),
         serde.getObjectInspector(), ObjectInspectorCopyOption.WRITABLE);
+
     if(value == null) {
       key = EMPTY_OBJECT_ARRAY;
     } else {
       key = value.toArray();
     }
   }
-  
-  public void write(MapJoinObjectSerDeContext context, ObjectOutputStream out) 
+
+  public void write(MapJoinObjectSerDeContext context, ObjectOutputStream out)
   throws IOException, SerDeException {
     SerDe serde = context.getSerDe();
     ObjectInspector objectInspector = context.getStandardOI();
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/persistence/MapJoinRowContainer.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/persistence/MapJoinRowContainer.java
index cab3db3b1a..b7f66fe82d 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/persistence/MapJoinRowContainer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/persistence/MapJoinRowContainer.java
@@ -104,30 +104,34 @@ public MapJoinRowContainer copy() {
     }
     return result;
   }
-  
-  @SuppressWarnings({"unchecked"})
-  public void read(MapJoinObjectSerDeContext context, ObjectInputStream in, Writable container) 
+
+  public void read(MapJoinObjectSerDeContext context, ObjectInputStream in, Writable container)
   throws IOException, SerDeException {
     clear();
-    SerDe serde = context.getSerDe();
     long numRows = in.readLong();
     for (long rowIndex = 0L; rowIndex < numRows; rowIndex++) {
-      container.readFields(in);      
-      List<Object> value = (List<Object>)ObjectInspectorUtils.copyToStandardObject(serde.deserialize(container),
-          serde.getObjectInspector(), ObjectInspectorCopyOption.WRITABLE);
-      if(value == null) {
-        add(toList(EMPTY_OBJECT_ARRAY));
-      } else {
-        Object[] valuesArray = value.toArray();
-        if (context.hasFilterTag()) {
-          aliasFilter &= ((ShortWritable)valuesArray[valuesArray.length - 1]).get();
-        }
-        add(toList(valuesArray));
+      container.readFields(in);
+      read(context, container);
+    }
+  }
+
+  @SuppressWarnings("unchecked")
+  public void read(MapJoinObjectSerDeContext context, Writable currentValue) throws SerDeException {
+    SerDe serde = context.getSerDe();
+    List<Object> value = (List<Object>)ObjectInspectorUtils.copyToStandardObject(serde.deserialize(currentValue),
+        serde.getObjectInspector(), ObjectInspectorCopyOption.WRITABLE);
+    if(value == null) {
+      add(toList(EMPTY_OBJECT_ARRAY));
+    } else {
+      Object[] valuesArray = value.toArray();
+      if (context.hasFilterTag()) {
+        aliasFilter &= ((ShortWritable)valuesArray[valuesArray.length - 1]).get();
       }
+      add(toList(valuesArray));
     }
   }
-  
-  public void write(MapJoinObjectSerDeContext context, ObjectOutputStream out) 
+
+  public void write(MapJoinObjectSerDeContext context, ObjectOutputStream out)
   throws IOException, SerDeException {
     SerDe serde = context.getSerDe();
     ObjectInspector valueObjectInspector = context.getStandardOI();
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/persistence/MapJoinTableContainerSerDe.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/persistence/MapJoinTableContainerSerDe.java
index 06151d5bd1..83ba0f0a0a 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/persistence/MapJoinTableContainerSerDe.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/persistence/MapJoinTableContainerSerDe.java
@@ -40,6 +40,14 @@ public MapJoinTableContainerSerDe(MapJoinObjectSerDeContext keyContext,
     this.keyContext = keyContext;
     this.valueContext = valueContext;
   }
+
+  public MapJoinObjectSerDeContext getKeyContext() {
+    return keyContext;
+  }
+  public MapJoinObjectSerDeContext getValueContext() {
+    return valueContext;
+  }
+
   @SuppressWarnings({"unchecked"})
   public MapJoinTableContainer load(ObjectInputStream in) 
       throws HiveException {
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/vector/VectorReduceSinkOperator.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/vector/VectorReduceSinkOperator.java
index e60fa9e4f0..661725e9c0 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/vector/VectorReduceSinkOperator.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/vector/VectorReduceSinkOperator.java
@@ -137,7 +137,7 @@ public void assign(VectorExpressionWriter[] writers,
         colNames = String.format("%s %s", colNames, colName);
       }
 
-      LOG.info(String.format("keyObjectInspector [%s]%s => %s",
+      LOG.debug(String.format("keyObjectInspector [%s]%s => %s",
           keyObjectInspector.getClass(),
           keyObjectInspector,
           colNames));
@@ -169,7 +169,7 @@ public void assign(VectorExpressionWriter[] writers,
         colNames = String.format("%s %s", colNames, colName);
       }
 
-      LOG.info(String.format("valueObjectInspector [%s]%s => %s",
+      LOG.debug(String.format("valueObjectInspector [%s]%s => %s",
           valueObjectInspector.getClass(),
           valueObjectInspector,
           colNames));
@@ -198,7 +198,7 @@ public void assign(VectorExpressionWriter[] writers,
   public void processOp(Object row, int tag) throws HiveException {
     VectorizedRowBatch vrg = (VectorizedRowBatch) row;
 
-    LOG.info(String.format("sinking %d rows, %d values, %d keys, %d parts",
+    LOG.debug(String.format("sinking %d rows, %d values, %d keys, %d parts",
         vrg.size,
         valueEval.length,
         keyEval.length,
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/io/HiveInputFormat.java b/ql/src/java/org/apache/hadoop/hive/ql/io/HiveInputFormat.java
index 729ed136ea..99172d49c1 100755
--- a/ql/src/java/org/apache/hadoop/hive/ql/io/HiveInputFormat.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/io/HiveInputFormat.java
@@ -24,6 +24,7 @@
 import java.util.ArrayList;
 import java.util.HashMap;
 import java.util.Iterator;
+import java.util.List;
 import java.util.Map;
 import java.util.Map.Entry;
 
@@ -42,6 +43,7 @@
 import org.apache.hadoop.hive.ql.plan.MapWork;
 import org.apache.hadoop.hive.ql.plan.OperatorDesc;
 import org.apache.hadoop.hive.ql.plan.PartitionDesc;
+import org.apache.hadoop.hive.ql.plan.TableDesc;
 import org.apache.hadoop.hive.ql.plan.TableScanDesc;
 import org.apache.hadoop.hive.serde.serdeConstants;
 import org.apache.hadoop.hive.serde2.ColumnProjectionUtils;
@@ -254,6 +256,43 @@ protected void init(JobConf job) {
     pathToPartitionInfo = mrwork.getPathToPartitionInfo();
   }
 
+  /*
+   * AddSplitsForGroup collects separate calls to setInputPaths into one where possible.
+   * The reason for this is that this is faster on some InputFormats. E.g.: Orc will start
+   * a threadpool to do the work and calling it multiple times unnecessarily will create a lot
+   * of unnecessary thread pools.
+   */
+  private void addSplitsForGroup(List<Path> dirs, TableScanOperator tableScan, JobConf conf,
+      InputFormat inputFormat, Class<? extends InputFormat> inputFormatClass, int splits,
+      TableDesc table, List<InputSplit> result) throws IOException {
+
+    Utilities.copyTableJobPropertiesToConf(table, conf);
+
+    if (tableScan != null) {
+      pushFilters(conf, tableScan);
+    }
+
+    FileInputFormat.setInputPaths(conf, dirs.toArray(new Path[dirs.size()]));
+    conf.setInputFormat(inputFormat.getClass());
+
+    int headerCount = 0;
+    int footerCount = 0;
+    if (table != null) {
+      headerCount = Utilities.getHeaderCount(table);
+      footerCount = Utilities.getFooterCount(table, conf);
+      if (headerCount != 0 || footerCount != 0) {
+        
+        // Input file has header or footer, cannot be splitted.
+        conf.setLong("mapred.min.split.size", Long.MAX_VALUE);
+      }
+    }
+
+    InputSplit[] iss = inputFormat.getSplits(conf, splits);
+    for (InputSplit is : iss) {
+      result.add(new HiveInputSplit(is, inputFormatClass.getName()));
+    }
+  }
+
   public InputSplit[] getSplits(JobConf job, int numSplits) throws IOException {
     PerfLogger perfLogger = PerfLogger.getPerfLogger();
     perfLogger.PerfLogBegin(CLASS_NAME, PerfLogger.GET_SPLITS);
@@ -264,24 +303,28 @@ public InputSplit[] getSplits(JobConf job, int numSplits) throws IOException {
       throw new IOException("No input paths specified in job");
     }
     JobConf newjob = new JobConf(job);
-    ArrayList<InputSplit> result = new ArrayList<InputSplit>();
+    List<InputSplit> result = new ArrayList<InputSplit>();
+
+    List<Path> currentDirs = new ArrayList<Path>();
+    Class<? extends InputFormat> currentInputFormatClass = null;
+    TableDesc currentTable = null;
+    TableScanOperator currentTableScan = null;
 
     // for each dir, get the InputFormat, and do getSplits.
     for (Path dir : dirs) {
       PartitionDesc part = getPartitionDescFromPath(pathToPartitionInfo, dir);
-      // create a new InputFormat instance if this is the first time to see this
-      // class
-      Class inputFormatClass = part.getInputFileFormatClass();
-      InputFormat inputFormat = getInputFormatFromCache(inputFormatClass, job);
-      Utilities.copyTableJobPropertiesToConf(part.getTableDesc(), newjob);
+      Class<? extends InputFormat> inputFormatClass = part.getInputFileFormatClass();
+      TableDesc table = part.getTableDesc();
+      TableScanOperator tableScan = null;
+
+      List<String> aliases =
+          mrwork.getPathToAliases().get(dir.toUri().toString());
 
       // Make filter pushdown information available to getSplits.
-      ArrayList<String> aliases =
-        mrwork.getPathToAliases().get(dir.toUri().toString());
       if ((aliases != null) && (aliases.size() == 1)) {
         Operator op = mrwork.getAliasToWork().get(aliases.get(0));
         if ((op != null) && (op instanceof TableScanOperator)) {
-          TableScanOperator tableScan = (TableScanOperator) op;
+          tableScan = (TableScanOperator) op;
           // push down projections.
           ColumnProjectionUtils.appendReadColumns(
               newjob, tableScan.getNeededColumnIDs(), tableScan.getNeededColumns());
@@ -290,26 +333,35 @@ public InputSplit[] getSplits(JobConf job, int numSplits) throws IOException {
         }
       }
 
-      FileInputFormat.setInputPaths(newjob, dir);
-      newjob.setInputFormat(inputFormat.getClass());
-      TableDesc tableDesc = part.getTableDesc();
-      int headerCount = 0;
-      int footerCount = 0;
-      if (tableDesc != null) {
-        headerCount = Utilities.getHeaderCount(tableDesc);
-        footerCount = Utilities.getFooterCount(tableDesc, newjob);
-        if (headerCount != 0 || footerCount != 0) {
-
-          // Input file has header or footer, cannot be splitted.
-          newjob.setLong("mapred.min.split.size", Long.MAX_VALUE);
-        }
+      if (!currentDirs.isEmpty() &&
+          inputFormatClass.equals(currentInputFormatClass) &&
+          table.equals(currentTable) &&
+          tableScan == currentTableScan) {
+        currentDirs.add(dir);
+        continue;
       }
-      InputSplit[] iss = inputFormat.getSplits(newjob, numSplits / dirs.length);
-      for (InputSplit is : iss) {
-        result.add(new HiveInputSplit(is, inputFormatClass.getName()));
+
+      if (!currentDirs.isEmpty()) {
+        LOG.info("Generating splits");
+        addSplitsForGroup(currentDirs, currentTableScan, newjob,
+            getInputFormatFromCache(currentInputFormatClass, job),
+            currentInputFormatClass, currentDirs.size()*(numSplits / dirs.length),
+            currentTable, result);
       }
+
+      currentDirs.clear();
+      currentDirs.add(dir);
+      currentTableScan = tableScan;
+      currentTable = table;
+      currentInputFormatClass = inputFormatClass;
     }
 
+    LOG.info("Generating splits");
+    addSplitsForGroup(currentDirs, currentTableScan, newjob,
+        getInputFormatFromCache(currentInputFormatClass, job),
+        currentInputFormatClass, currentDirs.size()*(numSplits / dirs.length),
+        currentTable, result);
+
     LOG.info("number of splits " + result.size());
     perfLogger.PerfLogEnd(CLASS_NAME, PerfLogger.GET_SPLITS);
     return result.toArray(new HiveInputSplit[result.size()]);
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/io/IOContext.java b/ql/src/java/org/apache/hadoop/hive/ql/io/IOContext.java
index 45a49c501f..8cbf32f804 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/io/IOContext.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/io/IOContext.java
@@ -19,6 +19,7 @@
 package org.apache.hadoop.hive.ql.io;
 
 import org.apache.hadoop.fs.Path;
+import org.apache.hadoop.hive.ql.session.SessionState;
 
 
 /**
@@ -37,12 +38,19 @@ public class IOContext {
     protected synchronized IOContext initialValue() { return new IOContext(); }
  };
 
+ private static IOContext ioContext = new IOContext();
+
   public static IOContext get() {
+    if (SessionState.get() == null) {
+      // this happens on the backend. only one io context needed.
+      return ioContext;
+    }
     return IOContext.threadLocal.get();
   }
 
   public static void clear() {
     IOContext.threadLocal.remove();
+    ioContext = new IOContext();
   }
 
   long currentBlockStart;
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/io/orc/OrcFile.java b/ql/src/java/org/apache/hadoop/hive/ql/io/orc/OrcFile.java
index f55e1c4f5b..54aee08373 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/io/orc/OrcFile.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/io/orc/OrcFile.java
@@ -18,14 +18,15 @@
 
 package org.apache.hadoop.hive.ql.io.orc;
 
+import java.io.IOException;
+
 import org.apache.hadoop.conf.Configuration;
 import org.apache.hadoop.fs.FileSystem;
 import org.apache.hadoop.fs.Path;
 import org.apache.hadoop.hive.conf.HiveConf;
+import org.apache.hadoop.hive.ql.io.orc.Reader.FileMetaInfo;
 import org.apache.hadoop.hive.serde2.objectinspector.ObjectInspector;
 
-import java.io.IOException;
-
 /**
  * Contains factory methods to read or write ORC files.
  */
@@ -126,6 +127,11 @@ public static Reader createReader(FileSystem fs, Path path
     return new ReaderImpl(fs, path);
   }
 
+  public static Reader createReader(FileSystem fs, Path path, FileMetaInfo fileMetaInfo)
+      throws IOException {
+    return new ReaderImpl(fs, path, fileMetaInfo);
+  }
+
   /**
    * Options for creating ORC file writers.
    */
@@ -307,4 +313,5 @@ MemoryManager getMemoryManager(Configuration conf) {
     }
     return memoryManager;
   }
+
 }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/io/orc/OrcInputFormat.java b/ql/src/java/org/apache/hadoop/hive/ql/io/orc/OrcInputFormat.java
index abdc1655e9..d189ddebbf 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/io/orc/OrcInputFormat.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/io/orc/OrcInputFormat.java
@@ -27,6 +27,7 @@
 import java.util.concurrent.ExecutorService;
 import java.util.concurrent.Executors;
 import java.util.concurrent.TimeUnit;
+import java.util.concurrent.atomic.AtomicInteger;
 
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
@@ -37,12 +38,18 @@
 import org.apache.hadoop.fs.Path;
 import org.apache.hadoop.fs.PathFilter;
 import org.apache.hadoop.hive.conf.HiveConf;
+import org.apache.hadoop.hive.conf.HiveConf.ConfVars;
 import org.apache.hadoop.hive.ql.exec.Utilities;
 import org.apache.hadoop.hive.ql.exec.vector.VectorizedInputFormatInterface;
 import org.apache.hadoop.hive.ql.exec.vector.VectorizedRowBatch;
 import org.apache.hadoop.hive.ql.io.InputFormatChecker;
+import org.apache.hadoop.hive.ql.io.orc.Metadata;
+import org.apache.hadoop.hive.ql.io.orc.OrcInputFormat.FileGenerator;
+import org.apache.hadoop.hive.ql.io.orc.OrcInputFormat.SplitGenerator;
+import org.apache.hadoop.hive.ql.io.orc.Reader.FileMetaInfo;
 import org.apache.hadoop.hive.ql.io.sarg.PredicateLeaf;
 import org.apache.hadoop.hive.ql.io.sarg.SearchArgument;
+import org.apache.hadoop.hive.ql.log.PerfLogger;
 import org.apache.hadoop.hive.ql.io.sarg.SearchArgument.TruthValue;
 import org.apache.hadoop.hive.ql.plan.TableScanDesc;
 import org.apache.hadoop.hive.serde.serdeConstants;
@@ -59,6 +66,10 @@
 import org.apache.hadoop.mapred.RecordReader;
 import org.apache.hadoop.mapred.Reporter;
 import org.apache.hadoop.util.StringUtils;
+
+import com.google.common.cache.Cache;
+import com.google.common.cache.CacheBuilder;
+import com.google.common.util.concurrent.ThreadFactoryBuilder;
 /**
  * A MapReduce/Hive input format for ORC files.
  */
@@ -70,9 +81,13 @@ public class OrcInputFormat  implements InputFormat<NullWritable, OrcStruct>,
   private static final Log LOG = LogFactory.getLog(OrcInputFormat.class);
   static final String MIN_SPLIT_SIZE = "mapred.min.split.size";
   static final String MAX_SPLIT_SIZE = "mapred.max.split.size";
+
   private static final long DEFAULT_MIN_SPLIT_SIZE = 16 * 1024 * 1024;
   private static final long DEFAULT_MAX_SPLIT_SIZE = 256 * 1024 * 1024;
 
+  private static final PerfLogger perfLogger = PerfLogger.getPerfLogger();
+  private static final String CLASS_NAME = ReaderImpl.class.getName();
+
   /**
    * When picking the hosts for a split that crosses block boundaries,
    * any drop any host that has fewer than MIN_INCLUDED_LOCATION of the
@@ -169,7 +184,7 @@ public static SearchArgument createSarg(List<OrcProto.Type> types, Configuration
     String serializedPushdown = conf.get(TableScanDesc.FILTER_EXPR_CONF_STR);
     if (serializedPushdown == null
         || conf.get(ColumnProjectionUtils.READ_COLUMN_NAMES_CONF_STR) == null) {
-      LOG.info("No ORC pushdown predicate");
+      LOG.debug("No ORC pushdown predicate");
       return null;
     }
     SearchArgument sarg = SearchArgument.FACTORY.create
@@ -181,7 +196,9 @@ public static SearchArgument createSarg(List<OrcProto.Type> types, Configuration
   public static String[] getIncludedColumnNames(
       List<OrcProto.Type> types, boolean[] includedColumns, Configuration conf) {
     String columnNamesString = conf.get(ColumnProjectionUtils.READ_COLUMN_NAMES_CONF_STR);
-    LOG.info("included columns names = " + columnNamesString);
+    if (LOG.isDebugEnabled()) {
+      LOG.debug("included columns names = " + columnNamesString);
+    }
     if (columnNamesString == null || conf.get(TableScanDesc.FILTER_EXPR_CONF_STR) == null) {
       return null;
     }
@@ -236,13 +253,27 @@ public static boolean[] findIncludedColumns(List<OrcProto.Type> types, Configura
           reporter);
       return (RecordReader) vorr;
     }
-
-    FileSplit fileSplit = (FileSplit) inputSplit;
-    Path path = fileSplit.getPath();
+    FileSplit fSplit = (FileSplit)inputSplit;
+    reporter.setStatus(fSplit.toString());
+    Path path = fSplit.getPath();
     FileSystem fs = path.getFileSystem(conf);
-    reporter.setStatus(fileSplit.toString());
-    return new OrcRecordReader(OrcFile.createReader(fs, path), conf,
-                               fileSplit.getStart(), fileSplit.getLength());
+    Reader reader = null;
+
+    if(!(fSplit instanceof OrcSplit)){
+      //If CombineHiveInputFormat is used, it works with FileSplit and not OrcSplit
+      reader = OrcFile.createReader(fs, path);
+    } else {
+      //We have OrcSplit, which may have footer metadata cached, so use the appropriate reader
+      //constructor
+      OrcSplit orcSplit = (OrcSplit) fSplit;
+      if (orcSplit.hasFooter()) {
+        FileMetaInfo fMetaInfo = orcSplit.getFileMetaInfo();
+        reader = OrcFile.createReader(fs, path, fMetaInfo);
+      } else {
+        reader = OrcFile.createReader(fs, path);
+      }
+    }
+    return new OrcRecordReader(reader, conf, fSplit.getStart(), fSplit.getLength());
   }
 
   @Override
@@ -299,13 +330,19 @@ static Path[] getInputPaths(JobConf conf) throws IOException {
    * the different worker threads.
    */
   static class Context {
-    private final ExecutorService threadPool = Executors.newFixedThreadPool(10);
-    private final List<FileSplit> splits = new ArrayList<FileSplit>(10000);
+    private final Configuration conf;
+    private static Cache<Path, FileInfo> footerCache;
+    private final ExecutorService threadPool;
+    private final List<OrcSplit> splits = new ArrayList<OrcSplit>(10000);
     private final List<Throwable> errors = new ArrayList<Throwable>();
     private final HadoopShims shims = ShimLoader.getHadoopShims();
-    private final Configuration conf;
     private final long maxSize;
     private final long minSize;
+    private final boolean footerInSplits;
+    private final boolean cacheStripeDetails;
+    private final AtomicInteger cacheHitCounter = new AtomicInteger(0);
+    private final AtomicInteger numFilesCounter = new AtomicInteger(0);
+    private Throwable fatalError = null;
 
     /**
      * A count of the number of threads that may create more work for the
@@ -317,6 +354,22 @@ static class Context {
       this.conf = conf;
       minSize = conf.getLong(MIN_SPLIT_SIZE, DEFAULT_MIN_SPLIT_SIZE);
       maxSize = conf.getLong(MAX_SPLIT_SIZE, DEFAULT_MAX_SPLIT_SIZE);
+      footerInSplits = HiveConf.getBoolVar(conf, ConfVars.HIVE_ORC_INCLUDE_FILE_FOOTER_IN_SPLITS);
+      int cacheStripeDetailsSize = HiveConf.getIntVar(conf,
+          ConfVars.HIVE_ORC_CACHE_STRIPE_DETAILS_SIZE);
+      int numThreads = HiveConf.getIntVar(conf, ConfVars.HIVE_ORC_COMPUTE_SPLITS_NUM_THREADS);
+
+      cacheStripeDetails = (cacheStripeDetailsSize > 0);
+
+      threadPool = Executors.newFixedThreadPool(numThreads,
+          new ThreadFactoryBuilder().setDaemon(true).setNameFormat("ORC_GET_SPLITS #%d").build());
+
+      synchronized (Context.class) {
+        if (footerCache == null && cacheStripeDetails) {
+          footerCache = CacheBuilder.newBuilder().concurrencyLevel(numThreads)
+              .initialCapacity(cacheStripeDetailsSize).softValues().build();
+        }
+      }
     }
 
     int getSchedulers() {
@@ -329,7 +382,7 @@ int getSchedulers() {
      *     the back.
      * @result the Nth file split
      */
-    FileSplit getResult(int index) {
+    OrcSplit getResult(int index) {
       if (index >= 0) {
         return splits.get(index);
       } else {
@@ -346,10 +399,14 @@ List<Throwable> getErrors() {
      * @param runnable the object to run
      */
     synchronized void schedule(Runnable runnable) {
-      if (runnable instanceof FileGenerator) {
-        schedulers += 1;
+      if (fatalError == null) {
+        if (runnable instanceof FileGenerator || runnable instanceof SplitGenerator) {
+          schedulers += 1;
+        }
+        threadPool.execute(runnable);
+      } else {
+        throw new RuntimeException("serious problem", fatalError);
       }
-      threadPool.execute(runnable);
     }
 
     /**
@@ -362,6 +419,11 @@ synchronized void decrementSchedulers() {
       }
     }
 
+    synchronized void notifyOnNonIOException(Throwable th) {
+      fatalError = th;
+      notify();
+    }
+
     /**
      * Wait until all of the tasks are done. It waits until all of the
      * threads that may create more work are done and then shuts down the
@@ -371,6 +433,10 @@ synchronized void waitForTasks() {
       try {
         while (schedulers != 0) {
           wait();
+          if (fatalError != null) {
+            threadPool.shutdownNow();
+            throw new RuntimeException("serious problem", fatalError);
+          }
         }
         threadPool.shutdown();
         threadPool.awaitTermination(Long.MAX_VALUE, TimeUnit.DAYS);
@@ -406,17 +472,56 @@ public void run() {
         while (itr.hasNext()) {
           FileStatus file = itr.next();
           if (!file.isDir()) {
-            context.schedule(new SplitGenerator(context, fs, file));
+            FileInfo fileInfo = null;
+            if (context.cacheStripeDetails) {
+              fileInfo = verifyCachedFileInfo(file);
+            }
+            SplitGenerator spgen = new SplitGenerator(context, fs, file, fileInfo);
+            spgen.schedule();
           }
         }
-        // mark the fact that we are done
-        context.decrementSchedulers();
       } catch (Throwable th) {
-        context.decrementSchedulers();
+        if (!(th instanceof IOException)) {
+          LOG.error("Unexpected Exception", th);
+        }
         synchronized (context.errors) {
           context.errors.add(th);
         }
+        if (!(th instanceof IOException)) {
+          context.notifyOnNonIOException(th);
+        }
+      } finally {
+        context.decrementSchedulers();
+      }
+    }
+
+    private FileInfo verifyCachedFileInfo(FileStatus file) {
+      context.numFilesCounter.incrementAndGet();
+      FileInfo fileInfo = Context.footerCache.getIfPresent(file.getPath());
+      if (fileInfo != null) {
+        if (LOG.isDebugEnabled()) {
+          LOG.debug("Info cached for path: " + file.getPath());
+        }
+        if (fileInfo.modificationTime == file.getModificationTime() && fileInfo.size == file.getLen()) {
+          // Cached copy is valid
+          context.cacheHitCounter.incrementAndGet();
+          return fileInfo;
+        } else {
+          // Invalidate
+          Context.footerCache.invalidate(file.getPath());
+          if (LOG.isDebugEnabled()) {
+            LOG.debug("Meta-Info for : " + file.getPath() + " changed. CachedModificationTime: "
+              + fileInfo.modificationTime + ", CurrentModificationTime: "
+              + file.getModificationTime()
+              + ", CachedLength: " + fileInfo.size + ", CurrentLength: " + file.getLen());
+          }
+        }
+      } else {
+        if (LOG.isDebugEnabled()) {
+          LOG.debug("Info not cached for path: " + file.getPath());
+        }
       }
+      return null;
     }
   }
 
@@ -430,13 +535,20 @@ static final class SplitGenerator implements Runnable {
     private final FileStatus file;
     private final long blockSize;
     private final BlockLocation[] locations;
+    private final FileInfo fileInfo;
+    private Iterable<StripeInformation> stripes;
+    private FileMetaInfo fileMetaInfo;
+    private Metadata metadata;
+    private List<OrcProto.Type> types;
+
 
     SplitGenerator(Context context, FileSystem fs,
-                   FileStatus file) throws IOException {
+                   FileStatus file, FileInfo fileInfo) throws IOException {
       this.context = context;
       this.fs = fs;
       this.file = file;
       this.blockSize = file.getBlockSize();
+      this.fileInfo = fileInfo;
       locations = context.shims.getLocations(fs, file);
     }
 
@@ -444,6 +556,19 @@ Path getPath() {
       return file.getPath();
     }
 
+    void schedule() throws IOException {
+      if(locations.length == 1 && file.getLen() < context.maxSize) {
+        String[] hosts = locations[0].getHosts();
+        synchronized (context.splits) {
+          context.splits.add(new OrcSplit(file.getPath(), 0, file.getLen(),
+                hosts, fileMetaInfo));
+        }
+      } else {
+        // if it requires a compute task
+        context.schedule(this);
+      }
+    }
+
     @Override
     public String toString() {
       return "splitter(" + file.getPath() + ")";
@@ -475,9 +600,10 @@ static long getOverlap(long offset1, long length1,
      * are written with large block sizes.
      * @param offset the start of the split
      * @param length the length of the split
+     * @param fileMetaInfo file metadata from footer and postscript
      * @throws IOException
      */
-    void createSplit(long offset, long length) throws IOException {
+    void createSplit(long offset, long length, FileMetaInfo fileMetaInfo) throws IOException {
       String[] hosts;
       if ((offset % blockSize) + length <= blockSize) {
         // handle the single block case
@@ -521,8 +647,8 @@ void createSplit(long offset, long length) throws IOException {
         hostList.toArray(hosts);
       }
       synchronized (context.splits) {
-        context.splits.add(new FileSplit(file.getPath(), offset, length,
-            hosts));
+        context.splits.add(new OrcSplit(file.getPath(), offset, length,
+            hosts, fileMetaInfo));
       }
     }
 
@@ -533,9 +659,8 @@ void createSplit(long offset, long length) throws IOException {
     @Override
     public void run() {
       try {
-        Reader orcReader = OrcFile.createReader(fs, file.getPath());
+        populateAndCacheStripeDetails();
         Configuration conf = context.conf;
-        List<OrcProto.Type> types = orcReader.getTypes();
         SearchArgument sarg = createSarg(types, conf);
         List<StripeStatistics> stripeStats = null;
         int[] filterColumns = null;
@@ -558,14 +683,13 @@ public void run() {
             }
           }
 
-          Metadata metadata = orcReader.getMetadata();
           stripeStats = metadata.getStripeStatistics();
         }
 
         long currentOffset = -1;
         long currentLength = 0;
         int idx = -1;
-        for(StripeInformation stripe: orcReader.getStripes()) {
+        for(StripeInformation stripe: stripes) {
           idx++;
 
           // eliminate stripes that doesn't satisfy the predicate condition
@@ -579,7 +703,7 @@ public void run() {
 
             // create split for the previous unfinished stripe
             if (currentOffset != -1) {
-              createSplit(currentOffset, currentLength);
+              createSplit(currentOffset, currentLength, fileMetaInfo);
               currentOffset = -1;
             }
             continue;
@@ -589,7 +713,7 @@ public void run() {
           // crossed a block boundary, cut the input split here.
           if (currentOffset != -1 && currentLength > context.minSize &&
               (currentOffset / blockSize != stripe.getOffset() / blockSize)) {
-            createSplit(currentOffset, currentLength);
+            createSplit(currentOffset, currentLength, fileMetaInfo);
             currentOffset = -1;
           }
           // if we aren't building a split, start a new one.
@@ -600,17 +724,69 @@ public void run() {
             currentLength += stripe.getLength();
           }
           if (currentLength >= context.maxSize) {
-            createSplit(currentOffset, currentLength);
+            createSplit(currentOffset, currentLength, fileMetaInfo);
             currentOffset = -1;
           }
         }
         if (currentOffset != -1) {
-          createSplit(currentOffset, currentLength);
+          createSplit(currentOffset, currentLength, fileMetaInfo);
         }
       } catch (Throwable th) {
+        if (!(th instanceof IOException)) {
+          LOG.error("Unexpected Exception", th);
+        }
         synchronized (context.errors) {
           context.errors.add(th);
         }
+        if (!(th instanceof IOException)) {
+          context.notifyOnNonIOException(th);
+        }
+      } finally {
+        context.decrementSchedulers();
+      }
+    }
+
+    private void populateAndCacheStripeDetails() {
+      try {
+        Reader orcReader;
+        boolean found = false;
+        if (fileInfo != null) {
+          found = true;
+          stripes = fileInfo.stripeInfos;
+          fileMetaInfo = fileInfo.fileMetaInfo;
+          metadata = fileInfo.metadata;
+          types = fileInfo.types;
+          // For multiple runs, in case sendSplitsInFooter changes
+          if (fileMetaInfo == null && context.footerInSplits) {
+            orcReader = OrcFile.createReader(fs, file.getPath());
+            fileInfo.fileMetaInfo = orcReader.getFileMetaInfo();
+            fileInfo.metadata = orcReader.getMetadata();
+            fileInfo.types = orcReader.getTypes();
+          }
+        }
+        if (!found) {
+          orcReader = OrcFile.createReader(fs, file.getPath());
+          stripes = orcReader.getStripes();
+          metadata = orcReader.getMetadata();
+          types = orcReader.getTypes();
+          fileMetaInfo = context.footerInSplits ? orcReader.getFileMetaInfo() : null;
+          if (context.cacheStripeDetails) {
+            // Populate into cache.
+            Context.footerCache.put(file.getPath(),
+                new FileInfo(file.getModificationTime(), file.getLen(), stripes, metadata, 
+                             types, fileMetaInfo));
+          }
+        }
+      } catch (Throwable th) {
+        if (!(th instanceof IOException)) {
+          LOG.error("Unexpected Exception", th);
+        }
+        synchronized (context.errors) {
+          context.errors.add(th);
+        }
+        if (!(th instanceof IOException)) {
+          context.notifyOnNonIOException(th);
+        }
       }
     }
 
@@ -677,13 +853,13 @@ private Object getMin(ColumnStatistics index) {
         return null;
       }
     }
-
   }
 
   @Override
   public InputSplit[] getSplits(JobConf job,
                                 int numSplits) throws IOException {
     // use threads to resolve directories into splits
+    perfLogger.PerfLogBegin(CLASS_NAME, PerfLogger.ORC_GET_SPLITS);
     Context context = new Context(job);
     for(Path dir: getInputPaths(job)) {
       FileSystem fs = dir.getFileSystem(job);
@@ -698,13 +874,44 @@ public InputSplit[] getSplits(JobConf job,
         if (th instanceof IOException) {
           errors.add((IOException) th);
         } else {
-          throw new IOException("serious problem", th);
+          throw new RuntimeException("serious problem", th);
         }
       }
       throw new InvalidInputException(errors);
     }
     InputSplit[] result = new InputSplit[context.splits.size()];
     context.splits.toArray(result);
+    if (context.cacheStripeDetails) {
+      LOG.info("FooterCacheHitRatio: " + context.cacheHitCounter.get() + "/"
+          + context.numFilesCounter.get());
+    }
+    perfLogger.PerfLogEnd(CLASS_NAME, PerfLogger.ORC_GET_SPLITS);
     return result;
   }
+
+  /**
+   * FileInfo.
+   *
+   * Stores information relevant to split generation for an ORC File.
+   *
+   */
+  private static class FileInfo {
+    long modificationTime;
+    long size;
+    Iterable<StripeInformation> stripeInfos;
+    FileMetaInfo fileMetaInfo;
+    Metadata metadata;
+    List<OrcProto.Type> types;
+
+
+    FileInfo(long modificationTime, long size, Iterable<StripeInformation> stripeInfos, 
+        Metadata metadata, List<OrcProto.Type> types, FileMetaInfo fileMetaInfo) {
+      this.modificationTime = modificationTime;
+      this.size = size;
+      this.stripeInfos = stripeInfos;
+      this.fileMetaInfo = fileMetaInfo;
+      this.metadata = metadata;
+      this.types = types;
+    }
+  }
 }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/io/orc/OrcSplit.java b/ql/src/java/org/apache/hadoop/hive/ql/io/orc/OrcSplit.java
new file mode 100644
index 0000000000..0cdf7ed9d4
--- /dev/null
+++ b/ql/src/java/org/apache/hadoop/hive/ql/io/orc/OrcSplit.java
@@ -0,0 +1,92 @@
+package org.apache.hadoop.hive.ql.io.orc;
+
+import java.io.DataInput;
+import java.io.DataOutput;
+import java.io.IOException;
+import java.nio.ByteBuffer;
+
+import org.apache.hadoop.fs.Path;
+import org.apache.hadoop.hive.ql.io.orc.Reader.FileMetaInfo;
+import org.apache.hadoop.io.Text;
+import org.apache.hadoop.io.WritableUtils;
+import org.apache.hadoop.mapred.FileSplit;
+
+
+
+/**
+ * OrcFileSplit. Holds file meta info
+ *
+ */
+public class OrcSplit extends FileSplit {
+  private Reader.FileMetaInfo fileMetaInfo;
+  private boolean hasFooter;
+
+  protected OrcSplit(){
+    //The FileSplit() constructor in hadoop 0.20 and 1.x is package private so can't use it.
+    //This constructor is used to create the object and then call readFields()
+    // so just pass nulls to this super constructor.
+    super(null, 0, 0, (String[])null);
+  }
+
+  public OrcSplit(Path path, long offset, long length, String[] hosts,
+      FileMetaInfo fileMetaInfo) {
+    super(path, offset, length, hosts);
+    this.fileMetaInfo = fileMetaInfo;
+    hasFooter = this.fileMetaInfo != null;
+  }
+
+  @Override
+  public void write(DataOutput out) throws IOException {
+    //serialize path, offset, length using FileSplit
+    super.write(out);
+
+    // Whether footer information follows.
+    out.writeBoolean(hasFooter);
+
+    if (hasFooter) {
+      // serialize FileMetaInfo fields
+      Text.writeString(out, fileMetaInfo.compressionType);
+      WritableUtils.writeVInt(out, fileMetaInfo.bufferSize);
+      WritableUtils.writeVInt(out, fileMetaInfo.metadataSize);
+
+      // serialize FileMetaInfo field footer
+      ByteBuffer footerBuff = fileMetaInfo.footerBuffer;
+      footerBuff.reset();
+
+      // write length of buffer
+      WritableUtils.writeVInt(out, footerBuff.limit() - footerBuff.position());
+      out.write(footerBuff.array(), footerBuff.position(),
+          footerBuff.limit() - footerBuff.position());
+    }
+  }
+
+  @Override
+  public void readFields(DataInput in) throws IOException {
+    //deserialize path, offset, length using FileSplit
+    super.readFields(in);
+
+    hasFooter = in.readBoolean();
+
+    if (hasFooter) {
+      // deserialize FileMetaInfo fields
+      String compressionType = Text.readString(in);
+      int bufferSize = WritableUtils.readVInt(in);
+      int metadataSize = WritableUtils.readVInt(in);
+
+      // deserialize FileMetaInfo field footer
+      int footerBuffSize = WritableUtils.readVInt(in);
+      ByteBuffer footerBuff = ByteBuffer.allocate(footerBuffSize);
+      in.readFully(footerBuff.array(), 0, footerBuffSize);
+
+      fileMetaInfo = new FileMetaInfo(compressionType, bufferSize, metadataSize, footerBuff);
+    }
+  }
+
+  public FileMetaInfo getFileMetaInfo(){
+    return fileMetaInfo;
+  }
+
+  public boolean hasFooter() {
+    return hasFooter;
+  }
+}
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/io/orc/Reader.java b/ql/src/java/org/apache/hadoop/hive/ql/io/orc/Reader.java
index b623496e7f..2bab0ce75b 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/io/orc/Reader.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/io/orc/Reader.java
@@ -121,6 +121,30 @@ public interface Reader {
    */
   List<OrcProto.Type> getTypes();
 
+  /**
+   * FileMetaInfo - represents file metadata stored in footer and postscript sections of the file
+   * that is useful for Reader implementation
+   *
+   */
+  class FileMetaInfo{
+    final String compressionType;
+    final int bufferSize;
+    final int metadataSize;
+    final ByteBuffer footerBuffer;
+    FileMetaInfo(String compressionType, int bufferSize, int metadataSize, ByteBuffer footerBuffer){
+      this.compressionType = compressionType;
+      this.bufferSize = bufferSize;
+      this.metadataSize = metadataSize;
+      this.footerBuffer = footerBuffer;
+    }
+  }
+
+  /**
+   * Get the metadata stored in footer and postscript sections of the file
+   * @return MetaInfo object with file metadata
+   */
+  FileMetaInfo getFileMetaInfo();
+
   /**
    * Create a RecordReader that will scan the entire file.
    * @param include true for each column that should be included
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/io/orc/ReaderImpl.java b/ql/src/java/org/apache/hadoop/hive/ql/io/orc/ReaderImpl.java
index f143c32fc7..56f25b71a6 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/io/orc/ReaderImpl.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/io/orc/ReaderImpl.java
@@ -35,6 +35,7 @@
 import org.apache.hadoop.fs.Path;
 import org.apache.hadoop.hive.ql.io.orc.OrcProto.Type;
 import org.apache.hadoop.hive.ql.io.sarg.SearchArgument;
+import org.apache.hadoop.hive.ql.log.PerfLogger;
 import org.apache.hadoop.hive.ql.util.JavaDataModel;
 import org.apache.hadoop.hive.serde2.objectinspector.ObjectInspector;
 import org.apache.hadoop.io.Text;
@@ -56,11 +57,18 @@ final class ReaderImpl implements Reader {
   private final int bufferSize;
   private OrcProto.Metadata metadata = null;
   private final int metadataSize;
-  private final int footerOffset;
   private final OrcProto.Footer footer;
   private final ObjectInspector inspector;
   private long deserializedSize = -1;
 
+  //serialized footer - Keeping this around for use by getFileMetaInfo()
+  // will help avoid cpu cycles spend in deserializing at cost of increased
+  // memory footprint.
+  private final ByteBuffer footerByteBuffer;
+
+  private static final PerfLogger perfLogger = PerfLogger.getPerfLogger();
+  private static final String CLASS_NAME = ReaderImpl.class.getName();
+
   private static class StripeInformationImpl
       implements StripeInformation {
     private final OrcProto.StripeInformation stripe;
@@ -276,78 +284,185 @@ static void checkOrcVersion(Log log, Path path, List<Integer> version) {
     }
   }
 
+  /**
+   * Constructor that extracts metadata information from file footer
+   * @param fs
+   * @param path
+   * @throws IOException
+   */
   ReaderImpl(FileSystem fs, Path path) throws IOException {
     this.fileSystem = fs;
     this.path = path;
+
+    FileMetaInfo footerMetaData = extractMetaInfoFromFooter(fs, path);
+
+    MetaInfoObjExtractor rInfo = new MetaInfoObjExtractor(footerMetaData.compressionType,
+        footerMetaData.bufferSize, footerMetaData.metadataSize, footerMetaData.footerBuffer);
+
+    this.footerByteBuffer = footerMetaData.footerBuffer;
+    this.compressionKind = rInfo.compressionKind;
+    this.codec = rInfo.codec;
+    this.bufferSize = rInfo.bufferSize;
+    this.metadataSize = rInfo.metadataSize;
+    this.metadata = rInfo.metadata;
+    this.footer = rInfo.footer;
+    this.inspector = rInfo.inspector;
+  }
+
+
+  /**
+   * Constructor that takes already saved footer meta information. Used for creating RecordReader
+   * from saved information in InputSplit
+   * @param fs
+   * @param path
+   * @param fMetaInfo
+   * @throws IOException
+   */
+  ReaderImpl(FileSystem fs, Path path, FileMetaInfo fMetaInfo)
+      throws IOException {
+    this.fileSystem = fs;
+    this.path = path;
+
+    MetaInfoObjExtractor rInfo = new MetaInfoObjExtractor(
+            fMetaInfo.compressionType,
+            fMetaInfo.bufferSize,
+            fMetaInfo.metadataSize,
+            fMetaInfo.footerBuffer
+            );
+    this.footerByteBuffer = fMetaInfo.footerBuffer;
+    this.compressionKind = rInfo.compressionKind;
+    this.codec = rInfo.codec;
+    this.bufferSize = rInfo.bufferSize;
+    this.metadataSize = rInfo.metadataSize;
+    this.metadata = rInfo.metadata;
+    this.footer = rInfo.footer;
+    this.inspector = rInfo.inspector;
+  }
+
+
+  private static FileMetaInfo extractMetaInfoFromFooter(FileSystem fs, Path path) throws IOException {
     FSDataInputStream file = fs.open(path);
+
+    //read last bytes into buffer to get PostScript
     long size = fs.getFileStatus(path).getLen();
     int readSize = (int) Math.min(size, DIRECTORY_SIZE_GUESS);
     file.seek(size - readSize);
     ByteBuffer buffer = ByteBuffer.allocate(readSize);
     file.readFully(buffer.array(), buffer.arrayOffset() + buffer.position(),
       buffer.remaining());
+
+    //read the PostScript
+    //get length of PostScript
     int psLen = buffer.get(readSize - 1) & 0xff;
     ensureOrcFooter(file, path, psLen, buffer);
     int psOffset = readSize - 1 - psLen;
     CodedInputStream in = CodedInputStream.newInstance(buffer.array(),
       buffer.arrayOffset() + psOffset, psLen);
     OrcProto.PostScript ps = OrcProto.PostScript.parseFrom(in);
+
     checkOrcVersion(LOG, path, ps.getVersionList());
+
     int footerSize = (int) ps.getFooterLength();
-    metadataSize = (int) ps.getMetadataLength();
-    footerOffset = (int) (size - ( psLen + 1 + footerSize));
-    bufferSize = (int) ps.getCompressionBlockSize();
+    int metadataSize = (int) ps.getMetadataLength();
+
+    //check compression codec
     switch (ps.getCompression()) {
       case NONE:
-        compressionKind = CompressionKind.NONE;
         break;
       case ZLIB:
-        compressionKind = CompressionKind.ZLIB;
         break;
       case SNAPPY:
-        compressionKind = CompressionKind.SNAPPY;
         break;
       case LZO:
-        compressionKind = CompressionKind.LZO;
         break;
       default:
         throw new IllegalArgumentException("Unknown compression");
     }
-    codec = WriterImpl.createCodec(compressionKind);
-    int extra = Math.max(0, psLen + 1 + footerSize - readSize);
+
+    //check if extra bytes need to be read
+    int extra = Math.max(0, psLen + 1 + footerSize + metadataSize - readSize);
     if (extra > 0) {
+      //more bytes need to be read, seek back to the right place and read extra bytes
       file.seek(size - readSize - extra);
       ByteBuffer extraBuf = ByteBuffer.allocate(extra + readSize);
       file.readFully(extraBuf.array(),
         extraBuf.arrayOffset() + extraBuf.position(), extra);
       extraBuf.position(extra);
+      //append with already read bytes
       extraBuf.put(buffer);
       buffer = extraBuf;
       buffer.position(0);
-      buffer.limit(footerSize);
+      buffer.limit(footerSize + metadataSize);
     } else {
-      buffer.position(psOffset - footerSize);
+      //footer is already in the bytes in buffer, just adjust position, length
+      buffer.position(psOffset - footerSize - metadataSize);
       buffer.limit(psOffset);
     }
-    // read footer
-    InputStream instream = InStream.create("footer", new ByteBuffer[]{buffer},
-        new long[]{0L}, footerSize, codec, bufferSize);
-    footer = OrcProto.Footer.parseFrom(instream);
-    inspector = OrcStruct.createObjectInspector(0, footer.getTypesList());
-
-    // if metadata is already contained in first 16K file read then parse it
-    // else do it lazily
-    if(extra == 0) {
-      buffer.position(psOffset - (footerSize + metadataSize));
-      buffer.limit(psOffset - footerSize);
-      instream = InStream.create("metadata", new ByteBuffer[]{buffer},
+
+    // remember position for later
+    buffer.mark();
+
+    file.close();
+
+    return new FileMetaInfo(
+        ps.getCompression().toString(),
+        (int) ps.getCompressionBlockSize(),
+        (int) ps.getMetadataLength(),
+        buffer
+        );
+  }
+
+
+
+  /**
+   * MetaInfoObjExtractor - has logic to create the values for the fields in ReaderImpl
+   *  from serialized fields.
+   * As the fields are final, the fields need to be initialized in the constructor and
+   *  can't be done in some helper function. So this helper class is used instead.
+   *
+   */
+  private static class MetaInfoObjExtractor{
+    final CompressionKind compressionKind;
+    final CompressionCodec codec;
+    final int bufferSize;
+    final int metadataSize;
+    final OrcProto.Metadata metadata;
+    final OrcProto.Footer footer;
+    final ObjectInspector inspector;
+
+    MetaInfoObjExtractor(String codecStr, int bufferSize, int metadataSize, 
+        ByteBuffer footerBuffer) throws IOException {
+
+      this.compressionKind = CompressionKind.valueOf(codecStr);
+      this.bufferSize = bufferSize;
+      this.codec = WriterImpl.createCodec(compressionKind);
+      this.metadataSize = metadataSize;
+
+      int position = footerBuffer.position();
+      int footerBufferSize = footerBuffer.limit() - footerBuffer.position() - metadataSize;
+      footerBuffer.limit(position + metadataSize);
+
+      InputStream instream = InStream.create("metadata", new ByteBuffer[]{footerBuffer},
           new long[]{0L}, metadataSize, codec, bufferSize);
-      metadata = OrcProto.Metadata.parseFrom(instream);
+      this.metadata = OrcProto.Metadata.parseFrom(instream);
+
+      footerBuffer.position(position + metadataSize);
+      footerBuffer.limit(position + metadataSize + footerBufferSize);
+      instream = InStream.create("footer", new ByteBuffer[]{footerBuffer},
+          new long[]{0L}, footerBufferSize, codec, bufferSize);
+      this.footer = OrcProto.Footer.parseFrom(instream);
+
+      footerBuffer.position(position);
+      this.inspector = OrcStruct.createObjectInspector(0, footer.getTypesList());
     }
+  }
 
-    file.close();
+  public FileMetaInfo getFileMetaInfo(){
+    return new FileMetaInfo(compressionKind.toString(), bufferSize, metadataSize, footerByteBuffer);
   }
 
+
+
   @Override
   public RecordReader rows(boolean[] include) throws IOException {
     return rows(0, Long.MAX_VALUE, include, null, null);
@@ -497,20 +612,6 @@ private int getLastIdx() {
 
   @Override
   public Metadata getMetadata() throws IOException {
-    // if metadata is not parsed already then read and parse it
-    if (metadata == null && metadataSize > 0) {
-      FSDataInputStream file = this.fileSystem.open(path);
-      file.seek(footerOffset - metadataSize);
-      ByteBuffer buffer = ByteBuffer.allocate(metadataSize);
-      file.readFully(buffer.array(), buffer.arrayOffset() + buffer.position(),
-          buffer.remaining());
-      buffer.position(0);
-      buffer.limit(metadataSize);
-      InputStream instream = InStream.create("metadata", new ByteBuffer[] {buffer},
-          new long[] {0L}, metadataSize, codec, bufferSize);
-      metadata = OrcProto.Metadata.parseFrom(instream);
-      file.close();
-    }
     return new Metadata(metadata);
   }
 
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/io/orc/VectorizedOrcInputFormat.java b/ql/src/java/org/apache/hadoop/hive/ql/io/orc/VectorizedOrcInputFormat.java
index 2209ee30de..d904c44f20 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/io/orc/VectorizedOrcInputFormat.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/io/orc/VectorizedOrcInputFormat.java
@@ -31,6 +31,7 @@
 import org.apache.hadoop.hive.ql.exec.vector.VectorizedRowBatch;
 import org.apache.hadoop.hive.ql.exec.vector.VectorizedRowBatchCtx;
 import org.apache.hadoop.hive.ql.io.InputFormatChecker;
+import org.apache.hadoop.hive.ql.io.orc.Reader.FileMetaInfo;
 import org.apache.hadoop.hive.ql.io.sarg.SearchArgument;
 import org.apache.hadoop.hive.ql.metadata.HiveException;
 import org.apache.hadoop.io.NullWritable;
@@ -140,11 +141,30 @@ public VectorizedOrcInputFormat() {
   public RecordReader<NullWritable, VectorizedRowBatch>
       getRecordReader(InputSplit inputSplit, JobConf conf,
           Reporter reporter) throws IOException {
-    FileSplit fileSplit = (FileSplit) inputSplit;
-    Path path = fileSplit.getPath();
+    FileSplit fSplit = (FileSplit)inputSplit;
+    reporter.setStatus(fSplit.toString());
+
+    Path path = fSplit.getPath();
     FileSystem fs = path.getFileSystem(conf);
-    reporter.setStatus(fileSplit.toString());
-    return new VectorizedOrcRecordReader(OrcFile.createReader(fs, path), conf, fileSplit);
+
+    Reader reader = null;
+
+    if(!(fSplit instanceof OrcSplit)){
+      //If CombineHiveInputFormat is used, it works with FileSplit and not OrcSplit
+      reader = OrcFile.createReader(fs, path);
+    } else {
+      //We have OrcSplit, which may have footer metadata cached, so use the appropriate reader
+      //constructor
+      OrcSplit orcSplit = (OrcSplit) fSplit;
+      if (orcSplit.hasFooter()) {
+        FileMetaInfo fMetaInfo = orcSplit.getFileMetaInfo();
+        reader = OrcFile.createReader(fs, path, fMetaInfo);
+      } else {
+        reader = OrcFile.createReader(fs, path);
+      }
+    }
+
+    return new VectorizedOrcRecordReader(reader, conf, fSplit);
   }
 
   @Override
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/lib/DefaultGraphWalker.java b/ql/src/java/org/apache/hadoop/hive/ql/lib/DefaultGraphWalker.java
index 69ea4a6587..7d5983abb2 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/lib/DefaultGraphWalker.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/lib/DefaultGraphWalker.java
@@ -36,9 +36,9 @@
 public class DefaultGraphWalker implements GraphWalker {
 
   protected Stack<Node> opStack;
-  private final List<Node> toWalk = new ArrayList<Node>();
-  private final HashMap<Node, Object> retMap = new HashMap<Node, Object>();
-  private final Dispatcher dispatcher;
+  protected final List<Node> toWalk = new ArrayList<Node>();
+  protected final HashMap<Node, Object> retMap = new HashMap<Node, Object>();
+  protected final Dispatcher dispatcher;
 
   /**
    * Constructor.
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/log/PerfLogger.java b/ql/src/java/org/apache/hadoop/hive/ql/log/PerfLogger.java
index e0261fe808..5d7686324d 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/log/PerfLogger.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/log/PerfLogger.java
@@ -53,6 +53,8 @@ public class PerfLogger {
   public static final String FAILURE_HOOK = "FailureHook.";
   public static final String DRIVER_RUN = "Driver.run";
   public static final String TIME_TO_SUBMIT = "TimeToSubmit";
+  public static final String LOAD_HASHTABLE = "LoadHashtable";
+  public static final String ORC_GET_SPLITS = "OrcGetSplits";
 
   protected static final ThreadLocal<PerfLogger> perfLogger = new ThreadLocal<PerfLogger>();
 
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/metadata/Hive.java b/ql/src/java/org/apache/hadoop/hive/ql/metadata/Hive.java
index 947b65cd44..2fe86e1e91 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/metadata/Hive.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/metadata/Hive.java
@@ -2478,7 +2478,7 @@ public boolean updateTableColumnStatistics(ColumnStatistics statsObj) throws Hiv
     try {
       return getMSC().updateTableColumnStatistics(statsObj);
     } catch (Exception e) {
-      LOG.error(StringUtils.stringifyException(e));
+      LOG.debug(StringUtils.stringifyException(e));
       throw new HiveException(e);
     }
   }
@@ -2487,7 +2487,7 @@ public boolean updatePartitionColumnStatistics(ColumnStatistics statsObj) throws
     try {
       return getMSC().updatePartitionColumnStatistics(statsObj);
     } catch (Exception e) {
-      LOG.error(StringUtils.stringifyException(e));
+      LOG.debug(StringUtils.stringifyException(e));
       throw new HiveException(e);
     }
   }
@@ -2497,7 +2497,7 @@ public ColumnStatistics getTableColumnStatistics(String dbName, String tableName
     try {
       return getMSC().getTableColumnStatistics(dbName, tableName, colName);
     } catch (Exception e) {
-      LOG.error(StringUtils.stringifyException(e));
+      LOG.debug(StringUtils.stringifyException(e));
       throw new HiveException(e);
     }
 
@@ -2508,7 +2508,7 @@ public ColumnStatistics getPartitionColumnStatistics(String dbName, String table
       try {
         return getMSC().getPartitionColumnStatistics(dbName, tableName, partName, colName);
       } catch (Exception e) {
-        LOG.error(StringUtils.stringifyException(e));
+        LOG.debug(StringUtils.stringifyException(e));
         throw new HiveException(e);
       }
     }
@@ -2518,7 +2518,7 @@ public boolean deleteTableColumnStatistics(String dbName, String tableName, Stri
     try {
       return getMSC().deleteTableColumnStatistics(dbName, tableName, colName);
     } catch(Exception e) {
-      LOG.error(StringUtils.stringifyException(e));
+      LOG.debug(StringUtils.stringifyException(e));
       throw new HiveException(e);
     }
   }
@@ -2528,7 +2528,7 @@ public boolean deletePartitionColumnStatistics(String dbName, String tableName,
       try {
         return getMSC().deletePartitionColumnStatistics(dbName, tableName, partName, colName);
       } catch(Exception e) {
-        LOG.error(StringUtils.stringifyException(e));
+        LOG.debug(StringUtils.stringifyException(e));
         throw new HiveException(e);
       }
     }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/AbstractSMBJoinProc.java b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/AbstractSMBJoinProc.java
index 6953365b8a..0b7b1a321b 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/AbstractSMBJoinProc.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/AbstractSMBJoinProc.java
@@ -473,7 +473,7 @@ protected boolean canConvertJoinToBucketMapJoin(
     JoinDesc joinDesc = joinOp.getConf();
     JoinCondDesc[] joinCondns = joinDesc.getConds();
     Set<Integer> joinCandidates = MapJoinProcessor.getBigTableCandidates(joinCondns);
-    if (joinCandidates == null) {
+    if (joinCandidates.isEmpty()) {
       // This is a full outer join. This can never be a map-join
       // of any type. So return false.
       return false;
@@ -527,6 +527,7 @@ protected MapJoinOperator convertJoinToBucketMapJoin(
     SortBucketJoinProcCtx joinContext,
     ParseContext parseContext) throws SemanticException {
     MapJoinOperator mapJoinOp = MapJoinProcessor.convertMapJoin(
+      parseContext.getConf(),
       parseContext.getOpParseCtx(),
       joinOp,
       pGraphContext.getJoinContext().get(joinOp),
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRFileSink1.java b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRFileSink1.java
index 84a0107453..978c18d2ac 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRFileSink1.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRFileSink1.java
@@ -19,10 +19,8 @@
 package org.apache.hadoop.hive.ql.optimizer;
 
 import java.io.Serializable;
-import java.net.URI;
 import java.util.ArrayList;
 import java.util.HashMap;
-import java.util.LinkedHashMap;
 import java.util.List;
 import java.util.Map;
 import java.util.Stack;
@@ -31,43 +29,18 @@
 import org.apache.commons.logging.LogFactory;
 import org.apache.hadoop.fs.Path;
 import org.apache.hadoop.hive.conf.HiveConf;
-import org.apache.hadoop.hive.conf.HiveConf.ConfVars;
-import org.apache.hadoop.hive.ql.Context;
-import org.apache.hadoop.hive.ql.exec.ColumnInfo;
-import org.apache.hadoop.hive.ql.exec.ConditionalTask;
-import org.apache.hadoop.hive.ql.exec.DependencyCollectionTask;
 import org.apache.hadoop.hive.ql.exec.FileSinkOperator;
-import org.apache.hadoop.hive.ql.exec.MoveTask;
 import org.apache.hadoop.hive.ql.exec.Operator;
-import org.apache.hadoop.hive.ql.exec.OperatorFactory;
-import org.apache.hadoop.hive.ql.exec.RowSchema;
 import org.apache.hadoop.hive.ql.exec.Task;
-import org.apache.hadoop.hive.ql.exec.TaskFactory;
 import org.apache.hadoop.hive.ql.exec.UnionOperator;
-import org.apache.hadoop.hive.ql.exec.Utilities;
-import org.apache.hadoop.hive.ql.io.RCFileInputFormat;
-import org.apache.hadoop.hive.ql.io.rcfile.merge.MergeWork;
 import org.apache.hadoop.hive.ql.lib.Node;
 import org.apache.hadoop.hive.ql.lib.NodeProcessor;
 import org.apache.hadoop.hive.ql.lib.NodeProcessorCtx;
 import org.apache.hadoop.hive.ql.parse.ParseContext;
 import org.apache.hadoop.hive.ql.parse.SemanticException;
-import org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles;
-import org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles.ConditionalResolverMergeFilesCtx;
-import org.apache.hadoop.hive.ql.plan.ConditionalWork;
-import org.apache.hadoop.hive.ql.plan.DynamicPartitionCtx;
 import org.apache.hadoop.hive.ql.plan.FileSinkDesc;
-import org.apache.hadoop.hive.ql.plan.LoadFileDesc;
-import org.apache.hadoop.hive.ql.plan.MapWork;
 import org.apache.hadoop.hive.ql.plan.MapredWork;
-import org.apache.hadoop.hive.ql.plan.MoveWork;
 import org.apache.hadoop.hive.ql.plan.OperatorDesc;
-import org.apache.hadoop.hive.ql.plan.PartitionDesc;
-import org.apache.hadoop.hive.ql.plan.StatsWork;
-import org.apache.hadoop.hive.ql.plan.TableDesc;
-import org.apache.hadoop.hive.ql.stats.StatsFactory;
-import org.apache.hadoop.hive.serde2.typeinfo.TypeInfoFactory;
-import org.apache.hadoop.mapred.InputFormat;
 
 /**
  * Processor for the rule - table scan followed by reduce sink.
@@ -97,8 +70,7 @@ public Object process(Node nd, Stack<Node> stack, NodeProcessorCtx opProcCtx,
 
     FileSinkOperator fsOp = (FileSinkOperator) nd;
     boolean isInsertTable = // is INSERT OVERWRITE TABLE
-    fsOp.getConf().getTableInfo().getTableName() != null &&
-        parseCtx.getQB().getParseInfo().isInsertToTable();
+        GenMapRedUtils.isInsertInto(parseCtx, fsOp);
     HiveConf hconf = parseCtx.getConf();
 
     // Mark this task as a final map reduce task (ignoring the optional merge task)
@@ -113,49 +85,12 @@ public Object process(Node nd, Stack<Node> stack, NodeProcessorCtx opProcCtx,
       return true;
     }
 
-    // Has the user enabled merging of files for map-only jobs or for all jobs
-    if ((ctx.getMvTask() != null) && (!ctx.getMvTask().isEmpty())) {
-      List<Task<MoveWork>> mvTasks = ctx.getMvTask();
-
-      // In case of unions or map-joins, it is possible that the file has
-      // already been seen.
-      // So, no need to attempt to merge the files again.
-      if ((ctx.getSeenFileSinkOps() == null)
-          || (!ctx.getSeenFileSinkOps().contains(nd))) {
-
-        // no need of merging if the move is to a local file system
-        MoveTask mvTask = (MoveTask) findMoveTask(mvTasks, fsOp);
-
-        if (mvTask != null && isInsertTable && hconf.getBoolVar(ConfVars.HIVESTATSAUTOGATHER)) {
-          addStatsTask(fsOp, mvTask, currTask, parseCtx.getConf());
-        }
-
-        if ((mvTask != null) && !mvTask.isLocal() && fsOp.getConf().canBeMerged()) {
-          if (fsOp.getConf().isLinkedFileSink()) {
-            // If the user has HIVEMERGEMAPREDFILES set to false, the idea was the
-            // number of reducers are few, so the number of files anyway are small.
-            // However, with this optimization, we are increasing the number of files
-            // possibly by a big margin. So, merge aggresively.
-            if (hconf.getBoolVar(ConfVars.HIVEMERGEMAPFILES) ||
-                hconf.getBoolVar(ConfVars.HIVEMERGEMAPREDFILES)) {
-              chDir = true;
-            }
-          } else {
-              // There are separate configuration parameters to control whether to
-              // merge for a map-only job
-              // or for a map-reduce job
-              MapredWork currWork = (MapredWork) currTask.getWork();
-              boolean mergeMapOnly =
-                  hconf.getBoolVar(ConfVars.HIVEMERGEMAPFILES) && currWork.getReduceWork() == null;
-              boolean mergeMapRed =
-                  hconf.getBoolVar(ConfVars.HIVEMERGEMAPREDFILES) &&
-                      currWork.getReduceWork() != null;
-              if (mergeMapOnly || mergeMapRed) {
-                chDir = true;
-              }
-          }
-        }
-      }
+    // In case of unions or map-joins, it is possible that the file has
+    // already been seen.
+    // So, no need to attempt to merge the files again.
+    if ((ctx.getSeenFileSinkOps() == null)
+        || (!ctx.getSeenFileSinkOps().contains(nd))) {
+      chDir = GenMapRedUtils.isMergeRequired(ctx.getMvTask(), hconf, fsOp, currTask, isInsertTable);
     }
 
     Path finalName = processFS(fsOp, stack, opProcCtx, chDir);
@@ -164,7 +99,9 @@ public Object process(Node nd, Stack<Node> stack, NodeProcessorCtx opProcCtx,
       // Merge the files in the destination table/partitions by creating Map-only merge job
       // If underlying data is RCFile a RCFileBlockMerge task would be created.
       LOG.info("using CombineHiveInputformat for the merge job");
-      createMRWorkForMergingFiles(fsOp, ctx, finalName);
+      GenMapRedUtils.createMRWorkForMergingFiles(fsOp, finalName,
+          ctx.getDependencyTaskForMultiInsert(), ctx.getMvTask(),
+          hconf, currTask);
     }
 
     FileSinkDesc fileSinkDesc = fsOp.getConf();
@@ -206,437 +143,6 @@ private void processLinkedFileDesc(GenMRProcContext ctx,
     }
   }
 
-  /**
-   * Add the StatsTask as a dependent task of the MoveTask
-   * because StatsTask will change the Table/Partition metadata. For atomicity, we
-   * should not change it before the data is actually there done by MoveTask.
-   *
-   * @param nd
-   *          the FileSinkOperator whose results are taken care of by the MoveTask.
-   * @param mvTask
-   *          The MoveTask that moves the FileSinkOperator's results.
-   * @param currTask
-   *          The MapRedTask that the FileSinkOperator belongs to.
-   * @param hconf
-   *          HiveConf
-   */
-  private void addStatsTask(FileSinkOperator nd, MoveTask mvTask,
-      Task<? extends Serializable> currTask, HiveConf hconf) {
-
-    MoveWork mvWork = mvTask.getWork();
-    StatsWork statsWork = null;
-    if (mvWork.getLoadTableWork() != null) {
-      statsWork = new StatsWork(mvWork.getLoadTableWork());
-    } else if (mvWork.getLoadFileWork() != null) {
-      statsWork = new StatsWork(mvWork.getLoadFileWork());
-    }
-    assert statsWork != null : "Error when genereting StatsTask";
-
-    statsWork.setSourceTask(currTask);
-    statsWork.setStatsReliable(hconf.getBoolVar(ConfVars.HIVE_STATS_RELIABLE));
-    MapredWork mrWork = (MapredWork) currTask.getWork();
-
-    // AggKey in StatsWork is used for stats aggregation while StatsAggPrefix
-    // in FileSinkDesc is used for stats publishing. They should be consistent.
-    statsWork.setAggKey(nd.getConf().getStatsAggPrefix());
-    Task<? extends Serializable> statsTask = TaskFactory.get(statsWork, hconf);
-
-    // mark the MapredWork and FileSinkOperator for gathering stats
-    nd.getConf().setGatherStats(true);
-    mrWork.getMapWork().setGatheringStats(true);
-    if (mrWork.getReduceWork() != null) {
-      mrWork.getReduceWork().setGatheringStats(true);
-    }
-    nd.getConf().setStatsReliable(hconf.getBoolVar(ConfVars.HIVE_STATS_RELIABLE));
-    nd.getConf().setMaxStatsKeyPrefixLength(StatsFactory.getMaxPrefixLength(hconf));
-    // mrWork.addDestinationTable(nd.getConf().getTableInfo().getTableName());
-
-    // subscribe feeds from the MoveTask so that MoveTask can forward the list
-    // of dynamic partition list to the StatsTask
-    mvTask.addDependentTask(statsTask);
-    statsTask.subscribeFeed(mvTask);
-  }
-
-  /**
-   * @param fsInput The FileSink operator.
-   * @param ctx The MR processing context.
-   * @param finalName the final destination path the merge job should output.
-   * @throws SemanticException
-
-   * create a Map-only merge job using CombineHiveInputFormat for all partitions with
-   * following operators:
-   *          MR job J0:
-   *          ...
-   *          |
-   *          v
-   *          FileSinkOperator_1 (fsInput)
-   *          |
-   *          v
-   *          Merge job J1:
-   *          |
-   *          v
-   *          TableScan (using CombineHiveInputFormat) (tsMerge)
-   *          |
-   *          v
-   *          FileSinkOperator (fsMerge)
-   *
-   *          Here the pathToPartitionInfo & pathToAlias will remain the same, which means the paths
-   *          do
-   *          not contain the dynamic partitions (their parent). So after the dynamic partitions are
-   *          created (after the first job finished before the moveTask or ConditionalTask start),
-   *          we need to change the pathToPartitionInfo & pathToAlias to include the dynamic
-   *          partition
-   *          directories.
-   *
-   */
-  private void createMRWorkForMergingFiles (FileSinkOperator fsInput, GenMRProcContext ctx,
-   Path finalName) throws SemanticException {
-
-    //
-    // 1. create the operator tree
-    //
-    HiveConf conf = ctx.getParseCtx().getConf();
-    FileSinkDesc fsInputDesc = fsInput.getConf();
-
-    // Create a TableScan operator
-    RowSchema inputRS = fsInput.getSchema();
-    Operator<? extends OperatorDesc> tsMerge =
-        GenMapRedUtils.createTemporaryTableScanOperator(inputRS);
-
-    // Create a FileSink operator
-    TableDesc ts = (TableDesc) fsInputDesc.getTableInfo().clone();
-    FileSinkDesc fsOutputDesc = new FileSinkDesc(finalName.toUri().toString(), ts,
-      conf.getBoolVar(ConfVars.COMPRESSRESULT));
-    FileSinkOperator fsOutput = (FileSinkOperator) OperatorFactory.getAndMakeChild(
-      fsOutputDesc, inputRS, tsMerge);
-
-    // If the input FileSinkOperator is a dynamic partition enabled, the tsMerge input schema
-    // needs to include the partition column, and the fsOutput should have
-    // a DynamicPartitionCtx to indicate that it needs to dynamically partitioned.
-    DynamicPartitionCtx dpCtx = fsInputDesc.getDynPartCtx();
-    if (dpCtx != null && dpCtx.getNumDPCols() > 0) {
-      // adding DP ColumnInfo to the RowSchema signature
-      ArrayList<ColumnInfo> signature = inputRS.getSignature();
-      String tblAlias = fsInputDesc.getTableInfo().getTableName();
-      LinkedHashMap<String, String> colMap = new LinkedHashMap<String, String>();
-      StringBuilder partCols = new StringBuilder();
-      for (String dpCol : dpCtx.getDPColNames()) {
-        ColumnInfo colInfo = new ColumnInfo(dpCol,
-            TypeInfoFactory.stringTypeInfo, // all partition column type should be string
-            tblAlias, true); // partition column is virtual column
-        signature.add(colInfo);
-        colMap.put(dpCol, dpCol); // input and output have the same column name
-        partCols.append(dpCol).append('/');
-      }
-      partCols.setLength(partCols.length() - 1); // remove the last '/'
-      inputRS.setSignature(signature);
-
-      // create another DynamicPartitionCtx, which has a different input-to-DP column mapping
-      DynamicPartitionCtx dpCtx2 = new DynamicPartitionCtx(dpCtx);
-      dpCtx2.setInputToDPCols(colMap);
-      fsOutputDesc.setDynPartCtx(dpCtx2);
-
-      // update the FileSinkOperator to include partition columns
-      fsInputDesc.getTableInfo().getProperties().setProperty(
-        org.apache.hadoop.hive.metastore.api.hive_metastoreConstants.META_TABLE_PARTITION_COLUMNS,
-        partCols.toString()); // list of dynamic partition column names
-    } else {
-      // non-partitioned table
-      fsInputDesc.getTableInfo().getProperties().remove(
-        org.apache.hadoop.hive.metastore.api.hive_metastoreConstants.META_TABLE_PARTITION_COLUMNS);
-    }
-
-    //
-    // 2. Constructing a conditional task consisting of a move task and a map reduce task
-    //
-    MoveWork dummyMv = new MoveWork(null, null, null,
-        new LoadFileDesc(new Path(fsInputDesc.getFinalDirName()), finalName, true, null, null), false);
-    MapWork cplan;
-    Serializable work;
-
-    if (conf.getBoolVar(ConfVars.HIVEMERGERCFILEBLOCKLEVEL) &&
-        fsInputDesc.getTableInfo().getInputFileFormatClass().equals(RCFileInputFormat.class)) {
-
-      // Check if InputFormatClass is valid
-      String inputFormatClass = conf.getVar(ConfVars.HIVEMERGEINPUTFORMATBLOCKLEVEL);
-      try {
-        Class c = (Class<? extends InputFormat>) Class.forName(inputFormatClass);
-
-        LOG.info("RCFile format- Using block level merge");
-        cplan = createRCFileMergeTask(fsInputDesc, finalName,
-            dpCtx != null && dpCtx.getNumDPCols() > 0);
-        work = cplan;
-      } catch (ClassNotFoundException e) {
-        String msg = "Illegal input format class: " + inputFormatClass;
-        throw new SemanticException(msg);
-      }
-
-    } else {
-      cplan = createMRWorkForMergingFiles(conf, tsMerge, fsInputDesc);
-      work = new MapredWork();
-      ((MapredWork)work).setMapWork(cplan);
-      // use CombineHiveInputFormat for map-only merging
-    }
-    cplan.setInputformat("org.apache.hadoop.hive.ql.io.CombineHiveInputFormat");
-    // NOTE: we should gather stats in MR1 rather than MR2 at merge job since we don't
-    // know if merge MR2 will be triggered at execution time
-    ConditionalTask cndTsk = createCondTask(conf, ctx.getCurrTask(), dummyMv, work,
-        fsInputDesc.getFinalDirName());
-
-    // keep the dynamic partition context in conditional task resolver context
-    ConditionalResolverMergeFilesCtx mrCtx =
-        (ConditionalResolverMergeFilesCtx) cndTsk.getResolverCtx();
-    mrCtx.setDPCtx(fsInputDesc.getDynPartCtx());
-    mrCtx.setLbCtx(fsInputDesc.getLbCtx());
-
-    //
-    // 3. add the moveTask as the children of the conditional task
-    //
-    linkMoveTask(ctx, fsOutput, cndTsk);
-  }
-
-  /**
-   * Make the move task in the GenMRProcContext following the FileSinkOperator a dependent of all
-   * possible subtrees branching from the ConditionalTask.
-   *
-   * @param ctx
-   * @param newOutput
-   * @param cndTsk
-   */
-  private void linkMoveTask(GenMRProcContext ctx, FileSinkOperator newOutput,
-      ConditionalTask cndTsk) {
-
-    List<Task<MoveWork>> mvTasks = ctx.getMvTask();
-    Task<MoveWork> mvTask = findMoveTask(mvTasks, newOutput);
-
-    for (Task<? extends Serializable> tsk : cndTsk.getListTasks()) {
-      linkMoveTask(ctx, mvTask, tsk);
-    }
-  }
-
-  /**
-   * Follows the task tree down from task and makes all leaves parents of mvTask
-   *
-   * @param ctx
-   * @param mvTask
-   * @param task
-   */
-  private void linkMoveTask(GenMRProcContext ctx, Task<MoveWork> mvTask,
-      Task<? extends Serializable> task) {
-
-    if (task.getDependentTasks() == null || task.getDependentTasks().isEmpty()) {
-      // If it's a leaf, add the move task as a child
-      addDependentMoveTasks(ctx, mvTask, task);
-    } else {
-      // Otherwise, for each child run this method recursively
-      for (Task<? extends Serializable> childTask : task.getDependentTasks()) {
-        linkMoveTask(ctx, mvTask, childTask);
-      }
-    }
-  }
-
-  /**
-   * Adds the dependencyTaskForMultiInsert in ctx as a dependent of parentTask. If mvTask is a
-   * load table, and HIVE_MULTI_INSERT_ATOMIC_OUTPUTS is set, adds mvTask as a dependent of
-   * dependencyTaskForMultiInsert in ctx, otherwise adds mvTask as a dependent of parentTask as
-   * well.
-   *
-   * @param ctx
-   * @param mvTask
-   * @param parentTask
-   */
-  private void addDependentMoveTasks(GenMRProcContext ctx, Task<MoveWork> mvTask,
-      Task<? extends Serializable> parentTask) {
-
-    if (mvTask != null) {
-      if (ctx.getConf().getBoolVar(ConfVars.HIVE_MULTI_INSERT_MOVE_TASKS_SHARE_DEPENDENCIES)) {
-        DependencyCollectionTask dependencyTask = ctx.getDependencyTaskForMultiInsert();
-        parentTask.addDependentTask(dependencyTask);
-        if (mvTask.getWork().getLoadTableWork() != null) {
-          // Moving tables/partitions depend on the dependencyTask
-          dependencyTask.addDependentTask(mvTask);
-        } else {
-          // Moving files depends on the parentTask (we still want the dependencyTask to depend
-          // on the parentTask)
-          parentTask.addDependentTask(mvTask);
-        }
-      } else {
-        parentTask.addDependentTask(mvTask);
-      }
-    }
-  }
-
-  /**
-   * Create a MapredWork based on input path, the top operator and the input
-   * table descriptor.
-   *
-   * @param conf
-   * @param topOp
-   *          the table scan operator that is the root of the MapReduce task.
-   * @param fsDesc
-   *          the file sink descriptor that serves as the input to this merge task.
-   * @param parentMR
-   *          the parent MapReduce work
-   * @param parentFS
-   *          the last FileSinkOperator in the parent MapReduce work
-   * @return the MapredWork
-   */
-  private MapWork createMRWorkForMergingFiles (HiveConf conf,
-    Operator<? extends OperatorDesc> topOp,  FileSinkDesc fsDesc) {
-
-    ArrayList<String> aliases = new ArrayList<String>();
-    String inputDir = fsDesc.getFinalDirName();
-    TableDesc tblDesc = fsDesc.getTableInfo();
-    aliases.add(inputDir); // dummy alias: just use the input path
-
-    // constructing the default MapredWork
-    MapredWork cMrPlan = GenMapRedUtils.getMapRedWorkFromConf(conf);
-    MapWork cplan = cMrPlan.getMapWork();
-    cplan.getPathToAliases().put(inputDir, aliases);
-    cplan.getPathToPartitionInfo().put(inputDir, new PartitionDesc(tblDesc, null));
-    cplan.getAliasToWork().put(inputDir, topOp);
-    cplan.setMapperCannotSpanPartns(true);
-
-    return cplan;
-  }
-
-  /**
-   * Create a block level merge task for RCFiles.
-   *
-   * @param fsInputDesc
-   * @param finalName
-   * @return MergeWork if table is stored as RCFile,
-   *         null otherwise
-   */
-  private MapWork createRCFileMergeTask(FileSinkDesc fsInputDesc,
-      Path finalName, boolean hasDynamicPartitions) throws SemanticException {
-
-    String inputDir = fsInputDesc.getFinalDirName();
-    TableDesc tblDesc = fsInputDesc.getTableInfo();
-
-    if (tblDesc.getInputFileFormatClass().equals(RCFileInputFormat.class)) {
-      ArrayList<Path> inputDirs = new ArrayList<Path>(1);
-      ArrayList<String> inputDirstr = new ArrayList<String>(1);
-      if (!hasDynamicPartitions
-          && !isSkewedStoredAsDirs(fsInputDesc)) {
-        inputDirs.add(new Path(inputDir));
-        inputDirstr.add(inputDir);
-      }
-
-      MergeWork work = new MergeWork(inputDirs, finalName,
-          hasDynamicPartitions, fsInputDesc.getDynPartCtx());
-      LinkedHashMap<String, ArrayList<String>> pathToAliases =
-          new LinkedHashMap<String, ArrayList<String>>();
-      pathToAliases.put(inputDir, (ArrayList<String>) inputDirstr.clone());
-      work.setMapperCannotSpanPartns(true);
-      work.setPathToAliases(pathToAliases);
-      work.setAliasToWork(
-          new LinkedHashMap<String, Operator<? extends OperatorDesc>>());
-      if (hasDynamicPartitions
-          || isSkewedStoredAsDirs(fsInputDesc)) {
-        work.getPathToPartitionInfo().put(inputDir,
-            new PartitionDesc(tblDesc, null));
-      }
-      work.setListBucketingCtx(fsInputDesc.getLbCtx());
-
-      return work;
-    }
-
-    throw new SemanticException("createRCFileMergeTask called on non-RCFile table");
-  }
-
-  /**
-   * check if it is skewed table and stored as dirs.
-   *
-   * @param fsInputDesc
-   * @return
-   */
-  private boolean isSkewedStoredAsDirs(FileSinkDesc fsInputDesc) {
-    return (fsInputDesc.getLbCtx() == null) ? false : fsInputDesc.getLbCtx()
-        .isSkewedStoredAsDir();
-  }
-
-  /**
-   * Construct a conditional task given the current leaf task, the MoveWork and the MapredWork.
-   *
-   * @param conf
-   *          HiveConf
-   * @param currTask
-   *          current leaf task
-   * @param mvWork
-   *          MoveWork for the move task
-   * @param mergeWork
-   *          MapredWork for the merge task.
-   * @param inputPath
-   *          the input directory of the merge/move task
-   * @return The conditional task
-   */
-  private ConditionalTask createCondTask(HiveConf conf,
-      Task<? extends Serializable> currTask, MoveWork mvWork,
-      Serializable mergeWork, String inputPath) {
-
-    // There are 3 options for this ConditionalTask:
-    // 1) Merge the partitions
-    // 2) Move the partitions (i.e. don't merge the partitions)
-    // 3) Merge some partitions and move other partitions (i.e. merge some partitions and don't
-    // merge others) in this case the merge is done first followed by the move to prevent
-    // conflicts.
-    Task<? extends Serializable> mergeOnlyMergeTask = TaskFactory.get(mergeWork, conf);
-    Task<? extends Serializable> moveOnlyMoveTask = TaskFactory.get(mvWork, conf);
-    Task<? extends Serializable> mergeAndMoveMergeTask = TaskFactory.get(mergeWork, conf);
-    Task<? extends Serializable> mergeAndMoveMoveTask = TaskFactory.get(mvWork, conf);
-
-    // NOTE! It is necessary merge task is the parent of the move task, and not
-    // the other way around, for the proper execution of the execute method of
-    // ConditionalTask
-    mergeAndMoveMergeTask.addDependentTask(mergeAndMoveMoveTask);
-
-    List<Serializable> listWorks = new ArrayList<Serializable>();
-    listWorks.add(mvWork);
-    listWorks.add(mergeWork);
-
-    ConditionalWork cndWork = new ConditionalWork(listWorks);
-
-    List<Task<? extends Serializable>> listTasks = new ArrayList<Task<? extends Serializable>>();
-    listTasks.add(moveOnlyMoveTask);
-    listTasks.add(mergeOnlyMergeTask);
-    listTasks.add(mergeAndMoveMergeTask);
-
-    ConditionalTask cndTsk = (ConditionalTask) TaskFactory.get(cndWork, conf);
-    cndTsk.setListTasks(listTasks);
-
-    // create resolver
-    cndTsk.setResolver(new ConditionalResolverMergeFiles());
-    ConditionalResolverMergeFilesCtx mrCtx =
-        new ConditionalResolverMergeFilesCtx(listTasks, inputPath);
-    cndTsk.setResolverCtx(mrCtx);
-
-    // make the conditional task as the child of the current leaf task
-    currTask.addDependentTask(cndTsk);
-
-    return cndTsk;
-  }
-
-  private Task<MoveWork> findMoveTask(
-      List<Task<MoveWork>> mvTasks, FileSinkOperator fsOp) {
-    // find the move task
-    for (Task<MoveWork> mvTsk : mvTasks) {
-      MoveWork mvWork = mvTsk.getWork();
-      Path srcDir = null;
-      if (mvWork.getLoadFileWork() != null) {
-        srcDir = mvWork.getLoadFileWork().getSourcePath();
-      } else if (mvWork.getLoadTableWork() != null) {
-        srcDir = mvWork.getLoadTableWork().getSourcePath();
-      }
-
-      if ((srcDir != null)
-          && (srcDir.equals(new Path(fsOp.getConf().getFinalDirName())))) {
-        return mvTsk;
-      }
-    }
-    return null;
-  }
-
   /**
    * Process the FileSink operator to generate a MoveTask if necessary.
    *
@@ -655,6 +161,11 @@ private Path processFS(FileSinkOperator fsOp, Stack<Node> stack,
       NodeProcessorCtx opProcCtx, boolean chDir) throws SemanticException {
 
     GenMRProcContext ctx = (GenMRProcContext) opProcCtx;
+    Task<? extends Serializable> currTask = ctx.getCurrTask();
+
+    // If the directory needs to be changed, send the new directory
+    Path dest = null;
+
     List<FileSinkOperator> seenFSOps = ctx.getSeenFileSinkOps();
     if (seenFSOps == null) {
       seenFSOps = new ArrayList<FileSinkOperator>();
@@ -664,49 +175,14 @@ private Path processFS(FileSinkOperator fsOp, Stack<Node> stack,
     }
     ctx.setSeenFileSinkOps(seenFSOps);
 
-    Task<? extends Serializable> currTask = ctx.getCurrTask();
-
-    // If the directory needs to be changed, send the new directory
-    Path dest = null;
-
-    if (chDir) {
-      dest = new Path(fsOp.getConf().getFinalDirName());
-
-      // generate the temporary file
-      // it must be on the same file system as the current destination
-      ParseContext parseCtx = ctx.getParseCtx();
-      Context baseCtx = parseCtx.getContext();
-      String tmpDir = baseCtx.getExternalTmpFileURI(dest.toUri());
-
-      FileSinkDesc fileSinkDesc = fsOp.getConf();
-      // Change all the linked file sink descriptors
-      if (fileSinkDesc.isLinkedFileSink()) {
-        for (FileSinkDesc fsConf:fileSinkDesc.getLinkedFileSinkDesc()) {
-          String fileName = Utilities.getFileNameFromDirName(fsConf.getDirName());
-          fsConf.setParentDir(tmpDir);
-          fsConf.setDirName(tmpDir + Path.SEPARATOR + fileName);
-        }
-      } else {
-        fileSinkDesc.setDirName(tmpDir);
-      }
-    }
-
-    Task<MoveWork> mvTask = null;
-
-    if (!chDir) {
-      mvTask = findMoveTask(ctx.getMvTask(), fsOp);
-    }
+    dest = GenMapRedUtils.createMoveTask(ctx.getCurrTask(), chDir, fsOp, ctx.getParseCtx(),
+        ctx.getMvTask(), ctx.getConf(), ctx.getDependencyTaskForMultiInsert());
 
     Operator<? extends OperatorDesc> currTopOp = ctx.getCurrTopOp();
     String currAliasId = ctx.getCurrAliasId();
     HashMap<Operator<? extends OperatorDesc>, Task<? extends Serializable>> opTaskMap =
         ctx.getOpTaskMap();
 
-    // Set the move task to be dependent on the current task
-    if (mvTask != null) {
-      addDependentMoveTasks(ctx, mvTask, currTask);
-    }
-
     // In case of multi-table insert, the path to alias mapping is needed for
     // all the sources. Since there is no
     // reducer, treat it as a plan with null reducer
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRProcContext.java b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRProcContext.java
index 82a0b491a6..0da5790cfc 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRProcContext.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRProcContext.java
@@ -27,6 +27,7 @@
 import java.util.Set;
 
 import org.apache.hadoop.hive.conf.HiveConf;
+import org.apache.hadoop.hive.conf.HiveConf.ConfVars;
 import org.apache.hadoop.hive.ql.exec.DependencyCollectionTask;
 import org.apache.hadoop.hive.ql.exec.FileSinkOperator;
 import org.apache.hadoop.hive.ql.exec.Operator;
@@ -440,8 +441,10 @@ public void setConf(HiveConf conf) {
    */
   public DependencyCollectionTask getDependencyTaskForMultiInsert() {
     if (dependencyTaskForMultiInsert == null) {
-      dependencyTaskForMultiInsert =
-          (DependencyCollectionTask) TaskFactory.get(new DependencyCollectionWork(), conf);
+      if (conf.getBoolVar(ConfVars.HIVE_MULTI_INSERT_MOVE_TASKS_SHARE_DEPENDENCIES)) {
+        dependencyTaskForMultiInsert =
+            (DependencyCollectionTask) TaskFactory.get(new DependencyCollectionWork(), conf);
+      }
     }
     return dependencyTaskForMultiInsert;
   }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMapRedUtils.java b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMapRedUtils.java
index 9030ce8e94..1e89fcd601 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMapRedUtils.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMapRedUtils.java
@@ -33,11 +33,15 @@
 import org.apache.commons.logging.LogFactory;
 import org.apache.hadoop.fs.Path;
 import org.apache.hadoop.hive.conf.HiveConf;
+import org.apache.hadoop.hive.conf.HiveConf.ConfVars;
 import org.apache.hadoop.hive.ql.Context;
 import org.apache.hadoop.hive.ql.exec.ColumnInfo;
 import org.apache.hadoop.hive.ql.exec.ConditionalTask;
 import org.apache.hadoop.hive.ql.exec.DemuxOperator;
+import org.apache.hadoop.hive.ql.exec.DependencyCollectionTask;
+import org.apache.hadoop.hive.ql.exec.FileSinkOperator;
 import org.apache.hadoop.hive.ql.exec.JoinOperator;
+import org.apache.hadoop.hive.ql.exec.MoveTask;
 import org.apache.hadoop.hive.ql.exec.MapJoinOperator;
 import org.apache.hadoop.hive.ql.exec.Operator;
 import org.apache.hadoop.hive.ql.exec.OperatorFactory;
@@ -52,6 +56,8 @@
 import org.apache.hadoop.hive.ql.exec.mr.ExecDriver;
 import org.apache.hadoop.hive.ql.exec.mr.MapRedTask;
 import org.apache.hadoop.hive.ql.hooks.ReadEntity;
+import org.apache.hadoop.hive.ql.io.RCFileInputFormat;
+import org.apache.hadoop.hive.ql.io.rcfile.merge.MergeWork;
 import org.apache.hadoop.hive.ql.metadata.HiveException;
 import org.apache.hadoop.hive.ql.metadata.Partition;
 import org.apache.hadoop.hive.ql.optimizer.GenMRProcContext.GenMRUnionCtx;
@@ -64,20 +70,31 @@
 import org.apache.hadoop.hive.ql.parse.QBJoinTree;
 import org.apache.hadoop.hive.ql.parse.RowResolver;
 import org.apache.hadoop.hive.ql.parse.SemanticException;
+import org.apache.hadoop.hive.ql.plan.BaseWork;
+import org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles;
+import org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles.ConditionalResolverMergeFilesCtx;
+import org.apache.hadoop.hive.ql.plan.ConditionalWork;
+import org.apache.hadoop.hive.ql.plan.DynamicPartitionCtx;
 import org.apache.hadoop.hive.ql.plan.ExprNodeDesc;
 import org.apache.hadoop.hive.ql.plan.FetchWork;
 import org.apache.hadoop.hive.ql.plan.FileSinkDesc;
 import org.apache.hadoop.hive.ql.plan.FilterDesc.sampleDesc;
+import org.apache.hadoop.hive.ql.plan.LoadFileDesc;
 import org.apache.hadoop.hive.ql.plan.MapWork;
 import org.apache.hadoop.hive.ql.plan.MapredLocalWork;
 import org.apache.hadoop.hive.ql.plan.MapredWork;
+import org.apache.hadoop.hive.ql.plan.MoveWork;
 import org.apache.hadoop.hive.ql.plan.OperatorDesc;
 import org.apache.hadoop.hive.ql.plan.PartitionDesc;
 import org.apache.hadoop.hive.ql.plan.PlanUtils;
 import org.apache.hadoop.hive.ql.plan.ReduceSinkDesc;
 import org.apache.hadoop.hive.ql.plan.ReduceWork;
+import org.apache.hadoop.hive.ql.plan.StatsWork;
 import org.apache.hadoop.hive.ql.plan.TableDesc;
 import org.apache.hadoop.hive.ql.plan.TableScanDesc;
+import org.apache.hadoop.hive.ql.stats.StatsFactory;
+import org.apache.hadoop.hive.serde2.typeinfo.TypeInfoFactory;
+import org.apache.hadoop.mapred.InputFormat;
 
 /**
  * General utility common functions for the Processor to convert operator into
@@ -90,7 +107,7 @@ public final class GenMapRedUtils {
     LOG = LogFactory.getLog("org.apache.hadoop.hive.ql.optimizer.GenMapRedUtils");
   }
 
-  private static boolean needsTagging(ReduceWork rWork) {
+  public static boolean needsTagging(ReduceWork rWork) {
     return rWork != null && (rWork.getReducer().getClass() == JoinOperator.class ||
          rWork.getReducer().getClass() == DemuxOperator.class);
   }
@@ -444,18 +461,38 @@ private static ReadEntity getParentViewInfo(String alias_id,
   public static void setTaskPlan(String alias_id,
       Operator<? extends OperatorDesc> topOp, Task<?> task, boolean local,
       GenMRProcContext opProcCtx, PrunedPartitionList pList) throws SemanticException {
-    MapWork plan = ((MapredWork) task.getWork()).getMapWork();
-    ParseContext parseCtx = opProcCtx.getParseCtx();
-    Set<ReadEntity> inputs = opProcCtx.getInputs();
+    setMapWork(((MapredWork) task.getWork()).getMapWork(), opProcCtx.getParseCtx(),
+        opProcCtx.getInputs(), pList, topOp, alias_id, opProcCtx.getConf(), local);
+    opProcCtx.addSeenOp(task, topOp);
+  }
 
+  /**
+   * initialize MapWork
+   *
+   * @param alias_id
+   *          current alias
+   * @param topOp
+   *          the top operator of the stack
+   * @param plan
+   *          map work to initialize
+   * @param local
+   *          whether you need to add to map-reduce or local work
+   * @param pList
+   *          pruned partition list. If it is null it will be computed on-the-fly.
+   * @param inputs
+   *          read entities for the map work
+   * @param conf
+   *          current instance of hive conf
+   */
+  public static void setMapWork(MapWork plan, ParseContext parseCtx, Set<ReadEntity> inputs,
+      PrunedPartitionList partsList, Operator<? extends OperatorDesc> topOp, String alias_id,
+      HiveConf conf, boolean local) throws SemanticException {
     ArrayList<Path> partDir = new ArrayList<Path>();
     ArrayList<PartitionDesc> partDesc = new ArrayList<PartitionDesc>();
 
     Path tblDir = null;
     TableDesc tblDesc = null;
 
-    PrunedPartitionList partsList = pList;
-
     plan.setNameToSplitSample(parseCtx.getNameToSplitSample());
 
     if (partsList == null) {
@@ -701,7 +738,6 @@ public static void setTaskPlan(String alias_id,
       }
       plan.setMapLocalWork(localPlan);
     }
-    opProcCtx.addSeenOp(task, topOp);
   }
 
   /**
@@ -750,6 +786,21 @@ public static void setTaskPlan(String path, String alias,
     }
   }
 
+  /**
+   * Set key and value descriptor
+   * @param work RedueWork
+   * @param rs ReduceSinkOperator
+   */
+  public static void setKeyAndValueDesc(ReduceWork work, ReduceSinkOperator rs) {
+    work.setKeyDesc(rs.getConf().getKeySerializeInfo());
+    int tag = Math.max(0, rs.getConf().getTag());
+    List<TableDesc> tagToSchema = work.getTagToValueDesc();
+    while (tag + 1 > tagToSchema.size()) {
+      tagToSchema.add(null);
+    }
+    tagToSchema.set(tag, rs.getConf().getValueSerializeInfo());
+  }
+
   /**
    * set key and value descriptor.
    *
@@ -766,13 +817,7 @@ public static void setKeyAndValueDesc(ReduceWork plan,
 
     if (topOp instanceof ReduceSinkOperator) {
       ReduceSinkOperator rs = (ReduceSinkOperator) topOp;
-      plan.setKeyDesc(rs.getConf().getKeySerializeInfo());
-      int tag = Math.max(0, rs.getConf().getTag());
-      List<TableDesc> tagToSchema = plan.getTagToValueDesc();
-      while (tag + 1 > tagToSchema.size()) {
-        tagToSchema.add(null);
-      }
-      tagToSchema.set(tag, rs.getConf().getValueSerializeInfo());
+      setKeyAndValueDesc(plan, rs);
     } else {
       List<Operator<? extends OperatorDesc>> children = topOp.getChildOperators();
       if (children != null) {
@@ -1096,6 +1141,571 @@ public static void replaceMapWork(String sourceAlias, String targetAlias,
     }
   }
 
+  /**
+   * @param fsInput The FileSink operator.
+   * @param ctx The MR processing context.
+   * @param finalName the final destination path the merge job should output.
+   * @param dependencyTask
+   * @param mvTasks
+   * @param conf
+   * @param currTask
+   * @throws SemanticException
+
+   * create a Map-only merge job using CombineHiveInputFormat for all partitions with
+   * following operators:
+   *          MR job J0:
+   *          ...
+   *          |
+   *          v
+   *          FileSinkOperator_1 (fsInput)
+   *          |
+   *          v
+   *          Merge job J1:
+   *          |
+   *          v
+   *          TableScan (using CombineHiveInputFormat) (tsMerge)
+   *          |
+   *          v
+   *          FileSinkOperator (fsMerge)
+   *
+   *          Here the pathToPartitionInfo & pathToAlias will remain the same, which means the paths
+   *          do
+   *          not contain the dynamic partitions (their parent). So after the dynamic partitions are
+   *          created (after the first job finished before the moveTask or ConditionalTask start),
+   *          we need to change the pathToPartitionInfo & pathToAlias to include the dynamic
+   *          partition
+   *          directories.
+   *
+   */
+  public static void createMRWorkForMergingFiles (FileSinkOperator fsInput,
+   Path finalName, DependencyCollectionTask dependencyTask,
+   List<Task<MoveWork>> mvTasks, HiveConf conf,
+   Task<? extends Serializable> currTask) throws SemanticException {
+
+    //
+    // 1. create the operator tree
+    //
+    FileSinkDesc fsInputDesc = fsInput.getConf();
+
+    // Create a TableScan operator
+    RowSchema inputRS = fsInput.getSchema();
+    Operator<? extends OperatorDesc> tsMerge =
+        GenMapRedUtils.createTemporaryTableScanOperator(inputRS);
+
+    // Create a FileSink operator
+    TableDesc ts = (TableDesc) fsInputDesc.getTableInfo().clone();
+    FileSinkDesc fsOutputDesc = new FileSinkDesc(finalName.toUri().toString(), ts,
+      conf.getBoolVar(ConfVars.COMPRESSRESULT));
+    FileSinkOperator fsOutput = (FileSinkOperator) OperatorFactory.getAndMakeChild(
+      fsOutputDesc, inputRS, tsMerge);
+
+    // If the input FileSinkOperator is a dynamic partition enabled, the tsMerge input schema
+    // needs to include the partition column, and the fsOutput should have
+    // a DynamicPartitionCtx to indicate that it needs to dynamically partitioned.
+    DynamicPartitionCtx dpCtx = fsInputDesc.getDynPartCtx();
+    if (dpCtx != null && dpCtx.getNumDPCols() > 0) {
+      // adding DP ColumnInfo to the RowSchema signature
+      ArrayList<ColumnInfo> signature = inputRS.getSignature();
+      String tblAlias = fsInputDesc.getTableInfo().getTableName();
+      LinkedHashMap<String, String> colMap = new LinkedHashMap<String, String>();
+      StringBuilder partCols = new StringBuilder();
+      for (String dpCol : dpCtx.getDPColNames()) {
+        ColumnInfo colInfo = new ColumnInfo(dpCol,
+            TypeInfoFactory.stringTypeInfo, // all partition column type should be string
+            tblAlias, true); // partition column is virtual column
+        signature.add(colInfo);
+        colMap.put(dpCol, dpCol); // input and output have the same column name
+        partCols.append(dpCol).append('/');
+      }
+      partCols.setLength(partCols.length() - 1); // remove the last '/'
+      inputRS.setSignature(signature);
+
+      // create another DynamicPartitionCtx, which has a different input-to-DP column mapping
+      DynamicPartitionCtx dpCtx2 = new DynamicPartitionCtx(dpCtx);
+      dpCtx2.setInputToDPCols(colMap);
+      fsOutputDesc.setDynPartCtx(dpCtx2);
+
+      // update the FileSinkOperator to include partition columns
+      fsInputDesc.getTableInfo().getProperties().setProperty(
+        org.apache.hadoop.hive.metastore.api.hive_metastoreConstants.META_TABLE_PARTITION_COLUMNS,
+        partCols.toString()); // list of dynamic partition column names
+    } else {
+      // non-partitioned table
+      fsInputDesc.getTableInfo().getProperties().remove(
+        org.apache.hadoop.hive.metastore.api.hive_metastoreConstants.META_TABLE_PARTITION_COLUMNS);
+    }
+
+    //
+    // 2. Constructing a conditional task consisting of a move task and a map reduce task
+    //
+    MoveWork dummyMv = new MoveWork(null, null, null,
+         new LoadFileDesc(new Path(fsInputDesc.getFinalDirName()), finalName, true, null, null), false);
+    MapWork cplan;
+    Serializable work;
+
+    if (conf.getBoolVar(ConfVars.HIVEMERGERCFILEBLOCKLEVEL) &&
+        fsInputDesc.getTableInfo().getInputFileFormatClass().equals(RCFileInputFormat.class)) {
+
+      // Check if InputFormatClass is valid
+      String inputFormatClass = conf.getVar(ConfVars.HIVEMERGEINPUTFORMATBLOCKLEVEL);
+      try {
+        Class c = (Class<? extends InputFormat>) Class.forName(inputFormatClass);
+
+        LOG.info("RCFile format- Using block level merge");
+        cplan = GenMapRedUtils.createRCFileMergeTask(fsInputDesc, finalName,
+            dpCtx != null && dpCtx.getNumDPCols() > 0);
+        work = cplan;
+      } catch (ClassNotFoundException e) {
+        String msg = "Illegal input format class: " + inputFormatClass;
+        throw new SemanticException(msg);
+      }
+
+    } else {
+      cplan = createMRWorkForMergingFiles(conf, tsMerge, fsInputDesc);
+      work = new MapredWork();
+      ((MapredWork)work).setMapWork(cplan);
+    }
+    // use CombineHiveInputFormat for map-only merging
+    cplan.setInputformat("org.apache.hadoop.hive.ql.io.CombineHiveInputFormat");
+    // NOTE: we should gather stats in MR1 rather than MR2 at merge job since we don't
+    // know if merge MR2 will be triggered at execution time
+    ConditionalTask cndTsk = GenMapRedUtils.createCondTask(conf, currTask, dummyMv, work,
+        fsInputDesc.getFinalDirName());
+
+    // keep the dynamic partition context in conditional task resolver context
+    ConditionalResolverMergeFilesCtx mrCtx =
+        (ConditionalResolverMergeFilesCtx) cndTsk.getResolverCtx();
+    mrCtx.setDPCtx(fsInputDesc.getDynPartCtx());
+    mrCtx.setLbCtx(fsInputDesc.getLbCtx());
+
+    //
+    // 3. add the moveTask as the children of the conditional task
+    //
+    linkMoveTask(fsOutput, cndTsk, mvTasks, conf, dependencyTask);
+  }
+
+  /**
+   * Make the move task in the GenMRProcContext following the FileSinkOperator a dependent of all
+   * possible subtrees branching from the ConditionalTask.
+   *
+   * @param newOutput
+   * @param cndTsk
+   * @param mvTasks
+   * @param hconf
+   * @param dependencyTask
+   */
+  public static void linkMoveTask(FileSinkOperator newOutput,
+      ConditionalTask cndTsk, List<Task<MoveWork>> mvTasks, HiveConf hconf,
+      DependencyCollectionTask dependencyTask) {
+
+    Task<MoveWork> mvTask = GenMapRedUtils.findMoveTask(mvTasks, newOutput);
+
+    for (Task<? extends Serializable> tsk : cndTsk.getListTasks()) {
+      linkMoveTask(mvTask, tsk, hconf, dependencyTask);
+    }
+  }
+
+  /**
+   * Follows the task tree down from task and makes all leaves parents of mvTask
+   *
+   * @param mvTask
+   * @param task
+   * @param hconf
+   * @param dependencyTask
+   */
+  public static void linkMoveTask(Task<MoveWork> mvTask,
+      Task<? extends Serializable> task, HiveConf hconf,
+      DependencyCollectionTask dependencyTask) {
+
+    if (task.getDependentTasks() == null || task.getDependentTasks().isEmpty()) {
+      // If it's a leaf, add the move task as a child
+      addDependentMoveTasks(mvTask, hconf, task, dependencyTask);
+    } else {
+      // Otherwise, for each child run this method recursively
+      for (Task<? extends Serializable> childTask : task.getDependentTasks()) {
+        linkMoveTask(mvTask, childTask, hconf, dependencyTask);
+      }
+    }
+  }
+
+  /**
+   * Adds the dependencyTaskForMultiInsert in ctx as a dependent of parentTask. If mvTask is a
+   * load table, and HIVE_MULTI_INSERT_ATOMIC_OUTPUTS is set, adds mvTask as a dependent of
+   * dependencyTaskForMultiInsert in ctx, otherwise adds mvTask as a dependent of parentTask as
+   * well.
+   *
+   * @param mvTask
+   * @param hconf
+   * @param parentTask
+   * @param dependencyTask
+   */
+  public static void addDependentMoveTasks(Task<MoveWork> mvTask, HiveConf hconf,
+      Task<? extends Serializable> parentTask, DependencyCollectionTask dependencyTask) {
+
+    if (mvTask != null) {
+      if (dependencyTask != null) {
+        parentTask.addDependentTask(dependencyTask);
+        if (mvTask.getWork().getLoadTableWork() != null) {
+          // Moving tables/partitions depend on the dependencyTask
+          dependencyTask.addDependentTask(mvTask);
+        } else {
+          // Moving files depends on the parentTask (we still want the dependencyTask to depend
+          // on the parentTask)
+          parentTask.addDependentTask(mvTask);
+        }
+      } else {
+        parentTask.addDependentTask(mvTask);
+      }
+    }
+  }
+
+
+  /**
+   * Add the StatsTask as a dependent task of the MoveTask
+   * because StatsTask will change the Table/Partition metadata. For atomicity, we
+   * should not change it before the data is actually there done by MoveTask.
+   *
+   * @param nd
+   *          the FileSinkOperator whose results are taken care of by the MoveTask.
+   * @param mvTask
+   *          The MoveTask that moves the FileSinkOperator's results.
+   * @param currTask
+   *          The MapRedTask that the FileSinkOperator belongs to.
+   * @param hconf
+   *          HiveConf
+   */
+  public static void addStatsTask(FileSinkOperator nd, MoveTask mvTask,
+      Task<? extends Serializable> currTask, HiveConf hconf) {
+
+    MoveWork mvWork = mvTask.getWork();
+    StatsWork statsWork = null;
+    if (mvWork.getLoadTableWork() != null) {
+      statsWork = new StatsWork(mvWork.getLoadTableWork());
+    } else if (mvWork.getLoadFileWork() != null) {
+      statsWork = new StatsWork(mvWork.getLoadFileWork());
+    }
+    assert statsWork != null : "Error when genereting StatsTask";
+
+    statsWork.setSourceTask(currTask);
+    statsWork.setStatsReliable(hconf.getBoolVar(ConfVars.HIVE_STATS_RELIABLE));
+
+    if (currTask.getWork() instanceof MapredWork) {
+      MapredWork mrWork = (MapredWork) currTask.getWork();
+      mrWork.getMapWork().setGatheringStats(true);
+      if (mrWork.getReduceWork() != null) {
+        mrWork.getReduceWork().setGatheringStats(true);
+      }
+    }
+
+    // AggKey in StatsWork is used for stats aggregation while StatsAggPrefix
+    // in FileSinkDesc is used for stats publishing. They should be consistent.
+    statsWork.setAggKey(nd.getConf().getStatsAggPrefix());
+    Task<? extends Serializable> statsTask = TaskFactory.get(statsWork, hconf);
+
+    // mark the MapredWork and FileSinkOperator for gathering stats
+    nd.getConf().setGatherStats(true);
+    nd.getConf().setStatsReliable(hconf.getBoolVar(ConfVars.HIVE_STATS_RELIABLE));
+    nd.getConf().setMaxStatsKeyPrefixLength(StatsFactory.getMaxPrefixLength(hconf));
+    // mrWork.addDestinationTable(nd.getConf().getTableInfo().getTableName());
+
+    // subscribe feeds from the MoveTask so that MoveTask can forward the list
+    // of dynamic partition list to the StatsTask
+    mvTask.addDependentTask(statsTask);
+    statsTask.subscribeFeed(mvTask);
+  }
+
+  /**
+   * Returns true iff current query is an insert into for the given file sink
+   *
+   * @param parseCtx
+   * @param fsOp
+   * @return
+   */
+  public static boolean isInsertInto(ParseContext parseCtx, FileSinkOperator fsOp) {
+    return fsOp.getConf().getTableInfo().getTableName() != null &&
+        parseCtx.getQB().getParseInfo().isInsertToTable();
+  }
+
+  /**
+   * Create a MapredWork based on input path, the top operator and the input
+   * table descriptor.
+   *
+   * @param conf
+   * @param topOp
+   *          the table scan operator that is the root of the MapReduce task.
+   * @param fsDesc
+   *          the file sink descriptor that serves as the input to this merge task.
+   * @param parentMR
+   *          the parent MapReduce work
+   * @param parentFS
+   *          the last FileSinkOperator in the parent MapReduce work
+   * @return the MapredWork
+   */
+  private static MapWork createMRWorkForMergingFiles (HiveConf conf,
+    Operator<? extends OperatorDesc> topOp,  FileSinkDesc fsDesc) {
+
+    ArrayList<String> aliases = new ArrayList<String>();
+    String inputDir = fsDesc.getFinalDirName();
+    TableDesc tblDesc = fsDesc.getTableInfo();
+    aliases.add(inputDir); // dummy alias: just use the input path
+
+    // constructing the default MapredWork
+    MapredWork cMrPlan = GenMapRedUtils.getMapRedWorkFromConf(conf);
+    MapWork cplan = cMrPlan.getMapWork();
+    cplan.getPathToAliases().put(inputDir, aliases);
+    cplan.getPathToPartitionInfo().put(inputDir, new PartitionDesc(tblDesc, null));
+    cplan.getAliasToWork().put(inputDir, topOp);
+    cplan.setMapperCannotSpanPartns(true);
+
+    return cplan;
+  }
+
+  /**
+   * Create a block level merge task for RCFiles.
+   *
+   * @param fsInputDesc
+   * @param finalName
+   * @return MergeWork if table is stored as RCFile,
+   *         null otherwise
+   */
+  public static MapWork createRCFileMergeTask(FileSinkDesc fsInputDesc,
+      Path finalName, boolean hasDynamicPartitions) throws SemanticException {
+
+    String inputDir = fsInputDesc.getFinalDirName();
+    TableDesc tblDesc = fsInputDesc.getTableInfo();
+
+    if (tblDesc.getInputFileFormatClass().equals(RCFileInputFormat.class)) {
+      ArrayList<Path> inputDirs = new ArrayList<Path>(1);
+      ArrayList<String> inputDirstr = new ArrayList<String>(1);
+      if (!hasDynamicPartitions
+          && !GenMapRedUtils.isSkewedStoredAsDirs(fsInputDesc)) {
+        inputDirs.add(new Path(inputDir));
+        inputDirstr.add(inputDir);
+      }
+
+      MergeWork work = new MergeWork(inputDirs, finalName,
+          hasDynamicPartitions, fsInputDesc.getDynPartCtx());
+      LinkedHashMap<String, ArrayList<String>> pathToAliases =
+          new LinkedHashMap<String, ArrayList<String>>();
+      pathToAliases.put(inputDir, (ArrayList<String>) inputDirstr.clone());
+      work.setMapperCannotSpanPartns(true);
+      work.setPathToAliases(pathToAliases);
+      work.setAliasToWork(
+          new LinkedHashMap<String, Operator<? extends OperatorDesc>>());
+      if (hasDynamicPartitions
+          || GenMapRedUtils.isSkewedStoredAsDirs(fsInputDesc)) {
+        work.getPathToPartitionInfo().put(inputDir,
+            new PartitionDesc(tblDesc, null));
+      }
+      work.setListBucketingCtx(fsInputDesc.getLbCtx());
+
+      return work;
+    }
+
+    throw new SemanticException("createRCFileMergeTask called on non-RCFile table");
+  }
+
+  /**
+   * Construct a conditional task given the current leaf task, the MoveWork and the MapredWork.
+   *
+   * @param conf
+   *          HiveConf
+   * @param currTask
+   *          current leaf task
+   * @param mvWork
+   *          MoveWork for the move task
+   * @param mergeWork
+   *          MapredWork for the merge task.
+   * @param inputPath
+   *          the input directory of the merge/move task
+   * @return The conditional task
+   */
+  @SuppressWarnings("unchecked")
+  public static ConditionalTask createCondTask(HiveConf conf,
+      Task<? extends Serializable> currTask, MoveWork mvWork,
+      Serializable mergeWork, String inputPath) {
+
+    // There are 3 options for this ConditionalTask:
+    // 1) Merge the partitions
+    // 2) Move the partitions (i.e. don't merge the partitions)
+    // 3) Merge some partitions and move other partitions (i.e. merge some partitions and don't
+    // merge others) in this case the merge is done first followed by the move to prevent
+    // conflicts.
+    Task<? extends Serializable> mergeOnlyMergeTask = TaskFactory.get(mergeWork, conf);
+    Task<? extends Serializable> moveOnlyMoveTask = TaskFactory.get(mvWork, conf);
+    Task<? extends Serializable> mergeAndMoveMergeTask = TaskFactory.get(mergeWork, conf);
+    Task<? extends Serializable> mergeAndMoveMoveTask = TaskFactory.get(mvWork, conf);
+
+    // NOTE! It is necessary merge task is the parent of the move task, and not
+    // the other way around, for the proper execution of the execute method of
+    // ConditionalTask
+    mergeAndMoveMergeTask.addDependentTask(mergeAndMoveMoveTask);
+
+    List<Serializable> listWorks = new ArrayList<Serializable>();
+    listWorks.add(mvWork);
+    listWorks.add(mergeWork);
+
+    ConditionalWork cndWork = new ConditionalWork(listWorks);
+
+    List<Task<? extends Serializable>> listTasks = new ArrayList<Task<? extends Serializable>>();
+    listTasks.add(moveOnlyMoveTask);
+    listTasks.add(mergeOnlyMergeTask);
+    listTasks.add(mergeAndMoveMergeTask);
+
+    ConditionalTask cndTsk = (ConditionalTask) TaskFactory.get(cndWork, conf);
+    cndTsk.setListTasks(listTasks);
+
+    // create resolver
+    cndTsk.setResolver(new ConditionalResolverMergeFiles());
+    ConditionalResolverMergeFilesCtx mrCtx =
+        new ConditionalResolverMergeFilesCtx(listTasks, inputPath);
+    cndTsk.setResolverCtx(mrCtx);
+
+    // make the conditional task as the child of the current leaf task
+    currTask.addDependentTask(cndTsk);
+
+    return cndTsk;
+  }
+
+  /**
+   * check if it is skewed table and stored as dirs.
+   *
+   * @param fsInputDesc
+   * @return
+   */
+  public static boolean isSkewedStoredAsDirs(FileSinkDesc fsInputDesc) {
+    return (fsInputDesc.getLbCtx() == null) ? false : fsInputDesc.getLbCtx()
+        .isSkewedStoredAsDir();
+  }
+
+  public static Task<MoveWork> findMoveTask(
+      List<Task<MoveWork>> mvTasks, FileSinkOperator fsOp) {
+    // find the move task
+    for (Task<MoveWork> mvTsk : mvTasks) {
+      MoveWork mvWork = mvTsk.getWork();
+      Path srcDir = null;
+      if (mvWork.getLoadFileWork() != null) {
+        srcDir = mvWork.getLoadFileWork().getSourcePath();
+      } else if (mvWork.getLoadTableWork() != null) {
+        srcDir = mvWork.getLoadTableWork().getSourcePath();
+      }
+
+      if ((srcDir != null)
+          && (srcDir.equals(new Path(fsOp.getConf().getFinalDirName())))) {
+        return mvTsk;
+      }
+    }
+    return null;
+  }
+
+  /**
+   * Returns true iff the fsOp requires a merge
+   * @param mvTasks
+   * @param hconf
+   * @param fsOp
+   * @param currTask
+   * @param isInsertTable
+   * @return
+   */
+  public static boolean isMergeRequired(List<Task<MoveWork>> mvTasks, HiveConf hconf, FileSinkOperator fsOp,
+      Task<? extends Serializable> currTask, boolean isInsertTable) {
+
+    // Has the user enabled merging of files for map-only jobs or for all jobs
+    if ((mvTasks != null) && (!mvTasks.isEmpty())) {
+
+      // no need of merging if the move is to a local file system
+      MoveTask mvTask = (MoveTask) GenMapRedUtils.findMoveTask(mvTasks, fsOp);
+
+      if (mvTask != null && isInsertTable && hconf.getBoolVar(ConfVars.HIVESTATSAUTOGATHER)) {
+        GenMapRedUtils.addStatsTask(fsOp, mvTask, currTask, hconf);
+      }
+
+      if ((mvTask != null) && !mvTask.isLocal() && fsOp.getConf().canBeMerged()) {
+        if (fsOp.getConf().isLinkedFileSink()) {
+          // If the user has HIVEMERGEMAPREDFILES set to false, the idea was the
+          // number of reducers are few, so the number of files anyway are small.
+          // However, with this optimization, we are increasing the number of files
+          // possibly by a big margin. So, merge aggresively.
+          if (hconf.getBoolVar(ConfVars.HIVEMERGEMAPFILES) ||
+              hconf.getBoolVar(ConfVars.HIVEMERGEMAPREDFILES)) {
+            return true;
+          }
+        } else {
+          // There are separate configuration parameters to control whether to
+          // merge for a map-only job
+          // or for a map-reduce job
+          if (currTask.getWork() instanceof MapredWork) {
+            ReduceWork reduceWork = ((MapredWork) currTask.getWork()).getReduceWork();
+            boolean mergeMapOnly =
+                hconf.getBoolVar(ConfVars.HIVEMERGEMAPFILES) && reduceWork == null;
+            boolean mergeMapRed =
+                hconf.getBoolVar(ConfVars.HIVEMERGEMAPREDFILES) &&
+                reduceWork != null;
+            if (mergeMapOnly || mergeMapRed) {
+              return true;
+            }
+          } else {
+            return false;
+          }
+        }
+      }
+    }
+    return false;
+  }
+
+  /**
+   * Create and add any dependent move tasks
+   *
+   * @param currTask
+   * @param chDir
+   * @param fsOp
+   * @param parseCtx
+   * @param mvTasks
+   * @param hconf
+   * @param dependencyTask
+   * @return
+   */
+  public static Path createMoveTask(Task<? extends Serializable> currTask, boolean chDir,
+      FileSinkOperator fsOp, ParseContext parseCtx, List<Task<MoveWork>> mvTasks,
+      HiveConf hconf, DependencyCollectionTask dependencyTask) {
+
+    Path dest = null;
+
+    if (chDir) {
+      dest = new Path(fsOp.getConf().getFinalDirName());
+
+      // generate the temporary file
+      // it must be on the same file system as the current destination
+      Context baseCtx = parseCtx.getContext();
+      String tmpDir = baseCtx.getExternalTmpFileURI(dest.toUri());
+
+      FileSinkDesc fileSinkDesc = fsOp.getConf();
+      // Change all the linked file sink descriptors
+      if (fileSinkDesc.isLinkedFileSink()) {
+        for (FileSinkDesc fsConf:fileSinkDesc.getLinkedFileSinkDesc()) {
+          String fileName = Utilities.getFileNameFromDirName(fsConf.getDirName());
+          fsConf.setParentDir(tmpDir);
+          fsConf.setDirName(tmpDir + Path.SEPARATOR + fileName);
+        }
+      } else {
+        fileSinkDesc.setDirName(tmpDir);
+      }
+    }
+
+    Task<MoveWork> mvTask = null;
+
+    if (!chDir) {
+      mvTask = GenMapRedUtils.findMoveTask(mvTasks, fsOp);
+    }
+
+    // Set the move task to be dependent on the current task
+    if (mvTask != null) {
+      GenMapRedUtils.addDependentMoveTasks(mvTask, hconf, currTask, dependencyTask);
+    }
+
+    return dest;
+  }
+
   private GenMapRedUtils() {
     // prevent instantiation
   }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GroupByOptimizer.java b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GroupByOptimizer.java
index 670e39cb7c..c16010fc84 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GroupByOptimizer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GroupByOptimizer.java
@@ -286,7 +286,7 @@ protected GroupByOptimizerSortMatch checkSortGroupBy(Stack<Node> stack,
       currOp = currOp.getParentOperators().get(0);
 
       while (true) {
-        if (currOp.getParentOperators() == null) {
+        if ((currOp.getParentOperators() == null) || (currOp.getParentOperators().isEmpty())) {
           break;
         }
 
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/MapJoinProcessor.java b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/MapJoinProcessor.java
index be3cf6b2a4..b4aeb14858 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/MapJoinProcessor.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/MapJoinProcessor.java
@@ -236,13 +236,14 @@ private static String genMapJoinLocalWork(MapredWork newWork, MapJoinOperator ma
    * @return the alias to the big table
    * @throws SemanticException
    */
-  public static String genMapJoinOpAndLocalWork(MapredWork newWork, JoinOperator op, int mapJoinPos)
+  public static String genMapJoinOpAndLocalWork(HiveConf conf, MapredWork newWork,
+    JoinOperator op, int mapJoinPos)
       throws SemanticException {
     LinkedHashMap<Operator<? extends OperatorDesc>, OpParseContext> opParseCtxMap =
         newWork.getMapWork().getOpParseCtxMap();
     QBJoinTree newJoinTree = newWork.getMapWork().getJoinTree();
     // generate the map join operator; already checked the map join
-    MapJoinOperator newMapJoinOp = MapJoinProcessor.convertMapJoin(opParseCtxMap, op,
+    MapJoinOperator newMapJoinOp = MapJoinProcessor.convertMapJoin(conf, opParseCtxMap, op,
         newJoinTree, mapJoinPos, true, false);
     return genLocalWorkForMapJoin(newWork, newMapJoinOp, mapJoinPos);
   }
@@ -315,7 +316,7 @@ private static void validateMapJoinTypes(Operator<? extends OperatorDesc> op)
    *          are cached in memory
    * @param noCheckOuterJoin
    */
-  public static MapJoinOperator convertMapJoin(
+  public static MapJoinOperator convertMapJoin(HiveConf conf,
     LinkedHashMap<Operator<? extends OperatorDesc>, OpParseContext> opParseCtxMap,
     JoinOperator op, QBJoinTree joinTree, int mapJoinPos, boolean noCheckOuterJoin,
     boolean validateMapJoinTree)
@@ -372,21 +373,90 @@ public static MapJoinOperator convertMapJoin(
       pos++;
     }
 
-    // get the join keys from old parent ReduceSink operators
+    // create the map-join operator
+    MapJoinOperator mapJoinOp = convertJoinOpMapJoinOp(conf, opParseCtxMap,
+        op, joinTree, mapJoinPos, noCheckOuterJoin);
+
+
+    // remove old parents
     for (pos = 0; pos < newParentOps.size(); pos++) {
-      ReduceSinkOperator oldPar = (ReduceSinkOperator) oldReduceSinkParentOps.get(pos);
-      ReduceSinkDesc rsconf = oldPar.getConf();
+      newParentOps.get(pos).removeChild(oldReduceSinkParentOps.get(pos));
+      newParentOps.get(pos).getChildOperators().add(mapJoinOp);
+    }
+
+
+    mapJoinOp.getParentOperators().removeAll(oldReduceSinkParentOps);
+    mapJoinOp.setParentOperators(newParentOps);
+
+    // make sure only map-joins can be performed.
+    if (validateMapJoinTree) {
+      validateMapJoinTypes(mapJoinOp);
+    }
+
+    // change the children of the original join operator to point to the map
+    // join operator
+
+    return mapJoinOp;
+  }
+
+  public static MapJoinOperator convertJoinOpMapJoinOp(HiveConf hconf,
+      LinkedHashMap<Operator<? extends OperatorDesc>, OpParseContext> opParseCtxMap,
+      JoinOperator op, QBJoinTree joinTree, int mapJoinPos, boolean noCheckOuterJoin)
+      throws SemanticException {
+
+    JoinDesc desc = op.getConf();
+    JoinCondDesc[] condns = desc.getConds();
+    Byte[] tagOrder = desc.getTagOrder();
+
+    // outer join cannot be performed on a table which is being cached
+    if (!noCheckOuterJoin) {
+      if (checkMapJoin(mapJoinPos, condns) < 0) {
+        throw new SemanticException(ErrorMsg.NO_OUTER_MAPJOIN.getMsg());
+      }
+    }
+
+    Map<Byte, List<ExprNodeDesc>> keyExprMap = new HashMap<Byte, List<ExprNodeDesc>>();
+
+    // Walk over all the sources (which are guaranteed to be reduce sink
+    // operators).
+    // The join outputs a concatenation of all the inputs.
+    QBJoinTree leftSrc = joinTree.getJoinSrc();
+    List<Operator<? extends OperatorDesc>> oldReduceSinkParentOps =
+        new ArrayList<Operator<? extends OperatorDesc>>();
+    if (leftSrc != null) {
+      // assert mapJoinPos == 0;
+      Operator<? extends OperatorDesc> parentOp = op.getParentOperators().get(0);
+      assert parentOp.getParentOperators().size() == 1;
+      oldReduceSinkParentOps.add(parentOp);
+    }
+
+
+    byte pos = 0;
+    for (String src : joinTree.getBaseSrc()) {
+      if (src != null) {
+        Operator<? extends OperatorDesc> parentOp = op.getParentOperators().get(pos);
+        assert parentOp.getParentOperators().size() == 1;
+        oldReduceSinkParentOps.add(parentOp);
+      }
+      pos++;
+    }
+
+    // get the join keys from old parent ReduceSink operators
+    for (pos = 0; pos < op.getParentOperators().size(); pos++) {
+      ReduceSinkOperator parent = (ReduceSinkOperator) oldReduceSinkParentOps.get(pos);
+      ReduceSinkDesc rsconf = parent.getConf();
       List<ExprNodeDesc> keys = rsconf.getKeyCols();
       keyExprMap.put(pos, keys);
     }
 
-    // removing RS, only ExprNodeDesc is changed (key/value/filter exprs and colExprMap)
-    // others (output column-name, RR, schema) remain intact
-    Map<String, ExprNodeDesc> colExprMap = op.getColumnExprMap();
-    List<String> outputColumnNames = op.getConf().getOutputColumnNames();
+    List<ExprNodeDesc> keyCols = keyExprMap.get(Byte.valueOf((byte) 0));
+    StringBuilder keyOrder = new StringBuilder();
+    for (int i = 0; i < keyCols.size(); i++) {
+      keyOrder.append("+");
+    }
 
+    Map<String, ExprNodeDesc> colExprMap = op.getColumnExprMap();
     List<ColumnInfo> schema = new ArrayList<ColumnInfo>(op.getSchema().getSignature());
-
     Map<Byte, List<ExprNodeDesc>> valueExprs = op.getConf().getExprs();
     Map<Byte, List<ExprNodeDesc>> newValueExprs = new HashMap<Byte, List<ExprNodeDesc>>();
     for (Map.Entry<Byte, List<ExprNodeDesc>> entry : valueExprs.entrySet()) {
@@ -410,45 +480,12 @@ public static MapJoinOperator convertMapJoin(
       }
     }
 
-    Map<Byte, List<ExprNodeDesc>> filters = desc.getFilters();
-    Map<Byte, List<ExprNodeDesc>> newFilters = new HashMap<Byte, List<ExprNodeDesc>>();
-    for (Map.Entry<Byte, List<ExprNodeDesc>> entry : filters.entrySet()) {
-      byte srcTag = entry.getKey();
-      List<ExprNodeDesc> filter = entry.getValue();
-
-      Operator<?> terminal = oldReduceSinkParentOps.get(srcTag);
-      newFilters.put(srcTag, ExprNodeDescUtils.backtrack(filter, op, terminal));
-    }
-    desc.setFilters(filters = newFilters);
-
-    // remove old parents
-    for (pos = 0; pos < newParentOps.size(); pos++) {
-      newParentOps.get(pos).removeChild(oldReduceSinkParentOps.get(pos));
-    }
-
-    JoinCondDesc[] joinCondns = op.getConf().getConds();
-
-    Operator[] newPar = new Operator[newParentOps.size()];
-    pos = 0;
-    for (Operator<? extends OperatorDesc> o : newParentOps) {
-      newPar[pos++] = o;
-    }
-
-    List<ExprNodeDesc> keyCols = keyExprMap.get(Byte.valueOf((byte) 0));
-    StringBuilder keyOrder = new StringBuilder();
-    for (int i = 0; i < keyCols.size(); i++) {
-      keyOrder.append("+");
-    }
-
-    TableDesc keyTableDesc = PlanUtils.getMapJoinKeyTableDesc(PlanUtils
-        .getFieldSchemasFromColumnList(keyCols, MAPJOINKEY_FIELDPREFIX));
-
+    // construct valueTableDescs and valueFilteredTableDescs
     List<TableDesc> valueTableDescs = new ArrayList<TableDesc>();
     List<TableDesc> valueFiltedTableDescs = new ArrayList<TableDesc>();
-
     int[][] filterMap = desc.getFilterMap();
-    for (pos = 0; pos < newParentOps.size(); pos++) {
-      List<ExprNodeDesc> valueCols = newValueExprs.get(pos);
+    for (pos = 0; pos < op.getParentOperators().size(); pos++) {
+      List<ExprNodeDesc> valueCols = newValueExprs.get(Byte.valueOf((byte) pos));
       int length = valueCols.size();
       List<ExprNodeDesc> valueFilteredCols = new ArrayList<ExprNodeDesc>(length);
       // deep copy expr node desc
@@ -475,6 +512,19 @@ public static MapJoinOperator convertMapJoin(
       valueTableDescs.add(valueTableDesc);
       valueFiltedTableDescs.add(valueFilteredTableDesc);
     }
+
+    Map<Byte, List<ExprNodeDesc>> filters = desc.getFilters();
+    Map<Byte, List<ExprNodeDesc>> newFilters = new HashMap<Byte, List<ExprNodeDesc>>();
+    for (Map.Entry<Byte, List<ExprNodeDesc>> entry : filters.entrySet()) {
+      byte srcTag = entry.getKey();
+      List<ExprNodeDesc> filter = entry.getValue();
+
+      Operator<?> terminal = op.getParentOperators().get(srcTag);
+      newFilters.put(srcTag, ExprNodeDescUtils.backtrack(filter, op, terminal));
+    }
+    desc.setFilters(filters = newFilters);
+
+    // create dumpfile prefix needed to create descriptor
     String dumpFilePrefix = "";
     if( joinTree.getMapAliases() != null ) {
       for(String mapAlias : joinTree.getMapAliases()) {
@@ -484,15 +534,24 @@ public static MapJoinOperator convertMapJoin(
     } else {
       dumpFilePrefix = "mapfile"+PlanUtils.getCountForMapJoinDumpFilePrefix();
     }
+
+    List<String> outputColumnNames = op.getConf().getOutputColumnNames();
+    TableDesc keyTableDesc = PlanUtils.getMapJoinKeyTableDesc(hconf,
+        PlanUtils.getFieldSchemasFromColumnList(keyCols, MAPJOINKEY_FIELDPREFIX));
+    JoinCondDesc[] joinCondns = op.getConf().getConds();
     MapJoinDesc mapJoinDescriptor = new MapJoinDesc(keyExprMap, keyTableDesc, newValueExprs,
         valueTableDescs, valueFiltedTableDescs, outputColumnNames, mapJoinPos, joinCondns,
         filters, op.getConf().getNoOuterJoin(), dumpFilePrefix);
+    mapJoinDescriptor.setStatistics(op.getConf().getStatistics());
     mapJoinDescriptor.setTagOrder(tagOrder);
     mapJoinDescriptor.setNullSafes(desc.getNullSafes());
     mapJoinDescriptor.setFilterMap(desc.getFilterMap());
 
+    // reduce sink row resolver used to generate map join op
+    RowResolver outputRS = opParseCtxMap.get(op).getRowResolver();
+
     MapJoinOperator mapJoinOp = (MapJoinOperator) OperatorFactory.getAndMakeChild(
-        mapJoinDescriptor, new RowSchema(outputRS.getColumnInfos()), newPar);
+        mapJoinDescriptor, new RowSchema(outputRS.getColumnInfos()), op.getParentOperators());
 
     OpParseContext ctx = new OpParseContext(outputRS);
     opParseCtxMap.put(mapJoinOp, ctx);
@@ -500,24 +559,17 @@ public static MapJoinOperator convertMapJoin(
     mapJoinOp.getConf().setReversedExprs(op.getConf().getReversedExprs());
     mapJoinOp.setColumnExprMap(colExprMap);
 
-    // change the children of the original join operator to point to the map
-    // join operator
     List<Operator<? extends OperatorDesc>> childOps = op.getChildOperators();
     for (Operator<? extends OperatorDesc> childOp : childOps) {
       childOp.replaceParent(op, mapJoinOp);
     }
 
     mapJoinOp.setChildOperators(childOps);
-    mapJoinOp.setParentOperators(newParentOps);
     op.setChildOperators(null);
     op.setParentOperators(null);
 
-    // make sure only map-joins can be performed.
-    if (validateMapJoinTree) {
-      validateMapJoinTypes(mapJoinOp);
-    }
-
     return mapJoinOp;
+
   }
 
   /**
@@ -533,14 +585,14 @@ public static MapJoinOperator convertMapJoin(
    *          are cached in memory
    * @param noCheckOuterJoin
    */
-  public static MapJoinOperator convertSMBJoinToMapJoin(
+  public static MapJoinOperator convertSMBJoinToMapJoin(HiveConf hconf,
     Map<Operator<? extends OperatorDesc>, OpParseContext> opParseCtxMap,
     SMBMapJoinOperator smbJoinOp, QBJoinTree joinTree, int bigTablePos, boolean noCheckOuterJoin)
     throws SemanticException {
     // Create a new map join operator
     SMBJoinDesc smbJoinDesc = smbJoinOp.getConf();
     List<ExprNodeDesc> keyCols = smbJoinDesc.getKeys().get(Byte.valueOf((byte) 0));
-    TableDesc keyTableDesc = PlanUtils.getMapJoinKeyTableDesc(PlanUtils
+    TableDesc keyTableDesc = PlanUtils.getMapJoinKeyTableDesc(hconf, PlanUtils
         .getFieldSchemasFromColumnList(keyCols, MAPJOINKEY_FIELDPREFIX));
     MapJoinDesc mapJoinDesc = new MapJoinDesc(smbJoinDesc.getKeys(),
         keyTableDesc, smbJoinDesc.getExprs(),
@@ -549,6 +601,8 @@ public static MapJoinOperator convertSMBJoinToMapJoin(
         bigTablePos, smbJoinDesc.getConds(),
         smbJoinDesc.getFilters(), smbJoinDesc.isNoOuterJoin(), smbJoinDesc.getDumpFilePrefix());
 
+    mapJoinDesc.setStatistics(smbJoinDesc.getStatistics());
+
     RowResolver joinRS = opParseCtxMap.get(smbJoinOp).getRowResolver();
     // The mapjoin has the same schema as the join operator
     MapJoinOperator mapJoinOp = (MapJoinOperator) OperatorFactory.getAndMakeChild(
@@ -588,8 +642,8 @@ public MapJoinOperator generateMapJoinOperator(ParseContext pctx, JoinOperator o
 
     LinkedHashMap<Operator<? extends OperatorDesc>, OpParseContext> opParseCtxMap = pctx
         .getOpParseCtx();
-    MapJoinOperator mapJoinOp = convertMapJoin(opParseCtxMap, op, joinTree, mapJoinPos,
-        noCheckOuterJoin, true);
+    MapJoinOperator mapJoinOp = convertMapJoin(pctx.getConf(), opParseCtxMap, op,
+        joinTree, mapJoinPos, noCheckOuterJoin, true);
     // create a dummy select to select all columns
     genSelectPlan(pctx, mapJoinOp);
     return mapJoinOp;
@@ -609,7 +663,7 @@ public MapJoinOperator generateMapJoinOperator(ParseContext pctx, JoinOperator o
    * If see a right outer join, set lastSeenRightOuterJoin to true, clear the
    * bigTableCandidates, and add right side to the bigTableCandidates, it means
    * the right side of a right outer join always win. If see a full outer join,
-   * return null immediately (no one can be the big table, can not do a
+   * return empty set immediately (no one can be the big table, can not do a
    * mapjoin).
    *
    *
@@ -635,7 +689,8 @@ public static Set<Integer> getBigTableCandidates(JoinCondDesc[] condns) {
         // changed in future, these 2 are not missing.
         seenOuterJoin = true;
         lastSeenRightOuterJoin = false;
-        return null;
+        // empty set - cannot convert
+        return new HashSet<Integer>();
       } else if (joinType == JoinDesc.LEFT_OUTER_JOIN
           || joinType == JoinDesc.LEFT_SEMI_JOIN) {
         seenOuterJoin = true;
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/SkewJoinOptimizer.java b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/SkewJoinOptimizer.java
index a49a216e93..54afbfe9bf 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/SkewJoinOptimizer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/SkewJoinOptimizer.java
@@ -398,7 +398,8 @@ private Table getTable(
             return parseContext.getTopToTable().get(tsOp);
           }
         }
-        if ((op.getParentOperators() == null) || (op.getParentOperators().size() > 1)) {
+        if ((op.getParentOperators() == null) || (op.getParentOperators().isEmpty()) || 
+            (op.getParentOperators().size() > 1)) {
           return null;
         }
         op = op.getParentOperators().get(0);
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/correlation/CorrelationOptimizer.java b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/correlation/CorrelationOptimizer.java
index 879aa58977..359564037d 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/correlation/CorrelationOptimizer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/correlation/CorrelationOptimizer.java
@@ -168,7 +168,7 @@ private void findPossibleAutoConvertedJoinOperators() throws SemanticException {
       int numAliases = order.length;
       Set<Integer> bigTableCandidates =
           MapJoinProcessor.getBigTableCandidates(joinDesc.getConds());
-      if (bigTableCandidates == null) {
+      if (bigTableCandidates.isEmpty()) {
         continue;
       }
 
@@ -346,7 +346,7 @@ private LinkedHashSet<ReduceSinkOperator> findCorrelatedReduceSinkOperators(
             "involved in this operator");
         return correlatedReduceSinkOperators;
       }
-      if (current.getParentOperators() == null) {
+      if ((current.getParentOperators() == null) || (current.getParentOperators().isEmpty())) {
         return correlatedReduceSinkOperators;
       }
       if (current instanceof PTFOperator) {
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/CommonJoinTaskDispatcher.java b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/CommonJoinTaskDispatcher.java
index 37ed27515a..082074382d 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/CommonJoinTaskDispatcher.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/CommonJoinTaskDispatcher.java
@@ -189,7 +189,8 @@ private ObjectPair<MapRedTask, String> convertTaskToMapJoinTask(MapredWork newWo
 
     // optimize this newWork given the big table position
     String bigTableAlias =
-        MapJoinProcessor.genMapJoinOpAndLocalWork(newWork, newJoinOp, bigTablePosition);
+        MapJoinProcessor.genMapJoinOpAndLocalWork(physicalContext.getParseContext().getConf(),
+            newWork, newJoinOp, bigTablePosition);
     return new ObjectPair<MapRedTask, String>(newTask, bigTableAlias);
   }
 
@@ -434,7 +435,7 @@ public Task<? extends Serializable> processCurrentTask(MapRedTask currTask,
           .getConds());
 
       // no table could be the big table; there is no need to convert
-      if (bigTableCandidates == null) {
+      if (bigTableCandidates.isEmpty()) {
         return null;
       }
 
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/SortMergeJoinTaskDispatcher.java b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/SortMergeJoinTaskDispatcher.java
index 808a7e50be..f4cd3ab3bf 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/SortMergeJoinTaskDispatcher.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/SortMergeJoinTaskDispatcher.java
@@ -205,7 +205,7 @@ private boolean isEligibleForOptimization(SMBMapJoinOperator originalSMBJoinOp)
 
     Operator<? extends OperatorDesc> currOp = originalSMBJoinOp;
     while (true) {
-      if (currOp.getChildOperators() == null) {
+      if ((currOp.getChildOperators() == null) || (currOp.getChildOperators().isEmpty())) {
         if (currOp instanceof FileSinkOperator) {
           FileSinkOperator fsOp = (FileSinkOperator)currOp;
           // The query has enforced that a sort-merge join should be performed.
@@ -433,7 +433,8 @@ private MapJoinOperator getMapJoinOperator(MapRedTask task,
     opParseContextMap.put(newSMBJoinOp, opParseContextMap.get(oldSMBJoinOp));
 
     // generate the map join operator
-    return MapJoinProcessor.convertSMBJoinToMapJoin(opParseContextMap, newSMBJoinOp,
+    return MapJoinProcessor.convertSMBJoinToMapJoin(physicalContext.getConf(),
+        opParseContextMap, newSMBJoinOp,
         joinTree, mapJoinPos, true);
   }
 }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/MapReduceCompiler.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/MapReduceCompiler.java
index e30118a263..76f5a31f73 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/MapReduceCompiler.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/MapReduceCompiler.java
@@ -22,10 +22,10 @@
 import java.io.Serializable;
 import java.util.ArrayList;
 import java.util.HashMap;
-import java.util.HashSet;
 import java.util.LinkedHashMap;
 import java.util.List;
 import java.util.Map;
+import java.util.Set;
 
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
@@ -33,21 +33,14 @@
 import org.apache.hadoop.fs.Path;
 import org.apache.hadoop.fs.PathFilter;
 import org.apache.hadoop.hive.conf.HiveConf;
-import org.apache.hadoop.hive.metastore.Warehouse;
-import org.apache.hadoop.hive.metastore.api.MetaException;
 import org.apache.hadoop.hive.ql.Context;
-import org.apache.hadoop.hive.ql.ErrorMsg;
-import org.apache.hadoop.hive.ql.exec.ColumnStatsTask;
 import org.apache.hadoop.hive.ql.exec.ConditionalTask;
-import org.apache.hadoop.hive.ql.exec.FetchTask;
 import org.apache.hadoop.hive.ql.exec.FileSinkOperator;
 import org.apache.hadoop.hive.ql.exec.MapJoinOperator;
 import org.apache.hadoop.hive.ql.exec.Operator;
 import org.apache.hadoop.hive.ql.exec.ReduceSinkOperator;
-import org.apache.hadoop.hive.ql.exec.StatsTask;
 import org.apache.hadoop.hive.ql.exec.TableScanOperator;
 import org.apache.hadoop.hive.ql.exec.Task;
-import org.apache.hadoop.hive.ql.exec.TaskFactory;
 import org.apache.hadoop.hive.ql.exec.UnionOperator;
 import org.apache.hadoop.hive.ql.exec.Utilities;
 import org.apache.hadoop.hive.ql.exec.mr.ExecDriver;
@@ -61,9 +54,6 @@
 import org.apache.hadoop.hive.ql.lib.NodeProcessor;
 import org.apache.hadoop.hive.ql.lib.Rule;
 import org.apache.hadoop.hive.ql.lib.RuleRegExp;
-import org.apache.hadoop.hive.ql.metadata.Hive;
-import org.apache.hadoop.hive.ql.metadata.HiveException;
-import org.apache.hadoop.hive.ql.metadata.Table;
 import org.apache.hadoop.hive.ql.optimizer.GenMRFileSink1;
 import org.apache.hadoop.hive.ql.optimizer.GenMROperator;
 import org.apache.hadoop.hive.ql.optimizer.GenMRProcContext;
@@ -73,302 +63,25 @@
 import org.apache.hadoop.hive.ql.optimizer.GenMRRedSink3;
 import org.apache.hadoop.hive.ql.optimizer.GenMRTableScan1;
 import org.apache.hadoop.hive.ql.optimizer.GenMRUnion1;
-import org.apache.hadoop.hive.ql.optimizer.GenMapRedUtils;
 import org.apache.hadoop.hive.ql.optimizer.MapJoinFactory;
 import org.apache.hadoop.hive.ql.optimizer.physical.PhysicalContext;
 import org.apache.hadoop.hive.ql.optimizer.physical.PhysicalOptimizer;
-import org.apache.hadoop.hive.ql.plan.ColumnStatsDesc;
-import org.apache.hadoop.hive.ql.plan.ColumnStatsWork;
-import org.apache.hadoop.hive.ql.plan.CreateTableDesc;
-import org.apache.hadoop.hive.ql.plan.DDLWork;
-import org.apache.hadoop.hive.ql.plan.FetchWork;
-import org.apache.hadoop.hive.ql.plan.LoadFileDesc;
-import org.apache.hadoop.hive.ql.plan.LoadTableDesc;
 import org.apache.hadoop.hive.ql.plan.MapWork;
 import org.apache.hadoop.hive.ql.plan.MapredWork;
 import org.apache.hadoop.hive.ql.plan.MoveWork;
 import org.apache.hadoop.hive.ql.plan.OperatorDesc;
-import org.apache.hadoop.hive.ql.plan.PlanUtils;
-import org.apache.hadoop.hive.ql.plan.TableDesc;
-import org.apache.hadoop.hive.ql.session.SessionState.LogHelper;
 import org.apache.hadoop.hive.shims.ShimLoader;
 
-public class MapReduceCompiler {
+public class MapReduceCompiler extends TaskCompiler {
 
   protected final Log LOG = LogFactory.getLog(MapReduceCompiler.class);
-  private Hive db;
-  protected LogHelper console;
-  private HiveConf conf;
-
 
   public MapReduceCompiler() {
   }
 
-  public void init(HiveConf conf, LogHelper console, Hive db) {
-    this.conf = conf;
-    this.db = db;
-    this.console = console;
-  }
-
-  @SuppressWarnings({"nls", "unchecked"})
-  public void compile(final ParseContext pCtx, final List<Task<? extends Serializable>> rootTasks,
-      final HashSet<ReadEntity> inputs, final HashSet<WriteEntity> outputs) throws SemanticException {
-
-    Context ctx = pCtx.getContext();
-    GlobalLimitCtx globalLimitCtx = pCtx.getGlobalLimitCtx();
-    QB qb = pCtx.getQB();
-    List<Task<MoveWork>> mvTask = new ArrayList<Task<MoveWork>>();
-
-    List<LoadTableDesc> loadTableWork = pCtx.getLoadTableWork();
-    List<LoadFileDesc> loadFileWork = pCtx.getLoadFileWork();
-
-    boolean isCStats = qb.isAnalyzeRewrite();
-
-    if (pCtx.getFetchTask() != null) {
-      return;
-    }
-
-    /*
-     * In case of a select, use a fetch task instead of a move task.
-     * If the select is from analyze table column rewrite, don't create a fetch task. Instead create
-     * a column stats task later.
-     */
-    if (pCtx.getQB().getIsQuery() && !isCStats) {
-      if ((!loadTableWork.isEmpty()) || (loadFileWork.size() != 1)) {
-        throw new SemanticException(ErrorMsg.GENERIC_ERROR.getMsg());
-      }
-
-      LoadFileDesc loadFileDesc = loadFileWork.get(0);
-
-      String cols = loadFileDesc.getColumns();
-      String colTypes = loadFileDesc.getColumnTypes();
-
-      TableDesc resultTab = pCtx.getFetchTabledesc();
-      if (resultTab == null) {
-        String resFileFormat = HiveConf.getVar(conf, HiveConf.ConfVars.HIVEQUERYRESULTFILEFORMAT);
-        resultTab = PlanUtils.getDefaultQueryOutputTableDesc(cols, colTypes, resFileFormat);
-      }
-
-      FetchWork fetch = new FetchWork(loadFileDesc.getSourcePath(),
-          resultTab, qb.getParseInfo().getOuterQueryLimit());
-      fetch.setSource(pCtx.getFetchSource());
-      fetch.setSink(pCtx.getFetchSink());
-
-      pCtx.setFetchTask((FetchTask) TaskFactory.get(fetch, conf));
-
-      // For the FetchTask, the limit optimization requires we fetch all the rows
-      // in memory and count how many rows we get. It's not practical if the
-      // limit factor is too big
-      int fetchLimit = HiveConf.getIntVar(conf, HiveConf.ConfVars.HIVELIMITOPTMAXFETCH);
-      if (globalLimitCtx.isEnable() && globalLimitCtx.getGlobalLimit() > fetchLimit) {
-        LOG.info("For FetchTask, LIMIT " + globalLimitCtx.getGlobalLimit() + " > " + fetchLimit
-            + ". Doesn't qualify limit optimiztion.");
-        globalLimitCtx.disableOpt();
-      }
-    } else if (!isCStats) {
-      for (LoadTableDesc ltd : loadTableWork) {
-        Task<MoveWork> tsk = TaskFactory.get(new MoveWork(null, null, ltd, null, false), conf);
-        mvTask.add(tsk);
-        // Check to see if we are stale'ing any indexes and auto-update them if we want
-        if (HiveConf.getBoolVar(conf, HiveConf.ConfVars.HIVEINDEXAUTOUPDATE)) {
-          IndexUpdater indexUpdater = new IndexUpdater(loadTableWork, inputs, conf);
-          try {
-            List<Task<? extends Serializable>> indexUpdateTasks = indexUpdater
-                .generateUpdateTasks();
-            for (Task<? extends Serializable> updateTask : indexUpdateTasks) {
-              tsk.addDependentTask(updateTask);
-            }
-          } catch (HiveException e) {
-            console
-                .printInfo("WARNING: could not auto-update stale indexes, which are not in sync");
-          }
-        }
-      }
-
-      boolean oneLoadFile = true;
-      for (LoadFileDesc lfd : loadFileWork) {
-        if (qb.isCTAS()) {
-          assert (oneLoadFile); // should not have more than 1 load file for
-          // CTAS
-          // make the movetask's destination directory the table's destination.
-          Path location;
-          String loc = qb.getTableDesc().getLocation();
-          if (loc == null) {
-            // get the table's default location
-            Table dumpTable;
-            Path targetPath;
-            try {
-              dumpTable = db.newTable(qb.getTableDesc().getTableName());
-              if (!db.databaseExists(dumpTable.getDbName())) {
-                throw new SemanticException("ERROR: The database " + dumpTable.getDbName()
-                    + " does not exist.");
-              }
-              Warehouse wh = new Warehouse(conf);
-              targetPath = wh.getTablePath(db.getDatabase(dumpTable.getDbName()), dumpTable
-                  .getTableName());
-            } catch (HiveException e) {
-              throw new SemanticException(e);
-            } catch (MetaException e) {
-              throw new SemanticException(e);
-            }
-
-            location = targetPath;
-          } else {
-              location = new Path(loc);
-          }
-          lfd.setTargetDir(location);
-
-          oneLoadFile = false;
-        }
-        mvTask.add(TaskFactory.get(new MoveWork(null, null, null, lfd, false), conf));
-      }
-    }
-
-    // generate map reduce plans
-    ParseContext tempParseContext = getParseContext(pCtx, rootTasks);
-    GenMRProcContext procCtx = new GenMRProcContext(
-        conf,
-        new HashMap<Operator<? extends OperatorDesc>, Task<? extends Serializable>>(),
-        tempParseContext, mvTask, rootTasks,
-        new LinkedHashMap<Operator<? extends OperatorDesc>, GenMapRedCtx>(),
-        inputs, outputs);
-
-    // create a walker which walks the tree in a DFS manner while maintaining
-    // the operator stack.
-    // The dispatcher generates the plan from the operator tree
-    Map<Rule, NodeProcessor> opRules = new LinkedHashMap<Rule, NodeProcessor>();
-    opRules.put(new RuleRegExp(new String("R1"),
-        TableScanOperator.getOperatorName() + "%"),
-        new GenMRTableScan1());
-    opRules.put(new RuleRegExp(new String("R2"),
-        TableScanOperator.getOperatorName() + "%.*" + ReduceSinkOperator.getOperatorName() + "%"),
-        new GenMRRedSink1());
-    opRules.put(new RuleRegExp(new String("R3"),
-        ReduceSinkOperator.getOperatorName() + "%.*" + ReduceSinkOperator.getOperatorName() + "%"),
-        new GenMRRedSink2());
-    opRules.put(new RuleRegExp(new String("R4"),
-        FileSinkOperator.getOperatorName() + "%"),
-        new GenMRFileSink1());
-    opRules.put(new RuleRegExp(new String("R5"),
-        UnionOperator.getOperatorName() + "%"),
-        new GenMRUnion1());
-    opRules.put(new RuleRegExp(new String("R6"),
-        UnionOperator.getOperatorName() + "%.*" + ReduceSinkOperator.getOperatorName() + "%"),
-        new GenMRRedSink3());
-    opRules.put(new RuleRegExp(new String("R7"),
-        MapJoinOperator.getOperatorName() + "%"),
-        MapJoinFactory.getTableScanMapJoin());
-
-    // The dispatcher fires the processor corresponding to the closest matching
-    // rule and passes the context along
-    Dispatcher disp = new DefaultRuleDispatcher(new GenMROperator(), opRules,
-        procCtx);
-
-    GraphWalker ogw = new GenMapRedWalker(disp);
-    ArrayList<Node> topNodes = new ArrayList<Node>();
-    topNodes.addAll(pCtx.getTopOps().values());
-    ogw.startWalking(topNodes, null);
-
-    /*
-     * If the query was the result of analyze table column compute statistics rewrite, create
-     * a column stats task instead of a fetch task to persist stats to the metastore.
-     */
-    if (isCStats) {
-      genColumnStatsTask(qb, loadTableWork, loadFileWork, rootTasks);
-    }
-
-    // reduce sink does not have any kids - since the plan by now has been
-    // broken up into multiple
-    // tasks, iterate over all tasks.
-    // For each task, go over all operators recursively
-    for (Task<? extends Serializable> rootTask : rootTasks) {
-      breakTaskTree(rootTask);
-    }
-
-    // For each task, set the key descriptor for the reducer
-    for (Task<? extends Serializable> rootTask : rootTasks) {
-      GenMapRedUtils.setKeyAndValueDescForTaskTree(rootTask);
-    }
-
-    // If a task contains an operator which instructs bucketizedhiveinputformat
-    // to be used, please do so
-    for (Task<? extends Serializable> rootTask : rootTasks) {
-      setInputFormat(rootTask);
-    }
-
-    PhysicalContext physicalContext = new PhysicalContext(conf,
-        getParseContext(pCtx, rootTasks), ctx, rootTasks, pCtx.getFetchTask());
-    PhysicalOptimizer physicalOptimizer = new PhysicalOptimizer(
-        physicalContext, conf);
-    physicalOptimizer.optimize();
-
-    decideExecMode(rootTasks, ctx, globalLimitCtx);
-
-    if (qb.isCTAS()) {
-      // generate a DDL task and make it a dependent task of the leaf
-      CreateTableDesc crtTblDesc = qb.getTableDesc();
-
-      crtTblDesc.validate();
-
-      // Clear the output for CTAS since we don't need the output from the
-      // mapredWork, the
-      // DDLWork at the tail of the chain will have the output
-      outputs.clear();
-
-      Task<? extends Serializable> crtTblTask = TaskFactory.get(new DDLWork(
-          inputs, outputs, crtTblDesc), conf);
-
-      // find all leaf tasks and make the DDLTask as a dependent task of all of
-      // them
-      HashSet<Task<? extends Serializable>> leaves = new HashSet<Task<? extends Serializable>>();
-      getLeafTasks(rootTasks, leaves);
-      assert (leaves.size() > 0);
-      for (Task<? extends Serializable> task : leaves) {
-        if (task instanceof StatsTask) {
-          // StatsTask require table to already exist
-          for (Task<? extends Serializable> parentOfStatsTask : task.getParentTasks()) {
-            parentOfStatsTask.addDependentTask(crtTblTask);
-          }
-          for (Task<? extends Serializable> parentOfCrtTblTask : crtTblTask.getParentTasks()) {
-            parentOfCrtTblTask.removeDependentTask(task);
-          }
-          crtTblTask.addDependentTask(task);
-        } else {
-          task.addDependentTask(crtTblTask);
-        }
-      }
-    }
-
-    if (globalLimitCtx.isEnable() && pCtx.getFetchTask() != null) {
-      LOG.info("set least row check for FetchTask: " + globalLimitCtx.getGlobalLimit());
-      pCtx.getFetchTask().getWork().setLeastNumRows(globalLimitCtx.getGlobalLimit());
-    }
-
-    if (globalLimitCtx.isEnable() && globalLimitCtx.getLastReduceLimitDesc() != null) {
-      LOG.info("set least row check for LimitDesc: " + globalLimitCtx.getGlobalLimit());
-      globalLimitCtx.getLastReduceLimitDesc().setLeastRows(globalLimitCtx.getGlobalLimit());
-      List<ExecDriver> mrTasks = Utilities.getMRTasks(rootTasks);
-      for (ExecDriver tsk : mrTasks) {
-        tsk.setRetryCmdWhenFail(true);
-      }
-    }
-  }
-
-  private void setInputFormat(MapWork work, Operator<? extends OperatorDesc> op) {
-    if (op.isUseBucketizedHiveInputFormat()) {
-      work.setUseBucketizedHiveInputFormat(true);
-      return;
-    }
-
-    if (op.getChildOperators() != null) {
-      for (Operator<? extends OperatorDesc> childOp : op.getChildOperators()) {
-        setInputFormat(work, childOp);
-      }
-    }
-  }
-
   // loop over all the tasks recursively
-  private void setInputFormat(Task<? extends Serializable> task) {
+  @Override
+  protected void setInputFormat(Task<? extends Serializable> task) {
     if (task instanceof ExecDriver) {
       MapWork work = ((MapredWork) task.getWork()).getMapWork();
       HashMap<String, Operator<? extends OperatorDesc>> opMap = work.getAliasToWork();
@@ -392,6 +105,20 @@ private void setInputFormat(Task<? extends Serializable> task) {
     }
   }
 
+  private void setInputFormat(MapWork work, Operator<? extends OperatorDesc> op) {
+    if (op.isUseBucketizedHiveInputFormat()) {
+      work.setUseBucketizedHiveInputFormat(true);
+      return;
+    }
+
+    if (op.getChildOperators() != null) {
+      for (Operator<? extends OperatorDesc> childOp : op.getChildOperators()) {
+        setInputFormat(work, childOp);
+      }
+    }
+  }
+
+  @Override
   public ParseContext getParseContext(ParseContext pCtx, List<Task<? extends Serializable>> rootTasks) {
     return new ParseContext(conf, pCtx.getQB(), pCtx.getParseTree(),
         pCtx.getOpToPartPruner(), pCtx.getOpToPartList(), pCtx.getTopOps(),
@@ -451,67 +178,6 @@ private void breakOperatorTree(Operator<? extends OperatorDesc> topOp) {
     }
   }
 
-  /**
-   * A helper function to generate a column stats task on top of map-red task. The column stats
-   * task fetches from the output of the map-red task, constructs the column stats object and
-   * persists it to the metastore.
-   *
-   * This method generates a plan with a column stats task on top of map-red task and sets up the
-   * appropriate metadata to be used during execution.
-   *
-   * @param qb
-   */
-  @SuppressWarnings("unchecked")
-  private void genColumnStatsTask(QB qb, List<LoadTableDesc> loadTableWork,
-      List<LoadFileDesc> loadFileWork, List<Task<? extends Serializable>> rootTasks) {
-    QBParseInfo qbParseInfo = qb.getParseInfo();
-    ColumnStatsTask cStatsTask = null;
-    ColumnStatsWork cStatsWork = null;
-    FetchWork fetch = null;
-    String tableName = qbParseInfo.getTableName();
-    String partName = qbParseInfo.getPartName();
-    List<String> colName = qbParseInfo.getColName();
-    List<String> colType = qbParseInfo.getColType();
-    boolean isTblLevel = qbParseInfo.isTblLvl();
-
-    String cols = loadFileWork.get(0).getColumns();
-    String colTypes = loadFileWork.get(0).getColumnTypes();
-
-    String resFileFormat = HiveConf.getVar(conf, HiveConf.ConfVars.HIVEQUERYRESULTFILEFORMAT);
-    TableDesc resultTab = PlanUtils.getDefaultQueryOutputTableDesc(cols, colTypes, resFileFormat);
-
-    fetch = new FetchWork(loadFileWork.get(0).getSourcePath(),
-        resultTab, qb.getParseInfo().getOuterQueryLimit());
-
-    ColumnStatsDesc cStatsDesc = new ColumnStatsDesc(tableName, partName,
-        colName, colType, isTblLevel);
-    cStatsWork = new ColumnStatsWork(fetch, cStatsDesc);
-    cStatsTask = (ColumnStatsTask) TaskFactory.get(cStatsWork, conf);
-    rootTasks.add(cStatsTask);
-  }
-
-  /**
-   * Find all leaf tasks of the list of root tasks.
-   */
-  private void getLeafTasks(List<Task<? extends Serializable>> rootTasks,
-      HashSet<Task<? extends Serializable>> leaves) {
-
-    for (Task<? extends Serializable> root : rootTasks) {
-      getLeafTasks(root, leaves);
-    }
-  }
-
-  private void getLeafTasks(Task<? extends Serializable> task,
-      HashSet<Task<? extends Serializable>> leaves) {
-    if (task.getDependentTasks() == null) {
-      if (!leaves.contains(task)) {
-        leaves.add(task);
-      }
-    } else {
-      getLeafTasks(task.getDependentTasks(), leaves);
-    }
-  }
-
   /**
    * Make a best guess at trying to find the number of reducers
    */
@@ -527,7 +193,8 @@ private static int getNumberOfReducers(MapredWork mrwork, HiveConf conf) {
     return conf.getIntVar(HiveConf.ConfVars.HADOOPNUMREDUCERS);
   }
 
-  private void decideExecMode(List<Task<? extends Serializable>> rootTasks, Context ctx,
+  @Override
+  protected void decideExecMode(List<Task<? extends Serializable>> rootTasks, Context ctx,
       GlobalLimitCtx globalLimitCtx)
       throws SemanticException {
 
@@ -603,4 +270,74 @@ public boolean accept(Path file) {
       console.printInfo("Automatically selecting local only mode for query");
     }
   }
+
+  @Override
+  protected void optimizeTaskPlan(List<Task<? extends Serializable>> rootTasks,
+      ParseContext pCtx, Context ctx) throws SemanticException {
+    // reduce sink does not have any kids - since the plan by now has been
+    // broken up into multiple
+    // tasks, iterate over all tasks.
+    // For each task, go over all operators recursively
+    for (Task<? extends Serializable> rootTask : rootTasks) {
+      breakTaskTree(rootTask);
+    }
+
+
+    PhysicalContext physicalContext = new PhysicalContext(conf,
+        getParseContext(pCtx, rootTasks), ctx, rootTasks, pCtx.getFetchTask());
+    PhysicalOptimizer physicalOptimizer = new PhysicalOptimizer(
+        physicalContext, conf);
+    physicalOptimizer.optimize();
+
+  }
+
+  @Override
+  protected void generateTaskTree(List<Task<? extends Serializable>> rootTasks, ParseContext pCtx,
+      List<Task<MoveWork>> mvTask, Set<ReadEntity> inputs, Set<WriteEntity> outputs) throws SemanticException {
+
+    // generate map reduce plans
+    ParseContext tempParseContext = getParseContext(pCtx, rootTasks);
+    GenMRProcContext procCtx = new GenMRProcContext(
+        conf,
+        new HashMap<Operator<? extends OperatorDesc>, Task<? extends Serializable>>(),
+        tempParseContext, mvTask, rootTasks,
+        new LinkedHashMap<Operator<? extends OperatorDesc>, GenMapRedCtx>(),
+        inputs, outputs);
+
+    // create a walker which walks the tree in a DFS manner while maintaining
+    // the operator stack.
+    // The dispatcher generates the plan from the operator tree
+    Map<Rule, NodeProcessor> opRules = new LinkedHashMap<Rule, NodeProcessor>();
+    opRules.put(new RuleRegExp(new String("R1"),
+        TableScanOperator.getOperatorName() + "%"),
+        new GenMRTableScan1());
+    opRules.put(new RuleRegExp(new String("R2"),
+        TableScanOperator.getOperatorName() + "%.*" + ReduceSinkOperator.getOperatorName() + "%"),
+        new GenMRRedSink1());
+    opRules.put(new RuleRegExp(new String("R3"),
+        ReduceSinkOperator.getOperatorName() + "%.*" + ReduceSinkOperator.getOperatorName() + "%"),
+        new GenMRRedSink2());
+    opRules.put(new RuleRegExp(new String("R4"),
+        FileSinkOperator.getOperatorName() + "%"),
+        new GenMRFileSink1());
+    opRules.put(new RuleRegExp(new String("R5"),
+        UnionOperator.getOperatorName() + "%"),
+        new GenMRUnion1());
+    opRules.put(new RuleRegExp(new String("R6"),
+        UnionOperator.getOperatorName() + "%.*" + ReduceSinkOperator.getOperatorName() + "%"),
+        new GenMRRedSink3());
+    opRules.put(new RuleRegExp(new String("R7"),
+        MapJoinOperator.getOperatorName() + "%"),
+        MapJoinFactory.getTableScanMapJoin());
+
+    // The dispatcher fires the processor corresponding to the closest matching
+    // rule and passes the context along
+    Dispatcher disp = new DefaultRuleDispatcher(new GenMROperator(), opRules,
+        procCtx);
+
+    GraphWalker ogw = new GenMapRedWalker(disp);
+    ArrayList<Node> topNodes = new ArrayList<Node>();
+    topNodes.addAll(pCtx.getTopOps().values());
+    ogw.startWalking(topNodes, null);
+  }
 }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
index 0bd091fe88..848e0ab7db 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
@@ -8958,7 +8958,7 @@ public void analyzeInternal(ASTNode ast) throws SemanticException {
     if (!ctx.getExplainLogical()) {
       // At this point we have the complete operator tree
       // from which we want to create the map-reduce plan
-      MapReduceCompiler compiler = new MapReduceCompiler();
+      TaskCompiler compiler = TaskCompilerFactory.getCompiler(conf, pCtx);
       compiler.init(conf, console, db);
       compiler.compile(pCtx, rootTasks, inputs, outputs);
       fetchTask = pCtx.getFetchTask();
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/TableAccessAnalyzer.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/TableAccessAnalyzer.java
index 5fdfcf1518..d847a16b41 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/TableAccessAnalyzer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/TableAccessAnalyzer.java
@@ -239,7 +239,7 @@ public static TableScanOperator genRootTableScan(
     // and filters.
     while (true) {
       parentOps = currOp.getParentOperators();
-      if (parentOps == null) {
+      if ((parentOps == null) || (parentOps.isEmpty())) {
         return (TableScanOperator) currOp;
       }
 
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/TaskCompiler.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/TaskCompiler.java
new file mode 100644
index 0000000000..b569ed0141
--- /dev/null
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/TaskCompiler.java
@@ -0,0 +1,381 @@
+/**
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.hadoop.hive.ql.parse;
+
+import java.io.Serializable;
+import java.util.ArrayList;
+import java.util.HashSet;
+import java.util.LinkedHashSet;
+import java.util.List;
+import java.util.Set;
+
+import org.apache.commons.logging.Log;
+import org.apache.commons.logging.LogFactory;
+import org.apache.hadoop.fs.Path;
+import org.apache.hadoop.hive.conf.HiveConf;
+import org.apache.hadoop.hive.metastore.Warehouse;
+import org.apache.hadoop.hive.metastore.api.MetaException;
+import org.apache.hadoop.hive.ql.Context;
+import org.apache.hadoop.hive.ql.ErrorMsg;
+import org.apache.hadoop.hive.ql.exec.ColumnStatsTask;
+import org.apache.hadoop.hive.ql.exec.FetchTask;
+import org.apache.hadoop.hive.ql.exec.StatsTask;
+import org.apache.hadoop.hive.ql.exec.Task;
+import org.apache.hadoop.hive.ql.exec.TaskFactory;
+import org.apache.hadoop.hive.ql.exec.Utilities;
+import org.apache.hadoop.hive.ql.exec.mr.ExecDriver;
+import org.apache.hadoop.hive.ql.hooks.ReadEntity;
+import org.apache.hadoop.hive.ql.hooks.WriteEntity;
+import org.apache.hadoop.hive.ql.metadata.Hive;
+import org.apache.hadoop.hive.ql.metadata.HiveException;
+import org.apache.hadoop.hive.ql.metadata.Table;
+import org.apache.hadoop.hive.ql.optimizer.GenMapRedUtils;
+import org.apache.hadoop.hive.ql.plan.ColumnStatsDesc;
+import org.apache.hadoop.hive.ql.plan.ColumnStatsWork;
+import org.apache.hadoop.hive.ql.plan.CreateTableDesc;
+import org.apache.hadoop.hive.ql.plan.DDLWork;
+import org.apache.hadoop.hive.ql.plan.FetchWork;
+import org.apache.hadoop.hive.ql.plan.LoadFileDesc;
+import org.apache.hadoop.hive.ql.plan.LoadTableDesc;
+import org.apache.hadoop.hive.ql.plan.MoveWork;
+import org.apache.hadoop.hive.ql.plan.PlanUtils;
+import org.apache.hadoop.hive.ql.plan.TableDesc;
+import org.apache.hadoop.hive.ql.session.SessionState.LogHelper;
+
+/**
+ * TaskCompiler is a the base class for classes that compile
+ * operator pipelines into tasks.
+ */
+public abstract class TaskCompiler {
+
+  protected final Log LOG = LogFactory.getLog(TaskCompiler.class);
+
+  protected Hive db;
+  protected LogHelper console;
+  protected HiveConf conf;
+
+  public void init(HiveConf conf, LogHelper console, Hive db) {
+    this.conf = conf;
+    this.db = db;
+    this.console = console;
+  }
+
+  @SuppressWarnings({"nls", "unchecked"})
+  public void compile(final ParseContext pCtx, final List<Task<? extends Serializable>> rootTasks,
+      final HashSet<ReadEntity> inputs, final HashSet<WriteEntity> outputs) throws SemanticException {
+
+    Context ctx = pCtx.getContext();
+    GlobalLimitCtx globalLimitCtx = pCtx.getGlobalLimitCtx();
+    QB qb = pCtx.getQB();
+    List<Task<MoveWork>> mvTask = new ArrayList<Task<MoveWork>>();
+
+    List<LoadTableDesc> loadTableWork = pCtx.getLoadTableWork();
+    List<LoadFileDesc> loadFileWork = pCtx.getLoadFileWork();
+
+    boolean isCStats = qb.isAnalyzeRewrite();
+
+    if (pCtx.getFetchTask() != null) {
+      return;
+    }
+
+    optimizeOperatorPlan(pCtx, inputs, outputs);
+
+    /*
+     * In case of a select, use a fetch task instead of a move task.
+     * If the select is from analyze table column rewrite, don't create a fetch task. Instead create
+     * a column stats task later.
+     */
+    if (pCtx.getQB().getIsQuery() && !isCStats) {
+      if ((!loadTableWork.isEmpty()) || (loadFileWork.size() != 1)) {
+        throw new SemanticException(ErrorMsg.GENERIC_ERROR.getMsg());
+      }
+
+      LoadFileDesc loadFileDesc = loadFileWork.get(0);
+
+      String cols = loadFileDesc.getColumns();
+      String colTypes = loadFileDesc.getColumnTypes();
+
+      TableDesc resultTab = pCtx.getFetchTabledesc();
+      if (resultTab == null) {
+        String resFileFormat = HiveConf.getVar(conf, HiveConf.ConfVars.HIVEQUERYRESULTFILEFORMAT);
+        resultTab = PlanUtils.getDefaultQueryOutputTableDesc(cols, colTypes, resFileFormat);
+      }
+
+      FetchWork fetch = new FetchWork(loadFileDesc.getSourcePath(),
+                                      resultTab, qb.getParseInfo().getOuterQueryLimit());
+      fetch.setSource(pCtx.getFetchSource());
+      fetch.setSink(pCtx.getFetchSink());
+
+      pCtx.setFetchTask((FetchTask) TaskFactory.get(fetch, conf));
+
+      // For the FetchTask, the limit optimization requires we fetch all the rows
+      // in memory and count how many rows we get. It's not practical if the
+      // limit factor is too big
+      int fetchLimit = HiveConf.getIntVar(conf, HiveConf.ConfVars.HIVELIMITOPTMAXFETCH);
+      if (globalLimitCtx.isEnable() && globalLimitCtx.getGlobalLimit() > fetchLimit) {
+        LOG.info("For FetchTask, LIMIT " + globalLimitCtx.getGlobalLimit() + " > " + fetchLimit
+            + ". Doesn't qualify limit optimiztion.");
+        globalLimitCtx.disableOpt();
+      }
+    } else if (!isCStats) {
+      for (LoadTableDesc ltd : loadTableWork) {
+        Task<MoveWork> tsk = TaskFactory.get(new MoveWork(null, null, ltd, null, false), conf);
+        mvTask.add(tsk);
+        // Check to see if we are stale'ing any indexes and auto-update them if we want
+        if (HiveConf.getBoolVar(conf, HiveConf.ConfVars.HIVEINDEXAUTOUPDATE)) {
+          IndexUpdater indexUpdater = new IndexUpdater(loadTableWork, inputs, conf);
+          try {
+            List<Task<? extends Serializable>> indexUpdateTasks = indexUpdater
+                .generateUpdateTasks();
+            for (Task<? extends Serializable> updateTask : indexUpdateTasks) {
+              tsk.addDependentTask(updateTask);
+            }
+          } catch (HiveException e) {
+            console
+                .printInfo("WARNING: could not auto-update stale indexes, which are not in sync");
+          }
+        }
+      }
+
+      boolean oneLoadFile = true;
+      for (LoadFileDesc lfd : loadFileWork) {
+        if (qb.isCTAS()) {
+          assert (oneLoadFile); // should not have more than 1 load file for
+          // CTAS
+          // make the movetask's destination directory the table's destination.
+          Path location;
+          String loc = qb.getTableDesc().getLocation();
+          if (loc == null) {
+            // get the table's default location
+            Table dumpTable;
+            Path targetPath;
+            try {
+              dumpTable = db.newTable(qb.getTableDesc().getTableName());
+              if (!db.databaseExists(dumpTable.getDbName())) {
+                throw new SemanticException("ERROR: The database " + dumpTable.getDbName()
+                    + " does not exist.");
+              }
+              Warehouse wh = new Warehouse(conf);
+              targetPath = wh.getTablePath(db.getDatabase(dumpTable.getDbName()), dumpTable
+                  .getTableName());
+            } catch (HiveException e) {
+              throw new SemanticException(e);
+            } catch (MetaException e) {
+              throw new SemanticException(e);
+            }
+
+            location = targetPath;
+          } else {
+            location = new Path(loc);
+          }
+          lfd.setTargetDir(location);
+
+          oneLoadFile = false;
+        }
+        mvTask.add(TaskFactory.get(new MoveWork(null, null, null, lfd, false), conf));
+      }
+    }
+
+    generateTaskTree(rootTasks, pCtx, mvTask, inputs, outputs);
+
+    /*
+     * If the query was the result of analyze table column compute statistics rewrite, create
+     * a column stats task instead of a fetch task to persist stats to the metastore.
+     */
+    if (isCStats) {
+      genColumnStatsTask(qb, loadTableWork, loadFileWork, rootTasks);
+    }
+
+    // For each task, set the key descriptor for the reducer
+    for (Task<? extends Serializable> rootTask : rootTasks) {
+      GenMapRedUtils.setKeyAndValueDescForTaskTree(rootTask);
+    }
+
+    // If a task contains an operator which instructs bucketizedhiveinputformat
+    // to be used, please do so
+    for (Task<? extends Serializable> rootTask : rootTasks) {
+      setInputFormat(rootTask);
+    }
+
+    optimizeTaskPlan(rootTasks, pCtx, ctx);
+
+    decideExecMode(rootTasks, ctx, globalLimitCtx);
+
+    if (qb.isCTAS()) {
+      // generate a DDL task and make it a dependent task of the leaf
+      CreateTableDesc crtTblDesc = qb.getTableDesc();
+
+      crtTblDesc.validate();
+
+      // Clear the output for CTAS since we don't need the output from the
+      // mapredWork, the
+      // DDLWork at the tail of the chain will have the output
+      outputs.clear();
+
+      Task<? extends Serializable> crtTblTask = TaskFactory.get(new DDLWork(
+          inputs, outputs, crtTblDesc), conf);
+
+      // find all leaf tasks and make the DDLTask as a dependent task of all of
+      // them
+      HashSet<Task<? extends Serializable>> leaves = new LinkedHashSet<Task<? extends Serializable>>();
+      getLeafTasks(rootTasks, leaves);
+      assert (leaves.size() > 0);
+      for (Task<? extends Serializable> task : leaves) {
+        if (task instanceof StatsTask) {
+          // StatsTask require table to already exist
+          for (Task<? extends Serializable> parentOfStatsTask : task.getParentTasks()) {
+            parentOfStatsTask.addDependentTask(crtTblTask);
+          }
+          for (Task<? extends Serializable> parentOfCrtTblTask : crtTblTask.getParentTasks()) {
+            parentOfCrtTblTask.removeDependentTask(task);
+          }
+          crtTblTask.addDependentTask(task);
+        } else {
+          task.addDependentTask(crtTblTask);
+        }
+      }
+    }
+
+    if (globalLimitCtx.isEnable() && pCtx.getFetchTask() != null) {
+      LOG.info("set least row check for FetchTask: " + globalLimitCtx.getGlobalLimit());
+      pCtx.getFetchTask().getWork().setLeastNumRows(globalLimitCtx.getGlobalLimit());
+    }
+
+    if (globalLimitCtx.isEnable() && globalLimitCtx.getLastReduceLimitDesc() != null) {
+      LOG.info("set least row check for LimitDesc: " + globalLimitCtx.getGlobalLimit());
+      globalLimitCtx.getLastReduceLimitDesc().setLeastRows(globalLimitCtx.getGlobalLimit());
+      List<ExecDriver> mrTasks = Utilities.getMRTasks(rootTasks);
+      for (ExecDriver tsk : mrTasks) {
+        tsk.setRetryCmdWhenFail(true);
+      }
+    }
+  }
+
+
+  /**
+   * A helper function to generate a column stats task on top of map-red task. The column stats
+   * task fetches from the output of the map-red task, constructs the column stats object and
+   * persists it to the metastore.
+   *
+   * This method generates a plan with a column stats task on top of map-red task and sets up the
+   * appropriate metadata to be used during execution.
+   *
+   * @param qb
+   */
+  @SuppressWarnings("unchecked")
+  protected void genColumnStatsTask(QB qb, List<LoadTableDesc> loadTableWork,
+      List<LoadFileDesc> loadFileWork, List<Task<? extends Serializable>> rootTasks) {
+    QBParseInfo qbParseInfo = qb.getParseInfo();
+    ColumnStatsTask cStatsTask = null;
+    ColumnStatsWork cStatsWork = null;
+    FetchWork fetch = null;
+    String tableName = qbParseInfo.getTableName();
+    String partName = qbParseInfo.getPartName();
+    List<String> colName = qbParseInfo.getColName();
+    List<String> colType = qbParseInfo.getColType();
+    boolean isTblLevel = qbParseInfo.isTblLvl();
+
+    String cols = loadFileWork.get(0).getColumns();
+    String colTypes = loadFileWork.get(0).getColumnTypes();
+
+    String resFileFormat = HiveConf.getVar(conf, HiveConf.ConfVars.HIVEQUERYRESULTFILEFORMAT);
+    TableDesc resultTab = PlanUtils.getDefaultQueryOutputTableDesc(cols, colTypes, resFileFormat);
+
+    fetch = new FetchWork(loadFileWork.get(0).getSourcePath(),
+        resultTab, qb.getParseInfo().getOuterQueryLimit());
+
+    ColumnStatsDesc cStatsDesc = new ColumnStatsDesc(tableName, partName,
+        colName, colType, isTblLevel);
+    cStatsWork = new ColumnStatsWork(fetch, cStatsDesc);
+    cStatsTask = (ColumnStatsTask) TaskFactory.get(cStatsWork, conf);
+    rootTasks.add(cStatsTask);
+  }
+
+
+  /**
+   * Find all leaf tasks of the list of root tasks.
+   */
+  protected void getLeafTasks(List<Task<? extends Serializable>> rootTasks,
+      HashSet<Task<? extends Serializable>> leaves) {
+
+    for (Task<? extends Serializable> root : rootTasks) {
+      getLeafTasks(root, leaves);
+    }
+  }
+
+  private void getLeafTasks(Task<? extends Serializable> task,
+      HashSet<Task<? extends Serializable>> leaves) {
+    if (task.getDependentTasks() == null) {
+      if (!leaves.contains(task)) {
+        leaves.add(task);
+      }
+    } else {
+      getLeafTasks(task.getDependentTasks(), leaves);
+    }
+  }
+
+  /*
+   * Called to transform tasks into local tasks where possible/desirable
+   */
+  protected abstract void decideExecMode(List<Task<? extends Serializable>> rootTasks, Context ctx,
+      GlobalLimitCtx globalLimitCtx) throws SemanticException;
+
+  /*
+   * Called at the beginning of the compile phase to have another chance to optimize the operator plan
+   */
+  protected void optimizeOperatorPlan(ParseContext pCtxSet, Set<ReadEntity> inputs, 
+      Set<WriteEntity> outputs) throws SemanticException {
+  }
+
+  /*
+   * Called after the tasks have been generated to run another round of optimization
+   */
+  protected abstract void optimizeTaskPlan(List<Task<? extends Serializable>> rootTasks,
+      ParseContext pCtx, Context ctx) throws SemanticException;
+
+  /*
+   * Called to set the appropriate input format for tasks
+   */
+  protected abstract void setInputFormat(Task<? extends Serializable> rootTask);
+
+  /*
+   * Called to generate the taks tree from the parse context/operator tree
+   */
+  protected abstract void generateTaskTree(List<Task<? extends Serializable>> rootTasks, ParseContext pCtx,
+      List<Task<MoveWork>> mvTask, Set<ReadEntity> inputs, Set<WriteEntity> outputs) throws SemanticException;
+
+  /**
+   * Create a clone of the parse context
+   */
+  public ParseContext getParseContext(ParseContext pCtx, List<Task<? extends Serializable>> rootTasks) {
+    return new ParseContext(conf, pCtx.getQB(), pCtx.getParseTree(),
+        pCtx.getOpToPartPruner(), pCtx.getOpToPartList(), pCtx.getTopOps(),
+        pCtx.getTopSelOps(), pCtx.getOpParseCtx(), pCtx.getJoinContext(),
+        pCtx.getSmbMapJoinContext(), pCtx.getTopToTable(), pCtx.getTopToProps(),
+        pCtx.getFsopToTable(),
+        pCtx.getLoadTableWork(), pCtx.getLoadFileWork(), pCtx.getContext(),
+        pCtx.getIdToTableNameMap(), pCtx.getDestTableId(), pCtx.getUCtx(),
+        pCtx.getListMapJoinOpsNoReducer(), pCtx.getGroupOpToInputTables(),
+        pCtx.getPrunedPartitions(), pCtx.getOpToSamplePruner(), pCtx.getGlobalLimitCtx(),
+        pCtx.getNameToSplitSample(), pCtx.getSemanticInputs(), rootTasks,
+        pCtx.getOpToPartToSkewedPruner(), pCtx.getViewAliasToInput(),
+        pCtx.getReduceSinkOperatorsAddedByEnforceBucketingSorting(),
+        pCtx.getQueryProperties());
+  }
+}
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/TaskCompilerFactory.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/TaskCompilerFactory.java
new file mode 100644
index 0000000000..8506b7e078
--- /dev/null
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/TaskCompilerFactory.java
@@ -0,0 +1,40 @@
+/**
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.hadoop.hive.ql.parse;
+
+import org.apache.hadoop.hive.conf.HiveConf;
+
+/**
+ * TaskCompilerFactory is a factory class to choose the appropriate
+ * TaskCompiler.
+ */
+public class TaskCompilerFactory {
+
+  private TaskCompilerFactory() {
+    // avoid instantiation
+  }
+
+  /**
+   * Returns the appropriate compiler to translate the operator tree
+   * into executable units.
+   */
+  public static TaskCompiler getCompiler(HiveConf conf, ParseContext parseContext) {
+    return new MapReduceCompiler();
+  }
+}
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/plan/BaseWork.java b/ql/src/java/org/apache/hadoop/hive/ql/plan/BaseWork.java
index 2e09de9879..e8c3145caa 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/plan/BaseWork.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/plan/BaseWork.java
@@ -19,10 +19,10 @@
 package org.apache.hadoop.hive.ql.plan;
 
 import java.util.ArrayList;
-import java.util.HashMap;
+import java.util.LinkedList;
 import java.util.List;
-import java.util.Map;
 
+import org.apache.hadoop.hive.ql.exec.HashTableDummyOperator;
 import org.apache.hadoop.hive.ql.exec.Operator;
 
 /**
@@ -32,8 +32,22 @@
 @SuppressWarnings({"serial", "deprecation"})
 public abstract class BaseWork extends AbstractOperatorDesc {
 
+  // dummyOps is a reference to all the HashTableDummy operators in the
+  // plan. These have to be separately initialized when we setup a task.
+  // Their funtion is mainly as root ops to give the mapjoin the correct
+  // schema info.
+  List<HashTableDummyOperator> dummyOps;
+
+  public BaseWork() {}
+
+  public BaseWork(String name) {
+    setName(name);
+  }
+
   private boolean gatheringStats;
 
+  private String name;
+
   public void setGatheringStats(boolean gatherStats) {
     this.gatheringStats = gatherStats;
   }
@@ -42,6 +56,29 @@ public boolean isGatheringStats() {
     return this.gatheringStats;
   }
 
+  public String getName() {
+    return name;
+  }
+
+  public void setName(String name) {
+    this.name = name;
+  }
+
+  public List<HashTableDummyOperator> getDummyOps() {
+    return dummyOps;
+  }
+
+  public void setDummyOps(List<HashTableDummyOperator> dummyOps) {
+    this.dummyOps = dummyOps;
+  }
+
+  public void addDummyOp(HashTableDummyOperator dummyOp) {
+    if (dummyOps == null) {
+      dummyOps = new LinkedList<HashTableDummyOperator>();
+    }
+    dummyOps.add(dummyOp);
+  }
+
   protected abstract List<Operator<?>> getAllRootOperators();
 
   public List<Operator<?>> getAllOperators() {
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/plan/JoinDesc.java b/ql/src/java/org/apache/hadoop/hive/ql/plan/JoinDesc.java
index dad56742e8..4b9feac883 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/plan/JoinDesc.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/plan/JoinDesc.java
@@ -187,6 +187,7 @@ public JoinDesc(JoinDesc clone) {
     this.tagOrder = clone.tagOrder;
     this.filters = clone.filters;
     this.filterMap = clone.filterMap;
+    this.statistics = clone.statistics;
   }
 
   public Map<Byte, List<ExprNodeDesc>> getExprs() {
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/plan/MapJoinDesc.java b/ql/src/java/org/apache/hadoop/hive/ql/plan/MapJoinDesc.java
index e609633953..cf0ca5705b 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/plan/MapJoinDesc.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/plan/MapJoinDesc.java
@@ -47,6 +47,9 @@ public class MapJoinDesc extends JoinDesc implements Serializable {
 
   private transient String bigTableAlias;
 
+  // for tez. used to remember which position maps to which logical input
+  private Map<Integer, String> parentToInput = new HashMap<Integer, String>();
+
   // table alias (small) --> input file name (big) --> target file names (small)
   private Map<String, Map<String, List<String>>> aliasBucketFileNameMapping;
   private Map<String, Integer> bigTableBucketNumMapping;
@@ -74,6 +77,7 @@ public MapJoinDesc(MapJoinDesc clone) {
     this.bigTableBucketNumMapping = clone.bigTableBucketNumMapping;
     this.bigTablePartSpecToFileMapping = clone.bigTablePartSpecToFileMapping;
     this.dumpFilePrefix = clone.dumpFilePrefix;
+    this.parentToInput = clone.parentToInput;
   }
 
   public MapJoinDesc(final Map<Byte, List<ExprNodeDesc>> keys,
@@ -106,6 +110,14 @@ private void initRetainExprList() {
     }
   }
 
+  public Map<Integer, String> getParentToInput() {
+    return parentToInput;
+  }
+
+  public void setParentToInput(Map<Integer, String> parentToInput) {
+    this.parentToInput = parentToInput;
+  }
+
   public Map<Byte, List<Integer>> getRetainList() {
     return retainList;
   }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/plan/MapWork.java b/ql/src/java/org/apache/hadoop/hive/ql/plan/MapWork.java
index 65c4e3ff55..99292753b6 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/plan/MapWork.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/plan/MapWork.java
@@ -116,8 +116,10 @@ public class MapWork extends BaseWork {
   private Map<String, Map<String, Integer>> scratchColumnMap = null;
   private boolean vectorMode = false;
 
+  public MapWork() {}
 
-  public MapWork() {
+  public MapWork(String name) {
+    super(name);
   }
 
   @Explain(displayName = "Path -> Alias", normalExplain = false)
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/plan/PlanUtils.java b/ql/src/java/org/apache/hadoop/hive/ql/plan/PlanUtils.java
index cdd8b9c5e2..da1437c911 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/plan/PlanUtils.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/plan/PlanUtils.java
@@ -29,7 +29,9 @@
 
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
+import org.apache.hadoop.conf.Configuration;
 import org.apache.hadoop.hive.conf.HiveConf;
+import org.apache.hadoop.hive.conf.HiveConf.ConfVars;
 import org.apache.hadoop.hive.metastore.MetaStoreUtils;
 import org.apache.hadoop.hive.metastore.api.FieldSchema;
 import org.apache.hadoop.hive.ql.exec.ColumnInfo;
@@ -386,7 +388,8 @@ public static TableDesc getReduceKeyTableDesc(List<FieldSchema> fieldSchemas,
   /**
    * Generate the table descriptor for Map-side join key.
    */
-  public static TableDesc getMapJoinKeyTableDesc(List<FieldSchema> fieldSchemas) {
+  public static TableDesc getMapJoinKeyTableDesc(Configuration conf,
+      List<FieldSchema> fieldSchemas) {
     return new TableDesc(SequenceFileInputFormat.class,
         SequenceFileOutputFormat.class, Utilities.makeProperties("columns",
         MetaStoreUtils.getColumnNamesFromFieldSchema(fieldSchemas),
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/plan/ReduceSinkDesc.java b/ql/src/java/org/apache/hadoop/hive/ql/plan/ReduceSinkDesc.java
index 5837facbbe..e193734881 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/plan/ReduceSinkDesc.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/plan/ReduceSinkDesc.java
@@ -59,6 +59,12 @@ public class ReduceSinkDesc extends AbstractOperatorDesc {
    */
   private int numDistributionKeys;
 
+  /**
+   * Used in tez. Holds the name of the output
+   * that this reduce sink is writing to.
+   */
+  private String outputName;
+
   /**
    * The partition columns (CLUSTER BY or DISTRIBUTE BY in Hive language).
    * Partition columns decide the reducer that the current row goes to.
@@ -273,4 +279,12 @@ public void setDistinctColumnIndices(
       List<List<Integer>> distinctColumnIndices) {
     this.distinctColumnIndices = distinctColumnIndices;
   }
+
+  public String getOutputName() {
+    return outputName;
+  }
+
+  public void setOutputName(String outputName) {
+    this.outputName = outputName;
+  }
 }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/plan/ReduceWork.java b/ql/src/java/org/apache/hadoop/hive/ql/plan/ReduceWork.java
index a6d9c55cac..03edcc1029 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/plan/ReduceWork.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/plan/ReduceWork.java
@@ -19,7 +19,9 @@
 package org.apache.hadoop.hive.ql.plan;
 
 import java.util.ArrayList;
+import java.util.HashMap;
 import java.util.List;
+import java.util.Map;
 
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
@@ -44,6 +46,12 @@
 @SuppressWarnings({"serial", "deprecation"})
 public class ReduceWork extends BaseWork {
 
+  public ReduceWork() {}
+
+  public ReduceWork(String name) {
+    super(name);
+  }
+
   private static transient final Log LOG = LogFactory.getLog(ReduceWork.class);
 
   // schema of the map-reduce 'key' object - this is homogeneous
@@ -63,6 +71,8 @@ public class ReduceWork extends BaseWork {
   // not (e.g.: group by)
   private boolean needsTagging;
 
+  private Map<Integer, String> tagToInput = new HashMap<Integer, String>();
+
   /**
    * If the plan has a reducer and correspondingly a reduce-sink, then store the TableDesc pointing
    * to keySerializeInfo of the ReduceSink
@@ -103,6 +113,14 @@ public void setNeedsTagging(boolean needsTagging) {
     this.needsTagging = needsTagging;
   }
 
+  public void setTagToInput(final Map<Integer, String> tagToInput) {
+    this.tagToInput = tagToInput;
+  }
+
+  public Map<Integer, String> getTagToInput() {
+    return tagToInput;
+  }
+
   @Override
   protected List<Operator<?>> getAllRootOperators() {
     ArrayList<Operator<?>> opList = new ArrayList<Operator<?>>();
diff --git a/ql/src/test/org/apache/hadoop/hive/ql/exec/TestOperators.java b/ql/src/test/org/apache/hadoop/hive/ql/exec/TestOperators.java
index b36767c408..bbde09c0ff 100644
--- a/ql/src/test/org/apache/hadoop/hive/ql/exec/TestOperators.java
+++ b/ql/src/test/org/apache/hadoop/hive/ql/exec/TestOperators.java
@@ -29,6 +29,7 @@
 import org.apache.hadoop.conf.Configuration;
 import org.apache.hadoop.fs.Path;
 import org.apache.hadoop.hive.conf.HiveConf;
+import org.apache.hadoop.hive.ql.io.IOContext;
 import org.apache.hadoop.hive.ql.parse.TypeCheckProcFactory;
 import org.apache.hadoop.hive.ql.plan.CollectDesc;
 import org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc;
@@ -313,6 +314,7 @@ public void testMapOperator() throws Throwable {
       Configuration hconf = new JobConf(TestOperators.class);
       HiveConf.setVar(hconf, HiveConf.ConfVars.HADOOPMAPFILENAME,
           "hdfs:///testDir/testFile");
+      IOContext.get().setInputPath(new Path("hdfs:///testDir/testFile"));
 
       // initialize pathToAliases
       ArrayList<String> aliases = new ArrayList<String>();
diff --git a/ql/src/test/org/apache/hadoop/hive/ql/io/orc/TestInputOutputFormat.java b/ql/src/test/org/apache/hadoop/hive/ql/io/orc/TestInputOutputFormat.java
index ac2bf02b65..93b50c6006 100644
--- a/ql/src/test/org/apache/hadoop/hive/ql/io/orc/TestInputOutputFormat.java
+++ b/ql/src/test/org/apache/hadoop/hive/ql/io/orc/TestInputOutputFormat.java
@@ -19,6 +19,7 @@
 
 import static org.junit.Assert.assertArrayEquals;
 import static org.junit.Assert.assertEquals;
+import static org.junit.Assert.assertTrue;
 
 import java.io.DataInput;
 import java.io.DataOutput;
@@ -425,8 +426,8 @@ public void testAddSplit() throws Exception {
     OrcInputFormat.Context context = new OrcInputFormat.Context(conf);
     OrcInputFormat.SplitGenerator splitter =
         new OrcInputFormat.SplitGenerator(context, fs,
-            fs.getFileStatus(new Path("/a/file")));
-    splitter.createSplit(0, 200);
+            fs.getFileStatus(new Path("/a/file")), null);
+    splitter.createSplit(0, 200, null);
     FileSplit result = context.getResult(-1);
     assertEquals(0, result.getStart());
     assertEquals(200, result.getLength());
@@ -436,14 +437,14 @@ public void testAddSplit() throws Exception {
     assertEquals("host1-1", locs[0]);
     assertEquals("host1-2", locs[1]);
     assertEquals("host1-3", locs[2]);
-    splitter.createSplit(500, 600);
+    splitter.createSplit(500, 600, null);
     result = context.getResult(-1);
     locs = result.getLocations();
     assertEquals(3, locs.length);
     assertEquals("host2-1", locs[0]);
     assertEquals("host0", locs[1]);
     assertEquals("host2-3", locs[2]);
-    splitter.createSplit(0, 2500);
+    splitter.createSplit(0, 2500, null);
     result = context.getResult(-1);
     locs = result.getLocations();
     assertEquals(1, locs.length);
@@ -468,7 +469,7 @@ public void testSplitGenerator() throws Exception {
     OrcInputFormat.Context context = new OrcInputFormat.Context(conf);
     OrcInputFormat.SplitGenerator splitter =
         new OrcInputFormat.SplitGenerator(context, fs,
-            fs.getFileStatus(new Path("/a/file")));
+            fs.getFileStatus(new Path("/a/file")), null);
     splitter.run();
     if (context.getErrors().size() > 0) {
       for(Throwable th: context.getErrors()) {
@@ -496,7 +497,7 @@ public void testSplitGenerator() throws Exception {
     conf.setInt(OrcInputFormat.MAX_SPLIT_SIZE, 0);
     context = new OrcInputFormat.Context(conf);
     splitter = new OrcInputFormat.SplitGenerator(context, fs,
-      fs.getFileStatus(new Path("/a/file")));
+      fs.getFileStatus(new Path("/a/file")), null);
     splitter.run();
     if (context.getErrors().size() > 0) {
       for(Throwable th: context.getErrors()) {
@@ -562,7 +563,6 @@ public void testInOutFormat() throws Exception {
     IntObjectInspector intInspector =
         (IntObjectInspector) fields.get(0).getFieldObjectInspector();
     assertEquals(0.0, reader.getProgress(), 0.00001);
-    assertEquals(3, reader.getPos());
     while (reader.next(key, value)) {
       assertEquals(++rowNum, intInspector.get(inspector.
           getStructFieldData(serde.deserialize(value), fields.get(0))));
@@ -697,7 +697,7 @@ public void testEmptyFile() throws Exception {
     InputFormat<?,?> in = new OrcInputFormat();
     FileInputFormat.setInputPaths(conf, testFilePath.toString());
     InputSplit[] splits = in.getSplits(conf, 1);
-    assertEquals(0, splits.length);
+    assertTrue(1 == splits.length);
     assertEquals(null, serde.getSerDeStats());
   }
 
diff --git a/ql/src/test/results/clientpositive/auto_sortmerge_join_11.q.out b/ql/src/test/results/clientpositive/auto_sortmerge_join_11.q.out
index c768239a35..95e86e1f15 100644
--- a/ql/src/test/results/clientpositive/auto_sortmerge_join_11.q.out
+++ b/ql/src/test/results/clientpositive/auto_sortmerge_join_11.q.out
@@ -174,6 +174,8 @@ STAGE PLANS:
                 0 [Column[key]]
                 1 [Column[key]]
               Position of Big Table: 1
+              Statistics:
+                  numRows: 127 dataSize: 12786 basicStatsState: COMPLETE colStatsState: NONE
               Select Operator
                 Statistics:
                     numRows: 127 dataSize: 12786 basicStatsState: COMPLETE colStatsState: NONE
@@ -498,6 +500,8 @@ STAGE PLANS:
                 0 [Column[key]]
                 1 [Column[key]]
               Position of Big Table: 1
+              Statistics:
+                  numRows: 127 dataSize: 12786 basicStatsState: COMPLETE colStatsState: NONE
               Select Operator
                 Statistics:
                     numRows: 127 dataSize: 12786 basicStatsState: COMPLETE colStatsState: NONE
diff --git a/ql/src/test/results/clientpositive/auto_sortmerge_join_12.q.out b/ql/src/test/results/clientpositive/auto_sortmerge_join_12.q.out
index e049ccfc38..fd8e9ccd81 100644
--- a/ql/src/test/results/clientpositive/auto_sortmerge_join_12.q.out
+++ b/ql/src/test/results/clientpositive/auto_sortmerge_join_12.q.out
@@ -334,6 +334,8 @@ STAGE PLANS:
                 1 [Column[key]]
                 2 [Column[key]]
               Position of Big Table: 2
+              Statistics:
+                  numRows: 255 dataSize: 25572 basicStatsState: COMPLETE colStatsState: NONE
               Map Join Operator
                 condition map:
                      Inner Join 0 to 1
@@ -345,6 +347,8 @@ STAGE PLANS:
                   0 []
                   1 []
                 Position of Big Table: 0
+                Statistics:
+                    numRows: 280 dataSize: 28129 basicStatsState: COMPLETE colStatsState: NONE
                 Select Operator
                   Statistics:
                       numRows: 280 dataSize: 28129 basicStatsState: COMPLETE colStatsState: NONE
diff --git a/ql/src/test/results/clientpositive/join32.q.out b/ql/src/test/results/clientpositive/join32.q.out
index 890826091a..9e84d842cd 100644
--- a/ql/src/test/results/clientpositive/join32.q.out
+++ b/ql/src/test/results/clientpositive/join32.q.out
@@ -133,6 +133,8 @@ STAGE PLANS:
                 1 [Column[key]]
               outputColumnNames: _col0, _col1, _col5
               Position of Big Table: 1
+              Statistics:
+                  numRows: 31 dataSize: 6393 basicStatsState: COMPLETE colStatsState: NONE
               Map Join Operator
                 condition map:
                      Inner Join 0 to 1
@@ -145,6 +147,8 @@ STAGE PLANS:
                   1 [Column[value]]
                 outputColumnNames: _col1, _col4, _col9
                 Position of Big Table: 0
+                Statistics:
+                    numRows: 63 dataSize: 6393 basicStatsState: COMPLETE colStatsState: NONE
                 Select Operator
                   expressions:
                         expr: _col4
diff --git a/ql/src/test/results/clientpositive/join32_lessSize.q.out b/ql/src/test/results/clientpositive/join32_lessSize.q.out
index de5736be29..0f6f8ec3c0 100644
--- a/ql/src/test/results/clientpositive/join32_lessSize.q.out
+++ b/ql/src/test/results/clientpositive/join32_lessSize.q.out
@@ -80,6 +80,8 @@ STAGE PLANS:
                 1 [Column[key]]
               outputColumnNames: _col0, _col1, _col5
               Position of Big Table: 1
+              Statistics:
+                  numRows: 31 dataSize: 6393 basicStatsState: COMPLETE colStatsState: NONE
               File Output Operator
                 compressed: false
                 GlobalTableId: 0
@@ -272,6 +274,8 @@ STAGE PLANS:
                 1 [Column[value]]
               outputColumnNames: _col1, _col4, _col9
               Position of Big Table: 0
+              Statistics:
+                  numRows: 63 dataSize: 6393 basicStatsState: COMPLETE colStatsState: NONE
               Select Operator
                 expressions:
                       expr: _col4
@@ -602,6 +606,8 @@ STAGE PLANS:
                 1 [Column[value]]
               outputColumnNames: _col4
               Position of Big Table: 0
+              Statistics:
+                  numRows: 63 dataSize: 6393 basicStatsState: COMPLETE colStatsState: NONE
               File Output Operator
                 compressed: false
                 GlobalTableId: 0
@@ -1805,6 +1811,8 @@ STAGE PLANS:
                 1 [Column[key]]
               outputColumnNames: _col0, _col1
               Position of Big Table: 1
+              Statistics:
+                  numRows: 63 dataSize: 6393 basicStatsState: COMPLETE colStatsState: NONE
               Select Operator
                 expressions:
                       expr: _col0
@@ -2006,6 +2014,8 @@ STAGE PLANS:
                 1 [Column[value]]
               outputColumnNames: _col0, _col1, _col3
               Position of Big Table: 0
+              Statistics:
+                  numRows: 69 dataSize: 7032 basicStatsState: COMPLETE colStatsState: NONE
               Select Operator
                 expressions:
                       expr: _col0
@@ -2346,6 +2356,8 @@ STAGE PLANS:
                 1 [Column[key]]
               outputColumnNames: _col0, _col1
               Position of Big Table: 0
+              Statistics:
+                  numRows: 63 dataSize: 6393 basicStatsState: COMPLETE colStatsState: NONE
               Select Operator
                 expressions:
                       expr: _col0
@@ -2547,6 +2559,8 @@ STAGE PLANS:
                 1 [Column[value]]
               outputColumnNames: _col0, _col1, _col3
               Position of Big Table: 0
+              Statistics:
+                  numRows: 69 dataSize: 7032 basicStatsState: COMPLETE colStatsState: NONE
               Select Operator
                 expressions:
                       expr: _col0
diff --git a/ql/src/test/results/clientpositive/join33.q.out b/ql/src/test/results/clientpositive/join33.q.out
index 890826091a..9e84d842cd 100644
--- a/ql/src/test/results/clientpositive/join33.q.out
+++ b/ql/src/test/results/clientpositive/join33.q.out
@@ -133,6 +133,8 @@ STAGE PLANS:
                 1 [Column[key]]
               outputColumnNames: _col0, _col1, _col5
               Position of Big Table: 1
+              Statistics:
+                  numRows: 31 dataSize: 6393 basicStatsState: COMPLETE colStatsState: NONE
               Map Join Operator
                 condition map:
                      Inner Join 0 to 1
@@ -145,6 +147,8 @@ STAGE PLANS:
                   1 [Column[value]]
                 outputColumnNames: _col1, _col4, _col9
                 Position of Big Table: 0
+                Statistics:
+                    numRows: 63 dataSize: 6393 basicStatsState: COMPLETE colStatsState: NONE
                 Select Operator
                   expressions:
                         expr: _col4
diff --git a/ql/src/test/results/clientpositive/join34.q.out b/ql/src/test/results/clientpositive/join34.q.out
index 86bfa53385..1e2aa91fa9 100644
--- a/ql/src/test/results/clientpositive/join34.q.out
+++ b/ql/src/test/results/clientpositive/join34.q.out
@@ -100,6 +100,8 @@ STAGE PLANS:
                       1 [Column[key]]
                     outputColumnNames: _col1, _col2, _col3
                     Position of Big Table: 0
+                    Statistics:
+                        numRows: 19 dataSize: 3966 basicStatsState: COMPLETE colStatsState: NONE
                     Select Operator
                       expressions:
                             expr: _col2
@@ -174,6 +176,8 @@ STAGE PLANS:
                       1 [Column[key]]
                     outputColumnNames: _col1, _col2, _col3
                     Position of Big Table: 0
+                    Statistics:
+                        numRows: 19 dataSize: 3966 basicStatsState: COMPLETE colStatsState: NONE
                     Select Operator
                       expressions:
                             expr: _col2
diff --git a/ql/src/test/results/clientpositive/multi_insert_move_tasks_share_dependencies.q.out b/ql/src/test/results/clientpositive/multi_insert_move_tasks_share_dependencies.q.out
index 3a181f383a..e264abb3f4 100644
--- a/ql/src/test/results/clientpositive/multi_insert_move_tasks_share_dependencies.q.out
+++ b/ql/src/test/results/clientpositive/multi_insert_move_tasks_share_dependencies.q.out
@@ -184,16 +184,16 @@ ABSTRACT SYNTAX TREE:
 
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
-  Stage-8 depends on stages: Stage-2 , consists of Stage-5, Stage-4, Stage-6
-  Stage-5
-  Stage-9 depends on stages: Stage-5, Stage-4, Stage-7, Stage-12, Stage-11, Stage-14
-  Stage-0 depends on stages: Stage-9
+  Stage-9 depends on stages: Stage-2 , consists of Stage-6, Stage-5, Stage-7
+  Stage-6
+  Stage-4 depends on stages: Stage-6, Stage-5, Stage-8, Stage-12, Stage-11, Stage-14
+  Stage-0 depends on stages: Stage-4
   Stage-3 depends on stages: Stage-0
-  Stage-1 depends on stages: Stage-9
+  Stage-1 depends on stages: Stage-4
   Stage-10 depends on stages: Stage-1
-  Stage-4
-  Stage-6
-  Stage-7 depends on stages: Stage-6
+  Stage-5
+  Stage-7
+  Stage-8 depends on stages: Stage-7
   Stage-15 depends on stages: Stage-2 , consists of Stage-12, Stage-11, Stage-13
   Stage-12
   Stage-11
@@ -246,16 +246,16 @@ STAGE PLANS:
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       name: default.src_multi2
 
-  Stage: Stage-8
+  Stage: Stage-9
     Conditional Operator
 
-  Stage: Stage-5
+  Stage: Stage-6
     Move Operator
       files:
           hdfs directory: true
 #### A masked pattern was here ####
 
-  Stage: Stage-9
+  Stage: Stage-4
     Dependency Collection
 
   Stage: Stage-0
@@ -284,7 +284,7 @@ STAGE PLANS:
   Stage: Stage-10
     Stats-Aggr Operator
 
-  Stage: Stage-4
+  Stage: Stage-5
     Map Reduce
       Alias -> Map Operator Tree:
 #### A masked pattern was here ####
@@ -298,7 +298,7 @@ STAGE PLANS:
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   name: default.src_multi1
 
-  Stage: Stage-6
+  Stage: Stage-7
     Map Reduce
       Alias -> Map Operator Tree:
 #### A masked pattern was here ####
@@ -312,7 +312,7 @@ STAGE PLANS:
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   name: default.src_multi1
 
-  Stage: Stage-7
+  Stage: Stage-8
     Move Operator
       files:
           hdfs directory: true
@@ -650,16 +650,16 @@ ABSTRACT SYNTAX TREE:
 
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
-  Stage-8 depends on stages: Stage-2 , consists of Stage-5, Stage-4, Stage-6
-  Stage-5
-  Stage-9 depends on stages: Stage-5, Stage-4, Stage-7, Stage-12, Stage-11, Stage-14
-  Stage-0 depends on stages: Stage-9
+  Stage-9 depends on stages: Stage-2 , consists of Stage-6, Stage-5, Stage-7
+  Stage-6
+  Stage-4 depends on stages: Stage-6, Stage-5, Stage-8, Stage-12, Stage-11, Stage-14
+  Stage-0 depends on stages: Stage-4
   Stage-3 depends on stages: Stage-0
-  Stage-1 depends on stages: Stage-9
+  Stage-1 depends on stages: Stage-4
   Stage-10 depends on stages: Stage-1
-  Stage-4
-  Stage-6
-  Stage-7 depends on stages: Stage-6
+  Stage-5
+  Stage-7
+  Stage-8 depends on stages: Stage-7
   Stage-15 depends on stages: Stage-2 , consists of Stage-12, Stage-11, Stage-13
   Stage-12
   Stage-11
@@ -712,16 +712,16 @@ STAGE PLANS:
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       name: default.src_multi2
 
-  Stage: Stage-8
+  Stage: Stage-9
     Conditional Operator
 
-  Stage: Stage-5
+  Stage: Stage-6
     Move Operator
       files:
           hdfs directory: true
 #### A masked pattern was here ####
 
-  Stage: Stage-9
+  Stage: Stage-4
     Dependency Collection
 
   Stage: Stage-0
@@ -750,7 +750,7 @@ STAGE PLANS:
   Stage: Stage-10
     Stats-Aggr Operator
 
-  Stage: Stage-4
+  Stage: Stage-5
     Map Reduce
       Alias -> Map Operator Tree:
 #### A masked pattern was here ####
@@ -764,7 +764,7 @@ STAGE PLANS:
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   name: default.src_multi1
 
-  Stage: Stage-6
+  Stage: Stage-7
     Map Reduce
       Alias -> Map Operator Tree:
 #### A masked pattern was here ####
@@ -778,7 +778,7 @@ STAGE PLANS:
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   name: default.src_multi1
 
-  Stage: Stage-7
+  Stage: Stage-8
     Move Operator
       files:
           hdfs directory: true
@@ -1201,16 +1201,16 @@ ABSTRACT SYNTAX TREE:
 
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
-  Stage-8 depends on stages: Stage-2 , consists of Stage-5, Stage-4, Stage-6
-  Stage-5
-  Stage-9 depends on stages: Stage-5, Stage-4, Stage-7, Stage-12, Stage-11, Stage-14
-  Stage-0 depends on stages: Stage-9
+  Stage-9 depends on stages: Stage-2 , consists of Stage-6, Stage-5, Stage-7
+  Stage-6
+  Stage-4 depends on stages: Stage-6, Stage-5, Stage-8, Stage-12, Stage-11, Stage-14
+  Stage-0 depends on stages: Stage-4
   Stage-3 depends on stages: Stage-0
-  Stage-1 depends on stages: Stage-9
+  Stage-1 depends on stages: Stage-4
   Stage-10 depends on stages: Stage-1
-  Stage-4
-  Stage-6
-  Stage-7 depends on stages: Stage-6
+  Stage-5
+  Stage-7
+  Stage-8 depends on stages: Stage-7
   Stage-15 depends on stages: Stage-2 , consists of Stage-12, Stage-11, Stage-13
   Stage-12
   Stage-11
@@ -1307,16 +1307,16 @@ STAGE PLANS:
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       name: default.src_multi2
 
-  Stage: Stage-8
+  Stage: Stage-9
     Conditional Operator
 
-  Stage: Stage-5
+  Stage: Stage-6
     Move Operator
       files:
           hdfs directory: true
 #### A masked pattern was here ####
 
-  Stage: Stage-9
+  Stage: Stage-4
     Dependency Collection
 
   Stage: Stage-0
@@ -1345,7 +1345,7 @@ STAGE PLANS:
   Stage: Stage-10
     Stats-Aggr Operator
 
-  Stage: Stage-4
+  Stage: Stage-5
     Map Reduce
       Alias -> Map Operator Tree:
 #### A masked pattern was here ####
@@ -1359,7 +1359,7 @@ STAGE PLANS:
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   name: default.src_multi1
 
-  Stage: Stage-6
+  Stage: Stage-7
     Map Reduce
       Alias -> Map Operator Tree:
 #### A masked pattern was here ####
@@ -1373,7 +1373,7 @@ STAGE PLANS:
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   name: default.src_multi1
 
-  Stage: Stage-7
+  Stage: Stage-8
     Move Operator
       files:
           hdfs directory: true
@@ -1789,16 +1789,16 @@ ABSTRACT SYNTAX TREE:
 
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
-  Stage-8 depends on stages: Stage-2 , consists of Stage-5, Stage-4, Stage-6
-  Stage-5
-  Stage-9 depends on stages: Stage-5, Stage-4, Stage-7, Stage-12, Stage-11, Stage-14
-  Stage-0 depends on stages: Stage-9
+  Stage-9 depends on stages: Stage-2 , consists of Stage-6, Stage-5, Stage-7
+  Stage-6
+  Stage-4 depends on stages: Stage-6, Stage-5, Stage-8, Stage-12, Stage-11, Stage-14
+  Stage-0 depends on stages: Stage-4
   Stage-3 depends on stages: Stage-0
-  Stage-1 depends on stages: Stage-9
+  Stage-1 depends on stages: Stage-4
   Stage-10 depends on stages: Stage-1
-  Stage-4
-  Stage-6
-  Stage-7 depends on stages: Stage-6
+  Stage-5
+  Stage-7
+  Stage-8 depends on stages: Stage-7
   Stage-15 depends on stages: Stage-2 , consists of Stage-12, Stage-11, Stage-13
   Stage-12
   Stage-11
@@ -1895,16 +1895,16 @@ STAGE PLANS:
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       name: default.src_multi2
 
-  Stage: Stage-8
+  Stage: Stage-9
     Conditional Operator
 
-  Stage: Stage-5
+  Stage: Stage-6
     Move Operator
       files:
           hdfs directory: true
 #### A masked pattern was here ####
 
-  Stage: Stage-9
+  Stage: Stage-4
     Dependency Collection
 
   Stage: Stage-0
@@ -1933,7 +1933,7 @@ STAGE PLANS:
   Stage: Stage-10
     Stats-Aggr Operator
 
-  Stage: Stage-4
+  Stage: Stage-5
     Map Reduce
       Alias -> Map Operator Tree:
 #### A masked pattern was here ####
@@ -1947,7 +1947,7 @@ STAGE PLANS:
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   name: default.src_multi1
 
-  Stage: Stage-6
+  Stage: Stage-7
     Map Reduce
       Alias -> Map Operator Tree:
 #### A masked pattern was here ####
@@ -1961,7 +1961,7 @@ STAGE PLANS:
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   name: default.src_multi1
 
-  Stage: Stage-7
+  Stage: Stage-8
     Move Operator
       files:
           hdfs directory: true
@@ -2432,16 +2432,16 @@ ABSTRACT SYNTAX TREE:
 
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
-  Stage-8 depends on stages: Stage-2 , consists of Stage-5, Stage-4, Stage-6
-  Stage-5
-  Stage-9 depends on stages: Stage-5, Stage-4, Stage-7, Stage-12, Stage-11, Stage-14
-  Stage-0 depends on stages: Stage-9
+  Stage-9 depends on stages: Stage-2 , consists of Stage-6, Stage-5, Stage-7
+  Stage-6
+  Stage-4 depends on stages: Stage-6, Stage-5, Stage-8, Stage-12, Stage-11, Stage-14
+  Stage-0 depends on stages: Stage-4
   Stage-3 depends on stages: Stage-0
-  Stage-1 depends on stages: Stage-9
+  Stage-1 depends on stages: Stage-4
   Stage-10 depends on stages: Stage-1
-  Stage-4
-  Stage-6
-  Stage-7 depends on stages: Stage-6
+  Stage-5
+  Stage-7
+  Stage-8 depends on stages: Stage-7
   Stage-15 depends on stages: Stage-2 , consists of Stage-12, Stage-11, Stage-13
   Stage-12
   Stage-11
@@ -2551,16 +2551,16 @@ STAGE PLANS:
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           name: default.src_multi2
 
-  Stage: Stage-8
+  Stage: Stage-9
     Conditional Operator
 
-  Stage: Stage-5
+  Stage: Stage-6
     Move Operator
       files:
           hdfs directory: true
 #### A masked pattern was here ####
 
-  Stage: Stage-9
+  Stage: Stage-4
     Dependency Collection
 
   Stage: Stage-0
@@ -2589,7 +2589,7 @@ STAGE PLANS:
   Stage: Stage-10
     Stats-Aggr Operator
 
-  Stage: Stage-4
+  Stage: Stage-5
     Map Reduce
       Alias -> Map Operator Tree:
 #### A masked pattern was here ####
@@ -2603,7 +2603,7 @@ STAGE PLANS:
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   name: default.src_multi1
 
-  Stage: Stage-6
+  Stage: Stage-7
     Map Reduce
       Alias -> Map Operator Tree:
 #### A masked pattern was here ####
@@ -2617,7 +2617,7 @@ STAGE PLANS:
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   name: default.src_multi1
 
-  Stage: Stage-7
+  Stage: Stage-8
     Move Operator
       files:
           hdfs directory: true
@@ -3178,16 +3178,16 @@ ABSTRACT SYNTAX TREE:
 
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
-  Stage-8 depends on stages: Stage-2 , consists of Stage-5, Stage-4, Stage-6
-  Stage-5
-  Stage-9 depends on stages: Stage-5, Stage-4, Stage-7, Stage-12, Stage-11, Stage-14
-  Stage-0 depends on stages: Stage-9
+  Stage-9 depends on stages: Stage-2 , consists of Stage-6, Stage-5, Stage-7
+  Stage-6
+  Stage-4 depends on stages: Stage-6, Stage-5, Stage-8, Stage-12, Stage-11, Stage-14
+  Stage-0 depends on stages: Stage-4
   Stage-3 depends on stages: Stage-0
-  Stage-1 depends on stages: Stage-9
+  Stage-1 depends on stages: Stage-4
   Stage-10 depends on stages: Stage-1
-  Stage-4
-  Stage-6
-  Stage-7 depends on stages: Stage-6
+  Stage-5
+  Stage-7
+  Stage-8 depends on stages: Stage-7
   Stage-15 depends on stages: Stage-2 , consists of Stage-12, Stage-11, Stage-13
   Stage-12
   Stage-11
@@ -3297,16 +3297,16 @@ STAGE PLANS:
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           name: default.src_multi2
 
-  Stage: Stage-8
+  Stage: Stage-9
     Conditional Operator
 
-  Stage: Stage-5
+  Stage: Stage-6
     Move Operator
       files:
           hdfs directory: true
 #### A masked pattern was here ####
 
-  Stage: Stage-9
+  Stage: Stage-4
     Dependency Collection
 
   Stage: Stage-0
@@ -3335,7 +3335,7 @@ STAGE PLANS:
   Stage: Stage-10
     Stats-Aggr Operator
 
-  Stage: Stage-4
+  Stage: Stage-5
     Map Reduce
       Alias -> Map Operator Tree:
 #### A masked pattern was here ####
@@ -3349,7 +3349,7 @@ STAGE PLANS:
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   name: default.src_multi1
 
-  Stage: Stage-6
+  Stage: Stage-7
     Map Reduce
       Alias -> Map Operator Tree:
 #### A masked pattern was here ####
@@ -3363,7 +3363,7 @@ STAGE PLANS:
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   name: default.src_multi1
 
-  Stage: Stage-7
+  Stage: Stage-8
     Move Operator
       files:
           hdfs directory: true
@@ -6276,16 +6276,16 @@ ABSTRACT SYNTAX TREE:
 
 STAGE DEPENDENCIES:
   Stage-4 is a root stage
-  Stage-10 depends on stages: Stage-4 , consists of Stage-7, Stage-6, Stage-8
-  Stage-7
-  Stage-11 depends on stages: Stage-7, Stage-6, Stage-9, Stage-14, Stage-13, Stage-16, Stage-18, Stage-19
-  Stage-0 depends on stages: Stage-11
+  Stage-11 depends on stages: Stage-4 , consists of Stage-8, Stage-7, Stage-9
+  Stage-8
+  Stage-6 depends on stages: Stage-8, Stage-7, Stage-10, Stage-14, Stage-13, Stage-16, Stage-18, Stage-19
+  Stage-0 depends on stages: Stage-6
   Stage-5 depends on stages: Stage-0
-  Stage-1 depends on stages: Stage-11
+  Stage-1 depends on stages: Stage-6
   Stage-12 depends on stages: Stage-1
-  Stage-6
-  Stage-8
-  Stage-9 depends on stages: Stage-8
+  Stage-7
+  Stage-9
+  Stage-10 depends on stages: Stage-9
   Stage-17 depends on stages: Stage-4 , consists of Stage-14, Stage-13, Stage-15
   Stage-14
   Stage-13
@@ -6422,16 +6422,16 @@ STAGE PLANS:
                       output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                       serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
 
-  Stage: Stage-10
+  Stage: Stage-11
     Conditional Operator
 
-  Stage: Stage-7
+  Stage: Stage-8
     Move Operator
       files:
           hdfs directory: true
 #### A masked pattern was here ####
 
-  Stage: Stage-11
+  Stage: Stage-6
     Dependency Collection
 
   Stage: Stage-0
@@ -6460,7 +6460,7 @@ STAGE PLANS:
   Stage: Stage-12
     Stats-Aggr Operator
 
-  Stage: Stage-6
+  Stage: Stage-7
     Map Reduce
       Alias -> Map Operator Tree:
 #### A masked pattern was here ####
@@ -6474,7 +6474,7 @@ STAGE PLANS:
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   name: default.src_multi1
 
-  Stage: Stage-8
+  Stage: Stage-9
     Map Reduce
       Alias -> Map Operator Tree:
 #### A masked pattern was here ####
@@ -6488,7 +6488,7 @@ STAGE PLANS:
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   name: default.src_multi1
 
-  Stage: Stage-9
+  Stage: Stage-10
     Move Operator
       files:
           hdfs directory: true
@@ -6855,16 +6855,16 @@ ABSTRACT SYNTAX TREE:
 
 STAGE DEPENDENCIES:
   Stage-4 is a root stage
-  Stage-10 depends on stages: Stage-4 , consists of Stage-7, Stage-6, Stage-8
-  Stage-7
-  Stage-11 depends on stages: Stage-7, Stage-6, Stage-9, Stage-14, Stage-13, Stage-16, Stage-18, Stage-19
-  Stage-0 depends on stages: Stage-11
+  Stage-11 depends on stages: Stage-4 , consists of Stage-8, Stage-7, Stage-9
+  Stage-8
+  Stage-6 depends on stages: Stage-8, Stage-7, Stage-10, Stage-14, Stage-13, Stage-16, Stage-18, Stage-19
+  Stage-0 depends on stages: Stage-6
   Stage-5 depends on stages: Stage-0
-  Stage-1 depends on stages: Stage-11
+  Stage-1 depends on stages: Stage-6
   Stage-12 depends on stages: Stage-1
-  Stage-6
-  Stage-8
-  Stage-9 depends on stages: Stage-8
+  Stage-7
+  Stage-9
+  Stage-10 depends on stages: Stage-9
   Stage-17 depends on stages: Stage-4 , consists of Stage-14, Stage-13, Stage-15
   Stage-14
   Stage-13
@@ -7001,16 +7001,16 @@ STAGE PLANS:
                       output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                       serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
 
-  Stage: Stage-10
+  Stage: Stage-11
     Conditional Operator
 
-  Stage: Stage-7
+  Stage: Stage-8
     Move Operator
       files:
           hdfs directory: true
 #### A masked pattern was here ####
 
-  Stage: Stage-11
+  Stage: Stage-6
     Dependency Collection
 
   Stage: Stage-0
@@ -7039,7 +7039,7 @@ STAGE PLANS:
   Stage: Stage-12
     Stats-Aggr Operator
 
-  Stage: Stage-6
+  Stage: Stage-7
     Map Reduce
       Alias -> Map Operator Tree:
 #### A masked pattern was here ####
@@ -7053,7 +7053,7 @@ STAGE PLANS:
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   name: default.src_multi1
 
-  Stage: Stage-8
+  Stage: Stage-9
     Map Reduce
       Alias -> Map Operator Tree:
 #### A masked pattern was here ####
@@ -7067,7 +7067,7 @@ STAGE PLANS:
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   name: default.src_multi1
 
-  Stage: Stage-9
+  Stage: Stage-10
     Move Operator
       files:
           hdfs directory: true
diff --git a/ql/src/test/results/clientpositive/vector_left_outer_join.q.out b/ql/src/test/results/clientpositive/vector_left_outer_join.q.out
index 1ecfae8e2a..0113bb5e67 100644
--- a/ql/src/test/results/clientpositive/vector_left_outer_join.q.out
+++ b/ql/src/test/results/clientpositive/vector_left_outer_join.q.out
@@ -152,4 +152,4 @@ left outer join alltypesorc hd
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc
 #### A masked pattern was here ####
-192735557
+225951785
diff --git a/ql/src/test/results/clientpositive/vectorized_mapjoin.q.out b/ql/src/test/results/clientpositive/vectorized_mapjoin.q.out
index e4e824e0a8..13d54897a8 100644
--- a/ql/src/test/results/clientpositive/vectorized_mapjoin.q.out
+++ b/ql/src/test/results/clientpositive/vectorized_mapjoin.q.out
@@ -131,4 +131,4 @@ POSTHOOK: query: SELECT COUNT(t1.cint), MAX(t2.cint), MIN(t1.cint), AVG(t1.cint+
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc
 #### A masked pattern was here ####
-3149925	1073680599	-1073051226	9.381482540406644E8
+3152013	1073680599	-1073279343	9.375396162525452E8
diff --git a/ql/src/test/results/compiler/plan/case_sensitivity.q.xml b/ql/src/test/results/compiler/plan/case_sensitivity.q.xml
index 3928bc649c..a5fc4725e9 100644
--- a/ql/src/test/results/compiler/plan/case_sensitivity.q.xml
+++ b/ql/src/test/results/compiler/plan/case_sensitivity.q.xml
@@ -79,137 +79,133 @@
                        #### A masked pattern was here #### 
                        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                         <void property="childOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                            <void property="conf"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                              <void property="dirName"> 
-                               #### A masked pattern was here #### 
-                              </void> 
-                              <void property="numFiles"> 
-                               <int>1</int> 
-                              </void> 
-                              <void property="tableInfo"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                                <void property="inputFileFormatClass"> 
-                                 <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-                                </void> 
-                                <void property="outputFileFormatClass"> 
-                                 <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-                                </void> 
-                                <void property="properties"> 
-                                 <object class="java.util.Properties"> 
-                                  <void method="put"> 
-                                   <string>name</string> 
-                                   <string>default.dest1</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>columns.types</string> 
-                                   <string>string:string</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.ddl</string> 
-                                   <string>struct dest1 { string key, string value}</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.format</string> 
-                                   <string>1</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>columns</string> 
-                                   <string>key,value</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>bucket_count</string> 
-                                   <string>-1</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.lib</string> 
-                                   <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>file.inputformat</string> 
-                                   <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>location</string> 
-                                   #### A masked pattern was here #### 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>file.outputformat</string> 
-                                   <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>transient_lastDdlTime</string> 
-                                   #### A masked pattern was here #### 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void property="totalFiles"> 
-                               <int>1</int> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="operatorId"> 
-                             <string>FS_6</string> 
+                         <void method="add"> 
+                          <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                           <void property="conf"> 
+                            <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                             <void property="dirName"> 
+                              #### A masked pattern was here #### 
+                             </void> 
+                             <void property="numFiles"> 
+                              <int>1</int> 
+                             </void> 
+                             <void property="tableInfo"> 
+                              <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                               <void property="inputFileFormatClass"> 
+                                <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                               </void> 
+                               <void property="outputFileFormatClass"> 
+                                <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                               </void> 
+                               <void property="properties"> 
+                                <object class="java.util.Properties"> 
+                                 <void method="put"> 
+                                  <string>name</string> 
+                                  <string>default.dest1</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>columns.types</string> 
+                                  <string>string:string</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.ddl</string> 
+                                  <string>struct dest1 { string key, string value}</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.format</string> 
+                                  <string>1</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>columns</string> 
+                                  <string>key,value</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>bucket_count</string> 
+                                  <string>-1</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.lib</string> 
+                                  <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>file.inputformat</string> 
+                                  <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>location</string> 
+                                  #### A masked pattern was here #### 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>file.outputformat</string> 
+                                  <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>transient_lastDdlTime</string> 
+                                  #### A masked pattern was here #### 
+                                 </void> 
+                                </object> 
+                               </void> 
+                              </object> 
+                             </void> 
+                             <void property="totalFiles"> 
+                              <int>1</int> 
+                             </void> 
+                            </object> 
+                           </void> 
+                           <void property="operatorId"> 
+                            <string>FS_6</string> 
+                           </void> 
+                           <void property="parentOperators"> 
+                            <void method="add"> 
+                             <object idref="TableScanOperator0"/> 
                             </void> 
-                            <void property="parentOperators"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object idref="TableScanOperator0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="schema"> 
-                             <object id="RowSchema0" class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                              <void property="signature"> 
-                               <object class="java.util.ArrayList"> 
-                                <void method="add"> 
-                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                  <void property="internalName"> 
-                                   <string>key</string> 
-                                  </void> 
-                                  <void property="tabAlias"> 
-                                   <string></string> 
-                                  </void> 
-                                  <void property="type"> 
-                                   <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                                    <void property="typeName"> 
-                                     <string>string</string> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                  <void property="typeName"> 
-                                   <string>string</string> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void method="add"> 
-                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                  <void property="internalName"> 
-                                   <string>value</string> 
-                                  </void> 
-                                  <void property="tabAlias"> 
-                                   <string></string> 
-                                  </void> 
-                                  <void property="type"> 
-                                   <object idref="PrimitiveTypeInfo0"/> 
-                                  </void> 
-                                  <void property="typeName"> 
-                                   <string>string</string> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
+                           </void> 
+                           <void property="schema"> 
+                            <object id="RowSchema0" class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                             <void property="signature"> 
+                              <object class="java.util.ArrayList"> 
+                               <void method="add"> 
+                                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                 <void property="internalName"> 
+                                  <string>key</string> 
+                                 </void> 
+                                 <void property="tabAlias"> 
+                                  <string></string> 
+                                 </void> 
+                                 <void property="type"> 
+                                  <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                                   <void property="typeName"> 
+                                    <string>string</string> 
+                                   </void> 
+                                  </object> 
+                                 </void> 
+                                 <void property="typeName"> 
+                                  <string>string</string> 
+                                 </void> 
+                                </object> 
+                               </void> 
+                               <void method="add"> 
+                                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                 <void property="internalName"> 
+                                  <string>value</string> 
+                                 </void> 
+                                 <void property="tabAlias"> 
+                                  <string></string> 
+                                 </void> 
+                                 <void property="type"> 
+                                  <object idref="PrimitiveTypeInfo0"/> 
+                                 </void> 
+                                 <void property="typeName"> 
+                                  <string>string</string> 
+                                 </void> 
+                                </object> 
+                               </void> 
+                              </object> 
+                             </void> 
+                            </object> 
+                           </void> 
+                          </object> 
+                         </void> 
                         </void> 
                         <void property="conf"> 
                          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"/> 
@@ -646,173 +642,114 @@
        <string>src_thrift</string> 
        <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                <void property="childOperators"> 
-                 <object class="java.util.ArrayList"> 
+         <void method="add"> 
+          <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+              <void property="childOperators"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                 <void property="conf"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                   <void property="destTableId"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="dirName"> 
+                    #### A masked pattern was here #### 
+                   </void> 
+                   <void property="gatherStats"> 
+                    <boolean>true</boolean> 
+                   </void> 
+                   <void property="lbCtx"> 
+                    <object idref="ListBucketingCtx0"/> 
+                   </void> 
+                   <void property="maxStatsKeyPrefixLength"> 
+                    <int>150</int> 
+                   </void> 
+                   <void property="numFiles"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="statsAggPrefix"> 
+                    #### A masked pattern was here #### 
+                   </void> 
+                   <void property="statsCollectRawDataSize"> 
+                    <boolean>true</boolean> 
+                   </void> 
+                   <void property="tableInfo"> 
+                    <object idref="TableDesc0"/> 
+                   </void> 
+                   <void property="totalFiles"> 
+                    <int>1</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="operatorId"> 
+                  <string>FS_3</string> 
+                 </void> 
+                 <void property="parentOperators"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                      <void property="destTableId"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="dirName"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="gatherStats"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="lbCtx"> 
-                       <object idref="ListBucketingCtx0"/> 
-                      </void> 
-                      <void property="maxStatsKeyPrefixLength"> 
-                       <int>150</int> 
-                      </void> 
-                      <void property="numFiles"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="statsAggPrefix"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="statsCollectRawDataSize"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="tableInfo"> 
-                       <object idref="TableDesc0"/> 
-                      </void> 
-                      <void property="totalFiles"> 
-                       <int>1</int> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="operatorId"> 
-                     <string>FS_3</string> 
-                    </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="SelectOperator0"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="schema"> 
-                     <object idref="RowSchema0"/> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="columnExprMap"> 
-                 <object class="java.util.HashMap"> 
-                  <void method="put"> 
-                   <string>_col1</string> 
-                   <object id="ExprNodeFieldDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeFieldDesc"> 
-                    <void property="desc"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                      <void property="children"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                          <void property="column"> 
-                           <string>lintstring</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string>src_thrift</string> 
-                          </void> 
-                          <void property="typeInfo"> 
-                           <object id="ListTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.ListTypeInfo"> 
-                            <void property="listElementTypeInfo"> 
-                             <object id="StructTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.StructTypeInfo"> 
-                              <void property="allStructFieldNames"> 
-                               <object class="java.util.ArrayList"> 
-                                <void method="add"> 
-                                 <string>myint</string> 
-                                </void> 
-                                <void method="add"> 
-                                 <string>mystring</string> 
-                                </void> 
-                                <void method="add"> 
-                                 <string>underscore_int</string> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void property="allStructFieldTypeInfos"> 
-                               <object class="java.util.ArrayList"> 
-                                <void method="add"> 
-                                 <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                                  <void property="typeName"> 
-                                   <string>int</string> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void method="add"> 
-                                 <object idref="PrimitiveTypeInfo0"/> 
-                                </void> 
-                                <void method="add"> 
-                                 <object idref="PrimitiveTypeInfo1"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                          <void property="typeInfo"> 
-                           <object idref="PrimitiveTypeInfo1"/> 
-                          </void> 
-                          <void property="value"> 
-                           <int>0</int> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="genericUDF"> 
-                       <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFIndex"/> 
-                      </void> 
-                      <void property="typeInfo"> 
-                       <object idref="StructTypeInfo0"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="fieldName"> 
-                     <string>MYSTRING</string> 
-                    </void> 
-                    <void property="isList"> 
-                     <boolean>false</boolean> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
+                   <object idref="SelectOperator0"/> 
                   </void> 
-                  <void method="put"> 
-                   <string>_col0</string> 
-                   <object id="ExprNodeGenericFuncDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                 </void> 
+                 <void property="schema"> 
+                  <object idref="RowSchema0"/> 
+                 </void> 
+                </object> 
+               </void> 
+              </void> 
+              <void property="columnExprMap"> 
+               <object class="java.util.HashMap"> 
+                <void method="put"> 
+                 <string>_col1</string> 
+                 <object id="ExprNodeFieldDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeFieldDesc"> 
+                  <void property="desc"> 
+                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
                     <void property="children"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
                        <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
                         <void property="column"> 
-                         <string>lint</string> 
+                         <string>lintstring</string> 
                         </void> 
                         <void property="tabAlias"> 
                          <string>src_thrift</string> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object id="ListTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.ListTypeInfo"> 
+                         <object id="ListTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.ListTypeInfo"> 
                           <void property="listElementTypeInfo"> 
-                           <object idref="PrimitiveTypeInfo1"/> 
+                           <object id="StructTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.StructTypeInfo"> 
+                            <void property="allStructFieldNames"> 
+                             <object class="java.util.ArrayList"> 
+                              <void method="add"> 
+                               <string>myint</string> 
+                              </void> 
+                              <void method="add"> 
+                               <string>mystring</string> 
+                              </void> 
+                              <void method="add"> 
+                               <string>underscore_int</string> 
+                              </void> 
+                             </object> 
+                            </void> 
+                            <void property="allStructFieldTypeInfos"> 
+                             <object class="java.util.ArrayList"> 
+                              <void method="add"> 
+                               <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                                <void property="typeName"> 
+                                 <string>int</string> 
+                                </void> 
+                               </object> 
+                              </void> 
+                              <void method="add"> 
+                               <object idref="PrimitiveTypeInfo0"/> 
+                              </void> 
+                              <void method="add"> 
+                               <object idref="PrimitiveTypeInfo1"/> 
+                              </void> 
+                             </object> 
+                            </void> 
+                           </object> 
                           </void> 
                          </object> 
                         </void> 
@@ -824,7 +761,7 @@
                          <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
                         <void property="value"> 
-                         <int>1</int> 
+                         <int>0</int> 
                         </void> 
                        </object> 
                       </void> 
@@ -834,196 +771,126 @@
                      <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFIndex"/> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
+                     <object idref="StructTypeInfo0"/> 
                     </void> 
                    </object> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                  <void property="colList"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="ExprNodeGenericFuncDesc0"/> 
-                    </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeFieldDesc0"/> 
-                    </void> 
-                   </object> 
+                  <void property="fieldName"> 
+                   <string>MYSTRING</string> 
                   </void> 
-                  <void property="outputColumnNames"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <string>_col0</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col1</string> 
-                    </void> 
-                   </object> 
+                  <void property="isList"> 
+                   <boolean>false</boolean> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="operatorId"> 
-                 <string>SEL_2</string> 
-                </void> 
-                <void property="parentOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object idref="FilterOperator0"/> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
+                <void method="put"> 
+                 <string>_col0</string> 
+                 <object id="ExprNodeGenericFuncDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                  <void property="children"> 
                    <object class="java.util.ArrayList"> 
                     <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                      <void property="column"> 
+                       <string>lint</string> 
                       </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo1"/> 
+                      <void property="tabAlias"> 
+                       <string>src_thrift</string> 
                       </void> 
-                      <void property="typeName"> 
-                       <string>int</string> 
+                      <void property="typeInfo"> 
+                       <object id="ListTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.ListTypeInfo"> 
+                        <void property="listElementTypeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
+                        </void> 
+                       </object> 
                       </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
+                      <void property="value"> 
+                       <int>1</int> 
                       </void> 
                      </object> 
                     </void> 
                    </object> 
                   </void> 
+                  <void property="genericUDF"> 
+                   <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFIndex"/> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo1"/> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
               </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-              <void property="predicate"> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                <void property="colList"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>lint</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src_thrift</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="ListTypeInfo1"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>0</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFIndex"/> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
-                    </void> 
-                   </object> 
+                   <object idref="ExprNodeGenericFuncDesc0"/> 
                   </void> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
-                    </void> 
-                    <void property="value"> 
-                     <int>0</int> 
-                    </void> 
-                   </object> 
+                   <object idref="ExprNodeFieldDesc0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                  <void property="typeName"> 
-                   <string>boolean</string> 
+                <void property="outputColumnNames"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <string>_col0</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col1</string> 
                   </void> 
                  </object> 
                 </void> 
                </object> 
               </void> 
-             </object> 
-            </void> 
-            <void property="operatorId"> 
-             <string>FIL_4</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator1"/> 
+              <void property="operatorId"> 
+               <string>SEL_2</string> 
               </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>lint</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src_thrift</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="ListTypeInfo1"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>array&lt;int&gt;</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>lintstring</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src_thrift</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="ListTypeInfo0"/> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="FilterOperator0"/> 
+               </void> 
+              </void> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo1"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>int</string> 
+                    </void> 
+                   </object> 
                   </void> 
-                  <void property="typeName"> 
-                   <string>array&lt;struct&lt;myint:int,mystring:string,underscore_int:int&gt;&gt;</string> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col1</string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
                   </void> 
                  </object> 
                 </void> 
@@ -1031,9 +898,126 @@
               </void> 
              </object> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
+             <void property="predicate"> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                   <void property="children"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <void property="column"> 
+                        <string>lint</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string>src_thrift</string> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="ListTypeInfo1"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo1"/> 
+                       </void> 
+                       <void property="value"> 
+                        <int>0</int> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="genericUDF"> 
+                    <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFIndex"/> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo1"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo1"/> 
+                   </void> 
+                   <void property="value"> 
+                    <int>0</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                 <void property="typeName"> 
+                  <string>boolean</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>FIL_4</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator1"/> 
+            </void> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>lint</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src_thrift</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="ListTypeInfo1"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>array&lt;int&gt;</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>lintstring</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src_thrift</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="ListTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>array&lt;struct&lt;myint:int,mystring:string,underscore_int:int&gt;&gt;</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
diff --git a/ql/src/test/results/compiler/plan/cast1.q.xml b/ql/src/test/results/compiler/plan/cast1.q.xml
index 75f400d88b..03ad8123d5 100644
--- a/ql/src/test/results/compiler/plan/cast1.q.xml
+++ b/ql/src/test/results/compiler/plan/cast1.q.xml
@@ -153,744 +153,655 @@
        <string>src</string> 
        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                <void property="childOperators"> 
-                 <object class="java.util.ArrayList"> 
+         <void method="add"> 
+          <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+              <void property="childOperators"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                 <void property="conf"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                   <void property="dirName"> 
+                    #### A masked pattern was here #### 
+                   </void> 
+                   <void property="numFiles"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="statsAggPrefix"> 
+                    #### A masked pattern was here #### 
+                   </void> 
+                   <void property="statsCollectRawDataSize"> 
+                    <boolean>true</boolean> 
+                   </void> 
+                   <void property="tableInfo"> 
+                    <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                     <void property="inputFileFormatClass"> 
+                      <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                     </void> 
+                     <void property="outputFileFormatClass"> 
+                      <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                     </void> 
+                     <void property="properties"> 
+                      <object class="java.util.Properties"> 
+                       <void method="put"> 
+                        <string>hive.serialization.extend.nesting.levels</string> 
+                        <string>true</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns</string> 
+                        <string>_col0,_col1,_col2,_col3,_col4,_col5,_col6</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.lib</string> 
+                        <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.format</string> 
+                        <string>1</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns.types</string> 
+                        <string>int:double:double:double:int:boolean:int</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>escape.delim</string> 
+                        <string>\</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="totalFiles"> 
+                    <int>1</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="operatorId"> 
+                  <string>FS_3</string> 
+                 </void> 
+                 <void property="parentOperators"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                      <void property="dirName"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="numFiles"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="statsAggPrefix"> 
-                       #### A masked pattern was here #### 
+                   <object idref="SelectOperator0"/> 
+                  </void> 
+                 </void> 
+                 <void property="schema"> 
+                  <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                   <void property="signature"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>_col0</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string></string> 
+                       </void> 
+                       <void property="type"> 
+                        <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                         <void property="typeName"> 
+                          <string>int</string> 
+                         </void> 
+                        </object> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>int</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>_col1</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string></string> 
+                       </void> 
+                       <void property="type"> 
+                        <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                         <void property="typeName"> 
+                          <string>double</string> 
+                         </void> 
+                        </object> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>double</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>_col2</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string></string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo1"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>double</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>_col3</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string></string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo1"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>double</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>_col4</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string></string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>int</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>_col5</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string></string> 
+                       </void> 
+                       <void property="type"> 
+                        <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                         <void property="typeName"> 
+                          <string>boolean</string> 
+                         </void> 
+                        </object> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>boolean</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>_col6</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string></string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>int</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+              </void> 
+              <void property="columnExprMap"> 
+               <object class="java.util.HashMap"> 
+                <void method="put"> 
+                 <string>_col6</string> 
+                 <object id="ExprNodeGenericFuncDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                  <void property="children"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo2"/> 
                       </void> 
-                      <void property="statsCollectRawDataSize"> 
+                      <void property="value"> 
                        <boolean>true</boolean> 
                       </void> 
-                      <void property="tableInfo"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                        <void property="inputFileFormatClass"> 
-                         <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-                        </void> 
-                        <void property="outputFileFormatClass"> 
-                         <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-                        </void> 
-                        <void property="properties"> 
-                         <object class="java.util.Properties"> 
-                          <void method="put"> 
-                           <string>hive.serialization.extend.nesting.levels</string> 
-                           <string>true</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns</string> 
-                           <string>_col0,_col1,_col2,_col3,_col4,_col5,_col6</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.lib</string> 
-                           <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.format</string> 
-                           <string>1</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns.types</string> 
-                           <string>int:double:double:double:int:boolean:int</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>escape.delim</string> 
-                           <string>\</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="totalFiles"> 
-                       <int>1</int> 
-                      </void> 
                      </object> 
                     </void> 
-                    <void property="operatorId"> 
-                     <string>FS_3</string> 
-                    </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="SelectOperator0"/> 
-                      </void> 
-                     </object> 
+                   </object> 
+                  </void> 
+                  <void property="genericUDF"> 
+                   <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                    <void property="udfClassName"> 
+                     <string>org.apache.hadoop.hive.ql.udf.UDFToInteger</string> 
                     </void> 
-                    <void property="schema"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                      <void property="signature"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col0</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string></string> 
-                          </void> 
-                          <void property="type"> 
-                           <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                            <void property="typeName"> 
-                             <string>int</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>int</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col1</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string></string> 
-                          </void> 
-                          <void property="type"> 
-                           <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                            <void property="typeName"> 
-                             <string>double</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>double</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col2</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string></string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo1"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>double</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col3</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string></string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo1"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>double</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col4</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string></string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>int</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col5</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string></string> 
-                          </void> 
-                          <void property="type"> 
-                           <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                            <void property="typeName"> 
-                             <string>boolean</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>boolean</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col6</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string></string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>int</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                    <void property="udfName"> 
+                     <string>UDFToInteger</string> 
                     </void> 
                    </object> 
                   </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
                  </object> 
                 </void> 
-                <void property="columnExprMap"> 
-                 <object class="java.util.HashMap"> 
-                  <void method="put"> 
-                   <string>_col6</string> 
-                   <object id="ExprNodeGenericFuncDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo2"/> 
-                        </void> 
-                        <void property="value"> 
-                         <boolean>true</boolean> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                      <void property="udfClassName"> 
-                       <string>org.apache.hadoop.hive.ql.udf.UDFToInteger</string> 
+                <void method="put"> 
+                 <string>_col5</string> 
+                 <object id="ExprNodeGenericFuncDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                  <void property="children"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
-                      <void property="udfName"> 
-                       <string>UDFToInteger</string> 
+                      <void property="value"> 
+                       <int>1</int> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
                    </object> 
                   </void> 
-                  <void method="put"> 
-                   <string>_col5</string> 
-                   <object id="ExprNodeGenericFuncDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>1</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                      <void property="udfClassName"> 
-                       <string>org.apache.hadoop.hive.ql.udf.UDFToBoolean</string> 
-                      </void> 
-                      <void property="udfName"> 
-                       <string>UDFToBoolean</string> 
-                      </void> 
-                     </object> 
+                  <void property="genericUDF"> 
+                   <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                    <void property="udfClassName"> 
+                     <string>org.apache.hadoop.hive.ql.udf.UDFToBoolean</string> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                    <void property="udfName"> 
+                     <string>UDFToBoolean</string> 
                     </void> 
                    </object> 
                   </void> 
-                  <void method="put"> 
-                   <string>_col4</string> 
-                   <object id="ExprNodeGenericFuncDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>3</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="children"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <double>2.0</double> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                          <void property="udfClassName"> 
-                           <string>org.apache.hadoop.hive.ql.udf.UDFToInteger</string> 
-                          </void> 
-                          <void property="udfName"> 
-                           <string>UDFToInteger</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPPlus"/> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo2"/> 
                   </void> 
-                  <void method="put"> 
-                   <string>_col3</string> 
-                   <object id="ExprNodeGenericFuncDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <double>3.0</double> 
-                        </void> 
-                       </object> 
+                 </object> 
+                </void> 
+                <void method="put"> 
+                 <string>_col4</string> 
+                 <object id="ExprNodeGenericFuncDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                  <void property="children"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <double>2.0</double> 
-                        </void> 
-                       </object> 
+                      <void property="value"> 
+                       <int>3</int> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPPlus"/> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void method="put"> 
-                   <string>_col2</string> 
-                   <object id="ExprNodeGenericFuncDesc4" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>3</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <double>2.0</double> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                      <void property="children"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                          <void property="typeInfo"> 
+                           <object idref="PrimitiveTypeInfo1"/> 
+                          </void> 
+                          <void property="value"> 
+                           <double>2.0</double> 
+                          </void> 
+                         </object> 
                         </void> 
                        </object> 
                       </void> 
-                     </object> 
-                    </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPPlus"/> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void method="put"> 
-                   <string>_col1</string> 
-                   <object id="ExprNodeGenericFuncDesc5" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
+                      <void property="genericUDF"> 
+                       <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                        <void property="udfClassName"> 
+                         <string>org.apache.hadoop.hive.ql.udf.UDFToInteger</string> 
                         </void> 
-                        <void property="value"> 
-                         <double>3.0</double> 
+                        <void property="udfName"> 
+                         <string>UDFToInteger</string> 
                         </void> 
                        </object> 
                       </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>2</int> 
-                        </void> 
-                       </object> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPPlus"/> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
-                    </void> 
                    </object> 
                   </void> 
-                  <void method="put"> 
-                   <string>_col0</string> 
-                   <object id="ExprNodeGenericFuncDesc6" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>3</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>2</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPPlus"/> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
+                  <void property="genericUDF"> 
+                   <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPPlus"/> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                  <void property="colList"> 
+                <void method="put"> 
+                 <string>_col3</string> 
+                 <object id="ExprNodeGenericFuncDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                  <void property="children"> 
                    <object class="java.util.ArrayList"> 
                     <void method="add"> 
-                     <object idref="ExprNodeGenericFuncDesc6"/> 
-                    </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeGenericFuncDesc5"/> 
-                    </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeGenericFuncDesc4"/> 
-                    </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeGenericFuncDesc3"/> 
-                    </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeGenericFuncDesc2"/> 
-                    </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeGenericFuncDesc1"/> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
+                      </void> 
+                      <void property="value"> 
+                       <double>3.0</double> 
+                      </void> 
+                     </object> 
                     </void> 
                     <void method="add"> 
-                     <object idref="ExprNodeGenericFuncDesc0"/> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
+                      </void> 
+                      <void property="value"> 
+                       <double>2.0</double> 
+                      </void> 
+                     </object> 
                     </void> 
                    </object> 
                   </void> 
-                  <void property="outputColumnNames"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <string>_col0</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col1</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col2</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col3</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col4</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col5</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col6</string> 
-                    </void> 
-                   </object> 
+                  <void property="genericUDF"> 
+                   <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPPlus"/> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="operatorId"> 
-                 <string>SEL_2</string> 
-                </void> 
-                <void property="parentOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object idref="FilterOperator0"/> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo1"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
+                <void method="put"> 
+                 <string>_col2</string> 
+                 <object id="ExprNodeGenericFuncDesc4" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                  <void property="children"> 
                    <object class="java.util.ArrayList"> 
                     <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="alias"> 
-                       <string>_c0</string> 
-                      </void> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="type"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
-                      <void property="typeName"> 
-                       <string>int</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="alias"> 
-                       <string>_c1</string> 
-                      </void> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo1"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>double</string> 
+                      <void property="value"> 
+                       <int>3</int> 
                       </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="alias"> 
-                       <string>_c2</string> 
-                      </void> 
-                      <void property="internalName"> 
-                       <string>_col2</string> 
-                      </void> 
-                      <void property="type"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
                        <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
-                      <void property="typeName"> 
-                       <string>double</string> 
+                      <void property="value"> 
+                       <double>2.0</double> 
                       </void> 
                      </object> 
                     </void> 
+                   </object> 
+                  </void> 
+                  <void property="genericUDF"> 
+                   <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPPlus"/> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo1"/> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void method="put"> 
+                 <string>_col1</string> 
+                 <object id="ExprNodeGenericFuncDesc5" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                  <void property="children"> 
+                   <object class="java.util.ArrayList"> 
                     <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="alias"> 
-                       <string>_c3</string> 
-                      </void> 
-                      <void property="internalName"> 
-                       <string>_col3</string> 
-                      </void> 
-                      <void property="type"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
                        <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
-                      <void property="typeName"> 
-                       <string>double</string> 
+                      <void property="value"> 
+                       <double>3.0</double> 
                       </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="alias"> 
-                       <string>_c4</string> 
-                      </void> 
-                      <void property="internalName"> 
-                       <string>_col4</string> 
-                      </void> 
-                      <void property="type"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
-                      <void property="typeName"> 
-                       <string>int</string> 
+                      <void property="value"> 
+                       <int>2</int> 
                       </void> 
                      </object> 
                     </void> 
+                   </object> 
+                  </void> 
+                  <void property="genericUDF"> 
+                   <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPPlus"/> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo1"/> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void method="put"> 
+                 <string>_col0</string> 
+                 <object id="ExprNodeGenericFuncDesc6" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                  <void property="children"> 
+                   <object class="java.util.ArrayList"> 
                     <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="alias"> 
-                       <string>_c5</string> 
-                      </void> 
-                      <void property="internalName"> 
-                       <string>_col5</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo2"/> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
-                      <void property="typeName"> 
-                       <string>boolean</string> 
+                      <void property="value"> 
+                       <int>3</int> 
                       </void> 
                      </object> 
                     </void> 
                     <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="alias"> 
-                       <string>_c6</string> 
-                      </void> 
-                      <void property="internalName"> 
-                       <string>_col6</string> 
-                      </void> 
-                      <void property="type"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
                        <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
-                      <void property="typeName"> 
-                       <string>int</string> 
+                      <void property="value"> 
+                       <int>2</int> 
                       </void> 
                      </object> 
                     </void> 
                    </object> 
                   </void> 
+                  <void property="genericUDF"> 
+                   <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPPlus"/> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
                  </object> 
                 </void> 
                </object> 
               </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-              <void property="predicate"> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                <void property="colList"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object idref="ExprNodeGenericFuncDesc6"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object idref="ExprNodeGenericFuncDesc5"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object idref="ExprNodeGenericFuncDesc4"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object idref="ExprNodeGenericFuncDesc3"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object idref="ExprNodeGenericFuncDesc2"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object idref="ExprNodeGenericFuncDesc1"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object idref="ExprNodeGenericFuncDesc0"/> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="outputColumnNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>key</string> 
+                   <string>_col0</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col1</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col2</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col3</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col4</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col5</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col6</string> 
+                  </void> 
+                 </object> 
+                </void> 
+               </object> 
+              </void> 
+              <void property="operatorId"> 
+               <string>SEL_2</string> 
+              </void> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="FilterOperator0"/> 
+               </void> 
+              </void> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="alias"> 
+                     <string>_c0</string> 
+                    </void> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
                     </void> 
-                    <void property="tabAlias"> 
-                     <string>src</string> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object id="PrimitiveTypeInfo3" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
+                    <void property="typeName"> 
+                     <string>int</string> 
                     </void> 
                    </object> 
                   </void> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="alias"> 
+                     <string>_c1</string> 
+                    </void> 
+                    <void property="internalName"> 
+                     <string>_col1</string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo1"/> 
                     </void> 
-                    <void property="value"> 
-                     <int>86</int> 
+                    <void property="typeName"> 
+                     <string>double</string> 
                     </void> 
                    </object> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo2"/> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="operatorId"> 
-             <string>FIL_4</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator0"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>key</string> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="alias"> 
+                     <string>_c2</string> 
+                    </void> 
+                    <void property="internalName"> 
+                     <string>_col2</string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo1"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>double</string> 
+                    </void> 
+                   </object> 
                   </void> 
-                  <void property="tabAlias"> 
-                   <string>src</string> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="alias"> 
+                     <string>_c3</string> 
+                    </void> 
+                    <void property="internalName"> 
+                     <string>_col3</string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo1"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>double</string> 
+                    </void> 
+                   </object> 
                   </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo3"/> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="alias"> 
+                     <string>_c4</string> 
+                    </void> 
+                    <void property="internalName"> 
+                     <string>_col4</string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>int</string> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="alias"> 
+                     <string>_c5</string> 
+                    </void> 
+                    <void property="internalName"> 
+                     <string>_col5</string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo2"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>boolean</string> 
+                    </void> 
+                   </object> 
                   </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="alias"> 
+                     <string>_c6</string> 
+                    </void> 
+                    <void property="internalName"> 
+                     <string>_col6</string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>int</string> 
+                    </void> 
+                   </object> 
                   </void> 
                  </object> 
                 </void> 
@@ -898,9 +809,86 @@
               </void> 
              </object> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
+             <void property="predicate"> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                   <void property="column"> 
+                    <string>key</string> 
+                   </void> 
+                   <void property="tabAlias"> 
+                    <string>src</string> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object id="PrimitiveTypeInfo3" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                     <void property="typeName"> 
+                      <string>string</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo0"/> 
+                   </void> 
+                   <void property="value"> 
+                    <int>86</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo2"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>FIL_4</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator0"/> 
+            </void> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>key</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo3"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
diff --git a/ql/src/test/results/compiler/plan/groupby1.q.xml b/ql/src/test/results/compiler/plan/groupby1.q.xml
index 185666f30c..9b01919a0f 100755
--- a/ql/src/test/results/compiler/plan/groupby1.q.xml
+++ b/ql/src/test/results/compiler/plan/groupby1.q.xml
@@ -297,553 +297,376 @@
        <string>src</string> 
        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="GroupByOperator0" class="org.apache.hadoop.hive.ql.exec.GroupByOperator"> 
-                <void property="childOperators"> 
-                 <object class="java.util.ArrayList"> 
+         <void method="add"> 
+          <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object id="GroupByOperator0" class="org.apache.hadoop.hive.ql.exec.GroupByOperator"> 
+              <void property="childOperators"> 
+               <void method="add"> 
+                <object id="ReduceSinkOperator0" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
+                 <void property="columnExprMap"> 
+                  <object class="java.util.HashMap"> 
+                   <void method="put"> 
+                    <string>KEY._col0</string> 
+                    <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                     <void property="column"> 
+                      <string>_col0</string> 
+                     </void> 
+                     <void property="tabAlias"> 
+                      <string></string> 
+                     </void> 
+                     <void property="typeInfo"> 
+                      <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void method="put"> 
+                    <string>VALUE._col0</string> 
+                    <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                     <void property="column"> 
+                      <string>_col1</string> 
+                     </void> 
+                     <void property="tabAlias"> 
+                      <string></string> 
+                     </void> 
+                     <void property="typeInfo"> 
+                      <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                       <void property="typeName"> 
+                        <string>double</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="conf"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
+                   <void property="distinctColumnIndices"> 
+                    <object class="java.util.ArrayList"/> 
+                   </void> 
+                   <void property="keyCols"> 
+                    <object id="ArrayList0" class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object idref="ExprNodeColumnDesc0"/> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="keySerializeInfo"> 
+                    <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                     <void property="inputFileFormatClass"> 
+                      <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                     </void> 
+                     <void property="outputFileFormatClass"> 
+                      <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                     </void> 
+                     <void property="properties"> 
+                      <object class="java.util.Properties"> 
+                       <void method="put"> 
+                        <string>columns</string> 
+                        <string>_col0</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.lib</string> 
+                        <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.sort.order</string> 
+                        <string>+</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns.types</string> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="numDistributionKeys"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="numReducers"> 
+                    <int>-1</int> 
+                   </void> 
+                   <void property="outputKeyColumnNames"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <string>_col0</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="outputValueColumnNames"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <string>_col0</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="partitionCols"> 
+                    <object idref="ArrayList0"/> 
+                   </void> 
+                   <void property="tag"> 
+                    <int>-1</int> 
+                   </void> 
+                   <void property="valueCols"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object idref="ExprNodeColumnDesc1"/> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="valueSerializeInfo"> 
+                    <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                     <void property="inputFileFormatClass"> 
+                      <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                     </void> 
+                     <void property="outputFileFormatClass"> 
+                      <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                     </void> 
+                     <void property="properties"> 
+                      <object class="java.util.Properties"> 
+                       <void method="put"> 
+                        <string>columns</string> 
+                        <string>_col0</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.lib</string> 
+                        <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns.types</string> 
+                        <string>double</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>escape.delim</string> 
+                        <string>\</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="operatorId"> 
+                  <string>RS_3</string> 
+                 </void> 
+                 <void property="parentOperators"> 
                   <void method="add"> 
-                   <object id="ReduceSinkOperator0" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
-                    <void property="columnExprMap"> 
-                     <object class="java.util.HashMap"> 
-                      <void method="put"> 
-                       <string>KEY._col0</string> 
-                       <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string></string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="put"> 
-                       <string>VALUE._col0</string> 
-                       <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>_col1</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string></string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>double</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
-                      <void property="distinctColumnIndices"> 
-                       <object class="java.util.ArrayList"/> 
-                      </void> 
-                      <void property="keyCols"> 
-                       <object id="ArrayList0" class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="keySerializeInfo"> 
-                       <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                        <void property="inputFileFormatClass"> 
-                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                        </void> 
-                        <void property="outputFileFormatClass"> 
-                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                        </void> 
-                        <void property="properties"> 
-                         <object class="java.util.Properties"> 
-                          <void method="put"> 
-                           <string>columns</string> 
-                           <string>_col0</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.lib</string> 
-                           <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.sort.order</string> 
-                           <string>+</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns.types</string> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="numDistributionKeys"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="numReducers"> 
-                       <int>-1</int> 
-                      </void> 
-                      <void property="outputKeyColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>_col0</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="outputValueColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>_col0</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="partitionCols"> 
-                       <object idref="ArrayList0"/> 
-                      </void> 
-                      <void property="tag"> 
-                       <int>-1</int> 
-                      </void> 
-                      <void property="valueCols"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc1"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="valueSerializeInfo"> 
-                       <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                        <void property="inputFileFormatClass"> 
-                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                        </void> 
-                        <void property="outputFileFormatClass"> 
-                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                        </void> 
-                        <void property="properties"> 
-                         <object class="java.util.Properties"> 
-                          <void method="put"> 
-                           <string>columns</string> 
-                           <string>_col0</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.lib</string> 
-                           <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns.types</string> 
-                           <string>double</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>escape.delim</string> 
-                           <string>\</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="operatorId"> 
-                     <string>RS_3</string> 
-                    </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="GroupByOperator0"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="schema"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                      <void property="signature"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>KEY._col0</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>VALUE._col0</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo1"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>double</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                   <object idref="GroupByOperator0"/> 
+                  </void> 
+                 </void> 
+                 <void property="schema"> 
+                  <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                   <void property="signature"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>KEY._col0</string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>VALUE._col0</string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo1"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>double</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+              </void> 
+              <void property="columnExprMap"> 
+               <object class="java.util.HashMap"> 
+                <void method="put"> 
+                 <string>_col0</string> 
+                 <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>key</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>src</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="columnExprMap"> 
-                 <object class="java.util.HashMap"> 
-                  <void method="put"> 
-                   <string>_col0</string> 
-                   <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>key</string> 
+               </object> 
+              </void> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.GroupByDesc"> 
+                <void property="aggregators"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.plan.AggregationDesc"> 
+                    <void property="genericUDAFEvaluatorClassName"> 
+                     <string>org.apache.hadoop.hive.ql.udf.generic.GenericUDAFSum$GenericUDAFSumDouble</string> 
                     </void> 
-                    <void property="tabAlias"> 
-                     <string>src</string> 
+                    <void property="genericUDAFName"> 
+                     <string>sum</string> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
+                    <void property="mode"> 
+                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDAFEvaluator$Mode" method="valueOf"> 
+                      <string>PARTIAL1</string> 
+                     </object> 
                     </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.GroupByDesc"> 
-                  <void property="aggregators"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.AggregationDesc"> 
-                      <void property="genericUDAFEvaluatorClassName"> 
-                       <string>org.apache.hadoop.hive.ql.udf.generic.GenericUDAFSum$GenericUDAFSumDouble</string> 
-                      </void> 
-                      <void property="genericUDAFName"> 
-                       <string>sum</string> 
-                      </void> 
-                      <void property="mode"> 
-                       <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDAFEvaluator$Mode" method="valueOf"> 
-                        <string>PARTIAL1</string> 
-                       </object> 
-                      </void> 
-                      <void property="parameters"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                          <void property="children"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                              <void property="column"> 
-                               <string>value</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string>src</string> 
-                              </void> 
-                              <void property="typeInfo"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
+                    <void property="parameters"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                        <void property="children"> 
+                         <object class="java.util.ArrayList"> 
+                          <void method="add"> 
+                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                            <void property="column"> 
+                             <string>value</string> 
                             </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                              <void property="typeInfo"> 
-                               <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                                <void property="typeName"> 
-                                 <string>int</string> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void property="value"> 
-                               <int>5</int> 
-                              </void> 
-                             </object> 
+                            <void property="tabAlias"> 
+                             <string>src</string> 
+                            </void> 
+                            <void property="typeInfo"> 
+                             <object idref="PrimitiveTypeInfo0"/> 
                             </void> 
                            </object> 
                           </void> 
-                          <void property="genericUDF"> 
-                           <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                            <void property="udfClassName"> 
-                             <string>org.apache.hadoop.hive.ql.udf.UDFSubstr</string> 
+                          <void method="add"> 
+                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                            <void property="typeInfo"> 
+                             <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                              <void property="typeName"> 
+                               <string>int</string> 
+                              </void> 
+                             </object> 
                             </void> 
-                            <void property="udfName"> 
-                             <string>substr</string> 
+                            <void property="value"> 
+                             <int>5</int> 
                             </void> 
                            </object> 
                           </void> 
-                          <void property="typeInfo"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
+                         </object> 
+                        </void> 
+                        <void property="genericUDF"> 
+                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                          <void property="udfClassName"> 
+                           <string>org.apache.hadoop.hive.ql.udf.UDFSubstr</string> 
+                          </void> 
+                          <void property="udfName"> 
+                           <string>substr</string> 
                           </void> 
                          </object> 
                         </void> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo0"/> 
+                        </void> 
                        </object> 
                       </void> 
                      </object> 
                     </void> 
                    </object> 
                   </void> 
-                  <void property="groupByMemoryUsage"> 
-                   <float>0.5</float> 
-                  </void> 
-                  <void property="groupingSetPosition"> 
-                   <int>1</int> 
-                  </void> 
-                  <void property="keys"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc2"/> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void property="listGroupingSets"> 
-                   <object id="ArrayList1" class="java.util.ArrayList"/> 
-                  </void> 
-                  <void property="memoryThreshold"> 
-                   <float>0.9</float> 
-                  </void> 
-                  <void property="mode"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.GroupByDesc$Mode" method="valueOf"> 
-                    <string>HASH</string> 
-                   </object> 
-                  </void> 
-                  <void property="outputColumnNames"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <string>_col0</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col1</string> 
-                    </void> 
-                   </object> 
-                  </void> 
                  </object> 
                 </void> 
-                <void property="operatorId"> 
-                 <string>GBY_2</string> 
+                <void property="groupByMemoryUsage"> 
+                 <float>0.5</float> 
+                </void> 
+                <void property="groupingSetPosition"> 
+                 <int>1</int> 
                 </void> 
-                <void property="parentOperators"> 
+                <void property="keys"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object idref="SelectOperator0"/> 
+                   <object idref="ExprNodeColumnDesc2"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo1"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>double</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="columnExprMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>BLOCK__OFFSET__INSIDE__FILE</string> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>BLOCK__OFFSET__INSIDE__FILE</string> 
-                </void> 
-                <void property="isPartitionColOrVirtualCol"> 
-                 <boolean>true</boolean> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string>src</string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                  <void property="typeName"> 
-                   <string>bigint</string> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>INPUT__FILE__NAME</string> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>INPUT__FILE__NAME</string> 
-                </void> 
-                <void property="isPartitionColOrVirtualCol"> 
-                 <boolean>true</boolean> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string>src</string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>value</string> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>value</string> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string>src</string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>key</string> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>key</string> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string>src</string> 
+                <void property="listGroupingSets"> 
+                 <object id="ArrayList1" class="java.util.ArrayList"/> 
                 </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
+                <void property="memoryThreshold"> 
+                 <float>0.9</float> 
                 </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-              <void property="colList"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                  <void property="column"> 
-                   <string>key</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src</string> 
-                  </void> 
-                  <void property="typeInfo"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
+                <void property="mode"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.GroupByDesc$Mode" method="valueOf"> 
+                  <string>HASH</string> 
                  </object> 
                 </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                  <void property="column"> 
-                   <string>value</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src</string> 
+                <void property="outputColumnNames"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <string>_col0</string> 
                   </void> 
-                  <void property="typeInfo"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
+                  <void method="add"> 
+                   <string>_col1</string> 
                   </void> 
                  </object> 
                 </void> 
                </object> 
               </void> 
-              <void property="outputColumnNames"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <string>key</string> 
-                </void> 
-                <void method="add"> 
-                 <string>value</string> 
-                </void> 
-               </object> 
-              </void> 
-              <void property="selectStar"> 
-               <boolean>true</boolean> 
+              <void property="operatorId"> 
+               <string>GBY_2</string> 
               </void> 
-             </object> 
-            </void> 
-            <void property="operatorId"> 
-             <string>SEL_1</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator0"/> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="SelectOperator0"/> 
+               </void> 
               </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>key</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>value</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
                   </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col1</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo1"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>double</string> 
+                    </void> 
+                   </object> 
                   </void> 
                  </object> 
                 </void> 
@@ -851,9 +674,174 @@
               </void> 
              </object> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="columnExprMap"> 
+            <object class="java.util.HashMap"> 
+             <void method="put"> 
+              <string>BLOCK__OFFSET__INSIDE__FILE</string> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>BLOCK__OFFSET__INSIDE__FILE</string> 
+               </void> 
+               <void property="isPartitionColOrVirtualCol"> 
+                <boolean>true</boolean> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>src</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                 <void property="typeName"> 
+                  <string>bigint</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>INPUT__FILE__NAME</string> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>INPUT__FILE__NAME</string> 
+               </void> 
+               <void property="isPartitionColOrVirtualCol"> 
+                <boolean>true</boolean> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>src</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>value</string> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>value</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>src</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>key</string> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>key</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>src</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+             <void property="colList"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                 <void property="column"> 
+                  <string>key</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src</string> 
+                 </void> 
+                 <void property="typeInfo"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                 <void property="column"> 
+                  <string>value</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src</string> 
+                 </void> 
+                 <void property="typeInfo"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="outputColumnNames"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <string>key</string> 
+               </void> 
+               <void method="add"> 
+                <string>value</string> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="selectStar"> 
+              <boolean>true</boolean> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>SEL_1</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator0"/> 
+            </void> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>key</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>value</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
@@ -1136,197 +1124,88 @@
       <void property="reducer"> 
        <object id="GroupByOperator1" class="org.apache.hadoop.hive.ql.exec.GroupByOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                  <void property="destTableId"> 
-                   <int>1</int> 
-                  </void> 
-                  <void property="dirName"> 
-                   #### A masked pattern was here #### 
-                  </void> 
-                  <void property="gatherStats"> 
-                   <boolean>true</boolean> 
-                  </void> 
-                  <void property="lbCtx"> 
-                   <object idref="ListBucketingCtx0"/> 
-                  </void> 
-                  <void property="maxStatsKeyPrefixLength"> 
-                   <int>150</int> 
-                  </void> 
-                  <void property="numFiles"> 
-                   <int>1</int> 
-                  </void> 
-                  <void property="statsAggPrefix"> 
-                   #### A masked pattern was here #### 
-                  </void> 
-                  <void property="statsCollectRawDataSize"> 
-                   <boolean>true</boolean> 
-                  </void> 
-                  <void property="tableInfo"> 
-                   <object idref="TableDesc0"/> 
-                  </void> 
-                  <void property="totalFiles"> 
-                   <int>1</int> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="operatorId"> 
-                 <string>FS_6</string> 
-                </void> 
-                <void property="parentOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object idref="SelectOperator1"/> 
-                  </void> 
-                 </object> 
+         <void method="add"> 
+          <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                <void property="destTableId"> 
+                 <int>1</int> 
                 </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>key</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>value</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
+                <void property="dirName"> 
+                 #### A masked pattern was here #### 
                 </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="columnExprMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>_col1</string> 
-               <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>_col1</string> 
+                <void property="gatherStats"> 
+                 <boolean>true</boolean> 
                 </void> 
-                <void property="tabAlias"> 
-                 <string></string> 
+                <void property="lbCtx"> 
+                 <object idref="ListBucketingCtx0"/> 
                 </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo1"/> 
+                <void property="maxStatsKeyPrefixLength"> 
+                 <int>150</int> 
                 </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>_col0</string> 
-               <object id="ExprNodeColumnDesc4" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>_col0</string> 
+                <void property="numFiles"> 
+                 <int>1</int> 
                 </void> 
-                <void property="tabAlias"> 
-                 <string></string> 
+                <void property="statsAggPrefix"> 
+                 #### A masked pattern was here #### 
                 </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
+                <void property="statsCollectRawDataSize"> 
+                 <boolean>true</boolean> 
                 </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-              <void property="colList"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object idref="ExprNodeColumnDesc4"/> 
+                <void property="tableInfo"> 
+                 <object idref="TableDesc0"/> 
                 </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeColumnDesc3"/> 
+                <void property="totalFiles"> 
+                 <int>1</int> 
                 </void> 
                </object> 
               </void> 
-              <void property="outputColumnNames"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <string>_col0</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col1</string> 
-                </void> 
-               </object> 
+              <void property="operatorId"> 
+               <string>FS_6</string> 
               </void> 
-             </object> 
-            </void> 
-            <void property="operatorId"> 
-             <string>SEL_5</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="GroupByOperator1"/> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="SelectOperator1"/> 
+               </void> 
               </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>_col0</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>_col1</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo1"/> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>key</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
                   </void> 
-                  <void property="typeName"> 
-                   <string>double</string> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>value</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
                   </void> 
                  </object> 
                 </void> 
@@ -1334,9 +1213,110 @@
               </void> 
              </object> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="columnExprMap"> 
+            <object class="java.util.HashMap"> 
+             <void method="put"> 
+              <string>_col1</string> 
+              <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>_col1</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string></string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo1"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col0</string> 
+              <object id="ExprNodeColumnDesc4" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>_col0</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string></string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+             <void property="colList"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object idref="ExprNodeColumnDesc4"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeColumnDesc3"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="outputColumnNames"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <string>_col0</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col1</string> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>SEL_5</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="GroupByOperator1"/> 
+            </void> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>_col0</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>_col1</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo1"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>double</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="columnExprMap"> 
          <object class="java.util.HashMap"> 
@@ -1425,11 +1405,9 @@
          <string>GBY_4</string> 
         </void> 
         <void property="parentOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object idref="ReduceSinkOperator0"/> 
-          </void> 
-         </object> 
+         <void method="add"> 
+          <object idref="ReduceSinkOperator0"/> 
+         </void> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
diff --git a/ql/src/test/results/compiler/plan/groupby2.q.xml b/ql/src/test/results/compiler/plan/groupby2.q.xml
index e9fee6ae69..905f5110aa 100755
--- a/ql/src/test/results/compiler/plan/groupby2.q.xml
+++ b/ql/src/test/results/compiler/plan/groupby2.q.xml
@@ -153,825 +153,652 @@
        <string>src</string> 
        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="GroupByOperator0" class="org.apache.hadoop.hive.ql.exec.GroupByOperator"> 
-                <void property="childOperators"> 
-                 <object class="java.util.ArrayList"> 
+         <void method="add"> 
+          <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object id="GroupByOperator0" class="org.apache.hadoop.hive.ql.exec.GroupByOperator"> 
+              <void property="childOperators"> 
+               <void method="add"> 
+                <object id="ReduceSinkOperator0" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
+                 <void property="columnExprMap"> 
+                  <object class="java.util.HashMap"> 
+                   <void method="put"> 
+                    <string>KEY._col0</string> 
+                    <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                     <void property="column"> 
+                      <string>_col0</string> 
+                     </void> 
+                     <void property="tabAlias"> 
+                      <string></string> 
+                     </void> 
+                     <void property="typeInfo"> 
+                      <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void method="put"> 
+                    <string>VALUE._col1</string> 
+                    <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                     <void property="column"> 
+                      <string>_col3</string> 
+                     </void> 
+                     <void property="tabAlias"> 
+                      <string></string> 
+                     </void> 
+                     <void property="typeInfo"> 
+                      <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                       <void property="typeName"> 
+                        <string>double</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void method="put"> 
+                    <string>KEY._col1:0._col0</string> 
+                    <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                     <void property="column"> 
+                      <string>_col1</string> 
+                     </void> 
+                     <void property="tabAlias"> 
+                      <string></string> 
+                     </void> 
+                     <void property="typeInfo"> 
+                      <object idref="PrimitiveTypeInfo0"/> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void method="put"> 
+                    <string>VALUE._col0</string> 
+                    <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                     <void property="column"> 
+                      <string>_col2</string> 
+                     </void> 
+                     <void property="tabAlias"> 
+                      <string></string> 
+                     </void> 
+                     <void property="typeInfo"> 
+                      <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                       <void property="typeName"> 
+                        <string>bigint</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="conf"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
+                   <void property="distinctColumnIndices"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="java.util.ArrayList"> 
+                       <void method="add"> 
+                        <int>1</int> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="keyCols"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object idref="ExprNodeColumnDesc0"/> 
+                     </void> 
+                     <void method="add"> 
+                      <object idref="ExprNodeColumnDesc2"/> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="keySerializeInfo"> 
+                    <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                     <void property="inputFileFormatClass"> 
+                      <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                     </void> 
+                     <void property="outputFileFormatClass"> 
+                      <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                     </void> 
+                     <void property="properties"> 
+                      <object class="java.util.Properties"> 
+                       <void method="put"> 
+                        <string>columns</string> 
+                        <string>_col0,_col1</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.lib</string> 
+                        <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.sort.order</string> 
+                        <string>++</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns.types</string> 
+                        <string>string,uniontype&lt;struct&lt;_col0:string&gt;&gt;</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="numDistributionKeys"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="numReducers"> 
+                    <int>-1</int> 
+                   </void> 
+                   <void property="outputKeyColumnNames"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <string>_col0</string> 
+                     </void> 
+                     <void method="add"> 
+                      <string>_col1</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="outputValueColumnNames"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <string>_col0</string> 
+                     </void> 
+                     <void method="add"> 
+                      <string>_col1</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="partitionCols"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object idref="ExprNodeColumnDesc0"/> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="tag"> 
+                    <int>-1</int> 
+                   </void> 
+                   <void property="valueCols"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object idref="ExprNodeColumnDesc3"/> 
+                     </void> 
+                     <void method="add"> 
+                      <object idref="ExprNodeColumnDesc1"/> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="valueSerializeInfo"> 
+                    <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                     <void property="inputFileFormatClass"> 
+                      <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                     </void> 
+                     <void property="outputFileFormatClass"> 
+                      <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                     </void> 
+                     <void property="properties"> 
+                      <object class="java.util.Properties"> 
+                       <void method="put"> 
+                        <string>columns</string> 
+                        <string>_col0,_col1</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.lib</string> 
+                        <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns.types</string> 
+                        <string>bigint,double</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>escape.delim</string> 
+                        <string>\</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="operatorId"> 
+                  <string>RS_3</string> 
+                 </void> 
+                 <void property="parentOperators"> 
                   <void method="add"> 
-                   <object id="ReduceSinkOperator0" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
-                    <void property="columnExprMap"> 
-                     <object class="java.util.HashMap"> 
-                      <void method="put"> 
-                       <string>KEY._col0</string> 
-                       <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string></string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="put"> 
-                       <string>VALUE._col1</string> 
-                       <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>_col3</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string></string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>double</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
+                   <object idref="GroupByOperator0"/> 
+                  </void> 
+                 </void> 
+                 <void property="schema"> 
+                  <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                   <void property="signature"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>KEY._col0</string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>KEY._col1:0._col0</string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>VALUE._col0</string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo2"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>bigint</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>VALUE._col1</string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo1"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>double</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+              </void> 
+              <void property="columnExprMap"> 
+               <object class="java.util.HashMap"> 
+                <void method="put"> 
+                 <string>_col1</string> 
+                 <object id="ExprNodeGenericFuncDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                  <void property="children"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                      <void property="column"> 
+                       <string>value</string> 
                       </void> 
-                      <void method="put"> 
-                       <string>KEY._col1:0._col0</string> 
-                       <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>_col1</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string></string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
+                      <void property="tabAlias"> 
+                       <string>src</string> 
                       </void> 
-                      <void method="put"> 
-                       <string>VALUE._col0</string> 
-                       <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>_col2</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string></string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>bigint</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
-                      <void property="distinctColumnIndices"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <int>1</int> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="keyCols"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc0"/> 
-                        </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc2"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="keySerializeInfo"> 
-                       <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                        <void property="inputFileFormatClass"> 
-                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                        </void> 
-                        <void property="outputFileFormatClass"> 
-                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                        </void> 
-                        <void property="properties"> 
-                         <object class="java.util.Properties"> 
-                          <void method="put"> 
-                           <string>columns</string> 
-                           <string>_col0,_col1</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.lib</string> 
-                           <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.sort.order</string> 
-                           <string>++</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns.types</string> 
-                           <string>string,uniontype&lt;struct&lt;_col0:string&gt;&gt;</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="numDistributionKeys"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="numReducers"> 
-                       <int>-1</int> 
-                      </void> 
-                      <void property="outputKeyColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void method="add"> 
-                         <string>_col1</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="outputValueColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void method="add"> 
-                         <string>_col1</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="partitionCols"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc0"/> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
+                       <object id="PrimitiveTypeInfo3" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                        <void property="typeName"> 
+                         <string>int</string> 
                         </void> 
                        </object> 
                       </void> 
-                      <void property="tag"> 
-                       <int>-1</int> 
-                      </void> 
-                      <void property="valueCols"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc3"/> 
-                        </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc1"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="valueSerializeInfo"> 
-                       <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                        <void property="inputFileFormatClass"> 
-                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                        </void> 
-                        <void property="outputFileFormatClass"> 
-                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                        </void> 
-                        <void property="properties"> 
-                         <object class="java.util.Properties"> 
-                          <void method="put"> 
-                           <string>columns</string> 
-                           <string>_col0,_col1</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.lib</string> 
-                           <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns.types</string> 
-                           <string>bigint,double</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>escape.delim</string> 
-                           <string>\</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
+                      <void property="value"> 
+                       <int>5</int> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="operatorId"> 
-                     <string>RS_3</string> 
+                   </object> 
+                  </void> 
+                  <void property="genericUDF"> 
+                   <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                    <void property="udfClassName"> 
+                     <string>org.apache.hadoop.hive.ql.udf.UDFSubstr</string> 
                     </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="GroupByOperator0"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="schema"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                      <void property="signature"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>KEY._col0</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>KEY._col1:0._col0</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>VALUE._col0</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo2"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>bigint</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>VALUE._col1</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo1"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>double</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                    <void property="udfName"> 
+                     <string>substr</string> 
                     </void> 
                    </object> 
                   </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
                  </object> 
                 </void> 
-                <void property="columnExprMap"> 
-                 <object class="java.util.HashMap"> 
-                  <void method="put"> 
-                   <string>_col1</string> 
-                   <object id="ExprNodeGenericFuncDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>value</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo3" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>int</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="value"> 
-                         <int>5</int> 
-                        </void> 
-                       </object> 
+                <void method="put"> 
+                 <string>_col0</string> 
+                 <object id="ExprNodeGenericFuncDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                  <void property="children"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                      <void property="column"> 
+                       <string>key</string> 
                       </void> 
-                     </object> 
-                    </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                      <void property="udfClassName"> 
-                       <string>org.apache.hadoop.hive.ql.udf.UDFSubstr</string> 
+                      <void property="tabAlias"> 
+                       <string>src</string> 
                       </void> 
-                      <void property="udfName"> 
-                       <string>substr</string> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void method="put"> 
-                   <string>_col0</string> 
-                   <object id="ExprNodeGenericFuncDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo3"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>1</int> 
-                        </void> 
-                       </object> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo3"/> 
                       </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo3"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>1</int> 
-                        </void> 
-                       </object> 
+                      <void property="value"> 
+                       <int>1</int> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                      <void property="udfClassName"> 
-                       <string>org.apache.hadoop.hive.ql.udf.UDFSubstr</string> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo3"/> 
                       </void> 
-                      <void property="udfName"> 
-                       <string>substr</string> 
+                      <void property="value"> 
+                       <int>1</int> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
+                   </object> 
+                  </void> 
+                  <void property="genericUDF"> 
+                   <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                    <void property="udfClassName"> 
+                     <string>org.apache.hadoop.hive.ql.udf.UDFSubstr</string> 
+                    </void> 
+                    <void property="udfName"> 
+                     <string>substr</string> 
                     </void> 
                    </object> 
                   </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.GroupByDesc"> 
-                  <void property="aggregators"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.AggregationDesc"> 
-                      <void property="distinct"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="genericUDAFEvaluatorClassName"> 
-                       <string>org.apache.hadoop.hive.ql.udf.generic.GenericUDAFCount$GenericUDAFCountEvaluator</string> 
-                      </void> 
-                      <void property="genericUDAFName"> 
-                       <string>count</string> 
-                      </void> 
-                      <void property="mode"> 
-                       <object id="GenericUDAFEvaluator$Mode0" class="org.apache.hadoop.hive.ql.udf.generic.GenericUDAFEvaluator$Mode" method="valueOf"> 
-                        <string>PARTIAL1</string> 
-                       </object> 
-                      </void> 
-                      <void property="parameters"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                          <void property="children"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                              <void property="column"> 
-                               <string>value</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string>src</string> 
-                              </void> 
-                              <void property="typeInfo"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
+               </object> 
+              </void> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.GroupByDesc"> 
+                <void property="aggregators"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.plan.AggregationDesc"> 
+                    <void property="distinct"> 
+                     <boolean>true</boolean> 
+                    </void> 
+                    <void property="genericUDAFEvaluatorClassName"> 
+                     <string>org.apache.hadoop.hive.ql.udf.generic.GenericUDAFCount$GenericUDAFCountEvaluator</string> 
+                    </void> 
+                    <void property="genericUDAFName"> 
+                     <string>count</string> 
+                    </void> 
+                    <void property="mode"> 
+                     <object id="GenericUDAFEvaluator$Mode0" class="org.apache.hadoop.hive.ql.udf.generic.GenericUDAFEvaluator$Mode" method="valueOf"> 
+                      <string>PARTIAL1</string> 
+                     </object> 
+                    </void> 
+                    <void property="parameters"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                        <void property="children"> 
+                         <object class="java.util.ArrayList"> 
+                          <void method="add"> 
+                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                            <void property="column"> 
+                             <string>value</string> 
+                            </void> 
+                            <void property="tabAlias"> 
+                             <string>src</string> 
                             </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                              <void property="typeInfo"> 
-                               <object idref="PrimitiveTypeInfo3"/> 
-                              </void> 
-                              <void property="value"> 
-                               <int>5</int> 
-                              </void> 
-                             </object> 
+                            <void property="typeInfo"> 
+                             <object idref="PrimitiveTypeInfo0"/> 
                             </void> 
                            </object> 
                           </void> 
-                          <void property="genericUDF"> 
-                           <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                            <void property="udfClassName"> 
-                             <string>org.apache.hadoop.hive.ql.udf.UDFSubstr</string> 
+                          <void method="add"> 
+                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                            <void property="typeInfo"> 
+                             <object idref="PrimitiveTypeInfo3"/> 
                             </void> 
-                            <void property="udfName"> 
-                             <string>substr</string> 
+                            <void property="value"> 
+                             <int>5</int> 
                             </void> 
                            </object> 
                           </void> 
-                          <void property="typeInfo"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
+                         </object> 
+                        </void> 
+                        <void property="genericUDF"> 
+                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                          <void property="udfClassName"> 
+                           <string>org.apache.hadoop.hive.ql.udf.UDFSubstr</string> 
+                          </void> 
+                          <void property="udfName"> 
+                           <string>substr</string> 
                           </void> 
                          </object> 
                         </void> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo0"/> 
+                        </void> 
                        </object> 
                       </void> 
                      </object> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.AggregationDesc"> 
-                      <void property="genericUDAFEvaluatorClassName"> 
-                       <string>org.apache.hadoop.hive.ql.udf.generic.GenericUDAFSum$GenericUDAFSumDouble</string> 
-                      </void> 
-                      <void property="genericUDAFName"> 
-                       <string>sum</string> 
-                      </void> 
-                      <void property="mode"> 
-                       <object idref="GenericUDAFEvaluator$Mode0"/> 
-                      </void> 
-                      <void property="parameters"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                          <void property="children"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                              <void property="column"> 
-                               <string>value</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string>src</string> 
-                              </void> 
-                              <void property="typeInfo"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
+                   </object> 
+                  </void> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.plan.AggregationDesc"> 
+                    <void property="genericUDAFEvaluatorClassName"> 
+                     <string>org.apache.hadoop.hive.ql.udf.generic.GenericUDAFSum$GenericUDAFSumDouble</string> 
+                    </void> 
+                    <void property="genericUDAFName"> 
+                     <string>sum</string> 
+                    </void> 
+                    <void property="mode"> 
+                     <object idref="GenericUDAFEvaluator$Mode0"/> 
+                    </void> 
+                    <void property="parameters"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                        <void property="children"> 
+                         <object class="java.util.ArrayList"> 
+                          <void method="add"> 
+                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                            <void property="column"> 
+                             <string>value</string> 
+                            </void> 
+                            <void property="tabAlias"> 
+                             <string>src</string> 
                             </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                              <void property="typeInfo"> 
-                               <object idref="PrimitiveTypeInfo3"/> 
-                              </void> 
-                              <void property="value"> 
-                               <int>5</int> 
-                              </void> 
-                             </object> 
+                            <void property="typeInfo"> 
+                             <object idref="PrimitiveTypeInfo0"/> 
                             </void> 
                            </object> 
                           </void> 
-                          <void property="genericUDF"> 
-                           <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                            <void property="udfClassName"> 
-                             <string>org.apache.hadoop.hive.ql.udf.UDFSubstr</string> 
+                          <void method="add"> 
+                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                            <void property="typeInfo"> 
+                             <object idref="PrimitiveTypeInfo3"/> 
                             </void> 
-                            <void property="udfName"> 
-                             <string>substr</string> 
+                            <void property="value"> 
+                             <int>5</int> 
                             </void> 
                            </object> 
                           </void> 
-                          <void property="typeInfo"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
+                         </object> 
+                        </void> 
+                        <void property="genericUDF"> 
+                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                          <void property="udfClassName"> 
+                           <string>org.apache.hadoop.hive.ql.udf.UDFSubstr</string> 
+                          </void> 
+                          <void property="udfName"> 
+                           <string>substr</string> 
                           </void> 
                          </object> 
                         </void> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo0"/> 
+                        </void> 
                        </object> 
                       </void> 
                      </object> 
                     </void> 
                    </object> 
                   </void> 
-                  <void property="distinct"> 
-                   <boolean>true</boolean> 
-                  </void> 
-                  <void property="groupByMemoryUsage"> 
-                   <float>0.5</float> 
-                  </void> 
-                  <void property="groupingSetPosition"> 
-                   <int>1</int> 
-                  </void> 
-                  <void property="keys"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="ExprNodeGenericFuncDesc1"/> 
-                    </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeGenericFuncDesc0"/> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void property="listGroupingSets"> 
-                   <object id="ArrayList0" class="java.util.ArrayList"/> 
-                  </void> 
-                  <void property="memoryThreshold"> 
-                   <float>0.9</float> 
-                  </void> 
-                  <void property="mode"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.GroupByDesc$Mode" method="valueOf"> 
-                    <string>HASH</string> 
-                   </object> 
-                  </void> 
-                  <void property="outputColumnNames"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <string>_col0</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col1</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col2</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col3</string> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="operatorId"> 
-                 <string>GBY_2</string> 
-                </void> 
-                <void property="parentOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object idref="SelectOperator0"/> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col2</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo2"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>bigint</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col3</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo1"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>double</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
-                  </void> 
                  </object> 
                 </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="columnExprMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>BLOCK__OFFSET__INSIDE__FILE</string> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>BLOCK__OFFSET__INSIDE__FILE</string> 
-                </void> 
-                <void property="isPartitionColOrVirtualCol"> 
-                 <boolean>true</boolean> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string>src</string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo2"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>INPUT__FILE__NAME</string> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>INPUT__FILE__NAME</string> 
-                </void> 
-                <void property="isPartitionColOrVirtualCol"> 
-                 <boolean>true</boolean> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string>src</string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>value</string> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>value</string> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string>src</string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>key</string> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>key</string> 
+                <void property="distinct"> 
+                 <boolean>true</boolean> 
                 </void> 
-                <void property="tabAlias"> 
-                 <string>src</string> 
+                <void property="groupByMemoryUsage"> 
+                 <float>0.5</float> 
                 </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
+                <void property="groupingSetPosition"> 
+                 <int>1</int> 
                 </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-              <void property="colList"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                  <void property="column"> 
-                   <string>key</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src</string> 
+                <void property="keys"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object idref="ExprNodeGenericFuncDesc1"/> 
                   </void> 
-                  <void property="typeInfo"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
+                  <void method="add"> 
+                   <object idref="ExprNodeGenericFuncDesc0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                  <void property="column"> 
-                   <string>value</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src</string> 
-                  </void> 
-                  <void property="typeInfo"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                 </object> 
+                <void property="listGroupingSets"> 
+                 <object id="ArrayList0" class="java.util.ArrayList"/> 
                 </void> 
-               </object> 
-              </void> 
-              <void property="outputColumnNames"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <string>key</string> 
+                <void property="memoryThreshold"> 
+                 <float>0.9</float> 
                 </void> 
-                <void method="add"> 
-                 <string>value</string> 
+                <void property="mode"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.GroupByDesc$Mode" method="valueOf"> 
+                  <string>HASH</string> 
+                 </object> 
                 </void> 
-               </object> 
-              </void> 
-              <void property="selectStar"> 
-               <boolean>true</boolean> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="operatorId"> 
-             <string>SEL_1</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator0"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>key</string> 
+                <void property="outputColumnNames"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <string>_col0</string> 
                   </void> 
-                  <void property="tabAlias"> 
-                   <string>src</string> 
+                  <void method="add"> 
+                   <string>_col1</string> 
                   </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
+                  <void method="add"> 
+                   <string>_col2</string> 
                   </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
+                  <void method="add"> 
+                   <string>_col3</string> 
                   </void> 
                  </object> 
                 </void> 
-                <void method="add"> 
-                 <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>value</string> 
+               </object> 
+              </void> 
+              <void property="operatorId"> 
+               <string>GBY_2</string> 
+              </void> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="SelectOperator0"/> 
+               </void> 
+              </void> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
                   </void> 
-                  <void property="tabAlias"> 
-                   <string>src</string> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col1</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
                   </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col2</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo2"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>bigint</string> 
+                    </void> 
+                   </object> 
                   </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col3</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo1"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>double</string> 
+                    </void> 
+                   </object> 
                   </void> 
                  </object> 
                 </void> 
@@ -979,9 +806,170 @@
               </void> 
              </object> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="columnExprMap"> 
+            <object class="java.util.HashMap"> 
+             <void method="put"> 
+              <string>BLOCK__OFFSET__INSIDE__FILE</string> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>BLOCK__OFFSET__INSIDE__FILE</string> 
+               </void> 
+               <void property="isPartitionColOrVirtualCol"> 
+                <boolean>true</boolean> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>src</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo2"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>INPUT__FILE__NAME</string> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>INPUT__FILE__NAME</string> 
+               </void> 
+               <void property="isPartitionColOrVirtualCol"> 
+                <boolean>true</boolean> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>src</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>value</string> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>value</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>src</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>key</string> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>key</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>src</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+             <void property="colList"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                 <void property="column"> 
+                  <string>key</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src</string> 
+                 </void> 
+                 <void property="typeInfo"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                 <void property="column"> 
+                  <string>value</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src</string> 
+                 </void> 
+                 <void property="typeInfo"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="outputColumnNames"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <string>key</string> 
+               </void> 
+               <void method="add"> 
+                <string>value</string> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="selectStar"> 
+              <boolean>true</boolean> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>SEL_1</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator0"/> 
+            </void> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>key</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>value</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
@@ -1258,312 +1246,304 @@
       <void property="reducer"> 
        <object id="GroupByOperator1" class="org.apache.hadoop.hive.ql.exec.GroupByOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                  <void property="dirName"> 
-                   #### A masked pattern was here #### 
-                  </void> 
-                  <void property="numFiles"> 
-                   <int>1</int> 
-                  </void> 
-                  <void property="statsAggPrefix"> 
-                   #### A masked pattern was here #### 
+         <void method="add"> 
+          <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                <void property="dirName"> 
+                 #### A masked pattern was here #### 
+                </void> 
+                <void property="numFiles"> 
+                 <int>1</int> 
+                </void> 
+                <void property="statsAggPrefix"> 
+                 #### A masked pattern was here #### 
+                </void> 
+                <void property="statsCollectRawDataSize"> 
+                 <boolean>true</boolean> 
+                </void> 
+                <void property="tableInfo"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                  <void property="inputFileFormatClass"> 
+                   <class>org.apache.hadoop.mapred.TextInputFormat</class> 
                   </void> 
-                  <void property="statsCollectRawDataSize"> 
-                   <boolean>true</boolean> 
+                  <void property="outputFileFormatClass"> 
+                   <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
                   </void> 
-                  <void property="tableInfo"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                    <void property="inputFileFormatClass"> 
-                     <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                  <void property="properties"> 
+                   <object class="java.util.Properties"> 
+                    <void method="put"> 
+                     <string>hive.serialization.extend.nesting.levels</string> 
+                     <string>true</string> 
                     </void> 
-                    <void property="outputFileFormatClass"> 
-                     <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                    <void method="put"> 
+                     <string>columns</string> 
+                     <string>_col0,_col1,_col2</string> 
                     </void> 
-                    <void property="properties"> 
-                     <object class="java.util.Properties"> 
-                      <void method="put"> 
-                       <string>hive.serialization.extend.nesting.levels</string> 
-                       <string>true</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>columns</string> 
-                       <string>_col0,_col1,_col2</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.lib</string> 
-                       <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.format</string> 
-                       <string>1</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>columns.types</string> 
-                       <string>string:bigint:string</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>escape.delim</string> 
-                       <string>\</string> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>serialization.lib</string> 
+                     <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
                     </void> 
-                   </object> 
-                  </void> 
-                  <void property="totalFiles"> 
-                   <int>1</int> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="operatorId"> 
-                 <string>FS_6</string> 
-                </void> 
-                <void property="parentOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object idref="SelectOperator1"/> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>serialization.format</string> 
+                     <string>1</string> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo2"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>bigint</string> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>columns.types</string> 
+                     <string>string:bigint:string</string> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col2</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>escape.delim</string> 
+                     <string>\</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
+                <void property="totalFiles"> 
+                 <int>1</int> 
+                </void> 
                </object> 
               </void> 
-             </object> 
-            </void> 
-            <void property="columnExprMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>_col2</string> 
-               <object id="ExprNodeGenericFuncDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
+              <void property="operatorId"> 
+               <string>FS_6</string> 
+              </void> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="SelectOperator1"/> 
+               </void> 
+              </void> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
                      <string>_col0</string> 
                     </void> 
                     <void property="tabAlias"> 
                      <string></string> 
                     </void> 
-                    <void property="typeInfo"> 
+                    <void property="type"> 
                      <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col1</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo2"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>bigint</string> 
+                    </void> 
                    </object> 
                   </void> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
                      <string>_col2</string> 
                     </void> 
                     <void property="tabAlias"> 
                      <string></string> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFConcat"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>_col1</string> 
-               <object id="ExprNodeColumnDesc4" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>_col1</string> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string></string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo2"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>_col0</string> 
-               <object id="ExprNodeColumnDesc5" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>_col0</string> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string></string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
                </object> 
               </void> 
              </object> 
             </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-              <void property="colList"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object idref="ExprNodeColumnDesc5"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeColumnDesc4"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeGenericFuncDesc2"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void property="outputColumnNames"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <string>_col0</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col1</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col2</string> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="operatorId"> 
-             <string>SEL_5</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="GroupByOperator1"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>_c0</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col0</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>_c1</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col1</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo2"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>bigint</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>_c2</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col2</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
+           </void> 
+           <void property="columnExprMap"> 
+            <object class="java.util.HashMap"> 
+             <void method="put"> 
+              <string>_col2</string> 
+              <object id="ExprNodeGenericFuncDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                   <void property="column"> 
+                    <string>_col0</string> 
+                   </void> 
+                   <void property="tabAlias"> 
+                    <string></string> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo0"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                   <void property="column"> 
+                    <string>_col2</string> 
+                   </void> 
+                   <void property="tabAlias"> 
+                    <string></string> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo1"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFConcat"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col1</string> 
+              <object id="ExprNodeColumnDesc4" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>_col1</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string></string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo2"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col0</string> 
+              <object id="ExprNodeColumnDesc5" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>_col0</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string></string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+             <void property="colList"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object idref="ExprNodeColumnDesc5"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeColumnDesc4"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeGenericFuncDesc2"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="outputColumnNames"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <string>_col0</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col1</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col2</string> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>SEL_5</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="GroupByOperator1"/> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>_c0</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col0</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>_c1</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col1</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo2"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>bigint</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>_c2</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col2</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="columnExprMap"> 
          <object class="java.util.HashMap"> 
@@ -1690,11 +1670,9 @@
          <string>GBY_4</string> 
         </void> 
         <void property="parentOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object idref="ReduceSinkOperator0"/> 
-          </void> 
-         </object> 
+         <void method="add"> 
+          <object idref="ReduceSinkOperator0"/> 
+         </void> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
diff --git a/ql/src/test/results/compiler/plan/groupby3.q.xml b/ql/src/test/results/compiler/plan/groupby3.q.xml
index 18d7fc7939..fe44c46498 100644
--- a/ql/src/test/results/compiler/plan/groupby3.q.xml
+++ b/ql/src/test/results/compiler/plan/groupby3.q.xml
@@ -153,1033 +153,892 @@
        <string>src</string> 
        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="GroupByOperator0" class="org.apache.hadoop.hive.ql.exec.GroupByOperator"> 
-                <void property="childOperators"> 
-                 <object class="java.util.ArrayList"> 
+         <void method="add"> 
+          <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object id="GroupByOperator0" class="org.apache.hadoop.hive.ql.exec.GroupByOperator"> 
+              <void property="childOperators"> 
+               <void method="add"> 
+                <object id="ReduceSinkOperator0" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
+                 <void property="columnExprMap"> 
+                  <object class="java.util.HashMap"> 
+                   <void method="put"> 
+                    <string>VALUE._col4</string> 
+                    <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                     <void property="column"> 
+                      <string>_col5</string> 
+                     </void> 
+                     <void property="tabAlias"> 
+                      <string></string> 
+                     </void> 
+                     <void property="typeInfo"> 
+                      <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void method="put"> 
+                    <string>VALUE._col3</string> 
+                    <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                     <void property="column"> 
+                      <string>_col4</string> 
+                     </void> 
+                     <void property="tabAlias"> 
+                      <string></string> 
+                     </void> 
+                     <void property="typeInfo"> 
+                      <object idref="PrimitiveTypeInfo0"/> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void method="put"> 
+                    <string>VALUE._col2</string> 
+                    <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                     <void property="column"> 
+                      <string>_col3</string> 
+                     </void> 
+                     <void property="tabAlias"> 
+                      <string></string> 
+                     </void> 
+                     <void property="typeInfo"> 
+                      <object id="StructTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.StructTypeInfo"> 
+                       <void property="allStructFieldNames"> 
+                        <object class="java.util.ArrayList"> 
+                         <void method="add"> 
+                          <string>count</string> 
+                         </void> 
+                         <void method="add"> 
+                          <string>sum</string> 
+                         </void> 
+                        </object> 
+                       </void> 
+                       <void property="allStructFieldTypeInfos"> 
+                        <object class="java.util.ArrayList"> 
+                         <void method="add"> 
+                          <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                           <void property="typeName"> 
+                            <string>bigint</string> 
+                           </void> 
+                          </object> 
+                         </void> 
+                         <void method="add"> 
+                          <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                           <void property="typeName"> 
+                            <string>double</string> 
+                           </void> 
+                          </object> 
+                         </void> 
+                        </object> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void method="put"> 
+                    <string>VALUE._col1</string> 
+                    <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                     <void property="column"> 
+                      <string>_col2</string> 
+                     </void> 
+                     <void property="tabAlias"> 
+                      <string></string> 
+                     </void> 
+                     <void property="typeInfo"> 
+                      <object idref="StructTypeInfo0"/> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void method="put"> 
+                    <string>VALUE._col0</string> 
+                    <object id="ExprNodeColumnDesc4" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                     <void property="column"> 
+                      <string>_col1</string> 
+                     </void> 
+                     <void property="tabAlias"> 
+                      <string></string> 
+                     </void> 
+                     <void property="typeInfo"> 
+                      <object idref="PrimitiveTypeInfo2"/> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void method="put"> 
+                    <string>KEY._col0:0._col0</string> 
+                    <object id="ExprNodeColumnDesc5" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                     <void property="column"> 
+                      <string>_col0</string> 
+                     </void> 
+                     <void property="tabAlias"> 
+                      <string></string> 
+                     </void> 
+                     <void property="typeInfo"> 
+                      <object idref="PrimitiveTypeInfo0"/> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="conf"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
+                   <void property="distinctColumnIndices"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="java.util.ArrayList"> 
+                       <void method="add"> 
+                        <int>0</int> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="keyCols"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object idref="ExprNodeColumnDesc5"/> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="keySerializeInfo"> 
+                    <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                     <void property="inputFileFormatClass"> 
+                      <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                     </void> 
+                     <void property="outputFileFormatClass"> 
+                      <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                     </void> 
+                     <void property="properties"> 
+                      <object class="java.util.Properties"> 
+                       <void method="put"> 
+                        <string>columns</string> 
+                        <string>_col0</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.lib</string> 
+                        <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.sort.order</string> 
+                        <string>+</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns.types</string> 
+                        <string>uniontype&lt;struct&lt;_col0:string&gt;&gt;</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="numReducers"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="outputKeyColumnNames"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <string>_col0</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="outputValueColumnNames"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <string>_col0</string> 
+                     </void> 
+                     <void method="add"> 
+                      <string>_col1</string> 
+                     </void> 
+                     <void method="add"> 
+                      <string>_col2</string> 
+                     </void> 
+                     <void method="add"> 
+                      <string>_col3</string> 
+                     </void> 
+                     <void method="add"> 
+                      <string>_col4</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="partitionCols"> 
+                    <object class="java.util.ArrayList"/> 
+                   </void> 
+                   <void property="tag"> 
+                    <int>-1</int> 
+                   </void> 
+                   <void property="valueCols"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object idref="ExprNodeColumnDesc4"/> 
+                     </void> 
+                     <void method="add"> 
+                      <object idref="ExprNodeColumnDesc3"/> 
+                     </void> 
+                     <void method="add"> 
+                      <object idref="ExprNodeColumnDesc2"/> 
+                     </void> 
+                     <void method="add"> 
+                      <object idref="ExprNodeColumnDesc1"/> 
+                     </void> 
+                     <void method="add"> 
+                      <object idref="ExprNodeColumnDesc0"/> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="valueSerializeInfo"> 
+                    <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                     <void property="inputFileFormatClass"> 
+                      <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                     </void> 
+                     <void property="outputFileFormatClass"> 
+                      <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                     </void> 
+                     <void property="properties"> 
+                      <object class="java.util.Properties"> 
+                       <void method="put"> 
+                        <string>columns</string> 
+                        <string>_col0,_col1,_col2,_col3,_col4</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.lib</string> 
+                        <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns.types</string> 
+                        <string>double,struct&lt;count:bigint,sum:double&gt;,struct&lt;count:bigint,sum:double&gt;,string,string</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>escape.delim</string> 
+                        <string>\</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="operatorId"> 
+                  <string>RS_3</string> 
+                 </void> 
+                 <void property="parentOperators"> 
                   <void method="add"> 
-                   <object id="ReduceSinkOperator0" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
-                    <void property="columnExprMap"> 
-                     <object class="java.util.HashMap"> 
-                      <void method="put"> 
-                       <string>VALUE._col4</string> 
-                       <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>_col5</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string></string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="put"> 
-                       <string>VALUE._col3</string> 
-                       <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>_col4</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string></string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="put"> 
-                       <string>VALUE._col2</string> 
-                       <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>_col3</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string></string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object id="StructTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.StructTypeInfo"> 
-                          <void property="allStructFieldNames"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <string>count</string> 
-                            </void> 
-                            <void method="add"> 
-                             <string>sum</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="allStructFieldTypeInfos"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                              <void property="typeName"> 
-                               <string>bigint</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                              <void property="typeName"> 
-                               <string>double</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="put"> 
-                       <string>VALUE._col1</string> 
-                       <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>_col2</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string></string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="StructTypeInfo0"/> 
-                        </void> 
-                       </object> 
+                   <object idref="GroupByOperator0"/> 
+                  </void> 
+                 </void> 
+                 <void property="schema"> 
+                  <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                   <void property="signature"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>KEY._col0:0._col0</string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>VALUE._col0</string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo2"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>double</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>VALUE._col1</string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="StructTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>struct&lt;count:bigint,sum:double&gt;</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>VALUE._col2</string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="StructTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>struct&lt;count:bigint,sum:double&gt;</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>VALUE._col3</string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>VALUE._col4</string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+              </void> 
+              <void property="columnExprMap"> 
+               <object class="java.util.HashMap"> 
+                <void method="put"> 
+                 <string>_col0</string> 
+                 <object id="ExprNodeGenericFuncDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                  <void property="children"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                      <void property="column"> 
+                       <string>value</string> 
                       </void> 
-                      <void method="put"> 
-                       <string>VALUE._col0</string> 
-                       <object id="ExprNodeColumnDesc4" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>_col1</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string></string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo2"/> 
-                        </void> 
-                       </object> 
+                      <void property="tabAlias"> 
+                       <string>src</string> 
                       </void> 
-                      <void method="put"> 
-                       <string>KEY._col0:0._col0</string> 
-                       <object id="ExprNodeColumnDesc5" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string></string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
-                      <void property="distinctColumnIndices"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <int>0</int> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="keyCols"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc5"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="keySerializeInfo"> 
-                       <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                        <void property="inputFileFormatClass"> 
-                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                        </void> 
-                        <void property="outputFileFormatClass"> 
-                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                        </void> 
-                        <void property="properties"> 
-                         <object class="java.util.Properties"> 
-                          <void method="put"> 
-                           <string>columns</string> 
-                           <string>_col0</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.lib</string> 
-                           <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.sort.order</string> 
-                           <string>+</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns.types</string> 
-                           <string>uniontype&lt;struct&lt;_col0:string&gt;&gt;</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="numReducers"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="outputKeyColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>_col0</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="outputValueColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void method="add"> 
-                         <string>_col1</string> 
-                        </void> 
-                        <void method="add"> 
-                         <string>_col2</string> 
-                        </void> 
-                        <void method="add"> 
-                         <string>_col3</string> 
-                        </void> 
-                        <void method="add"> 
-                         <string>_col4</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="partitionCols"> 
-                       <object class="java.util.ArrayList"/> 
-                      </void> 
-                      <void property="tag"> 
-                       <int>-1</int> 
-                      </void> 
-                      <void property="valueCols"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc4"/> 
-                        </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc3"/> 
-                        </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc2"/> 
-                        </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc1"/> 
-                        </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc0"/> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
+                       <object id="PrimitiveTypeInfo3" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                        <void property="typeName"> 
+                         <string>int</string> 
                         </void> 
                        </object> 
                       </void> 
-                      <void property="valueSerializeInfo"> 
-                       <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                        <void property="inputFileFormatClass"> 
-                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                        </void> 
-                        <void property="outputFileFormatClass"> 
-                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                        </void> 
-                        <void property="properties"> 
-                         <object class="java.util.Properties"> 
-                          <void method="put"> 
-                           <string>columns</string> 
-                           <string>_col0,_col1,_col2,_col3,_col4</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.lib</string> 
-                           <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns.types</string> 
-                           <string>double,struct&lt;count:bigint,sum:double&gt;,struct&lt;count:bigint,sum:double&gt;,string,string</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>escape.delim</string> 
-                           <string>\</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
+                      <void property="value"> 
+                       <int>5</int> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="operatorId"> 
-                     <string>RS_3</string> 
-                    </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="GroupByOperator0"/> 
-                      </void> 
-                     </object> 
+                   </object> 
+                  </void> 
+                  <void property="genericUDF"> 
+                   <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                    <void property="udfClassName"> 
+                     <string>org.apache.hadoop.hive.ql.udf.UDFSubstr</string> 
                     </void> 
-                    <void property="schema"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                      <void property="signature"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>KEY._col0:0._col0</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>VALUE._col0</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo2"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>double</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>VALUE._col1</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="StructTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>struct&lt;count:bigint,sum:double&gt;</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>VALUE._col2</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="StructTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>struct&lt;count:bigint,sum:double&gt;</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>VALUE._col3</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>VALUE._col4</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                    <void property="udfName"> 
+                     <string>substr</string> 
                     </void> 
                    </object> 
                   </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
                  </object> 
                 </void> 
-                <void property="columnExprMap"> 
-                 <object class="java.util.HashMap"> 
-                  <void method="put"> 
-                   <string>_col0</string> 
-                   <object id="ExprNodeGenericFuncDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>value</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo3" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>int</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="value"> 
-                         <int>5</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+               </object> 
+              </void> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.GroupByDesc"> 
+                <void property="aggregators"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.plan.AggregationDesc"> 
+                    <void property="genericUDAFEvaluatorClassName"> 
+                     <string>org.apache.hadoop.hive.ql.udf.generic.GenericUDAFSum$GenericUDAFSumDouble</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                      <void property="udfClassName"> 
-                       <string>org.apache.hadoop.hive.ql.udf.UDFSubstr</string> 
-                      </void> 
-                      <void property="udfName"> 
-                       <string>substr</string> 
-                      </void> 
-                     </object> 
+                    <void property="genericUDAFName"> 
+                     <string>sum</string> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
+                    <void property="mode"> 
+                     <object id="GenericUDAFEvaluator$Mode0" class="org.apache.hadoop.hive.ql.udf.generic.GenericUDAFEvaluator$Mode" method="valueOf"> 
+                      <string>PARTIAL1</string> 
+                     </object> 
                     </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.GroupByDesc"> 
-                  <void property="aggregators"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.AggregationDesc"> 
-                      <void property="genericUDAFEvaluatorClassName"> 
-                       <string>org.apache.hadoop.hive.ql.udf.generic.GenericUDAFSum$GenericUDAFSumDouble</string> 
-                      </void> 
-                      <void property="genericUDAFName"> 
-                       <string>sum</string> 
-                      </void> 
-                      <void property="mode"> 
-                       <object id="GenericUDAFEvaluator$Mode0" class="org.apache.hadoop.hive.ql.udf.generic.GenericUDAFEvaluator$Mode" method="valueOf"> 
-                        <string>PARTIAL1</string> 
-                       </object> 
-                      </void> 
-                      <void property="parameters"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                          <void property="children"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                              <void property="column"> 
-                               <string>value</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string>src</string> 
-                              </void> 
-                              <void property="typeInfo"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
+                    <void property="parameters"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                        <void property="children"> 
+                         <object class="java.util.ArrayList"> 
+                          <void method="add"> 
+                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                            <void property="column"> 
+                             <string>value</string> 
                             </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                              <void property="typeInfo"> 
-                               <object idref="PrimitiveTypeInfo3"/> 
-                              </void> 
-                              <void property="value"> 
-                               <int>5</int> 
-                              </void> 
-                             </object> 
+                            <void property="tabAlias"> 
+                             <string>src</string> 
+                            </void> 
+                            <void property="typeInfo"> 
+                             <object idref="PrimitiveTypeInfo0"/> 
                             </void> 
                            </object> 
                           </void> 
-                          <void property="genericUDF"> 
-                           <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                            <void property="udfClassName"> 
-                             <string>org.apache.hadoop.hive.ql.udf.UDFSubstr</string> 
+                          <void method="add"> 
+                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                            <void property="typeInfo"> 
+                             <object idref="PrimitiveTypeInfo3"/> 
                             </void> 
-                            <void property="udfName"> 
-                             <string>substr</string> 
+                            <void property="value"> 
+                             <int>5</int> 
                             </void> 
                            </object> 
                           </void> 
-                          <void property="typeInfo"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
+                         </object> 
+                        </void> 
+                        <void property="genericUDF"> 
+                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                          <void property="udfClassName"> 
+                           <string>org.apache.hadoop.hive.ql.udf.UDFSubstr</string> 
+                          </void> 
+                          <void property="udfName"> 
+                           <string>substr</string> 
                           </void> 
                          </object> 
                         </void> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo0"/> 
+                        </void> 
                        </object> 
                       </void> 
                      </object> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.AggregationDesc"> 
-                      <void property="genericUDAFEvaluatorClassName"> 
-                       <string>org.apache.hadoop.hive.ql.udf.generic.GenericUDAFAverage$GenericUDAFAverageEvaluatorDouble</string> 
-                      </void> 
-                      <void property="genericUDAFName"> 
-                       <string>avg</string> 
-                      </void> 
-                      <void property="mode"> 
-                       <object idref="GenericUDAFEvaluator$Mode0"/> 
-                      </void> 
-                      <void property="parameters"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                          <void property="children"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                              <void property="column"> 
-                               <string>value</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string>src</string> 
-                              </void> 
-                              <void property="typeInfo"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
+                   </object> 
+                  </void> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.plan.AggregationDesc"> 
+                    <void property="genericUDAFEvaluatorClassName"> 
+                     <string>org.apache.hadoop.hive.ql.udf.generic.GenericUDAFAverage$GenericUDAFAverageEvaluatorDouble</string> 
+                    </void> 
+                    <void property="genericUDAFName"> 
+                     <string>avg</string> 
+                    </void> 
+                    <void property="mode"> 
+                     <object idref="GenericUDAFEvaluator$Mode0"/> 
+                    </void> 
+                    <void property="parameters"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                        <void property="children"> 
+                         <object class="java.util.ArrayList"> 
+                          <void method="add"> 
+                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                            <void property="column"> 
+                             <string>value</string> 
+                            </void> 
+                            <void property="tabAlias"> 
+                             <string>src</string> 
                             </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                              <void property="typeInfo"> 
-                               <object idref="PrimitiveTypeInfo3"/> 
-                              </void> 
-                              <void property="value"> 
-                               <int>5</int> 
-                              </void> 
-                             </object> 
+                            <void property="typeInfo"> 
+                             <object idref="PrimitiveTypeInfo0"/> 
                             </void> 
                            </object> 
                           </void> 
-                          <void property="genericUDF"> 
-                           <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                            <void property="udfClassName"> 
-                             <string>org.apache.hadoop.hive.ql.udf.UDFSubstr</string> 
+                          <void method="add"> 
+                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                            <void property="typeInfo"> 
+                             <object idref="PrimitiveTypeInfo3"/> 
                             </void> 
-                            <void property="udfName"> 
-                             <string>substr</string> 
+                            <void property="value"> 
+                             <int>5</int> 
                             </void> 
                            </object> 
                           </void> 
-                          <void property="typeInfo"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
+                         </object> 
+                        </void> 
+                        <void property="genericUDF"> 
+                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                          <void property="udfClassName"> 
+                           <string>org.apache.hadoop.hive.ql.udf.UDFSubstr</string> 
+                          </void> 
+                          <void property="udfName"> 
+                           <string>substr</string> 
                           </void> 
                          </object> 
                         </void> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo0"/> 
+                        </void> 
                        </object> 
                       </void> 
                      </object> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.AggregationDesc"> 
-                      <void property="distinct"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="genericUDAFEvaluatorClassName"> 
-                       <string>org.apache.hadoop.hive.ql.udf.generic.GenericUDAFAverage$GenericUDAFAverageEvaluatorDouble</string> 
-                      </void> 
-                      <void property="genericUDAFName"> 
-                       <string>avg</string> 
-                      </void> 
-                      <void property="mode"> 
-                       <object idref="GenericUDAFEvaluator$Mode0"/> 
-                      </void> 
-                      <void property="parameters"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                          <void property="children"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                              <void property="column"> 
-                               <string>value</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string>src</string> 
-                              </void> 
-                              <void property="typeInfo"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
+                   </object> 
+                  </void> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.plan.AggregationDesc"> 
+                    <void property="distinct"> 
+                     <boolean>true</boolean> 
+                    </void> 
+                    <void property="genericUDAFEvaluatorClassName"> 
+                     <string>org.apache.hadoop.hive.ql.udf.generic.GenericUDAFAverage$GenericUDAFAverageEvaluatorDouble</string> 
+                    </void> 
+                    <void property="genericUDAFName"> 
+                     <string>avg</string> 
+                    </void> 
+                    <void property="mode"> 
+                     <object idref="GenericUDAFEvaluator$Mode0"/> 
+                    </void> 
+                    <void property="parameters"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                        <void property="children"> 
+                         <object class="java.util.ArrayList"> 
+                          <void method="add"> 
+                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                            <void property="column"> 
+                             <string>value</string> 
                             </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                              <void property="typeInfo"> 
-                               <object idref="PrimitiveTypeInfo3"/> 
-                              </void> 
-                              <void property="value"> 
-                               <int>5</int> 
-                              </void> 
-                             </object> 
+                            <void property="tabAlias"> 
+                             <string>src</string> 
+                            </void> 
+                            <void property="typeInfo"> 
+                             <object idref="PrimitiveTypeInfo0"/> 
                             </void> 
                            </object> 
                           </void> 
-                          <void property="genericUDF"> 
-                           <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                            <void property="udfClassName"> 
-                             <string>org.apache.hadoop.hive.ql.udf.UDFSubstr</string> 
+                          <void method="add"> 
+                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                            <void property="typeInfo"> 
+                             <object idref="PrimitiveTypeInfo3"/> 
                             </void> 
-                            <void property="udfName"> 
-                             <string>substr</string> 
+                            <void property="value"> 
+                             <int>5</int> 
                             </void> 
                            </object> 
                           </void> 
-                          <void property="typeInfo"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
+                         </object> 
+                        </void> 
+                        <void property="genericUDF"> 
+                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                          <void property="udfClassName"> 
+                           <string>org.apache.hadoop.hive.ql.udf.UDFSubstr</string> 
+                          </void> 
+                          <void property="udfName"> 
+                           <string>substr</string> 
                           </void> 
                          </object> 
                         </void> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo0"/> 
+                        </void> 
                        </object> 
                       </void> 
                      </object> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.AggregationDesc"> 
-                      <void property="genericUDAFEvaluatorClassName"> 
-                       <string>org.apache.hadoop.hive.ql.udf.generic.GenericUDAFMax$GenericUDAFMaxEvaluator</string> 
-                      </void> 
-                      <void property="genericUDAFName"> 
-                       <string>max</string> 
-                      </void> 
-                      <void property="mode"> 
-                       <object idref="GenericUDAFEvaluator$Mode0"/> 
-                      </void> 
-                      <void property="parameters"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                          <void property="children"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                              <void property="column"> 
-                               <string>value</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string>src</string> 
-                              </void> 
-                              <void property="typeInfo"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
+                   </object> 
+                  </void> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.plan.AggregationDesc"> 
+                    <void property="genericUDAFEvaluatorClassName"> 
+                     <string>org.apache.hadoop.hive.ql.udf.generic.GenericUDAFMax$GenericUDAFMaxEvaluator</string> 
+                    </void> 
+                    <void property="genericUDAFName"> 
+                     <string>max</string> 
+                    </void> 
+                    <void property="mode"> 
+                     <object idref="GenericUDAFEvaluator$Mode0"/> 
+                    </void> 
+                    <void property="parameters"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                        <void property="children"> 
+                         <object class="java.util.ArrayList"> 
+                          <void method="add"> 
+                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                            <void property="column"> 
+                             <string>value</string> 
+                            </void> 
+                            <void property="tabAlias"> 
+                             <string>src</string> 
                             </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                              <void property="typeInfo"> 
-                               <object idref="PrimitiveTypeInfo3"/> 
-                              </void> 
-                              <void property="value"> 
-                               <int>5</int> 
-                              </void> 
-                             </object> 
+                            <void property="typeInfo"> 
+                             <object idref="PrimitiveTypeInfo0"/> 
                             </void> 
                            </object> 
                           </void> 
-                          <void property="genericUDF"> 
-                           <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                            <void property="udfClassName"> 
-                             <string>org.apache.hadoop.hive.ql.udf.UDFSubstr</string> 
+                          <void method="add"> 
+                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                            <void property="typeInfo"> 
+                             <object idref="PrimitiveTypeInfo3"/> 
                             </void> 
-                            <void property="udfName"> 
-                             <string>substr</string> 
+                            <void property="value"> 
+                             <int>5</int> 
                             </void> 
                            </object> 
                           </void> 
-                          <void property="typeInfo"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
+                         </object> 
+                        </void> 
+                        <void property="genericUDF"> 
+                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                          <void property="udfClassName"> 
+                           <string>org.apache.hadoop.hive.ql.udf.UDFSubstr</string> 
+                          </void> 
+                          <void property="udfName"> 
+                           <string>substr</string> 
                           </void> 
                          </object> 
                         </void> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo0"/> 
+                        </void> 
                        </object> 
                       </void> 
                      </object> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.AggregationDesc"> 
-                      <void property="genericUDAFEvaluatorClassName"> 
-                       <string>org.apache.hadoop.hive.ql.udf.generic.GenericUDAFMin$GenericUDAFMinEvaluator</string> 
-                      </void> 
-                      <void property="genericUDAFName"> 
-                       <string>min</string> 
-                      </void> 
-                      <void property="mode"> 
-                       <object idref="GenericUDAFEvaluator$Mode0"/> 
-                      </void> 
-                      <void property="parameters"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                          <void property="children"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                              <void property="column"> 
-                               <string>value</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string>src</string> 
-                              </void> 
-                              <void property="typeInfo"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
+                   </object> 
+                  </void> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.plan.AggregationDesc"> 
+                    <void property="genericUDAFEvaluatorClassName"> 
+                     <string>org.apache.hadoop.hive.ql.udf.generic.GenericUDAFMin$GenericUDAFMinEvaluator</string> 
+                    </void> 
+                    <void property="genericUDAFName"> 
+                     <string>min</string> 
+                    </void> 
+                    <void property="mode"> 
+                     <object idref="GenericUDAFEvaluator$Mode0"/> 
+                    </void> 
+                    <void property="parameters"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                        <void property="children"> 
+                         <object class="java.util.ArrayList"> 
+                          <void method="add"> 
+                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                            <void property="column"> 
+                             <string>value</string> 
                             </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                              <void property="typeInfo"> 
-                               <object idref="PrimitiveTypeInfo3"/> 
-                              </void> 
-                              <void property="value"> 
-                               <int>5</int> 
-                              </void> 
-                             </object> 
+                            <void property="tabAlias"> 
+                             <string>src</string> 
+                            </void> 
+                            <void property="typeInfo"> 
+                             <object idref="PrimitiveTypeInfo0"/> 
                             </void> 
                            </object> 
                           </void> 
-                          <void property="genericUDF"> 
-                           <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                            <void property="udfClassName"> 
-                             <string>org.apache.hadoop.hive.ql.udf.UDFSubstr</string> 
+                          <void method="add"> 
+                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                            <void property="typeInfo"> 
+                             <object idref="PrimitiveTypeInfo3"/> 
                             </void> 
-                            <void property="udfName"> 
-                             <string>substr</string> 
+                            <void property="value"> 
+                             <int>5</int> 
                             </void> 
                            </object> 
                           </void> 
-                          <void property="typeInfo"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
+                         </object> 
+                        </void> 
+                        <void property="genericUDF"> 
+                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                          <void property="udfClassName"> 
+                           <string>org.apache.hadoop.hive.ql.udf.UDFSubstr</string> 
+                          </void> 
+                          <void property="udfName"> 
+                           <string>substr</string> 
                           </void> 
                          </object> 
                         </void> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo0"/> 
+                        </void> 
                        </object> 
                       </void> 
                      </object> 
                     </void> 
                    </object> 
                   </void> 
-                  <void property="distinct"> 
-                   <boolean>true</boolean> 
-                  </void> 
-                  <void property="groupByMemoryUsage"> 
-                   <float>0.5</float> 
-                  </void> 
-                  <void property="keys"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="ExprNodeGenericFuncDesc0"/> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void property="listGroupingSets"> 
-                   <object id="ArrayList0" class="java.util.ArrayList"/> 
-                  </void> 
-                  <void property="memoryThreshold"> 
-                   <float>0.9</float> 
-                  </void> 
-                  <void property="mode"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.GroupByDesc$Mode" method="valueOf"> 
-                    <string>HASH</string> 
-                   </object> 
-                  </void> 
-                  <void property="outputColumnNames"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <string>_col0</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col1</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col2</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col3</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col4</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col5</string> 
-                    </void> 
-                   </object> 
-                  </void> 
                  </object> 
                 </void> 
-                <void property="operatorId"> 
-                 <string>GBY_2</string> 
+                <void property="distinct"> 
+                 <boolean>true</boolean> 
+                </void> 
+                <void property="groupByMemoryUsage"> 
+                 <float>0.5</float> 
                 </void> 
-                <void property="parentOperators"> 
+                <void property="keys"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object idref="SelectOperator0"/> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo2"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>double</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col2</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="StructTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>struct&lt;count:bigint,sum:double&gt;</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col3</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="StructTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>struct&lt;count:bigint,sum:double&gt;</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col4</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col5</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                   <object idref="ExprNodeGenericFuncDesc0"/> 
                   </void> 
                  </object> 
                 </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="columnExprMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>BLOCK__OFFSET__INSIDE__FILE</string> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>BLOCK__OFFSET__INSIDE__FILE</string> 
-                </void> 
-                <void property="isPartitionColOrVirtualCol"> 
-                 <boolean>true</boolean> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string>src</string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo1"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>INPUT__FILE__NAME</string> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>INPUT__FILE__NAME</string> 
-                </void> 
-                <void property="isPartitionColOrVirtualCol"> 
-                 <boolean>true</boolean> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string>src</string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>value</string> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>value</string> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string>src</string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>key</string> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>key</string> 
+                <void property="listGroupingSets"> 
+                 <object id="ArrayList0" class="java.util.ArrayList"/> 
                 </void> 
-                <void property="tabAlias"> 
-                 <string>src</string> 
+                <void property="memoryThreshold"> 
+                 <float>0.9</float> 
                 </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
+                <void property="mode"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.GroupByDesc$Mode" method="valueOf"> 
+                  <string>HASH</string> 
+                 </object> 
                 </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-              <void property="colList"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                  <void property="column"> 
-                   <string>value</string> 
+                <void property="outputColumnNames"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <string>_col0</string> 
                   </void> 
-                  <void property="tabAlias"> 
-                   <string>src</string> 
+                  <void method="add"> 
+                   <string>_col1</string> 
                   </void> 
-                  <void property="typeInfo"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
+                  <void method="add"> 
+                   <string>_col2</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col3</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col4</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col5</string> 
                   </void> 
                  </object> 
                 </void> 
                </object> 
               </void> 
-              <void property="outputColumnNames"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <string>value</string> 
-                </void> 
-               </object> 
+              <void property="operatorId"> 
+               <string>GBY_2</string> 
               </void> 
-              <void property="selectStar"> 
-               <boolean>true</boolean> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="operatorId"> 
-             <string>SEL_1</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator0"/> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="SelectOperator0"/> 
+               </void> 
               </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>value</string> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col1</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo2"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>double</string> 
+                    </void> 
+                   </object> 
                   </void> 
-                  <void property="tabAlias"> 
-                   <string>src</string> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col2</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="StructTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>struct&lt;count:bigint,sum:double&gt;</string> 
+                    </void> 
+                   </object> 
                   </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col3</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="StructTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>struct&lt;count:bigint,sum:double&gt;</string> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col4</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
                   </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col5</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
                   </void> 
                  </object> 
                 </void> 
@@ -1187,9 +1046,138 @@
               </void> 
              </object> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="columnExprMap"> 
+            <object class="java.util.HashMap"> 
+             <void method="put"> 
+              <string>BLOCK__OFFSET__INSIDE__FILE</string> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>BLOCK__OFFSET__INSIDE__FILE</string> 
+               </void> 
+               <void property="isPartitionColOrVirtualCol"> 
+                <boolean>true</boolean> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>src</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo1"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>INPUT__FILE__NAME</string> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>INPUT__FILE__NAME</string> 
+               </void> 
+               <void property="isPartitionColOrVirtualCol"> 
+                <boolean>true</boolean> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>src</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>value</string> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>value</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>src</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>key</string> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>key</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>src</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+             <void property="colList"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                 <void property="column"> 
+                  <string>value</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src</string> 
+                 </void> 
+                 <void property="typeInfo"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="outputColumnNames"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <string>value</string> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="selectStar"> 
+              <boolean>true</boolean> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>SEL_1</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator0"/> 
+            </void> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>value</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
@@ -1473,379 +1461,159 @@
       <void property="reducer"> 
        <object id="GroupByOperator1" class="org.apache.hadoop.hive.ql.exec.GroupByOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                  <void property="dirName"> 
-                   #### A masked pattern was here #### 
-                  </void> 
-                  <void property="numFiles"> 
-                   <int>1</int> 
-                  </void> 
-                  <void property="statsAggPrefix"> 
-                   #### A masked pattern was here #### 
-                  </void> 
-                  <void property="statsCollectRawDataSize"> 
-                   <boolean>true</boolean> 
-                  </void> 
-                  <void property="tableInfo"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                    <void property="inputFileFormatClass"> 
-                     <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-                    </void> 
-                    <void property="outputFileFormatClass"> 
-                     <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-                    </void> 
-                    <void property="properties"> 
-                     <object class="java.util.Properties"> 
-                      <void method="put"> 
-                       <string>hive.serialization.extend.nesting.levels</string> 
-                       <string>true</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>columns</string> 
-                       <string>_col0,_col1,_col2,_col3,_col4</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.lib</string> 
-                       <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.format</string> 
-                       <string>1</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>columns.types</string> 
-                       <string>double:double:double:string:string</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>escape.delim</string> 
-                       <string>\</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void property="totalFiles"> 
-                   <int>1</int> 
-                  </void> 
-                 </object> 
+         <void method="add"> 
+          <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                <void property="dirName"> 
+                 #### A masked pattern was here #### 
                 </void> 
-                <void property="operatorId"> 
-                 <string>FS_6</string> 
+                <void property="numFiles"> 
+                 <int>1</int> 
                 </void> 
-                <void property="parentOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object idref="SelectOperator1"/> 
-                  </void> 
-                 </object> 
+                <void property="statsAggPrefix"> 
+                 #### A masked pattern was here #### 
                 </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo2"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>double</string> 
-                      </void> 
-                     </object> 
+                <void property="statsCollectRawDataSize"> 
+                 <boolean>true</boolean> 
+                </void> 
+                <void property="tableInfo"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                  <void property="inputFileFormatClass"> 
+                   <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                  </void> 
+                  <void property="outputFileFormatClass"> 
+                   <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                  </void> 
+                  <void property="properties"> 
+                   <object class="java.util.Properties"> 
+                    <void method="put"> 
+                     <string>hive.serialization.extend.nesting.levels</string> 
+                     <string>true</string> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo2"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>double</string> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>columns</string> 
+                     <string>_col0,_col1,_col2,_col3,_col4</string> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col2</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo2"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>double</string> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>serialization.lib</string> 
+                     <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col3</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>serialization.format</string> 
+                     <string>1</string> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col4</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>columns.types</string> 
+                     <string>double:double:double:string:string</string> 
+                    </void> 
+                    <void method="put"> 
+                     <string>escape.delim</string> 
+                     <string>\</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="columnExprMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>_col4</string> 
-               <object id="ExprNodeColumnDesc6" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>_col4</string> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string></string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>_col3</string> 
-               <object id="ExprNodeColumnDesc7" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>_col3</string> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string></string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>_col2</string> 
-               <object id="ExprNodeColumnDesc8" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>_col2</string> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string></string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo2"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>_col1</string> 
-               <object id="ExprNodeColumnDesc9" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>_col1</string> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string></string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo2"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>_col0</string> 
-               <object id="ExprNodeColumnDesc10" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>_col0</string> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string></string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo2"/> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-              <void property="colList"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object idref="ExprNodeColumnDesc10"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeColumnDesc9"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeColumnDesc8"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeColumnDesc7"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeColumnDesc6"/> 
+                <void property="totalFiles"> 
+                 <int>1</int> 
                 </void> 
                </object> 
               </void> 
-              <void property="outputColumnNames"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <string>_col0</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col1</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col2</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col3</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col4</string> 
-                </void> 
-               </object> 
+              <void property="operatorId"> 
+               <string>FS_6</string> 
               </void> 
-             </object> 
-            </void> 
-            <void property="operatorId"> 
-             <string>SEL_5</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="GroupByOperator1"/> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="SelectOperator1"/> 
+               </void> 
               </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>_c0</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col0</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo2"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>double</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>_c1</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col1</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo2"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>double</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>_c2</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col2</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo2"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>double</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>_c3</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col3</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo2"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>double</string> 
+                    </void> 
+                   </object> 
                   </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>_c4</string> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col1</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo2"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>double</string> 
+                    </void> 
+                   </object> 
                   </void> 
-                  <void property="internalName"> 
-                   <string>_col4</string> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col2</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo2"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>double</string> 
+                    </void> 
+                   </object> 
                   </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col3</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
                   </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col4</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
                   </void> 
                  </object> 
                 </void> 
@@ -1853,9 +1621,221 @@
               </void> 
              </object> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="columnExprMap"> 
+            <object class="java.util.HashMap"> 
+             <void method="put"> 
+              <string>_col4</string> 
+              <object id="ExprNodeColumnDesc6" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>_col4</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string></string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col3</string> 
+              <object id="ExprNodeColumnDesc7" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>_col3</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string></string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col2</string> 
+              <object id="ExprNodeColumnDesc8" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>_col2</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string></string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo2"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col1</string> 
+              <object id="ExprNodeColumnDesc9" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>_col1</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string></string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo2"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col0</string> 
+              <object id="ExprNodeColumnDesc10" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>_col0</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string></string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo2"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+             <void property="colList"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object idref="ExprNodeColumnDesc10"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeColumnDesc9"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeColumnDesc8"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeColumnDesc7"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeColumnDesc6"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="outputColumnNames"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <string>_col0</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col1</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col2</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col3</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col4</string> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>SEL_5</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="GroupByOperator1"/> 
+            </void> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>_c0</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col0</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo2"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>double</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>_c1</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col1</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo2"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>double</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>_c2</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col2</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo2"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>double</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>_c3</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col3</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>_c4</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col4</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="columnExprMap"> 
          <object class="java.util.HashMap"/> 
@@ -2053,11 +2033,9 @@
          <string>GBY_4</string> 
         </void> 
         <void property="parentOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object idref="ReduceSinkOperator0"/> 
-          </void> 
-         </object> 
+         <void method="add"> 
+          <object idref="ReduceSinkOperator0"/> 
+         </void> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
diff --git a/ql/src/test/results/compiler/plan/groupby4.q.xml b/ql/src/test/results/compiler/plan/groupby4.q.xml
index f014ca7c8a..d2ef044d7b 100644
--- a/ql/src/test/results/compiler/plan/groupby4.q.xml
+++ b/ql/src/test/results/compiler/plan/groupby4.q.xml
@@ -153,440 +153,295 @@
        <string>src</string> 
        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="GroupByOperator0" class="org.apache.hadoop.hive.ql.exec.GroupByOperator"> 
-                <void property="childOperators"> 
-                 <object class="java.util.ArrayList"> 
+         <void method="add"> 
+          <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object id="GroupByOperator0" class="org.apache.hadoop.hive.ql.exec.GroupByOperator"> 
+              <void property="childOperators"> 
+               <void method="add"> 
+                <object id="ReduceSinkOperator0" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
+                 <void property="columnExprMap"> 
+                  <object class="java.util.HashMap"> 
+                   <void method="put"> 
+                    <string>KEY._col0</string> 
+                    <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                     <void property="column"> 
+                      <string>_col0</string> 
+                     </void> 
+                     <void property="tabAlias"> 
+                      <string></string> 
+                     </void> 
+                     <void property="typeInfo"> 
+                      <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="conf"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
+                   <void property="distinctColumnIndices"> 
+                    <object class="java.util.ArrayList"/> 
+                   </void> 
+                   <void property="keyCols"> 
+                    <object id="ArrayList0" class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object idref="ExprNodeColumnDesc0"/> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="keySerializeInfo"> 
+                    <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                     <void property="inputFileFormatClass"> 
+                      <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                     </void> 
+                     <void property="outputFileFormatClass"> 
+                      <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                     </void> 
+                     <void property="properties"> 
+                      <object class="java.util.Properties"> 
+                       <void method="put"> 
+                        <string>columns</string> 
+                        <string>_col0</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.lib</string> 
+                        <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.sort.order</string> 
+                        <string>+</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns.types</string> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="numDistributionKeys"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="numReducers"> 
+                    <int>-1</int> 
+                   </void> 
+                   <void property="outputKeyColumnNames"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <string>_col0</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="outputValueColumnNames"> 
+                    <object class="java.util.ArrayList"/> 
+                   </void> 
+                   <void property="partitionCols"> 
+                    <object idref="ArrayList0"/> 
+                   </void> 
+                   <void property="tag"> 
+                    <int>-1</int> 
+                   </void> 
+                   <void property="valueCols"> 
+                    <object class="java.util.ArrayList"/> 
+                   </void> 
+                   <void property="valueSerializeInfo"> 
+                    <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                     <void property="inputFileFormatClass"> 
+                      <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                     </void> 
+                     <void property="outputFileFormatClass"> 
+                      <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                     </void> 
+                     <void property="properties"> 
+                      <object class="java.util.Properties"> 
+                       <void method="put"> 
+                        <string>columns</string> 
+                        <string></string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.lib</string> 
+                        <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns.types</string> 
+                        <string></string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>escape.delim</string> 
+                        <string>\</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="operatorId"> 
+                  <string>RS_3</string> 
+                 </void> 
+                 <void property="parentOperators"> 
                   <void method="add"> 
-                   <object id="ReduceSinkOperator0" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
-                    <void property="columnExprMap"> 
-                     <object class="java.util.HashMap"> 
-                      <void method="put"> 
-                       <string>KEY._col0</string> 
-                       <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string></string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
-                      <void property="distinctColumnIndices"> 
-                       <object class="java.util.ArrayList"/> 
-                      </void> 
-                      <void property="keyCols"> 
-                       <object id="ArrayList0" class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="keySerializeInfo"> 
-                       <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                        <void property="inputFileFormatClass"> 
-                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                        </void> 
-                        <void property="outputFileFormatClass"> 
-                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                        </void> 
-                        <void property="properties"> 
-                         <object class="java.util.Properties"> 
-                          <void method="put"> 
-                           <string>columns</string> 
-                           <string>_col0</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.lib</string> 
-                           <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.sort.order</string> 
-                           <string>+</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns.types</string> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="numDistributionKeys"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="numReducers"> 
-                       <int>-1</int> 
-                      </void> 
-                      <void property="outputKeyColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>_col0</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="outputValueColumnNames"> 
-                       <object class="java.util.ArrayList"/> 
-                      </void> 
-                      <void property="partitionCols"> 
-                       <object idref="ArrayList0"/> 
-                      </void> 
-                      <void property="tag"> 
-                       <int>-1</int> 
-                      </void> 
-                      <void property="valueCols"> 
-                       <object class="java.util.ArrayList"/> 
-                      </void> 
-                      <void property="valueSerializeInfo"> 
-                       <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                        <void property="inputFileFormatClass"> 
-                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                        </void> 
-                        <void property="outputFileFormatClass"> 
-                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                        </void> 
-                        <void property="properties"> 
-                         <object class="java.util.Properties"> 
-                          <void method="put"> 
-                           <string>columns</string> 
-                           <string></string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.lib</string> 
-                           <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns.types</string> 
-                           <string></string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>escape.delim</string> 
-                           <string>\</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
+                   <object idref="GroupByOperator0"/> 
+                  </void> 
+                 </void> 
+                 <void property="schema"> 
+                  <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                   <void property="signature"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>KEY._col0</string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+              </void> 
+              <void property="columnExprMap"> 
+               <object class="java.util.HashMap"> 
+                <void method="put"> 
+                 <string>_col0</string> 
+                 <object id="ExprNodeGenericFuncDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                  <void property="children"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                      <void property="column"> 
+                       <string>key</string> 
                       </void> 
-                     </object> 
-                    </void> 
-                    <void property="operatorId"> 
-                     <string>RS_3</string> 
-                    </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="GroupByOperator0"/> 
+                      <void property="tabAlias"> 
+                       <string>src</string> 
                       </void> 
-                     </object> 
-                    </void> 
-                    <void property="schema"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                      <void property="signature"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>KEY._col0</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
                      </object> 
                     </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="columnExprMap"> 
-                 <object class="java.util.HashMap"> 
-                  <void method="put"> 
-                   <string>_col0</string> 
-                   <object id="ExprNodeGenericFuncDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>int</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="value"> 
-                         <int>1</int> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
+                       <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                        <void property="typeName"> 
+                         <string>int</string> 
                         </void> 
                        </object> 
                       </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>1</int> 
-                        </void> 
-                       </object> 
+                      <void property="value"> 
+                       <int>1</int> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                      <void property="udfClassName"> 
-                       <string>org.apache.hadoop.hive.ql.udf.UDFSubstr</string> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
-                      <void property="udfName"> 
-                       <string>substr</string> 
+                      <void property="value"> 
+                       <int>1</int> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
                    </object> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.GroupByDesc"> 
-                  <void property="aggregators"> 
-                   <object class="java.util.ArrayList"/> 
-                  </void> 
-                  <void property="groupByMemoryUsage"> 
-                   <float>0.5</float> 
-                  </void> 
-                  <void property="groupingSetPosition"> 
-                   <int>1</int> 
-                  </void> 
-                  <void property="keys"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="ExprNodeGenericFuncDesc0"/> 
+                  <void property="genericUDF"> 
+                   <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                    <void property="udfClassName"> 
+                     <string>org.apache.hadoop.hive.ql.udf.UDFSubstr</string> 
                     </void> 
-                   </object> 
-                  </void> 
-                  <void property="listGroupingSets"> 
-                   <object id="ArrayList1" class="java.util.ArrayList"/> 
-                  </void> 
-                  <void property="memoryThreshold"> 
-                   <float>0.9</float> 
-                  </void> 
-                  <void property="mode"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.GroupByDesc$Mode" method="valueOf"> 
-                    <string>HASH</string> 
-                   </object> 
-                  </void> 
-                  <void property="outputColumnNames"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <string>_col0</string> 
+                    <void property="udfName"> 
+                     <string>substr</string> 
                     </void> 
                    </object> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="operatorId"> 
-                 <string>GBY_2</string> 
-                </void> 
-                <void property="parentOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object idref="SelectOperator0"/> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
                </object> 
               </void> 
-             </object> 
-            </void> 
-            <void property="columnExprMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>BLOCK__OFFSET__INSIDE__FILE</string> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>BLOCK__OFFSET__INSIDE__FILE</string> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.GroupByDesc"> 
+                <void property="aggregators"> 
+                 <object class="java.util.ArrayList"/> 
                 </void> 
-                <void property="isPartitionColOrVirtualCol"> 
-                 <boolean>true</boolean> 
+                <void property="groupByMemoryUsage"> 
+                 <float>0.5</float> 
                 </void> 
-                <void property="tabAlias"> 
-                 <string>src</string> 
+                <void property="groupingSetPosition"> 
+                 <int>1</int> 
                 </void> 
-                <void property="typeInfo"> 
-                 <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                  <void property="typeName"> 
-                   <string>bigint</string> 
+                <void property="keys"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object idref="ExprNodeGenericFuncDesc0"/> 
                   </void> 
                  </object> 
                 </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>INPUT__FILE__NAME</string> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>INPUT__FILE__NAME</string> 
-                </void> 
-                <void property="isPartitionColOrVirtualCol"> 
-                 <boolean>true</boolean> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string>src</string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>value</string> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>value</string> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string>src</string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>key</string> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>key</string> 
+                <void property="listGroupingSets"> 
+                 <object id="ArrayList1" class="java.util.ArrayList"/> 
                 </void> 
-                <void property="tabAlias"> 
-                 <string>src</string> 
+                <void property="memoryThreshold"> 
+                 <float>0.9</float> 
                 </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
+                <void property="mode"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.GroupByDesc$Mode" method="valueOf"> 
+                  <string>HASH</string> 
+                 </object> 
                 </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-              <void property="colList"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                  <void property="column"> 
-                   <string>key</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src</string> 
-                  </void> 
-                  <void property="typeInfo"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
+                <void property="outputColumnNames"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <string>_col0</string> 
                   </void> 
                  </object> 
                 </void> 
                </object> 
               </void> 
-              <void property="outputColumnNames"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <string>key</string> 
-                </void> 
-               </object> 
-              </void> 
-              <void property="selectStar"> 
-               <boolean>true</boolean> 
+              <void property="operatorId"> 
+               <string>GBY_2</string> 
               </void> 
-             </object> 
-            </void> 
-            <void property="operatorId"> 
-             <string>SEL_1</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator0"/> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="SelectOperator0"/> 
+               </void> 
               </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>key</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
                   </void> 
                  </object> 
                 </void> 
@@ -594,9 +449,142 @@
               </void> 
              </object> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="columnExprMap"> 
+            <object class="java.util.HashMap"> 
+             <void method="put"> 
+              <string>BLOCK__OFFSET__INSIDE__FILE</string> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>BLOCK__OFFSET__INSIDE__FILE</string> 
+               </void> 
+               <void property="isPartitionColOrVirtualCol"> 
+                <boolean>true</boolean> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>src</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                 <void property="typeName"> 
+                  <string>bigint</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>INPUT__FILE__NAME</string> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>INPUT__FILE__NAME</string> 
+               </void> 
+               <void property="isPartitionColOrVirtualCol"> 
+                <boolean>true</boolean> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>src</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>value</string> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>value</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>src</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>key</string> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>key</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>src</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+             <void property="colList"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                 <void property="column"> 
+                  <string>key</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src</string> 
+                 </void> 
+                 <void property="typeInfo"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="outputColumnNames"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <string>key</string> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="selectStar"> 
+              <boolean>true</boolean> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>SEL_1</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator0"/> 
+            </void> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>key</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
@@ -880,171 +868,95 @@
       <void property="reducer"> 
        <object id="GroupByOperator1" class="org.apache.hadoop.hive.ql.exec.GroupByOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                  <void property="dirName"> 
-                   #### A masked pattern was here #### 
-                  </void> 
-                  <void property="numFiles"> 
-                   <int>1</int> 
-                  </void> 
-                  <void property="statsAggPrefix"> 
-                   #### A masked pattern was here #### 
+         <void method="add"> 
+          <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                <void property="dirName"> 
+                 #### A masked pattern was here #### 
+                </void> 
+                <void property="numFiles"> 
+                 <int>1</int> 
+                </void> 
+                <void property="statsAggPrefix"> 
+                 #### A masked pattern was here #### 
+                </void> 
+                <void property="statsCollectRawDataSize"> 
+                 <boolean>true</boolean> 
+                </void> 
+                <void property="tableInfo"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                  <void property="inputFileFormatClass"> 
+                   <class>org.apache.hadoop.mapred.TextInputFormat</class> 
                   </void> 
-                  <void property="statsCollectRawDataSize"> 
-                   <boolean>true</boolean> 
+                  <void property="outputFileFormatClass"> 
+                   <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
                   </void> 
-                  <void property="tableInfo"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                    <void property="inputFileFormatClass"> 
-                     <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                  <void property="properties"> 
+                   <object class="java.util.Properties"> 
+                    <void method="put"> 
+                     <string>hive.serialization.extend.nesting.levels</string> 
+                     <string>true</string> 
                     </void> 
-                    <void property="outputFileFormatClass"> 
-                     <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                    <void method="put"> 
+                     <string>columns</string> 
+                     <string>_col0</string> 
                     </void> 
-                    <void property="properties"> 
-                     <object class="java.util.Properties"> 
-                      <void method="put"> 
-                       <string>hive.serialization.extend.nesting.levels</string> 
-                       <string>true</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>columns</string> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.lib</string> 
-                       <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.format</string> 
-                       <string>1</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>columns.types</string> 
-                       <string>string</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>escape.delim</string> 
-                       <string>\</string> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>serialization.lib</string> 
+                     <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
                     </void> 
-                   </object> 
-                  </void> 
-                  <void property="totalFiles"> 
-                   <int>1</int> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="operatorId"> 
-                 <string>FS_6</string> 
-                </void> 
-                <void property="parentOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object idref="SelectOperator1"/> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>serialization.format</string> 
+                     <string>1</string> 
+                    </void> 
+                    <void method="put"> 
+                     <string>columns.types</string> 
+                     <string>string</string> 
+                    </void> 
+                    <void method="put"> 
+                     <string>escape.delim</string> 
+                     <string>\</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="columnExprMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>_col0</string> 
-               <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>_col0</string> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string></string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-              <void property="colList"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object idref="ExprNodeColumnDesc1"/> 
+                <void property="totalFiles"> 
+                 <int>1</int> 
                 </void> 
                </object> 
               </void> 
-              <void property="outputColumnNames"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <string>_col0</string> 
-                </void> 
-               </object> 
+              <void property="operatorId"> 
+               <string>FS_6</string> 
               </void> 
-             </object> 
-            </void> 
-            <void property="operatorId"> 
-             <string>SEL_5</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="GroupByOperator1"/> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="SelectOperator1"/> 
+               </void> 
               </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>_c0</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col0</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
                   </void> 
                  </object> 
                 </void> 
@@ -1052,9 +964,77 @@
               </void> 
              </object> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="columnExprMap"> 
+            <object class="java.util.HashMap"> 
+             <void method="put"> 
+              <string>_col0</string> 
+              <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>_col0</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string></string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+             <void property="colList"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object idref="ExprNodeColumnDesc1"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="outputColumnNames"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <string>_col0</string> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>SEL_5</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="GroupByOperator1"/> 
+            </void> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>_c0</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col0</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="columnExprMap"> 
          <object class="java.util.HashMap"> 
@@ -1110,11 +1090,9 @@
          <string>GBY_4</string> 
         </void> 
         <void property="parentOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object idref="ReduceSinkOperator0"/> 
-          </void> 
-         </object> 
+         <void method="add"> 
+          <object idref="ReduceSinkOperator0"/> 
+         </void> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
diff --git a/ql/src/test/results/compiler/plan/groupby5.q.xml b/ql/src/test/results/compiler/plan/groupby5.q.xml
index f247c05b49..99219e08ec 100644
--- a/ql/src/test/results/compiler/plan/groupby5.q.xml
+++ b/ql/src/test/results/compiler/plan/groupby5.q.xml
@@ -153,553 +153,376 @@
        <string>src</string> 
        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="GroupByOperator0" class="org.apache.hadoop.hive.ql.exec.GroupByOperator"> 
-                <void property="childOperators"> 
-                 <object class="java.util.ArrayList"> 
+         <void method="add"> 
+          <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object id="GroupByOperator0" class="org.apache.hadoop.hive.ql.exec.GroupByOperator"> 
+              <void property="childOperators"> 
+               <void method="add"> 
+                <object id="ReduceSinkOperator0" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
+                 <void property="columnExprMap"> 
+                  <object class="java.util.HashMap"> 
+                   <void method="put"> 
+                    <string>KEY._col0</string> 
+                    <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                     <void property="column"> 
+                      <string>_col0</string> 
+                     </void> 
+                     <void property="tabAlias"> 
+                      <string></string> 
+                     </void> 
+                     <void property="typeInfo"> 
+                      <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void method="put"> 
+                    <string>VALUE._col0</string> 
+                    <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                     <void property="column"> 
+                      <string>_col1</string> 
+                     </void> 
+                     <void property="tabAlias"> 
+                      <string></string> 
+                     </void> 
+                     <void property="typeInfo"> 
+                      <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                       <void property="typeName"> 
+                        <string>double</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="conf"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
+                   <void property="distinctColumnIndices"> 
+                    <object class="java.util.ArrayList"/> 
+                   </void> 
+                   <void property="keyCols"> 
+                    <object id="ArrayList0" class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object idref="ExprNodeColumnDesc0"/> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="keySerializeInfo"> 
+                    <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                     <void property="inputFileFormatClass"> 
+                      <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                     </void> 
+                     <void property="outputFileFormatClass"> 
+                      <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                     </void> 
+                     <void property="properties"> 
+                      <object class="java.util.Properties"> 
+                       <void method="put"> 
+                        <string>columns</string> 
+                        <string>_col0</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.lib</string> 
+                        <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.sort.order</string> 
+                        <string>+</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns.types</string> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="numDistributionKeys"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="numReducers"> 
+                    <int>-1</int> 
+                   </void> 
+                   <void property="outputKeyColumnNames"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <string>_col0</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="outputValueColumnNames"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <string>_col0</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="partitionCols"> 
+                    <object idref="ArrayList0"/> 
+                   </void> 
+                   <void property="tag"> 
+                    <int>-1</int> 
+                   </void> 
+                   <void property="valueCols"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object idref="ExprNodeColumnDesc1"/> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="valueSerializeInfo"> 
+                    <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                     <void property="inputFileFormatClass"> 
+                      <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                     </void> 
+                     <void property="outputFileFormatClass"> 
+                      <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                     </void> 
+                     <void property="properties"> 
+                      <object class="java.util.Properties"> 
+                       <void method="put"> 
+                        <string>columns</string> 
+                        <string>_col0</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.lib</string> 
+                        <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns.types</string> 
+                        <string>double</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>escape.delim</string> 
+                        <string>\</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="operatorId"> 
+                  <string>RS_3</string> 
+                 </void> 
+                 <void property="parentOperators"> 
                   <void method="add"> 
-                   <object id="ReduceSinkOperator0" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
-                    <void property="columnExprMap"> 
-                     <object class="java.util.HashMap"> 
-                      <void method="put"> 
-                       <string>KEY._col0</string> 
-                       <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string></string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="put"> 
-                       <string>VALUE._col0</string> 
-                       <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>_col1</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string></string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>double</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
-                      <void property="distinctColumnIndices"> 
-                       <object class="java.util.ArrayList"/> 
-                      </void> 
-                      <void property="keyCols"> 
-                       <object id="ArrayList0" class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="keySerializeInfo"> 
-                       <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                        <void property="inputFileFormatClass"> 
-                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                        </void> 
-                        <void property="outputFileFormatClass"> 
-                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                        </void> 
-                        <void property="properties"> 
-                         <object class="java.util.Properties"> 
-                          <void method="put"> 
-                           <string>columns</string> 
-                           <string>_col0</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.lib</string> 
-                           <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.sort.order</string> 
-                           <string>+</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns.types</string> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="numDistributionKeys"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="numReducers"> 
-                       <int>-1</int> 
-                      </void> 
-                      <void property="outputKeyColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>_col0</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="outputValueColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>_col0</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="partitionCols"> 
-                       <object idref="ArrayList0"/> 
-                      </void> 
-                      <void property="tag"> 
-                       <int>-1</int> 
-                      </void> 
-                      <void property="valueCols"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc1"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="valueSerializeInfo"> 
-                       <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                        <void property="inputFileFormatClass"> 
-                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                        </void> 
-                        <void property="outputFileFormatClass"> 
-                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                        </void> 
-                        <void property="properties"> 
-                         <object class="java.util.Properties"> 
-                          <void method="put"> 
-                           <string>columns</string> 
-                           <string>_col0</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.lib</string> 
-                           <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns.types</string> 
-                           <string>double</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>escape.delim</string> 
-                           <string>\</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="operatorId"> 
-                     <string>RS_3</string> 
-                    </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="GroupByOperator0"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="schema"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                      <void property="signature"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>KEY._col0</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>VALUE._col0</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo1"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>double</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                   <object idref="GroupByOperator0"/> 
+                  </void> 
+                 </void> 
+                 <void property="schema"> 
+                  <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                   <void property="signature"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>KEY._col0</string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>VALUE._col0</string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo1"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>double</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+              </void> 
+              <void property="columnExprMap"> 
+               <object class="java.util.HashMap"> 
+                <void method="put"> 
+                 <string>_col0</string> 
+                 <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>key</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>src</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="columnExprMap"> 
-                 <object class="java.util.HashMap"> 
-                  <void method="put"> 
-                   <string>_col0</string> 
-                   <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>key</string> 
+               </object> 
+              </void> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.GroupByDesc"> 
+                <void property="aggregators"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.plan.AggregationDesc"> 
+                    <void property="genericUDAFEvaluatorClassName"> 
+                     <string>org.apache.hadoop.hive.ql.udf.generic.GenericUDAFSum$GenericUDAFSumDouble</string> 
                     </void> 
-                    <void property="tabAlias"> 
-                     <string>src</string> 
+                    <void property="genericUDAFName"> 
+                     <string>sum</string> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
+                    <void property="mode"> 
+                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDAFEvaluator$Mode" method="valueOf"> 
+                      <string>PARTIAL1</string> 
+                     </object> 
                     </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.GroupByDesc"> 
-                  <void property="aggregators"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.AggregationDesc"> 
-                      <void property="genericUDAFEvaluatorClassName"> 
-                       <string>org.apache.hadoop.hive.ql.udf.generic.GenericUDAFSum$GenericUDAFSumDouble</string> 
-                      </void> 
-                      <void property="genericUDAFName"> 
-                       <string>sum</string> 
-                      </void> 
-                      <void property="mode"> 
-                       <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDAFEvaluator$Mode" method="valueOf"> 
-                        <string>PARTIAL1</string> 
-                       </object> 
-                      </void> 
-                      <void property="parameters"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                          <void property="children"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                              <void property="column"> 
-                               <string>value</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string>src</string> 
-                              </void> 
-                              <void property="typeInfo"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
+                    <void property="parameters"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                        <void property="children"> 
+                         <object class="java.util.ArrayList"> 
+                          <void method="add"> 
+                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                            <void property="column"> 
+                             <string>value</string> 
                             </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                              <void property="typeInfo"> 
-                               <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                                <void property="typeName"> 
-                                 <string>int</string> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void property="value"> 
-                               <int>5</int> 
-                              </void> 
-                             </object> 
+                            <void property="tabAlias"> 
+                             <string>src</string> 
+                            </void> 
+                            <void property="typeInfo"> 
+                             <object idref="PrimitiveTypeInfo0"/> 
                             </void> 
                            </object> 
                           </void> 
-                          <void property="genericUDF"> 
-                           <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                            <void property="udfClassName"> 
-                             <string>org.apache.hadoop.hive.ql.udf.UDFSubstr</string> 
+                          <void method="add"> 
+                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                            <void property="typeInfo"> 
+                             <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                              <void property="typeName"> 
+                               <string>int</string> 
+                              </void> 
+                             </object> 
                             </void> 
-                            <void property="udfName"> 
-                             <string>substr</string> 
+                            <void property="value"> 
+                             <int>5</int> 
                             </void> 
                            </object> 
                           </void> 
-                          <void property="typeInfo"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
+                         </object> 
+                        </void> 
+                        <void property="genericUDF"> 
+                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                          <void property="udfClassName"> 
+                           <string>org.apache.hadoop.hive.ql.udf.UDFSubstr</string> 
+                          </void> 
+                          <void property="udfName"> 
+                           <string>substr</string> 
                           </void> 
                          </object> 
                         </void> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo0"/> 
+                        </void> 
                        </object> 
                       </void> 
                      </object> 
                     </void> 
                    </object> 
                   </void> 
-                  <void property="groupByMemoryUsage"> 
-                   <float>0.5</float> 
-                  </void> 
-                  <void property="groupingSetPosition"> 
-                   <int>1</int> 
-                  </void> 
-                  <void property="keys"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc2"/> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void property="listGroupingSets"> 
-                   <object id="ArrayList1" class="java.util.ArrayList"/> 
-                  </void> 
-                  <void property="memoryThreshold"> 
-                   <float>0.9</float> 
-                  </void> 
-                  <void property="mode"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.GroupByDesc$Mode" method="valueOf"> 
-                    <string>HASH</string> 
-                   </object> 
-                  </void> 
-                  <void property="outputColumnNames"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <string>_col0</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col1</string> 
-                    </void> 
-                   </object> 
-                  </void> 
                  </object> 
                 </void> 
-                <void property="operatorId"> 
-                 <string>GBY_2</string> 
+                <void property="groupByMemoryUsage"> 
+                 <float>0.5</float> 
                 </void> 
-                <void property="parentOperators"> 
+                <void property="groupingSetPosition"> 
+                 <int>1</int> 
+                </void> 
+                <void property="keys"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object idref="SelectOperator0"/> 
+                   <object idref="ExprNodeColumnDesc2"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo1"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>double</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="columnExprMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>BLOCK__OFFSET__INSIDE__FILE</string> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>BLOCK__OFFSET__INSIDE__FILE</string> 
-                </void> 
-                <void property="isPartitionColOrVirtualCol"> 
-                 <boolean>true</boolean> 
+                <void property="listGroupingSets"> 
+                 <object id="ArrayList1" class="java.util.ArrayList"/> 
                 </void> 
-                <void property="tabAlias"> 
-                 <string>src</string> 
+                <void property="memoryThreshold"> 
+                 <float>0.9</float> 
                 </void> 
-                <void property="typeInfo"> 
-                 <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                  <void property="typeName"> 
-                   <string>bigint</string> 
-                  </void> 
+                <void property="mode"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.GroupByDesc$Mode" method="valueOf"> 
+                  <string>HASH</string> 
                  </object> 
                 </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>INPUT__FILE__NAME</string> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>INPUT__FILE__NAME</string> 
-                </void> 
-                <void property="isPartitionColOrVirtualCol"> 
-                 <boolean>true</boolean> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string>src</string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>value</string> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>value</string> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string>src</string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>key</string> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>key</string> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string>src</string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-              <void property="colList"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                  <void property="column"> 
-                   <string>key</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src</string> 
-                  </void> 
-                  <void property="typeInfo"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                  <void property="column"> 
-                   <string>value</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src</string> 
+                <void property="outputColumnNames"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <string>_col0</string> 
                   </void> 
-                  <void property="typeInfo"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
+                  <void method="add"> 
+                   <string>_col1</string> 
                   </void> 
                  </object> 
                 </void> 
                </object> 
               </void> 
-              <void property="outputColumnNames"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <string>key</string> 
-                </void> 
-                <void method="add"> 
-                 <string>value</string> 
-                </void> 
-               </object> 
-              </void> 
-              <void property="selectStar"> 
-               <boolean>true</boolean> 
+              <void property="operatorId"> 
+               <string>GBY_2</string> 
               </void> 
-             </object> 
-            </void> 
-            <void property="operatorId"> 
-             <string>SEL_1</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator0"/> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="SelectOperator0"/> 
+               </void> 
               </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>key</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>value</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
                   </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col1</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo1"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>double</string> 
+                    </void> 
+                   </object> 
                   </void> 
                  </object> 
                 </void> 
@@ -707,9 +530,174 @@
               </void> 
              </object> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="columnExprMap"> 
+            <object class="java.util.HashMap"> 
+             <void method="put"> 
+              <string>BLOCK__OFFSET__INSIDE__FILE</string> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>BLOCK__OFFSET__INSIDE__FILE</string> 
+               </void> 
+               <void property="isPartitionColOrVirtualCol"> 
+                <boolean>true</boolean> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>src</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                 <void property="typeName"> 
+                  <string>bigint</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>INPUT__FILE__NAME</string> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>INPUT__FILE__NAME</string> 
+               </void> 
+               <void property="isPartitionColOrVirtualCol"> 
+                <boolean>true</boolean> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>src</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>value</string> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>value</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>src</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>key</string> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>key</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>src</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+             <void property="colList"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                 <void property="column"> 
+                  <string>key</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src</string> 
+                 </void> 
+                 <void property="typeInfo"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                 <void property="column"> 
+                  <string>value</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src</string> 
+                 </void> 
+                 <void property="typeInfo"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="outputColumnNames"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <string>key</string> 
+               </void> 
+               <void method="add"> 
+                <string>value</string> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="selectStar"> 
+              <boolean>true</boolean> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>SEL_1</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator0"/> 
+            </void> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>key</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>value</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
@@ -986,226 +974,111 @@
       <void property="reducer"> 
        <object id="GroupByOperator1" class="org.apache.hadoop.hive.ql.exec.GroupByOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                  <void property="dirName"> 
-                   #### A masked pattern was here #### 
-                  </void> 
-                  <void property="numFiles"> 
-                   <int>1</int> 
-                  </void> 
-                  <void property="statsAggPrefix"> 
-                   #### A masked pattern was here #### 
+         <void method="add"> 
+          <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                <void property="dirName"> 
+                 #### A masked pattern was here #### 
+                </void> 
+                <void property="numFiles"> 
+                 <int>1</int> 
+                </void> 
+                <void property="statsAggPrefix"> 
+                 #### A masked pattern was here #### 
+                </void> 
+                <void property="statsCollectRawDataSize"> 
+                 <boolean>true</boolean> 
+                </void> 
+                <void property="tableInfo"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                  <void property="inputFileFormatClass"> 
+                   <class>org.apache.hadoop.mapred.TextInputFormat</class> 
                   </void> 
-                  <void property="statsCollectRawDataSize"> 
-                   <boolean>true</boolean> 
+                  <void property="outputFileFormatClass"> 
+                   <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
                   </void> 
-                  <void property="tableInfo"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                    <void property="inputFileFormatClass"> 
-                     <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                  <void property="properties"> 
+                   <object class="java.util.Properties"> 
+                    <void method="put"> 
+                     <string>hive.serialization.extend.nesting.levels</string> 
+                     <string>true</string> 
                     </void> 
-                    <void property="outputFileFormatClass"> 
-                     <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                    <void method="put"> 
+                     <string>columns</string> 
+                     <string>_col0,_col1</string> 
                     </void> 
-                    <void property="properties"> 
-                     <object class="java.util.Properties"> 
-                      <void method="put"> 
-                       <string>hive.serialization.extend.nesting.levels</string> 
-                       <string>true</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>columns</string> 
-                       <string>_col0,_col1</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.lib</string> 
-                       <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.format</string> 
-                       <string>1</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>columns.types</string> 
-                       <string>string:double</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>escape.delim</string> 
-                       <string>\</string> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>serialization.lib</string> 
+                     <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
                     </void> 
-                   </object> 
-                  </void> 
-                  <void property="totalFiles"> 
-                   <int>1</int> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="operatorId"> 
-                 <string>FS_6</string> 
-                </void> 
-                <void property="parentOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object idref="SelectOperator1"/> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>serialization.format</string> 
+                     <string>1</string> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo1"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>double</string> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>columns.types</string> 
+                     <string>string:double</string> 
+                    </void> 
+                    <void method="put"> 
+                     <string>escape.delim</string> 
+                     <string>\</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="columnExprMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>_col1</string> 
-               <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>_col1</string> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string></string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo1"/> 
+                <void property="totalFiles"> 
+                 <int>1</int> 
                 </void> 
                </object> 
               </void> 
-              <void method="put"> 
-               <string>_col0</string> 
-               <object id="ExprNodeColumnDesc4" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>_col0</string> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string></string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-              <void property="colList"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object idref="ExprNodeColumnDesc4"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeColumnDesc3"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void property="outputColumnNames"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <string>_col0</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col1</string> 
-                </void> 
-               </object> 
+              <void property="operatorId"> 
+               <string>FS_6</string> 
               </void> 
-             </object> 
-            </void> 
-            <void property="operatorId"> 
-             <string>SEL_5</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="GroupByOperator1"/> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="SelectOperator1"/> 
+               </void> 
               </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>key</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col0</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>_c1</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col1</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo1"/> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
                   </void> 
-                  <void property="typeName"> 
-                   <string>double</string> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col1</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo1"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>double</string> 
+                    </void> 
+                   </object> 
                   </void> 
                  </object> 
                 </void> 
@@ -1213,9 +1086,116 @@
               </void> 
              </object> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="columnExprMap"> 
+            <object class="java.util.HashMap"> 
+             <void method="put"> 
+              <string>_col1</string> 
+              <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>_col1</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string></string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo1"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col0</string> 
+              <object id="ExprNodeColumnDesc4" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>_col0</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string></string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+             <void property="colList"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object idref="ExprNodeColumnDesc4"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeColumnDesc3"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="outputColumnNames"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <string>_col0</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col1</string> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>SEL_5</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="GroupByOperator1"/> 
+            </void> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>key</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col0</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>_c1</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col1</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo1"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>double</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="columnExprMap"> 
          <object class="java.util.HashMap"> 
@@ -1304,11 +1284,9 @@
          <string>GBY_4</string> 
         </void> 
         <void property="parentOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object idref="ReduceSinkOperator0"/> 
-          </void> 
-         </object> 
+         <void method="add"> 
+          <object idref="ReduceSinkOperator0"/> 
+         </void> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
diff --git a/ql/src/test/results/compiler/plan/groupby6.q.xml b/ql/src/test/results/compiler/plan/groupby6.q.xml
index 51b65eee7f..1422106d5c 100644
--- a/ql/src/test/results/compiler/plan/groupby6.q.xml
+++ b/ql/src/test/results/compiler/plan/groupby6.q.xml
@@ -153,440 +153,295 @@
        <string>src</string> 
        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="GroupByOperator0" class="org.apache.hadoop.hive.ql.exec.GroupByOperator"> 
-                <void property="childOperators"> 
-                 <object class="java.util.ArrayList"> 
+         <void method="add"> 
+          <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object id="GroupByOperator0" class="org.apache.hadoop.hive.ql.exec.GroupByOperator"> 
+              <void property="childOperators"> 
+               <void method="add"> 
+                <object id="ReduceSinkOperator0" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
+                 <void property="columnExprMap"> 
+                  <object class="java.util.HashMap"> 
+                   <void method="put"> 
+                    <string>KEY._col0</string> 
+                    <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                     <void property="column"> 
+                      <string>_col0</string> 
+                     </void> 
+                     <void property="tabAlias"> 
+                      <string></string> 
+                     </void> 
+                     <void property="typeInfo"> 
+                      <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="conf"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
+                   <void property="distinctColumnIndices"> 
+                    <object class="java.util.ArrayList"/> 
+                   </void> 
+                   <void property="keyCols"> 
+                    <object id="ArrayList0" class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object idref="ExprNodeColumnDesc0"/> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="keySerializeInfo"> 
+                    <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                     <void property="inputFileFormatClass"> 
+                      <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                     </void> 
+                     <void property="outputFileFormatClass"> 
+                      <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                     </void> 
+                     <void property="properties"> 
+                      <object class="java.util.Properties"> 
+                       <void method="put"> 
+                        <string>columns</string> 
+                        <string>_col0</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.lib</string> 
+                        <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.sort.order</string> 
+                        <string>+</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns.types</string> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="numDistributionKeys"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="numReducers"> 
+                    <int>-1</int> 
+                   </void> 
+                   <void property="outputKeyColumnNames"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <string>_col0</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="outputValueColumnNames"> 
+                    <object class="java.util.ArrayList"/> 
+                   </void> 
+                   <void property="partitionCols"> 
+                    <object idref="ArrayList0"/> 
+                   </void> 
+                   <void property="tag"> 
+                    <int>-1</int> 
+                   </void> 
+                   <void property="valueCols"> 
+                    <object class="java.util.ArrayList"/> 
+                   </void> 
+                   <void property="valueSerializeInfo"> 
+                    <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                     <void property="inputFileFormatClass"> 
+                      <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                     </void> 
+                     <void property="outputFileFormatClass"> 
+                      <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                     </void> 
+                     <void property="properties"> 
+                      <object class="java.util.Properties"> 
+                       <void method="put"> 
+                        <string>columns</string> 
+                        <string></string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.lib</string> 
+                        <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns.types</string> 
+                        <string></string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>escape.delim</string> 
+                        <string>\</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="operatorId"> 
+                  <string>RS_3</string> 
+                 </void> 
+                 <void property="parentOperators"> 
                   <void method="add"> 
-                   <object id="ReduceSinkOperator0" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
-                    <void property="columnExprMap"> 
-                     <object class="java.util.HashMap"> 
-                      <void method="put"> 
-                       <string>KEY._col0</string> 
-                       <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string></string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
-                      <void property="distinctColumnIndices"> 
-                       <object class="java.util.ArrayList"/> 
-                      </void> 
-                      <void property="keyCols"> 
-                       <object id="ArrayList0" class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="keySerializeInfo"> 
-                       <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                        <void property="inputFileFormatClass"> 
-                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                        </void> 
-                        <void property="outputFileFormatClass"> 
-                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                        </void> 
-                        <void property="properties"> 
-                         <object class="java.util.Properties"> 
-                          <void method="put"> 
-                           <string>columns</string> 
-                           <string>_col0</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.lib</string> 
-                           <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.sort.order</string> 
-                           <string>+</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns.types</string> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="numDistributionKeys"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="numReducers"> 
-                       <int>-1</int> 
-                      </void> 
-                      <void property="outputKeyColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>_col0</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="outputValueColumnNames"> 
-                       <object class="java.util.ArrayList"/> 
-                      </void> 
-                      <void property="partitionCols"> 
-                       <object idref="ArrayList0"/> 
-                      </void> 
-                      <void property="tag"> 
-                       <int>-1</int> 
-                      </void> 
-                      <void property="valueCols"> 
-                       <object class="java.util.ArrayList"/> 
-                      </void> 
-                      <void property="valueSerializeInfo"> 
-                       <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                        <void property="inputFileFormatClass"> 
-                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                        </void> 
-                        <void property="outputFileFormatClass"> 
-                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                        </void> 
-                        <void property="properties"> 
-                         <object class="java.util.Properties"> 
-                          <void method="put"> 
-                           <string>columns</string> 
-                           <string></string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.lib</string> 
-                           <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns.types</string> 
-                           <string></string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>escape.delim</string> 
-                           <string>\</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
+                   <object idref="GroupByOperator0"/> 
+                  </void> 
+                 </void> 
+                 <void property="schema"> 
+                  <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                   <void property="signature"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>KEY._col0</string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+              </void> 
+              <void property="columnExprMap"> 
+               <object class="java.util.HashMap"> 
+                <void method="put"> 
+                 <string>_col0</string> 
+                 <object id="ExprNodeGenericFuncDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                  <void property="children"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                      <void property="column"> 
+                       <string>value</string> 
                       </void> 
-                     </object> 
-                    </void> 
-                    <void property="operatorId"> 
-                     <string>RS_3</string> 
-                    </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="GroupByOperator0"/> 
+                      <void property="tabAlias"> 
+                       <string>src</string> 
                       </void> 
-                     </object> 
-                    </void> 
-                    <void property="schema"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                      <void property="signature"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>KEY._col0</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
                      </object> 
                     </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="columnExprMap"> 
-                 <object class="java.util.HashMap"> 
-                  <void method="put"> 
-                   <string>_col0</string> 
-                   <object id="ExprNodeGenericFuncDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>value</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>int</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="value"> 
-                         <int>5</int> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
+                       <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                        <void property="typeName"> 
+                         <string>int</string> 
                         </void> 
                        </object> 
                       </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>1</int> 
-                        </void> 
-                       </object> 
+                      <void property="value"> 
+                       <int>5</int> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                      <void property="udfClassName"> 
-                       <string>org.apache.hadoop.hive.ql.udf.UDFSubstr</string> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
-                      <void property="udfName"> 
-                       <string>substr</string> 
+                      <void property="value"> 
+                       <int>1</int> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
                    </object> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.GroupByDesc"> 
-                  <void property="aggregators"> 
-                   <object class="java.util.ArrayList"/> 
-                  </void> 
-                  <void property="groupByMemoryUsage"> 
-                   <float>0.5</float> 
-                  </void> 
-                  <void property="groupingSetPosition"> 
-                   <int>1</int> 
-                  </void> 
-                  <void property="keys"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="ExprNodeGenericFuncDesc0"/> 
+                  <void property="genericUDF"> 
+                   <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                    <void property="udfClassName"> 
+                     <string>org.apache.hadoop.hive.ql.udf.UDFSubstr</string> 
                     </void> 
-                   </object> 
-                  </void> 
-                  <void property="listGroupingSets"> 
-                   <object id="ArrayList1" class="java.util.ArrayList"/> 
-                  </void> 
-                  <void property="memoryThreshold"> 
-                   <float>0.9</float> 
-                  </void> 
-                  <void property="mode"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.GroupByDesc$Mode" method="valueOf"> 
-                    <string>HASH</string> 
-                   </object> 
-                  </void> 
-                  <void property="outputColumnNames"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <string>_col0</string> 
+                    <void property="udfName"> 
+                     <string>substr</string> 
                     </void> 
                    </object> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="operatorId"> 
-                 <string>GBY_2</string> 
-                </void> 
-                <void property="parentOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object idref="SelectOperator0"/> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
                </object> 
               </void> 
-             </object> 
-            </void> 
-            <void property="columnExprMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>BLOCK__OFFSET__INSIDE__FILE</string> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>BLOCK__OFFSET__INSIDE__FILE</string> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.GroupByDesc"> 
+                <void property="aggregators"> 
+                 <object class="java.util.ArrayList"/> 
                 </void> 
-                <void property="isPartitionColOrVirtualCol"> 
-                 <boolean>true</boolean> 
+                <void property="groupByMemoryUsage"> 
+                 <float>0.5</float> 
                 </void> 
-                <void property="tabAlias"> 
-                 <string>src</string> 
+                <void property="groupingSetPosition"> 
+                 <int>1</int> 
                 </void> 
-                <void property="typeInfo"> 
-                 <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                  <void property="typeName"> 
-                   <string>bigint</string> 
+                <void property="keys"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object idref="ExprNodeGenericFuncDesc0"/> 
                   </void> 
                  </object> 
                 </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>INPUT__FILE__NAME</string> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>INPUT__FILE__NAME</string> 
-                </void> 
-                <void property="isPartitionColOrVirtualCol"> 
-                 <boolean>true</boolean> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string>src</string> 
+                <void property="listGroupingSets"> 
+                 <object id="ArrayList1" class="java.util.ArrayList"/> 
                 </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>value</string> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>value</string> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string>src</string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>key</string> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>key</string> 
+                <void property="memoryThreshold"> 
+                 <float>0.9</float> 
                 </void> 
-                <void property="tabAlias"> 
-                 <string>src</string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
+                <void property="mode"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.GroupByDesc$Mode" method="valueOf"> 
+                  <string>HASH</string> 
+                 </object> 
                 </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-              <void property="colList"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                  <void property="column"> 
-                   <string>value</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src</string> 
-                  </void> 
-                  <void property="typeInfo"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
+                <void property="outputColumnNames"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <string>_col0</string> 
                   </void> 
                  </object> 
                 </void> 
                </object> 
               </void> 
-              <void property="outputColumnNames"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <string>value</string> 
-                </void> 
-               </object> 
+              <void property="operatorId"> 
+               <string>GBY_2</string> 
               </void> 
-              <void property="selectStar"> 
-               <boolean>true</boolean> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="SelectOperator0"/> 
+               </void> 
               </void> 
-             </object> 
-            </void> 
-            <void property="operatorId"> 
-             <string>SEL_1</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator0"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>value</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
                   </void> 
                  </object> 
                 </void> 
@@ -594,9 +449,142 @@
               </void> 
              </object> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="columnExprMap"> 
+            <object class="java.util.HashMap"> 
+             <void method="put"> 
+              <string>BLOCK__OFFSET__INSIDE__FILE</string> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>BLOCK__OFFSET__INSIDE__FILE</string> 
+               </void> 
+               <void property="isPartitionColOrVirtualCol"> 
+                <boolean>true</boolean> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>src</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                 <void property="typeName"> 
+                  <string>bigint</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>INPUT__FILE__NAME</string> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>INPUT__FILE__NAME</string> 
+               </void> 
+               <void property="isPartitionColOrVirtualCol"> 
+                <boolean>true</boolean> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>src</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>value</string> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>value</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>src</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>key</string> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>key</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>src</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+             <void property="colList"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                 <void property="column"> 
+                  <string>value</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src</string> 
+                 </void> 
+                 <void property="typeInfo"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="outputColumnNames"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <string>value</string> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="selectStar"> 
+              <boolean>true</boolean> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>SEL_1</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator0"/> 
+            </void> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>value</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
@@ -880,171 +868,95 @@
       <void property="reducer"> 
        <object id="GroupByOperator1" class="org.apache.hadoop.hive.ql.exec.GroupByOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                  <void property="dirName"> 
-                   #### A masked pattern was here #### 
-                  </void> 
-                  <void property="numFiles"> 
-                   <int>1</int> 
-                  </void> 
-                  <void property="statsAggPrefix"> 
-                   #### A masked pattern was here #### 
+         <void method="add"> 
+          <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                <void property="dirName"> 
+                 #### A masked pattern was here #### 
+                </void> 
+                <void property="numFiles"> 
+                 <int>1</int> 
+                </void> 
+                <void property="statsAggPrefix"> 
+                 #### A masked pattern was here #### 
+                </void> 
+                <void property="statsCollectRawDataSize"> 
+                 <boolean>true</boolean> 
+                </void> 
+                <void property="tableInfo"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                  <void property="inputFileFormatClass"> 
+                   <class>org.apache.hadoop.mapred.TextInputFormat</class> 
                   </void> 
-                  <void property="statsCollectRawDataSize"> 
-                   <boolean>true</boolean> 
+                  <void property="outputFileFormatClass"> 
+                   <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
                   </void> 
-                  <void property="tableInfo"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                    <void property="inputFileFormatClass"> 
-                     <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                  <void property="properties"> 
+                   <object class="java.util.Properties"> 
+                    <void method="put"> 
+                     <string>hive.serialization.extend.nesting.levels</string> 
+                     <string>true</string> 
                     </void> 
-                    <void property="outputFileFormatClass"> 
-                     <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                    <void method="put"> 
+                     <string>columns</string> 
+                     <string>_col0</string> 
                     </void> 
-                    <void property="properties"> 
-                     <object class="java.util.Properties"> 
-                      <void method="put"> 
-                       <string>hive.serialization.extend.nesting.levels</string> 
-                       <string>true</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>columns</string> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.lib</string> 
-                       <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.format</string> 
-                       <string>1</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>columns.types</string> 
-                       <string>string</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>escape.delim</string> 
-                       <string>\</string> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>serialization.lib</string> 
+                     <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
                     </void> 
-                   </object> 
-                  </void> 
-                  <void property="totalFiles"> 
-                   <int>1</int> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="operatorId"> 
-                 <string>FS_6</string> 
-                </void> 
-                <void property="parentOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object idref="SelectOperator1"/> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>serialization.format</string> 
+                     <string>1</string> 
+                    </void> 
+                    <void method="put"> 
+                     <string>columns.types</string> 
+                     <string>string</string> 
+                    </void> 
+                    <void method="put"> 
+                     <string>escape.delim</string> 
+                     <string>\</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="columnExprMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>_col0</string> 
-               <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>_col0</string> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string></string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-              <void property="colList"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object idref="ExprNodeColumnDesc1"/> 
+                <void property="totalFiles"> 
+                 <int>1</int> 
                 </void> 
                </object> 
               </void> 
-              <void property="outputColumnNames"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <string>_col0</string> 
-                </void> 
-               </object> 
+              <void property="operatorId"> 
+               <string>FS_6</string> 
               </void> 
-             </object> 
-            </void> 
-            <void property="operatorId"> 
-             <string>SEL_5</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="GroupByOperator1"/> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="SelectOperator1"/> 
+               </void> 
               </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>_c0</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col0</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
                   </void> 
                  </object> 
                 </void> 
@@ -1052,9 +964,77 @@
               </void> 
              </object> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="columnExprMap"> 
+            <object class="java.util.HashMap"> 
+             <void method="put"> 
+              <string>_col0</string> 
+              <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>_col0</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string></string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+             <void property="colList"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object idref="ExprNodeColumnDesc1"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="outputColumnNames"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <string>_col0</string> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>SEL_5</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="GroupByOperator1"/> 
+            </void> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>_c0</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col0</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="columnExprMap"> 
          <object class="java.util.HashMap"> 
@@ -1110,11 +1090,9 @@
          <string>GBY_4</string> 
         </void> 
         <void property="parentOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object idref="ReduceSinkOperator0"/> 
-          </void> 
-         </object> 
+         <void method="add"> 
+          <object idref="ReduceSinkOperator0"/> 
+         </void> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
diff --git a/ql/src/test/results/compiler/plan/input1.q.xml b/ql/src/test/results/compiler/plan/input1.q.xml
index f4343c3fb2..eb158e3793 100755
--- a/ql/src/test/results/compiler/plan/input1.q.xml
+++ b/ql/src/test/results/compiler/plan/input1.q.xml
@@ -79,137 +79,133 @@
                        #### A masked pattern was here #### 
                        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                         <void property="childOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                            <void property="conf"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                              <void property="dirName"> 
-                               #### A masked pattern was here #### 
-                              </void> 
-                              <void property="numFiles"> 
-                               <int>1</int> 
-                              </void> 
-                              <void property="tableInfo"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                                <void property="inputFileFormatClass"> 
-                                 <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-                                </void> 
-                                <void property="outputFileFormatClass"> 
-                                 <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-                                </void> 
-                                <void property="properties"> 
-                                 <object class="java.util.Properties"> 
-                                  <void method="put"> 
-                                   <string>name</string> 
-                                   <string>default.dest1</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>columns.types</string> 
-                                   <string>string:string</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.ddl</string> 
-                                   <string>struct dest1 { string key, string value}</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.format</string> 
-                                   <string>1</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>columns</string> 
-                                   <string>key,value</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>bucket_count</string> 
-                                   <string>-1</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.lib</string> 
-                                   <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>file.inputformat</string> 
-                                   <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>location</string> 
-                                   #### A masked pattern was here #### 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>file.outputformat</string> 
-                                   <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>transient_lastDdlTime</string> 
-                                   #### A masked pattern was here #### 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void property="totalFiles"> 
-                               <int>1</int> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="operatorId"> 
-                             <string>FS_6</string> 
-                            </void> 
-                            <void property="parentOperators"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object idref="TableScanOperator0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="schema"> 
-                             <object id="RowSchema0" class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                              <void property="signature"> 
-                               <object class="java.util.ArrayList"> 
-                                <void method="add"> 
-                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                  <void property="internalName"> 
-                                   <string>key</string> 
-                                  </void> 
-                                  <void property="tabAlias"> 
-                                   <string></string> 
-                                  </void> 
-                                  <void property="type"> 
-                                   <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                                    <void property="typeName"> 
-                                     <string>string</string> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                  <void property="typeName"> 
-                                   <string>string</string> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void method="add"> 
-                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                  <void property="internalName"> 
-                                   <string>value</string> 
-                                  </void> 
-                                  <void property="tabAlias"> 
-                                   <string></string> 
-                                  </void> 
-                                  <void property="type"> 
-                                   <object idref="PrimitiveTypeInfo0"/> 
-                                  </void> 
-                                  <void property="typeName"> 
-                                   <string>string</string> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
+                         <void method="add"> 
+                          <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                           <void property="conf"> 
+                            <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                             <void property="dirName"> 
+                              #### A masked pattern was here #### 
+                             </void> 
+                             <void property="numFiles"> 
+                              <int>1</int> 
+                             </void> 
+                             <void property="tableInfo"> 
+                              <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                               <void property="inputFileFormatClass"> 
+                                <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                               </void> 
+                               <void property="outputFileFormatClass"> 
+                                <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                               </void> 
+                               <void property="properties"> 
+                                <object class="java.util.Properties"> 
+                                 <void method="put"> 
+                                  <string>name</string> 
+                                  <string>default.dest1</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>columns.types</string> 
+                                  <string>string:string</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.ddl</string> 
+                                  <string>struct dest1 { string key, string value}</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.format</string> 
+                                  <string>1</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>columns</string> 
+                                  <string>key,value</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>bucket_count</string> 
+                                  <string>-1</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.lib</string> 
+                                  <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>file.inputformat</string> 
+                                  <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>location</string> 
+                                  #### A masked pattern was here #### 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>file.outputformat</string> 
+                                  <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>transient_lastDdlTime</string> 
+                                  #### A masked pattern was here #### 
+                                 </void> 
+                                </object> 
+                               </void> 
+                              </object> 
+                             </void> 
+                             <void property="totalFiles"> 
+                              <int>1</int> 
+                             </void> 
+                            </object> 
+                           </void> 
+                           <void property="operatorId"> 
+                            <string>FS_6</string> 
+                           </void> 
+                           <void property="parentOperators"> 
+                            <void method="add"> 
+                             <object idref="TableScanOperator0"/> 
                             </void> 
-                           </object> 
-                          </void> 
-                         </object> 
+                           </void> 
+                           <void property="schema"> 
+                            <object id="RowSchema0" class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                             <void property="signature"> 
+                              <object class="java.util.ArrayList"> 
+                               <void method="add"> 
+                                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                 <void property="internalName"> 
+                                  <string>key</string> 
+                                 </void> 
+                                 <void property="tabAlias"> 
+                                  <string></string> 
+                                 </void> 
+                                 <void property="type"> 
+                                  <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                                   <void property="typeName"> 
+                                    <string>string</string> 
+                                   </void> 
+                                  </object> 
+                                 </void> 
+                                 <void property="typeName"> 
+                                  <string>string</string> 
+                                 </void> 
+                                </object> 
+                               </void> 
+                               <void method="add"> 
+                                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                 <void property="internalName"> 
+                                  <string>value</string> 
+                                 </void> 
+                                 <void property="tabAlias"> 
+                                  <string></string> 
+                                 </void> 
+                                 <void property="type"> 
+                                  <object idref="PrimitiveTypeInfo0"/> 
+                                 </void> 
+                                 <void property="typeName"> 
+                                  <string>string</string> 
+                                 </void> 
+                                </object> 
+                               </void> 
+                              </object> 
+                             </void> 
+                            </object> 
+                           </void> 
+                          </object> 
+                         </void> 
                         </void> 
                         <void property="conf"> 
                          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"/> 
@@ -638,280 +634,268 @@
        <string>src</string> 
        <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                <void property="childOperators"> 
-                 <object class="java.util.ArrayList"> 
+         <void method="add"> 
+          <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+              <void property="childOperators"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                 <void property="conf"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                   <void property="destTableId"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="dirName"> 
+                    #### A masked pattern was here #### 
+                   </void> 
+                   <void property="gatherStats"> 
+                    <boolean>true</boolean> 
+                   </void> 
+                   <void property="lbCtx"> 
+                    <object idref="ListBucketingCtx0"/> 
+                   </void> 
+                   <void property="maxStatsKeyPrefixLength"> 
+                    <int>150</int> 
+                   </void> 
+                   <void property="numFiles"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="statsAggPrefix"> 
+                    #### A masked pattern was here #### 
+                   </void> 
+                   <void property="statsCollectRawDataSize"> 
+                    <boolean>true</boolean> 
+                   </void> 
+                   <void property="tableInfo"> 
+                    <object idref="TableDesc0"/> 
+                   </void> 
+                   <void property="totalFiles"> 
+                    <int>1</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="operatorId"> 
+                  <string>FS_3</string> 
+                 </void> 
+                 <void property="parentOperators"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                      <void property="destTableId"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="dirName"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="gatherStats"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="lbCtx"> 
-                       <object idref="ListBucketingCtx0"/> 
-                      </void> 
-                      <void property="maxStatsKeyPrefixLength"> 
-                       <int>150</int> 
-                      </void> 
-                      <void property="numFiles"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="statsAggPrefix"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="statsCollectRawDataSize"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="tableInfo"> 
-                       <object idref="TableDesc0"/> 
-                      </void> 
-                      <void property="totalFiles"> 
-                       <int>1</int> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="operatorId"> 
-                     <string>FS_3</string> 
-                    </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="SelectOperator0"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="schema"> 
-                     <object idref="RowSchema0"/> 
-                    </void> 
-                   </object> 
+                   <object idref="SelectOperator0"/> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="columnExprMap"> 
-                 <object class="java.util.HashMap"> 
-                  <void method="put"> 
-                   <string>_col1</string> 
-                   <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>value</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>src</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
+                 </void> 
+                 <void property="schema"> 
+                  <object idref="RowSchema0"/> 
+                 </void> 
+                </object> 
+               </void> 
+              </void> 
+              <void property="columnExprMap"> 
+               <object class="java.util.HashMap"> 
+                <void method="put"> 
+                 <string>_col1</string> 
+                 <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>value</string> 
                   </void> 
-                  <void method="put"> 
-                   <string>_col0</string> 
-                   <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>key</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>src</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
+                  <void property="tabAlias"> 
+                   <string>src</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                  <void property="colList"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc1"/> 
-                    </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc0"/> 
-                    </void> 
-                   </object> 
+                <void method="put"> 
+                 <string>_col0</string> 
+                 <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>key</string> 
                   </void> 
-                  <void property="outputColumnNames"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <string>_col0</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col1</string> 
-                    </void> 
-                   </object> 
+                  <void property="tabAlias"> 
+                   <string>src</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="operatorId"> 
-                 <string>SEL_2</string> 
-                </void> 
-                <void property="parentOperators"> 
+               </object> 
+              </void> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                <void property="colList"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object idref="FilterOperator0"/> 
+                   <object idref="ExprNodeColumnDesc1"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object idref="ExprNodeColumnDesc0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>src</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>src</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                <void property="outputColumnNames"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <string>_col0</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col1</string> 
                   </void> 
                  </object> 
                 </void> 
                </object> 
               </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-              <void property="predicate"> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
+              <void property="operatorId"> 
+               <string>SEL_2</string> 
+              </void> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="FilterOperator0"/> 
+               </void> 
+              </void> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>key</string> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
                     </void> 
                     <void property="tabAlias"> 
                      <string>src</string> 
                     </void> 
-                    <void property="typeInfo"> 
+                    <void property="type"> 
                      <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
                    </object> 
                   </void> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
-                     <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                      <void property="typeName"> 
-                       <string>int</string> 
-                      </void> 
-                     </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col1</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string>src</string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                    <void property="value"> 
-                     <int>100</int> 
+                    <void property="typeName"> 
+                     <string>string</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                  <void property="typeName"> 
-                   <string>boolean</string> 
-                  </void> 
-                 </object> 
-                </void> 
                </object> 
               </void> 
              </object> 
             </void> 
-            <void property="operatorId"> 
-             <string>FIL_4</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator1"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>key</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>value</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
+             <void property="predicate"> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                   <void property="column"> 
+                    <string>key</string> 
+                   </void> 
+                   <void property="tabAlias"> 
+                    <string>src</string> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo0"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                     <void property="typeName"> 
+                      <string>int</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="value"> 
+                    <int>100</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                 <void property="typeName"> 
+                  <string>boolean</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>FIL_4</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator1"/> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>key</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>value</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
diff --git a/ql/src/test/results/compiler/plan/input2.q.xml b/ql/src/test/results/compiler/plan/input2.q.xml
index aa4e7e3478..2f6158c62f 100755
--- a/ql/src/test/results/compiler/plan/input2.q.xml
+++ b/ql/src/test/results/compiler/plan/input2.q.xml
@@ -79,137 +79,133 @@
                        #### A masked pattern was here #### 
                        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                         <void property="childOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                            <void property="conf"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                              <void property="dirName"> 
-                               #### A masked pattern was here #### 
-                              </void> 
-                              <void property="numFiles"> 
-                               <int>1</int> 
-                              </void> 
-                              <void property="tableInfo"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                                <void property="inputFileFormatClass"> 
-                                 <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-                                </void> 
-                                <void property="outputFileFormatClass"> 
-                                 <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-                                </void> 
-                                <void property="properties"> 
-                                 <object class="java.util.Properties"> 
-                                  <void method="put"> 
-                                   <string>name</string> 
-                                   <string>default.dest1</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>columns.types</string> 
-                                   <string>string:string</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.ddl</string> 
-                                   <string>struct dest1 { string key, string value}</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.format</string> 
-                                   <string>1</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>columns</string> 
-                                   <string>key,value</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>bucket_count</string> 
-                                   <string>-1</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.lib</string> 
-                                   <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>file.inputformat</string> 
-                                   <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>location</string> 
-                                   #### A masked pattern was here #### 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>file.outputformat</string> 
-                                   <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>transient_lastDdlTime</string> 
-                                   #### A masked pattern was here #### 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void property="totalFiles"> 
-                               <int>1</int> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="operatorId"> 
-                             <string>FS_11</string> 
-                            </void> 
-                            <void property="parentOperators"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object idref="TableScanOperator0"/> 
-                              </void> 
-                             </object> 
+                         <void method="add"> 
+                          <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                           <void property="conf"> 
+                            <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                             <void property="dirName"> 
+                              #### A masked pattern was here #### 
+                             </void> 
+                             <void property="numFiles"> 
+                              <int>1</int> 
+                             </void> 
+                             <void property="tableInfo"> 
+                              <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                               <void property="inputFileFormatClass"> 
+                                <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                               </void> 
+                               <void property="outputFileFormatClass"> 
+                                <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                               </void> 
+                               <void property="properties"> 
+                                <object class="java.util.Properties"> 
+                                 <void method="put"> 
+                                  <string>name</string> 
+                                  <string>default.dest1</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>columns.types</string> 
+                                  <string>string:string</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.ddl</string> 
+                                  <string>struct dest1 { string key, string value}</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.format</string> 
+                                  <string>1</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>columns</string> 
+                                  <string>key,value</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>bucket_count</string> 
+                                  <string>-1</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.lib</string> 
+                                  <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>file.inputformat</string> 
+                                  <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>location</string> 
+                                  #### A masked pattern was here #### 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>file.outputformat</string> 
+                                  <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>transient_lastDdlTime</string> 
+                                  #### A masked pattern was here #### 
+                                 </void> 
+                                </object> 
+                               </void> 
+                              </object> 
+                             </void> 
+                             <void property="totalFiles"> 
+                              <int>1</int> 
+                             </void> 
+                            </object> 
+                           </void> 
+                           <void property="operatorId"> 
+                            <string>FS_11</string> 
+                           </void> 
+                           <void property="parentOperators"> 
+                            <void method="add"> 
+                             <object idref="TableScanOperator0"/> 
                             </void> 
-                            <void property="schema"> 
-                             <object id="RowSchema0" class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                              <void property="signature"> 
-                               <object class="java.util.ArrayList"> 
-                                <void method="add"> 
-                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                  <void property="internalName"> 
-                                   <string>key</string> 
-                                  </void> 
-                                  <void property="tabAlias"> 
-                                   <string></string> 
-                                  </void> 
-                                  <void property="type"> 
-                                   <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                                    <void property="typeName"> 
-                                     <string>string</string> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                  <void property="typeName"> 
-                                   <string>string</string> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void method="add"> 
-                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                  <void property="internalName"> 
-                                   <string>value</string> 
-                                  </void> 
-                                  <void property="tabAlias"> 
-                                   <string></string> 
-                                  </void> 
-                                  <void property="type"> 
-                                   <object idref="PrimitiveTypeInfo0"/> 
-                                  </void> 
-                                  <void property="typeName"> 
-                                   <string>string</string> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
+                           </void> 
+                           <void property="schema"> 
+                            <object id="RowSchema0" class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                             <void property="signature"> 
+                              <object class="java.util.ArrayList"> 
+                               <void method="add"> 
+                                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                 <void property="internalName"> 
+                                  <string>key</string> 
+                                 </void> 
+                                 <void property="tabAlias"> 
+                                  <string></string> 
+                                 </void> 
+                                 <void property="type"> 
+                                  <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                                   <void property="typeName"> 
+                                    <string>string</string> 
+                                   </void> 
+                                  </object> 
+                                 </void> 
+                                 <void property="typeName"> 
+                                  <string>string</string> 
+                                 </void> 
+                                </object> 
+                               </void> 
+                               <void method="add"> 
+                                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                 <void property="internalName"> 
+                                  <string>value</string> 
+                                 </void> 
+                                 <void property="tabAlias"> 
+                                  <string></string> 
+                                 </void> 
+                                 <void property="type"> 
+                                  <object idref="PrimitiveTypeInfo0"/> 
+                                 </void> 
+                                 <void property="typeName"> 
+                                  <string>string</string> 
+                                 </void> 
+                                </object> 
+                               </void> 
+                              </object> 
+                             </void> 
+                            </object> 
+                           </void> 
+                          </object> 
+                         </void> 
                         </void> 
                         <void property="conf"> 
                          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"/> 
@@ -560,133 +556,129 @@
                        #### A masked pattern was here #### 
                        <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                         <void property="childOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                            <void property="conf"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                              <void property="dirName"> 
-                               #### A masked pattern was here #### 
-                              </void> 
-                              <void property="numFiles"> 
-                               <int>1</int> 
-                              </void> 
-                              <void property="tableInfo"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                                <void property="inputFileFormatClass"> 
-                                 <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-                                </void> 
-                                <void property="outputFileFormatClass"> 
-                                 <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-                                </void> 
-                                <void property="properties"> 
-                                 <object class="java.util.Properties"> 
-                                  <void method="put"> 
-                                   <string>name</string> 
-                                   <string>default.dest2</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>columns.types</string> 
-                                   <string>string:string</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.ddl</string> 
-                                   <string>struct dest2 { string key, string value}</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.format</string> 
-                                   <string>1</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>columns</string> 
-                                   <string>key,value</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>bucket_count</string> 
-                                   <string>-1</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.lib</string> 
-                                   <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>file.inputformat</string> 
-                                   <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>location</string> 
-                                   #### A masked pattern was here #### 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>file.outputformat</string> 
-                                   <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>transient_lastDdlTime</string> 
-                                   #### A masked pattern was here #### 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void property="totalFiles"> 
-                               <int>1</int> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="operatorId"> 
-                             <string>FS_13</string> 
+                         <void method="add"> 
+                          <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                           <void property="conf"> 
+                            <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                             <void property="dirName"> 
+                              #### A masked pattern was here #### 
+                             </void> 
+                             <void property="numFiles"> 
+                              <int>1</int> 
+                             </void> 
+                             <void property="tableInfo"> 
+                              <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                               <void property="inputFileFormatClass"> 
+                                <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                               </void> 
+                               <void property="outputFileFormatClass"> 
+                                <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                               </void> 
+                               <void property="properties"> 
+                                <object class="java.util.Properties"> 
+                                 <void method="put"> 
+                                  <string>name</string> 
+                                  <string>default.dest2</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>columns.types</string> 
+                                  <string>string:string</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.ddl</string> 
+                                  <string>struct dest2 { string key, string value}</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.format</string> 
+                                  <string>1</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>columns</string> 
+                                  <string>key,value</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>bucket_count</string> 
+                                  <string>-1</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.lib</string> 
+                                  <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>file.inputformat</string> 
+                                  <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>location</string> 
+                                  #### A masked pattern was here #### 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>file.outputformat</string> 
+                                  <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>transient_lastDdlTime</string> 
+                                  #### A masked pattern was here #### 
+                                 </void> 
+                                </object> 
+                               </void> 
+                              </object> 
+                             </void> 
+                             <void property="totalFiles"> 
+                              <int>1</int> 
+                             </void> 
+                            </object> 
+                           </void> 
+                           <void property="operatorId"> 
+                            <string>FS_13</string> 
+                           </void> 
+                           <void property="parentOperators"> 
+                            <void method="add"> 
+                             <object idref="TableScanOperator1"/> 
                             </void> 
-                            <void property="parentOperators"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object idref="TableScanOperator1"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="schema"> 
-                             <object id="RowSchema1" class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                              <void property="signature"> 
-                               <object class="java.util.ArrayList"> 
-                                <void method="add"> 
-                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                  <void property="internalName"> 
-                                   <string>key</string> 
-                                  </void> 
-                                  <void property="tabAlias"> 
-                                   <string></string> 
-                                  </void> 
-                                  <void property="type"> 
-                                   <object idref="PrimitiveTypeInfo0"/> 
-                                  </void> 
-                                  <void property="typeName"> 
-                                   <string>string</string> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void method="add"> 
-                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                  <void property="internalName"> 
-                                   <string>value</string> 
-                                  </void> 
-                                  <void property="tabAlias"> 
-                                   <string></string> 
-                                  </void> 
-                                  <void property="type"> 
-                                   <object idref="PrimitiveTypeInfo0"/> 
-                                  </void> 
-                                  <void property="typeName"> 
-                                   <string>string</string> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
+                           </void> 
+                           <void property="schema"> 
+                            <object id="RowSchema1" class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                             <void property="signature"> 
+                              <object class="java.util.ArrayList"> 
+                               <void method="add"> 
+                                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                 <void property="internalName"> 
+                                  <string>key</string> 
+                                 </void> 
+                                 <void property="tabAlias"> 
+                                  <string></string> 
+                                 </void> 
+                                 <void property="type"> 
+                                  <object idref="PrimitiveTypeInfo0"/> 
+                                 </void> 
+                                 <void property="typeName"> 
+                                  <string>string</string> 
+                                 </void> 
+                                </object> 
+                               </void> 
+                               <void method="add"> 
+                                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                 <void property="internalName"> 
+                                  <string>value</string> 
+                                 </void> 
+                                 <void property="tabAlias"> 
+                                  <string></string> 
+                                 </void> 
+                                 <void property="type"> 
+                                  <object idref="PrimitiveTypeInfo0"/> 
+                                 </void> 
+                                 <void property="typeName"> 
+                                  <string>string</string> 
+                                 </void> 
+                                </object> 
+                               </void> 
+                              </object> 
+                             </void> 
+                            </object> 
+                           </void> 
+                          </object> 
+                         </void> 
                         </void> 
                         <void property="conf"> 
                          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"/> 
@@ -1037,137 +1029,133 @@
                        #### A masked pattern was here #### 
                        <object id="TableScanOperator2" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                         <void property="childOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                            <void property="conf"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                              <void property="dirName"> 
-                               #### A masked pattern was here #### 
-                              </void> 
-                              <void property="numFiles"> 
-                               <int>1</int> 
-                              </void> 
-                              <void property="tableInfo"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                                <void property="inputFileFormatClass"> 
-                                 <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-                                </void> 
-                                <void property="outputFileFormatClass"> 
-                                 <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-                                </void> 
-                                <void property="properties"> 
-                                 <object class="java.util.Properties"> 
-                                  <void method="put"> 
-                                   <string>name</string> 
-                                   <string>default.dest3</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>columns.types</string> 
-                                   <string>string:string</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.ddl</string> 
-                                   <string>struct dest3 { string key, string value}</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.format</string> 
-                                   <string>1</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>columns</string> 
-                                   <string>key,value</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>partition_columns</string> 
-                                   <string>ds/hr</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>bucket_count</string> 
-                                   <string>-1</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.lib</string> 
-                                   <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>file.inputformat</string> 
-                                   <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>location</string> 
-                                   #### A masked pattern was here #### 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>file.outputformat</string> 
-                                   <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>transient_lastDdlTime</string> 
-                                   #### A masked pattern was here #### 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void property="totalFiles"> 
-                               <int>1</int> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="operatorId"> 
-                             <string>FS_15</string> 
+                         <void method="add"> 
+                          <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                           <void property="conf"> 
+                            <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                             <void property="dirName"> 
+                              #### A masked pattern was here #### 
+                             </void> 
+                             <void property="numFiles"> 
+                              <int>1</int> 
+                             </void> 
+                             <void property="tableInfo"> 
+                              <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                               <void property="inputFileFormatClass"> 
+                                <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                               </void> 
+                               <void property="outputFileFormatClass"> 
+                                <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                               </void> 
+                               <void property="properties"> 
+                                <object class="java.util.Properties"> 
+                                 <void method="put"> 
+                                  <string>name</string> 
+                                  <string>default.dest3</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>columns.types</string> 
+                                  <string>string:string</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.ddl</string> 
+                                  <string>struct dest3 { string key, string value}</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.format</string> 
+                                  <string>1</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>columns</string> 
+                                  <string>key,value</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>partition_columns</string> 
+                                  <string>ds/hr</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>bucket_count</string> 
+                                  <string>-1</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.lib</string> 
+                                  <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>file.inputformat</string> 
+                                  <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>location</string> 
+                                  #### A masked pattern was here #### 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>file.outputformat</string> 
+                                  <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>transient_lastDdlTime</string> 
+                                  #### A masked pattern was here #### 
+                                 </void> 
+                                </object> 
+                               </void> 
+                              </object> 
+                             </void> 
+                             <void property="totalFiles"> 
+                              <int>1</int> 
+                             </void> 
+                            </object> 
+                           </void> 
+                           <void property="operatorId"> 
+                            <string>FS_15</string> 
+                           </void> 
+                           <void property="parentOperators"> 
+                            <void method="add"> 
+                             <object idref="TableScanOperator2"/> 
                             </void> 
-                            <void property="parentOperators"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object idref="TableScanOperator2"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="schema"> 
-                             <object id="RowSchema2" class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                              <void property="signature"> 
-                               <object class="java.util.ArrayList"> 
-                                <void method="add"> 
-                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                  <void property="internalName"> 
-                                   <string>key</string> 
-                                  </void> 
-                                  <void property="tabAlias"> 
-                                   <string></string> 
-                                  </void> 
-                                  <void property="type"> 
-                                   <object idref="PrimitiveTypeInfo0"/> 
-                                  </void> 
-                                  <void property="typeName"> 
-                                   <string>string</string> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void method="add"> 
-                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                  <void property="internalName"> 
-                                   <string>value</string> 
-                                  </void> 
-                                  <void property="tabAlias"> 
-                                   <string></string> 
-                                  </void> 
-                                  <void property="type"> 
-                                   <object idref="PrimitiveTypeInfo0"/> 
-                                  </void> 
-                                  <void property="typeName"> 
-                                   <string>string</string> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
+                           </void> 
+                           <void property="schema"> 
+                            <object id="RowSchema2" class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                             <void property="signature"> 
+                              <object class="java.util.ArrayList"> 
+                               <void method="add"> 
+                                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                 <void property="internalName"> 
+                                  <string>key</string> 
+                                 </void> 
+                                 <void property="tabAlias"> 
+                                  <string></string> 
+                                 </void> 
+                                 <void property="type"> 
+                                  <object idref="PrimitiveTypeInfo0"/> 
+                                 </void> 
+                                 <void property="typeName"> 
+                                  <string>string</string> 
+                                 </void> 
+                                </object> 
+                               </void> 
+                               <void method="add"> 
+                                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                 <void property="internalName"> 
+                                  <string>value</string> 
+                                 </void> 
+                                 <void property="tabAlias"> 
+                                  <string></string> 
+                                 </void> 
+                                 <void property="type"> 
+                                  <object idref="PrimitiveTypeInfo0"/> 
+                                 </void> 
+                                 <void property="typeName"> 
+                                  <string>string</string> 
+                                 </void> 
+                                </object> 
+                               </void> 
+                              </object> 
+                             </void> 
+                            </object> 
+                           </void> 
+                          </object> 
+                         </void> 
                         </void> 
                         <void property="conf"> 
                          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"/> 
@@ -1605,804 +1593,772 @@
        <string>src</string> 
        <object id="TableScanOperator3" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                <void property="childOperators"> 
-                 <object class="java.util.ArrayList"> 
+         <void method="add"> 
+          <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+              <void property="childOperators"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                 <void property="conf"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                   <void property="destTableId"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="dirName"> 
+                    #### A masked pattern was here #### 
+                   </void> 
+                   <void property="gatherStats"> 
+                    <boolean>true</boolean> 
+                   </void> 
+                   <void property="lbCtx"> 
+                    <object idref="ListBucketingCtx0"/> 
+                   </void> 
+                   <void property="maxStatsKeyPrefixLength"> 
+                    <int>150</int> 
+                   </void> 
+                   <void property="numFiles"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="statsAggPrefix"> 
+                    #### A masked pattern was here #### 
+                   </void> 
+                   <void property="statsCollectRawDataSize"> 
+                    <boolean>true</boolean> 
+                   </void> 
+                   <void property="tableInfo"> 
+                    <object idref="TableDesc0"/> 
+                   </void> 
+                   <void property="totalFiles"> 
+                    <int>1</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="operatorId"> 
+                  <string>FS_3</string> 
+                 </void> 
+                 <void property="parentOperators"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                      <void property="destTableId"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="dirName"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="gatherStats"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="lbCtx"> 
-                       <object idref="ListBucketingCtx0"/> 
-                      </void> 
-                      <void property="maxStatsKeyPrefixLength"> 
-                       <int>150</int> 
-                      </void> 
-                      <void property="numFiles"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="statsAggPrefix"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="statsCollectRawDataSize"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="tableInfo"> 
-                       <object idref="TableDesc0"/> 
-                      </void> 
-                      <void property="totalFiles"> 
-                       <int>1</int> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="operatorId"> 
-                     <string>FS_3</string> 
-                    </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="SelectOperator0"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="schema"> 
-                     <object idref="RowSchema0"/> 
-                    </void> 
-                   </object> 
+                   <object idref="SelectOperator0"/> 
+                  </void> 
+                 </void> 
+                 <void property="schema"> 
+                  <object idref="RowSchema0"/> 
+                 </void> 
+                </object> 
+               </void> 
+              </void> 
+              <void property="columnExprMap"> 
+               <object class="java.util.HashMap"> 
+                <void method="put"> 
+                 <string>_col1</string> 
+                 <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>value</string> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="columnExprMap"> 
-                 <object class="java.util.HashMap"> 
-                  <void method="put"> 
-                   <string>_col1</string> 
-                   <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>value</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>src</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
+                  <void property="tabAlias"> 
+                   <string>src</string> 
                   </void> 
-                  <void method="put"> 
-                   <string>_col0</string> 
-                   <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>key</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>src</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                  <void property="colList"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc1"/> 
-                    </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc0"/> 
-                    </void> 
-                   </object> 
+                <void method="put"> 
+                 <string>_col0</string> 
+                 <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>key</string> 
                   </void> 
-                  <void property="outputColumnNames"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <string>_col0</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col1</string> 
-                    </void> 
-                   </object> 
+                  <void property="tabAlias"> 
+                   <string>src</string> 
                   </void> 
-                  <void property="selectStar"> 
-                   <boolean>true</boolean> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="operatorId"> 
-                 <string>SEL_2</string> 
-                </void> 
-                <void property="parentOperators"> 
+               </object> 
+              </void> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                <void property="colList"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object idref="FilterOperator0"/> 
+                   <object idref="ExprNodeColumnDesc1"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object idref="ExprNodeColumnDesc0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>src</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>src</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                <void property="outputColumnNames"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <string>_col0</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col1</string> 
                   </void> 
                  </object> 
                 </void> 
+                <void property="selectStar"> 
+                 <boolean>true</boolean> 
+                </void> 
                </object> 
               </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-              <void property="predicate"> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
+              <void property="operatorId"> 
+               <string>SEL_2</string> 
+              </void> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="FilterOperator0"/> 
+               </void> 
+              </void> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>key</string> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
                     </void> 
                     <void property="tabAlias"> 
                      <string>src</string> 
                     </void> 
-                    <void property="typeInfo"> 
+                    <void property="type"> 
                      <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
                    </object> 
                   </void> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
-                     <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                      <void property="typeName"> 
-                       <string>int</string> 
-                      </void> 
-                     </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col1</string> 
                     </void> 
-                    <void property="value"> 
-                     <int>100</int> 
+                    <void property="tabAlias"> 
+                     <string>src</string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                  <void property="typeName"> 
-                   <string>boolean</string> 
-                  </void> 
-                 </object> 
-                </void> 
                </object> 
               </void> 
              </object> 
             </void> 
-            <void property="operatorId"> 
-             <string>FIL_1</string> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
+             <void property="predicate"> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                   <void property="column"> 
+                    <string>key</string> 
+                   </void> 
+                   <void property="tabAlias"> 
+                    <string>src</string> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo0"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                     <void property="typeName"> 
+                      <string>int</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="value"> 
+                    <int>100</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                 <void property="typeName"> 
+                  <string>boolean</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>FIL_1</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator3"/> 
             </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator3"/> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>key</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>value</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
+         <void method="add"> 
+          <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+              <void property="childOperators"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                 <void property="conf"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                   <void property="destTableId"> 
+                    <int>2</int> 
+                   </void> 
+                   <void property="dirName"> 
+                    #### A masked pattern was here #### 
+                   </void> 
+                   <void property="gatherStats"> 
+                    <boolean>true</boolean> 
+                   </void> 
+                   <void property="lbCtx"> 
+                    <object idref="ListBucketingCtx1"/> 
+                   </void> 
+                   <void property="maxStatsKeyPrefixLength"> 
+                    <int>150</int> 
+                   </void> 
+                   <void property="numFiles"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="statsAggPrefix"> 
+                    #### A masked pattern was here #### 
+                   </void> 
+                   <void property="statsCollectRawDataSize"> 
+                    <boolean>true</boolean> 
+                   </void> 
+                   <void property="tableInfo"> 
+                    <object idref="TableDesc1"/> 
+                   </void> 
+                   <void property="totalFiles"> 
+                    <int>1</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="operatorId"> 
+                  <string>FS_6</string> 
+                 </void> 
+                 <void property="parentOperators"> 
+                  <void method="add"> 
+                   <object idref="SelectOperator1"/> 
+                  </void> 
+                 </void> 
+                 <void property="schema"> 
+                  <object idref="RowSchema1"/> 
+                 </void> 
+                </object> 
+               </void> 
               </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>key</string> 
+              <void property="columnExprMap"> 
+               <object class="java.util.HashMap"> 
+                <void method="put"> 
+                 <string>_col1</string> 
+                 <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>value</string> 
                   </void> 
                   <void property="tabAlias"> 
                    <string>src</string> 
                   </void> 
-                  <void property="type"> 
+                  <void property="typeInfo"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
                  </object> 
                 </void> 
-                <void method="add"> 
-                 <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>value</string> 
+                <void method="put"> 
+                 <string>_col0</string> 
+                 <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>key</string> 
                   </void> 
                   <void property="tabAlias"> 
                    <string>src</string> 
                   </void> 
-                  <void property="type"> 
+                  <void property="typeInfo"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
                  </object> 
                 </void> 
                </object> 
               </void> 
-             </object> 
-            </void> 
-           </object> 
-          </void> 
-          <void method="add"> 
-           <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                <void property="childOperators"> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                <void property="colList"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                      <void property="destTableId"> 
-                       <int>2</int> 
-                      </void> 
-                      <void property="dirName"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="gatherStats"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="lbCtx"> 
-                       <object idref="ListBucketingCtx1"/> 
-                      </void> 
-                      <void property="maxStatsKeyPrefixLength"> 
-                       <int>150</int> 
-                      </void> 
-                      <void property="numFiles"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="statsAggPrefix"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="statsCollectRawDataSize"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="tableInfo"> 
-                       <object idref="TableDesc1"/> 
-                      </void> 
-                      <void property="totalFiles"> 
-                       <int>1</int> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="operatorId"> 
-                     <string>FS_6</string> 
-                    </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="SelectOperator1"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="schema"> 
-                     <object idref="RowSchema1"/> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="columnExprMap"> 
-                 <object class="java.util.HashMap"> 
-                  <void method="put"> 
-                   <string>_col1</string> 
-                   <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>value</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>src</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void method="put"> 
-                   <string>_col0</string> 
-                   <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>key</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>src</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                  <void property="colList"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc3"/> 
-                    </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc2"/> 
-                    </void> 
-                   </object> 
+                   <object idref="ExprNodeColumnDesc3"/> 
                   </void> 
-                  <void property="outputColumnNames"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <string>_col0</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col1</string> 
-                    </void> 
-                   </object> 
+                  <void method="add"> 
+                   <object idref="ExprNodeColumnDesc2"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="operatorId"> 
-                 <string>SEL_5</string> 
-                </void> 
-                <void property="parentOperators"> 
+                <void property="outputColumnNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object idref="FilterOperator1"/> 
+                   <string>_col0</string> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>src</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>src</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                  <void method="add"> 
+                   <string>_col1</string> 
                   </void> 
                  </object> 
                 </void> 
                </object> 
               </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-              <void property="predicate"> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
+              <void property="operatorId"> 
+               <string>SEL_5</string> 
+              </void> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="FilterOperator1"/> 
+               </void> 
+              </void> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>100</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqualOrGreaterThan"/> 
+                    <void property="tabAlias"> 
+                     <string>src</string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                    <void property="typeName"> 
+                     <string>string</string> 
                     </void> 
                    </object> 
                   </void> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>200</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col1</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string>src</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                    <void property="typeName"> 
+                     <string>string</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo2"/> 
-                </void> 
                </object> 
               </void> 
              </object> 
             </void> 
-            <void property="operatorId"> 
-             <string>FIL_4</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator3"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object idref="ColumnInfo0"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ColumnInfo1"/> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
+             <void property="predicate"> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                   <void property="children"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <void property="column"> 
+                        <string>key</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string>src</string> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo1"/> 
+                       </void> 
+                       <void property="value"> 
+                        <int>100</int> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="genericUDF"> 
+                    <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqualOrGreaterThan"/> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo2"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                   <void property="children"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <void property="column"> 
+                        <string>key</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string>src</string> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo1"/> 
+                       </void> 
+                       <void property="value"> 
+                        <int>200</int> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="genericUDF"> 
+                    <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo2"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo2"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>FIL_4</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator3"/> 
             </void> 
-           </object> 
-          </void> 
-          <void method="add"> 
-           <object id="FilterOperator2" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="SelectOperator2" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                <void property="childOperators"> 
-                 <object class="java.util.ArrayList"> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object idref="ColumnInfo0"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ColumnInfo1"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
+         <void method="add"> 
+          <object id="FilterOperator2" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object id="SelectOperator2" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+              <void property="childOperators"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                 <void property="conf"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                   <void property="destTableId"> 
+                    <int>3</int> 
+                   </void> 
+                   <void property="dirName"> 
+                    #### A masked pattern was here #### 
+                   </void> 
+                   <void property="gatherStats"> 
+                    <boolean>true</boolean> 
+                   </void> 
+                   <void property="lbCtx"> 
+                    <object idref="ListBucketingCtx2"/> 
+                   </void> 
+                   <void property="maxStatsKeyPrefixLength"> 
+                    <int>150</int> 
+                   </void> 
+                   <void property="numFiles"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="staticSpec"> 
+                    <string>ds=2008-04-08/hr=12/</string> 
+                   </void> 
+                   <void property="statsAggPrefix"> 
+                    #### A masked pattern was here #### 
+                   </void> 
+                   <void property="statsCollectRawDataSize"> 
+                    <boolean>true</boolean> 
+                   </void> 
+                   <void property="tableInfo"> 
+                    <object idref="TableDesc2"/> 
+                   </void> 
+                   <void property="totalFiles"> 
+                    <int>1</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="operatorId"> 
+                  <string>FS_9</string> 
+                 </void> 
+                 <void property="parentOperators"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                      <void property="destTableId"> 
-                       <int>3</int> 
-                      </void> 
-                      <void property="dirName"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="gatherStats"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="lbCtx"> 
-                       <object idref="ListBucketingCtx2"/> 
-                      </void> 
-                      <void property="maxStatsKeyPrefixLength"> 
-                       <int>150</int> 
-                      </void> 
-                      <void property="numFiles"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="staticSpec"> 
-                       <string>ds=2008-04-08/hr=12/</string> 
-                      </void> 
-                      <void property="statsAggPrefix"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="statsCollectRawDataSize"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="tableInfo"> 
-                       <object idref="TableDesc2"/> 
-                      </void> 
-                      <void property="totalFiles"> 
-                       <int>1</int> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="operatorId"> 
-                     <string>FS_9</string> 
-                    </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="SelectOperator2"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="schema"> 
-                     <object idref="RowSchema2"/> 
-                    </void> 
-                   </object> 
+                   <object idref="SelectOperator2"/> 
+                  </void> 
+                 </void> 
+                 <void property="schema"> 
+                  <object idref="RowSchema2"/> 
+                 </void> 
+                </object> 
+               </void> 
+              </void> 
+              <void property="columnExprMap"> 
+               <object class="java.util.HashMap"> 
+                <void method="put"> 
+                 <string>_col1</string> 
+                 <object id="ExprNodeConstantDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo1"/> 
+                  </void> 
+                  <void property="value"> 
+                   <int>2</int> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="columnExprMap"> 
-                 <object class="java.util.HashMap"> 
-                  <void method="put"> 
-                   <string>_col1</string> 
-                   <object id="ExprNodeConstantDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
-                    </void> 
-                    <void property="value"> 
-                     <int>2</int> 
-                    </void> 
-                   </object> 
+                <void method="put"> 
+                 <string>_col0</string> 
+                 <object id="ExprNodeColumnDesc4" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>key</string> 
                   </void> 
-                  <void method="put"> 
-                   <string>_col0</string> 
-                   <object id="ExprNodeColumnDesc4" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>key</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>src</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
+                  <void property="tabAlias"> 
+                   <string>src</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                  <void property="colList"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc4"/> 
-                    </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeConstantDesc0"/> 
-                    </void> 
-                   </object> 
+               </object> 
+              </void> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                <void property="colList"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object idref="ExprNodeColumnDesc4"/> 
                   </void> 
-                  <void property="outputColumnNames"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <string>_col0</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col1</string> 
-                    </void> 
-                   </object> 
+                  <void method="add"> 
+                   <object idref="ExprNodeConstantDesc0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="operatorId"> 
-                 <string>SEL_8</string> 
-                </void> 
-                <void property="parentOperators"> 
+                <void property="outputColumnNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object idref="FilterOperator2"/> 
+                   <string>_col0</string> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>src</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo1"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>int</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                  <void method="add"> 
+                   <string>_col1</string> 
                   </void> 
                  </object> 
                 </void> 
                </object> 
               </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-              <void property="predicate"> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
+              <void property="operatorId"> 
+               <string>SEL_8</string> 
+              </void> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="FilterOperator2"/> 
+               </void> 
+              </void> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>key</string> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
                     </void> 
                     <void property="tabAlias"> 
                      <string>src</string> 
                     </void> 
-                    <void property="typeInfo"> 
+                    <void property="type"> 
                      <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
                    </object> 
                   </void> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col1</string> 
+                    </void> 
+                    <void property="type"> 
                      <object idref="PrimitiveTypeInfo1"/> 
                     </void> 
-                    <void property="value"> 
-                     <int>200</int> 
+                    <void property="typeName"> 
+                     <string>int</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqualOrGreaterThan"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo2"/> 
-                </void> 
                </object> 
               </void> 
              </object> 
             </void> 
-            <void property="operatorId"> 
-             <string>FIL_7</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator3"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object idref="ColumnInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
+             <void property="predicate"> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                   <void property="column"> 
+                    <string>key</string> 
+                   </void> 
+                   <void property="tabAlias"> 
+                    <string>src</string> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo0"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo1"/> 
+                   </void> 
+                   <void property="value"> 
+                    <int>200</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqualOrGreaterThan"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo2"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>FIL_7</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator3"/> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object idref="ColumnInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
diff --git a/ql/src/test/results/compiler/plan/input20.q.xml b/ql/src/test/results/compiler/plan/input20.q.xml
index 0e031a6fbe..bce5b9b465 100644
--- a/ql/src/test/results/compiler/plan/input20.q.xml
+++ b/ql/src/test/results/compiler/plan/input20.q.xml
@@ -153,530 +153,518 @@
        <string>tmap:src</string> 
        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="ScriptOperator0" class="org.apache.hadoop.hive.ql.exec.ScriptOperator"> 
-                <void property="childOperators"> 
-                 <object class="java.util.ArrayList"> 
+         <void method="add"> 
+          <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object id="ScriptOperator0" class="org.apache.hadoop.hive.ql.exec.ScriptOperator"> 
+              <void property="childOperators"> 
+               <void method="add"> 
+                <object id="ReduceSinkOperator0" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
+                 <void property="columnExprMap"> 
+                  <object class="java.util.HashMap"> 
+                   <void method="put"> 
+                    <string>_col1</string> 
+                    <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                     <void property="column"> 
+                      <string>_col1</string> 
+                     </void> 
+                     <void property="typeInfo"> 
+                      <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void method="put"> 
+                    <string>_col0</string> 
+                    <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                     <void property="column"> 
+                      <string>_col0</string> 
+                     </void> 
+                     <void property="typeInfo"> 
+                      <object idref="PrimitiveTypeInfo0"/> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="conf"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
+                   <void property="distinctColumnIndices"> 
+                    <object class="java.util.ArrayList"/> 
+                   </void> 
+                   <void property="keyCols"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <void property="column"> 
+                        <string>_col0</string> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="keySerializeInfo"> 
+                    <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                     <void property="inputFileFormatClass"> 
+                      <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                     </void> 
+                     <void property="outputFileFormatClass"> 
+                      <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                     </void> 
+                     <void property="properties"> 
+                      <object class="java.util.Properties"> 
+                       <void method="put"> 
+                        <string>columns</string> 
+                        <string>reducesinkkey0</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.lib</string> 
+                        <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.sort.order</string> 
+                        <string>+</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns.types</string> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="numDistributionKeys"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="numReducers"> 
+                    <int>-1</int> 
+                   </void> 
+                   <void property="outputKeyColumnNames"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <string>reducesinkkey0</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="outputValueColumnNames"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <string>_col0</string> 
+                     </void> 
+                     <void method="add"> 
+                      <string>_col1</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="partitionCols"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <void property="column"> 
+                        <string>_col0</string> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="tag"> 
+                    <int>-1</int> 
+                   </void> 
+                   <void property="valueCols"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object idref="ExprNodeColumnDesc1"/> 
+                     </void> 
+                     <void method="add"> 
+                      <object idref="ExprNodeColumnDesc0"/> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="valueSerializeInfo"> 
+                    <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                     <void property="inputFileFormatClass"> 
+                      <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                     </void> 
+                     <void property="outputFileFormatClass"> 
+                      <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                     </void> 
+                     <void property="properties"> 
+                      <object class="java.util.Properties"> 
+                       <void method="put"> 
+                        <string>columns</string> 
+                        <string>_col0,_col1</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.lib</string> 
+                        <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns.types</string> 
+                        <string>string,string</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>escape.delim</string> 
+                        <string>\</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="operatorId"> 
+                  <string>RS_3</string> 
+                 </void> 
+                 <void property="parentOperators"> 
                   <void method="add"> 
-                   <object id="ReduceSinkOperator0" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
-                    <void property="columnExprMap"> 
-                     <object class="java.util.HashMap"> 
-                      <void method="put"> 
-                       <string>_col1</string> 
-                       <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>_col1</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="put"> 
-                       <string>_col0</string> 
-                       <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
-                      <void property="distinctColumnIndices"> 
-                       <object class="java.util.ArrayList"/> 
-                      </void> 
-                      <void property="keyCols"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                          <void property="column"> 
-                           <string>_col0</string> 
-                          </void> 
-                          <void property="typeInfo"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="keySerializeInfo"> 
-                       <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                        <void property="inputFileFormatClass"> 
-                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                        </void> 
-                        <void property="outputFileFormatClass"> 
-                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                        </void> 
-                        <void property="properties"> 
-                         <object class="java.util.Properties"> 
-                          <void method="put"> 
-                           <string>columns</string> 
-                           <string>reducesinkkey0</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.lib</string> 
-                           <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.sort.order</string> 
-                           <string>+</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns.types</string> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="numDistributionKeys"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="numReducers"> 
-                       <int>-1</int> 
-                      </void> 
-                      <void property="outputKeyColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>reducesinkkey0</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="outputValueColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void method="add"> 
-                         <string>_col1</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="partitionCols"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                          <void property="column"> 
-                           <string>_col0</string> 
-                          </void> 
-                          <void property="typeInfo"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="tag"> 
-                       <int>-1</int> 
-                      </void> 
-                      <void property="valueCols"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc1"/> 
-                        </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="valueSerializeInfo"> 
-                       <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                        <void property="inputFileFormatClass"> 
-                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                        </void> 
-                        <void property="outputFileFormatClass"> 
-                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                        </void> 
-                        <void property="properties"> 
-                         <object class="java.util.Properties"> 
-                          <void method="put"> 
-                           <string>columns</string> 
-                           <string>_col0,_col1</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.lib</string> 
-                           <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns.types</string> 
-                           <string>string,string</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>escape.delim</string> 
-                           <string>\</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="operatorId"> 
-                     <string>RS_3</string> 
-                    </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="ScriptOperator0"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="schema"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                      <void property="signature"> 
-                       <object id="ArrayList0" class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="alias"> 
-                           <string>key</string> 
-                          </void> 
-                          <void property="internalName"> 
-                           <string>_col0</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="alias"> 
-                           <string>value</string> 
-                          </void> 
-                          <void property="internalName"> 
-                           <string>_col1</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                   <object idref="ScriptOperator0"/> 
                   </void> 
-                 </object> 
+                 </void> 
+                 <void property="schema"> 
+                  <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                   <void property="signature"> 
+                    <object id="ArrayList0" class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="alias"> 
+                        <string>key</string> 
+                       </void> 
+                       <void property="internalName"> 
+                        <string>_col0</string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="alias"> 
+                        <string>value</string> 
+                       </void> 
+                       <void property="internalName"> 
+                        <string>_col1</string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+              </void> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.ScriptDesc"> 
+                <void property="errRecordReaderClass"> 
+                 <class>org.apache.hadoop.hive.ql.exec.TextRecordReader</class> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.ScriptDesc"> 
-                  <void property="errRecordReaderClass"> 
-                   <class>org.apache.hadoop.hive.ql.exec.TextRecordReader</class> 
-                  </void> 
-                  <void property="inRecordWriterClass"> 
-                   <class>org.apache.hadoop.hive.ql.exec.TextRecordWriter</class> 
-                  </void> 
-                  <void property="outRecordReaderClass"> 
-                   <class>org.apache.hadoop.hive.ql.exec.TextRecordReader</class> 
+                <void property="inRecordWriterClass"> 
+                 <class>org.apache.hadoop.hive.ql.exec.TextRecordWriter</class> 
+                </void> 
+                <void property="outRecordReaderClass"> 
+                 <class>org.apache.hadoop.hive.ql.exec.TextRecordReader</class> 
+                </void> 
+                <void property="scriptCmd"> 
+                 <string>cat</string> 
+                </void> 
+                <void property="scriptErrInfo"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                  <void property="inputFileFormatClass"> 
+                   <class>org.apache.hadoop.mapred.TextInputFormat</class> 
                   </void> 
-                  <void property="scriptCmd"> 
-                   <string>cat</string> 
+                  <void property="outputFileFormatClass"> 
+                   <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
                   </void> 
-                  <void property="scriptErrInfo"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                    <void property="inputFileFormatClass"> 
-                     <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                  <void property="properties"> 
+                   <object class="java.util.Properties"> 
+                    <void method="put"> 
+                     <string>field.delim</string> 
+                     <string>9</string> 
                     </void> 
-                    <void property="outputFileFormatClass"> 
-                     <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                    <void method="put"> 
+                     <string>columns</string> 
+                     <string>KEY</string> 
                     </void> 
-                    <void property="properties"> 
-                     <object class="java.util.Properties"> 
-                      <void method="put"> 
-                       <string>field.delim</string> 
-                       <string>9</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>columns</string> 
-                       <string>KEY</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.lib</string> 
-                       <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.format</string> 
-                       <string>9</string> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>serialization.lib</string> 
+                     <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
                     </void> 
-                   </object> 
-                  </void> 
-                  <void property="scriptInputInfo"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                    <void property="inputFileFormatClass"> 
-                     <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-                    </void> 
-                    <void property="outputFileFormatClass"> 
-                     <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-                    </void> 
-                    <void property="properties"> 
-                     <object class="java.util.Properties"> 
-                      <void method="put"> 
-                       <string>field.delim</string> 
-                       <string>9</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>columns</string> 
-                       <string>_col0,_col1</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.lib</string> 
-                       <string>org.apache.hadoop.hive.serde2.DelimitedJSONSerDe</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.format</string> 
-                       <string>9</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>columns.types</string> 
-                       <string>double,double</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void property="scriptOutputInfo"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                    <void property="inputFileFormatClass"> 
-                     <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-                    </void> 
-                    <void property="outputFileFormatClass"> 
-                     <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-                    </void> 
-                    <void property="properties"> 
-                     <object class="java.util.Properties"> 
-                      <void method="put"> 
-                       <string>field.delim</string> 
-                       <string>9</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>columns</string> 
-                       <string>_col0,_col1</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.lib</string> 
-                       <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.format</string> 
-                       <string>9</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>columns.types</string> 
-                       <string>string,string</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.last.column.takes.rest</string> 
-                       <string>true</string> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>serialization.format</string> 
+                     <string>9</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="operatorId"> 
-                 <string>SCR_2</string> 
-                </void> 
-                <void property="parentOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object idref="SelectOperator0"/> 
+                <void property="scriptInputInfo"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                  <void property="inputFileFormatClass"> 
+                   <class>org.apache.hadoop.mapred.TextInputFormat</class> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object idref="ArrayList0"/> 
+                  <void property="outputFileFormatClass"> 
+                   <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
                   </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="columnExprMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>_col1</string> 
-               <object id="ExprNodeGenericFuncDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>key</string> 
+                  <void property="properties"> 
+                   <object class="java.util.Properties"> 
+                    <void method="put"> 
+                     <string>field.delim</string> 
+                     <string>9</string> 
                     </void> 
-                    <void property="tabAlias"> 
-                     <string>src</string> 
+                    <void method="put"> 
+                     <string>columns</string> 
+                     <string>_col0,_col1</string> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
+                    <void method="put"> 
+                     <string>serialization.lib</string> 
+                     <string>org.apache.hadoop.hive.serde2.DelimitedJSONSerDe</string> 
                     </void> 
-                   </object> 
-                  </void> 
-                  <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
-                     <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                      <void property="typeName"> 
-                       <string>int</string> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>serialization.format</string> 
+                     <string>9</string> 
                     </void> 
-                    <void property="value"> 
-                     <int>5</int> 
+                    <void method="put"> 
+                     <string>columns.types</string> 
+                     <string>double,double</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPMod"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                  <void property="typeName"> 
-                   <string>double</string> 
+                <void property="scriptOutputInfo"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                  <void property="inputFileFormatClass"> 
+                   <class>org.apache.hadoop.mapred.TextInputFormat</class> 
                   </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>_col0</string> 
-               <object id="ExprNodeGenericFuncDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>key</string> 
+                  <void property="outputFileFormatClass"> 
+                   <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                  </void> 
+                  <void property="properties"> 
+                   <object class="java.util.Properties"> 
+                    <void method="put"> 
+                     <string>field.delim</string> 
+                     <string>9</string> 
                     </void> 
-                    <void property="tabAlias"> 
-                     <string>src</string> 
+                    <void method="put"> 
+                     <string>columns</string> 
+                     <string>_col0,_col1</string> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
+                    <void method="put"> 
+                     <string>serialization.lib</string> 
+                     <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
                     </void> 
-                   </object> 
-                  </void> 
-                  <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
+                    <void method="put"> 
+                     <string>serialization.format</string> 
+                     <string>9</string> 
+                    </void> 
+                    <void method="put"> 
+                     <string>columns.types</string> 
+                     <string>string,string</string> 
                     </void> 
-                    <void property="value"> 
-                     <int>2</int> 
+                    <void method="put"> 
+                     <string>serialization.last.column.takes.rest</string> 
+                     <string>true</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPMod"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo2"/> 
-                </void> 
                </object> 
               </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-              <void property="colList"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object idref="ExprNodeGenericFuncDesc1"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeGenericFuncDesc0"/> 
-                </void> 
-               </object> 
+              <void property="operatorId"> 
+               <string>SCR_2</string> 
               </void> 
-              <void property="outputColumnNames"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <string>_col0</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col1</string> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="operatorId"> 
-             <string>SEL_1</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator0"/> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="SelectOperator0"/> 
+               </void> 
               </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>_col0</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo2"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>double</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>_col1</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo2"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>double</string> 
-                  </void> 
-                 </object> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
+                 <object idref="ArrayList0"/> 
                 </void> 
                </object> 
               </void> 
              </object> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="columnExprMap"> 
+            <object class="java.util.HashMap"> 
+             <void method="put"> 
+              <string>_col1</string> 
+              <object id="ExprNodeGenericFuncDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                   <void property="column"> 
+                    <string>key</string> 
+                   </void> 
+                   <void property="tabAlias"> 
+                    <string>src</string> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo0"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                     <void property="typeName"> 
+                      <string>int</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="value"> 
+                    <int>5</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPMod"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                 <void property="typeName"> 
+                  <string>double</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col0</string> 
+              <object id="ExprNodeGenericFuncDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                   <void property="column"> 
+                    <string>key</string> 
+                   </void> 
+                   <void property="tabAlias"> 
+                    <string>src</string> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo0"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo1"/> 
+                   </void> 
+                   <void property="value"> 
+                    <int>2</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPMod"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo2"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+             <void property="colList"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object idref="ExprNodeGenericFuncDesc1"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeGenericFuncDesc0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="outputColumnNames"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <string>_col0</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col1</string> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>SEL_1</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator0"/> 
+            </void> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>_col0</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo2"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>double</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>_col1</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo2"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>double</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
@@ -977,287 +965,229 @@
       <void property="reducer"> 
        <object id="ExtractOperator0" class="org.apache.hadoop.hive.ql.exec.ExtractOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="ScriptOperator1" class="org.apache.hadoop.hive.ql.exec.ScriptOperator"> 
-                <void property="childOperators"> 
-                 <object class="java.util.ArrayList"> 
+         <void method="add"> 
+          <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object id="ScriptOperator1" class="org.apache.hadoop.hive.ql.exec.ScriptOperator"> 
+              <void property="childOperators"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                 <void property="conf"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                   <void property="dirName"> 
+                    #### A masked pattern was here #### 
+                   </void> 
+                   <void property="numFiles"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="statsAggPrefix"> 
+                    #### A masked pattern was here #### 
+                   </void> 
+                   <void property="statsCollectRawDataSize"> 
+                    <boolean>true</boolean> 
+                   </void> 
+                   <void property="tableInfo"> 
+                    <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                     <void property="inputFileFormatClass"> 
+                      <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                     </void> 
+                     <void property="outputFileFormatClass"> 
+                      <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                     </void> 
+                     <void property="properties"> 
+                      <object class="java.util.Properties"> 
+                       <void method="put"> 
+                        <string>hive.serialization.extend.nesting.levels</string> 
+                        <string>true</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns</string> 
+                        <string>_col0,_col1</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.lib</string> 
+                        <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.format</string> 
+                        <string>1</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns.types</string> 
+                        <string>string:string</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>escape.delim</string> 
+                        <string>\</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="totalFiles"> 
+                    <int>1</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="operatorId"> 
+                  <string>FS_7</string> 
+                 </void> 
+                 <void property="parentOperators"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                      <void property="dirName"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="numFiles"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="statsAggPrefix"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="statsCollectRawDataSize"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="tableInfo"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                        <void property="inputFileFormatClass"> 
-                         <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-                        </void> 
-                        <void property="outputFileFormatClass"> 
-                         <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-                        </void> 
-                        <void property="properties"> 
-                         <object class="java.util.Properties"> 
-                          <void method="put"> 
-                           <string>hive.serialization.extend.nesting.levels</string> 
-                           <string>true</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns</string> 
-                           <string>_col0,_col1</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.lib</string> 
-                           <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.format</string> 
-                           <string>1</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns.types</string> 
-                           <string>string:string</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>escape.delim</string> 
-                           <string>\</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="totalFiles"> 
-                       <int>1</int> 
-                      </void> 
-                     </object> 
+                   <object idref="ScriptOperator1"/> 
+                  </void> 
+                 </void> 
+                 <void property="schema"> 
+                  <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                   <void property="signature"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>_col0</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string></string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>_col1</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string></string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+              </void> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.ScriptDesc"> 
+                <void property="errRecordReaderClass"> 
+                 <class>org.apache.hadoop.hive.ql.exec.TextRecordReader</class> 
+                </void> 
+                <void property="inRecordWriterClass"> 
+                 <class>org.apache.hadoop.hive.ql.exec.TextRecordWriter</class> 
+                </void> 
+                <void property="outRecordReaderClass"> 
+                 <class>org.apache.hadoop.hive.ql.exec.TextRecordReader</class> 
+                </void> 
+                <void property="scriptCmd"> 
+                 <string>uniq -c | sed &quot;s@^ *@@&quot; | sed &quot;s@\t@_@&quot; | sed &quot;s@ @\t@&quot;</string> 
+                </void> 
+                <void property="scriptErrInfo"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                  <void property="inputFileFormatClass"> 
+                   <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                  </void> 
+                  <void property="outputFileFormatClass"> 
+                   <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                  </void> 
+                  <void property="properties"> 
+                   <object class="java.util.Properties"> 
+                    <void method="put"> 
+                     <string>field.delim</string> 
+                     <string>9</string> 
                     </void> 
-                    <void property="operatorId"> 
-                     <string>FS_7</string> 
+                    <void method="put"> 
+                     <string>columns</string> 
+                     <string>KEY</string> 
                     </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="ScriptOperator1"/> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>serialization.lib</string> 
+                     <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
                     </void> 
-                    <void property="schema"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                      <void property="signature"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col0</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string></string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col1</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string></string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>serialization.format</string> 
+                     <string>9</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.ScriptDesc"> 
-                  <void property="errRecordReaderClass"> 
-                   <class>org.apache.hadoop.hive.ql.exec.TextRecordReader</class> 
+                <void property="scriptInputInfo"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                  <void property="inputFileFormatClass"> 
+                   <class>org.apache.hadoop.mapred.TextInputFormat</class> 
                   </void> 
-                  <void property="inRecordWriterClass"> 
-                   <class>org.apache.hadoop.hive.ql.exec.TextRecordWriter</class> 
+                  <void property="outputFileFormatClass"> 
+                   <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
                   </void> 
-                  <void property="outRecordReaderClass"> 
-                   <class>org.apache.hadoop.hive.ql.exec.TextRecordReader</class> 
-                  </void> 
-                  <void property="scriptCmd"> 
-                   <string>uniq -c | sed &quot;s@^ *@@&quot; | sed &quot;s@\t@_@&quot; | sed &quot;s@ @\t@&quot;</string> 
-                  </void> 
-                  <void property="scriptErrInfo"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                    <void property="inputFileFormatClass"> 
-                     <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-                    </void> 
-                    <void property="outputFileFormatClass"> 
-                     <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                  <void property="properties"> 
+                   <object class="java.util.Properties"> 
+                    <void method="put"> 
+                     <string>field.delim</string> 
+                     <string>9</string> 
                     </void> 
-                    <void property="properties"> 
-                     <object class="java.util.Properties"> 
-                      <void method="put"> 
-                       <string>field.delim</string> 
-                       <string>9</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>columns</string> 
-                       <string>KEY</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.lib</string> 
-                       <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.format</string> 
-                       <string>9</string> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>columns</string> 
+                     <string>_col0,_col1</string> 
                     </void> 
-                   </object> 
-                  </void> 
-                  <void property="scriptInputInfo"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                    <void property="inputFileFormatClass"> 
-                     <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                    <void method="put"> 
+                     <string>serialization.lib</string> 
+                     <string>org.apache.hadoop.hive.serde2.DelimitedJSONSerDe</string> 
                     </void> 
-                    <void property="outputFileFormatClass"> 
-                     <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                    <void method="put"> 
+                     <string>serialization.format</string> 
+                     <string>9</string> 
                     </void> 
-                    <void property="properties"> 
-                     <object class="java.util.Properties"> 
-                      <void method="put"> 
-                       <string>field.delim</string> 
-                       <string>9</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>columns</string> 
-                       <string>_col0,_col1</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.lib</string> 
-                       <string>org.apache.hadoop.hive.serde2.DelimitedJSONSerDe</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.format</string> 
-                       <string>9</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>columns.types</string> 
-                       <string>string,string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void property="scriptOutputInfo"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                    <void property="inputFileFormatClass"> 
-                     <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-                    </void> 
-                    <void property="outputFileFormatClass"> 
-                     <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-                    </void> 
-                    <void property="properties"> 
-                     <object class="java.util.Properties"> 
-                      <void method="put"> 
-                       <string>field.delim</string> 
-                       <string>9</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>columns</string> 
-                       <string>_col0,_col1</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.lib</string> 
-                       <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.format</string> 
-                       <string>9</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>columns.types</string> 
-                       <string>string,string</string> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>columns.types</string> 
+                     <string>string,string</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="operatorId"> 
-                 <string>SCR_6</string> 
-                </void> 
-                <void property="parentOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object idref="SelectOperator1"/> 
+                <void property="scriptOutputInfo"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                  <void property="inputFileFormatClass"> 
+                   <class>org.apache.hadoop.mapred.TextInputFormat</class> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="alias"> 
-                       <string>key</string> 
-                      </void> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
+                  <void property="outputFileFormatClass"> 
+                   <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                  </void> 
+                  <void property="properties"> 
+                   <object class="java.util.Properties"> 
+                    <void method="put"> 
+                     <string>field.delim</string> 
+                     <string>9</string> 
+                    </void> 
+                    <void method="put"> 
+                     <string>columns</string> 
+                     <string>_col0,_col1</string> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="alias"> 
-                       <string>value</string> 
-                      </void> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>serialization.lib</string> 
+                     <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                    </void> 
+                    <void method="put"> 
+                     <string>serialization.format</string> 
+                     <string>9</string> 
+                    </void> 
+                    <void method="put"> 
+                     <string>columns.types</string> 
+                     <string>string,string</string> 
                     </void> 
                    </object> 
                   </void> 
@@ -1265,101 +1195,49 @@
                 </void> 
                </object> 
               </void> 
-             </object> 
-            </void> 
-            <void property="columnExprMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>_col1</string> 
-               <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>_col1</string> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string>tmap</string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>_col0</string> 
-               <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>_col0</string> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string>tmap</string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-              <void property="colList"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object idref="ExprNodeColumnDesc3"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeColumnDesc2"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void property="outputColumnNames"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <string>_col0</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col1</string> 
-                </void> 
-               </object> 
+              <void property="operatorId"> 
+               <string>SCR_6</string> 
               </void> 
-             </object> 
-            </void> 
-            <void property="operatorId"> 
-             <string>SEL_5</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="ExtractOperator0"/> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="SelectOperator1"/> 
+               </void> 
               </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>_col0</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>_col1</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="alias"> 
+                     <string>key</string> 
+                    </void> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
                   </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="alias"> 
+                     <string>value</string> 
+                    </void> 
+                    <void property="internalName"> 
+                     <string>_col1</string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
                   </void> 
                  </object> 
                 </void> 
@@ -1367,9 +1245,107 @@
               </void> 
              </object> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="columnExprMap"> 
+            <object class="java.util.HashMap"> 
+             <void method="put"> 
+              <string>_col1</string> 
+              <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>_col1</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>tmap</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col0</string> 
+              <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>_col0</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>tmap</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+             <void property="colList"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object idref="ExprNodeColumnDesc3"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeColumnDesc2"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="outputColumnNames"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <string>_col0</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col1</string> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>SEL_5</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="ExtractOperator0"/> 
+            </void> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>_col0</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>_col1</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.ExtractDesc"> 
@@ -1392,11 +1368,9 @@
          <string>EX_4</string> 
         </void> 
         <void property="parentOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object idref="ReduceSinkOperator0"/> 
-          </void> 
-         </object> 
+         <void method="add"> 
+          <object idref="ReduceSinkOperator0"/> 
+         </void> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
diff --git a/ql/src/test/results/compiler/plan/input3.q.xml b/ql/src/test/results/compiler/plan/input3.q.xml
index 48eeca5eaf..43b57e79fa 100755
--- a/ql/src/test/results/compiler/plan/input3.q.xml
+++ b/ql/src/test/results/compiler/plan/input3.q.xml
@@ -79,137 +79,133 @@
                        #### A masked pattern was here #### 
                        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                         <void property="childOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                            <void property="conf"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                              <void property="dirName"> 
-                               #### A masked pattern was here #### 
-                              </void> 
-                              <void property="numFiles"> 
-                               <int>1</int> 
-                              </void> 
-                              <void property="tableInfo"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                                <void property="inputFileFormatClass"> 
-                                 <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-                                </void> 
-                                <void property="outputFileFormatClass"> 
-                                 <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-                                </void> 
-                                <void property="properties"> 
-                                 <object class="java.util.Properties"> 
-                                  <void method="put"> 
-                                   <string>name</string> 
-                                   <string>default.dest1</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>columns.types</string> 
-                                   <string>string:string</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.ddl</string> 
-                                   <string>struct dest1 { string key, string value}</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.format</string> 
-                                   <string>1</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>columns</string> 
-                                   <string>key,value</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>bucket_count</string> 
-                                   <string>-1</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.lib</string> 
-                                   <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>file.inputformat</string> 
-                                   <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>location</string> 
-                                   #### A masked pattern was here #### 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>file.outputformat</string> 
-                                   <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>transient_lastDdlTime</string> 
-                                   #### A masked pattern was here #### 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void property="totalFiles"> 
-                               <int>1</int> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="operatorId"> 
-                             <string>FS_14</string> 
-                            </void> 
-                            <void property="parentOperators"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object idref="TableScanOperator0"/> 
-                              </void> 
-                             </object> 
+                         <void method="add"> 
+                          <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                           <void property="conf"> 
+                            <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                             <void property="dirName"> 
+                              #### A masked pattern was here #### 
+                             </void> 
+                             <void property="numFiles"> 
+                              <int>1</int> 
+                             </void> 
+                             <void property="tableInfo"> 
+                              <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                               <void property="inputFileFormatClass"> 
+                                <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                               </void> 
+                               <void property="outputFileFormatClass"> 
+                                <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                               </void> 
+                               <void property="properties"> 
+                                <object class="java.util.Properties"> 
+                                 <void method="put"> 
+                                  <string>name</string> 
+                                  <string>default.dest1</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>columns.types</string> 
+                                  <string>string:string</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.ddl</string> 
+                                  <string>struct dest1 { string key, string value}</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.format</string> 
+                                  <string>1</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>columns</string> 
+                                  <string>key,value</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>bucket_count</string> 
+                                  <string>-1</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.lib</string> 
+                                  <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>file.inputformat</string> 
+                                  <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>location</string> 
+                                  #### A masked pattern was here #### 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>file.outputformat</string> 
+                                  <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>transient_lastDdlTime</string> 
+                                  #### A masked pattern was here #### 
+                                 </void> 
+                                </object> 
+                               </void> 
+                              </object> 
+                             </void> 
+                             <void property="totalFiles"> 
+                              <int>1</int> 
+                             </void> 
+                            </object> 
+                           </void> 
+                           <void property="operatorId"> 
+                            <string>FS_14</string> 
+                           </void> 
+                           <void property="parentOperators"> 
+                            <void method="add"> 
+                             <object idref="TableScanOperator0"/> 
                             </void> 
-                            <void property="schema"> 
-                             <object id="RowSchema0" class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                              <void property="signature"> 
-                               <object class="java.util.ArrayList"> 
-                                <void method="add"> 
-                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                  <void property="internalName"> 
-                                   <string>key</string> 
-                                  </void> 
-                                  <void property="tabAlias"> 
-                                   <string></string> 
-                                  </void> 
-                                  <void property="type"> 
-                                   <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                                    <void property="typeName"> 
-                                     <string>string</string> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                  <void property="typeName"> 
-                                   <string>string</string> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void method="add"> 
-                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                  <void property="internalName"> 
-                                   <string>value</string> 
-                                  </void> 
-                                  <void property="tabAlias"> 
-                                   <string></string> 
-                                  </void> 
-                                  <void property="type"> 
-                                   <object idref="PrimitiveTypeInfo0"/> 
-                                  </void> 
-                                  <void property="typeName"> 
-                                   <string>string</string> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
+                           </void> 
+                           <void property="schema"> 
+                            <object id="RowSchema0" class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                             <void property="signature"> 
+                              <object class="java.util.ArrayList"> 
+                               <void method="add"> 
+                                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                 <void property="internalName"> 
+                                  <string>key</string> 
+                                 </void> 
+                                 <void property="tabAlias"> 
+                                  <string></string> 
+                                 </void> 
+                                 <void property="type"> 
+                                  <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                                   <void property="typeName"> 
+                                    <string>string</string> 
+                                   </void> 
+                                  </object> 
+                                 </void> 
+                                 <void property="typeName"> 
+                                  <string>string</string> 
+                                 </void> 
+                                </object> 
+                               </void> 
+                               <void method="add"> 
+                                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                 <void property="internalName"> 
+                                  <string>value</string> 
+                                 </void> 
+                                 <void property="tabAlias"> 
+                                  <string></string> 
+                                 </void> 
+                                 <void property="type"> 
+                                  <object idref="PrimitiveTypeInfo0"/> 
+                                 </void> 
+                                 <void property="typeName"> 
+                                  <string>string</string> 
+                                 </void> 
+                                </object> 
+                               </void> 
+                              </object> 
+                             </void> 
+                            </object> 
+                           </void> 
+                          </object> 
+                         </void> 
                         </void> 
                         <void property="conf"> 
                          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"/> 
@@ -560,133 +556,129 @@
                        #### A masked pattern was here #### 
                        <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                         <void property="childOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                            <void property="conf"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                              <void property="dirName"> 
-                               #### A masked pattern was here #### 
-                              </void> 
-                              <void property="numFiles"> 
-                               <int>1</int> 
-                              </void> 
-                              <void property="tableInfo"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                                <void property="inputFileFormatClass"> 
-                                 <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-                                </void> 
-                                <void property="outputFileFormatClass"> 
-                                 <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-                                </void> 
-                                <void property="properties"> 
-                                 <object class="java.util.Properties"> 
-                                  <void method="put"> 
-                                   <string>name</string> 
-                                   <string>default.dest2</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>columns.types</string> 
-                                   <string>string:string</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.ddl</string> 
-                                   <string>struct dest2 { string key, string value}</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.format</string> 
-                                   <string>1</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>columns</string> 
-                                   <string>key,value</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>bucket_count</string> 
-                                   <string>-1</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.lib</string> 
-                                   <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>file.inputformat</string> 
-                                   <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>location</string> 
-                                   #### A masked pattern was here #### 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>file.outputformat</string> 
-                                   <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>transient_lastDdlTime</string> 
-                                   #### A masked pattern was here #### 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void property="totalFiles"> 
-                               <int>1</int> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="operatorId"> 
-                             <string>FS_16</string> 
-                            </void> 
-                            <void property="parentOperators"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object idref="TableScanOperator1"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="schema"> 
-                             <object id="RowSchema1" class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                              <void property="signature"> 
-                               <object class="java.util.ArrayList"> 
-                                <void method="add"> 
-                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                  <void property="internalName"> 
-                                   <string>key</string> 
-                                  </void> 
-                                  <void property="tabAlias"> 
-                                   <string></string> 
-                                  </void> 
-                                  <void property="type"> 
-                                   <object idref="PrimitiveTypeInfo0"/> 
-                                  </void> 
-                                  <void property="typeName"> 
-                                   <string>string</string> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void method="add"> 
-                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                  <void property="internalName"> 
-                                   <string>value</string> 
-                                  </void> 
-                                  <void property="tabAlias"> 
-                                   <string></string> 
-                                  </void> 
-                                  <void property="type"> 
-                                   <object idref="PrimitiveTypeInfo0"/> 
-                                  </void> 
-                                  <void property="typeName"> 
-                                   <string>string</string> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
+                         <void method="add"> 
+                          <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                           <void property="conf"> 
+                            <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                             <void property="dirName"> 
+                              #### A masked pattern was here #### 
+                             </void> 
+                             <void property="numFiles"> 
+                              <int>1</int> 
+                             </void> 
+                             <void property="tableInfo"> 
+                              <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                               <void property="inputFileFormatClass"> 
+                                <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                               </void> 
+                               <void property="outputFileFormatClass"> 
+                                <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                               </void> 
+                               <void property="properties"> 
+                                <object class="java.util.Properties"> 
+                                 <void method="put"> 
+                                  <string>name</string> 
+                                  <string>default.dest2</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>columns.types</string> 
+                                  <string>string:string</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.ddl</string> 
+                                  <string>struct dest2 { string key, string value}</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.format</string> 
+                                  <string>1</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>columns</string> 
+                                  <string>key,value</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>bucket_count</string> 
+                                  <string>-1</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.lib</string> 
+                                  <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>file.inputformat</string> 
+                                  <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>location</string> 
+                                  #### A masked pattern was here #### 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>file.outputformat</string> 
+                                  <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>transient_lastDdlTime</string> 
+                                  #### A masked pattern was here #### 
+                                 </void> 
+                                </object> 
+                               </void> 
+                              </object> 
+                             </void> 
+                             <void property="totalFiles"> 
+                              <int>1</int> 
+                             </void> 
+                            </object> 
+                           </void> 
+                           <void property="operatorId"> 
+                            <string>FS_16</string> 
+                           </void> 
+                           <void property="parentOperators"> 
+                            <void method="add"> 
+                             <object idref="TableScanOperator1"/> 
                             </void> 
-                           </object> 
-                          </void> 
-                         </object> 
+                           </void> 
+                           <void property="schema"> 
+                            <object id="RowSchema1" class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                             <void property="signature"> 
+                              <object class="java.util.ArrayList"> 
+                               <void method="add"> 
+                                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                 <void property="internalName"> 
+                                  <string>key</string> 
+                                 </void> 
+                                 <void property="tabAlias"> 
+                                  <string></string> 
+                                 </void> 
+                                 <void property="type"> 
+                                  <object idref="PrimitiveTypeInfo0"/> 
+                                 </void> 
+                                 <void property="typeName"> 
+                                  <string>string</string> 
+                                 </void> 
+                                </object> 
+                               </void> 
+                               <void method="add"> 
+                                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                 <void property="internalName"> 
+                                  <string>value</string> 
+                                 </void> 
+                                 <void property="tabAlias"> 
+                                  <string></string> 
+                                 </void> 
+                                 <void property="type"> 
+                                  <object idref="PrimitiveTypeInfo0"/> 
+                                 </void> 
+                                 <void property="typeName"> 
+                                  <string>string</string> 
+                                 </void> 
+                                </object> 
+                               </void> 
+                              </object> 
+                             </void> 
+                            </object> 
+                           </void> 
+                          </object> 
+                         </void> 
                         </void> 
                         <void property="conf"> 
                          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"/> 
@@ -1037,137 +1029,133 @@
                        #### A masked pattern was here #### 
                        <object id="TableScanOperator2" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                         <void property="childOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                            <void property="conf"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                              <void property="dirName"> 
-                               #### A masked pattern was here #### 
-                              </void> 
-                              <void property="numFiles"> 
-                               <int>1</int> 
-                              </void> 
-                              <void property="tableInfo"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                                <void property="inputFileFormatClass"> 
-                                 <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-                                </void> 
-                                <void property="outputFileFormatClass"> 
-                                 <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-                                </void> 
-                                <void property="properties"> 
-                                 <object class="java.util.Properties"> 
-                                  <void method="put"> 
-                                   <string>name</string> 
-                                   <string>default.dest3</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>columns.types</string> 
-                                   <string>string:string</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.ddl</string> 
-                                   <string>struct dest3 { string key, string value}</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.format</string> 
-                                   <string>1</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>columns</string> 
-                                   <string>key,value</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>partition_columns</string> 
-                                   <string>ds/hr</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>bucket_count</string> 
-                                   <string>-1</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.lib</string> 
-                                   <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>file.inputformat</string> 
-                                   <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>location</string> 
-                                   #### A masked pattern was here #### 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>file.outputformat</string> 
-                                   <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>transient_lastDdlTime</string> 
-                                   #### A masked pattern was here #### 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void property="totalFiles"> 
-                               <int>1</int> 
-                              </void> 
-                             </object> 
+                         <void method="add"> 
+                          <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                           <void property="conf"> 
+                            <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                             <void property="dirName"> 
+                              #### A masked pattern was here #### 
+                             </void> 
+                             <void property="numFiles"> 
+                              <int>1</int> 
+                             </void> 
+                             <void property="tableInfo"> 
+                              <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                               <void property="inputFileFormatClass"> 
+                                <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                               </void> 
+                               <void property="outputFileFormatClass"> 
+                                <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                               </void> 
+                               <void property="properties"> 
+                                <object class="java.util.Properties"> 
+                                 <void method="put"> 
+                                  <string>name</string> 
+                                  <string>default.dest3</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>columns.types</string> 
+                                  <string>string:string</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.ddl</string> 
+                                  <string>struct dest3 { string key, string value}</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.format</string> 
+                                  <string>1</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>columns</string> 
+                                  <string>key,value</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>partition_columns</string> 
+                                  <string>ds/hr</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>bucket_count</string> 
+                                  <string>-1</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.lib</string> 
+                                  <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>file.inputformat</string> 
+                                  <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>location</string> 
+                                  #### A masked pattern was here #### 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>file.outputformat</string> 
+                                  <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>transient_lastDdlTime</string> 
+                                  #### A masked pattern was here #### 
+                                 </void> 
+                                </object> 
+                               </void> 
+                              </object> 
+                             </void> 
+                             <void property="totalFiles"> 
+                              <int>1</int> 
+                             </void> 
+                            </object> 
+                           </void> 
+                           <void property="operatorId"> 
+                            <string>FS_18</string> 
+                           </void> 
+                           <void property="parentOperators"> 
+                            <void method="add"> 
+                             <object idref="TableScanOperator2"/> 
                             </void> 
-                            <void property="operatorId"> 
-                             <string>FS_18</string> 
-                            </void> 
-                            <void property="parentOperators"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object idref="TableScanOperator2"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="schema"> 
-                             <object id="RowSchema2" class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                              <void property="signature"> 
-                               <object class="java.util.ArrayList"> 
-                                <void method="add"> 
-                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                  <void property="internalName"> 
-                                   <string>key</string> 
-                                  </void> 
-                                  <void property="tabAlias"> 
-                                   <string></string> 
-                                  </void> 
-                                  <void property="type"> 
-                                   <object idref="PrimitiveTypeInfo0"/> 
-                                  </void> 
-                                  <void property="typeName"> 
-                                   <string>string</string> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void method="add"> 
-                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                  <void property="internalName"> 
-                                   <string>value</string> 
-                                  </void> 
-                                  <void property="tabAlias"> 
-                                   <string></string> 
-                                  </void> 
-                                  <void property="type"> 
-                                   <object idref="PrimitiveTypeInfo0"/> 
-                                  </void> 
-                                  <void property="typeName"> 
-                                   <string>string</string> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
+                           </void> 
+                           <void property="schema"> 
+                            <object id="RowSchema2" class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                             <void property="signature"> 
+                              <object class="java.util.ArrayList"> 
+                               <void method="add"> 
+                                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                 <void property="internalName"> 
+                                  <string>key</string> 
+                                 </void> 
+                                 <void property="tabAlias"> 
+                                  <string></string> 
+                                 </void> 
+                                 <void property="type"> 
+                                  <object idref="PrimitiveTypeInfo0"/> 
+                                 </void> 
+                                 <void property="typeName"> 
+                                  <string>string</string> 
+                                 </void> 
+                                </object> 
+                               </void> 
+                               <void method="add"> 
+                                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                 <void property="internalName"> 
+                                  <string>value</string> 
+                                 </void> 
+                                 <void property="tabAlias"> 
+                                  <string></string> 
+                                 </void> 
+                                 <void property="type"> 
+                                  <object idref="PrimitiveTypeInfo0"/> 
+                                 </void> 
+                                 <void property="typeName"> 
+                                  <string>string</string> 
+                                 </void> 
+                                </object> 
+                               </void> 
+                              </object> 
+                             </void> 
+                            </object> 
+                           </void> 
+                          </object> 
+                         </void> 
                         </void> 
                         <void property="conf"> 
                          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"/> 
@@ -1492,89 +1480,85 @@
                        #### A masked pattern was here #### 
                        <object id="TableScanOperator3" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                         <void property="childOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                            <void property="conf"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                              <void property="dirName"> 
-                               #### A masked pattern was here #### 
-                              </void> 
-                              <void property="numFiles"> 
-                               <int>1</int> 
-                              </void> 
-                              <void property="tableInfo"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                                <void property="inputFileFormatClass"> 
-                                 <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-                                </void> 
-                                <void property="outputFileFormatClass"> 
-                                 <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-                                </void> 
-                                <void property="properties"> 
-                                 <object class="java.util.Properties"> 
-                                  <void method="put"> 
-                                   <string>columns</string> 
-                                   <string>_col0</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.lib</string> 
-                                   <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.format</string> 
-                                   <string>1</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>columns.types</string> 
-                                   <string>string</string> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void property="totalFiles"> 
-                               <int>1</int> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="operatorId"> 
-                             <string>FS_20</string> 
+                         <void method="add"> 
+                          <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                           <void property="conf"> 
+                            <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                             <void property="dirName"> 
+                              #### A masked pattern was here #### 
+                             </void> 
+                             <void property="numFiles"> 
+                              <int>1</int> 
+                             </void> 
+                             <void property="tableInfo"> 
+                              <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                               <void property="inputFileFormatClass"> 
+                                <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                               </void> 
+                               <void property="outputFileFormatClass"> 
+                                <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                               </void> 
+                               <void property="properties"> 
+                                <object class="java.util.Properties"> 
+                                 <void method="put"> 
+                                  <string>columns</string> 
+                                  <string>_col0</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.lib</string> 
+                                  <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.format</string> 
+                                  <string>1</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>columns.types</string> 
+                                  <string>string</string> 
+                                 </void> 
+                                </object> 
+                               </void> 
+                              </object> 
+                             </void> 
+                             <void property="totalFiles"> 
+                              <int>1</int> 
+                             </void> 
+                            </object> 
+                           </void> 
+                           <void property="operatorId"> 
+                            <string>FS_20</string> 
+                           </void> 
+                           <void property="parentOperators"> 
+                            <void method="add"> 
+                             <object idref="TableScanOperator3"/> 
                             </void> 
-                            <void property="parentOperators"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object idref="TableScanOperator3"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="schema"> 
-                             <object id="RowSchema3" class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                              <void property="signature"> 
-                               <object class="java.util.ArrayList"> 
-                                <void method="add"> 
-                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                  <void property="internalName"> 
-                                   <string>_col0</string> 
-                                  </void> 
-                                  <void property="tabAlias"> 
-                                   <string></string> 
-                                  </void> 
-                                  <void property="type"> 
-                                   <object idref="PrimitiveTypeInfo0"/> 
-                                  </void> 
-                                  <void property="typeName"> 
-                                   <string>string</string> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
+                           </void> 
+                           <void property="schema"> 
+                            <object id="RowSchema3" class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                             <void property="signature"> 
+                              <object class="java.util.ArrayList"> 
+                               <void method="add"> 
+                                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                 <void property="internalName"> 
+                                  <string>_col0</string> 
+                                 </void> 
+                                 <void property="tabAlias"> 
+                                  <string></string> 
+                                 </void> 
+                                 <void property="type"> 
+                                  <object idref="PrimitiveTypeInfo0"/> 
+                                 </void> 
+                                 <void property="typeName"> 
+                                  <string>string</string> 
+                                 </void> 
+                                </object> 
+                               </void> 
+                              </object> 
+                             </void> 
+                            </object> 
+                           </void> 
+                          </object> 
+                         </void> 
                         </void> 
                         <void property="conf"> 
                          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"/> 
@@ -1947,444 +1931,700 @@
        <string>src</string> 
        <object id="TableScanOperator4" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                <void property="childOperators"> 
+         <void method="add"> 
+          <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+              <void property="childOperators"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                 <void property="conf"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                   <void property="destTableId"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="dirName"> 
+                    #### A masked pattern was here #### 
+                   </void> 
+                   <void property="gatherStats"> 
+                    <boolean>true</boolean> 
+                   </void> 
+                   <void property="lbCtx"> 
+                    <object idref="ListBucketingCtx0"/> 
+                   </void> 
+                   <void property="maxStatsKeyPrefixLength"> 
+                    <int>150</int> 
+                   </void> 
+                   <void property="numFiles"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="statsAggPrefix"> 
+                    #### A masked pattern was here #### 
+                   </void> 
+                   <void property="statsCollectRawDataSize"> 
+                    <boolean>true</boolean> 
+                   </void> 
+                   <void property="tableInfo"> 
+                    <object idref="TableDesc0"/> 
+                   </void> 
+                   <void property="totalFiles"> 
+                    <int>1</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="operatorId"> 
+                  <string>FS_3</string> 
+                 </void> 
+                 <void property="parentOperators"> 
+                  <void method="add"> 
+                   <object idref="SelectOperator0"/> 
+                  </void> 
+                 </void> 
+                 <void property="schema"> 
+                  <object idref="RowSchema0"/> 
+                 </void> 
+                </object> 
+               </void> 
+              </void> 
+              <void property="columnExprMap"> 
+               <object class="java.util.HashMap"> 
+                <void method="put"> 
+                 <string>_col1</string> 
+                 <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>value</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>src</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void method="put"> 
+                 <string>_col0</string> 
+                 <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>key</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>src</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
+                </void> 
+               </object> 
+              </void> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                <void property="colList"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                      <void property="destTableId"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="dirName"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="gatherStats"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="lbCtx"> 
-                       <object idref="ListBucketingCtx0"/> 
-                      </void> 
-                      <void property="maxStatsKeyPrefixLength"> 
-                       <int>150</int> 
-                      </void> 
-                      <void property="numFiles"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="statsAggPrefix"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="statsCollectRawDataSize"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="tableInfo"> 
-                       <object idref="TableDesc0"/> 
-                      </void> 
-                      <void property="totalFiles"> 
-                       <int>1</int> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="operatorId"> 
-                     <string>FS_3</string> 
-                    </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="SelectOperator0"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="schema"> 
-                     <object idref="RowSchema0"/> 
-                    </void> 
-                   </object> 
+                   <object idref="ExprNodeColumnDesc1"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object idref="ExprNodeColumnDesc0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="columnExprMap"> 
-                 <object class="java.util.HashMap"> 
-                  <void method="put"> 
+                <void property="outputColumnNames"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <string>_col0</string> 
+                  </void> 
+                  <void method="add"> 
                    <string>_col1</string> 
-                   <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>value</string> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="selectStar"> 
+                 <boolean>true</boolean> 
+                </void> 
+               </object> 
+              </void> 
+              <void property="operatorId"> 
+               <string>SEL_2</string> 
+              </void> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="FilterOperator0"/> 
+               </void> 
+              </void> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
                     </void> 
                     <void property="tabAlias"> 
                      <string>src</string> 
                     </void> 
-                    <void property="typeInfo"> 
+                    <void property="type"> 
                      <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
                    </object> 
                   </void> 
-                  <void method="put"> 
-                   <string>_col0</string> 
-                   <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>key</string> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col1</string> 
                     </void> 
                     <void property="tabAlias"> 
                      <string>src</string> 
                     </void> 
-                    <void property="typeInfo"> 
+                    <void property="type"> 
                      <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                  <void property="colList"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc1"/> 
-                    </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc0"/> 
-                    </void> 
-                   </object> 
+               </object> 
+              </void> 
+             </object> 
+            </void> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
+             <void property="predicate"> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                   <void property="column"> 
+                    <string>key</string> 
+                   </void> 
+                   <void property="tabAlias"> 
+                    <string>src</string> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo0"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                     <void property="typeName"> 
+                      <string>int</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="value"> 
+                    <int>100</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                 <void property="typeName"> 
+                  <string>boolean</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>FIL_1</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator4"/> 
+            </void> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>key</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>value</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
+         <void method="add"> 
+          <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+              <void property="childOperators"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                 <void property="conf"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                   <void property="destTableId"> 
+                    <int>2</int> 
+                   </void> 
+                   <void property="dirName"> 
+                    #### A masked pattern was here #### 
+                   </void> 
+                   <void property="gatherStats"> 
+                    <boolean>true</boolean> 
+                   </void> 
+                   <void property="lbCtx"> 
+                    <object idref="ListBucketingCtx1"/> 
+                   </void> 
+                   <void property="maxStatsKeyPrefixLength"> 
+                    <int>150</int> 
+                   </void> 
+                   <void property="numFiles"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="statsAggPrefix"> 
+                    #### A masked pattern was here #### 
+                   </void> 
+                   <void property="statsCollectRawDataSize"> 
+                    <boolean>true</boolean> 
+                   </void> 
+                   <void property="tableInfo"> 
+                    <object idref="TableDesc1"/> 
+                   </void> 
+                   <void property="totalFiles"> 
+                    <int>1</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="operatorId"> 
+                  <string>FS_6</string> 
+                 </void> 
+                 <void property="parentOperators"> 
+                  <void method="add"> 
+                   <object idref="SelectOperator1"/> 
+                  </void> 
+                 </void> 
+                 <void property="schema"> 
+                  <object idref="RowSchema1"/> 
+                 </void> 
+                </object> 
+               </void> 
+              </void> 
+              <void property="columnExprMap"> 
+               <object class="java.util.HashMap"> 
+                <void method="put"> 
+                 <string>_col1</string> 
+                 <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>value</string> 
                   </void> 
-                  <void property="outputColumnNames"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <string>_col0</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col1</string> 
-                    </void> 
-                   </object> 
+                  <void property="tabAlias"> 
+                   <string>src</string> 
                   </void> 
-                  <void property="selectStar"> 
-                   <boolean>true</boolean> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="operatorId"> 
-                 <string>SEL_2</string> 
+                <void method="put"> 
+                 <string>_col0</string> 
+                 <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>key</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>src</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
                 </void> 
-                <void property="parentOperators"> 
+               </object> 
+              </void> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                <void property="colList"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object idref="FilterOperator0"/> 
+                   <object idref="ExprNodeColumnDesc3"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object idref="ExprNodeColumnDesc2"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>src</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>src</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                <void property="outputColumnNames"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <string>_col0</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col1</string> 
                   </void> 
                  </object> 
                 </void> 
                </object> 
               </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-              <void property="predicate"> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
+              <void property="operatorId"> 
+               <string>SEL_5</string> 
+              </void> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="FilterOperator1"/> 
+               </void> 
+              </void> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>key</string> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
                     </void> 
                     <void property="tabAlias"> 
                      <string>src</string> 
                     </void> 
-                    <void property="typeInfo"> 
+                    <void property="type"> 
                      <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
                    </object> 
                   </void> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
-                     <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                      <void property="typeName"> 
-                       <string>int</string> 
-                      </void> 
-                     </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col1</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string>src</string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                    <void property="value"> 
-                     <int>100</int> 
+                    <void property="typeName"> 
+                     <string>string</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                  <void property="typeName"> 
-                   <string>boolean</string> 
-                  </void> 
-                 </object> 
-                </void> 
                </object> 
               </void> 
              </object> 
             </void> 
-            <void property="operatorId"> 
-             <string>FIL_1</string> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
+             <void property="predicate"> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                   <void property="children"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <void property="column"> 
+                        <string>key</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string>src</string> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo1"/> 
+                       </void> 
+                       <void property="value"> 
+                        <int>100</int> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="genericUDF"> 
+                    <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqualOrGreaterThan"/> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo2"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                   <void property="children"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <void property="column"> 
+                        <string>key</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string>src</string> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo1"/> 
+                       </void> 
+                       <void property="value"> 
+                        <int>200</int> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="genericUDF"> 
+                    <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo2"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo2"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>FIL_4</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator4"/> 
             </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator4"/> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object idref="ColumnInfo0"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ColumnInfo1"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
+         <void method="add"> 
+          <object id="FilterOperator2" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object id="SelectOperator2" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+              <void property="childOperators"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                 <void property="conf"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                   <void property="destTableId"> 
+                    <int>3</int> 
+                   </void> 
+                   <void property="dirName"> 
+                    #### A masked pattern was here #### 
+                   </void> 
+                   <void property="gatherStats"> 
+                    <boolean>true</boolean> 
+                   </void> 
+                   <void property="lbCtx"> 
+                    <object idref="ListBucketingCtx2"/> 
+                   </void> 
+                   <void property="maxStatsKeyPrefixLength"> 
+                    <int>150</int> 
+                   </void> 
+                   <void property="numFiles"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="staticSpec"> 
+                    <string>ds=2008-04-08/hr=12/</string> 
+                   </void> 
+                   <void property="statsAggPrefix"> 
+                    #### A masked pattern was here #### 
+                   </void> 
+                   <void property="statsCollectRawDataSize"> 
+                    <boolean>true</boolean> 
+                   </void> 
+                   <void property="tableInfo"> 
+                    <object idref="TableDesc2"/> 
+                   </void> 
+                   <void property="totalFiles"> 
+                    <int>1</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="operatorId"> 
+                  <string>FS_9</string> 
+                 </void> 
+                 <void property="parentOperators"> 
+                  <void method="add"> 
+                   <object idref="SelectOperator2"/> 
+                  </void> 
+                 </void> 
+                 <void property="schema"> 
+                  <object idref="RowSchema2"/> 
+                 </void> 
+                </object> 
+               </void> 
               </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>key</string> 
+              <void property="columnExprMap"> 
+               <object class="java.util.HashMap"> 
+                <void method="put"> 
+                 <string>_col1</string> 
+                 <object id="ExprNodeConstantDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo1"/> 
                   </void> 
-                  <void property="tabAlias"> 
-                   <string>src</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
+                  <void property="value"> 
+                   <int>2</int> 
                   </void> 
                  </object> 
                 </void> 
-                <void method="add"> 
-                 <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>value</string> 
+                <void method="put"> 
+                 <string>_col0</string> 
+                 <object id="ExprNodeColumnDesc4" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>key</string> 
                   </void> 
                   <void property="tabAlias"> 
                    <string>src</string> 
                   </void> 
-                  <void property="type"> 
+                  <void property="typeInfo"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
                  </object> 
                 </void> 
                </object> 
               </void> 
-             </object> 
-            </void> 
-           </object> 
-          </void> 
-          <void method="add"> 
-           <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                <void property="childOperators"> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                <void property="colList"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                      <void property="destTableId"> 
-                       <int>2</int> 
-                      </void> 
-                      <void property="dirName"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="gatherStats"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="lbCtx"> 
-                       <object idref="ListBucketingCtx1"/> 
-                      </void> 
-                      <void property="maxStatsKeyPrefixLength"> 
-                       <int>150</int> 
-                      </void> 
-                      <void property="numFiles"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="statsAggPrefix"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="statsCollectRawDataSize"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="tableInfo"> 
-                       <object idref="TableDesc1"/> 
-                      </void> 
-                      <void property="totalFiles"> 
-                       <int>1</int> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="operatorId"> 
-                     <string>FS_6</string> 
-                    </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="SelectOperator1"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="schema"> 
-                     <object idref="RowSchema1"/> 
-                    </void> 
-                   </object> 
+                   <object idref="ExprNodeColumnDesc4"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object idref="ExprNodeConstantDesc0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="columnExprMap"> 
-                 <object class="java.util.HashMap"> 
-                  <void method="put"> 
+                <void property="outputColumnNames"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <string>_col0</string> 
+                  </void> 
+                  <void method="add"> 
                    <string>_col1</string> 
-                   <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>value</string> 
+                  </void> 
+                 </object> 
+                </void> 
+               </object> 
+              </void> 
+              <void property="operatorId"> 
+               <string>SEL_8</string> 
+              </void> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="FilterOperator2"/> 
+               </void> 
+              </void> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
                     </void> 
                     <void property="tabAlias"> 
                      <string>src</string> 
                     </void> 
-                    <void property="typeInfo"> 
+                    <void property="type"> 
                      <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
                    </object> 
                   </void> 
-                  <void method="put"> 
-                   <string>_col0</string> 
-                   <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>key</string> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col1</string> 
                     </void> 
-                    <void property="tabAlias"> 
-                     <string>src</string> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo1"/> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                  <void property="colList"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc3"/> 
-                    </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc2"/> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void property="outputColumnNames"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <string>_col0</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col1</string> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="operatorId"> 
-                 <string>SEL_5</string> 
-                </void> 
-                <void property="parentOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object idref="FilterOperator1"/> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>src</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>src</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
+                    <void property="typeName"> 
+                     <string>int</string> 
                     </void> 
                    </object> 
                   </void> 
@@ -2394,604 +2634,306 @@
               </void> 
              </object> 
             </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-              <void property="predicate"> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>100</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqualOrGreaterThan"/> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>200</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo2"/> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="operatorId"> 
-             <string>FIL_4</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator4"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object idref="ColumnInfo0"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ColumnInfo1"/> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
+             <void property="predicate"> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                   <void property="children"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <void property="column"> 
+                        <string>key</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string>src</string> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo1"/> 
+                       </void> 
+                       <void property="value"> 
+                        <int>200</int> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="genericUDF"> 
+                    <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqualOrGreaterThan"/> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo2"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                   <void property="children"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <void property="column"> 
+                        <string>key</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string>src</string> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo1"/> 
+                       </void> 
+                       <void property="value"> 
+                        <int>300</int> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="genericUDF"> 
+                    <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo2"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo2"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>FIL_7</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator4"/> 
             </void> 
-           </object> 
-          </void> 
-          <void method="add"> 
-           <object id="FilterOperator2" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="SelectOperator2" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                <void property="childOperators"> 
-                 <object class="java.util.ArrayList"> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object idref="ColumnInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
+         <void method="add"> 
+          <object id="FilterOperator3" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object id="SelectOperator3" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+              <void property="childOperators"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                 <void property="conf"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                   <void property="destTableId"> 
+                    <int>4</int> 
+                   </void> 
+                   <void property="dirName"> 
+                    #### A masked pattern was here #### 
+                   </void> 
+                   <void property="numFiles"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="statsAggPrefix"> 
+                    #### A masked pattern was here #### 
+                   </void> 
+                   <void property="statsCollectRawDataSize"> 
+                    <boolean>true</boolean> 
+                   </void> 
+                   <void property="tableInfo"> 
+                    <object idref="TableDesc3"/> 
+                   </void> 
+                   <void property="totalFiles"> 
+                    <int>1</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="operatorId"> 
+                  <string>FS_12</string> 
+                 </void> 
+                 <void property="parentOperators"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                      <void property="destTableId"> 
-                       <int>3</int> 
-                      </void> 
-                      <void property="dirName"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="gatherStats"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="lbCtx"> 
-                       <object idref="ListBucketingCtx2"/> 
-                      </void> 
-                      <void property="maxStatsKeyPrefixLength"> 
-                       <int>150</int> 
-                      </void> 
-                      <void property="numFiles"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="staticSpec"> 
-                       <string>ds=2008-04-08/hr=12/</string> 
-                      </void> 
-                      <void property="statsAggPrefix"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="statsCollectRawDataSize"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="tableInfo"> 
-                       <object idref="TableDesc2"/> 
-                      </void> 
-                      <void property="totalFiles"> 
-                       <int>1</int> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="operatorId"> 
-                     <string>FS_9</string> 
-                    </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="SelectOperator2"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="schema"> 
-                     <object idref="RowSchema2"/> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="columnExprMap"> 
-                 <object class="java.util.HashMap"> 
-                  <void method="put"> 
-                   <string>_col1</string> 
-                   <object id="ExprNodeConstantDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
-                    </void> 
-                    <void property="value"> 
-                     <int>2</int> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void method="put"> 
-                   <string>_col0</string> 
-                   <object id="ExprNodeColumnDesc4" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>key</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>src</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
+                   <object idref="SelectOperator3"/> 
+                  </void> 
+                 </void> 
+                 <void property="schema"> 
+                  <object idref="RowSchema3"/> 
+                 </void> 
+                </object> 
+               </void> 
+              </void> 
+              <void property="columnExprMap"> 
+               <object class="java.util.HashMap"> 
+                <void method="put"> 
+                 <string>_col0</string> 
+                 <object id="ExprNodeColumnDesc5" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>value</string> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                  <void property="colList"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc4"/> 
-                    </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeConstantDesc0"/> 
-                    </void> 
-                   </object> 
+                  <void property="tabAlias"> 
+                   <string>src</string> 
                   </void> 
-                  <void property="outputColumnNames"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <string>_col0</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col1</string> 
-                    </void> 
-                   </object> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="operatorId"> 
-                 <string>SEL_8</string> 
-                </void> 
-                <void property="parentOperators"> 
+               </object> 
+              </void> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                <void property="colList"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object idref="FilterOperator2"/> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>src</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo1"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>int</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                   <object idref="ExprNodeColumnDesc5"/> 
                   </void> 
                  </object> 
                 </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-              <void property="predicate"> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
+                <void property="outputColumnNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>200</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqualOrGreaterThan"/> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>300</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
-                    </void> 
-                   </object> 
+                   <string>_col0</string> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo2"/> 
-                </void> 
                </object> 
               </void> 
-             </object> 
-            </void> 
-            <void property="operatorId"> 
-             <string>FIL_7</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator4"/> 
+              <void property="operatorId"> 
+               <string>SEL_11</string> 
               </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object idref="ColumnInfo0"/> 
-                </void> 
-               </object> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="FilterOperator3"/> 
+               </void> 
               </void> 
-             </object> 
-            </void> 
-           </object> 
-          </void> 
-          <void method="add"> 
-           <object id="FilterOperator3" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="SelectOperator3" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                <void property="childOperators"> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                      <void property="destTableId"> 
-                       <int>4</int> 
-                      </void> 
-                      <void property="dirName"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="numFiles"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="statsAggPrefix"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="statsCollectRawDataSize"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="tableInfo"> 
-                       <object idref="TableDesc3"/> 
-                      </void> 
-                      <void property="totalFiles"> 
-                       <int>1</int> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="operatorId"> 
-                     <string>FS_12</string> 
-                    </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="SelectOperator3"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="schema"> 
-                     <object idref="RowSchema3"/> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="columnExprMap"> 
-                 <object class="java.util.HashMap"> 
-                  <void method="put"> 
-                   <string>_col0</string> 
-                   <object id="ExprNodeColumnDesc5" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="alias"> 
                      <string>value</string> 
                     </void> 
-                    <void property="tabAlias"> 
-                     <string>src</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                  <void property="colList"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc5"/> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void property="outputColumnNames"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
+                    <void property="internalName"> 
                      <string>_col0</string> 
                     </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="operatorId"> 
-                 <string>SEL_11</string> 
-                </void> 
-                <void property="parentOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object idref="FilterOperator3"/> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="alias"> 
-                       <string>value</string> 
-                      </void> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>src</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-              <void property="predicate"> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>key</string> 
-                    </void> 
                     <void property="tabAlias"> 
                      <string>src</string> 
                     </void> 
-                    <void property="typeInfo"> 
+                    <void property="type"> 
                      <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                   </object> 
-                  </void> 
-                  <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
-                    </void> 
-                    <void property="value"> 
-                     <int>300</int> 
+                    <void property="typeName"> 
+                     <string>string</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqualOrGreaterThan"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo2"/> 
-                </void> 
                </object> 
               </void> 
              </object> 
             </void> 
-            <void property="operatorId"> 
-             <string>FIL_10</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator4"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object idref="ColumnInfo0"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ColumnInfo1"/> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
+             <void property="predicate"> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                   <void property="column"> 
+                    <string>key</string> 
+                   </void> 
+                   <void property="tabAlias"> 
+                    <string>src</string> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo0"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo1"/> 
+                   </void> 
+                   <void property="value"> 
+                    <int>300</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqualOrGreaterThan"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo2"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>FIL_10</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator4"/> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object idref="ColumnInfo0"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ColumnInfo1"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
diff --git a/ql/src/test/results/compiler/plan/input4.q.xml b/ql/src/test/results/compiler/plan/input4.q.xml
index c35d662a2c..6732b6d54a 100755
--- a/ql/src/test/results/compiler/plan/input4.q.xml
+++ b/ql/src/test/results/compiler/plan/input4.q.xml
@@ -297,268 +297,171 @@
        <string>tmap:src</string> 
        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="ScriptOperator0" class="org.apache.hadoop.hive.ql.exec.ScriptOperator"> 
-                <void property="childOperators"> 
-                 <object class="java.util.ArrayList"> 
+         <void method="add"> 
+          <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object id="ScriptOperator0" class="org.apache.hadoop.hive.ql.exec.ScriptOperator"> 
+              <void property="childOperators"> 
+               <void method="add"> 
+                <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+                 <void property="childOperators"> 
                   <void method="add"> 
-                   <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
-                    <void property="childOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object id="ReduceSinkOperator0" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
-                        <void property="columnExprMap"> 
-                         <object class="java.util.HashMap"> 
-                          <void method="put"> 
-                           <string>_col1</string> 
-                           <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>_col1</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                              <void property="typeName"> 
-                               <string>string</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="put"> 
-                           <string>_col0</string> 
-                           <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>_col0</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
+                   <object id="ReduceSinkOperator0" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
+                    <void property="columnExprMap"> 
+                     <object class="java.util.HashMap"> 
+                      <void method="put"> 
+                       <string>_col1</string> 
+                       <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                        <void property="column"> 
+                         <string>_col1</string> 
+                        </void> 
+                        <void property="typeInfo"> 
+                         <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                          <void property="typeName"> 
+                           <string>string</string> 
                           </void> 
                          </object> 
                         </void> 
-                        <void property="conf"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
-                          <void property="distinctColumnIndices"> 
-                           <object class="java.util.ArrayList"/> 
-                          </void> 
-                          <void property="keyCols"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                              <void property="column"> 
-                               <string>_col0</string> 
-                              </void> 
-                              <void property="typeInfo"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="keySerializeInfo"> 
-                           <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                            <void property="inputFileFormatClass"> 
-                             <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                            </void> 
-                            <void property="outputFileFormatClass"> 
-                             <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                            </void> 
-                            <void property="properties"> 
-                             <object class="java.util.Properties"> 
-                              <void method="put"> 
-                               <string>columns</string> 
-                               <string>reducesinkkey0</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>serialization.lib</string> 
-                               <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>serialization.sort.order</string> 
-                               <string>+</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>columns.types</string> 
-                               <string>string</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="numDistributionKeys"> 
-                           <int>1</int> 
-                          </void> 
-                          <void property="numReducers"> 
-                           <int>-1</int> 
-                          </void> 
-                          <void property="outputKeyColumnNames"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <string>reducesinkkey0</string> 
-                            </void> 
-                           </object> 
+                       </object> 
+                      </void> 
+                      <void method="put"> 
+                       <string>_col0</string> 
+                       <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                        <void property="column"> 
+                         <string>_col0</string> 
+                        </void> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo0"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="conf"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
+                      <void property="distinctColumnIndices"> 
+                       <object class="java.util.ArrayList"/> 
+                      </void> 
+                      <void property="keyCols"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                          <void property="column"> 
+                           <string>_col0</string> 
                           </void> 
-                          <void property="outputValueColumnNames"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <string>_col0</string> 
-                            </void> 
-                            <void method="add"> 
-                             <string>_col1</string> 
-                            </void> 
-                           </object> 
+                          <void property="typeInfo"> 
+                           <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
-                          <void property="partitionCols"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                              <void property="column"> 
-                               <string>_col0</string> 
-                              </void> 
-                              <void property="typeInfo"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
+                         </object> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="keySerializeInfo"> 
+                       <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                        <void property="inputFileFormatClass"> 
+                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                        </void> 
+                        <void property="outputFileFormatClass"> 
+                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                        </void> 
+                        <void property="properties"> 
+                         <object class="java.util.Properties"> 
+                          <void method="put"> 
+                           <string>columns</string> 
+                           <string>reducesinkkey0</string> 
                           </void> 
-                          <void property="tag"> 
-                           <int>-1</int> 
+                          <void method="put"> 
+                           <string>serialization.lib</string> 
+                           <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
                           </void> 
-                          <void property="valueCols"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object idref="ExprNodeColumnDesc1"/> 
-                            </void> 
-                            <void method="add"> 
-                             <object idref="ExprNodeColumnDesc0"/> 
-                            </void> 
-                           </object> 
+                          <void method="put"> 
+                           <string>serialization.sort.order</string> 
+                           <string>+</string> 
                           </void> 
-                          <void property="valueSerializeInfo"> 
-                           <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                            <void property="inputFileFormatClass"> 
-                             <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                            </void> 
-                            <void property="outputFileFormatClass"> 
-                             <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                            </void> 
-                            <void property="properties"> 
-                             <object class="java.util.Properties"> 
-                              <void method="put"> 
-                               <string>columns</string> 
-                               <string>_col0,_col1</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>serialization.lib</string> 
-                               <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>columns.types</string> 
-                               <string>string,string</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>escape.delim</string> 
-                               <string>\</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
+                          <void method="put"> 
+                           <string>columns.types</string> 
+                           <string>string</string> 
                           </void> 
                          </object> 
                         </void> 
-                        <void property="operatorId"> 
-                         <string>RS_3</string> 
+                       </object> 
+                      </void> 
+                      <void property="numDistributionKeys"> 
+                       <int>1</int> 
+                      </void> 
+                      <void property="numReducers"> 
+                       <int>-1</int> 
+                      </void> 
+                      <void property="outputKeyColumnNames"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <string>reducesinkkey0</string> 
                         </void> 
-                        <void property="parentOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object idref="FilterOperator0"/> 
-                          </void> 
-                         </object> 
+                       </object> 
+                      </void> 
+                      <void property="outputValueColumnNames"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <string>_col0</string> 
                         </void> 
-                        <void property="schema"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                          <void property="signature"> 
-                           <object id="ArrayList0" class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="alias"> 
-                               <string>tkey</string> 
-                              </void> 
-                              <void property="internalName"> 
-                               <string>_col0</string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                              <void property="typeName"> 
-                               <string>string</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="alias"> 
-                               <string>tvalue</string> 
-                              </void> 
-                              <void property="internalName"> 
-                               <string>_col1</string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                              <void property="typeName"> 
-                               <string>string</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
+                        <void method="add"> 
+                         <string>_col1</string> 
                         </void> 
                        </object> 
                       </void> 
-                     </object> 
-                    </void> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-                      <void property="predicate"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="children"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object idref="ExprNodeColumnDesc1"/> 
+                      <void property="partitionCols"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                          <void property="column"> 
+                           <string>_col0</string> 
                           </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                              <void property="typeName"> 
-                               <string>int</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="value"> 
-                             <int>100</int> 
-                            </void> 
-                           </object> 
+                          <void property="typeInfo"> 
+                           <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
                          </object> 
                         </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
+                       </object> 
+                      </void> 
+                      <void property="tag"> 
+                       <int>-1</int> 
+                      </void> 
+                      <void property="valueCols"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <object idref="ExprNodeColumnDesc1"/> 
                         </void> 
-                        <void property="typeInfo"> 
-                         <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>boolean</string> 
+                        <void method="add"> 
+                         <object idref="ExprNodeColumnDesc0"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="valueSerializeInfo"> 
+                       <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                        <void property="inputFileFormatClass"> 
+                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                        </void> 
+                        <void property="outputFileFormatClass"> 
+                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                        </void> 
+                        <void property="properties"> 
+                         <object class="java.util.Properties"> 
+                          <void method="put"> 
+                           <string>columns</string> 
+                           <string>_col0,_col1</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>serialization.lib</string> 
+                           <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>columns.types</string> 
+                           <string>string,string</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>escape.delim</string> 
+                           <string>\</string> 
                           </void> 
                          </object> 
                         </void> 
@@ -567,264 +470,345 @@
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>FIL_8</string> 
+                     <string>RS_3</string> 
                     </void> 
                     <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="ScriptOperator0"/> 
-                      </void> 
-                     </object> 
+                     <void method="add"> 
+                      <object idref="FilterOperator0"/> 
+                     </void> 
                     </void> 
                     <void property="schema"> 
                      <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
                       <void property="signature"> 
-                       <object idref="ArrayList0"/> 
+                       <object id="ArrayList0" class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                          <void property="alias"> 
+                           <string>tkey</string> 
+                          </void> 
+                          <void property="internalName"> 
+                           <string>_col0</string> 
+                          </void> 
+                          <void property="type"> 
+                           <object idref="PrimitiveTypeInfo0"/> 
+                          </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
+                         </object> 
+                        </void> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                          <void property="alias"> 
+                           <string>tvalue</string> 
+                          </void> 
+                          <void property="internalName"> 
+                           <string>_col1</string> 
+                          </void> 
+                          <void property="type"> 
+                           <object idref="PrimitiveTypeInfo0"/> 
+                          </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
+                         </object> 
+                        </void> 
+                       </object> 
                       </void> 
                      </object> 
                     </void> 
                    </object> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.ScriptDesc"> 
-                  <void property="errRecordReaderClass"> 
-                   <class>org.apache.hadoop.hive.ql.exec.TextRecordReader</class> 
-                  </void> 
-                  <void property="inRecordWriterClass"> 
-                   <class>org.apache.hadoop.hive.ql.exec.TextRecordWriter</class> 
+                 </void> 
+                 <void property="conf"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
+                   <void property="predicate"> 
+                    <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                     <void property="children"> 
+                      <object class="java.util.ArrayList"> 
+                       <void method="add"> 
+                        <object idref="ExprNodeColumnDesc1"/> 
+                       </void> 
+                       <void method="add"> 
+                        <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                         <void property="typeInfo"> 
+                          <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                           <void property="typeName"> 
+                            <string>int</string> 
+                           </void> 
+                          </object> 
+                         </void> 
+                         <void property="value"> 
+                          <int>100</int> 
+                         </void> 
+                        </object> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void property="genericUDF"> 
+                      <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
+                     </void> 
+                     <void property="typeInfo"> 
+                      <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                       <void property="typeName"> 
+                        <string>boolean</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="operatorId"> 
+                  <string>FIL_8</string> 
+                 </void> 
+                 <void property="parentOperators"> 
+                  <void method="add"> 
+                   <object idref="ScriptOperator0"/> 
                   </void> 
-                  <void property="outRecordReaderClass"> 
-                   <class>org.apache.hadoop.hive.ql.exec.TextRecordReader</class> 
+                 </void> 
+                 <void property="schema"> 
+                  <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                   <void property="signature"> 
+                    <object idref="ArrayList0"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+              </void> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.ScriptDesc"> 
+                <void property="errRecordReaderClass"> 
+                 <class>org.apache.hadoop.hive.ql.exec.TextRecordReader</class> 
+                </void> 
+                <void property="inRecordWriterClass"> 
+                 <class>org.apache.hadoop.hive.ql.exec.TextRecordWriter</class> 
+                </void> 
+                <void property="outRecordReaderClass"> 
+                 <class>org.apache.hadoop.hive.ql.exec.TextRecordReader</class> 
+                </void> 
+                <void property="scriptCmd"> 
+                 <string>/bin/cat</string> 
+                </void> 
+                <void property="scriptErrInfo"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                  <void property="inputFileFormatClass"> 
+                   <class>org.apache.hadoop.mapred.TextInputFormat</class> 
                   </void> 
-                  <void property="scriptCmd"> 
-                   <string>/bin/cat</string> 
+                  <void property="outputFileFormatClass"> 
+                   <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
                   </void> 
-                  <void property="scriptErrInfo"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                    <void property="inputFileFormatClass"> 
-                     <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                  <void property="properties"> 
+                   <object class="java.util.Properties"> 
+                    <void method="put"> 
+                     <string>field.delim</string> 
+                     <string>9</string> 
                     </void> 
-                    <void property="outputFileFormatClass"> 
-                     <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                    <void method="put"> 
+                     <string>columns</string> 
+                     <string>KEY</string> 
                     </void> 
-                    <void property="properties"> 
-                     <object class="java.util.Properties"> 
-                      <void method="put"> 
-                       <string>field.delim</string> 
-                       <string>9</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>columns</string> 
-                       <string>KEY</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.lib</string> 
-                       <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.format</string> 
-                       <string>9</string> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>serialization.lib</string> 
+                     <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                    </void> 
+                    <void method="put"> 
+                     <string>serialization.format</string> 
+                     <string>9</string> 
                     </void> 
                    </object> 
                   </void> 
-                  <void property="scriptInputInfo"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                    <void property="inputFileFormatClass"> 
-                     <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                 </object> 
+                </void> 
+                <void property="scriptInputInfo"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                  <void property="inputFileFormatClass"> 
+                   <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                  </void> 
+                  <void property="outputFileFormatClass"> 
+                   <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                  </void> 
+                  <void property="properties"> 
+                   <object class="java.util.Properties"> 
+                    <void method="put"> 
+                     <string>field.delim</string> 
+                     <string>9</string> 
                     </void> 
-                    <void property="outputFileFormatClass"> 
-                     <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                    <void method="put"> 
+                     <string>columns</string> 
+                     <string>_col0,_col1</string> 
                     </void> 
-                    <void property="properties"> 
-                     <object class="java.util.Properties"> 
-                      <void method="put"> 
-                       <string>field.delim</string> 
-                       <string>9</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>columns</string> 
-                       <string>_col0,_col1</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.lib</string> 
-                       <string>org.apache.hadoop.hive.serde2.DelimitedJSONSerDe</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.format</string> 
-                       <string>9</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>columns.types</string> 
-                       <string>string,string</string> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>serialization.lib</string> 
+                     <string>org.apache.hadoop.hive.serde2.DelimitedJSONSerDe</string> 
                     </void> 
-                   </object> 
-                  </void> 
-                  <void property="scriptOutputInfo"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                    <void property="inputFileFormatClass"> 
-                     <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                    <void method="put"> 
+                     <string>serialization.format</string> 
+                     <string>9</string> 
                     </void> 
-                    <void property="outputFileFormatClass"> 
-                     <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-                    </void> 
-                    <void property="properties"> 
-                     <object class="java.util.Properties"> 
-                      <void method="put"> 
-                       <string>field.delim</string> 
-                       <string>9</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>columns</string> 
-                       <string>_col0,_col1</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.lib</string> 
-                       <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.format</string> 
-                       <string>9</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>columns.types</string> 
-                       <string>string,string</string> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>columns.types</string> 
+                     <string>string,string</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="operatorId"> 
-                 <string>SCR_2</string> 
-                </void> 
-                <void property="parentOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object idref="SelectOperator0"/> 
+                <void property="scriptOutputInfo"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                  <void property="inputFileFormatClass"> 
+                   <class>org.apache.hadoop.mapred.TextInputFormat</class> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object idref="ArrayList0"/> 
+                  <void property="outputFileFormatClass"> 
+                   <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                  </void> 
+                  <void property="properties"> 
+                   <object class="java.util.Properties"> 
+                    <void method="put"> 
+                     <string>field.delim</string> 
+                     <string>9</string> 
+                    </void> 
+                    <void method="put"> 
+                     <string>columns</string> 
+                     <string>_col0,_col1</string> 
+                    </void> 
+                    <void method="put"> 
+                     <string>serialization.lib</string> 
+                     <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                    </void> 
+                    <void method="put"> 
+                     <string>serialization.format</string> 
+                     <string>9</string> 
+                    </void> 
+                    <void method="put"> 
+                     <string>columns.types</string> 
+                     <string>string,string</string> 
+                    </void> 
+                   </object> 
                   </void> 
                  </object> 
                 </void> 
                </object> 
               </void> 
-             </object> 
-            </void> 
-            <void property="columnExprMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>_col1</string> 
-               <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>value</string> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string>src</string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>_col0</string> 
-               <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>key</string> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string>src</string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-              <void property="colList"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object idref="ExprNodeColumnDesc3"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeColumnDesc2"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void property="outputColumnNames"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <string>_col0</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col1</string> 
-                </void> 
-               </object> 
+              <void property="operatorId"> 
+               <string>SCR_2</string> 
               </void> 
-             </object> 
-            </void> 
-            <void property="operatorId"> 
-             <string>SEL_1</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator0"/> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="SelectOperator0"/> 
+               </void> 
               </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>_col0</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>_col1</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
+                 <object idref="ArrayList0"/> 
                 </void> 
                </object> 
               </void> 
              </object> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="columnExprMap"> 
+            <object class="java.util.HashMap"> 
+             <void method="put"> 
+              <string>_col1</string> 
+              <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>value</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>src</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col0</string> 
+              <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>key</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>src</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+             <void property="colList"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object idref="ExprNodeColumnDesc3"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeColumnDesc2"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="outputColumnNames"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <string>_col0</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col1</string> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>SEL_1</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator0"/> 
+            </void> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>_col0</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>_col1</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
@@ -1137,200 +1121,88 @@
       <void property="reducer"> 
        <object id="ExtractOperator0" class="org.apache.hadoop.hive.ql.exec.ExtractOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                  <void property="destTableId"> 
-                   <int>1</int> 
-                  </void> 
-                  <void property="dirName"> 
-                   #### A masked pattern was here #### 
-                  </void> 
-                  <void property="gatherStats"> 
-                   <boolean>true</boolean> 
-                  </void> 
-                  <void property="lbCtx"> 
-                   <object idref="ListBucketingCtx0"/> 
-                  </void> 
-                  <void property="maxStatsKeyPrefixLength"> 
-                   <int>150</int> 
-                  </void> 
-                  <void property="numFiles"> 
-                   <int>1</int> 
-                  </void> 
-                  <void property="statsAggPrefix"> 
-                   #### A masked pattern was here #### 
-                  </void> 
-                  <void property="statsCollectRawDataSize"> 
-                   <boolean>true</boolean> 
-                  </void> 
-                  <void property="tableInfo"> 
-                   <object idref="TableDesc0"/> 
-                  </void> 
-                  <void property="totalFiles"> 
-                   <int>1</int> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="operatorId"> 
-                 <string>FS_7</string> 
-                </void> 
-                <void property="parentOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object idref="SelectOperator1"/> 
-                  </void> 
-                 </object> 
+         <void method="add"> 
+          <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                <void property="destTableId"> 
+                 <int>1</int> 
                 </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>key</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>value</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
+                <void property="dirName"> 
+                 #### A masked pattern was here #### 
                 </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="columnExprMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>_col1</string> 
-               <object id="ExprNodeColumnDesc4" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>_col1</string> 
+                <void property="gatherStats"> 
+                 <boolean>true</boolean> 
                 </void> 
-                <void property="tabAlias"> 
-                 <string>tmap</string> 
+                <void property="lbCtx"> 
+                 <object idref="ListBucketingCtx0"/> 
                 </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
+                <void property="maxStatsKeyPrefixLength"> 
+                 <int>150</int> 
                 </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>_col0</string> 
-               <object id="ExprNodeColumnDesc5" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>_col0</string> 
+                <void property="numFiles"> 
+                 <int>1</int> 
                 </void> 
-                <void property="tabAlias"> 
-                 <string>tmap</string> 
+                <void property="statsAggPrefix"> 
+                 #### A masked pattern was here #### 
                 </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
+                <void property="statsCollectRawDataSize"> 
+                 <boolean>true</boolean> 
                 </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-              <void property="colList"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object idref="ExprNodeColumnDesc5"/> 
+                <void property="tableInfo"> 
+                 <object idref="TableDesc0"/> 
                 </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeColumnDesc4"/> 
+                <void property="totalFiles"> 
+                 <int>1</int> 
                 </void> 
                </object> 
               </void> 
-              <void property="outputColumnNames"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <string>_col0</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col1</string> 
-                </void> 
-               </object> 
+              <void property="operatorId"> 
+               <string>FS_7</string> 
               </void> 
-             </object> 
-            </void> 
-            <void property="operatorId"> 
-             <string>SEL_6</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="ExtractOperator0"/> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="SelectOperator1"/> 
+               </void> 
               </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>_col0</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>tmap</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>_col1</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>tmap</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>key</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
                   </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>value</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
                   </void> 
                  </object> 
                 </void> 
@@ -1338,9 +1210,113 @@
               </void> 
              </object> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="columnExprMap"> 
+            <object class="java.util.HashMap"> 
+             <void method="put"> 
+              <string>_col1</string> 
+              <object id="ExprNodeColumnDesc4" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>_col1</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>tmap</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col0</string> 
+              <object id="ExprNodeColumnDesc5" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>_col0</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>tmap</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+             <void property="colList"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object idref="ExprNodeColumnDesc5"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeColumnDesc4"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="outputColumnNames"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <string>_col0</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col1</string> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>SEL_6</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="ExtractOperator0"/> 
+            </void> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>_col0</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>tmap</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>_col1</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>tmap</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.ExtractDesc"> 
@@ -1363,11 +1339,9 @@
          <string>EX_4</string> 
         </void> 
         <void property="parentOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object idref="ReduceSinkOperator0"/> 
-          </void> 
-         </object> 
+         <void method="add"> 
+          <object idref="ReduceSinkOperator0"/> 
+         </void> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
diff --git a/ql/src/test/results/compiler/plan/input5.q.xml b/ql/src/test/results/compiler/plan/input5.q.xml
index 8ff4223c86..2452901263 100644
--- a/ql/src/test/results/compiler/plan/input5.q.xml
+++ b/ql/src/test/results/compiler/plan/input5.q.xml
@@ -305,411 +305,333 @@
        <string>tmap:src_thrift</string> 
        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="ScriptOperator0" class="org.apache.hadoop.hive.ql.exec.ScriptOperator"> 
-                <void property="childOperators"> 
-                 <object class="java.util.ArrayList"> 
+         <void method="add"> 
+          <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object id="ScriptOperator0" class="org.apache.hadoop.hive.ql.exec.ScriptOperator"> 
+              <void property="childOperators"> 
+               <void method="add"> 
+                <object id="ReduceSinkOperator0" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
+                 <void property="columnExprMap"> 
+                  <object class="java.util.HashMap"> 
+                   <void method="put"> 
+                    <string>_col1</string> 
+                    <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                     <void property="column"> 
+                      <string>_col1</string> 
+                     </void> 
+                     <void property="typeInfo"> 
+                      <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void method="put"> 
+                    <string>_col0</string> 
+                    <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                     <void property="column"> 
+                      <string>_col0</string> 
+                     </void> 
+                     <void property="typeInfo"> 
+                      <object idref="PrimitiveTypeInfo0"/> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="conf"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
+                   <void property="distinctColumnIndices"> 
+                    <object class="java.util.ArrayList"/> 
+                   </void> 
+                   <void property="keyCols"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <void property="column"> 
+                        <string>_col0</string> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="keySerializeInfo"> 
+                    <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                     <void property="inputFileFormatClass"> 
+                      <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                     </void> 
+                     <void property="outputFileFormatClass"> 
+                      <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                     </void> 
+                     <void property="properties"> 
+                      <object class="java.util.Properties"> 
+                       <void method="put"> 
+                        <string>columns</string> 
+                        <string>reducesinkkey0</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.lib</string> 
+                        <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.sort.order</string> 
+                        <string>+</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns.types</string> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="numDistributionKeys"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="numReducers"> 
+                    <int>-1</int> 
+                   </void> 
+                   <void property="outputKeyColumnNames"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <string>reducesinkkey0</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="outputValueColumnNames"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <string>_col0</string> 
+                     </void> 
+                     <void method="add"> 
+                      <string>_col1</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="partitionCols"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <void property="column"> 
+                        <string>_col0</string> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="tag"> 
+                    <int>-1</int> 
+                   </void> 
+                   <void property="valueCols"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object idref="ExprNodeColumnDesc1"/> 
+                     </void> 
+                     <void method="add"> 
+                      <object idref="ExprNodeColumnDesc0"/> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="valueSerializeInfo"> 
+                    <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                     <void property="inputFileFormatClass"> 
+                      <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                     </void> 
+                     <void property="outputFileFormatClass"> 
+                      <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                     </void> 
+                     <void property="properties"> 
+                      <object class="java.util.Properties"> 
+                       <void method="put"> 
+                        <string>columns</string> 
+                        <string>_col0,_col1</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.lib</string> 
+                        <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns.types</string> 
+                        <string>string,string</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>escape.delim</string> 
+                        <string>\</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="operatorId"> 
+                  <string>RS_3</string> 
+                 </void> 
+                 <void property="parentOperators"> 
                   <void method="add"> 
-                   <object id="ReduceSinkOperator0" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
-                    <void property="columnExprMap"> 
-                     <object class="java.util.HashMap"> 
-                      <void method="put"> 
-                       <string>_col1</string> 
-                       <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>_col1</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="put"> 
-                       <string>_col0</string> 
-                       <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
-                      <void property="distinctColumnIndices"> 
-                       <object class="java.util.ArrayList"/> 
-                      </void> 
-                      <void property="keyCols"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                          <void property="column"> 
-                           <string>_col0</string> 
-                          </void> 
-                          <void property="typeInfo"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="keySerializeInfo"> 
-                       <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                        <void property="inputFileFormatClass"> 
-                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                        </void> 
-                        <void property="outputFileFormatClass"> 
-                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                        </void> 
-                        <void property="properties"> 
-                         <object class="java.util.Properties"> 
-                          <void method="put"> 
-                           <string>columns</string> 
-                           <string>reducesinkkey0</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.lib</string> 
-                           <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.sort.order</string> 
-                           <string>+</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns.types</string> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="numDistributionKeys"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="numReducers"> 
-                       <int>-1</int> 
-                      </void> 
-                      <void property="outputKeyColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>reducesinkkey0</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="outputValueColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void method="add"> 
-                         <string>_col1</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="partitionCols"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                          <void property="column"> 
-                           <string>_col0</string> 
-                          </void> 
-                          <void property="typeInfo"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="tag"> 
-                       <int>-1</int> 
-                      </void> 
-                      <void property="valueCols"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc1"/> 
-                        </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="valueSerializeInfo"> 
-                       <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                        <void property="inputFileFormatClass"> 
-                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                        </void> 
-                        <void property="outputFileFormatClass"> 
-                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                        </void> 
-                        <void property="properties"> 
-                         <object class="java.util.Properties"> 
-                          <void method="put"> 
-                           <string>columns</string> 
-                           <string>_col0,_col1</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.lib</string> 
-                           <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns.types</string> 
-                           <string>string,string</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>escape.delim</string> 
-                           <string>\</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                   <object idref="ScriptOperator0"/> 
+                  </void> 
+                 </void> 
+                 <void property="schema"> 
+                  <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                   <void property="signature"> 
+                    <object id="ArrayList0" class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="alias"> 
+                        <string>tkey</string> 
+                       </void> 
+                       <void property="internalName"> 
+                        <string>_col0</string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="alias"> 
+                        <string>tvalue</string> 
+                       </void> 
+                       <void property="internalName"> 
+                        <string>_col1</string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+              </void> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.ScriptDesc"> 
+                <void property="errRecordReaderClass"> 
+                 <class>org.apache.hadoop.hive.ql.exec.TextRecordReader</class> 
+                </void> 
+                <void property="inRecordWriterClass"> 
+                 <class>org.apache.hadoop.hive.ql.exec.TextRecordWriter</class> 
+                </void> 
+                <void property="outRecordReaderClass"> 
+                 <class>org.apache.hadoop.hive.ql.exec.TextRecordReader</class> 
+                </void> 
+                <void property="scriptCmd"> 
+                 <string>/bin/cat</string> 
+                </void> 
+                <void property="scriptErrInfo"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                  <void property="inputFileFormatClass"> 
+                   <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                  </void> 
+                  <void property="outputFileFormatClass"> 
+                   <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                  </void> 
+                  <void property="properties"> 
+                   <object class="java.util.Properties"> 
+                    <void method="put"> 
+                     <string>field.delim</string> 
+                     <string>9</string> 
                     </void> 
-                    <void property="operatorId"> 
-                     <string>RS_3</string> 
+                    <void method="put"> 
+                     <string>columns</string> 
+                     <string>KEY</string> 
                     </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="ScriptOperator0"/> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>serialization.lib</string> 
+                     <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
                     </void> 
-                    <void property="schema"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                      <void property="signature"> 
-                       <object id="ArrayList0" class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="alias"> 
-                           <string>tkey</string> 
-                          </void> 
-                          <void property="internalName"> 
-                           <string>_col0</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="alias"> 
-                           <string>tvalue</string> 
-                          </void> 
-                          <void property="internalName"> 
-                           <string>_col1</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>serialization.format</string> 
+                     <string>9</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.ScriptDesc"> 
-                  <void property="errRecordReaderClass"> 
-                   <class>org.apache.hadoop.hive.ql.exec.TextRecordReader</class> 
-                  </void> 
-                  <void property="inRecordWriterClass"> 
-                   <class>org.apache.hadoop.hive.ql.exec.TextRecordWriter</class> 
+                <void property="scriptInputInfo"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                  <void property="inputFileFormatClass"> 
+                   <class>org.apache.hadoop.mapred.TextInputFormat</class> 
                   </void> 
-                  <void property="outRecordReaderClass"> 
-                   <class>org.apache.hadoop.hive.ql.exec.TextRecordReader</class> 
+                  <void property="outputFileFormatClass"> 
+                   <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
                   </void> 
-                  <void property="scriptCmd"> 
-                   <string>/bin/cat</string> 
-                  </void> 
-                  <void property="scriptErrInfo"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                    <void property="inputFileFormatClass"> 
-                     <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-                    </void> 
-                    <void property="outputFileFormatClass"> 
-                     <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                  <void property="properties"> 
+                   <object class="java.util.Properties"> 
+                    <void method="put"> 
+                     <string>field.delim</string> 
+                     <string>9</string> 
                     </void> 
-                    <void property="properties"> 
-                     <object class="java.util.Properties"> 
-                      <void method="put"> 
-                       <string>field.delim</string> 
-                       <string>9</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>columns</string> 
-                       <string>KEY</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.lib</string> 
-                       <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.format</string> 
-                       <string>9</string> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>columns</string> 
+                     <string>_col0,_col1</string> 
                     </void> 
-                   </object> 
-                  </void> 
-                  <void property="scriptInputInfo"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                    <void property="inputFileFormatClass"> 
-                     <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                    <void method="put"> 
+                     <string>serialization.lib</string> 
+                     <string>org.apache.hadoop.hive.serde2.DelimitedJSONSerDe</string> 
                     </void> 
-                    <void property="outputFileFormatClass"> 
-                     <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                    <void method="put"> 
+                     <string>serialization.format</string> 
+                     <string>9</string> 
                     </void> 
-                    <void property="properties"> 
-                     <object class="java.util.Properties"> 
-                      <void method="put"> 
-                       <string>field.delim</string> 
-                       <string>9</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>columns</string> 
-                       <string>_col0,_col1</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.lib</string> 
-                       <string>org.apache.hadoop.hive.serde2.DelimitedJSONSerDe</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.format</string> 
-                       <string>9</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>columns.types</string> 
-                       <string>array&lt;int&gt;,array&lt;struct&lt;myint:int,mystring:string,underscore_int:int&gt;&gt;</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void property="scriptOutputInfo"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                    <void property="inputFileFormatClass"> 
-                     <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-                    </void> 
-                    <void property="outputFileFormatClass"> 
-                     <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-                    </void> 
-                    <void property="properties"> 
-                     <object class="java.util.Properties"> 
-                      <void method="put"> 
-                       <string>field.delim</string> 
-                       <string>9</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>columns</string> 
-                       <string>_col0,_col1</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.lib</string> 
-                       <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.format</string> 
-                       <string>9</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>columns.types</string> 
-                       <string>string,string</string> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>columns.types</string> 
+                     <string>array&lt;int&gt;,array&lt;struct&lt;myint:int,mystring:string,underscore_int:int&gt;&gt;</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="operatorId"> 
-                 <string>SCR_2</string> 
-                </void> 
-                <void property="parentOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object idref="SelectOperator0"/> 
+                <void property="scriptOutputInfo"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                  <void property="inputFileFormatClass"> 
+                   <class>org.apache.hadoop.mapred.TextInputFormat</class> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object idref="ArrayList0"/> 
+                  <void property="outputFileFormatClass"> 
+                   <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
                   </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="columnExprMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>_col1</string> 
-               <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>lintstring</string> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string>src_thrift</string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object id="ListTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.ListTypeInfo"> 
-                  <void property="listElementTypeInfo"> 
-                   <object class="org.apache.hadoop.hive.serde2.typeinfo.StructTypeInfo"> 
-                    <void property="allStructFieldNames"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <string>myint</string> 
-                      </void> 
-                      <void method="add"> 
-                       <string>mystring</string> 
-                      </void> 
-                      <void method="add"> 
-                       <string>underscore_int</string> 
-                      </void> 
-                     </object> 
+                  <void property="properties"> 
+                   <object class="java.util.Properties"> 
+                    <void method="put"> 
+                     <string>field.delim</string> 
+                     <string>9</string> 
+                    </void> 
+                    <void method="put"> 
+                     <string>columns</string> 
+                     <string>_col0,_col1</string> 
+                    </void> 
+                    <void method="put"> 
+                     <string>serialization.lib</string> 
+                     <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
                     </void> 
-                    <void property="allStructFieldTypeInfos"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                        <void property="typeName"> 
-                         <string>int</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void method="add"> 
-                       <object idref="PrimitiveTypeInfo1"/> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>serialization.format</string> 
+                     <string>9</string> 
+                    </void> 
+                    <void method="put"> 
+                     <string>columns.types</string> 
+                     <string>string,string</string> 
                     </void> 
                    </object> 
                   </void> 
@@ -717,97 +639,163 @@
                 </void> 
                </object> 
               </void> 
-              <void method="put"> 
-               <string>_col0</string> 
-               <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>lint</string> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string>src_thrift</string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object id="ListTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.ListTypeInfo"> 
-                  <void property="listElementTypeInfo"> 
-                   <object idref="PrimitiveTypeInfo1"/> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-              <void property="colList"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object idref="ExprNodeColumnDesc3"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeColumnDesc2"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void property="outputColumnNames"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <string>_col0</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col1</string> 
-                </void> 
-               </object> 
+              <void property="operatorId"> 
+               <string>SCR_2</string> 
               </void> 
-             </object> 
-            </void> 
-            <void property="operatorId"> 
-             <string>SEL_1</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator0"/> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="SelectOperator0"/> 
+               </void> 
               </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>_col0</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="ListTypeInfo1"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>array&lt;int&gt;</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>_col1</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="ListTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>array&lt;struct&lt;myint:int,mystring:string,underscore_int:int&gt;&gt;</string> 
-                  </void> 
-                 </object> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
+                 <object idref="ArrayList0"/> 
                 </void> 
                </object> 
               </void> 
              </object> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="columnExprMap"> 
+            <object class="java.util.HashMap"> 
+             <void method="put"> 
+              <string>_col1</string> 
+              <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>lintstring</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>src_thrift</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object id="ListTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.ListTypeInfo"> 
+                 <void property="listElementTypeInfo"> 
+                  <object class="org.apache.hadoop.hive.serde2.typeinfo.StructTypeInfo"> 
+                   <void property="allStructFieldNames"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <string>myint</string> 
+                     </void> 
+                     <void method="add"> 
+                      <string>mystring</string> 
+                     </void> 
+                     <void method="add"> 
+                      <string>underscore_int</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="allStructFieldTypeInfos"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                       <void property="typeName"> 
+                        <string>int</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object idref="PrimitiveTypeInfo0"/> 
+                     </void> 
+                     <void method="add"> 
+                      <object idref="PrimitiveTypeInfo1"/> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col0</string> 
+              <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>lint</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>src_thrift</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object id="ListTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.ListTypeInfo"> 
+                 <void property="listElementTypeInfo"> 
+                  <object idref="PrimitiveTypeInfo1"/> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+             <void property="colList"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object idref="ExprNodeColumnDesc3"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeColumnDesc2"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="outputColumnNames"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <string>_col0</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col1</string> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>SEL_1</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator0"/> 
+            </void> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>_col0</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="ListTypeInfo1"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>array&lt;int&gt;</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>_col1</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="ListTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>array&lt;struct&lt;myint:int,mystring:string,underscore_int:int&gt;&gt;</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
@@ -1203,200 +1191,88 @@
       <void property="reducer"> 
        <object id="ExtractOperator0" class="org.apache.hadoop.hive.ql.exec.ExtractOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                  <void property="destTableId"> 
-                   <int>1</int> 
-                  </void> 
-                  <void property="dirName"> 
-                   #### A masked pattern was here #### 
-                  </void> 
-                  <void property="gatherStats"> 
-                   <boolean>true</boolean> 
-                  </void> 
-                  <void property="lbCtx"> 
-                   <object idref="ListBucketingCtx0"/> 
-                  </void> 
-                  <void property="maxStatsKeyPrefixLength"> 
-                   <int>150</int> 
-                  </void> 
-                  <void property="numFiles"> 
-                   <int>1</int> 
-                  </void> 
-                  <void property="statsAggPrefix"> 
-                   #### A masked pattern was here #### 
-                  </void> 
-                  <void property="statsCollectRawDataSize"> 
-                   <boolean>true</boolean> 
-                  </void> 
-                  <void property="tableInfo"> 
-                   <object idref="TableDesc0"/> 
-                  </void> 
-                  <void property="totalFiles"> 
-                   <int>1</int> 
-                  </void> 
-                 </object> 
+         <void method="add"> 
+          <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                <void property="destTableId"> 
+                 <int>1</int> 
                 </void> 
-                <void property="operatorId"> 
-                 <string>FS_6</string> 
+                <void property="dirName"> 
+                 #### A masked pattern was here #### 
                 </void> 
-                <void property="parentOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object idref="SelectOperator1"/> 
-                  </void> 
-                 </object> 
+                <void property="gatherStats"> 
+                 <boolean>true</boolean> 
                 </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>key</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>value</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
+                <void property="lbCtx"> 
+                 <object idref="ListBucketingCtx0"/> 
                 </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="columnExprMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>_col1</string> 
-               <object id="ExprNodeColumnDesc4" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>_col1</string> 
+                <void property="maxStatsKeyPrefixLength"> 
+                 <int>150</int> 
                 </void> 
-                <void property="tabAlias"> 
-                 <string>tmap</string> 
+                <void property="numFiles"> 
+                 <int>1</int> 
                 </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
+                <void property="statsAggPrefix"> 
+                 #### A masked pattern was here #### 
                 </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>_col0</string> 
-               <object id="ExprNodeColumnDesc5" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>_col0</string> 
+                <void property="statsCollectRawDataSize"> 
+                 <boolean>true</boolean> 
                 </void> 
-                <void property="tabAlias"> 
-                 <string>tmap</string> 
+                <void property="tableInfo"> 
+                 <object idref="TableDesc0"/> 
                 </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
+                <void property="totalFiles"> 
+                 <int>1</int> 
                 </void> 
                </object> 
               </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-              <void property="colList"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object idref="ExprNodeColumnDesc5"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeColumnDesc4"/> 
-                </void> 
-               </object> 
+              <void property="operatorId"> 
+               <string>FS_6</string> 
               </void> 
-              <void property="outputColumnNames"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <string>_col0</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col1</string> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="operatorId"> 
-             <string>SEL_5</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="ExtractOperator0"/> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="SelectOperator1"/> 
+               </void> 
               </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>_col0</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>tmap</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>_col1</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>tmap</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>key</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
                   </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>value</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
                   </void> 
                  </object> 
                 </void> 
@@ -1404,9 +1280,113 @@
               </void> 
              </object> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="columnExprMap"> 
+            <object class="java.util.HashMap"> 
+             <void method="put"> 
+              <string>_col1</string> 
+              <object id="ExprNodeColumnDesc4" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>_col1</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>tmap</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col0</string> 
+              <object id="ExprNodeColumnDesc5" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>_col0</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>tmap</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+             <void property="colList"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object idref="ExprNodeColumnDesc5"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeColumnDesc4"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="outputColumnNames"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <string>_col0</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col1</string> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>SEL_5</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="ExtractOperator0"/> 
+            </void> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>_col0</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>tmap</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>_col1</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>tmap</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.ExtractDesc"> 
@@ -1429,11 +1409,9 @@
          <string>EX_4</string> 
         </void> 
         <void property="parentOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object idref="ReduceSinkOperator0"/> 
-          </void> 
-         </object> 
+         <void method="add"> 
+          <object idref="ReduceSinkOperator0"/> 
+         </void> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
diff --git a/ql/src/test/results/compiler/plan/input6.q.xml b/ql/src/test/results/compiler/plan/input6.q.xml
index 69dc7dfe3b..b3fda7649c 100644
--- a/ql/src/test/results/compiler/plan/input6.q.xml
+++ b/ql/src/test/results/compiler/plan/input6.q.xml
@@ -79,137 +79,133 @@
                        #### A masked pattern was here #### 
                        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                         <void property="childOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                            <void property="conf"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                              <void property="dirName"> 
-                               #### A masked pattern was here #### 
-                              </void> 
-                              <void property="numFiles"> 
-                               <int>1</int> 
-                              </void> 
-                              <void property="tableInfo"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                                <void property="inputFileFormatClass"> 
-                                 <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-                                </void> 
-                                <void property="outputFileFormatClass"> 
-                                 <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-                                </void> 
-                                <void property="properties"> 
-                                 <object class="java.util.Properties"> 
-                                  <void method="put"> 
-                                   <string>name</string> 
-                                   <string>default.dest1</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>columns.types</string> 
-                                   <string>string:string</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.ddl</string> 
-                                   <string>struct dest1 { string key, string value}</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.format</string> 
-                                   <string>1</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>columns</string> 
-                                   <string>key,value</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>bucket_count</string> 
-                                   <string>-1</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.lib</string> 
-                                   <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>file.inputformat</string> 
-                                   <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>location</string> 
-                                   #### A masked pattern was here #### 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>file.outputformat</string> 
-                                   <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>transient_lastDdlTime</string> 
-                                   #### A masked pattern was here #### 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void property="totalFiles"> 
-                               <int>1</int> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="operatorId"> 
-                             <string>FS_6</string> 
-                            </void> 
-                            <void property="parentOperators"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object idref="TableScanOperator0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="schema"> 
-                             <object id="RowSchema0" class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                              <void property="signature"> 
-                               <object class="java.util.ArrayList"> 
-                                <void method="add"> 
-                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                  <void property="internalName"> 
-                                   <string>key</string> 
-                                  </void> 
-                                  <void property="tabAlias"> 
-                                   <string></string> 
-                                  </void> 
-                                  <void property="type"> 
-                                   <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                                    <void property="typeName"> 
-                                     <string>string</string> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                  <void property="typeName"> 
-                                   <string>string</string> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void method="add"> 
-                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                  <void property="internalName"> 
-                                   <string>value</string> 
-                                  </void> 
-                                  <void property="tabAlias"> 
-                                   <string></string> 
-                                  </void> 
-                                  <void property="type"> 
-                                   <object idref="PrimitiveTypeInfo0"/> 
-                                  </void> 
-                                  <void property="typeName"> 
-                                   <string>string</string> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
+                         <void method="add"> 
+                          <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                           <void property="conf"> 
+                            <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                             <void property="dirName"> 
+                              #### A masked pattern was here #### 
+                             </void> 
+                             <void property="numFiles"> 
+                              <int>1</int> 
+                             </void> 
+                             <void property="tableInfo"> 
+                              <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                               <void property="inputFileFormatClass"> 
+                                <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                               </void> 
+                               <void property="outputFileFormatClass"> 
+                                <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                               </void> 
+                               <void property="properties"> 
+                                <object class="java.util.Properties"> 
+                                 <void method="put"> 
+                                  <string>name</string> 
+                                  <string>default.dest1</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>columns.types</string> 
+                                  <string>string:string</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.ddl</string> 
+                                  <string>struct dest1 { string key, string value}</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.format</string> 
+                                  <string>1</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>columns</string> 
+                                  <string>key,value</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>bucket_count</string> 
+                                  <string>-1</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.lib</string> 
+                                  <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>file.inputformat</string> 
+                                  <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>location</string> 
+                                  #### A masked pattern was here #### 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>file.outputformat</string> 
+                                  <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>transient_lastDdlTime</string> 
+                                  #### A masked pattern was here #### 
+                                 </void> 
+                                </object> 
+                               </void> 
+                              </object> 
+                             </void> 
+                             <void property="totalFiles"> 
+                              <int>1</int> 
+                             </void> 
+                            </object> 
+                           </void> 
+                           <void property="operatorId"> 
+                            <string>FS_6</string> 
+                           </void> 
+                           <void property="parentOperators"> 
+                            <void method="add"> 
+                             <object idref="TableScanOperator0"/> 
                             </void> 
-                           </object> 
-                          </void> 
-                         </object> 
+                           </void> 
+                           <void property="schema"> 
+                            <object id="RowSchema0" class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                             <void property="signature"> 
+                              <object class="java.util.ArrayList"> 
+                               <void method="add"> 
+                                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                 <void property="internalName"> 
+                                  <string>key</string> 
+                                 </void> 
+                                 <void property="tabAlias"> 
+                                  <string></string> 
+                                 </void> 
+                                 <void property="type"> 
+                                  <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                                   <void property="typeName"> 
+                                    <string>string</string> 
+                                   </void> 
+                                  </object> 
+                                 </void> 
+                                 <void property="typeName"> 
+                                  <string>string</string> 
+                                 </void> 
+                                </object> 
+                               </void> 
+                               <void method="add"> 
+                                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                 <void property="internalName"> 
+                                  <string>value</string> 
+                                 </void> 
+                                 <void property="tabAlias"> 
+                                  <string></string> 
+                                 </void> 
+                                 <void property="type"> 
+                                  <object idref="PrimitiveTypeInfo0"/> 
+                                 </void> 
+                                 <void property="typeName"> 
+                                  <string>string</string> 
+                                 </void> 
+                                </object> 
+                               </void> 
+                              </object> 
+                             </void> 
+                            </object> 
+                           </void> 
+                          </object> 
+                         </void> 
                         </void> 
                         <void property="conf"> 
                          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"/> 
@@ -638,206 +634,161 @@
        <string>src1</string> 
        <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                <void property="childOperators"> 
-                 <object class="java.util.ArrayList"> 
+         <void method="add"> 
+          <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+              <void property="childOperators"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                 <void property="conf"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                   <void property="destTableId"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="dirName"> 
+                    #### A masked pattern was here #### 
+                   </void> 
+                   <void property="gatherStats"> 
+                    <boolean>true</boolean> 
+                   </void> 
+                   <void property="lbCtx"> 
+                    <object idref="ListBucketingCtx0"/> 
+                   </void> 
+                   <void property="maxStatsKeyPrefixLength"> 
+                    <int>150</int> 
+                   </void> 
+                   <void property="numFiles"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="statsAggPrefix"> 
+                    #### A masked pattern was here #### 
+                   </void> 
+                   <void property="statsCollectRawDataSize"> 
+                    <boolean>true</boolean> 
+                   </void> 
+                   <void property="tableInfo"> 
+                    <object idref="TableDesc0"/> 
+                   </void> 
+                   <void property="totalFiles"> 
+                    <int>1</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="operatorId"> 
+                  <string>FS_3</string> 
+                 </void> 
+                 <void property="parentOperators"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                      <void property="destTableId"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="dirName"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="gatherStats"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="lbCtx"> 
-                       <object idref="ListBucketingCtx0"/> 
-                      </void> 
-                      <void property="maxStatsKeyPrefixLength"> 
-                       <int>150</int> 
-                      </void> 
-                      <void property="numFiles"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="statsAggPrefix"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="statsCollectRawDataSize"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="tableInfo"> 
-                       <object idref="TableDesc0"/> 
-                      </void> 
-                      <void property="totalFiles"> 
-                       <int>1</int> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="operatorId"> 
-                     <string>FS_3</string> 
-                    </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="SelectOperator0"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="schema"> 
-                     <object idref="RowSchema0"/> 
-                    </void> 
-                   </object> 
+                   <object idref="SelectOperator0"/> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="columnExprMap"> 
-                 <object class="java.util.HashMap"> 
-                  <void method="put"> 
-                   <string>_col1</string> 
-                   <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>value</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>src1</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
+                 </void> 
+                 <void property="schema"> 
+                  <object idref="RowSchema0"/> 
+                 </void> 
+                </object> 
+               </void> 
+              </void> 
+              <void property="columnExprMap"> 
+               <object class="java.util.HashMap"> 
+                <void method="put"> 
+                 <string>_col1</string> 
+                 <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>value</string> 
                   </void> 
-                  <void method="put"> 
-                   <string>_col0</string> 
-                   <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>key</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>src1</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
+                  <void property="tabAlias"> 
+                   <string>src1</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                  <void property="colList"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc1"/> 
-                    </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc0"/> 
-                    </void> 
-                   </object> 
+                <void method="put"> 
+                 <string>_col0</string> 
+                 <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>key</string> 
                   </void> 
-                  <void property="outputColumnNames"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <string>_col0</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col1</string> 
-                    </void> 
-                   </object> 
+                  <void property="tabAlias"> 
+                   <string>src1</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="operatorId"> 
-                 <string>SEL_2</string> 
-                </void> 
-                <void property="parentOperators"> 
+               </object> 
+              </void> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                <void property="colList"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object idref="FilterOperator0"/> 
+                   <object idref="ExprNodeColumnDesc1"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object idref="ExprNodeColumnDesc0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>src1</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>src1</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                <void property="outputColumnNames"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <string>_col0</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col1</string> 
                   </void> 
                  </object> 
                 </void> 
                </object> 
               </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-              <void property="predicate"> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
+              <void property="operatorId"> 
+               <string>SEL_2</string> 
+              </void> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="FilterOperator0"/> 
+               </void> 
+              </void> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>key</string> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
                     </void> 
                     <void property="tabAlias"> 
                      <string>src1</string> 
                     </void> 
-                    <void property="typeInfo"> 
+                    <void property="type"> 
                      <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
                    </object> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPNull"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                  <void property="typeName"> 
-                   <string>boolean</string> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col1</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string>src1</string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
                   </void> 
                  </object> 
                 </void> 
@@ -845,59 +796,92 @@
               </void> 
              </object> 
             </void> 
-            <void property="operatorId"> 
-             <string>FIL_4</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator1"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>key</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src1</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>value</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src1</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
+             <void property="predicate"> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                   <void property="column"> 
+                    <string>key</string> 
+                   </void> 
+                   <void property="tabAlias"> 
+                    <string>src1</string> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo0"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPNull"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                 <void property="typeName"> 
+                  <string>boolean</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>FIL_4</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator1"/> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>key</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src1</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>value</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src1</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
diff --git a/ql/src/test/results/compiler/plan/input7.q.xml b/ql/src/test/results/compiler/plan/input7.q.xml
index b6270eafa1..d3998d0f10 100644
--- a/ql/src/test/results/compiler/plan/input7.q.xml
+++ b/ql/src/test/results/compiler/plan/input7.q.xml
@@ -79,137 +79,133 @@
                        #### A masked pattern was here #### 
                        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                         <void property="childOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                            <void property="conf"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                              <void property="dirName"> 
-                               #### A masked pattern was here #### 
-                              </void> 
-                              <void property="numFiles"> 
-                               <int>1</int> 
-                              </void> 
-                              <void property="tableInfo"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                                <void property="inputFileFormatClass"> 
-                                 <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-                                </void> 
-                                <void property="outputFileFormatClass"> 
-                                 <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-                                </void> 
-                                <void property="properties"> 
-                                 <object class="java.util.Properties"> 
-                                  <void method="put"> 
-                                   <string>name</string> 
-                                   <string>default.dest1</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>columns.types</string> 
-                                   <string>string:string</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.ddl</string> 
-                                   <string>struct dest1 { string key, string value}</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.format</string> 
-                                   <string>1</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>columns</string> 
-                                   <string>key,value</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>bucket_count</string> 
-                                   <string>-1</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.lib</string> 
-                                   <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>file.inputformat</string> 
-                                   <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>location</string> 
-                                   #### A masked pattern was here #### 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>file.outputformat</string> 
-                                   <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>transient_lastDdlTime</string> 
-                                   #### A masked pattern was here #### 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void property="totalFiles"> 
-                               <int>1</int> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="operatorId"> 
-                             <string>FS_4</string> 
-                            </void> 
-                            <void property="parentOperators"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object idref="TableScanOperator0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="schema"> 
-                             <object id="RowSchema0" class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                              <void property="signature"> 
-                               <object class="java.util.ArrayList"> 
-                                <void method="add"> 
-                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                  <void property="internalName"> 
-                                   <string>key</string> 
-                                  </void> 
-                                  <void property="tabAlias"> 
-                                   <string></string> 
-                                  </void> 
-                                  <void property="type"> 
-                                   <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                                    <void property="typeName"> 
-                                     <string>string</string> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                  <void property="typeName"> 
-                                   <string>string</string> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void method="add"> 
-                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                  <void property="internalName"> 
-                                   <string>value</string> 
-                                  </void> 
-                                  <void property="tabAlias"> 
-                                   <string></string> 
-                                  </void> 
-                                  <void property="type"> 
-                                   <object idref="PrimitiveTypeInfo0"/> 
-                                  </void> 
-                                  <void property="typeName"> 
-                                   <string>string</string> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
+                         <void method="add"> 
+                          <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                           <void property="conf"> 
+                            <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                             <void property="dirName"> 
+                              #### A masked pattern was here #### 
+                             </void> 
+                             <void property="numFiles"> 
+                              <int>1</int> 
+                             </void> 
+                             <void property="tableInfo"> 
+                              <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                               <void property="inputFileFormatClass"> 
+                                <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                               </void> 
+                               <void property="outputFileFormatClass"> 
+                                <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                               </void> 
+                               <void property="properties"> 
+                                <object class="java.util.Properties"> 
+                                 <void method="put"> 
+                                  <string>name</string> 
+                                  <string>default.dest1</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>columns.types</string> 
+                                  <string>string:string</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.ddl</string> 
+                                  <string>struct dest1 { string key, string value}</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.format</string> 
+                                  <string>1</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>columns</string> 
+                                  <string>key,value</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>bucket_count</string> 
+                                  <string>-1</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.lib</string> 
+                                  <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>file.inputformat</string> 
+                                  <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>location</string> 
+                                  #### A masked pattern was here #### 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>file.outputformat</string> 
+                                  <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>transient_lastDdlTime</string> 
+                                  #### A masked pattern was here #### 
+                                 </void> 
+                                </object> 
+                               </void> 
+                              </object> 
+                             </void> 
+                             <void property="totalFiles"> 
+                              <int>1</int> 
+                             </void> 
+                            </object> 
+                           </void> 
+                           <void property="operatorId"> 
+                            <string>FS_4</string> 
+                           </void> 
+                           <void property="parentOperators"> 
+                            <void method="add"> 
+                             <object idref="TableScanOperator0"/> 
                             </void> 
-                           </object> 
-                          </void> 
-                         </object> 
+                           </void> 
+                           <void property="schema"> 
+                            <object id="RowSchema0" class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                             <void property="signature"> 
+                              <object class="java.util.ArrayList"> 
+                               <void method="add"> 
+                                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                 <void property="internalName"> 
+                                  <string>key</string> 
+                                 </void> 
+                                 <void property="tabAlias"> 
+                                  <string></string> 
+                                 </void> 
+                                 <void property="type"> 
+                                  <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                                   <void property="typeName"> 
+                                    <string>string</string> 
+                                   </void> 
+                                  </object> 
+                                 </void> 
+                                 <void property="typeName"> 
+                                  <string>string</string> 
+                                 </void> 
+                                </object> 
+                               </void> 
+                               <void method="add"> 
+                                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                 <void property="internalName"> 
+                                  <string>value</string> 
+                                 </void> 
+                                 <void property="tabAlias"> 
+                                  <string></string> 
+                                 </void> 
+                                 <void property="type"> 
+                                  <object idref="PrimitiveTypeInfo0"/> 
+                                 </void> 
+                                 <void property="typeName"> 
+                                  <string>string</string> 
+                                 </void> 
+                                </object> 
+                               </void> 
+                              </object> 
+                             </void> 
+                            </object> 
+                           </void> 
+                          </object> 
+                         </void> 
                         </void> 
                         <void property="conf"> 
                          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"/> 
@@ -638,168 +634,160 @@
        <string>src1</string> 
        <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                  <void property="destTableId"> 
-                   <int>1</int> 
-                  </void> 
-                  <void property="dirName"> 
-                   #### A masked pattern was here #### 
-                  </void> 
-                  <void property="gatherStats"> 
-                   <boolean>true</boolean> 
-                  </void> 
-                  <void property="lbCtx"> 
-                   <object idref="ListBucketingCtx0"/> 
-                  </void> 
-                  <void property="maxStatsKeyPrefixLength"> 
-                   <int>150</int> 
-                  </void> 
-                  <void property="numFiles"> 
-                   <int>1</int> 
-                  </void> 
-                  <void property="statsAggPrefix"> 
-                   #### A masked pattern was here #### 
-                  </void> 
-                  <void property="statsCollectRawDataSize"> 
-                   <boolean>true</boolean> 
-                  </void> 
-                  <void property="tableInfo"> 
-                   <object idref="TableDesc0"/> 
-                  </void> 
-                  <void property="totalFiles"> 
-                   <int>1</int> 
-                  </void> 
-                 </object> 
+         <void method="add"> 
+          <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                <void property="destTableId"> 
+                 <int>1</int> 
                 </void> 
-                <void property="operatorId"> 
-                 <string>FS_2</string> 
+                <void property="dirName"> 
+                 #### A masked pattern was here #### 
                 </void> 
-                <void property="parentOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object idref="SelectOperator0"/> 
-                  </void> 
-                 </object> 
+                <void property="gatherStats"> 
+                 <boolean>true</boolean> 
                 </void> 
-                <void property="schema"> 
-                 <object idref="RowSchema0"/> 
+                <void property="lbCtx"> 
+                 <object idref="ListBucketingCtx0"/> 
                 </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="columnExprMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>_col1</string> 
-               <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>key</string> 
+                <void property="maxStatsKeyPrefixLength"> 
+                 <int>150</int> 
                 </void> 
-                <void property="tabAlias"> 
-                 <string>src1</string> 
+                <void property="numFiles"> 
+                 <int>1</int> 
                 </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
+                <void property="statsAggPrefix"> 
+                 #### A masked pattern was here #### 
                 </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>_col0</string> 
-               <object id="ExprNodeConstantDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
+                <void property="statsCollectRawDataSize"> 
+                 <boolean>true</boolean> 
                 </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-              <void property="colList"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object idref="ExprNodeConstantDesc0"/> 
+                <void property="tableInfo"> 
+                 <object idref="TableDesc0"/> 
                 </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeColumnDesc0"/> 
+                <void property="totalFiles"> 
+                 <int>1</int> 
                 </void> 
                </object> 
               </void> 
-              <void property="outputColumnNames"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <string>_col0</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col1</string> 
-                </void> 
-               </object> 
+              <void property="operatorId"> 
+               <string>FS_2</string> 
               </void> 
-             </object> 
-            </void> 
-            <void property="operatorId"> 
-             <string>SEL_1</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator1"/> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="SelectOperator0"/> 
+               </void> 
               </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>_col0</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                    <void property="typeName"> 
-                     <string>void</string> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>void</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>_col1</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src1</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
+              <void property="schema"> 
+               <object idref="RowSchema0"/> 
               </void> 
              </object> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="columnExprMap"> 
+            <object class="java.util.HashMap"> 
+             <void method="put"> 
+              <string>_col1</string> 
+              <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>key</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>src1</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col0</string> 
+              <object id="ExprNodeConstantDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+             <void property="colList"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object idref="ExprNodeConstantDesc0"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeColumnDesc0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="outputColumnNames"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <string>_col0</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col1</string> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>SEL_1</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator1"/> 
+            </void> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>_col0</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                   <void property="typeName"> 
+                    <string>void</string> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>void</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>_col1</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src1</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
diff --git a/ql/src/test/results/compiler/plan/input8.q.xml b/ql/src/test/results/compiler/plan/input8.q.xml
index d218950a3e..59b7d27420 100644
--- a/ql/src/test/results/compiler/plan/input8.q.xml
+++ b/ql/src/test/results/compiler/plan/input8.q.xml
@@ -153,325 +153,131 @@
        <string>src1</string> 
        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                  <void property="dirName"> 
-                   #### A masked pattern was here #### 
-                  </void> 
-                  <void property="numFiles"> 
-                   <int>1</int> 
-                  </void> 
-                  <void property="statsAggPrefix"> 
-                   #### A masked pattern was here #### 
+         <void method="add"> 
+          <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                <void property="dirName"> 
+                 #### A masked pattern was here #### 
+                </void> 
+                <void property="numFiles"> 
+                 <int>1</int> 
+                </void> 
+                <void property="statsAggPrefix"> 
+                 #### A masked pattern was here #### 
+                </void> 
+                <void property="statsCollectRawDataSize"> 
+                 <boolean>true</boolean> 
+                </void> 
+                <void property="tableInfo"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                  <void property="inputFileFormatClass"> 
+                   <class>org.apache.hadoop.mapred.TextInputFormat</class> 
                   </void> 
-                  <void property="statsCollectRawDataSize"> 
-                   <boolean>true</boolean> 
+                  <void property="outputFileFormatClass"> 
+                   <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
                   </void> 
-                  <void property="tableInfo"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                    <void property="inputFileFormatClass"> 
-                     <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                  <void property="properties"> 
+                   <object class="java.util.Properties"> 
+                    <void method="put"> 
+                     <string>hive.serialization.extend.nesting.levels</string> 
+                     <string>true</string> 
                     </void> 
-                    <void property="outputFileFormatClass"> 
-                     <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                    <void method="put"> 
+                     <string>columns</string> 
+                     <string>_col0,_col1,_col2</string> 
                     </void> 
-                    <void property="properties"> 
-                     <object class="java.util.Properties"> 
-                      <void method="put"> 
-                       <string>hive.serialization.extend.nesting.levels</string> 
-                       <string>true</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>columns</string> 
-                       <string>_col0,_col1,_col2</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.lib</string> 
-                       <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.format</string> 
-                       <string>1</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>columns.types</string> 
-                       <string>double:double:double</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>escape.delim</string> 
-                       <string>\</string> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>serialization.lib</string> 
+                     <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
                     </void> 
-                   </object> 
-                  </void> 
-                  <void property="totalFiles"> 
-                   <int>1</int> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="operatorId"> 
-                 <string>FS_2</string> 
-                </void> 
-                <void property="parentOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object idref="SelectOperator0"/> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                        <void property="typeName"> 
-                         <string>double</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>double</string> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>serialization.format</string> 
+                     <string>1</string> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>double</string> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>columns.types</string> 
+                     <string>double:double:double</string> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col2</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>double</string> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>escape.delim</string> 
+                     <string>\</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="columnExprMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>_col2</string> 
-               <object id="ExprNodeGenericFuncDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeNullDesc"/> 
-                  </void> 
-                  <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeNullDesc"/> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPPlus"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
+                <void property="totalFiles"> 
+                 <int>1</int> 
                 </void> 
                </object> 
               </void> 
-              <void method="put"> 
-               <string>_col1</string> 
-               <object id="ExprNodeGenericFuncDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
+              <void property="operatorId"> 
+               <string>FS_2</string> 
+              </void> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="SelectOperator0"/> 
+               </void> 
+              </void> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>key</string> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
                     </void> 
                     <void property="tabAlias"> 
-                     <string>src1</string> 
+                     <string></string> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                    <void property="type"> 
+                     <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
                       <void property="typeName"> 
-                       <string>string</string> 
+                       <string>double</string> 
                       </void> 
                      </object> 
                     </void> 
+                    <void property="typeName"> 
+                     <string>double</string> 
+                    </void> 
                    </object> 
                   </void> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeNullDesc"/> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPMinus"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>_col0</string> 
-               <object id="ExprNodeGenericFuncDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
-                     <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                      <void property="typeName"> 
-                       <string>int</string> 
-                      </void> 
-                     </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col1</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                    <void property="value"> 
-                     <int>4</int> 
+                    <void property="typeName"> 
+                     <string>double</string> 
                     </void> 
                    </object> 
                   </void> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeNullDesc"/> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPPlus"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-              <void property="colList"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object idref="ExprNodeGenericFuncDesc2"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeGenericFuncDesc1"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeGenericFuncDesc0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void property="outputColumnNames"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <string>_col0</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col1</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col2</string> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="operatorId"> 
-             <string>SEL_1</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator0"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>_c0</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col0</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>double</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>_c1</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col1</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>double</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>_c2</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col2</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>double</string> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col2</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>double</string> 
+                    </void> 
+                   </object> 
                   </void> 
                  </object> 
                 </void> 
@@ -479,9 +285,195 @@
               </void> 
              </object> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="columnExprMap"> 
+            <object class="java.util.HashMap"> 
+             <void method="put"> 
+              <string>_col2</string> 
+              <object id="ExprNodeGenericFuncDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeNullDesc"/> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeNullDesc"/> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPPlus"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col1</string> 
+              <object id="ExprNodeGenericFuncDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                   <void property="column"> 
+                    <string>key</string> 
+                   </void> 
+                   <void property="tabAlias"> 
+                    <string>src1</string> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                     <void property="typeName"> 
+                      <string>string</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeNullDesc"/> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPMinus"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col0</string> 
+              <object id="ExprNodeGenericFuncDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                     <void property="typeName"> 
+                      <string>int</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="value"> 
+                    <int>4</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeNullDesc"/> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPPlus"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+             <void property="colList"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object idref="ExprNodeGenericFuncDesc2"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeGenericFuncDesc1"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeGenericFuncDesc0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="outputColumnNames"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <string>_col0</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col1</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col2</string> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>SEL_1</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator0"/> 
+            </void> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>_c0</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col0</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>double</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>_c1</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col1</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>double</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>_c2</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col2</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>double</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
diff --git a/ql/src/test/results/compiler/plan/input9.q.xml b/ql/src/test/results/compiler/plan/input9.q.xml
index 1424f4e19f..c79ac144aa 100644
--- a/ql/src/test/results/compiler/plan/input9.q.xml
+++ b/ql/src/test/results/compiler/plan/input9.q.xml
@@ -79,137 +79,133 @@
                        #### A masked pattern was here #### 
                        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                         <void property="childOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                            <void property="conf"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                              <void property="dirName"> 
-                               #### A masked pattern was here #### 
-                              </void> 
-                              <void property="numFiles"> 
-                               <int>1</int> 
-                              </void> 
-                              <void property="tableInfo"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                                <void property="inputFileFormatClass"> 
-                                 <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-                                </void> 
-                                <void property="outputFileFormatClass"> 
-                                 <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-                                </void> 
-                                <void property="properties"> 
-                                 <object class="java.util.Properties"> 
-                                  <void method="put"> 
-                                   <string>name</string> 
-                                   <string>default.dest1</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>columns.types</string> 
-                                   <string>string:string</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.ddl</string> 
-                                   <string>struct dest1 { string key, string value}</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.format</string> 
-                                   <string>1</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>columns</string> 
-                                   <string>key,value</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>bucket_count</string> 
-                                   <string>-1</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.lib</string> 
-                                   <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>file.inputformat</string> 
-                                   <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>location</string> 
-                                   #### A masked pattern was here #### 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>file.outputformat</string> 
-                                   <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>transient_lastDdlTime</string> 
-                                   #### A masked pattern was here #### 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void property="totalFiles"> 
-                               <int>1</int> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="operatorId"> 
-                             <string>FS_6</string> 
-                            </void> 
-                            <void property="parentOperators"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object idref="TableScanOperator0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="schema"> 
-                             <object id="RowSchema0" class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                              <void property="signature"> 
-                               <object class="java.util.ArrayList"> 
-                                <void method="add"> 
-                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                  <void property="internalName"> 
-                                   <string>key</string> 
-                                  </void> 
-                                  <void property="tabAlias"> 
-                                   <string></string> 
-                                  </void> 
-                                  <void property="type"> 
-                                   <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                                    <void property="typeName"> 
-                                     <string>string</string> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                  <void property="typeName"> 
-                                   <string>string</string> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void method="add"> 
-                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                  <void property="internalName"> 
-                                   <string>value</string> 
-                                  </void> 
-                                  <void property="tabAlias"> 
-                                   <string></string> 
-                                  </void> 
-                                  <void property="type"> 
-                                   <object idref="PrimitiveTypeInfo0"/> 
-                                  </void> 
-                                  <void property="typeName"> 
-                                   <string>string</string> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
+                         <void method="add"> 
+                          <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                           <void property="conf"> 
+                            <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                             <void property="dirName"> 
+                              #### A masked pattern was here #### 
+                             </void> 
+                             <void property="numFiles"> 
+                              <int>1</int> 
+                             </void> 
+                             <void property="tableInfo"> 
+                              <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                               <void property="inputFileFormatClass"> 
+                                <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                               </void> 
+                               <void property="outputFileFormatClass"> 
+                                <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                               </void> 
+                               <void property="properties"> 
+                                <object class="java.util.Properties"> 
+                                 <void method="put"> 
+                                  <string>name</string> 
+                                  <string>default.dest1</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>columns.types</string> 
+                                  <string>string:string</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.ddl</string> 
+                                  <string>struct dest1 { string key, string value}</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.format</string> 
+                                  <string>1</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>columns</string> 
+                                  <string>key,value</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>bucket_count</string> 
+                                  <string>-1</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.lib</string> 
+                                  <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>file.inputformat</string> 
+                                  <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>location</string> 
+                                  #### A masked pattern was here #### 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>file.outputformat</string> 
+                                  <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>transient_lastDdlTime</string> 
+                                  #### A masked pattern was here #### 
+                                 </void> 
+                                </object> 
+                               </void> 
+                              </object> 
+                             </void> 
+                             <void property="totalFiles"> 
+                              <int>1</int> 
+                             </void> 
+                            </object> 
+                           </void> 
+                           <void property="operatorId"> 
+                            <string>FS_6</string> 
+                           </void> 
+                           <void property="parentOperators"> 
+                            <void method="add"> 
+                             <object idref="TableScanOperator0"/> 
                             </void> 
-                           </object> 
-                          </void> 
-                         </object> 
+                           </void> 
+                           <void property="schema"> 
+                            <object id="RowSchema0" class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                             <void property="signature"> 
+                              <object class="java.util.ArrayList"> 
+                               <void method="add"> 
+                                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                 <void property="internalName"> 
+                                  <string>key</string> 
+                                 </void> 
+                                 <void property="tabAlias"> 
+                                  <string></string> 
+                                 </void> 
+                                 <void property="type"> 
+                                  <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                                   <void property="typeName"> 
+                                    <string>string</string> 
+                                   </void> 
+                                  </object> 
+                                 </void> 
+                                 <void property="typeName"> 
+                                  <string>string</string> 
+                                 </void> 
+                                </object> 
+                               </void> 
+                               <void method="add"> 
+                                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                 <void property="internalName"> 
+                                  <string>value</string> 
+                                 </void> 
+                                 <void property="tabAlias"> 
+                                  <string></string> 
+                                 </void> 
+                                 <void property="type"> 
+                                  <object idref="PrimitiveTypeInfo0"/> 
+                                 </void> 
+                                 <void property="typeName"> 
+                                  <string>string</string> 
+                                 </void> 
+                                </object> 
+                               </void> 
+                              </object> 
+                             </void> 
+                            </object> 
+                           </void> 
+                          </object> 
+                         </void> 
                         </void> 
                         <void property="conf"> 
                          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"/> 
@@ -638,228 +634,156 @@
        <string>src1</string> 
        <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                <void property="childOperators"> 
-                 <object class="java.util.ArrayList"> 
+         <void method="add"> 
+          <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+              <void property="childOperators"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                 <void property="conf"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                   <void property="destTableId"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="dirName"> 
+                    #### A masked pattern was here #### 
+                   </void> 
+                   <void property="gatherStats"> 
+                    <boolean>true</boolean> 
+                   </void> 
+                   <void property="lbCtx"> 
+                    <object idref="ListBucketingCtx0"/> 
+                   </void> 
+                   <void property="maxStatsKeyPrefixLength"> 
+                    <int>150</int> 
+                   </void> 
+                   <void property="numFiles"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="statsAggPrefix"> 
+                    #### A masked pattern was here #### 
+                   </void> 
+                   <void property="statsCollectRawDataSize"> 
+                    <boolean>true</boolean> 
+                   </void> 
+                   <void property="tableInfo"> 
+                    <object idref="TableDesc0"/> 
+                   </void> 
+                   <void property="totalFiles"> 
+                    <int>1</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="operatorId"> 
+                  <string>FS_3</string> 
+                 </void> 
+                 <void property="parentOperators"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                      <void property="destTableId"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="dirName"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="gatherStats"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="lbCtx"> 
-                       <object idref="ListBucketingCtx0"/> 
-                      </void> 
-                      <void property="maxStatsKeyPrefixLength"> 
-                       <int>150</int> 
-                      </void> 
-                      <void property="numFiles"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="statsAggPrefix"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="statsCollectRawDataSize"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="tableInfo"> 
-                       <object idref="TableDesc0"/> 
-                      </void> 
-                      <void property="totalFiles"> 
-                       <int>1</int> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="operatorId"> 
-                     <string>FS_3</string> 
-                    </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="SelectOperator0"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="schema"> 
-                     <object idref="RowSchema0"/> 
-                    </void> 
-                   </object> 
+                   <object idref="SelectOperator0"/> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="columnExprMap"> 
-                 <object class="java.util.HashMap"> 
-                  <void method="put"> 
-                   <string>_col1</string> 
-                   <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>key</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>src1</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void method="put"> 
-                   <string>_col0</string> 
-                   <object id="ExprNodeConstantDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                  <void property="colList"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="ExprNodeConstantDesc0"/> 
-                    </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc0"/> 
-                    </void> 
-                   </object> 
+                 </void> 
+                 <void property="schema"> 
+                  <object idref="RowSchema0"/> 
+                 </void> 
+                </object> 
+               </void> 
+              </void> 
+              <void property="columnExprMap"> 
+               <object class="java.util.HashMap"> 
+                <void method="put"> 
+                 <string>_col1</string> 
+                 <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>key</string> 
                   </void> 
-                  <void property="outputColumnNames"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <string>_col0</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col1</string> 
-                    </void> 
-                   </object> 
+                  <void property="tabAlias"> 
+                   <string>src1</string> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="operatorId"> 
-                 <string>SEL_2</string> 
-                </void> 
-                <void property="parentOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object idref="FilterOperator0"/> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                        <void property="typeName"> 
-                         <string>void</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>void</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>src1</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                <void method="put"> 
+                 <string>_col0</string> 
+                 <object id="ExprNodeConstantDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
                </object> 
               </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-              <void property="predicate"> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                <void property="colList"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeNullDesc"/> 
+                   <object idref="ExprNodeConstantDesc0"/> 
                   </void> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeNullDesc"/> 
+                   <object idref="ExprNodeColumnDesc0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                  <void property="typeName"> 
-                   <string>boolean</string> 
+                <void property="outputColumnNames"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <string>_col0</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col1</string> 
                   </void> 
                  </object> 
                 </void> 
                </object> 
               </void> 
-             </object> 
-            </void> 
-            <void property="operatorId"> 
-             <string>FIL_4</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator1"/> 
+              <void property="operatorId"> 
+               <string>SEL_2</string> 
               </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>key</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src1</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="FilterOperator0"/> 
+               </void> 
+              </void> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
+                    </void> 
+                    <void property="type"> 
+                     <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                      <void property="typeName"> 
+                       <string>void</string> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>void</string> 
+                    </void> 
+                   </object> 
                   </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col1</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string>src1</string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
                   </void> 
                  </object> 
                 </void> 
@@ -867,9 +791,69 @@
               </void> 
              </object> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
+             <void property="predicate"> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeNullDesc"/> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeNullDesc"/> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                 <void property="typeName"> 
+                  <string>boolean</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>FIL_4</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator1"/> 
+            </void> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>key</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src1</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
diff --git a/ql/src/test/results/compiler/plan/input_part1.q.xml b/ql/src/test/results/compiler/plan/input_part1.q.xml
index 61c8c83e8e..95b45d5598 100644
--- a/ql/src/test/results/compiler/plan/input_part1.q.xml
+++ b/ql/src/test/results/compiler/plan/input_part1.q.xml
@@ -174,498 +174,486 @@
        <string>srcpart</string> 
        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                <void property="childOperators"> 
+         <void method="add"> 
+          <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+              <void property="childOperators"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                 <void property="conf"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                   <void property="dirName"> 
+                    #### A masked pattern was here #### 
+                   </void> 
+                   <void property="numFiles"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="statsAggPrefix"> 
+                    #### A masked pattern was here #### 
+                   </void> 
+                   <void property="statsCollectRawDataSize"> 
+                    <boolean>true</boolean> 
+                   </void> 
+                   <void property="tableInfo"> 
+                    <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                     <void property="inputFileFormatClass"> 
+                      <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                     </void> 
+                     <void property="outputFileFormatClass"> 
+                      <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                     </void> 
+                     <void property="properties"> 
+                      <object class="java.util.Properties"> 
+                       <void method="put"> 
+                        <string>hive.serialization.extend.nesting.levels</string> 
+                        <string>true</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns</string> 
+                        <string>_col0,_col1,_col2,_col3</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.lib</string> 
+                        <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.format</string> 
+                        <string>1</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns.types</string> 
+                        <string>string:string:string:string</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>escape.delim</string> 
+                        <string>\</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="totalFiles"> 
+                    <int>1</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="operatorId"> 
+                  <string>FS_3</string> 
+                 </void> 
+                 <void property="parentOperators"> 
+                  <void method="add"> 
+                   <object idref="SelectOperator0"/> 
+                  </void> 
+                 </void> 
+                 <void property="schema"> 
+                  <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                   <void property="signature"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>_col0</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string></string> 
+                       </void> 
+                       <void property="type"> 
+                        <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                         <void property="typeName"> 
+                          <string>string</string> 
+                         </void> 
+                        </object> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>_col1</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string></string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>_col2</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string></string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>_col3</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string></string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+              </void> 
+              <void property="columnExprMap"> 
+               <object class="java.util.HashMap"> 
+                <void method="put"> 
+                 <string>_col3</string> 
+                 <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>ds</string> 
+                  </void> 
+                  <void property="isPartitionColOrVirtualCol"> 
+                   <boolean>true</boolean> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>srcpart</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void method="put"> 
+                 <string>_col2</string> 
+                 <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>hr</string> 
+                  </void> 
+                  <void property="isPartitionColOrVirtualCol"> 
+                   <boolean>true</boolean> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>srcpart</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void method="put"> 
+                 <string>_col1</string> 
+                 <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>value</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>srcpart</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void method="put"> 
+                 <string>_col0</string> 
+                 <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>key</string> 
+                  </void> 
+                  <void property="tabAlias"> 
+                   <string>srcpart</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
+                </void> 
+               </object> 
+              </void> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                <void property="colList"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                      <void property="dirName"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="numFiles"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="statsAggPrefix"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="statsCollectRawDataSize"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="tableInfo"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                        <void property="inputFileFormatClass"> 
-                         <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-                        </void> 
-                        <void property="outputFileFormatClass"> 
-                         <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-                        </void> 
-                        <void property="properties"> 
-                         <object class="java.util.Properties"> 
-                          <void method="put"> 
-                           <string>hive.serialization.extend.nesting.levels</string> 
-                           <string>true</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns</string> 
-                           <string>_col0,_col1,_col2,_col3</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.lib</string> 
-                           <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.format</string> 
-                           <string>1</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns.types</string> 
-                           <string>string:string:string:string</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>escape.delim</string> 
-                           <string>\</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="totalFiles"> 
-                       <int>1</int> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="operatorId"> 
-                     <string>FS_3</string> 
-                    </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="SelectOperator0"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="schema"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                      <void property="signature"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col0</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string></string> 
-                          </void> 
-                          <void property="type"> 
-                           <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                            <void property="typeName"> 
-                             <string>string</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col1</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string></string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col2</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string></string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col3</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string></string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                   <object idref="ExprNodeColumnDesc3"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object idref="ExprNodeColumnDesc2"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object idref="ExprNodeColumnDesc1"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object idref="ExprNodeColumnDesc0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="columnExprMap"> 
-                 <object class="java.util.HashMap"> 
-                  <void method="put"> 
-                   <string>_col3</string> 
-                   <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>ds</string> 
-                    </void> 
-                    <void property="isPartitionColOrVirtualCol"> 
-                     <boolean>true</boolean> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>srcpart</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
+                <void property="outputColumnNames"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <string>_col0</string> 
                   </void> 
-                  <void method="put"> 
+                  <void method="add"> 
+                   <string>_col1</string> 
+                  </void> 
+                  <void method="add"> 
                    <string>_col2</string> 
-                   <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>hr</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col3</string> 
+                  </void> 
+                 </object> 
+                </void> 
+               </object> 
+              </void> 
+              <void property="operatorId"> 
+               <string>SEL_2</string> 
+              </void> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="FilterOperator0"/> 
+               </void> 
+              </void> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="alias"> 
+                     <string>key</string> 
                     </void> 
-                    <void property="isPartitionColOrVirtualCol"> 
-                     <boolean>true</boolean> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
                     </void> 
                     <void property="tabAlias"> 
                      <string>srcpart</string> 
                     </void> 
-                    <void property="typeInfo"> 
+                    <void property="type"> 
                      <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
                    </object> 
                   </void> 
-                  <void method="put"> 
-                   <string>_col1</string> 
-                   <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="alias"> 
                      <string>value</string> 
                     </void> 
-                    <void property="tabAlias"> 
-                     <string>srcpart</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void method="put"> 
-                   <string>_col0</string> 
-                   <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>key</string> 
+                    <void property="internalName"> 
+                     <string>_col1</string> 
                     </void> 
                     <void property="tabAlias"> 
                      <string>srcpart</string> 
                     </void> 
-                    <void property="typeInfo"> 
+                    <void property="type"> 
                      <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                  <void property="colList"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc3"/> 
-                    </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc2"/> 
-                    </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc1"/> 
-                    </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc0"/> 
+                    <void property="typeName"> 
+                     <string>string</string> 
                     </void> 
                    </object> 
                   </void> 
-                  <void property="outputColumnNames"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <string>_col0</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col1</string> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="alias"> 
+                     <string>hr</string> 
                     </void> 
-                    <void method="add"> 
+                    <void property="internalName"> 
                      <string>_col2</string> 
                     </void> 
-                    <void method="add"> 
-                     <string>_col3</string> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="operatorId"> 
-                 <string>SEL_2</string> 
-                </void> 
-                <void property="parentOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object idref="FilterOperator0"/> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="alias"> 
-                       <string>key</string> 
-                      </void> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>srcpart</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="alias"> 
-                       <string>value</string> 
-                      </void> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>srcpart</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
+                    <void property="tabAlias"> 
+                     <string>srcpart</string> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="alias"> 
-                       <string>hr</string> 
-                      </void> 
-                      <void property="internalName"> 
-                       <string>_col2</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>srcpart</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="alias"> 
-                       <string>ds</string> 
-                      </void> 
-                      <void property="internalName"> 
-                       <string>_col3</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>srcpart</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
+                    <void property="typeName"> 
+                     <string>string</string> 
                     </void> 
                    </object> 
                   </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-              <void property="predicate"> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
-                 <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>key</string> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="alias"> 
+                     <string>ds</string> 
+                    </void> 
+                    <void property="internalName"> 
+                     <string>_col3</string> 
                     </void> 
                     <void property="tabAlias"> 
                      <string>srcpart</string> 
                     </void> 
-                    <void property="typeInfo"> 
+                    <void property="type"> 
                      <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                   </object> 
-                  </void> 
-                  <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
-                     <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                      <void property="typeName"> 
-                       <string>int</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="value"> 
-                     <int>100</int> 
+                    <void property="typeName"> 
+                     <string>string</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                  <void property="typeName"> 
-                   <string>boolean</string> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="operatorId"> 
-             <string>FIL_4</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator0"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>key</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>srcpart</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>value</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>srcpart</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object id="ColumnInfo2" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>ds</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>srcpart</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object id="ColumnInfo3" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>hr</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>srcpart</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
                </object> 
               </void> 
              </object> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
+             <void property="predicate"> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                   <void property="column"> 
+                    <string>key</string> 
+                   </void> 
+                   <void property="tabAlias"> 
+                    <string>srcpart</string> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo0"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                     <void property="typeName"> 
+                      <string>int</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="value"> 
+                    <int>100</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                 <void property="typeName"> 
+                  <string>boolean</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>FIL_4</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator0"/> 
+            </void> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>key</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>srcpart</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>value</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>srcpart</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object id="ColumnInfo2" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>ds</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>srcpart</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object id="ColumnInfo3" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>hr</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>srcpart</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
diff --git a/ql/src/test/results/compiler/plan/input_testsequencefile.q.xml b/ql/src/test/results/compiler/plan/input_testsequencefile.q.xml
index 09ebd3f9d1..24470275d9 100644
--- a/ql/src/test/results/compiler/plan/input_testsequencefile.q.xml
+++ b/ql/src/test/results/compiler/plan/input_testsequencefile.q.xml
@@ -79,137 +79,133 @@
                        #### A masked pattern was here #### 
                        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                         <void property="childOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                            <void property="conf"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                              <void property="dirName"> 
-                               #### A masked pattern was here #### 
-                              </void> 
-                              <void property="numFiles"> 
-                               <int>1</int> 
-                              </void> 
-                              <void property="tableInfo"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                                <void property="inputFileFormatClass"> 
-                                 <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                                </void> 
-                                <void property="outputFileFormatClass"> 
-                                 <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                                </void> 
-                                <void property="properties"> 
-                                 <object class="java.util.Properties"> 
-                                  <void method="put"> 
-                                   <string>name</string> 
-                                   <string>default.dest4_sequencefile</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>columns.types</string> 
-                                   <string>string:string</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.ddl</string> 
-                                   <string>struct dest4_sequencefile { string key, string value}</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.format</string> 
-                                   <string>1</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>columns</string> 
-                                   <string>key,value</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>bucket_count</string> 
-                                   <string>-1</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.lib</string> 
-                                   <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>file.inputformat</string> 
-                                   <string>org.apache.hadoop.mapred.SequenceFileInputFormat</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>location</string> 
-                                   #### A masked pattern was here #### 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>file.outputformat</string> 
-                                   <string>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>transient_lastDdlTime</string> 
-                                   #### A masked pattern was here #### 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void property="totalFiles"> 
-                               <int>1</int> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="operatorId"> 
-                             <string>FS_4</string> 
-                            </void> 
-                            <void property="parentOperators"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object idref="TableScanOperator0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="schema"> 
-                             <object id="RowSchema0" class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                              <void property="signature"> 
-                               <object class="java.util.ArrayList"> 
-                                <void method="add"> 
-                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                  <void property="internalName"> 
-                                   <string>key</string> 
-                                  </void> 
-                                  <void property="tabAlias"> 
-                                   <string></string> 
-                                  </void> 
-                                  <void property="type"> 
-                                   <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                                    <void property="typeName"> 
-                                     <string>string</string> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                  <void property="typeName"> 
-                                   <string>string</string> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void method="add"> 
-                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                  <void property="internalName"> 
-                                   <string>value</string> 
-                                  </void> 
-                                  <void property="tabAlias"> 
-                                   <string></string> 
-                                  </void> 
-                                  <void property="type"> 
-                                   <object idref="PrimitiveTypeInfo0"/> 
-                                  </void> 
-                                  <void property="typeName"> 
-                                   <string>string</string> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
+                         <void method="add"> 
+                          <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                           <void property="conf"> 
+                            <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                             <void property="dirName"> 
+                              #### A masked pattern was here #### 
+                             </void> 
+                             <void property="numFiles"> 
+                              <int>1</int> 
+                             </void> 
+                             <void property="tableInfo"> 
+                              <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                               <void property="inputFileFormatClass"> 
+                                <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                               </void> 
+                               <void property="outputFileFormatClass"> 
+                                <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                               </void> 
+                               <void property="properties"> 
+                                <object class="java.util.Properties"> 
+                                 <void method="put"> 
+                                  <string>name</string> 
+                                  <string>default.dest4_sequencefile</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>columns.types</string> 
+                                  <string>string:string</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.ddl</string> 
+                                  <string>struct dest4_sequencefile { string key, string value}</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.format</string> 
+                                  <string>1</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>columns</string> 
+                                  <string>key,value</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>bucket_count</string> 
+                                  <string>-1</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.lib</string> 
+                                  <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>file.inputformat</string> 
+                                  <string>org.apache.hadoop.mapred.SequenceFileInputFormat</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>location</string> 
+                                  #### A masked pattern was here #### 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>file.outputformat</string> 
+                                  <string>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>transient_lastDdlTime</string> 
+                                  #### A masked pattern was here #### 
+                                 </void> 
+                                </object> 
+                               </void> 
+                              </object> 
+                             </void> 
+                             <void property="totalFiles"> 
+                              <int>1</int> 
+                             </void> 
+                            </object> 
+                           </void> 
+                           <void property="operatorId"> 
+                            <string>FS_4</string> 
+                           </void> 
+                           <void property="parentOperators"> 
+                            <void method="add"> 
+                             <object idref="TableScanOperator0"/> 
                             </void> 
-                           </object> 
-                          </void> 
-                         </object> 
+                           </void> 
+                           <void property="schema"> 
+                            <object id="RowSchema0" class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                             <void property="signature"> 
+                              <object class="java.util.ArrayList"> 
+                               <void method="add"> 
+                                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                 <void property="internalName"> 
+                                  <string>key</string> 
+                                 </void> 
+                                 <void property="tabAlias"> 
+                                  <string></string> 
+                                 </void> 
+                                 <void property="type"> 
+                                  <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                                   <void property="typeName"> 
+                                    <string>string</string> 
+                                   </void> 
+                                  </object> 
+                                 </void> 
+                                 <void property="typeName"> 
+                                  <string>string</string> 
+                                 </void> 
+                                </object> 
+                               </void> 
+                               <void method="add"> 
+                                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                 <void property="internalName"> 
+                                  <string>value</string> 
+                                 </void> 
+                                 <void property="tabAlias"> 
+                                  <string></string> 
+                                 </void> 
+                                 <void property="type"> 
+                                  <object idref="PrimitiveTypeInfo0"/> 
+                                 </void> 
+                                 <void property="typeName"> 
+                                  <string>string</string> 
+                                 </void> 
+                                </object> 
+                               </void> 
+                              </object> 
+                             </void> 
+                            </object> 
+                           </void> 
+                          </object> 
+                         </void> 
                         </void> 
                         <void property="conf"> 
                          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"/> 
@@ -638,173 +634,165 @@
        <string>src</string> 
        <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                  <void property="destTableId"> 
-                   <int>1</int> 
-                  </void> 
-                  <void property="dirName"> 
-                   #### A masked pattern was here #### 
-                  </void> 
-                  <void property="gatherStats"> 
-                   <boolean>true</boolean> 
-                  </void> 
-                  <void property="lbCtx"> 
-                   <object idref="ListBucketingCtx0"/> 
-                  </void> 
-                  <void property="maxStatsKeyPrefixLength"> 
-                   <int>150</int> 
-                  </void> 
-                  <void property="numFiles"> 
-                   <int>1</int> 
-                  </void> 
-                  <void property="statsAggPrefix"> 
-                   #### A masked pattern was here #### 
-                  </void> 
-                  <void property="statsCollectRawDataSize"> 
-                   <boolean>true</boolean> 
-                  </void> 
-                  <void property="tableInfo"> 
-                   <object idref="TableDesc0"/> 
-                  </void> 
-                  <void property="totalFiles"> 
-                   <int>1</int> 
-                  </void> 
-                 </object> 
+         <void method="add"> 
+          <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                <void property="destTableId"> 
+                 <int>1</int> 
                 </void> 
-                <void property="operatorId"> 
-                 <string>FS_2</string> 
+                <void property="dirName"> 
+                 #### A masked pattern was here #### 
                 </void> 
-                <void property="parentOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object idref="SelectOperator0"/> 
-                  </void> 
-                 </object> 
+                <void property="gatherStats"> 
+                 <boolean>true</boolean> 
                 </void> 
-                <void property="schema"> 
-                 <object idref="RowSchema0"/> 
+                <void property="lbCtx"> 
+                 <object idref="ListBucketingCtx0"/> 
                 </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="columnExprMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>_col1</string> 
-               <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>value</string> 
+                <void property="maxStatsKeyPrefixLength"> 
+                 <int>150</int> 
                 </void> 
-                <void property="tabAlias"> 
-                 <string>src</string> 
+                <void property="numFiles"> 
+                 <int>1</int> 
                 </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
+                <void property="statsAggPrefix"> 
+                 #### A masked pattern was here #### 
                 </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>_col0</string> 
-               <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>key</string> 
+                <void property="statsCollectRawDataSize"> 
+                 <boolean>true</boolean> 
                 </void> 
-                <void property="tabAlias"> 
-                 <string>src</string> 
+                <void property="tableInfo"> 
+                 <object idref="TableDesc0"/> 
                 </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
+                <void property="totalFiles"> 
+                 <int>1</int> 
                 </void> 
                </object> 
               </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-              <void property="colList"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object idref="ExprNodeColumnDesc1"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeColumnDesc0"/> 
-                </void> 
-               </object> 
+              <void property="operatorId"> 
+               <string>FS_2</string> 
               </void> 
-              <void property="outputColumnNames"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <string>_col0</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col1</string> 
-                </void> 
-               </object> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="SelectOperator0"/> 
+               </void> 
               </void> 
-             </object> 
-            </void> 
-            <void property="operatorId"> 
-             <string>SEL_1</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator1"/> 
+              <void property="schema"> 
+               <object idref="RowSchema0"/> 
               </void> 
              </object> 
             </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>_col0</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>_col1</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
+           </void> 
+           <void property="columnExprMap"> 
+            <object class="java.util.HashMap"> 
+             <void method="put"> 
+              <string>_col1</string> 
+              <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>value</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>src</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col0</string> 
+              <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>key</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>src</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+             <void property="colList"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object idref="ExprNodeColumnDesc1"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeColumnDesc0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="outputColumnNames"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <string>_col0</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col1</string> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>SEL_1</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator1"/> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>_col0</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>_col1</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
diff --git a/ql/src/test/results/compiler/plan/input_testxpath.q.xml b/ql/src/test/results/compiler/plan/input_testxpath.q.xml
index ab0e183c86..f97554bf18 100644
--- a/ql/src/test/results/compiler/plan/input_testxpath.q.xml
+++ b/ql/src/test/results/compiler/plan/input_testxpath.q.xml
@@ -161,420 +161,412 @@
        <string>src_thrift</string> 
        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                  <void property="dirName"> 
-                   #### A masked pattern was here #### 
-                  </void> 
-                  <void property="numFiles"> 
-                   <int>1</int> 
-                  </void> 
-                  <void property="statsAggPrefix"> 
-                   #### A masked pattern was here #### 
+         <void method="add"> 
+          <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                <void property="dirName"> 
+                 #### A masked pattern was here #### 
+                </void> 
+                <void property="numFiles"> 
+                 <int>1</int> 
+                </void> 
+                <void property="statsAggPrefix"> 
+                 #### A masked pattern was here #### 
+                </void> 
+                <void property="statsCollectRawDataSize"> 
+                 <boolean>true</boolean> 
+                </void> 
+                <void property="tableInfo"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                  <void property="inputFileFormatClass"> 
+                   <class>org.apache.hadoop.mapred.TextInputFormat</class> 
                   </void> 
-                  <void property="statsCollectRawDataSize"> 
-                   <boolean>true</boolean> 
+                  <void property="outputFileFormatClass"> 
+                   <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
                   </void> 
-                  <void property="tableInfo"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                    <void property="inputFileFormatClass"> 
-                     <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                  <void property="properties"> 
+                   <object class="java.util.Properties"> 
+                    <void method="put"> 
+                     <string>hive.serialization.extend.nesting.levels</string> 
+                     <string>true</string> 
                     </void> 
-                    <void property="outputFileFormatClass"> 
-                     <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                    <void method="put"> 
+                     <string>columns</string> 
+                     <string>_col0,_col1,_col2</string> 
                     </void> 
-                    <void property="properties"> 
-                     <object class="java.util.Properties"> 
-                      <void method="put"> 
-                       <string>hive.serialization.extend.nesting.levels</string> 
-                       <string>true</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>columns</string> 
-                       <string>_col0,_col1,_col2</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.lib</string> 
-                       <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.format</string> 
-                       <string>1</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>columns.types</string> 
-                       <string>int:string:string</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>escape.delim</string> 
-                       <string>\</string> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>serialization.lib</string> 
+                     <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
                     </void> 
-                   </object> 
-                  </void> 
-                  <void property="totalFiles"> 
-                   <int>1</int> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="operatorId"> 
-                 <string>FS_2</string> 
-                </void> 
-                <void property="parentOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object idref="SelectOperator0"/> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                        <void property="typeName"> 
-                         <string>int</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>int</string> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>serialization.format</string> 
+                     <string>1</string> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                        <void property="typeName"> 
-                         <string>string</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>columns.types</string> 
+                     <string>int:string:string</string> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col2</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo1"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>escape.delim</string> 
+                     <string>\</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
+                <void property="totalFiles"> 
+                 <int>1</int> 
+                </void> 
                </object> 
               </void> 
-             </object> 
-            </void> 
-            <void property="columnExprMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>_col2</string> 
-               <object id="ExprNodeGenericFuncDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
+              <void property="operatorId"> 
+               <string>FS_2</string> 
+              </void> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="SelectOperator0"/> 
+               </void> 
+              </void> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>mstringstring</string> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
                     </void> 
                     <void property="tabAlias"> 
-                     <string>src_thrift</string> 
+                     <string></string> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object id="MapTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.MapTypeInfo"> 
-                      <void property="mapKeyTypeInfo"> 
-                       <object idref="PrimitiveTypeInfo1"/> 
-                      </void> 
-                      <void property="mapValueTypeInfo"> 
-                       <object idref="PrimitiveTypeInfo1"/> 
+                    <void property="type"> 
+                     <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                      <void property="typeName"> 
+                       <string>int</string> 
                       </void> 
                      </object> 
                     </void> 
+                    <void property="typeName"> 
+                     <string>int</string> 
+                    </void> 
                    </object> 
                   </void> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col1</string> 
                     </void> 
-                    <void property="value"> 
-                     <string>key_2</string> 
+                    <void property="tabAlias"> 
+                     <string></string> 
                     </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFIndex"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo1"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>_col1</string> 
-               <object id="ExprNodeFieldDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeFieldDesc"> 
-                <void property="desc"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                  <void property="children"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                      <void property="column"> 
-                       <string>lintstring</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>src_thrift</string> 
-                      </void> 
-                      <void property="typeInfo"> 
-                       <object id="ListTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.ListTypeInfo"> 
-                        <void property="listElementTypeInfo"> 
-                         <object id="StructTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.StructTypeInfo"> 
-                          <void property="allStructFieldNames"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <string>myint</string> 
-                            </void> 
-                            <void method="add"> 
-                             <string>mystring</string> 
-                            </void> 
-                            <void method="add"> 
-                             <string>underscore_int</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="allStructFieldTypeInfos"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                            <void method="add"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void method="add"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
+                    <void property="type"> 
+                     <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                      <void property="typeName"> 
+                       <string>string</string> 
                       </void> 
                      </object> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                      <void property="typeInfo"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="value"> 
-                       <int>0</int> 
-                      </void> 
-                     </object> 
+                    <void property="typeName"> 
+                     <string>string</string> 
                     </void> 
                    </object> 
                   </void> 
-                  <void property="genericUDF"> 
-                   <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFIndex"/> 
-                  </void> 
-                  <void property="typeInfo"> 
-                   <object idref="StructTypeInfo0"/> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="fieldName"> 
-                 <string>mystring</string> 
-                </void> 
-                <void property="isList"> 
-                 <boolean>false</boolean> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo1"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>_col0</string> 
-               <object id="ExprNodeGenericFuncDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
-                 <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>lint</string> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col2</string> 
                     </void> 
                     <void property="tabAlias"> 
-                     <string>src_thrift</string> 
+                     <string></string> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object id="ListTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.ListTypeInfo"> 
-                      <void property="listElementTypeInfo"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo1"/> 
                     </void> 
-                    <void property="value"> 
-                     <int>1</int> 
+                    <void property="typeName"> 
+                     <string>string</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFIndex"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-              <void property="colList"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object idref="ExprNodeGenericFuncDesc1"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeFieldDesc0"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeGenericFuncDesc0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void property="outputColumnNames"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <string>_col0</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col1</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col2</string> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="operatorId"> 
-             <string>SEL_1</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator0"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>_c0</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col0</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>int</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>mystring</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col1</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo1"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>_c2</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col2</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo1"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
                </object> 
               </void> 
              </object> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="columnExprMap"> 
+            <object class="java.util.HashMap"> 
+             <void method="put"> 
+              <string>_col2</string> 
+              <object id="ExprNodeGenericFuncDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                   <void property="column"> 
+                    <string>mstringstring</string> 
+                   </void> 
+                   <void property="tabAlias"> 
+                    <string>src_thrift</string> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object id="MapTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.MapTypeInfo"> 
+                     <void property="mapKeyTypeInfo"> 
+                      <object idref="PrimitiveTypeInfo1"/> 
+                     </void> 
+                     <void property="mapValueTypeInfo"> 
+                      <object idref="PrimitiveTypeInfo1"/> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo1"/> 
+                   </void> 
+                   <void property="value"> 
+                    <string>key_2</string> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFIndex"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo1"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col1</string> 
+              <object id="ExprNodeFieldDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeFieldDesc"> 
+               <void property="desc"> 
+                <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                 <void property="children"> 
+                  <object class="java.util.ArrayList"> 
+                   <void method="add"> 
+                    <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                     <void property="column"> 
+                      <string>lintstring</string> 
+                     </void> 
+                     <void property="tabAlias"> 
+                      <string>src_thrift</string> 
+                     </void> 
+                     <void property="typeInfo"> 
+                      <object id="ListTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.ListTypeInfo"> 
+                       <void property="listElementTypeInfo"> 
+                        <object id="StructTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.StructTypeInfo"> 
+                         <void property="allStructFieldNames"> 
+                          <object class="java.util.ArrayList"> 
+                           <void method="add"> 
+                            <string>myint</string> 
+                           </void> 
+                           <void method="add"> 
+                            <string>mystring</string> 
+                           </void> 
+                           <void method="add"> 
+                            <string>underscore_int</string> 
+                           </void> 
+                          </object> 
+                         </void> 
+                         <void property="allStructFieldTypeInfos"> 
+                          <object class="java.util.ArrayList"> 
+                           <void method="add"> 
+                            <object idref="PrimitiveTypeInfo0"/> 
+                           </void> 
+                           <void method="add"> 
+                            <object idref="PrimitiveTypeInfo1"/> 
+                           </void> 
+                           <void method="add"> 
+                            <object idref="PrimitiveTypeInfo0"/> 
+                           </void> 
+                          </object> 
+                         </void> 
+                        </object> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void method="add"> 
+                    <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                     <void property="typeInfo"> 
+                      <object idref="PrimitiveTypeInfo0"/> 
+                     </void> 
+                     <void property="value"> 
+                      <int>0</int> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="genericUDF"> 
+                  <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFIndex"/> 
+                 </void> 
+                 <void property="typeInfo"> 
+                  <object idref="StructTypeInfo0"/> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="fieldName"> 
+                <string>mystring</string> 
+               </void> 
+               <void property="isList"> 
+                <boolean>false</boolean> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo1"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col0</string> 
+              <object id="ExprNodeGenericFuncDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                   <void property="column"> 
+                    <string>lint</string> 
+                   </void> 
+                   <void property="tabAlias"> 
+                    <string>src_thrift</string> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object id="ListTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.ListTypeInfo"> 
+                     <void property="listElementTypeInfo"> 
+                      <object idref="PrimitiveTypeInfo0"/> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo0"/> 
+                   </void> 
+                   <void property="value"> 
+                    <int>1</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFIndex"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+             <void property="colList"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object idref="ExprNodeGenericFuncDesc1"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeFieldDesc0"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeGenericFuncDesc0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="outputColumnNames"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <string>_col0</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col1</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col2</string> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>SEL_1</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator0"/> 
+            </void> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>_c0</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col0</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>int</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>mystring</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col1</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo1"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>_c2</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col2</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo1"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
diff --git a/ql/src/test/results/compiler/plan/input_testxpath2.q.xml b/ql/src/test/results/compiler/plan/input_testxpath2.q.xml
index c2a8100e6a..1173b55f35 100644
--- a/ql/src/test/results/compiler/plan/input_testxpath2.q.xml
+++ b/ql/src/test/results/compiler/plan/input_testxpath2.q.xml
@@ -161,139 +161,168 @@
        <string>src_thrift</string> 
        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                <void property="childOperators"> 
-                 <object class="java.util.ArrayList"> 
+         <void method="add"> 
+          <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+              <void property="childOperators"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                 <void property="conf"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                   <void property="dirName"> 
+                    #### A masked pattern was here #### 
+                   </void> 
+                   <void property="numFiles"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="statsAggPrefix"> 
+                    #### A masked pattern was here #### 
+                   </void> 
+                   <void property="statsCollectRawDataSize"> 
+                    <boolean>true</boolean> 
+                   </void> 
+                   <void property="tableInfo"> 
+                    <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                     <void property="inputFileFormatClass"> 
+                      <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                     </void> 
+                     <void property="outputFileFormatClass"> 
+                      <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                     </void> 
+                     <void property="properties"> 
+                      <object class="java.util.Properties"> 
+                       <void method="put"> 
+                        <string>hive.serialization.extend.nesting.levels</string> 
+                        <string>true</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns</string> 
+                        <string>_col0,_col1,_col2</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.lib</string> 
+                        <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.format</string> 
+                        <string>1</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns.types</string> 
+                        <string>int:int:int</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>escape.delim</string> 
+                        <string>\</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="totalFiles"> 
+                    <int>1</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="operatorId"> 
+                  <string>FS_3</string> 
+                 </void> 
+                 <void property="parentOperators"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                      <void property="dirName"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="numFiles"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="statsAggPrefix"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="statsCollectRawDataSize"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="tableInfo"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                        <void property="inputFileFormatClass"> 
-                         <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-                        </void> 
-                        <void property="outputFileFormatClass"> 
-                         <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-                        </void> 
-                        <void property="properties"> 
-                         <object class="java.util.Properties"> 
-                          <void method="put"> 
-                           <string>hive.serialization.extend.nesting.levels</string> 
-                           <string>true</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns</string> 
-                           <string>_col0,_col1,_col2</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.lib</string> 
-                           <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.format</string> 
-                           <string>1</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns.types</string> 
-                           <string>int:int:int</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>escape.delim</string> 
-                           <string>\</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="totalFiles"> 
-                       <int>1</int> 
+                   <object idref="SelectOperator0"/> 
+                  </void> 
+                 </void> 
+                 <void property="schema"> 
+                  <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                   <void property="signature"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>_col0</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string></string> 
+                       </void> 
+                       <void property="type"> 
+                        <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                         <void property="typeName"> 
+                          <string>int</string> 
+                         </void> 
+                        </object> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>int</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>_col1</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string></string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>int</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>_col2</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string></string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>int</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+              </void> 
+              <void property="columnExprMap"> 
+               <object class="java.util.HashMap"> 
+                <void method="put"> 
+                 <string>_col2</string> 
+                 <object id="ExprNodeGenericFuncDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                  <void property="children"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                      <void property="column"> 
+                       <string>mstringstring</string> 
                       </void> 
-                     </object> 
-                    </void> 
-                    <void property="operatorId"> 
-                     <string>FS_3</string> 
-                    </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="SelectOperator0"/> 
+                      <void property="tabAlias"> 
+                       <string>src_thrift</string> 
                       </void> 
-                     </object> 
-                    </void> 
-                    <void property="schema"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                      <void property="signature"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col0</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string></string> 
-                          </void> 
-                          <void property="type"> 
-                           <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                            <void property="typeName"> 
-                             <string>int</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>int</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col1</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string></string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
+                      <void property="typeInfo"> 
+                       <object id="MapTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.MapTypeInfo"> 
+                        <void property="mapKeyTypeInfo"> 
+                         <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
                           <void property="typeName"> 
-                           <string>int</string> 
+                           <string>string</string> 
                           </void> 
                          </object> 
                         </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col2</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string></string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>int</string> 
-                          </void> 
-                         </object> 
+                        <void property="mapValueTypeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
                        </object> 
                       </void> 
@@ -301,91 +330,54 @@
                     </void> 
                    </object> 
                   </void> 
+                  <void property="genericUDF"> 
+                   <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFSize"/> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
                  </object> 
                 </void> 
-                <void property="columnExprMap"> 
-                 <object class="java.util.HashMap"> 
-                  <void method="put"> 
-                   <string>_col2</string> 
-                   <object id="ExprNodeGenericFuncDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>mstringstring</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src_thrift</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object id="MapTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.MapTypeInfo"> 
-                          <void property="mapKeyTypeInfo"> 
-                           <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                            <void property="typeName"> 
-                             <string>string</string> 
+                <void method="put"> 
+                 <string>_col1</string> 
+                 <object id="ExprNodeGenericFuncDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                  <void property="children"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                      <void property="column"> 
+                       <string>lintstring</string> 
+                      </void> 
+                      <void property="tabAlias"> 
+                       <string>src_thrift</string> 
+                      </void> 
+                      <void property="typeInfo"> 
+                       <object id="ListTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.ListTypeInfo"> 
+                        <void property="listElementTypeInfo"> 
+                         <object class="org.apache.hadoop.hive.serde2.typeinfo.StructTypeInfo"> 
+                          <void property="allStructFieldNames"> 
+                           <object class="java.util.ArrayList"> 
+                            <void method="add"> 
+                             <string>myint</string> 
+                            </void> 
+                            <void method="add"> 
+                             <string>mystring</string> 
+                            </void> 
+                            <void method="add"> 
+                             <string>underscore_int</string> 
                             </void> 
                            </object> 
                           </void> 
-                          <void property="mapValueTypeInfo"> 
-                           <object idref="PrimitiveTypeInfo1"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFSize"/> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void method="put"> 
-                   <string>_col1</string> 
-                   <object id="ExprNodeGenericFuncDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>lintstring</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src_thrift</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object id="ListTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.ListTypeInfo"> 
-                          <void property="listElementTypeInfo"> 
-                           <object class="org.apache.hadoop.hive.serde2.typeinfo.StructTypeInfo"> 
-                            <void property="allStructFieldNames"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <string>myint</string> 
-                              </void> 
-                              <void method="add"> 
-                               <string>mystring</string> 
-                              </void> 
-                              <void method="add"> 
-                               <string>underscore_int</string> 
-                              </void> 
-                             </object> 
+                          <void property="allStructFieldTypeInfos"> 
+                           <object class="java.util.ArrayList"> 
+                            <void method="add"> 
+                             <object idref="PrimitiveTypeInfo0"/> 
+                            </void> 
+                            <void method="add"> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
-                            <void property="allStructFieldTypeInfos"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                              <void method="add"> 
-                               <object idref="PrimitiveTypeInfo1"/> 
-                              </void> 
-                              <void method="add"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
+                            <void method="add"> 
+                             <object idref="PrimitiveTypeInfo0"/> 
                             </void> 
                            </object> 
                           </void> 
@@ -395,307 +387,303 @@
                       </void> 
                      </object> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFSize"/> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
                    </object> 
                   </void> 
-                  <void method="put"> 
-                   <string>_col0</string> 
-                   <object id="ExprNodeGenericFuncDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>lint</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src_thrift</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object id="ListTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.ListTypeInfo"> 
-                          <void property="listElementTypeInfo"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                         </object> 
+                  <void property="genericUDF"> 
+                   <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFSize"/> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void method="put"> 
+                 <string>_col0</string> 
+                 <object id="ExprNodeGenericFuncDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                  <void property="children"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                      <void property="column"> 
+                       <string>lint</string> 
+                      </void> 
+                      <void property="tabAlias"> 
+                       <string>src_thrift</string> 
+                      </void> 
+                      <void property="typeInfo"> 
+                       <object id="ListTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.ListTypeInfo"> 
+                        <void property="listElementTypeInfo"> 
+                         <object idref="PrimitiveTypeInfo0"/> 
                         </void> 
                        </object> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFSize"/> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
                    </object> 
                   </void> 
+                  <void property="genericUDF"> 
+                   <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFSize"/> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                  <void property="colList"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="ExprNodeGenericFuncDesc2"/> 
-                    </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeGenericFuncDesc1"/> 
-                    </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeGenericFuncDesc0"/> 
-                    </void> 
-                   </object> 
+               </object> 
+              </void> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                <void property="colList"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object idref="ExprNodeGenericFuncDesc2"/> 
                   </void> 
-                  <void property="outputColumnNames"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <string>_col0</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col1</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col2</string> 
-                    </void> 
-                   </object> 
+                  <void method="add"> 
+                   <object idref="ExprNodeGenericFuncDesc1"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object idref="ExprNodeGenericFuncDesc0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="operatorId"> 
-                 <string>SEL_2</string> 
-                </void> 
-                <void property="parentOperators"> 
+                <void property="outputColumnNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object idref="FilterOperator0"/> 
+                   <string>_col0</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col1</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col2</string> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="alias"> 
-                       <string>_c0</string> 
-                      </void> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>int</string> 
-                      </void> 
-                     </object> 
+               </object> 
+              </void> 
+              <void property="operatorId"> 
+               <string>SEL_2</string> 
+              </void> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="FilterOperator0"/> 
+               </void> 
+              </void> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="alias"> 
+                     <string>_c0</string> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="alias"> 
-                       <string>_c1</string> 
-                      </void> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>int</string> 
-                      </void> 
-                     </object> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="alias"> 
-                       <string>_c2</string> 
-                      </void> 
-                      <void property="internalName"> 
-                       <string>_col2</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>int</string> 
-                      </void> 
-                     </object> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>int</string> 
                     </void> 
                    </object> 
                   </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-              <void property="predicate"> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
-                 <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>lint</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src_thrift</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="ListTypeInfo1"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="alias"> 
+                     <string>_c1</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPNotNull"/> 
+                    <void property="internalName"> 
+                     <string>_col1</string> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                      <void property="typeName"> 
-                       <string>boolean</string> 
-                      </void> 
-                     </object> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>int</string> 
                     </void> 
                    </object> 
                   </void> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="children"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>mstringstring</string> 
-                            </void> 
-                            <void property="tabAlias"> 
-                             <string>src_thrift</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="MapTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPNull"/> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo2"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="alias"> 
+                     <string>_c2</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPNot"/> 
+                    <void property="internalName"> 
+                     <string>_col2</string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                    <void property="typeName"> 
+                     <string>int</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo2"/> 
-                </void> 
                </object> 
               </void> 
              </object> 
             </void> 
-            <void property="operatorId"> 
-             <string>FIL_4</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator0"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>lint</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src_thrift</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="ListTypeInfo1"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>array&lt;int&gt;</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>lintstring</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src_thrift</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="ListTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>array&lt;struct&lt;myint:int,mystring:string,underscore_int:int&gt;&gt;</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object id="ColumnInfo2" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>mstringstring</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src_thrift</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="MapTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>map&lt;string,string&gt;</string> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
+             <void property="predicate"> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                   <void property="children"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <void property="column"> 
+                        <string>lint</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string>src_thrift</string> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="ListTypeInfo1"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="genericUDF"> 
+                    <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPNotNull"/> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                     <void property="typeName"> 
+                      <string>boolean</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                   <void property="children"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                       <void property="children"> 
+                        <object class="java.util.ArrayList"> 
+                         <void method="add"> 
+                          <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                           <void property="column"> 
+                            <string>mstringstring</string> 
+                           </void> 
+                           <void property="tabAlias"> 
+                            <string>src_thrift</string> 
+                           </void> 
+                           <void property="typeInfo"> 
+                            <object idref="MapTypeInfo0"/> 
+                           </void> 
+                          </object> 
+                         </void> 
+                        </object> 
+                       </void> 
+                       <void property="genericUDF"> 
+                        <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPNull"/> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo2"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="genericUDF"> 
+                    <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPNot"/> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo2"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo2"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>FIL_4</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator0"/> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>lint</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src_thrift</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="ListTypeInfo1"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>array&lt;int&gt;</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>lintstring</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src_thrift</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="ListTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>array&lt;struct&lt;myint:int,mystring:string,underscore_int:int&gt;&gt;</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object id="ColumnInfo2" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>mstringstring</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src_thrift</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="MapTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>map&lt;string,string&gt;</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
diff --git a/ql/src/test/results/compiler/plan/join1.q.xml b/ql/src/test/results/compiler/plan/join1.q.xml
index a7a7e0108c..43eeb70217 100644
--- a/ql/src/test/results/compiler/plan/join1.q.xml
+++ b/ql/src/test/results/compiler/plan/join1.q.xml
@@ -433,218 +433,214 @@
        <string>src2</string> 
        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="ReduceSinkOperator0" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
-            <void property="columnExprMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>VALUE._col1</string> 
-               <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>value</string> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string>src2</string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>VALUE._col0</string> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>key</string> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string>src2</string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
-              <void property="distinctColumnIndices"> 
-               <object class="java.util.ArrayList"/> 
-              </void> 
-              <void property="keyCols"> 
-               <object id="ArrayList0" class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                  <void property="column"> 
-                   <string>key</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src2</string> 
-                  </void> 
-                  <void property="typeInfo"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-              <void property="keySerializeInfo"> 
-               <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                <void property="inputFileFormatClass"> 
-                 <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                </void> 
-                <void property="outputFileFormatClass"> 
-                 <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                </void> 
-                <void property="properties"> 
-                 <object class="java.util.Properties"> 
-                  <void method="put"> 
-                   <string>columns</string> 
-                   <string>joinkey0</string> 
-                  </void> 
-                  <void method="put"> 
-                   <string>serialization.lib</string> 
-                   <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
-                  </void> 
-                  <void method="put"> 
-                   <string>serialization.sort.order</string> 
-                   <string>+</string> 
-                  </void> 
-                  <void method="put"> 
-                   <string>columns.types</string> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-              <void property="numDistributionKeys"> 
-               <int>1</int> 
-              </void> 
-              <void property="numReducers"> 
-               <int>-1</int> 
-              </void> 
-              <void property="outputKeyColumnNames"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <string>reducesinkkey0</string> 
-                </void> 
-               </object> 
-              </void> 
-              <void property="outputValueColumnNames"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <string>_col1</string> 
-                </void> 
-               </object> 
-              </void> 
-              <void property="partitionCols"> 
-               <object idref="ArrayList0"/> 
-              </void> 
-              <void property="tag"> 
-               <int>1</int> 
-              </void> 
-              <void property="valueCols"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object idref="ExprNodeColumnDesc0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void property="valueSerializeInfo"> 
-               <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                <void property="inputFileFormatClass"> 
-                 <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                </void> 
-                <void property="outputFileFormatClass"> 
-                 <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                </void> 
-                <void property="properties"> 
-                 <object class="java.util.Properties"> 
-                  <void method="put"> 
-                   <string>columns</string> 
-                   <string>_col1</string> 
-                  </void> 
-                  <void method="put"> 
-                   <string>serialization.lib</string> 
-                   <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
-                  </void> 
-                  <void method="put"> 
-                   <string>columns.types</string> 
-                   <string>string</string> 
-                  </void> 
-                  <void method="put"> 
-                   <string>escape.delim</string> 
-                   <string>\</string> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="inputAlias"> 
-             <string>src2</string> 
-            </void> 
-            <void property="operatorId"> 
-             <string>RS_3</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator0"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>VALUE._col0</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src2</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>VALUE._col1</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src2</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <void method="add"> 
+          <object id="ReduceSinkOperator0" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
+           <void property="columnExprMap"> 
+            <object class="java.util.HashMap"> 
+             <void method="put"> 
+              <string>VALUE._col1</string> 
+              <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>value</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>src2</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>VALUE._col0</string> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>key</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>src2</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
+             <void property="distinctColumnIndices"> 
+              <object class="java.util.ArrayList"/> 
+             </void> 
+             <void property="keyCols"> 
+              <object id="ArrayList0" class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                 <void property="column"> 
+                  <string>key</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src2</string> 
+                 </void> 
+                 <void property="typeInfo"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="keySerializeInfo"> 
+              <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+               <void property="inputFileFormatClass"> 
+                <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+               </void> 
+               <void property="outputFileFormatClass"> 
+                <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+               </void> 
+               <void property="properties"> 
+                <object class="java.util.Properties"> 
+                 <void method="put"> 
+                  <string>columns</string> 
+                  <string>joinkey0</string> 
+                 </void> 
+                 <void method="put"> 
+                  <string>serialization.lib</string> 
+                  <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
+                 </void> 
+                 <void method="put"> 
+                  <string>serialization.sort.order</string> 
+                  <string>+</string> 
+                 </void> 
+                 <void method="put"> 
+                  <string>columns.types</string> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="numDistributionKeys"> 
+              <int>1</int> 
+             </void> 
+             <void property="numReducers"> 
+              <int>-1</int> 
+             </void> 
+             <void property="outputKeyColumnNames"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <string>reducesinkkey0</string> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="outputValueColumnNames"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <string>_col1</string> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="partitionCols"> 
+              <object idref="ArrayList0"/> 
+             </void> 
+             <void property="tag"> 
+              <int>1</int> 
+             </void> 
+             <void property="valueCols"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object idref="ExprNodeColumnDesc0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="valueSerializeInfo"> 
+              <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+               <void property="inputFileFormatClass"> 
+                <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+               </void> 
+               <void property="outputFileFormatClass"> 
+                <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+               </void> 
+               <void property="properties"> 
+                <object class="java.util.Properties"> 
+                 <void method="put"> 
+                  <string>columns</string> 
+                  <string>_col1</string> 
+                 </void> 
+                 <void method="put"> 
+                  <string>serialization.lib</string> 
+                  <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
+                 </void> 
+                 <void method="put"> 
+                  <string>columns.types</string> 
+                  <string>string</string> 
+                 </void> 
+                 <void method="put"> 
+                  <string>escape.delim</string> 
+                  <string>\</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="inputAlias"> 
+            <string>src2</string> 
+           </void> 
+           <void property="operatorId"> 
+            <string>RS_3</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator0"/> 
+            </void> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>VALUE._col0</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src2</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>VALUE._col1</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src2</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
@@ -767,181 +763,177 @@
        <string>src1</string> 
        <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="ReduceSinkOperator1" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
-            <void property="columnExprMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>VALUE._col0</string> 
-               <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>key</string> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string>src1</string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
-              <void property="distinctColumnIndices"> 
-               <object class="java.util.ArrayList"/> 
-              </void> 
-              <void property="keyCols"> 
-               <object id="ArrayList1" class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                  <void property="column"> 
-                   <string>key</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src1</string> 
-                  </void> 
-                  <void property="typeInfo"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-              <void property="keySerializeInfo"> 
-               <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                <void property="inputFileFormatClass"> 
-                 <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                </void> 
-                <void property="outputFileFormatClass"> 
-                 <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                </void> 
-                <void property="properties"> 
-                 <object class="java.util.Properties"> 
-                  <void method="put"> 
-                   <string>columns</string> 
-                   <string>joinkey0</string> 
-                  </void> 
-                  <void method="put"> 
-                   <string>serialization.lib</string> 
-                   <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
-                  </void> 
-                  <void method="put"> 
-                   <string>serialization.sort.order</string> 
-                   <string>+</string> 
-                  </void> 
-                  <void method="put"> 
-                   <string>columns.types</string> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-              <void property="numDistributionKeys"> 
-               <int>1</int> 
-              </void> 
-              <void property="numReducers"> 
-               <int>-1</int> 
-              </void> 
-              <void property="outputKeyColumnNames"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <string>reducesinkkey0</string> 
-                </void> 
-               </object> 
-              </void> 
-              <void property="outputValueColumnNames"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <string>_col0</string> 
-                </void> 
-               </object> 
-              </void> 
-              <void property="partitionCols"> 
-               <object idref="ArrayList1"/> 
-              </void> 
-              <void property="valueCols"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object idref="ExprNodeColumnDesc1"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void property="valueSerializeInfo"> 
-               <object id="TableDesc3" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                <void property="inputFileFormatClass"> 
-                 <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                </void> 
-                <void property="outputFileFormatClass"> 
-                 <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                </void> 
-                <void property="properties"> 
-                 <object class="java.util.Properties"> 
-                  <void method="put"> 
-                   <string>columns</string> 
-                   <string>_col0</string> 
-                  </void> 
-                  <void method="put"> 
-                   <string>serialization.lib</string> 
-                   <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
-                  </void> 
-                  <void method="put"> 
-                   <string>columns.types</string> 
-                   <string>string</string> 
-                  </void> 
-                  <void method="put"> 
-                   <string>escape.delim</string> 
-                   <string>\</string> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="inputAlias"> 
-             <string>src1</string> 
-            </void> 
-            <void property="operatorId"> 
-             <string>RS_2</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator1"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>VALUE._col0</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src1</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <void method="add"> 
+          <object id="ReduceSinkOperator1" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
+           <void property="columnExprMap"> 
+            <object class="java.util.HashMap"> 
+             <void method="put"> 
+              <string>VALUE._col0</string> 
+              <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>key</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>src1</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
+             <void property="distinctColumnIndices"> 
+              <object class="java.util.ArrayList"/> 
+             </void> 
+             <void property="keyCols"> 
+              <object id="ArrayList1" class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                 <void property="column"> 
+                  <string>key</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src1</string> 
+                 </void> 
+                 <void property="typeInfo"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="keySerializeInfo"> 
+              <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+               <void property="inputFileFormatClass"> 
+                <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+               </void> 
+               <void property="outputFileFormatClass"> 
+                <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+               </void> 
+               <void property="properties"> 
+                <object class="java.util.Properties"> 
+                 <void method="put"> 
+                  <string>columns</string> 
+                  <string>joinkey0</string> 
+                 </void> 
+                 <void method="put"> 
+                  <string>serialization.lib</string> 
+                  <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
+                 </void> 
+                 <void method="put"> 
+                  <string>serialization.sort.order</string> 
+                  <string>+</string> 
+                 </void> 
+                 <void method="put"> 
+                  <string>columns.types</string> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="numDistributionKeys"> 
+              <int>1</int> 
+             </void> 
+             <void property="numReducers"> 
+              <int>-1</int> 
+             </void> 
+             <void property="outputKeyColumnNames"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <string>reducesinkkey0</string> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="outputValueColumnNames"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <string>_col0</string> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="partitionCols"> 
+              <object idref="ArrayList1"/> 
+             </void> 
+             <void property="valueCols"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object idref="ExprNodeColumnDesc1"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="valueSerializeInfo"> 
+              <object id="TableDesc3" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+               <void property="inputFileFormatClass"> 
+                <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+               </void> 
+               <void property="outputFileFormatClass"> 
+                <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+               </void> 
+               <void property="properties"> 
+                <object class="java.util.Properties"> 
+                 <void method="put"> 
+                  <string>columns</string> 
+                  <string>_col0</string> 
+                 </void> 
+                 <void method="put"> 
+                  <string>serialization.lib</string> 
+                  <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
+                 </void> 
+                 <void method="put"> 
+                  <string>columns.types</string> 
+                  <string>string</string> 
+                 </void> 
+                 <void method="put"> 
+                  <string>escape.delim</string> 
+                  <string>\</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="inputAlias"> 
+            <string>src1</string> 
+           </void> 
+           <void property="operatorId"> 
+            <string>RS_2</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator1"/> 
+            </void> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>VALUE._col0</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src1</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
@@ -1250,200 +1242,88 @@
       <void property="reducer"> 
        <object id="JoinOperator0" class="org.apache.hadoop.hive.ql.exec.JoinOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                  <void property="destTableId"> 
-                   <int>1</int> 
-                  </void> 
-                  <void property="dirName"> 
-                   #### A masked pattern was here #### 
-                  </void> 
-                  <void property="gatherStats"> 
-                   <boolean>true</boolean> 
-                  </void> 
-                  <void property="lbCtx"> 
-                   <object idref="ListBucketingCtx0"/> 
-                  </void> 
-                  <void property="maxStatsKeyPrefixLength"> 
-                   <int>150</int> 
-                  </void> 
-                  <void property="numFiles"> 
-                   <int>1</int> 
-                  </void> 
-                  <void property="statsAggPrefix"> 
-                   #### A masked pattern was here #### 
-                  </void> 
-                  <void property="statsCollectRawDataSize"> 
-                   <boolean>true</boolean> 
-                  </void> 
-                  <void property="tableInfo"> 
-                   <object idref="TableDesc0"/> 
-                  </void> 
-                  <void property="totalFiles"> 
-                   <int>1</int> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="operatorId"> 
-                 <string>FS_6</string> 
-                </void> 
-                <void property="parentOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object idref="SelectOperator0"/> 
-                  </void> 
-                 </object> 
+         <void method="add"> 
+          <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                <void property="destTableId"> 
+                 <int>1</int> 
                 </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>key</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>value</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
+                <void property="dirName"> 
+                 #### A masked pattern was here #### 
                 </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="columnExprMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>_col1</string> 
-               <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>_col5</string> 
+                <void property="gatherStats"> 
+                 <boolean>true</boolean> 
                 </void> 
-                <void property="tabAlias"> 
-                 <string>src2</string> 
+                <void property="lbCtx"> 
+                 <object idref="ListBucketingCtx0"/> 
                 </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
+                <void property="maxStatsKeyPrefixLength"> 
+                 <int>150</int> 
                 </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>_col0</string> 
-               <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>_col0</string> 
+                <void property="numFiles"> 
+                 <int>1</int> 
                 </void> 
-                <void property="tabAlias"> 
-                 <string>src1</string> 
+                <void property="statsAggPrefix"> 
+                 #### A masked pattern was here #### 
                 </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
+                <void property="statsCollectRawDataSize"> 
+                 <boolean>true</boolean> 
                 </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-              <void property="colList"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object idref="ExprNodeColumnDesc3"/> 
+                <void property="tableInfo"> 
+                 <object idref="TableDesc0"/> 
                 </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeColumnDesc2"/> 
+                <void property="totalFiles"> 
+                 <int>1</int> 
                 </void> 
                </object> 
               </void> 
-              <void property="outputColumnNames"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <string>_col0</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col1</string> 
-                </void> 
-               </object> 
+              <void property="operatorId"> 
+               <string>FS_6</string> 
               </void> 
-             </object> 
-            </void> 
-            <void property="operatorId"> 
-             <string>SEL_5</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="JoinOperator0"/> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="SelectOperator0"/> 
+               </void> 
               </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>_col0</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src1</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>_col1</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src2</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>key</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
                   </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>value</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
                   </void> 
                  </object> 
                 </void> 
@@ -1451,9 +1331,113 @@
               </void> 
              </object> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="columnExprMap"> 
+            <object class="java.util.HashMap"> 
+             <void method="put"> 
+              <string>_col1</string> 
+              <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>_col5</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>src2</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col0</string> 
+              <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>_col0</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>src1</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+             <void property="colList"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object idref="ExprNodeColumnDesc3"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeColumnDesc2"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="outputColumnNames"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <string>_col0</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col1</string> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>SEL_5</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="JoinOperator0"/> 
+            </void> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>_col0</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src1</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>_col1</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src2</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="columnExprMap"> 
          <object class="java.util.HashMap"> 
@@ -1603,14 +1587,12 @@
          <string>JOIN_4</string> 
         </void> 
         <void property="parentOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object idref="ReduceSinkOperator1"/> 
-          </void> 
-          <void method="add"> 
-           <object idref="ReduceSinkOperator0"/> 
-          </void> 
-         </object> 
+         <void method="add"> 
+          <object idref="ReduceSinkOperator1"/> 
+         </void> 
+         <void method="add"> 
+          <object idref="ReduceSinkOperator0"/> 
+         </void> 
         </void> 
         <void property="posToAliasMap"> 
          <object class="java.util.HashMap"> 
diff --git a/ql/src/test/results/compiler/plan/join2.q.xml b/ql/src/test/results/compiler/plan/join2.q.xml
index dede01abec..b269cae46e 100644
--- a/ql/src/test/results/compiler/plan/join2.q.xml
+++ b/ql/src/test/results/compiler/plan/join2.q.xml
@@ -308,213 +308,209 @@
            <string>$INTNAME</string> 
            <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
             <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="ReduceSinkOperator0" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
-                <void property="columnExprMap"> 
-                 <object class="java.util.HashMap"> 
-                  <void method="put"> 
-                   <string>VALUE._col4</string> 
-                   <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>_col0</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>src1</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
-                  <void property="distinctColumnIndices"> 
-                   <object class="java.util.ArrayList"/> 
-                  </void> 
-                  <void property="keyCols"> 
-                   <object id="ArrayList0" class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                      <void property="children"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                          <void property="column"> 
-                           <string>_col0</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string>src1</string> 
-                          </void> 
-                          <void property="typeInfo"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                          <void property="column"> 
-                           <string>_col4</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string>src2</string> 
-                          </void> 
-                          <void property="typeInfo"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="genericUDF"> 
-                       <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPPlus"/> 
-                      </void> 
-                      <void property="typeInfo"> 
-                       <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                        <void property="typeName"> 
-                         <string>double</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void property="keySerializeInfo"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                    <void property="inputFileFormatClass"> 
-                     <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                    </void> 
-                    <void property="outputFileFormatClass"> 
-                     <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                    </void> 
-                    <void property="properties"> 
-                     <object class="java.util.Properties"> 
-                      <void method="put"> 
-                       <string>columns</string> 
-                       <string>joinkey0</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.lib</string> 
-                       <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.sort.order</string> 
-                       <string>+</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>columns.types</string> 
-                       <string>double</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void property="numDistributionKeys"> 
-                   <int>1</int> 
-                  </void> 
-                  <void property="numReducers"> 
-                   <int>-1</int> 
-                  </void> 
-                  <void property="outputKeyColumnNames"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <string>reducesinkkey0</string> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void property="outputValueColumnNames"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <string>_col4</string> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void property="partitionCols"> 
-                   <object idref="ArrayList0"/> 
-                  </void> 
-                  <void property="valueCols"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc0"/> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void property="valueSerializeInfo"> 
-                   <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                    <void property="inputFileFormatClass"> 
-                     <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                    </void> 
-                    <void property="outputFileFormatClass"> 
-                     <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                    </void> 
-                    <void property="properties"> 
-                     <object class="java.util.Properties"> 
-                      <void method="put"> 
-                       <string>columns</string> 
-                       <string>_col4</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.lib</string> 
-                       <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>columns.types</string> 
-                       <string>string</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>escape.delim</string> 
-                       <string>\</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="operatorId"> 
-                 <string>RS_6</string> 
-                </void> 
-                <void property="parentOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object idref="TableScanOperator0"/> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>VALUE._col4</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>src1</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
+             <void method="add"> 
+              <object id="ReduceSinkOperator0" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
+               <void property="columnExprMap"> 
+                <object class="java.util.HashMap"> 
+                 <void method="put"> 
+                  <string>VALUE._col4</string> 
+                  <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                   <void property="column"> 
+                    <string>_col0</string> 
+                   </void> 
+                   <void property="tabAlias"> 
+                    <string>src1</string> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                     <void property="typeName"> 
+                      <string>string</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="conf"> 
+                <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
+                 <void property="distinctColumnIndices"> 
+                  <object class="java.util.ArrayList"/> 
+                 </void> 
+                 <void property="keyCols"> 
+                  <object id="ArrayList0" class="java.util.ArrayList"> 
+                   <void method="add"> 
+                    <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                     <void property="children"> 
+                      <object class="java.util.ArrayList"> 
+                       <void method="add"> 
+                        <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                         <void property="column"> 
+                          <string>_col0</string> 
+                         </void> 
+                         <void property="tabAlias"> 
+                          <string>src1</string> 
+                         </void> 
+                         <void property="typeInfo"> 
+                          <object idref="PrimitiveTypeInfo0"/> 
+                         </void> 
+                        </object> 
+                       </void> 
+                       <void method="add"> 
+                        <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                         <void property="column"> 
+                          <string>_col4</string> 
+                         </void> 
+                         <void property="tabAlias"> 
+                          <string>src2</string> 
+                         </void> 
+                         <void property="typeInfo"> 
+                          <object idref="PrimitiveTypeInfo0"/> 
+                         </void> 
+                        </object> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void property="genericUDF"> 
+                      <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPPlus"/> 
+                     </void> 
+                     <void property="typeInfo"> 
+                      <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                       <void property="typeName"> 
+                        <string>double</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="keySerializeInfo"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                   <void property="inputFileFormatClass"> 
+                    <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                   </void> 
+                   <void property="outputFileFormatClass"> 
+                    <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                   </void> 
+                   <void property="properties"> 
+                    <object class="java.util.Properties"> 
+                     <void method="put"> 
+                      <string>columns</string> 
+                      <string>joinkey0</string> 
+                     </void> 
+                     <void method="put"> 
+                      <string>serialization.lib</string> 
+                      <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
+                     </void> 
+                     <void method="put"> 
+                      <string>serialization.sort.order</string> 
+                      <string>+</string> 
+                     </void> 
+                     <void method="put"> 
+                      <string>columns.types</string> 
+                      <string>double</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="numDistributionKeys"> 
+                  <int>1</int> 
+                 </void> 
+                 <void property="numReducers"> 
+                  <int>-1</int> 
+                 </void> 
+                 <void property="outputKeyColumnNames"> 
+                  <object class="java.util.ArrayList"> 
+                   <void method="add"> 
+                    <string>reducesinkkey0</string> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="outputValueColumnNames"> 
+                  <object class="java.util.ArrayList"> 
+                   <void method="add"> 
+                    <string>_col4</string> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="partitionCols"> 
+                  <object idref="ArrayList0"/> 
+                 </void> 
+                 <void property="valueCols"> 
+                  <object class="java.util.ArrayList"> 
+                   <void method="add"> 
+                    <object idref="ExprNodeColumnDesc0"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="valueSerializeInfo"> 
+                  <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                   <void property="inputFileFormatClass"> 
+                    <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                   </void> 
+                   <void property="outputFileFormatClass"> 
+                    <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                   </void> 
+                   <void property="properties"> 
+                    <object class="java.util.Properties"> 
+                     <void method="put"> 
+                      <string>columns</string> 
+                      <string>_col4</string> 
+                     </void> 
+                     <void method="put"> 
+                      <string>serialization.lib</string> 
+                      <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
+                     </void> 
+                     <void method="put"> 
+                      <string>columns.types</string> 
+                      <string>string</string> 
+                     </void> 
+                     <void method="put"> 
+                      <string>escape.delim</string> 
+                      <string>\</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="operatorId"> 
+                <string>RS_6</string> 
+               </void> 
+               <void property="parentOperators"> 
+                <void method="add"> 
+                 <object idref="TableScanOperator0"/> 
+                </void> 
+               </void> 
+               <void property="schema"> 
+                <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                 <void property="signature"> 
+                  <object class="java.util.ArrayList"> 
+                   <void method="add"> 
+                    <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                     <void property="internalName"> 
+                      <string>VALUE._col4</string> 
+                     </void> 
+                     <void property="tabAlias"> 
+                      <string>src1</string> 
+                     </void> 
+                     <void property="type"> 
+                      <object idref="PrimitiveTypeInfo0"/> 
+                     </void> 
+                     <void property="typeName"> 
+                      <string>string</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
             </void> 
             <void property="conf"> 
              <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"/> 
@@ -588,205 +584,201 @@
            <string>src3</string> 
            <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
             <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="ReduceSinkOperator1" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
-                <void property="columnExprMap"> 
-                 <object class="java.util.HashMap"> 
-                  <void method="put"> 
-                   <string>VALUE._col1</string> 
-                   <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>value</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>src3</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
-                  <void property="distinctColumnIndices"> 
-                   <object class="java.util.ArrayList"/> 
-                  </void> 
-                  <void property="keyCols"> 
-                   <object id="ArrayList1" class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                      <void property="children"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                          <void property="column"> 
-                           <string>key</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string>src3</string> 
-                          </void> 
-                          <void property="typeInfo"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="genericUDF"> 
-                       <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                        <void property="udfClassName"> 
-                         <string>org.apache.hadoop.hive.ql.udf.UDFToDouble</string> 
-                        </void> 
-                        <void property="udfName"> 
-                         <string>UDFToDouble</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="typeInfo"> 
-                       <object idref="PrimitiveTypeInfo1"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void property="keySerializeInfo"> 
-                   <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                    <void property="inputFileFormatClass"> 
-                     <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                    </void> 
-                    <void property="outputFileFormatClass"> 
-                     <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                    </void> 
-                    <void property="properties"> 
-                     <object class="java.util.Properties"> 
-                      <void method="put"> 
-                       <string>columns</string> 
-                       <string>joinkey0</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.lib</string> 
-                       <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.sort.order</string> 
-                       <string>+</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>columns.types</string> 
-                       <string>double</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void property="numDistributionKeys"> 
-                   <int>1</int> 
-                  </void> 
-                  <void property="numReducers"> 
-                   <int>-1</int> 
-                  </void> 
-                  <void property="outputKeyColumnNames"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <string>reducesinkkey0</string> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void property="outputValueColumnNames"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <string>_col1</string> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void property="partitionCols"> 
-                   <object idref="ArrayList1"/> 
-                  </void> 
-                  <void property="tag"> 
-                   <int>1</int> 
-                  </void> 
-                  <void property="valueCols"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc1"/> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void property="valueSerializeInfo"> 
-                   <object id="TableDesc3" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                    <void property="inputFileFormatClass"> 
-                     <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                    </void> 
-                    <void property="outputFileFormatClass"> 
-                     <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                    </void> 
-                    <void property="properties"> 
-                     <object class="java.util.Properties"> 
-                      <void method="put"> 
-                       <string>columns</string> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.lib</string> 
-                       <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>columns.types</string> 
-                       <string>string</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>escape.delim</string> 
-                       <string>\</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="inputAlias"> 
-                 <string>src3</string> 
-                </void> 
-                <void property="operatorId"> 
-                 <string>RS_7</string> 
-                </void> 
-                <void property="parentOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object idref="TableScanOperator1"/> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>VALUE._col1</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>src3</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
+             <void method="add"> 
+              <object id="ReduceSinkOperator1" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
+               <void property="columnExprMap"> 
+                <object class="java.util.HashMap"> 
+                 <void method="put"> 
+                  <string>VALUE._col1</string> 
+                  <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                   <void property="column"> 
+                    <string>value</string> 
+                   </void> 
+                   <void property="tabAlias"> 
+                    <string>src3</string> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo0"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="conf"> 
+                <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
+                 <void property="distinctColumnIndices"> 
+                  <object class="java.util.ArrayList"/> 
+                 </void> 
+                 <void property="keyCols"> 
+                  <object id="ArrayList1" class="java.util.ArrayList"> 
+                   <void method="add"> 
+                    <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                     <void property="children"> 
+                      <object class="java.util.ArrayList"> 
+                       <void method="add"> 
+                        <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                         <void property="column"> 
+                          <string>key</string> 
+                         </void> 
+                         <void property="tabAlias"> 
+                          <string>src3</string> 
+                         </void> 
+                         <void property="typeInfo"> 
+                          <object idref="PrimitiveTypeInfo0"/> 
+                         </void> 
+                        </object> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void property="genericUDF"> 
+                      <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                       <void property="udfClassName"> 
+                        <string>org.apache.hadoop.hive.ql.udf.UDFToDouble</string> 
+                       </void> 
+                       <void property="udfName"> 
+                        <string>UDFToDouble</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void property="typeInfo"> 
+                      <object idref="PrimitiveTypeInfo1"/> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="keySerializeInfo"> 
+                  <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                   <void property="inputFileFormatClass"> 
+                    <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                   </void> 
+                   <void property="outputFileFormatClass"> 
+                    <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                   </void> 
+                   <void property="properties"> 
+                    <object class="java.util.Properties"> 
+                     <void method="put"> 
+                      <string>columns</string> 
+                      <string>joinkey0</string> 
+                     </void> 
+                     <void method="put"> 
+                      <string>serialization.lib</string> 
+                      <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
+                     </void> 
+                     <void method="put"> 
+                      <string>serialization.sort.order</string> 
+                      <string>+</string> 
+                     </void> 
+                     <void method="put"> 
+                      <string>columns.types</string> 
+                      <string>double</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="numDistributionKeys"> 
+                  <int>1</int> 
+                 </void> 
+                 <void property="numReducers"> 
+                  <int>-1</int> 
+                 </void> 
+                 <void property="outputKeyColumnNames"> 
+                  <object class="java.util.ArrayList"> 
+                   <void method="add"> 
+                    <string>reducesinkkey0</string> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="outputValueColumnNames"> 
+                  <object class="java.util.ArrayList"> 
+                   <void method="add"> 
+                    <string>_col1</string> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="partitionCols"> 
+                  <object idref="ArrayList1"/> 
+                 </void> 
+                 <void property="tag"> 
+                  <int>1</int> 
+                 </void> 
+                 <void property="valueCols"> 
+                  <object class="java.util.ArrayList"> 
+                   <void method="add"> 
+                    <object idref="ExprNodeColumnDesc1"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="valueSerializeInfo"> 
+                  <object id="TableDesc3" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                   <void property="inputFileFormatClass"> 
+                    <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                   </void> 
+                   <void property="outputFileFormatClass"> 
+                    <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                   </void> 
+                   <void property="properties"> 
+                    <object class="java.util.Properties"> 
+                     <void method="put"> 
+                      <string>columns</string> 
+                      <string>_col1</string> 
+                     </void> 
+                     <void method="put"> 
+                      <string>serialization.lib</string> 
+                      <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
+                     </void> 
+                     <void method="put"> 
+                      <string>columns.types</string> 
+                      <string>string</string> 
+                     </void> 
+                     <void method="put"> 
+                      <string>escape.delim</string> 
+                      <string>\</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="inputAlias"> 
+                <string>src3</string> 
+               </void> 
+               <void property="operatorId"> 
+                <string>RS_7</string> 
+               </void> 
+               <void property="parentOperators"> 
+                <void method="add"> 
+                 <object idref="TableScanOperator1"/> 
+                </void> 
+               </void> 
+               <void property="schema"> 
+                <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                 <void property="signature"> 
+                  <object class="java.util.ArrayList"> 
+                   <void method="add"> 
+                    <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                     <void property="internalName"> 
+                      <string>VALUE._col1</string> 
+                     </void> 
+                     <void property="tabAlias"> 
+                      <string>src3</string> 
+                     </void> 
+                     <void property="type"> 
+                      <object idref="PrimitiveTypeInfo0"/> 
+                     </void> 
+                     <void property="typeName"> 
+                      <string>string</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
             </void> 
             <void property="conf"> 
              <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
@@ -1157,200 +1149,88 @@
           <void property="reducer"> 
            <object id="JoinOperator0" class="org.apache.hadoop.hive.ql.exec.JoinOperator"> 
             <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                <void property="childOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                      <void property="destTableId"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="dirName"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="gatherStats"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="lbCtx"> 
-                       <object idref="ListBucketingCtx0"/> 
-                      </void> 
-                      <void property="maxStatsKeyPrefixLength"> 
-                       <int>150</int> 
-                      </void> 
-                      <void property="numFiles"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="statsAggPrefix"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="statsCollectRawDataSize"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="tableInfo"> 
-                       <object idref="TableDesc0"/> 
-                      </void> 
-                      <void property="totalFiles"> 
-                       <int>1</int> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="operatorId"> 
-                     <string>FS_10</string> 
-                    </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="SelectOperator0"/> 
-                      </void> 
-                     </object> 
+             <void method="add"> 
+              <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+               <void property="childOperators"> 
+                <void method="add"> 
+                 <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                  <void property="conf"> 
+                   <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                    <void property="destTableId"> 
+                     <int>1</int> 
                     </void> 
-                    <void property="schema"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                      <void property="signature"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>key</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string></string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>value</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string></string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                    <void property="dirName"> 
+                     #### A masked pattern was here #### 
                     </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="columnExprMap"> 
-                 <object class="java.util.HashMap"> 
-                  <void method="put"> 
-                   <string>_col1</string> 
-                   <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>_col9</string> 
+                    <void property="gatherStats"> 
+                     <boolean>true</boolean> 
                     </void> 
-                    <void property="tabAlias"> 
-                     <string>src3</string> 
+                    <void property="lbCtx"> 
+                     <object idref="ListBucketingCtx0"/> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
+                    <void property="maxStatsKeyPrefixLength"> 
+                     <int>150</int> 
                     </void> 
-                   </object> 
-                  </void> 
-                  <void method="put"> 
-                   <string>_col0</string> 
-                   <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>_col4</string> 
+                    <void property="numFiles"> 
+                     <int>1</int> 
                     </void> 
-                    <void property="tabAlias"> 
-                     <string>src1</string> 
+                    <void property="statsAggPrefix"> 
+                     #### A masked pattern was here #### 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
+                    <void property="statsCollectRawDataSize"> 
+                     <boolean>true</boolean> 
                     </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                  <void property="colList"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc3"/> 
+                    <void property="tableInfo"> 
+                     <object idref="TableDesc0"/> 
                     </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc2"/> 
+                    <void property="totalFiles"> 
+                     <int>1</int> 
                     </void> 
                    </object> 
                   </void> 
-                  <void property="outputColumnNames"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <string>_col0</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col1</string> 
-                    </void> 
-                   </object> 
+                  <void property="operatorId"> 
+                   <string>FS_10</string> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="operatorId"> 
-                 <string>SEL_9</string> 
-                </void> 
-                <void property="parentOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object idref="JoinOperator0"/> 
+                  <void property="parentOperators"> 
+                   <void method="add"> 
+                    <object idref="SelectOperator0"/> 
+                   </void> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>src1</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>src3</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
+                  <void property="schema"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                    <void property="signature"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                        <void property="internalName"> 
+                         <string>key</string> 
+                        </void> 
+                        <void property="tabAlias"> 
+                         <string></string> 
+                        </void> 
+                        <void property="type"> 
+                         <object idref="PrimitiveTypeInfo0"/> 
+                        </void> 
+                        <void property="typeName"> 
+                         <string>string</string> 
+                        </void> 
+                       </object> 
                       </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                        <void property="internalName"> 
+                         <string>value</string> 
+                        </void> 
+                        <void property="tabAlias"> 
+                         <string></string> 
+                        </void> 
+                        <void property="type"> 
+                         <object idref="PrimitiveTypeInfo0"/> 
+                        </void> 
+                        <void property="typeName"> 
+                         <string>string</string> 
+                        </void> 
+                       </object> 
                       </void> 
                      </object> 
                     </void> 
@@ -1358,9 +1238,113 @@
                   </void> 
                  </object> 
                 </void> 
-               </object> 
-              </void> 
-             </object> 
+               </void> 
+               <void property="columnExprMap"> 
+                <object class="java.util.HashMap"> 
+                 <void method="put"> 
+                  <string>_col1</string> 
+                  <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                   <void property="column"> 
+                    <string>_col9</string> 
+                   </void> 
+                   <void property="tabAlias"> 
+                    <string>src3</string> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo0"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="put"> 
+                  <string>_col0</string> 
+                  <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                   <void property="column"> 
+                    <string>_col4</string> 
+                   </void> 
+                   <void property="tabAlias"> 
+                    <string>src1</string> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo0"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="conf"> 
+                <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                 <void property="colList"> 
+                  <object class="java.util.ArrayList"> 
+                   <void method="add"> 
+                    <object idref="ExprNodeColumnDesc3"/> 
+                   </void> 
+                   <void method="add"> 
+                    <object idref="ExprNodeColumnDesc2"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="outputColumnNames"> 
+                  <object class="java.util.ArrayList"> 
+                   <void method="add"> 
+                    <string>_col0</string> 
+                   </void> 
+                   <void method="add"> 
+                    <string>_col1</string> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="operatorId"> 
+                <string>SEL_9</string> 
+               </void> 
+               <void property="parentOperators"> 
+                <void method="add"> 
+                 <object idref="JoinOperator0"/> 
+                </void> 
+               </void> 
+               <void property="schema"> 
+                <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                 <void property="signature"> 
+                  <object class="java.util.ArrayList"> 
+                   <void method="add"> 
+                    <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                     <void property="internalName"> 
+                      <string>_col0</string> 
+                     </void> 
+                     <void property="tabAlias"> 
+                      <string>src1</string> 
+                     </void> 
+                     <void property="type"> 
+                      <object idref="PrimitiveTypeInfo0"/> 
+                     </void> 
+                     <void property="typeName"> 
+                      <string>string</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void method="add"> 
+                    <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                     <void property="internalName"> 
+                      <string>_col1</string> 
+                     </void> 
+                     <void property="tabAlias"> 
+                      <string>src3</string> 
+                     </void> 
+                     <void property="type"> 
+                      <object idref="PrimitiveTypeInfo0"/> 
+                     </void> 
+                     <void property="typeName"> 
+                      <string>string</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
             </void> 
             <void property="columnExprMap"> 
              <object class="java.util.HashMap"> 
@@ -1526,14 +1510,12 @@
              <string>JOIN_8</string> 
             </void> 
             <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="ReduceSinkOperator0"/> 
-              </void> 
-              <void method="add"> 
-               <object idref="ReduceSinkOperator1"/> 
-              </void> 
-             </object> 
+             <void method="add"> 
+              <object idref="ReduceSinkOperator0"/> 
+             </void> 
+             <void method="add"> 
+              <object idref="ReduceSinkOperator1"/> 
+             </void> 
             </void> 
             <void property="posToAliasMap"> 
              <object class="java.util.HashMap"> 
@@ -1901,184 +1883,180 @@
        <string>src2</string> 
        <object id="TableScanOperator2" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="ReduceSinkOperator2" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
-            <void property="columnExprMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>VALUE._col0</string> 
-               <object id="ExprNodeColumnDesc6" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>key</string> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string>src2</string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
-              <void property="distinctColumnIndices"> 
-               <object class="java.util.ArrayList"/> 
-              </void> 
-              <void property="keyCols"> 
-               <object id="ArrayList2" class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                  <void property="column"> 
-                   <string>key</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src2</string> 
-                  </void> 
-                  <void property="typeInfo"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-              <void property="keySerializeInfo"> 
-               <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                <void property="inputFileFormatClass"> 
-                 <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                </void> 
-                <void property="outputFileFormatClass"> 
-                 <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                </void> 
-                <void property="properties"> 
-                 <object class="java.util.Properties"> 
-                  <void method="put"> 
-                   <string>columns</string> 
-                   <string>joinkey0</string> 
-                  </void> 
-                  <void method="put"> 
-                   <string>serialization.lib</string> 
-                   <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
-                  </void> 
-                  <void method="put"> 
-                   <string>serialization.sort.order</string> 
-                   <string>+</string> 
-                  </void> 
-                  <void method="put"> 
-                   <string>columns.types</string> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-              <void property="numDistributionKeys"> 
-               <int>1</int> 
-              </void> 
-              <void property="numReducers"> 
-               <int>-1</int> 
-              </void> 
-              <void property="outputKeyColumnNames"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <string>reducesinkkey0</string> 
-                </void> 
-               </object> 
-              </void> 
-              <void property="outputValueColumnNames"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <string>_col0</string> 
-                </void> 
-               </object> 
-              </void> 
-              <void property="partitionCols"> 
-               <object idref="ArrayList2"/> 
-              </void> 
-              <void property="tag"> 
-               <int>1</int> 
-              </void> 
-              <void property="valueCols"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object idref="ExprNodeColumnDesc6"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void property="valueSerializeInfo"> 
-               <object id="TableDesc5" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                <void property="inputFileFormatClass"> 
-                 <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                </void> 
-                <void property="outputFileFormatClass"> 
-                 <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                </void> 
-                <void property="properties"> 
-                 <object class="java.util.Properties"> 
-                  <void method="put"> 
-                   <string>columns</string> 
-                   <string>_col0</string> 
-                  </void> 
-                  <void method="put"> 
-                   <string>serialization.lib</string> 
-                   <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
-                  </void> 
-                  <void method="put"> 
-                   <string>columns.types</string> 
-                   <string>string</string> 
-                  </void> 
-                  <void method="put"> 
-                   <string>escape.delim</string> 
-                   <string>\</string> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="inputAlias"> 
-             <string>src2</string> 
-            </void> 
-            <void property="operatorId"> 
-             <string>RS_4</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator2"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>VALUE._col0</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src2</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
+         <void method="add"> 
+          <object id="ReduceSinkOperator2" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
+           <void property="columnExprMap"> 
+            <object class="java.util.HashMap"> 
+             <void method="put"> 
+              <string>VALUE._col0</string> 
+              <object id="ExprNodeColumnDesc6" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>key</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>src2</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
+             <void property="distinctColumnIndices"> 
+              <object class="java.util.ArrayList"/> 
+             </void> 
+             <void property="keyCols"> 
+              <object id="ArrayList2" class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                 <void property="column"> 
+                  <string>key</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src2</string> 
+                 </void> 
+                 <void property="typeInfo"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="keySerializeInfo"> 
+              <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+               <void property="inputFileFormatClass"> 
+                <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+               </void> 
+               <void property="outputFileFormatClass"> 
+                <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+               </void> 
+               <void property="properties"> 
+                <object class="java.util.Properties"> 
+                 <void method="put"> 
+                  <string>columns</string> 
+                  <string>joinkey0</string> 
+                 </void> 
+                 <void method="put"> 
+                  <string>serialization.lib</string> 
+                  <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
+                 </void> 
+                 <void method="put"> 
+                  <string>serialization.sort.order</string> 
+                  <string>+</string> 
+                 </void> 
+                 <void method="put"> 
+                  <string>columns.types</string> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="numDistributionKeys"> 
+              <int>1</int> 
+             </void> 
+             <void property="numReducers"> 
+              <int>-1</int> 
+             </void> 
+             <void property="outputKeyColumnNames"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <string>reducesinkkey0</string> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="outputValueColumnNames"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <string>_col0</string> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="partitionCols"> 
+              <object idref="ArrayList2"/> 
+             </void> 
+             <void property="tag"> 
+              <int>1</int> 
+             </void> 
+             <void property="valueCols"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object idref="ExprNodeColumnDesc6"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="valueSerializeInfo"> 
+              <object id="TableDesc5" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+               <void property="inputFileFormatClass"> 
+                <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+               </void> 
+               <void property="outputFileFormatClass"> 
+                <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+               </void> 
+               <void property="properties"> 
+                <object class="java.util.Properties"> 
+                 <void method="put"> 
+                  <string>columns</string> 
+                  <string>_col0</string> 
+                 </void> 
+                 <void method="put"> 
+                  <string>serialization.lib</string> 
+                  <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
+                 </void> 
+                 <void method="put"> 
+                  <string>columns.types</string> 
+                  <string>string</string> 
+                 </void> 
+                 <void method="put"> 
+                  <string>escape.delim</string> 
+                  <string>\</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="inputAlias"> 
+            <string>src2</string> 
+           </void> 
+           <void property="operatorId"> 
+            <string>RS_4</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator2"/> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>VALUE._col0</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src2</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
@@ -2191,181 +2169,177 @@
        <string>src1</string> 
        <object id="TableScanOperator3" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="ReduceSinkOperator3" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
-            <void property="columnExprMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>VALUE._col0</string> 
-               <object id="ExprNodeColumnDesc7" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>key</string> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string>src1</string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
-              <void property="distinctColumnIndices"> 
-               <object class="java.util.ArrayList"/> 
-              </void> 
-              <void property="keyCols"> 
-               <object id="ArrayList3" class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                  <void property="column"> 
-                   <string>key</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src1</string> 
-                  </void> 
-                  <void property="typeInfo"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-              <void property="keySerializeInfo"> 
-               <object id="TableDesc6" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                <void property="inputFileFormatClass"> 
-                 <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                </void> 
-                <void property="outputFileFormatClass"> 
-                 <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                </void> 
-                <void property="properties"> 
-                 <object class="java.util.Properties"> 
-                  <void method="put"> 
-                   <string>columns</string> 
-                   <string>joinkey0</string> 
-                  </void> 
-                  <void method="put"> 
-                   <string>serialization.lib</string> 
-                   <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
-                  </void> 
-                  <void method="put"> 
-                   <string>serialization.sort.order</string> 
-                   <string>+</string> 
-                  </void> 
-                  <void method="put"> 
-                   <string>columns.types</string> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-              <void property="numDistributionKeys"> 
-               <int>1</int> 
-              </void> 
-              <void property="numReducers"> 
-               <int>-1</int> 
-              </void> 
-              <void property="outputKeyColumnNames"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <string>reducesinkkey0</string> 
-                </void> 
-               </object> 
-              </void> 
-              <void property="outputValueColumnNames"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <string>_col0</string> 
-                </void> 
-               </object> 
-              </void> 
-              <void property="partitionCols"> 
-               <object idref="ArrayList3"/> 
-              </void> 
-              <void property="valueCols"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object idref="ExprNodeColumnDesc7"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void property="valueSerializeInfo"> 
-               <object id="TableDesc7" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                <void property="inputFileFormatClass"> 
-                 <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                </void> 
-                <void property="outputFileFormatClass"> 
-                 <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                </void> 
-                <void property="properties"> 
-                 <object class="java.util.Properties"> 
-                  <void method="put"> 
-                   <string>columns</string> 
-                   <string>_col0</string> 
-                  </void> 
-                  <void method="put"> 
-                   <string>serialization.lib</string> 
-                   <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
-                  </void> 
-                  <void method="put"> 
-                   <string>columns.types</string> 
-                   <string>string</string> 
-                  </void> 
-                  <void method="put"> 
-                   <string>escape.delim</string> 
-                   <string>\</string> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="inputAlias"> 
-             <string>src1</string> 
-            </void> 
-            <void property="operatorId"> 
-             <string>RS_3</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator3"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>VALUE._col0</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src1</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
+         <void method="add"> 
+          <object id="ReduceSinkOperator3" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
+           <void property="columnExprMap"> 
+            <object class="java.util.HashMap"> 
+             <void method="put"> 
+              <string>VALUE._col0</string> 
+              <object id="ExprNodeColumnDesc7" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>key</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>src1</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
+             <void property="distinctColumnIndices"> 
+              <object class="java.util.ArrayList"/> 
+             </void> 
+             <void property="keyCols"> 
+              <object id="ArrayList3" class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                 <void property="column"> 
+                  <string>key</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src1</string> 
+                 </void> 
+                 <void property="typeInfo"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="keySerializeInfo"> 
+              <object id="TableDesc6" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+               <void property="inputFileFormatClass"> 
+                <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+               </void> 
+               <void property="outputFileFormatClass"> 
+                <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+               </void> 
+               <void property="properties"> 
+                <object class="java.util.Properties"> 
+                 <void method="put"> 
+                  <string>columns</string> 
+                  <string>joinkey0</string> 
+                 </void> 
+                 <void method="put"> 
+                  <string>serialization.lib</string> 
+                  <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
+                 </void> 
+                 <void method="put"> 
+                  <string>serialization.sort.order</string> 
+                  <string>+</string> 
+                 </void> 
+                 <void method="put"> 
+                  <string>columns.types</string> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="numDistributionKeys"> 
+              <int>1</int> 
+             </void> 
+             <void property="numReducers"> 
+              <int>-1</int> 
+             </void> 
+             <void property="outputKeyColumnNames"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <string>reducesinkkey0</string> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="outputValueColumnNames"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <string>_col0</string> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="partitionCols"> 
+              <object idref="ArrayList3"/> 
+             </void> 
+             <void property="valueCols"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object idref="ExprNodeColumnDesc7"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="valueSerializeInfo"> 
+              <object id="TableDesc7" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+               <void property="inputFileFormatClass"> 
+                <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+               </void> 
+               <void property="outputFileFormatClass"> 
+                <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+               </void> 
+               <void property="properties"> 
+                <object class="java.util.Properties"> 
+                 <void method="put"> 
+                  <string>columns</string> 
+                  <string>_col0</string> 
+                 </void> 
+                 <void method="put"> 
+                  <string>serialization.lib</string> 
+                  <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
+                 </void> 
+                 <void method="put"> 
+                  <string>columns.types</string> 
+                  <string>string</string> 
+                 </void> 
+                 <void method="put"> 
+                  <string>escape.delim</string> 
+                  <string>\</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="inputAlias"> 
+            <string>src1</string> 
+           </void> 
+           <void property="operatorId"> 
+            <string>RS_3</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator3"/> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>VALUE._col0</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src1</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
@@ -2668,41 +2642,37 @@
       <void property="reducer"> 
        <object id="JoinOperator1" class="org.apache.hadoop.hive.ql.exec.JoinOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-              <void property="dirName"> 
-               #### A masked pattern was here #### 
-              </void> 
-              <void property="numFiles"> 
-               <int>1</int> 
-              </void> 
-              <void property="tableInfo"> 
-               <object idref="TableDesc4"/> 
-              </void> 
-              <void property="totalFiles"> 
-               <int>1</int> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="operatorId"> 
-             <string>FS_11</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="JoinOperator1"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object idref="RowSchema0"/> 
+         <void method="add"> 
+          <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+             <void property="dirName"> 
+              #### A masked pattern was here #### 
+             </void> 
+             <void property="numFiles"> 
+              <int>1</int> 
+             </void> 
+             <void property="tableInfo"> 
+              <object idref="TableDesc4"/> 
+             </void> 
+             <void property="totalFiles"> 
+              <int>1</int> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>FS_11</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="JoinOperator1"/> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="schema"> 
+            <object idref="RowSchema0"/> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="columnExprMap"> 
          <object class="java.util.HashMap"> 
@@ -2852,14 +2822,12 @@
          <string>JOIN_5</string> 
         </void> 
         <void property="parentOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object idref="ReduceSinkOperator3"/> 
-          </void> 
-          <void method="add"> 
-           <object idref="ReduceSinkOperator2"/> 
-          </void> 
-         </object> 
+         <void method="add"> 
+          <object idref="ReduceSinkOperator3"/> 
+         </void> 
+         <void method="add"> 
+          <object idref="ReduceSinkOperator2"/> 
+         </void> 
         </void> 
         <void property="posToAliasMap"> 
          <object class="java.util.HashMap"> 
diff --git a/ql/src/test/results/compiler/plan/join3.q.xml b/ql/src/test/results/compiler/plan/join3.q.xml
index 696d588ff5..23f7b68159 100644
--- a/ql/src/test/results/compiler/plan/join3.q.xml
+++ b/ql/src/test/results/compiler/plan/join3.q.xml
@@ -569,180 +569,176 @@
        <string>src2</string> 
        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="ReduceSinkOperator0" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
-            <void property="columnExprMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>VALUE._col0</string> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>key</string> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string>src2</string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
-              <void property="distinctColumnIndices"> 
-               <object class="java.util.ArrayList"/> 
-              </void> 
-              <void property="keyCols"> 
-               <object id="ArrayList0" class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                  <void property="column"> 
-                   <string>key</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src2</string> 
-                  </void> 
-                  <void property="typeInfo"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-              <void property="keySerializeInfo"> 
-               <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                <void property="inputFileFormatClass"> 
-                 <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                </void> 
-                <void property="outputFileFormatClass"> 
-                 <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                </void> 
-                <void property="properties"> 
-                 <object class="java.util.Properties"> 
-                  <void method="put"> 
-                   <string>columns</string> 
-                   <string>joinkey0</string> 
-                  </void> 
-                  <void method="put"> 
-                   <string>serialization.lib</string> 
-                   <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
-                  </void> 
-                  <void method="put"> 
-                   <string>serialization.sort.order</string> 
-                   <string>+</string> 
-                  </void> 
-                  <void method="put"> 
-                   <string>columns.types</string> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-              <void property="numDistributionKeys"> 
-               <int>1</int> 
-              </void> 
-              <void property="numReducers"> 
-               <int>-1</int> 
-              </void> 
-              <void property="outputKeyColumnNames"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <string>reducesinkkey0</string> 
-                </void> 
-               </object> 
-              </void> 
-              <void property="outputValueColumnNames"> 
-               <object class="java.util.ArrayList"/> 
-              </void> 
-              <void property="partitionCols"> 
-               <object idref="ArrayList0"/> 
-              </void> 
-              <void property="tag"> 
-               <int>1</int> 
-              </void> 
-              <void property="valueCols"> 
-               <object class="java.util.ArrayList"/> 
-              </void> 
-              <void property="valueSerializeInfo"> 
-               <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                <void property="inputFileFormatClass"> 
-                 <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                </void> 
-                <void property="outputFileFormatClass"> 
-                 <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                </void> 
-                <void property="properties"> 
-                 <object class="java.util.Properties"> 
-                  <void method="put"> 
-                   <string>columns</string> 
-                   <string></string> 
-                  </void> 
-                  <void method="put"> 
-                   <string>serialization.lib</string> 
-                   <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
-                  </void> 
-                  <void method="put"> 
-                   <string>columns.types</string> 
-                   <string></string> 
-                  </void> 
-                  <void method="put"> 
-                   <string>escape.delim</string> 
-                   <string>\</string> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="inputAlias"> 
-             <string>src2</string> 
-            </void> 
-            <void property="operatorId"> 
-             <string>RS_4</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator0"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>VALUE._col0</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src2</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <void method="add"> 
+          <object id="ReduceSinkOperator0" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
+           <void property="columnExprMap"> 
+            <object class="java.util.HashMap"> 
+             <void method="put"> 
+              <string>VALUE._col0</string> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>key</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>src2</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
+             <void property="distinctColumnIndices"> 
+              <object class="java.util.ArrayList"/> 
+             </void> 
+             <void property="keyCols"> 
+              <object id="ArrayList0" class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                 <void property="column"> 
+                  <string>key</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src2</string> 
+                 </void> 
+                 <void property="typeInfo"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="keySerializeInfo"> 
+              <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+               <void property="inputFileFormatClass"> 
+                <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+               </void> 
+               <void property="outputFileFormatClass"> 
+                <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+               </void> 
+               <void property="properties"> 
+                <object class="java.util.Properties"> 
+                 <void method="put"> 
+                  <string>columns</string> 
+                  <string>joinkey0</string> 
+                 </void> 
+                 <void method="put"> 
+                  <string>serialization.lib</string> 
+                  <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
+                 </void> 
+                 <void method="put"> 
+                  <string>serialization.sort.order</string> 
+                  <string>+</string> 
+                 </void> 
+                 <void method="put"> 
+                  <string>columns.types</string> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="numDistributionKeys"> 
+              <int>1</int> 
+             </void> 
+             <void property="numReducers"> 
+              <int>-1</int> 
+             </void> 
+             <void property="outputKeyColumnNames"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <string>reducesinkkey0</string> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="outputValueColumnNames"> 
+              <object class="java.util.ArrayList"/> 
+             </void> 
+             <void property="partitionCols"> 
+              <object idref="ArrayList0"/> 
+             </void> 
+             <void property="tag"> 
+              <int>1</int> 
+             </void> 
+             <void property="valueCols"> 
+              <object class="java.util.ArrayList"/> 
+             </void> 
+             <void property="valueSerializeInfo"> 
+              <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+               <void property="inputFileFormatClass"> 
+                <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+               </void> 
+               <void property="outputFileFormatClass"> 
+                <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+               </void> 
+               <void property="properties"> 
+                <object class="java.util.Properties"> 
+                 <void method="put"> 
+                  <string>columns</string> 
+                  <string></string> 
+                 </void> 
+                 <void method="put"> 
+                  <string>serialization.lib</string> 
+                  <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
+                 </void> 
+                 <void method="put"> 
+                  <string>columns.types</string> 
+                  <string></string> 
+                 </void> 
+                 <void method="put"> 
+                  <string>escape.delim</string> 
+                  <string>\</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="inputAlias"> 
+            <string>src2</string> 
+           </void> 
+           <void property="operatorId"> 
+            <string>RS_4</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator0"/> 
+            </void> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>VALUE._col0</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src2</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
@@ -859,214 +855,210 @@
        <string>src3</string> 
        <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="ReduceSinkOperator1" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
-            <void property="columnExprMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>VALUE._col1</string> 
-               <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>value</string> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string>src3</string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>VALUE._col0</string> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>key</string> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string>src3</string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
-              <void property="distinctColumnIndices"> 
-               <object class="java.util.ArrayList"/> 
-              </void> 
-              <void property="keyCols"> 
-               <object id="ArrayList1" class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                  <void property="column"> 
-                   <string>key</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src3</string> 
-                  </void> 
-                  <void property="typeInfo"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-              <void property="keySerializeInfo"> 
-               <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                <void property="inputFileFormatClass"> 
-                 <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                </void> 
-                <void property="outputFileFormatClass"> 
-                 <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                </void> 
-                <void property="properties"> 
-                 <object class="java.util.Properties"> 
-                  <void method="put"> 
-                   <string>columns</string> 
-                   <string>joinkey0</string> 
-                  </void> 
-                  <void method="put"> 
-                   <string>serialization.lib</string> 
-                   <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
-                  </void> 
-                  <void method="put"> 
-                   <string>serialization.sort.order</string> 
-                   <string>+</string> 
-                  </void> 
-                  <void method="put"> 
-                   <string>columns.types</string> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-              <void property="numDistributionKeys"> 
-               <int>1</int> 
-              </void> 
-              <void property="numReducers"> 
-               <int>-1</int> 
-              </void> 
-              <void property="outputKeyColumnNames"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <string>reducesinkkey0</string> 
-                </void> 
-               </object> 
-              </void> 
-              <void property="outputValueColumnNames"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <string>_col1</string> 
-                </void> 
-               </object> 
-              </void> 
-              <void property="partitionCols"> 
-               <object idref="ArrayList1"/> 
-              </void> 
-              <void property="tag"> 
-               <int>2</int> 
-              </void> 
-              <void property="valueCols"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object idref="ExprNodeColumnDesc0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void property="valueSerializeInfo"> 
-               <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                <void property="inputFileFormatClass"> 
-                 <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                </void> 
-                <void property="outputFileFormatClass"> 
-                 <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                </void> 
-                <void property="properties"> 
-                 <object class="java.util.Properties"> 
-                  <void method="put"> 
-                   <string>columns</string> 
-                   <string>_col1</string> 
-                  </void> 
-                  <void method="put"> 
-                   <string>serialization.lib</string> 
-                   <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
-                  </void> 
-                  <void method="put"> 
-                   <string>columns.types</string> 
-                   <string>string</string> 
-                  </void> 
-                  <void method="put"> 
-                   <string>escape.delim</string> 
-                   <string>\</string> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="inputAlias"> 
-             <string>src3</string> 
-            </void> 
-            <void property="operatorId"> 
-             <string>RS_5</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator1"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>VALUE._col0</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src3</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>VALUE._col1</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src3</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <void method="add"> 
+          <object id="ReduceSinkOperator1" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
+           <void property="columnExprMap"> 
+            <object class="java.util.HashMap"> 
+             <void method="put"> 
+              <string>VALUE._col1</string> 
+              <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>value</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>src3</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>VALUE._col0</string> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>key</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>src3</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
+             <void property="distinctColumnIndices"> 
+              <object class="java.util.ArrayList"/> 
+             </void> 
+             <void property="keyCols"> 
+              <object id="ArrayList1" class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                 <void property="column"> 
+                  <string>key</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src3</string> 
+                 </void> 
+                 <void property="typeInfo"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="keySerializeInfo"> 
+              <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+               <void property="inputFileFormatClass"> 
+                <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+               </void> 
+               <void property="outputFileFormatClass"> 
+                <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+               </void> 
+               <void property="properties"> 
+                <object class="java.util.Properties"> 
+                 <void method="put"> 
+                  <string>columns</string> 
+                  <string>joinkey0</string> 
+                 </void> 
+                 <void method="put"> 
+                  <string>serialization.lib</string> 
+                  <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
+                 </void> 
+                 <void method="put"> 
+                  <string>serialization.sort.order</string> 
+                  <string>+</string> 
+                 </void> 
+                 <void method="put"> 
+                  <string>columns.types</string> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="numDistributionKeys"> 
+              <int>1</int> 
+             </void> 
+             <void property="numReducers"> 
+              <int>-1</int> 
+             </void> 
+             <void property="outputKeyColumnNames"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <string>reducesinkkey0</string> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="outputValueColumnNames"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <string>_col1</string> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="partitionCols"> 
+              <object idref="ArrayList1"/> 
+             </void> 
+             <void property="tag"> 
+              <int>2</int> 
+             </void> 
+             <void property="valueCols"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object idref="ExprNodeColumnDesc0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="valueSerializeInfo"> 
+              <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+               <void property="inputFileFormatClass"> 
+                <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+               </void> 
+               <void property="outputFileFormatClass"> 
+                <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+               </void> 
+               <void property="properties"> 
+                <object class="java.util.Properties"> 
+                 <void method="put"> 
+                  <string>columns</string> 
+                  <string>_col1</string> 
+                 </void> 
+                 <void method="put"> 
+                  <string>serialization.lib</string> 
+                  <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
+                 </void> 
+                 <void method="put"> 
+                  <string>columns.types</string> 
+                  <string>string</string> 
+                 </void> 
+                 <void method="put"> 
+                  <string>escape.delim</string> 
+                  <string>\</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="inputAlias"> 
+            <string>src3</string> 
+           </void> 
+           <void property="operatorId"> 
+            <string>RS_5</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator1"/> 
+            </void> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>VALUE._col0</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src3</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>VALUE._col1</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src3</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
@@ -1185,181 +1177,177 @@
        <string>src1</string> 
        <object id="TableScanOperator2" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="ReduceSinkOperator2" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
-            <void property="columnExprMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>VALUE._col0</string> 
-               <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>key</string> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string>src1</string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
-              <void property="distinctColumnIndices"> 
-               <object class="java.util.ArrayList"/> 
-              </void> 
-              <void property="keyCols"> 
-               <object id="ArrayList2" class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                  <void property="column"> 
-                   <string>key</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src1</string> 
-                  </void> 
-                  <void property="typeInfo"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-              <void property="keySerializeInfo"> 
-               <object id="TableDesc3" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                <void property="inputFileFormatClass"> 
-                 <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                </void> 
-                <void property="outputFileFormatClass"> 
-                 <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                </void> 
-                <void property="properties"> 
-                 <object class="java.util.Properties"> 
-                  <void method="put"> 
-                   <string>columns</string> 
-                   <string>joinkey0</string> 
-                  </void> 
-                  <void method="put"> 
-                   <string>serialization.lib</string> 
-                   <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
-                  </void> 
-                  <void method="put"> 
-                   <string>serialization.sort.order</string> 
-                   <string>+</string> 
-                  </void> 
-                  <void method="put"> 
-                   <string>columns.types</string> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-              <void property="numDistributionKeys"> 
-               <int>1</int> 
-              </void> 
-              <void property="numReducers"> 
-               <int>-1</int> 
-              </void> 
-              <void property="outputKeyColumnNames"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <string>reducesinkkey0</string> 
-                </void> 
-               </object> 
-              </void> 
-              <void property="outputValueColumnNames"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <string>_col0</string> 
-                </void> 
-               </object> 
-              </void> 
-              <void property="partitionCols"> 
-               <object idref="ArrayList2"/> 
-              </void> 
-              <void property="valueCols"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object idref="ExprNodeColumnDesc1"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void property="valueSerializeInfo"> 
-               <object id="TableDesc4" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                <void property="inputFileFormatClass"> 
-                 <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                </void> 
-                <void property="outputFileFormatClass"> 
-                 <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                </void> 
-                <void property="properties"> 
-                 <object class="java.util.Properties"> 
-                  <void method="put"> 
-                   <string>columns</string> 
-                   <string>_col0</string> 
-                  </void> 
-                  <void method="put"> 
-                   <string>serialization.lib</string> 
-                   <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
-                  </void> 
-                  <void method="put"> 
-                   <string>columns.types</string> 
-                   <string>string</string> 
-                  </void> 
-                  <void method="put"> 
-                   <string>escape.delim</string> 
-                   <string>\</string> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="inputAlias"> 
-             <string>src1</string> 
-            </void> 
-            <void property="operatorId"> 
-             <string>RS_3</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator2"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>VALUE._col0</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src1</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <void method="add"> 
+          <object id="ReduceSinkOperator2" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
+           <void property="columnExprMap"> 
+            <object class="java.util.HashMap"> 
+             <void method="put"> 
+              <string>VALUE._col0</string> 
+              <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>key</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>src1</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
+             <void property="distinctColumnIndices"> 
+              <object class="java.util.ArrayList"/> 
+             </void> 
+             <void property="keyCols"> 
+              <object id="ArrayList2" class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                 <void property="column"> 
+                  <string>key</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src1</string> 
+                 </void> 
+                 <void property="typeInfo"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="keySerializeInfo"> 
+              <object id="TableDesc3" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+               <void property="inputFileFormatClass"> 
+                <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+               </void> 
+               <void property="outputFileFormatClass"> 
+                <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+               </void> 
+               <void property="properties"> 
+                <object class="java.util.Properties"> 
+                 <void method="put"> 
+                  <string>columns</string> 
+                  <string>joinkey0</string> 
+                 </void> 
+                 <void method="put"> 
+                  <string>serialization.lib</string> 
+                  <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
+                 </void> 
+                 <void method="put"> 
+                  <string>serialization.sort.order</string> 
+                  <string>+</string> 
+                 </void> 
+                 <void method="put"> 
+                  <string>columns.types</string> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="numDistributionKeys"> 
+              <int>1</int> 
+             </void> 
+             <void property="numReducers"> 
+              <int>-1</int> 
+             </void> 
+             <void property="outputKeyColumnNames"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <string>reducesinkkey0</string> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="outputValueColumnNames"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <string>_col0</string> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="partitionCols"> 
+              <object idref="ArrayList2"/> 
+             </void> 
+             <void property="valueCols"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object idref="ExprNodeColumnDesc1"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="valueSerializeInfo"> 
+              <object id="TableDesc4" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+               <void property="inputFileFormatClass"> 
+                <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+               </void> 
+               <void property="outputFileFormatClass"> 
+                <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+               </void> 
+               <void property="properties"> 
+                <object class="java.util.Properties"> 
+                 <void method="put"> 
+                  <string>columns</string> 
+                  <string>_col0</string> 
+                 </void> 
+                 <void method="put"> 
+                  <string>serialization.lib</string> 
+                  <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
+                 </void> 
+                 <void method="put"> 
+                  <string>columns.types</string> 
+                  <string>string</string> 
+                 </void> 
+                 <void method="put"> 
+                  <string>escape.delim</string> 
+                  <string>\</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="inputAlias"> 
+            <string>src1</string> 
+           </void> 
+           <void property="operatorId"> 
+            <string>RS_3</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator2"/> 
+            </void> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>VALUE._col0</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src1</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
@@ -1671,200 +1659,88 @@
       <void property="reducer"> 
        <object id="JoinOperator0" class="org.apache.hadoop.hive.ql.exec.JoinOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                  <void property="destTableId"> 
-                   <int>1</int> 
-                  </void> 
-                  <void property="dirName"> 
-                   #### A masked pattern was here #### 
-                  </void> 
-                  <void property="gatherStats"> 
-                   <boolean>true</boolean> 
-                  </void> 
-                  <void property="lbCtx"> 
-                   <object idref="ListBucketingCtx0"/> 
-                  </void> 
-                  <void property="maxStatsKeyPrefixLength"> 
-                   <int>150</int> 
-                  </void> 
-                  <void property="numFiles"> 
-                   <int>1</int> 
-                  </void> 
-                  <void property="statsAggPrefix"> 
-                   #### A masked pattern was here #### 
-                  </void> 
-                  <void property="statsCollectRawDataSize"> 
-                   <boolean>true</boolean> 
-                  </void> 
-                  <void property="tableInfo"> 
-                   <object idref="TableDesc0"/> 
-                  </void> 
-                  <void property="totalFiles"> 
-                   <int>1</int> 
-                  </void> 
-                 </object> 
+         <void method="add"> 
+          <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                <void property="destTableId"> 
+                 <int>1</int> 
                 </void> 
-                <void property="operatorId"> 
-                 <string>FS_8</string> 
+                <void property="dirName"> 
+                 #### A masked pattern was here #### 
                 </void> 
-                <void property="parentOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object idref="SelectOperator0"/> 
-                  </void> 
-                 </object> 
+                <void property="gatherStats"> 
+                 <boolean>true</boolean> 
                 </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>key</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>value</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
+                <void property="lbCtx"> 
+                 <object idref="ListBucketingCtx0"/> 
                 </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="columnExprMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>_col1</string> 
-               <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>_col9</string> 
+                <void property="maxStatsKeyPrefixLength"> 
+                 <int>150</int> 
                 </void> 
-                <void property="tabAlias"> 
-                 <string>src3</string> 
+                <void property="numFiles"> 
+                 <int>1</int> 
                 </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
+                <void property="statsAggPrefix"> 
+                 #### A masked pattern was here #### 
                 </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>_col0</string> 
-               <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>_col0</string> 
+                <void property="statsCollectRawDataSize"> 
+                 <boolean>true</boolean> 
                 </void> 
-                <void property="tabAlias"> 
-                 <string>src1</string> 
+                <void property="tableInfo"> 
+                 <object idref="TableDesc0"/> 
                 </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
+                <void property="totalFiles"> 
+                 <int>1</int> 
                 </void> 
                </object> 
               </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-              <void property="colList"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object idref="ExprNodeColumnDesc3"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeColumnDesc2"/> 
-                </void> 
-               </object> 
+              <void property="operatorId"> 
+               <string>FS_8</string> 
               </void> 
-              <void property="outputColumnNames"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <string>_col0</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col1</string> 
-                </void> 
-               </object> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="SelectOperator0"/> 
+               </void> 
               </void> 
-             </object> 
-            </void> 
-            <void property="operatorId"> 
-             <string>SEL_7</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="JoinOperator0"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>_col0</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src1</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>_col1</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src3</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>key</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
                   </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>value</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
                   </void> 
                  </object> 
                 </void> 
@@ -1872,9 +1748,113 @@
               </void> 
              </object> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="columnExprMap"> 
+            <object class="java.util.HashMap"> 
+             <void method="put"> 
+              <string>_col1</string> 
+              <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>_col9</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>src3</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col0</string> 
+              <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>_col0</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>src1</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+             <void property="colList"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object idref="ExprNodeColumnDesc3"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeColumnDesc2"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="outputColumnNames"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <string>_col0</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col1</string> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>SEL_7</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="JoinOperator0"/> 
+            </void> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>_col0</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src1</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>_col1</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src3</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="columnExprMap"> 
          <object class="java.util.HashMap"> 
@@ -2058,17 +2038,15 @@
          <string>JOIN_6</string> 
         </void> 
         <void property="parentOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object idref="ReduceSinkOperator2"/> 
-          </void> 
-          <void method="add"> 
-           <object idref="ReduceSinkOperator0"/> 
-          </void> 
-          <void method="add"> 
-           <object idref="ReduceSinkOperator1"/> 
-          </void> 
-         </object> 
+         <void method="add"> 
+          <object idref="ReduceSinkOperator2"/> 
+         </void> 
+         <void method="add"> 
+          <object idref="ReduceSinkOperator0"/> 
+         </void> 
+         <void method="add"> 
+          <object idref="ReduceSinkOperator1"/> 
+         </void> 
         </void> 
         <void property="posToAliasMap"> 
          <object class="java.util.HashMap"> 
diff --git a/ql/src/test/results/compiler/plan/join4.q.xml b/ql/src/test/results/compiler/plan/join4.q.xml
index f8a8f1064f..83d3d82e73 100644
--- a/ql/src/test/results/compiler/plan/join4.q.xml
+++ b/ql/src/test/results/compiler/plan/join4.q.xml
@@ -289,478 +289,466 @@
        <string>c:a:src1</string> 
        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                <void property="childOperators"> 
-                 <object class="java.util.ArrayList"> 
+         <void method="add"> 
+          <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+              <void property="childOperators"> 
+               <void method="add"> 
+                <object id="ReduceSinkOperator0" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
+                 <void property="columnExprMap"> 
+                  <object class="java.util.HashMap"> 
+                   <void method="put"> 
+                    <string>VALUE._col1</string> 
+                    <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                     <void property="column"> 
+                      <string>_col1</string> 
+                     </void> 
+                     <void property="typeInfo"> 
+                      <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void method="put"> 
+                    <string>VALUE._col0</string> 
+                    <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                     <void property="column"> 
+                      <string>_col0</string> 
+                     </void> 
+                     <void property="typeInfo"> 
+                      <object idref="PrimitiveTypeInfo0"/> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="conf"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
+                   <void property="distinctColumnIndices"> 
+                    <object class="java.util.ArrayList"/> 
+                   </void> 
+                   <void property="keyCols"> 
+                    <object id="ArrayList0" class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <void property="column"> 
+                        <string>_col0</string> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="keySerializeInfo"> 
+                    <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                     <void property="inputFileFormatClass"> 
+                      <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                     </void> 
+                     <void property="outputFileFormatClass"> 
+                      <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                     </void> 
+                     <void property="properties"> 
+                      <object class="java.util.Properties"> 
+                       <void method="put"> 
+                        <string>columns</string> 
+                        <string>joinkey0</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.lib</string> 
+                        <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.sort.order</string> 
+                        <string>+</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns.types</string> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="numDistributionKeys"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="numReducers"> 
+                    <int>-1</int> 
+                   </void> 
+                   <void property="outputKeyColumnNames"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <string>reducesinkkey0</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="outputValueColumnNames"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <string>_col0</string> 
+                     </void> 
+                     <void method="add"> 
+                      <string>_col1</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="partitionCols"> 
+                    <object idref="ArrayList0"/> 
+                   </void> 
+                   <void property="valueCols"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object idref="ExprNodeColumnDesc1"/> 
+                     </void> 
+                     <void method="add"> 
+                      <object idref="ExprNodeColumnDesc0"/> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="valueSerializeInfo"> 
+                    <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                     <void property="inputFileFormatClass"> 
+                      <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                     </void> 
+                     <void property="outputFileFormatClass"> 
+                      <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                     </void> 
+                     <void property="properties"> 
+                      <object class="java.util.Properties"> 
+                       <void method="put"> 
+                        <string>columns</string> 
+                        <string>_col0,_col1</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.lib</string> 
+                        <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns.types</string> 
+                        <string>string,string</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>escape.delim</string> 
+                        <string>\</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="inputAlias"> 
+                  <string>a</string> 
+                 </void> 
+                 <void property="operatorId"> 
+                  <string>RS_6</string> 
+                 </void> 
+                 <void property="parentOperators"> 
                   <void method="add"> 
-                   <object id="ReduceSinkOperator0" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
-                    <void property="columnExprMap"> 
-                     <object class="java.util.HashMap"> 
-                      <void method="put"> 
-                       <string>VALUE._col1</string> 
-                       <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>_col1</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="put"> 
-                       <string>VALUE._col0</string> 
-                       <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
-                      <void property="distinctColumnIndices"> 
-                       <object class="java.util.ArrayList"/> 
-                      </void> 
-                      <void property="keyCols"> 
-                       <object id="ArrayList0" class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                          <void property="column"> 
-                           <string>_col0</string> 
-                          </void> 
-                          <void property="typeInfo"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="keySerializeInfo"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                        <void property="inputFileFormatClass"> 
-                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                        </void> 
-                        <void property="outputFileFormatClass"> 
-                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                        </void> 
-                        <void property="properties"> 
-                         <object class="java.util.Properties"> 
-                          <void method="put"> 
-                           <string>columns</string> 
-                           <string>joinkey0</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.lib</string> 
-                           <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.sort.order</string> 
-                           <string>+</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns.types</string> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="numDistributionKeys"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="numReducers"> 
-                       <int>-1</int> 
-                      </void> 
-                      <void property="outputKeyColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>reducesinkkey0</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="outputValueColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void method="add"> 
-                         <string>_col1</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="partitionCols"> 
-                       <object idref="ArrayList0"/> 
-                      </void> 
-                      <void property="valueCols"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc1"/> 
-                        </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="valueSerializeInfo"> 
-                       <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                        <void property="inputFileFormatClass"> 
-                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                        </void> 
-                        <void property="outputFileFormatClass"> 
-                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                        </void> 
-                        <void property="properties"> 
-                         <object class="java.util.Properties"> 
-                          <void method="put"> 
-                           <string>columns</string> 
-                           <string>_col0,_col1</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.lib</string> 
-                           <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns.types</string> 
-                           <string>string,string</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>escape.delim</string> 
-                           <string>\</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="inputAlias"> 
-                     <string>a</string> 
-                    </void> 
-                    <void property="operatorId"> 
-                     <string>RS_6</string> 
-                    </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="SelectOperator0"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="schema"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                      <void property="signature"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>VALUE._col0</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string>a</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>VALUE._col1</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string>a</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                   <object idref="SelectOperator0"/> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="columnExprMap"> 
-                 <object class="java.util.HashMap"> 
-                  <void method="put"> 
-                   <string>_col1</string> 
-                   <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>value</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>src1</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
+                 </void> 
+                 <void property="schema"> 
+                  <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                   <void property="signature"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>VALUE._col0</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string>a</string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>VALUE._col1</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string>a</string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+              </void> 
+              <void property="columnExprMap"> 
+               <object class="java.util.HashMap"> 
+                <void method="put"> 
+                 <string>_col1</string> 
+                 <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>value</string> 
                   </void> 
-                  <void method="put"> 
-                   <string>_col0</string> 
-                   <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>key</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>src1</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
+                  <void property="tabAlias"> 
+                   <string>src1</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                  <void property="colList"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc3"/> 
-                    </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc2"/> 
-                    </void> 
-                   </object> 
+                <void method="put"> 
+                 <string>_col0</string> 
+                 <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>key</string> 
                   </void> 
-                  <void property="outputColumnNames"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <string>_col0</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col1</string> 
-                    </void> 
-                   </object> 
+                  <void property="tabAlias"> 
+                   <string>src1</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="operatorId"> 
-                 <string>SEL_5</string> 
-                </void> 
-                <void property="parentOperators"> 
+               </object> 
+              </void> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                <void property="colList"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object idref="FilterOperator0"/> 
+                   <object idref="ExprNodeColumnDesc3"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object idref="ExprNodeColumnDesc2"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                <void property="outputColumnNames"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <string>_col0</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col1</string> 
                   </void> 
                  </object> 
                 </void> 
                </object> 
               </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-              <void property="predicate"> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
+              <void property="operatorId"> 
+               <string>SEL_5</string> 
+              </void> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="FilterOperator0"/> 
+               </void> 
+              </void> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src1</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>int</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="value"> 
-                         <int>10</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan"/> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                      <void property="typeName"> 
-                       <string>boolean</string> 
-                      </void> 
-                     </object> 
+                    <void property="typeName"> 
+                     <string>string</string> 
                     </void> 
                    </object> 
                   </void> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src1</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>20</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col1</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                    <void property="typeName"> 
+                     <string>string</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo2"/> 
-                </void> 
                </object> 
               </void> 
              </object> 
             </void> 
-            <void property="operatorId"> 
-             <string>FIL_12</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator0"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>key</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src1</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>value</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src1</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
+             <void property="predicate"> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                   <void property="children"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <void property="column"> 
+                        <string>key</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string>src1</string> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                       <void property="typeInfo"> 
+                        <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                         <void property="typeName"> 
+                          <string>int</string> 
+                         </void> 
+                        </object> 
+                       </void> 
+                       <void property="value"> 
+                        <int>10</int> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="genericUDF"> 
+                    <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan"/> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                     <void property="typeName"> 
+                      <string>boolean</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                   <void property="children"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <void property="column"> 
+                        <string>key</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string>src1</string> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo1"/> 
+                       </void> 
+                       <void property="value"> 
+                        <int>20</int> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="genericUDF"> 
+                    <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo2"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo2"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>FIL_12</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator0"/> 
+            </void> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>key</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src1</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>value</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src1</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
@@ -857,469 +845,457 @@
        <string>c:b:src2</string> 
        <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                <void property="childOperators"> 
-                 <object class="java.util.ArrayList"> 
+         <void method="add"> 
+          <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+              <void property="childOperators"> 
+               <void method="add"> 
+                <object id="ReduceSinkOperator1" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
+                 <void property="columnExprMap"> 
+                  <object class="java.util.HashMap"> 
+                   <void method="put"> 
+                    <string>VALUE._col1</string> 
+                    <object id="ExprNodeColumnDesc4" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                     <void property="column"> 
+                      <string>_col1</string> 
+                     </void> 
+                     <void property="typeInfo"> 
+                      <object idref="PrimitiveTypeInfo0"/> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void method="put"> 
+                    <string>VALUE._col0</string> 
+                    <object id="ExprNodeColumnDesc5" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                     <void property="column"> 
+                      <string>_col0</string> 
+                     </void> 
+                     <void property="typeInfo"> 
+                      <object idref="PrimitiveTypeInfo0"/> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="conf"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
+                   <void property="distinctColumnIndices"> 
+                    <object class="java.util.ArrayList"/> 
+                   </void> 
+                   <void property="keyCols"> 
+                    <object id="ArrayList1" class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <void property="column"> 
+                        <string>_col0</string> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="keySerializeInfo"> 
+                    <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                     <void property="inputFileFormatClass"> 
+                      <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                     </void> 
+                     <void property="outputFileFormatClass"> 
+                      <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                     </void> 
+                     <void property="properties"> 
+                      <object class="java.util.Properties"> 
+                       <void method="put"> 
+                        <string>columns</string> 
+                        <string>joinkey0</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.lib</string> 
+                        <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.sort.order</string> 
+                        <string>+</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns.types</string> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="numDistributionKeys"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="numReducers"> 
+                    <int>-1</int> 
+                   </void> 
+                   <void property="outputKeyColumnNames"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <string>reducesinkkey0</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="outputValueColumnNames"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <string>_col0</string> 
+                     </void> 
+                     <void method="add"> 
+                      <string>_col1</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="partitionCols"> 
+                    <object idref="ArrayList1"/> 
+                   </void> 
+                   <void property="tag"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="valueCols"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object idref="ExprNodeColumnDesc5"/> 
+                     </void> 
+                     <void method="add"> 
+                      <object idref="ExprNodeColumnDesc4"/> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="valueSerializeInfo"> 
+                    <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                     <void property="inputFileFormatClass"> 
+                      <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                     </void> 
+                     <void property="outputFileFormatClass"> 
+                      <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                     </void> 
+                     <void property="properties"> 
+                      <object class="java.util.Properties"> 
+                       <void method="put"> 
+                        <string>columns</string> 
+                        <string>_col0,_col1</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.lib</string> 
+                        <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns.types</string> 
+                        <string>string,string</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>escape.delim</string> 
+                        <string>\</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="inputAlias"> 
+                  <string>b</string> 
+                 </void> 
+                 <void property="operatorId"> 
+                  <string>RS_7</string> 
+                 </void> 
+                 <void property="parentOperators"> 
                   <void method="add"> 
-                   <object id="ReduceSinkOperator1" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
-                    <void property="columnExprMap"> 
-                     <object class="java.util.HashMap"> 
-                      <void method="put"> 
-                       <string>VALUE._col1</string> 
-                       <object id="ExprNodeColumnDesc4" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>_col1</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="put"> 
-                       <string>VALUE._col0</string> 
-                       <object id="ExprNodeColumnDesc5" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
-                      <void property="distinctColumnIndices"> 
-                       <object class="java.util.ArrayList"/> 
-                      </void> 
-                      <void property="keyCols"> 
-                       <object id="ArrayList1" class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                          <void property="column"> 
-                           <string>_col0</string> 
-                          </void> 
-                          <void property="typeInfo"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="keySerializeInfo"> 
-                       <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                        <void property="inputFileFormatClass"> 
-                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                        </void> 
-                        <void property="outputFileFormatClass"> 
-                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                        </void> 
-                        <void property="properties"> 
-                         <object class="java.util.Properties"> 
-                          <void method="put"> 
-                           <string>columns</string> 
-                           <string>joinkey0</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.lib</string> 
-                           <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.sort.order</string> 
-                           <string>+</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns.types</string> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="numDistributionKeys"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="numReducers"> 
-                       <int>-1</int> 
-                      </void> 
-                      <void property="outputKeyColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>reducesinkkey0</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="outputValueColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void method="add"> 
-                         <string>_col1</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="partitionCols"> 
-                       <object idref="ArrayList1"/> 
-                      </void> 
-                      <void property="tag"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="valueCols"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc5"/> 
-                        </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc4"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="valueSerializeInfo"> 
-                       <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                        <void property="inputFileFormatClass"> 
-                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                        </void> 
-                        <void property="outputFileFormatClass"> 
-                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                        </void> 
-                        <void property="properties"> 
-                         <object class="java.util.Properties"> 
-                          <void method="put"> 
-                           <string>columns</string> 
-                           <string>_col0,_col1</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.lib</string> 
-                           <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns.types</string> 
-                           <string>string,string</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>escape.delim</string> 
-                           <string>\</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="inputAlias"> 
-                     <string>b</string> 
-                    </void> 
-                    <void property="operatorId"> 
-                     <string>RS_7</string> 
-                    </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="SelectOperator1"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="schema"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                      <void property="signature"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>VALUE._col0</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string>b</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>VALUE._col1</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string>b</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                   <object idref="SelectOperator1"/> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="columnExprMap"> 
-                 <object class="java.util.HashMap"> 
-                  <void method="put"> 
-                   <string>_col1</string> 
-                   <object id="ExprNodeColumnDesc6" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>value</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>src2</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
+                 </void> 
+                 <void property="schema"> 
+                  <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                   <void property="signature"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>VALUE._col0</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string>b</string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>VALUE._col1</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string>b</string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+              </void> 
+              <void property="columnExprMap"> 
+               <object class="java.util.HashMap"> 
+                <void method="put"> 
+                 <string>_col1</string> 
+                 <object id="ExprNodeColumnDesc6" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>value</string> 
                   </void> 
-                  <void method="put"> 
-                   <string>_col0</string> 
-                   <object id="ExprNodeColumnDesc7" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>key</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>src2</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
+                  <void property="tabAlias"> 
+                   <string>src2</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                  <void property="colList"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc7"/> 
-                    </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc6"/> 
-                    </void> 
-                   </object> 
+                <void method="put"> 
+                 <string>_col0</string> 
+                 <object id="ExprNodeColumnDesc7" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>key</string> 
                   </void> 
-                  <void property="outputColumnNames"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <string>_col0</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col1</string> 
-                    </void> 
-                   </object> 
+                  <void property="tabAlias"> 
+                   <string>src2</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="operatorId"> 
-                 <string>SEL_2</string> 
-                </void> 
-                <void property="parentOperators"> 
+               </object> 
+              </void> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                <void property="colList"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object idref="FilterOperator1"/> 
+                   <object idref="ExprNodeColumnDesc7"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object idref="ExprNodeColumnDesc6"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                <void property="outputColumnNames"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <string>_col0</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col1</string> 
                   </void> 
                  </object> 
                 </void> 
                </object> 
               </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-              <void property="predicate"> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
+              <void property="operatorId"> 
+               <string>SEL_2</string> 
+              </void> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="FilterOperator1"/> 
+               </void> 
+              </void> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src2</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>15</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan"/> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                    <void property="typeName"> 
+                     <string>string</string> 
                     </void> 
                    </object> 
                   </void> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src2</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>25</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col1</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                    <void property="typeName"> 
+                     <string>string</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo2"/> 
-                </void> 
                </object> 
               </void> 
              </object> 
             </void> 
-            <void property="operatorId"> 
-             <string>FIL_13</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator1"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object id="ColumnInfo2" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>key</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src2</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object id="ColumnInfo3" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>value</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src2</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
+             <void property="predicate"> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                   <void property="children"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <void property="column"> 
+                        <string>key</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string>src2</string> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo1"/> 
+                       </void> 
+                       <void property="value"> 
+                        <int>15</int> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="genericUDF"> 
+                    <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan"/> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo2"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                   <void property="children"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <void property="column"> 
+                        <string>key</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string>src2</string> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo1"/> 
+                       </void> 
+                       <void property="value"> 
+                        <int>25</int> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="genericUDF"> 
+                    <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo2"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo2"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>FIL_13</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator1"/> 
+            </void> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object id="ColumnInfo2" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>key</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src2</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object id="ColumnInfo3" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>value</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src2</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
@@ -1602,339 +1578,143 @@
       <void property="reducer"> 
        <object id="JoinOperator0" class="org.apache.hadoop.hive.ql.exec.JoinOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="SelectOperator2" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                  <void property="dirName"> 
-                   #### A masked pattern was here #### 
-                  </void> 
-                  <void property="numFiles"> 
-                   <int>1</int> 
-                  </void> 
-                  <void property="statsAggPrefix"> 
-                   #### A masked pattern was here #### 
+         <void method="add"> 
+          <object id="SelectOperator2" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                <void property="dirName"> 
+                 #### A masked pattern was here #### 
+                </void> 
+                <void property="numFiles"> 
+                 <int>1</int> 
+                </void> 
+                <void property="statsAggPrefix"> 
+                 #### A masked pattern was here #### 
+                </void> 
+                <void property="statsCollectRawDataSize"> 
+                 <boolean>true</boolean> 
+                </void> 
+                <void property="tableInfo"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                  <void property="inputFileFormatClass"> 
+                   <class>org.apache.hadoop.mapred.TextInputFormat</class> 
                   </void> 
-                  <void property="statsCollectRawDataSize"> 
-                   <boolean>true</boolean> 
+                  <void property="outputFileFormatClass"> 
+                   <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
                   </void> 
-                  <void property="tableInfo"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                    <void property="inputFileFormatClass"> 
-                     <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                  <void property="properties"> 
+                   <object class="java.util.Properties"> 
+                    <void method="put"> 
+                     <string>hive.serialization.extend.nesting.levels</string> 
+                     <string>true</string> 
                     </void> 
-                    <void property="outputFileFormatClass"> 
-                     <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                    <void method="put"> 
+                     <string>columns</string> 
+                     <string>_col0,_col1,_col2,_col3</string> 
                     </void> 
-                    <void property="properties"> 
-                     <object class="java.util.Properties"> 
-                      <void method="put"> 
-                       <string>hive.serialization.extend.nesting.levels</string> 
-                       <string>true</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>columns</string> 
-                       <string>_col0,_col1,_col2,_col3</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.lib</string> 
-                       <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.format</string> 
-                       <string>1</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>columns.types</string> 
-                       <string>string:string:string:string</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>escape.delim</string> 
-                       <string>\</string> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>serialization.lib</string> 
+                     <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
                     </void> 
-                   </object> 
-                  </void> 
-                  <void property="totalFiles"> 
-                   <int>1</int> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="operatorId"> 
-                 <string>FS_11</string> 
-                </void> 
-                <void property="parentOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object idref="SelectOperator2"/> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>serialization.format</string> 
+                     <string>1</string> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>columns.types</string> 
+                     <string>string:string:string:string</string> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col2</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col3</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>escape.delim</string> 
+                     <string>\</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="columnExprMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>_col3</string> 
-               <object id="ExprNodeColumnDesc8" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>_col3</string> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string>b</string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>_col2</string> 
-               <object id="ExprNodeColumnDesc9" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>_col2</string> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string>b</string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>_col1</string> 
-               <object id="ExprNodeColumnDesc10" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>_col1</string> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string>a</string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>_col0</string> 
-               <object id="ExprNodeColumnDesc11" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>_col0</string> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string>a</string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-              <void property="colList"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object idref="ExprNodeColumnDesc11"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeColumnDesc10"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeColumnDesc9"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeColumnDesc8"/> 
+                <void property="totalFiles"> 
+                 <int>1</int> 
                 </void> 
                </object> 
               </void> 
-              <void property="outputColumnNames"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <string>_col0</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col1</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col2</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col3</string> 
-                </void> 
-               </object> 
+              <void property="operatorId"> 
+               <string>FS_11</string> 
               </void> 
-             </object> 
-            </void> 
-            <void property="operatorId"> 
-             <string>SEL_9</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="JoinOperator0"/> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="SelectOperator2"/> 
+               </void> 
               </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>c1</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col0</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>c</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>c2</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col1</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>c</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>c3</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col2</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>c</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>c4</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col3</string> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
                   </void> 
-                  <void property="tabAlias"> 
-                   <string>c</string> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col1</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
                   </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col2</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
                   </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col3</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
                   </void> 
                  </object> 
                 </void> 
@@ -1942,9 +1722,197 @@
               </void> 
              </object> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="columnExprMap"> 
+            <object class="java.util.HashMap"> 
+             <void method="put"> 
+              <string>_col3</string> 
+              <object id="ExprNodeColumnDesc8" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>_col3</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>b</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col2</string> 
+              <object id="ExprNodeColumnDesc9" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>_col2</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>b</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col1</string> 
+              <object id="ExprNodeColumnDesc10" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>_col1</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>a</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col0</string> 
+              <object id="ExprNodeColumnDesc11" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>_col0</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>a</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+             <void property="colList"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object idref="ExprNodeColumnDesc11"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeColumnDesc10"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeColumnDesc9"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeColumnDesc8"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="outputColumnNames"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <string>_col0</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col1</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col2</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col3</string> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>SEL_9</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="JoinOperator0"/> 
+            </void> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>c1</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col0</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>c</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>c2</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col1</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>c</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>c3</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col2</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>c</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>c4</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col3</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>c</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="columnExprMap"> 
          <object class="java.util.HashMap"> 
@@ -2126,14 +2094,12 @@
          <string>JOIN_8</string> 
         </void> 
         <void property="parentOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object idref="ReduceSinkOperator0"/> 
-          </void> 
-          <void method="add"> 
-           <object idref="ReduceSinkOperator1"/> 
-          </void> 
-         </object> 
+         <void method="add"> 
+          <object idref="ReduceSinkOperator0"/> 
+         </void> 
+         <void method="add"> 
+          <object idref="ReduceSinkOperator1"/> 
+         </void> 
         </void> 
         <void property="posToAliasMap"> 
          <object class="java.util.HashMap"> 
diff --git a/ql/src/test/results/compiler/plan/join5.q.xml b/ql/src/test/results/compiler/plan/join5.q.xml
index d43ce00934..0f4e58d997 100644
--- a/ql/src/test/results/compiler/plan/join5.q.xml
+++ b/ql/src/test/results/compiler/plan/join5.q.xml
@@ -289,478 +289,466 @@
        <string>c:a:src1</string> 
        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                <void property="childOperators"> 
-                 <object class="java.util.ArrayList"> 
+         <void method="add"> 
+          <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+              <void property="childOperators"> 
+               <void method="add"> 
+                <object id="ReduceSinkOperator0" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
+                 <void property="columnExprMap"> 
+                  <object class="java.util.HashMap"> 
+                   <void method="put"> 
+                    <string>VALUE._col1</string> 
+                    <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                     <void property="column"> 
+                      <string>_col1</string> 
+                     </void> 
+                     <void property="typeInfo"> 
+                      <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void method="put"> 
+                    <string>VALUE._col0</string> 
+                    <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                     <void property="column"> 
+                      <string>_col0</string> 
+                     </void> 
+                     <void property="typeInfo"> 
+                      <object idref="PrimitiveTypeInfo0"/> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="conf"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
+                   <void property="distinctColumnIndices"> 
+                    <object class="java.util.ArrayList"/> 
+                   </void> 
+                   <void property="keyCols"> 
+                    <object id="ArrayList0" class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <void property="column"> 
+                        <string>_col0</string> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="keySerializeInfo"> 
+                    <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                     <void property="inputFileFormatClass"> 
+                      <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                     </void> 
+                     <void property="outputFileFormatClass"> 
+                      <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                     </void> 
+                     <void property="properties"> 
+                      <object class="java.util.Properties"> 
+                       <void method="put"> 
+                        <string>columns</string> 
+                        <string>joinkey0</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.lib</string> 
+                        <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.sort.order</string> 
+                        <string>+</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns.types</string> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="numDistributionKeys"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="numReducers"> 
+                    <int>-1</int> 
+                   </void> 
+                   <void property="outputKeyColumnNames"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <string>reducesinkkey0</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="outputValueColumnNames"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <string>_col0</string> 
+                     </void> 
+                     <void method="add"> 
+                      <string>_col1</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="partitionCols"> 
+                    <object idref="ArrayList0"/> 
+                   </void> 
+                   <void property="valueCols"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object idref="ExprNodeColumnDesc1"/> 
+                     </void> 
+                     <void method="add"> 
+                      <object idref="ExprNodeColumnDesc0"/> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="valueSerializeInfo"> 
+                    <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                     <void property="inputFileFormatClass"> 
+                      <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                     </void> 
+                     <void property="outputFileFormatClass"> 
+                      <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                     </void> 
+                     <void property="properties"> 
+                      <object class="java.util.Properties"> 
+                       <void method="put"> 
+                        <string>columns</string> 
+                        <string>_col0,_col1</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.lib</string> 
+                        <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns.types</string> 
+                        <string>string,string</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>escape.delim</string> 
+                        <string>\</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="inputAlias"> 
+                  <string>a</string> 
+                 </void> 
+                 <void property="operatorId"> 
+                  <string>RS_6</string> 
+                 </void> 
+                 <void property="parentOperators"> 
                   <void method="add"> 
-                   <object id="ReduceSinkOperator0" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
-                    <void property="columnExprMap"> 
-                     <object class="java.util.HashMap"> 
-                      <void method="put"> 
-                       <string>VALUE._col1</string> 
-                       <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>_col1</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="put"> 
-                       <string>VALUE._col0</string> 
-                       <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
-                      <void property="distinctColumnIndices"> 
-                       <object class="java.util.ArrayList"/> 
-                      </void> 
-                      <void property="keyCols"> 
-                       <object id="ArrayList0" class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                          <void property="column"> 
-                           <string>_col0</string> 
-                          </void> 
-                          <void property="typeInfo"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="keySerializeInfo"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                        <void property="inputFileFormatClass"> 
-                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                        </void> 
-                        <void property="outputFileFormatClass"> 
-                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                        </void> 
-                        <void property="properties"> 
-                         <object class="java.util.Properties"> 
-                          <void method="put"> 
-                           <string>columns</string> 
-                           <string>joinkey0</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.lib</string> 
-                           <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.sort.order</string> 
-                           <string>+</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns.types</string> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="numDistributionKeys"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="numReducers"> 
-                       <int>-1</int> 
-                      </void> 
-                      <void property="outputKeyColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>reducesinkkey0</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="outputValueColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void method="add"> 
-                         <string>_col1</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="partitionCols"> 
-                       <object idref="ArrayList0"/> 
-                      </void> 
-                      <void property="valueCols"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc1"/> 
-                        </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="valueSerializeInfo"> 
-                       <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                        <void property="inputFileFormatClass"> 
-                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                        </void> 
-                        <void property="outputFileFormatClass"> 
-                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                        </void> 
-                        <void property="properties"> 
-                         <object class="java.util.Properties"> 
-                          <void method="put"> 
-                           <string>columns</string> 
-                           <string>_col0,_col1</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.lib</string> 
-                           <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns.types</string> 
-                           <string>string,string</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>escape.delim</string> 
-                           <string>\</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="inputAlias"> 
-                     <string>a</string> 
-                    </void> 
-                    <void property="operatorId"> 
-                     <string>RS_6</string> 
-                    </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="SelectOperator0"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="schema"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                      <void property="signature"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>VALUE._col0</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string>a</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>VALUE._col1</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string>a</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                   <object idref="SelectOperator0"/> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="columnExprMap"> 
-                 <object class="java.util.HashMap"> 
-                  <void method="put"> 
-                   <string>_col1</string> 
-                   <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>value</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>src1</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
+                 </void> 
+                 <void property="schema"> 
+                  <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                   <void property="signature"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>VALUE._col0</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string>a</string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>VALUE._col1</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string>a</string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+              </void> 
+              <void property="columnExprMap"> 
+               <object class="java.util.HashMap"> 
+                <void method="put"> 
+                 <string>_col1</string> 
+                 <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>value</string> 
                   </void> 
-                  <void method="put"> 
-                   <string>_col0</string> 
-                   <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>key</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>src1</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
+                  <void property="tabAlias"> 
+                   <string>src1</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                  <void property="colList"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc3"/> 
-                    </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc2"/> 
-                    </void> 
-                   </object> 
+                <void method="put"> 
+                 <string>_col0</string> 
+                 <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>key</string> 
                   </void> 
-                  <void property="outputColumnNames"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <string>_col0</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col1</string> 
-                    </void> 
-                   </object> 
+                  <void property="tabAlias"> 
+                   <string>src1</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="operatorId"> 
-                 <string>SEL_5</string> 
-                </void> 
-                <void property="parentOperators"> 
+               </object> 
+              </void> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                <void property="colList"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object idref="FilterOperator0"/> 
+                   <object idref="ExprNodeColumnDesc3"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object idref="ExprNodeColumnDesc2"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                <void property="outputColumnNames"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <string>_col0</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col1</string> 
                   </void> 
                  </object> 
                 </void> 
                </object> 
               </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-              <void property="predicate"> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
+              <void property="operatorId"> 
+               <string>SEL_5</string> 
+              </void> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="FilterOperator0"/> 
+               </void> 
+              </void> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src1</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>int</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="value"> 
-                         <int>10</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan"/> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                      <void property="typeName"> 
-                       <string>boolean</string> 
-                      </void> 
-                     </object> 
+                    <void property="typeName"> 
+                     <string>string</string> 
                     </void> 
                    </object> 
                   </void> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src1</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>20</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col1</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                    <void property="typeName"> 
+                     <string>string</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo2"/> 
-                </void> 
                </object> 
               </void> 
              </object> 
             </void> 
-            <void property="operatorId"> 
-             <string>FIL_12</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator0"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>key</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src1</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>value</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src1</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
+             <void property="predicate"> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                   <void property="children"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <void property="column"> 
+                        <string>key</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string>src1</string> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                       <void property="typeInfo"> 
+                        <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                         <void property="typeName"> 
+                          <string>int</string> 
+                         </void> 
+                        </object> 
+                       </void> 
+                       <void property="value"> 
+                        <int>10</int> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="genericUDF"> 
+                    <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan"/> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                     <void property="typeName"> 
+                      <string>boolean</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                   <void property="children"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <void property="column"> 
+                        <string>key</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string>src1</string> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo1"/> 
+                       </void> 
+                       <void property="value"> 
+                        <int>20</int> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="genericUDF"> 
+                    <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo2"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo2"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>FIL_12</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator0"/> 
+            </void> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>key</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src1</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>value</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src1</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
@@ -857,469 +845,457 @@
        <string>c:b:src2</string> 
        <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                <void property="childOperators"> 
-                 <object class="java.util.ArrayList"> 
+         <void method="add"> 
+          <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+              <void property="childOperators"> 
+               <void method="add"> 
+                <object id="ReduceSinkOperator1" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
+                 <void property="columnExprMap"> 
+                  <object class="java.util.HashMap"> 
+                   <void method="put"> 
+                    <string>VALUE._col1</string> 
+                    <object id="ExprNodeColumnDesc4" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                     <void property="column"> 
+                      <string>_col1</string> 
+                     </void> 
+                     <void property="typeInfo"> 
+                      <object idref="PrimitiveTypeInfo0"/> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void method="put"> 
+                    <string>VALUE._col0</string> 
+                    <object id="ExprNodeColumnDesc5" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                     <void property="column"> 
+                      <string>_col0</string> 
+                     </void> 
+                     <void property="typeInfo"> 
+                      <object idref="PrimitiveTypeInfo0"/> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="conf"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
+                   <void property="distinctColumnIndices"> 
+                    <object class="java.util.ArrayList"/> 
+                   </void> 
+                   <void property="keyCols"> 
+                    <object id="ArrayList1" class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <void property="column"> 
+                        <string>_col0</string> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="keySerializeInfo"> 
+                    <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                     <void property="inputFileFormatClass"> 
+                      <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                     </void> 
+                     <void property="outputFileFormatClass"> 
+                      <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                     </void> 
+                     <void property="properties"> 
+                      <object class="java.util.Properties"> 
+                       <void method="put"> 
+                        <string>columns</string> 
+                        <string>joinkey0</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.lib</string> 
+                        <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.sort.order</string> 
+                        <string>+</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns.types</string> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="numDistributionKeys"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="numReducers"> 
+                    <int>-1</int> 
+                   </void> 
+                   <void property="outputKeyColumnNames"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <string>reducesinkkey0</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="outputValueColumnNames"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <string>_col0</string> 
+                     </void> 
+                     <void method="add"> 
+                      <string>_col1</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="partitionCols"> 
+                    <object idref="ArrayList1"/> 
+                   </void> 
+                   <void property="tag"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="valueCols"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object idref="ExprNodeColumnDesc5"/> 
+                     </void> 
+                     <void method="add"> 
+                      <object idref="ExprNodeColumnDesc4"/> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="valueSerializeInfo"> 
+                    <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                     <void property="inputFileFormatClass"> 
+                      <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                     </void> 
+                     <void property="outputFileFormatClass"> 
+                      <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                     </void> 
+                     <void property="properties"> 
+                      <object class="java.util.Properties"> 
+                       <void method="put"> 
+                        <string>columns</string> 
+                        <string>_col0,_col1</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.lib</string> 
+                        <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns.types</string> 
+                        <string>string,string</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>escape.delim</string> 
+                        <string>\</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="inputAlias"> 
+                  <string>b</string> 
+                 </void> 
+                 <void property="operatorId"> 
+                  <string>RS_7</string> 
+                 </void> 
+                 <void property="parentOperators"> 
                   <void method="add"> 
-                   <object id="ReduceSinkOperator1" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
-                    <void property="columnExprMap"> 
-                     <object class="java.util.HashMap"> 
-                      <void method="put"> 
-                       <string>VALUE._col1</string> 
-                       <object id="ExprNodeColumnDesc4" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>_col1</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="put"> 
-                       <string>VALUE._col0</string> 
-                       <object id="ExprNodeColumnDesc5" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
-                      <void property="distinctColumnIndices"> 
-                       <object class="java.util.ArrayList"/> 
-                      </void> 
-                      <void property="keyCols"> 
-                       <object id="ArrayList1" class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                          <void property="column"> 
-                           <string>_col0</string> 
-                          </void> 
-                          <void property="typeInfo"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="keySerializeInfo"> 
-                       <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                        <void property="inputFileFormatClass"> 
-                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                        </void> 
-                        <void property="outputFileFormatClass"> 
-                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                        </void> 
-                        <void property="properties"> 
-                         <object class="java.util.Properties"> 
-                          <void method="put"> 
-                           <string>columns</string> 
-                           <string>joinkey0</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.lib</string> 
-                           <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.sort.order</string> 
-                           <string>+</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns.types</string> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="numDistributionKeys"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="numReducers"> 
-                       <int>-1</int> 
-                      </void> 
-                      <void property="outputKeyColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>reducesinkkey0</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="outputValueColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void method="add"> 
-                         <string>_col1</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="partitionCols"> 
-                       <object idref="ArrayList1"/> 
-                      </void> 
-                      <void property="tag"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="valueCols"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc5"/> 
-                        </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc4"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="valueSerializeInfo"> 
-                       <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                        <void property="inputFileFormatClass"> 
-                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                        </void> 
-                        <void property="outputFileFormatClass"> 
-                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                        </void> 
-                        <void property="properties"> 
-                         <object class="java.util.Properties"> 
-                          <void method="put"> 
-                           <string>columns</string> 
-                           <string>_col0,_col1</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.lib</string> 
-                           <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns.types</string> 
-                           <string>string,string</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>escape.delim</string> 
-                           <string>\</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="inputAlias"> 
-                     <string>b</string> 
-                    </void> 
-                    <void property="operatorId"> 
-                     <string>RS_7</string> 
-                    </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="SelectOperator1"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="schema"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                      <void property="signature"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>VALUE._col0</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string>b</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>VALUE._col1</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string>b</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                   <object idref="SelectOperator1"/> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="columnExprMap"> 
-                 <object class="java.util.HashMap"> 
-                  <void method="put"> 
-                   <string>_col1</string> 
-                   <object id="ExprNodeColumnDesc6" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>value</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>src2</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
+                 </void> 
+                 <void property="schema"> 
+                  <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                   <void property="signature"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>VALUE._col0</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string>b</string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>VALUE._col1</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string>b</string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+              </void> 
+              <void property="columnExprMap"> 
+               <object class="java.util.HashMap"> 
+                <void method="put"> 
+                 <string>_col1</string> 
+                 <object id="ExprNodeColumnDesc6" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>value</string> 
                   </void> 
-                  <void method="put"> 
-                   <string>_col0</string> 
-                   <object id="ExprNodeColumnDesc7" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>key</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>src2</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
+                  <void property="tabAlias"> 
+                   <string>src2</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                  <void property="colList"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc7"/> 
-                    </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc6"/> 
-                    </void> 
-                   </object> 
+                <void method="put"> 
+                 <string>_col0</string> 
+                 <object id="ExprNodeColumnDesc7" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>key</string> 
                   </void> 
-                  <void property="outputColumnNames"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <string>_col0</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col1</string> 
-                    </void> 
-                   </object> 
+                  <void property="tabAlias"> 
+                   <string>src2</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="operatorId"> 
-                 <string>SEL_2</string> 
-                </void> 
-                <void property="parentOperators"> 
+               </object> 
+              </void> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                <void property="colList"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object idref="FilterOperator1"/> 
+                   <object idref="ExprNodeColumnDesc7"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object idref="ExprNodeColumnDesc6"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                <void property="outputColumnNames"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <string>_col0</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col1</string> 
                   </void> 
                  </object> 
                 </void> 
                </object> 
               </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-              <void property="predicate"> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
+              <void property="operatorId"> 
+               <string>SEL_2</string> 
+              </void> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="FilterOperator1"/> 
+               </void> 
+              </void> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src2</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>15</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan"/> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                    <void property="typeName"> 
+                     <string>string</string> 
                     </void> 
                    </object> 
                   </void> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src2</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>25</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col1</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                    <void property="typeName"> 
+                     <string>string</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo2"/> 
-                </void> 
                </object> 
               </void> 
              </object> 
             </void> 
-            <void property="operatorId"> 
-             <string>FIL_13</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator1"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object id="ColumnInfo2" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>key</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src2</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object id="ColumnInfo3" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>value</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src2</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
+             <void property="predicate"> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                   <void property="children"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <void property="column"> 
+                        <string>key</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string>src2</string> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo1"/> 
+                       </void> 
+                       <void property="value"> 
+                        <int>15</int> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="genericUDF"> 
+                    <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan"/> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo2"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                   <void property="children"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <void property="column"> 
+                        <string>key</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string>src2</string> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo1"/> 
+                       </void> 
+                       <void property="value"> 
+                        <int>25</int> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="genericUDF"> 
+                    <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo2"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo2"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>FIL_13</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator1"/> 
+            </void> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object id="ColumnInfo2" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>key</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src2</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object id="ColumnInfo3" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>value</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src2</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
@@ -1602,339 +1578,143 @@
       <void property="reducer"> 
        <object id="JoinOperator0" class="org.apache.hadoop.hive.ql.exec.JoinOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="SelectOperator2" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                  <void property="dirName"> 
-                   #### A masked pattern was here #### 
-                  </void> 
-                  <void property="numFiles"> 
-                   <int>1</int> 
-                  </void> 
-                  <void property="statsAggPrefix"> 
-                   #### A masked pattern was here #### 
+         <void method="add"> 
+          <object id="SelectOperator2" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                <void property="dirName"> 
+                 #### A masked pattern was here #### 
+                </void> 
+                <void property="numFiles"> 
+                 <int>1</int> 
+                </void> 
+                <void property="statsAggPrefix"> 
+                 #### A masked pattern was here #### 
+                </void> 
+                <void property="statsCollectRawDataSize"> 
+                 <boolean>true</boolean> 
+                </void> 
+                <void property="tableInfo"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                  <void property="inputFileFormatClass"> 
+                   <class>org.apache.hadoop.mapred.TextInputFormat</class> 
                   </void> 
-                  <void property="statsCollectRawDataSize"> 
-                   <boolean>true</boolean> 
+                  <void property="outputFileFormatClass"> 
+                   <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
                   </void> 
-                  <void property="tableInfo"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                    <void property="inputFileFormatClass"> 
-                     <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                  <void property="properties"> 
+                   <object class="java.util.Properties"> 
+                    <void method="put"> 
+                     <string>hive.serialization.extend.nesting.levels</string> 
+                     <string>true</string> 
                     </void> 
-                    <void property="outputFileFormatClass"> 
-                     <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                    <void method="put"> 
+                     <string>columns</string> 
+                     <string>_col0,_col1,_col2,_col3</string> 
                     </void> 
-                    <void property="properties"> 
-                     <object class="java.util.Properties"> 
-                      <void method="put"> 
-                       <string>hive.serialization.extend.nesting.levels</string> 
-                       <string>true</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>columns</string> 
-                       <string>_col0,_col1,_col2,_col3</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.lib</string> 
-                       <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.format</string> 
-                       <string>1</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>columns.types</string> 
-                       <string>string:string:string:string</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>escape.delim</string> 
-                       <string>\</string> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>serialization.lib</string> 
+                     <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
                     </void> 
-                   </object> 
-                  </void> 
-                  <void property="totalFiles"> 
-                   <int>1</int> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="operatorId"> 
-                 <string>FS_11</string> 
-                </void> 
-                <void property="parentOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object idref="SelectOperator2"/> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>serialization.format</string> 
+                     <string>1</string> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>columns.types</string> 
+                     <string>string:string:string:string</string> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col2</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col3</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>escape.delim</string> 
+                     <string>\</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="columnExprMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>_col3</string> 
-               <object id="ExprNodeColumnDesc8" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>_col3</string> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string>b</string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>_col2</string> 
-               <object id="ExprNodeColumnDesc9" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>_col2</string> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string>b</string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>_col1</string> 
-               <object id="ExprNodeColumnDesc10" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>_col1</string> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string>a</string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>_col0</string> 
-               <object id="ExprNodeColumnDesc11" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>_col0</string> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string>a</string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-              <void property="colList"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object idref="ExprNodeColumnDesc11"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeColumnDesc10"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeColumnDesc9"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeColumnDesc8"/> 
+                <void property="totalFiles"> 
+                 <int>1</int> 
                 </void> 
                </object> 
               </void> 
-              <void property="outputColumnNames"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <string>_col0</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col1</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col2</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col3</string> 
-                </void> 
-               </object> 
+              <void property="operatorId"> 
+               <string>FS_11</string> 
               </void> 
-             </object> 
-            </void> 
-            <void property="operatorId"> 
-             <string>SEL_9</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="JoinOperator0"/> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="SelectOperator2"/> 
+               </void> 
               </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>c1</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col0</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>c</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>c2</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col1</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>c</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>c3</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col2</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>c</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>c4</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col3</string> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
                   </void> 
-                  <void property="tabAlias"> 
-                   <string>c</string> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col1</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
                   </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col2</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
                   </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col3</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
                   </void> 
                  </object> 
                 </void> 
@@ -1942,9 +1722,197 @@
               </void> 
              </object> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="columnExprMap"> 
+            <object class="java.util.HashMap"> 
+             <void method="put"> 
+              <string>_col3</string> 
+              <object id="ExprNodeColumnDesc8" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>_col3</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>b</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col2</string> 
+              <object id="ExprNodeColumnDesc9" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>_col2</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>b</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col1</string> 
+              <object id="ExprNodeColumnDesc10" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>_col1</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>a</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col0</string> 
+              <object id="ExprNodeColumnDesc11" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>_col0</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>a</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+             <void property="colList"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object idref="ExprNodeColumnDesc11"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeColumnDesc10"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeColumnDesc9"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeColumnDesc8"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="outputColumnNames"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <string>_col0</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col1</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col2</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col3</string> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>SEL_9</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="JoinOperator0"/> 
+            </void> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>c1</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col0</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>c</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>c2</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col1</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>c</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>c3</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col2</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>c</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>c4</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col3</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>c</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="columnExprMap"> 
          <object class="java.util.HashMap"> 
@@ -2122,14 +2090,12 @@
          <string>JOIN_8</string> 
         </void> 
         <void property="parentOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object idref="ReduceSinkOperator0"/> 
-          </void> 
-          <void method="add"> 
-           <object idref="ReduceSinkOperator1"/> 
-          </void> 
-         </object> 
+         <void method="add"> 
+          <object idref="ReduceSinkOperator0"/> 
+         </void> 
+         <void method="add"> 
+          <object idref="ReduceSinkOperator1"/> 
+         </void> 
         </void> 
         <void property="posToAliasMap"> 
          <object class="java.util.HashMap"> 
diff --git a/ql/src/test/results/compiler/plan/join6.q.xml b/ql/src/test/results/compiler/plan/join6.q.xml
index a354e4b91c..57f4de26a6 100644
--- a/ql/src/test/results/compiler/plan/join6.q.xml
+++ b/ql/src/test/results/compiler/plan/join6.q.xml
@@ -289,478 +289,466 @@
        <string>c:a:src1</string> 
        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                <void property="childOperators"> 
-                 <object class="java.util.ArrayList"> 
+         <void method="add"> 
+          <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+              <void property="childOperators"> 
+               <void method="add"> 
+                <object id="ReduceSinkOperator0" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
+                 <void property="columnExprMap"> 
+                  <object class="java.util.HashMap"> 
+                   <void method="put"> 
+                    <string>VALUE._col1</string> 
+                    <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                     <void property="column"> 
+                      <string>_col1</string> 
+                     </void> 
+                     <void property="typeInfo"> 
+                      <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void method="put"> 
+                    <string>VALUE._col0</string> 
+                    <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                     <void property="column"> 
+                      <string>_col0</string> 
+                     </void> 
+                     <void property="typeInfo"> 
+                      <object idref="PrimitiveTypeInfo0"/> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="conf"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
+                   <void property="distinctColumnIndices"> 
+                    <object class="java.util.ArrayList"/> 
+                   </void> 
+                   <void property="keyCols"> 
+                    <object id="ArrayList0" class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <void property="column"> 
+                        <string>_col0</string> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="keySerializeInfo"> 
+                    <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                     <void property="inputFileFormatClass"> 
+                      <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                     </void> 
+                     <void property="outputFileFormatClass"> 
+                      <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                     </void> 
+                     <void property="properties"> 
+                      <object class="java.util.Properties"> 
+                       <void method="put"> 
+                        <string>columns</string> 
+                        <string>joinkey0</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.lib</string> 
+                        <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.sort.order</string> 
+                        <string>+</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns.types</string> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="numDistributionKeys"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="numReducers"> 
+                    <int>-1</int> 
+                   </void> 
+                   <void property="outputKeyColumnNames"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <string>reducesinkkey0</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="outputValueColumnNames"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <string>_col0</string> 
+                     </void> 
+                     <void method="add"> 
+                      <string>_col1</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="partitionCols"> 
+                    <object idref="ArrayList0"/> 
+                   </void> 
+                   <void property="valueCols"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object idref="ExprNodeColumnDesc1"/> 
+                     </void> 
+                     <void method="add"> 
+                      <object idref="ExprNodeColumnDesc0"/> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="valueSerializeInfo"> 
+                    <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                     <void property="inputFileFormatClass"> 
+                      <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                     </void> 
+                     <void property="outputFileFormatClass"> 
+                      <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                     </void> 
+                     <void property="properties"> 
+                      <object class="java.util.Properties"> 
+                       <void method="put"> 
+                        <string>columns</string> 
+                        <string>_col0,_col1</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.lib</string> 
+                        <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns.types</string> 
+                        <string>string,string</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>escape.delim</string> 
+                        <string>\</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="inputAlias"> 
+                  <string>a</string> 
+                 </void> 
+                 <void property="operatorId"> 
+                  <string>RS_6</string> 
+                 </void> 
+                 <void property="parentOperators"> 
                   <void method="add"> 
-                   <object id="ReduceSinkOperator0" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
-                    <void property="columnExprMap"> 
-                     <object class="java.util.HashMap"> 
-                      <void method="put"> 
-                       <string>VALUE._col1</string> 
-                       <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>_col1</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="put"> 
-                       <string>VALUE._col0</string> 
-                       <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
-                      <void property="distinctColumnIndices"> 
-                       <object class="java.util.ArrayList"/> 
-                      </void> 
-                      <void property="keyCols"> 
-                       <object id="ArrayList0" class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                          <void property="column"> 
-                           <string>_col0</string> 
-                          </void> 
-                          <void property="typeInfo"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="keySerializeInfo"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                        <void property="inputFileFormatClass"> 
-                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                        </void> 
-                        <void property="outputFileFormatClass"> 
-                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                        </void> 
-                        <void property="properties"> 
-                         <object class="java.util.Properties"> 
-                          <void method="put"> 
-                           <string>columns</string> 
-                           <string>joinkey0</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.lib</string> 
-                           <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.sort.order</string> 
-                           <string>+</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns.types</string> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="numDistributionKeys"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="numReducers"> 
-                       <int>-1</int> 
-                      </void> 
-                      <void property="outputKeyColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>reducesinkkey0</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="outputValueColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void method="add"> 
-                         <string>_col1</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="partitionCols"> 
-                       <object idref="ArrayList0"/> 
-                      </void> 
-                      <void property="valueCols"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc1"/> 
-                        </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="valueSerializeInfo"> 
-                       <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                        <void property="inputFileFormatClass"> 
-                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                        </void> 
-                        <void property="outputFileFormatClass"> 
-                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                        </void> 
-                        <void property="properties"> 
-                         <object class="java.util.Properties"> 
-                          <void method="put"> 
-                           <string>columns</string> 
-                           <string>_col0,_col1</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.lib</string> 
-                           <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns.types</string> 
-                           <string>string,string</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>escape.delim</string> 
-                           <string>\</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="inputAlias"> 
-                     <string>a</string> 
-                    </void> 
-                    <void property="operatorId"> 
-                     <string>RS_6</string> 
-                    </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="SelectOperator0"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="schema"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                      <void property="signature"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>VALUE._col0</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string>a</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>VALUE._col1</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string>a</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                   <object idref="SelectOperator0"/> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="columnExprMap"> 
-                 <object class="java.util.HashMap"> 
-                  <void method="put"> 
-                   <string>_col1</string> 
-                   <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>value</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>src1</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
+                 </void> 
+                 <void property="schema"> 
+                  <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                   <void property="signature"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>VALUE._col0</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string>a</string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>VALUE._col1</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string>a</string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+              </void> 
+              <void property="columnExprMap"> 
+               <object class="java.util.HashMap"> 
+                <void method="put"> 
+                 <string>_col1</string> 
+                 <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>value</string> 
                   </void> 
-                  <void method="put"> 
-                   <string>_col0</string> 
-                   <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>key</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>src1</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
+                  <void property="tabAlias"> 
+                   <string>src1</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                  <void property="colList"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc3"/> 
-                    </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc2"/> 
-                    </void> 
-                   </object> 
+                <void method="put"> 
+                 <string>_col0</string> 
+                 <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>key</string> 
                   </void> 
-                  <void property="outputColumnNames"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <string>_col0</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col1</string> 
-                    </void> 
-                   </object> 
+                  <void property="tabAlias"> 
+                   <string>src1</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="operatorId"> 
-                 <string>SEL_5</string> 
-                </void> 
-                <void property="parentOperators"> 
+               </object> 
+              </void> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                <void property="colList"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object idref="FilterOperator0"/> 
+                   <object idref="ExprNodeColumnDesc3"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object idref="ExprNodeColumnDesc2"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                <void property="outputColumnNames"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <string>_col0</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col1</string> 
                   </void> 
                  </object> 
                 </void> 
                </object> 
               </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-              <void property="predicate"> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
+              <void property="operatorId"> 
+               <string>SEL_5</string> 
+              </void> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="FilterOperator0"/> 
+               </void> 
+              </void> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src1</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>int</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="value"> 
-                         <int>10</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan"/> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                      <void property="typeName"> 
-                       <string>boolean</string> 
-                      </void> 
-                     </object> 
+                    <void property="typeName"> 
+                     <string>string</string> 
                     </void> 
                    </object> 
                   </void> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src1</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>20</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col1</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                    <void property="typeName"> 
+                     <string>string</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo2"/> 
-                </void> 
                </object> 
               </void> 
              </object> 
             </void> 
-            <void property="operatorId"> 
-             <string>FIL_12</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator0"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>key</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src1</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>value</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src1</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
+             <void property="predicate"> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                   <void property="children"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <void property="column"> 
+                        <string>key</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string>src1</string> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                       <void property="typeInfo"> 
+                        <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                         <void property="typeName"> 
+                          <string>int</string> 
+                         </void> 
+                        </object> 
+                       </void> 
+                       <void property="value"> 
+                        <int>10</int> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="genericUDF"> 
+                    <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan"/> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                     <void property="typeName"> 
+                      <string>boolean</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                   <void property="children"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <void property="column"> 
+                        <string>key</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string>src1</string> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo1"/> 
+                       </void> 
+                       <void property="value"> 
+                        <int>20</int> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="genericUDF"> 
+                    <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo2"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo2"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>FIL_12</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator0"/> 
+            </void> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>key</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src1</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>value</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src1</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
@@ -857,469 +845,457 @@
        <string>c:b:src2</string> 
        <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                <void property="childOperators"> 
-                 <object class="java.util.ArrayList"> 
+         <void method="add"> 
+          <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+              <void property="childOperators"> 
+               <void method="add"> 
+                <object id="ReduceSinkOperator1" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
+                 <void property="columnExprMap"> 
+                  <object class="java.util.HashMap"> 
+                   <void method="put"> 
+                    <string>VALUE._col1</string> 
+                    <object id="ExprNodeColumnDesc4" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                     <void property="column"> 
+                      <string>_col1</string> 
+                     </void> 
+                     <void property="typeInfo"> 
+                      <object idref="PrimitiveTypeInfo0"/> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void method="put"> 
+                    <string>VALUE._col0</string> 
+                    <object id="ExprNodeColumnDesc5" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                     <void property="column"> 
+                      <string>_col0</string> 
+                     </void> 
+                     <void property="typeInfo"> 
+                      <object idref="PrimitiveTypeInfo0"/> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="conf"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
+                   <void property="distinctColumnIndices"> 
+                    <object class="java.util.ArrayList"/> 
+                   </void> 
+                   <void property="keyCols"> 
+                    <object id="ArrayList1" class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <void property="column"> 
+                        <string>_col0</string> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="keySerializeInfo"> 
+                    <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                     <void property="inputFileFormatClass"> 
+                      <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                     </void> 
+                     <void property="outputFileFormatClass"> 
+                      <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                     </void> 
+                     <void property="properties"> 
+                      <object class="java.util.Properties"> 
+                       <void method="put"> 
+                        <string>columns</string> 
+                        <string>joinkey0</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.lib</string> 
+                        <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.sort.order</string> 
+                        <string>+</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns.types</string> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="numDistributionKeys"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="numReducers"> 
+                    <int>-1</int> 
+                   </void> 
+                   <void property="outputKeyColumnNames"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <string>reducesinkkey0</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="outputValueColumnNames"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <string>_col0</string> 
+                     </void> 
+                     <void method="add"> 
+                      <string>_col1</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="partitionCols"> 
+                    <object idref="ArrayList1"/> 
+                   </void> 
+                   <void property="tag"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="valueCols"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object idref="ExprNodeColumnDesc5"/> 
+                     </void> 
+                     <void method="add"> 
+                      <object idref="ExprNodeColumnDesc4"/> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="valueSerializeInfo"> 
+                    <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                     <void property="inputFileFormatClass"> 
+                      <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                     </void> 
+                     <void property="outputFileFormatClass"> 
+                      <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                     </void> 
+                     <void property="properties"> 
+                      <object class="java.util.Properties"> 
+                       <void method="put"> 
+                        <string>columns</string> 
+                        <string>_col0,_col1</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.lib</string> 
+                        <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns.types</string> 
+                        <string>string,string</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>escape.delim</string> 
+                        <string>\</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="inputAlias"> 
+                  <string>b</string> 
+                 </void> 
+                 <void property="operatorId"> 
+                  <string>RS_7</string> 
+                 </void> 
+                 <void property="parentOperators"> 
                   <void method="add"> 
-                   <object id="ReduceSinkOperator1" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
-                    <void property="columnExprMap"> 
-                     <object class="java.util.HashMap"> 
-                      <void method="put"> 
-                       <string>VALUE._col1</string> 
-                       <object id="ExprNodeColumnDesc4" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>_col1</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="put"> 
-                       <string>VALUE._col0</string> 
-                       <object id="ExprNodeColumnDesc5" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
-                      <void property="distinctColumnIndices"> 
-                       <object class="java.util.ArrayList"/> 
-                      </void> 
-                      <void property="keyCols"> 
-                       <object id="ArrayList1" class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                          <void property="column"> 
-                           <string>_col0</string> 
-                          </void> 
-                          <void property="typeInfo"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="keySerializeInfo"> 
-                       <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                        <void property="inputFileFormatClass"> 
-                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                        </void> 
-                        <void property="outputFileFormatClass"> 
-                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                        </void> 
-                        <void property="properties"> 
-                         <object class="java.util.Properties"> 
-                          <void method="put"> 
-                           <string>columns</string> 
-                           <string>joinkey0</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.lib</string> 
-                           <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.sort.order</string> 
-                           <string>+</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns.types</string> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="numDistributionKeys"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="numReducers"> 
-                       <int>-1</int> 
-                      </void> 
-                      <void property="outputKeyColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>reducesinkkey0</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="outputValueColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void method="add"> 
-                         <string>_col1</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="partitionCols"> 
-                       <object idref="ArrayList1"/> 
-                      </void> 
-                      <void property="tag"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="valueCols"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc5"/> 
-                        </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc4"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="valueSerializeInfo"> 
-                       <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                        <void property="inputFileFormatClass"> 
-                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                        </void> 
-                        <void property="outputFileFormatClass"> 
-                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                        </void> 
-                        <void property="properties"> 
-                         <object class="java.util.Properties"> 
-                          <void method="put"> 
-                           <string>columns</string> 
-                           <string>_col0,_col1</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.lib</string> 
-                           <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns.types</string> 
-                           <string>string,string</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>escape.delim</string> 
-                           <string>\</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="inputAlias"> 
-                     <string>b</string> 
-                    </void> 
-                    <void property="operatorId"> 
-                     <string>RS_7</string> 
-                    </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="SelectOperator1"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="schema"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                      <void property="signature"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>VALUE._col0</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string>b</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>VALUE._col1</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string>b</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                   <object idref="SelectOperator1"/> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="columnExprMap"> 
-                 <object class="java.util.HashMap"> 
-                  <void method="put"> 
-                   <string>_col1</string> 
-                   <object id="ExprNodeColumnDesc6" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>value</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>src2</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
+                 </void> 
+                 <void property="schema"> 
+                  <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                   <void property="signature"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>VALUE._col0</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string>b</string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>VALUE._col1</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string>b</string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+              </void> 
+              <void property="columnExprMap"> 
+               <object class="java.util.HashMap"> 
+                <void method="put"> 
+                 <string>_col1</string> 
+                 <object id="ExprNodeColumnDesc6" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>value</string> 
                   </void> 
-                  <void method="put"> 
-                   <string>_col0</string> 
-                   <object id="ExprNodeColumnDesc7" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>key</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>src2</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
+                  <void property="tabAlias"> 
+                   <string>src2</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                  <void property="colList"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc7"/> 
-                    </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc6"/> 
-                    </void> 
-                   </object> 
+                <void method="put"> 
+                 <string>_col0</string> 
+                 <object id="ExprNodeColumnDesc7" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>key</string> 
                   </void> 
-                  <void property="outputColumnNames"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <string>_col0</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col1</string> 
-                    </void> 
-                   </object> 
+                  <void property="tabAlias"> 
+                   <string>src2</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="operatorId"> 
-                 <string>SEL_2</string> 
-                </void> 
-                <void property="parentOperators"> 
+               </object> 
+              </void> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                <void property="colList"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object idref="FilterOperator1"/> 
+                   <object idref="ExprNodeColumnDesc7"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object idref="ExprNodeColumnDesc6"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                <void property="outputColumnNames"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <string>_col0</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col1</string> 
                   </void> 
                  </object> 
                 </void> 
                </object> 
               </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-              <void property="predicate"> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
+              <void property="operatorId"> 
+               <string>SEL_2</string> 
+              </void> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="FilterOperator1"/> 
+               </void> 
+              </void> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src2</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>15</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan"/> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                    <void property="typeName"> 
+                     <string>string</string> 
                     </void> 
                    </object> 
                   </void> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src2</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>25</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col1</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                    <void property="typeName"> 
+                     <string>string</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo2"/> 
-                </void> 
                </object> 
               </void> 
              </object> 
             </void> 
-            <void property="operatorId"> 
-             <string>FIL_13</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator1"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object id="ColumnInfo2" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>key</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src2</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object id="ColumnInfo3" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>value</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src2</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
+             <void property="predicate"> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                   <void property="children"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <void property="column"> 
+                        <string>key</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string>src2</string> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo1"/> 
+                       </void> 
+                       <void property="value"> 
+                        <int>15</int> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="genericUDF"> 
+                    <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan"/> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo2"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                   <void property="children"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <void property="column"> 
+                        <string>key</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string>src2</string> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo1"/> 
+                       </void> 
+                       <void property="value"> 
+                        <int>25</int> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="genericUDF"> 
+                    <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo2"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo2"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>FIL_13</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator1"/> 
+            </void> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object id="ColumnInfo2" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>key</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src2</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object id="ColumnInfo3" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>value</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src2</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
@@ -1602,339 +1578,143 @@
       <void property="reducer"> 
        <object id="JoinOperator0" class="org.apache.hadoop.hive.ql.exec.JoinOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="SelectOperator2" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                  <void property="dirName"> 
-                   #### A masked pattern was here #### 
-                  </void> 
-                  <void property="numFiles"> 
-                   <int>1</int> 
-                  </void> 
-                  <void property="statsAggPrefix"> 
-                   #### A masked pattern was here #### 
+         <void method="add"> 
+          <object id="SelectOperator2" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                <void property="dirName"> 
+                 #### A masked pattern was here #### 
+                </void> 
+                <void property="numFiles"> 
+                 <int>1</int> 
+                </void> 
+                <void property="statsAggPrefix"> 
+                 #### A masked pattern was here #### 
+                </void> 
+                <void property="statsCollectRawDataSize"> 
+                 <boolean>true</boolean> 
+                </void> 
+                <void property="tableInfo"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                  <void property="inputFileFormatClass"> 
+                   <class>org.apache.hadoop.mapred.TextInputFormat</class> 
                   </void> 
-                  <void property="statsCollectRawDataSize"> 
-                   <boolean>true</boolean> 
+                  <void property="outputFileFormatClass"> 
+                   <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
                   </void> 
-                  <void property="tableInfo"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                    <void property="inputFileFormatClass"> 
-                     <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                  <void property="properties"> 
+                   <object class="java.util.Properties"> 
+                    <void method="put"> 
+                     <string>hive.serialization.extend.nesting.levels</string> 
+                     <string>true</string> 
                     </void> 
-                    <void property="outputFileFormatClass"> 
-                     <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                    <void method="put"> 
+                     <string>columns</string> 
+                     <string>_col0,_col1,_col2,_col3</string> 
                     </void> 
-                    <void property="properties"> 
-                     <object class="java.util.Properties"> 
-                      <void method="put"> 
-                       <string>hive.serialization.extend.nesting.levels</string> 
-                       <string>true</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>columns</string> 
-                       <string>_col0,_col1,_col2,_col3</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.lib</string> 
-                       <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.format</string> 
-                       <string>1</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>columns.types</string> 
-                       <string>string:string:string:string</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>escape.delim</string> 
-                       <string>\</string> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>serialization.lib</string> 
+                     <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
                     </void> 
-                   </object> 
-                  </void> 
-                  <void property="totalFiles"> 
-                   <int>1</int> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="operatorId"> 
-                 <string>FS_11</string> 
-                </void> 
-                <void property="parentOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object idref="SelectOperator2"/> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>serialization.format</string> 
+                     <string>1</string> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>columns.types</string> 
+                     <string>string:string:string:string</string> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col2</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col3</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>escape.delim</string> 
+                     <string>\</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="columnExprMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>_col3</string> 
-               <object id="ExprNodeColumnDesc8" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>_col3</string> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string>b</string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>_col2</string> 
-               <object id="ExprNodeColumnDesc9" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>_col2</string> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string>b</string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>_col1</string> 
-               <object id="ExprNodeColumnDesc10" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>_col1</string> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string>a</string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>_col0</string> 
-               <object id="ExprNodeColumnDesc11" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>_col0</string> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string>a</string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-              <void property="colList"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object idref="ExprNodeColumnDesc11"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeColumnDesc10"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeColumnDesc9"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeColumnDesc8"/> 
+                <void property="totalFiles"> 
+                 <int>1</int> 
                 </void> 
                </object> 
               </void> 
-              <void property="outputColumnNames"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <string>_col0</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col1</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col2</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col3</string> 
-                </void> 
-               </object> 
+              <void property="operatorId"> 
+               <string>FS_11</string> 
               </void> 
-             </object> 
-            </void> 
-            <void property="operatorId"> 
-             <string>SEL_9</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="JoinOperator0"/> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="SelectOperator2"/> 
+               </void> 
               </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>c1</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col0</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>c</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>c2</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col1</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>c</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>c3</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col2</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>c</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>c4</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col3</string> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
                   </void> 
-                  <void property="tabAlias"> 
-                   <string>c</string> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col1</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
                   </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col2</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
                   </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col3</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
                   </void> 
                  </object> 
                 </void> 
@@ -1942,9 +1722,197 @@
               </void> 
              </object> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="columnExprMap"> 
+            <object class="java.util.HashMap"> 
+             <void method="put"> 
+              <string>_col3</string> 
+              <object id="ExprNodeColumnDesc8" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>_col3</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>b</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col2</string> 
+              <object id="ExprNodeColumnDesc9" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>_col2</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>b</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col1</string> 
+              <object id="ExprNodeColumnDesc10" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>_col1</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>a</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col0</string> 
+              <object id="ExprNodeColumnDesc11" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>_col0</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>a</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+             <void property="colList"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object idref="ExprNodeColumnDesc11"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeColumnDesc10"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeColumnDesc9"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeColumnDesc8"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="outputColumnNames"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <string>_col0</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col1</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col2</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col3</string> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>SEL_9</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="JoinOperator0"/> 
+            </void> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>c1</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col0</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>c</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>c2</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col1</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>c</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>c3</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col2</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>c</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>c4</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col3</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>c</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="columnExprMap"> 
          <object class="java.util.HashMap"> 
@@ -2129,14 +2097,12 @@
          <string>JOIN_8</string> 
         </void> 
         <void property="parentOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object idref="ReduceSinkOperator0"/> 
-          </void> 
-          <void method="add"> 
-           <object idref="ReduceSinkOperator1"/> 
-          </void> 
-         </object> 
+         <void method="add"> 
+          <object idref="ReduceSinkOperator0"/> 
+         </void> 
+         <void method="add"> 
+          <object idref="ReduceSinkOperator1"/> 
+         </void> 
         </void> 
         <void property="posToAliasMap"> 
          <object class="java.util.HashMap"> 
diff --git a/ql/src/test/results/compiler/plan/join7.q.xml b/ql/src/test/results/compiler/plan/join7.q.xml
index ac41995c97..a359c9bfd9 100644
--- a/ql/src/test/results/compiler/plan/join7.q.xml
+++ b/ql/src/test/results/compiler/plan/join7.q.xml
@@ -425,478 +425,466 @@
        <string>c:a:src1</string> 
        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                <void property="childOperators"> 
-                 <object class="java.util.ArrayList"> 
+         <void method="add"> 
+          <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+              <void property="childOperators"> 
+               <void method="add"> 
+                <object id="ReduceSinkOperator0" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
+                 <void property="columnExprMap"> 
+                  <object class="java.util.HashMap"> 
+                   <void method="put"> 
+                    <string>VALUE._col1</string> 
+                    <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                     <void property="column"> 
+                      <string>_col1</string> 
+                     </void> 
+                     <void property="typeInfo"> 
+                      <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void method="put"> 
+                    <string>VALUE._col0</string> 
+                    <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                     <void property="column"> 
+                      <string>_col0</string> 
+                     </void> 
+                     <void property="typeInfo"> 
+                      <object idref="PrimitiveTypeInfo0"/> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="conf"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
+                   <void property="distinctColumnIndices"> 
+                    <object class="java.util.ArrayList"/> 
+                   </void> 
+                   <void property="keyCols"> 
+                    <object id="ArrayList0" class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <void property="column"> 
+                        <string>_col0</string> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="keySerializeInfo"> 
+                    <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                     <void property="inputFileFormatClass"> 
+                      <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                     </void> 
+                     <void property="outputFileFormatClass"> 
+                      <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                     </void> 
+                     <void property="properties"> 
+                      <object class="java.util.Properties"> 
+                       <void method="put"> 
+                        <string>columns</string> 
+                        <string>joinkey0</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.lib</string> 
+                        <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.sort.order</string> 
+                        <string>+</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns.types</string> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="numDistributionKeys"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="numReducers"> 
+                    <int>-1</int> 
+                   </void> 
+                   <void property="outputKeyColumnNames"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <string>reducesinkkey0</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="outputValueColumnNames"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <string>_col0</string> 
+                     </void> 
+                     <void method="add"> 
+                      <string>_col1</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="partitionCols"> 
+                    <object idref="ArrayList0"/> 
+                   </void> 
+                   <void property="valueCols"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object idref="ExprNodeColumnDesc1"/> 
+                     </void> 
+                     <void method="add"> 
+                      <object idref="ExprNodeColumnDesc0"/> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="valueSerializeInfo"> 
+                    <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                     <void property="inputFileFormatClass"> 
+                      <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                     </void> 
+                     <void property="outputFileFormatClass"> 
+                      <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                     </void> 
+                     <void property="properties"> 
+                      <object class="java.util.Properties"> 
+                       <void method="put"> 
+                        <string>columns</string> 
+                        <string>_col0,_col1</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.lib</string> 
+                        <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns.types</string> 
+                        <string>string,string</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>escape.delim</string> 
+                        <string>\</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="inputAlias"> 
+                  <string>a</string> 
+                 </void> 
+                 <void property="operatorId"> 
+                  <string>RS_9</string> 
+                 </void> 
+                 <void property="parentOperators"> 
                   <void method="add"> 
-                   <object id="ReduceSinkOperator0" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
-                    <void property="columnExprMap"> 
-                     <object class="java.util.HashMap"> 
-                      <void method="put"> 
-                       <string>VALUE._col1</string> 
-                       <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>_col1</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="put"> 
-                       <string>VALUE._col0</string> 
-                       <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
-                      <void property="distinctColumnIndices"> 
-                       <object class="java.util.ArrayList"/> 
-                      </void> 
-                      <void property="keyCols"> 
-                       <object id="ArrayList0" class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                          <void property="column"> 
-                           <string>_col0</string> 
-                          </void> 
-                          <void property="typeInfo"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="keySerializeInfo"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                        <void property="inputFileFormatClass"> 
-                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                        </void> 
-                        <void property="outputFileFormatClass"> 
-                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                        </void> 
-                        <void property="properties"> 
-                         <object class="java.util.Properties"> 
-                          <void method="put"> 
-                           <string>columns</string> 
-                           <string>joinkey0</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.lib</string> 
-                           <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.sort.order</string> 
-                           <string>+</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns.types</string> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="numDistributionKeys"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="numReducers"> 
-                       <int>-1</int> 
-                      </void> 
-                      <void property="outputKeyColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>reducesinkkey0</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="outputValueColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void method="add"> 
-                         <string>_col1</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="partitionCols"> 
-                       <object idref="ArrayList0"/> 
-                      </void> 
-                      <void property="valueCols"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc1"/> 
-                        </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="valueSerializeInfo"> 
-                       <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                        <void property="inputFileFormatClass"> 
-                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                        </void> 
-                        <void property="outputFileFormatClass"> 
-                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                        </void> 
-                        <void property="properties"> 
-                         <object class="java.util.Properties"> 
-                          <void method="put"> 
-                           <string>columns</string> 
-                           <string>_col0,_col1</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.lib</string> 
-                           <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns.types</string> 
-                           <string>string,string</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>escape.delim</string> 
-                           <string>\</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="inputAlias"> 
-                     <string>a</string> 
-                    </void> 
-                    <void property="operatorId"> 
-                     <string>RS_9</string> 
-                    </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="SelectOperator0"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="schema"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                      <void property="signature"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>VALUE._col0</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string>a</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>VALUE._col1</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string>a</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                   <object idref="SelectOperator0"/> 
+                  </void> 
+                 </void> 
+                 <void property="schema"> 
+                  <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                   <void property="signature"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>VALUE._col0</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string>a</string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>VALUE._col1</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string>a</string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+              </void> 
+              <void property="columnExprMap"> 
+               <object class="java.util.HashMap"> 
+                <void method="put"> 
+                 <string>_col1</string> 
+                 <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>value</string> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="columnExprMap"> 
-                 <object class="java.util.HashMap"> 
-                  <void method="put"> 
-                   <string>_col1</string> 
-                   <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>value</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>src1</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
+                  <void property="tabAlias"> 
+                   <string>src1</string> 
                   </void> 
-                  <void method="put"> 
-                   <string>_col0</string> 
-                   <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>key</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>src1</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                  <void property="colList"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc3"/> 
-                    </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc2"/> 
-                    </void> 
-                   </object> 
+                <void method="put"> 
+                 <string>_col0</string> 
+                 <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>key</string> 
                   </void> 
-                  <void property="outputColumnNames"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <string>_col0</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col1</string> 
-                    </void> 
-                   </object> 
+                  <void property="tabAlias"> 
+                   <string>src1</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="operatorId"> 
-                 <string>SEL_8</string> 
-                </void> 
-                <void property="parentOperators"> 
+               </object> 
+              </void> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                <void property="colList"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object idref="FilterOperator0"/> 
+                   <object idref="ExprNodeColumnDesc3"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object idref="ExprNodeColumnDesc2"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                <void property="outputColumnNames"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <string>_col0</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col1</string> 
                   </void> 
                  </object> 
                 </void> 
                </object> 
               </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-              <void property="predicate"> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
+              <void property="operatorId"> 
+               <string>SEL_8</string> 
+              </void> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="FilterOperator0"/> 
+               </void> 
+              </void> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src1</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>int</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="value"> 
-                         <int>10</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan"/> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                      <void property="typeName"> 
-                       <string>boolean</string> 
-                      </void> 
-                     </object> 
+                    <void property="typeName"> 
+                     <string>string</string> 
                     </void> 
                    </object> 
                   </void> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src1</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>20</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col1</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                    <void property="typeName"> 
+                     <string>string</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo2"/> 
-                </void> 
                </object> 
               </void> 
              </object> 
             </void> 
-            <void property="operatorId"> 
-             <string>FIL_16</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator0"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>key</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src1</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>value</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src1</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
+             <void property="predicate"> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                   <void property="children"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <void property="column"> 
+                        <string>key</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string>src1</string> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                       <void property="typeInfo"> 
+                        <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                         <void property="typeName"> 
+                          <string>int</string> 
+                         </void> 
+                        </object> 
+                       </void> 
+                       <void property="value"> 
+                        <int>10</int> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="genericUDF"> 
+                    <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan"/> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                     <void property="typeName"> 
+                      <string>boolean</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                   <void property="children"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <void property="column"> 
+                        <string>key</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string>src1</string> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo1"/> 
+                       </void> 
+                       <void property="value"> 
+                        <int>20</int> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="genericUDF"> 
+                    <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo2"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo2"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>FIL_16</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator0"/> 
+            </void> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>key</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src1</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>value</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src1</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
@@ -993,469 +981,457 @@
        <string>c:b:src2</string> 
        <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                <void property="childOperators"> 
-                 <object class="java.util.ArrayList"> 
+         <void method="add"> 
+          <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+              <void property="childOperators"> 
+               <void method="add"> 
+                <object id="ReduceSinkOperator1" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
+                 <void property="columnExprMap"> 
+                  <object class="java.util.HashMap"> 
+                   <void method="put"> 
+                    <string>VALUE._col1</string> 
+                    <object id="ExprNodeColumnDesc4" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                     <void property="column"> 
+                      <string>_col1</string> 
+                     </void> 
+                     <void property="typeInfo"> 
+                      <object idref="PrimitiveTypeInfo0"/> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void method="put"> 
+                    <string>VALUE._col0</string> 
+                    <object id="ExprNodeColumnDesc5" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                     <void property="column"> 
+                      <string>_col0</string> 
+                     </void> 
+                     <void property="typeInfo"> 
+                      <object idref="PrimitiveTypeInfo0"/> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="conf"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
+                   <void property="distinctColumnIndices"> 
+                    <object class="java.util.ArrayList"/> 
+                   </void> 
+                   <void property="keyCols"> 
+                    <object id="ArrayList1" class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <void property="column"> 
+                        <string>_col0</string> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="keySerializeInfo"> 
+                    <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                     <void property="inputFileFormatClass"> 
+                      <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                     </void> 
+                     <void property="outputFileFormatClass"> 
+                      <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                     </void> 
+                     <void property="properties"> 
+                      <object class="java.util.Properties"> 
+                       <void method="put"> 
+                        <string>columns</string> 
+                        <string>joinkey0</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.lib</string> 
+                        <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.sort.order</string> 
+                        <string>+</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns.types</string> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="numDistributionKeys"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="numReducers"> 
+                    <int>-1</int> 
+                   </void> 
+                   <void property="outputKeyColumnNames"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <string>reducesinkkey0</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="outputValueColumnNames"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <string>_col0</string> 
+                     </void> 
+                     <void method="add"> 
+                      <string>_col1</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="partitionCols"> 
+                    <object idref="ArrayList1"/> 
+                   </void> 
+                   <void property="tag"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="valueCols"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object idref="ExprNodeColumnDesc5"/> 
+                     </void> 
+                     <void method="add"> 
+                      <object idref="ExprNodeColumnDesc4"/> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="valueSerializeInfo"> 
+                    <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                     <void property="inputFileFormatClass"> 
+                      <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                     </void> 
+                     <void property="outputFileFormatClass"> 
+                      <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                     </void> 
+                     <void property="properties"> 
+                      <object class="java.util.Properties"> 
+                       <void method="put"> 
+                        <string>columns</string> 
+                        <string>_col0,_col1</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.lib</string> 
+                        <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns.types</string> 
+                        <string>string,string</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>escape.delim</string> 
+                        <string>\</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="inputAlias"> 
+                  <string>b</string> 
+                 </void> 
+                 <void property="operatorId"> 
+                  <string>RS_10</string> 
+                 </void> 
+                 <void property="parentOperators"> 
                   <void method="add"> 
-                   <object id="ReduceSinkOperator1" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
-                    <void property="columnExprMap"> 
-                     <object class="java.util.HashMap"> 
-                      <void method="put"> 
-                       <string>VALUE._col1</string> 
-                       <object id="ExprNodeColumnDesc4" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>_col1</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="put"> 
-                       <string>VALUE._col0</string> 
-                       <object id="ExprNodeColumnDesc5" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
-                      <void property="distinctColumnIndices"> 
-                       <object class="java.util.ArrayList"/> 
-                      </void> 
-                      <void property="keyCols"> 
-                       <object id="ArrayList1" class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                          <void property="column"> 
-                           <string>_col0</string> 
-                          </void> 
-                          <void property="typeInfo"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="keySerializeInfo"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                        <void property="inputFileFormatClass"> 
-                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                        </void> 
-                        <void property="outputFileFormatClass"> 
-                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                        </void> 
-                        <void property="properties"> 
-                         <object class="java.util.Properties"> 
-                          <void method="put"> 
-                           <string>columns</string> 
-                           <string>joinkey0</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.lib</string> 
-                           <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.sort.order</string> 
-                           <string>+</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns.types</string> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="numDistributionKeys"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="numReducers"> 
-                       <int>-1</int> 
-                      </void> 
-                      <void property="outputKeyColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>reducesinkkey0</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="outputValueColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void method="add"> 
-                         <string>_col1</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="partitionCols"> 
-                       <object idref="ArrayList1"/> 
-                      </void> 
-                      <void property="tag"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="valueCols"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc5"/> 
-                        </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc4"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="valueSerializeInfo"> 
-                       <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                        <void property="inputFileFormatClass"> 
-                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                        </void> 
-                        <void property="outputFileFormatClass"> 
-                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                        </void> 
-                        <void property="properties"> 
-                         <object class="java.util.Properties"> 
-                          <void method="put"> 
-                           <string>columns</string> 
-                           <string>_col0,_col1</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.lib</string> 
-                           <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns.types</string> 
-                           <string>string,string</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>escape.delim</string> 
-                           <string>\</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="inputAlias"> 
-                     <string>b</string> 
-                    </void> 
-                    <void property="operatorId"> 
-                     <string>RS_10</string> 
-                    </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="SelectOperator1"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="schema"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                      <void property="signature"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>VALUE._col0</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string>b</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>VALUE._col1</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string>b</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                   <object idref="SelectOperator1"/> 
+                  </void> 
+                 </void> 
+                 <void property="schema"> 
+                  <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                   <void property="signature"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>VALUE._col0</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string>b</string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>VALUE._col1</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string>b</string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+              </void> 
+              <void property="columnExprMap"> 
+               <object class="java.util.HashMap"> 
+                <void method="put"> 
+                 <string>_col1</string> 
+                 <object id="ExprNodeColumnDesc6" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>value</string> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="columnExprMap"> 
-                 <object class="java.util.HashMap"> 
-                  <void method="put"> 
-                   <string>_col1</string> 
-                   <object id="ExprNodeColumnDesc6" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>value</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>src2</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
+                  <void property="tabAlias"> 
+                   <string>src2</string> 
                   </void> 
-                  <void method="put"> 
-                   <string>_col0</string> 
-                   <object id="ExprNodeColumnDesc7" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>key</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>src2</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                  <void property="colList"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc7"/> 
-                    </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc6"/> 
-                    </void> 
-                   </object> 
+                <void method="put"> 
+                 <string>_col0</string> 
+                 <object id="ExprNodeColumnDesc7" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>key</string> 
                   </void> 
-                  <void property="outputColumnNames"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <string>_col0</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col1</string> 
-                    </void> 
-                   </object> 
+                  <void property="tabAlias"> 
+                   <string>src2</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="operatorId"> 
-                 <string>SEL_2</string> 
-                </void> 
-                <void property="parentOperators"> 
+               </object> 
+              </void> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                <void property="colList"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object idref="FilterOperator1"/> 
+                   <object idref="ExprNodeColumnDesc7"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object idref="ExprNodeColumnDesc6"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                <void property="outputColumnNames"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <string>_col0</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col1</string> 
                   </void> 
                  </object> 
                 </void> 
                </object> 
               </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-              <void property="predicate"> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
+              <void property="operatorId"> 
+               <string>SEL_2</string> 
+              </void> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="FilterOperator1"/> 
+               </void> 
+              </void> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src2</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>15</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan"/> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                    <void property="typeName"> 
+                     <string>string</string> 
                     </void> 
                    </object> 
                   </void> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src2</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>25</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col1</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                    <void property="typeName"> 
+                     <string>string</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo2"/> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="operatorId"> 
-             <string>FIL_17</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator1"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object id="ColumnInfo2" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>key</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src2</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object id="ColumnInfo3" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>value</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src2</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
                </object> 
               </void> 
              </object> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
+             <void property="predicate"> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                   <void property="children"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <void property="column"> 
+                        <string>key</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string>src2</string> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo1"/> 
+                       </void> 
+                       <void property="value"> 
+                        <int>15</int> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="genericUDF"> 
+                    <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan"/> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo2"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                   <void property="children"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <void property="column"> 
+                        <string>key</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string>src2</string> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo1"/> 
+                       </void> 
+                       <void property="value"> 
+                        <int>25</int> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="genericUDF"> 
+                    <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo2"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo2"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>FIL_17</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator1"/> 
+            </void> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object id="ColumnInfo2" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>key</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src2</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object id="ColumnInfo3" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>value</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src2</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
@@ -1548,469 +1524,457 @@
        <string>c:c:src3</string> 
        <object id="TableScanOperator2" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="FilterOperator2" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="SelectOperator2" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                <void property="childOperators"> 
-                 <object class="java.util.ArrayList"> 
+         <void method="add"> 
+          <object id="FilterOperator2" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object id="SelectOperator2" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+              <void property="childOperators"> 
+               <void method="add"> 
+                <object id="ReduceSinkOperator2" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
+                 <void property="columnExprMap"> 
+                  <object class="java.util.HashMap"> 
+                   <void method="put"> 
+                    <string>VALUE._col1</string> 
+                    <object id="ExprNodeColumnDesc8" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                     <void property="column"> 
+                      <string>_col1</string> 
+                     </void> 
+                     <void property="typeInfo"> 
+                      <object idref="PrimitiveTypeInfo0"/> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void method="put"> 
+                    <string>VALUE._col0</string> 
+                    <object id="ExprNodeColumnDesc9" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                     <void property="column"> 
+                      <string>_col0</string> 
+                     </void> 
+                     <void property="typeInfo"> 
+                      <object idref="PrimitiveTypeInfo0"/> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="conf"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
+                   <void property="distinctColumnIndices"> 
+                    <object class="java.util.ArrayList"/> 
+                   </void> 
+                   <void property="keyCols"> 
+                    <object id="ArrayList2" class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <void property="column"> 
+                        <string>_col0</string> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="keySerializeInfo"> 
+                    <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                     <void property="inputFileFormatClass"> 
+                      <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                     </void> 
+                     <void property="outputFileFormatClass"> 
+                      <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                     </void> 
+                     <void property="properties"> 
+                      <object class="java.util.Properties"> 
+                       <void method="put"> 
+                        <string>columns</string> 
+                        <string>joinkey0</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.lib</string> 
+                        <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.sort.order</string> 
+                        <string>+</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns.types</string> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="numDistributionKeys"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="numReducers"> 
+                    <int>-1</int> 
+                   </void> 
+                   <void property="outputKeyColumnNames"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <string>reducesinkkey0</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="outputValueColumnNames"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <string>_col0</string> 
+                     </void> 
+                     <void method="add"> 
+                      <string>_col1</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="partitionCols"> 
+                    <object idref="ArrayList2"/> 
+                   </void> 
+                   <void property="tag"> 
+                    <int>2</int> 
+                   </void> 
+                   <void property="valueCols"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object idref="ExprNodeColumnDesc9"/> 
+                     </void> 
+                     <void method="add"> 
+                      <object idref="ExprNodeColumnDesc8"/> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="valueSerializeInfo"> 
+                    <object id="TableDesc3" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                     <void property="inputFileFormatClass"> 
+                      <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                     </void> 
+                     <void property="outputFileFormatClass"> 
+                      <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                     </void> 
+                     <void property="properties"> 
+                      <object class="java.util.Properties"> 
+                       <void method="put"> 
+                        <string>columns</string> 
+                        <string>_col0,_col1</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.lib</string> 
+                        <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns.types</string> 
+                        <string>string,string</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>escape.delim</string> 
+                        <string>\</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="inputAlias"> 
+                  <string>c</string> 
+                 </void> 
+                 <void property="operatorId"> 
+                  <string>RS_11</string> 
+                 </void> 
+                 <void property="parentOperators"> 
                   <void method="add"> 
-                   <object id="ReduceSinkOperator2" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
-                    <void property="columnExprMap"> 
-                     <object class="java.util.HashMap"> 
-                      <void method="put"> 
-                       <string>VALUE._col1</string> 
-                       <object id="ExprNodeColumnDesc8" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>_col1</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="put"> 
-                       <string>VALUE._col0</string> 
-                       <object id="ExprNodeColumnDesc9" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
-                      <void property="distinctColumnIndices"> 
-                       <object class="java.util.ArrayList"/> 
-                      </void> 
-                      <void property="keyCols"> 
-                       <object id="ArrayList2" class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                          <void property="column"> 
-                           <string>_col0</string> 
-                          </void> 
-                          <void property="typeInfo"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="keySerializeInfo"> 
-                       <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                        <void property="inputFileFormatClass"> 
-                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                        </void> 
-                        <void property="outputFileFormatClass"> 
-                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                        </void> 
-                        <void property="properties"> 
-                         <object class="java.util.Properties"> 
-                          <void method="put"> 
-                           <string>columns</string> 
-                           <string>joinkey0</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.lib</string> 
-                           <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.sort.order</string> 
-                           <string>+</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns.types</string> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="numDistributionKeys"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="numReducers"> 
-                       <int>-1</int> 
-                      </void> 
-                      <void property="outputKeyColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>reducesinkkey0</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="outputValueColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void method="add"> 
-                         <string>_col1</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="partitionCols"> 
-                       <object idref="ArrayList2"/> 
-                      </void> 
-                      <void property="tag"> 
-                       <int>2</int> 
-                      </void> 
-                      <void property="valueCols"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc9"/> 
-                        </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc8"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="valueSerializeInfo"> 
-                       <object id="TableDesc3" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                        <void property="inputFileFormatClass"> 
-                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                        </void> 
-                        <void property="outputFileFormatClass"> 
-                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                        </void> 
-                        <void property="properties"> 
-                         <object class="java.util.Properties"> 
-                          <void method="put"> 
-                           <string>columns</string> 
-                           <string>_col0,_col1</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.lib</string> 
-                           <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns.types</string> 
-                           <string>string,string</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>escape.delim</string> 
-                           <string>\</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="inputAlias"> 
-                     <string>c</string> 
-                    </void> 
-                    <void property="operatorId"> 
-                     <string>RS_11</string> 
-                    </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="SelectOperator2"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="schema"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                      <void property="signature"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>VALUE._col0</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string>c</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>VALUE._col1</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string>c</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                   <object idref="SelectOperator2"/> 
+                  </void> 
+                 </void> 
+                 <void property="schema"> 
+                  <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                   <void property="signature"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>VALUE._col0</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string>c</string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>VALUE._col1</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string>c</string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+              </void> 
+              <void property="columnExprMap"> 
+               <object class="java.util.HashMap"> 
+                <void method="put"> 
+                 <string>_col1</string> 
+                 <object id="ExprNodeColumnDesc10" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>value</string> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="columnExprMap"> 
-                 <object class="java.util.HashMap"> 
-                  <void method="put"> 
-                   <string>_col1</string> 
-                   <object id="ExprNodeColumnDesc10" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>value</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>src3</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
+                  <void property="tabAlias"> 
+                   <string>src3</string> 
                   </void> 
-                  <void method="put"> 
-                   <string>_col0</string> 
-                   <object id="ExprNodeColumnDesc11" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>key</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>src3</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                  <void property="colList"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc11"/> 
-                    </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc10"/> 
-                    </void> 
-                   </object> 
+                <void method="put"> 
+                 <string>_col0</string> 
+                 <object id="ExprNodeColumnDesc11" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>key</string> 
                   </void> 
-                  <void property="outputColumnNames"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <string>_col0</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col1</string> 
-                    </void> 
-                   </object> 
+                  <void property="tabAlias"> 
+                   <string>src3</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="operatorId"> 
-                 <string>SEL_5</string> 
-                </void> 
-                <void property="parentOperators"> 
+               </object> 
+              </void> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                <void property="colList"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object idref="FilterOperator2"/> 
+                   <object idref="ExprNodeColumnDesc11"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object idref="ExprNodeColumnDesc10"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                <void property="outputColumnNames"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <string>_col0</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col1</string> 
                   </void> 
                  </object> 
                 </void> 
                </object> 
               </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-              <void property="predicate"> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
+              <void property="operatorId"> 
+               <string>SEL_5</string> 
+              </void> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="FilterOperator2"/> 
+               </void> 
+              </void> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src3</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>20</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan"/> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                    <void property="typeName"> 
+                     <string>string</string> 
                     </void> 
                    </object> 
                   </void> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src3</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>25</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col1</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                    <void property="typeName"> 
+                     <string>string</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo2"/> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="operatorId"> 
-             <string>FIL_18</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator2"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object id="ColumnInfo4" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>key</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src3</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object id="ColumnInfo5" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>value</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src3</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
                </object> 
               </void> 
              </object> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
+             <void property="predicate"> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                   <void property="children"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <void property="column"> 
+                        <string>key</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string>src3</string> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo1"/> 
+                       </void> 
+                       <void property="value"> 
+                        <int>20</int> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="genericUDF"> 
+                    <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan"/> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo2"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                   <void property="children"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <void property="column"> 
+                        <string>key</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string>src3</string> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo1"/> 
+                       </void> 
+                       <void property="value"> 
+                        <int>25</int> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="genericUDF"> 
+                    <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo2"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo2"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>FIL_18</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator2"/> 
+            </void> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object id="ColumnInfo4" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>key</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src3</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object id="ColumnInfo5" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>value</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src3</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
@@ -2296,449 +2260,175 @@
       <void property="reducer"> 
        <object id="JoinOperator0" class="org.apache.hadoop.hive.ql.exec.JoinOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="SelectOperator3" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                  <void property="dirName"> 
-                   #### A masked pattern was here #### 
-                  </void> 
-                  <void property="numFiles"> 
-                   <int>1</int> 
-                  </void> 
-                  <void property="statsAggPrefix"> 
-                   #### A masked pattern was here #### 
-                  </void> 
-                  <void property="statsCollectRawDataSize"> 
-                   <boolean>true</boolean> 
-                  </void> 
-                  <void property="tableInfo"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                    <void property="inputFileFormatClass"> 
-                     <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-                    </void> 
-                    <void property="outputFileFormatClass"> 
-                     <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-                    </void> 
-                    <void property="properties"> 
-                     <object class="java.util.Properties"> 
-                      <void method="put"> 
-                       <string>hive.serialization.extend.nesting.levels</string> 
-                       <string>true</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>columns</string> 
-                       <string>_col0,_col1,_col2,_col3,_col4,_col5</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.lib</string> 
-                       <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.format</string> 
-                       <string>1</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>columns.types</string> 
-                       <string>string:string:string:string:string:string</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>escape.delim</string> 
-                       <string>\</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void property="totalFiles"> 
-                   <int>1</int> 
-                  </void> 
-                 </object> 
+         <void method="add"> 
+          <object id="SelectOperator3" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                <void property="dirName"> 
+                 #### A masked pattern was here #### 
                 </void> 
-                <void property="operatorId"> 
-                 <string>FS_15</string> 
+                <void property="numFiles"> 
+                 <int>1</int> 
                 </void> 
-                <void property="parentOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object idref="SelectOperator3"/> 
-                  </void> 
-                 </object> 
+                <void property="statsAggPrefix"> 
+                 #### A masked pattern was here #### 
+                </void> 
+                <void property="statsCollectRawDataSize"> 
+                 <boolean>true</boolean> 
                 </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
+                <void property="tableInfo"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                  <void property="inputFileFormatClass"> 
+                   <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                  </void> 
+                  <void property="outputFileFormatClass"> 
+                   <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                  </void> 
+                  <void property="properties"> 
+                   <object class="java.util.Properties"> 
+                    <void method="put"> 
+                     <string>hive.serialization.extend.nesting.levels</string> 
+                     <string>true</string> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>columns</string> 
+                     <string>_col0,_col1,_col2,_col3,_col4,_col5</string> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col2</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>serialization.lib</string> 
+                     <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col3</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>serialization.format</string> 
+                     <string>1</string> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col4</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>columns.types</string> 
+                     <string>string:string:string:string:string:string</string> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col5</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>escape.delim</string> 
+                     <string>\</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="columnExprMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>_col5</string> 
-               <object id="ExprNodeColumnDesc12" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>_col5</string> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string>c</string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>_col4</string> 
-               <object id="ExprNodeColumnDesc13" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>_col4</string> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string>c</string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>_col3</string> 
-               <object id="ExprNodeColumnDesc14" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>_col3</string> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string>b</string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>_col2</string> 
-               <object id="ExprNodeColumnDesc15" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>_col2</string> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string>b</string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>_col1</string> 
-               <object id="ExprNodeColumnDesc16" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>_col1</string> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string>a</string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>_col0</string> 
-               <object id="ExprNodeColumnDesc17" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>_col0</string> 
-                </void> 
-                <void property="tabAlias"> 
-                 <string>a</string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-              <void property="colList"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object idref="ExprNodeColumnDesc17"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeColumnDesc16"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeColumnDesc15"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeColumnDesc14"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeColumnDesc13"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeColumnDesc12"/> 
+                <void property="totalFiles"> 
+                 <int>1</int> 
                 </void> 
                </object> 
               </void> 
-              <void property="outputColumnNames"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <string>_col0</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col1</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col2</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col3</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col4</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col5</string> 
-                </void> 
-               </object> 
+              <void property="operatorId"> 
+               <string>FS_15</string> 
               </void> 
-             </object> 
-            </void> 
-            <void property="operatorId"> 
-             <string>SEL_13</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="JoinOperator0"/> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="SelectOperator3"/> 
+               </void> 
               </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>c1</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col0</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>c</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>c2</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col1</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>c</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>c3</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col2</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>c</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>c4</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col3</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>c</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>c5</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col4</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>c</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
                   </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>c6</string> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col1</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
                   </void> 
-                  <void property="internalName"> 
-                   <string>_col5</string> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col2</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
                   </void> 
-                  <void property="tabAlias"> 
-                   <string>c</string> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col3</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
                   </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col4</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
                   </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col5</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
                   </void> 
                  </object> 
                 </void> 
@@ -2746,9 +2436,275 @@
               </void> 
              </object> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="columnExprMap"> 
+            <object class="java.util.HashMap"> 
+             <void method="put"> 
+              <string>_col5</string> 
+              <object id="ExprNodeColumnDesc12" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>_col5</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>c</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col4</string> 
+              <object id="ExprNodeColumnDesc13" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>_col4</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>c</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col3</string> 
+              <object id="ExprNodeColumnDesc14" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>_col3</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>b</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col2</string> 
+              <object id="ExprNodeColumnDesc15" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>_col2</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>b</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col1</string> 
+              <object id="ExprNodeColumnDesc16" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>_col1</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>a</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col0</string> 
+              <object id="ExprNodeColumnDesc17" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+               <void property="column"> 
+                <string>_col0</string> 
+               </void> 
+               <void property="tabAlias"> 
+                <string>a</string> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+             <void property="colList"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object idref="ExprNodeColumnDesc17"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeColumnDesc16"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeColumnDesc15"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeColumnDesc14"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeColumnDesc13"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeColumnDesc12"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="outputColumnNames"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <string>_col0</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col1</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col2</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col3</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col4</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col5</string> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>SEL_13</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="JoinOperator0"/> 
+            </void> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>c1</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col0</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>c</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>c2</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col1</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>c</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>c3</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col2</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>c</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>c4</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col3</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>c</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>c5</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col4</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>c</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>c6</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col5</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>c</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="columnExprMap"> 
          <object class="java.util.HashMap"> 
@@ -3006,17 +2962,15 @@
          <string>JOIN_12</string> 
         </void> 
         <void property="parentOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object idref="ReduceSinkOperator0"/> 
-          </void> 
-          <void method="add"> 
-           <object idref="ReduceSinkOperator1"/> 
-          </void> 
-          <void method="add"> 
-           <object idref="ReduceSinkOperator2"/> 
-          </void> 
-         </object> 
+         <void method="add"> 
+          <object idref="ReduceSinkOperator0"/> 
+         </void> 
+         <void method="add"> 
+          <object idref="ReduceSinkOperator1"/> 
+         </void> 
+         <void method="add"> 
+          <object idref="ReduceSinkOperator2"/> 
+         </void> 
         </void> 
         <void property="posToAliasMap"> 
          <object class="java.util.HashMap"> 
diff --git a/ql/src/test/results/compiler/plan/join8.q.xml b/ql/src/test/results/compiler/plan/join8.q.xml
index 569cf6e4c4..8afceb0947 100644
--- a/ql/src/test/results/compiler/plan/join8.q.xml
+++ b/ql/src/test/results/compiler/plan/join8.q.xml
@@ -289,519 +289,507 @@
        <string>c:a:src1</string> 
        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                <void property="childOperators"> 
-                 <object class="java.util.ArrayList"> 
+         <void method="add"> 
+          <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+              <void property="childOperators"> 
+               <void method="add"> 
+                <object id="ReduceSinkOperator0" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
+                 <void property="columnExprMap"> 
+                  <object class="java.util.HashMap"> 
+                   <void method="put"> 
+                    <string>VALUE._col1</string> 
+                    <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                     <void property="column"> 
+                      <string>_col1</string> 
+                     </void> 
+                     <void property="typeInfo"> 
+                      <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void method="put"> 
+                    <string>VALUE._col0</string> 
+                    <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                     <void property="column"> 
+                      <string>_col0</string> 
+                     </void> 
+                     <void property="typeInfo"> 
+                      <object idref="PrimitiveTypeInfo0"/> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="conf"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
+                   <void property="distinctColumnIndices"> 
+                    <object class="java.util.ArrayList"/> 
+                   </void> 
+                   <void property="keyCols"> 
+                    <object id="ArrayList0" class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <void property="column"> 
+                        <string>_col0</string> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="keySerializeInfo"> 
+                    <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                     <void property="inputFileFormatClass"> 
+                      <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                     </void> 
+                     <void property="outputFileFormatClass"> 
+                      <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                     </void> 
+                     <void property="properties"> 
+                      <object class="java.util.Properties"> 
+                       <void method="put"> 
+                        <string>columns</string> 
+                        <string>joinkey0</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.lib</string> 
+                        <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.sort.order</string> 
+                        <string>+</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns.types</string> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="numDistributionKeys"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="numReducers"> 
+                    <int>-1</int> 
+                   </void> 
+                   <void property="outputKeyColumnNames"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <string>reducesinkkey0</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="outputValueColumnNames"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <string>_col0</string> 
+                     </void> 
+                     <void method="add"> 
+                      <string>_col1</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="partitionCols"> 
+                    <object idref="ArrayList0"/> 
+                   </void> 
+                   <void property="valueCols"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object idref="ExprNodeColumnDesc1"/> 
+                     </void> 
+                     <void method="add"> 
+                      <object idref="ExprNodeColumnDesc0"/> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="valueSerializeInfo"> 
+                    <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                     <void property="inputFileFormatClass"> 
+                      <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                     </void> 
+                     <void property="outputFileFormatClass"> 
+                      <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                     </void> 
+                     <void property="properties"> 
+                      <object class="java.util.Properties"> 
+                       <void method="put"> 
+                        <string>columns</string> 
+                        <string>_col0,_col1</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.lib</string> 
+                        <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns.types</string> 
+                        <string>string,string</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>escape.delim</string> 
+                        <string>\</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="inputAlias"> 
+                  <string>a</string> 
+                 </void> 
+                 <void property="operatorId"> 
+                  <string>RS_6</string> 
+                 </void> 
+                 <void property="parentOperators"> 
                   <void method="add"> 
-                   <object id="ReduceSinkOperator0" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
-                    <void property="columnExprMap"> 
-                     <object class="java.util.HashMap"> 
-                      <void method="put"> 
-                       <string>VALUE._col1</string> 
-                       <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>_col1</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="put"> 
-                       <string>VALUE._col0</string> 
-                       <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
-                      <void property="distinctColumnIndices"> 
-                       <object class="java.util.ArrayList"/> 
-                      </void> 
-                      <void property="keyCols"> 
-                       <object id="ArrayList0" class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                          <void property="column"> 
-                           <string>_col0</string> 
-                          </void> 
-                          <void property="typeInfo"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="keySerializeInfo"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                        <void property="inputFileFormatClass"> 
-                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                        </void> 
-                        <void property="outputFileFormatClass"> 
-                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                        </void> 
-                        <void property="properties"> 
-                         <object class="java.util.Properties"> 
-                          <void method="put"> 
-                           <string>columns</string> 
-                           <string>joinkey0</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.lib</string> 
-                           <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.sort.order</string> 
-                           <string>+</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns.types</string> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="numDistributionKeys"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="numReducers"> 
-                       <int>-1</int> 
-                      </void> 
-                      <void property="outputKeyColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>reducesinkkey0</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="outputValueColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void method="add"> 
-                         <string>_col1</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="partitionCols"> 
-                       <object idref="ArrayList0"/> 
-                      </void> 
-                      <void property="valueCols"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc1"/> 
-                        </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="valueSerializeInfo"> 
-                       <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                        <void property="inputFileFormatClass"> 
-                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                        </void> 
-                        <void property="outputFileFormatClass"> 
-                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                        </void> 
-                        <void property="properties"> 
-                         <object class="java.util.Properties"> 
-                          <void method="put"> 
-                           <string>columns</string> 
-                           <string>_col0,_col1</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.lib</string> 
-                           <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns.types</string> 
-                           <string>string,string</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>escape.delim</string> 
-                           <string>\</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="inputAlias"> 
-                     <string>a</string> 
-                    </void> 
-                    <void property="operatorId"> 
-                     <string>RS_6</string> 
-                    </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="SelectOperator0"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="schema"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                      <void property="signature"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>VALUE._col0</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string>a</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>VALUE._col1</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string>a</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                   <object idref="SelectOperator0"/> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="columnExprMap"> 
-                 <object class="java.util.HashMap"> 
-                  <void method="put"> 
-                   <string>_col1</string> 
-                   <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>value</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>src1</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
+                 </void> 
+                 <void property="schema"> 
+                  <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                   <void property="signature"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>VALUE._col0</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string>a</string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>VALUE._col1</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string>a</string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+              </void> 
+              <void property="columnExprMap"> 
+               <object class="java.util.HashMap"> 
+                <void method="put"> 
+                 <string>_col1</string> 
+                 <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>value</string> 
                   </void> 
-                  <void method="put"> 
-                   <string>_col0</string> 
-                   <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>key</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>src1</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
+                  <void property="tabAlias"> 
+                   <string>src1</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                  <void property="colList"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc3"/> 
-                    </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc2"/> 
-                    </void> 
-                   </object> 
+                <void method="put"> 
+                 <string>_col0</string> 
+                 <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>key</string> 
                   </void> 
-                  <void property="outputColumnNames"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <string>_col0</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col1</string> 
-                    </void> 
-                   </object> 
+                  <void property="tabAlias"> 
+                   <string>src1</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="operatorId"> 
-                 <string>SEL_5</string> 
-                </void> 
-                <void property="parentOperators"> 
+               </object> 
+              </void> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                <void property="colList"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object idref="FilterOperator0"/> 
+                   <object idref="ExprNodeColumnDesc3"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object idref="ExprNodeColumnDesc2"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                <void property="outputColumnNames"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <string>_col0</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col1</string> 
                   </void> 
                  </object> 
                 </void> 
                </object> 
               </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-              <void property="predicate"> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
+              <void property="operatorId"> 
+               <string>SEL_5</string> 
+              </void> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="FilterOperator0"/> 
+               </void> 
+              </void> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="children"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>key</string> 
-                            </void> 
-                            <void property="tabAlias"> 
-                             <string>src1</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                              <void property="typeName"> 
-                               <string>int</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="value"> 
-                             <int>10</int> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan"/> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>boolean</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="children"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>key</string> 
-                            </void> 
-                            <void property="tabAlias"> 
-                             <string>src1</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <int>20</int> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo2"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd"/> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                    <void property="typeName"> 
+                     <string>string</string> 
                     </void> 
                    </object> 
                   </void> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src1</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col1</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPNotNull"/> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                    <void property="typeName"> 
+                     <string>string</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo2"/> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="operatorId"> 
-             <string>FIL_14</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator0"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>key</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src1</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>value</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src1</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
                </object> 
               </void> 
              </object> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
+             <void property="predicate"> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                   <void property="children"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                       <void property="children"> 
+                        <object class="java.util.ArrayList"> 
+                         <void method="add"> 
+                          <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                           <void property="column"> 
+                            <string>key</string> 
+                           </void> 
+                           <void property="tabAlias"> 
+                            <string>src1</string> 
+                           </void> 
+                           <void property="typeInfo"> 
+                            <object idref="PrimitiveTypeInfo0"/> 
+                           </void> 
+                          </object> 
+                         </void> 
+                         <void method="add"> 
+                          <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                           <void property="typeInfo"> 
+                            <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                             <void property="typeName"> 
+                              <string>int</string> 
+                             </void> 
+                            </object> 
+                           </void> 
+                           <void property="value"> 
+                            <int>10</int> 
+                           </void> 
+                          </object> 
+                         </void> 
+                        </object> 
+                       </void> 
+                       <void property="genericUDF"> 
+                        <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan"/> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                         <void property="typeName"> 
+                          <string>boolean</string> 
+                         </void> 
+                        </object> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                       <void property="children"> 
+                        <object class="java.util.ArrayList"> 
+                         <void method="add"> 
+                          <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                           <void property="column"> 
+                            <string>key</string> 
+                           </void> 
+                           <void property="tabAlias"> 
+                            <string>src1</string> 
+                           </void> 
+                           <void property="typeInfo"> 
+                            <object idref="PrimitiveTypeInfo0"/> 
+                           </void> 
+                          </object> 
+                         </void> 
+                         <void method="add"> 
+                          <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                           <void property="typeInfo"> 
+                            <object idref="PrimitiveTypeInfo1"/> 
+                           </void> 
+                           <void property="value"> 
+                            <int>20</int> 
+                           </void> 
+                          </object> 
+                         </void> 
+                        </object> 
+                       </void> 
+                       <void property="genericUDF"> 
+                        <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo2"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="genericUDF"> 
+                    <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd"/> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo2"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                   <void property="children"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <void property="column"> 
+                        <string>key</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string>src1</string> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="genericUDF"> 
+                    <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPNotNull"/> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo2"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo2"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>FIL_14</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator0"/> 
+            </void> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>key</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src1</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>value</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src1</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
@@ -898,510 +886,498 @@
        <string>c:b:src2</string> 
        <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                <void property="childOperators"> 
-                 <object class="java.util.ArrayList"> 
+         <void method="add"> 
+          <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+              <void property="childOperators"> 
+               <void method="add"> 
+                <object id="ReduceSinkOperator1" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
+                 <void property="columnExprMap"> 
+                  <object class="java.util.HashMap"> 
+                   <void method="put"> 
+                    <string>VALUE._col1</string> 
+                    <object id="ExprNodeColumnDesc4" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                     <void property="column"> 
+                      <string>_col1</string> 
+                     </void> 
+                     <void property="typeInfo"> 
+                      <object idref="PrimitiveTypeInfo0"/> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void method="put"> 
+                    <string>VALUE._col0</string> 
+                    <object id="ExprNodeColumnDesc5" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                     <void property="column"> 
+                      <string>_col0</string> 
+                     </void> 
+                     <void property="typeInfo"> 
+                      <object idref="PrimitiveTypeInfo0"/> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="conf"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
+                   <void property="distinctColumnIndices"> 
+                    <object class="java.util.ArrayList"/> 
+                   </void> 
+                   <void property="keyCols"> 
+                    <object id="ArrayList1" class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <void property="column"> 
+                        <string>_col0</string> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="keySerializeInfo"> 
+                    <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                     <void property="inputFileFormatClass"> 
+                      <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                     </void> 
+                     <void property="outputFileFormatClass"> 
+                      <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                     </void> 
+                     <void property="properties"> 
+                      <object class="java.util.Properties"> 
+                       <void method="put"> 
+                        <string>columns</string> 
+                        <string>joinkey0</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.lib</string> 
+                        <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.sort.order</string> 
+                        <string>+</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns.types</string> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="numDistributionKeys"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="numReducers"> 
+                    <int>-1</int> 
+                   </void> 
+                   <void property="outputKeyColumnNames"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <string>reducesinkkey0</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="outputValueColumnNames"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <string>_col0</string> 
+                     </void> 
+                     <void method="add"> 
+                      <string>_col1</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="partitionCols"> 
+                    <object idref="ArrayList1"/> 
+                   </void> 
+                   <void property="tag"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="valueCols"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object idref="ExprNodeColumnDesc5"/> 
+                     </void> 
+                     <void method="add"> 
+                      <object idref="ExprNodeColumnDesc4"/> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="valueSerializeInfo"> 
+                    <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                     <void property="inputFileFormatClass"> 
+                      <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                     </void> 
+                     <void property="outputFileFormatClass"> 
+                      <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                     </void> 
+                     <void property="properties"> 
+                      <object class="java.util.Properties"> 
+                       <void method="put"> 
+                        <string>columns</string> 
+                        <string>_col0,_col1</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.lib</string> 
+                        <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns.types</string> 
+                        <string>string,string</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>escape.delim</string> 
+                        <string>\</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="inputAlias"> 
+                  <string>b</string> 
+                 </void> 
+                 <void property="operatorId"> 
+                  <string>RS_7</string> 
+                 </void> 
+                 <void property="parentOperators"> 
                   <void method="add"> 
-                   <object id="ReduceSinkOperator1" class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
-                    <void property="columnExprMap"> 
-                     <object class="java.util.HashMap"> 
-                      <void method="put"> 
-                       <string>VALUE._col1</string> 
-                       <object id="ExprNodeColumnDesc4" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>_col1</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="put"> 
-                       <string>VALUE._col0</string> 
-                       <object id="ExprNodeColumnDesc5" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.ReduceSinkDesc"> 
-                      <void property="distinctColumnIndices"> 
-                       <object class="java.util.ArrayList"/> 
-                      </void> 
-                      <void property="keyCols"> 
-                       <object id="ArrayList1" class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                          <void property="column"> 
-                           <string>_col0</string> 
-                          </void> 
-                          <void property="typeInfo"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="keySerializeInfo"> 
-                       <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                        <void property="inputFileFormatClass"> 
-                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                        </void> 
-                        <void property="outputFileFormatClass"> 
-                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                        </void> 
-                        <void property="properties"> 
-                         <object class="java.util.Properties"> 
-                          <void method="put"> 
-                           <string>columns</string> 
-                           <string>joinkey0</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.lib</string> 
-                           <string>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.sort.order</string> 
-                           <string>+</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns.types</string> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="numDistributionKeys"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="numReducers"> 
-                       <int>-1</int> 
-                      </void> 
-                      <void property="outputKeyColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>reducesinkkey0</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="outputValueColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void method="add"> 
-                         <string>_col1</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="partitionCols"> 
-                       <object idref="ArrayList1"/> 
-                      </void> 
-                      <void property="tag"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="valueCols"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc5"/> 
-                        </void> 
-                        <void method="add"> 
-                         <object idref="ExprNodeColumnDesc4"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="valueSerializeInfo"> 
-                       <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                        <void property="inputFileFormatClass"> 
-                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                        </void> 
-                        <void property="outputFileFormatClass"> 
-                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                        </void> 
-                        <void property="properties"> 
-                         <object class="java.util.Properties"> 
-                          <void method="put"> 
-                           <string>columns</string> 
-                           <string>_col0,_col1</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.lib</string> 
-                           <string>org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns.types</string> 
-                           <string>string,string</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>escape.delim</string> 
-                           <string>\</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="inputAlias"> 
-                     <string>b</string> 
-                    </void> 
-                    <void property="operatorId"> 
-                     <string>RS_7</string> 
-                    </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="SelectOperator1"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="schema"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                      <void property="signature"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>VALUE._col0</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string>b</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>VALUE._col1</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string>b</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                   <object idref="SelectOperator1"/> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="columnExprMap"> 
-                 <object class="java.util.HashMap"> 
-                  <void method="put"> 
-                   <string>_col1</string> 
-                   <object id="ExprNodeColumnDesc6" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>value</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>src2</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
+                 </void> 
+                 <void property="schema"> 
+                  <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                   <void property="signature"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>VALUE._col0</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string>b</string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>VALUE._col1</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string>b</string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+              </void> 
+              <void property="columnExprMap"> 
+               <object class="java.util.HashMap"> 
+                <void method="put"> 
+                 <string>_col1</string> 
+                 <object id="ExprNodeColumnDesc6" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>value</string> 
                   </void> 
-                  <void method="put"> 
-                   <string>_col0</string> 
-                   <object id="ExprNodeColumnDesc7" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>key</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>src2</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
+                  <void property="tabAlias"> 
+                   <string>src2</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                  <void property="colList"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc7"/> 
-                    </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc6"/> 
-                    </void> 
-                   </object> 
+                <void method="put"> 
+                 <string>_col0</string> 
+                 <object id="ExprNodeColumnDesc7" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>key</string> 
                   </void> 
-                  <void property="outputColumnNames"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <string>_col0</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col1</string> 
-                    </void> 
-                   </object> 
+                  <void property="tabAlias"> 
+                   <string>src2</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="operatorId"> 
-                 <string>SEL_2</string> 
-                </void> 
-                <void property="parentOperators"> 
+               </object> 
+              </void> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                <void property="colList"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object idref="FilterOperator1"/> 
+                   <object idref="ExprNodeColumnDesc7"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object idref="ExprNodeColumnDesc6"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                <void property="outputColumnNames"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <string>_col0</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col1</string> 
                   </void> 
                  </object> 
                 </void> 
                </object> 
               </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-              <void property="predicate"> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
+              <void property="operatorId"> 
+               <string>SEL_2</string> 
+              </void> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="FilterOperator1"/> 
+               </void> 
+              </void> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="children"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>key</string> 
-                            </void> 
-                            <void property="tabAlias"> 
-                             <string>src2</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <int>15</int> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan"/> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo2"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="children"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>key</string> 
-                            </void> 
-                            <void property="tabAlias"> 
-                             <string>src2</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <int>25</int> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo2"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd"/> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                    <void property="typeName"> 
+                     <string>string</string> 
                     </void> 
                    </object> 
                   </void> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>src2</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col1</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPNotNull"/> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                    <void property="typeName"> 
+                     <string>string</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo2"/> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="operatorId"> 
-             <string>FIL_15</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator1"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object id="ColumnInfo2" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>key</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src2</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object id="ColumnInfo3" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>value</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src2</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
                </object> 
               </void> 
              </object> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
+             <void property="predicate"> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                   <void property="children"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                       <void property="children"> 
+                        <object class="java.util.ArrayList"> 
+                         <void method="add"> 
+                          <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                           <void property="column"> 
+                            <string>key</string> 
+                           </void> 
+                           <void property="tabAlias"> 
+                            <string>src2</string> 
+                           </void> 
+                           <void property="typeInfo"> 
+                            <object idref="PrimitiveTypeInfo0"/> 
+                           </void> 
+                          </object> 
+                         </void> 
+                         <void method="add"> 
+                          <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                           <void property="typeInfo"> 
+                            <object idref="PrimitiveTypeInfo1"/> 
+                           </void> 
+                           <void property="value"> 
+                            <int>15</int> 
+                           </void> 
+                          </object> 
+                         </void> 
+                        </object> 
+                       </void> 
+                       <void property="genericUDF"> 
+                        <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan"/> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo2"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                       <void property="children"> 
+                        <object class="java.util.ArrayList"> 
+                         <void method="add"> 
+                          <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                           <void property="column"> 
+                            <string>key</string> 
+                           </void> 
+                           <void property="tabAlias"> 
+                            <string>src2</string> 
+                           </void> 
+                           <void property="typeInfo"> 
+                            <object idref="PrimitiveTypeInfo0"/> 
+                           </void> 
+                          </object> 
+                         </void> 
+                         <void method="add"> 
+                          <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                           <void property="typeInfo"> 
+                            <object idref="PrimitiveTypeInfo1"/> 
+                           </void> 
+                           <void property="value"> 
+                            <int>25</int> 
+                           </void> 
+                          </object> 
+                         </void> 
+                        </object> 
+                       </void> 
+                       <void property="genericUDF"> 
+                        <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo2"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="genericUDF"> 
+                    <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd"/> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo2"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                   <void property="children"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <void property="column"> 
+                        <string>key</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string>src2</string> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="genericUDF"> 
+                    <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPNotNull"/> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo2"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo2"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>FIL_15</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator1"/> 
+            </void> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object id="ColumnInfo2" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>key</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src2</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object id="ColumnInfo3" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>value</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src2</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
@@ -1684,450 +1660,337 @@
       <void property="reducer"> 
        <object id="JoinOperator0" class="org.apache.hadoop.hive.ql.exec.JoinOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="FilterOperator2" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="SelectOperator2" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                <void property="childOperators"> 
-                 <object class="java.util.ArrayList"> 
+         <void method="add"> 
+          <object id="FilterOperator2" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object id="SelectOperator2" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+              <void property="childOperators"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                 <void property="conf"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                   <void property="dirName"> 
+                    #### A masked pattern was here #### 
+                   </void> 
+                   <void property="numFiles"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="statsAggPrefix"> 
+                    #### A masked pattern was here #### 
+                   </void> 
+                   <void property="statsCollectRawDataSize"> 
+                    <boolean>true</boolean> 
+                   </void> 
+                   <void property="tableInfo"> 
+                    <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                     <void property="inputFileFormatClass"> 
+                      <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                     </void> 
+                     <void property="outputFileFormatClass"> 
+                      <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                     </void> 
+                     <void property="properties"> 
+                      <object class="java.util.Properties"> 
+                       <void method="put"> 
+                        <string>hive.serialization.extend.nesting.levels</string> 
+                        <string>true</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns</string> 
+                        <string>_col0,_col1,_col2,_col3</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.lib</string> 
+                        <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.format</string> 
+                        <string>1</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns.types</string> 
+                        <string>string:string:string:string</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>escape.delim</string> 
+                        <string>\</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="totalFiles"> 
+                    <int>1</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="operatorId"> 
+                  <string>FS_12</string> 
+                 </void> 
+                 <void property="parentOperators"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                      <void property="dirName"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="numFiles"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="statsAggPrefix"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="statsCollectRawDataSize"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="tableInfo"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                        <void property="inputFileFormatClass"> 
-                         <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-                        </void> 
-                        <void property="outputFileFormatClass"> 
-                         <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-                        </void> 
-                        <void property="properties"> 
-                         <object class="java.util.Properties"> 
-                          <void method="put"> 
-                           <string>hive.serialization.extend.nesting.levels</string> 
-                           <string>true</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns</string> 
-                           <string>_col0,_col1,_col2,_col3</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.lib</string> 
-                           <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.format</string> 
-                           <string>1</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns.types</string> 
-                           <string>string:string:string:string</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>escape.delim</string> 
-                           <string>\</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="totalFiles"> 
-                       <int>1</int> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="operatorId"> 
-                     <string>FS_12</string> 
-                    </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="SelectOperator2"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="schema"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                      <void property="signature"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col0</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string></string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col1</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string></string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col2</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string></string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col3</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string></string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                   <object idref="SelectOperator2"/> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="columnExprMap"> 
-                 <object class="java.util.HashMap"> 
-                  <void method="put"> 
+                 </void> 
+                 <void property="schema"> 
+                  <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                   <void property="signature"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>_col0</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string></string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>_col1</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string></string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>_col2</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string></string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>_col3</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string></string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+              </void> 
+              <void property="columnExprMap"> 
+               <object class="java.util.HashMap"> 
+                <void method="put"> 
+                 <string>_col3</string> 
+                 <object id="ExprNodeColumnDesc8" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
                    <string>_col3</string> 
-                   <object id="ExprNodeColumnDesc8" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>_col3</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>b</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
                   </void> 
-                  <void method="put"> 
-                   <string>_col2</string> 
-                   <object id="ExprNodeColumnDesc9" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>_col2</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>b</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void method="put"> 
-                   <string>_col1</string> 
-                   <object id="ExprNodeColumnDesc10" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>_col1</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>a</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
+                  <void property="tabAlias"> 
+                   <string>b</string> 
                   </void> 
-                  <void method="put"> 
-                   <string>_col0</string> 
-                   <object id="ExprNodeColumnDesc11" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>_col0</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>a</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                  <void property="colList"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc11"/> 
-                    </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc10"/> 
-                    </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc9"/> 
-                    </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc8"/> 
-                    </void> 
-                   </object> 
+                <void method="put"> 
+                 <string>_col2</string> 
+                 <object id="ExprNodeColumnDesc9" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>_col2</string> 
                   </void> 
-                  <void property="outputColumnNames"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <string>_col0</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col1</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col2</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col3</string> 
-                    </void> 
-                   </object> 
+                  <void property="tabAlias"> 
+                   <string>b</string> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="operatorId"> 
-                 <string>SEL_9</string> 
-                </void> 
-                <void property="parentOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object idref="FilterOperator2"/> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="alias"> 
-                       <string>c1</string> 
-                      </void> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>c</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="alias"> 
-                       <string>c2</string> 
-                      </void> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>c</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="alias"> 
-                       <string>c3</string> 
-                      </void> 
-                      <void property="internalName"> 
-                       <string>_col2</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>c</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="alias"> 
-                       <string>c4</string> 
-                      </void> 
-                      <void property="internalName"> 
-                       <string>_col3</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>c</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                <void method="put"> 
+                 <string>_col1</string> 
+                 <object id="ExprNodeColumnDesc10" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>_col1</string> 
                   </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-              <void property="predicate"> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object idref="ExprNodeColumnDesc9"/> 
+                  <void property="tabAlias"> 
+                   <string>a</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPNull"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo2"/> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="operatorId"> 
-             <string>FIL_13</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="JoinOperator0"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object id="ColumnInfo4" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
+                <void method="put"> 
+                 <string>_col0</string> 
+                 <object id="ExprNodeColumnDesc11" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
                    <string>_col0</string> 
                   </void> 
                   <void property="tabAlias"> 
                    <string>a</string> 
                   </void> 
-                  <void property="type"> 
+                  <void property="typeInfo"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
                  </object> 
                 </void> 
-                <void method="add"> 
-                 <object id="ColumnInfo5" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>_col1</string> 
+               </object> 
+              </void> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                <void property="colList"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object idref="ExprNodeColumnDesc11"/> 
                   </void> 
-                  <void property="tabAlias"> 
-                   <string>a</string> 
+                  <void method="add"> 
+                   <object idref="ExprNodeColumnDesc10"/> 
                   </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
+                  <void method="add"> 
+                   <object idref="ExprNodeColumnDesc9"/> 
                   </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
+                  <void method="add"> 
+                   <object idref="ExprNodeColumnDesc8"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void method="add"> 
-                 <object id="ColumnInfo6" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>_col2</string> 
+                <void property="outputColumnNames"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <string>_col0</string> 
                   </void> 
-                  <void property="tabAlias"> 
-                   <string>b</string> 
+                  <void method="add"> 
+                   <string>_col1</string> 
                   </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
+                  <void method="add"> 
+                   <string>_col2</string> 
                   </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
+                  <void method="add"> 
+                   <string>_col3</string> 
                   </void> 
                  </object> 
                 </void> 
-                <void method="add"> 
-                 <object id="ColumnInfo7" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>_col3</string> 
+               </object> 
+              </void> 
+              <void property="operatorId"> 
+               <string>SEL_9</string> 
+              </void> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="FilterOperator2"/> 
+               </void> 
+              </void> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="alias"> 
+                     <string>c1</string> 
+                    </void> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string>c</string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
                   </void> 
-                  <void property="tabAlias"> 
-                   <string>b</string> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="alias"> 
+                     <string>c2</string> 
+                    </void> 
+                    <void property="internalName"> 
+                     <string>_col1</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string>c</string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
                   </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="alias"> 
+                     <string>c3</string> 
+                    </void> 
+                    <void property="internalName"> 
+                     <string>_col2</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string>c</string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
                   </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="alias"> 
+                     <string>c4</string> 
+                    </void> 
+                    <void property="internalName"> 
+                     <string>_col3</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string>c</string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
                   </void> 
                  </object> 
                 </void> 
@@ -2135,9 +1998,110 @@
               </void> 
              </object> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
+             <void property="predicate"> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object idref="ExprNodeColumnDesc9"/> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPNull"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo2"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>FIL_13</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="JoinOperator0"/> 
+            </void> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object id="ColumnInfo4" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>_col0</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>a</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object id="ColumnInfo5" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>_col1</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>a</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object id="ColumnInfo6" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>_col2</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>b</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object id="ColumnInfo7" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>_col3</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>b</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="columnExprMap"> 
          <object class="java.util.HashMap"> 
@@ -2319,14 +2283,12 @@
          <string>JOIN_8</string> 
         </void> 
         <void property="parentOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object idref="ReduceSinkOperator0"/> 
-          </void> 
-          <void method="add"> 
-           <object idref="ReduceSinkOperator1"/> 
-          </void> 
-         </object> 
+         <void method="add"> 
+          <object idref="ReduceSinkOperator0"/> 
+         </void> 
+         <void method="add"> 
+          <object idref="ReduceSinkOperator1"/> 
+         </void> 
         </void> 
         <void property="posToAliasMap"> 
          <object class="java.util.HashMap"> 
diff --git a/ql/src/test/results/compiler/plan/sample1.q.xml b/ql/src/test/results/compiler/plan/sample1.q.xml
index 57b109cb08..84940659b7 100644
--- a/ql/src/test/results/compiler/plan/sample1.q.xml
+++ b/ql/src/test/results/compiler/plan/sample1.q.xml
@@ -174,577 +174,350 @@
        <string>s</string> 
        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                <void property="childOperators"> 
-                 <object class="java.util.ArrayList"> 
+         <void method="add"> 
+          <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+              <void property="childOperators"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                 <void property="conf"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                   <void property="dirName"> 
+                    #### A masked pattern was here #### 
+                   </void> 
+                   <void property="numFiles"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="statsAggPrefix"> 
+                    #### A masked pattern was here #### 
+                   </void> 
+                   <void property="statsCollectRawDataSize"> 
+                    <boolean>true</boolean> 
+                   </void> 
+                   <void property="tableInfo"> 
+                    <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                     <void property="inputFileFormatClass"> 
+                      <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                     </void> 
+                     <void property="outputFileFormatClass"> 
+                      <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                     </void> 
+                     <void property="properties"> 
+                      <object class="java.util.Properties"> 
+                       <void method="put"> 
+                        <string>hive.serialization.extend.nesting.levels</string> 
+                        <string>true</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns</string> 
+                        <string>_col0,_col1,_col2,_col3</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.lib</string> 
+                        <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.format</string> 
+                        <string>1</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns.types</string> 
+                        <string>string:string:string:string</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>escape.delim</string> 
+                        <string>\</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="totalFiles"> 
+                    <int>1</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="operatorId"> 
+                  <string>FS_4</string> 
+                 </void> 
+                 <void property="parentOperators"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                      <void property="dirName"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="numFiles"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="statsAggPrefix"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="statsCollectRawDataSize"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="tableInfo"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                        <void property="inputFileFormatClass"> 
-                         <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-                        </void> 
-                        <void property="outputFileFormatClass"> 
-                         <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-                        </void> 
-                        <void property="properties"> 
-                         <object class="java.util.Properties"> 
-                          <void method="put"> 
-                           <string>hive.serialization.extend.nesting.levels</string> 
-                           <string>true</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns</string> 
-                           <string>_col0,_col1,_col2,_col3</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.lib</string> 
-                           <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.format</string> 
-                           <string>1</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns.types</string> 
-                           <string>string:string:string:string</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>escape.delim</string> 
-                           <string>\</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="totalFiles"> 
-                       <int>1</int> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="operatorId"> 
-                     <string>FS_4</string> 
-                    </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="SelectOperator0"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="schema"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                      <void property="signature"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col0</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string></string> 
-                          </void> 
-                          <void property="type"> 
-                           <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                            <void property="typeName"> 
-                             <string>string</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col1</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string></string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col2</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string></string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col3</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string></string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                   <object idref="SelectOperator0"/> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="columnExprMap"> 
-                 <object class="java.util.HashMap"> 
-                  <void method="put"> 
-                   <string>_col3</string> 
-                   <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>hr</string> 
-                    </void> 
-                    <void property="isPartitionColOrVirtualCol"> 
-                     <boolean>true</boolean> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>s</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
+                 </void> 
+                 <void property="schema"> 
+                  <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                   <void property="signature"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>_col0</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string></string> 
+                       </void> 
+                       <void property="type"> 
+                        <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                         <void property="typeName"> 
+                          <string>string</string> 
+                         </void> 
+                        </object> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>_col1</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string></string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>_col2</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string></string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>_col3</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string></string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+              </void> 
+              <void property="columnExprMap"> 
+               <object class="java.util.HashMap"> 
+                <void method="put"> 
+                 <string>_col3</string> 
+                 <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>hr</string> 
                   </void> 
-                  <void method="put"> 
-                   <string>_col2</string> 
-                   <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>ds</string> 
-                    </void> 
-                    <void property="isPartitionColOrVirtualCol"> 
-                     <boolean>true</boolean> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>s</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
+                  <void property="isPartitionColOrVirtualCol"> 
+                   <boolean>true</boolean> 
                   </void> 
-                  <void method="put"> 
-                   <string>_col1</string> 
-                   <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>value</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>s</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
+                  <void property="tabAlias"> 
+                   <string>s</string> 
                   </void> 
-                  <void method="put"> 
-                   <string>_col0</string> 
-                   <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>key</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>s</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                  <void property="colList"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc3"/> 
-                    </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc2"/> 
-                    </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc1"/> 
-                    </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc0"/> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void property="outputColumnNames"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <string>_col0</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col1</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col2</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col3</string> 
-                    </void> 
-                   </object> 
+                <void method="put"> 
+                 <string>_col2</string> 
+                 <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>ds</string> 
                   </void> 
-                  <void property="selectStar"> 
+                  <void property="isPartitionColOrVirtualCol"> 
                    <boolean>true</boolean> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="operatorId"> 
-                 <string>SEL_3</string> 
-                </void> 
-                <void property="parentOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object idref="FilterOperator0"/> 
+                  <void property="tabAlias"> 
+                   <string>s</string> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="alias"> 
-                       <string>key</string> 
-                      </void> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>s</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="alias"> 
-                       <string>value</string> 
-                      </void> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>s</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="alias"> 
-                       <string>ds</string> 
-                      </void> 
-                      <void property="internalName"> 
-                       <string>_col2</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>s</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="alias"> 
-                       <string>hr</string> 
-                      </void> 
-                      <void property="internalName"> 
-                       <string>_col3</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>s</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-              <void property="isSamplingPred"> 
-               <boolean>true</boolean> 
-              </void> 
-              <void property="predicate"> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="children"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                            <void property="children"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                                <void property="children"> 
-                                 <object class="java.util.ArrayList"/> 
-                                </void> 
-                                <void property="genericUDF"> 
-                                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                                  <void property="udfClassName"> 
-                                   <string>org.apache.hadoop.hive.ql.udf.UDFRand</string> 
-                                  </void> 
-                                  <void property="udfName"> 
-                                   <string>rand</string> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void property="typeInfo"> 
-                                 <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                                  <void property="typeName"> 
-                                   <string>double</string> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="genericUDF"> 
-                             <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFHash"/> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                              <void property="typeName"> 
-                               <string>int</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <int>2147483647</int> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                          <void property="operator"> 
-                           <boolean>true</boolean> 
-                          </void> 
-                          <void property="udfClassName"> 
-                           <string>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</string> 
-                          </void> 
-                          <void property="udfName"> 
-                           <string>&amp;</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>1</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPMod"/> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
-                    </void> 
-                   </object> 
+                <void method="put"> 
+                 <string>_col1</string> 
+                 <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>value</string> 
                   </void> 
-                  <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
-                    </void> 
-                    <void property="value"> 
-                     <int>0</int> 
-                    </void> 
-                   </object> 
+                  <void property="tabAlias"> 
+                   <string>s</string> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                  <void property="typeName"> 
-                   <string>boolean</string> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="operatorId"> 
-             <string>FIL_1</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator0"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
+                <void method="put"> 
+                 <string>_col0</string> 
+                 <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
                    <string>key</string> 
                   </void> 
                   <void property="tabAlias"> 
                    <string>s</string> 
                   </void> 
-                  <void property="type"> 
+                  <void property="typeInfo"> 
                    <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
                  </object> 
                 </void> 
-                <void method="add"> 
-                 <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>value</string> 
+               </object> 
+              </void> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                <void property="colList"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object idref="ExprNodeColumnDesc3"/> 
                   </void> 
-                  <void property="tabAlias"> 
-                   <string>s</string> 
+                  <void method="add"> 
+                   <object idref="ExprNodeColumnDesc2"/> 
                   </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
+                  <void method="add"> 
+                   <object idref="ExprNodeColumnDesc1"/> 
                   </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
+                  <void method="add"> 
+                   <object idref="ExprNodeColumnDesc0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void method="add"> 
-                 <object id="ColumnInfo2" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>ds</string> 
+                <void property="outputColumnNames"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <string>_col0</string> 
                   </void> 
-                  <void property="tabAlias"> 
-                   <string>s</string> 
+                  <void method="add"> 
+                   <string>_col1</string> 
                   </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
+                  <void method="add"> 
+                   <string>_col2</string> 
                   </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
+                  <void method="add"> 
+                   <string>_col3</string> 
                   </void> 
                  </object> 
                 </void> 
-                <void method="add"> 
-                 <object id="ColumnInfo3" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>hr</string> 
+                <void property="selectStar"> 
+                 <boolean>true</boolean> 
+                </void> 
+               </object> 
+              </void> 
+              <void property="operatorId"> 
+               <string>SEL_3</string> 
+              </void> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="FilterOperator0"/> 
+               </void> 
+              </void> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="alias"> 
+                     <string>key</string> 
+                    </void> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string>s</string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
                   </void> 
-                  <void property="tabAlias"> 
-                   <string>s</string> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="alias"> 
+                     <string>value</string> 
+                    </void> 
+                    <void property="internalName"> 
+                     <string>_col1</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string>s</string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
                   </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="alias"> 
+                     <string>ds</string> 
+                    </void> 
+                    <void property="internalName"> 
+                     <string>_col2</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string>s</string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
                   </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="alias"> 
+                     <string>hr</string> 
+                    </void> 
+                    <void property="internalName"> 
+                     <string>_col3</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string>s</string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
                   </void> 
                  </object> 
                 </void> 
@@ -752,9 +525,224 @@
               </void> 
              </object> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
+             <void property="isSamplingPred"> 
+              <boolean>true</boolean> 
+             </void> 
+             <void property="predicate"> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                   <void property="children"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                       <void property="children"> 
+                        <object class="java.util.ArrayList"> 
+                         <void method="add"> 
+                          <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                           <void property="children"> 
+                            <object class="java.util.ArrayList"> 
+                             <void method="add"> 
+                              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                               <void property="children"> 
+                                <object class="java.util.ArrayList"/> 
+                               </void> 
+                               <void property="genericUDF"> 
+                                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                                 <void property="udfClassName"> 
+                                  <string>org.apache.hadoop.hive.ql.udf.UDFRand</string> 
+                                 </void> 
+                                 <void property="udfName"> 
+                                  <string>rand</string> 
+                                 </void> 
+                                </object> 
+                               </void> 
+                               <void property="typeInfo"> 
+                                <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                                 <void property="typeName"> 
+                                  <string>double</string> 
+                                 </void> 
+                                </object> 
+                               </void> 
+                              </object> 
+                             </void> 
+                            </object> 
+                           </void> 
+                           <void property="genericUDF"> 
+                            <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFHash"/> 
+                           </void> 
+                           <void property="typeInfo"> 
+                            <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                             <void property="typeName"> 
+                              <string>int</string> 
+                             </void> 
+                            </object> 
+                           </void> 
+                          </object> 
+                         </void> 
+                         <void method="add"> 
+                          <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                           <void property="typeInfo"> 
+                            <object idref="PrimitiveTypeInfo1"/> 
+                           </void> 
+                           <void property="value"> 
+                            <int>2147483647</int> 
+                           </void> 
+                          </object> 
+                         </void> 
+                        </object> 
+                       </void> 
+                       <void property="genericUDF"> 
+                        <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                         <void property="operator"> 
+                          <boolean>true</boolean> 
+                         </void> 
+                         <void property="udfClassName"> 
+                          <string>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</string> 
+                         </void> 
+                         <void property="udfName"> 
+                          <string>&amp;</string> 
+                         </void> 
+                        </object> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo1"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo1"/> 
+                       </void> 
+                       <void property="value"> 
+                        <int>1</int> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="genericUDF"> 
+                    <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPMod"/> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo1"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo1"/> 
+                   </void> 
+                   <void property="value"> 
+                    <int>0</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                 <void property="typeName"> 
+                  <string>boolean</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>FIL_1</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator0"/> 
+            </void> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>key</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>s</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>value</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>s</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object id="ColumnInfo2" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>ds</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>s</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object id="ColumnInfo3" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>hr</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>s</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
diff --git a/ql/src/test/results/compiler/plan/sample2.q.xml b/ql/src/test/results/compiler/plan/sample2.q.xml
index 85a0e4d2d4..6ebc3e4ce2 100644
--- a/ql/src/test/results/compiler/plan/sample2.q.xml
+++ b/ql/src/test/results/compiler/plan/sample2.q.xml
@@ -79,137 +79,133 @@
                        #### A masked pattern was here #### 
                        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                         <void property="childOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                            <void property="conf"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                              <void property="dirName"> 
-                               #### A masked pattern was here #### 
-                              </void> 
-                              <void property="numFiles"> 
-                               <int>1</int> 
-                              </void> 
-                              <void property="tableInfo"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                                <void property="inputFileFormatClass"> 
-                                 <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-                                </void> 
-                                <void property="outputFileFormatClass"> 
-                                 <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-                                </void> 
-                                <void property="properties"> 
-                                 <object class="java.util.Properties"> 
-                                  <void method="put"> 
-                                   <string>name</string> 
-                                   <string>default.dest1</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>columns.types</string> 
-                                   <string>string:string</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.ddl</string> 
-                                   <string>struct dest1 { string key, string value}</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.format</string> 
-                                   <string>1</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>columns</string> 
-                                   <string>key,value</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>bucket_count</string> 
-                                   <string>-1</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.lib</string> 
-                                   <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>file.inputformat</string> 
-                                   <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>location</string> 
-                                   #### A masked pattern was here #### 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>file.outputformat</string> 
-                                   <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>transient_lastDdlTime</string> 
-                                   #### A masked pattern was here #### 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void property="totalFiles"> 
-                               <int>1</int> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="operatorId"> 
-                             <string>FS_5</string> 
+                         <void method="add"> 
+                          <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                           <void property="conf"> 
+                            <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                             <void property="dirName"> 
+                              #### A masked pattern was here #### 
+                             </void> 
+                             <void property="numFiles"> 
+                              <int>1</int> 
+                             </void> 
+                             <void property="tableInfo"> 
+                              <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                               <void property="inputFileFormatClass"> 
+                                <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                               </void> 
+                               <void property="outputFileFormatClass"> 
+                                <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                               </void> 
+                               <void property="properties"> 
+                                <object class="java.util.Properties"> 
+                                 <void method="put"> 
+                                  <string>name</string> 
+                                  <string>default.dest1</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>columns.types</string> 
+                                  <string>string:string</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.ddl</string> 
+                                  <string>struct dest1 { string key, string value}</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.format</string> 
+                                  <string>1</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>columns</string> 
+                                  <string>key,value</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>bucket_count</string> 
+                                  <string>-1</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.lib</string> 
+                                  <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>file.inputformat</string> 
+                                  <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>location</string> 
+                                  #### A masked pattern was here #### 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>file.outputformat</string> 
+                                  <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>transient_lastDdlTime</string> 
+                                  #### A masked pattern was here #### 
+                                 </void> 
+                                </object> 
+                               </void> 
+                              </object> 
+                             </void> 
+                             <void property="totalFiles"> 
+                              <int>1</int> 
+                             </void> 
+                            </object> 
+                           </void> 
+                           <void property="operatorId"> 
+                            <string>FS_5</string> 
+                           </void> 
+                           <void property="parentOperators"> 
+                            <void method="add"> 
+                             <object idref="TableScanOperator0"/> 
                             </void> 
-                            <void property="parentOperators"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object idref="TableScanOperator0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="schema"> 
-                             <object id="RowSchema0" class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                              <void property="signature"> 
-                               <object class="java.util.ArrayList"> 
-                                <void method="add"> 
-                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                  <void property="internalName"> 
-                                   <string>key</string> 
-                                  </void> 
-                                  <void property="tabAlias"> 
-                                   <string></string> 
-                                  </void> 
-                                  <void property="type"> 
-                                   <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                                    <void property="typeName"> 
-                                     <string>string</string> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                  <void property="typeName"> 
-                                   <string>string</string> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void method="add"> 
-                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                  <void property="internalName"> 
-                                   <string>value</string> 
-                                  </void> 
-                                  <void property="tabAlias"> 
-                                   <string></string> 
-                                  </void> 
-                                  <void property="type"> 
-                                   <object idref="PrimitiveTypeInfo0"/> 
-                                  </void> 
-                                  <void property="typeName"> 
-                                   <string>string</string> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
+                           </void> 
+                           <void property="schema"> 
+                            <object id="RowSchema0" class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                             <void property="signature"> 
+                              <object class="java.util.ArrayList"> 
+                               <void method="add"> 
+                                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                 <void property="internalName"> 
+                                  <string>key</string> 
+                                 </void> 
+                                 <void property="tabAlias"> 
+                                  <string></string> 
+                                 </void> 
+                                 <void property="type"> 
+                                  <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                                   <void property="typeName"> 
+                                    <string>string</string> 
+                                   </void> 
+                                  </object> 
+                                 </void> 
+                                 <void property="typeName"> 
+                                  <string>string</string> 
+                                 </void> 
+                                </object> 
+                               </void> 
+                               <void method="add"> 
+                                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                 <void property="internalName"> 
+                                  <string>value</string> 
+                                 </void> 
+                                 <void property="tabAlias"> 
+                                  <string></string> 
+                                 </void> 
+                                 <void property="type"> 
+                                  <object idref="PrimitiveTypeInfo0"/> 
+                                 </void> 
+                                 <void property="typeName"> 
+                                  <string>string</string> 
+                                 </void> 
+                                </object> 
+                               </void> 
+                              </object> 
+                             </void> 
+                            </object> 
+                           </void> 
+                          </object> 
+                         </void> 
                         </void> 
                         <void property="conf"> 
                          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"/> 
@@ -646,361 +642,349 @@
        <string>s</string> 
        <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                <void property="childOperators"> 
-                 <object class="java.util.ArrayList"> 
+         <void method="add"> 
+          <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+              <void property="childOperators"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                 <void property="conf"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                   <void property="destTableId"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="dirName"> 
+                    #### A masked pattern was here #### 
+                   </void> 
+                   <void property="gatherStats"> 
+                    <boolean>true</boolean> 
+                   </void> 
+                   <void property="lbCtx"> 
+                    <object idref="ListBucketingCtx0"/> 
+                   </void> 
+                   <void property="maxStatsKeyPrefixLength"> 
+                    <int>150</int> 
+                   </void> 
+                   <void property="numFiles"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="statsAggPrefix"> 
+                    #### A masked pattern was here #### 
+                   </void> 
+                   <void property="statsCollectRawDataSize"> 
+                    <boolean>true</boolean> 
+                   </void> 
+                   <void property="tableInfo"> 
+                    <object idref="TableDesc0"/> 
+                   </void> 
+                   <void property="totalFiles"> 
+                    <int>1</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="operatorId"> 
+                  <string>FS_3</string> 
+                 </void> 
+                 <void property="parentOperators"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                      <void property="destTableId"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="dirName"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="gatherStats"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="lbCtx"> 
-                       <object idref="ListBucketingCtx0"/> 
-                      </void> 
-                      <void property="maxStatsKeyPrefixLength"> 
-                       <int>150</int> 
-                      </void> 
-                      <void property="numFiles"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="statsAggPrefix"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="statsCollectRawDataSize"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="tableInfo"> 
-                       <object idref="TableDesc0"/> 
-                      </void> 
-                      <void property="totalFiles"> 
-                       <int>1</int> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="operatorId"> 
-                     <string>FS_3</string> 
-                    </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="SelectOperator0"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="schema"> 
-                     <object idref="RowSchema0"/> 
-                    </void> 
-                   </object> 
+                   <object idref="SelectOperator0"/> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="columnExprMap"> 
-                 <object class="java.util.HashMap"> 
-                  <void method="put"> 
-                   <string>_col1</string> 
-                   <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>value</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>s</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
+                 </void> 
+                 <void property="schema"> 
+                  <object idref="RowSchema0"/> 
+                 </void> 
+                </object> 
+               </void> 
+              </void> 
+              <void property="columnExprMap"> 
+               <object class="java.util.HashMap"> 
+                <void method="put"> 
+                 <string>_col1</string> 
+                 <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>value</string> 
                   </void> 
-                  <void method="put"> 
-                   <string>_col0</string> 
-                   <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>key</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>s</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                      <void property="typeName"> 
-                       <string>int</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                  <void property="tabAlias"> 
+                   <string>s</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                  <void property="colList"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc1"/> 
-                    </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc0"/> 
-                    </void> 
-                   </object> 
+                <void method="put"> 
+                 <string>_col0</string> 
+                 <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>key</string> 
                   </void> 
-                  <void property="outputColumnNames"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <string>_col0</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col1</string> 
+                  <void property="tabAlias"> 
+                   <string>s</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                    <void property="typeName"> 
+                     <string>int</string> 
                     </void> 
                    </object> 
                   </void> 
-                  <void property="selectStar"> 
-                   <boolean>true</boolean> 
-                  </void> 
                  </object> 
                 </void> 
-                <void property="operatorId"> 
-                 <string>SEL_2</string> 
-                </void> 
-                <void property="parentOperators"> 
+               </object> 
+              </void> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                <void property="colList"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object idref="FilterOperator0"/> 
+                   <object idref="ExprNodeColumnDesc1"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object idref="ExprNodeColumnDesc0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>s</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo1"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>int</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>s</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                <void property="outputColumnNames"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <string>_col0</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col1</string> 
                   </void> 
                  </object> 
                 </void> 
+                <void property="selectStar"> 
+                 <boolean>true</boolean> 
+                </void> 
                </object> 
               </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-              <void property="isSamplingPred"> 
-               <boolean>true</boolean> 
+              <void property="operatorId"> 
+               <string>SEL_2</string> 
               </void> 
-              <void property="predicate"> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="FilterOperator0"/> 
+               </void> 
+              </void> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="children"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                            <void property="children"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                                <void property="column"> 
-                                 <string>key</string> 
-                                </void> 
-                                <void property="tabAlias"> 
-                                 <string>s</string> 
-                                </void> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo1"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="genericUDF"> 
-                             <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFHash"/> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <int>2147483647</int> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                          <void property="operator"> 
-                           <boolean>true</boolean> 
-                          </void> 
-                          <void property="udfClassName"> 
-                           <string>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</string> 
-                          </void> 
-                          <void property="udfName"> 
-                           <string>&amp;</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>2</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPMod"/> 
+                    <void property="tabAlias"> 
+                     <string>s</string> 
                     </void> 
-                    <void property="typeInfo"> 
+                    <void property="type"> 
                      <object idref="PrimitiveTypeInfo1"/> 
                     </void> 
+                    <void property="typeName"> 
+                     <string>int</string> 
+                    </void> 
                    </object> 
                   </void> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col1</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string>s</string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                    <void property="value"> 
-                     <int>0</int> 
+                    <void property="typeName"> 
+                     <string>string</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                  <void property="typeName"> 
-                   <string>boolean</string> 
-                  </void> 
-                 </object> 
-                </void> 
                </object> 
               </void> 
-              <void property="sampleDescr"> 
-               <object class="org.apache.hadoop.hive.ql.plan.FilterDesc$sampleDesc"/> 
-              </void> 
              </object> 
             </void> 
-            <void property="operatorId"> 
-             <string>FIL_1</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator1"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>key</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>s</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo1"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>int</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>value</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>s</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
+             <void property="isSamplingPred"> 
+              <boolean>true</boolean> 
+             </void> 
+             <void property="predicate"> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                   <void property="children"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                       <void property="children"> 
+                        <object class="java.util.ArrayList"> 
+                         <void method="add"> 
+                          <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                           <void property="children"> 
+                            <object class="java.util.ArrayList"> 
+                             <void method="add"> 
+                              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                               <void property="column"> 
+                                <string>key</string> 
+                               </void> 
+                               <void property="tabAlias"> 
+                                <string>s</string> 
+                               </void> 
+                               <void property="typeInfo"> 
+                                <object idref="PrimitiveTypeInfo1"/> 
+                               </void> 
+                              </object> 
+                             </void> 
+                            </object> 
+                           </void> 
+                           <void property="genericUDF"> 
+                            <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFHash"/> 
+                           </void> 
+                           <void property="typeInfo"> 
+                            <object idref="PrimitiveTypeInfo1"/> 
+                           </void> 
+                          </object> 
+                         </void> 
+                         <void method="add"> 
+                          <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                           <void property="typeInfo"> 
+                            <object idref="PrimitiveTypeInfo1"/> 
+                           </void> 
+                           <void property="value"> 
+                            <int>2147483647</int> 
+                           </void> 
+                          </object> 
+                         </void> 
+                        </object> 
+                       </void> 
+                       <void property="genericUDF"> 
+                        <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                         <void property="operator"> 
+                          <boolean>true</boolean> 
+                         </void> 
+                         <void property="udfClassName"> 
+                          <string>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</string> 
+                         </void> 
+                         <void property="udfName"> 
+                          <string>&amp;</string> 
+                         </void> 
+                        </object> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo1"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo1"/> 
+                       </void> 
+                       <void property="value"> 
+                        <int>2</int> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="genericUDF"> 
+                    <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPMod"/> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo1"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo1"/> 
+                   </void> 
+                   <void property="value"> 
+                    <int>0</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                 <void property="typeName"> 
+                  <string>boolean</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="sampleDescr"> 
+              <object class="org.apache.hadoop.hive.ql.plan.FilterDesc$sampleDesc"/> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>FIL_1</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator1"/> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>key</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>s</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo1"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>int</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>value</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>s</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
diff --git a/ql/src/test/results/compiler/plan/sample3.q.xml b/ql/src/test/results/compiler/plan/sample3.q.xml
index abf392e6fe..09e391e94d 100644
--- a/ql/src/test/results/compiler/plan/sample3.q.xml
+++ b/ql/src/test/results/compiler/plan/sample3.q.xml
@@ -79,137 +79,133 @@
                        #### A masked pattern was here #### 
                        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                         <void property="childOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                            <void property="conf"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                              <void property="dirName"> 
-                               #### A masked pattern was here #### 
-                              </void> 
-                              <void property="numFiles"> 
-                               <int>1</int> 
-                              </void> 
-                              <void property="tableInfo"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                                <void property="inputFileFormatClass"> 
-                                 <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-                                </void> 
-                                <void property="outputFileFormatClass"> 
-                                 <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-                                </void> 
-                                <void property="properties"> 
-                                 <object class="java.util.Properties"> 
-                                  <void method="put"> 
-                                   <string>name</string> 
-                                   <string>default.dest1</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>columns.types</string> 
-                                   <string>string:string</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.ddl</string> 
-                                   <string>struct dest1 { string key, string value}</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.format</string> 
-                                   <string>1</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>columns</string> 
-                                   <string>key,value</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>bucket_count</string> 
-                                   <string>-1</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.lib</string> 
-                                   <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>file.inputformat</string> 
-                                   <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>location</string> 
-                                   #### A masked pattern was here #### 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>file.outputformat</string> 
-                                   <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>transient_lastDdlTime</string> 
-                                   #### A masked pattern was here #### 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void property="totalFiles"> 
-                               <int>1</int> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="operatorId"> 
-                             <string>FS_5</string> 
+                         <void method="add"> 
+                          <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                           <void property="conf"> 
+                            <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                             <void property="dirName"> 
+                              #### A masked pattern was here #### 
+                             </void> 
+                             <void property="numFiles"> 
+                              <int>1</int> 
+                             </void> 
+                             <void property="tableInfo"> 
+                              <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                               <void property="inputFileFormatClass"> 
+                                <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                               </void> 
+                               <void property="outputFileFormatClass"> 
+                                <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                               </void> 
+                               <void property="properties"> 
+                                <object class="java.util.Properties"> 
+                                 <void method="put"> 
+                                  <string>name</string> 
+                                  <string>default.dest1</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>columns.types</string> 
+                                  <string>string:string</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.ddl</string> 
+                                  <string>struct dest1 { string key, string value}</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.format</string> 
+                                  <string>1</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>columns</string> 
+                                  <string>key,value</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>bucket_count</string> 
+                                  <string>-1</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.lib</string> 
+                                  <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>file.inputformat</string> 
+                                  <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>location</string> 
+                                  #### A masked pattern was here #### 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>file.outputformat</string> 
+                                  <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>transient_lastDdlTime</string> 
+                                  #### A masked pattern was here #### 
+                                 </void> 
+                                </object> 
+                               </void> 
+                              </object> 
+                             </void> 
+                             <void property="totalFiles"> 
+                              <int>1</int> 
+                             </void> 
+                            </object> 
+                           </void> 
+                           <void property="operatorId"> 
+                            <string>FS_5</string> 
+                           </void> 
+                           <void property="parentOperators"> 
+                            <void method="add"> 
+                             <object idref="TableScanOperator0"/> 
                             </void> 
-                            <void property="parentOperators"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object idref="TableScanOperator0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="schema"> 
-                             <object id="RowSchema0" class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                              <void property="signature"> 
-                               <object class="java.util.ArrayList"> 
-                                <void method="add"> 
-                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                  <void property="internalName"> 
-                                   <string>key</string> 
-                                  </void> 
-                                  <void property="tabAlias"> 
-                                   <string></string> 
-                                  </void> 
-                                  <void property="type"> 
-                                   <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                                    <void property="typeName"> 
-                                     <string>string</string> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                  <void property="typeName"> 
-                                   <string>string</string> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void method="add"> 
-                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                  <void property="internalName"> 
-                                   <string>value</string> 
-                                  </void> 
-                                  <void property="tabAlias"> 
-                                   <string></string> 
-                                  </void> 
-                                  <void property="type"> 
-                                   <object idref="PrimitiveTypeInfo0"/> 
-                                  </void> 
-                                  <void property="typeName"> 
-                                   <string>string</string> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
+                           </void> 
+                           <void property="schema"> 
+                            <object id="RowSchema0" class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                             <void property="signature"> 
+                              <object class="java.util.ArrayList"> 
+                               <void method="add"> 
+                                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                 <void property="internalName"> 
+                                  <string>key</string> 
+                                 </void> 
+                                 <void property="tabAlias"> 
+                                  <string></string> 
+                                 </void> 
+                                 <void property="type"> 
+                                  <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                                   <void property="typeName"> 
+                                    <string>string</string> 
+                                   </void> 
+                                  </object> 
+                                 </void> 
+                                 <void property="typeName"> 
+                                  <string>string</string> 
+                                 </void> 
+                                </object> 
+                               </void> 
+                               <void method="add"> 
+                                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                 <void property="internalName"> 
+                                  <string>value</string> 
+                                 </void> 
+                                 <void property="tabAlias"> 
+                                  <string></string> 
+                                 </void> 
+                                 <void property="type"> 
+                                  <object idref="PrimitiveTypeInfo0"/> 
+                                 </void> 
+                                 <void property="typeName"> 
+                                  <string>string</string> 
+                                 </void> 
+                                </object> 
+                               </void> 
+                              </object> 
+                             </void> 
+                            </object> 
+                           </void> 
+                          </object> 
+                         </void> 
                         </void> 
                         <void property="conf"> 
                          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"/> 
@@ -646,371 +642,359 @@
        <string>s</string> 
        <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                <void property="childOperators"> 
-                 <object class="java.util.ArrayList"> 
+         <void method="add"> 
+          <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+              <void property="childOperators"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                 <void property="conf"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                   <void property="destTableId"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="dirName"> 
+                    #### A masked pattern was here #### 
+                   </void> 
+                   <void property="gatherStats"> 
+                    <boolean>true</boolean> 
+                   </void> 
+                   <void property="lbCtx"> 
+                    <object idref="ListBucketingCtx0"/> 
+                   </void> 
+                   <void property="maxStatsKeyPrefixLength"> 
+                    <int>150</int> 
+                   </void> 
+                   <void property="numFiles"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="statsAggPrefix"> 
+                    #### A masked pattern was here #### 
+                   </void> 
+                   <void property="statsCollectRawDataSize"> 
+                    <boolean>true</boolean> 
+                   </void> 
+                   <void property="tableInfo"> 
+                    <object idref="TableDesc0"/> 
+                   </void> 
+                   <void property="totalFiles"> 
+                    <int>1</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="operatorId"> 
+                  <string>FS_3</string> 
+                 </void> 
+                 <void property="parentOperators"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                      <void property="destTableId"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="dirName"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="gatherStats"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="lbCtx"> 
-                       <object idref="ListBucketingCtx0"/> 
-                      </void> 
-                      <void property="maxStatsKeyPrefixLength"> 
-                       <int>150</int> 
-                      </void> 
-                      <void property="numFiles"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="statsAggPrefix"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="statsCollectRawDataSize"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="tableInfo"> 
-                       <object idref="TableDesc0"/> 
-                      </void> 
-                      <void property="totalFiles"> 
-                       <int>1</int> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="operatorId"> 
-                     <string>FS_3</string> 
-                    </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="SelectOperator0"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="schema"> 
-                     <object idref="RowSchema0"/> 
-                    </void> 
-                   </object> 
+                   <object idref="SelectOperator0"/> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="columnExprMap"> 
-                 <object class="java.util.HashMap"> 
-                  <void method="put"> 
-                   <string>_col1</string> 
-                   <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>value</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>s</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
+                 </void> 
+                 <void property="schema"> 
+                  <object idref="RowSchema0"/> 
+                 </void> 
+                </object> 
+               </void> 
+              </void> 
+              <void property="columnExprMap"> 
+               <object class="java.util.HashMap"> 
+                <void method="put"> 
+                 <string>_col1</string> 
+                 <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>value</string> 
                   </void> 
-                  <void method="put"> 
-                   <string>_col0</string> 
-                   <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>key</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>s</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                      <void property="typeName"> 
-                       <string>int</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                  <void property="tabAlias"> 
+                   <string>s</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                  <void property="colList"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc1"/> 
-                    </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc0"/> 
-                    </void> 
-                   </object> 
+                <void method="put"> 
+                 <string>_col0</string> 
+                 <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>key</string> 
                   </void> 
-                  <void property="outputColumnNames"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <string>_col0</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col1</string> 
+                  <void property="tabAlias"> 
+                   <string>s</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                    <void property="typeName"> 
+                     <string>int</string> 
                     </void> 
                    </object> 
                   </void> 
-                  <void property="selectStar"> 
-                   <boolean>true</boolean> 
-                  </void> 
                  </object> 
                 </void> 
-                <void property="operatorId"> 
-                 <string>SEL_2</string> 
-                </void> 
-                <void property="parentOperators"> 
+               </object> 
+              </void> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                <void property="colList"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object idref="FilterOperator0"/> 
+                   <object idref="ExprNodeColumnDesc1"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object idref="ExprNodeColumnDesc0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>s</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo1"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>int</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>s</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                <void property="outputColumnNames"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <string>_col0</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col1</string> 
                   </void> 
                  </object> 
                 </void> 
+                <void property="selectStar"> 
+                 <boolean>true</boolean> 
+                </void> 
                </object> 
               </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-              <void property="isSamplingPred"> 
-               <boolean>true</boolean> 
+              <void property="operatorId"> 
+               <string>SEL_2</string> 
               </void> 
-              <void property="predicate"> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="FilterOperator0"/> 
+               </void> 
+              </void> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="children"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                            <void property="children"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                                <void property="column"> 
-                                 <string>key</string> 
-                                </void> 
-                                <void property="tabAlias"> 
-                                 <string>s</string> 
-                                </void> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo1"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                                <void property="column"> 
-                                 <string>value</string> 
-                                </void> 
-                                <void property="tabAlias"> 
-                                 <string>s</string> 
-                                </void> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo0"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="genericUDF"> 
-                             <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFHash"/> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <int>2147483647</int> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                          <void property="operator"> 
-                           <boolean>true</boolean> 
-                          </void> 
-                          <void property="udfClassName"> 
-                           <string>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</string> 
-                          </void> 
-                          <void property="udfName"> 
-                           <string>&amp;</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>2</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPMod"/> 
+                    <void property="tabAlias"> 
+                     <string>s</string> 
                     </void> 
-                    <void property="typeInfo"> 
+                    <void property="type"> 
                      <object idref="PrimitiveTypeInfo1"/> 
                     </void> 
+                    <void property="typeName"> 
+                     <string>int</string> 
+                    </void> 
                    </object> 
                   </void> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col1</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string>s</string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                    <void property="value"> 
-                     <int>0</int> 
+                    <void property="typeName"> 
+                     <string>string</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                  <void property="typeName"> 
-                   <string>boolean</string> 
-                  </void> 
-                 </object> 
-                </void> 
                </object> 
               </void> 
              </object> 
             </void> 
-            <void property="operatorId"> 
-             <string>FIL_1</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator1"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>key</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>s</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo1"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>int</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>value</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>s</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
+             <void property="isSamplingPred"> 
+              <boolean>true</boolean> 
+             </void> 
+             <void property="predicate"> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                   <void property="children"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                       <void property="children"> 
+                        <object class="java.util.ArrayList"> 
+                         <void method="add"> 
+                          <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                           <void property="children"> 
+                            <object class="java.util.ArrayList"> 
+                             <void method="add"> 
+                              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                               <void property="column"> 
+                                <string>key</string> 
+                               </void> 
+                               <void property="tabAlias"> 
+                                <string>s</string> 
+                               </void> 
+                               <void property="typeInfo"> 
+                                <object idref="PrimitiveTypeInfo1"/> 
+                               </void> 
+                              </object> 
+                             </void> 
+                             <void method="add"> 
+                              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                               <void property="column"> 
+                                <string>value</string> 
+                               </void> 
+                               <void property="tabAlias"> 
+                                <string>s</string> 
+                               </void> 
+                               <void property="typeInfo"> 
+                                <object idref="PrimitiveTypeInfo0"/> 
+                               </void> 
+                              </object> 
+                             </void> 
+                            </object> 
+                           </void> 
+                           <void property="genericUDF"> 
+                            <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFHash"/> 
+                           </void> 
+                           <void property="typeInfo"> 
+                            <object idref="PrimitiveTypeInfo1"/> 
+                           </void> 
+                          </object> 
+                         </void> 
+                         <void method="add"> 
+                          <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                           <void property="typeInfo"> 
+                            <object idref="PrimitiveTypeInfo1"/> 
+                           </void> 
+                           <void property="value"> 
+                            <int>2147483647</int> 
+                           </void> 
+                          </object> 
+                         </void> 
+                        </object> 
+                       </void> 
+                       <void property="genericUDF"> 
+                        <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                         <void property="operator"> 
+                          <boolean>true</boolean> 
+                         </void> 
+                         <void property="udfClassName"> 
+                          <string>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</string> 
+                         </void> 
+                         <void property="udfName"> 
+                          <string>&amp;</string> 
+                         </void> 
+                        </object> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo1"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo1"/> 
+                       </void> 
+                       <void property="value"> 
+                        <int>2</int> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="genericUDF"> 
+                    <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPMod"/> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo1"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo1"/> 
+                   </void> 
+                   <void property="value"> 
+                    <int>0</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                 <void property="typeName"> 
+                  <string>boolean</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>FIL_1</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator1"/> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>key</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>s</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo1"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>int</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>value</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>s</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
diff --git a/ql/src/test/results/compiler/plan/sample4.q.xml b/ql/src/test/results/compiler/plan/sample4.q.xml
index 85a0e4d2d4..6ebc3e4ce2 100644
--- a/ql/src/test/results/compiler/plan/sample4.q.xml
+++ b/ql/src/test/results/compiler/plan/sample4.q.xml
@@ -79,137 +79,133 @@
                        #### A masked pattern was here #### 
                        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                         <void property="childOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                            <void property="conf"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                              <void property="dirName"> 
-                               #### A masked pattern was here #### 
-                              </void> 
-                              <void property="numFiles"> 
-                               <int>1</int> 
-                              </void> 
-                              <void property="tableInfo"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                                <void property="inputFileFormatClass"> 
-                                 <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-                                </void> 
-                                <void property="outputFileFormatClass"> 
-                                 <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-                                </void> 
-                                <void property="properties"> 
-                                 <object class="java.util.Properties"> 
-                                  <void method="put"> 
-                                   <string>name</string> 
-                                   <string>default.dest1</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>columns.types</string> 
-                                   <string>string:string</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.ddl</string> 
-                                   <string>struct dest1 { string key, string value}</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.format</string> 
-                                   <string>1</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>columns</string> 
-                                   <string>key,value</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>bucket_count</string> 
-                                   <string>-1</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.lib</string> 
-                                   <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>file.inputformat</string> 
-                                   <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>location</string> 
-                                   #### A masked pattern was here #### 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>file.outputformat</string> 
-                                   <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>transient_lastDdlTime</string> 
-                                   #### A masked pattern was here #### 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void property="totalFiles"> 
-                               <int>1</int> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="operatorId"> 
-                             <string>FS_5</string> 
+                         <void method="add"> 
+                          <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                           <void property="conf"> 
+                            <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                             <void property="dirName"> 
+                              #### A masked pattern was here #### 
+                             </void> 
+                             <void property="numFiles"> 
+                              <int>1</int> 
+                             </void> 
+                             <void property="tableInfo"> 
+                              <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                               <void property="inputFileFormatClass"> 
+                                <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                               </void> 
+                               <void property="outputFileFormatClass"> 
+                                <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                               </void> 
+                               <void property="properties"> 
+                                <object class="java.util.Properties"> 
+                                 <void method="put"> 
+                                  <string>name</string> 
+                                  <string>default.dest1</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>columns.types</string> 
+                                  <string>string:string</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.ddl</string> 
+                                  <string>struct dest1 { string key, string value}</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.format</string> 
+                                  <string>1</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>columns</string> 
+                                  <string>key,value</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>bucket_count</string> 
+                                  <string>-1</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.lib</string> 
+                                  <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>file.inputformat</string> 
+                                  <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>location</string> 
+                                  #### A masked pattern was here #### 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>file.outputformat</string> 
+                                  <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>transient_lastDdlTime</string> 
+                                  #### A masked pattern was here #### 
+                                 </void> 
+                                </object> 
+                               </void> 
+                              </object> 
+                             </void> 
+                             <void property="totalFiles"> 
+                              <int>1</int> 
+                             </void> 
+                            </object> 
+                           </void> 
+                           <void property="operatorId"> 
+                            <string>FS_5</string> 
+                           </void> 
+                           <void property="parentOperators"> 
+                            <void method="add"> 
+                             <object idref="TableScanOperator0"/> 
                             </void> 
-                            <void property="parentOperators"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object idref="TableScanOperator0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="schema"> 
-                             <object id="RowSchema0" class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                              <void property="signature"> 
-                               <object class="java.util.ArrayList"> 
-                                <void method="add"> 
-                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                  <void property="internalName"> 
-                                   <string>key</string> 
-                                  </void> 
-                                  <void property="tabAlias"> 
-                                   <string></string> 
-                                  </void> 
-                                  <void property="type"> 
-                                   <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                                    <void property="typeName"> 
-                                     <string>string</string> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                  <void property="typeName"> 
-                                   <string>string</string> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void method="add"> 
-                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                  <void property="internalName"> 
-                                   <string>value</string> 
-                                  </void> 
-                                  <void property="tabAlias"> 
-                                   <string></string> 
-                                  </void> 
-                                  <void property="type"> 
-                                   <object idref="PrimitiveTypeInfo0"/> 
-                                  </void> 
-                                  <void property="typeName"> 
-                                   <string>string</string> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
+                           </void> 
+                           <void property="schema"> 
+                            <object id="RowSchema0" class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                             <void property="signature"> 
+                              <object class="java.util.ArrayList"> 
+                               <void method="add"> 
+                                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                 <void property="internalName"> 
+                                  <string>key</string> 
+                                 </void> 
+                                 <void property="tabAlias"> 
+                                  <string></string> 
+                                 </void> 
+                                 <void property="type"> 
+                                  <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                                   <void property="typeName"> 
+                                    <string>string</string> 
+                                   </void> 
+                                  </object> 
+                                 </void> 
+                                 <void property="typeName"> 
+                                  <string>string</string> 
+                                 </void> 
+                                </object> 
+                               </void> 
+                               <void method="add"> 
+                                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                 <void property="internalName"> 
+                                  <string>value</string> 
+                                 </void> 
+                                 <void property="tabAlias"> 
+                                  <string></string> 
+                                 </void> 
+                                 <void property="type"> 
+                                  <object idref="PrimitiveTypeInfo0"/> 
+                                 </void> 
+                                 <void property="typeName"> 
+                                  <string>string</string> 
+                                 </void> 
+                                </object> 
+                               </void> 
+                              </object> 
+                             </void> 
+                            </object> 
+                           </void> 
+                          </object> 
+                         </void> 
                         </void> 
                         <void property="conf"> 
                          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"/> 
@@ -646,361 +642,349 @@
        <string>s</string> 
        <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                <void property="childOperators"> 
-                 <object class="java.util.ArrayList"> 
+         <void method="add"> 
+          <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+              <void property="childOperators"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                 <void property="conf"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                   <void property="destTableId"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="dirName"> 
+                    #### A masked pattern was here #### 
+                   </void> 
+                   <void property="gatherStats"> 
+                    <boolean>true</boolean> 
+                   </void> 
+                   <void property="lbCtx"> 
+                    <object idref="ListBucketingCtx0"/> 
+                   </void> 
+                   <void property="maxStatsKeyPrefixLength"> 
+                    <int>150</int> 
+                   </void> 
+                   <void property="numFiles"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="statsAggPrefix"> 
+                    #### A masked pattern was here #### 
+                   </void> 
+                   <void property="statsCollectRawDataSize"> 
+                    <boolean>true</boolean> 
+                   </void> 
+                   <void property="tableInfo"> 
+                    <object idref="TableDesc0"/> 
+                   </void> 
+                   <void property="totalFiles"> 
+                    <int>1</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="operatorId"> 
+                  <string>FS_3</string> 
+                 </void> 
+                 <void property="parentOperators"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                      <void property="destTableId"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="dirName"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="gatherStats"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="lbCtx"> 
-                       <object idref="ListBucketingCtx0"/> 
-                      </void> 
-                      <void property="maxStatsKeyPrefixLength"> 
-                       <int>150</int> 
-                      </void> 
-                      <void property="numFiles"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="statsAggPrefix"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="statsCollectRawDataSize"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="tableInfo"> 
-                       <object idref="TableDesc0"/> 
-                      </void> 
-                      <void property="totalFiles"> 
-                       <int>1</int> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="operatorId"> 
-                     <string>FS_3</string> 
-                    </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="SelectOperator0"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="schema"> 
-                     <object idref="RowSchema0"/> 
-                    </void> 
-                   </object> 
+                   <object idref="SelectOperator0"/> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="columnExprMap"> 
-                 <object class="java.util.HashMap"> 
-                  <void method="put"> 
-                   <string>_col1</string> 
-                   <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>value</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>s</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
+                 </void> 
+                 <void property="schema"> 
+                  <object idref="RowSchema0"/> 
+                 </void> 
+                </object> 
+               </void> 
+              </void> 
+              <void property="columnExprMap"> 
+               <object class="java.util.HashMap"> 
+                <void method="put"> 
+                 <string>_col1</string> 
+                 <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>value</string> 
                   </void> 
-                  <void method="put"> 
-                   <string>_col0</string> 
-                   <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>key</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>s</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                      <void property="typeName"> 
-                       <string>int</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                  <void property="tabAlias"> 
+                   <string>s</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                  <void property="colList"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc1"/> 
-                    </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc0"/> 
-                    </void> 
-                   </object> 
+                <void method="put"> 
+                 <string>_col0</string> 
+                 <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>key</string> 
                   </void> 
-                  <void property="outputColumnNames"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <string>_col0</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col1</string> 
+                  <void property="tabAlias"> 
+                   <string>s</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                    <void property="typeName"> 
+                     <string>int</string> 
                     </void> 
                    </object> 
                   </void> 
-                  <void property="selectStar"> 
-                   <boolean>true</boolean> 
-                  </void> 
                  </object> 
                 </void> 
-                <void property="operatorId"> 
-                 <string>SEL_2</string> 
-                </void> 
-                <void property="parentOperators"> 
+               </object> 
+              </void> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                <void property="colList"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object idref="FilterOperator0"/> 
+                   <object idref="ExprNodeColumnDesc1"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object idref="ExprNodeColumnDesc0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>s</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo1"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>int</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>s</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                <void property="outputColumnNames"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <string>_col0</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col1</string> 
                   </void> 
                  </object> 
                 </void> 
+                <void property="selectStar"> 
+                 <boolean>true</boolean> 
+                </void> 
                </object> 
               </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-              <void property="isSamplingPred"> 
-               <boolean>true</boolean> 
+              <void property="operatorId"> 
+               <string>SEL_2</string> 
               </void> 
-              <void property="predicate"> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="FilterOperator0"/> 
+               </void> 
+              </void> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="children"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                            <void property="children"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                                <void property="column"> 
-                                 <string>key</string> 
-                                </void> 
-                                <void property="tabAlias"> 
-                                 <string>s</string> 
-                                </void> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo1"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="genericUDF"> 
-                             <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFHash"/> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <int>2147483647</int> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                          <void property="operator"> 
-                           <boolean>true</boolean> 
-                          </void> 
-                          <void property="udfClassName"> 
-                           <string>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</string> 
-                          </void> 
-                          <void property="udfName"> 
-                           <string>&amp;</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>2</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPMod"/> 
+                    <void property="tabAlias"> 
+                     <string>s</string> 
                     </void> 
-                    <void property="typeInfo"> 
+                    <void property="type"> 
                      <object idref="PrimitiveTypeInfo1"/> 
                     </void> 
+                    <void property="typeName"> 
+                     <string>int</string> 
+                    </void> 
                    </object> 
                   </void> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col1</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string>s</string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                    <void property="value"> 
-                     <int>0</int> 
+                    <void property="typeName"> 
+                     <string>string</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                  <void property="typeName"> 
-                   <string>boolean</string> 
-                  </void> 
-                 </object> 
-                </void> 
                </object> 
               </void> 
-              <void property="sampleDescr"> 
-               <object class="org.apache.hadoop.hive.ql.plan.FilterDesc$sampleDesc"/> 
-              </void> 
              </object> 
             </void> 
-            <void property="operatorId"> 
-             <string>FIL_1</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator1"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>key</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>s</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo1"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>int</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>value</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>s</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
+             <void property="isSamplingPred"> 
+              <boolean>true</boolean> 
+             </void> 
+             <void property="predicate"> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                   <void property="children"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                       <void property="children"> 
+                        <object class="java.util.ArrayList"> 
+                         <void method="add"> 
+                          <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                           <void property="children"> 
+                            <object class="java.util.ArrayList"> 
+                             <void method="add"> 
+                              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                               <void property="column"> 
+                                <string>key</string> 
+                               </void> 
+                               <void property="tabAlias"> 
+                                <string>s</string> 
+                               </void> 
+                               <void property="typeInfo"> 
+                                <object idref="PrimitiveTypeInfo1"/> 
+                               </void> 
+                              </object> 
+                             </void> 
+                            </object> 
+                           </void> 
+                           <void property="genericUDF"> 
+                            <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFHash"/> 
+                           </void> 
+                           <void property="typeInfo"> 
+                            <object idref="PrimitiveTypeInfo1"/> 
+                           </void> 
+                          </object> 
+                         </void> 
+                         <void method="add"> 
+                          <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                           <void property="typeInfo"> 
+                            <object idref="PrimitiveTypeInfo1"/> 
+                           </void> 
+                           <void property="value"> 
+                            <int>2147483647</int> 
+                           </void> 
+                          </object> 
+                         </void> 
+                        </object> 
+                       </void> 
+                       <void property="genericUDF"> 
+                        <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                         <void property="operator"> 
+                          <boolean>true</boolean> 
+                         </void> 
+                         <void property="udfClassName"> 
+                          <string>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</string> 
+                         </void> 
+                         <void property="udfName"> 
+                          <string>&amp;</string> 
+                         </void> 
+                        </object> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo1"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo1"/> 
+                       </void> 
+                       <void property="value"> 
+                        <int>2</int> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="genericUDF"> 
+                    <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPMod"/> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo1"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo1"/> 
+                   </void> 
+                   <void property="value"> 
+                    <int>0</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                 <void property="typeName"> 
+                  <string>boolean</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="sampleDescr"> 
+              <object class="org.apache.hadoop.hive.ql.plan.FilterDesc$sampleDesc"/> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>FIL_1</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator1"/> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>key</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>s</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo1"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>int</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>value</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>s</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
diff --git a/ql/src/test/results/compiler/plan/sample5.q.xml b/ql/src/test/results/compiler/plan/sample5.q.xml
index 5921865311..7411d6d761 100644
--- a/ql/src/test/results/compiler/plan/sample5.q.xml
+++ b/ql/src/test/results/compiler/plan/sample5.q.xml
@@ -79,137 +79,133 @@
                        #### A masked pattern was here #### 
                        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                         <void property="childOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                            <void property="conf"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                              <void property="dirName"> 
-                               #### A masked pattern was here #### 
-                              </void> 
-                              <void property="numFiles"> 
-                               <int>1</int> 
-                              </void> 
-                              <void property="tableInfo"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                                <void property="inputFileFormatClass"> 
-                                 <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-                                </void> 
-                                <void property="outputFileFormatClass"> 
-                                 <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-                                </void> 
-                                <void property="properties"> 
-                                 <object class="java.util.Properties"> 
-                                  <void method="put"> 
-                                   <string>name</string> 
-                                   <string>default.dest1</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>columns.types</string> 
-                                   <string>string:string</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.ddl</string> 
-                                   <string>struct dest1 { string key, string value}</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.format</string> 
-                                   <string>1</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>columns</string> 
-                                   <string>key,value</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>bucket_count</string> 
-                                   <string>-1</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.lib</string> 
-                                   <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>file.inputformat</string> 
-                                   <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>location</string> 
-                                   #### A masked pattern was here #### 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>file.outputformat</string> 
-                                   <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>transient_lastDdlTime</string> 
-                                   #### A masked pattern was here #### 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void property="totalFiles"> 
-                               <int>1</int> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="operatorId"> 
-                             <string>FS_5</string> 
+                         <void method="add"> 
+                          <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                           <void property="conf"> 
+                            <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                             <void property="dirName"> 
+                              #### A masked pattern was here #### 
+                             </void> 
+                             <void property="numFiles"> 
+                              <int>1</int> 
+                             </void> 
+                             <void property="tableInfo"> 
+                              <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                               <void property="inputFileFormatClass"> 
+                                <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                               </void> 
+                               <void property="outputFileFormatClass"> 
+                                <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                               </void> 
+                               <void property="properties"> 
+                                <object class="java.util.Properties"> 
+                                 <void method="put"> 
+                                  <string>name</string> 
+                                  <string>default.dest1</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>columns.types</string> 
+                                  <string>string:string</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.ddl</string> 
+                                  <string>struct dest1 { string key, string value}</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.format</string> 
+                                  <string>1</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>columns</string> 
+                                  <string>key,value</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>bucket_count</string> 
+                                  <string>-1</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.lib</string> 
+                                  <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>file.inputformat</string> 
+                                  <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>location</string> 
+                                  #### A masked pattern was here #### 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>file.outputformat</string> 
+                                  <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>transient_lastDdlTime</string> 
+                                  #### A masked pattern was here #### 
+                                 </void> 
+                                </object> 
+                               </void> 
+                              </object> 
+                             </void> 
+                             <void property="totalFiles"> 
+                              <int>1</int> 
+                             </void> 
+                            </object> 
+                           </void> 
+                           <void property="operatorId"> 
+                            <string>FS_5</string> 
+                           </void> 
+                           <void property="parentOperators"> 
+                            <void method="add"> 
+                             <object idref="TableScanOperator0"/> 
                             </void> 
-                            <void property="parentOperators"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object idref="TableScanOperator0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="schema"> 
-                             <object id="RowSchema0" class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                              <void property="signature"> 
-                               <object class="java.util.ArrayList"> 
-                                <void method="add"> 
-                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                  <void property="internalName"> 
-                                   <string>key</string> 
-                                  </void> 
-                                  <void property="tabAlias"> 
-                                   <string></string> 
-                                  </void> 
-                                  <void property="type"> 
-                                   <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                                    <void property="typeName"> 
-                                     <string>string</string> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                  <void property="typeName"> 
-                                   <string>string</string> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void method="add"> 
-                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                  <void property="internalName"> 
-                                   <string>value</string> 
-                                  </void> 
-                                  <void property="tabAlias"> 
-                                   <string></string> 
-                                  </void> 
-                                  <void property="type"> 
-                                   <object idref="PrimitiveTypeInfo0"/> 
-                                  </void> 
-                                  <void property="typeName"> 
-                                   <string>string</string> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
+                           </void> 
+                           <void property="schema"> 
+                            <object id="RowSchema0" class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                             <void property="signature"> 
+                              <object class="java.util.ArrayList"> 
+                               <void method="add"> 
+                                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                 <void property="internalName"> 
+                                  <string>key</string> 
+                                 </void> 
+                                 <void property="tabAlias"> 
+                                  <string></string> 
+                                 </void> 
+                                 <void property="type"> 
+                                  <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                                   <void property="typeName"> 
+                                    <string>string</string> 
+                                   </void> 
+                                  </object> 
+                                 </void> 
+                                 <void property="typeName"> 
+                                  <string>string</string> 
+                                 </void> 
+                                </object> 
+                               </void> 
+                               <void method="add"> 
+                                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                 <void property="internalName"> 
+                                  <string>value</string> 
+                                 </void> 
+                                 <void property="tabAlias"> 
+                                  <string></string> 
+                                 </void> 
+                                 <void property="type"> 
+                                  <object idref="PrimitiveTypeInfo0"/> 
+                                 </void> 
+                                 <void property="typeName"> 
+                                  <string>string</string> 
+                                 </void> 
+                                </object> 
+                               </void> 
+                              </object> 
+                             </void> 
+                            </object> 
+                           </void> 
+                          </object> 
+                         </void> 
                         </void> 
                         <void property="conf"> 
                          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"/> 
@@ -646,358 +642,346 @@
        <string>s</string> 
        <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                <void property="childOperators"> 
-                 <object class="java.util.ArrayList"> 
+         <void method="add"> 
+          <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+              <void property="childOperators"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                 <void property="conf"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                   <void property="destTableId"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="dirName"> 
+                    #### A masked pattern was here #### 
+                   </void> 
+                   <void property="gatherStats"> 
+                    <boolean>true</boolean> 
+                   </void> 
+                   <void property="lbCtx"> 
+                    <object idref="ListBucketingCtx0"/> 
+                   </void> 
+                   <void property="maxStatsKeyPrefixLength"> 
+                    <int>150</int> 
+                   </void> 
+                   <void property="numFiles"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="statsAggPrefix"> 
+                    #### A masked pattern was here #### 
+                   </void> 
+                   <void property="statsCollectRawDataSize"> 
+                    <boolean>true</boolean> 
+                   </void> 
+                   <void property="tableInfo"> 
+                    <object idref="TableDesc0"/> 
+                   </void> 
+                   <void property="totalFiles"> 
+                    <int>1</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="operatorId"> 
+                  <string>FS_3</string> 
+                 </void> 
+                 <void property="parentOperators"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                      <void property="destTableId"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="dirName"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="gatherStats"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="lbCtx"> 
-                       <object idref="ListBucketingCtx0"/> 
-                      </void> 
-                      <void property="maxStatsKeyPrefixLength"> 
-                       <int>150</int> 
-                      </void> 
-                      <void property="numFiles"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="statsAggPrefix"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="statsCollectRawDataSize"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="tableInfo"> 
-                       <object idref="TableDesc0"/> 
-                      </void> 
-                      <void property="totalFiles"> 
-                       <int>1</int> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="operatorId"> 
-                     <string>FS_3</string> 
-                    </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="SelectOperator0"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="schema"> 
-                     <object idref="RowSchema0"/> 
-                    </void> 
-                   </object> 
+                   <object idref="SelectOperator0"/> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="columnExprMap"> 
-                 <object class="java.util.HashMap"> 
-                  <void method="put"> 
-                   <string>_col1</string> 
-                   <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>value</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>s</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
+                 </void> 
+                 <void property="schema"> 
+                  <object idref="RowSchema0"/> 
+                 </void> 
+                </object> 
+               </void> 
+              </void> 
+              <void property="columnExprMap"> 
+               <object class="java.util.HashMap"> 
+                <void method="put"> 
+                 <string>_col1</string> 
+                 <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>value</string> 
                   </void> 
-                  <void method="put"> 
-                   <string>_col0</string> 
-                   <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>key</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>s</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                      <void property="typeName"> 
-                       <string>int</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                  <void property="tabAlias"> 
+                   <string>s</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                  <void property="colList"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc1"/> 
-                    </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc0"/> 
-                    </void> 
-                   </object> 
+                <void method="put"> 
+                 <string>_col0</string> 
+                 <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>key</string> 
                   </void> 
-                  <void property="outputColumnNames"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <string>_col0</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col1</string> 
+                  <void property="tabAlias"> 
+                   <string>s</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                    <void property="typeName"> 
+                     <string>int</string> 
                     </void> 
                    </object> 
                   </void> 
-                  <void property="selectStar"> 
-                   <boolean>true</boolean> 
-                  </void> 
                  </object> 
                 </void> 
-                <void property="operatorId"> 
-                 <string>SEL_2</string> 
-                </void> 
-                <void property="parentOperators"> 
+               </object> 
+              </void> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                <void property="colList"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object idref="FilterOperator0"/> 
+                   <object idref="ExprNodeColumnDesc1"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object idref="ExprNodeColumnDesc0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>s</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo1"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>int</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>s</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                <void property="outputColumnNames"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <string>_col0</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col1</string> 
                   </void> 
                  </object> 
                 </void> 
+                <void property="selectStar"> 
+                 <boolean>true</boolean> 
+                </void> 
                </object> 
               </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-              <void property="isSamplingPred"> 
-               <boolean>true</boolean> 
+              <void property="operatorId"> 
+               <string>SEL_2</string> 
               </void> 
-              <void property="predicate"> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="FilterOperator0"/> 
+               </void> 
+              </void> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="children"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                            <void property="children"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                                <void property="column"> 
-                                 <string>key</string> 
-                                </void> 
-                                <void property="tabAlias"> 
-                                 <string>s</string> 
-                                </void> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo1"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="genericUDF"> 
-                             <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFHash"/> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <int>2147483647</int> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                          <void property="operator"> 
-                           <boolean>true</boolean> 
-                          </void> 
-                          <void property="udfClassName"> 
-                           <string>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</string> 
-                          </void> 
-                          <void property="udfName"> 
-                           <string>&amp;</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>5</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPMod"/> 
+                    <void property="tabAlias"> 
+                     <string>s</string> 
                     </void> 
-                    <void property="typeInfo"> 
+                    <void property="type"> 
                      <object idref="PrimitiveTypeInfo1"/> 
                     </void> 
+                    <void property="typeName"> 
+                     <string>int</string> 
+                    </void> 
                    </object> 
                   </void> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col1</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string>s</string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                    <void property="value"> 
-                     <int>0</int> 
+                    <void property="typeName"> 
+                     <string>string</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                  <void property="typeName"> 
-                   <string>boolean</string> 
-                  </void> 
-                 </object> 
-                </void> 
                </object> 
               </void> 
              </object> 
             </void> 
-            <void property="operatorId"> 
-             <string>FIL_1</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator1"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>key</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>s</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo1"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>int</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>value</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>s</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
+             <void property="isSamplingPred"> 
+              <boolean>true</boolean> 
+             </void> 
+             <void property="predicate"> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                   <void property="children"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                       <void property="children"> 
+                        <object class="java.util.ArrayList"> 
+                         <void method="add"> 
+                          <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                           <void property="children"> 
+                            <object class="java.util.ArrayList"> 
+                             <void method="add"> 
+                              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                               <void property="column"> 
+                                <string>key</string> 
+                               </void> 
+                               <void property="tabAlias"> 
+                                <string>s</string> 
+                               </void> 
+                               <void property="typeInfo"> 
+                                <object idref="PrimitiveTypeInfo1"/> 
+                               </void> 
+                              </object> 
+                             </void> 
+                            </object> 
+                           </void> 
+                           <void property="genericUDF"> 
+                            <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFHash"/> 
+                           </void> 
+                           <void property="typeInfo"> 
+                            <object idref="PrimitiveTypeInfo1"/> 
+                           </void> 
+                          </object> 
+                         </void> 
+                         <void method="add"> 
+                          <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                           <void property="typeInfo"> 
+                            <object idref="PrimitiveTypeInfo1"/> 
+                           </void> 
+                           <void property="value"> 
+                            <int>2147483647</int> 
+                           </void> 
+                          </object> 
+                         </void> 
+                        </object> 
+                       </void> 
+                       <void property="genericUDF"> 
+                        <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                         <void property="operator"> 
+                          <boolean>true</boolean> 
+                         </void> 
+                         <void property="udfClassName"> 
+                          <string>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</string> 
+                         </void> 
+                         <void property="udfName"> 
+                          <string>&amp;</string> 
+                         </void> 
+                        </object> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo1"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo1"/> 
+                       </void> 
+                       <void property="value"> 
+                        <int>5</int> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="genericUDF"> 
+                    <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPMod"/> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo1"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo1"/> 
+                   </void> 
+                   <void property="value"> 
+                    <int>0</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                 <void property="typeName"> 
+                  <string>boolean</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>FIL_1</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator1"/> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>key</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>s</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo1"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>int</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>value</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>s</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
diff --git a/ql/src/test/results/compiler/plan/sample6.q.xml b/ql/src/test/results/compiler/plan/sample6.q.xml
index 54b3f6eef3..17863a80ad 100644
--- a/ql/src/test/results/compiler/plan/sample6.q.xml
+++ b/ql/src/test/results/compiler/plan/sample6.q.xml
@@ -79,137 +79,133 @@
                        #### A masked pattern was here #### 
                        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                         <void property="childOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                            <void property="conf"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                              <void property="dirName"> 
-                               #### A masked pattern was here #### 
-                              </void> 
-                              <void property="numFiles"> 
-                               <int>1</int> 
-                              </void> 
-                              <void property="tableInfo"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                                <void property="inputFileFormatClass"> 
-                                 <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-                                </void> 
-                                <void property="outputFileFormatClass"> 
-                                 <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-                                </void> 
-                                <void property="properties"> 
-                                 <object class="java.util.Properties"> 
-                                  <void method="put"> 
-                                   <string>name</string> 
-                                   <string>default.dest1</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>columns.types</string> 
-                                   <string>string:string</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.ddl</string> 
-                                   <string>struct dest1 { string key, string value}</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.format</string> 
-                                   <string>1</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>columns</string> 
-                                   <string>key,value</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>bucket_count</string> 
-                                   <string>-1</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.lib</string> 
-                                   <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>file.inputformat</string> 
-                                   <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>location</string> 
-                                   #### A masked pattern was here #### 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>file.outputformat</string> 
-                                   <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>transient_lastDdlTime</string> 
-                                   #### A masked pattern was here #### 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void property="totalFiles"> 
-                               <int>1</int> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="operatorId"> 
-                             <string>FS_5</string> 
+                         <void method="add"> 
+                          <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                           <void property="conf"> 
+                            <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                             <void property="dirName"> 
+                              #### A masked pattern was here #### 
+                             </void> 
+                             <void property="numFiles"> 
+                              <int>1</int> 
+                             </void> 
+                             <void property="tableInfo"> 
+                              <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                               <void property="inputFileFormatClass"> 
+                                <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                               </void> 
+                               <void property="outputFileFormatClass"> 
+                                <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                               </void> 
+                               <void property="properties"> 
+                                <object class="java.util.Properties"> 
+                                 <void method="put"> 
+                                  <string>name</string> 
+                                  <string>default.dest1</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>columns.types</string> 
+                                  <string>string:string</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.ddl</string> 
+                                  <string>struct dest1 { string key, string value}</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.format</string> 
+                                  <string>1</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>columns</string> 
+                                  <string>key,value</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>bucket_count</string> 
+                                  <string>-1</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.lib</string> 
+                                  <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>file.inputformat</string> 
+                                  <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>location</string> 
+                                  #### A masked pattern was here #### 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>file.outputformat</string> 
+                                  <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>transient_lastDdlTime</string> 
+                                  #### A masked pattern was here #### 
+                                 </void> 
+                                </object> 
+                               </void> 
+                              </object> 
+                             </void> 
+                             <void property="totalFiles"> 
+                              <int>1</int> 
+                             </void> 
+                            </object> 
+                           </void> 
+                           <void property="operatorId"> 
+                            <string>FS_5</string> 
+                           </void> 
+                           <void property="parentOperators"> 
+                            <void method="add"> 
+                             <object idref="TableScanOperator0"/> 
                             </void> 
-                            <void property="parentOperators"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object idref="TableScanOperator0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="schema"> 
-                             <object id="RowSchema0" class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                              <void property="signature"> 
-                               <object class="java.util.ArrayList"> 
-                                <void method="add"> 
-                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                  <void property="internalName"> 
-                                   <string>key</string> 
-                                  </void> 
-                                  <void property="tabAlias"> 
-                                   <string></string> 
-                                  </void> 
-                                  <void property="type"> 
-                                   <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                                    <void property="typeName"> 
-                                     <string>string</string> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                  <void property="typeName"> 
-                                   <string>string</string> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void method="add"> 
-                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                  <void property="internalName"> 
-                                   <string>value</string> 
-                                  </void> 
-                                  <void property="tabAlias"> 
-                                   <string></string> 
-                                  </void> 
-                                  <void property="type"> 
-                                   <object idref="PrimitiveTypeInfo0"/> 
-                                  </void> 
-                                  <void property="typeName"> 
-                                   <string>string</string> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
+                           </void> 
+                           <void property="schema"> 
+                            <object id="RowSchema0" class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                             <void property="signature"> 
+                              <object class="java.util.ArrayList"> 
+                               <void method="add"> 
+                                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                 <void property="internalName"> 
+                                  <string>key</string> 
+                                 </void> 
+                                 <void property="tabAlias"> 
+                                  <string></string> 
+                                 </void> 
+                                 <void property="type"> 
+                                  <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                                   <void property="typeName"> 
+                                    <string>string</string> 
+                                   </void> 
+                                  </object> 
+                                 </void> 
+                                 <void property="typeName"> 
+                                  <string>string</string> 
+                                 </void> 
+                                </object> 
+                               </void> 
+                               <void method="add"> 
+                                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                 <void property="internalName"> 
+                                  <string>value</string> 
+                                 </void> 
+                                 <void property="tabAlias"> 
+                                  <string></string> 
+                                 </void> 
+                                 <void property="type"> 
+                                  <object idref="PrimitiveTypeInfo0"/> 
+                                 </void> 
+                                 <void property="typeName"> 
+                                  <string>string</string> 
+                                 </void> 
+                                </object> 
+                               </void> 
+                              </object> 
+                             </void> 
+                            </object> 
+                           </void> 
+                          </object> 
+                         </void> 
                         </void> 
                         <void property="conf"> 
                          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"/> 
@@ -646,361 +642,349 @@
        <string>s</string> 
        <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                <void property="childOperators"> 
-                 <object class="java.util.ArrayList"> 
+         <void method="add"> 
+          <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+              <void property="childOperators"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                 <void property="conf"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                   <void property="destTableId"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="dirName"> 
+                    #### A masked pattern was here #### 
+                   </void> 
+                   <void property="gatherStats"> 
+                    <boolean>true</boolean> 
+                   </void> 
+                   <void property="lbCtx"> 
+                    <object idref="ListBucketingCtx0"/> 
+                   </void> 
+                   <void property="maxStatsKeyPrefixLength"> 
+                    <int>150</int> 
+                   </void> 
+                   <void property="numFiles"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="statsAggPrefix"> 
+                    #### A masked pattern was here #### 
+                   </void> 
+                   <void property="statsCollectRawDataSize"> 
+                    <boolean>true</boolean> 
+                   </void> 
+                   <void property="tableInfo"> 
+                    <object idref="TableDesc0"/> 
+                   </void> 
+                   <void property="totalFiles"> 
+                    <int>1</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="operatorId"> 
+                  <string>FS_3</string> 
+                 </void> 
+                 <void property="parentOperators"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                      <void property="destTableId"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="dirName"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="gatherStats"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="lbCtx"> 
-                       <object idref="ListBucketingCtx0"/> 
-                      </void> 
-                      <void property="maxStatsKeyPrefixLength"> 
-                       <int>150</int> 
-                      </void> 
-                      <void property="numFiles"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="statsAggPrefix"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="statsCollectRawDataSize"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="tableInfo"> 
-                       <object idref="TableDesc0"/> 
-                      </void> 
-                      <void property="totalFiles"> 
-                       <int>1</int> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="operatorId"> 
-                     <string>FS_3</string> 
-                    </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="SelectOperator0"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="schema"> 
-                     <object idref="RowSchema0"/> 
-                    </void> 
-                   </object> 
+                   <object idref="SelectOperator0"/> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="columnExprMap"> 
-                 <object class="java.util.HashMap"> 
-                  <void method="put"> 
-                   <string>_col1</string> 
-                   <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>value</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>s</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
+                 </void> 
+                 <void property="schema"> 
+                  <object idref="RowSchema0"/> 
+                 </void> 
+                </object> 
+               </void> 
+              </void> 
+              <void property="columnExprMap"> 
+               <object class="java.util.HashMap"> 
+                <void method="put"> 
+                 <string>_col1</string> 
+                 <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>value</string> 
                   </void> 
-                  <void method="put"> 
-                   <string>_col0</string> 
-                   <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>key</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>s</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                      <void property="typeName"> 
-                       <string>int</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                  <void property="tabAlias"> 
+                   <string>s</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                  <void property="colList"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc1"/> 
-                    </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc0"/> 
-                    </void> 
-                   </object> 
+                <void method="put"> 
+                 <string>_col0</string> 
+                 <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>key</string> 
                   </void> 
-                  <void property="outputColumnNames"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <string>_col0</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col1</string> 
+                  <void property="tabAlias"> 
+                   <string>s</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                    <void property="typeName"> 
+                     <string>int</string> 
                     </void> 
                    </object> 
                   </void> 
-                  <void property="selectStar"> 
-                   <boolean>true</boolean> 
-                  </void> 
                  </object> 
                 </void> 
-                <void property="operatorId"> 
-                 <string>SEL_2</string> 
-                </void> 
-                <void property="parentOperators"> 
+               </object> 
+              </void> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                <void property="colList"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object idref="FilterOperator0"/> 
+                   <object idref="ExprNodeColumnDesc1"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object idref="ExprNodeColumnDesc0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>s</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo1"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>int</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>s</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                <void property="outputColumnNames"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <string>_col0</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col1</string> 
                   </void> 
                  </object> 
                 </void> 
+                <void property="selectStar"> 
+                 <boolean>true</boolean> 
+                </void> 
                </object> 
               </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-              <void property="isSamplingPred"> 
-               <boolean>true</boolean> 
+              <void property="operatorId"> 
+               <string>SEL_2</string> 
               </void> 
-              <void property="predicate"> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="FilterOperator0"/> 
+               </void> 
+              </void> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="children"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                            <void property="children"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                                <void property="column"> 
-                                 <string>key</string> 
-                                </void> 
-                                <void property="tabAlias"> 
-                                 <string>s</string> 
-                                </void> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo1"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="genericUDF"> 
-                             <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFHash"/> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <int>2147483647</int> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                          <void property="operator"> 
-                           <boolean>true</boolean> 
-                          </void> 
-                          <void property="udfClassName"> 
-                           <string>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</string> 
-                          </void> 
-                          <void property="udfName"> 
-                           <string>&amp;</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>4</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPMod"/> 
+                    <void property="tabAlias"> 
+                     <string>s</string> 
                     </void> 
-                    <void property="typeInfo"> 
+                    <void property="type"> 
                      <object idref="PrimitiveTypeInfo1"/> 
                     </void> 
+                    <void property="typeName"> 
+                     <string>int</string> 
+                    </void> 
                    </object> 
                   </void> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col1</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string>s</string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                    <void property="value"> 
-                     <int>0</int> 
+                    <void property="typeName"> 
+                     <string>string</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                  <void property="typeName"> 
-                   <string>boolean</string> 
-                  </void> 
-                 </object> 
-                </void> 
                </object> 
               </void> 
-              <void property="sampleDescr"> 
-               <object class="org.apache.hadoop.hive.ql.plan.FilterDesc$sampleDesc"/> 
-              </void> 
              </object> 
             </void> 
-            <void property="operatorId"> 
-             <string>FIL_1</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator1"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>key</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>s</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo1"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>int</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>value</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>s</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
+             <void property="isSamplingPred"> 
+              <boolean>true</boolean> 
+             </void> 
+             <void property="predicate"> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                   <void property="children"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                       <void property="children"> 
+                        <object class="java.util.ArrayList"> 
+                         <void method="add"> 
+                          <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                           <void property="children"> 
+                            <object class="java.util.ArrayList"> 
+                             <void method="add"> 
+                              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                               <void property="column"> 
+                                <string>key</string> 
+                               </void> 
+                               <void property="tabAlias"> 
+                                <string>s</string> 
+                               </void> 
+                               <void property="typeInfo"> 
+                                <object idref="PrimitiveTypeInfo1"/> 
+                               </void> 
+                              </object> 
+                             </void> 
+                            </object> 
+                           </void> 
+                           <void property="genericUDF"> 
+                            <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFHash"/> 
+                           </void> 
+                           <void property="typeInfo"> 
+                            <object idref="PrimitiveTypeInfo1"/> 
+                           </void> 
+                          </object> 
+                         </void> 
+                         <void method="add"> 
+                          <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                           <void property="typeInfo"> 
+                            <object idref="PrimitiveTypeInfo1"/> 
+                           </void> 
+                           <void property="value"> 
+                            <int>2147483647</int> 
+                           </void> 
+                          </object> 
+                         </void> 
+                        </object> 
+                       </void> 
+                       <void property="genericUDF"> 
+                        <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                         <void property="operator"> 
+                          <boolean>true</boolean> 
+                         </void> 
+                         <void property="udfClassName"> 
+                          <string>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</string> 
+                         </void> 
+                         <void property="udfName"> 
+                          <string>&amp;</string> 
+                         </void> 
+                        </object> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo1"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo1"/> 
+                       </void> 
+                       <void property="value"> 
+                        <int>4</int> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="genericUDF"> 
+                    <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPMod"/> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo1"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo1"/> 
+                   </void> 
+                   <void property="value"> 
+                    <int>0</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                 <void property="typeName"> 
+                  <string>boolean</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="sampleDescr"> 
+              <object class="org.apache.hadoop.hive.ql.plan.FilterDesc$sampleDesc"/> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>FIL_1</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator1"/> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>key</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>s</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo1"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>int</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>value</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>s</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
diff --git a/ql/src/test/results/compiler/plan/sample7.q.xml b/ql/src/test/results/compiler/plan/sample7.q.xml
index 47bbad54cb..bed67dcf77 100644
--- a/ql/src/test/results/compiler/plan/sample7.q.xml
+++ b/ql/src/test/results/compiler/plan/sample7.q.xml
@@ -79,137 +79,133 @@
                        #### A masked pattern was here #### 
                        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                         <void property="childOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                            <void property="conf"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                              <void property="dirName"> 
-                               #### A masked pattern was here #### 
-                              </void> 
-                              <void property="numFiles"> 
-                               <int>1</int> 
-                              </void> 
-                              <void property="tableInfo"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                                <void property="inputFileFormatClass"> 
-                                 <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-                                </void> 
-                                <void property="outputFileFormatClass"> 
-                                 <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-                                </void> 
-                                <void property="properties"> 
-                                 <object class="java.util.Properties"> 
-                                  <void method="put"> 
-                                   <string>name</string> 
-                                   <string>default.dest1</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>columns.types</string> 
-                                   <string>string:string</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.ddl</string> 
-                                   <string>struct dest1 { string key, string value}</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.format</string> 
-                                   <string>1</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>columns</string> 
-                                   <string>key,value</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>bucket_count</string> 
-                                   <string>-1</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.lib</string> 
-                                   <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>file.inputformat</string> 
-                                   <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>location</string> 
-                                   #### A masked pattern was here #### 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>file.outputformat</string> 
-                                   <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>transient_lastDdlTime</string> 
-                                   #### A masked pattern was here #### 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void property="totalFiles"> 
-                               <int>1</int> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="operatorId"> 
-                             <string>FS_7</string> 
+                         <void method="add"> 
+                          <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                           <void property="conf"> 
+                            <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                             <void property="dirName"> 
+                              #### A masked pattern was here #### 
+                             </void> 
+                             <void property="numFiles"> 
+                              <int>1</int> 
+                             </void> 
+                             <void property="tableInfo"> 
+                              <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                               <void property="inputFileFormatClass"> 
+                                <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                               </void> 
+                               <void property="outputFileFormatClass"> 
+                                <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                               </void> 
+                               <void property="properties"> 
+                                <object class="java.util.Properties"> 
+                                 <void method="put"> 
+                                  <string>name</string> 
+                                  <string>default.dest1</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>columns.types</string> 
+                                  <string>string:string</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.ddl</string> 
+                                  <string>struct dest1 { string key, string value}</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.format</string> 
+                                  <string>1</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>columns</string> 
+                                  <string>key,value</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>bucket_count</string> 
+                                  <string>-1</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.lib</string> 
+                                  <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>file.inputformat</string> 
+                                  <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>location</string> 
+                                  #### A masked pattern was here #### 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>file.outputformat</string> 
+                                  <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>transient_lastDdlTime</string> 
+                                  #### A masked pattern was here #### 
+                                 </void> 
+                                </object> 
+                               </void> 
+                              </object> 
+                             </void> 
+                             <void property="totalFiles"> 
+                              <int>1</int> 
+                             </void> 
+                            </object> 
+                           </void> 
+                           <void property="operatorId"> 
+                            <string>FS_7</string> 
+                           </void> 
+                           <void property="parentOperators"> 
+                            <void method="add"> 
+                             <object idref="TableScanOperator0"/> 
                             </void> 
-                            <void property="parentOperators"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object idref="TableScanOperator0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="schema"> 
-                             <object id="RowSchema0" class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                              <void property="signature"> 
-                               <object class="java.util.ArrayList"> 
-                                <void method="add"> 
-                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                  <void property="internalName"> 
-                                   <string>key</string> 
-                                  </void> 
-                                  <void property="tabAlias"> 
-                                   <string></string> 
-                                  </void> 
-                                  <void property="type"> 
-                                   <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                                    <void property="typeName"> 
-                                     <string>string</string> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                  <void property="typeName"> 
-                                   <string>string</string> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void method="add"> 
-                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                  <void property="internalName"> 
-                                   <string>value</string> 
-                                  </void> 
-                                  <void property="tabAlias"> 
-                                   <string></string> 
-                                  </void> 
-                                  <void property="type"> 
-                                   <object idref="PrimitiveTypeInfo0"/> 
-                                  </void> 
-                                  <void property="typeName"> 
-                                   <string>string</string> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
+                           </void> 
+                           <void property="schema"> 
+                            <object id="RowSchema0" class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                             <void property="signature"> 
+                              <object class="java.util.ArrayList"> 
+                               <void method="add"> 
+                                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                 <void property="internalName"> 
+                                  <string>key</string> 
+                                 </void> 
+                                 <void property="tabAlias"> 
+                                  <string></string> 
+                                 </void> 
+                                 <void property="type"> 
+                                  <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                                   <void property="typeName"> 
+                                    <string>string</string> 
+                                   </void> 
+                                  </object> 
+                                 </void> 
+                                 <void property="typeName"> 
+                                  <string>string</string> 
+                                 </void> 
+                                </object> 
+                               </void> 
+                               <void method="add"> 
+                                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                 <void property="internalName"> 
+                                  <string>value</string> 
+                                 </void> 
+                                 <void property="tabAlias"> 
+                                  <string></string> 
+                                 </void> 
+                                 <void property="type"> 
+                                  <object idref="PrimitiveTypeInfo0"/> 
+                                 </void> 
+                                 <void property="typeName"> 
+                                  <string>string</string> 
+                                 </void> 
+                                </object> 
+                               </void> 
+                              </object> 
+                             </void> 
+                            </object> 
+                           </void> 
+                          </object> 
+                         </void> 
                         </void> 
                         <void property="conf"> 
                          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"/> 
@@ -646,406 +642,394 @@
        <string>s</string> 
        <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                <void property="childOperators"> 
-                 <object class="java.util.ArrayList"> 
+         <void method="add"> 
+          <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+              <void property="childOperators"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                 <void property="conf"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                   <void property="destTableId"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="dirName"> 
+                    #### A masked pattern was here #### 
+                   </void> 
+                   <void property="gatherStats"> 
+                    <boolean>true</boolean> 
+                   </void> 
+                   <void property="lbCtx"> 
+                    <object idref="ListBucketingCtx0"/> 
+                   </void> 
+                   <void property="maxStatsKeyPrefixLength"> 
+                    <int>150</int> 
+                   </void> 
+                   <void property="numFiles"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="statsAggPrefix"> 
+                    #### A masked pattern was here #### 
+                   </void> 
+                   <void property="statsCollectRawDataSize"> 
+                    <boolean>true</boolean> 
+                   </void> 
+                   <void property="tableInfo"> 
+                    <object idref="TableDesc0"/> 
+                   </void> 
+                   <void property="totalFiles"> 
+                    <int>1</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="operatorId"> 
+                  <string>FS_4</string> 
+                 </void> 
+                 <void property="parentOperators"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                      <void property="destTableId"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="dirName"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="gatherStats"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="lbCtx"> 
-                       <object idref="ListBucketingCtx0"/> 
-                      </void> 
-                      <void property="maxStatsKeyPrefixLength"> 
-                       <int>150</int> 
-                      </void> 
-                      <void property="numFiles"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="statsAggPrefix"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="statsCollectRawDataSize"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="tableInfo"> 
-                       <object idref="TableDesc0"/> 
-                      </void> 
-                      <void property="totalFiles"> 
-                       <int>1</int> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="operatorId"> 
-                     <string>FS_4</string> 
-                    </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="SelectOperator0"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="schema"> 
-                     <object idref="RowSchema0"/> 
-                    </void> 
-                   </object> 
+                   <object idref="SelectOperator0"/> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="columnExprMap"> 
-                 <object class="java.util.HashMap"> 
-                  <void method="put"> 
-                   <string>_col1</string> 
-                   <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>value</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>s</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
+                 </void> 
+                 <void property="schema"> 
+                  <object idref="RowSchema0"/> 
+                 </void> 
+                </object> 
+               </void> 
+              </void> 
+              <void property="columnExprMap"> 
+               <object class="java.util.HashMap"> 
+                <void method="put"> 
+                 <string>_col1</string> 
+                 <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>value</string> 
                   </void> 
-                  <void method="put"> 
-                   <string>_col0</string> 
-                   <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>key</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>s</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                      <void property="typeName"> 
-                       <string>int</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                  <void property="tabAlias"> 
+                   <string>s</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                  <void property="colList"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc1"/> 
-                    </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc0"/> 
-                    </void> 
-                   </object> 
+                <void method="put"> 
+                 <string>_col0</string> 
+                 <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>key</string> 
                   </void> 
-                  <void property="outputColumnNames"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <string>_col0</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col1</string> 
+                  <void property="tabAlias"> 
+                   <string>s</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                    <void property="typeName"> 
+                     <string>int</string> 
                     </void> 
                    </object> 
                   </void> 
-                  <void property="selectStar"> 
-                   <boolean>true</boolean> 
-                  </void> 
                  </object> 
                 </void> 
-                <void property="operatorId"> 
-                 <string>SEL_3</string> 
-                </void> 
-                <void property="parentOperators"> 
+               </object> 
+              </void> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                <void property="colList"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object idref="FilterOperator0"/> 
+                   <object idref="ExprNodeColumnDesc1"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object idref="ExprNodeColumnDesc0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>s</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo1"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>int</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>s</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                <void property="outputColumnNames"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <string>_col0</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col1</string> 
                   </void> 
                  </object> 
                 </void> 
+                <void property="selectStar"> 
+                 <boolean>true</boolean> 
+                </void> 
                </object> 
               </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-              <void property="predicate"> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
+              <void property="operatorId"> 
+               <string>SEL_3</string> 
+              </void> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="FilterOperator0"/> 
+               </void> 
+              </void> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                        <void property="children"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                            <void property="children"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                                <void property="children"> 
-                                 <object class="java.util.ArrayList"> 
-                                  <void method="add"> 
-                                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                                    <void property="column"> 
-                                     <string>key</string> 
-                                    </void> 
-                                    <void property="tabAlias"> 
-                                     <string>s</string> 
-                                    </void> 
-                                    <void property="typeInfo"> 
-                                     <object idref="PrimitiveTypeInfo1"/> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void property="genericUDF"> 
-                                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFHash"/> 
-                                </void> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo1"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo1"/> 
-                                </void> 
-                                <void property="value"> 
-                                 <int>2147483647</int> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="genericUDF"> 
-                             <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                              <void property="operator"> 
-                               <boolean>true</boolean> 
-                              </void> 
-                              <void property="udfClassName"> 
-                               <string>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</string> 
-                              </void> 
-                              <void property="udfName"> 
-                               <string>&amp;</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                            <void property="value"> 
-                             <int>4</int> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="genericUDF"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPMod"/> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>0</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string>s</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual"/> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo1"/> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                      <void property="typeName"> 
-                       <string>boolean</string> 
-                      </void> 
-                     </object> 
+                    <void property="typeName"> 
+                     <string>int</string> 
                     </void> 
                    </object> 
                   </void> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>s</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>100</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col1</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string>s</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan"/> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                    <void property="typeName"> 
+                     <string>string</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo2"/> 
-                </void> 
                </object> 
               </void> 
              </object> 
             </void> 
-            <void property="operatorId"> 
-             <string>FIL_5</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator1"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>key</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>s</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo1"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>int</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>value</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>s</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
+             <void property="predicate"> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                   <void property="children"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                       <void property="children"> 
+                        <object class="java.util.ArrayList"> 
+                         <void method="add"> 
+                          <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                           <void property="children"> 
+                            <object class="java.util.ArrayList"> 
+                             <void method="add"> 
+                              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                               <void property="children"> 
+                                <object class="java.util.ArrayList"> 
+                                 <void method="add"> 
+                                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                                   <void property="column"> 
+                                    <string>key</string> 
+                                   </void> 
+                                   <void property="tabAlias"> 
+                                    <string>s</string> 
+                                   </void> 
+                                   <void property="typeInfo"> 
+                                    <object idref="PrimitiveTypeInfo1"/> 
+                                   </void> 
+                                  </object> 
+                                 </void> 
+                                </object> 
+                               </void> 
+                               <void property="genericUDF"> 
+                                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFHash"/> 
+                               </void> 
+                               <void property="typeInfo"> 
+                                <object idref="PrimitiveTypeInfo1"/> 
+                               </void> 
+                              </object> 
+                             </void> 
+                             <void method="add"> 
+                              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                               <void property="typeInfo"> 
+                                <object idref="PrimitiveTypeInfo1"/> 
+                               </void> 
+                               <void property="value"> 
+                                <int>2147483647</int> 
+                               </void> 
+                              </object> 
+                             </void> 
+                            </object> 
+                           </void> 
+                           <void property="genericUDF"> 
+                            <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                             <void property="operator"> 
+                              <boolean>true</boolean> 
+                             </void> 
+                             <void property="udfClassName"> 
+                              <string>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</string> 
+                             </void> 
+                             <void property="udfName"> 
+                              <string>&amp;</string> 
+                             </void> 
+                            </object> 
+                           </void> 
+                           <void property="typeInfo"> 
+                            <object idref="PrimitiveTypeInfo1"/> 
+                           </void> 
+                          </object> 
+                         </void> 
+                         <void method="add"> 
+                          <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                           <void property="typeInfo"> 
+                            <object idref="PrimitiveTypeInfo1"/> 
+                           </void> 
+                           <void property="value"> 
+                            <int>4</int> 
+                           </void> 
+                          </object> 
+                         </void> 
+                        </object> 
+                       </void> 
+                       <void property="genericUDF"> 
+                        <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPMod"/> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo1"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo1"/> 
+                       </void> 
+                       <void property="value"> 
+                        <int>0</int> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="genericUDF"> 
+                    <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual"/> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                     <void property="typeName"> 
+                      <string>boolean</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                   <void property="children"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                       <void property="column"> 
+                        <string>key</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string>s</string> 
+                       </void> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo1"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo1"/> 
+                       </void> 
+                       <void property="value"> 
+                        <int>100</int> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="genericUDF"> 
+                    <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan"/> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo2"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo2"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>FIL_5</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator1"/> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>key</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>s</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo1"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>int</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>value</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>s</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
diff --git a/ql/src/test/results/compiler/plan/subq.q.xml b/ql/src/test/results/compiler/plan/subq.q.xml
index 109bd7547d..6f367e0113 100644
--- a/ql/src/test/results/compiler/plan/subq.q.xml
+++ b/ql/src/test/results/compiler/plan/subq.q.xml
@@ -44,109 +44,105 @@
                        #### A masked pattern was here #### 
                        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                         <void property="childOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                            <void property="conf"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                              <void property="dirName"> 
-                               #### A masked pattern was here #### 
-                              </void> 
-                              <void property="numFiles"> 
-                               <int>1</int> 
-                              </void> 
-                              <void property="tableInfo"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                                <void property="inputFileFormatClass"> 
-                                 <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-                                </void> 
-                                <void property="outputFileFormatClass"> 
-                                 <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-                                </void> 
-                                <void property="properties"> 
-                                 <object class="java.util.Properties"> 
-                                  <void method="put"> 
-                                   <string>columns</string> 
-                                   <string>_col0,_col1</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.lib</string> 
-                                   <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.format</string> 
-                                   <string>1</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>columns.types</string> 
-                                   <string>string:string</string> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void property="totalFiles"> 
-                               <int>1</int> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="operatorId"> 
-                             <string>FS_7</string> 
-                            </void> 
-                            <void property="parentOperators"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object idref="TableScanOperator0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="schema"> 
-                             <object id="RowSchema0" class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                              <void property="signature"> 
-                               <object class="java.util.ArrayList"> 
-                                <void method="add"> 
-                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                  <void property="internalName"> 
-                                   <string>_col0</string> 
-                                  </void> 
-                                  <void property="tabAlias"> 
-                                   <string></string> 
-                                  </void> 
-                                  <void property="type"> 
-                                   <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                                    <void property="typeName"> 
-                                     <string>string</string> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                  <void property="typeName"> 
-                                   <string>string</string> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void method="add"> 
-                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                  <void property="internalName"> 
-                                   <string>_col1</string> 
-                                  </void> 
-                                  <void property="tabAlias"> 
-                                   <string></string> 
-                                  </void> 
-                                  <void property="type"> 
-                                   <object idref="PrimitiveTypeInfo0"/> 
-                                  </void> 
-                                  <void property="typeName"> 
-                                   <string>string</string> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
+                         <void method="add"> 
+                          <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                           <void property="conf"> 
+                            <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                             <void property="dirName"> 
+                              #### A masked pattern was here #### 
+                             </void> 
+                             <void property="numFiles"> 
+                              <int>1</int> 
+                             </void> 
+                             <void property="tableInfo"> 
+                              <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                               <void property="inputFileFormatClass"> 
+                                <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                               </void> 
+                               <void property="outputFileFormatClass"> 
+                                <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                               </void> 
+                               <void property="properties"> 
+                                <object class="java.util.Properties"> 
+                                 <void method="put"> 
+                                  <string>columns</string> 
+                                  <string>_col0,_col1</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.lib</string> 
+                                  <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.format</string> 
+                                  <string>1</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>columns.types</string> 
+                                  <string>string:string</string> 
+                                 </void> 
+                                </object> 
+                               </void> 
+                              </object> 
+                             </void> 
+                             <void property="totalFiles"> 
+                              <int>1</int> 
+                             </void> 
+                            </object> 
+                           </void> 
+                           <void property="operatorId"> 
+                            <string>FS_7</string> 
+                           </void> 
+                           <void property="parentOperators"> 
+                            <void method="add"> 
+                             <object idref="TableScanOperator0"/> 
                             </void> 
-                           </object> 
-                          </void> 
-                         </object> 
+                           </void> 
+                           <void property="schema"> 
+                            <object id="RowSchema0" class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                             <void property="signature"> 
+                              <object class="java.util.ArrayList"> 
+                               <void method="add"> 
+                                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                 <void property="internalName"> 
+                                  <string>_col0</string> 
+                                 </void> 
+                                 <void property="tabAlias"> 
+                                  <string></string> 
+                                 </void> 
+                                 <void property="type"> 
+                                  <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                                   <void property="typeName"> 
+                                    <string>string</string> 
+                                   </void> 
+                                  </object> 
+                                 </void> 
+                                 <void property="typeName"> 
+                                  <string>string</string> 
+                                 </void> 
+                                </object> 
+                               </void> 
+                               <void method="add"> 
+                                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                 <void property="internalName"> 
+                                  <string>_col1</string> 
+                                 </void> 
+                                 <void property="tabAlias"> 
+                                  <string></string> 
+                                 </void> 
+                                 <void property="type"> 
+                                  <object idref="PrimitiveTypeInfo0"/> 
+                                 </void> 
+                                 <void property="typeName"> 
+                                  <string>string</string> 
+                                 </void> 
+                                </object> 
+                               </void> 
+                              </object> 
+                             </void> 
+                            </object> 
+                           </void> 
+                          </object> 
+                         </void> 
                         </void> 
                         <void property="conf"> 
                          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"/> 
@@ -525,280 +521,268 @@
        <string>unioninput:src</string> 
        <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                <void property="childOperators"> 
-                 <object class="java.util.ArrayList"> 
+         <void method="add"> 
+          <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+              <void property="childOperators"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                 <void property="conf"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                   <void property="destTableId"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="dirName"> 
+                    #### A masked pattern was here #### 
+                   </void> 
+                   <void property="numFiles"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="statsAggPrefix"> 
+                    #### A masked pattern was here #### 
+                   </void> 
+                   <void property="statsCollectRawDataSize"> 
+                    <boolean>true</boolean> 
+                   </void> 
+                   <void property="tableInfo"> 
+                    <object idref="TableDesc0"/> 
+                   </void> 
+                   <void property="totalFiles"> 
+                    <int>1</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="operatorId"> 
+                  <string>FS_4</string> 
+                 </void> 
+                 <void property="parentOperators"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                      <void property="destTableId"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="dirName"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="numFiles"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="statsAggPrefix"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="statsCollectRawDataSize"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="tableInfo"> 
-                       <object idref="TableDesc0"/> 
-                      </void> 
-                      <void property="totalFiles"> 
-                       <int>1</int> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="operatorId"> 
-                     <string>FS_4</string> 
-                    </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="SelectOperator0"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="schema"> 
-                     <object idref="RowSchema0"/> 
-                    </void> 
-                   </object> 
+                   <object idref="SelectOperator0"/> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="columnExprMap"> 
-                 <object class="java.util.HashMap"> 
-                  <void method="put"> 
-                   <string>_col1</string> 
-                   <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>value</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>src</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
+                 </void> 
+                 <void property="schema"> 
+                  <object idref="RowSchema0"/> 
+                 </void> 
+                </object> 
+               </void> 
+              </void> 
+              <void property="columnExprMap"> 
+               <object class="java.util.HashMap"> 
+                <void method="put"> 
+                 <string>_col1</string> 
+                 <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>value</string> 
                   </void> 
-                  <void method="put"> 
-                   <string>_col0</string> 
-                   <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>key</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>src</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
+                  <void property="tabAlias"> 
+                   <string>src</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                  <void property="colList"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc1"/> 
-                    </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc0"/> 
-                    </void> 
-                   </object> 
+                <void method="put"> 
+                 <string>_col0</string> 
+                 <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>key</string> 
                   </void> 
-                  <void property="outputColumnNames"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <string>_col0</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col1</string> 
-                    </void> 
-                   </object> 
+                  <void property="tabAlias"> 
+                   <string>src</string> 
                   </void> 
-                  <void property="selectStar"> 
-                   <boolean>true</boolean> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="operatorId"> 
-                 <string>SEL_2</string> 
-                </void> 
-                <void property="parentOperators"> 
+               </object> 
+              </void> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                <void property="colList"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object idref="FilterOperator0"/> 
+                   <object idref="ExprNodeColumnDesc1"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object idref="ExprNodeColumnDesc0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="alias"> 
-                       <string>key</string> 
-                      </void> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>src</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="alias"> 
-                       <string>value</string> 
-                      </void> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>src</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                <void property="outputColumnNames"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <string>_col0</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col1</string> 
                   </void> 
                  </object> 
                 </void> 
+                <void property="selectStar"> 
+                 <boolean>true</boolean> 
+                </void> 
                </object> 
               </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-              <void property="predicate"> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
+              <void property="operatorId"> 
+               <string>SEL_2</string> 
+              </void> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="FilterOperator0"/> 
+               </void> 
+              </void> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="alias"> 
                      <string>key</string> 
                     </void> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
+                    </void> 
                     <void property="tabAlias"> 
                      <string>src</string> 
                     </void> 
-                    <void property="typeInfo"> 
+                    <void property="type"> 
                      <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
                    </object> 
                   </void> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
-                     <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                      <void property="typeName"> 
-                       <string>int</string> 
-                      </void> 
-                     </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="alias"> 
+                     <string>value</string> 
+                    </void> 
+                    <void property="internalName"> 
+                     <string>_col1</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string>src</string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                    <void property="value"> 
-                     <int>100</int> 
+                    <void property="typeName"> 
+                     <string>string</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                  <void property="typeName"> 
-                   <string>boolean</string> 
-                  </void> 
-                 </object> 
-                </void> 
                </object> 
               </void> 
              </object> 
             </void> 
-            <void property="operatorId"> 
-             <string>FIL_5</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator1"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>key</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>value</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
+             <void property="predicate"> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                   <void property="column"> 
+                    <string>key</string> 
+                   </void> 
+                   <void property="tabAlias"> 
+                    <string>src</string> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo0"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                     <void property="typeName"> 
+                      <string>int</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="value"> 
+                    <int>100</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                 <void property="typeName"> 
+                  <string>boolean</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>FIL_5</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator1"/> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>key</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>value</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
diff --git a/ql/src/test/results/compiler/plan/udf1.q.xml b/ql/src/test/results/compiler/plan/udf1.q.xml
index 954655bfc7..76e25e1bc6 100644
--- a/ql/src/test/results/compiler/plan/udf1.q.xml
+++ b/ql/src/test/results/compiler/plan/udf1.q.xml
@@ -153,1663 +153,1651 @@
        <string>src</string> 
        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                <void property="childOperators"> 
-                 <object class="java.util.ArrayList"> 
+         <void method="add"> 
+          <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+              <void property="childOperators"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                 <void property="conf"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                   <void property="dirName"> 
+                    #### A masked pattern was here #### 
+                   </void> 
+                   <void property="numFiles"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="statsAggPrefix"> 
+                    #### A masked pattern was here #### 
+                   </void> 
+                   <void property="statsCollectRawDataSize"> 
+                    <boolean>true</boolean> 
+                   </void> 
+                   <void property="tableInfo"> 
+                    <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                     <void property="inputFileFormatClass"> 
+                      <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                     </void> 
+                     <void property="outputFileFormatClass"> 
+                      <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                     </void> 
+                     <void property="properties"> 
+                      <object class="java.util.Properties"> 
+                       <void method="put"> 
+                        <string>hive.serialization.extend.nesting.levels</string> 
+                        <string>true</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns</string> 
+                        <string>_col0,_col1,_col2,_col3,_col4,_col5,_col6,_col7,_col8,_col9,_col10,_col11,_col12,_col13,_col14,_col15,_col16</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.lib</string> 
+                        <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.format</string> 
+                        <string>1</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns.types</string> 
+                        <string>boolean:boolean:boolean:boolean:boolean:boolean:boolean:boolean:boolean:boolean:boolean:boolean:boolean:string:string:string:string</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>escape.delim</string> 
+                        <string>\</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="totalFiles"> 
+                    <int>1</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="operatorId"> 
+                  <string>FS_3</string> 
+                 </void> 
+                 <void property="parentOperators"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                      <void property="dirName"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="numFiles"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="statsAggPrefix"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="statsCollectRawDataSize"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="tableInfo"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                        <void property="inputFileFormatClass"> 
-                         <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-                        </void> 
-                        <void property="outputFileFormatClass"> 
-                         <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-                        </void> 
-                        <void property="properties"> 
-                         <object class="java.util.Properties"> 
-                          <void method="put"> 
-                           <string>hive.serialization.extend.nesting.levels</string> 
-                           <string>true</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns</string> 
-                           <string>_col0,_col1,_col2,_col3,_col4,_col5,_col6,_col7,_col8,_col9,_col10,_col11,_col12,_col13,_col14,_col15,_col16</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.lib</string> 
-                           <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.format</string> 
-                           <string>1</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns.types</string> 
-                           <string>boolean:boolean:boolean:boolean:boolean:boolean:boolean:boolean:boolean:boolean:boolean:boolean:boolean:string:string:string:string</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>escape.delim</string> 
-                           <string>\</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="totalFiles"> 
-                       <int>1</int> 
+                   <object idref="SelectOperator0"/> 
+                  </void> 
+                 </void> 
+                 <void property="schema"> 
+                  <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                   <void property="signature"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>_col0</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string></string> 
+                       </void> 
+                       <void property="type"> 
+                        <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                         <void property="typeName"> 
+                          <string>boolean</string> 
+                         </void> 
+                        </object> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>boolean</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>_col1</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string></string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>boolean</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>_col2</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string></string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>boolean</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>_col3</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string></string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>boolean</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>_col4</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string></string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>boolean</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>_col5</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string></string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>boolean</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>_col6</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string></string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>boolean</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>_col7</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string></string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>boolean</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>_col8</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string></string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>boolean</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>_col9</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string></string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>boolean</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>_col10</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string></string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>boolean</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>_col11</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string></string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>boolean</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>_col12</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string></string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>boolean</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>_col13</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string></string> 
+                       </void> 
+                       <void property="type"> 
+                        <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                         <void property="typeName"> 
+                          <string>string</string> 
+                         </void> 
+                        </object> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>_col14</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string></string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo1"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>_col15</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string></string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo1"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>_col16</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string></string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo1"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+              </void> 
+              <void property="columnExprMap"> 
+               <object class="java.util.HashMap"> 
+                <void method="put"> 
+                 <string>_col8</string> 
+                 <object id="ExprNodeGenericFuncDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                  <void property="children"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
-                     </object> 
-                    </void> 
-                    <void property="operatorId"> 
-                     <string>FS_3</string> 
-                    </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="SelectOperator0"/> 
+                      <void property="value"> 
+                       <string></string> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="schema"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                      <void property="signature"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col0</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string></string> 
-                          </void> 
-                          <void property="type"> 
-                           <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                            <void property="typeName"> 
-                             <string>boolean</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>boolean</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col1</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string></string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>boolean</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col2</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string></string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>boolean</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col3</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string></string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>boolean</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col4</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string></string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>boolean</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col5</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string></string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>boolean</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col6</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string></string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>boolean</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col7</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string></string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>boolean</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col8</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string></string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>boolean</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col9</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string></string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>boolean</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col10</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string></string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>boolean</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col11</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string></string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>boolean</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col12</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string></string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>boolean</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col13</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string></string> 
-                          </void> 
-                          <void property="type"> 
-                           <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                            <void property="typeName"> 
-                             <string>string</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col14</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string></string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo1"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col15</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string></string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo1"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col16</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string></string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo1"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>string</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
+                      </void> 
+                      <void property="value"> 
+                       <string>.*</string> 
                       </void> 
                      </object> 
                     </void> 
                    </object> 
                   </void> 
+                  <void property="genericUDF"> 
+                   <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                    <void property="operator"> 
+                     <boolean>true</boolean> 
+                    </void> 
+                    <void property="udfClassName"> 
+                     <string>org.apache.hadoop.hive.ql.udf.UDFRegExp</string> 
+                    </void> 
+                    <void property="udfName"> 
+                     <string>rlike</string> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
                  </object> 
                 </void> 
-                <void property="columnExprMap"> 
-                 <object class="java.util.HashMap"> 
-                  <void method="put"> 
-                   <string>_col8</string> 
-                   <object id="ExprNodeGenericFuncDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <string></string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <string>.*</string> 
-                        </void> 
-                       </object> 
+                <void method="put"> 
+                 <string>_col7</string> 
+                 <object id="ExprNodeGenericFuncDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                  <void property="children"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
+                      </void> 
+                      <void property="value"> 
+                       <string>ab</string> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                      <void property="operator"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="udfClassName"> 
-                       <string>org.apache.hadoop.hive.ql.udf.UDFRegExp</string> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
-                      <void property="udfName"> 
-                       <string>rlike</string> 
+                      <void property="value"> 
+                       <string>a</string> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
                    </object> 
                   </void> 
-                  <void method="put"> 
-                   <string>_col7</string> 
-                   <object id="ExprNodeGenericFuncDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <string>ab</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <string>a</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                  <void property="genericUDF"> 
+                   <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                    <void property="operator"> 
+                     <boolean>true</boolean> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                      <void property="operator"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="udfClassName"> 
-                       <string>org.apache.hadoop.hive.ql.udf.UDFLike</string> 
-                      </void> 
-                      <void property="udfName"> 
-                       <string>like</string> 
-                      </void> 
-                     </object> 
+                    <void property="udfClassName"> 
+                     <string>org.apache.hadoop.hive.ql.udf.UDFLike</string> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
+                    <void property="udfName"> 
+                     <string>like</string> 
                     </void> 
                    </object> 
                   </void> 
-                  <void method="put"> 
-                   <string>_col6</string> 
-                   <object id="ExprNodeGenericFuncDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <string>ab</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <string>_a%</string> 
-                        </void> 
-                       </object> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void method="put"> 
+                 <string>_col6</string> 
+                 <object id="ExprNodeGenericFuncDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                  <void property="children"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
+                      </void> 
+                      <void property="value"> 
+                       <string>ab</string> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                      <void property="operator"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="udfClassName"> 
-                       <string>org.apache.hadoop.hive.ql.udf.UDFLike</string> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
-                      <void property="udfName"> 
-                       <string>like</string> 
+                      <void property="value"> 
+                       <string>_a%</string> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
                    </object> 
                   </void> 
-                  <void method="put"> 
-                   <string>_col5</string> 
-                   <object id="ExprNodeGenericFuncDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <string>ab</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <string>\%\_</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                  <void property="genericUDF"> 
+                   <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                    <void property="operator"> 
+                     <boolean>true</boolean> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                      <void property="operator"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="udfClassName"> 
-                       <string>org.apache.hadoop.hive.ql.udf.UDFLike</string> 
-                      </void> 
-                      <void property="udfName"> 
-                       <string>like</string> 
-                      </void> 
-                     </object> 
+                    <void property="udfClassName"> 
+                     <string>org.apache.hadoop.hive.ql.udf.UDFLike</string> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
+                    <void property="udfName"> 
+                     <string>like</string> 
                     </void> 
                    </object> 
                   </void> 
-                  <void method="put"> 
-                   <string>_col4</string> 
-                   <object id="ExprNodeGenericFuncDesc4" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <string>%_</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <string>\%\_</string> 
-                        </void> 
-                       </object> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void method="put"> 
+                 <string>_col5</string> 
+                 <object id="ExprNodeGenericFuncDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                  <void property="children"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
+                      </void> 
+                      <void property="value"> 
+                       <string>ab</string> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                      <void property="operator"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="udfClassName"> 
-                       <string>org.apache.hadoop.hive.ql.udf.UDFLike</string> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
-                      <void property="udfName"> 
-                       <string>like</string> 
+                      <void property="value"> 
+                       <string>\%\_</string> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
                    </object> 
                   </void> 
-                  <void method="put"> 
-                   <string>_col3</string> 
-                   <object id="ExprNodeGenericFuncDesc5" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <string>ab</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <string>%a_</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                  <void property="genericUDF"> 
+                   <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                    <void property="operator"> 
+                     <boolean>true</boolean> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                      <void property="operator"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="udfClassName"> 
-                       <string>org.apache.hadoop.hive.ql.udf.UDFLike</string> 
-                      </void> 
-                      <void property="udfName"> 
-                       <string>like</string> 
-                      </void> 
-                     </object> 
+                    <void property="udfClassName"> 
+                     <string>org.apache.hadoop.hive.ql.udf.UDFLike</string> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
+                    <void property="udfName"> 
+                     <string>like</string> 
                     </void> 
                    </object> 
                   </void> 
-                  <void method="put"> 
-                   <string>_col2</string> 
-                   <object id="ExprNodeGenericFuncDesc6" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <string>ab</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <string>%a%</string> 
-                        </void> 
-                       </object> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void method="put"> 
+                 <string>_col4</string> 
+                 <object id="ExprNodeGenericFuncDesc4" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                  <void property="children"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
+                      </void> 
+                      <void property="value"> 
+                       <string>%_</string> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                      <void property="operator"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="udfClassName"> 
-                       <string>org.apache.hadoop.hive.ql.udf.UDFLike</string> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
-                      <void property="udfName"> 
-                       <string>like</string> 
+                      <void property="value"> 
+                       <string>\%\_</string> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
                    </object> 
                   </void> 
-                  <void method="put"> 
-                   <string>_col1</string> 
-                   <object id="ExprNodeGenericFuncDesc7" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <string>b</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <string>%a%</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                  <void property="genericUDF"> 
+                   <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                    <void property="operator"> 
+                     <boolean>true</boolean> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                      <void property="operator"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="udfClassName"> 
-                       <string>org.apache.hadoop.hive.ql.udf.UDFLike</string> 
-                      </void> 
-                      <void property="udfName"> 
-                       <string>like</string> 
-                      </void> 
-                     </object> 
+                    <void property="udfClassName"> 
+                     <string>org.apache.hadoop.hive.ql.udf.UDFLike</string> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
+                    <void property="udfName"> 
+                     <string>like</string> 
                     </void> 
                    </object> 
                   </void> 
-                  <void method="put"> 
-                   <string>_col9</string> 
-                   <object id="ExprNodeGenericFuncDesc8" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <string>a</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <string>[ab]</string> 
-                        </void> 
-                       </object> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void method="put"> 
+                 <string>_col3</string> 
+                 <object id="ExprNodeGenericFuncDesc5" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                  <void property="children"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
+                      </void> 
+                      <void property="value"> 
+                       <string>ab</string> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                      <void property="operator"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="udfClassName"> 
-                       <string>org.apache.hadoop.hive.ql.udf.UDFRegExp</string> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
-                      <void property="udfName"> 
-                       <string>rlike</string> 
+                      <void property="value"> 
+                       <string>%a_</string> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
+                   </object> 
+                  </void> 
+                  <void property="genericUDF"> 
+                   <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                    <void property="operator"> 
+                     <boolean>true</boolean> 
+                    </void> 
+                    <void property="udfClassName"> 
+                     <string>org.apache.hadoop.hive.ql.udf.UDFLike</string> 
+                    </void> 
+                    <void property="udfName"> 
+                     <string>like</string> 
                     </void> 
                    </object> 
                   </void> 
-                  <void method="put"> 
-                   <string>_col13</string> 
-                   <object id="ExprNodeGenericFuncDesc9" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <string>abc</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <string>b</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <string>c</string> 
-                        </void> 
-                       </object> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void method="put"> 
+                 <string>_col2</string> 
+                 <object id="ExprNodeGenericFuncDesc6" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                  <void property="children"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
+                      </void> 
+                      <void property="value"> 
+                       <string>ab</string> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                      <void property="udfClassName"> 
-                       <string>org.apache.hadoop.hive.ql.udf.UDFRegExpReplace</string> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
-                      <void property="udfName"> 
-                       <string>regexp_replace</string> 
+                      <void property="value"> 
+                       <string>%a%</string> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
+                   </object> 
+                  </void> 
+                  <void property="genericUDF"> 
+                   <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                    <void property="operator"> 
+                     <boolean>true</boolean> 
+                    </void> 
+                    <void property="udfClassName"> 
+                     <string>org.apache.hadoop.hive.ql.udf.UDFLike</string> 
+                    </void> 
+                    <void property="udfName"> 
+                     <string>like</string> 
                     </void> 
                    </object> 
                   </void> 
-                  <void method="put"> 
-                   <string>_col12</string> 
-                   <object id="ExprNodeGenericFuncDesc10" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <string>hadoop</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <string>o*</string> 
-                        </void> 
-                       </object> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void method="put"> 
+                 <string>_col1</string> 
+                 <object id="ExprNodeGenericFuncDesc7" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                  <void property="children"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
+                      </void> 
+                      <void property="value"> 
+                       <string>b</string> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                      <void property="operator"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="udfClassName"> 
-                       <string>org.apache.hadoop.hive.ql.udf.UDFRegExp</string> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
-                      <void property="udfName"> 
-                       <string>rlike</string> 
+                      <void property="value"> 
+                       <string>%a%</string> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
+                   </object> 
+                  </void> 
+                  <void property="genericUDF"> 
+                   <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                    <void property="operator"> 
+                     <boolean>true</boolean> 
+                    </void> 
+                    <void property="udfClassName"> 
+                     <string>org.apache.hadoop.hive.ql.udf.UDFLike</string> 
+                    </void> 
+                    <void property="udfName"> 
+                     <string>like</string> 
                     </void> 
                    </object> 
                   </void> 
-                  <void method="put"> 
-                   <string>_col11</string> 
-                   <object id="ExprNodeGenericFuncDesc11" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <string>hadoop</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <string>[a-z]*</string> 
-                        </void> 
-                       </object> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void method="put"> 
+                 <string>_col9</string> 
+                 <object id="ExprNodeGenericFuncDesc8" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                  <void property="children"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
+                      </void> 
+                      <void property="value"> 
+                       <string>a</string> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                      <void property="operator"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="udfClassName"> 
-                       <string>org.apache.hadoop.hive.ql.udf.UDFRegExp</string> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
-                      <void property="udfName"> 
-                       <string>rlike</string> 
+                      <void property="value"> 
+                       <string>[ab]</string> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
+                   </object> 
+                  </void> 
+                  <void property="genericUDF"> 
+                   <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                    <void property="operator"> 
+                     <boolean>true</boolean> 
+                    </void> 
+                    <void property="udfClassName"> 
+                     <string>org.apache.hadoop.hive.ql.udf.UDFRegExp</string> 
+                    </void> 
+                    <void property="udfName"> 
+                     <string>rlike</string> 
                     </void> 
                    </object> 
                   </void> 
-                  <void method="put"> 
-                   <string>_col10</string> 
-                   <object id="ExprNodeGenericFuncDesc12" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <string></string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <string>[ab]</string> 
-                        </void> 
-                       </object> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void method="put"> 
+                 <string>_col13</string> 
+                 <object id="ExprNodeGenericFuncDesc9" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                  <void property="children"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
+                      </void> 
+                      <void property="value"> 
+                       <string>abc</string> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                      <void property="operator"> 
-                       <boolean>true</boolean> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
+                      </void> 
+                      <void property="value"> 
+                       <string>b</string> 
                       </void> 
-                      <void property="udfClassName"> 
-                       <string>org.apache.hadoop.hive.ql.udf.UDFRegExp</string> 
+                     </object> 
+                    </void> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
-                      <void property="udfName"> 
-                       <string>rlike</string> 
+                      <void property="value"> 
+                       <string>c</string> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
+                   </object> 
+                  </void> 
+                  <void property="genericUDF"> 
+                   <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                    <void property="udfClassName"> 
+                     <string>org.apache.hadoop.hive.ql.udf.UDFRegExpReplace</string> 
+                    </void> 
+                    <void property="udfName"> 
+                     <string>regexp_replace</string> 
                     </void> 
                    </object> 
                   </void> 
-                  <void method="put"> 
-                   <string>_col16</string> 
-                   <object id="ExprNodeGenericFuncDesc13" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <string>hadoop</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <string>(.)[a-z]*</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <string>$1ive</string> 
-                        </void> 
-                       </object> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo1"/> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void method="put"> 
+                 <string>_col12</string> 
+                 <object id="ExprNodeGenericFuncDesc10" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                  <void property="children"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
+                      </void> 
+                      <void property="value"> 
+                       <string>hadoop</string> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                      <void property="udfClassName"> 
-                       <string>org.apache.hadoop.hive.ql.udf.UDFRegExpReplace</string> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
-                      <void property="udfName"> 
-                       <string>regexp_replace</string> 
+                      <void property="value"> 
+                       <string>o*</string> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
+                   </object> 
+                  </void> 
+                  <void property="genericUDF"> 
+                   <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                    <void property="operator"> 
+                     <boolean>true</boolean> 
+                    </void> 
+                    <void property="udfClassName"> 
+                     <string>org.apache.hadoop.hive.ql.udf.UDFRegExp</string> 
+                    </void> 
+                    <void property="udfName"> 
+                     <string>rlike</string> 
                     </void> 
                    </object> 
                   </void> 
-                  <void method="put"> 
-                   <string>_col15</string> 
-                   <object id="ExprNodeGenericFuncDesc14" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <string>abbbb</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <string>bb</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <string>b</string> 
-                        </void> 
-                       </object> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void method="put"> 
+                 <string>_col11</string> 
+                 <object id="ExprNodeGenericFuncDesc11" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                  <void property="children"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
+                      </void> 
+                      <void property="value"> 
+                       <string>hadoop</string> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                      <void property="udfClassName"> 
-                       <string>org.apache.hadoop.hive.ql.udf.UDFRegExpReplace</string> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
-                      <void property="udfName"> 
-                       <string>regexp_replace</string> 
+                      <void property="value"> 
+                       <string>[a-z]*</string> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
+                   </object> 
+                  </void> 
+                  <void property="genericUDF"> 
+                   <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                    <void property="operator"> 
+                     <boolean>true</boolean> 
+                    </void> 
+                    <void property="udfClassName"> 
+                     <string>org.apache.hadoop.hive.ql.udf.UDFRegExp</string> 
+                    </void> 
+                    <void property="udfName"> 
+                     <string>rlike</string> 
                     </void> 
                    </object> 
                   </void> 
-                  <void method="put"> 
-                   <string>_col14</string> 
-                   <object id="ExprNodeGenericFuncDesc15" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <string>abc</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <string>z</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <string>a</string> 
-                        </void> 
-                       </object> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void method="put"> 
+                 <string>_col10</string> 
+                 <object id="ExprNodeGenericFuncDesc12" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                  <void property="children"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
+                      </void> 
+                      <void property="value"> 
+                       <string></string> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                      <void property="udfClassName"> 
-                       <string>org.apache.hadoop.hive.ql.udf.UDFRegExpReplace</string> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
-                      <void property="udfName"> 
-                       <string>regexp_replace</string> 
+                      <void property="value"> 
+                       <string>[ab]</string> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
+                   </object> 
+                  </void> 
+                  <void property="genericUDF"> 
+                   <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                    <void property="operator"> 
+                     <boolean>true</boolean> 
+                    </void> 
+                    <void property="udfClassName"> 
+                     <string>org.apache.hadoop.hive.ql.udf.UDFRegExp</string> 
+                    </void> 
+                    <void property="udfName"> 
+                     <string>rlike</string> 
                     </void> 
                    </object> 
                   </void> 
-                  <void method="put"> 
-                   <string>_col0</string> 
-                   <object id="ExprNodeGenericFuncDesc16" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <string>a</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                        <void property="value"> 
-                         <string>%a%</string> 
-                        </void> 
-                       </object> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void method="put"> 
+                 <string>_col16</string> 
+                 <object id="ExprNodeGenericFuncDesc13" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                  <void property="children"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
+                      </void> 
+                      <void property="value"> 
+                       <string>hadoop</string> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                      <void property="operator"> 
-                       <boolean>true</boolean> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
-                      <void property="udfClassName"> 
-                       <string>org.apache.hadoop.hive.ql.udf.UDFLike</string> 
+                      <void property="value"> 
+                       <string>(.)[a-z]*</string> 
                       </void> 
-                      <void property="udfName"> 
-                       <string>like</string> 
+                     </object> 
+                    </void> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
+                      </void> 
+                      <void property="value"> 
+                       <string>$1ive</string> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
+                   </object> 
+                  </void> 
+                  <void property="genericUDF"> 
+                   <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                    <void property="udfClassName"> 
+                     <string>org.apache.hadoop.hive.ql.udf.UDFRegExpReplace</string> 
+                    </void> 
+                    <void property="udfName"> 
+                     <string>regexp_replace</string> 
                     </void> 
                    </object> 
                   </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo1"/> 
+                  </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                  <void property="colList"> 
+                <void method="put"> 
+                 <string>_col15</string> 
+                 <object id="ExprNodeGenericFuncDesc14" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                  <void property="children"> 
                    <object class="java.util.ArrayList"> 
                     <void method="add"> 
-                     <object idref="ExprNodeGenericFuncDesc16"/> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
+                      </void> 
+                      <void property="value"> 
+                       <string>abbbb</string> 
+                      </void> 
+                     </object> 
                     </void> 
                     <void method="add"> 
-                     <object idref="ExprNodeGenericFuncDesc7"/> 
-                    </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeGenericFuncDesc6"/> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
+                      </void> 
+                      <void property="value"> 
+                       <string>bb</string> 
+                      </void> 
+                     </object> 
                     </void> 
                     <void method="add"> 
-                     <object idref="ExprNodeGenericFuncDesc5"/> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
+                      </void> 
+                      <void property="value"> 
+                       <string>b</string> 
+                      </void> 
+                     </object> 
                     </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeGenericFuncDesc4"/> 
+                   </object> 
+                  </void> 
+                  <void property="genericUDF"> 
+                   <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                    <void property="udfClassName"> 
+                     <string>org.apache.hadoop.hive.ql.udf.UDFRegExpReplace</string> 
                     </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeGenericFuncDesc3"/> 
-                    </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeGenericFuncDesc2"/> 
+                    <void property="udfName"> 
+                     <string>regexp_replace</string> 
                     </void> 
+                   </object> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo1"/> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void method="put"> 
+                 <string>_col14</string> 
+                 <object id="ExprNodeGenericFuncDesc15" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                  <void property="children"> 
+                   <object class="java.util.ArrayList"> 
                     <void method="add"> 
-                     <object idref="ExprNodeGenericFuncDesc1"/> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
+                      </void> 
+                      <void property="value"> 
+                       <string>abc</string> 
+                      </void> 
+                     </object> 
                     </void> 
                     <void method="add"> 
-                     <object idref="ExprNodeGenericFuncDesc0"/> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
+                      </void> 
+                      <void property="value"> 
+                       <string>z</string> 
+                      </void> 
+                     </object> 
                     </void> 
                     <void method="add"> 
-                     <object idref="ExprNodeGenericFuncDesc8"/> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
+                      </void> 
+                      <void property="value"> 
+                       <string>a</string> 
+                      </void> 
+                     </object> 
                     </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeGenericFuncDesc12"/> 
+                   </object> 
+                  </void> 
+                  <void property="genericUDF"> 
+                   <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                    <void property="udfClassName"> 
+                     <string>org.apache.hadoop.hive.ql.udf.UDFRegExpReplace</string> 
                     </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeGenericFuncDesc11"/> 
+                    <void property="udfName"> 
+                     <string>regexp_replace</string> 
                     </void> 
+                   </object> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo1"/> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void method="put"> 
+                 <string>_col0</string> 
+                 <object id="ExprNodeGenericFuncDesc16" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                  <void property="children"> 
+                   <object class="java.util.ArrayList"> 
                     <void method="add"> 
-                     <object idref="ExprNodeGenericFuncDesc10"/> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
+                      </void> 
+                      <void property="value"> 
+                       <string>a</string> 
+                      </void> 
+                     </object> 
                     </void> 
                     <void method="add"> 
-                     <object idref="ExprNodeGenericFuncDesc9"/> 
+                     <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                      <void property="typeInfo"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
+                      </void> 
+                      <void property="value"> 
+                       <string>%a%</string> 
+                      </void> 
+                     </object> 
                     </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeGenericFuncDesc15"/> 
+                   </object> 
+                  </void> 
+                  <void property="genericUDF"> 
+                   <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                    <void property="operator"> 
+                     <boolean>true</boolean> 
                     </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeGenericFuncDesc14"/> 
+                    <void property="udfClassName"> 
+                     <string>org.apache.hadoop.hive.ql.udf.UDFLike</string> 
                     </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeGenericFuncDesc13"/> 
+                    <void property="udfName"> 
+                     <string>like</string> 
                     </void> 
                    </object> 
                   </void> 
-                  <void property="outputColumnNames"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
+                </void> 
+               </object> 
+              </void> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                <void property="colList"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object idref="ExprNodeGenericFuncDesc16"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object idref="ExprNodeGenericFuncDesc7"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object idref="ExprNodeGenericFuncDesc6"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object idref="ExprNodeGenericFuncDesc5"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object idref="ExprNodeGenericFuncDesc4"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object idref="ExprNodeGenericFuncDesc3"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object idref="ExprNodeGenericFuncDesc2"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object idref="ExprNodeGenericFuncDesc1"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object idref="ExprNodeGenericFuncDesc0"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object idref="ExprNodeGenericFuncDesc8"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object idref="ExprNodeGenericFuncDesc12"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object idref="ExprNodeGenericFuncDesc11"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object idref="ExprNodeGenericFuncDesc10"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object idref="ExprNodeGenericFuncDesc9"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object idref="ExprNodeGenericFuncDesc15"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object idref="ExprNodeGenericFuncDesc14"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object idref="ExprNodeGenericFuncDesc13"/> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="outputColumnNames"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <string>_col0</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col1</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col2</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col3</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col4</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col5</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col6</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col7</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col8</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col9</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col10</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col11</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col12</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col13</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col14</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col15</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col16</string> 
+                  </void> 
+                 </object> 
+                </void> 
+               </object> 
+              </void> 
+              <void property="operatorId"> 
+               <string>SEL_2</string> 
+              </void> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="FilterOperator0"/> 
+               </void> 
+              </void> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="alias"> 
+                     <string>_c0</string> 
+                    </void> 
+                    <void property="internalName"> 
                      <string>_col0</string> 
                     </void> 
-                    <void method="add"> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>boolean</string> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="alias"> 
+                     <string>_c1</string> 
+                    </void> 
+                    <void property="internalName"> 
                      <string>_col1</string> 
                     </void> 
-                    <void method="add"> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>boolean</string> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="alias"> 
+                     <string>_c2</string> 
+                    </void> 
+                    <void property="internalName"> 
                      <string>_col2</string> 
                     </void> 
-                    <void method="add"> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>boolean</string> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="alias"> 
+                     <string>_c3</string> 
+                    </void> 
+                    <void property="internalName"> 
                      <string>_col3</string> 
                     </void> 
-                    <void method="add"> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>boolean</string> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="alias"> 
+                     <string>_c4</string> 
+                    </void> 
+                    <void property="internalName"> 
                      <string>_col4</string> 
                     </void> 
-                    <void method="add"> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>boolean</string> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="alias"> 
+                     <string>_c5</string> 
+                    </void> 
+                    <void property="internalName"> 
                      <string>_col5</string> 
                     </void> 
-                    <void method="add"> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>boolean</string> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="alias"> 
+                     <string>_c6</string> 
+                    </void> 
+                    <void property="internalName"> 
                      <string>_col6</string> 
                     </void> 
-                    <void method="add"> 
-                     <string>_col7</string> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                    <void method="add"> 
-                     <string>_col8</string> 
+                    <void property="typeName"> 
+                     <string>boolean</string> 
                     </void> 
-                    <void method="add"> 
-                     <string>_col9</string> 
+                   </object> 
+                  </void> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="alias"> 
+                     <string>_c7</string> 
                     </void> 
-                    <void method="add"> 
-                     <string>_col10</string> 
+                    <void property="internalName"> 
+                     <string>_col7</string> 
                     </void> 
-                    <void method="add"> 
-                     <string>_col11</string> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                    <void method="add"> 
-                     <string>_col12</string> 
+                    <void property="typeName"> 
+                     <string>boolean</string> 
                     </void> 
-                    <void method="add"> 
-                     <string>_col13</string> 
+                   </object> 
+                  </void> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="alias"> 
+                     <string>_c8</string> 
                     </void> 
-                    <void method="add"> 
-                     <string>_col14</string> 
+                    <void property="internalName"> 
+                     <string>_col8</string> 
                     </void> 
-                    <void method="add"> 
-                     <string>_col15</string> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                    <void method="add"> 
-                     <string>_col16</string> 
+                    <void property="typeName"> 
+                     <string>boolean</string> 
                     </void> 
                    </object> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="operatorId"> 
-                 <string>SEL_2</string> 
-                </void> 
-                <void property="parentOperators"> 
-                 <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object idref="FilterOperator0"/> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="alias"> 
+                     <string>_c9</string> 
+                    </void> 
+                    <void property="internalName"> 
+                     <string>_col9</string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>boolean</string> 
+                    </void> 
+                   </object> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="alias"> 
-                       <string>_c0</string> 
-                      </void> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>boolean</string> 
-                      </void> 
-                     </object> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="alias"> 
+                     <string>_c10</string> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="alias"> 
-                       <string>_c1</string> 
-                      </void> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>boolean</string> 
-                      </void> 
-                     </object> 
+                    <void property="internalName"> 
+                     <string>_col10</string> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="alias"> 
-                       <string>_c2</string> 
-                      </void> 
-                      <void property="internalName"> 
-                       <string>_col2</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>boolean</string> 
-                      </void> 
-                     </object> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="alias"> 
-                       <string>_c3</string> 
-                      </void> 
-                      <void property="internalName"> 
-                       <string>_col3</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>boolean</string> 
-                      </void> 
-                     </object> 
+                    <void property="typeName"> 
+                     <string>boolean</string> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="alias"> 
-                       <string>_c4</string> 
-                      </void> 
-                      <void property="internalName"> 
-                       <string>_col4</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>boolean</string> 
-                      </void> 
-                     </object> 
+                   </object> 
+                  </void> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="alias"> 
+                     <string>_c11</string> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="alias"> 
-                       <string>_c5</string> 
-                      </void> 
-                      <void property="internalName"> 
-                       <string>_col5</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>boolean</string> 
-                      </void> 
-                     </object> 
+                    <void property="internalName"> 
+                     <string>_col11</string> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="alias"> 
-                       <string>_c6</string> 
-                      </void> 
-                      <void property="internalName"> 
-                       <string>_col6</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>boolean</string> 
-                      </void> 
-                     </object> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="alias"> 
-                       <string>_c7</string> 
-                      </void> 
-                      <void property="internalName"> 
-                       <string>_col7</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>boolean</string> 
-                      </void> 
-                     </object> 
+                    <void property="typeName"> 
+                     <string>boolean</string> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="alias"> 
-                       <string>_c8</string> 
-                      </void> 
-                      <void property="internalName"> 
-                       <string>_col8</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>boolean</string> 
-                      </void> 
-                     </object> 
+                   </object> 
+                  </void> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="alias"> 
+                     <string>_c12</string> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="alias"> 
-                       <string>_c9</string> 
-                      </void> 
-                      <void property="internalName"> 
-                       <string>_col9</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>boolean</string> 
-                      </void> 
-                     </object> 
+                    <void property="internalName"> 
+                     <string>_col12</string> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="alias"> 
-                       <string>_c10</string> 
-                      </void> 
-                      <void property="internalName"> 
-                       <string>_col10</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>boolean</string> 
-                      </void> 
-                     </object> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="alias"> 
-                       <string>_c11</string> 
-                      </void> 
-                      <void property="internalName"> 
-                       <string>_col11</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>boolean</string> 
-                      </void> 
-                     </object> 
+                    <void property="typeName"> 
+                     <string>boolean</string> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="alias"> 
-                       <string>_c12</string> 
-                      </void> 
-                      <void property="internalName"> 
-                       <string>_col12</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>boolean</string> 
-                      </void> 
-                     </object> 
+                   </object> 
+                  </void> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="alias"> 
+                     <string>_c13</string> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="alias"> 
-                       <string>_c13</string> 
-                      </void> 
-                      <void property="internalName"> 
-                       <string>_col13</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo1"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
+                    <void property="internalName"> 
+                     <string>_col13</string> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="alias"> 
-                       <string>_c14</string> 
-                      </void> 
-                      <void property="internalName"> 
-                       <string>_col14</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo1"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo1"/> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="alias"> 
-                       <string>_c15</string> 
-                      </void> 
-                      <void property="internalName"> 
-                       <string>_col15</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo1"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
+                    <void property="typeName"> 
+                     <string>string</string> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="alias"> 
-                       <string>_c16</string> 
-                      </void> 
-                      <void property="internalName"> 
-                       <string>_col16</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo1"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
+                   </object> 
+                  </void> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="alias"> 
+                     <string>_c14</string> 
+                    </void> 
+                    <void property="internalName"> 
+                     <string>_col14</string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo1"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
                     </void> 
                    </object> 
                   </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-              <void property="predicate"> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
-                 <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>key</string> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="alias"> 
+                     <string>_c15</string> 
                     </void> 
-                    <void property="tabAlias"> 
-                     <string>src</string> 
+                    <void property="internalName"> 
+                     <string>_col15</string> 
                     </void> 
-                    <void property="typeInfo"> 
+                    <void property="type"> 
                      <object idref="PrimitiveTypeInfo1"/> 
                     </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
                    </object> 
                   </void> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
-                     <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                      <void property="typeName"> 
-                       <string>int</string> 
-                      </void> 
-                     </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="alias"> 
+                     <string>_c16</string> 
                     </void> 
-                    <void property="value"> 
-                     <int>86</int> 
+                    <void property="internalName"> 
+                     <string>_col16</string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo1"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
                </object> 
               </void> 
              </object> 
             </void> 
-            <void property="operatorId"> 
-             <string>FIL_4</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator0"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>key</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo1"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
+             <void property="predicate"> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                   <void property="column"> 
+                    <string>key</string> 
+                   </void> 
+                   <void property="tabAlias"> 
+                    <string>src</string> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo1"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                     <void property="typeName"> 
+                      <string>int</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="value"> 
+                    <int>86</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>FIL_4</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator0"/> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>key</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo1"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
diff --git a/ql/src/test/results/compiler/plan/udf4.q.xml b/ql/src/test/results/compiler/plan/udf4.q.xml
index 24c2d08a39..9ae48bb507 100644
--- a/ql/src/test/results/compiler/plan/udf4.q.xml
+++ b/ql/src/test/results/compiler/plan/udf4.q.xml
@@ -133,1452 +133,1444 @@
        <string>dest1</string> 
        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                  <void property="dirName"> 
-                   #### A masked pattern was here #### 
-                  </void> 
-                  <void property="numFiles"> 
-                   <int>1</int> 
-                  </void> 
-                  <void property="statsAggPrefix"> 
-                   #### A masked pattern was here #### 
+         <void method="add"> 
+          <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                <void property="dirName"> 
+                 #### A masked pattern was here #### 
+                </void> 
+                <void property="numFiles"> 
+                 <int>1</int> 
+                </void> 
+                <void property="statsAggPrefix"> 
+                 #### A masked pattern was here #### 
+                </void> 
+                <void property="statsCollectRawDataSize"> 
+                 <boolean>true</boolean> 
+                </void> 
+                <void property="tableInfo"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                  <void property="inputFileFormatClass"> 
+                   <class>org.apache.hadoop.mapred.TextInputFormat</class> 
                   </void> 
-                  <void property="statsCollectRawDataSize"> 
-                   <boolean>true</boolean> 
+                  <void property="outputFileFormatClass"> 
+                   <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
                   </void> 
-                  <void property="tableInfo"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                    <void property="inputFileFormatClass"> 
-                     <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-                    </void> 
-                    <void property="outputFileFormatClass"> 
-                     <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-                    </void> 
-                    <void property="properties"> 
-                     <object class="java.util.Properties"> 
-                      <void method="put"> 
-                       <string>hive.serialization.extend.nesting.levels</string> 
-                       <string>true</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>columns</string> 
-                       <string>_col0,_col1,_col2,_col3,_col4,_col5,_col6,_col7,_col8,_col9,_col10,_col11,_col12,_col13,_col14,_col15,_col16,_col17,_col18</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.lib</string> 
-                       <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.format</string> 
-                       <string>1</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>columns.types</string> 
-                       <string>double:double:double:bigint:bigint:bigint:double:double:double:bigint:bigint:bigint:bigint:double:int:int:int:int:int</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>escape.delim</string> 
-                       <string>\</string> 
-                      </void> 
-                     </object> 
+                  <void property="properties"> 
+                   <object class="java.util.Properties"> 
+                    <void method="put"> 
+                     <string>hive.serialization.extend.nesting.levels</string> 
+                     <string>true</string> 
+                    </void> 
+                    <void method="put"> 
+                     <string>columns</string> 
+                     <string>_col0,_col1,_col2,_col3,_col4,_col5,_col6,_col7,_col8,_col9,_col10,_col11,_col12,_col13,_col14,_col15,_col16,_col17,_col18</string> 
+                    </void> 
+                    <void method="put"> 
+                     <string>serialization.lib</string> 
+                     <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                    </void> 
+                    <void method="put"> 
+                     <string>serialization.format</string> 
+                     <string>1</string> 
+                    </void> 
+                    <void method="put"> 
+                     <string>columns.types</string> 
+                     <string>double:double:double:bigint:bigint:bigint:double:double:double:bigint:bigint:bigint:bigint:double:int:int:int:int:int</string> 
+                    </void> 
+                    <void method="put"> 
+                     <string>escape.delim</string> 
+                     <string>\</string> 
                     </void> 
                    </object> 
                   </void> 
-                  <void property="totalFiles"> 
-                   <int>1</int> 
-                  </void> 
                  </object> 
                 </void> 
-                <void property="operatorId"> 
-                 <string>FS_2</string> 
+                <void property="totalFiles"> 
+                 <int>1</int> 
                 </void> 
-                <void property="parentOperators"> 
+               </object> 
+              </void> 
+              <void property="operatorId"> 
+               <string>FS_2</string> 
+              </void> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="SelectOperator0"/> 
+               </void> 
+              </void> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object idref="SelectOperator0"/> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                        <void property="typeName"> 
-                         <string>double</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>double</string> 
-                      </void> 
-                     </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>double</string> 
-                      </void> 
-                     </object> 
+                    <void property="tabAlias"> 
+                     <string></string> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col2</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
+                    <void property="type"> 
+                     <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
                       <void property="typeName"> 
                        <string>double</string> 
                       </void> 
                      </object> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col3</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                        <void property="typeName"> 
-                         <string>bigint</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>bigint</string> 
-                      </void> 
-                     </object> 
+                    <void property="typeName"> 
+                     <string>double</string> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col4</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo1"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>bigint</string> 
-                      </void> 
-                     </object> 
+                   </object> 
+                  </void> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col1</string> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col5</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo1"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>bigint</string> 
-                      </void> 
-                     </object> 
+                    <void property="tabAlias"> 
+                     <string></string> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col6</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>double</string> 
-                      </void> 
-                     </object> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col7</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>double</string> 
-                      </void> 
-                     </object> 
+                    <void property="typeName"> 
+                     <string>double</string> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col8</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>double</string> 
-                      </void> 
-                     </object> 
+                   </object> 
+                  </void> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col2</string> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col9</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo1"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>bigint</string> 
-                      </void> 
-                     </object> 
+                    <void property="tabAlias"> 
+                     <string></string> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col10</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo1"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>bigint</string> 
-                      </void> 
-                     </object> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col11</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo1"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>bigint</string> 
-                      </void> 
-                     </object> 
+                    <void property="typeName"> 
+                     <string>double</string> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col12</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo1"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>bigint</string> 
-                      </void> 
-                     </object> 
+                   </object> 
+                  </void> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col3</string> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col13</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>double</string> 
-                      </void> 
-                     </object> 
+                    <void property="tabAlias"> 
+                     <string></string> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col14</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                        <void property="typeName"> 
-                         <string>int</string> 
-                        </void> 
-                       </object> 
-                      </void> 
+                    <void property="type"> 
+                     <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
                       <void property="typeName"> 
-                       <string>int</string> 
+                       <string>bigint</string> 
                       </void> 
                      </object> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col15</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo2"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>int</string> 
-                      </void> 
-                     </object> 
+                    <void property="typeName"> 
+                     <string>bigint</string> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col16</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo2"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>int</string> 
-                      </void> 
-                     </object> 
+                   </object> 
+                  </void> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col4</string> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col17</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo2"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>int</string> 
-                      </void> 
-                     </object> 
+                    <void property="tabAlias"> 
+                     <string></string> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col18</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo2"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>int</string> 
-                      </void> 
-                     </object> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo1"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>bigint</string> 
                     </void> 
                    </object> 
                   </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="columnExprMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>_col8</string> 
-               <object id="ExprNodeGenericFuncDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
-                 <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col5</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
                     </void> 
-                    <void property="value"> 
-                     <double>0.0</double> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo1"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>bigint</string> 
                     </void> 
                    </object> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                  <void property="udfClassName"> 
-                   <string>org.apache.hadoop.hive.ql.udf.UDFSqrt</string> 
-                  </void> 
-                  <void property="udfName"> 
-                   <string>sqrt</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>_col7</string> 
-               <object id="ExprNodeGenericFuncDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
-                 <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                        <void property="value"> 
-                         <double>1.0</double> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col6</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPNegative"/> 
+                    <void property="tabAlias"> 
+                     <string></string> 
                     </void> 
-                    <void property="typeInfo"> 
+                    <void property="type"> 
                      <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
+                    <void property="typeName"> 
+                     <string>double</string> 
+                    </void> 
                    </object> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                  <void property="udfClassName"> 
-                   <string>org.apache.hadoop.hive.ql.udf.UDFSqrt</string> 
-                  </void> 
-                  <void property="udfName"> 
-                   <string>sqrt</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>_col6</string> 
-               <object id="ExprNodeGenericFuncDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
-                 <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col7</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
                      <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                    <void property="value"> 
-                     <double>1.0</double> 
+                    <void property="typeName"> 
+                     <string>double</string> 
                     </void> 
                    </object> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                  <void property="udfClassName"> 
-                   <string>org.apache.hadoop.hive.ql.udf.UDFSqrt</string> 
-                  </void> 
-                  <void property="udfName"> 
-                   <string>sqrt</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>_col5</string> 
-               <object id="ExprNodeGenericFuncDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
-                 <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                        <void property="value"> 
-                         <double>1.5</double> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col8</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPNegative"/> 
+                    <void property="tabAlias"> 
+                     <string></string> 
                     </void> 
-                    <void property="typeInfo"> 
+                    <void property="type"> 
                      <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
+                    <void property="typeName"> 
+                     <string>double</string> 
+                    </void> 
                    </object> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFFloor"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo1"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>_col4</string> 
-               <object id="ExprNodeGenericFuncDesc4" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
-                 <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col9</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
                     </void> 
-                    <void property="value"> 
-                     <double>1.5</double> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo1"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>bigint</string> 
                     </void> 
                    </object> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFFloor"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo1"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>_col3</string> 
-               <object id="ExprNodeGenericFuncDesc5" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
-                 <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col10</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
                     </void> 
-                    <void property="value"> 
-                     <double>1.0</double> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo1"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>bigint</string> 
                     </void> 
                    </object> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFFloor"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo1"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>_col2</string> 
-               <object id="ExprNodeGenericFuncDesc6" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
-                 <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                        <void property="value"> 
-                         <double>1.5</double> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col11</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPNegative"/> 
+                    <void property="tabAlias"> 
+                     <string></string> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo1"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>bigint</string> 
                     </void> 
                    </object> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFRound"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>_col1</string> 
-               <object id="ExprNodeGenericFuncDesc7" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
-                 <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col12</string> 
                     </void> 
-                    <void property="value"> 
-                     <double>1.5</double> 
+                    <void property="tabAlias"> 
+                     <string></string> 
                     </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFRound"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>_col9</string> 
-               <object id="ExprNodeGenericFuncDesc8" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo1"/> 
                     </void> 
-                    <void property="value"> 
-                     <double>1.0</double> 
+                    <void property="typeName"> 
+                     <string>bigint</string> 
                     </void> 
                    </object> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFCeil"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo1"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>_col13</string> 
-               <object id="ExprNodeGenericFuncDesc9" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
-                 <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col13</string> 
                     </void> 
-                    <void property="value"> 
-                     <int>3</int> 
+                    <void property="tabAlias"> 
+                     <string></string> 
                     </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                  <void property="udfClassName"> 
-                   <string>org.apache.hadoop.hive.ql.udf.UDFRand</string> 
-                  </void> 
-                  <void property="udfName"> 
-                   <string>rand</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>_col12</string> 
-               <object id="ExprNodeGenericFuncDesc10" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
+                    <void property="type"> 
                      <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                    <void property="value"> 
-                     <double>1.0</double> 
+                    <void property="typeName"> 
+                     <string>double</string> 
                     </void> 
                    </object> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFCeil"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo1"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>_col11</string> 
-               <object id="ExprNodeGenericFuncDesc11" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
-                 <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                        <void property="value"> 
-                         <double>1.5</double> 
-                        </void> 
-                       </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col14</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                      <void property="typeName"> 
+                       <string>int</string> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPNegative"/> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
+                    <void property="typeName"> 
+                     <string>int</string> 
                     </void> 
                    </object> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFCeil"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo1"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>_col10</string> 
-               <object id="ExprNodeGenericFuncDesc12" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
-                 <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col15</string> 
                     </void> 
-                    <void property="value"> 
-                     <double>1.5</double> 
+                    <void property="tabAlias"> 
+                     <string></string> 
                     </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFCeil"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo1"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>_col17</string> 
-               <object id="ExprNodeGenericFuncDesc13" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
+                    <void property="type"> 
                      <object idref="PrimitiveTypeInfo2"/> 
                     </void> 
-                    <void property="value"> 
-                     <int>1</int> 
+                    <void property="typeName"> 
+                     <string>int</string> 
                     </void> 
                    </object> 
                   </void> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo2"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>2</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col16</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPNegative"/> 
+                    <void property="tabAlias"> 
+                     <string></string> 
                     </void> 
-                    <void property="typeInfo"> 
+                    <void property="type"> 
                      <object idref="PrimitiveTypeInfo2"/> 
                     </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPPlus"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo2"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>_col16</string> 
-               <object id="ExprNodeGenericFuncDesc14" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
-                    </void> 
-                    <void property="value"> 
-                     <int>1</int> 
+                    <void property="typeName"> 
+                     <string>int</string> 
                     </void> 
                    </object> 
                   </void> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col17</string> 
                     </void> 
-                    <void property="value"> 
-                     <int>2</int> 
+                    <void property="tabAlias"> 
+                     <string></string> 
                     </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPPlus"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo2"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>_col15</string> 
-               <object id="ExprNodeGenericFuncDesc15" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
+                    <void property="type"> 
                      <object idref="PrimitiveTypeInfo2"/> 
                     </void> 
-                    <void property="value"> 
-                     <int>3</int> 
+                    <void property="typeName"> 
+                     <string>int</string> 
                     </void> 
                    </object> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPNegative"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo2"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>_col14</string> 
-               <object id="ExprNodeConstantDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo2"/> 
-                </void> 
-                <void property="value"> 
-                 <int>3</int> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>_col0</string> 
-               <object id="ExprNodeGenericFuncDesc16" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
-                 <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col18</string> 
                     </void> 
-                    <void property="value"> 
-                     <double>1.0</double> 
+                    <void property="tabAlias"> 
+                     <string></string> 
                     </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFRound"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>_col18</string> 
-               <object id="ExprNodeGenericFuncDesc17" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
+                    <void property="type"> 
                      <object idref="PrimitiveTypeInfo2"/> 
                     </void> 
-                    <void property="value"> 
-                     <int>1</int> 
+                    <void property="typeName"> 
+                     <string>int</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
-                  <void property="operator"> 
-                   <boolean>true</boolean> 
-                  </void> 
-                  <void property="udfClassName"> 
-                   <string>org.apache.hadoop.hive.ql.udf.UDFOPBitNot</string> 
-                  </void> 
-                  <void property="udfName"> 
-                   <string>~</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo2"/> 
-                </void> 
                </object> 
               </void> 
              </object> 
             </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-              <void property="colList"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object idref="ExprNodeGenericFuncDesc16"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeGenericFuncDesc7"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeGenericFuncDesc6"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeGenericFuncDesc5"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeGenericFuncDesc4"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeGenericFuncDesc3"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeGenericFuncDesc2"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeGenericFuncDesc1"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeGenericFuncDesc0"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeGenericFuncDesc8"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeGenericFuncDesc12"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeGenericFuncDesc11"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeGenericFuncDesc10"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeGenericFuncDesc9"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeConstantDesc0"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeGenericFuncDesc15"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeGenericFuncDesc14"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeGenericFuncDesc13"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeGenericFuncDesc17"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void property="outputColumnNames"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <string>_col0</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col1</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col2</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col3</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col4</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col5</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col6</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col7</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col8</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col9</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col10</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col11</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col12</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col13</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col14</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col15</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col16</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col17</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col18</string> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="operatorId"> 
-             <string>SEL_1</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator0"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>_c0</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col0</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>double</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>_c1</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col1</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>double</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>_c2</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col2</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>double</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>_c3</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col3</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo1"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>bigint</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>_c4</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col4</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo1"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>bigint</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>_c5</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col5</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo1"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>bigint</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>_c6</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col6</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>double</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>_c7</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col7</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>double</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>_c8</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col8</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>double</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>_c9</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col9</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo1"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>bigint</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>_c10</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col10</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo1"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>bigint</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>_c11</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col11</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo1"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>bigint</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>_c12</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col12</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo1"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>bigint</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>_c13</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col13</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>double</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>_c14</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col14</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo2"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>int</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>_c15</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col15</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo2"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>int</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>_c16</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col16</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo2"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>int</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>_c17</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col17</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo2"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>int</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>_c18</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col18</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo2"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>int</string> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
+           </void> 
+           <void property="columnExprMap"> 
+            <object class="java.util.HashMap"> 
+             <void method="put"> 
+              <string>_col8</string> 
+              <object id="ExprNodeGenericFuncDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo0"/> 
+                   </void> 
+                   <void property="value"> 
+                    <double>0.0</double> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                 <void property="udfClassName"> 
+                  <string>org.apache.hadoop.hive.ql.udf.UDFSqrt</string> 
+                 </void> 
+                 <void property="udfName"> 
+                  <string>sqrt</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col7</string> 
+              <object id="ExprNodeGenericFuncDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                   <void property="children"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="value"> 
+                        <double>1.0</double> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="genericUDF"> 
+                    <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPNegative"/> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo0"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                 <void property="udfClassName"> 
+                  <string>org.apache.hadoop.hive.ql.udf.UDFSqrt</string> 
+                 </void> 
+                 <void property="udfName"> 
+                  <string>sqrt</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col6</string> 
+              <object id="ExprNodeGenericFuncDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo0"/> 
+                   </void> 
+                   <void property="value"> 
+                    <double>1.0</double> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                 <void property="udfClassName"> 
+                  <string>org.apache.hadoop.hive.ql.udf.UDFSqrt</string> 
+                 </void> 
+                 <void property="udfName"> 
+                  <string>sqrt</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col5</string> 
+              <object id="ExprNodeGenericFuncDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                   <void property="children"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="value"> 
+                        <double>1.5</double> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="genericUDF"> 
+                    <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPNegative"/> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo0"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFFloor"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo1"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col4</string> 
+              <object id="ExprNodeGenericFuncDesc4" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo0"/> 
+                   </void> 
+                   <void property="value"> 
+                    <double>1.5</double> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFFloor"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo1"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col3</string> 
+              <object id="ExprNodeGenericFuncDesc5" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo0"/> 
+                   </void> 
+                   <void property="value"> 
+                    <double>1.0</double> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFFloor"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo1"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col2</string> 
+              <object id="ExprNodeGenericFuncDesc6" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                   <void property="children"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="value"> 
+                        <double>1.5</double> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="genericUDF"> 
+                    <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPNegative"/> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo0"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFRound"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col1</string> 
+              <object id="ExprNodeGenericFuncDesc7" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo0"/> 
+                   </void> 
+                   <void property="value"> 
+                    <double>1.5</double> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFRound"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col9</string> 
+              <object id="ExprNodeGenericFuncDesc8" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo0"/> 
+                   </void> 
+                   <void property="value"> 
+                    <double>1.0</double> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFCeil"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo1"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col13</string> 
+              <object id="ExprNodeGenericFuncDesc9" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo2"/> 
+                   </void> 
+                   <void property="value"> 
+                    <int>3</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                 <void property="udfClassName"> 
+                  <string>org.apache.hadoop.hive.ql.udf.UDFRand</string> 
+                 </void> 
+                 <void property="udfName"> 
+                  <string>rand</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col12</string> 
+              <object id="ExprNodeGenericFuncDesc10" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo0"/> 
+                   </void> 
+                   <void property="value"> 
+                    <double>1.0</double> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFCeil"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo1"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col11</string> 
+              <object id="ExprNodeGenericFuncDesc11" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                   <void property="children"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="value"> 
+                        <double>1.5</double> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="genericUDF"> 
+                    <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPNegative"/> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo0"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFCeil"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo1"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col10</string> 
+              <object id="ExprNodeGenericFuncDesc12" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo0"/> 
+                   </void> 
+                   <void property="value"> 
+                    <double>1.5</double> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFCeil"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo1"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col17</string> 
+              <object id="ExprNodeGenericFuncDesc13" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo2"/> 
+                   </void> 
+                   <void property="value"> 
+                    <int>1</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                   <void property="children"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo2"/> 
+                       </void> 
+                       <void property="value"> 
+                        <int>2</int> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="genericUDF"> 
+                    <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPNegative"/> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo2"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPPlus"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo2"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col16</string> 
+              <object id="ExprNodeGenericFuncDesc14" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo2"/> 
+                   </void> 
+                   <void property="value"> 
+                    <int>1</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo2"/> 
+                   </void> 
+                   <void property="value"> 
+                    <int>2</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPPlus"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo2"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col15</string> 
+              <object id="ExprNodeGenericFuncDesc15" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo2"/> 
+                   </void> 
+                   <void property="value"> 
+                    <int>3</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPNegative"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo2"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col14</string> 
+              <object id="ExprNodeConstantDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo2"/> 
+               </void> 
+               <void property="value"> 
+                <int>3</int> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col0</string> 
+              <object id="ExprNodeGenericFuncDesc16" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo0"/> 
+                   </void> 
+                   <void property="value"> 
+                    <double>1.0</double> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFRound"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col18</string> 
+              <object id="ExprNodeGenericFuncDesc17" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo2"/> 
+                   </void> 
+                   <void property="value"> 
+                    <int>1</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                 <void property="operator"> 
+                  <boolean>true</boolean> 
+                 </void> 
+                 <void property="udfClassName"> 
+                  <string>org.apache.hadoop.hive.ql.udf.UDFOPBitNot</string> 
+                 </void> 
+                 <void property="udfName"> 
+                  <string>~</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo2"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+             <void property="colList"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object idref="ExprNodeGenericFuncDesc16"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeGenericFuncDesc7"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeGenericFuncDesc6"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeGenericFuncDesc5"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeGenericFuncDesc4"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeGenericFuncDesc3"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeGenericFuncDesc2"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeGenericFuncDesc1"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeGenericFuncDesc0"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeGenericFuncDesc8"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeGenericFuncDesc12"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeGenericFuncDesc11"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeGenericFuncDesc10"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeGenericFuncDesc9"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeConstantDesc0"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeGenericFuncDesc15"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeGenericFuncDesc14"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeGenericFuncDesc13"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeGenericFuncDesc17"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="outputColumnNames"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <string>_col0</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col1</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col2</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col3</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col4</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col5</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col6</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col7</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col8</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col9</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col10</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col11</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col12</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col13</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col14</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col15</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col16</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col17</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col18</string> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>SEL_1</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator0"/> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>_c0</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col0</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>double</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>_c1</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col1</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>double</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>_c2</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col2</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>double</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>_c3</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col3</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo1"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>bigint</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>_c4</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col4</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo1"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>bigint</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>_c5</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col5</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo1"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>bigint</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>_c6</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col6</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>double</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>_c7</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col7</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>double</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>_c8</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col8</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>double</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>_c9</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col9</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo1"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>bigint</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>_c10</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col10</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo1"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>bigint</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>_c11</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col11</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo1"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>bigint</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>_c12</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col12</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo1"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>bigint</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>_c13</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col13</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>double</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>_c14</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col14</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo2"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>int</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>_c15</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col15</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo2"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>int</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>_c16</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col16</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo2"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>int</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>_c17</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col17</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo2"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>int</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>_c18</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col18</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo2"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>int</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
diff --git a/ql/src/test/results/compiler/plan/udf6.q.xml b/ql/src/test/results/compiler/plan/udf6.q.xml
index 204b95d059..2d45099e36 100644
--- a/ql/src/test/results/compiler/plan/udf6.q.xml
+++ b/ql/src/test/results/compiler/plan/udf6.q.xml
@@ -153,297 +153,289 @@
        <string>src</string> 
        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                  <void property="dirName"> 
-                   #### A masked pattern was here #### 
-                  </void> 
-                  <void property="numFiles"> 
-                   <int>1</int> 
-                  </void> 
-                  <void property="statsAggPrefix"> 
-                   #### A masked pattern was here #### 
+         <void method="add"> 
+          <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                <void property="dirName"> 
+                 #### A masked pattern was here #### 
+                </void> 
+                <void property="numFiles"> 
+                 <int>1</int> 
+                </void> 
+                <void property="statsAggPrefix"> 
+                 #### A masked pattern was here #### 
+                </void> 
+                <void property="statsCollectRawDataSize"> 
+                 <boolean>true</boolean> 
+                </void> 
+                <void property="tableInfo"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                  <void property="inputFileFormatClass"> 
+                   <class>org.apache.hadoop.mapred.TextInputFormat</class> 
                   </void> 
-                  <void property="statsCollectRawDataSize"> 
-                   <boolean>true</boolean> 
+                  <void property="outputFileFormatClass"> 
+                   <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
                   </void> 
-                  <void property="tableInfo"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                    <void property="inputFileFormatClass"> 
-                     <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                  <void property="properties"> 
+                   <object class="java.util.Properties"> 
+                    <void method="put"> 
+                     <string>hive.serialization.extend.nesting.levels</string> 
+                     <string>true</string> 
                     </void> 
-                    <void property="outputFileFormatClass"> 
-                     <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                    <void method="put"> 
+                     <string>columns</string> 
+                     <string>_col0,_col1</string> 
                     </void> 
-                    <void property="properties"> 
-                     <object class="java.util.Properties"> 
-                      <void method="put"> 
-                       <string>hive.serialization.extend.nesting.levels</string> 
-                       <string>true</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>columns</string> 
-                       <string>_col0,_col1</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.lib</string> 
-                       <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>serialization.format</string> 
-                       <string>1</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>columns.types</string> 
-                       <string>string:int</string> 
-                      </void> 
-                      <void method="put"> 
-                       <string>escape.delim</string> 
-                       <string>\</string> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>serialization.lib</string> 
+                     <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
                     </void> 
-                   </object> 
-                  </void> 
-                  <void property="totalFiles"> 
-                   <int>1</int> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="operatorId"> 
-                 <string>FS_2</string> 
-                </void> 
-                <void property="parentOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object idref="SelectOperator0"/> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                        <void property="typeName"> 
-                         <string>string</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>serialization.format</string> 
+                     <string>1</string> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string></string> 
-                      </void> 
-                      <void property="type"> 
-                       <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                        <void property="typeName"> 
-                         <string>int</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>int</string> 
-                      </void> 
-                     </object> 
+                    <void method="put"> 
+                     <string>columns.types</string> 
+                     <string>string:int</string> 
+                    </void> 
+                    <void method="put"> 
+                     <string>escape.delim</string> 
+                     <string>\</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
+                <void property="totalFiles"> 
+                 <int>1</int> 
+                </void> 
                </object> 
               </void> 
-             </object> 
-            </void> 
-            <void property="columnExprMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>_col1</string> 
-               <object id="ExprNodeGenericFuncDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
+              <void property="operatorId"> 
+               <string>FS_2</string> 
+              </void> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="SelectOperator0"/> 
+               </void> 
+              </void> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
-                     <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
+                    </void> 
+                    <void property="tabAlias"> 
+                     <string></string> 
+                    </void> 
+                    <void property="type"> 
+                     <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
                       <void property="typeName"> 
-                       <string>boolean</string> 
+                       <string>string</string> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="value"> 
-                     <boolean>true</boolean> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
-                    </void> 
-                    <void property="value"> 
-                     <int>1</int> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
-                    </void> 
-                    <void property="value"> 
-                     <int>2</int> 
+                    <void property="typeName"> 
+                     <string>string</string> 
                     </void> 
                    </object> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFIf"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo1"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>_col0</string> 
-               <object id="ExprNodeGenericFuncDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
-                 <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col1</string> 
                     </void> 
-                    <void property="value"> 
-                     <string>a</string> 
+                    <void property="tabAlias"> 
+                     <string></string> 
                     </void> 
-                   </object> 
-                  </void> 
-                  <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
+                    <void property="type"> 
+                     <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                      <void property="typeName"> 
+                       <string>int</string> 
+                      </void> 
+                     </object> 
                     </void> 
-                    <void property="value"> 
-                     <string>b</string> 
+                    <void property="typeName"> 
+                     <string>int</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFConcat"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-              <void property="colList"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object idref="ExprNodeGenericFuncDesc1"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeGenericFuncDesc0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void property="outputColumnNames"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <string>_col0</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col1</string> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="operatorId"> 
-             <string>SEL_1</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator0"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>_c0</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col0</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="alias"> 
-                   <string>_c1</string> 
-                  </void> 
-                  <void property="internalName"> 
-                   <string>_col1</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo1"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>int</string> 
-                  </void> 
-                 </object> 
-                </void> 
                </object> 
               </void> 
              </object> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="columnExprMap"> 
+            <object class="java.util.HashMap"> 
+             <void method="put"> 
+              <string>_col1</string> 
+              <object id="ExprNodeGenericFuncDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                     <void property="typeName"> 
+                      <string>boolean</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="value"> 
+                    <boolean>true</boolean> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo1"/> 
+                   </void> 
+                   <void property="value"> 
+                    <int>1</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo1"/> 
+                   </void> 
+                   <void property="value"> 
+                    <int>2</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFIf"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo1"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col0</string> 
+              <object id="ExprNodeGenericFuncDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo0"/> 
+                   </void> 
+                   <void property="value"> 
+                    <string>a</string> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo0"/> 
+                   </void> 
+                   <void property="value"> 
+                    <string>b</string> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFConcat"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+             <void property="colList"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object idref="ExprNodeGenericFuncDesc1"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeGenericFuncDesc0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="outputColumnNames"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <string>_col0</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col1</string> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>SEL_1</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator0"/> 
+            </void> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>_c0</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col0</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="alias"> 
+                  <string>_c1</string> 
+                 </void> 
+                 <void property="internalName"> 
+                  <string>_col1</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo1"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>int</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
diff --git a/ql/src/test/results/compiler/plan/udf_case.q.xml b/ql/src/test/results/compiler/plan/udf_case.q.xml
index 0fb8129d08..03c83ccc6e 100644
--- a/ql/src/test/results/compiler/plan/udf_case.q.xml
+++ b/ql/src/test/results/compiler/plan/udf_case.q.xml
@@ -153,381 +153,369 @@
        <string>src</string> 
        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="LimitOperator0" class="org.apache.hadoop.hive.ql.exec.LimitOperator"> 
-                <void property="childOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                      <void property="dirName"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="numFiles"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="statsAggPrefix"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="statsCollectRawDataSize"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="tableInfo"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                        <void property="inputFileFormatClass"> 
-                         <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-                        </void> 
-                        <void property="outputFileFormatClass"> 
-                         <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-                        </void> 
-                        <void property="properties"> 
-                         <object class="java.util.Properties"> 
-                          <void method="put"> 
-                           <string>hive.serialization.extend.nesting.levels</string> 
-                           <string>true</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns</string> 
-                           <string>_col0,_col1</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.lib</string> 
-                           <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.format</string> 
-                           <string>1</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns.types</string> 
-                           <string>int:int</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>escape.delim</string> 
-                           <string>\</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="totalFiles"> 
-                       <int>1</int> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="operatorId"> 
-                     <string>FS_3</string> 
-                    </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="LimitOperator0"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="schema"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                      <void property="signature"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col0</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string></string> 
-                          </void> 
-                          <void property="type"> 
-                           <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                            <void property="typeName"> 
-                             <string>int</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>int</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col1</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string></string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>int</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.LimitDesc"> 
-                  <void property="limit"> 
-                   <int>1</int> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="operatorId"> 
-                 <string>LIM_2</string> 
-                </void> 
-                <void property="parentOperators"> 
-                 <object class="java.util.ArrayList"> 
+         <void method="add"> 
+          <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object id="LimitOperator0" class="org.apache.hadoop.hive.ql.exec.LimitOperator"> 
+              <void property="childOperators"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                 <void property="conf"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                   <void property="dirName"> 
+                    #### A masked pattern was here #### 
+                   </void> 
+                   <void property="numFiles"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="statsAggPrefix"> 
+                    #### A masked pattern was here #### 
+                   </void> 
+                   <void property="statsCollectRawDataSize"> 
+                    <boolean>true</boolean> 
+                   </void> 
+                   <void property="tableInfo"> 
+                    <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                     <void property="inputFileFormatClass"> 
+                      <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                     </void> 
+                     <void property="outputFileFormatClass"> 
+                      <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                     </void> 
+                     <void property="properties"> 
+                      <object class="java.util.Properties"> 
+                       <void method="put"> 
+                        <string>hive.serialization.extend.nesting.levels</string> 
+                        <string>true</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns</string> 
+                        <string>_col0,_col1</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.lib</string> 
+                        <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.format</string> 
+                        <string>1</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns.types</string> 
+                        <string>int:int</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>escape.delim</string> 
+                        <string>\</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="totalFiles"> 
+                    <int>1</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="operatorId"> 
+                  <string>FS_3</string> 
+                 </void> 
+                 <void property="parentOperators"> 
                   <void method="add"> 
-                   <object idref="SelectOperator0"/> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object id="ArrayList0" class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="alias"> 
-                       <string>_c0</string> 
-                      </void> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>int</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="alias"> 
-                       <string>_c1</string> 
-                      </void> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>int</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                   <object idref="LimitOperator0"/> 
                   </void> 
-                 </object> 
-                </void> 
-               </object> 
+                 </void> 
+                 <void property="schema"> 
+                  <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                   <void property="signature"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>_col0</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string></string> 
+                       </void> 
+                       <void property="type"> 
+                        <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                         <void property="typeName"> 
+                          <string>int</string> 
+                         </void> 
+                        </object> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>int</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>_col1</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string></string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>int</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
               </void> 
-             </object> 
-            </void> 
-            <void property="columnExprMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>_col1</string> 
-               <object id="ExprNodeGenericFuncDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                    <void property="value"> 
-                     <int>11</int> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                    <void property="value"> 
-                     <int>12</int> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                    <void property="value"> 
-                     <int>13</int> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                    <void property="value"> 
-                     <int>14</int> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                    <void property="value"> 
-                     <int>15</int> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFCase"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.LimitDesc"> 
+                <void property="limit"> 
+                 <int>1</int> 
                 </void> 
                </object> 
               </void> 
-              <void method="put"> 
-               <string>_col0</string> 
-               <object id="ExprNodeGenericFuncDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                    <void property="value"> 
-                     <int>1</int> 
-                    </void> 
-                   </object> 
-                  </void> 
+              <void property="operatorId"> 
+               <string>LIM_2</string> 
+              </void> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="SelectOperator0"/> 
+               </void> 
+              </void> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
+                 <object id="ArrayList0" class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="alias"> 
+                     <string>_c0</string> 
                     </void> 
-                    <void property="value"> 
-                     <int>1</int> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
                     </void> 
-                   </object> 
-                  </void> 
-                  <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
+                    <void property="type"> 
                      <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                    <void property="value"> 
-                     <int>2</int> 
+                    <void property="typeName"> 
+                     <string>int</string> 
                     </void> 
                    </object> 
                   </void> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="alias"> 
+                     <string>_c1</string> 
                     </void> 
-                    <void property="value"> 
-                     <int>3</int> 
+                    <void property="internalName"> 
+                     <string>_col1</string> 
                     </void> 
-                   </object> 
-                  </void> 
-                  <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
+                    <void property="type"> 
                      <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                    <void property="value"> 
-                     <int>4</int> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                    <void property="value"> 
-                     <int>5</int> 
+                    <void property="typeName"> 
+                     <string>int</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFCase"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
                </object> 
               </void> 
              </object> 
             </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-              <void property="colList"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object idref="ExprNodeGenericFuncDesc1"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeGenericFuncDesc0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void property="outputColumnNames"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <string>_col0</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col1</string> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="operatorId"> 
-             <string>SEL_1</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator0"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object idref="ArrayList0"/> 
-              </void> 
-             </object> 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="columnExprMap"> 
+            <object class="java.util.HashMap"> 
+             <void method="put"> 
+              <string>_col1</string> 
+              <object id="ExprNodeGenericFuncDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo0"/> 
+                   </void> 
+                   <void property="value"> 
+                    <int>11</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo0"/> 
+                   </void> 
+                   <void property="value"> 
+                    <int>12</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo0"/> 
+                   </void> 
+                   <void property="value"> 
+                    <int>13</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo0"/> 
+                   </void> 
+                   <void property="value"> 
+                    <int>14</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo0"/> 
+                   </void> 
+                   <void property="value"> 
+                    <int>15</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFCase"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col0</string> 
+              <object id="ExprNodeGenericFuncDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo0"/> 
+                   </void> 
+                   <void property="value"> 
+                    <int>1</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo0"/> 
+                   </void> 
+                   <void property="value"> 
+                    <int>1</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo0"/> 
+                   </void> 
+                   <void property="value"> 
+                    <int>2</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo0"/> 
+                   </void> 
+                   <void property="value"> 
+                    <int>3</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo0"/> 
+                   </void> 
+                   <void property="value"> 
+                    <int>4</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo0"/> 
+                   </void> 
+                   <void property="value"> 
+                    <int>5</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFCase"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+             <void property="colList"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object idref="ExprNodeGenericFuncDesc1"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeGenericFuncDesc0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="outputColumnNames"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <string>_col0</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col1</string> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>SEL_1</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator0"/> 
+            </void> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object idref="ArrayList0"/> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
diff --git a/ql/src/test/results/compiler/plan/udf_when.q.xml b/ql/src/test/results/compiler/plan/udf_when.q.xml
index cc55f6040b..4a995f4152 100644
--- a/ql/src/test/results/compiler/plan/udf_when.q.xml
+++ b/ql/src/test/results/compiler/plan/udf_when.q.xml
@@ -153,461 +153,449 @@
        <string>src</string> 
        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="LimitOperator0" class="org.apache.hadoop.hive.ql.exec.LimitOperator"> 
-                <void property="childOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                      <void property="dirName"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="numFiles"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="statsAggPrefix"> 
-                       #### A masked pattern was here #### 
-                      </void> 
-                      <void property="statsCollectRawDataSize"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                      <void property="tableInfo"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                        <void property="inputFileFormatClass"> 
-                         <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-                        </void> 
-                        <void property="outputFileFormatClass"> 
-                         <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-                        </void> 
-                        <void property="properties"> 
-                         <object class="java.util.Properties"> 
-                          <void method="put"> 
-                           <string>hive.serialization.extend.nesting.levels</string> 
-                           <string>true</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns</string> 
-                           <string>_col0,_col1</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.lib</string> 
-                           <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>serialization.format</string> 
-                           <string>1</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>columns.types</string> 
-                           <string>int:int</string> 
-                          </void> 
-                          <void method="put"> 
-                           <string>escape.delim</string> 
-                           <string>\</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="totalFiles"> 
-                       <int>1</int> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="operatorId"> 
-                     <string>FS_3</string> 
-                    </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="LimitOperator0"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="schema"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                      <void property="signature"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col0</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string></string> 
-                          </void> 
-                          <void property="type"> 
-                           <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                            <void property="typeName"> 
-                             <string>int</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>int</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col1</string> 
-                          </void> 
-                          <void property="tabAlias"> 
-                           <string></string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
-                          </void> 
-                          <void property="typeName"> 
-                           <string>int</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.LimitDesc"> 
-                  <void property="limit"> 
-                   <int>1</int> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="operatorId"> 
-                 <string>LIM_2</string> 
-                </void> 
-                <void property="parentOperators"> 
-                 <object class="java.util.ArrayList"> 
+         <void method="add"> 
+          <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object id="LimitOperator0" class="org.apache.hadoop.hive.ql.exec.LimitOperator"> 
+              <void property="childOperators"> 
+               <void method="add"> 
+                <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                 <void property="conf"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                   <void property="dirName"> 
+                    #### A masked pattern was here #### 
+                   </void> 
+                   <void property="numFiles"> 
+                    <int>1</int> 
+                   </void> 
+                   <void property="statsAggPrefix"> 
+                    #### A masked pattern was here #### 
+                   </void> 
+                   <void property="statsCollectRawDataSize"> 
+                    <boolean>true</boolean> 
+                   </void> 
+                   <void property="tableInfo"> 
+                    <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                     <void property="inputFileFormatClass"> 
+                      <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                     </void> 
+                     <void property="outputFileFormatClass"> 
+                      <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                     </void> 
+                     <void property="properties"> 
+                      <object class="java.util.Properties"> 
+                       <void method="put"> 
+                        <string>hive.serialization.extend.nesting.levels</string> 
+                        <string>true</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns</string> 
+                        <string>_col0,_col1</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.lib</string> 
+                        <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>serialization.format</string> 
+                        <string>1</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>columns.types</string> 
+                        <string>int:int</string> 
+                       </void> 
+                       <void method="put"> 
+                        <string>escape.delim</string> 
+                        <string>\</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="totalFiles"> 
+                    <int>1</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void property="operatorId"> 
+                  <string>FS_3</string> 
+                 </void> 
+                 <void property="parentOperators"> 
                   <void method="add"> 
-                   <object idref="SelectOperator0"/> 
+                   <object idref="LimitOperator0"/> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object id="ArrayList0" class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="alias"> 
-                       <string>_c0</string> 
-                      </void> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>int</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="alias"> 
-                       <string>_c1</string> 
-                      </void> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>int</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
+                 </void> 
+                 <void property="schema"> 
+                  <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                   <void property="signature"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>_col0</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string></string> 
+                       </void> 
+                       <void property="type"> 
+                        <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                         <void property="typeName"> 
+                          <string>int</string> 
+                         </void> 
+                        </object> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>int</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>_col1</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string></string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>int</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
               </void> 
-             </object> 
-            </void> 
-            <void property="columnExprMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>_col1</string> 
-               <object id="ExprNodeGenericFuncDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>12</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>11</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual"/> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                      <void property="typeName"> 
-                       <string>boolean</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                    <void property="value"> 
-                     <int>13</int> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>14</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>10</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual"/> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                    <void property="value"> 
-                     <int>15</int> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFWhen"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.LimitDesc"> 
+                <void property="limit"> 
+                 <int>1</int> 
                 </void> 
                </object> 
               </void> 
-              <void method="put"> 
-               <string>_col0</string> 
-               <object id="ExprNodeGenericFuncDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
-                 <object class="java.util.ArrayList"> 
+              <void property="operatorId"> 
+               <string>LIM_2</string> 
+              </void> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="SelectOperator0"/> 
+               </void> 
+              </void> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
+                 <object id="ArrayList0" class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>1</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>1</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual"/> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="alias"> 
+                     <string>_c0</string> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
                     </void> 
-                   </object> 
-                  </void> 
-                  <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
+                    <void property="type"> 
                      <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                    <void property="value"> 
-                     <int>2</int> 
+                    <void property="typeName"> 
+                     <string>int</string> 
                     </void> 
                    </object> 
                   </void> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                    <void property="children"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>3</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>5</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="alias"> 
+                     <string>_c1</string> 
                     </void> 
-                    <void property="genericUDF"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual"/> 
+                    <void property="internalName"> 
+                     <string>_col1</string> 
                     </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
+                    <void property="type"> 
                      <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
-                    <void property="value"> 
-                     <int>4</int> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                    <void property="value"> 
-                     <int>5</int> 
+                    <void property="typeName"> 
+                     <string>int</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFWhen"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-              <void property="colList"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object idref="ExprNodeGenericFuncDesc1"/> 
-                </void> 
-                <void method="add"> 
-                 <object idref="ExprNodeGenericFuncDesc0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void property="outputColumnNames"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <string>_col0</string> 
-                </void> 
-                <void method="add"> 
-                 <string>_col1</string> 
-                </void> 
                </object> 
               </void> 
              </object> 
             </void> 
-            <void property="operatorId"> 
-             <string>SEL_1</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator0"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object idref="ArrayList0"/> 
-              </void> 
-             </object> 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="columnExprMap"> 
+            <object class="java.util.HashMap"> 
+             <void method="put"> 
+              <string>_col1</string> 
+              <object id="ExprNodeGenericFuncDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                   <void property="children"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="value"> 
+                        <int>12</int> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="value"> 
+                        <int>11</int> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="genericUDF"> 
+                    <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual"/> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                     <void property="typeName"> 
+                      <string>boolean</string> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo0"/> 
+                   </void> 
+                   <void property="value"> 
+                    <int>13</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                   <void property="children"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="value"> 
+                        <int>14</int> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="value"> 
+                        <int>10</int> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="genericUDF"> 
+                    <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual"/> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo1"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo0"/> 
+                   </void> 
+                   <void property="value"> 
+                    <int>15</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFWhen"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void method="put"> 
+              <string>_col0</string> 
+              <object id="ExprNodeGenericFuncDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                   <void property="children"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="value"> 
+                        <int>1</int> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="value"> 
+                        <int>1</int> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="genericUDF"> 
+                    <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual"/> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo1"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo0"/> 
+                   </void> 
+                   <void property="value"> 
+                    <int>2</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                   <void property="children"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="value"> 
+                        <int>3</int> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                       <void property="typeInfo"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="value"> 
+                        <int>5</int> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                   <void property="genericUDF"> 
+                    <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual"/> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo1"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo0"/> 
+                   </void> 
+                   <void property="value"> 
+                    <int>4</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo0"/> 
+                   </void> 
+                   <void property="value"> 
+                    <int>5</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFWhen"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo0"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+             <void property="colList"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object idref="ExprNodeGenericFuncDesc1"/> 
+               </void> 
+               <void method="add"> 
+                <object idref="ExprNodeGenericFuncDesc0"/> 
+               </void> 
+              </object> 
+             </void> 
+             <void property="outputColumnNames"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <string>_col0</string> 
+               </void> 
+               <void method="add"> 
+                <string>_col1</string> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>SEL_1</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator0"/> 
+            </void> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object idref="ArrayList0"/> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
diff --git a/ql/src/test/results/compiler/plan/union.q.xml b/ql/src/test/results/compiler/plan/union.q.xml
index 1f06cb5c3c..f92a63d931 100644
--- a/ql/src/test/results/compiler/plan/union.q.xml
+++ b/ql/src/test/results/compiler/plan/union.q.xml
@@ -44,109 +44,105 @@
                        #### A masked pattern was here #### 
                        <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                         <void property="childOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                            <void property="conf"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                              <void property="dirName"> 
-                               #### A masked pattern was here #### 
-                              </void> 
-                              <void property="numFiles"> 
-                               <int>1</int> 
-                              </void> 
-                              <void property="tableInfo"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-                                <void property="inputFileFormatClass"> 
-                                 <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-                                </void> 
-                                <void property="outputFileFormatClass"> 
-                                 <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-                                </void> 
-                                <void property="properties"> 
-                                 <object class="java.util.Properties"> 
-                                  <void method="put"> 
-                                   <string>columns</string> 
-                                   <string>_col0,_col1</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.lib</string> 
-                                   <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>serialization.format</string> 
-                                   <string>1</string> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>columns.types</string> 
-                                   <string>string:string</string> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void property="totalFiles"> 
-                               <int>1</int> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="operatorId"> 
-                             <string>FS_12</string> 
-                            </void> 
-                            <void property="parentOperators"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object idref="TableScanOperator0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="schema"> 
-                             <object id="RowSchema0" class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                              <void property="signature"> 
-                               <object class="java.util.ArrayList"> 
-                                <void method="add"> 
-                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                  <void property="internalName"> 
-                                   <string>_col0</string> 
-                                  </void> 
-                                  <void property="tabAlias"> 
-                                   <string></string> 
-                                  </void> 
-                                  <void property="type"> 
-                                   <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                                    <void property="typeName"> 
-                                     <string>string</string> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                  <void property="typeName"> 
-                                   <string>string</string> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void method="add"> 
-                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                  <void property="internalName"> 
-                                   <string>_col1</string> 
-                                  </void> 
-                                  <void property="tabAlias"> 
-                                   <string></string> 
-                                  </void> 
-                                  <void property="type"> 
-                                   <object idref="PrimitiveTypeInfo0"/> 
-                                  </void> 
-                                  <void property="typeName"> 
-                                   <string>string</string> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
+                         <void method="add"> 
+                          <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                           <void property="conf"> 
+                            <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                             <void property="dirName"> 
+                              #### A masked pattern was here #### 
+                             </void> 
+                             <void property="numFiles"> 
+                              <int>1</int> 
+                             </void> 
+                             <void property="tableInfo"> 
+                              <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                               <void property="inputFileFormatClass"> 
+                                <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                               </void> 
+                               <void property="outputFileFormatClass"> 
+                                <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                               </void> 
+                               <void property="properties"> 
+                                <object class="java.util.Properties"> 
+                                 <void method="put"> 
+                                  <string>columns</string> 
+                                  <string>_col0,_col1</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.lib</string> 
+                                  <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>serialization.format</string> 
+                                  <string>1</string> 
+                                 </void> 
+                                 <void method="put"> 
+                                  <string>columns.types</string> 
+                                  <string>string:string</string> 
+                                 </void> 
+                                </object> 
+                               </void> 
+                              </object> 
+                             </void> 
+                             <void property="totalFiles"> 
+                              <int>1</int> 
+                             </void> 
+                            </object> 
+                           </void> 
+                           <void property="operatorId"> 
+                            <string>FS_12</string> 
+                           </void> 
+                           <void property="parentOperators"> 
+                            <void method="add"> 
+                             <object idref="TableScanOperator0"/> 
                             </void> 
-                           </object> 
-                          </void> 
-                         </object> 
+                           </void> 
+                           <void property="schema"> 
+                            <object id="RowSchema0" class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                             <void property="signature"> 
+                              <object class="java.util.ArrayList"> 
+                               <void method="add"> 
+                                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                 <void property="internalName"> 
+                                  <string>_col0</string> 
+                                 </void> 
+                                 <void property="tabAlias"> 
+                                  <string></string> 
+                                 </void> 
+                                 <void property="type"> 
+                                  <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                                   <void property="typeName"> 
+                                    <string>string</string> 
+                                   </void> 
+                                  </object> 
+                                 </void> 
+                                 <void property="typeName"> 
+                                  <string>string</string> 
+                                 </void> 
+                                </object> 
+                               </void> 
+                               <void method="add"> 
+                                <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                 <void property="internalName"> 
+                                  <string>_col1</string> 
+                                 </void> 
+                                 <void property="tabAlias"> 
+                                  <string></string> 
+                                 </void> 
+                                 <void property="type"> 
+                                  <object idref="PrimitiveTypeInfo0"/> 
+                                 </void> 
+                                 <void property="typeName"> 
+                                  <string>string</string> 
+                                 </void> 
+                                </object> 
+                               </void> 
+                              </object> 
+                             </void> 
+                            </object> 
+                           </void> 
+                          </object> 
+                         </void> 
                         </void> 
                         <void property="conf"> 
                          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"/> 
@@ -661,470 +657,430 @@
        <string>null-subquery1:unioninput-subquery1:src</string> 
        <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
         <void property="childOperators"> 
-         <object class="java.util.ArrayList"> 
-          <void method="add"> 
-           <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                <void property="childOperators"> 
-                 <object class="java.util.ArrayList"> 
+         <void method="add"> 
+          <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+           <void property="childOperators"> 
+            <void method="add"> 
+             <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+              <void property="childOperators"> 
+               <void method="add"> 
+                <object id="UnionOperator0" class="org.apache.hadoop.hive.ql.exec.UnionOperator"> 
+                 <void property="childOperators"> 
                   <void method="add"> 
-                   <object id="UnionOperator0" class="org.apache.hadoop.hive.ql.exec.UnionOperator"> 
+                   <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
                     <void property="childOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                        <void property="childOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                            <void property="conf"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
-                              <void property="destTableId"> 
-                               <int>1</int> 
-                              </void> 
-                              <void property="dirName"> 
-                               #### A masked pattern was here #### 
-                              </void> 
-                              <void property="numFiles"> 
-                               <int>1</int> 
-                              </void> 
-                              <void property="statsAggPrefix"> 
-                               #### A masked pattern was here #### 
-                              </void> 
-                              <void property="statsCollectRawDataSize"> 
-                               <boolean>true</boolean> 
-                              </void> 
-                              <void property="tableInfo"> 
-                               <object idref="TableDesc0"/> 
-                              </void> 
-                              <void property="totalFiles"> 
-                               <int>1</int> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="operatorId"> 
-                             <string>FS_8</string> 
-                            </void> 
-                            <void property="parentOperators"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object idref="SelectOperator1"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="schema"> 
-                             <object idref="RowSchema0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                       <void property="conf"> 
+                        <object class="org.apache.hadoop.hive.ql.plan.FileSinkDesc"> 
+                         <void property="destTableId"> 
+                          <int>1</int> 
+                         </void> 
+                         <void property="dirName"> 
+                          #### A masked pattern was here #### 
+                         </void> 
+                         <void property="numFiles"> 
+                          <int>1</int> 
+                         </void> 
+                         <void property="statsAggPrefix"> 
+                          #### A masked pattern was here #### 
+                         </void> 
+                         <void property="statsCollectRawDataSize"> 
+                          <boolean>true</boolean> 
+                         </void> 
+                         <void property="tableInfo"> 
+                          <object idref="TableDesc0"/> 
+                         </void> 
+                         <void property="totalFiles"> 
+                          <int>1</int> 
+                         </void> 
+                        </object> 
+                       </void> 
+                       <void property="operatorId"> 
+                        <string>FS_8</string> 
+                       </void> 
+                       <void property="parentOperators"> 
+                        <void method="add"> 
+                         <object idref="SelectOperator1"/> 
                         </void> 
-                        <void property="columnExprMap"> 
-                         <object class="java.util.HashMap"> 
-                          <void method="put"> 
-                           <string>_col1</string> 
-                           <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>_col1</string> 
-                            </void> 
-                            <void property="tabAlias"> 
-                             <string>src</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
+                       </void> 
+                       <void property="schema"> 
+                        <object idref="RowSchema0"/> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </void> 
+                    <void property="columnExprMap"> 
+                     <object class="java.util.HashMap"> 
+                      <void method="put"> 
+                       <string>_col1</string> 
+                       <object id="ExprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                        <void property="column"> 
+                         <string>_col1</string> 
+                        </void> 
+                        <void property="tabAlias"> 
+                         <string>src</string> 
+                        </void> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo0"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void method="put"> 
+                       <string>_col0</string> 
+                       <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                        <void property="column"> 
+                         <string>_col0</string> 
+                        </void> 
+                        <void property="tabAlias"> 
+                         <string>src</string> 
+                        </void> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo0"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="conf"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                      <void property="colList"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <object idref="ExprNodeColumnDesc1"/> 
+                        </void> 
+                        <void method="add"> 
+                         <object idref="ExprNodeColumnDesc0"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="outputColumnNames"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <string>_col0</string> 
+                        </void> 
+                        <void method="add"> 
+                         <string>_col1</string> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="selectStar"> 
+                       <boolean>true</boolean> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="operatorId"> 
+                     <string>SEL_7</string> 
+                    </void> 
+                    <void property="parentOperators"> 
+                     <void method="add"> 
+                      <object idref="UnionOperator0"/> 
+                     </void> 
+                    </void> 
+                    <void property="schema"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                      <void property="signature"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                          <void property="alias"> 
+                           <string>key</string> 
                           </void> 
-                          <void method="put"> 
+                          <void property="internalName"> 
                            <string>_col0</string> 
-                           <object id="ExprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>_col0</string> 
-                            </void> 
-                            <void property="tabAlias"> 
-                             <string>src</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
+                          </void> 
+                          <void property="tabAlias"> 
+                           <string>src</string> 
+                          </void> 
+                          <void property="type"> 
+                           <object idref="PrimitiveTypeInfo0"/> 
+                          </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
                           </void> 
                          </object> 
                         </void> 
-                        <void property="conf"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                          <void property="colList"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object idref="ExprNodeColumnDesc1"/> 
-                            </void> 
-                            <void method="add"> 
-                             <object idref="ExprNodeColumnDesc0"/> 
-                            </void> 
-                           </object> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                          <void property="alias"> 
+                           <string>value</string> 
                           </void> 
-                          <void property="outputColumnNames"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <string>_col0</string> 
-                            </void> 
-                            <void method="add"> 
-                             <string>_col1</string> 
-                            </void> 
-                           </object> 
+                          <void property="internalName"> 
+                           <string>_col1</string> 
+                          </void> 
+                          <void property="tabAlias"> 
+                           <string>src</string> 
                           </void> 
-                          <void property="selectStar"> 
-                           <boolean>true</boolean> 
+                          <void property="type"> 
+                           <object idref="PrimitiveTypeInfo0"/> 
+                          </void> 
+                          <void property="typeName"> 
+                           <string>string</string> 
                           </void> 
                          </object> 
                         </void> 
-                        <void property="operatorId"> 
-                         <string>SEL_7</string> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </void> 
+                 <void property="conf"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.UnionDesc"/> 
+                 </void> 
+                 <void property="operatorId"> 
+                  <string>UNION_6</string> 
+                 </void> 
+                 <void property="parentOperators"> 
+                  <void method="add"> 
+                   <object idref="SelectOperator0"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object id="SelectOperator2" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+                    <void property="childOperators"> 
+                     <void method="add"> 
+                      <object idref="UnionOperator0"/> 
+                     </void> 
+                    </void> 
+                    <void property="columnExprMap"> 
+                     <object class="java.util.HashMap"> 
+                      <void method="put"> 
+                       <string>_col1</string> 
+                       <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                        <void property="column"> 
+                         <string>value</string> 
                         </void> 
-                        <void property="parentOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object idref="UnionOperator0"/> 
-                          </void> 
-                         </object> 
+                        <void property="tabAlias"> 
+                         <string>src</string> 
                         </void> 
-                        <void property="schema"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                          <void property="signature"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="alias"> 
-                               <string>key</string> 
-                              </void> 
-                              <void property="internalName"> 
-                               <string>_col0</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string>src</string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                              <void property="typeName"> 
-                               <string>string</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="alias"> 
-                               <string>value</string> 
-                              </void> 
-                              <void property="internalName"> 
-                               <string>_col1</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string>src</string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                              <void property="typeName"> 
-                               <string>string</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo0"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void method="put"> 
+                       <string>_col0</string> 
+                       <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                        <void property="column"> 
+                         <string>key</string> 
+                        </void> 
+                        <void property="tabAlias"> 
+                         <string>src</string> 
+                        </void> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo0"/> 
                         </void> 
                        </object> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.UnionDesc"/> 
+                     <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                      <void property="colList"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <object idref="ExprNodeColumnDesc3"/> 
+                        </void> 
+                        <void method="add"> 
+                         <object idref="ExprNodeColumnDesc2"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="outputColumnNames"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <string>_col0</string> 
+                        </void> 
+                        <void method="add"> 
+                         <string>_col1</string> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="selectStar"> 
+                       <boolean>true</boolean> 
+                      </void> 
+                     </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>UNION_6</string> 
+                     <string>SEL_5</string> 
                     </void> 
                     <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="SelectOperator0"/> 
-                      </void> 
-                      <void method="add"> 
-                       <object id="SelectOperator2" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                        <void property="childOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object idref="UnionOperator0"/> 
-                          </void> 
-                         </object> 
+                     <void method="add"> 
+                      <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+                       <void property="childOperators"> 
+                        <void method="add"> 
+                         <object idref="SelectOperator2"/> 
                         </void> 
-                        <void property="columnExprMap"> 
-                         <object class="java.util.HashMap"> 
-                          <void method="put"> 
-                           <string>_col1</string> 
-                           <object id="ExprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>value</string> 
-                            </void> 
-                            <void property="tabAlias"> 
-                             <string>src</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
+                       </void> 
+                       <void property="conf"> 
+                        <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
+                         <void property="predicate"> 
+                          <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+                           <void property="children"> 
+                            <object class="java.util.ArrayList"> 
+                             <void method="add"> 
+                              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                               <void property="column"> 
+                                <string>key</string> 
+                               </void> 
+                               <void property="tabAlias"> 
+                                <string>src</string> 
+                               </void> 
+                               <void property="typeInfo"> 
+                                <object idref="PrimitiveTypeInfo0"/> 
+                               </void> 
+                              </object> 
+                             </void> 
+                             <void method="add"> 
+                              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                               <void property="typeInfo"> 
+                                <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                                 <void property="typeName"> 
+                                  <string>int</string> 
+                                 </void> 
+                                </object> 
+                               </void> 
+                               <void property="value"> 
+                                <int>100</int> 
+                               </void> 
+                              </object> 
+                             </void> 
+                            </object> 
+                           </void> 
+                           <void property="genericUDF"> 
+                            <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan"/> 
+                           </void> 
+                           <void property="typeInfo"> 
+                            <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                             <void property="typeName"> 
+                              <string>boolean</string> 
+                             </void> 
+                            </object> 
+                           </void> 
+                          </object> 
+                         </void> 
+                        </object> 
+                       </void> 
+                       <void property="operatorId"> 
+                        <string>FIL_10</string> 
+                       </void> 
+                       <void property="parentOperators"> 
+                        <void method="add"> 
+                         <object id="TableScanOperator2" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
+                          <void property="childOperators"> 
+                           <void method="add"> 
+                            <object idref="FilterOperator1"/> 
+                           </void> 
                           </void> 
-                          <void method="put"> 
-                           <string>_col0</string> 
-                           <object id="ExprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>key</string> 
-                            </void> 
-                            <void property="tabAlias"> 
+                          <void property="conf"> 
+                           <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
+                            <void property="alias"> 
                              <string>src</string> 
                             </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
+                            <void property="virtualCols"> 
+                             <object class="java.util.ArrayList"/> 
                             </void> 
                            </object> 
                           </void> 
-                         </object> 
-                        </void> 
-                        <void property="conf"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                          <void property="colList"> 
+                          <void property="neededColumnIDs"> 
                            <object class="java.util.ArrayList"> 
                             <void method="add"> 
-                             <object idref="ExprNodeColumnDesc3"/> 
+                             <int>0</int> 
                             </void> 
                             <void method="add"> 
-                             <object idref="ExprNodeColumnDesc2"/> 
+                             <int>1</int> 
                             </void> 
                            </object> 
                           </void> 
-                          <void property="outputColumnNames"> 
+                          <void property="neededColumns"> 
                            <object class="java.util.ArrayList"> 
                             <void method="add"> 
-                             <string>_col0</string> 
+                             <string>key</string> 
                             </void> 
                             <void method="add"> 
-                             <string>_col1</string> 
+                             <string>value</string> 
                             </void> 
                            </object> 
                           </void> 
-                          <void property="selectStar"> 
-                           <boolean>true</boolean> 
+                          <void property="operatorId"> 
+                           <string>TS_3</string> 
                           </void> 
-                         </object> 
-                        </void> 
-                        <void property="operatorId"> 
-                         <string>SEL_5</string> 
-                        </void> 
-                        <void property="parentOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
-                            <void property="childOperators"> 
+                          <void property="schema"> 
+                           <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                            <void property="signature"> 
                              <object class="java.util.ArrayList"> 
                               <void method="add"> 
-                               <object idref="SelectOperator2"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="conf"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-                              <void property="predicate"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                                <void property="children"> 
-                                 <object class="java.util.ArrayList"> 
-                                  <void method="add"> 
-                                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                                    <void property="column"> 
-                                     <string>key</string> 
-                                    </void> 
-                                    <void property="tabAlias"> 
-                                     <string>src</string> 
-                                    </void> 
-                                    <void property="typeInfo"> 
-                                     <object idref="PrimitiveTypeInfo0"/> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                  <void method="add"> 
-                                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                                    <void property="typeInfo"> 
-                                     <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                                      <void property="typeName"> 
-                                       <string>int</string> 
-                                      </void> 
-                                     </object> 
-                                    </void> 
-                                    <void property="value"> 
-                                     <int>100</int> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                 </object> 
+                               <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                <void property="internalName"> 
+                                 <string>key</string> 
                                 </void> 
-                                <void property="genericUDF"> 
-                                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan"/> 
+                                <void property="tabAlias"> 
+                                 <string>src</string> 
                                 </void> 
-                                <void property="typeInfo"> 
-                                 <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                                  <void property="typeName"> 
-                                   <string>boolean</string> 
-                                  </void> 
-                                 </object> 
+                                <void property="type"> 
+                                 <object idref="PrimitiveTypeInfo0"/> 
+                                </void> 
+                                <void property="typeName"> 
+                                 <string>string</string> 
                                 </void> 
                                </object> 
                               </void> 
-                             </object> 
-                            </void> 
-                            <void property="operatorId"> 
-                             <string>FIL_10</string> 
-                            </void> 
-                            <void property="parentOperators"> 
-                             <object class="java.util.ArrayList"> 
                               <void method="add"> 
-                               <object id="TableScanOperator2" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
-                                <void property="childOperators"> 
-                                 <object class="java.util.ArrayList"> 
-                                  <void method="add"> 
-                                   <object idref="FilterOperator1"/> 
-                                  </void> 
-                                 </object> 
+                               <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                <void property="internalName"> 
+                                 <string>value</string> 
                                 </void> 
-                                <void property="conf"> 
-                                 <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
-                                  <void property="alias"> 
-                                   <string>src</string> 
-                                  </void> 
-                                  <void property="virtualCols"> 
-                                   <object class="java.util.ArrayList"/> 
-                                  </void> 
-                                 </object> 
+                                <void property="tabAlias"> 
+                                 <string>src</string> 
                                 </void> 
-                                <void property="neededColumnIDs"> 
-                                 <object class="java.util.ArrayList"> 
-                                  <void method="add"> 
-                                   <int>0</int> 
-                                  </void> 
-                                  <void method="add"> 
-                                   <int>1</int> 
-                                  </void> 
-                                 </object> 
+                                <void property="type"> 
+                                 <object idref="PrimitiveTypeInfo0"/> 
                                 </void> 
-                                <void property="neededColumns"> 
-                                 <object class="java.util.ArrayList"> 
-                                  <void method="add"> 
-                                   <string>key</string> 
-                                  </void> 
-                                  <void method="add"> 
-                                   <string>value</string> 
-                                  </void> 
-                                 </object> 
+                                <void property="typeName"> 
+                                 <string>string</string> 
                                 </void> 
-                                <void property="operatorId"> 
-                                 <string>TS_3</string> 
+                               </object> 
+                              </void> 
+                              <void method="add"> 
+                               <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                <void property="hiddenVirtualCol"> 
+                                 <boolean>true</boolean> 
                                 </void> 
-                                <void property="schema"> 
-                                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                                  <void property="signature"> 
-                                   <object class="java.util.ArrayList"> 
-                                    <void method="add"> 
-                                     <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                      <void property="internalName"> 
-                                       <string>key</string> 
-                                      </void> 
-                                      <void property="tabAlias"> 
-                                       <string>src</string> 
-                                      </void> 
-                                      <void property="type"> 
-                                       <object idref="PrimitiveTypeInfo0"/> 
-                                      </void> 
-                                      <void property="typeName"> 
-                                       <string>string</string> 
-                                      </void> 
-                                     </object> 
-                                    </void> 
-                                    <void method="add"> 
-                                     <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                      <void property="internalName"> 
-                                       <string>value</string> 
-                                      </void> 
-                                      <void property="tabAlias"> 
-                                       <string>src</string> 
-                                      </void> 
-                                      <void property="type"> 
-                                       <object idref="PrimitiveTypeInfo0"/> 
-                                      </void> 
-                                      <void property="typeName"> 
-                                       <string>string</string> 
-                                      </void> 
-                                     </object> 
-                                    </void> 
-                                    <void method="add"> 
-                                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                      <void property="hiddenVirtualCol"> 
-                                       <boolean>true</boolean> 
-                                      </void> 
-                                      <void property="internalName"> 
-                                       <string>BLOCK__OFFSET__INSIDE__FILE</string> 
-                                      </void> 
-                                      <void property="tabAlias"> 
-                                       <string>src</string> 
-                                      </void> 
-                                      <void property="type"> 
-                                       <object id="PrimitiveTypeInfo3" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                                        <void property="typeName"> 
-                                         <string>bigint</string> 
-                                        </void> 
-                                       </object> 
-                                      </void> 
-                                      <void property="typeName"> 
-                                       <string>bigint</string> 
-                                      </void> 
-                                     </object> 
-                                    </void> 
-                                    <void method="add"> 
-                                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                      <void property="hiddenVirtualCol"> 
-                                       <boolean>true</boolean> 
-                                      </void> 
-                                      <void property="internalName"> 
-                                       <string>INPUT__FILE__NAME</string> 
-                                      </void> 
-                                      <void property="tabAlias"> 
-                                       <string>src</string> 
-                                      </void> 
-                                      <void property="type"> 
-                                       <object idref="PrimitiveTypeInfo0"/> 
-                                      </void> 
-                                      <void property="typeName"> 
-                                       <string>string</string> 
-                                      </void> 
-                                     </object> 
-                                    </void> 
-                                   </object> 
+                                <void property="internalName"> 
+                                 <string>BLOCK__OFFSET__INSIDE__FILE</string> 
+                                </void> 
+                                <void property="tabAlias"> 
+                                 <string>src</string> 
+                                </void> 
+                                <void property="type"> 
+                                 <object id="PrimitiveTypeInfo3" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                                  <void property="typeName"> 
+                                   <string>bigint</string> 
                                   </void> 
                                  </object> 
                                 </void> 
+                                <void property="typeName"> 
+                                 <string>bigint</string> 
+                                </void> 
                                </object> 
                               </void> 
-                             </object> 
-                            </void> 
-                            <void property="schema"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                              <void property="signature"> 
-                               <object class="java.util.ArrayList"> 
-                                <void method="add"> 
-                                 <object idref="ColumnInfo0"/> 
+                              <void method="add"> 
+                               <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                <void property="hiddenVirtualCol"> 
+                                 <boolean>true</boolean> 
+                                </void> 
+                                <void property="internalName"> 
+                                 <string>INPUT__FILE__NAME</string> 
+                                </void> 
+                                <void property="tabAlias"> 
+                                 <string>src</string> 
+                                </void> 
+                                <void property="type"> 
+                                 <object idref="PrimitiveTypeInfo0"/> 
                                 </void> 
-                                <void method="add"> 
-                                 <object idref="ColumnInfo1"/> 
+                                <void property="typeName"> 
+                                 <string>string</string> 
                                 </void> 
                                </object> 
                               </void> 
@@ -1134,49 +1090,23 @@
                           </void> 
                          </object> 
                         </void> 
-                        <void property="schema"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                          <void property="signature"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>_col0</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string>src</string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                              <void property="typeName"> 
-                               <string>string</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>_col1</string> 
-                              </void> 
-                              <void property="tabAlias"> 
-                               <string>src</string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                              <void property="typeName"> 
-                               <string>string</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                       </void> 
+                       <void property="schema"> 
+                        <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                         <void property="signature"> 
+                          <object class="java.util.ArrayList"> 
+                           <void method="add"> 
+                            <object idref="ColumnInfo0"/> 
+                           </void> 
+                           <void method="add"> 
+                            <object idref="ColumnInfo1"/> 
+                           </void> 
+                          </object> 
+                         </void> 
+                        </object> 
+                       </void> 
+                      </object> 
+                     </void> 
                     </void> 
                     <void property="schema"> 
                      <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -1220,212 +1150,248 @@
                     </void> 
                    </object> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="columnExprMap"> 
-                 <object class="java.util.HashMap"> 
-                  <void method="put"> 
-                   <string>_col1</string> 
-                   <object id="ExprNodeColumnDesc4" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>value</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>src</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
+                 </void> 
+                 <void property="schema"> 
+                  <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                   <void property="signature"> 
+                    <object class="java.util.ArrayList"> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>_col0</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string>src</string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                     <void method="add"> 
+                      <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                       <void property="internalName"> 
+                        <string>_col1</string> 
+                       </void> 
+                       <void property="tabAlias"> 
+                        <string>src</string> 
+                       </void> 
+                       <void property="type"> 
+                        <object idref="PrimitiveTypeInfo0"/> 
+                       </void> 
+                       <void property="typeName"> 
+                        <string>string</string> 
+                       </void> 
+                      </object> 
+                     </void> 
+                    </object> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+              </void> 
+              <void property="columnExprMap"> 
+               <object class="java.util.HashMap"> 
+                <void method="put"> 
+                 <string>_col1</string> 
+                 <object id="ExprNodeColumnDesc4" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>value</string> 
                   </void> 
-                  <void method="put"> 
-                   <string>_col0</string> 
-                   <object id="ExprNodeColumnDesc5" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>key</string> 
-                    </void> 
-                    <void property="tabAlias"> 
-                     <string>src</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
+                  <void property="tabAlias"> 
+                   <string>src</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
-                  <void property="colList"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc5"/> 
-                    </void> 
-                    <void method="add"> 
-                     <object idref="ExprNodeColumnDesc4"/> 
-                    </void> 
-                   </object> 
+                <void method="put"> 
+                 <string>_col0</string> 
+                 <object id="ExprNodeColumnDesc5" class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>key</string> 
                   </void> 
-                  <void property="outputColumnNames"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <string>_col0</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col1</string> 
-                    </void> 
-                   </object> 
+                  <void property="tabAlias"> 
+                   <string>src</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="operatorId"> 
-                 <string>SEL_2</string> 
-                </void> 
-                <void property="parentOperators"> 
+               </object> 
+              </void> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.SelectDesc"> 
+                <void property="colList"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object idref="FilterOperator0"/> 
+                   <object idref="ExprNodeColumnDesc5"/> 
+                  </void> 
+                  <void method="add"> 
+                   <object idref="ExprNodeColumnDesc4"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>src</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="tabAlias"> 
-                       <string>src</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                      <void property="typeName"> 
-                       <string>string</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                <void property="outputColumnNames"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <string>_col0</string> 
+                  </void> 
+                  <void method="add"> 
+                   <string>_col1</string> 
                   </void> 
                  </object> 
                 </void> 
                </object> 
               </void> 
-             </object> 
-            </void> 
-            <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
-              <void property="predicate"> 
-               <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
-                <void property="children"> 
+              <void property="operatorId"> 
+               <string>SEL_2</string> 
+              </void> 
+              <void property="parentOperators"> 
+               <void method="add"> 
+                <object idref="FilterOperator0"/> 
+               </void> 
+              </void> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>key</string> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col0</string> 
                     </void> 
                     <void property="tabAlias"> 
                      <string>src</string> 
                     </void> 
-                    <void property="typeInfo"> 
+                    <void property="type"> 
                      <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
+                    </void> 
                    </object> 
                   </void> 
                   <void method="add"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>_col1</string> 
                     </void> 
-                    <void property="value"> 
-                     <int>100</int> 
+                    <void property="tabAlias"> 
+                     <string>src</string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                    <void property="typeName"> 
+                     <string>string</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="genericUDF"> 
-                 <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo2"/> 
-                </void> 
                </object> 
               </void> 
              </object> 
             </void> 
-            <void property="operatorId"> 
-             <string>FIL_9</string> 
-            </void> 
-            <void property="parentOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="TableScanOperator1"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object id="ColumnInfo2" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>key</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object id="ColumnInfo3" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>value</string> 
-                  </void> 
-                  <void property="tabAlias"> 
-                   <string>src</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                  <void property="typeName"> 
-                   <string>string</string> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
+           </void> 
+           <void property="conf"> 
+            <object class="org.apache.hadoop.hive.ql.plan.FilterDesc"> 
+             <void property="predicate"> 
+              <object class="org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc"> 
+               <void property="children"> 
+                <object class="java.util.ArrayList"> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc"> 
+                   <void property="column"> 
+                    <string>key</string> 
+                   </void> 
+                   <void property="tabAlias"> 
+                    <string>src</string> 
+                   </void> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo0"/> 
+                   </void> 
+                  </object> 
+                 </void> 
+                 <void method="add"> 
+                  <object class="org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc"> 
+                   <void property="typeInfo"> 
+                    <object idref="PrimitiveTypeInfo1"/> 
+                   </void> 
+                   <void property="value"> 
+                    <int>100</int> 
+                   </void> 
+                  </object> 
+                 </void> 
+                </object> 
+               </void> 
+               <void property="genericUDF"> 
+                <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan"/> 
+               </void> 
+               <void property="typeInfo"> 
+                <object idref="PrimitiveTypeInfo2"/> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+           <void property="operatorId"> 
+            <string>FIL_9</string> 
+           </void> 
+           <void property="parentOperators"> 
+            <void method="add"> 
+             <object idref="TableScanOperator1"/> 
             </void> 
-           </object> 
-          </void> 
-         </object> 
+           </void> 
+           <void property="schema"> 
+            <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+             <void property="signature"> 
+              <object class="java.util.ArrayList"> 
+               <void method="add"> 
+                <object id="ColumnInfo2" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>key</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+               <void method="add"> 
+                <object id="ColumnInfo3" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                 <void property="internalName"> 
+                  <string>value</string> 
+                 </void> 
+                 <void property="tabAlias"> 
+                  <string>src</string> 
+                 </void> 
+                 <void property="type"> 
+                  <object idref="PrimitiveTypeInfo0"/> 
+                 </void> 
+                 <void property="typeName"> 
+                  <string>string</string> 
+                 </void> 
+                </object> 
+               </void> 
+              </object> 
+             </void> 
+            </object> 
+           </void> 
+          </object> 
+         </void> 
         </void> 
         <void property="conf"> 
          <object class="org.apache.hadoop.hive.ql.plan.TableScanDesc"> 
