diff --git a/llap-server/src/java/org/apache/hadoop/hive/llap/cache/BuddyAllocator.java b/llap-server/src/java/org/apache/hadoop/hive/llap/cache/BuddyAllocator.java
index 08a6ca89c6..ae64d20604 100644
--- a/llap-server/src/java/org/apache/hadoop/hive/llap/cache/BuddyAllocator.java
+++ b/llap-server/src/java/org/apache/hadoop/hive/llap/cache/BuddyAllocator.java
@@ -282,7 +282,7 @@ public void debugDump(StringBuilder result) {
           int nextHeaderIx = freeList.listHead;
           while (nextHeaderIx >= 0) {
             result.append(nextHeaderIx + ", ");
-            nextHeaderIx = data.getInt(offsetFromHeaderIndex(nextHeaderIx));
+            nextHeaderIx = getNextFreeListItem(offsetFromHeaderIndex(nextHeaderIx));
           }
         } finally {
           freeList.lock.unlock();
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/io/orc/encoded/EncodedReaderImpl.java b/ql/src/java/org/apache/hadoop/hive/ql/io/orc/encoded/EncodedReaderImpl.java
index b1477e75c0..0d3b64cd5d 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/io/orc/encoded/EncodedReaderImpl.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/io/orc/encoded/EncodedReaderImpl.java
@@ -956,16 +956,16 @@ private static CacheChunk copyAndReplaceUncompressedToNonCached(
   private static void copyAndReplaceUncompressedChunks(
       UncompressedCacheChunk candidateCached, ByteBuffer dest, CacheChunk tcc) {
     int startPos = dest.position(), startLim = dest.limit();
-    BufferChunk chunk = candidateCached.getChunk();
+    DiskRangeList next = null;
     for (int i = 0; i < candidateCached.getCount(); ++i) {
+      BufferChunk chunk = (i == 0) ? candidateCached.getChunk() : (BufferChunk)next;
       dest.put(chunk.getData());
-      BufferChunk next = (BufferChunk)(chunk.next);
+      next = chunk.next;
       if (i == 0) {
         chunk.replaceSelfWith(tcc);
       } else {
         chunk.removeSelf();
       }
-      chunk = next;
     }
     int newPos = dest.position();
     if (newPos > startLim) {
