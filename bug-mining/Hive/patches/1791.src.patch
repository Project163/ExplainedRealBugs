diff --git a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDAFSum.java b/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDAFSum.java
index 58685f06b4..8508ffb1ec 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDAFSum.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDAFSum.java
@@ -50,7 +50,7 @@ public class GenericUDAFSum extends AbstractGenericUDAFResolver {
 
   @Override
   public GenericUDAFEvaluator getEvaluator(TypeInfo[] parameters)
-    throws SemanticException {
+      throws SemanticException {
     if (parameters.length != 1) {
       throw new UDFArgumentTypeException(parameters.length - 1,
           "Exactly one argument is expected.");
@@ -59,15 +59,15 @@ public GenericUDAFEvaluator getEvaluator(TypeInfo[] parameters)
     if (parameters[0].getCategory() != ObjectInspector.Category.PRIMITIVE) {
       throw new UDFArgumentTypeException(0,
           "Only primitive type arguments are accepted but "
-          + parameters[0].getTypeName() + " is passed.");
+              + parameters[0].getTypeName() + " is passed.");
     }
     switch (((PrimitiveTypeInfo) parameters[0]).getPrimitiveCategory()) {
     case BYTE:
     case SHORT:
     case INT:
     case LONG:
-    case TIMESTAMP:
       return new GenericUDAFSumLong();
+    case TIMESTAMP:
     case FLOAT:
     case DOUBLE:
     case STRING:
@@ -81,7 +81,7 @@ public GenericUDAFEvaluator getEvaluator(TypeInfo[] parameters)
     default:
       throw new UDFArgumentTypeException(0,
           "Only numeric or string type arguments are accepted but "
-          + parameters[0].getTypeName() + " is passed.");
+              + parameters[0].getTypeName() + " is passed.");
     }
   }
 
@@ -145,7 +145,7 @@ public void iterate(AggregationBuffer agg, Object[] parameters) throws HiveExcep
           LOG.warn(getClass().getSimpleName() + " "
               + StringUtils.stringifyException(e));
           LOG
-              .warn(getClass().getSimpleName()
+          .warn(getClass().getSimpleName()
               + " ignoring similar exceptions.");
         }
       }
@@ -234,7 +234,7 @@ public void iterate(AggregationBuffer agg, Object[] parameters) throws HiveExcep
           LOG.warn(getClass().getSimpleName() + " "
               + StringUtils.stringifyException(e));
           LOG
-              .warn(getClass().getSimpleName()
+          .warn(getClass().getSimpleName()
               + " ignoring similar exceptions.");
         }
       }
diff --git a/ql/src/test/queries/clientpositive/timestamp_3.q b/ql/src/test/queries/clientpositive/timestamp_3.q
index e5a43456d7..0e1a8d5526 100644
--- a/ql/src/test/queries/clientpositive/timestamp_3.q
+++ b/ql/src/test/queries/clientpositive/timestamp_3.q
@@ -16,4 +16,6 @@ select cast(t as float) from timestamp_3 limit 1;
 select cast(t as double) from timestamp_3 limit 1;
 select cast(t as string) from timestamp_3 limit 1;
 
+select t, sum(t), count(*), sum(t)/count(*), avg(t) from timestamp_3 group by t;
+
 drop table timestamp_3;
diff --git a/ql/src/test/results/clientpositive/timestamp_3.q.out b/ql/src/test/results/clientpositive/timestamp_3.q.out
index 8544307df7..7eaf5cb47e 100644
--- a/ql/src/test/results/clientpositive/timestamp_3.q.out
+++ b/ql/src/test/results/clientpositive/timestamp_3.q.out
@@ -106,6 +106,16 @@ POSTHOOK: Input: default@timestamp_3
 #### A masked pattern was here ####
 POSTHOOK: Lineage: timestamp_3.t EXPRESSION []
 2011-04-29 20:46:56.4485
+PREHOOK: query: select t, sum(t), count(*), sum(t)/count(*), avg(t) from timestamp_3 group by t
+PREHOOK: type: QUERY
+PREHOOK: Input: default@timestamp_3
+#### A masked pattern was here ####
+POSTHOOK: query: select t, sum(t), count(*), sum(t)/count(*), avg(t) from timestamp_3 group by t
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@timestamp_3
+#### A masked pattern was here ####
+POSTHOOK: Lineage: timestamp_3.t EXPRESSION []
+2011-04-29 20:46:56.4485	1.3041352164485E9	1	1.3041352164485E9	1.3041352164485E9
 PREHOOK: query: drop table timestamp_3
 PREHOOK: type: DROPTABLE
 PREHOOK: Input: default@timestamp_3
