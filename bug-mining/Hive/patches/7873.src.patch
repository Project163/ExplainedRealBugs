diff --git a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/calcite/translator/ASTBuilder.java b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/calcite/translator/ASTBuilder.java
index 8abc28ac4c..4bfefd5bb1 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/calcite/translator/ASTBuilder.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/calcite/translator/ASTBuilder.java
@@ -247,6 +247,8 @@ public static ASTNode literal(RexLiteral literal) {
     case INTERVAL_SECOND:
     case INTERVAL_YEAR:
     case INTERVAL_YEAR_MONTH:
+    case MAP:
+    case ARRAY:
     case ROW:
       if (literal.getValue() == null) {
         return ASTBuilder.construct(HiveParser.TOK_NULL, "TOK_NULL").node();
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/calcite/translator/ASTConverter.java b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/calcite/translator/ASTConverter.java
index 4fe7f7d03b..90c06447fd 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/calcite/translator/ASTConverter.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/calcite/translator/ASTConverter.java
@@ -786,8 +786,10 @@ public ASTNode visitCall(RexCall call) {
         break;
       case CAST:
         assert(call.getOperands().size() == 1);
-        if(call.getType().isStruct()) {
-          // cast for struct types can be ignored safely because explicit casting on struct
+        if (call.getType().isStruct() ||
+            SqlTypeName.MAP.equals(call.getType().getSqlTypeName()) ||
+            SqlTypeName.ARRAY.equals(call.getType().getSqlTypeName())) {
+          // cast for complex types can be ignored safely because explicit casting on such
           // types are not possible, implicit casting e.g. CAST(ROW__ID as <...>) can be ignored
           return call.getOperands().get(0).accept(this);
         }
diff --git a/ql/src/test/results/clientpositive/llap/analyze_npe.q.out b/ql/src/test/results/clientpositive/llap/analyze_npe.q.out
index f532295b3b..dfcf9c7763 100644
--- a/ql/src/test/results/clientpositive/llap/analyze_npe.q.out
+++ b/ql/src/test/results/clientpositive/llap/analyze_npe.q.out
@@ -133,7 +133,7 @@ STAGE PLANS:
           Filter Operator
             predicate: c1 is null (type: boolean)
             Select Operator
-              expressions: Const map<string,string> null (type: map<string,string>)
+              expressions: null (type: void)
               outputColumnNames: _col0
               ListSink
 
@@ -159,7 +159,7 @@ STAGE PLANS:
           Filter Operator
             predicate: c1 is null (type: boolean)
             Select Operator
-              expressions: Const array<string> null (type: array<string>)
+              expressions: null (type: void)
               outputColumnNames: _col0
               ListSink
 
