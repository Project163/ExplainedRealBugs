diff --git a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRProcContext.java b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRProcContext.java
index 82a0b491a6..0da5790cfc 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRProcContext.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRProcContext.java
@@ -27,6 +27,7 @@
 import java.util.Set;
 
 import org.apache.hadoop.hive.conf.HiveConf;
+import org.apache.hadoop.hive.conf.HiveConf.ConfVars;
 import org.apache.hadoop.hive.ql.exec.DependencyCollectionTask;
 import org.apache.hadoop.hive.ql.exec.FileSinkOperator;
 import org.apache.hadoop.hive.ql.exec.Operator;
@@ -440,8 +441,10 @@ public void setConf(HiveConf conf) {
    */
   public DependencyCollectionTask getDependencyTaskForMultiInsert() {
     if (dependencyTaskForMultiInsert == null) {
-      dependencyTaskForMultiInsert =
-          (DependencyCollectionTask) TaskFactory.get(new DependencyCollectionWork(), conf);
+      if (conf.getBoolVar(ConfVars.HIVE_MULTI_INSERT_MOVE_TASKS_SHARE_DEPENDENCIES)) {
+        dependencyTaskForMultiInsert =
+            (DependencyCollectionTask) TaskFactory.get(new DependencyCollectionWork(), conf);
+      }
     }
     return dependencyTaskForMultiInsert;
   }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMapRedUtils.java b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMapRedUtils.java
index e75720902d..01d8b7324c 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMapRedUtils.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMapRedUtils.java
@@ -1332,7 +1332,7 @@ public static void addDependentMoveTasks(Task<MoveWork> mvTask, HiveConf hconf,
       Task<? extends Serializable> parentTask, DependencyCollectionTask dependencyTask) {
 
     if (mvTask != null) {
-      if (hconf.getBoolVar(ConfVars.HIVE_MULTI_INSERT_MOVE_TASKS_SHARE_DEPENDENCIES)) {
+      if (dependencyTask != null) {
         parentTask.addDependentTask(dependencyTask);
         if (mvTask.getWork().getLoadTableWork() != null) {
           // Moving tables/partitions depend on the dependencyTask
