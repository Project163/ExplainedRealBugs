diff --git a/CHANGES.txt b/CHANGES.txt
index aa13607bd9..72f02bb41d 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -132,6 +132,8 @@ Release 0.3.0 - Unreleased
     HIVE-384. Fixing UNION ALL when the first job is a map-only job.
     (Namit Jain via zshao)
 
+    HIVE-394. Break plans in Cluster Mode. (Namit Jain via zshao)
+
 Release 0.2.0 - Unreleased
 
   INCOMPATIBLE CHANGES
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
index c2dc17106d..e8bc59f8c8 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
@@ -80,6 +80,8 @@
 import org.apache.hadoop.hive.ql.optimizer.GenMRRedSink3;
 import org.apache.hadoop.hive.ql.plan.*;
 import org.apache.hadoop.hive.ql.udf.UDFOPPositive;
+import org.apache.hadoop.hive.ql.exec.MapRedTask;
+import org.apache.hadoop.hive.ql.exec.ExecDriver;
 import org.apache.hadoop.hive.ql.exec.*;
 import org.apache.hadoop.hive.conf.HiveConf;
 import org.apache.hadoop.hive.ql.plan.PlanUtils;
@@ -3473,8 +3475,9 @@ private void genMapRedTasks(QB qb) throws SemanticException {
 
   // loop over all the tasks recursviely
   private void breakTaskTree(Task<? extends Serializable> task) { 
-    if (task instanceof MapRedTask) {
-      HashMap<String, Operator<? extends Serializable>> opMap = ((MapRedTask)task).getWork().getAliasToWork();
+    
+    if ((task instanceof MapRedTask) || (task instanceof ExecDriver)) {
+      HashMap<String, Operator<? extends Serializable>> opMap = ((mapredWork)task.getWork()).getAliasToWork();
       if (!opMap.isEmpty())
         for (Operator<? extends Serializable> op: opMap.values())
           breakOperatorTree(op);
