diff --git a/CHANGES.txt b/CHANGES.txt
index 0a4f00b222..d87adb11ce 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -355,6 +355,8 @@ Trunk - Unreleased
 
     HIVE-632. Make conditional task serializable. (Namit Jain via zshao)
 
+    HIVE-160. Bug in sampling for subqueries. (Raghu Murthy via namit)
+
 Release 0.3.1 - Unreleased
 
   INCOMPATIBLE CHANGES
diff --git a/data/files/srcbucket0.txt b/data/files/srcbucket0.txt
new file mode 100644
index 0000000000..c11aec09d9
--- /dev/null
+++ b/data/files/srcbucket0.txt
@@ -0,0 +1,493 @@
+474val_475
+62val_63
+468val_469
+272val_273
+448val_449
+246val_247
+440val_441
+278val_279
+296val_297
+428val_429
+126val_127
+106val_107
+356val_357
+490val_491
+402val_403
+128val_129
+10val_11
+226val_227
+110val_111
+0val_1
+240val_241
+286val_287
+408val_409
+476val_477
+482val_483
+48val_49
+424val_425
+226val_227
+494val_495
+488val_489
+94val_95
+50val_51
+402val_403
+128val_129
+468val_469
+314val_315
+224val_225
+344val_345
+4val_5
+206val_207
+114val_115
+56val_57
+114val_115
+254val_255
+390val_391
+304val_305
+264val_265
+196val_197
+238val_239
+20val_21
+492val_493
+82val_83
+58val_59
+86val_87
+438val_439
+360val_361
+222val_223
+42val_43
+338val_339
+68val_69
+16val_17
+492val_493
+376val_377
+120val_121
+306val_307
+426val_427
+132val_133
+446val_447
+386val_387
+388val_389
+184val_185
+284val_285
+246val_247
+262val_263
+122val_123
+438val_439
+390val_391
+352val_353
+226val_227
+328val_329
+382val_383
+342val_343
+480val_481
+102val_103
+480val_481
+318val_319
+392val_393
+476val_477
+258val_259
+174val_175
+252val_253
+114val_115
+264val_265
+48val_49
+336val_337
+340val_341
+390val_391
+484val_485
+6val_7
+260val_261
+2val_3
+170val_171
+164val_165
+118val_119
+310val_311
+104val_105
+80val_81
+326val_327
+450val_451
+140val_141
+212val_213
+308val_309
+30val_31
+358val_359
+416val_417
+42val_43
+386val_387
+454val_455
+364val_365
+20val_21
+52val_53
+40val_41
+8val_9
+168val_169
+384val_385
+324val_325
+310val_311
+206val_207
+404val_405
+206val_207
+226val_227
+262val_263
+260val_261
+328val_329
+322val_323
+122val_123
+404val_405
+384val_385
+76val_77
+116val_117
+42val_43
+104val_105
+406val_407
+32val_33
+132val_133
+192val_193
+58val_59
+70val_71
+356val_357
+352val_353
+52val_53
+330val_331
+138val_139
+160val_161
+454val_455
+76val_77
+174val_175
+412val_413
+16val_17
+204val_205
+126val_127
+274val_275
+374val_375
+494val_495
+216val_217
+470val_471
+196val_197
+302val_303
+450val_451
+12val_13
+398val_399
+334val_335
+384val_385
+60val_61
+442val_443
+52val_53
+404val_405
+446val_447
+300val_301
+0val_1
+268val_269
+392val_393
+104val_105
+436val_437
+156val_157
+118val_119
+172val_173
+244val_245
+6val_7
+284val_285
+164val_165
+136val_137
+462val_463
+432val_433
+496val_497
+144val_145
+408val_409
+152val_153
+382val_383
+348val_349
+122val_123
+292val_293
+182val_183
+474val_475
+310val_311
+52val_53
+486val_487
+152val_153
+378val_379
+414val_415
+256val_257
+292val_293
+412val_413
+40val_41
+478val_479
+178val_179
+100val_101
+156val_157
+228val_229
+22val_23
+248val_249
+402val_403
+62val_63
+162val_163
+244val_245
+276val_277
+46val_47
+78val_79
+134val_135
+196val_197
+410val_411
+82val_83
+440val_441
+100val_101
+308val_309
+430val_431
+468val_469
+152val_153
+138val_139
+76val_77
+300val_301
+478val_479
+118val_119
+178val_179
+242val_243
+244val_245
+238val_238
+86val_86
+278val_278
+98val_98
+484val_484
+150val_150
+224val_224
+66val_66
+128val_128
+146val_146
+406val_406
+374val_374
+152val_152
+82val_82
+166val_166
+430val_430
+252val_252
+292val_292
+338val_338
+446val_446
+394val_394
+482val_482
+174val_174
+494val_494
+466val_466
+208val_208
+174val_174
+396val_396
+162val_162
+266val_266
+342val_342
+0val_0
+128val_128
+316val_316
+302val_302
+438val_438
+170val_170
+20val_20
+378val_378
+92val_92
+72val_72
+4val_4
+280val_280
+208val_208
+356val_356
+382val_382
+498val_498
+386val_386
+192val_192
+286val_286
+176val_176
+54val_54
+138val_138
+216val_216
+430val_430
+278val_278
+176val_176
+318val_318
+332val_332
+180val_180
+284val_284
+12val_12
+230val_230
+260val_260
+404val_404
+384val_384
+272val_272
+138val_138
+84val_84
+348val_348
+466val_466
+58val_58
+8val_8
+230val_230
+208val_208
+348val_348
+24val_24
+172val_172
+42val_42
+158val_158
+496val_496
+0val_0
+322val_322
+468val_468
+454val_454
+100val_100
+298val_298
+418val_418
+96val_96
+26val_26
+230val_230
+120val_120
+404val_404
+436val_436
+156val_156
+468val_468
+308val_308
+196val_196
+288val_288
+98val_98
+282val_282
+318val_318
+318val_318
+470val_470
+316val_316
+0val_0
+490val_490
+364val_364
+118val_118
+134val_134
+282val_282
+138val_138
+238val_238
+118val_118
+72val_72
+90val_90
+10val_10
+306val_306
+224val_224
+242val_242
+392val_392
+272val_272
+242val_242
+452val_452
+226val_226
+402val_402
+396val_396
+58val_58
+336val_336
+168val_168
+34val_34
+472val_472
+322val_322
+498val_498
+160val_160
+42val_42
+430val_430
+458val_458
+78val_78
+76val_76
+492val_492
+218val_218
+228val_228
+138val_138
+30val_30
+64val_64
+468val_468
+76val_76
+74val_74
+342val_342
+230val_230
+368val_368
+296val_296
+216val_216
+344val_344
+274val_274
+116val_116
+256val_256
+70val_70
+480val_480
+288val_288
+244val_244
+438val_438
+128val_128
+432val_432
+202val_202
+316val_316
+280val_280
+2val_2
+80val_80
+44val_44
+104val_104
+466val_466
+366val_366
+406val_406
+190val_190
+406val_406
+114val_114
+258val_258
+90val_90
+262val_262
+348val_348
+424val_424
+12val_12
+396val_396
+164val_164
+454val_454
+478val_478
+298val_298
+164val_164
+424val_424
+382val_382
+70val_70
+480val_480
+24val_24
+104val_104
+70val_70
+438val_438
+414val_414
+200val_200
+360val_360
+248val_248
+444val_444
+120val_120
+230val_230
+478val_478
+178val_178
+468val_468
+310val_310
+460val_460
+480val_480
+136val_136
+172val_172
+214val_214
+462val_462
+406val_406
+454val_454
+384val_384
+256val_256
+26val_26
+134val_134
+384val_384
+18val_18
+462val_462
+492val_492
+100val_100
+298val_298
+498val_498
+146val_146
+458val_458
+362val_362
+186val_186
+348val_348
+18val_18
+344val_344
+84val_84
+28val_28
+448val_448
+152val_152
+348val_348
+194val_194
+414val_414
+222val_222
+126val_126
+90val_90
+400val_400
+200val_200
diff --git a/data/files/srcbucket1.txt b/data/files/srcbucket1.txt
new file mode 100644
index 0000000000..49bfa85498
--- /dev/null
+++ b/data/files/srcbucket1.txt
@@ -0,0 +1,507 @@
+281val_282
+179val_180
+291val_292
+271val_272
+217val_218
+135val_136
+167val_168
+423val_424
+413val_414
+245val_246
+455val_456
+425val_426
+241val_242
+177val_178
+231val_232
+287val_288
+31val_32
+373val_374
+447val_448
+443val_444
+175val_176
+147val_148
+249val_250
+21val_22
+273val_274
+441val_442
+371val_372
+153val_154
+217val_218
+33val_34
+35val_36
+421val_422
+243val_244
+133val_134
+333val_334
+15val_16
+391val_392
+343val_344
+275val_276
+485val_486
+293val_294
+241val_242
+85val_86
+477val_478
+455val_456
+99val_100
+335val_336
+367val_368
+59val_60
+485val_486
+393val_394
+349val_350
+11val_12
+161val_162
+123val_124
+409val_410
+265val_266
+497val_498
+63val_64
+277val_278
+135val_136
+3val_4
+101val_102
+331val_332
+209val_210
+281val_282
+239val_240
+389val_390
+235val_236
+165val_166
+11val_12
+129val_130
+257val_258
+71val_72
+289val_290
+453val_454
+421val_422
+5val_6
+249val_250
+323val_324
+467val_468
+411val_412
+175val_176
+429val_430
+281val_282
+185val_186
+147val_148
+119val_120
+473val_474
+347val_348
+213val_214
+393val_394
+427val_428
+291val_292
+65val_66
+121val_122
+375val_376
+191val_192
+129val_130
+197val_198
+491val_492
+369val_370
+351val_352
+23val_24
+349val_350
+497val_498
+487val_488
+331val_332
+409val_410
+475val_476
+463val_464
+183val_184
+177val_178
+399val_400
+15val_16
+149val_150
+77val_78
+275val_276
+87val_88
+161val_162
+75val_76
+443val_444
+407val_408
+189val_190
+305val_306
+367val_368
+349val_350
+51val_52
+355val_356
+363val_364
+19val_20
+117val_118
+47val_48
+121val_122
+241val_242
+405val_406
+239val_240
+119val_120
+11val_12
+49val_50
+143val_144
+153val_154
+341val_342
+21val_22
+105val_106
+157val_158
+199val_200
+375val_376
+89val_90
+363val_364
+395val_396
+347val_348
+77val_78
+293val_294
+89val_90
+461val_462
+313val_314
+381val_382
+385val_386
+259val_260
+69val_70
+303val_304
+245val_246
+241val_242
+469val_470
+481val_482
+303val_304
+93val_94
+277val_278
+451val_452
+53val_54
+351val_352
+443val_444
+399val_400
+205val_206
+21val_22
+317val_318
+209val_210
+429val_430
+267val_268
+257val_258
+375val_376
+489val_490
+295val_296
+105val_106
+439val_440
+457val_458
+93val_94
+119val_120
+375val_376
+391val_392
+287val_288
+375val_376
+437val_438
+35val_36
+435val_436
+29val_30
+151val_152
+491val_492
+21val_22
+295val_296
+93val_94
+61val_62
+407val_408
+439val_440
+341val_342
+335val_336
+349val_350
+371val_372
+123val_124
+355val_356
+87val_88
+427val_428
+353val_354
+261val_262
+65val_66
+371val_372
+97val_98
+495val_496
+385val_386
+49val_50
+389val_390
+259val_260
+97val_98
+125val_126
+243val_244
+151val_152
+415val_416
+401val_402
+363val_364
+117val_118
+459val_460
+137val_138
+341val_342
+379val_380
+215val_216
+157val_158
+431val_432
+407val_408
+371val_372
+309val_310
+135val_136
+161val_162
+161val_162
+337val_338
+91val_92
+1val_2
+89val_90
+457val_458
+29val_30
+285val_286
+35val_36
+227val_228
+395val_396
+311val_311
+27val_27
+165val_165
+409val_409
+255val_255
+265val_265
+193val_193
+401val_401
+273val_273
+369val_369
+213val_213
+429val_429
+469val_469
+145val_145
+495val_495
+37val_37
+327val_327
+281val_281
+277val_277
+209val_209
+15val_15
+403val_403
+417val_417
+219val_219
+287val_287
+153val_153
+193val_193
+459val_459
+237val_237
+413val_413
+207val_207
+199val_199
+399val_399
+247val_247
+417val_417
+489val_489
+377val_377
+397val_397
+309val_309
+365val_365
+439val_439
+367val_367
+325val_325
+167val_167
+195val_195
+475val_475
+17val_17
+113val_113
+155val_155
+203val_203
+339val_339
+455val_455
+311val_311
+57val_57
+205val_205
+149val_149
+345val_345
+129val_129
+489val_489
+157val_157
+221val_221
+111val_111
+47val_47
+35val_35
+427val_427
+277val_277
+399val_399
+169val_169
+125val_125
+437val_437
+469val_469
+187val_187
+459val_459
+51val_51
+103val_103
+239val_239
+213val_213
+289val_289
+221val_221
+65val_65
+311val_311
+275val_275
+137val_137
+241val_241
+83val_83
+333val_333
+181val_181
+67val_67
+489val_489
+353val_353
+373val_373
+217val_217
+411val_411
+463val_463
+431val_431
+179val_179
+129val_129
+119val_119
+197val_197
+393val_393
+199val_199
+191val_191
+165val_165
+327val_327
+205val_205
+131val_131
+51val_51
+43val_43
+469val_469
+95val_95
+481val_481
+457val_457
+197val_197
+187val_187
+409val_409
+137val_137
+369val_369
+169val_169
+413val_413
+85val_85
+77val_77
+87val_87
+179val_179
+395val_395
+419val_419
+15val_15
+307val_307
+19val_19
+435val_435
+277val_277
+273val_273
+309val_309
+389val_389
+327val_327
+369val_369
+331val_331
+401val_401
+177val_177
+5val_5
+497val_497
+317val_317
+395val_395
+35val_35
+95val_95
+11val_11
+229val_229
+233val_233
+143val_143
+195val_195
+321val_321
+119val_119
+489val_489
+41val_41
+223val_223
+149val_149
+449val_449
+453val_453
+209val_209
+69val_69
+33val_33
+103val_103
+113val_113
+367val_367
+167val_167
+219val_219
+239val_239
+485val_485
+223val_223
+263val_263
+487val_487
+401val_401
+191val_191
+5val_5
+467val_467
+229val_229
+469val_469
+463val_463
+35val_35
+283val_283
+331val_331
+235val_235
+193val_193
+321val_321
+335val_335
+175val_175
+403val_403
+483val_483
+53val_53
+105val_105
+257val_257
+409val_409
+401val_401
+203val_203
+201val_201
+217val_217
+431val_431
+125val_125
+431val_431
+187val_187
+5val_5
+397val_397
+291val_291
+351val_351
+255val_255
+163val_163
+119val_119
+491val_491
+237val_237
+439val_439
+479val_479
+305val_305
+417val_417
+199val_199
+429val_429
+169val_169
+443val_443
+323val_323
+325val_325
+277val_277
+317val_317
+333val_333
+493val_493
+207val_207
+249val_249
+265val_265
+83val_83
+353val_353
+233val_233
+133val_133
+175val_175
+189val_189
+375val_375
+401val_401
+421val_421
+407val_407
+67val_67
+379val_379
+9val_9
+341val_341
+285val_285
+167val_167
+273val_273
+183val_183
+281val_281
+97val_97
+469val_469
+315val_315
+37val_37
+307val_307
+477val_477
+169val_169
+403val_403
+97val_97
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/SamplePruner.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/SamplePruner.java
index c89b2f2344..9193090323 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/SamplePruner.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/SamplePruner.java
@@ -50,6 +50,10 @@ public class SamplePruner {
   @SuppressWarnings("nls")
   private static final Log LOG = LogFactory.getLog("hive.ql.parse.SamplePruner");
 
+  public SamplePruner() {
+    
+  }
+  
   /**
    * Constructs the SamplePruner given the table alias and the table sample
    * 	
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
index a015cfd14b..2d86c1ba78 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
@@ -3596,6 +3596,13 @@ private Operator genTablePlan(String alias, QB qb) throws SemanticException {
           && (num == den || den <= numBuckets && numBuckets % den == 0)) { 
         // input pruning is enough; no need for filter
         LOG.info("No need for sample filter");
+        // TODO sample predicate is not needed, but we are adding it anyway since
+        // input pruning is broken for subqueries. will remove this once we move
+        // compilation of sampling to use the operator tree
+        exprNodeDesc samplePredicate = genSamplePredicate(ts, tabBucketCols, colsEqual, alias, rwsch, qb.getMetaData(), null);
+        tableOp = OperatorFactory.getAndMakeChild(
+            new filterDesc(samplePredicate), 
+            top);
       }
       else {
         // need to add filter
diff --git a/ql/src/test/org/apache/hadoop/hive/ql/QTestUtil.java b/ql/src/test/org/apache/hadoop/hive/ql/QTestUtil.java
index 3091dadc96..c9512071bd 100644
--- a/ql/src/test/org/apache/hadoop/hive/ql/QTestUtil.java
+++ b/ql/src/test/org/apache/hadoop/hive/ql/QTestUtil.java
@@ -281,6 +281,16 @@ private void runLoadCmd(String loadCmd) throws Exception {
 
     return;
   }
+  
+  private void runCreateTableCmd(String createTableCmd) throws Exception {
+    int ecode = 0;
+    ecode = drv.run(createTableCmd);
+    if(ecode != 0) {
+       throw new Exception("create table command: " + createTableCmd + " failed with exit code= " + ecode);
+    }
+
+    return;
+  }
 
   public void createSources() throws Exception {
     // Next create the three tables src, dest1 and dest2 each with two columns
@@ -316,9 +326,10 @@ public void createSources() throws Exception {
     }
     ArrayList<String> bucketCols = new ArrayList<String>();
     bucketCols.add("key");
-    db.createTable("srcbucket", cols, null, TextInputFormat.class, IgnoreKeyTextOutputFormat.class, 2, bucketCols);
+    runCreateTableCmd("CREATE TABLE srcbucket(key int, value string) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE");
+    //db.createTable("srcbucket", cols, null, TextInputFormat.class, IgnoreKeyTextOutputFormat.class, 2, bucketCols);
     srcTables.add("srcbucket");
-    for (String fname: new String [] {"kv1.txt", "kv2.txt"}) {
+    for (String fname: new String [] {"srcbucket0.txt", "srcbucket1.txt"}) {
       fpath = new Path(testFiles, fname);
       newfpath = new Path(tmppath, fname);
       fs.copyFromLocalFile(false, true, fpath, newfpath);
diff --git a/ql/src/test/queries/clientpositive/sample1.q b/ql/src/test/queries/clientpositive/sample1.q
index 1bd5b53e95..6e86cef267 100644
--- a/ql/src/test/queries/clientpositive/sample1.q
+++ b/ql/src/test/queries/clientpositive/sample1.q
@@ -11,3 +11,5 @@ FROM srcpart TABLESAMPLE (BUCKET 1 OUT OF 1 ON rand()) s
 WHERE s.ds='2008-04-08' and s.hr='11';
 
 SELECT dest1.* FROM dest1;
+
+select count(1) from srcbucket;
diff --git a/ql/src/test/queries/clientpositive/sample9.q b/ql/src/test/queries/clientpositive/sample9.q
new file mode 100644
index 0000000000..03139ca1fd
--- /dev/null
+++ b/ql/src/test/queries/clientpositive/sample9.q
@@ -0,0 +1,6 @@
+EXPLAIN EXTENDED
+SELECT s.*
+FROM (SELECT a.* FROM srcbucket TABLESAMPLE (BUCKET 1 OUT OF 2 on key) a) s;
+
+SELECT s.*
+FROM (SELECT a.* FROM srcbucket TABLESAMPLE (BUCKET 1 OUT OF 2 on key) a) s;
diff --git a/ql/src/test/results/clientpositive/input31.q.out b/ql/src/test/results/clientpositive/input31.q.out
index 767858e505..9ad3980f83 100644
--- a/ql/src/test/results/clientpositive/input31.q.out
+++ b/ql/src/test/results/clientpositive/input31.q.out
@@ -67,7 +67,7 @@ Input: default/srcbucket
 Output: default/tst_dest31
 query: select * from tst_dest31
 Input: default/tst_dest31
-Output: file:/data/users/njain/hive4/hive4/build/ql/tmp/2046635781/10000
-500
+Output: file:/Users/rmurthy/workspace/hive/build/ql/tmp/1005816917/10000
+493
 query: drop table tst_dest31
 query: drop table dest31
diff --git a/ql/src/test/results/clientpositive/sample1.q.out b/ql/src/test/results/clientpositive/sample1.q.out
index cd9650e379..fff16d965a 100644
--- a/ql/src/test/results/clientpositive/sample1.q.out
+++ b/ql/src/test/results/clientpositive/sample1.q.out
@@ -48,7 +48,7 @@ STAGE PLANS:
                     File Output Operator
                       compressed: false
                       GlobalTableId: 1
-                      directory: file:/data/users/njain/hive4/hive4/build/ql/tmp/1977299035/10002
+                      directory: file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/42658590/10002
                       table:
                           input format: org.apache.hadoop.mapred.TextInputFormat
                           output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -62,14 +62,14 @@ STAGE PLANS:
                             serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                             file.inputformat org.apache.hadoop.mapred.TextInputFormat
                             file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                            location file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/dest1
+                            location file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/dest1
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           name: dest1
       Needs Tagging: false
       Path -> Alias:
-        file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 
+        file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 
       Path -> Partition:
-        file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 
+        file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 
           Partition
             partition values:
               ds 2008-04-08
@@ -88,7 +88,7 @@ STAGE PLANS:
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/srcpart
+                location file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/srcpart
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: srcpart
 
@@ -98,11 +98,11 @@ STAGE PLANS:
           Move Operator
             files:
                 hdfs directory: true
-                source: file:/data/users/njain/hive4/hive4/build/ql/tmp/1977299035/10002
-                destination: file:/data/users/njain/hive4/hive4/build/ql/tmp/1662393292/10000
+                source: file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/42658590/10002
+                destination: file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/729662936/10000
           Map Reduce
             Alias -> Map Operator Tree:
-              file:/data/users/njain/hive4/hive4/build/ql/tmp/1977299035/10002 
+              file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/42658590/10002 
                   Reduce Output Operator
                     sort order: 
                     Map-reduce partition columns:
@@ -120,9 +120,9 @@ STAGE PLANS:
                           type: string
             Needs Tagging: false
             Path -> Alias:
-              file:/data/users/njain/hive4/hive4/build/ql/tmp/1977299035/10002 
+              file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/42658590/10002 
             Path -> Partition:
-              file:/data/users/njain/hive4/hive4/build/ql/tmp/1977299035/10002 
+              file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/42658590/10002 
                 Partition
                 
                     input format: org.apache.hadoop.mapred.TextInputFormat
@@ -137,7 +137,7 @@ STAGE PLANS:
                       serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       file.inputformat org.apache.hadoop.mapred.TextInputFormat
                       file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                      location file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/dest1
+                      location file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/dest1
                     serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                     name: dest1
             Reduce Operator Tree:
@@ -145,7 +145,7 @@ STAGE PLANS:
                 File Output Operator
                   compressed: false
                   GlobalTableId: 0
-                  directory: file:/data/users/njain/hive4/hive4/build/ql/tmp/1662393292/10000
+                  directory: file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/729662936/10000
                   table:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -159,7 +159,7 @@ STAGE PLANS:
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                         file.inputformat org.apache.hadoop.mapred.TextInputFormat
                         file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                        location file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/dest1
+                        location file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/dest1
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       name: dest1
 
@@ -167,7 +167,7 @@ STAGE PLANS:
     Move Operator
       tables:
           replace: true
-          source: file:/data/users/njain/hive4/hive4/build/ql/tmp/1662393292/10000
+          source: file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/729662936/10000
           table:
               input format: org.apache.hadoop.mapred.TextInputFormat
               output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -181,10 +181,10 @@ STAGE PLANS:
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/dest1
+                location file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/dest1
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: dest1
-          tmp directory: file:/data/users/njain/hive4/hive4/build/ql/tmp/1662393292/10001
+          tmp directory: file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/729662936/10001
 
 
 query: INSERT OVERWRITE TABLE dest1 SELECT s.*
@@ -194,7 +194,7 @@ Input: default/srcpart/ds=2008-04-08/hr=11
 Output: default/dest1
 query: SELECT dest1.* FROM dest1
 Input: default/dest1
-Output: file:/data/users/njain/hive4/hive4/build/ql/tmp/483810366/10000
+Output: file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/169981750/10000
 238	val_238	2008-04-08	11
 86	val_86	2008-04-08	11
 311	val_311	2008-04-08	11
@@ -695,3 +695,7 @@ Output: file:/data/users/njain/hive4/hive4/build/ql/tmp/483810366/10000
 400	val_400	2008-04-08	11
 200	val_200	2008-04-08	11
 97	val_97	2008-04-08	11
+query: select count(1) from srcbucket
+Input: default/srcbucket
+Output: file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1669892494/10000
+1000
diff --git a/ql/src/test/results/clientpositive/sample2.q.out b/ql/src/test/results/clientpositive/sample2.q.out
index 1e74491a85..d8c2c473d6 100644
--- a/ql/src/test/results/clientpositive/sample2.q.out
+++ b/ql/src/test/results/clientpositive/sample2.q.out
@@ -17,59 +17,61 @@ STAGE PLANS:
     Map Reduce
       Alias -> Map Operator Tree:
         s 
-            Select Operator
-              expressions:
-                    expr: key
-                    type: string
-                    expr: value
-                    type: string
-              Select Operator
-                expressions:
-                      expr: UDFToInteger(_col0)
-                      type: int
-                      expr: _col1
-                      type: string
-                File Output Operator
-                  compressed: false
-                  GlobalTableId: 1
-                  directory: file:/data/users/njain/hive4/hive4/build/ql/tmp/423424771/10002
-                  table:
-                      input format: org.apache.hadoop.mapred.TextInputFormat
-                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                      properties:
-                        name dest1
-                        columns.types int:string
-                        serialization.ddl struct dest1 { i32 key, string value}
-                        serialization.format 1
-                        columns key,value
-                        bucket_count -1
-                        serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                        file.inputformat org.apache.hadoop.mapred.TextInputFormat
-                        file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                        location file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/dest1
-                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                      name: dest1
+            Filter Operator
+              predicate:
+                  expr: (((hash(key) & 2147483647) % 2) = 0)
+                  type: boolean
+              Filter Operator
+                predicate:
+                    expr: (((hash(key) & 2147483647) % 2) = 0)
+                    type: boolean
+                Select Operator
+                  expressions:
+                        expr: key
+                        type: int
+                        expr: value
+                        type: string
+                  File Output Operator
+                    compressed: false
+                    GlobalTableId: 1
+                    directory: file:/Users/rmurthy/workspace/hive/build/ql/tmp/58163774/10002
+                    table:
+                        input format: org.apache.hadoop.mapred.TextInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                        properties:
+                          name dest1
+                          columns.types int:string
+                          serialization.ddl struct dest1 { i32 key, string value}
+                          serialization.format 1
+                          columns key,value
+                          bucket_count -1
+                          serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                          file.inputformat org.apache.hadoop.mapred.TextInputFormat
+                          file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                          location file:/Users/rmurthy/workspace/hive/build/ql/test/data/warehouse/dest1
+                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                        name: dest1
       Needs Tagging: false
       Path -> Alias:
-        file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/srcbucket/kv1.txt 
+        file:/Users/rmurthy/workspace/hive/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt 
       Path -> Partition:
-        file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/srcbucket/kv1.txt 
+        file:/Users/rmurthy/workspace/hive/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt 
           Partition
           
               input format: org.apache.hadoop.mapred.TextInputFormat
               output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
               properties:
                 name srcbucket
-                columns.types string:string
+                columns.types int:string
                 bucket_field_name key
-                serialization.ddl struct srcbucket { string key, string value}
+                serialization.ddl struct srcbucket { i32 key, string value}
                 columns key,value
                 serialization.format 1
                 bucket_count 2
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/srcbucket
+                location file:/Users/rmurthy/workspace/hive/build/ql/test/data/warehouse/srcbucket
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: srcbucket
 
@@ -79,11 +81,11 @@ STAGE PLANS:
           Move Operator
             files:
                 hdfs directory: true
-                source: file:/data/users/njain/hive4/hive4/build/ql/tmp/423424771/10002
-                destination: file:/data/users/njain/hive4/hive4/build/ql/tmp/543274388/10000
+                source: file:/Users/rmurthy/workspace/hive/build/ql/tmp/58163774/10002
+                destination: file:/Users/rmurthy/workspace/hive/build/ql/tmp/185536818/10000
           Map Reduce
             Alias -> Map Operator Tree:
-              file:/data/users/njain/hive4/hive4/build/ql/tmp/423424771/10002 
+              file:/Users/rmurthy/workspace/hive/build/ql/tmp/58163774/10002 
                   Reduce Output Operator
                     sort order: 
                     Map-reduce partition columns:
@@ -97,9 +99,9 @@ STAGE PLANS:
                           type: string
             Needs Tagging: false
             Path -> Alias:
-              file:/data/users/njain/hive4/hive4/build/ql/tmp/423424771/10002 
+              file:/Users/rmurthy/workspace/hive/build/ql/tmp/58163774/10002 
             Path -> Partition:
-              file:/data/users/njain/hive4/hive4/build/ql/tmp/423424771/10002 
+              file:/Users/rmurthy/workspace/hive/build/ql/tmp/58163774/10002 
                 Partition
                 
                     input format: org.apache.hadoop.mapred.TextInputFormat
@@ -114,7 +116,7 @@ STAGE PLANS:
                       serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       file.inputformat org.apache.hadoop.mapred.TextInputFormat
                       file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                      location file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/dest1
+                      location file:/Users/rmurthy/workspace/hive/build/ql/test/data/warehouse/dest1
                     serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                     name: dest1
             Reduce Operator Tree:
@@ -122,7 +124,7 @@ STAGE PLANS:
                 File Output Operator
                   compressed: false
                   GlobalTableId: 0
-                  directory: file:/data/users/njain/hive4/hive4/build/ql/tmp/543274388/10000
+                  directory: file:/Users/rmurthy/workspace/hive/build/ql/tmp/185536818/10000
                   table:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -136,7 +138,7 @@ STAGE PLANS:
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                         file.inputformat org.apache.hadoop.mapred.TextInputFormat
                         file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                        location file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/dest1
+                        location file:/Users/rmurthy/workspace/hive/build/ql/test/data/warehouse/dest1
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       name: dest1
 
@@ -144,7 +146,7 @@ STAGE PLANS:
     Move Operator
       tables:
           replace: true
-          source: file:/data/users/njain/hive4/hive4/build/ql/tmp/543274388/10000
+          source: file:/Users/rmurthy/workspace/hive/build/ql/tmp/185536818/10000
           table:
               input format: org.apache.hadoop.mapred.TextInputFormat
               output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -158,10 +160,10 @@ STAGE PLANS:
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/dest1
+                location file:/Users/rmurthy/workspace/hive/build/ql/test/data/warehouse/dest1
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: dest1
-          tmp directory: file:/data/users/njain/hive4/hive4/build/ql/tmp/543274388/10001
+          tmp directory: file:/Users/rmurthy/workspace/hive/build/ql/tmp/185536818/10001
 
 
 query: INSERT OVERWRITE TABLE dest1 SELECT s.* 
@@ -170,504 +172,497 @@ Input: default/srcbucket
 Output: default/dest1
 query: SELECT dest1.* FROM dest1
 Input: default/dest1
-Output: file:/data/users/njain/hive4/hive4/build/ql/tmp/1292112251/10000
+Output: file:/Users/rmurthy/workspace/hive/build/ql/tmp/1592489862/10000
+474	val_475
+62	val_63
+468	val_469
+272	val_273
+448	val_449
+246	val_247
+440	val_441
+278	val_279
+296	val_297
+428	val_429
+126	val_127
+106	val_107
+356	val_357
+490	val_491
+402	val_403
+128	val_129
+10	val_11
+226	val_227
+110	val_111
+0	val_1
+240	val_241
+286	val_287
+408	val_409
+476	val_477
+482	val_483
+48	val_49
+424	val_425
+226	val_227
+494	val_495
+488	val_489
+94	val_95
+50	val_51
+402	val_403
+128	val_129
+468	val_469
+314	val_315
+224	val_225
+344	val_345
+4	val_5
+206	val_207
+114	val_115
+56	val_57
+114	val_115
+254	val_255
+390	val_391
+304	val_305
+264	val_265
+196	val_197
+238	val_239
+20	val_21
+492	val_493
+82	val_83
+58	val_59
+86	val_87
+438	val_439
+360	val_361
+222	val_223
+42	val_43
+338	val_339
+68	val_69
+16	val_17
+492	val_493
+376	val_377
+120	val_121
+306	val_307
+426	val_427
+132	val_133
+446	val_447
+386	val_387
+388	val_389
+184	val_185
+284	val_285
+246	val_247
+262	val_263
+122	val_123
+438	val_439
+390	val_391
+352	val_353
+226	val_227
+328	val_329
+382	val_383
+342	val_343
+480	val_481
+102	val_103
+480	val_481
+318	val_319
+392	val_393
+476	val_477
+258	val_259
+174	val_175
+252	val_253
+114	val_115
+264	val_265
+48	val_49
+336	val_337
+340	val_341
+390	val_391
+484	val_485
+6	val_7
+260	val_261
+2	val_3
+170	val_171
+164	val_165
+118	val_119
+310	val_311
+104	val_105
+80	val_81
+326	val_327
+450	val_451
+140	val_141
+212	val_213
+308	val_309
+30	val_31
+358	val_359
+416	val_417
+42	val_43
+386	val_387
+454	val_455
+364	val_365
+20	val_21
+52	val_53
+40	val_41
+8	val_9
+168	val_169
+384	val_385
+324	val_325
+310	val_311
+206	val_207
+404	val_405
+206	val_207
+226	val_227
+262	val_263
+260	val_261
+328	val_329
+322	val_323
+122	val_123
+404	val_405
+384	val_385
+76	val_77
+116	val_117
+42	val_43
+104	val_105
+406	val_407
+32	val_33
+132	val_133
+192	val_193
+58	val_59
+70	val_71
+356	val_357
+352	val_353
+52	val_53
+330	val_331
+138	val_139
+160	val_161
+454	val_455
+76	val_77
+174	val_175
+412	val_413
+16	val_17
+204	val_205
+126	val_127
+274	val_275
+374	val_375
+494	val_495
+216	val_217
+470	val_471
+196	val_197
+302	val_303
+450	val_451
+12	val_13
+398	val_399
+334	val_335
+384	val_385
+60	val_61
+442	val_443
+52	val_53
+404	val_405
+446	val_447
+300	val_301
+0	val_1
+268	val_269
+392	val_393
+104	val_105
+436	val_437
+156	val_157
+118	val_119
+172	val_173
+244	val_245
+6	val_7
+284	val_285
+164	val_165
+136	val_137
+462	val_463
+432	val_433
+496	val_497
+144	val_145
+408	val_409
+152	val_153
+382	val_383
+348	val_349
+122	val_123
+292	val_293
+182	val_183
+474	val_475
+310	val_311
+52	val_53
+486	val_487
+152	val_153
+378	val_379
+414	val_415
+256	val_257
+292	val_293
+412	val_413
+40	val_41
+478	val_479
+178	val_179
+100	val_101
+156	val_157
+228	val_229
+22	val_23
+248	val_249
+402	val_403
+62	val_63
+162	val_163
+244	val_245
+276	val_277
+46	val_47
+78	val_79
+134	val_135
+196	val_197
+410	val_411
+82	val_83
+440	val_441
+100	val_101
+308	val_309
+430	val_431
+468	val_469
+152	val_153
+138	val_139
+76	val_77
+300	val_301
+478	val_479
+118	val_119
+178	val_179
+242	val_243
+244	val_245
 238	val_238
 86	val_86
-311	val_311
-27	val_27
-165	val_165
-409	val_409
-255	val_255
 278	val_278
 98	val_98
 484	val_484
-265	val_265
-193	val_193
-401	val_401
 150	val_150
-273	val_273
 224	val_224
-369	val_369
 66	val_66
 128	val_128
-213	val_213
 146	val_146
 406	val_406
-429	val_429
 374	val_374
 152	val_152
-469	val_469
-145	val_145
-495	val_495
-37	val_37
-327	val_327
-281	val_281
-277	val_277
-209	val_209
-15	val_15
 82	val_82
-403	val_403
 166	val_166
-417	val_417
 430	val_430
 252	val_252
 292	val_292
-219	val_219
-287	val_287
-153	val_153
-193	val_193
 338	val_338
 446	val_446
-459	val_459
 394	val_394
-237	val_237
 482	val_482
 174	val_174
-413	val_413
 494	val_494
-207	val_207
-199	val_199
 466	val_466
 208	val_208
 174	val_174
-399	val_399
 396	val_396
-247	val_247
-417	val_417
-489	val_489
 162	val_162
-377	val_377
-397	val_397
-309	val_309
-365	val_365
 266	val_266
-439	val_439
 342	val_342
-367	val_367
-325	val_325
-167	val_167
-195	val_195
-475	val_475
-17	val_17
-113	val_113
-155	val_155
-203	val_203
-339	val_339
 0	val_0
-455	val_455
 128	val_128
-311	val_311
 316	val_316
-57	val_57
 302	val_302
-205	val_205
-149	val_149
 438	val_438
-345	val_345
-129	val_129
 170	val_170
 20	val_20
-489	val_489
-157	val_157
 378	val_378
-221	val_221
 92	val_92
-111	val_111
-47	val_47
 72	val_72
 4	val_4
 280	val_280
-35	val_35
-427	val_427
-277	val_277
 208	val_208
 356	val_356
-399	val_399
-169	val_169
 382	val_382
 498	val_498
-125	val_125
 386	val_386
-437	val_437
-469	val_469
 192	val_192
 286	val_286
-187	val_187
 176	val_176
 54	val_54
-459	val_459
-51	val_51
 138	val_138
-103	val_103
-239	val_239
-213	val_213
 216	val_216
 430	val_430
 278	val_278
 176	val_176
-289	val_289
-221	val_221
-65	val_65
 318	val_318
 332	val_332
-311	val_311
-275	val_275
-137	val_137
-241	val_241
-83	val_83
-333	val_333
 180	val_180
 284	val_284
 12	val_12
 230	val_230
-181	val_181
-67	val_67
 260	val_260
 404	val_404
 384	val_384
-489	val_489
-353	val_353
-373	val_373
 272	val_272
 138	val_138
-217	val_217
 84	val_84
 348	val_348
 466	val_466
 58	val_58
 8	val_8
-411	val_411
 230	val_230
 208	val_208
 348	val_348
 24	val_24
-463	val_463
-431	val_431
-179	val_179
 172	val_172
 42	val_42
-129	val_129
 158	val_158
-119	val_119
 496	val_496
 0	val_0
 322	val_322
-197	val_197
 468	val_468
-393	val_393
 454	val_454
 100	val_100
 298	val_298
-199	val_199
-191	val_191
 418	val_418
 96	val_96
 26	val_26
-165	val_165
-327	val_327
 230	val_230
-205	val_205
 120	val_120
-131	val_131
-51	val_51
 404	val_404
-43	val_43
 436	val_436
 156	val_156
-469	val_469
 468	val_468
 308	val_308
-95	val_95
 196	val_196
 288	val_288
-481	val_481
-457	val_457
 98	val_98
 282	val_282
-197	val_197
-187	val_187
 318	val_318
 318	val_318
-409	val_409
 470	val_470
-137	val_137
-369	val_369
 316	val_316
-169	val_169
-413	val_413
-85	val_85
-77	val_77
 0	val_0
 490	val_490
-87	val_87
 364	val_364
-179	val_179
 118	val_118
 134	val_134
-395	val_395
 282	val_282
 138	val_138
 238	val_238
-419	val_419
-15	val_15
 118	val_118
 72	val_72
 90	val_90
-307	val_307
-19	val_19
-435	val_435
 10	val_10
-277	val_277
-273	val_273
 306	val_306
 224	val_224
-309	val_309
-389	val_389
-327	val_327
 242	val_242
-369	val_369
 392	val_392
 272	val_272
-331	val_331
-401	val_401
 242	val_242
 452	val_452
-177	val_177
 226	val_226
-5	val_5
-497	val_497
 402	val_402
 396	val_396
-317	val_317
-395	val_395
 58	val_58
-35	val_35
 336	val_336
-95	val_95
-11	val_11
 168	val_168
 34	val_34
-229	val_229
-233	val_233
-143	val_143
 472	val_472
 322	val_322
 498	val_498
 160	val_160
-195	val_195
 42	val_42
-321	val_321
 430	val_430
-119	val_119
-489	val_489
 458	val_458
 78	val_78
 76	val_76
-41	val_41
-223	val_223
 492	val_492
-149	val_149
-449	val_449
 218	val_218
 228	val_228
 138	val_138
-453	val_453
 30	val_30
-209	val_209
 64	val_64
 468	val_468
 76	val_76
 74	val_74
 342	val_342
-69	val_69
 230	val_230
-33	val_33
 368	val_368
-103	val_103
 296	val_296
-113	val_113
 216	val_216
-367	val_367
 344	val_344
-167	val_167
 274	val_274
-219	val_219
-239	val_239
-485	val_485
 116	val_116
-223	val_223
 256	val_256
-263	val_263
 70	val_70
-487	val_487
 480	val_480
-401	val_401
 288	val_288
-191	val_191
-5	val_5
 244	val_244
 438	val_438
 128	val_128
-467	val_467
 432	val_432
 202	val_202
 316	val_316
-229	val_229
-469	val_469
-463	val_463
 280	val_280
 2	val_2
-35	val_35
-283	val_283
-331	val_331
-235	val_235
 80	val_80
 44	val_44
-193	val_193
-321	val_321
-335	val_335
 104	val_104
 466	val_466
 366	val_366
-175	val_175
-403	val_403
-483	val_483
-53	val_53
-105	val_105
-257	val_257
 406	val_406
-409	val_409
 190	val_190
 406	val_406
-401	val_401
 114	val_114
 258	val_258
 90	val_90
-203	val_203
 262	val_262
 348	val_348
 424	val_424
 12	val_12
 396	val_396
-201	val_201
-217	val_217
 164	val_164
-431	val_431
 454	val_454
 478	val_478
 298	val_298
-125	val_125
-431	val_431
 164	val_164
 424	val_424
-187	val_187
 382	val_382
-5	val_5
 70	val_70
-397	val_397
 480	val_480
-291	val_291
 24	val_24
-351	val_351
-255	val_255
 104	val_104
 70	val_70
-163	val_163
 438	val_438
-119	val_119
 414	val_414
 200	val_200
-491	val_491
-237	val_237
-439	val_439
 360	val_360
 248	val_248
-479	val_479
-305	val_305
-417	val_417
-199	val_199
 444	val_444
 120	val_120
-429	val_429
-169	val_169
-443	val_443
-323	val_323
-325	val_325
-277	val_277
 230	val_230
 478	val_478
 178	val_178
 468	val_468
 310	val_310
-317	val_317
-333	val_333
-493	val_493
 460	val_460
-207	val_207
-249	val_249
-265	val_265
 480	val_480
-83	val_83
 136	val_136
-353	val_353
 172	val_172
 214	val_214
 462	val_462
-233	val_233
 406	val_406
-133	val_133
-175	val_175
-189	val_189
 454	val_454
-375	val_375
-401	val_401
-421	val_421
-407	val_407
 384	val_384
 256	val_256
 26	val_26
 134	val_134
-67	val_67
 384	val_384
-379	val_379
 18	val_18
 462	val_462
 492	val_492
 100	val_100
 298	val_298
-9	val_9
-341	val_341
 498	val_498
 146	val_146
 458	val_458
 362	val_362
 186	val_186
-285	val_285
 348	val_348
-167	val_167
 18	val_18
-273	val_273
-183	val_183
-281	val_281
 344	val_344
-97	val_97
-469	val_469
-315	val_315
 84	val_84
 28	val_28
-37	val_37
 448	val_448
 152	val_152
 348	val_348
-307	val_307
 194	val_194
 414	val_414
-477	val_477
 222	val_222
 126	val_126
 90	val_90
-169	val_169
-403	val_403
 400	val_400
 200	val_200
-97	val_97
diff --git a/ql/src/test/results/clientpositive/sample3.q.out b/ql/src/test/results/clientpositive/sample3.q.out
index 4ef4580c89..f4d4c2ef5a 100644
--- a/ql/src/test/results/clientpositive/sample3.q.out
+++ b/ql/src/test/results/clientpositive/sample3.q.out
@@ -25,7 +25,7 @@ STAGE PLANS:
                 Select Operator
                   expressions:
                         expr: key
-                        type: string
+                        type: int
                   File Output Operator
                     compressed: false
                     GlobalTableId: 0
@@ -41,7 +41,54 @@ STAGE PLANS:
 query: SELECT s.key
 FROM srcbucket TABLESAMPLE (BUCKET 1 OUT OF 5 on key) s SORT BY key
 Input: default/srcbucket
-Output: file:/data/users/pchakka/workspace/oshive/build/ql/tmp/2122674370/10000
+Output: file:/Users/rmurthy/workspace/hive/build/ql/tmp/98452558/10000
+0
+0
+0
+0
+0
+5
+5
+5
+5
+10
+10
+15
+15
+15
+15
+20
+20
+20
+30
+30
+35
+35
+35
+35
+35
+35
+40
+40
+50
+60
+65
+65
+65
+70
+70
+70
+70
+75
+80
+80
+85
+85
+90
+90
+90
+95
+95
 100
 100
 100
@@ -49,203 +96,138 @@ Output: file:/data/users/pchakka/workspace/oshive/build/ql/tmp/2122674370/10000
 105
 105
 105
-114
-114
-114
-114
-119
-119
-119
-119
-119
-119
-123
-123
-128
-128
-128
-128
-128
-132
-132
-137
-137
-137
-146
-146
+110
+120
+120
+120
+125
+125
+125
+135
+135
+135
+140
+145
 150
 155
-164
-164
-164
-164
-169
-169
-169
-169
-178
-178
-178
-18
-18
-182
-187
-187
-187
-191
-191
-191
-196
-196
-196
-196
-2
-2
-204
-209
-209
-209
-209
-213
-213
-213
-218
-22
-222
-222
-227
-231
+160
+160
+165
+165
+165
+170
+170
+175
+175
+175
+175
+180
+185
+190
+195
+195
+200
+200
+205
+205
+205
+215
+230
+230
+230
+230
+230
+235
+235
 240
 245
 245
-254
-259
-259
-263
-268
-27
-272
-272
-272
-277
-277
-277
-277
-277
-277
-281
-281
-281
-281
-281
-286
-286
+255
+255
+260
+260
+260
+265
+265
+265
+275
+275
+275
+280
+280
+285
+285
 295
 295
-303
-303
-308
-308
-308
-31
-317
-317
-317
-321
-321
-326
+300
+300
+305
+305
+310
+310
+310
+310
+315
+325
+325
 330
 335
 335
 335
-344
-344
-344
-349
-349
-349
-349
-353
-353
-353
-358
-362
-367
-367
-367
-367
-371
-371
-371
-371
-376
+340
+345
+355
+355
+360
+360
+365
+375
+375
+375
+375
+375
+375
 385
 385
-394
-399
-399
-399
-399
-40
-40
-402
-402
-402
-402
-407
-407
-407
-407
-411
-411
-416
+390
+390
+390
+395
+395
+395
+395
+400
+405
+410
+415
 425
-439
-439
-439
-439
-443
-443
-443
-443
-448
-448
-452
-457
-457
-457
-461
-466
-466
-466
+430
+430
+430
+430
+435
+435
+440
+440
+450
+450
+455
+455
+455
+460
 470
 470
 475
 475
-484
-484
-489
-489
-489
-489
-489
-493
-498
-498
-498
-54
-59
-63
-68
-72
-72
-77
-77
-77
-86
-86
-90
-90
-90
-95
-95
+480
+480
+480
+480
+480
+485
+485
+485
+490
+490
+495
+495
diff --git a/ql/src/test/results/clientpositive/sample4.q.out b/ql/src/test/results/clientpositive/sample4.q.out
index 6bf74039ad..f1544a0415 100644
--- a/ql/src/test/results/clientpositive/sample4.q.out
+++ b/ql/src/test/results/clientpositive/sample4.q.out
@@ -17,59 +17,61 @@ STAGE PLANS:
     Map Reduce
       Alias -> Map Operator Tree:
         s 
-            Select Operator
-              expressions:
-                    expr: key
-                    type: string
-                    expr: value
-                    type: string
-              Select Operator
-                expressions:
-                      expr: UDFToInteger(_col0)
-                      type: int
-                      expr: _col1
-                      type: string
-                File Output Operator
-                  compressed: false
-                  GlobalTableId: 1
-                  directory: file:/data/users/njain/hive4/hive4/build/ql/tmp/1936626981/10002
-                  table:
-                      input format: org.apache.hadoop.mapred.TextInputFormat
-                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                      properties:
-                        name dest1
-                        columns.types int:string
-                        serialization.ddl struct dest1 { i32 key, string value}
-                        serialization.format 1
-                        columns key,value
-                        bucket_count -1
-                        serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                        file.inputformat org.apache.hadoop.mapred.TextInputFormat
-                        file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                        location file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/dest1
-                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                      name: dest1
+            Filter Operator
+              predicate:
+                  expr: (((hash(key) & 2147483647) % 2) = 0)
+                  type: boolean
+              Filter Operator
+                predicate:
+                    expr: (((hash(key) & 2147483647) % 2) = 0)
+                    type: boolean
+                Select Operator
+                  expressions:
+                        expr: key
+                        type: int
+                        expr: value
+                        type: string
+                  File Output Operator
+                    compressed: false
+                    GlobalTableId: 1
+                    directory: file:/Users/rmurthy/workspace/hive/build/ql/tmp/1686700906/10002
+                    table:
+                        input format: org.apache.hadoop.mapred.TextInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                        properties:
+                          name dest1
+                          columns.types int:string
+                          serialization.ddl struct dest1 { i32 key, string value}
+                          serialization.format 1
+                          columns key,value
+                          bucket_count -1
+                          serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                          file.inputformat org.apache.hadoop.mapred.TextInputFormat
+                          file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                          location file:/Users/rmurthy/workspace/hive/build/ql/test/data/warehouse/dest1
+                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                        name: dest1
       Needs Tagging: false
       Path -> Alias:
-        file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/srcbucket/kv1.txt 
+        file:/Users/rmurthy/workspace/hive/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt 
       Path -> Partition:
-        file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/srcbucket/kv1.txt 
+        file:/Users/rmurthy/workspace/hive/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt 
           Partition
           
               input format: org.apache.hadoop.mapred.TextInputFormat
               output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
               properties:
                 name srcbucket
-                columns.types string:string
+                columns.types int:string
                 bucket_field_name key
-                serialization.ddl struct srcbucket { string key, string value}
+                serialization.ddl struct srcbucket { i32 key, string value}
                 columns key,value
                 serialization.format 1
                 bucket_count 2
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/srcbucket
+                location file:/Users/rmurthy/workspace/hive/build/ql/test/data/warehouse/srcbucket
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: srcbucket
 
@@ -79,11 +81,11 @@ STAGE PLANS:
           Move Operator
             files:
                 hdfs directory: true
-                source: file:/data/users/njain/hive4/hive4/build/ql/tmp/1936626981/10002
-                destination: file:/data/users/njain/hive4/hive4/build/ql/tmp/1693466892/10000
+                source: file:/Users/rmurthy/workspace/hive/build/ql/tmp/1686700906/10002
+                destination: file:/Users/rmurthy/workspace/hive/build/ql/tmp/948268915/10000
           Map Reduce
             Alias -> Map Operator Tree:
-              file:/data/users/njain/hive4/hive4/build/ql/tmp/1936626981/10002 
+              file:/Users/rmurthy/workspace/hive/build/ql/tmp/1686700906/10002 
                   Reduce Output Operator
                     sort order: 
                     Map-reduce partition columns:
@@ -97,9 +99,9 @@ STAGE PLANS:
                           type: string
             Needs Tagging: false
             Path -> Alias:
-              file:/data/users/njain/hive4/hive4/build/ql/tmp/1936626981/10002 
+              file:/Users/rmurthy/workspace/hive/build/ql/tmp/1686700906/10002 
             Path -> Partition:
-              file:/data/users/njain/hive4/hive4/build/ql/tmp/1936626981/10002 
+              file:/Users/rmurthy/workspace/hive/build/ql/tmp/1686700906/10002 
                 Partition
                 
                     input format: org.apache.hadoop.mapred.TextInputFormat
@@ -114,7 +116,7 @@ STAGE PLANS:
                       serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       file.inputformat org.apache.hadoop.mapred.TextInputFormat
                       file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                      location file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/dest1
+                      location file:/Users/rmurthy/workspace/hive/build/ql/test/data/warehouse/dest1
                     serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                     name: dest1
             Reduce Operator Tree:
@@ -122,7 +124,7 @@ STAGE PLANS:
                 File Output Operator
                   compressed: false
                   GlobalTableId: 0
-                  directory: file:/data/users/njain/hive4/hive4/build/ql/tmp/1693466892/10000
+                  directory: file:/Users/rmurthy/workspace/hive/build/ql/tmp/948268915/10000
                   table:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -136,7 +138,7 @@ STAGE PLANS:
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                         file.inputformat org.apache.hadoop.mapred.TextInputFormat
                         file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                        location file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/dest1
+                        location file:/Users/rmurthy/workspace/hive/build/ql/test/data/warehouse/dest1
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       name: dest1
 
@@ -144,7 +146,7 @@ STAGE PLANS:
     Move Operator
       tables:
           replace: true
-          source: file:/data/users/njain/hive4/hive4/build/ql/tmp/1693466892/10000
+          source: file:/Users/rmurthy/workspace/hive/build/ql/tmp/948268915/10000
           table:
               input format: org.apache.hadoop.mapred.TextInputFormat
               output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -158,10 +160,10 @@ STAGE PLANS:
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/dest1
+                location file:/Users/rmurthy/workspace/hive/build/ql/test/data/warehouse/dest1
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: dest1
-          tmp directory: file:/data/users/njain/hive4/hive4/build/ql/tmp/1693466892/10001
+          tmp directory: file:/Users/rmurthy/workspace/hive/build/ql/tmp/948268915/10001
 
 
 query: INSERT OVERWRITE TABLE dest1 SELECT s.*
@@ -170,504 +172,497 @@ Input: default/srcbucket
 Output: default/dest1
 query: SELECT dest1.* FROM dest1
 Input: default/dest1
-Output: file:/data/users/njain/hive4/hive4/build/ql/tmp/1129401450/10000
+Output: file:/Users/rmurthy/workspace/hive/build/ql/tmp/1828173581/10000
+474	val_475
+62	val_63
+468	val_469
+272	val_273
+448	val_449
+246	val_247
+440	val_441
+278	val_279
+296	val_297
+428	val_429
+126	val_127
+106	val_107
+356	val_357
+490	val_491
+402	val_403
+128	val_129
+10	val_11
+226	val_227
+110	val_111
+0	val_1
+240	val_241
+286	val_287
+408	val_409
+476	val_477
+482	val_483
+48	val_49
+424	val_425
+226	val_227
+494	val_495
+488	val_489
+94	val_95
+50	val_51
+402	val_403
+128	val_129
+468	val_469
+314	val_315
+224	val_225
+344	val_345
+4	val_5
+206	val_207
+114	val_115
+56	val_57
+114	val_115
+254	val_255
+390	val_391
+304	val_305
+264	val_265
+196	val_197
+238	val_239
+20	val_21
+492	val_493
+82	val_83
+58	val_59
+86	val_87
+438	val_439
+360	val_361
+222	val_223
+42	val_43
+338	val_339
+68	val_69
+16	val_17
+492	val_493
+376	val_377
+120	val_121
+306	val_307
+426	val_427
+132	val_133
+446	val_447
+386	val_387
+388	val_389
+184	val_185
+284	val_285
+246	val_247
+262	val_263
+122	val_123
+438	val_439
+390	val_391
+352	val_353
+226	val_227
+328	val_329
+382	val_383
+342	val_343
+480	val_481
+102	val_103
+480	val_481
+318	val_319
+392	val_393
+476	val_477
+258	val_259
+174	val_175
+252	val_253
+114	val_115
+264	val_265
+48	val_49
+336	val_337
+340	val_341
+390	val_391
+484	val_485
+6	val_7
+260	val_261
+2	val_3
+170	val_171
+164	val_165
+118	val_119
+310	val_311
+104	val_105
+80	val_81
+326	val_327
+450	val_451
+140	val_141
+212	val_213
+308	val_309
+30	val_31
+358	val_359
+416	val_417
+42	val_43
+386	val_387
+454	val_455
+364	val_365
+20	val_21
+52	val_53
+40	val_41
+8	val_9
+168	val_169
+384	val_385
+324	val_325
+310	val_311
+206	val_207
+404	val_405
+206	val_207
+226	val_227
+262	val_263
+260	val_261
+328	val_329
+322	val_323
+122	val_123
+404	val_405
+384	val_385
+76	val_77
+116	val_117
+42	val_43
+104	val_105
+406	val_407
+32	val_33
+132	val_133
+192	val_193
+58	val_59
+70	val_71
+356	val_357
+352	val_353
+52	val_53
+330	val_331
+138	val_139
+160	val_161
+454	val_455
+76	val_77
+174	val_175
+412	val_413
+16	val_17
+204	val_205
+126	val_127
+274	val_275
+374	val_375
+494	val_495
+216	val_217
+470	val_471
+196	val_197
+302	val_303
+450	val_451
+12	val_13
+398	val_399
+334	val_335
+384	val_385
+60	val_61
+442	val_443
+52	val_53
+404	val_405
+446	val_447
+300	val_301
+0	val_1
+268	val_269
+392	val_393
+104	val_105
+436	val_437
+156	val_157
+118	val_119
+172	val_173
+244	val_245
+6	val_7
+284	val_285
+164	val_165
+136	val_137
+462	val_463
+432	val_433
+496	val_497
+144	val_145
+408	val_409
+152	val_153
+382	val_383
+348	val_349
+122	val_123
+292	val_293
+182	val_183
+474	val_475
+310	val_311
+52	val_53
+486	val_487
+152	val_153
+378	val_379
+414	val_415
+256	val_257
+292	val_293
+412	val_413
+40	val_41
+478	val_479
+178	val_179
+100	val_101
+156	val_157
+228	val_229
+22	val_23
+248	val_249
+402	val_403
+62	val_63
+162	val_163
+244	val_245
+276	val_277
+46	val_47
+78	val_79
+134	val_135
+196	val_197
+410	val_411
+82	val_83
+440	val_441
+100	val_101
+308	val_309
+430	val_431
+468	val_469
+152	val_153
+138	val_139
+76	val_77
+300	val_301
+478	val_479
+118	val_119
+178	val_179
+242	val_243
+244	val_245
 238	val_238
 86	val_86
-311	val_311
-27	val_27
-165	val_165
-409	val_409
-255	val_255
 278	val_278
 98	val_98
 484	val_484
-265	val_265
-193	val_193
-401	val_401
 150	val_150
-273	val_273
 224	val_224
-369	val_369
 66	val_66
 128	val_128
-213	val_213
 146	val_146
 406	val_406
-429	val_429
 374	val_374
 152	val_152
-469	val_469
-145	val_145
-495	val_495
-37	val_37
-327	val_327
-281	val_281
-277	val_277
-209	val_209
-15	val_15
 82	val_82
-403	val_403
 166	val_166
-417	val_417
 430	val_430
 252	val_252
 292	val_292
-219	val_219
-287	val_287
-153	val_153
-193	val_193
 338	val_338
 446	val_446
-459	val_459
 394	val_394
-237	val_237
 482	val_482
 174	val_174
-413	val_413
 494	val_494
-207	val_207
-199	val_199
 466	val_466
 208	val_208
 174	val_174
-399	val_399
 396	val_396
-247	val_247
-417	val_417
-489	val_489
 162	val_162
-377	val_377
-397	val_397
-309	val_309
-365	val_365
 266	val_266
-439	val_439
 342	val_342
-367	val_367
-325	val_325
-167	val_167
-195	val_195
-475	val_475
-17	val_17
-113	val_113
-155	val_155
-203	val_203
-339	val_339
 0	val_0
-455	val_455
 128	val_128
-311	val_311
 316	val_316
-57	val_57
 302	val_302
-205	val_205
-149	val_149
 438	val_438
-345	val_345
-129	val_129
 170	val_170
 20	val_20
-489	val_489
-157	val_157
 378	val_378
-221	val_221
 92	val_92
-111	val_111
-47	val_47
 72	val_72
 4	val_4
 280	val_280
-35	val_35
-427	val_427
-277	val_277
 208	val_208
 356	val_356
-399	val_399
-169	val_169
 382	val_382
 498	val_498
-125	val_125
 386	val_386
-437	val_437
-469	val_469
 192	val_192
 286	val_286
-187	val_187
 176	val_176
 54	val_54
-459	val_459
-51	val_51
 138	val_138
-103	val_103
-239	val_239
-213	val_213
 216	val_216
 430	val_430
 278	val_278
 176	val_176
-289	val_289
-221	val_221
-65	val_65
 318	val_318
 332	val_332
-311	val_311
-275	val_275
-137	val_137
-241	val_241
-83	val_83
-333	val_333
 180	val_180
 284	val_284
 12	val_12
 230	val_230
-181	val_181
-67	val_67
 260	val_260
 404	val_404
 384	val_384
-489	val_489
-353	val_353
-373	val_373
 272	val_272
 138	val_138
-217	val_217
 84	val_84
 348	val_348
 466	val_466
 58	val_58
 8	val_8
-411	val_411
 230	val_230
 208	val_208
 348	val_348
 24	val_24
-463	val_463
-431	val_431
-179	val_179
 172	val_172
 42	val_42
-129	val_129
 158	val_158
-119	val_119
 496	val_496
 0	val_0
 322	val_322
-197	val_197
 468	val_468
-393	val_393
 454	val_454
 100	val_100
 298	val_298
-199	val_199
-191	val_191
 418	val_418
 96	val_96
 26	val_26
-165	val_165
-327	val_327
 230	val_230
-205	val_205
 120	val_120
-131	val_131
-51	val_51
 404	val_404
-43	val_43
 436	val_436
 156	val_156
-469	val_469
 468	val_468
 308	val_308
-95	val_95
 196	val_196
 288	val_288
-481	val_481
-457	val_457
 98	val_98
 282	val_282
-197	val_197
-187	val_187
 318	val_318
 318	val_318
-409	val_409
 470	val_470
-137	val_137
-369	val_369
 316	val_316
-169	val_169
-413	val_413
-85	val_85
-77	val_77
 0	val_0
 490	val_490
-87	val_87
 364	val_364
-179	val_179
 118	val_118
 134	val_134
-395	val_395
 282	val_282
 138	val_138
 238	val_238
-419	val_419
-15	val_15
 118	val_118
 72	val_72
 90	val_90
-307	val_307
-19	val_19
-435	val_435
 10	val_10
-277	val_277
-273	val_273
 306	val_306
 224	val_224
-309	val_309
-389	val_389
-327	val_327
 242	val_242
-369	val_369
 392	val_392
 272	val_272
-331	val_331
-401	val_401
 242	val_242
 452	val_452
-177	val_177
 226	val_226
-5	val_5
-497	val_497
 402	val_402
 396	val_396
-317	val_317
-395	val_395
 58	val_58
-35	val_35
 336	val_336
-95	val_95
-11	val_11
 168	val_168
 34	val_34
-229	val_229
-233	val_233
-143	val_143
 472	val_472
 322	val_322
 498	val_498
 160	val_160
-195	val_195
 42	val_42
-321	val_321
 430	val_430
-119	val_119
-489	val_489
 458	val_458
 78	val_78
 76	val_76
-41	val_41
-223	val_223
 492	val_492
-149	val_149
-449	val_449
 218	val_218
 228	val_228
 138	val_138
-453	val_453
 30	val_30
-209	val_209
 64	val_64
 468	val_468
 76	val_76
 74	val_74
 342	val_342
-69	val_69
 230	val_230
-33	val_33
 368	val_368
-103	val_103
 296	val_296
-113	val_113
 216	val_216
-367	val_367
 344	val_344
-167	val_167
 274	val_274
-219	val_219
-239	val_239
-485	val_485
 116	val_116
-223	val_223
 256	val_256
-263	val_263
 70	val_70
-487	val_487
 480	val_480
-401	val_401
 288	val_288
-191	val_191
-5	val_5
 244	val_244
 438	val_438
 128	val_128
-467	val_467
 432	val_432
 202	val_202
 316	val_316
-229	val_229
-469	val_469
-463	val_463
 280	val_280
 2	val_2
-35	val_35
-283	val_283
-331	val_331
-235	val_235
 80	val_80
 44	val_44
-193	val_193
-321	val_321
-335	val_335
 104	val_104
 466	val_466
 366	val_366
-175	val_175
-403	val_403
-483	val_483
-53	val_53
-105	val_105
-257	val_257
 406	val_406
-409	val_409
 190	val_190
 406	val_406
-401	val_401
 114	val_114
 258	val_258
 90	val_90
-203	val_203
 262	val_262
 348	val_348
 424	val_424
 12	val_12
 396	val_396
-201	val_201
-217	val_217
 164	val_164
-431	val_431
 454	val_454
 478	val_478
 298	val_298
-125	val_125
-431	val_431
 164	val_164
 424	val_424
-187	val_187
 382	val_382
-5	val_5
 70	val_70
-397	val_397
 480	val_480
-291	val_291
 24	val_24
-351	val_351
-255	val_255
 104	val_104
 70	val_70
-163	val_163
 438	val_438
-119	val_119
 414	val_414
 200	val_200
-491	val_491
-237	val_237
-439	val_439
 360	val_360
 248	val_248
-479	val_479
-305	val_305
-417	val_417
-199	val_199
 444	val_444
 120	val_120
-429	val_429
-169	val_169
-443	val_443
-323	val_323
-325	val_325
-277	val_277
 230	val_230
 478	val_478
 178	val_178
 468	val_468
 310	val_310
-317	val_317
-333	val_333
-493	val_493
 460	val_460
-207	val_207
-249	val_249
-265	val_265
 480	val_480
-83	val_83
 136	val_136
-353	val_353
 172	val_172
 214	val_214
 462	val_462
-233	val_233
 406	val_406
-133	val_133
-175	val_175
-189	val_189
 454	val_454
-375	val_375
-401	val_401
-421	val_421
-407	val_407
 384	val_384
 256	val_256
 26	val_26
 134	val_134
-67	val_67
 384	val_384
-379	val_379
 18	val_18
 462	val_462
 492	val_492
 100	val_100
 298	val_298
-9	val_9
-341	val_341
 498	val_498
 146	val_146
 458	val_458
 362	val_362
 186	val_186
-285	val_285
 348	val_348
-167	val_167
 18	val_18
-273	val_273
-183	val_183
-281	val_281
 344	val_344
-97	val_97
-469	val_469
-315	val_315
 84	val_84
 28	val_28
-37	val_37
 448	val_448
 152	val_152
 348	val_348
-307	val_307
 194	val_194
 414	val_414
-477	val_477
 222	val_222
 126	val_126
 90	val_90
-169	val_169
-403	val_403
 400	val_400
 200	val_200
-97	val_97
diff --git a/ql/src/test/results/clientpositive/sample5.q.out b/ql/src/test/results/clientpositive/sample5.q.out
index efbd6a5003..03a20790e9 100644
--- a/ql/src/test/results/clientpositive/sample5.q.out
+++ b/ql/src/test/results/clientpositive/sample5.q.out
@@ -27,56 +27,50 @@ STAGE PLANS:
                 Select Operator
                   expressions:
                         expr: key
-                        type: string
+                        type: int
                         expr: value
                         type: string
-                  Select Operator
-                    expressions:
-                          expr: UDFToInteger(_col0)
-                          type: int
-                          expr: _col1
-                          type: string
-                    File Output Operator
-                      compressed: false
-                      GlobalTableId: 1
-                      directory: file:/data/users/pchakka/workspace/oshive/build/ql/tmp/15105901/10002
-                      table:
-                          input format: org.apache.hadoop.mapred.TextInputFormat
-                          output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                          properties:
-                            name dest1
-                            columns.types int:string
-                            serialization.ddl struct dest1 { i32 key, string value}
-                            serialization.format 1
-                            columns key,value
-                            bucket_count -1
-                            serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                            file.inputformat org.apache.hadoop.mapred.TextInputFormat
-                            file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                            location file:/data/users/pchakka/workspace/oshive/build/ql/test/data/warehouse/dest1
-                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                          name: dest1
+                  File Output Operator
+                    compressed: false
+                    GlobalTableId: 1
+                    directory: file:/Users/rmurthy/workspace/hive/build/ql/tmp/1149177794/10002
+                    table:
+                        input format: org.apache.hadoop.mapred.TextInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                        properties:
+                          name dest1
+                          columns.types int:string
+                          serialization.ddl struct dest1 { i32 key, string value}
+                          serialization.format 1
+                          columns key,value
+                          bucket_count -1
+                          serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                          file.inputformat org.apache.hadoop.mapred.TextInputFormat
+                          file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                          location file:/Users/rmurthy/workspace/hive/build/ql/test/data/warehouse/dest1
+                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                        name: dest1
       Needs Tagging: false
       Path -> Alias:
-        file:/data/users/pchakka/workspace/oshive/build/ql/test/data/warehouse/srcbucket 
+        file:/Users/rmurthy/workspace/hive/build/ql/test/data/warehouse/srcbucket 
       Path -> Partition:
-        file:/data/users/pchakka/workspace/oshive/build/ql/test/data/warehouse/srcbucket 
+        file:/Users/rmurthy/workspace/hive/build/ql/test/data/warehouse/srcbucket 
           Partition
           
               input format: org.apache.hadoop.mapred.TextInputFormat
               output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
               properties:
                 name srcbucket
-                columns.types string:string
+                columns.types int:string
                 bucket_field_name key
-                serialization.ddl struct srcbucket { string key, string value}
+                serialization.ddl struct srcbucket { i32 key, string value}
                 columns key,value
                 serialization.format 1
                 bucket_count 2
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location file:/data/users/pchakka/workspace/oshive/build/ql/test/data/warehouse/srcbucket
+                location file:/Users/rmurthy/workspace/hive/build/ql/test/data/warehouse/srcbucket
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: srcbucket
 
@@ -86,11 +80,11 @@ STAGE PLANS:
           Move Operator
             files:
                 hdfs directory: true
-                source: file:/data/users/pchakka/workspace/oshive/build/ql/tmp/15105901/10002
-                destination: file:/data/users/pchakka/workspace/oshive/build/ql/tmp/331098123/10000
+                source: file:/Users/rmurthy/workspace/hive/build/ql/tmp/1149177794/10002
+                destination: file:/Users/rmurthy/workspace/hive/build/ql/tmp/964570774/10000
           Map Reduce
             Alias -> Map Operator Tree:
-              file:/data/users/pchakka/workspace/oshive/build/ql/tmp/15105901/10002 
+              file:/Users/rmurthy/workspace/hive/build/ql/tmp/1149177794/10002 
                   Reduce Output Operator
                     sort order: 
                     Map-reduce partition columns:
@@ -104,9 +98,9 @@ STAGE PLANS:
                           type: string
             Needs Tagging: false
             Path -> Alias:
-              file:/data/users/pchakka/workspace/oshive/build/ql/tmp/15105901/10002 
+              file:/Users/rmurthy/workspace/hive/build/ql/tmp/1149177794/10002 
             Path -> Partition:
-              file:/data/users/pchakka/workspace/oshive/build/ql/tmp/15105901/10002 
+              file:/Users/rmurthy/workspace/hive/build/ql/tmp/1149177794/10002 
                 Partition
                 
                     input format: org.apache.hadoop.mapred.TextInputFormat
@@ -121,7 +115,7 @@ STAGE PLANS:
                       serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       file.inputformat org.apache.hadoop.mapred.TextInputFormat
                       file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                      location file:/data/users/pchakka/workspace/oshive/build/ql/test/data/warehouse/dest1
+                      location file:/Users/rmurthy/workspace/hive/build/ql/test/data/warehouse/dest1
                     serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                     name: dest1
             Reduce Operator Tree:
@@ -129,7 +123,7 @@ STAGE PLANS:
                 File Output Operator
                   compressed: false
                   GlobalTableId: 0
-                  directory: file:/data/users/pchakka/workspace/oshive/build/ql/tmp/331098123/10000
+                  directory: file:/Users/rmurthy/workspace/hive/build/ql/tmp/964570774/10000
                   table:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -143,7 +137,7 @@ STAGE PLANS:
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                         file.inputformat org.apache.hadoop.mapred.TextInputFormat
                         file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                        location file:/data/users/pchakka/workspace/oshive/build/ql/test/data/warehouse/dest1
+                        location file:/Users/rmurthy/workspace/hive/build/ql/test/data/warehouse/dest1
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       name: dest1
 
@@ -151,7 +145,7 @@ STAGE PLANS:
     Move Operator
       tables:
           replace: true
-          source: file:/data/users/pchakka/workspace/oshive/build/ql/tmp/331098123/10000
+          source: file:/Users/rmurthy/workspace/hive/build/ql/tmp/964570774/10000
           table:
               input format: org.apache.hadoop.mapred.TextInputFormat
               output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -165,10 +159,10 @@ STAGE PLANS:
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location file:/data/users/pchakka/workspace/oshive/build/ql/test/data/warehouse/dest1
+                location file:/Users/rmurthy/workspace/hive/build/ql/test/data/warehouse/dest1
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: dest1
-          tmp directory: file:/data/users/pchakka/workspace/oshive/build/ql/tmp/331098123/10001
+          tmp directory: file:/Users/rmurthy/workspace/hive/build/ql/tmp/964570774/10001
 
 
 query: INSERT OVERWRITE TABLE dest1 SELECT s.* -- here's another test
@@ -177,27 +171,49 @@ Input: default/srcbucket
 Output: default/dest1
 query: SELECT dest1.* FROM dest1 SORT BY key, value
 Input: default/dest1
-Output: file:/data/users/pchakka/workspace/oshive/build/ql/tmp/685198063/10000
-2	val_2
-2	val_3
-18	val_18
-18	val_18
-22	val_23
-27	val_27
-31	val_32
+Output: file:/Users/rmurthy/workspace/hive/build/ql/tmp/1391249417/10000
+0	val_0
+0	val_0
+0	val_0
+0	val_1
+0	val_1
+5	val_5
+5	val_5
+5	val_5
+5	val_6
+10	val_10
+10	val_11
+15	val_15
+15	val_15
+15	val_16
+15	val_16
+20	val_20
+20	val_21
+20	val_21
+30	val_30
+30	val_31
+35	val_35
+35	val_35
+35	val_35
+35	val_36
+35	val_36
+35	val_36
 40	val_41
 40	val_41
-54	val_54
-59	val_60
-63	val_64
-68	val_69
-72	val_72
-72	val_72
-77	val_77
-77	val_78
-77	val_78
-86	val_86
-86	val_87
+50	val_51
+60	val_61
+65	val_65
+65	val_66
+65	val_66
+70	val_70
+70	val_70
+70	val_70
+70	val_71
+75	val_76
+80	val_80
+80	val_81
+85	val_85
+85	val_86
 90	val_90
 90	val_90
 90	val_90
@@ -210,178 +226,138 @@ Output: file:/data/users/pchakka/workspace/oshive/build/ql/tmp/685198063/10000
 105	val_105
 105	val_106
 105	val_106
-114	val_114
-114	val_115
-114	val_115
-114	val_115
-119	val_119
-119	val_119
-119	val_119
-119	val_120
-119	val_120
-119	val_120
-123	val_124
-123	val_124
-128	val_128
-128	val_128
-128	val_128
-128	val_129
-128	val_129
-132	val_133
-132	val_133
-137	val_137
-137	val_137
-137	val_138
-146	val_146
-146	val_146
+110	val_111
+120	val_120
+120	val_120
+120	val_121
+125	val_125
+125	val_125
+125	val_126
+135	val_136
+135	val_136
+135	val_136
+140	val_141
+145	val_145
 150	val_150
 155	val_155
-164	val_164
-164	val_164
-164	val_165
-164	val_165
-169	val_169
-169	val_169
-169	val_169
-169	val_169
-178	val_178
-178	val_179
-178	val_179
-182	val_183
-187	val_187
-187	val_187
-187	val_187
-191	val_191
-191	val_191
-191	val_192
-196	val_196
-196	val_197
-196	val_197
-196	val_197
-204	val_205
-209	val_209
-209	val_209
-209	val_210
-209	val_210
-213	val_213
-213	val_213
-213	val_214
-218	val_218
-222	val_222
-222	val_223
-227	val_228
-231	val_232
+160	val_160
+160	val_161
+165	val_165
+165	val_165
+165	val_166
+170	val_170
+170	val_171
+175	val_175
+175	val_175
+175	val_176
+175	val_176
+180	val_180
+185	val_186
+190	val_190
+195	val_195
+195	val_195
+200	val_200
+200	val_200
+205	val_205
+205	val_205
+205	val_206
+215	val_216
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+230	val_230
+235	val_235
+235	val_236
 240	val_241
 245	val_246
 245	val_246
-254	val_255
-259	val_260
-259	val_260
-263	val_263
-268	val_269
-272	val_272
-272	val_272
-272	val_273
-277	val_277
-277	val_277
-277	val_277
-277	val_277
-277	val_278
-277	val_278
-281	val_281
-281	val_281
-281	val_282
-281	val_282
-281	val_282
-286	val_286
-286	val_287
+255	val_255
+255	val_255
+260	val_260
+260	val_261
+260	val_261
+265	val_265
+265	val_265
+265	val_266
+275	val_275
+275	val_276
+275	val_276
+280	val_280
+280	val_280
+285	val_285
+285	val_286
 295	val_296
 295	val_296
-303	val_304
-303	val_304
-308	val_308
-308	val_309
-308	val_309
-317	val_317
-317	val_317
-317	val_318
-321	val_321
-321	val_321
-326	val_327
+300	val_301
+300	val_301
+305	val_305
+305	val_306
+310	val_310
+310	val_311
+310	val_311
+310	val_311
+315	val_315
+325	val_325
+325	val_325
 330	val_331
 335	val_335
 335	val_336
 335	val_336
-344	val_344
-344	val_344
-344	val_345
-349	val_350
-349	val_350
-349	val_350
-349	val_350
-353	val_353
-353	val_353
-353	val_354
-358	val_359
-362	val_362
-367	val_367
-367	val_367
-367	val_368
-367	val_368
-371	val_372
-371	val_372
-371	val_372
-371	val_372
-376	val_377
+340	val_341
+345	val_345
+355	val_356
+355	val_356
+360	val_360
+360	val_361
+365	val_365
+375	val_375
+375	val_376
+375	val_376
+375	val_376
+375	val_376
+375	val_376
 385	val_386
 385	val_386
-394	val_394
-399	val_399
-399	val_399
-399	val_400
-399	val_400
-402	val_402
-402	val_403
-402	val_403
-402	val_403
-407	val_407
-407	val_408
-407	val_408
-407	val_408
-411	val_411
-411	val_412
-416	val_417
+390	val_391
+390	val_391
+390	val_391
+395	val_395
+395	val_395
+395	val_396
+395	val_396
+400	val_400
+405	val_406
+410	val_411
+415	val_416
 425	val_426
-439	val_439
-439	val_439
-439	val_440
-439	val_440
-443	val_443
-443	val_444
-443	val_444
-443	val_444
-448	val_448
-448	val_449
-452	val_452
-457	val_457
-457	val_458
-457	val_458
-461	val_462
-466	val_466
-466	val_466
-466	val_466
+430	val_430
+430	val_430
+430	val_430
+430	val_431
+435	val_435
+435	val_436
+440	val_441
+440	val_441
+450	val_451
+450	val_451
+455	val_455
+455	val_456
+455	val_456
+460	val_460
 470	val_470
 470	val_471
 475	val_475
 475	val_476
-484	val_484
-484	val_485
-489	val_489
-489	val_489
-489	val_489
-489	val_489
-489	val_490
-493	val_493
-498	val_498
-498	val_498
-498	val_498
+480	val_480
+480	val_480
+480	val_480
+480	val_481
+480	val_481
+485	val_485
+485	val_486
+485	val_486
+490	val_490
+490	val_491
+495	val_495
+495	val_496
diff --git a/ql/src/test/results/clientpositive/sample6.q.out b/ql/src/test/results/clientpositive/sample6.q.out
index 49aea2e1fc..72f29339c6 100644
--- a/ql/src/test/results/clientpositive/sample6.q.out
+++ b/ql/src/test/results/clientpositive/sample6.q.out
@@ -27,56 +27,50 @@ STAGE PLANS:
                 Select Operator
                   expressions:
                         expr: key
-                        type: string
+                        type: int
                         expr: value
                         type: string
-                  Select Operator
-                    expressions:
-                          expr: UDFToInteger(_col0)
-                          type: int
-                          expr: _col1
-                          type: string
-                    File Output Operator
-                      compressed: false
-                      GlobalTableId: 1
-                      directory: file:/data/users/pchakka/workspace/oshive/build/ql/tmp/557388751/10002
-                      table:
-                          input format: org.apache.hadoop.mapred.TextInputFormat
-                          output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                          properties:
-                            name dest1
-                            columns.types int:string
-                            serialization.ddl struct dest1 { i32 key, string value}
-                            serialization.format 1
-                            columns key,value
-                            bucket_count -1
-                            serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                            file.inputformat org.apache.hadoop.mapred.TextInputFormat
-                            file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                            location file:/data/users/pchakka/workspace/oshive/build/ql/test/data/warehouse/dest1
-                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                          name: dest1
+                  File Output Operator
+                    compressed: false
+                    GlobalTableId: 1
+                    directory: file:/Users/rmurthy/workspace/hive/build/ql/tmp/173941422/10002
+                    table:
+                        input format: org.apache.hadoop.mapred.TextInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                        properties:
+                          name dest1
+                          columns.types int:string
+                          serialization.ddl struct dest1 { i32 key, string value}
+                          serialization.format 1
+                          columns key,value
+                          bucket_count -1
+                          serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                          file.inputformat org.apache.hadoop.mapred.TextInputFormat
+                          file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                          location file:/Users/rmurthy/workspace/hive/build/ql/test/data/warehouse/dest1
+                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                        name: dest1
       Needs Tagging: false
       Path -> Alias:
-        file:/data/users/pchakka/workspace/oshive/build/ql/test/data/warehouse/srcbucket/kv1.txt 
+        file:/Users/rmurthy/workspace/hive/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt 
       Path -> Partition:
-        file:/data/users/pchakka/workspace/oshive/build/ql/test/data/warehouse/srcbucket/kv1.txt 
+        file:/Users/rmurthy/workspace/hive/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt 
           Partition
           
               input format: org.apache.hadoop.mapred.TextInputFormat
               output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
               properties:
                 name srcbucket
-                columns.types string:string
+                columns.types int:string
                 bucket_field_name key
-                serialization.ddl struct srcbucket { string key, string value}
+                serialization.ddl struct srcbucket { i32 key, string value}
                 columns key,value
                 serialization.format 1
                 bucket_count 2
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location file:/data/users/pchakka/workspace/oshive/build/ql/test/data/warehouse/srcbucket
+                location file:/Users/rmurthy/workspace/hive/build/ql/test/data/warehouse/srcbucket
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: srcbucket
 
@@ -86,11 +80,11 @@ STAGE PLANS:
           Move Operator
             files:
                 hdfs directory: true
-                source: file:/data/users/pchakka/workspace/oshive/build/ql/tmp/557388751/10002
-                destination: file:/data/users/pchakka/workspace/oshive/build/ql/tmp/1329298090/10000
+                source: file:/Users/rmurthy/workspace/hive/build/ql/tmp/173941422/10002
+                destination: file:/Users/rmurthy/workspace/hive/build/ql/tmp/1903663728/10000
           Map Reduce
             Alias -> Map Operator Tree:
-              file:/data/users/pchakka/workspace/oshive/build/ql/tmp/557388751/10002 
+              file:/Users/rmurthy/workspace/hive/build/ql/tmp/173941422/10002 
                   Reduce Output Operator
                     sort order: 
                     Map-reduce partition columns:
@@ -104,9 +98,9 @@ STAGE PLANS:
                           type: string
             Needs Tagging: false
             Path -> Alias:
-              file:/data/users/pchakka/workspace/oshive/build/ql/tmp/557388751/10002 
+              file:/Users/rmurthy/workspace/hive/build/ql/tmp/173941422/10002 
             Path -> Partition:
-              file:/data/users/pchakka/workspace/oshive/build/ql/tmp/557388751/10002 
+              file:/Users/rmurthy/workspace/hive/build/ql/tmp/173941422/10002 
                 Partition
                 
                     input format: org.apache.hadoop.mapred.TextInputFormat
@@ -121,7 +115,7 @@ STAGE PLANS:
                       serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       file.inputformat org.apache.hadoop.mapred.TextInputFormat
                       file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                      location file:/data/users/pchakka/workspace/oshive/build/ql/test/data/warehouse/dest1
+                      location file:/Users/rmurthy/workspace/hive/build/ql/test/data/warehouse/dest1
                     serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                     name: dest1
             Reduce Operator Tree:
@@ -129,7 +123,7 @@ STAGE PLANS:
                 File Output Operator
                   compressed: false
                   GlobalTableId: 0
-                  directory: file:/data/users/pchakka/workspace/oshive/build/ql/tmp/1329298090/10000
+                  directory: file:/Users/rmurthy/workspace/hive/build/ql/tmp/1903663728/10000
                   table:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -143,7 +137,7 @@ STAGE PLANS:
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                         file.inputformat org.apache.hadoop.mapred.TextInputFormat
                         file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                        location file:/data/users/pchakka/workspace/oshive/build/ql/test/data/warehouse/dest1
+                        location file:/Users/rmurthy/workspace/hive/build/ql/test/data/warehouse/dest1
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       name: dest1
 
@@ -151,7 +145,7 @@ STAGE PLANS:
     Move Operator
       tables:
           replace: true
-          source: file:/data/users/pchakka/workspace/oshive/build/ql/tmp/1329298090/10000
+          source: file:/Users/rmurthy/workspace/hive/build/ql/tmp/1903663728/10000
           table:
               input format: org.apache.hadoop.mapred.TextInputFormat
               output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -165,10 +159,10 @@ STAGE PLANS:
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location file:/data/users/pchakka/workspace/oshive/build/ql/test/data/warehouse/dest1
+                location file:/Users/rmurthy/workspace/hive/build/ql/test/data/warehouse/dest1
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: dest1
-          tmp directory: file:/data/users/pchakka/workspace/oshive/build/ql/tmp/1329298090/10001
+          tmp directory: file:/Users/rmurthy/workspace/hive/build/ql/tmp/1903663728/10001
 
 
 query: INSERT OVERWRITE TABLE dest1 SELECT s.* 
@@ -177,122 +171,253 @@ Input: default/srcbucket
 Output: default/dest1
 query: SELECT dest1.* FROM dest1
 Input: default/dest1
-Output: file:/data/users/pchakka/workspace/oshive/build/ql/tmp/569046726/10000
-165	val_165
+Output: file:/Users/rmurthy/workspace/hive/build/ql/tmp/607325452/10000
+468	val_469
+272	val_273
+448	val_449
+440	val_441
+296	val_297
+428	val_429
+356	val_357
+128	val_129
+0	val_1
+240	val_241
+408	val_409
+476	val_477
+48	val_49
+424	val_425
+488	val_489
+128	val_129
+468	val_469
+224	val_225
+344	val_345
+4	val_5
+56	val_57
+304	val_305
+264	val_265
+196	val_197
+20	val_21
+492	val_493
+360	val_361
+68	val_69
+16	val_17
+492	val_493
+376	val_377
+120	val_121
+132	val_133
+388	val_389
+184	val_185
+284	val_285
+352	val_353
+328	val_329
+480	val_481
+480	val_481
+392	val_393
+476	val_477
+252	val_253
+264	val_265
+48	val_49
+336	val_337
+340	val_341
+484	val_485
+260	val_261
+164	val_165
+104	val_105
+80	val_81
+140	val_141
+212	val_213
+308	val_309
+416	val_417
+364	val_365
+20	val_21
+52	val_53
+40	val_41
+8	val_9
+168	val_169
+384	val_385
+324	val_325
+404	val_405
+260	val_261
+328	val_329
+404	val_405
+384	val_385
+76	val_77
+116	val_117
+104	val_105
+32	val_33
+132	val_133
+192	val_193
+356	val_357
+352	val_353
+52	val_53
+160	val_161
+76	val_77
+412	val_413
+16	val_17
+204	val_205
+216	val_217
+196	val_197
+12	val_13
+384	val_385
+60	val_61
+52	val_53
+404	val_405
+300	val_301
+0	val_1
+268	val_269
+392	val_393
+104	val_105
+436	val_437
+156	val_157
+172	val_173
+244	val_245
+284	val_285
+164	val_165
+136	val_137
+432	val_433
+496	val_497
+144	val_145
+408	val_409
+152	val_153
+348	val_349
+292	val_293
+52	val_53
+152	val_153
+256	val_257
+292	val_293
+412	val_413
+40	val_41
+100	val_101
+156	val_157
+228	val_229
+248	val_249
+244	val_245
+276	val_277
+196	val_197
+440	val_441
+100	val_101
+308	val_309
+468	val_469
+152	val_153
+76	val_77
+300	val_301
+244	val_245
 484	val_484
-150	val_150
 224	val_224
-66	val_66
-213	val_213
-374	val_374
-495	val_495
-37	val_37
-327	val_327
-15	val_15
-338	val_338
-459	val_459
-466	val_466
+128	val_128
+152	val_152
+252	val_252
+292	val_292
+208	val_208
 396	val_396
-309	val_309
-367	val_367
 0	val_0
-455	val_455
+128	val_128
 316	val_316
-345	val_345
-129	val_129
-378	val_378
+20	val_20
+92	val_92
+72	val_72
 4	val_4
+280	val_280
+208	val_208
 356	val_356
-169	val_169
-125	val_125
-437	val_437
-286	val_286
-187	val_187
+192	val_192
 176	val_176
-459	val_459
-51	val_51
-103	val_103
-239	val_239
-213	val_213
+216	val_216
 176	val_176
-275	val_275
+332	val_332
+180	val_180
+284	val_284
+12	val_12
 260	val_260
 404	val_404
-217	val_217
+384	val_384
+272	val_272
 84	val_84
-466	val_466
+348	val_348
 8	val_8
-411	val_411
+208	val_208
+348	val_348
+24	val_24
 172	val_172
-129	val_129
-158	val_158
+496	val_496
 0	val_0
-26	val_26
-165	val_165
-327	val_327
-51	val_51
+468	val_468
+100	val_100
+96	val_96
+120	val_120
 404	val_404
-95	val_95
-282	val_282
-187	val_187
+436	val_436
+156	val_156
+468	val_468
+308	val_308
+196	val_196
+288	val_288
 316	val_316
-169	val_169
-77	val_77
 0	val_0
-118	val_118
-282	val_282
-419	val_419
-15	val_15
-118	val_118
-19	val_19
+364	val_364
+72	val_72
 224	val_224
-309	val_309
-389	val_389
-327	val_327
-242	val_242
 392	val_392
-242	val_242
+272	val_272
+452	val_452
 396	val_396
-95	val_95
-11	val_11
-143	val_143
+336	val_336
+168	val_168
+472	val_472
+160	val_160
+76	val_76
+492	val_492
 228	val_228
-33	val_33
-103	val_103
-367	val_367
-239	val_239
+64	val_64
+468	val_468
+76	val_76
+368	val_368
+296	val_296
+216	val_216
+344	val_344
+116	val_116
+256	val_256
 480	val_480
-202	val_202
+288	val_288
+244	val_244
+128	val_128
+432	val_432
 316	val_316
-235	val_235
+280	val_280
 80	val_80
 44	val_44
-466	val_466
-257	val_257
-190	val_190
-114	val_114
+104	val_104
+348	val_348
+424	val_424
+12	val_12
 396	val_396
-217	val_217
-125	val_125
-187	val_187
+164	val_164
+164	val_164
+424	val_424
 480	val_480
-491	val_491
-305	val_305
+24	val_24
+104	val_104
+200	val_200
+360	val_360
+248	val_248
 444	val_444
-169	val_169
-323	val_323
+120	val_120
+468	val_468
+460	val_460
 480	val_480
 136	val_136
 172	val_172
-462	val_462
-26	val_26
-462	val_462
-341	val_341
-183	val_183
+384	val_384
+256	val_256
+384	val_384
+492	val_492
+100	val_100
+348	val_348
+344	val_344
 84	val_84
-37	val_37
+28	val_28
 448	val_448
-194	val_194
-477	val_477
-169	val_169
+152	val_152
+348	val_348
 400	val_400
+200	val_200
diff --git a/ql/src/test/results/clientpositive/sample7.q.out b/ql/src/test/results/clientpositive/sample7.q.out
index 24b3d7b5f6..af896fbce4 100644
--- a/ql/src/test/results/clientpositive/sample7.q.out
+++ b/ql/src/test/results/clientpositive/sample7.q.out
@@ -19,7 +19,7 @@ STAGE PLANS:
         s 
             Filter Operator
               predicate:
-                  expr: ((((hash(key) & 2147483647) % 4) = 0) and (UDFToDouble(key) > UDFToDouble(100)))
+                  expr: ((((hash(key) & 2147483647) % 4) = 0) and (key > 100))
                   type: boolean
               Filter Operator
                 predicate:
@@ -27,61 +27,55 @@ STAGE PLANS:
                     type: boolean
                 Filter Operator
                   predicate:
-                      expr: (UDFToDouble(key) > UDFToDouble(100))
+                      expr: (key > 100)
                       type: boolean
                   Select Operator
                     expressions:
                           expr: key
-                          type: string
+                          type: int
                           expr: value
                           type: string
-                    Select Operator
-                      expressions:
-                            expr: UDFToInteger(_col0)
-                            type: int
-                            expr: _col1
-                            type: string
-                      File Output Operator
-                        compressed: false
-                        GlobalTableId: 1
-                        directory: file:/data/users/pchakka/workspace/oshive/build/ql/tmp/1062372910/10002
-                        table:
-                            input format: org.apache.hadoop.mapred.TextInputFormat
-                            output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                            properties:
-                              name dest1
-                              columns.types int:string
-                              serialization.ddl struct dest1 { i32 key, string value}
-                              serialization.format 1
-                              columns key,value
-                              bucket_count -1
-                              serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                              file.inputformat org.apache.hadoop.mapred.TextInputFormat
-                              file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                              location file:/data/users/pchakka/workspace/oshive/build/ql/test/data/warehouse/dest1
-                            serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                            name: dest1
+                    File Output Operator
+                      compressed: false
+                      GlobalTableId: 1
+                      directory: file:/Users/rmurthy/workspace/hive/build/ql/tmp/733482180/10002
+                      table:
+                          input format: org.apache.hadoop.mapred.TextInputFormat
+                          output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                          properties:
+                            name dest1
+                            columns.types int:string
+                            serialization.ddl struct dest1 { i32 key, string value}
+                            serialization.format 1
+                            columns key,value
+                            bucket_count -1
+                            serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                            file.inputformat org.apache.hadoop.mapred.TextInputFormat
+                            file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                            location file:/Users/rmurthy/workspace/hive/build/ql/test/data/warehouse/dest1
+                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                          name: dest1
       Needs Tagging: false
       Path -> Alias:
-        file:/data/users/pchakka/workspace/oshive/build/ql/test/data/warehouse/srcbucket/kv1.txt 
+        file:/Users/rmurthy/workspace/hive/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt 
       Path -> Partition:
-        file:/data/users/pchakka/workspace/oshive/build/ql/test/data/warehouse/srcbucket/kv1.txt 
+        file:/Users/rmurthy/workspace/hive/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt 
           Partition
           
               input format: org.apache.hadoop.mapred.TextInputFormat
               output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
               properties:
                 name srcbucket
-                columns.types string:string
+                columns.types int:string
                 bucket_field_name key
-                serialization.ddl struct srcbucket { string key, string value}
+                serialization.ddl struct srcbucket { i32 key, string value}
                 columns key,value
                 serialization.format 1
                 bucket_count 2
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location file:/data/users/pchakka/workspace/oshive/build/ql/test/data/warehouse/srcbucket
+                location file:/Users/rmurthy/workspace/hive/build/ql/test/data/warehouse/srcbucket
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: srcbucket
 
@@ -91,11 +85,11 @@ STAGE PLANS:
           Move Operator
             files:
                 hdfs directory: true
-                source: file:/data/users/pchakka/workspace/oshive/build/ql/tmp/1062372910/10002
-                destination: file:/data/users/pchakka/workspace/oshive/build/ql/tmp/921828791/10000
+                source: file:/Users/rmurthy/workspace/hive/build/ql/tmp/733482180/10002
+                destination: file:/Users/rmurthy/workspace/hive/build/ql/tmp/569755481/10000
           Map Reduce
             Alias -> Map Operator Tree:
-              file:/data/users/pchakka/workspace/oshive/build/ql/tmp/1062372910/10002 
+              file:/Users/rmurthy/workspace/hive/build/ql/tmp/733482180/10002 
                   Reduce Output Operator
                     sort order: 
                     Map-reduce partition columns:
@@ -109,9 +103,9 @@ STAGE PLANS:
                           type: string
             Needs Tagging: false
             Path -> Alias:
-              file:/data/users/pchakka/workspace/oshive/build/ql/tmp/1062372910/10002 
+              file:/Users/rmurthy/workspace/hive/build/ql/tmp/733482180/10002 
             Path -> Partition:
-              file:/data/users/pchakka/workspace/oshive/build/ql/tmp/1062372910/10002 
+              file:/Users/rmurthy/workspace/hive/build/ql/tmp/733482180/10002 
                 Partition
                 
                     input format: org.apache.hadoop.mapred.TextInputFormat
@@ -126,7 +120,7 @@ STAGE PLANS:
                       serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       file.inputformat org.apache.hadoop.mapred.TextInputFormat
                       file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                      location file:/data/users/pchakka/workspace/oshive/build/ql/test/data/warehouse/dest1
+                      location file:/Users/rmurthy/workspace/hive/build/ql/test/data/warehouse/dest1
                     serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                     name: dest1
             Reduce Operator Tree:
@@ -134,7 +128,7 @@ STAGE PLANS:
                 File Output Operator
                   compressed: false
                   GlobalTableId: 0
-                  directory: file:/data/users/pchakka/workspace/oshive/build/ql/tmp/921828791/10000
+                  directory: file:/Users/rmurthy/workspace/hive/build/ql/tmp/569755481/10000
                   table:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -148,7 +142,7 @@ STAGE PLANS:
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                         file.inputformat org.apache.hadoop.mapred.TextInputFormat
                         file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                        location file:/data/users/pchakka/workspace/oshive/build/ql/test/data/warehouse/dest1
+                        location file:/Users/rmurthy/workspace/hive/build/ql/test/data/warehouse/dest1
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       name: dest1
 
@@ -156,7 +150,7 @@ STAGE PLANS:
     Move Operator
       tables:
           replace: true
-          source: file:/data/users/pchakka/workspace/oshive/build/ql/tmp/921828791/10000
+          source: file:/Users/rmurthy/workspace/hive/build/ql/tmp/569755481/10000
           table:
               input format: org.apache.hadoop.mapred.TextInputFormat
               output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -170,10 +164,10 @@ STAGE PLANS:
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location file:/data/users/pchakka/workspace/oshive/build/ql/test/data/warehouse/dest1
+                location file:/Users/rmurthy/workspace/hive/build/ql/test/data/warehouse/dest1
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: dest1
-          tmp directory: file:/data/users/pchakka/workspace/oshive/build/ql/tmp/921828791/10001
+          tmp directory: file:/Users/rmurthy/workspace/hive/build/ql/tmp/569755481/10001
 
 
 query: INSERT OVERWRITE TABLE dest1 SELECT s.* 
@@ -183,98 +177,202 @@ Input: default/srcbucket
 Output: default/dest1
 query: SELECT dest1.* FROM dest1
 Input: default/dest1
-Output: file:/data/users/pchakka/workspace/oshive/build/ql/tmp/1564717662/10000
-165	val_165
+Output: file:/Users/rmurthy/workspace/hive/build/ql/tmp/503845125/10000
+468	val_469
+272	val_273
+448	val_449
+440	val_441
+296	val_297
+428	val_429
+356	val_357
+128	val_129
+240	val_241
+408	val_409
+476	val_477
+424	val_425
+488	val_489
+128	val_129
+468	val_469
+224	val_225
+344	val_345
+304	val_305
+264	val_265
+196	val_197
+492	val_493
+360	val_361
+492	val_493
+376	val_377
+120	val_121
+132	val_133
+388	val_389
+184	val_185
+284	val_285
+352	val_353
+328	val_329
+480	val_481
+480	val_481
+392	val_393
+476	val_477
+252	val_253
+264	val_265
+336	val_337
+340	val_341
+484	val_485
+260	val_261
+164	val_165
+104	val_105
+140	val_141
+212	val_213
+308	val_309
+416	val_417
+364	val_365
+168	val_169
+384	val_385
+324	val_325
+404	val_405
+260	val_261
+328	val_329
+404	val_405
+384	val_385
+116	val_117
+104	val_105
+132	val_133
+192	val_193
+356	val_357
+352	val_353
+160	val_161
+412	val_413
+204	val_205
+216	val_217
+196	val_197
+384	val_385
+404	val_405
+300	val_301
+268	val_269
+392	val_393
+104	val_105
+436	val_437
+156	val_157
+172	val_173
+244	val_245
+284	val_285
+164	val_165
+136	val_137
+432	val_433
+496	val_497
+144	val_145
+408	val_409
+152	val_153
+348	val_349
+292	val_293
+152	val_153
+256	val_257
+292	val_293
+412	val_413
+156	val_157
+228	val_229
+248	val_249
+244	val_245
+276	val_277
+196	val_197
+440	val_441
+308	val_309
+468	val_469
+152	val_153
+300	val_301
+244	val_245
 484	val_484
-150	val_150
 224	val_224
-213	val_213
-374	val_374
-495	val_495
-327	val_327
-338	val_338
-459	val_459
-466	val_466
+128	val_128
+152	val_152
+252	val_252
+292	val_292
+208	val_208
 396	val_396
-309	val_309
-367	val_367
-455	val_455
+128	val_128
 316	val_316
-345	val_345
-129	val_129
-378	val_378
+280	val_280
+208	val_208
 356	val_356
-169	val_169
-125	val_125
-437	val_437
-286	val_286
-187	val_187
+192	val_192
 176	val_176
-459	val_459
-103	val_103
-239	val_239
-213	val_213
+216	val_216
 176	val_176
-275	val_275
+332	val_332
+180	val_180
+284	val_284
 260	val_260
 404	val_404
-217	val_217
-466	val_466
-411	val_411
+384	val_384
+272	val_272
+348	val_348
+208	val_208
+348	val_348
 172	val_172
-129	val_129
-158	val_158
-165	val_165
-327	val_327
+496	val_496
+468	val_468
+120	val_120
 404	val_404
-282	val_282
-187	val_187
+436	val_436
+156	val_156
+468	val_468
+308	val_308
+196	val_196
+288	val_288
 316	val_316
-169	val_169
-118	val_118
-282	val_282
-419	val_419
-118	val_118
+364	val_364
 224	val_224
-309	val_309
-389	val_389
-327	val_327
-242	val_242
 392	val_392
-242	val_242
+272	val_272
+452	val_452
 396	val_396
-143	val_143
+336	val_336
+168	val_168
+472	val_472
+160	val_160
+492	val_492
 228	val_228
-103	val_103
-367	val_367
-239	val_239
+468	val_468
+368	val_368
+296	val_296
+216	val_216
+344	val_344
+116	val_116
+256	val_256
 480	val_480
-202	val_202
+288	val_288
+244	val_244
+128	val_128
+432	val_432
 316	val_316
-235	val_235
-466	val_466
-257	val_257
-190	val_190
-114	val_114
+280	val_280
+104	val_104
+348	val_348
+424	val_424
 396	val_396
-217	val_217
-125	val_125
-187	val_187
+164	val_164
+164	val_164
+424	val_424
 480	val_480
-491	val_491
-305	val_305
+104	val_104
+200	val_200
+360	val_360
+248	val_248
 444	val_444
-169	val_169
-323	val_323
+120	val_120
+468	val_468
+460	val_460
 480	val_480
 136	val_136
 172	val_172
-462	val_462
-462	val_462
-341	val_341
-183	val_183
+384	val_384
+256	val_256
+384	val_384
+492	val_492
+348	val_348
+344	val_344
 448	val_448
-194	val_194
-477	val_477
-169	val_169
+152	val_152
+348	val_348
 400	val_400
+200	val_200
diff --git a/ql/src/test/results/clientpositive/sample9.q.out b/ql/src/test/results/clientpositive/sample9.q.out
new file mode 100644
index 0000000000..305288725b
--- /dev/null
+++ b/ql/src/test/results/clientpositive/sample9.q.out
@@ -0,0 +1,572 @@
+query: EXPLAIN EXTENDED
+SELECT s.*
+FROM (SELECT a.* FROM srcbucket TABLESAMPLE (BUCKET 1 OUT OF 2 on key) a) s
+ABSTRACT SYNTAX TREE:
+  (TOK_QUERY (TOK_FROM (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_TABREF srcbucket (TOK_TABLESAMPLE 1 2 (TOK_TABLE_OR_COL key)) a)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_ALLCOLREF a))))) s)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_ALLCOLREF s)))))
+
+STAGE DEPENDENCIES:
+  Stage-1 is a root stage
+  Stage-0 is a root stage
+
+STAGE PLANS:
+  Stage: Stage-1
+    Map Reduce
+      Alias -> Map Operator Tree:
+        s:a 
+            Filter Operator
+              predicate:
+                  expr: (((hash(key) & 2147483647) % 2) = 0)
+                  type: boolean
+              Filter Operator
+                predicate:
+                    expr: (((hash(key) & 2147483647) % 2) = 0)
+                    type: boolean
+                Select Operator
+                  expressions:
+                        expr: key
+                        type: int
+                        expr: value
+                        type: string
+                  Select Operator
+                    expressions:
+                          expr: _col0
+                          type: int
+                          expr: _col1
+                          type: string
+                    File Output Operator
+                      compressed: false
+                      GlobalTableId: 0
+                      directory: file:/Users/rmurthy/workspace/hive/build/ql/tmp/404346748/10001
+                      table:
+                          input format: org.apache.hadoop.mapred.TextInputFormat
+                          output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                          properties:
+                            columns s.key,s.value
+                            serialization.format 1
+                            columns.types int:string
+      Needs Tagging: false
+      Path -> Alias:
+        file:/Users/rmurthy/workspace/hive/build/ql/test/data/warehouse/srcbucket 
+      Path -> Partition:
+        file:/Users/rmurthy/workspace/hive/build/ql/test/data/warehouse/srcbucket 
+          Partition
+          
+              input format: org.apache.hadoop.mapred.TextInputFormat
+              output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+              properties:
+                name srcbucket
+                columns.types int:string
+                bucket_field_name key
+                serialization.ddl struct srcbucket { i32 key, string value}
+                columns key,value
+                serialization.format 1
+                bucket_count 2
+                serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                file.inputformat org.apache.hadoop.mapred.TextInputFormat
+                file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                location file:/Users/rmurthy/workspace/hive/build/ql/test/data/warehouse/srcbucket
+              serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+              name: srcbucket
+
+  Stage: Stage-0
+    Fetch Operator
+      limit: -1
+
+
+query: SELECT s.*
+FROM (SELECT a.* FROM srcbucket TABLESAMPLE (BUCKET 1 OUT OF 2 on key) a) s
+Input: default/srcbucket
+Output: file:/Users/rmurthy/workspace/hive/build/ql/tmp/831191978/10000
+474	val_475
+62	val_63
+468	val_469
+272	val_273
+448	val_449
+246	val_247
+440	val_441
+278	val_279
+296	val_297
+428	val_429
+126	val_127
+106	val_107
+356	val_357
+490	val_491
+402	val_403
+128	val_129
+10	val_11
+226	val_227
+110	val_111
+0	val_1
+240	val_241
+286	val_287
+408	val_409
+476	val_477
+482	val_483
+48	val_49
+424	val_425
+226	val_227
+494	val_495
+488	val_489
+94	val_95
+50	val_51
+402	val_403
+128	val_129
+468	val_469
+314	val_315
+224	val_225
+344	val_345
+4	val_5
+206	val_207
+114	val_115
+56	val_57
+114	val_115
+254	val_255
+390	val_391
+304	val_305
+264	val_265
+196	val_197
+238	val_239
+20	val_21
+492	val_493
+82	val_83
+58	val_59
+86	val_87
+438	val_439
+360	val_361
+222	val_223
+42	val_43
+338	val_339
+68	val_69
+16	val_17
+492	val_493
+376	val_377
+120	val_121
+306	val_307
+426	val_427
+132	val_133
+446	val_447
+386	val_387
+388	val_389
+184	val_185
+284	val_285
+246	val_247
+262	val_263
+122	val_123
+438	val_439
+390	val_391
+352	val_353
+226	val_227
+328	val_329
+382	val_383
+342	val_343
+480	val_481
+102	val_103
+480	val_481
+318	val_319
+392	val_393
+476	val_477
+258	val_259
+174	val_175
+252	val_253
+114	val_115
+264	val_265
+48	val_49
+336	val_337
+340	val_341
+390	val_391
+484	val_485
+6	val_7
+260	val_261
+2	val_3
+170	val_171
+164	val_165
+118	val_119
+310	val_311
+104	val_105
+80	val_81
+326	val_327
+450	val_451
+140	val_141
+212	val_213
+308	val_309
+30	val_31
+358	val_359
+416	val_417
+42	val_43
+386	val_387
+454	val_455
+364	val_365
+20	val_21
+52	val_53
+40	val_41
+8	val_9
+168	val_169
+384	val_385
+324	val_325
+310	val_311
+206	val_207
+404	val_405
+206	val_207
+226	val_227
+262	val_263
+260	val_261
+328	val_329
+322	val_323
+122	val_123
+404	val_405
+384	val_385
+76	val_77
+116	val_117
+42	val_43
+104	val_105
+406	val_407
+32	val_33
+132	val_133
+192	val_193
+58	val_59
+70	val_71
+356	val_357
+352	val_353
+52	val_53
+330	val_331
+138	val_139
+160	val_161
+454	val_455
+76	val_77
+174	val_175
+412	val_413
+16	val_17
+204	val_205
+126	val_127
+274	val_275
+374	val_375
+494	val_495
+216	val_217
+470	val_471
+196	val_197
+302	val_303
+450	val_451
+12	val_13
+398	val_399
+334	val_335
+384	val_385
+60	val_61
+442	val_443
+52	val_53
+404	val_405
+446	val_447
+300	val_301
+0	val_1
+268	val_269
+392	val_393
+104	val_105
+436	val_437
+156	val_157
+118	val_119
+172	val_173
+244	val_245
+6	val_7
+284	val_285
+164	val_165
+136	val_137
+462	val_463
+432	val_433
+496	val_497
+144	val_145
+408	val_409
+152	val_153
+382	val_383
+348	val_349
+122	val_123
+292	val_293
+182	val_183
+474	val_475
+310	val_311
+52	val_53
+486	val_487
+152	val_153
+378	val_379
+414	val_415
+256	val_257
+292	val_293
+412	val_413
+40	val_41
+478	val_479
+178	val_179
+100	val_101
+156	val_157
+228	val_229
+22	val_23
+248	val_249
+402	val_403
+62	val_63
+162	val_163
+244	val_245
+276	val_277
+46	val_47
+78	val_79
+134	val_135
+196	val_197
+410	val_411
+82	val_83
+440	val_441
+100	val_101
+308	val_309
+430	val_431
+468	val_469
+152	val_153
+138	val_139
+76	val_77
+300	val_301
+478	val_479
+118	val_119
+178	val_179
+242	val_243
+244	val_245
+238	val_238
+86	val_86
+278	val_278
+98	val_98
+484	val_484
+150	val_150
+224	val_224
+66	val_66
+128	val_128
+146	val_146
+406	val_406
+374	val_374
+152	val_152
+82	val_82
+166	val_166
+430	val_430
+252	val_252
+292	val_292
+338	val_338
+446	val_446
+394	val_394
+482	val_482
+174	val_174
+494	val_494
+466	val_466
+208	val_208
+174	val_174
+396	val_396
+162	val_162
+266	val_266
+342	val_342
+0	val_0
+128	val_128
+316	val_316
+302	val_302
+438	val_438
+170	val_170
+20	val_20
+378	val_378
+92	val_92
+72	val_72
+4	val_4
+280	val_280
+208	val_208
+356	val_356
+382	val_382
+498	val_498
+386	val_386
+192	val_192
+286	val_286
+176	val_176
+54	val_54
+138	val_138
+216	val_216
+430	val_430
+278	val_278
+176	val_176
+318	val_318
+332	val_332
+180	val_180
+284	val_284
+12	val_12
+230	val_230
+260	val_260
+404	val_404
+384	val_384
+272	val_272
+138	val_138
+84	val_84
+348	val_348
+466	val_466
+58	val_58
+8	val_8
+230	val_230
+208	val_208
+348	val_348
+24	val_24
+172	val_172
+42	val_42
+158	val_158
+496	val_496
+0	val_0
+322	val_322
+468	val_468
+454	val_454
+100	val_100
+298	val_298
+418	val_418
+96	val_96
+26	val_26
+230	val_230
+120	val_120
+404	val_404
+436	val_436
+156	val_156
+468	val_468
+308	val_308
+196	val_196
+288	val_288
+98	val_98
+282	val_282
+318	val_318
+318	val_318
+470	val_470
+316	val_316
+0	val_0
+490	val_490
+364	val_364
+118	val_118
+134	val_134
+282	val_282
+138	val_138
+238	val_238
+118	val_118
+72	val_72
+90	val_90
+10	val_10
+306	val_306
+224	val_224
+242	val_242
+392	val_392
+272	val_272
+242	val_242
+452	val_452
+226	val_226
+402	val_402
+396	val_396
+58	val_58
+336	val_336
+168	val_168
+34	val_34
+472	val_472
+322	val_322
+498	val_498
+160	val_160
+42	val_42
+430	val_430
+458	val_458
+78	val_78
+76	val_76
+492	val_492
+218	val_218
+228	val_228
+138	val_138
+30	val_30
+64	val_64
+468	val_468
+76	val_76
+74	val_74
+342	val_342
+230	val_230
+368	val_368
+296	val_296
+216	val_216
+344	val_344
+274	val_274
+116	val_116
+256	val_256
+70	val_70
+480	val_480
+288	val_288
+244	val_244
+438	val_438
+128	val_128
+432	val_432
+202	val_202
+316	val_316
+280	val_280
+2	val_2
+80	val_80
+44	val_44
+104	val_104
+466	val_466
+366	val_366
+406	val_406
+190	val_190
+406	val_406
+114	val_114
+258	val_258
+90	val_90
+262	val_262
+348	val_348
+424	val_424
+12	val_12
+396	val_396
+164	val_164
+454	val_454
+478	val_478
+298	val_298
+164	val_164
+424	val_424
+382	val_382
+70	val_70
+480	val_480
+24	val_24
+104	val_104
+70	val_70
+438	val_438
+414	val_414
+200	val_200
+360	val_360
+248	val_248
+444	val_444
+120	val_120
+230	val_230
+478	val_478
+178	val_178
+468	val_468
+310	val_310
+460	val_460
+480	val_480
+136	val_136
+172	val_172
+214	val_214
+462	val_462
+406	val_406
+454	val_454
+384	val_384
+256	val_256
+26	val_26
+134	val_134
+384	val_384
+18	val_18
+462	val_462
+492	val_492
+100	val_100
+298	val_298
+498	val_498
+146	val_146
+458	val_458
+362	val_362
+186	val_186
+348	val_348
+18	val_18
+344	val_344
+84	val_84
+28	val_28
+448	val_448
+152	val_152
+348	val_348
+194	val_194
+414	val_414
+222	val_222
+126	val_126
+90	val_90
+400	val_400
+200	val_200
diff --git a/ql/src/test/results/compiler/plan/sample2.q.xml b/ql/src/test/results/compiler/plan/sample2.q.xml
index 20d8c82575..ec00deacc3 100644
--- a/ql/src/test/results/compiler/plan/sample2.q.xml
+++ b/ql/src/test/results/compiler/plan/sample2.q.xml
@@ -30,7 +30,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/252028113/10000</string> 
+               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1927782633/10000</string> 
               </void> 
               <void property="table"> 
                <object id="tableDesc0" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -83,7 +83,7 @@
                   </void> 
                   <void method="put"> 
                    <string>location</string> 
-                   <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/dest1</string> 
+                   <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/dest1</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -93,7 +93,7 @@
                </object> 
               </void> 
               <void property="tmpDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/252028113/10001</string> 
+               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1927782633/10001</string> 
               </void> 
              </object> 
             </void> 
@@ -121,10 +121,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1740154627/10002</string> 
+               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1976066542/10002</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/252028113/10000</string> 
+               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1927782633/10000</string> 
               </void> 
              </object> 
             </void> 
@@ -142,7 +142,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1740154627/10002</string> 
+               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1976066542/10002</string> 
                <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -342,10 +342,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1740154627/10002</string> 
+               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1976066542/10002</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1740154627/10002</string> 
+                 <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1976066542/10002</string> 
                 </void> 
                </object> 
               </void> 
@@ -354,7 +354,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1740154627/10002</string> 
+               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1976066542/10002</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object idref="tableDesc0"/> 
@@ -372,7 +372,7 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/252028113/10000</string> 
+                     <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1927782633/10000</string> 
                     </void> 
                     <void property="tableInfo"> 
                      <object idref="tableDesc0"/> 
@@ -417,7 +417,11 @@
                      <string>0</string> 
                     </void> 
                     <void property="type"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
+                     <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                      <void property="typeName"> 
+                       <string>int</string> 
+                      </void> 
+                     </object> 
                     </void> 
                    </object> 
                   </void> 
@@ -463,7 +467,7 @@
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
         <void property="dir"> 
-         <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1740154627/10002</string> 
+         <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1976066542/10002</string> 
         </void> 
         <void property="listTasks"> 
          <object idref="ArrayList0"/> 
@@ -519,7 +523,7 @@
            </void> 
            <void method="put"> 
             <string>columns.types</string> 
-            <string>string:string</string> 
+            <string>int:string</string> 
            </void> 
            <void method="put"> 
             <string>bucket_field_name</string> 
@@ -527,7 +531,7 @@
            </void> 
            <void method="put"> 
             <string>serialization.ddl</string> 
-            <string>struct srcbucket { string key, string value}</string> 
+            <string>struct srcbucket { i32 key, string value}</string> 
            </void> 
            <void method="put"> 
             <string>columns</string> 
@@ -555,7 +559,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/srcbucket</string> 
+            <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/srcbucket</string> 
            </void> 
           </object> 
          </void> 
@@ -575,89 +579,399 @@
         <void property="childOperators"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+           <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
             <void property="childOperators"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
-                  <void property="destTableId"> 
-                   <int>1</int> 
-                  </void> 
-                  <void property="dirName"> 
-                   <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1740154627/10002</string> 
+               <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+                <void property="childOperators"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+                    <void property="childOperators"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                        <void property="conf"> 
+                         <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
+                          <void property="destTableId"> 
+                           <int>1</int> 
+                          </void> 
+                          <void property="dirName"> 
+                           <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1976066542/10002</string> 
+                          </void> 
+                          <void property="tableInfo"> 
+                           <object idref="tableDesc0"/> 
+                          </void> 
+                         </object> 
+                        </void> 
+                        <void property="parentOperators"> 
+                         <object class="java.util.ArrayList"> 
+                          <void method="add"> 
+                           <object idref="SelectOperator0"/> 
+                          </void> 
+                         </object> 
+                        </void> 
+                        <void property="schema"> 
+                         <object idref="RowSchema0"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="columnExprMap"> 
+                     <object class="java.util.HashMap"> 
+                      <void method="put"> 
+                       <string>_col1</string> 
+                       <object id="exprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                        <void property="column"> 
+                         <string>value</string> 
+                        </void> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo0"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void method="put"> 
+                       <string>_col0</string> 
+                       <object id="exprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                        <void property="column"> 
+                         <string>key</string> 
+                        </void> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="conf"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.selectDesc"> 
+                      <void property="colList"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <object idref="exprNodeColumnDesc1"/> 
+                        </void> 
+                        <void method="add"> 
+                         <object idref="exprNodeColumnDesc0"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="outputColumnNames"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <string>_col0</string> 
+                        </void> 
+                        <void method="add"> 
+                         <string>_col1</string> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="selectStar"> 
+                       <boolean>true</boolean> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="parentOperators"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object idref="FilterOperator1"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="schema"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                      <void property="signature"> 
+                       <object class="java.util.Vector"> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                          <void property="internalName"> 
+                           <string>_col0</string> 
+                          </void> 
+                          <void property="type"> 
+                           <object idref="PrimitiveTypeInfo1"/> 
+                          </void> 
+                         </object> 
+                        </void> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                          <void property="internalName"> 
+                           <string>_col1</string> 
+                          </void> 
+                          <void property="type"> 
+                           <object idref="PrimitiveTypeInfo0"/> 
+                          </void> 
+                         </object> 
+                        </void> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                   </object> 
                   </void> 
-                  <void property="tableInfo"> 
-                   <object idref="tableDesc0"/> 
+                 </object> 
+                </void> 
+                <void property="conf"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.filterDesc"> 
+                  <void property="predicate"> 
+                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                    <void property="UDFClass"> 
+                     <class>org.apache.hadoop.hive.ql.udf.UDFOPEqual</class> 
+                    </void> 
+                    <void property="UDFMethod"> 
+                     <object id="Method0" class="org.apache.hadoop.hive.ql.udf.UDFOPEqual" method="getMethod"> 
+                      <string>evaluate</string> 
+                      <array class="java.lang.Class" length="2"> 
+                       <void index="0"> 
+                        <class>org.apache.hadoop.io.IntWritable</class> 
+                       </void> 
+                       <void index="1"> 
+                        <class>org.apache.hadoop.io.IntWritable</class> 
+                       </void> 
+                      </array> 
+                     </object> 
+                    </void> 
+                    <void property="childExprs"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                        <void property="UDFClass"> 
+                         <class>org.apache.hadoop.hive.ql.udf.UDFOPMod</class> 
+                        </void> 
+                        <void property="UDFMethod"> 
+                         <object id="Method1" class="org.apache.hadoop.hive.ql.udf.UDFOPMod" method="getMethod"> 
+                          <string>evaluate</string> 
+                          <array class="java.lang.Class" length="2"> 
+                           <void index="0"> 
+                            <class>org.apache.hadoop.io.IntWritable</class> 
+                           </void> 
+                           <void index="1"> 
+                            <class>org.apache.hadoop.io.IntWritable</class> 
+                           </void> 
+                          </array> 
+                         </object> 
+                        </void> 
+                        <void property="childExprs"> 
+                         <object class="java.util.ArrayList"> 
+                          <void method="add"> 
+                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                            <void property="UDFClass"> 
+                             <class>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</class> 
+                            </void> 
+                            <void property="UDFMethod"> 
+                             <object id="Method2" class="org.apache.hadoop.hive.ql.udf.UDFOPBitAnd" method="getMethod"> 
+                              <string>evaluate</string> 
+                              <array class="java.lang.Class" length="2"> 
+                               <void index="0"> 
+                                <class>org.apache.hadoop.io.IntWritable</class> 
+                               </void> 
+                               <void index="1"> 
+                                <class>org.apache.hadoop.io.IntWritable</class> 
+                               </void> 
+                              </array> 
+                             </object> 
+                            </void> 
+                            <void property="childExprs"> 
+                             <object class="java.util.ArrayList"> 
+                              <void method="add"> 
+                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeGenericFuncDesc"> 
+                                <void property="childExprs"> 
+                                 <object class="java.util.ArrayList"> 
+                                  <void method="add"> 
+                                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                                    <void property="column"> 
+                                     <string>key</string> 
+                                    </void> 
+                                    <void property="typeInfo"> 
+                                     <object idref="PrimitiveTypeInfo1"/> 
+                                    </void> 
+                                   </object> 
+                                  </void> 
+                                 </object> 
+                                </void> 
+                                <void property="genericUDFClass"> 
+                                 <class>org.apache.hadoop.hive.ql.udf.generic.GenericUDFHash</class> 
+                                </void> 
+                                <void property="typeInfo"> 
+                                 <object idref="PrimitiveTypeInfo1"/> 
+                                </void> 
+                               </object> 
+                              </void> 
+                              <void method="add"> 
+                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
+                                <void property="typeInfo"> 
+                                 <object idref="PrimitiveTypeInfo1"/> 
+                                </void> 
+                                <void property="value"> 
+                                 <int>2147483647</int> 
+                                </void> 
+                               </object> 
+                              </void> 
+                             </object> 
+                            </void> 
+                            <void property="typeInfo"> 
+                             <object idref="PrimitiveTypeInfo1"/> 
+                            </void> 
+                           </object> 
+                          </void> 
+                          <void method="add"> 
+                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
+                            <void property="typeInfo"> 
+                             <object idref="PrimitiveTypeInfo1"/> 
+                            </void> 
+                            <void property="value"> 
+                             <int>2</int> 
+                            </void> 
+                           </object> 
+                          </void> 
+                         </object> 
+                        </void> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
+                        </void> 
+                        <void property="value"> 
+                         <int>0</int> 
+                        </void> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                      <void property="typeName"> 
+                       <string>boolean</string> 
+                      </void> 
+                     </object> 
+                    </void> 
+                   </object> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object idref="SelectOperator0"/> 
+                   <object idref="FilterOperator0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="schema"> 
-                 <object idref="RowSchema0"/> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="columnExprMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>_col1</string> 
-               <object id="exprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>value</string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>_col0</string> 
-               <object id="exprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>key</string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
                </object> 
               </void> 
              </object> 
             </void> 
             <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.selectDesc"> 
-              <void property="colList"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object idref="exprNodeColumnDesc1"/> 
+             <object class="org.apache.hadoop.hive.ql.plan.filterDesc"> 
+              <void property="predicate"> 
+               <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                <void property="UDFClass"> 
+                 <class>org.apache.hadoop.hive.ql.udf.UDFOPEqual</class> 
                 </void> 
-                <void method="add"> 
-                 <object idref="exprNodeColumnDesc0"/> 
+                <void property="UDFMethod"> 
+                 <object idref="Method0"/> 
                 </void> 
-               </object> 
-              </void> 
-              <void property="outputColumnNames"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <string>_col0</string> 
+                <void property="childExprs"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                    <void property="UDFClass"> 
+                     <class>org.apache.hadoop.hive.ql.udf.UDFOPMod</class> 
+                    </void> 
+                    <void property="UDFMethod"> 
+                     <object idref="Method1"/> 
+                    </void> 
+                    <void property="childExprs"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                        <void property="UDFClass"> 
+                         <class>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</class> 
+                        </void> 
+                        <void property="UDFMethod"> 
+                         <object idref="Method2"/> 
+                        </void> 
+                        <void property="childExprs"> 
+                         <object class="java.util.ArrayList"> 
+                          <void method="add"> 
+                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeGenericFuncDesc"> 
+                            <void property="childExprs"> 
+                             <object class="java.util.ArrayList"> 
+                              <void method="add"> 
+                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                                <void property="column"> 
+                                 <string>key</string> 
+                                </void> 
+                                <void property="typeInfo"> 
+                                 <object idref="PrimitiveTypeInfo1"/> 
+                                </void> 
+                               </object> 
+                              </void> 
+                             </object> 
+                            </void> 
+                            <void property="genericUDFClass"> 
+                             <class>org.apache.hadoop.hive.ql.udf.generic.GenericUDFHash</class> 
+                            </void> 
+                            <void property="typeInfo"> 
+                             <object idref="PrimitiveTypeInfo1"/> 
+                            </void> 
+                           </object> 
+                          </void> 
+                          <void method="add"> 
+                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
+                            <void property="typeInfo"> 
+                             <object idref="PrimitiveTypeInfo1"/> 
+                            </void> 
+                            <void property="value"> 
+                             <int>2147483647</int> 
+                            </void> 
+                           </object> 
+                          </void> 
+                         </object> 
+                        </void> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
+                        </void> 
+                        <void property="value"> 
+                         <int>2</int> 
+                        </void> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo1"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo1"/> 
+                    </void> 
+                    <void property="value"> 
+                     <int>0</int> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
                 </void> 
-                <void method="add"> 
-                 <string>_col1</string> 
+                <void property="typeInfo"> 
+                 <object idref="PrimitiveTypeInfo2"/> 
                 </void> 
                </object> 
               </void> 
-              <void property="selectStar"> 
-               <boolean>true</boolean> 
-              </void> 
              </object> 
             </void> 
             <void property="parentOperators"> 
@@ -670,21 +984,21 @@
             <void property="schema"> 
              <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
               <void property="signature"> 
-               <object class="java.util.Vector"> 
+               <object id="Vector0" class="java.util.Vector"> 
                 <void method="add"> 
                  <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                   <void property="internalName"> 
-                   <string>_col0</string> 
+                   <string>key</string> 
                   </void> 
                   <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
+                   <object idref="PrimitiveTypeInfo1"/> 
                   </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
                  <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                   <void property="internalName"> 
-                   <string>_col1</string> 
+                   <string>value</string> 
                   </void> 
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
@@ -712,28 +1026,7 @@
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
           <void property="signature"> 
-           <object class="java.util.Vector"> 
-            <void method="add"> 
-             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-              <void property="internalName"> 
-               <string>key</string> 
-              </void> 
-              <void property="type"> 
-               <object idref="PrimitiveTypeInfo0"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void method="add"> 
-             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-              <void property="internalName"> 
-               <string>value</string> 
-              </void> 
-              <void property="type"> 
-               <object idref="PrimitiveTypeInfo0"/> 
-              </void> 
-             </object> 
-            </void> 
-           </object> 
+           <object idref="Vector0"/> 
           </void> 
          </object> 
         </void> 
@@ -744,7 +1037,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/srcbucket/kv1.txt</string> 
+       <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>s</string> 
@@ -756,7 +1049,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/srcbucket/kv1.txt</string> 
+       <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/sample3.q.xml b/ql/src/test/results/compiler/plan/sample3.q.xml
index 50cff509f3..5c0ac452da 100644
--- a/ql/src/test/results/compiler/plan/sample3.q.xml
+++ b/ql/src/test/results/compiler/plan/sample3.q.xml
@@ -30,7 +30,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1523749381/10000</string> 
+               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1065018374/10000</string> 
               </void> 
               <void property="table"> 
                <object id="tableDesc0" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -83,7 +83,7 @@
                   </void> 
                   <void method="put"> 
                    <string>location</string> 
-                   <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/dest1</string> 
+                   <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/dest1</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -93,7 +93,7 @@
                </object> 
               </void> 
               <void property="tmpDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1523749381/10001</string> 
+               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1065018374/10001</string> 
               </void> 
              </object> 
             </void> 
@@ -121,10 +121,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1586340751/10002</string> 
+               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1846470159/10002</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1523749381/10000</string> 
+               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1065018374/10000</string> 
               </void> 
              </object> 
             </void> 
@@ -142,7 +142,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1586340751/10002</string> 
+               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1846470159/10002</string> 
                <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -342,10 +342,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1586340751/10002</string> 
+               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1846470159/10002</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1586340751/10002</string> 
+                 <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1846470159/10002</string> 
                 </void> 
                </object> 
               </void> 
@@ -354,7 +354,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1586340751/10002</string> 
+               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1846470159/10002</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object idref="tableDesc0"/> 
@@ -372,7 +372,7 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1523749381/10000</string> 
+                     <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1065018374/10000</string> 
                     </void> 
                     <void property="tableInfo"> 
                      <object idref="tableDesc0"/> 
@@ -417,7 +417,11 @@
                      <string>0</string> 
                     </void> 
                     <void property="type"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
+                     <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                      <void property="typeName"> 
+                       <string>int</string> 
+                      </void> 
+                     </object> 
                     </void> 
                    </object> 
                   </void> 
@@ -463,7 +467,7 @@
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
         <void property="dir"> 
-         <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1586340751/10002</string> 
+         <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1846470159/10002</string> 
         </void> 
         <void property="listTasks"> 
          <object idref="ArrayList0"/> 
@@ -519,7 +523,7 @@
            </void> 
            <void method="put"> 
             <string>columns.types</string> 
-            <string>string:string</string> 
+            <string>int:string</string> 
            </void> 
            <void method="put"> 
             <string>bucket_field_name</string> 
@@ -527,7 +531,7 @@
            </void> 
            <void method="put"> 
             <string>serialization.ddl</string> 
-            <string>struct srcbucket { string key, string value}</string> 
+            <string>struct srcbucket { i32 key, string value}</string> 
            </void> 
            <void method="put"> 
             <string>columns</string> 
@@ -555,7 +559,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/srcbucket</string> 
+            <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/srcbucket</string> 
            </void> 
           </object> 
          </void> 
@@ -594,7 +598,7 @@
                            <int>1</int> 
                           </void> 
                           <void property="dirName"> 
-                           <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1586340751/10002</string> 
+                           <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1846470159/10002</string> 
                           </void> 
                           <void property="tableInfo"> 
                            <object idref="tableDesc0"/> 
@@ -635,7 +639,7 @@
                          <string>key</string> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
                        </object> 
                       </void> 
@@ -685,7 +689,7 @@
                            <string>_col0</string> 
                           </void> 
                           <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
+                           <object idref="PrimitiveTypeInfo1"/> 
                           </void> 
                          </object> 
                         </void> 
@@ -779,7 +783,7 @@
                                      <string>key</string> 
                                     </void> 
                                     <void property="typeInfo"> 
-                                     <object idref="PrimitiveTypeInfo0"/> 
+                                     <object idref="PrimitiveTypeInfo1"/> 
                                     </void> 
                                    </object> 
                                   </void> 
@@ -799,11 +803,7 @@
                                  <class>org.apache.hadoop.hive.ql.udf.generic.GenericUDFHash</class> 
                                 </void> 
                                 <void property="typeInfo"> 
-                                 <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                                  <void property="typeName"> 
-                                   <string>int</string> 
-                                  </void> 
-                                 </object> 
+                                 <object idref="PrimitiveTypeInfo1"/> 
                                 </void> 
                                </object> 
                               </void> 
@@ -917,7 +917,7 @@
                                  <string>key</string> 
                                 </void> 
                                 <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo0"/> 
+                                 <object idref="PrimitiveTypeInfo1"/> 
                                 </void> 
                                </object> 
                               </void> 
@@ -1011,7 +1011,7 @@
                    <string>key</string> 
                   </void> 
                   <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
+                   <object idref="PrimitiveTypeInfo1"/> 
                   </void> 
                  </object> 
                 </void> 
@@ -1057,7 +1057,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/srcbucket</string> 
+       <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/srcbucket</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>s</string> 
@@ -1069,7 +1069,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/srcbucket</string> 
+       <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/srcbucket</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/sample4.q.xml b/ql/src/test/results/compiler/plan/sample4.q.xml
index 812af2ed07..cc3a56a1ef 100644
--- a/ql/src/test/results/compiler/plan/sample4.q.xml
+++ b/ql/src/test/results/compiler/plan/sample4.q.xml
@@ -30,7 +30,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1342043497/10000</string> 
+               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/215193431/10000</string> 
               </void> 
               <void property="table"> 
                <object id="tableDesc0" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -83,7 +83,7 @@
                   </void> 
                   <void method="put"> 
                    <string>location</string> 
-                   <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/dest1</string> 
+                   <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/dest1</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -93,7 +93,7 @@
                </object> 
               </void> 
               <void property="tmpDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1342043497/10001</string> 
+               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/215193431/10001</string> 
               </void> 
              </object> 
             </void> 
@@ -121,10 +121,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1473884255/10002</string> 
+               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1178789084/10002</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1342043497/10000</string> 
+               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/215193431/10000</string> 
               </void> 
              </object> 
             </void> 
@@ -142,7 +142,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1473884255/10002</string> 
+               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1178789084/10002</string> 
                <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -342,10 +342,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1473884255/10002</string> 
+               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1178789084/10002</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1473884255/10002</string> 
+                 <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1178789084/10002</string> 
                 </void> 
                </object> 
               </void> 
@@ -354,7 +354,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1473884255/10002</string> 
+               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1178789084/10002</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object idref="tableDesc0"/> 
@@ -372,7 +372,7 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1342043497/10000</string> 
+                     <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/215193431/10000</string> 
                     </void> 
                     <void property="tableInfo"> 
                      <object idref="tableDesc0"/> 
@@ -417,7 +417,11 @@
                      <string>0</string> 
                     </void> 
                     <void property="type"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
+                     <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                      <void property="typeName"> 
+                       <string>int</string> 
+                      </void> 
+                     </object> 
                     </void> 
                    </object> 
                   </void> 
@@ -463,7 +467,7 @@
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
         <void property="dir"> 
-         <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1473884255/10002</string> 
+         <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1178789084/10002</string> 
         </void> 
         <void property="listTasks"> 
          <object idref="ArrayList0"/> 
@@ -519,7 +523,7 @@
            </void> 
            <void method="put"> 
             <string>columns.types</string> 
-            <string>string:string</string> 
+            <string>int:string</string> 
            </void> 
            <void method="put"> 
             <string>bucket_field_name</string> 
@@ -527,7 +531,7 @@
            </void> 
            <void method="put"> 
             <string>serialization.ddl</string> 
-            <string>struct srcbucket { string key, string value}</string> 
+            <string>struct srcbucket { i32 key, string value}</string> 
            </void> 
            <void method="put"> 
             <string>columns</string> 
@@ -555,7 +559,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/srcbucket</string> 
+            <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/srcbucket</string> 
            </void> 
           </object> 
          </void> 
@@ -575,89 +579,399 @@
         <void property="childOperators"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+           <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
             <void property="childOperators"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
-                  <void property="destTableId"> 
-                   <int>1</int> 
-                  </void> 
-                  <void property="dirName"> 
-                   <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1473884255/10002</string> 
+               <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+                <void property="childOperators"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+                    <void property="childOperators"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                        <void property="conf"> 
+                         <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
+                          <void property="destTableId"> 
+                           <int>1</int> 
+                          </void> 
+                          <void property="dirName"> 
+                           <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1178789084/10002</string> 
+                          </void> 
+                          <void property="tableInfo"> 
+                           <object idref="tableDesc0"/> 
+                          </void> 
+                         </object> 
+                        </void> 
+                        <void property="parentOperators"> 
+                         <object class="java.util.ArrayList"> 
+                          <void method="add"> 
+                           <object idref="SelectOperator0"/> 
+                          </void> 
+                         </object> 
+                        </void> 
+                        <void property="schema"> 
+                         <object idref="RowSchema0"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="columnExprMap"> 
+                     <object class="java.util.HashMap"> 
+                      <void method="put"> 
+                       <string>_col1</string> 
+                       <object id="exprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                        <void property="column"> 
+                         <string>value</string> 
+                        </void> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo0"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void method="put"> 
+                       <string>_col0</string> 
+                       <object id="exprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                        <void property="column"> 
+                         <string>key</string> 
+                        </void> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="conf"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.selectDesc"> 
+                      <void property="colList"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <object idref="exprNodeColumnDesc1"/> 
+                        </void> 
+                        <void method="add"> 
+                         <object idref="exprNodeColumnDesc0"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="outputColumnNames"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <string>_col0</string> 
+                        </void> 
+                        <void method="add"> 
+                         <string>_col1</string> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="selectStar"> 
+                       <boolean>true</boolean> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="parentOperators"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object idref="FilterOperator1"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="schema"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                      <void property="signature"> 
+                       <object class="java.util.Vector"> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                          <void property="internalName"> 
+                           <string>_col0</string> 
+                          </void> 
+                          <void property="type"> 
+                           <object idref="PrimitiveTypeInfo1"/> 
+                          </void> 
+                         </object> 
+                        </void> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                          <void property="internalName"> 
+                           <string>_col1</string> 
+                          </void> 
+                          <void property="type"> 
+                           <object idref="PrimitiveTypeInfo0"/> 
+                          </void> 
+                         </object> 
+                        </void> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                   </object> 
                   </void> 
-                  <void property="tableInfo"> 
-                   <object idref="tableDesc0"/> 
+                 </object> 
+                </void> 
+                <void property="conf"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.filterDesc"> 
+                  <void property="predicate"> 
+                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                    <void property="UDFClass"> 
+                     <class>org.apache.hadoop.hive.ql.udf.UDFOPEqual</class> 
+                    </void> 
+                    <void property="UDFMethod"> 
+                     <object id="Method0" class="org.apache.hadoop.hive.ql.udf.UDFOPEqual" method="getMethod"> 
+                      <string>evaluate</string> 
+                      <array class="java.lang.Class" length="2"> 
+                       <void index="0"> 
+                        <class>org.apache.hadoop.io.IntWritable</class> 
+                       </void> 
+                       <void index="1"> 
+                        <class>org.apache.hadoop.io.IntWritable</class> 
+                       </void> 
+                      </array> 
+                     </object> 
+                    </void> 
+                    <void property="childExprs"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                        <void property="UDFClass"> 
+                         <class>org.apache.hadoop.hive.ql.udf.UDFOPMod</class> 
+                        </void> 
+                        <void property="UDFMethod"> 
+                         <object id="Method1" class="org.apache.hadoop.hive.ql.udf.UDFOPMod" method="getMethod"> 
+                          <string>evaluate</string> 
+                          <array class="java.lang.Class" length="2"> 
+                           <void index="0"> 
+                            <class>org.apache.hadoop.io.IntWritable</class> 
+                           </void> 
+                           <void index="1"> 
+                            <class>org.apache.hadoop.io.IntWritable</class> 
+                           </void> 
+                          </array> 
+                         </object> 
+                        </void> 
+                        <void property="childExprs"> 
+                         <object class="java.util.ArrayList"> 
+                          <void method="add"> 
+                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                            <void property="UDFClass"> 
+                             <class>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</class> 
+                            </void> 
+                            <void property="UDFMethod"> 
+                             <object id="Method2" class="org.apache.hadoop.hive.ql.udf.UDFOPBitAnd" method="getMethod"> 
+                              <string>evaluate</string> 
+                              <array class="java.lang.Class" length="2"> 
+                               <void index="0"> 
+                                <class>org.apache.hadoop.io.IntWritable</class> 
+                               </void> 
+                               <void index="1"> 
+                                <class>org.apache.hadoop.io.IntWritable</class> 
+                               </void> 
+                              </array> 
+                             </object> 
+                            </void> 
+                            <void property="childExprs"> 
+                             <object class="java.util.ArrayList"> 
+                              <void method="add"> 
+                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeGenericFuncDesc"> 
+                                <void property="childExprs"> 
+                                 <object class="java.util.ArrayList"> 
+                                  <void method="add"> 
+                                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                                    <void property="column"> 
+                                     <string>key</string> 
+                                    </void> 
+                                    <void property="typeInfo"> 
+                                     <object idref="PrimitiveTypeInfo1"/> 
+                                    </void> 
+                                   </object> 
+                                  </void> 
+                                 </object> 
+                                </void> 
+                                <void property="genericUDFClass"> 
+                                 <class>org.apache.hadoop.hive.ql.udf.generic.GenericUDFHash</class> 
+                                </void> 
+                                <void property="typeInfo"> 
+                                 <object idref="PrimitiveTypeInfo1"/> 
+                                </void> 
+                               </object> 
+                              </void> 
+                              <void method="add"> 
+                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
+                                <void property="typeInfo"> 
+                                 <object idref="PrimitiveTypeInfo1"/> 
+                                </void> 
+                                <void property="value"> 
+                                 <int>2147483647</int> 
+                                </void> 
+                               </object> 
+                              </void> 
+                             </object> 
+                            </void> 
+                            <void property="typeInfo"> 
+                             <object idref="PrimitiveTypeInfo1"/> 
+                            </void> 
+                           </object> 
+                          </void> 
+                          <void method="add"> 
+                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
+                            <void property="typeInfo"> 
+                             <object idref="PrimitiveTypeInfo1"/> 
+                            </void> 
+                            <void property="value"> 
+                             <int>2</int> 
+                            </void> 
+                           </object> 
+                          </void> 
+                         </object> 
+                        </void> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
+                        </void> 
+                        <void property="value"> 
+                         <int>0</int> 
+                        </void> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                      <void property="typeName"> 
+                       <string>boolean</string> 
+                      </void> 
+                     </object> 
+                    </void> 
+                   </object> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object idref="SelectOperator0"/> 
+                   <object idref="FilterOperator0"/> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="schema"> 
-                 <object idref="RowSchema0"/> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="columnExprMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>_col1</string> 
-               <object id="exprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>value</string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <string>_col0</string> 
-               <object id="exprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                <void property="column"> 
-                 <string>key</string> 
-                </void> 
-                <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
-                </void> 
                </object> 
               </void> 
              </object> 
             </void> 
             <void property="conf"> 
-             <object class="org.apache.hadoop.hive.ql.plan.selectDesc"> 
-              <void property="colList"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object idref="exprNodeColumnDesc1"/> 
+             <object class="org.apache.hadoop.hive.ql.plan.filterDesc"> 
+              <void property="predicate"> 
+               <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                <void property="UDFClass"> 
+                 <class>org.apache.hadoop.hive.ql.udf.UDFOPEqual</class> 
                 </void> 
-                <void method="add"> 
-                 <object idref="exprNodeColumnDesc0"/> 
+                <void property="UDFMethod"> 
+                 <object idref="Method0"/> 
                 </void> 
-               </object> 
-              </void> 
-              <void property="outputColumnNames"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <string>_col0</string> 
+                <void property="childExprs"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                    <void property="UDFClass"> 
+                     <class>org.apache.hadoop.hive.ql.udf.UDFOPMod</class> 
+                    </void> 
+                    <void property="UDFMethod"> 
+                     <object idref="Method1"/> 
+                    </void> 
+                    <void property="childExprs"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                        <void property="UDFClass"> 
+                         <class>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</class> 
+                        </void> 
+                        <void property="UDFMethod"> 
+                         <object idref="Method2"/> 
+                        </void> 
+                        <void property="childExprs"> 
+                         <object class="java.util.ArrayList"> 
+                          <void method="add"> 
+                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeGenericFuncDesc"> 
+                            <void property="childExprs"> 
+                             <object class="java.util.ArrayList"> 
+                              <void method="add"> 
+                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                                <void property="column"> 
+                                 <string>key</string> 
+                                </void> 
+                                <void property="typeInfo"> 
+                                 <object idref="PrimitiveTypeInfo1"/> 
+                                </void> 
+                               </object> 
+                              </void> 
+                             </object> 
+                            </void> 
+                            <void property="genericUDFClass"> 
+                             <class>org.apache.hadoop.hive.ql.udf.generic.GenericUDFHash</class> 
+                            </void> 
+                            <void property="typeInfo"> 
+                             <object idref="PrimitiveTypeInfo1"/> 
+                            </void> 
+                           </object> 
+                          </void> 
+                          <void method="add"> 
+                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
+                            <void property="typeInfo"> 
+                             <object idref="PrimitiveTypeInfo1"/> 
+                            </void> 
+                            <void property="value"> 
+                             <int>2147483647</int> 
+                            </void> 
+                           </object> 
+                          </void> 
+                         </object> 
+                        </void> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
+                        </void> 
+                        <void property="value"> 
+                         <int>2</int> 
+                        </void> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo1"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo1"/> 
+                    </void> 
+                    <void property="value"> 
+                     <int>0</int> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
                 </void> 
-                <void method="add"> 
-                 <string>_col1</string> 
+                <void property="typeInfo"> 
+                 <object idref="PrimitiveTypeInfo2"/> 
                 </void> 
                </object> 
               </void> 
-              <void property="selectStar"> 
-               <boolean>true</boolean> 
-              </void> 
              </object> 
             </void> 
             <void property="parentOperators"> 
@@ -670,21 +984,21 @@
             <void property="schema"> 
              <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
               <void property="signature"> 
-               <object class="java.util.Vector"> 
+               <object id="Vector0" class="java.util.Vector"> 
                 <void method="add"> 
                  <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                   <void property="internalName"> 
-                   <string>_col0</string> 
+                   <string>key</string> 
                   </void> 
                   <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
+                   <object idref="PrimitiveTypeInfo1"/> 
                   </void> 
                  </object> 
                 </void> 
                 <void method="add"> 
                  <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                   <void property="internalName"> 
-                   <string>_col1</string> 
+                   <string>value</string> 
                   </void> 
                   <void property="type"> 
                    <object idref="PrimitiveTypeInfo0"/> 
@@ -712,28 +1026,7 @@
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
           <void property="signature"> 
-           <object class="java.util.Vector"> 
-            <void method="add"> 
-             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-              <void property="internalName"> 
-               <string>key</string> 
-              </void> 
-              <void property="type"> 
-               <object idref="PrimitiveTypeInfo0"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void method="add"> 
-             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-              <void property="internalName"> 
-               <string>value</string> 
-              </void> 
-              <void property="type"> 
-               <object idref="PrimitiveTypeInfo0"/> 
-              </void> 
-             </object> 
-            </void> 
-           </object> 
+           <object idref="Vector0"/> 
           </void> 
          </object> 
         </void> 
@@ -744,7 +1037,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/srcbucket/kv1.txt</string> 
+       <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>s</string> 
@@ -756,7 +1049,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/srcbucket/kv1.txt</string> 
+       <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/sample5.q.xml b/ql/src/test/results/compiler/plan/sample5.q.xml
index d3fc7e1c6f..e44e671a5e 100644
--- a/ql/src/test/results/compiler/plan/sample5.q.xml
+++ b/ql/src/test/results/compiler/plan/sample5.q.xml
@@ -30,7 +30,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1150927183/10000</string> 
+               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/846885962/10000</string> 
               </void> 
               <void property="table"> 
                <object id="tableDesc0" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -83,7 +83,7 @@
                   </void> 
                   <void method="put"> 
                    <string>location</string> 
-                   <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/dest1</string> 
+                   <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/dest1</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -93,7 +93,7 @@
                </object> 
               </void> 
               <void property="tmpDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1150927183/10001</string> 
+               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/846885962/10001</string> 
               </void> 
              </object> 
             </void> 
@@ -121,10 +121,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1799249456/10002</string> 
+               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/922690588/10002</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1150927183/10000</string> 
+               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/846885962/10000</string> 
               </void> 
              </object> 
             </void> 
@@ -142,7 +142,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1799249456/10002</string> 
+               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/922690588/10002</string> 
                <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -342,10 +342,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1799249456/10002</string> 
+               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/922690588/10002</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1799249456/10002</string> 
+                 <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/922690588/10002</string> 
                 </void> 
                </object> 
               </void> 
@@ -354,7 +354,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1799249456/10002</string> 
+               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/922690588/10002</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object idref="tableDesc0"/> 
@@ -372,7 +372,7 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1150927183/10000</string> 
+                     <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/846885962/10000</string> 
                     </void> 
                     <void property="tableInfo"> 
                      <object idref="tableDesc0"/> 
@@ -417,7 +417,11 @@
                      <string>0</string> 
                     </void> 
                     <void property="type"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
+                     <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                      <void property="typeName"> 
+                       <string>int</string> 
+                      </void> 
+                     </object> 
                     </void> 
                    </object> 
                   </void> 
@@ -463,7 +467,7 @@
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
         <void property="dir"> 
-         <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1799249456/10002</string> 
+         <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/922690588/10002</string> 
         </void> 
         <void property="listTasks"> 
          <object idref="ArrayList0"/> 
@@ -519,7 +523,7 @@
            </void> 
            <void method="put"> 
             <string>columns.types</string> 
-            <string>string:string</string> 
+            <string>int:string</string> 
            </void> 
            <void method="put"> 
             <string>bucket_field_name</string> 
@@ -527,7 +531,7 @@
            </void> 
            <void method="put"> 
             <string>serialization.ddl</string> 
-            <string>struct srcbucket { string key, string value}</string> 
+            <string>struct srcbucket { i32 key, string value}</string> 
            </void> 
            <void method="put"> 
             <string>columns</string> 
@@ -555,7 +559,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/srcbucket</string> 
+            <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/srcbucket</string> 
            </void> 
           </object> 
          </void> 
@@ -594,7 +598,7 @@
                            <int>1</int> 
                           </void> 
                           <void property="dirName"> 
-                           <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1799249456/10002</string> 
+                           <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/922690588/10002</string> 
                           </void> 
                           <void property="tableInfo"> 
                            <object idref="tableDesc0"/> 
@@ -635,7 +639,7 @@
                          <string>key</string> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
                        </object> 
                       </void> 
@@ -685,7 +689,7 @@
                            <string>_col0</string> 
                           </void> 
                           <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
+                           <object idref="PrimitiveTypeInfo1"/> 
                           </void> 
                          </object> 
                         </void> 
@@ -779,7 +783,7 @@
                                      <string>key</string> 
                                     </void> 
                                     <void property="typeInfo"> 
-                                     <object idref="PrimitiveTypeInfo0"/> 
+                                     <object idref="PrimitiveTypeInfo1"/> 
                                     </void> 
                                    </object> 
                                   </void> 
@@ -789,11 +793,7 @@
                                  <class>org.apache.hadoop.hive.ql.udf.generic.GenericUDFHash</class> 
                                 </void> 
                                 <void property="typeInfo"> 
-                                 <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                                  <void property="typeName"> 
-                                   <string>int</string> 
-                                  </void> 
-                                 </object> 
+                                 <object idref="PrimitiveTypeInfo1"/> 
                                 </void> 
                                </object> 
                               </void> 
@@ -907,7 +907,7 @@
                                  <string>key</string> 
                                 </void> 
                                 <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo0"/> 
+                                 <object idref="PrimitiveTypeInfo1"/> 
                                 </void> 
                                </object> 
                               </void> 
@@ -991,7 +991,7 @@
                    <string>key</string> 
                   </void> 
                   <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
+                   <object idref="PrimitiveTypeInfo1"/> 
                   </void> 
                  </object> 
                 </void> 
@@ -1037,7 +1037,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/srcbucket</string> 
+       <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/srcbucket</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>s</string> 
@@ -1049,7 +1049,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/srcbucket</string> 
+       <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/srcbucket</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/sample6.q.xml b/ql/src/test/results/compiler/plan/sample6.q.xml
index 5e783efc4c..1e7ac64550 100644
--- a/ql/src/test/results/compiler/plan/sample6.q.xml
+++ b/ql/src/test/results/compiler/plan/sample6.q.xml
@@ -30,7 +30,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1043217121/10000</string> 
+               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1218577077/10000</string> 
               </void> 
               <void property="table"> 
                <object id="tableDesc0" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -83,7 +83,7 @@
                   </void> 
                   <void method="put"> 
                    <string>location</string> 
-                   <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/dest1</string> 
+                   <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/dest1</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -93,7 +93,7 @@
                </object> 
               </void> 
               <void property="tmpDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1043217121/10001</string> 
+               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1218577077/10001</string> 
               </void> 
              </object> 
             </void> 
@@ -121,10 +121,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1143415033/10002</string> 
+               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/2128074916/10002</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1043217121/10000</string> 
+               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1218577077/10000</string> 
               </void> 
              </object> 
             </void> 
@@ -142,7 +142,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1143415033/10002</string> 
+               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/2128074916/10002</string> 
                <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -342,10 +342,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1143415033/10002</string> 
+               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/2128074916/10002</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1143415033/10002</string> 
+                 <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/2128074916/10002</string> 
                 </void> 
                </object> 
               </void> 
@@ -354,7 +354,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1143415033/10002</string> 
+               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/2128074916/10002</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object idref="tableDesc0"/> 
@@ -372,7 +372,7 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1043217121/10000</string> 
+                     <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1218577077/10000</string> 
                     </void> 
                     <void property="tableInfo"> 
                      <object idref="tableDesc0"/> 
@@ -417,7 +417,11 @@
                      <string>0</string> 
                     </void> 
                     <void property="type"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
+                     <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                      <void property="typeName"> 
+                       <string>int</string> 
+                      </void> 
+                     </object> 
                     </void> 
                    </object> 
                   </void> 
@@ -463,7 +467,7 @@
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
         <void property="dir"> 
-         <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1143415033/10002</string> 
+         <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/2128074916/10002</string> 
         </void> 
         <void property="listTasks"> 
          <object idref="ArrayList0"/> 
@@ -519,7 +523,7 @@
            </void> 
            <void method="put"> 
             <string>columns.types</string> 
-            <string>string:string</string> 
+            <string>int:string</string> 
            </void> 
            <void method="put"> 
             <string>bucket_field_name</string> 
@@ -527,7 +531,7 @@
            </void> 
            <void method="put"> 
             <string>serialization.ddl</string> 
-            <string>struct srcbucket { string key, string value}</string> 
+            <string>struct srcbucket { i32 key, string value}</string> 
            </void> 
            <void method="put"> 
             <string>columns</string> 
@@ -555,7 +559,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/srcbucket</string> 
+            <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/srcbucket</string> 
            </void> 
           </object> 
          </void> 
@@ -594,7 +598,7 @@
                            <int>1</int> 
                           </void> 
                           <void property="dirName"> 
-                           <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1143415033/10002</string> 
+                           <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/2128074916/10002</string> 
                           </void> 
                           <void property="tableInfo"> 
                            <object idref="tableDesc0"/> 
@@ -635,7 +639,7 @@
                          <string>key</string> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
                        </object> 
                       </void> 
@@ -685,7 +689,7 @@
                            <string>_col0</string> 
                           </void> 
                           <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
+                           <object idref="PrimitiveTypeInfo1"/> 
                           </void> 
                          </object> 
                         </void> 
@@ -779,7 +783,7 @@
                                      <string>key</string> 
                                     </void> 
                                     <void property="typeInfo"> 
-                                     <object idref="PrimitiveTypeInfo0"/> 
+                                     <object idref="PrimitiveTypeInfo1"/> 
                                     </void> 
                                    </object> 
                                   </void> 
@@ -789,11 +793,7 @@
                                  <class>org.apache.hadoop.hive.ql.udf.generic.GenericUDFHash</class> 
                                 </void> 
                                 <void property="typeInfo"> 
-                                 <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                                  <void property="typeName"> 
-                                   <string>int</string> 
-                                  </void> 
-                                 </object> 
+                                 <object idref="PrimitiveTypeInfo1"/> 
                                 </void> 
                                </object> 
                               </void> 
@@ -907,7 +907,7 @@
                                  <string>key</string> 
                                 </void> 
                                 <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo0"/> 
+                                 <object idref="PrimitiveTypeInfo1"/> 
                                 </void> 
                                </object> 
                               </void> 
@@ -991,7 +991,7 @@
                    <string>key</string> 
                   </void> 
                   <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
+                   <object idref="PrimitiveTypeInfo1"/> 
                   </void> 
                  </object> 
                 </void> 
@@ -1037,7 +1037,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/srcbucket/kv1.txt</string> 
+       <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>s</string> 
@@ -1049,7 +1049,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/srcbucket/kv1.txt</string> 
+       <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/sample7.q.xml b/ql/src/test/results/compiler/plan/sample7.q.xml
index 501d3ab121..0f61ceed36 100644
--- a/ql/src/test/results/compiler/plan/sample7.q.xml
+++ b/ql/src/test/results/compiler/plan/sample7.q.xml
@@ -30,7 +30,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/2139697288/10000</string> 
+               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/598613180/10000</string> 
               </void> 
               <void property="table"> 
                <object id="tableDesc0" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -83,7 +83,7 @@
                   </void> 
                   <void method="put"> 
                    <string>location</string> 
-                   <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/dest1</string> 
+                   <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/dest1</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -93,7 +93,7 @@
                </object> 
               </void> 
               <void property="tmpDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/2139697288/10001</string> 
+               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/598613180/10001</string> 
               </void> 
              </object> 
             </void> 
@@ -121,10 +121,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1309167553/10002</string> 
+               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/775500580/10002</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/2139697288/10000</string> 
+               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/598613180/10000</string> 
               </void> 
              </object> 
             </void> 
@@ -142,7 +142,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1309167553/10002</string> 
+               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/775500580/10002</string> 
                <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -215,7 +215,7 @@
                            <object class="java.util.ArrayList"/> 
                           </void> 
                           <void property="typeInfo"> 
-                           <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                           <object class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
                             <void property="typeName"> 
                              <string>double</string> 
                             </void> 
@@ -236,7 +236,7 @@
                            <string>key</string> 
                           </void> 
                           <void property="typeInfo"> 
-                           <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                           <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
                             <void property="typeName"> 
                              <string>string</string> 
                             </void> 
@@ -250,7 +250,7 @@
                            <string>value</string> 
                           </void> 
                           <void property="typeInfo"> 
-                           <object idref="PrimitiveTypeInfo1"/> 
+                           <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
                          </object> 
                         </void> 
@@ -304,7 +304,7 @@
                            <string>key</string> 
                           </void> 
                           <void property="type"> 
-                           <object idref="PrimitiveTypeInfo1"/> 
+                           <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
                          </object> 
                         </void> 
@@ -314,7 +314,7 @@
                            <string>value</string> 
                           </void> 
                           <void property="type"> 
-                           <object idref="PrimitiveTypeInfo1"/> 
+                           <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
                          </object> 
                         </void> 
@@ -342,10 +342,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1309167553/10002</string> 
+               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/775500580/10002</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1309167553/10002</string> 
+                 <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/775500580/10002</string> 
                 </void> 
                </object> 
               </void> 
@@ -354,7 +354,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1309167553/10002</string> 
+               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/775500580/10002</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object idref="tableDesc0"/> 
@@ -372,7 +372,7 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/2139697288/10000</string> 
+                     <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/598613180/10000</string> 
                     </void> 
                     <void property="tableInfo"> 
                      <object idref="tableDesc0"/> 
@@ -401,7 +401,7 @@
                    <string>VALUE</string> 
                   </void> 
                   <void property="typeInfo"> 
-                   <object idref="PrimitiveTypeInfo1"/> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
@@ -417,7 +417,11 @@
                      <string>0</string> 
                     </void> 
                     <void property="type"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
+                     <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                      <void property="typeName"> 
+                       <string>int</string> 
+                      </void> 
+                     </object> 
                     </void> 
                    </object> 
                   </void> 
@@ -427,7 +431,7 @@
                      <string>1</string> 
                     </void> 
                     <void property="type"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
                    </object> 
                   </void> 
@@ -463,7 +467,7 @@
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
         <void property="dir"> 
-         <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1309167553/10002</string> 
+         <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/775500580/10002</string> 
         </void> 
         <void property="listTasks"> 
          <object idref="ArrayList0"/> 
@@ -519,7 +523,7 @@
            </void> 
            <void method="put"> 
             <string>columns.types</string> 
-            <string>string:string</string> 
+            <string>int:string</string> 
            </void> 
            <void method="put"> 
             <string>bucket_field_name</string> 
@@ -527,7 +531,7 @@
            </void> 
            <void method="put"> 
             <string>serialization.ddl</string> 
-            <string>struct srcbucket { string key, string value}</string> 
+            <string>struct srcbucket { i32 key, string value}</string> 
            </void> 
            <void method="put"> 
             <string>columns</string> 
@@ -555,7 +559,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/srcbucket</string> 
+            <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/srcbucket</string> 
            </void> 
           </object> 
          </void> 
@@ -598,7 +602,7 @@
                                <int>1</int> 
                               </void> 
                               <void property="dirName"> 
-                               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1309167553/10002</string> 
+                               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/775500580/10002</string> 
                               </void> 
                               <void property="tableInfo"> 
                                <object idref="tableDesc0"/> 
@@ -628,7 +632,7 @@
                              <string>value</string> 
                             </void> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
+                             <object idref="PrimitiveTypeInfo0"/> 
                             </void> 
                            </object> 
                           </void> 
@@ -699,7 +703,7 @@
                                <string>_col1</string> 
                               </void> 
                               <void property="type"> 
-                               <object idref="PrimitiveTypeInfo1"/> 
+                               <object idref="PrimitiveTypeInfo0"/> 
                               </void> 
                              </object> 
                             </void> 
@@ -723,10 +727,10 @@
                           <string>evaluate</string> 
                           <array class="java.lang.Class" length="2"> 
                            <void index="0"> 
-                            <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
+                            <class>org.apache.hadoop.io.IntWritable</class> 
                            </void> 
                            <void index="1"> 
-                            <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
+                            <class>org.apache.hadoop.io.IntWritable</class> 
                            </void> 
                           </array> 
                          </object> 
@@ -734,81 +738,29 @@
                         <void property="childExprs"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                            <void property="UDFClass"> 
-                             <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
-                            </void> 
-                            <void property="UDFMethod"> 
-                             <object id="Method1" class="org.apache.hadoop.hive.ql.udf.UDFToDouble" method="getMethod"> 
-                              <string>evaluate</string> 
-                              <array class="java.lang.Class" length="1"> 
-                               <void index="0"> 
-                                <class>org.apache.hadoop.io.Text</class> 
-                               </void> 
-                              </array> 
-                             </object> 
-                            </void> 
-                            <void property="childExprs"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                                <void property="column"> 
-                                 <string>key</string> 
-                                </void> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo1"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
+                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                            <void property="column"> 
+                             <string>key</string> 
                             </void> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                            </object> 
                           </void> 
                           <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                            <void property="UDFClass"> 
-                             <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
-                            </void> 
-                            <void property="UDFMethod"> 
-                             <object id="Method2" class="org.apache.hadoop.hive.ql.udf.UDFToDouble" method="getMethod"> 
-                              <string>evaluate</string> 
-                              <array class="java.lang.Class" length="1"> 
-                               <void index="0"> 
-                                <class>org.apache.hadoop.io.IntWritable</class> 
-                               </void> 
-                              </array> 
-                             </object> 
-                            </void> 
-                            <void property="childExprs"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
-                                <void property="typeInfo"> 
-                                 <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                                  <void property="typeName"> 
-                                   <string>int</string> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void property="value"> 
-                                 <int>100</int> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
+                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
+                            </void> 
+                            <void property="value"> 
+                             <int>100</int> 
                             </void> 
                            </object> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo3" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                         <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
                           <void property="typeName"> 
                            <string>boolean</string> 
                           </void> 
@@ -845,7 +797,7 @@
                            <string>value</string> 
                           </void> 
                           <void property="type"> 
-                           <object idref="PrimitiveTypeInfo1"/> 
+                           <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
                          </object> 
                         </void> 
@@ -865,7 +817,7 @@
                      <class>org.apache.hadoop.hive.ql.udf.UDFOPEqual</class> 
                     </void> 
                     <void property="UDFMethod"> 
-                     <object id="Method3" class="org.apache.hadoop.hive.ql.udf.UDFOPEqual" method="getMethod"> 
+                     <object id="Method1" class="org.apache.hadoop.hive.ql.udf.UDFOPEqual" method="getMethod"> 
                       <string>evaluate</string> 
                       <array class="java.lang.Class" length="2"> 
                        <void index="0"> 
@@ -885,7 +837,7 @@
                          <class>org.apache.hadoop.hive.ql.udf.UDFOPMod</class> 
                         </void> 
                         <void property="UDFMethod"> 
-                         <object id="Method4" class="org.apache.hadoop.hive.ql.udf.UDFOPMod" method="getMethod"> 
+                         <object id="Method2" class="org.apache.hadoop.hive.ql.udf.UDFOPMod" method="getMethod"> 
                           <string>evaluate</string> 
                           <array class="java.lang.Class" length="2"> 
                            <void index="0"> 
@@ -905,7 +857,7 @@
                              <class>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</class> 
                             </void> 
                             <void property="UDFMethod"> 
-                             <object id="Method5" class="org.apache.hadoop.hive.ql.udf.UDFOPBitAnd" method="getMethod"> 
+                             <object id="Method3" class="org.apache.hadoop.hive.ql.udf.UDFOPBitAnd" method="getMethod"> 
                               <string>evaluate</string> 
                               <array class="java.lang.Class" length="2"> 
                                <void index="0"> 
@@ -939,14 +891,14 @@
                                  <class>org.apache.hadoop.hive.ql.udf.generic.GenericUDFHash</class> 
                                 </void> 
                                 <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo2"/> 
+                                 <object idref="PrimitiveTypeInfo1"/> 
                                 </void> 
                                </object> 
                               </void> 
                               <void method="add"> 
                                <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                                 <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo2"/> 
+                                 <object idref="PrimitiveTypeInfo1"/> 
                                 </void> 
                                 <void property="value"> 
                                  <int>2147483647</int> 
@@ -956,14 +908,14 @@
                              </object> 
                             </void> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo2"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                            </object> 
                           </void> 
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo2"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                             <void property="value"> 
                              <int>4</int> 
@@ -973,14 +925,14 @@
                          </object> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo2"/> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
                        </object> 
                       </void> 
                       <void method="add"> 
                        <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo2"/> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
                         <void property="value"> 
                          <int>0</int> 
@@ -990,7 +942,7 @@
                      </object> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo3"/> 
+                     <object idref="PrimitiveTypeInfo2"/> 
                     </void> 
                    </object> 
                   </void> 
@@ -1035,7 +987,7 @@
                      <class>org.apache.hadoop.hive.ql.udf.UDFOPEqual</class> 
                     </void> 
                     <void property="UDFMethod"> 
-                     <object idref="Method3"/> 
+                     <object idref="Method1"/> 
                     </void> 
                     <void property="childExprs"> 
                      <object class="java.util.ArrayList"> 
@@ -1045,7 +997,7 @@
                          <class>org.apache.hadoop.hive.ql.udf.UDFOPMod</class> 
                         </void> 
                         <void property="UDFMethod"> 
-                         <object idref="Method4"/> 
+                         <object idref="Method2"/> 
                         </void> 
                         <void property="childExprs"> 
                          <object class="java.util.ArrayList"> 
@@ -1055,7 +1007,7 @@
                              <class>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</class> 
                             </void> 
                             <void property="UDFMethod"> 
-                             <object idref="Method5"/> 
+                             <object idref="Method3"/> 
                             </void> 
                             <void property="childExprs"> 
                              <object class="java.util.ArrayList"> 
@@ -1079,14 +1031,14 @@
                                  <class>org.apache.hadoop.hive.ql.udf.generic.GenericUDFHash</class> 
                                 </void> 
                                 <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo2"/> 
+                                 <object idref="PrimitiveTypeInfo1"/> 
                                 </void> 
                                </object> 
                               </void> 
                               <void method="add"> 
                                <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                                 <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo2"/> 
+                                 <object idref="PrimitiveTypeInfo1"/> 
                                 </void> 
                                 <void property="value"> 
                                  <int>2147483647</int> 
@@ -1096,14 +1048,14 @@
                              </object> 
                             </void> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo2"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                            </object> 
                           </void> 
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo2"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                             <void property="value"> 
                              <int>4</int> 
@@ -1113,14 +1065,14 @@
                          </object> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo2"/> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
                        </object> 
                       </void> 
                       <void method="add"> 
                        <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo2"/> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
                         <void property="value"> 
                          <int>0</int> 
@@ -1130,7 +1082,7 @@
                      </object> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo3"/> 
+                     <object idref="PrimitiveTypeInfo2"/> 
                     </void> 
                    </object> 
                   </void> 
@@ -1145,70 +1097,36 @@
                     <void property="childExprs"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                        <void property="UDFClass"> 
-                         <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
-                        </void> 
-                        <void property="UDFMethod"> 
-                         <object idref="Method1"/> 
-                        </void> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>key</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
+                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                        <void property="column"> 
+                         <string>key</string> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
                        </object> 
                       </void> 
                       <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                        <void property="UDFClass"> 
-                         <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
-                        </void> 
-                        <void property="UDFMethod"> 
-                         <object idref="Method2"/> 
-                        </void> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo2"/> 
-                            </void> 
-                            <void property="value"> 
-                             <int>100</int> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
+                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
+                         <object idref="PrimitiveTypeInfo1"/> 
+                        </void> 
+                        <void property="value"> 
+                         <int>100</int> 
                         </void> 
                        </object> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo3"/> 
+                     <object idref="PrimitiveTypeInfo2"/> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo3"/> 
+                 <object idref="PrimitiveTypeInfo2"/> 
                 </void> 
                </object> 
               </void> 
@@ -1256,7 +1174,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/srcbucket/kv1.txt</string> 
+       <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>s</string> 
@@ -1268,7 +1186,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/srcbucket/kv1.txt</string> 
+       <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
