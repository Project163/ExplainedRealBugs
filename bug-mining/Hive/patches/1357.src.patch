diff --git a/testutils/ptest2/README.md b/testutils/ptest2/README.md
index a483851ad6..6c11c4a1f5 100644
--- a/testutils/ptest2/README.md
+++ b/testutils/ptest2/README.md
@@ -25,10 +25,10 @@ On all slaves add the following to /etc/ssh/sshd_config:
     MaxSessions 100
     MaxStartups 100
 
-# Install git, java, ant, and maven
+# Install git, svn, make, patch, java, ant, and maven
 
-Recent version os java, ant and maven should be installed. Additionally environment variables
-such as MAVEN_OPTS and ANT_OPTS should be configured with large leap sizes:
+Recent version of git, svn, make, patch, java, ant and maven should be installed. Additionally
+environment variables such as MAVEN_OPTS and ANT_OPTS should be configured with large leap sizes:
 
     $ for item in java maven ant; do echo $item; cat /etc/profile.d/${item}.sh;done
     java
@@ -73,7 +73,8 @@ Ensure the user running the tests has strict host/key checking disabled:
 
    $ cat ~/.ssh/config
    StrictHostKeyChecking no
-
+   ConnectTimeout 20
+   ServerAliveInterval 1
 
 # Configure properties file
 
@@ -82,4 +83,4 @@ See conf/example-apache-trunk.properties
 # Execute
 
     mvn dependency:copy-dependencies
-    java -Xms4g -Xmx4g -cp "conf/:/home/hiveptest/hive-ptest/target/hive-test-1.0.jar:target/dependency/*" org.apache.hive.ptest.RunTests --properties apache-trunk.properties
+    java -Xms4g -Xmx4g -cp "target/hive-ptest-1.0-classes.jar:target/dependency/*" org.apache.hive.ptest.execution.PTest --properties apache-trunk.properties
diff --git a/testutils/ptest2/src/main/java/org/apache/hive/ptest/api/client/PTestClient.java b/testutils/ptest2/src/main/java/org/apache/hive/ptest/api/client/PTestClient.java
index d6e9ce3a79..89c2c998e9 100644
--- a/testutils/ptest2/src/main/java/org/apache/hive/ptest/api/client/PTestClient.java
+++ b/testutils/ptest2/src/main/java/org/apache/hive/ptest/api/client/PTestClient.java
@@ -80,6 +80,7 @@ public class PTestClient {
   private static final String JIRA = "jira";
   private static final String OUTPUT_DIR = "outputDir";
   private static final String TEST_HANDLE = "testHandle";
+  private static final String CLEAR_LIBRARY_CACHE = "clearLibraryCache";
   private final String mApiEndPoint;
   private final String mLogsEndpoint;
   private final ObjectMapper mMapper;
@@ -102,7 +103,7 @@ public PTestClient(String endPoint, String password)
         new UsernamePasswordCredentials("hive", password));
   }
   public boolean testStart(String profile, String testHandle,
-      String jira, String patch, String testOutputDir)
+      String jira, String patch, String testOutputDir, boolean clearLibraryCache)
   throws Exception {
     patch = Strings.nullToEmpty(patch).trim();
     if(!patch.isEmpty()) {
@@ -111,7 +112,7 @@ public boolean testStart(String profile, String testHandle,
         throw new IllegalArgumentException("Patch " + patch + " was zero bytes");
       }
     }
-    TestStartRequest startRequest = new TestStartRequest(profile, testHandle, jira, patch);
+    TestStartRequest startRequest = new TestStartRequest(profile, testHandle, jira, patch, clearLibraryCache);
     post(startRequest);
     boolean result = false;
     try {
@@ -256,7 +257,8 @@ public static void main(String[] args) throws Exception {
     options.addOption(null, JIRA, true, "JIRA to post the results to e.g.: HIVE-XXXX");
     options.addOption(null, TEST_HANDLE, true, "Server supplied test handle. (Required for testStop and testTailLog)");
     options.addOption(null, OUTPUT_DIR, true, "Directory to download and save test-results.tar.gz to. (Optional for testStart)");
-
+    options.addOption(null, CLEAR_LIBRARY_CACHE, false, "Before starting the test, delete the ivy and maven directories (Optional for testStart)");
+    
     CommandLine commandLine = parser.parse(options, args);
 
     if(commandLine.hasOption(HELP_SHORT)) {
@@ -278,7 +280,8 @@ public static void main(String[] args) throws Exception {
           TEST_HANDLE
         });
       result = client.testStart(commandLine.getOptionValue(PROFILE), commandLine.getOptionValue(TEST_HANDLE),
-          commandLine.getOptionValue(JIRA), commandLine.getOptionValue(PATCH), commandLine.getOptionValue(OUTPUT_DIR));
+          commandLine.getOptionValue(JIRA), commandLine.getOptionValue(PATCH), commandLine.getOptionValue(OUTPUT_DIR),
+          commandLine.hasOption(CLEAR_LIBRARY_CACHE));
     } else if("testTailLog".equalsIgnoreCase(command)) {
       result = client.testTailLog(commandLine.getOptionValue(TEST_HANDLE));
     } else if("testList".equalsIgnoreCase(command)) {
diff --git a/testutils/ptest2/src/main/java/org/apache/hive/ptest/api/request/TestStartRequest.java b/testutils/ptest2/src/main/java/org/apache/hive/ptest/api/request/TestStartRequest.java
index b41726ad7f..31aaa1de59 100644
--- a/testutils/ptest2/src/main/java/org/apache/hive/ptest/api/request/TestStartRequest.java
+++ b/testutils/ptest2/src/main/java/org/apache/hive/ptest/api/request/TestStartRequest.java
@@ -23,16 +23,18 @@ public class TestStartRequest {
   private String testHandle;
   private String patchURL;
   private String jiraName;
+  private boolean clearLibraryCache;
 
   public TestStartRequest() {
 
   }
   public TestStartRequest(String profile, String testHandle, 
-      String jiraName, String patchURL) {
+      String jiraName, String patchURL, boolean clearLibraryCache) {
     this.profile = profile;
     this.testHandle = testHandle;
     this.jiraName = jiraName;
     this.patchURL = patchURL;
+    this.clearLibraryCache = clearLibraryCache;
   }
   public String getProfile() {
     return profile;
@@ -45,8 +47,13 @@ public String getPatchURL() {
   }
   public void setPatchURL(String patchURL) {
     this.patchURL = patchURL;
+  }  
+  public boolean isClearLibraryCache() {
+    return clearLibraryCache;
+  }
+  public void setClearLibraryCache(boolean clearLibraryCache) {
+    this.clearLibraryCache = clearLibraryCache;
   }
-  
   public String getJiraName() {
     return jiraName;
   }
@@ -64,6 +71,6 @@ public void setTestHandle(String testHandle) {
   public String toString() {
     return "TestStartRequest [profile=" + profile + ", testHandle="
         + testHandle + ", patchURL=" + patchURL + ", jiraName=" + jiraName
-        + "]";
+        + ", clearLibraryCache=" + clearLibraryCache + "]";
   }
 }
diff --git a/testutils/ptest2/src/main/java/org/apache/hive/ptest/api/server/TestExecutor.java b/testutils/ptest2/src/main/java/org/apache/hive/ptest/api/server/TestExecutor.java
index 9b2125c130..14b22d31be 100644
--- a/testutils/ptest2/src/main/java/org/apache/hive/ptest/api/server/TestExecutor.java
+++ b/testutils/ptest2/src/main/java/org/apache/hive/ptest/api/server/TestExecutor.java
@@ -110,6 +110,7 @@ public void run() {
             TestConfiguration testConfiguration = TestConfiguration.fromFile(profileConfFile, logger);
             testConfiguration.setPatch(startRequest.getPatchURL());
             testConfiguration.setJiraName(startRequest.getJiraName());
+            testConfiguration.setClearLibraryCache(startRequest.isClearLibraryCache());
             PTest ptest = mPTestBuilder.build(testConfiguration, mExecutionContext,
                 test.getStartRequest().getTestHandle(), logDir,
                 new LocalCommandFactory(logger), new SSHCommandExecutor(logger),
diff --git a/testutils/ptest2/src/main/java/org/apache/hive/ptest/execution/ExecutionPhase.java b/testutils/ptest2/src/main/java/org/apache/hive/ptest/execution/ExecutionPhase.java
index b5d79095d9..6260bda2af 100644
--- a/testutils/ptest2/src/main/java/org/apache/hive/ptest/execution/ExecutionPhase.java
+++ b/testutils/ptest2/src/main/java/org/apache/hive/ptest/execution/ExecutionPhase.java
@@ -20,8 +20,8 @@
 
 import java.io.File;
 import java.io.IOException;
-import java.util.ArrayList;
 import java.util.Collections;
+import java.util.HashSet;
 import java.util.List;
 import java.util.Set;
 import java.util.concurrent.BlockingQueue;
@@ -41,31 +41,38 @@
 
 public class ExecutionPhase extends Phase {
 
+  private final File succeededLogDir;
   private final File failedLogDir;
   private final BlockingQueue<TestBatch> parallelWorkQueue;
   private final BlockingQueue<TestBatch> isolatedWorkQueue;
+  private final Set<String> executedTests;
   private final Set<String> failedTests;
   private final Supplier<List<TestBatch>> testBatchSupplier;
-  private final List<TestBatch> failedTestResults;
+  private final Set<TestBatch> failedTestResults;
 
   public ExecutionPhase(ImmutableList<HostExecutor> hostExecutors,
       LocalCommandFactory localCommandFactory,
       ImmutableMap<String, String> templateDefaults,
-      File failedLogDir, Supplier<List<TestBatch>> testBatchSupplier,
-      Set<String> failedTests, Logger logger) throws IOException {
+      File succeededLogDir, File failedLogDir, Supplier<List<TestBatch>> testBatchSupplier,
+      Set<String> executedTests, Set<String> failedTests, Logger logger)
+          throws IOException {
     super(hostExecutors, localCommandFactory, templateDefaults, logger);
+    this.succeededLogDir = succeededLogDir;
     this.failedLogDir = failedLogDir;
     this.testBatchSupplier = testBatchSupplier;
+    this.executedTests = executedTests;
     this.failedTests = failedTests;
     this.parallelWorkQueue = new LinkedBlockingQueue<TestBatch>();
     this.isolatedWorkQueue = new LinkedBlockingQueue<TestBatch>();
     this.failedTestResults = Collections.
-        synchronizedList(new ArrayList<TestBatch>());
+        synchronizedSet(new HashSet<TestBatch>());
   }
   @Override
 public void execute() throws Throwable {
     long start = System.currentTimeMillis();
+    List<TestBatch> testBatches = Lists.newArrayList();
     for(TestBatch batch : testBatchSupplier.get()) {
+      testBatches.add(batch);
       if(batch.isParallel()) {
         parallelWorkQueue.add(batch);
       } else {
@@ -74,16 +81,17 @@ public void execute() throws Throwable {
     }
     try {
       do {
-        double numberBadHosts = 0d;
+        float numberBadHosts = 0f;
         for(HostExecutor hostExecutor : hostExecutors) {
           if(hostExecutor.remainingDrones() == 0) {
             numberBadHosts++;
           }
         }
         Preconditions.checkState(hostExecutors.size() > 0, "Host executors cannot be empty");
-        if((numberBadHosts / (double)hostExecutors.size()) > 0.30d) {
-          throw new IllegalStateException("Too many bad hosts: " + (int)numberBadHosts + 
-              " bad hosts out of " + hostExecutors.size() + " is greater than threshold of 30%");
+        float percentBadHosts = numberBadHosts / (float)hostExecutors.size();
+        if(percentBadHosts > 0.50f) {
+          throw new IllegalStateException("Too many bad hosts: " + percentBadHosts + "% (" + (int)numberBadHosts + 
+              " / " + hostExecutors.size() + ") is greater than threshold of 50%");
         }
         List<ListenableFuture<Void>> results = Lists.newArrayList();
         for(HostExecutor hostExecutor : getHostExecutors()) {
@@ -93,14 +101,16 @@ public void execute() throws Throwable {
       } while(!(parallelWorkQueue.isEmpty() && isolatedWorkQueue.isEmpty()));
       Preconditions.checkState(parallelWorkQueue.isEmpty(), "Parallel work queue is not empty. All drones must have aborted.");
       Preconditions.checkState(isolatedWorkQueue.isEmpty(), "Isolated work queue is not empty. All drones must have aborted.");
-      if(!failedTestResults.isEmpty()) {
-        for(TestBatch failure : failedTestResults) {
-          File batchLogDir = new File(failedLogDir, failure.getName());
-          JUnitReportParser parser = new JUnitReportParser(logger, batchLogDir);
-          for(String failedTest : parser.getFailedTests()) {
-            failedTests.add(failedTest);
-          }
-        }
+      for(TestBatch batch : testBatches) {
+       File batchLogDir;
+       if(failedTestResults.contains(batch)) {
+         batchLogDir = new File(failedLogDir, batch.getName());
+       } else {
+         batchLogDir = new File(succeededLogDir, batch.getName());
+       }
+       JUnitReportParser parser = new JUnitReportParser(logger, batchLogDir);
+       executedTests.addAll(parser.getExecutedTests());
+       failedTests.addAll(parser.getFailedTests());
       }
     } finally {
       long elapsed = System.currentTimeMillis() - start;
diff --git a/testutils/ptest2/src/main/java/org/apache/hive/ptest/execution/HostExecutor.java b/testutils/ptest2/src/main/java/org/apache/hive/ptest/execution/HostExecutor.java
index 34a087ceb1..62bc1ad662 100644
--- a/testutils/ptest2/src/main/java/org/apache/hive/ptest/execution/HostExecutor.java
+++ b/testutils/ptest2/src/main/java/org/apache/hive/ptest/execution/HostExecutor.java
@@ -23,6 +23,7 @@
 import java.io.PrintWriter;
 import java.util.List;
 import java.util.Map;
+import java.util.Set;
 import java.util.concurrent.BlockingQueue;
 import java.util.concurrent.Callable;
 import java.util.concurrent.CopyOnWriteArrayList;
@@ -91,7 +92,7 @@ class HostExecutor {
    * @return failed tests
    */
   ListenableFuture<Void> submitTests(final BlockingQueue<TestBatch> parallelWorkQueue,
-      final BlockingQueue<TestBatch> isolatedWorkQueue, final List<TestBatch> failedTestResults) {
+      final BlockingQueue<TestBatch> isolatedWorkQueue, final Set<TestBatch> failedTestResults) {
     return mExecutor.submit(new Callable<Void>() {
       @Override
       public Void call() throws Exception {
@@ -116,7 +117,7 @@ Host getHost() {
    * are removed the host will be replaced before the next run.
    */
   private void executeTests(final BlockingQueue<TestBatch> parallelWorkQueue,
-      final BlockingQueue<TestBatch> isolatedWorkQueue, final List<TestBatch> failedTestResults)
+      final BlockingQueue<TestBatch> isolatedWorkQueue, final Set<TestBatch> failedTestResults)
           throws Exception {
     mLogger.info("Starting parallel execution on " + mHost.getName());
     List<ListenableFuture<Void>> droneResults = Lists.newArrayList();
@@ -129,7 +130,7 @@ public Void call() throws Exception {
             do {
               batch = parallelWorkQueue.poll(mNumPollSeconds, TimeUnit.SECONDS);
               if(batch != null) {
-                if(!executeTestBatch(drone, batch)) {
+                if(!executeTestBatch(drone, batch, failedTestResults.size())) {
                   failedTestResults.add(batch);
                 }
               }
@@ -154,7 +155,7 @@ public Void call() throws Exception {
         do {
           batch = isolatedWorkQueue.poll(mNumPollSeconds, TimeUnit.SECONDS);
           if(batch != null) {
-            if(!executeTestBatch(drone, batch)) {
+            if(!executeTestBatch(drone, batch, failedTestResults.size())) {
               failedTestResults.add(batch);
             }
           }
@@ -173,7 +174,7 @@ public Void call() throws Exception {
    * Executes the test batch on the drone in question. If the command
    * exits with a status code of 255 throw an AbortDroneException.
    */
-  private boolean executeTestBatch(Drone drone, TestBatch batch)
+  private boolean executeTestBatch(Drone drone, TestBatch batch, int numOfFailedTests)
       throws IOException, SSHExecutionException, AbortDroneException {
     String scriptName = "hiveptest-" + batch.getName() + ".sh";
     File script = new File(mLocalScratchDirectory, scriptName);
@@ -183,6 +184,7 @@ private boolean executeTestBatch(Drone drone, TestBatch batch)
     templateVariables.put("testArguments", batch.getTestArguments());
     templateVariables.put("localDir", drone.getLocalDirectory());
     templateVariables.put("logDir", drone.getLocalLogDirectory());
+    templateVariables.put("numOfFailedTests", String.valueOf(numOfFailedTests));
     String command = Templates.getTemplateResult("bash $localDir/$instanceName/scratch/" + script.getName(),
         templateVariables);
     Templates.writeTemplateResult("batch-exec.vm", script, templateVariables);
@@ -347,4 +349,4 @@ public SSHResult call() throws Exception {
     }
     return result;
   }
-}
\ No newline at end of file
+}
diff --git a/testutils/ptest2/src/main/java/org/apache/hive/ptest/execution/JIRAService.java b/testutils/ptest2/src/main/java/org/apache/hive/ptest/execution/JIRAService.java
index 09c6d66b27..50e5113b32 100644
--- a/testutils/ptest2/src/main/java/org/apache/hive/ptest/execution/JIRAService.java
+++ b/testutils/ptest2/src/main/java/org/apache/hive/ptest/execution/JIRAService.java
@@ -21,8 +21,11 @@
 import java.io.IOException;
 import java.net.URL;
 import java.util.List;
+import java.util.Map;
 import java.util.Set;
 
+import org.apache.hive.ptest.api.server.TestLogger;
+import org.apache.hive.ptest.execution.conf.Context;
 import org.apache.hive.ptest.execution.conf.TestConfiguration;
 import org.apache.http.HttpException;
 import org.apache.http.HttpHost;
@@ -44,11 +47,14 @@
 import org.apache.http.protocol.BasicHttpContext;
 import org.apache.http.protocol.ExecutionContext;
 import org.apache.http.protocol.HttpContext;
+import org.codehaus.jackson.map.ObjectMapper;
 import org.slf4j.Logger;
 
 import com.google.common.annotations.VisibleForTesting;
 import com.google.common.base.Joiner;
 import com.google.common.collect.Lists;
+import com.google.common.collect.Maps;
+import com.google.common.collect.Sets;
 
 class JIRAService {
   private final Logger mLogger;
@@ -71,7 +77,7 @@ public JIRAService(Logger logger, TestConfiguration configuration, String buildT
     mJenkinsURL = configuration.getJenkinsURL();
   }
 
-  void postComment(boolean error, Set<String> failedTests,
+  void postComment(boolean error, int numExecutesTests, Set<String> failedTests,
       List<String> messages) { 
     DefaultHttpClient httpClient = new DefaultHttpClient();    
     try {
@@ -79,7 +85,11 @@ void postComment(boolean error, Set<String> failedTests,
       List<String> comments = Lists.newArrayList();
       comments.add("");
       comments.add("");
-      if (error || !failedTests.isEmpty()) {
+      if(!failedTests.isEmpty()) {
+        comments.add("{color:red}Overall{color}: -1 at least one tests failed");
+      } else if(numExecutesTests == 0) {
+        comments.add("{color:red}Overall{color}: -1 no tests executed");
+      } else if (error) {
         comments.add("{color:red}Overall{color}: -1 build exited with an error");
       } else {
         comments.add("{color:green}Overall{color}: +1 all checks pass");
@@ -90,26 +100,32 @@ void postComment(boolean error, Set<String> failedTests,
         comments.add(mPatch);
       }
       comments.add("");
-      if (failedTests.isEmpty()) {
-        comments.add(formatSuccess("+1 all tests passed"));
-      } else {
-        comments.add(formatError("-1 due to " + failedTests.size()
-            + " failed/errored test(s)"));
-        comments.add("Failed tests:");
-        comments.addAll(failedTests);
+      if(numExecutesTests > 0) {
+        if (failedTests.isEmpty()) {
+          comments.add(formatSuccess("+1 "+ numExecutesTests + " tests passed"));
+        } else {
+          comments.add(formatError("-1 due to " + failedTests.size()
+              + " failed/errored test(s), " + numExecutesTests + " tests executed"));
+          comments.add("*Failed tests:*");
+          comments.add("{noformat}");
+          comments.addAll(failedTests);
+          comments.add("{noformat}");
+        }
+        comments.add("");        
       }
-      comments.add("");
       comments.add("Test results: " + mJenkinsURL + "/" + buildTag + "/testReport");
       comments.add("Console output: " + mJenkinsURL + "/" + buildTag + "/console");
       comments.add("");
-      comments.add("Messages:");
-      for (String message : messages) {
-        comments.add(message.replaceAll("\n", "\\n"));
+      if(!messages.isEmpty()) {
+        comments.add("Messages:");
+        comments.add("{noformat}");
+        comments.addAll(messages);
+        comments.add("{noformat}");
+        comments.add("");        
       }
-      comments.add("");
       comments.add("This message is automatically generated.");
-      mLogger.info("Comment: " + Joiner.on("\n").join(comments));
-      String body = Joiner.on("\\n").join(comments);
+      mLogger.info("Comment: " + Joiner.on("\n").join(comments));      
+      String body = Joiner.on("\n").join(comments);
       String url = String.format("%s/rest/api/2/issue/%s/comment", mUrl, mName);
       URL apiURL = new URL(mUrl);
       httpClient.getCredentialsProvider()
@@ -121,8 +137,8 @@ void postComment(boolean error, Set<String> failedTests,
       localcontext.setAttribute("preemptive-auth", new BasicScheme());
       httpClient.addRequestInterceptor(new PreemptiveAuth(), 0);      
       HttpPost request = new HttpPost(url);
-      StringEntity params = new StringEntity(String.format(
-          "{\"body\": \"%s\"}", body));
+      ObjectMapper mapper = new ObjectMapper();
+      StringEntity params = new StringEntity(mapper.writeValueAsString(new Body(body)));
       request.addHeader("Content-Type", "application/json");
       request.setEntity(params);
       HttpResponse httpResponse = httpClient.execute(request, localcontext);
@@ -140,6 +156,23 @@ void postComment(boolean error, Set<String> failedTests,
     }
   }
   
+  @SuppressWarnings("unused")  
+  private static class Body {
+    private String body;
+    public Body() {
+      
+    }
+    public Body(String body) {
+      this.body = body;
+    }
+    public String getBody() {
+      return body;
+    }
+    public void setBody(String body) {
+      this.body = body;
+    }    
+  }
+  
   /**
    * Hive-Build-123 to Hive-Build/123
    */
@@ -182,4 +215,22 @@ public void process(final HttpRequest request, final HttpContext context)
       }
     }
   }
-}
\ No newline at end of file
+  
+  public static void main(String[] args) throws Exception {
+    TestLogger logger = new TestLogger(System.err, TestLogger.LEVEL.TRACE);
+    Map<String, String> context = Maps.newHashMap();
+    context.put("jiraUrl", "https://issues.apache.org/jira");
+    context.put("jiraUser", "hiveqa");
+    context.put("jiraPassword", "password goes here");
+    context.put("branch", "trunk");
+    context.put("repository", "repo");
+    context.put("repositoryName", "repoName");
+    context.put("antArgs", "-Dsome=thing");
+    TestConfiguration configuration = new TestConfiguration(new Context(context), logger);
+    configuration.setJiraName("HIVE-4892");
+    JIRAService service = new JIRAService(logger, configuration, "test-123");
+    List<String> messages = Lists.newArrayList("msg1", "msg2");
+    Set<String> failedTests = Sets.newHashSet("failed");
+    service.postComment(false, 5, failedTests, messages);
+  }
+}
diff --git a/testutils/ptest2/src/main/java/org/apache/hive/ptest/execution/JUnitReportParser.java b/testutils/ptest2/src/main/java/org/apache/hive/ptest/execution/JUnitReportParser.java
index 50cce25556..bbc149c5a7 100644
--- a/testutils/ptest2/src/main/java/org/apache/hive/ptest/execution/JUnitReportParser.java
+++ b/testutils/ptest2/src/main/java/org/apache/hive/ptest/execution/JUnitReportParser.java
@@ -36,9 +36,15 @@
 public class JUnitReportParser {
   private final File directory;
   private final Logger logger;
+  private final Set<String> executedTests;
+  private final Set<String> failedTests;
+  private boolean parsed;
   public JUnitReportParser(Logger logger, File directory) throws Exception {
     this.logger = logger;
     this.directory = directory;
+    executedTests = Sets.newHashSet();
+    failedTests =  Sets.newHashSet();
+    parsed = false;
   }
 
   private Set<File> getFiles(File directory) {
@@ -51,15 +57,26 @@ private Set<File> getFiles(File directory) {
           if(name.startsWith("TEST-") && name.endsWith(".xml")) {
             result.add(file);
           }
-        } else if(file.isDirectory()) {
-          result.addAll(getFiles(file));
         }
       }
     }
     return result;
   }
+  public Set<String> getExecutedTests() {
+    if(!parsed) {
+      parse();
+      parsed = true;
+    }
+    return executedTests;
+  }
   public Set<String> getFailedTests() {
-    final Set<String> failedTests = Sets.newHashSet();
+    if(!parsed) {
+      parse();
+      parsed = true;
+    }
+    return failedTests;
+  }
+  private void parse() {
     for(File file : getFiles(directory)) {
       FileInputStream stream = null;
       try {
@@ -86,8 +103,11 @@ public void startElement(String uri, String localName, String qName, Attributes
           @Override
         public void endElement(String uri, String localName, String qName)  {
             if ("testcase".equals(qName)) {
-              if(failedOrErrored && name != null) {
-                failedTests.add(name);
+              if(name != null) {
+                executedTests.add(name);
+                if(failedOrErrored) {
+                  failedTests.add(name);
+                }
               }
             }
           }
@@ -104,6 +124,5 @@ public void endElement(String uri, String localName, String qName)  {
         }
       }
     }
-    return failedTests;
   }
-}
\ No newline at end of file
+}
diff --git a/testutils/ptest2/src/main/java/org/apache/hive/ptest/execution/PTest.java b/testutils/ptest2/src/main/java/org/apache/hive/ptest/execution/PTest.java
index f4f507681d..d287eb5538 100644
--- a/testutils/ptest2/src/main/java/org/apache/hive/ptest/execution/PTest.java
+++ b/testutils/ptest2/src/main/java/org/apache/hive/ptest/execution/PTest.java
@@ -67,6 +67,7 @@ public class PTest {
 
   private final TestConfiguration mConfiguration;
   private final ListeningExecutorService mExecutor;
+  private final Set<String> mExecutedTests;
   private final Set<String> mFailedTests;
   private final List<Phase> mPhases;
   private final ExecutionContext mExecutionContext;
@@ -81,6 +82,7 @@ public PTest(final TestConfiguration configuration, ExecutionContext executionCo
     mConfiguration = configuration;
     mLogger = logger;
     mBuildTag = buildTag;
+    mExecutedTests = Collections.newSetFromMap(new ConcurrentHashMap<String, Boolean>());
     mFailedTests = Collections.newSetFromMap(new ConcurrentHashMap<String, Boolean>());
     mExecutionContext = executionContext;
     mExecutor = MoreExecutors.listeningDecorator(Executors.newCachedThreadPool());
@@ -99,6 +101,7 @@ public PTest(final TestConfiguration configuration, ExecutionContext executionCo
         put("repositoryName", configuration.getRepositoryName()).
         put("repositoryType", configuration.getRepositoryType()).
         put("branch", configuration.getBranch()).
+        put("clearLibraryCache", String.valueOf(configuration.isClearLibraryCache())).
         put("workingDir", mExecutionContext.getLocalWorkingDirectory()).
         put("antArgs", configuration.getAntArgs()).
         put("buildTag", buildTag).
@@ -120,7 +123,7 @@ public PTest(final TestConfiguration configuration, ExecutionContext executionCo
     mPhases.add(new CleanupPhase(mHostExecutors, localCommandFactory, templateDefaults, logger));
     mPhases.add(new PrepPhase(mHostExecutors, localCommandFactory, templateDefaults, scratchDir, patchFile, logger));
     mPhases.add(new ExecutionPhase(mHostExecutors, localCommandFactory, templateDefaults,
-        failedLogDir, testParser.parse(), mFailedTests, logger));
+        succeededLogDir, failedLogDir, testParser.parse(), mExecutedTests, mFailedTests, logger));
     mPhases.add(new ReportingPhase(mHostExecutors, localCommandFactory, templateDefaults, logger));
   }
   public int run() {
@@ -143,11 +146,6 @@ public int run() {
           elapsedTimes.put(phase.getClass().getSimpleName(), elapsedTime);
         }
       }
-      for(HostExecutor hostExecutor : mHostExecutors) {
-        if(hostExecutor.remainingDrones() == 0) {
-          mExecutionContext.addBadHost(hostExecutor.getHost());
-        }
-      }
       if(!mFailedTests.isEmpty()) {
         throw new TestsFailedException(mFailedTests.size() + " tests failed");
       }
@@ -156,6 +154,11 @@ public int run() {
       messages.add("Tests failed with: " + throwable.getClass().getSimpleName() + ": " + throwable.getMessage());
       error = true;
     } finally {
+      for(HostExecutor hostExecutor : mHostExecutors) {
+        if(hostExecutor.remainingDrones() == 0) {
+          mExecutionContext.addBadHost(hostExecutor.getHost());
+        }
+      }
       mExecutor.shutdownNow();
       if(mFailedTests.isEmpty()) {
         mLogger.info(String.format("%d failed tests", mFailedTests.size()));
@@ -165,6 +168,7 @@ public int run() {
       for(String failingTestName : mFailedTests) {
         mLogger.warn(failingTestName);
       }
+      mLogger.info("Executed " + mExecutedTests.size() + " tests");
       for(Map.Entry<String, Long> entry : elapsedTimes.entrySet()) {
         mLogger.info(String.format("PERF: Phase %s took %d minutes", entry.getKey(), entry.getValue()));
       }
@@ -194,7 +198,7 @@ private void publishJiraComment(boolean error, List<String> messages) {
       return;
     }
     JIRAService jira = new JIRAService(mLogger, mConfiguration, mBuildTag);
-    jira.postComment(error, mFailedTests, messages);
+    jira.postComment(error, mExecutedTests.size(), mFailedTests, messages);
   }
 
   public static class Builder {
@@ -302,4 +306,4 @@ public static void main(String[] args) throws Exception {
     }
     System.exit(exitCode);
   }
-}
\ No newline at end of file
+}
diff --git a/testutils/ptest2/src/main/java/org/apache/hive/ptest/execution/ReportingPhase.java b/testutils/ptest2/src/main/java/org/apache/hive/ptest/execution/ReportingPhase.java
index 023c26ba72..120897c6f1 100644
--- a/testutils/ptest2/src/main/java/org/apache/hive/ptest/execution/ReportingPhase.java
+++ b/testutils/ptest2/src/main/java/org/apache/hive/ptest/execution/ReportingPhase.java
@@ -36,7 +36,7 @@ public ReportingPhase(ImmutableList<HostExecutor> hostExecutors,
   @Override
 public void execute() throws Exception {
     execLocally("mkdir $logDir/test-results");
-    execLocally("find $logDir/{failed,succeeded} -name 'TEST*.xml' -exec cp {} $logDir/test-results \\; 2>/dev/null");
+    execLocally("find $logDir/{failed,succeeded} -maxdepth 2 -name 'TEST*.xml' -exec cp {} $logDir/test-results \\; 2>/dev/null");
     execLocally("cd $logDir/ && tar -zvcf test-results.tar.gz test-results/");
   }
-}
\ No newline at end of file
+}
diff --git a/testutils/ptest2/src/main/java/org/apache/hive/ptest/execution/conf/QFileTestBatch.java b/testutils/ptest2/src/main/java/org/apache/hive/ptest/execution/conf/QFileTestBatch.java
index 722312a18a..63597fc203 100644
--- a/testutils/ptest2/src/main/java/org/apache/hive/ptest/execution/conf/QFileTestBatch.java
+++ b/testutils/ptest2/src/main/java/org/apache/hive/ptest/execution/conf/QFileTestBatch.java
@@ -66,4 +66,49 @@ public String toString() {
   public boolean isParallel() {
     return isParallel;
   }
+  @Override
+  public int hashCode() {
+    final int prime = 31;
+    int result = 1;
+    result = prime * result + ((driver == null) ? 0 : driver.hashCode());
+    result = prime * result + (isParallel ? 1231 : 1237);
+    result = prime * result + ((name == null) ? 0 : name.hashCode());
+    result = prime * result
+        + ((queryFilesProperty == null) ? 0 : queryFilesProperty.hashCode());
+    result = prime * result + ((tests == null) ? 0 : tests.hashCode());
+    return result;
+  }
+  @Override
+  public boolean equals(Object obj) {
+    if (this == obj)
+      return true;
+    if (obj == null)
+      return false;
+    if (getClass() != obj.getClass())
+      return false;
+    QFileTestBatch other = (QFileTestBatch) obj;
+    if (driver == null) {
+      if (other.driver != null)
+        return false;
+    } else if (!driver.equals(other.driver))
+      return false;
+    if (isParallel != other.isParallel)
+      return false;
+    if (name == null) {
+      if (other.name != null)
+        return false;
+    } else if (!name.equals(other.name))
+      return false;
+    if (queryFilesProperty == null) {
+      if (other.queryFilesProperty != null)
+        return false;
+    } else if (!queryFilesProperty.equals(other.queryFilesProperty))
+      return false;
+    if (tests == null) {
+      if (other.tests != null)
+        return false;
+    } else if (!tests.equals(other.tests))
+      return false;
+    return true;
+  }  
 }
diff --git a/testutils/ptest2/src/main/java/org/apache/hive/ptest/execution/conf/TestConfiguration.java b/testutils/ptest2/src/main/java/org/apache/hive/ptest/execution/conf/TestConfiguration.java
index fef2a3e344..d9f081ea91 100644
--- a/testutils/ptest2/src/main/java/org/apache/hive/ptest/execution/conf/TestConfiguration.java
+++ b/testutils/ptest2/src/main/java/org/apache/hive/ptest/execution/conf/TestConfiguration.java
@@ -60,6 +60,7 @@ public class TestConfiguration {
   private final String jiraUser;
   private final String jiraPassword;
   private String jiraName;
+  private boolean clearLibraryCache;
 
   @VisibleForTesting
   public TestConfiguration(Context context, Logger logger)
@@ -98,7 +99,12 @@ public String getJiraName() {
   public void setJiraName(String jiraName) {
     this.jiraName = Strings.nullToEmpty(jiraName);
   }
-
+  public boolean isClearLibraryCache() {
+    return clearLibraryCache; 
+   }
+  public void setClearLibraryCache(boolean clearLibraryCache) {
+    this.clearLibraryCache = clearLibraryCache;
+  }
   public String getJiraUrl() {
     return jiraUrl;
   }
diff --git a/testutils/ptest2/src/main/java/org/apache/hive/ptest/execution/conf/UnitTestBatch.java b/testutils/ptest2/src/main/java/org/apache/hive/ptest/execution/conf/UnitTestBatch.java
index e91130436b..39385aa3d8 100644
--- a/testutils/ptest2/src/main/java/org/apache/hive/ptest/execution/conf/UnitTestBatch.java
+++ b/testutils/ptest2/src/main/java/org/apache/hive/ptest/execution/conf/UnitTestBatch.java
@@ -44,4 +44,30 @@ public String toString() {
   public boolean isParallel() {
     return isParallel;
   }
+  @Override
+  public int hashCode() {
+    final int prime = 31;
+    int result = 1;
+    result = prime * result + (isParallel ? 1231 : 1237);
+    result = prime * result + ((testName == null) ? 0 : testName.hashCode());
+    return result;
+  }
+  @Override
+  public boolean equals(Object obj) {
+    if (this == obj)
+      return true;
+    if (obj == null)
+      return false;
+    if (getClass() != obj.getClass())
+      return false;
+    UnitTestBatch other = (UnitTestBatch) obj;
+    if (isParallel != other.isParallel)
+      return false;
+    if (testName == null) {
+      if (other.testName != null)
+        return false;
+    } else if (!testName.equals(other.testName))
+      return false;
+    return true;
+  }
 }
diff --git a/testutils/ptest2/src/main/resources/batch-exec.vm b/testutils/ptest2/src/main/resources/batch-exec.vm
index a35fcec832..538f7bebe1 100644
--- a/testutils/ptest2/src/main/resources/batch-exec.vm
+++ b/testutils/ptest2/src/main/resources/batch-exec.vm
@@ -40,7 +40,12 @@ cd $localDir/$instanceName/${repositoryName}-source && \
 ret=$?
 if [[ $ret -ne 0 ]]
 then
-  cp -R $localDir/$instanceName/${repositoryName}-source $logDir/source
+  if [[ $numOfFailedTests -lt 5 ]]
+  then
+    cp -R $localDir/$instanceName/${repositoryName}-source $logDir/source
+  else
+    echo "Number of failed tests $numOfFailedTests exceeded threshold, not copying source"
+  fi
 fi
 if [[ -f $localDir/$instanceName/${repositoryName}-source/build/ql/tmp/hive.log ]]
 then
@@ -57,4 +62,4 @@ then
 else
   echo "$logDir/.log does not exist"
 fi
-exit $ret
\ No newline at end of file
+exit $ret
diff --git a/testutils/ptest2/src/main/resources/source-prep.vm b/testutils/ptest2/src/main/resources/source-prep.vm
index 7a922721dc..637ffd9d87 100644
--- a/testutils/ptest2/src/main/resources/source-prep.vm
+++ b/testutils/ptest2/src/main/resources/source-prep.vm
@@ -42,7 +42,7 @@ cd $workingDir/
     fi
     cd ${repositoryName}-source
     svn revert -R .
-    rm -rf $(svn status --no-ignore)
+    rm -rf $(svn status --no-ignore | egrep -v '^X|^Performing status on external' | awk '{print $2}')
     svn update
   elif [[ "${repositoryType}" = "git" ]]
   then
@@ -77,7 +77,12 @@ cd $workingDir/
     chmod +x $patchCommandPath
     $patchCommandPath $patchFilePath
   fi
+  if [[ "$clearLibraryCache" == "true" ]]
+  then
+  	rm -rf $workingDir/ivy $workingDir/maven
+  	mkdir $workingDir/ivy $workingDir/maven
+  fi
   ant $antArgs -Divy.default.ivy.user.dir=$workingDir/ivy -Dmvn.local.repo=$workingDir/maven clean package
   ant $antArgs -Divy.default.ivy.user.dir=$workingDir/ivy -Dmvn.local.repo=$workingDir/maven -Dtestcase=nothing test
 ) 2>&1 | tee $logDir/source-prep.txt
-exit ${PIPESTATUS[0]}
\ No newline at end of file
+exit ${PIPESTATUS[0]}
diff --git a/testutils/ptest2/src/test/java/org/apache/hive/ptest/execution/TestExecutionPhase.java b/testutils/ptest2/src/test/java/org/apache/hive/ptest/execution/TestExecutionPhase.java
index eec5560f9c..4cf8c61e04 100644
--- a/testutils/ptest2/src/test/java/org/apache/hive/ptest/execution/TestExecutionPhase.java
+++ b/testutils/ptest2/src/test/java/org/apache/hive/ptest/execution/TestExecutionPhase.java
@@ -48,6 +48,7 @@ public class TestExecutionPhase extends AbstractTestPhase {
   private static final String QFILENAME = "sometest";
   private ExecutionPhase phase;
   private File testDir;
+  private Set<String> executedTests;
   private Set<String> failedTests;
   private List<TestBatch> testBatches;
   private TestBatch testBatch;
@@ -55,13 +56,14 @@ public class TestExecutionPhase extends AbstractTestPhase {
   @Before
   public void setup() throws Exception {
     initialize(getClass().getSimpleName());
+    executedTests = Sets.newHashSet();
     failedTests = Sets.newHashSet();
   }
   private ExecutionPhase getPhase() throws IOException {
     createHostExecutor();
     phase = new ExecutionPhase(hostExecutors, localCommandFactory, templateDefaults,
-        failedLogDir, Suppliers.ofInstance(testBatches),
-        failedTests, logger);
+        succeededLogDir, failedLogDir, Suppliers.ofInstance(testBatches),
+        executedTests, failedTests, logger);
     return phase;
   }
   private void setupQFile(boolean isParallel) throws Exception {
@@ -74,6 +76,12 @@ private void setupUnitTest() throws Exception {
     testBatch = new UnitTestBatch(DRIVER, false);
     testBatches = Collections.singletonList(testBatch);
   }
+  private void copyTestOutput(String resource, File directory, String name) throws Exception {
+    String junitOutput = Templates.readResource(resource);
+    File junitOutputFile = new File(Dirs.create(
+        new File(directory, name)), "TEST-SomeTest.xml");
+    Files.write(junitOutput.getBytes(Charsets.UTF_8), junitOutputFile);
+  }
   @After
   public void teardown() {
     FileUtils.deleteQuietly(baseDir);
@@ -81,8 +89,10 @@ public void teardown() {
   @Test
   public void testPassingQFileTest() throws Throwable {
     setupQFile(true);
+    copyTestOutput("SomeTest-success.xml", succeededLogDir, testBatch.getName());
     getPhase().execute();
     Approvals.verify(getExecutedCommands());
+    Assert.assertEquals(Sets.newHashSet("SomeTest." + QFILENAME), executedTests);
     Assert.assertEquals(Sets.newHashSet(), failedTests);
   }
   @Test
@@ -90,19 +100,19 @@ public void testFailingQFile() throws Throwable {
     setupQFile(true);
     sshCommandExecutor.putFailure("bash " + LOCAL_DIR + "/" + HOST + "-" + USER +
         "-0/scratch/hiveptest-" + DRIVER + "-" + QFILENAME + ".sh", 1);
-    String junitOutput = Templates.readResource("TEST-SomeTest-failure.xml");
-    File driverFailureDir = Dirs.create(new File(failedLogDir, testBatch.getName()));
-    File junitOutputFile = new File(driverFailureDir, "TEST-SomeTest-failure.xml");
-    Files.write(junitOutput.getBytes(Charsets.UTF_8), junitOutputFile);
+    copyTestOutput("SomeTest-failure.xml", failedLogDir, testBatch.getName());
     getPhase().execute();
     Approvals.verify(getExecutedCommands());
+    Assert.assertEquals(Sets.newHashSet("SomeTest." + QFILENAME), executedTests);
     Assert.assertEquals(Sets.newHashSet("SomeTest." + QFILENAME), failedTests);
   }
   @Test
   public void testPassingUnitTest() throws Throwable {
     setupUnitTest();
+    copyTestOutput("SomeTest-success.xml", succeededLogDir, testBatch.getName());
     getPhase().execute();
     Approvals.verify(getExecutedCommands());
+    Assert.assertEquals(Sets.newHashSet("SomeTest." + QFILENAME), executedTests);
     Assert.assertEquals(Sets.newHashSet(), failedTests);
   }
   @Test
@@ -110,12 +120,10 @@ public void testFailingUnitTest() throws Throwable {
     setupUnitTest();
     sshCommandExecutor.putFailure("bash " + LOCAL_DIR + "/" + HOST + "-" + USER +
         "-0/scratch/hiveptest-" + DRIVER + ".sh", 1);
-    String junitOutput = Templates.readResource("TEST-SomeTest-failure.xml");
-    File driverFailureDir = Dirs.create(new File(failedLogDir, testBatch.getName()));
-    File junitOutputFile = new File(driverFailureDir, "TEST-SomeTest-failure.xml");
-    Files.write(junitOutput.getBytes(Charsets.UTF_8), junitOutputFile);
+    copyTestOutput("SomeTest-failure.xml", failedLogDir, testBatch.getName());
     getPhase().execute();
     Approvals.verify(getExecutedCommands());
+    Assert.assertEquals(Sets.newHashSet("SomeTest." + QFILENAME), executedTests);
     Assert.assertEquals(Sets.newHashSet("SomeTest." + QFILENAME), failedTests);
   }
-}
\ No newline at end of file
+}
diff --git a/testutils/ptest2/src/test/java/org/apache/hive/ptest/execution/TestHostExecutor.java b/testutils/ptest2/src/test/java/org/apache/hive/ptest/execution/TestHostExecutor.java
index 6fc649ad1b..ca6b12656b 100644
--- a/testutils/ptest2/src/test/java/org/apache/hive/ptest/execution/TestHostExecutor.java
+++ b/testutils/ptest2/src/test/java/org/apache/hive/ptest/execution/TestHostExecutor.java
@@ -24,6 +24,7 @@
 import java.io.File;
 import java.util.Collections;
 import java.util.List;
+import java.util.Set;
 import java.util.concurrent.BlockingQueue;
 import java.util.concurrent.Executors;
 import java.util.concurrent.LinkedBlockingQueue;
@@ -46,6 +47,7 @@
 import com.google.common.base.Joiner;
 import com.google.common.collect.ImmutableMap;
 import com.google.common.collect.Lists;
+import com.google.common.collect.Sets;
 import com.google.common.util.concurrent.ListeningExecutorService;
 import com.google.common.util.concurrent.MoreExecutors;
 
@@ -86,7 +88,7 @@ public class TestHostExecutor {
   private Logger logger;
   private BlockingQueue<TestBatch> parallelWorkQueue;
   private BlockingQueue<TestBatch> isolatedWorkQueue;
-  private List<TestBatch> failedTestResults;
+  private Set<TestBatch> failedTestResults;
   private TestBatch testBatchParallel1;
   private TestBatch testBatchParallel2;
   private TestBatch testBatchIsolated1;
@@ -101,7 +103,7 @@ public void setup() throws Exception {
     failedLogDir = Dirs.create(new File(logDir, "failed"));
     parallelWorkQueue = new LinkedBlockingQueue<TestBatch>();
     isolatedWorkQueue = new LinkedBlockingQueue<TestBatch>();
-    failedTestResults = Lists.newArrayList();
+    failedTestResults = Sets.newHashSet();
     testBatchParallel1 = new UnitTestBatch(DRIVER_PARALLEL_1, true);
     testBatchParallel2 = new UnitTestBatch(DRIVER_PARALLEL_2, true);
     testBatchIsolated1 = new UnitTestBatch(DRIVER_ISOLATED_1, false);
@@ -151,7 +153,7 @@ public void testBasic()
     parallelWorkQueue.addAll(Lists.newArrayList(testBatchParallel1, testBatchParallel2));
     parallelWorkQueue.addAll(Lists.newArrayList(testBatchIsolated1, testBatchIsolated2));
     executor.submitTests(parallelWorkQueue, isolatedWorkQueue, failedTestResults).get();
-    Assert.assertEquals(Collections.emptyList(),  failedTestResults);
+    Assert.assertEquals(Collections.emptySet(),  failedTestResults);
     Approvals.verify(getExecutedCommands());
   }
   @Test
@@ -162,7 +164,7 @@ public void testParallelFailsOnExec()
     HostExecutor executor = createHostExecutor();
     parallelWorkQueue.addAll(Lists.newArrayList(testBatchParallel1));
     executor.submitTests(parallelWorkQueue, isolatedWorkQueue, failedTestResults).get();
-    Assert.assertEquals(Collections.emptyList(),  failedTestResults);
+    Assert.assertEquals(Collections.emptySet(),  failedTestResults);
     Assert.assertTrue(parallelWorkQueue.toString(), parallelWorkQueue.isEmpty());
     Approvals.verify(getExecutedCommands());
   }
@@ -174,7 +176,7 @@ public void testIsolatedFailsOnExec()
     HostExecutor executor = createHostExecutor();
     isolatedWorkQueue.addAll(Lists.newArrayList(testBatchIsolated1));
     executor.submitTests(parallelWorkQueue, isolatedWorkQueue, failedTestResults).get();
-    Assert.assertEquals(Collections.emptyList(),  failedTestResults);
+    Assert.assertEquals(Collections.emptySet(),  failedTestResults);
     Assert.assertTrue(isolatedWorkQueue.toString(), parallelWorkQueue.isEmpty());
     Approvals.verify(getExecutedCommands());
   }
@@ -186,7 +188,7 @@ public void testParallelFailsOnRsync()
     HostExecutor executor = createHostExecutor();
     parallelWorkQueue.addAll(Lists.newArrayList(testBatchParallel1));
     executor.submitTests(parallelWorkQueue, isolatedWorkQueue, failedTestResults).get();
-    Assert.assertEquals(Collections.emptyList(),  failedTestResults);
+    Assert.assertEquals(Collections.emptySet(),  failedTestResults);
     Assert.assertTrue(parallelWorkQueue.toString(), parallelWorkQueue.isEmpty());
     Approvals.verify(getExecutedCommands());
   }
@@ -198,7 +200,7 @@ public void testIsolatedFailsOnRsyncUnknown()
     HostExecutor executor = createHostExecutor();
     isolatedWorkQueue.addAll(Lists.newArrayList(testBatchIsolated1));
     executor.submitTests(parallelWorkQueue, isolatedWorkQueue, failedTestResults).get();
-    Assert.assertEquals(Collections.emptyList(),  failedTestResults);
+    Assert.assertEquals(Collections.emptySet(),  failedTestResults);
     Assert.assertTrue(isolatedWorkQueue.toString(), parallelWorkQueue.isEmpty());
     Approvals.verify(getExecutedCommands());
   }
@@ -210,7 +212,7 @@ public void testIsolatedFailsOnRsyncOne()
     HostExecutor executor = createHostExecutor();
     isolatedWorkQueue.addAll(Lists.newArrayList(testBatchIsolated1));
     executor.submitTests(parallelWorkQueue, isolatedWorkQueue, failedTestResults).get();
-    Assert.assertEquals(Collections.emptyList(),  failedTestResults);
+    Assert.assertEquals(Collections.emptySet(),  failedTestResults);
     Assert.assertTrue(isolatedWorkQueue.toString(), parallelWorkQueue.isEmpty());
     Approvals.verify(getExecutedCommands());
   }
diff --git a/testutils/ptest2/src/test/java/org/apache/hive/ptest/execution/TestReportParser.java b/testutils/ptest2/src/test/java/org/apache/hive/ptest/execution/TestReportParser.java
index 61b345d36c..c6691e2bb1 100644
--- a/testutils/ptest2/src/test/java/org/apache/hive/ptest/execution/TestReportParser.java
+++ b/testutils/ptest2/src/test/java/org/apache/hive/ptest/execution/TestReportParser.java
@@ -22,19 +22,41 @@
 
 import junit.framework.Assert;
 
+import org.apache.commons.io.FileUtils;
+import org.junit.After;
+import org.junit.Before;
 import org.junit.Test;
 import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
 
 import com.google.common.collect.Sets;
+import com.google.common.io.Files;
 
 public class TestReportParser {
   private static final Logger LOG = LoggerFactory
       .getLogger(TestReportParser.class);
+  private File baseDir;
+  @Before
+  public void setup() {
+    baseDir = Files.createTempDir();
+  }
+  @After
+  public void teardown() {
+    if(baseDir != null) {
+      FileUtils.deleteQuietly(baseDir);
+    }
+  }
   @Test
   public void test() throws Exception {
     File reportDir = new File("src/test/resources/test-outputs");
-    JUnitReportParser parser = new JUnitReportParser(LOG, reportDir);
+    for(File file : reportDir.listFiles()) {
+      if(file.getName().endsWith(".xml")) {
+        Files.copy(file, new File(baseDir, "TEST-" + file.getName()));
+      } else {
+        Files.copy(file, new File(baseDir, file.getName()));
+      }
+    }
+    JUnitReportParser parser = new JUnitReportParser(LOG, baseDir);
     Assert.assertEquals(3, parser.getFailedTests().size());
     Assert.assertEquals(Sets.
         newHashSet("org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_skewjoin_union_remove_1",
diff --git a/testutils/ptest2/src/test/java/org/apache/hive/ptest/execution/TestReportingPhase.testExecute.approved.txt b/testutils/ptest2/src/test/java/org/apache/hive/ptest/execution/TestReportingPhase.testExecute.approved.txt
index 19bc3e73ed..eed7157f4a 100644
--- a/testutils/ptest2/src/test/java/org/apache/hive/ptest/execution/TestReportingPhase.testExecute.approved.txt
+++ b/testutils/ptest2/src/test/java/org/apache/hive/ptest/execution/TestReportingPhase.testExecute.approved.txt
@@ -1,3 +1,3 @@
 cd /tmp/hive-ptest-units/TestReportingPhase/logs/ && tar -zvcf test-results.tar.gz test-results/
-find /tmp/hive-ptest-units/TestReportingPhase/logs/{failed,succeeded} -name 'TEST*.xml' -exec cp {} /tmp/hive-ptest-units/TestReportingPhase/logs/test-results \; 2>/dev/null
-mkdir /tmp/hive-ptest-units/TestReportingPhase/logs/test-results
\ No newline at end of file
+find /tmp/hive-ptest-units/TestReportingPhase/logs/{failed,succeeded} -maxdepth 2 -name 'TEST*.xml' -exec cp {} /tmp/hive-ptest-units/TestReportingPhase/logs/test-results \; 2>/dev/null
+mkdir /tmp/hive-ptest-units/TestReportingPhase/logs/test-results
diff --git a/testutils/ptest2/src/test/java/org/apache/hive/ptest/execution/TestScripts.java b/testutils/ptest2/src/test/java/org/apache/hive/ptest/execution/TestScripts.java
index 063199664c..72cd8e45c6 100644
--- a/testutils/ptest2/src/test/java/org/apache/hive/ptest/execution/TestScripts.java
+++ b/testutils/ptest2/src/test/java/org/apache/hive/ptest/execution/TestScripts.java
@@ -67,7 +67,9 @@ public void testBatch() throws Throwable {
     templateVariables.put("logDir", "/some/log/dir");
     templateVariables.put("instanceName", "instance-1");
     templateVariables.put("batchName","batch-1");
+    templateVariables.put("numOfFailedTests", "20");
     templateVariables.put("testArguments", "-Dtest=arg1");
+    templateVariables.put("clearLibraryCache", "true");
     templateVariables.put("javaHome", "/usr/java/jdk1.7");
     templateVariables.put("antEnvOpts", "-Dhttp.proxyHost=somehost -Dhttp.proxyPort=3128");
     String template = readResource("batch-exec.vm");
@@ -86,6 +88,7 @@ public void testPrepNone() throws Throwable {
     templateVariables.put("buildTag", "build-1");
     templateVariables.put("logDir", "/some/log/dir");
     templateVariables.put("testArguments", "-Dtest=arg1");
+    templateVariables.put("clearLibraryCache", "false");
     templateVariables.put("javaHome", "/usr/java/jdk1.7");
     templateVariables.put("antEnvOpts", "-Dhttp.proxyHost=somehost -Dhttp.proxyPort=3128");
     String template = readResource("source-prep.vm");
@@ -104,6 +107,7 @@ public void testPrepGit() throws Throwable {
     templateVariables.put("buildTag", "build-1");
     templateVariables.put("logDir", "/some/log/dir");
     templateVariables.put("testArguments", "-Dtest=arg1");
+    templateVariables.put("clearLibraryCache", "true");
     templateVariables.put("javaHome", "/usr/java/jdk1.7");
     templateVariables.put("antEnvOpts", "-Dhttp.proxyHost=somehost -Dhttp.proxyPort=3128");
     templateVariables.put("repositoryType", "git");
@@ -123,6 +127,7 @@ public void testPrepSvn() throws Throwable {
     templateVariables.put("buildTag", "build-1");
     templateVariables.put("logDir", "/some/log/dir");
     templateVariables.put("testArguments", "-Dtest=arg1");
+    templateVariables.put("clearLibraryCache", "true");
     templateVariables.put("javaHome", "/usr/java/jdk1.7");
     templateVariables.put("antEnvOpts", "-Dhttp.proxyHost=somehost -Dhttp.proxyPort=3128");
     templateVariables.put("repositoryType", "svn");
@@ -147,4 +152,4 @@ protected static String getTemplateResult(String command, Map<String, String> ke
     writer.close();
     return writer.toString();
   }
-}
\ No newline at end of file
+}
diff --git a/testutils/ptest2/src/test/java/org/apache/hive/ptest/execution/TestScripts.testBatch.approved.txt b/testutils/ptest2/src/test/java/org/apache/hive/ptest/execution/TestScripts.testBatch.approved.txt
index 9b4bb2fbe2..993bf5d47f 100644
--- a/testutils/ptest2/src/test/java/org/apache/hive/ptest/execution/TestScripts.testBatch.approved.txt
+++ b/testutils/ptest2/src/test/java/org/apache/hive/ptest/execution/TestScripts.testBatch.approved.txt
@@ -39,7 +39,12 @@ cd /some/local/dir/instance-1/apache-source && \
 ret=$?
 if [[ $ret -ne 0 ]]
 then
-  cp -R /some/local/dir/instance-1/apache-source /some/log/dir/source
+  if [[ 20 -lt 5 ]]
+  then
+    cp -R /some/local/dir/instance-1/apache-source /some/log/dir/source
+  else
+    echo "Number of failed tests 20 exceeded threshold, not copying source"
+  fi
 fi
 if [[ -f /some/local/dir/instance-1/apache-source/build/ql/tmp/hive.log ]]
 then
@@ -56,4 +61,4 @@ then
 else
   echo "/some/log/dir/.log does not exist"
 fi
-exit $ret
\ No newline at end of file
+exit $ret
diff --git a/testutils/ptest2/src/test/java/org/apache/hive/ptest/execution/TestScripts.testPrepGit.approved.txt b/testutils/ptest2/src/test/java/org/apache/hive/ptest/execution/TestScripts.testPrepGit.approved.txt
index 2decd3ee2a..81aade18d6 100644
--- a/testutils/ptest2/src/test/java/org/apache/hive/ptest/execution/TestScripts.testPrepGit.approved.txt
+++ b/testutils/ptest2/src/test/java/org/apache/hive/ptest/execution/TestScripts.testPrepGit.approved.txt
@@ -41,7 +41,7 @@ cd /some/working/dir/
     fi
     cd apache-source
     svn revert -R .
-    rm -rf $(svn status --no-ignore)
+    rm -rf $(svn status --no-ignore | egrep -v '^X|^Performing status on external' | awk '{print $2}')
     svn update
   elif [[ "git" = "git" ]]
   then
@@ -76,7 +76,12 @@ cd /some/working/dir/
     chmod +x $patchCommandPath
     $patchCommandPath $patchFilePath
   fi
+  if [[ "true" == "true" ]]
+  then
+  	rm -rf /some/working/dir/ivy /some/working/dir/maven
+  	mkdir /some/working/dir/ivy /some/working/dir/maven
+  fi
   ant -Dant=arg1 -Divy.default.ivy.user.dir=/some/working/dir/ivy -Dmvn.local.repo=/some/working/dir/maven clean package
   ant -Dant=arg1 -Divy.default.ivy.user.dir=/some/working/dir/ivy -Dmvn.local.repo=/some/working/dir/maven -Dtestcase=nothing test
 ) 2>&1 | tee /some/log/dir/source-prep.txt
-exit ${PIPESTATUS[0]}
\ No newline at end of file
+exit ${PIPESTATUS[0]}
diff --git a/testutils/ptest2/src/test/java/org/apache/hive/ptest/execution/TestScripts.testPrepNone.approved.txt b/testutils/ptest2/src/test/java/org/apache/hive/ptest/execution/TestScripts.testPrepNone.approved.txt
index 7d8719d5e7..cd6f3ed02f 100644
--- a/testutils/ptest2/src/test/java/org/apache/hive/ptest/execution/TestScripts.testPrepNone.approved.txt
+++ b/testutils/ptest2/src/test/java/org/apache/hive/ptest/execution/TestScripts.testPrepNone.approved.txt
@@ -41,7 +41,7 @@ cd /some/working/dir/
     fi
     cd apache-source
     svn revert -R .
-    rm -rf $(svn status --no-ignore)
+    rm -rf $(svn status --no-ignore | egrep -v '^X|^Performing status on external' | awk '{print $2}')
     svn update
   elif [[ "${repositoryType}" = "git" ]]
   then
@@ -76,7 +76,12 @@ cd /some/working/dir/
     chmod +x $patchCommandPath
     $patchCommandPath $patchFilePath
   fi
+  if [[ "false" == "true" ]]
+  then
+  	rm -rf /some/working/dir/ivy /some/working/dir/maven
+  	mkdir /some/working/dir/ivy /some/working/dir/maven
+  fi
   ant -Dant=arg1 -Divy.default.ivy.user.dir=/some/working/dir/ivy -Dmvn.local.repo=/some/working/dir/maven clean package
   ant -Dant=arg1 -Divy.default.ivy.user.dir=/some/working/dir/ivy -Dmvn.local.repo=/some/working/dir/maven -Dtestcase=nothing test
 ) 2>&1 | tee /some/log/dir/source-prep.txt
-exit ${PIPESTATUS[0]}
\ No newline at end of file
+exit ${PIPESTATUS[0]}
diff --git a/testutils/ptest2/src/test/java/org/apache/hive/ptest/execution/TestScripts.testPrepSvn.approved.txt b/testutils/ptest2/src/test/java/org/apache/hive/ptest/execution/TestScripts.testPrepSvn.approved.txt
index 0af317ee70..2dbccc0aeb 100644
--- a/testutils/ptest2/src/test/java/org/apache/hive/ptest/execution/TestScripts.testPrepSvn.approved.txt
+++ b/testutils/ptest2/src/test/java/org/apache/hive/ptest/execution/TestScripts.testPrepSvn.approved.txt
@@ -41,7 +41,7 @@ cd /some/working/dir/
     fi
     cd apache-source
     svn revert -R .
-    rm -rf $(svn status --no-ignore)
+    rm -rf $(svn status --no-ignore | egrep -v '^X|^Performing status on external' | awk '{print $2}')
     svn update
   elif [[ "svn" = "git" ]]
   then
@@ -76,7 +76,12 @@ cd /some/working/dir/
     chmod +x $patchCommandPath
     $patchCommandPath $patchFilePath
   fi
+  if [[ "true" == "true" ]]
+  then
+  	rm -rf /some/working/dir/ivy /some/working/dir/maven
+  	mkdir /some/working/dir/ivy /some/working/dir/maven
+  fi
   ant -Dant=arg1 -Divy.default.ivy.user.dir=/some/working/dir/ivy -Dmvn.local.repo=/some/working/dir/maven clean package
   ant -Dant=arg1 -Divy.default.ivy.user.dir=/some/working/dir/ivy -Dmvn.local.repo=/some/working/dir/maven -Dtestcase=nothing test
 ) 2>&1 | tee /some/log/dir/source-prep.txt
-exit ${PIPESTATUS[0]}
\ No newline at end of file
+exit ${PIPESTATUS[0]}
diff --git a/testutils/ptest2/src/test/resources/SomeTest-failure.xml b/testutils/ptest2/src/test/resources/SomeTest-failure.xml
new file mode 100644
index 0000000000..d033cc48a8
--- /dev/null
+++ b/testutils/ptest2/src/test/resources/SomeTest-failure.xml
@@ -0,0 +1,7 @@
+<?xml version="1.0" encoding="UTF-8" ?>
+<testsuite errors="0" failures="1" hostname="localhost" name="SomeTest" tests="1" time="0" timestamp="2013-01-28T01:14:46">
+  <properties></properties>
+  <testcase classname="SomeTest" name="sometest" time="434.688">
+    <failure message="sample" type="junit.framework.AssertionFailedError">sample</failure>
+  </testcase>
+</testsuite>
\ No newline at end of file
diff --git a/testutils/ptest2/src/test/resources/SomeTest-success.xml b/testutils/ptest2/src/test/resources/SomeTest-success.xml
new file mode 100644
index 0000000000..42ab2f2c2c
--- /dev/null
+++ b/testutils/ptest2/src/test/resources/SomeTest-success.xml
@@ -0,0 +1,6 @@
+<?xml version="1.0" encoding="UTF-8" ?>
+<testsuite errors="0" failures="1" hostname="localhost" name="SomeTest" tests="1" time="0" timestamp="2013-01-28T01:14:46">
+  <properties></properties>
+  <testcase classname="SomeTest" name="sometest" time="434.688">
+  </testcase>
+</testsuite>
\ No newline at end of file
diff --git a/testutils/ptest2/src/test/resources/TEST-SomeTest-failure.xml b/testutils/ptest2/src/test/resources/TEST-SomeTest-failure.xml
index d033cc48a8..e69de29bb2 100644
--- a/testutils/ptest2/src/test/resources/TEST-SomeTest-failure.xml
+++ b/testutils/ptest2/src/test/resources/TEST-SomeTest-failure.xml
@@ -1,7 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" ?>
-<testsuite errors="0" failures="1" hostname="localhost" name="SomeTest" tests="1" time="0" timestamp="2013-01-28T01:14:46">
-  <properties></properties>
-  <testcase classname="SomeTest" name="sometest" time="434.688">
-    <failure message="sample" type="junit.framework.AssertionFailedError">sample</failure>
-  </testcase>
-</testsuite>
\ No newline at end of file
diff --git a/testutils/ptest2/src/test/resources/test-outputs/SomeTest-truncated.xml b/testutils/ptest2/src/test/resources/test-outputs/SomeTest-truncated.xml
new file mode 100644
index 0000000000..7e3fca45e1
--- /dev/null
+++ b/testutils/ptest2/src/test/resources/test-outputs/SomeTest-truncated.xml
@@ -0,0 +1,4 @@
+<?xml version="1.0" encoding="UTF-8" ?>
+<testsuite errors="0" failures="1" hostname="localhost" name="SomeTest" tests="1" time="0" timestamp="2013-01-28T01:14:46">
+  <properties></properties>
+  <testcase classname="SomeTest" name="sometest" time="434.688">
diff --git a/testutils/ptest2/src/test/resources/test-outputs/TEST-SomeTest-truncated.xml b/testutils/ptest2/src/test/resources/test-outputs/TEST-SomeTest-truncated.xml
index 7e3fca45e1..e69de29bb2 100644
--- a/testutils/ptest2/src/test/resources/test-outputs/TEST-SomeTest-truncated.xml
+++ b/testutils/ptest2/src/test/resources/test-outputs/TEST-SomeTest-truncated.xml
@@ -1,4 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" ?>
-<testsuite errors="0" failures="1" hostname="localhost" name="SomeTest" tests="1" time="0" timestamp="2013-01-28T01:14:46">
-  <properties></properties>
-  <testcase classname="SomeTest" name="sometest" time="434.688">
diff --git a/testutils/ptest2/src/test/resources/test-outputs/TEST-index_auth.q-bucketcontex-ba31fb54-1d7f-4c70-a89d-477b7d155191-TEST-org.apache.hadoop.hive.cli.TestCliDriver.xml b/testutils/ptest2/src/test/resources/test-outputs/TEST-index_auth.q-bucketcontex-ba31fb54-1d7f-4c70-a89d-477b7d155191-TEST-org.apache.hadoop.hive.cli.TestCliDriver.xml
index dcf4d4f0af..e69de29bb2 100644
--- a/testutils/ptest2/src/test/resources/test-outputs/TEST-index_auth.q-bucketcontex-ba31fb54-1d7f-4c70-a89d-477b7d155191-TEST-org.apache.hadoop.hive.cli.TestCliDriver.xml
+++ b/testutils/ptest2/src/test/resources/test-outputs/TEST-index_auth.q-bucketcontex-ba31fb54-1d7f-4c70-a89d-477b7d155191-TEST-org.apache.hadoop.hive.cli.TestCliDriver.xml
@@ -1,34 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" ?>
-<testsuite errors="0" failures="0" hostname="p0416.mtv.cloudera.com" name="org.apache.hadoop.hive.cli.TestCliDriver" tests="14" time="567.873" timestamp="2013-01-28T01:13:29">
-  <properties>
-    <property name="hadoop.bin.path" value="/data/6/hive-local/p0416.mtv.cloudera.com-hiveptest-8/source/testutils/hadoop" />
-    <property name="commons-cli.version" value="1.2" />
-    <property name="ivy_repo_url" value="http://repo2.maven.org/maven2/org/apache/ivy/ivy/2.1.0/ivy-2.1.0.jar" />
-    <property name="snapshots.cloudera.com.ql.ivy.settings" value="https://repository.cloudera.com/artifactory/libs-snapshot-local/" />
-    <property name="is-offline" value="false" />
-  </properties>
-  <testcase classname="org.apache.hadoop.hive.cli.TestCliDriver" name="testCliDriver_authorization_2" time="252.494" />
-  <testcase classname="org.apache.hadoop.hive.cli.TestCliDriver" name="testCliDriver_auto_join17" time="21.234" />
-  <testcase classname="org.apache.hadoop.hive.cli.TestCliDriver" name="testCliDriver_binary_constant" time="5.314" />
-  <testcase classname="org.apache.hadoop.hive.cli.TestCliDriver" name="testCliDriver_bucketcontext_3" time="34.151" />
-  <testcase classname="org.apache.hadoop.hive.cli.TestCliDriver" name="testCliDriver_groupby_rollup1" time="74.646" />
-  <testcase classname="org.apache.hadoop.hive.cli.TestCliDriver" name="testCliDriver_index_auth" time="10.633" />
-  <testcase classname="org.apache.hadoop.hive.cli.TestCliDriver" name="testCliDriver_index_bitmap2" time="46.858" />
-  <testcase classname="org.apache.hadoop.hive.cli.TestCliDriver" name="testCliDriver_load_dyn_part3" time="11.091" />
-  <testcase classname="org.apache.hadoop.hive.cli.TestCliDriver" name="testCliDriver_multi_insert_gby" time="39.365" />
-  <testcase classname="org.apache.hadoop.hive.cli.TestCliDriver" name="testCliDriver_notable_alias1" time="8.025" />
-  <testcase classname="org.apache.hadoop.hive.cli.TestCliDriver" name="testCliDriver_ppd_join" time="14.558" />
-  <testcase classname="org.apache.hadoop.hive.cli.TestCliDriver" name="testCliDriver_rcfile_lazydecompress" time="47.846" />
-  <testcase classname="org.apache.hadoop.hive.cli.TestCliDriver" name="testCliDriver_udf_regexp_extract" time="0.392" />
-  <testcase classname="org.apache.hadoop.hive.cli.TestCliDriver" name="testCliDriver_shutdown" time="0.792" />
-  <system-out><![CDATA[Begin query: authorization_2.q
-diff -a /data/6/hive-local/p0416.mtv.cloudera.com-hiveptest-8/source/build/ql/test/logs/clientpositive/authorization_2.q.out /data/6/hive-local/p0416.mtv.cloudera.com-hiveptest-8/source/ql/src/test/results/clientpositive/authorization_2.q.out
-Done query: authorization_2.q elapsedTime=241s
-Begin query: auto_join17.q
-rmr: DEPRECATED: Please use 'rm -r' instead.
-WARNING: org.apache.hadoop.metrics.jvm.EventCounter is deprecated. Please use org.apache.hadoop.log.metrics.EventCounter in all the log4j.properties files.
-WARNING: org.apache.hadoop.metrics.jvm.EventCounter is deprecated. Please use org.apache.hadoop.log.metrics.EventCounter in all the log4j.properties files.
-WARNING: org.apache.hadoop.metrics.jvm.EventCounter is deprecated. Please use org.apache.hadoop.log.metrics.EventCounter in all the log4j.properties files.
-WARNING: org.apache.hadoop.metrics.jvm.EventCounter is deprecated. Please use org.apache.hadoop.log.metrics.EventCounter in all the log4j.properties files.
-]]></system-out>
-</testsuite>
diff --git a/testutils/ptest2/src/test/resources/test-outputs/TEST-skewjoin.q-ab8536a7-1b5c-45ed-ba29-14450f27db8b-TEST-org.apache.hadoop.hive.cli.TestCliDriver.xml b/testutils/ptest2/src/test/resources/test-outputs/TEST-skewjoin.q-ab8536a7-1b5c-45ed-ba29-14450f27db8b-TEST-org.apache.hadoop.hive.cli.TestCliDriver.xml
index c7d5e9a261..e69de29bb2 100644
--- a/testutils/ptest2/src/test/resources/test-outputs/TEST-skewjoin.q-ab8536a7-1b5c-45ed-ba29-14450f27db8b-TEST-org.apache.hadoop.hive.cli.TestCliDriver.xml
+++ b/testutils/ptest2/src/test/resources/test-outputs/TEST-skewjoin.q-ab8536a7-1b5c-45ed-ba29-14450f27db8b-TEST-org.apache.hadoop.hive.cli.TestCliDriver.xml
@@ -1,53 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" ?>
-<testsuite errors="0" failures="1" hostname="p0416.mtv.cloudera.com" name="org.apache.hadoop.hive.cli.TestCliDriver" tests="2" time="439.527" timestamp="2013-01-28T01:14:46">
-  <properties>
-    <property name="hadoop.bin.path" value="/data/6/hive-local/p0416.mtv.cloudera.com-hiveptest-2/source/testutils/hadoop" />
-    <property name="hadoop.mirror2" value="http://archive.cloudera.com/hive-deps" />
-    <property name="ivy_repo_url" value="http://repo2.maven.org/maven2/org/apache/ivy/ivy/2.1.0/ivy-2.1.0.jar" />
-    <property name="snapshots.cloudera.com.ql.ivy.settings" value="https://repository.cloudera.com/artifactory/libs-snapshot-local/" />
-    <property name="is-offline" value="false" />
-  </properties>
-  <testcase classname="org.apache.hadoop.hive.cli.TestCliDriver" name="testCliDriver_skewjoin" time="434.688">
-    <failure message="Unexpected exception&#xa;See build/ql/tmp/hive.log, or try &quot;ant test ... -Dtest.silent=false&quot; to get more logs." type="junit.framework.AssertionFailedError">junit.framework.AssertionFailedError: Unexpected exception
-See build/ql/tmp/hive.log, or try &quot;ant test ... -Dtest.silent=false&quot; to get more logs.
-	at junit.framework.Assert.fail(Assert.java:50)
-	at org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_skewjoin(TestCliDriver.java:156)
-	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
-	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
-	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
-	at java.lang.reflect.Method.invoke(Method.java:597)
-	at junit.framework.TestCase.runTest(TestCase.java:168)
-	at junit.framework.TestCase.runBare(TestCase.java:134)
-	at junit.framework.TestResult$1.protect(TestResult.java:110)
-	at junit.framework.TestResult.runProtected(TestResult.java:128)
-	at junit.framework.TestResult.run(TestResult.java:113)
-	at junit.framework.TestCase.run(TestCase.java:124)
-	at junit.framework.TestSuite.runTest(TestSuite.java:243)
-	at junit.framework.TestSuite.run(TestSuite.java:238)
-	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.run(JUnitTestRunner.java:520)
-	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.launch(JUnitTestRunner.java:1060)
-	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.main(JUnitTestRunner.java:911)
-</failure>
-  </testcase>
-  <testcase classname="org.apache.hadoop.hive.cli.TestCliDriver" name="testCliDriver_shutdown" time="4.824" />
-  <system-out><![CDATA[Begin query: skewjoin.q
-Deleted /data/6/hive-local/p0416.mtv.cloudera.com-hiveptest-2/source/build/ql/test/data/warehouse/dest_j1
-diff -a /data/6/hive-local/p0416.mtv.cloudera.com-hiveptest-2/source/build/ql/test/logs/clientpositive/skewjoin.q.out /data/6/hive-local/p0416.mtv.cloudera.com-hiveptest-2/source/ql/src/test/results/clientpositive/skewjoin.q.out
-1513a1514
-> 293143	-136853010385
-Exception: Client execution results failed with error code = 1
-See build/ql/tmp/hive.log, or try "ant test ... -Dtest.silent=false" to get more logs.
-Failed query: skewjoin.q
-Cleaning up TestCliDriver
-]]></system-out>
-  <system-err><![CDATA[WARNING: org.apache.hadoop.metrics.jvm.EventCounter is deprecated. Please use org.apache.hadoop.log.metrics.EventCounter in all the log4j.properties files.
-Hive history file=/data/6/hive-local/p0416.mtv.cloudera.com-hiveptest-2/source/build/ql/tmp/hive_job_log_hiveptest_201301271712_1670514421.txt
-Hive history file=/data/6/hive-local/p0416.mtv.cloudera.com-hiveptest-2/source/build/ql/tmp/hive_job_log_hiveptest_201301271712_1323090315.txt
-PREHOOK: query: LOAD DATA LOCAL INPATH '/data/6/hive-local/p0416.mtv.cloudera.com-hiveptest-2/source/data/files/kv1.txt' OVERWRITE INTO TABLE srcpart PARTITION (ds='2008-04-08',hr='11')
-PREHOOK: type: LOAD
-PREHOOK: Output: default@srcpart
-	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.run(JUnitTestRunner.java:520)
-	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.launch(JUnitTestRunner.java:1060)
-	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.main(JUnitTestRunner.java:911)
-]]></system-err>
-</testsuite>
diff --git a/testutils/ptest2/src/test/resources/test-outputs/TEST-skewjoin_union_remove_1.q-6fa31776-d2b0-4e13-9761-11f750627ad1-TEST-org.apache.hadoop.hive.cli.TestCliDriver.xml b/testutils/ptest2/src/test/resources/test-outputs/TEST-skewjoin_union_remove_1.q-6fa31776-d2b0-4e13-9761-11f750627ad1-TEST-org.apache.hadoop.hive.cli.TestCliDriver.xml
index fdf82c3446..e69de29bb2 100644
--- a/testutils/ptest2/src/test/resources/test-outputs/TEST-skewjoin_union_remove_1.q-6fa31776-d2b0-4e13-9761-11f750627ad1-TEST-org.apache.hadoop.hive.cli.TestCliDriver.xml
+++ b/testutils/ptest2/src/test/resources/test-outputs/TEST-skewjoin_union_remove_1.q-6fa31776-d2b0-4e13-9761-11f750627ad1-TEST-org.apache.hadoop.hive.cli.TestCliDriver.xml
@@ -1,51 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" ?>
-<testsuite errors="0" failures="1" hostname="p0415.mtv.cloudera.com" name="org.apache.hadoop.hive.cli.TestCliDriver" tests="2" time="154.481" timestamp="2013-01-28T01:00:34">
-  <properties>
-    <property name="hadoop.bin.path" value="/data/6/hive-local/p0415.mtv.cloudera.com-hiveptest-15/source/testutils/hadoop" />
-    <property name="eclipse.launch.jvm.args" value="-Xms256m -Xmx1024m" />
-    <property name="commons-cli.version" value="1.2" />
-    <property name="ivy_repo_url" value="http://repo2.maven.org/maven2/org/apache/ivy/ivy/2.1.0/ivy-2.1.0.jar" />
-    <property name="snapshots.cloudera.com.ql.ivy.settings" value="https://repository.cloudera.com/artifactory/libs-snapshot-local/" />
-    <property name="is-offline" value="false" />
-  </properties>
-  <testcase classname="org.apache.hadoop.hive.cli.TestCliDriver" name="testCliDriver_skewjoin_union_remove_1" time="117.885">
-    <failure message="Unexpected exception&#xa;See build/ql/tmp/hive.log, or try &quot;ant test ... -Dtest.silent=false&quot; to get more logs." type="junit.framework.AssertionFailedError">junit.framework.AssertionFailedError: Unexpected exception
-See build/ql/tmp/hive.log, or try &quot;ant test ... -Dtest.silent=false&quot; to get more logs.
-	at junit.framework.Assert.fail(Assert.java:50)
-	at org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_skewjoin_union_remove_1(TestCliDriver.java:156)
-	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
-	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
-	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
-	at java.lang.reflect.Method.invoke(Method.java:597)
-	at junit.framework.TestCase.runTest(TestCase.java:168)
-	at junit.framework.TestCase.runBare(TestCase.java:134)
-	at junit.framework.TestResult$1.protect(TestResult.java:110)
-	at junit.framework.TestResult.runProtected(TestResult.java:128)
-	at junit.framework.TestResult.run(TestResult.java:113)
-	at junit.framework.TestCase.run(TestCase.java:124)
-	at junit.framework.TestSuite.runTest(TestSuite.java:243)
-	at junit.framework.TestSuite.run(TestSuite.java:238)
-	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.run(JUnitTestRunner.java:520)
-	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.launch(JUnitTestRunner.java:1060)
-	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.main(JUnitTestRunner.java:911)
-</failure>
-  </testcase>
-  <testcase classname="org.apache.hadoop.hive.cli.TestCliDriver" name="testCliDriver_shutdown" time="36.577" />
-  <system-out><![CDATA[Begin query: skewjoin_union_remove_1.q
-Deleted /data/6/hive-local/p0415.mtv.cloudera.com-hiveptest-15/source/build/ql/test/data/warehouse/dest1
-Exception: Client Execution failed with error code = 1
-See build/ql/tmp/hive.log, or try "ant test ... -Dtest.silent=false" to get more logs.
-Failed query: skewjoin_union_remove_1.q
-Cleaning up TestCliDriver
-]]></system-out>
-  <system-err><![CDATA[WARNING: org.apache.hadoop.metrics.jvm.EventCounter is deprecated. Please use org.apache.hadoop.log.metrics.EventCounter in all the log4j.properties files.
-Hive history file=/data/6/hive-local/p0415.mtv.cloudera.com-hiveptest-15/source/build/ql/tmp/hive_job_log_hiveptest_201301271657_1229235931.txt
-Hive history file=/data/6/hive-local/p0415.mtv.cloudera.com-hiveptest-15/source/build/ql/tmp/hive_job_log_hiveptest_201301271657_548672592.txt
-PREHOOK: query: LOAD DATA LOCAL INPATH '/data/6/hive-local/p0415.mtv.cloudera.com-hiveptest-15/source/data/files/kv1.txt' OVERWRITE INTO TABLE srcpart PARTITION (ds='2008-04-08',hr='11')
-PREHOOK: type: LOAD
-PREHOOK: Output: default@srcpart
-	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.run(JUnitTestRunner.java:520)
-	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.launch(JUnitTestRunner.java:1060)
-	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.main(JUnitTestRunner.java:911)
-]]></system-err>
-</testsuite>
diff --git a/testutils/ptest2/src/test/resources/test-outputs/TEST-union_remove_9.q-acb9de8f-1b9c-4874-924c-b2107ca7b07c-TEST-org.apache.hadoop.hive.cli.TestCliDriver.xml b/testutils/ptest2/src/test/resources/test-outputs/TEST-union_remove_9.q-acb9de8f-1b9c-4874-924c-b2107ca7b07c-TEST-org.apache.hadoop.hive.cli.TestCliDriver.xml
index fdddd36f84..e69de29bb2 100644
--- a/testutils/ptest2/src/test/resources/test-outputs/TEST-union_remove_9.q-acb9de8f-1b9c-4874-924c-b2107ca7b07c-TEST-org.apache.hadoop.hive.cli.TestCliDriver.xml
+++ b/testutils/ptest2/src/test/resources/test-outputs/TEST-union_remove_9.q-acb9de8f-1b9c-4874-924c-b2107ca7b07c-TEST-org.apache.hadoop.hive.cli.TestCliDriver.xml
@@ -1,53 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" ?>
-<testsuite errors="0" failures="1" hostname="p0416.mtv.cloudera.com" name="org.apache.hadoop.hive.cli.TestCliDriver" tests="2" time="91.132" timestamp="2013-01-28T01:02:54">
-  <properties>
-    <property name="hadoop.bin.path" value="/data/6/hive-local/p0416.mtv.cloudera.com-hiveptest-2/source/testutils/hadoop" />
-    <property name="hadoop.mirror2" value="http://archive.cloudera.com/hive-deps" />
-    <property name="basedir.ql.ivy.settings" value="/data/6/hive-local/p0416.mtv.cloudera.com-hiveptest-2/source/ql" />
-    <property name="ivy_repo_url" value="http://repo2.maven.org/maven2/org/apache/ivy/ivy/2.1.0/ivy-2.1.0.jar" />
-    <property name="snapshots.cloudera.com.ql.ivy.settings" value="https://repository.cloudera.com/artifactory/libs-snapshot-local/" />
-    <property name="is-offline" value="false" />
-  </properties>
-  <testcase classname="org.apache.hadoop.hive.cli.TestCliDriver" name="testCliDriver_union_remove_9" time="58.55">
-    <failure message="Unexpected exception&#xa;See build/ql/tmp/hive.log, or try &quot;ant test ... -Dtest.silent=false&quot; to get more logs." type="junit.framework.AssertionFailedError">junit.framework.AssertionFailedError: Unexpected exception
-See build/ql/tmp/hive.log, or try &quot;ant test ... -Dtest.silent=false&quot; to get more logs.
-	at junit.framework.Assert.fail(Assert.java:50)
-	at org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_union_remove_9(TestCliDriver.java:156)
-	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
-	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
-	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
-	at java.lang.reflect.Method.invoke(Method.java:597)
-	at junit.framework.TestCase.runTest(TestCase.java:168)
-	at junit.framework.TestCase.runBare(TestCase.java:134)
-	at junit.framework.TestResult$1.protect(TestResult.java:110)
-	at junit.framework.TestResult.runProtected(TestResult.java:128)
-	at junit.framework.TestResult.run(TestResult.java:113)
-	at junit.framework.TestCase.run(TestCase.java:124)
-	at junit.framework.TestSuite.runTest(TestSuite.java:243)
-	at junit.framework.TestSuite.run(TestSuite.java:238)
-	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.run(JUnitTestRunner.java:520)
-	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.launch(JUnitTestRunner.java:1060)
-	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.main(JUnitTestRunner.java:911)
-</failure>
-  </testcase>
-  <testcase classname="org.apache.hadoop.hive.cli.TestCliDriver" name="testCliDriver_shutdown" time="32.562" />
-  <system-out><![CDATA[Begin query: union_remove_9.q
-Deleted /data/6/hive-local/p0416.mtv.cloudera.com-hiveptest-2/source/build/ql/test/data/warehouse/outputtbl1
-Exception: Client Execution failed with error code = 1
-See build/ql/tmp/hive.log, or try "ant test ... -Dtest.silent=false" to get more logs.
-Failed query: union_remove_9.q
-Cleaning up TestCliDriver
-]]></system-out>
-  <system-err><![CDATA[WARNING: org.apache.hadoop.metrics.jvm.EventCounter is deprecated. Please use org.apache.hadoop.log.metrics.EventCounter in all the log4j.properties files.
-Hive history file=/data/6/hive-local/p0416.mtv.cloudera.com-hiveptest-2/source/build/ql/tmp/hive_job_log_hiveptest_201301271659_834844307.txt
-	at junit.framework.TestResult$1.protect(TestResult.java:110)
-	at junit.framework.TestResult.runProtected(TestResult.java:128)
-	at junit.framework.TestResult.run(TestResult.java:113)
-	at junit.framework.TestCase.run(TestCase.java:124)
-	at junit.framework.TestSuite.runTest(TestSuite.java:243)
-	at junit.framework.TestSuite.run(TestSuite.java:238)
-	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.run(JUnitTestRunner.java:520)
-	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.launch(JUnitTestRunner.java:1060)
-	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.main(JUnitTestRunner.java:911)
-]]></system-err>
-</testsuite>
diff --git a/testutils/ptest2/src/test/resources/test-outputs/index_auth.q-TEST-org.apache.hadoop.hive.cli.TestCliDriver.xml b/testutils/ptest2/src/test/resources/test-outputs/index_auth.q-TEST-org.apache.hadoop.hive.cli.TestCliDriver.xml
new file mode 100644
index 0000000000..dcf4d4f0af
--- /dev/null
+++ b/testutils/ptest2/src/test/resources/test-outputs/index_auth.q-TEST-org.apache.hadoop.hive.cli.TestCliDriver.xml
@@ -0,0 +1,34 @@
+<?xml version="1.0" encoding="UTF-8" ?>
+<testsuite errors="0" failures="0" hostname="p0416.mtv.cloudera.com" name="org.apache.hadoop.hive.cli.TestCliDriver" tests="14" time="567.873" timestamp="2013-01-28T01:13:29">
+  <properties>
+    <property name="hadoop.bin.path" value="/data/6/hive-local/p0416.mtv.cloudera.com-hiveptest-8/source/testutils/hadoop" />
+    <property name="commons-cli.version" value="1.2" />
+    <property name="ivy_repo_url" value="http://repo2.maven.org/maven2/org/apache/ivy/ivy/2.1.0/ivy-2.1.0.jar" />
+    <property name="snapshots.cloudera.com.ql.ivy.settings" value="https://repository.cloudera.com/artifactory/libs-snapshot-local/" />
+    <property name="is-offline" value="false" />
+  </properties>
+  <testcase classname="org.apache.hadoop.hive.cli.TestCliDriver" name="testCliDriver_authorization_2" time="252.494" />
+  <testcase classname="org.apache.hadoop.hive.cli.TestCliDriver" name="testCliDriver_auto_join17" time="21.234" />
+  <testcase classname="org.apache.hadoop.hive.cli.TestCliDriver" name="testCliDriver_binary_constant" time="5.314" />
+  <testcase classname="org.apache.hadoop.hive.cli.TestCliDriver" name="testCliDriver_bucketcontext_3" time="34.151" />
+  <testcase classname="org.apache.hadoop.hive.cli.TestCliDriver" name="testCliDriver_groupby_rollup1" time="74.646" />
+  <testcase classname="org.apache.hadoop.hive.cli.TestCliDriver" name="testCliDriver_index_auth" time="10.633" />
+  <testcase classname="org.apache.hadoop.hive.cli.TestCliDriver" name="testCliDriver_index_bitmap2" time="46.858" />
+  <testcase classname="org.apache.hadoop.hive.cli.TestCliDriver" name="testCliDriver_load_dyn_part3" time="11.091" />
+  <testcase classname="org.apache.hadoop.hive.cli.TestCliDriver" name="testCliDriver_multi_insert_gby" time="39.365" />
+  <testcase classname="org.apache.hadoop.hive.cli.TestCliDriver" name="testCliDriver_notable_alias1" time="8.025" />
+  <testcase classname="org.apache.hadoop.hive.cli.TestCliDriver" name="testCliDriver_ppd_join" time="14.558" />
+  <testcase classname="org.apache.hadoop.hive.cli.TestCliDriver" name="testCliDriver_rcfile_lazydecompress" time="47.846" />
+  <testcase classname="org.apache.hadoop.hive.cli.TestCliDriver" name="testCliDriver_udf_regexp_extract" time="0.392" />
+  <testcase classname="org.apache.hadoop.hive.cli.TestCliDriver" name="testCliDriver_shutdown" time="0.792" />
+  <system-out><![CDATA[Begin query: authorization_2.q
+diff -a /data/6/hive-local/p0416.mtv.cloudera.com-hiveptest-8/source/build/ql/test/logs/clientpositive/authorization_2.q.out /data/6/hive-local/p0416.mtv.cloudera.com-hiveptest-8/source/ql/src/test/results/clientpositive/authorization_2.q.out
+Done query: authorization_2.q elapsedTime=241s
+Begin query: auto_join17.q
+rmr: DEPRECATED: Please use 'rm -r' instead.
+WARNING: org.apache.hadoop.metrics.jvm.EventCounter is deprecated. Please use org.apache.hadoop.log.metrics.EventCounter in all the log4j.properties files.
+WARNING: org.apache.hadoop.metrics.jvm.EventCounter is deprecated. Please use org.apache.hadoop.log.metrics.EventCounter in all the log4j.properties files.
+WARNING: org.apache.hadoop.metrics.jvm.EventCounter is deprecated. Please use org.apache.hadoop.log.metrics.EventCounter in all the log4j.properties files.
+WARNING: org.apache.hadoop.metrics.jvm.EventCounter is deprecated. Please use org.apache.hadoop.log.metrics.EventCounter in all the log4j.properties files.
+]]></system-out>
+</testsuite>
diff --git a/testutils/ptest2/src/test/resources/test-outputs/index_auth.q-bucketcontex-ba31fb54-1d7f-4c70-a89d-477b7d155191-hive.log b/testutils/ptest2/src/test/resources/test-outputs/index_auth.q-bucketcontex-ba31fb54-1d7f-4c70-a89d-477b7d155191-hive.log
index bf4e0a8cda..e69de29bb2 100644
--- a/testutils/ptest2/src/test/resources/test-outputs/index_auth.q-bucketcontex-ba31fb54-1d7f-4c70-a89d-477b7d155191-hive.log
+++ b/testutils/ptest2/src/test/resources/test-outputs/index_auth.q-bucketcontex-ba31fb54-1d7f-4c70-a89d-477b7d155191-hive.log
@@ -1,10 +0,0 @@
-2013-01-27 17:22:57,540 INFO  server.NIOServerCnxnFactory (NIOServerCnxnFactory.java:run(224)) - NIOServerCnxn factory exited run method
-2013-01-27 17:22:57,540 INFO  zookeeper.ClientCnxn (ClientCnxn.java:run(1085)) - Unable to read additional data from server sessionid 0x13c7eb59be60001, likely server has closed socket, closing socket connection and attempting reconnect
-2013-01-27 17:22:57,541 INFO  server.ZooKeeperServer (ZooKeeperServer.java:shutdown(419)) - shutting down
-2013-01-27 17:22:57,541 INFO  server.SessionTrackerImpl (SessionTrackerImpl.java:shutdown(225)) - Shutting down
-2013-01-27 17:22:57,541 INFO  server.PrepRequestProcessor (PrepRequestProcessor.java:shutdown(743)) - Shutting down
-2013-01-27 17:22:57,541 INFO  server.SyncRequestProcessor (SyncRequestProcessor.java:shutdown(175)) - Shutting down
-2013-01-27 17:22:57,541 INFO  server.PrepRequestProcessor (PrepRequestProcessor.java:run(143)) - PrepRequestProcessor exited loop!
-2013-01-27 17:22:57,541 INFO  server.SyncRequestProcessor (SyncRequestProcessor.java:run(155)) - SyncRequestProcessor exited!
-2013-01-27 17:22:57,542 INFO  server.FinalRequestProcessor (FinalRequestProcessor.java:shutdown(415)) - shutdown of request processor complete
-2013-01-27 17:22:57,543 INFO  zookeeper.MiniZooKeeperCluster (MiniZooKeeperCluster.java:shutdown(235)) - Shutdown MiniZK cluster with all ZK servers
diff --git a/testutils/ptest2/src/test/resources/test-outputs/index_auth.q-hive.log b/testutils/ptest2/src/test/resources/test-outputs/index_auth.q-hive.log
new file mode 100644
index 0000000000..bf4e0a8cda
--- /dev/null
+++ b/testutils/ptest2/src/test/resources/test-outputs/index_auth.q-hive.log
@@ -0,0 +1,10 @@
+2013-01-27 17:22:57,540 INFO  server.NIOServerCnxnFactory (NIOServerCnxnFactory.java:run(224)) - NIOServerCnxn factory exited run method
+2013-01-27 17:22:57,540 INFO  zookeeper.ClientCnxn (ClientCnxn.java:run(1085)) - Unable to read additional data from server sessionid 0x13c7eb59be60001, likely server has closed socket, closing socket connection and attempting reconnect
+2013-01-27 17:22:57,541 INFO  server.ZooKeeperServer (ZooKeeperServer.java:shutdown(419)) - shutting down
+2013-01-27 17:22:57,541 INFO  server.SessionTrackerImpl (SessionTrackerImpl.java:shutdown(225)) - Shutting down
+2013-01-27 17:22:57,541 INFO  server.PrepRequestProcessor (PrepRequestProcessor.java:shutdown(743)) - Shutting down
+2013-01-27 17:22:57,541 INFO  server.SyncRequestProcessor (SyncRequestProcessor.java:shutdown(175)) - Shutting down
+2013-01-27 17:22:57,541 INFO  server.PrepRequestProcessor (PrepRequestProcessor.java:run(143)) - PrepRequestProcessor exited loop!
+2013-01-27 17:22:57,541 INFO  server.SyncRequestProcessor (SyncRequestProcessor.java:run(155)) - SyncRequestProcessor exited!
+2013-01-27 17:22:57,542 INFO  server.FinalRequestProcessor (FinalRequestProcessor.java:shutdown(415)) - shutdown of request processor complete
+2013-01-27 17:22:57,543 INFO  zookeeper.MiniZooKeeperCluster (MiniZooKeeperCluster.java:shutdown(235)) - Shutdown MiniZK cluster with all ZK servers
diff --git a/testutils/ptest2/src/test/resources/test-outputs/skewjoin.q-TEST-org.apache.hadoop.hive.cli.TestCliDriver.xml b/testutils/ptest2/src/test/resources/test-outputs/skewjoin.q-TEST-org.apache.hadoop.hive.cli.TestCliDriver.xml
new file mode 100644
index 0000000000..c7d5e9a261
--- /dev/null
+++ b/testutils/ptest2/src/test/resources/test-outputs/skewjoin.q-TEST-org.apache.hadoop.hive.cli.TestCliDriver.xml
@@ -0,0 +1,53 @@
+<?xml version="1.0" encoding="UTF-8" ?>
+<testsuite errors="0" failures="1" hostname="p0416.mtv.cloudera.com" name="org.apache.hadoop.hive.cli.TestCliDriver" tests="2" time="439.527" timestamp="2013-01-28T01:14:46">
+  <properties>
+    <property name="hadoop.bin.path" value="/data/6/hive-local/p0416.mtv.cloudera.com-hiveptest-2/source/testutils/hadoop" />
+    <property name="hadoop.mirror2" value="http://archive.cloudera.com/hive-deps" />
+    <property name="ivy_repo_url" value="http://repo2.maven.org/maven2/org/apache/ivy/ivy/2.1.0/ivy-2.1.0.jar" />
+    <property name="snapshots.cloudera.com.ql.ivy.settings" value="https://repository.cloudera.com/artifactory/libs-snapshot-local/" />
+    <property name="is-offline" value="false" />
+  </properties>
+  <testcase classname="org.apache.hadoop.hive.cli.TestCliDriver" name="testCliDriver_skewjoin" time="434.688">
+    <failure message="Unexpected exception&#xa;See build/ql/tmp/hive.log, or try &quot;ant test ... -Dtest.silent=false&quot; to get more logs." type="junit.framework.AssertionFailedError">junit.framework.AssertionFailedError: Unexpected exception
+See build/ql/tmp/hive.log, or try &quot;ant test ... -Dtest.silent=false&quot; to get more logs.
+	at junit.framework.Assert.fail(Assert.java:50)
+	at org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_skewjoin(TestCliDriver.java:156)
+	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
+	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
+	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
+	at java.lang.reflect.Method.invoke(Method.java:597)
+	at junit.framework.TestCase.runTest(TestCase.java:168)
+	at junit.framework.TestCase.runBare(TestCase.java:134)
+	at junit.framework.TestResult$1.protect(TestResult.java:110)
+	at junit.framework.TestResult.runProtected(TestResult.java:128)
+	at junit.framework.TestResult.run(TestResult.java:113)
+	at junit.framework.TestCase.run(TestCase.java:124)
+	at junit.framework.TestSuite.runTest(TestSuite.java:243)
+	at junit.framework.TestSuite.run(TestSuite.java:238)
+	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.run(JUnitTestRunner.java:520)
+	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.launch(JUnitTestRunner.java:1060)
+	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.main(JUnitTestRunner.java:911)
+</failure>
+  </testcase>
+  <testcase classname="org.apache.hadoop.hive.cli.TestCliDriver" name="testCliDriver_shutdown" time="4.824" />
+  <system-out><![CDATA[Begin query: skewjoin.q
+Deleted /data/6/hive-local/p0416.mtv.cloudera.com-hiveptest-2/source/build/ql/test/data/warehouse/dest_j1
+diff -a /data/6/hive-local/p0416.mtv.cloudera.com-hiveptest-2/source/build/ql/test/logs/clientpositive/skewjoin.q.out /data/6/hive-local/p0416.mtv.cloudera.com-hiveptest-2/source/ql/src/test/results/clientpositive/skewjoin.q.out
+1513a1514
+> 293143	-136853010385
+Exception: Client execution results failed with error code = 1
+See build/ql/tmp/hive.log, or try "ant test ... -Dtest.silent=false" to get more logs.
+Failed query: skewjoin.q
+Cleaning up TestCliDriver
+]]></system-out>
+  <system-err><![CDATA[WARNING: org.apache.hadoop.metrics.jvm.EventCounter is deprecated. Please use org.apache.hadoop.log.metrics.EventCounter in all the log4j.properties files.
+Hive history file=/data/6/hive-local/p0416.mtv.cloudera.com-hiveptest-2/source/build/ql/tmp/hive_job_log_hiveptest_201301271712_1670514421.txt
+Hive history file=/data/6/hive-local/p0416.mtv.cloudera.com-hiveptest-2/source/build/ql/tmp/hive_job_log_hiveptest_201301271712_1323090315.txt
+PREHOOK: query: LOAD DATA LOCAL INPATH '/data/6/hive-local/p0416.mtv.cloudera.com-hiveptest-2/source/data/files/kv1.txt' OVERWRITE INTO TABLE srcpart PARTITION (ds='2008-04-08',hr='11')
+PREHOOK: type: LOAD
+PREHOOK: Output: default@srcpart
+	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.run(JUnitTestRunner.java:520)
+	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.launch(JUnitTestRunner.java:1060)
+	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.main(JUnitTestRunner.java:911)
+]]></system-err>
+</testsuite>
diff --git a/testutils/ptest2/src/test/resources/test-outputs/skewjoin.q-ab8536a7-1b5c-45ed-ba29-14450f27db8b-TestCliDriver.txt b/testutils/ptest2/src/test/resources/test-outputs/skewjoin.q-ab8536a7-1b5c-45ed-ba29-14450f27db8b-TestCliDriver.txt
index d495d05e2c..e69de29bb2 100644
--- a/testutils/ptest2/src/test/resources/test-outputs/skewjoin.q-ab8536a7-1b5c-45ed-ba29-14450f27db8b-TestCliDriver.txt
+++ b/testutils/ptest2/src/test/resources/test-outputs/skewjoin.q-ab8536a7-1b5c-45ed-ba29-14450f27db8b-TestCliDriver.txt
@@ -1,10 +0,0 @@
-
-BUILD FAILED
-/data/6/hive-local/p0416.mtv.cloudera.com-hiveptest-2/source/build.xml:349: Keepgoing execution: 1 of 13 iterations failed.
-
-Total time: 17 minutes 15 seconds
-'
-	at com.cloudera.hive.ptest.PTest.run(PTest.java:220)
-	at com.cloudera.hive.ptest.PTest.runAllTests(PTest.java:138)
-	at com.cloudera.hive.ptest.PTest.run(PTest.java:72)
-	at com.cloudera.hive.ptest.PTest.main(PTest.java:345)
diff --git a/testutils/ptest2/src/test/resources/test-outputs/skewjoin.q-ab8536a7-1b5c-45ed-ba29-14450f27db8b-hive.log b/testutils/ptest2/src/test/resources/test-outputs/skewjoin.q-ab8536a7-1b5c-45ed-ba29-14450f27db8b-hive.log
index f483fb867e..e69de29bb2 100644
--- a/testutils/ptest2/src/test/resources/test-outputs/skewjoin.q-ab8536a7-1b5c-45ed-ba29-14450f27db8b-hive.log
+++ b/testutils/ptest2/src/test/resources/test-outputs/skewjoin.q-ab8536a7-1b5c-45ed-ba29-14450f27db8b-hive.log
@@ -1,10 +0,0 @@
-2013-01-27 17:22:05,609 INFO  server.NIOServerCnxnFactory (NIOServerCnxnFactory.java:run(224)) - NIOServerCnxn factory exited run method
-2013-01-27 17:22:05,609 INFO  server.ZooKeeperServer (ZooKeeperServer.java:shutdown(419)) - shutting down
-2013-01-27 17:22:05,609 INFO  zookeeper.ClientCnxn (ClientCnxn.java:run(1085)) - Unable to read additional data from server sessionid 0x13c7eb6a72e0001, likely server has closed socket, closing socket connection and attempting reconnect
-2013-01-27 17:22:05,609 INFO  server.SessionTrackerImpl (SessionTrackerImpl.java:shutdown(225)) - Shutting down
-2013-01-27 17:22:05,609 INFO  server.PrepRequestProcessor (PrepRequestProcessor.java:shutdown(743)) - Shutting down
-2013-01-27 17:22:05,610 INFO  server.SyncRequestProcessor (SyncRequestProcessor.java:shutdown(175)) - Shutting down
-2013-01-27 17:22:05,610 INFO  server.PrepRequestProcessor (PrepRequestProcessor.java:run(143)) - PrepRequestProcessor exited loop!
-2013-01-27 17:22:05,610 INFO  server.SyncRequestProcessor (SyncRequestProcessor.java:run(155)) - SyncRequestProcessor exited!
-2013-01-27 17:22:05,610 INFO  server.FinalRequestProcessor (FinalRequestProcessor.java:shutdown(415)) - shutdown of request processor complete
-2013-01-27 17:22:05,611 INFO  zookeeper.MiniZooKeeperCluster (MiniZooKeeperCluster.java:shutdown(235)) - Shutdown MiniZK cluster with all ZK servers
diff --git a/testutils/ptest2/src/test/resources/test-outputs/skewjoin_union_remove_1.q-6fa31776-d2b0-4e13-9761-11f750627ad1-TestCliDriver.txt b/testutils/ptest2/src/test/resources/test-outputs/skewjoin_union_remove_1.q-6fa31776-d2b0-4e13-9761-11f750627ad1-TestCliDriver.txt
index 0f827894ba..e69de29bb2 100644
--- a/testutils/ptest2/src/test/resources/test-outputs/skewjoin_union_remove_1.q-6fa31776-d2b0-4e13-9761-11f750627ad1-TestCliDriver.txt
+++ b/testutils/ptest2/src/test/resources/test-outputs/skewjoin_union_remove_1.q-6fa31776-d2b0-4e13-9761-11f750627ad1-TestCliDriver.txt
@@ -1,10 +0,0 @@
-
-BUILD FAILED
-/data/6/hive-local/p0415.mtv.cloudera.com-hiveptest-15/source/build.xml:349: Keepgoing execution: 1 of 13 iterations failed.
-
-Total time: 12 minutes 39 seconds
-'
-	at com.cloudera.hive.ptest.PTest.run(PTest.java:220)
-	at com.cloudera.hive.ptest.PTest.runAllTests(PTest.java:138)
-	at com.cloudera.hive.ptest.PTest.run(PTest.java:72)
-	at com.cloudera.hive.ptest.PTest.main(PTest.java:345)
diff --git a/testutils/ptest2/src/test/resources/test-outputs/skewjoin_union_remove_1.q-6fa31776-d2b0-4e13-9761-11f750627ad1-hive.log b/testutils/ptest2/src/test/resources/test-outputs/skewjoin_union_remove_1.q-6fa31776-d2b0-4e13-9761-11f750627ad1-hive.log
index ebae0bf928..e69de29bb2 100644
--- a/testutils/ptest2/src/test/resources/test-outputs/skewjoin_union_remove_1.q-6fa31776-d2b0-4e13-9761-11f750627ad1-hive.log
+++ b/testutils/ptest2/src/test/resources/test-outputs/skewjoin_union_remove_1.q-6fa31776-d2b0-4e13-9761-11f750627ad1-hive.log
@@ -1,10 +0,0 @@
-2013-01-27 17:03:09,281 INFO  server.NIOServerCnxnFactory (NIOServerCnxnFactory.java:run(224)) - NIOServerCnxn factory exited run method
-2013-01-27 17:03:09,281 INFO  zookeeper.ClientCnxn (ClientCnxn.java:run(1085)) - Unable to read additional data from server sessionid 0x13c7ea913980001, likely server has closed socket, closing socket connection and attempting reconnect
-2013-01-27 17:03:09,281 INFO  server.ZooKeeperServer (ZooKeeperServer.java:shutdown(419)) - shutting down
-2013-01-27 17:03:09,281 INFO  server.SessionTrackerImpl (SessionTrackerImpl.java:shutdown(225)) - Shutting down
-2013-01-27 17:03:09,281 INFO  server.PrepRequestProcessor (PrepRequestProcessor.java:shutdown(743)) - Shutting down
-2013-01-27 17:03:09,282 INFO  server.SyncRequestProcessor (SyncRequestProcessor.java:shutdown(175)) - Shutting down
-2013-01-27 17:03:09,282 INFO  server.PrepRequestProcessor (PrepRequestProcessor.java:run(143)) - PrepRequestProcessor exited loop!
-2013-01-27 17:03:09,282 INFO  server.SyncRequestProcessor (SyncRequestProcessor.java:run(155)) - SyncRequestProcessor exited!
-2013-01-27 17:03:09,282 INFO  server.FinalRequestProcessor (FinalRequestProcessor.java:shutdown(415)) - shutdown of request processor complete
-2013-01-27 17:03:09,283 INFO  zookeeper.MiniZooKeeperCluster (MiniZooKeeperCluster.java:shutdown(235)) - Shutdown MiniZK cluster with all ZK servers
diff --git a/testutils/ptest2/src/test/resources/test-outputs/skewjoin_union_remove_1.q-TEST-org.apache.hadoop.hive.cli.TestCliDriver.xml b/testutils/ptest2/src/test/resources/test-outputs/skewjoin_union_remove_1.q-TEST-org.apache.hadoop.hive.cli.TestCliDriver.xml
new file mode 100644
index 0000000000..fdf82c3446
--- /dev/null
+++ b/testutils/ptest2/src/test/resources/test-outputs/skewjoin_union_remove_1.q-TEST-org.apache.hadoop.hive.cli.TestCliDriver.xml
@@ -0,0 +1,51 @@
+<?xml version="1.0" encoding="UTF-8" ?>
+<testsuite errors="0" failures="1" hostname="p0415.mtv.cloudera.com" name="org.apache.hadoop.hive.cli.TestCliDriver" tests="2" time="154.481" timestamp="2013-01-28T01:00:34">
+  <properties>
+    <property name="hadoop.bin.path" value="/data/6/hive-local/p0415.mtv.cloudera.com-hiveptest-15/source/testutils/hadoop" />
+    <property name="eclipse.launch.jvm.args" value="-Xms256m -Xmx1024m" />
+    <property name="commons-cli.version" value="1.2" />
+    <property name="ivy_repo_url" value="http://repo2.maven.org/maven2/org/apache/ivy/ivy/2.1.0/ivy-2.1.0.jar" />
+    <property name="snapshots.cloudera.com.ql.ivy.settings" value="https://repository.cloudera.com/artifactory/libs-snapshot-local/" />
+    <property name="is-offline" value="false" />
+  </properties>
+  <testcase classname="org.apache.hadoop.hive.cli.TestCliDriver" name="testCliDriver_skewjoin_union_remove_1" time="117.885">
+    <failure message="Unexpected exception&#xa;See build/ql/tmp/hive.log, or try &quot;ant test ... -Dtest.silent=false&quot; to get more logs." type="junit.framework.AssertionFailedError">junit.framework.AssertionFailedError: Unexpected exception
+See build/ql/tmp/hive.log, or try &quot;ant test ... -Dtest.silent=false&quot; to get more logs.
+	at junit.framework.Assert.fail(Assert.java:50)
+	at org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_skewjoin_union_remove_1(TestCliDriver.java:156)
+	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
+	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
+	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
+	at java.lang.reflect.Method.invoke(Method.java:597)
+	at junit.framework.TestCase.runTest(TestCase.java:168)
+	at junit.framework.TestCase.runBare(TestCase.java:134)
+	at junit.framework.TestResult$1.protect(TestResult.java:110)
+	at junit.framework.TestResult.runProtected(TestResult.java:128)
+	at junit.framework.TestResult.run(TestResult.java:113)
+	at junit.framework.TestCase.run(TestCase.java:124)
+	at junit.framework.TestSuite.runTest(TestSuite.java:243)
+	at junit.framework.TestSuite.run(TestSuite.java:238)
+	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.run(JUnitTestRunner.java:520)
+	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.launch(JUnitTestRunner.java:1060)
+	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.main(JUnitTestRunner.java:911)
+</failure>
+  </testcase>
+  <testcase classname="org.apache.hadoop.hive.cli.TestCliDriver" name="testCliDriver_shutdown" time="36.577" />
+  <system-out><![CDATA[Begin query: skewjoin_union_remove_1.q
+Deleted /data/6/hive-local/p0415.mtv.cloudera.com-hiveptest-15/source/build/ql/test/data/warehouse/dest1
+Exception: Client Execution failed with error code = 1
+See build/ql/tmp/hive.log, or try "ant test ... -Dtest.silent=false" to get more logs.
+Failed query: skewjoin_union_remove_1.q
+Cleaning up TestCliDriver
+]]></system-out>
+  <system-err><![CDATA[WARNING: org.apache.hadoop.metrics.jvm.EventCounter is deprecated. Please use org.apache.hadoop.log.metrics.EventCounter in all the log4j.properties files.
+Hive history file=/data/6/hive-local/p0415.mtv.cloudera.com-hiveptest-15/source/build/ql/tmp/hive_job_log_hiveptest_201301271657_1229235931.txt
+Hive history file=/data/6/hive-local/p0415.mtv.cloudera.com-hiveptest-15/source/build/ql/tmp/hive_job_log_hiveptest_201301271657_548672592.txt
+PREHOOK: query: LOAD DATA LOCAL INPATH '/data/6/hive-local/p0415.mtv.cloudera.com-hiveptest-15/source/data/files/kv1.txt' OVERWRITE INTO TABLE srcpart PARTITION (ds='2008-04-08',hr='11')
+PREHOOK: type: LOAD
+PREHOOK: Output: default@srcpart
+	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.run(JUnitTestRunner.java:520)
+	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.launch(JUnitTestRunner.java:1060)
+	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.main(JUnitTestRunner.java:911)
+]]></system-err>
+</testsuite>
diff --git a/testutils/ptest2/src/test/resources/test-outputs/skewjoin_union_remove_1.q-TestCliDriver.txt b/testutils/ptest2/src/test/resources/test-outputs/skewjoin_union_remove_1.q-TestCliDriver.txt
new file mode 100644
index 0000000000..0f827894ba
--- /dev/null
+++ b/testutils/ptest2/src/test/resources/test-outputs/skewjoin_union_remove_1.q-TestCliDriver.txt
@@ -0,0 +1,10 @@
+
+BUILD FAILED
+/data/6/hive-local/p0415.mtv.cloudera.com-hiveptest-15/source/build.xml:349: Keepgoing execution: 1 of 13 iterations failed.
+
+Total time: 12 minutes 39 seconds
+'
+	at com.cloudera.hive.ptest.PTest.run(PTest.java:220)
+	at com.cloudera.hive.ptest.PTest.runAllTests(PTest.java:138)
+	at com.cloudera.hive.ptest.PTest.run(PTest.java:72)
+	at com.cloudera.hive.ptest.PTest.main(PTest.java:345)
diff --git a/testutils/ptest2/src/test/resources/test-outputs/union_remove_9.q-TEST-org.apache.hadoop.hive.cli.TestCliDriver.xml b/testutils/ptest2/src/test/resources/test-outputs/union_remove_9.q-TEST-org.apache.hadoop.hive.cli.TestCliDriver.xml
new file mode 100644
index 0000000000..fdddd36f84
--- /dev/null
+++ b/testutils/ptest2/src/test/resources/test-outputs/union_remove_9.q-TEST-org.apache.hadoop.hive.cli.TestCliDriver.xml
@@ -0,0 +1,53 @@
+<?xml version="1.0" encoding="UTF-8" ?>
+<testsuite errors="0" failures="1" hostname="p0416.mtv.cloudera.com" name="org.apache.hadoop.hive.cli.TestCliDriver" tests="2" time="91.132" timestamp="2013-01-28T01:02:54">
+  <properties>
+    <property name="hadoop.bin.path" value="/data/6/hive-local/p0416.mtv.cloudera.com-hiveptest-2/source/testutils/hadoop" />
+    <property name="hadoop.mirror2" value="http://archive.cloudera.com/hive-deps" />
+    <property name="basedir.ql.ivy.settings" value="/data/6/hive-local/p0416.mtv.cloudera.com-hiveptest-2/source/ql" />
+    <property name="ivy_repo_url" value="http://repo2.maven.org/maven2/org/apache/ivy/ivy/2.1.0/ivy-2.1.0.jar" />
+    <property name="snapshots.cloudera.com.ql.ivy.settings" value="https://repository.cloudera.com/artifactory/libs-snapshot-local/" />
+    <property name="is-offline" value="false" />
+  </properties>
+  <testcase classname="org.apache.hadoop.hive.cli.TestCliDriver" name="testCliDriver_union_remove_9" time="58.55">
+    <failure message="Unexpected exception&#xa;See build/ql/tmp/hive.log, or try &quot;ant test ... -Dtest.silent=false&quot; to get more logs." type="junit.framework.AssertionFailedError">junit.framework.AssertionFailedError: Unexpected exception
+See build/ql/tmp/hive.log, or try &quot;ant test ... -Dtest.silent=false&quot; to get more logs.
+	at junit.framework.Assert.fail(Assert.java:50)
+	at org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_union_remove_9(TestCliDriver.java:156)
+	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
+	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
+	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
+	at java.lang.reflect.Method.invoke(Method.java:597)
+	at junit.framework.TestCase.runTest(TestCase.java:168)
+	at junit.framework.TestCase.runBare(TestCase.java:134)
+	at junit.framework.TestResult$1.protect(TestResult.java:110)
+	at junit.framework.TestResult.runProtected(TestResult.java:128)
+	at junit.framework.TestResult.run(TestResult.java:113)
+	at junit.framework.TestCase.run(TestCase.java:124)
+	at junit.framework.TestSuite.runTest(TestSuite.java:243)
+	at junit.framework.TestSuite.run(TestSuite.java:238)
+	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.run(JUnitTestRunner.java:520)
+	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.launch(JUnitTestRunner.java:1060)
+	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.main(JUnitTestRunner.java:911)
+</failure>
+  </testcase>
+  <testcase classname="org.apache.hadoop.hive.cli.TestCliDriver" name="testCliDriver_shutdown" time="32.562" />
+  <system-out><![CDATA[Begin query: union_remove_9.q
+Deleted /data/6/hive-local/p0416.mtv.cloudera.com-hiveptest-2/source/build/ql/test/data/warehouse/outputtbl1
+Exception: Client Execution failed with error code = 1
+See build/ql/tmp/hive.log, or try "ant test ... -Dtest.silent=false" to get more logs.
+Failed query: union_remove_9.q
+Cleaning up TestCliDriver
+]]></system-out>
+  <system-err><![CDATA[WARNING: org.apache.hadoop.metrics.jvm.EventCounter is deprecated. Please use org.apache.hadoop.log.metrics.EventCounter in all the log4j.properties files.
+Hive history file=/data/6/hive-local/p0416.mtv.cloudera.com-hiveptest-2/source/build/ql/tmp/hive_job_log_hiveptest_201301271659_834844307.txt
+	at junit.framework.TestResult$1.protect(TestResult.java:110)
+	at junit.framework.TestResult.runProtected(TestResult.java:128)
+	at junit.framework.TestResult.run(TestResult.java:113)
+	at junit.framework.TestCase.run(TestCase.java:124)
+	at junit.framework.TestSuite.runTest(TestSuite.java:243)
+	at junit.framework.TestSuite.run(TestSuite.java:238)
+	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.run(JUnitTestRunner.java:520)
+	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.launch(JUnitTestRunner.java:1060)
+	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.main(JUnitTestRunner.java:911)
+]]></system-err>
+</testsuite>
diff --git a/testutils/ptest2/src/test/resources/test-outputs/union_remove_9.q-acb9de8f-1b9c-4874-924c-b2107ca7b07c-TestCliDriver.txt b/testutils/ptest2/src/test/resources/test-outputs/union_remove_9.q-acb9de8f-1b9c-4874-924c-b2107ca7b07c-TestCliDriver.txt
index 6465594609..e69de29bb2 100644
--- a/testutils/ptest2/src/test/resources/test-outputs/union_remove_9.q-acb9de8f-1b9c-4874-924c-b2107ca7b07c-TestCliDriver.txt
+++ b/testutils/ptest2/src/test/resources/test-outputs/union_remove_9.q-acb9de8f-1b9c-4874-924c-b2107ca7b07c-TestCliDriver.txt
@@ -1,10 +0,0 @@
-
-BUILD FAILED
-/data/6/hive-local/p0416.mtv.cloudera.com-hiveptest-2/source/build.xml:349: Keepgoing execution: 1 of 13 iterations failed.
-
-Total time: 13 minutes 56 seconds
-'
-	at com.cloudera.hive.ptest.PTest.run(PTest.java:220)
-	at com.cloudera.hive.ptest.PTest.runAllTests(PTest.java:138)
-	at com.cloudera.hive.ptest.PTest.run(PTest.java:72)
-	at com.cloudera.hive.ptest.PTest.main(PTest.java:345)
diff --git a/testutils/ptest2/src/test/resources/test-outputs/union_remove_9.q-acb9de8f-1b9c-4874-924c-b2107ca7b07c-hive.log b/testutils/ptest2/src/test/resources/test-outputs/union_remove_9.q-acb9de8f-1b9c-4874-924c-b2107ca7b07c-hive.log
index 7d7548c7a7..e69de29bb2 100644
--- a/testutils/ptest2/src/test/resources/test-outputs/union_remove_9.q-acb9de8f-1b9c-4874-924c-b2107ca7b07c-hive.log
+++ b/testutils/ptest2/src/test/resources/test-outputs/union_remove_9.q-acb9de8f-1b9c-4874-924c-b2107ca7b07c-hive.log
@@ -1,10 +0,0 @@
-2013-01-27 17:04:25,273 INFO  server.NIOServerCnxnFactory (NIOServerCnxnFactory.java:run(224)) - NIOServerCnxn factory exited run method
-2013-01-27 17:04:25,273 INFO  zookeeper.ClientCnxn (ClientCnxn.java:run(1085)) - Unable to read additional data from server sessionid 0x13c7eaabc450001, likely server has closed socket, closing socket connection and attempting reconnect
-2013-01-27 17:04:25,273 INFO  server.ZooKeeperServer (ZooKeeperServer.java:shutdown(419)) - shutting down
-2013-01-27 17:04:25,273 INFO  server.SessionTrackerImpl (SessionTrackerImpl.java:shutdown(225)) - Shutting down
-2013-01-27 17:04:25,273 INFO  server.PrepRequestProcessor (PrepRequestProcessor.java:shutdown(743)) - Shutting down
-2013-01-27 17:04:25,274 INFO  server.SyncRequestProcessor (SyncRequestProcessor.java:shutdown(175)) - Shutting down
-2013-01-27 17:04:25,274 INFO  server.PrepRequestProcessor (PrepRequestProcessor.java:run(143)) - PrepRequestProcessor exited loop!
-2013-01-27 17:04:25,274 INFO  server.SyncRequestProcessor (SyncRequestProcessor.java:run(155)) - SyncRequestProcessor exited!
-2013-01-27 17:04:25,274 INFO  server.FinalRequestProcessor (FinalRequestProcessor.java:shutdown(415)) - shutdown of request processor complete
-2013-01-27 17:04:25,275 INFO  zookeeper.MiniZooKeeperCluster (MiniZooKeeperCluster.java:shutdown(235)) - Shutdown MiniZK cluster with all ZK servers
