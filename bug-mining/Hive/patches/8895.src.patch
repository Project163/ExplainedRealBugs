diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/vector/ptf/VectorPTFEvaluatorBase.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/vector/ptf/VectorPTFEvaluatorBase.java
index c45a48b0e2..9243c3cb00 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/vector/ptf/VectorPTFEvaluatorBase.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/vector/ptf/VectorPTFEvaluatorBase.java
@@ -50,6 +50,7 @@ public abstract class VectorPTFEvaluatorBase {
   protected int inputColumnNum;
   protected final int outputColumnNum;
   private boolean nullsLast;
+  private boolean respectNulls = true;
 
   protected final Logger LOG = LoggerFactory.getLogger(getClass());
 
@@ -194,4 +195,12 @@ public boolean isCacheableForRange() {
    */
   public void mapCustomColumns(int[] bufferedColumnMap) {
   }
+
+  public boolean doesRespectNulls() {
+    return respectNulls;
+  }
+
+  public void setRespectNulls(boolean respectNulls) {
+    this.respectNulls = respectNulls;
+  }
 }
\ No newline at end of file
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/vector/ptf/VectorPTFEvaluatorDecimalFirstValue.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/vector/ptf/VectorPTFEvaluatorDecimalFirstValue.java
index 59f16d6d26..d21e882084 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/vector/ptf/VectorPTFEvaluatorDecimalFirstValue.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/vector/ptf/VectorPTFEvaluatorDecimalFirstValue.java
@@ -18,7 +18,6 @@
 
 package org.apache.hadoop.hive.ql.exec.vector.ptf;
 
-import org.apache.hadoop.hive.common.type.HiveDecimal;
 import org.apache.hadoop.hive.ql.exec.vector.ColumnVector.Type;
 import org.apache.hadoop.hive.ql.exec.vector.DecimalColumnVector;
 import org.apache.hadoop.hive.ql.exec.vector.VectorizedRowBatch;
@@ -44,7 +43,6 @@ public class VectorPTFEvaluatorDecimalFirstValue extends VectorPTFEvaluatorBase
   public VectorPTFEvaluatorDecimalFirstValue(WindowFrameDef windowFrameDef,
       VectorExpression inputVecExpr, int outputColumnNum) {
     super(windowFrameDef, inputVecExpr, outputColumnNum);
-    firstValue = new HiveDecimalWritable();
     resetEvaluator();
   }
 
@@ -66,7 +64,6 @@ public void evaluateGroupBatch(VectorizedRowBatch batch)
       }
       DecimalColumnVector decimalColVector = ((DecimalColumnVector) batch.cols[inputColumnNum]);
       if (decimalColVector.isRepeating) {
-
         if (decimalColVector.noNulls || !decimalColVector.isNull[0]) {
           firstValue.set(decimalColVector.vector[0]);
           isGroupResultNull = false;
@@ -74,13 +71,25 @@ public void evaluateGroupBatch(VectorizedRowBatch batch)
       } else if (decimalColVector.noNulls) {
         firstValue.set(decimalColVector.vector[0]);
         isGroupResultNull = false;
-      } else {
+      } else if (doesRespectNulls()) {
         if (!decimalColVector.isNull[0]) {
           firstValue.set(decimalColVector.vector[0]);
           isGroupResultNull = false;
         }
+      } else {
+        // If we do not respect nulls, we just take the first value and ignore nulls.
+        for (int i = 0; i < size; i++) {
+          if (!decimalColVector.isNull[i]) {
+            firstValue.set(decimalColVector.vector[i]);
+            isGroupResultNull = false;
+            break;
+          }
+        }
       }
-      haveFirstValue = true;
+      // If nulls are respected, we set haveFirstValue to true as we don't need to look for a non-null value
+      // Otherwise, we should keep looking for a non-null value in the next batches, i.e.,
+      // until group result is not null.
+      haveFirstValue = doesRespectNulls() || !isGroupResultNull;
     }
 
     /*
@@ -122,7 +131,7 @@ public Object getGroupResult() {
   public void resetEvaluator() {
     haveFirstValue = false;
     isGroupResultNull = true;
-    firstValue.set(HiveDecimal.ZERO);
+    firstValue = new HiveDecimalWritable();
   }
 
   // this is not necessarily needed, because first_value is evaluated in a streaming way, therefore
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/vector/ptf/VectorPTFEvaluatorDecimalLastValue.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/vector/ptf/VectorPTFEvaluatorDecimalLastValue.java
index 9f6e6f20ff..0a116c03bb 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/vector/ptf/VectorPTFEvaluatorDecimalLastValue.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/vector/ptf/VectorPTFEvaluatorDecimalLastValue.java
@@ -43,7 +43,6 @@ public class VectorPTFEvaluatorDecimalLastValue extends VectorPTFEvaluatorBase {
   public VectorPTFEvaluatorDecimalLastValue(WindowFrameDef windowFrameDef,
       VectorExpression inputVecExpr, int outputColumnNum) {
     super(windowFrameDef, inputVecExpr, outputColumnNum);
-    lastValue = new HiveDecimalWritable();
     resetEvaluator();
   }
 
@@ -64,7 +63,6 @@ public void evaluateGroupBatch(VectorizedRowBatch batch)
     }
     DecimalColumnVector decimalColVector = ((DecimalColumnVector) batch.cols[inputColumnNum]);
     if (decimalColVector.isRepeating) {
-
       if (decimalColVector.noNulls || !decimalColVector.isNull[0]) {
         lastValue.set(decimalColVector.vector[0]);
         isGroupResultNull = false;
@@ -74,7 +72,7 @@ public void evaluateGroupBatch(VectorizedRowBatch batch)
     } else if (decimalColVector.noNulls) {
       lastValue.set(decimalColVector.vector[size - 1]);
       isGroupResultNull = false;
-    } else {
+    } else if (doesRespectNulls()) {
       final int lastBatchIndex = size - 1;
       if (!decimalColVector.isNull[lastBatchIndex]) {
         lastValue.set(decimalColVector.vector[lastBatchIndex]);
@@ -82,6 +80,16 @@ public void evaluateGroupBatch(VectorizedRowBatch batch)
       } else {
         isGroupResultNull = true;
       }
+    } else {
+      // If we do not respect nulls, we can keep checking from the end of the batch
+      isGroupResultNull = !lastValue.isSet();
+      for (int i = size-1; i >= 0; i--) {
+        if (!decimalColVector.isNull[i]) {
+          lastValue.set(decimalColVector.vector[i]);
+          isGroupResultNull = false;
+          break;
+        }
+      }
     }
   }
 
@@ -109,7 +117,7 @@ public Object getGroupResult() {
   @Override
   public void resetEvaluator() {
     isGroupResultNull = true;
-    lastValue.set(HiveDecimal.ZERO);
+    lastValue = new HiveDecimalWritable();
   }
 
   public boolean isCacheableForRange() {
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/vector/ptf/VectorPTFEvaluatorDoubleFirstValue.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/vector/ptf/VectorPTFEvaluatorDoubleFirstValue.java
index a391fd2ac1..40b49d7960 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/vector/ptf/VectorPTFEvaluatorDoubleFirstValue.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/vector/ptf/VectorPTFEvaluatorDoubleFirstValue.java
@@ -37,7 +37,7 @@ public class VectorPTFEvaluatorDoubleFirstValue extends VectorPTFEvaluatorBase {
 
   protected boolean haveFirstValue;
   protected boolean isGroupResultNull;
-  protected double firstValue;
+  protected Double firstValue = null;
 
   public VectorPTFEvaluatorDoubleFirstValue(WindowFrameDef windowFrameDef,
       VectorExpression inputVecExpr, int outputColumnNum) {
@@ -63,7 +63,6 @@ public void evaluateGroupBatch(VectorizedRowBatch batch)
       }
       DoubleColumnVector doubleColVector = ((DoubleColumnVector) batch.cols[inputColumnNum]);
       if (doubleColVector.isRepeating) {
-
         if (doubleColVector.noNulls || !doubleColVector.isNull[0]) {
           firstValue = doubleColVector.vector[0];
           isGroupResultNull = false;
@@ -71,13 +70,25 @@ public void evaluateGroupBatch(VectorizedRowBatch batch)
       } else if (doubleColVector.noNulls) {
         firstValue = doubleColVector.vector[0];
         isGroupResultNull = false;
-      } else {
+      } else if (doesRespectNulls()) {
         if (!doubleColVector.isNull[0]) {
           firstValue = doubleColVector.vector[0];
           isGroupResultNull = false;
         }
+      } else {
+        // If we do not respect nulls, we just take the first value and ignore nulls.
+        for (int i = 0; i < size; i++) {
+          if (!doubleColVector.isNull[i]) {
+            firstValue = doubleColVector.vector[i];
+            isGroupResultNull = false;
+            break;
+          }
+        }
       }
-      haveFirstValue = true;
+      // If nulls are respected, we set haveFirstValue to true as we don't need to look for a non-null value
+      // Otherwise, we should keep looking for a non-null value in the next batches, i.e.,
+      // until group result is not null.
+      haveFirstValue = doesRespectNulls() || !isGroupResultNull;
     }
 
     /*
@@ -119,7 +130,7 @@ public Object getGroupResult() {
   public void resetEvaluator() {
     haveFirstValue = false;
     isGroupResultNull = true;
-    firstValue = 0.0;
+    firstValue = null;
   }
 
   // this is not necessarily needed, because first_value is evaluated in a streaming way, therefore
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/vector/ptf/VectorPTFEvaluatorDoubleLastValue.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/vector/ptf/VectorPTFEvaluatorDoubleLastValue.java
index bc205bda13..2615199e7e 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/vector/ptf/VectorPTFEvaluatorDoubleLastValue.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/vector/ptf/VectorPTFEvaluatorDoubleLastValue.java
@@ -35,7 +35,7 @@
 public class VectorPTFEvaluatorDoubleLastValue extends VectorPTFEvaluatorBase {
 
   protected boolean isGroupResultNull;
-  protected double lastValue;
+  protected Double lastValue = null;
 
   public VectorPTFEvaluatorDoubleLastValue(WindowFrameDef windowFrameDef,
     VectorExpression inputVecExpr, int outputColumnNum) {
@@ -60,7 +60,6 @@ public void evaluateGroupBatch(VectorizedRowBatch batch)
     }
     DoubleColumnVector doubleColVector = ((DoubleColumnVector) batch.cols[inputColumnNum]);
     if (doubleColVector.isRepeating) {
-
       if (doubleColVector.noNulls || !doubleColVector.isNull[0]) {
         lastValue = doubleColVector.vector[0];
         isGroupResultNull = false;
@@ -70,7 +69,7 @@ public void evaluateGroupBatch(VectorizedRowBatch batch)
     } else if (doubleColVector.noNulls) {
       lastValue = doubleColVector.vector[size - 1];
       isGroupResultNull = false;
-    } else {
+    } else if (doesRespectNulls()) {
       final int lastBatchIndex = size - 1;
       if (!doubleColVector.isNull[lastBatchIndex]) {
         lastValue = doubleColVector.vector[lastBatchIndex];
@@ -78,6 +77,16 @@ public void evaluateGroupBatch(VectorizedRowBatch batch)
       } else {
         isGroupResultNull = true;
       }
+    } else {
+      // If we do not respect nulls, we can keep checking from the end of the batch
+      isGroupResultNull = lastValue == null;
+      for (int i = size-1; i >= 0; i--) {
+        if (!doubleColVector.isNull[i]) {
+          lastValue = doubleColVector.vector[i];
+          isGroupResultNull = false;
+          break;
+        }
+      }
     }
   }
 
@@ -105,7 +114,7 @@ public Object getGroupResult() {
   @Override
   public void resetEvaluator() {
     isGroupResultNull = true;
-    lastValue = 0.0;
+    lastValue = null;
   }
 
   public boolean isCacheableForRange() {
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/vector/ptf/VectorPTFEvaluatorLongFirstValue.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/vector/ptf/VectorPTFEvaluatorLongFirstValue.java
index 80b815cd03..1b1ca20493 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/vector/ptf/VectorPTFEvaluatorLongFirstValue.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/vector/ptf/VectorPTFEvaluatorLongFirstValue.java
@@ -37,7 +37,7 @@ public class VectorPTFEvaluatorLongFirstValue extends VectorPTFEvaluatorBase {
 
   protected boolean haveFirstValue;
   protected boolean isGroupResultNull;
-  protected long firstValue;
+  protected Long firstValue = null;
 
   public VectorPTFEvaluatorLongFirstValue(WindowFrameDef windowFrameDef,
       VectorExpression inputVecExpr, int outputColumnNum) {
@@ -63,7 +63,6 @@ public void evaluateGroupBatch(VectorizedRowBatch batch)
       }
       LongColumnVector longColVector = ((LongColumnVector) batch.cols[inputColumnNum]);
       if (longColVector.isRepeating) {
-
         if (longColVector.noNulls || !longColVector.isNull[0]) {
           firstValue = longColVector.vector[0];
           isGroupResultNull = false;
@@ -71,13 +70,25 @@ public void evaluateGroupBatch(VectorizedRowBatch batch)
       } else if (longColVector.noNulls) {
         firstValue = longColVector.vector[0];
         isGroupResultNull = false;
-      } else {
+      } else if (doesRespectNulls()) {
         if (!longColVector.isNull[0]) {
           firstValue = longColVector.vector[0];
           isGroupResultNull = false;
         }
+      } else {
+        // If we do not respect nulls, we just take the first value and ignore nulls.
+        for (int i = 0; i < size; i++) {
+          if (!longColVector.isNull[i]) {
+            firstValue = longColVector.vector[i];
+            isGroupResultNull = false;
+            break;
+          }
+        }
       }
-      haveFirstValue = true;
+      // If nulls are respected, we set haveFirstValue to true as we don't need to look for a non-null value
+      // Otherwise, we should keep looking for a non-null value in the next batches, i.e.,
+      // until group result is not null.
+      haveFirstValue = doesRespectNulls() || !isGroupResultNull;
     }
 
     /*
@@ -119,7 +130,7 @@ public Object getGroupResult() {
   public void resetEvaluator() {
     haveFirstValue = false;
     isGroupResultNull = true;
-    firstValue = 0;
+    firstValue = null;
   }
 
   // this is not necessarily needed, because first_value is evaluated in a streaming way, therefore
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/vector/ptf/VectorPTFEvaluatorLongLastValue.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/vector/ptf/VectorPTFEvaluatorLongLastValue.java
index 3c13667f2a..5a83f68ca8 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/vector/ptf/VectorPTFEvaluatorLongLastValue.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/vector/ptf/VectorPTFEvaluatorLongLastValue.java
@@ -36,7 +36,7 @@
 public class VectorPTFEvaluatorLongLastValue extends VectorPTFEvaluatorBase {
 
   protected boolean isGroupResultNull;
-  protected long lastValue;
+  protected Long lastValue = null;
 
   public VectorPTFEvaluatorLongLastValue(WindowFrameDef windowFrameDef,
       VectorExpression inputVecExpr, int outputColumnNum) {
@@ -61,7 +61,6 @@ public void evaluateGroupBatch(VectorizedRowBatch batch)
     }
     LongColumnVector longColVector = ((LongColumnVector) batch.cols[inputColumnNum]);
     if (longColVector.isRepeating) {
-
       if (longColVector.noNulls || !longColVector.isNull[0]) {
         lastValue = longColVector.vector[0];
         isGroupResultNull = false;
@@ -71,7 +70,7 @@ public void evaluateGroupBatch(VectorizedRowBatch batch)
     } else if (longColVector.noNulls) {
       lastValue = longColVector.vector[size - 1];
       isGroupResultNull = false;
-    } else {
+    } else if (doesRespectNulls()) {
       final int lastBatchIndex = size - 1;
       if (!longColVector.isNull[lastBatchIndex]) {
         lastValue = longColVector.vector[lastBatchIndex];
@@ -79,6 +78,16 @@ public void evaluateGroupBatch(VectorizedRowBatch batch)
       } else {
         isGroupResultNull = true;
       }
+    } else {
+      // If we do not respect nulls, we can keep checking from the end of the batch
+      isGroupResultNull = lastValue == null;
+      for (int i = size-1; i >= 0; i--) {
+        if (!longColVector.isNull[i]) {
+          lastValue = longColVector.vector[i];
+          isGroupResultNull = false;
+          break;
+        }
+      }
     }
   }
 
@@ -106,7 +115,7 @@ public Object getGroupResult() {
   @Override
   public void resetEvaluator() {
     isGroupResultNull = true;
-    lastValue = 0;
+    lastValue = null;
   }
 
   public boolean isCacheableForRange() {
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/Vectorizer.java b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/Vectorizer.java
index 571d3bcafb..b8acb2661f 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/Vectorizer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/Vectorizer.java
@@ -4919,15 +4919,19 @@ private static VectorExpression fixDecimalDataTypePhysicalVariations(final Vecto
     return parent;
   }
 
-  private static void fillInPTFEvaluators(List<WindowFunctionDef> windowsFunctions,
-      String[] evaluatorFunctionNames, boolean[] evaluatorsAreDistinct,
+  private static void fillInPTFEvaluators(
+      List<WindowFunctionDef> windowsFunctions,
+      String[] evaluatorFunctionNames,
+      boolean[] evaluatorsAreDistinct,
+      boolean[] evaluatorsRespectNulls,
       WindowFrameDef[] evaluatorWindowFrameDefs,
-      List<ExprNodeDesc>[] evaluatorInputExprNodeDescLists) throws HiveException {
+      List<ExprNodeDesc>[] evaluatorInputExprNodeDescLists) {
     final int functionCount = windowsFunctions.size();
     for (int i = 0; i < functionCount; i++) {
       WindowFunctionDef winFunc = windowsFunctions.get(i);
       evaluatorFunctionNames[i] = winFunc.getName();
       evaluatorsAreDistinct[i] = winFunc.isDistinct();
+      evaluatorsRespectNulls[i] = winFunc.respectNulls();
       evaluatorWindowFrameDefs[i] = winFunc.getWindowFrame();
 
       List<PTFExpressionDef> args = winFunc.getArgs();
@@ -5038,6 +5042,7 @@ private static void createVectorPTFDesc(Operator<? extends OperatorDesc> ptfOp,
 
     String[] evaluatorFunctionNames = new String[functionCount];
     boolean[] evaluatorsAreDistinct = new boolean[functionCount];
+    boolean[] evaluatorsRespectNulls = new boolean[functionCount];
     WindowFrameDef[] evaluatorWindowFrameDefs = new WindowFrameDef[functionCount];
     List<ExprNodeDesc>[] evaluatorInputExprNodeDescLists = (List<ExprNodeDesc>[]) new List<?>[functionCount];
 
@@ -5045,6 +5050,7 @@ private static void createVectorPTFDesc(Operator<? extends OperatorDesc> ptfOp,
         windowsFunctions,
         evaluatorFunctionNames,
         evaluatorsAreDistinct,
+        evaluatorsRespectNulls,
         evaluatorWindowFrameDefs,
         evaluatorInputExprNodeDescLists);
 
@@ -5057,6 +5063,7 @@ private static void createVectorPTFDesc(Operator<? extends OperatorDesc> ptfOp,
 
     vectorPTFDesc.setEvaluatorFunctionNames(evaluatorFunctionNames);
     vectorPTFDesc.setEvaluatorsAreDistinct(evaluatorsAreDistinct);
+    vectorPTFDesc.setEvaluatorsRespectNulls(evaluatorsRespectNulls);
     vectorPTFDesc.setEvaluatorWindowFrameDefs(evaluatorWindowFrameDefs);
     vectorPTFDesc.setEvaluatorInputExprNodeDescLists(evaluatorInputExprNodeDescLists);
 
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/plan/VectorPTFDesc.java b/ql/src/java/org/apache/hadoop/hive/ql/plan/VectorPTFDesc.java
index b8c7fb5135..346a969a00 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/plan/VectorPTFDesc.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/plan/VectorPTFDesc.java
@@ -137,6 +137,7 @@ public boolean isSupportDistinct() {
 
   private String[] evaluatorFunctionNames;
   private boolean[] evaluatorsAreDistinct;
+  private boolean[] evaluatorsRespectNulls;
   private WindowFrameDef[] evaluatorWindowFrameDefs;
   private List<ExprNodeDesc>[] evaluatorInputExprNodeDescLists;
 
@@ -156,6 +157,7 @@ public VectorPTFDesc() {
 
     evaluatorFunctionNames = null;
     evaluatorsAreDistinct = null;
+    evaluatorsRespectNulls = null;
     evaluatorInputExprNodeDescLists = null;
 
     orderExprNodeDescs = null;
@@ -170,7 +172,7 @@ public VectorPTFDesc() {
 
   // We provide this public method to help EXPLAIN VECTORIZATION show the evaluator classes.
   public static VectorPTFEvaluatorBase getEvaluator(SupportedFunctionType functionType,
-      boolean isDistinct, WindowFrameDef windowFrameDef, Type[] columnVectorTypes,
+      boolean isDistinct, boolean respectNulls, WindowFrameDef windowFrameDef, Type[] columnVectorTypes,
       VectorExpression[] inputVectorExpressions, int outputColumnNum) {
 
     final boolean isRowEndCurrent = (windowFrameDef.getWindowType() == WindowType.ROWS
@@ -416,12 +418,14 @@ public static VectorPTFEvaluatorBase getEvaluator(SupportedFunctionType function
     default:
       throw new RuntimeException("Unexpected function type " + functionType);
     }
+    evaluator.setRespectNulls(respectNulls);
     return evaluator;
   }
 
   public static VectorPTFEvaluatorBase[] getEvaluators(VectorPTFDesc vectorPTFDesc, VectorPTFInfo vectorPTFInfo) {
     String[] evaluatorFunctionNames = vectorPTFDesc.getEvaluatorFunctionNames();
     boolean[] evaluatorsAreDistinct = vectorPTFDesc.getEvaluatorsAreDistinct();
+    boolean[] evaluatorsRespectNulls = vectorPTFDesc.getEvaluatorsRespectNulls();
     int evaluatorCount = evaluatorFunctionNames.length;
     WindowFrameDef[] evaluatorWindowFrameDefs = vectorPTFDesc.getEvaluatorWindowFrameDefs();
     VectorExpression[][] evaluatorInputExpressions = vectorPTFInfo.getEvaluatorInputExpressions();
@@ -433,6 +437,7 @@ public static VectorPTFEvaluatorBase[] getEvaluators(VectorPTFDesc vectorPTFDesc
     for (int i = 0; i < evaluatorCount; i++) {
       String functionName = evaluatorFunctionNames[i].toLowerCase();
       boolean isDistinct = evaluatorsAreDistinct[i];
+      boolean respectNulls = evaluatorsRespectNulls[i];
       WindowFrameDef windowFrameDef = evaluatorWindowFrameDefs[i];
       SupportedFunctionType functionType = VectorPTFDesc.supportedFunctionsMap.get(functionName);
       VectorExpression[] inputVectorExpressions = evaluatorInputExpressions[i];
@@ -442,7 +447,7 @@ public static VectorPTFEvaluatorBase[] getEvaluators(VectorPTFDesc vectorPTFDesc
       final int outputColumnNum = outputColumnMap[i];
 
       VectorPTFEvaluatorBase evaluator =
-          VectorPTFDesc.getEvaluator(functionType, isDistinct,
+          VectorPTFDesc.getEvaluator(functionType, isDistinct, respectNulls,
               windowFrameDef, columnVectorTypes, inputVectorExpressions, outputColumnNum);
 
       evaluators[i] = evaluator;
@@ -496,6 +501,14 @@ public boolean[] getEvaluatorsAreDistinct() {
     return evaluatorsAreDistinct;
   }
 
+  public boolean[] getEvaluatorsRespectNulls() {
+    return evaluatorsRespectNulls;
+  }
+
+  public void setEvaluatorsRespectNulls(boolean[] evaluatorsRespectNulls) {
+    this.evaluatorsRespectNulls = evaluatorsRespectNulls;
+  }
+
   public WindowFrameDef[] getEvaluatorWindowFrameDefs() {
     return evaluatorWindowFrameDefs;
   }
diff --git a/ql/src/test/queries/clientpositive/vectorized_first_last_value_ignore_nulls_decimal.q b/ql/src/test/queries/clientpositive/vectorized_first_last_value_ignore_nulls_decimal.q
new file mode 100644
index 0000000000..924cc7a25f
--- /dev/null
+++ b/ql/src/test/queries/clientpositive/vectorized_first_last_value_ignore_nulls_decimal.q
@@ -0,0 +1,219 @@
+SET hive.cli.print.header=true;
+
+CREATE TABLE window_decimal_test (
+  id INT,
+  decimal_col DECIMAL(10,2)
+);
+
+INSERT INTO window_decimal_test VALUES
+  (1, NULL),
+  (2, NULL),
+  (1, NULL),
+  (1, NULL),
+  (2, 200.00),
+  (3, NULL),
+  (6, 610.00),
+  (2, NULL),
+  (3, 300.75),
+  (4, NULL),
+  (3, 300.50),
+  (5, 500.20),
+  (4, 400.00),
+  (5, NULL),
+  (6, 600.00),
+  (7, NULL),
+  (NULL, 800.00),
+  (NULL, NULL);
+
+-- ================ Test FIRST_VALUE and LAST_VALUE for decimal column ====================================================
+
+-- Test FIRST_VALUE and LAST_VALUE for decimal column with IGNORE NULLS outside function
+set hive.vectorized.execution.enabled=false;
+SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col) IGNORE NULLS OVER(ORDER BY id) AS first_decimal,
+  LAST_VALUE(decimal_col) IGNORE NULLS OVER(ORDER BY id) AS last_decimal
+FROM window_decimal_test;
+
+set hive.vectorized.execution.enabled=true;
+SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col) IGNORE NULLS OVER(ORDER BY id) AS first_decimal,
+  LAST_VALUE(decimal_col) IGNORE NULLS OVER(ORDER BY id) AS last_decimal
+FROM window_decimal_test;
+
+-- Test FIRST_VALUE and LAST_VALUE for decimal column with IGNORE NULLS inside function
+set hive.vectorized.execution.enabled=false;
+SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col IGNORE NULLS) OVER(ORDER BY id) AS first_decimal,
+  LAST_VALUE(decimal_col IGNORE NULLS) OVER(ORDER BY id) AS last_decimal
+FROM window_decimal_test;
+
+set hive.vectorized.execution.enabled=true;
+SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col IGNORE NULLS) OVER(ORDER BY id) AS first_decimal,
+  LAST_VALUE(decimal_col IGNORE NULLS) OVER(ORDER BY id) AS last_decimal
+FROM window_decimal_test;
+
+-- Test FIRST_VALUE and LAST_VALUE for decimal column with PARTITION BY clause
+set hive.vectorized.execution.enabled=false;
+SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id) AS first_decimal,
+  LAST_VALUE(decimal_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id) AS last_decimal
+FROM window_decimal_test;
+
+set hive.vectorized.execution.enabled=true;
+SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id) AS first_decimal,
+  LAST_VALUE(decimal_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id) AS last_decimal
+FROM window_decimal_test;
+
+-- Test FIRST_VALUE and LAST_VALUE for decimal column without IGNORE NULLS
+set hive.vectorized.execution.enabled=false;
+SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col) OVER(ORDER BY id) AS first_decimal,
+  LAST_VALUE(decimal_col) OVER(ORDER BY id) AS last_decimal
+FROM window_decimal_test;
+
+set hive.vectorized.execution.enabled=true;
+SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col) OVER(ORDER BY id) AS first_decimal,
+  LAST_VALUE(decimal_col) OVER(ORDER BY id) AS last_decimal
+FROM window_decimal_test;
+
+-- Test FIRST_VALUE and LAST_VALUE for decimal column with PARTITION BY clause and without IGNORE NULLS
+set hive.vectorized.execution.enabled=false;
+SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col) OVER(PARTITION BY id ORDER BY id) AS first_decimal,
+  LAST_VALUE(decimal_col) OVER(PARTITION BY id ORDER BY id) AS last_decimal
+FROM window_decimal_test;
+
+set hive.vectorized.execution.enabled=true;
+SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col) OVER(PARTITION BY id ORDER BY id) AS first_decimal,
+  LAST_VALUE(decimal_col) OVER(PARTITION BY id ORDER BY id) AS last_decimal
+FROM window_decimal_test;
+
+
+--========================================================================================
+-- Repeat the same tests with nulls first added after order by clause
+--========================================================================================
+-- Test FIRST_VALUE and LAST_VALUE for decimal column with IGNORE NULLS outside function
+set hive.vectorized.execution.enabled=false;
+SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col) IGNORE NULLS OVER(ORDER BY id ASC NULLS FIRST) AS first_decimal,
+  LAST_VALUE(decimal_col) IGNORE NULLS OVER(ORDER BY id ASC NULLS FIRST) AS last_decimal
+FROM window_decimal_test;
+
+set hive.vectorized.execution.enabled=true;
+SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col) IGNORE NULLS OVER(ORDER BY id ASC NULLS FIRST) AS first_decimal,
+  LAST_VALUE(decimal_col) IGNORE NULLS OVER(ORDER BY id ASC NULLS FIRST) AS last_decimal
+FROM window_decimal_test;
+
+-- Test FIRST_VALUE and LAST_VALUE for decimal column with IGNORE NULLS inside function
+set hive.vectorized.execution.enabled=false;
+SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col IGNORE NULLS) OVER(ORDER BY id ASC NULLS FIRST) AS first_decimal,
+  LAST_VALUE(decimal_col IGNORE NULLS) OVER(ORDER BY id ASC NULLS FIRST) AS last_decimal
+FROM window_decimal_test;
+
+set hive.vectorized.execution.enabled=true;
+SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col IGNORE NULLS) OVER(ORDER BY id ASC NULLS FIRST) AS first_decimal,
+  LAST_VALUE(decimal_col IGNORE NULLS) OVER(ORDER BY id ASC NULLS FIRST) AS last_decimal
+FROM window_decimal_test;
+
+-- Test FIRST_VALUE and LAST_VALUE for decimal column with PARTITION BY clause
+set hive.vectorized.execution.enabled=false;
+SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS first_decimal,
+  LAST_VALUE(decimal_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS last_decimal
+FROM window_decimal_test;
+
+set hive.vectorized.execution.enabled=true;
+SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS first_decimal,
+  LAST_VALUE(decimal_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS last_decimal
+FROM window_decimal_test;
+
+-- Test FIRST_VALUE and LAST_VALUE for decimal column without IGNORE NULLS
+set hive.vectorized.execution.enabled=false;
+SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col) OVER(ORDER BY id ASC NULLS FIRST) AS first_decimal,
+  LAST_VALUE(decimal_col) OVER(ORDER BY id ASC NULLS FIRST) AS last_decimal
+FROM window_decimal_test;
+
+set hive.vectorized.execution.enabled=true;
+SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col) OVER(ORDER BY id ASC NULLS FIRST) AS first_decimal,
+  LAST_VALUE(decimal_col) OVER(ORDER BY id ASC NULLS FIRST) AS last_decimal
+FROM window_decimal_test;
+
+-- Test FIRST_VALUE and LAST_VALUE for decimal column with PARTITION BY clause and without IGNORE NULLS
+set hive.vectorized.execution.enabled=false;
+SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS first_decimal,
+  LAST_VALUE(decimal_col) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS last_decimal
+FROM window_decimal_test;
+
+set hive.vectorized.execution.enabled=true;
+SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS first_decimal,
+  LAST_VALUE(decimal_col) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS last_decimal
+FROM window_decimal_test;
+
+
+--========================================================================================
+-- Test with reducer batch size set to 2
+--========================================================================================
+set hive.vectorized.testing.reducer.batch.size=2;
+set hive.vectorized.execution.enabled=true;
+
+SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col) IGNORE NULLS OVER(ORDER BY id) AS first_decimal,
+  LAST_VALUE(decimal_col) IGNORE NULLS OVER(ORDER BY id) AS last_decimal
+FROM window_decimal_test;
+
+SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col) IGNORE NULLS OVER(ORDER BY id ASC NULLS FIRST) AS first_decimal,
+  LAST_VALUE(decimal_col) IGNORE NULLS OVER(ORDER BY id ASC NULLS FIRST) AS last_decimal
+FROM window_decimal_test;
+
+SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col IGNORE NULLS) OVER(ORDER BY id) AS first_decimal,
+  LAST_VALUE(decimal_col IGNORE NULLS) OVER(ORDER BY id) AS last_decimal
+FROM window_decimal_test;
+
+SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col IGNORE NULLS) OVER(ORDER BY id ASC NULLS FIRST) AS first_decimal,
+  LAST_VALUE(decimal_col IGNORE NULLS) OVER(ORDER BY id ASC NULLS FIRST) AS last_decimal
+FROM window_decimal_test;
+
+SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id) AS first_decimal,
+  LAST_VALUE(decimal_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id) AS last_decimal
+FROM window_decimal_test;
+
+SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS first_decimal,
+  LAST_VALUE(decimal_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS last_decimal
+FROM window_decimal_test;
+
+SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col) OVER(ORDER BY id) AS first_decimal,
+  LAST_VALUE(decimal_col) OVER(ORDER BY id) AS last_decimal
+FROM window_decimal_test;
+
+SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col) OVER(ORDER BY id ASC NULLS FIRST) AS first_decimal,
+  LAST_VALUE(decimal_col) OVER(ORDER BY id ASC NULLS FIRST) AS last_decimal
+FROM window_decimal_test;
+
+SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col) OVER(PARTITION BY id ORDER BY id) AS first_decimal,
+  LAST_VALUE(decimal_col) OVER(PARTITION BY id ORDER BY id) AS last_decimal
+FROM window_decimal_test;
+
+SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS first_decimal,
+  LAST_VALUE(decimal_col) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS last_decimal
+FROM window_decimal_test;
diff --git a/ql/src/test/queries/clientpositive/vectorized_first_last_value_ignore_nulls_double.q b/ql/src/test/queries/clientpositive/vectorized_first_last_value_ignore_nulls_double.q
new file mode 100644
index 0000000000..8c7d2edefe
--- /dev/null
+++ b/ql/src/test/queries/clientpositive/vectorized_first_last_value_ignore_nulls_double.q
@@ -0,0 +1,219 @@
+SET hive.cli.print.header=true;
+
+CREATE TABLE window_double_test (
+  id INT,
+  double_col DOUBLE
+);
+
+INSERT INTO window_double_test VALUES
+  (1, NULL),
+  (2, NULL),
+  (1, NULL),
+  (1, NULL),
+  (2, 25.5),
+  (3, NULL),
+  (6, 65.5),
+  (2, NULL),
+  (3, 32.5),
+  (4, NULL),
+  (3, 30.5),
+  (5, 50.5),
+  (4, 42.3),
+  (5, NULL),
+  (6, 65.2),
+  (7, NULL),
+  (NULL, 80.5),
+  (NULL, NULL);
+  
+-- ================ Test FIRST_VALUE and LAST_VALUE for double column ====================================================
+
+-- Test FIRST_VALUE and LAST_VALUE for double column with IGNORE NULLS outside function
+set hive.vectorized.execution.enabled=false;
+SELECT id, double_col,
+  FIRST_VALUE(double_col) IGNORE NULLS OVER(ORDER BY id) AS first_double,
+  LAST_VALUE(double_col) IGNORE NULLS OVER(ORDER BY id) AS last_double
+FROM window_double_test;
+
+set hive.vectorized.execution.enabled=true;
+SELECT id, double_col,
+  FIRST_VALUE(double_col) IGNORE NULLS OVER(ORDER BY id) AS first_double,
+  LAST_VALUE(double_col) IGNORE NULLS OVER(ORDER BY id) AS last_double
+FROM window_double_test;
+
+-- Test FIRST_VALUE and LAST_VALUE for double column with IGNORE NULLS inside function
+set hive.vectorized.execution.enabled=false;
+SELECT id, double_col,
+  FIRST_VALUE(double_col IGNORE NULLS) OVER(ORDER BY id) AS first_double,
+  LAST_VALUE(double_col IGNORE NULLS) OVER(ORDER BY id) AS last_double
+FROM window_double_test;
+
+set hive.vectorized.execution.enabled=true;
+SELECT id, double_col,
+  FIRST_VALUE(double_col IGNORE NULLS) OVER(ORDER BY id) AS first_double,
+  LAST_VALUE(double_col IGNORE NULLS) OVER(ORDER BY id) AS last_double
+FROM window_double_test;
+
+-- Test FIRST_VALUE and LAST_VALUE for double column with PARTITION BY clause
+set hive.vectorized.execution.enabled=false;
+SELECT id, double_col,
+  FIRST_VALUE(double_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id) AS first_double,
+  LAST_VALUE(double_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id) AS last_double
+FROM window_double_test;
+
+set hive.vectorized.execution.enabled=true;
+SELECT id, double_col,
+  FIRST_VALUE(double_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id) AS first_double,
+  LAST_VALUE(double_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id) AS last_double
+FROM window_double_test;
+
+-- Test FIRST_VALUE and LAST_VALUE for double column without IGNORE NULLS
+set hive.vectorized.execution.enabled=false;
+SELECT id, double_col,
+  FIRST_VALUE(double_col) OVER(ORDER BY id) AS first_double,
+  LAST_VALUE(double_col) OVER(ORDER BY id) AS last_double
+FROM window_double_test;
+
+set hive.vectorized.execution.enabled=true;
+SELECT id, double_col,
+  FIRST_VALUE(double_col) OVER(ORDER BY id) AS first_double,
+  LAST_VALUE(double_col) OVER(ORDER BY id) AS last_double
+FROM window_double_test;
+
+-- Test FIRST_VALUE and LAST_VALUE for double column with PARTITION BY clause and without IGNORE NULLS
+set hive.vectorized.execution.enabled=false;
+SELECT id, double_col,
+  FIRST_VALUE(double_col) OVER(PARTITION BY id ORDER BY id) AS first_double,
+  LAST_VALUE(double_col) OVER(PARTITION BY id ORDER BY id) AS last_double
+FROM window_double_test;
+
+set hive.vectorized.execution.enabled=true;
+SELECT id, double_col,
+  FIRST_VALUE(double_col) OVER(PARTITION BY id ORDER BY id) AS first_double,
+  LAST_VALUE(double_col) OVER(PARTITION BY id ORDER BY id) AS last_double
+FROM window_double_test;
+
+
+--========================================================================================
+-- Repeat the same tests with nulls first added after order by clause
+--========================================================================================
+-- Test FIRST_VALUE and LAST_VALUE for double column with IGNORE NULLS outside function
+set hive.vectorized.execution.enabled=false;
+SELECT id, double_col,
+  FIRST_VALUE(double_col) IGNORE NULLS OVER(ORDER BY id ASC NULLS FIRST) AS first_double,
+  LAST_VALUE(double_col) IGNORE NULLS OVER(ORDER BY id ASC NULLS FIRST) AS last_double
+FROM window_double_test;
+
+set hive.vectorized.execution.enabled=true;
+SELECT id, double_col,
+  FIRST_VALUE(double_col) IGNORE NULLS OVER(ORDER BY id ASC NULLS FIRST) AS first_double,
+  LAST_VALUE(double_col) IGNORE NULLS OVER(ORDER BY id ASC NULLS FIRST) AS last_double
+FROM window_double_test;
+
+-- Test FIRST_VALUE and LAST_VALUE for double column with IGNORE NULLS inside function
+set hive.vectorized.execution.enabled=false;
+SELECT id, double_col,
+  FIRST_VALUE(double_col IGNORE NULLS) OVER(ORDER BY id ASC NULLS FIRST) AS first_double,
+  LAST_VALUE(double_col IGNORE NULLS) OVER(ORDER BY id ASC NULLS FIRST) AS last_double
+FROM window_double_test;
+
+set hive.vectorized.execution.enabled=true;
+SELECT id, double_col,
+  FIRST_VALUE(double_col IGNORE NULLS) OVER(ORDER BY id ASC NULLS FIRST) AS first_double,
+  LAST_VALUE(double_col IGNORE NULLS) OVER(ORDER BY id ASC NULLS FIRST) AS last_double
+FROM window_double_test;
+
+-- Test FIRST_VALUE and LAST_VALUE for double column with PARTITION BY clause
+set hive.vectorized.execution.enabled=false;
+SELECT id, double_col,
+  FIRST_VALUE(double_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS first_double,
+  LAST_VALUE(double_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS last_double
+FROM window_double_test;
+
+set hive.vectorized.execution.enabled=true;
+SELECT id, double_col,
+  FIRST_VALUE(double_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS first_double,
+  LAST_VALUE(double_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS last_double
+FROM window_double_test;
+
+-- Test FIRST_VALUE and LAST_VALUE for double column without IGNORE NULLS
+set hive.vectorized.execution.enabled=false;
+SELECT id, double_col,
+  FIRST_VALUE(double_col) OVER(ORDER BY id ASC NULLS FIRST) AS first_double,
+  LAST_VALUE(double_col) OVER(ORDER BY id ASC NULLS FIRST) AS last_double
+FROM window_double_test;
+
+set hive.vectorized.execution.enabled=true;
+SELECT id, double_col,
+  FIRST_VALUE(double_col) OVER(ORDER BY id ASC NULLS FIRST) AS first_double,
+  LAST_VALUE(double_col) OVER(ORDER BY id ASC NULLS FIRST) AS last_double
+FROM window_double_test;
+
+-- Test FIRST_VALUE and LAST_VALUE for double column with PARTITION BY clause and without IGNORE NULLS
+set hive.vectorized.execution.enabled=false;
+SELECT id, double_col,
+  FIRST_VALUE(double_col) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS first_double,
+  LAST_VALUE(double_col) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS last_double
+FROM window_double_test;
+
+set hive.vectorized.execution.enabled=true;
+SELECT id, double_col,
+  FIRST_VALUE(double_col) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS first_double,
+  LAST_VALUE(double_col) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS last_double
+FROM window_double_test;
+
+
+--========================================================================================
+-- Test with reducer batch size set to 2
+--========================================================================================
+set hive.vectorized.testing.reducer.batch.size=2;
+set hive.vectorized.execution.enabled=true;
+
+SELECT id, double_col,
+  FIRST_VALUE(double_col) IGNORE NULLS OVER(ORDER BY id) AS first_double,
+  LAST_VALUE(double_col) IGNORE NULLS OVER(ORDER BY id) AS last_double
+FROM window_double_test;
+
+SELECT id, double_col,
+  FIRST_VALUE(double_col) IGNORE NULLS OVER(ORDER BY id ASC NULLS FIRST) AS first_double,
+  LAST_VALUE(double_col) IGNORE NULLS OVER(ORDER BY id ASC NULLS FIRST) AS last_double
+FROM window_double_test;
+
+SELECT id, double_col,
+  FIRST_VALUE(double_col IGNORE NULLS) OVER(ORDER BY id) AS first_double,
+  LAST_VALUE(double_col IGNORE NULLS) OVER(ORDER BY id) AS last_double
+FROM window_double_test;
+
+SELECT id, double_col,
+  FIRST_VALUE(double_col IGNORE NULLS) OVER(ORDER BY id ASC NULLS FIRST) AS first_double,
+  LAST_VALUE(double_col IGNORE NULLS) OVER(ORDER BY id ASC NULLS FIRST) AS last_double
+FROM window_double_test;
+
+SELECT id, double_col,
+  FIRST_VALUE(double_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id) AS first_double,
+  LAST_VALUE(double_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id) AS last_double
+FROM window_double_test;
+
+SELECT id, double_col,
+  FIRST_VALUE(double_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS first_double,
+  LAST_VALUE(double_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS last_double
+FROM window_double_test;
+
+SELECT id, double_col,
+  FIRST_VALUE(double_col) OVER(ORDER BY id) AS first_double,
+  LAST_VALUE(double_col) OVER(ORDER BY id) AS last_double
+FROM window_double_test;
+
+SELECT id, double_col,
+  FIRST_VALUE(double_col) OVER(ORDER BY id ASC NULLS FIRST) AS first_double,
+  LAST_VALUE(double_col) OVER(ORDER BY id ASC NULLS FIRST) AS last_double
+FROM window_double_test;
+
+SELECT id, double_col,
+  FIRST_VALUE(double_col) OVER(PARTITION BY id ORDER BY id) AS first_double,
+  LAST_VALUE(double_col) OVER(PARTITION BY id ORDER BY id) AS last_double
+FROM window_double_test;
+
+SELECT id, double_col,
+  FIRST_VALUE(double_col) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS first_double,
+  LAST_VALUE(double_col) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS last_double
+FROM window_double_test;
diff --git a/ql/src/test/queries/clientpositive/vectorized_first_last_value_ignore_nulls_int.q b/ql/src/test/queries/clientpositive/vectorized_first_last_value_ignore_nulls_int.q
new file mode 100644
index 0000000000..93b999b593
--- /dev/null
+++ b/ql/src/test/queries/clientpositive/vectorized_first_last_value_ignore_nulls_int.q
@@ -0,0 +1,218 @@
+set hive.cli.print.header=true;
+
+CREATE TABLE window_int_test (
+  id INT,
+  int_col INT
+);
+
+INSERT INTO window_int_test VALUES
+  (1, NULL),
+  (2, NULL),
+  (1, NULL),
+  (1, NULL),
+  (2, 20),
+  (3, NULL),
+  (6, 62),
+  (2, NULL),
+  (3, 30),
+  (4, NULL),
+  (3, 32),
+  (5, 50),
+  (4, 40),
+  (5, NULL),
+  (6, 60),
+  (7, NULL),
+  (NULL, 80),
+  (NULL, NULL);
+
+-- ================ Test FIRST_VALUE and LAST_VALUE for int column ====================================================
+
+-- Test FIRST_VALUE and LAST_VALUE for int column with IGNORE NULLS outside function
+set hive.vectorized.execution.enabled=false;
+SELECT id, int_col,
+  FIRST_VALUE(int_col) IGNORE NULLS OVER(ORDER BY id) AS first_int,
+  LAST_VALUE(int_col) IGNORE NULLS OVER(ORDER BY id) AS last_int
+FROM window_int_test;
+
+set hive.vectorized.execution.enabled=true;
+SELECT id, int_col,
+  FIRST_VALUE(int_col) IGNORE NULLS OVER(ORDER BY id) AS first_int,
+  LAST_VALUE(int_col) IGNORE NULLS OVER(ORDER BY id) AS last_int
+FROM window_int_test;
+
+-- Test FIRST_VALUE and LAST_VALUE for int column with IGNORE NULLS inside function
+set hive.vectorized.execution.enabled=false;
+SELECT id, int_col,
+  FIRST_VALUE(int_col IGNORE NULLS) OVER(ORDER BY id) AS first_int,
+  LAST_VALUE(int_col IGNORE NULLS) OVER(ORDER BY id) AS last_int
+FROM window_int_test;
+
+set hive.vectorized.execution.enabled=true;
+SELECT id, int_col,
+  FIRST_VALUE(int_col IGNORE NULLS) OVER(ORDER BY id) AS first_int,
+  LAST_VALUE(int_col IGNORE NULLS) OVER(ORDER BY id) AS last_int
+FROM window_int_test;
+
+-- Test FIRST_VALUE and LAST_VALUE for int column with PARTITION BY clause
+set hive.vectorized.execution.enabled=false;
+SELECT id, int_col,
+  FIRST_VALUE(int_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id) AS first_int,
+  LAST_VALUE(int_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id) AS last_int
+FROM window_int_test;
+
+set hive.vectorized.execution.enabled=true;
+SELECT id, int_col,
+  FIRST_VALUE(int_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id) AS first_int,
+  LAST_VALUE(int_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id) AS last_int
+FROM window_int_test;
+
+-- Test FIRST_VALUE and LAST_VALUE for int column without IGNORE NULLS
+set hive.vectorized.execution.enabled=false;
+SELECT id, int_col,
+  FIRST_VALUE(int_col) OVER(ORDER BY id) AS first_int,
+  LAST_VALUE(int_col) OVER(ORDER BY id) AS last_int
+FROM window_int_test;
+
+set hive.vectorized.execution.enabled=true;
+SELECT id, int_col,
+  FIRST_VALUE(int_col) OVER(ORDER BY id) AS first_int,
+  LAST_VALUE(int_col) OVER(ORDER BY id) AS last_int
+FROM window_int_test;
+
+-- Test FIRST_VALUE and LAST_VALUE for int column with PARTITION BY clause and without IGNORE NULLS
+set hive.vectorized.execution.enabled=false;
+SELECT id, int_col,
+  FIRST_VALUE(int_col) OVER(PARTITION BY id ORDER BY id) AS first_int,
+  LAST_VALUE(int_col) OVER(PARTITION BY id ORDER BY id) AS last_int
+FROM window_int_test;
+
+set hive.vectorized.execution.enabled=true;
+SELECT id, int_col,
+  FIRST_VALUE(int_col) OVER(PARTITION BY id ORDER BY id) AS first_int,
+  LAST_VALUE(int_col) OVER(PARTITION BY id ORDER BY id) AS last_int
+FROM window_int_test;
+
+
+--========================================================================================
+-- Repeat the same tests with nulls first added after order by clause
+--========================================================================================
+-- Test FIRST_VALUE and LAST_VALUE for int column with IGNORE NULLS outside function
+set hive.vectorized.execution.enabled=false;
+SELECT id, int_col,
+  FIRST_VALUE(int_col) IGNORE NULLS OVER(ORDER BY id ASC NULLS FIRST) AS first_int,
+  LAST_VALUE(int_col) IGNORE NULLS OVER(ORDER BY id ASC NULLS FIRST) AS last_int
+FROM window_int_test;
+
+set hive.vectorized.execution.enabled=true;
+SELECT id, int_col,
+  FIRST_VALUE(int_col) IGNORE NULLS OVER(ORDER BY id ASC NULLS FIRST) AS first_int,
+  LAST_VALUE(int_col) IGNORE NULLS OVER(ORDER BY id ASC NULLS FIRST) AS last_int
+FROM window_int_test;
+
+-- Test FIRST_VALUE and LAST_VALUE for int column with IGNORE NULLS inside function
+set hive.vectorized.execution.enabled=false;
+SELECT id, int_col,
+  FIRST_VALUE(int_col IGNORE NULLS) OVER(ORDER BY id ASC NULLS FIRST) AS first_int,
+  LAST_VALUE(int_col IGNORE NULLS) OVER(ORDER BY id ASC NULLS FIRST) AS last_int
+FROM window_int_test;
+
+set hive.vectorized.execution.enabled=true;
+SELECT id, int_col,
+  FIRST_VALUE(int_col IGNORE NULLS) OVER(ORDER BY id ASC NULLS FIRST) AS first_int,
+  LAST_VALUE(int_col IGNORE NULLS) OVER(ORDER BY id ASC NULLS FIRST) AS last_int
+FROM window_int_test;
+
+-- Test FIRST_VALUE and LAST_VALUE for int column with PARTITION BY clause
+set hive.vectorized.execution.enabled=false;
+SELECT id, int_col,
+  FIRST_VALUE(int_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS first_int,
+  LAST_VALUE(int_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS last_int
+FROM window_int_test;
+
+set hive.vectorized.execution.enabled=true;
+SELECT id, int_col,
+  FIRST_VALUE(int_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS first_int,
+  LAST_VALUE(int_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS last_int
+FROM window_int_test;
+
+-- Test FIRST_VALUE and LAST_VALUE for int column without IGNORE NULLS
+set hive.vectorized.execution.enabled=false;
+SELECT id, int_col,
+  FIRST_VALUE(int_col) OVER(ORDER BY id ASC NULLS FIRST) AS first_int,
+  LAST_VALUE(int_col) OVER(ORDER BY id ASC NULLS FIRST) AS last_int
+FROM window_int_test;
+
+set hive.vectorized.execution.enabled=true;
+SELECT id, int_col,
+  FIRST_VALUE(int_col) OVER(ORDER BY id ASC NULLS FIRST) AS first_int,
+  LAST_VALUE(int_col) OVER(ORDER BY id ASC NULLS FIRST) AS last_int
+FROM window_int_test;
+
+-- Test FIRST_VALUE and LAST_VALUE for int column with PARTITION BY clause and without IGNORE NULLS
+set hive.vectorized.execution.enabled=false;
+SELECT id, int_col,
+  FIRST_VALUE(int_col) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS first_int,
+  LAST_VALUE(int_col) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS last_int
+FROM window_int_test;
+
+set hive.vectorized.execution.enabled=true;
+SELECT id, int_col,
+  FIRST_VALUE(int_col) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS first_int,
+  LAST_VALUE(int_col) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS last_int
+FROM window_int_test;
+
+--========================================================================================
+-- Test with reducer batch size set to 2
+--========================================================================================
+set hive.vectorized.testing.reducer.batch.size=2;
+set hive.vectorized.execution.enabled=true;
+
+SELECT id, int_col,
+  FIRST_VALUE(int_col) IGNORE NULLS OVER(ORDER BY id) AS first_int,
+  LAST_VALUE(int_col) IGNORE NULLS OVER(ORDER BY id) AS last_int
+FROM window_int_test;
+
+SELECT id, int_col,
+  FIRST_VALUE(int_col) IGNORE NULLS OVER(ORDER BY id ASC NULLS FIRST) AS first_int,
+  LAST_VALUE(int_col) IGNORE NULLS OVER(ORDER BY id ASC NULLS FIRST) AS last_int
+FROM window_int_test;
+
+SELECT id, int_col,
+  FIRST_VALUE(int_col IGNORE NULLS) OVER(ORDER BY id) AS first_int,
+  LAST_VALUE(int_col IGNORE NULLS) OVER(ORDER BY id) AS last_int
+FROM window_int_test;
+
+SELECT id, int_col,
+  FIRST_VALUE(int_col IGNORE NULLS) OVER(ORDER BY id ASC NULLS FIRST) AS first_int,
+  LAST_VALUE(int_col IGNORE NULLS) OVER(ORDER BY id ASC NULLS FIRST) AS last_int
+FROM window_int_test;
+
+SELECT id, int_col,
+  FIRST_VALUE(int_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id) AS first_int,
+  LAST_VALUE(int_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id) AS last_int
+FROM window_int_test;
+
+SELECT id, int_col,
+  FIRST_VALUE(int_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS first_int,
+  LAST_VALUE(int_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS last_int
+FROM window_int_test;
+
+SELECT id, int_col,
+  FIRST_VALUE(int_col) OVER(ORDER BY id) AS first_int,
+  LAST_VALUE(int_col) OVER(ORDER BY id) AS last_int
+FROM window_int_test;
+
+SELECT id, int_col,
+  FIRST_VALUE(int_col) OVER(ORDER BY id ASC NULLS FIRST) AS first_int,
+  LAST_VALUE(int_col) OVER(ORDER BY id ASC NULLS FIRST) AS last_int
+FROM window_int_test;
+
+SELECT id, int_col,
+  FIRST_VALUE(int_col) OVER(PARTITION BY id ORDER BY id) AS first_int,
+  LAST_VALUE(int_col) OVER(PARTITION BY id ORDER BY id) AS last_int
+FROM window_int_test;
+
+SELECT id, int_col,
+  FIRST_VALUE(int_col) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS first_int,
+  LAST_VALUE(int_col) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS last_int
+FROM window_int_test;
diff --git a/ql/src/test/results/clientpositive/llap/vectorized_first_last_value_ignore_nulls_decimal.q.out b/ql/src/test/results/clientpositive/llap/vectorized_first_last_value_ignore_nulls_decimal.q.out
new file mode 100644
index 0000000000..a6b7b0642a
--- /dev/null
+++ b/ql/src/test/results/clientpositive/llap/vectorized_first_last_value_ignore_nulls_decimal.q.out
@@ -0,0 +1,1051 @@
+PREHOOK: query: CREATE TABLE window_decimal_test (
+  id INT,
+  decimal_col DECIMAL(10,2)
+)
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@window_decimal_test
+POSTHOOK: query: CREATE TABLE window_decimal_test (
+  id INT,
+  decimal_col DECIMAL(10,2)
+)
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@window_decimal_test
+PREHOOK: query: INSERT INTO window_decimal_test VALUES
+  (1, NULL),
+  (2, NULL),
+  (1, NULL),
+  (1, NULL),
+  (2, 200.00),
+  (3, NULL),
+  (6, 610.00),
+  (2, NULL),
+  (3, 300.75),
+  (4, NULL),
+  (3, 300.50),
+  (5, 500.20),
+  (4, 400.00),
+  (5, NULL),
+  (6, 600.00),
+  (7, NULL),
+  (NULL, 800.00),
+  (NULL, NULL)
+PREHOOK: type: QUERY
+PREHOOK: Input: _dummy_database@_dummy_table
+PREHOOK: Output: default@window_decimal_test
+POSTHOOK: query: INSERT INTO window_decimal_test VALUES
+  (1, NULL),
+  (2, NULL),
+  (1, NULL),
+  (1, NULL),
+  (2, 200.00),
+  (3, NULL),
+  (6, 610.00),
+  (2, NULL),
+  (3, 300.75),
+  (4, NULL),
+  (3, 300.50),
+  (5, 500.20),
+  (4, 400.00),
+  (5, NULL),
+  (6, 600.00),
+  (7, NULL),
+  (NULL, 800.00),
+  (NULL, NULL)
+POSTHOOK: type: QUERY
+POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@window_decimal_test
+POSTHOOK: Lineage: window_decimal_test.decimal_col SCRIPT []
+POSTHOOK: Lineage: window_decimal_test.id SCRIPT []
+_col0	_col1
+PREHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col) IGNORE NULLS OVER(ORDER BY id) AS first_decimal,
+  LAST_VALUE(decimal_col) IGNORE NULLS OVER(ORDER BY id) AS last_decimal
+FROM window_decimal_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col) IGNORE NULLS OVER(ORDER BY id) AS first_decimal,
+  LAST_VALUE(decimal_col) IGNORE NULLS OVER(ORDER BY id) AS last_decimal
+FROM window_decimal_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+id	decimal_col	first_decimal	last_decimal
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+2	NULL	200.00	200.00
+2	200.00	200.00	200.00
+2	NULL	200.00	200.00
+3	NULL	200.00	300.75
+3	300.50	200.00	300.75
+3	300.75	200.00	300.75
+4	NULL	200.00	400.00
+4	400.00	200.00	400.00
+5	500.20	200.00	500.20
+5	NULL	200.00	500.20
+6	600.00	200.00	610.00
+6	610.00	200.00	610.00
+7	NULL	200.00	610.00
+NULL	NULL	200.00	800.00
+NULL	800.00	200.00	800.00
+PREHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col) IGNORE NULLS OVER(ORDER BY id) AS first_decimal,
+  LAST_VALUE(decimal_col) IGNORE NULLS OVER(ORDER BY id) AS last_decimal
+FROM window_decimal_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col) IGNORE NULLS OVER(ORDER BY id) AS first_decimal,
+  LAST_VALUE(decimal_col) IGNORE NULLS OVER(ORDER BY id) AS last_decimal
+FROM window_decimal_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+id	decimal_col	first_decimal	last_decimal
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+2	NULL	200.00	200.00
+2	200.00	200.00	200.00
+2	NULL	200.00	200.00
+3	NULL	200.00	300.75
+3	300.50	200.00	300.75
+3	300.75	200.00	300.75
+4	NULL	200.00	400.00
+4	400.00	200.00	400.00
+5	500.20	200.00	500.20
+5	NULL	200.00	500.20
+6	600.00	200.00	610.00
+6	610.00	200.00	610.00
+7	NULL	200.00	610.00
+NULL	NULL	200.00	800.00
+NULL	800.00	200.00	800.00
+PREHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col IGNORE NULLS) OVER(ORDER BY id) AS first_decimal,
+  LAST_VALUE(decimal_col IGNORE NULLS) OVER(ORDER BY id) AS last_decimal
+FROM window_decimal_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col IGNORE NULLS) OVER(ORDER BY id) AS first_decimal,
+  LAST_VALUE(decimal_col IGNORE NULLS) OVER(ORDER BY id) AS last_decimal
+FROM window_decimal_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+id	decimal_col	first_decimal	last_decimal
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+2	NULL	200.00	200.00
+2	200.00	200.00	200.00
+2	NULL	200.00	200.00
+3	NULL	200.00	300.75
+3	300.50	200.00	300.75
+3	300.75	200.00	300.75
+4	NULL	200.00	400.00
+4	400.00	200.00	400.00
+5	500.20	200.00	500.20
+5	NULL	200.00	500.20
+6	600.00	200.00	610.00
+6	610.00	200.00	610.00
+7	NULL	200.00	610.00
+NULL	NULL	200.00	800.00
+NULL	800.00	200.00	800.00
+PREHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col IGNORE NULLS) OVER(ORDER BY id) AS first_decimal,
+  LAST_VALUE(decimal_col IGNORE NULLS) OVER(ORDER BY id) AS last_decimal
+FROM window_decimal_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col IGNORE NULLS) OVER(ORDER BY id) AS first_decimal,
+  LAST_VALUE(decimal_col IGNORE NULLS) OVER(ORDER BY id) AS last_decimal
+FROM window_decimal_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+id	decimal_col	first_decimal	last_decimal
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+2	NULL	200.00	200.00
+2	200.00	200.00	200.00
+2	NULL	200.00	200.00
+3	NULL	200.00	300.75
+3	300.50	200.00	300.75
+3	300.75	200.00	300.75
+4	NULL	200.00	400.00
+4	400.00	200.00	400.00
+5	500.20	200.00	500.20
+5	NULL	200.00	500.20
+6	600.00	200.00	610.00
+6	610.00	200.00	610.00
+7	NULL	200.00	610.00
+NULL	NULL	200.00	800.00
+NULL	800.00	200.00	800.00
+PREHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id) AS first_decimal,
+  LAST_VALUE(decimal_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id) AS last_decimal
+FROM window_decimal_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id) AS first_decimal,
+  LAST_VALUE(decimal_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id) AS last_decimal
+FROM window_decimal_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+id	decimal_col	first_decimal	last_decimal
+3	NULL	300.75	300.50
+3	300.75	300.75	300.50
+3	300.50	300.75	300.50
+5	500.20	500.20	500.20
+5	NULL	500.20	500.20
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+2	NULL	200.00	200.00
+2	200.00	200.00	200.00
+2	NULL	200.00	200.00
+4	NULL	400.00	400.00
+4	400.00	400.00	400.00
+6	610.00	610.00	600.00
+6	600.00	610.00	600.00
+7	NULL	NULL	NULL
+NULL	800.00	800.00	800.00
+NULL	NULL	800.00	800.00
+PREHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id) AS first_decimal,
+  LAST_VALUE(decimal_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id) AS last_decimal
+FROM window_decimal_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id) AS first_decimal,
+  LAST_VALUE(decimal_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id) AS last_decimal
+FROM window_decimal_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+id	decimal_col	first_decimal	last_decimal
+3	NULL	300.75	300.50
+3	300.75	300.75	300.50
+3	300.50	300.75	300.50
+5	500.20	500.20	500.20
+5	NULL	500.20	500.20
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+2	NULL	200.00	200.00
+2	200.00	200.00	200.00
+2	NULL	200.00	200.00
+4	NULL	400.00	400.00
+4	400.00	400.00	400.00
+6	610.00	610.00	600.00
+6	600.00	610.00	600.00
+7	NULL	NULL	NULL
+NULL	800.00	800.00	800.00
+NULL	NULL	800.00	800.00
+PREHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col) OVER(ORDER BY id) AS first_decimal,
+  LAST_VALUE(decimal_col) OVER(ORDER BY id) AS last_decimal
+FROM window_decimal_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col) OVER(ORDER BY id) AS first_decimal,
+  LAST_VALUE(decimal_col) OVER(ORDER BY id) AS last_decimal
+FROM window_decimal_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+id	decimal_col	first_decimal	last_decimal
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+2	NULL	NULL	NULL
+2	200.00	NULL	NULL
+2	NULL	NULL	NULL
+3	NULL	NULL	300.75
+3	300.50	NULL	300.75
+3	300.75	NULL	300.75
+4	NULL	NULL	400.00
+4	400.00	NULL	400.00
+5	500.20	NULL	NULL
+5	NULL	NULL	NULL
+6	600.00	NULL	610.00
+6	610.00	NULL	610.00
+7	NULL	NULL	NULL
+NULL	NULL	NULL	800.00
+NULL	800.00	NULL	800.00
+PREHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col) OVER(ORDER BY id) AS first_decimal,
+  LAST_VALUE(decimal_col) OVER(ORDER BY id) AS last_decimal
+FROM window_decimal_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col) OVER(ORDER BY id) AS first_decimal,
+  LAST_VALUE(decimal_col) OVER(ORDER BY id) AS last_decimal
+FROM window_decimal_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+id	decimal_col	first_decimal	last_decimal
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+2	NULL	NULL	NULL
+2	200.00	NULL	NULL
+2	NULL	NULL	NULL
+3	NULL	NULL	300.75
+3	300.50	NULL	300.75
+3	300.75	NULL	300.75
+4	NULL	NULL	400.00
+4	400.00	NULL	400.00
+5	500.20	NULL	NULL
+5	NULL	NULL	NULL
+6	600.00	NULL	610.00
+6	610.00	NULL	610.00
+7	NULL	NULL	NULL
+NULL	NULL	NULL	800.00
+NULL	800.00	NULL	800.00
+PREHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col) OVER(PARTITION BY id ORDER BY id) AS first_decimal,
+  LAST_VALUE(decimal_col) OVER(PARTITION BY id ORDER BY id) AS last_decimal
+FROM window_decimal_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col) OVER(PARTITION BY id ORDER BY id) AS first_decimal,
+  LAST_VALUE(decimal_col) OVER(PARTITION BY id ORDER BY id) AS last_decimal
+FROM window_decimal_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+id	decimal_col	first_decimal	last_decimal
+3	NULL	NULL	300.50
+3	300.75	NULL	300.50
+3	300.50	NULL	300.50
+5	500.20	500.20	NULL
+5	NULL	500.20	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+2	NULL	NULL	NULL
+2	200.00	NULL	NULL
+2	NULL	NULL	NULL
+4	NULL	NULL	400.00
+4	400.00	NULL	400.00
+6	610.00	610.00	600.00
+6	600.00	610.00	600.00
+7	NULL	NULL	NULL
+NULL	800.00	800.00	NULL
+NULL	NULL	800.00	NULL
+PREHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col) OVER(PARTITION BY id ORDER BY id) AS first_decimal,
+  LAST_VALUE(decimal_col) OVER(PARTITION BY id ORDER BY id) AS last_decimal
+FROM window_decimal_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col) OVER(PARTITION BY id ORDER BY id) AS first_decimal,
+  LAST_VALUE(decimal_col) OVER(PARTITION BY id ORDER BY id) AS last_decimal
+FROM window_decimal_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+id	decimal_col	first_decimal	last_decimal
+3	NULL	NULL	300.50
+3	300.75	NULL	300.50
+3	300.50	NULL	300.50
+5	500.20	500.20	NULL
+5	NULL	500.20	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+2	NULL	NULL	NULL
+2	200.00	NULL	NULL
+2	NULL	NULL	NULL
+4	NULL	NULL	400.00
+4	400.00	NULL	400.00
+6	610.00	610.00	600.00
+6	600.00	610.00	600.00
+7	NULL	NULL	NULL
+NULL	800.00	800.00	NULL
+NULL	NULL	800.00	NULL
+PREHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col) IGNORE NULLS OVER(ORDER BY id ASC NULLS FIRST) AS first_decimal,
+  LAST_VALUE(decimal_col) IGNORE NULLS OVER(ORDER BY id ASC NULLS FIRST) AS last_decimal
+FROM window_decimal_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col) IGNORE NULLS OVER(ORDER BY id ASC NULLS FIRST) AS first_decimal,
+  LAST_VALUE(decimal_col) IGNORE NULLS OVER(ORDER BY id ASC NULLS FIRST) AS last_decimal
+FROM window_decimal_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+id	decimal_col	first_decimal	last_decimal
+NULL	NULL	800.00	800.00
+NULL	800.00	800.00	800.00
+1	NULL	800.00	800.00
+1	NULL	800.00	800.00
+1	NULL	800.00	800.00
+2	NULL	800.00	200.00
+2	NULL	800.00	200.00
+2	200.00	800.00	200.00
+3	NULL	800.00	300.50
+3	300.75	800.00	300.50
+3	300.50	800.00	300.50
+4	NULL	800.00	400.00
+4	400.00	800.00	400.00
+5	NULL	800.00	500.20
+5	500.20	800.00	500.20
+6	600.00	800.00	610.00
+6	610.00	800.00	610.00
+7	NULL	800.00	610.00
+PREHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col) IGNORE NULLS OVER(ORDER BY id ASC NULLS FIRST) AS first_decimal,
+  LAST_VALUE(decimal_col) IGNORE NULLS OVER(ORDER BY id ASC NULLS FIRST) AS last_decimal
+FROM window_decimal_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col) IGNORE NULLS OVER(ORDER BY id ASC NULLS FIRST) AS first_decimal,
+  LAST_VALUE(decimal_col) IGNORE NULLS OVER(ORDER BY id ASC NULLS FIRST) AS last_decimal
+FROM window_decimal_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+id	decimal_col	first_decimal	last_decimal
+NULL	NULL	800.00	800.00
+NULL	800.00	800.00	800.00
+1	NULL	800.00	800.00
+1	NULL	800.00	800.00
+1	NULL	800.00	800.00
+2	NULL	800.00	200.00
+2	NULL	800.00	200.00
+2	200.00	800.00	200.00
+3	NULL	800.00	300.50
+3	300.75	800.00	300.50
+3	300.50	800.00	300.50
+4	NULL	800.00	400.00
+4	400.00	800.00	400.00
+5	NULL	800.00	500.20
+5	500.20	800.00	500.20
+6	600.00	800.00	610.00
+6	610.00	800.00	610.00
+7	NULL	800.00	610.00
+PREHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col IGNORE NULLS) OVER(ORDER BY id ASC NULLS FIRST) AS first_decimal,
+  LAST_VALUE(decimal_col IGNORE NULLS) OVER(ORDER BY id ASC NULLS FIRST) AS last_decimal
+FROM window_decimal_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col IGNORE NULLS) OVER(ORDER BY id ASC NULLS FIRST) AS first_decimal,
+  LAST_VALUE(decimal_col IGNORE NULLS) OVER(ORDER BY id ASC NULLS FIRST) AS last_decimal
+FROM window_decimal_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+id	decimal_col	first_decimal	last_decimal
+NULL	NULL	800.00	800.00
+NULL	800.00	800.00	800.00
+1	NULL	800.00	800.00
+1	NULL	800.00	800.00
+1	NULL	800.00	800.00
+2	NULL	800.00	200.00
+2	NULL	800.00	200.00
+2	200.00	800.00	200.00
+3	NULL	800.00	300.50
+3	300.75	800.00	300.50
+3	300.50	800.00	300.50
+4	NULL	800.00	400.00
+4	400.00	800.00	400.00
+5	NULL	800.00	500.20
+5	500.20	800.00	500.20
+6	600.00	800.00	610.00
+6	610.00	800.00	610.00
+7	NULL	800.00	610.00
+PREHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col IGNORE NULLS) OVER(ORDER BY id ASC NULLS FIRST) AS first_decimal,
+  LAST_VALUE(decimal_col IGNORE NULLS) OVER(ORDER BY id ASC NULLS FIRST) AS last_decimal
+FROM window_decimal_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col IGNORE NULLS) OVER(ORDER BY id ASC NULLS FIRST) AS first_decimal,
+  LAST_VALUE(decimal_col IGNORE NULLS) OVER(ORDER BY id ASC NULLS FIRST) AS last_decimal
+FROM window_decimal_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+id	decimal_col	first_decimal	last_decimal
+NULL	NULL	800.00	800.00
+NULL	800.00	800.00	800.00
+1	NULL	800.00	800.00
+1	NULL	800.00	800.00
+1	NULL	800.00	800.00
+2	NULL	800.00	200.00
+2	NULL	800.00	200.00
+2	200.00	800.00	200.00
+3	NULL	800.00	300.50
+3	300.75	800.00	300.50
+3	300.50	800.00	300.50
+4	NULL	800.00	400.00
+4	400.00	800.00	400.00
+5	NULL	800.00	500.20
+5	500.20	800.00	500.20
+6	600.00	800.00	610.00
+6	610.00	800.00	610.00
+7	NULL	800.00	610.00
+PREHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS first_decimal,
+  LAST_VALUE(decimal_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS last_decimal
+FROM window_decimal_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS first_decimal,
+  LAST_VALUE(decimal_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS last_decimal
+FROM window_decimal_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+id	decimal_col	first_decimal	last_decimal
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+NULL	NULL	800.00	800.00
+NULL	800.00	800.00	800.00
+2	200.00	200.00	200.00
+2	NULL	200.00	200.00
+2	NULL	200.00	200.00
+3	NULL	300.75	300.50
+3	300.75	300.75	300.50
+3	300.50	300.75	300.50
+4	400.00	400.00	400.00
+4	NULL	400.00	400.00
+5	NULL	500.20	500.20
+5	500.20	500.20	500.20
+6	610.00	610.00	600.00
+6	600.00	610.00	600.00
+7	NULL	NULL	NULL
+PREHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS first_decimal,
+  LAST_VALUE(decimal_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS last_decimal
+FROM window_decimal_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS first_decimal,
+  LAST_VALUE(decimal_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS last_decimal
+FROM window_decimal_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+id	decimal_col	first_decimal	last_decimal
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+NULL	NULL	800.00	800.00
+NULL	800.00	800.00	800.00
+2	200.00	200.00	200.00
+2	NULL	200.00	200.00
+2	NULL	200.00	200.00
+3	NULL	300.75	300.50
+3	300.75	300.75	300.50
+3	300.50	300.75	300.50
+4	400.00	400.00	400.00
+4	NULL	400.00	400.00
+5	NULL	500.20	500.20
+5	500.20	500.20	500.20
+6	610.00	610.00	600.00
+6	600.00	610.00	600.00
+7	NULL	NULL	NULL
+PREHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col) OVER(ORDER BY id ASC NULLS FIRST) AS first_decimal,
+  LAST_VALUE(decimal_col) OVER(ORDER BY id ASC NULLS FIRST) AS last_decimal
+FROM window_decimal_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col) OVER(ORDER BY id ASC NULLS FIRST) AS first_decimal,
+  LAST_VALUE(decimal_col) OVER(ORDER BY id ASC NULLS FIRST) AS last_decimal
+FROM window_decimal_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+id	decimal_col	first_decimal	last_decimal
+NULL	NULL	NULL	800.00
+NULL	800.00	NULL	800.00
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+2	NULL	NULL	200.00
+2	NULL	NULL	200.00
+2	200.00	NULL	200.00
+3	NULL	NULL	300.50
+3	300.75	NULL	300.50
+3	300.50	NULL	300.50
+4	NULL	NULL	400.00
+4	400.00	NULL	400.00
+5	NULL	NULL	500.20
+5	500.20	NULL	500.20
+6	600.00	NULL	610.00
+6	610.00	NULL	610.00
+7	NULL	NULL	NULL
+PREHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col) OVER(ORDER BY id ASC NULLS FIRST) AS first_decimal,
+  LAST_VALUE(decimal_col) OVER(ORDER BY id ASC NULLS FIRST) AS last_decimal
+FROM window_decimal_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col) OVER(ORDER BY id ASC NULLS FIRST) AS first_decimal,
+  LAST_VALUE(decimal_col) OVER(ORDER BY id ASC NULLS FIRST) AS last_decimal
+FROM window_decimal_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+id	decimal_col	first_decimal	last_decimal
+NULL	NULL	NULL	800.00
+NULL	800.00	NULL	800.00
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+2	NULL	NULL	200.00
+2	NULL	NULL	200.00
+2	200.00	NULL	200.00
+3	NULL	NULL	300.50
+3	300.75	NULL	300.50
+3	300.50	NULL	300.50
+4	NULL	NULL	400.00
+4	400.00	NULL	400.00
+5	NULL	NULL	500.20
+5	500.20	NULL	500.20
+6	600.00	NULL	610.00
+6	610.00	NULL	610.00
+7	NULL	NULL	NULL
+PREHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS first_decimal,
+  LAST_VALUE(decimal_col) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS last_decimal
+FROM window_decimal_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS first_decimal,
+  LAST_VALUE(decimal_col) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS last_decimal
+FROM window_decimal_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+id	decimal_col	first_decimal	last_decimal
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+NULL	NULL	NULL	800.00
+NULL	800.00	NULL	800.00
+2	200.00	200.00	NULL
+2	NULL	200.00	NULL
+2	NULL	200.00	NULL
+3	NULL	NULL	300.50
+3	300.75	NULL	300.50
+3	300.50	NULL	300.50
+4	400.00	400.00	NULL
+4	NULL	400.00	NULL
+5	NULL	NULL	500.20
+5	500.20	NULL	500.20
+6	610.00	610.00	600.00
+6	600.00	610.00	600.00
+7	NULL	NULL	NULL
+PREHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS first_decimal,
+  LAST_VALUE(decimal_col) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS last_decimal
+FROM window_decimal_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS first_decimal,
+  LAST_VALUE(decimal_col) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS last_decimal
+FROM window_decimal_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+id	decimal_col	first_decimal	last_decimal
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+NULL	NULL	NULL	800.00
+NULL	800.00	NULL	800.00
+2	200.00	200.00	NULL
+2	NULL	200.00	NULL
+2	NULL	200.00	NULL
+3	NULL	NULL	300.50
+3	300.75	NULL	300.50
+3	300.50	NULL	300.50
+4	400.00	400.00	NULL
+4	NULL	400.00	NULL
+5	NULL	NULL	500.20
+5	500.20	NULL	500.20
+6	610.00	610.00	600.00
+6	600.00	610.00	600.00
+7	NULL	NULL	NULL
+PREHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col) IGNORE NULLS OVER(ORDER BY id) AS first_decimal,
+  LAST_VALUE(decimal_col) IGNORE NULLS OVER(ORDER BY id) AS last_decimal
+FROM window_decimal_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col) IGNORE NULLS OVER(ORDER BY id) AS first_decimal,
+  LAST_VALUE(decimal_col) IGNORE NULLS OVER(ORDER BY id) AS last_decimal
+FROM window_decimal_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+id	decimal_col	first_decimal	last_decimal
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+2	NULL	200.00	200.00
+2	200.00	200.00	200.00
+2	NULL	200.00	200.00
+3	NULL	200.00	300.75
+3	300.50	200.00	300.75
+3	300.75	200.00	300.75
+4	NULL	200.00	400.00
+4	400.00	200.00	400.00
+5	500.20	200.00	500.20
+5	NULL	200.00	500.20
+6	600.00	200.00	610.00
+6	610.00	200.00	610.00
+7	NULL	200.00	610.00
+NULL	NULL	200.00	800.00
+NULL	800.00	200.00	800.00
+PREHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col) IGNORE NULLS OVER(ORDER BY id ASC NULLS FIRST) AS first_decimal,
+  LAST_VALUE(decimal_col) IGNORE NULLS OVER(ORDER BY id ASC NULLS FIRST) AS last_decimal
+FROM window_decimal_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col) IGNORE NULLS OVER(ORDER BY id ASC NULLS FIRST) AS first_decimal,
+  LAST_VALUE(decimal_col) IGNORE NULLS OVER(ORDER BY id ASC NULLS FIRST) AS last_decimal
+FROM window_decimal_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+id	decimal_col	first_decimal	last_decimal
+NULL	NULL	800.00	800.00
+NULL	800.00	800.00	800.00
+1	NULL	800.00	800.00
+1	NULL	800.00	800.00
+1	NULL	800.00	800.00
+2	NULL	800.00	200.00
+2	NULL	800.00	200.00
+2	200.00	800.00	200.00
+3	NULL	800.00	300.50
+3	300.75	800.00	300.50
+3	300.50	800.00	300.50
+4	NULL	800.00	400.00
+4	400.00	800.00	400.00
+5	NULL	800.00	500.20
+5	500.20	800.00	500.20
+6	600.00	800.00	610.00
+6	610.00	800.00	610.00
+7	NULL	800.00	610.00
+PREHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col IGNORE NULLS) OVER(ORDER BY id) AS first_decimal,
+  LAST_VALUE(decimal_col IGNORE NULLS) OVER(ORDER BY id) AS last_decimal
+FROM window_decimal_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col IGNORE NULLS) OVER(ORDER BY id) AS first_decimal,
+  LAST_VALUE(decimal_col IGNORE NULLS) OVER(ORDER BY id) AS last_decimal
+FROM window_decimal_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+id	decimal_col	first_decimal	last_decimal
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+2	NULL	200.00	200.00
+2	200.00	200.00	200.00
+2	NULL	200.00	200.00
+3	NULL	200.00	300.75
+3	300.50	200.00	300.75
+3	300.75	200.00	300.75
+4	NULL	200.00	400.00
+4	400.00	200.00	400.00
+5	500.20	200.00	500.20
+5	NULL	200.00	500.20
+6	600.00	200.00	610.00
+6	610.00	200.00	610.00
+7	NULL	200.00	610.00
+NULL	NULL	200.00	800.00
+NULL	800.00	200.00	800.00
+PREHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col IGNORE NULLS) OVER(ORDER BY id ASC NULLS FIRST) AS first_decimal,
+  LAST_VALUE(decimal_col IGNORE NULLS) OVER(ORDER BY id ASC NULLS FIRST) AS last_decimal
+FROM window_decimal_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col IGNORE NULLS) OVER(ORDER BY id ASC NULLS FIRST) AS first_decimal,
+  LAST_VALUE(decimal_col IGNORE NULLS) OVER(ORDER BY id ASC NULLS FIRST) AS last_decimal
+FROM window_decimal_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+id	decimal_col	first_decimal	last_decimal
+NULL	NULL	800.00	800.00
+NULL	800.00	800.00	800.00
+1	NULL	800.00	800.00
+1	NULL	800.00	800.00
+1	NULL	800.00	800.00
+2	NULL	800.00	200.00
+2	NULL	800.00	200.00
+2	200.00	800.00	200.00
+3	NULL	800.00	300.50
+3	300.75	800.00	300.50
+3	300.50	800.00	300.50
+4	NULL	800.00	400.00
+4	400.00	800.00	400.00
+5	NULL	800.00	500.20
+5	500.20	800.00	500.20
+6	600.00	800.00	610.00
+6	610.00	800.00	610.00
+7	NULL	800.00	610.00
+PREHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id) AS first_decimal,
+  LAST_VALUE(decimal_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id) AS last_decimal
+FROM window_decimal_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id) AS first_decimal,
+  LAST_VALUE(decimal_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id) AS last_decimal
+FROM window_decimal_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+id	decimal_col	first_decimal	last_decimal
+3	NULL	300.75	300.50
+3	300.75	300.75	300.50
+3	300.50	300.75	300.50
+5	500.20	500.20	500.20
+5	NULL	500.20	500.20
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+2	NULL	200.00	200.00
+2	200.00	200.00	200.00
+2	NULL	200.00	200.00
+4	NULL	400.00	400.00
+4	400.00	400.00	400.00
+6	610.00	610.00	600.00
+6	600.00	610.00	600.00
+7	NULL	NULL	NULL
+NULL	800.00	800.00	800.00
+NULL	NULL	800.00	800.00
+PREHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS first_decimal,
+  LAST_VALUE(decimal_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS last_decimal
+FROM window_decimal_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS first_decimal,
+  LAST_VALUE(decimal_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS last_decimal
+FROM window_decimal_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+id	decimal_col	first_decimal	last_decimal
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+NULL	NULL	800.00	800.00
+NULL	800.00	800.00	800.00
+2	200.00	200.00	200.00
+2	NULL	200.00	200.00
+2	NULL	200.00	200.00
+3	NULL	300.75	300.50
+3	300.75	300.75	300.50
+3	300.50	300.75	300.50
+4	400.00	400.00	400.00
+4	NULL	400.00	400.00
+5	NULL	500.20	500.20
+5	500.20	500.20	500.20
+6	610.00	610.00	600.00
+6	600.00	610.00	600.00
+7	NULL	NULL	NULL
+PREHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col) OVER(ORDER BY id) AS first_decimal,
+  LAST_VALUE(decimal_col) OVER(ORDER BY id) AS last_decimal
+FROM window_decimal_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col) OVER(ORDER BY id) AS first_decimal,
+  LAST_VALUE(decimal_col) OVER(ORDER BY id) AS last_decimal
+FROM window_decimal_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+id	decimal_col	first_decimal	last_decimal
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+2	NULL	NULL	NULL
+2	200.00	NULL	NULL
+2	NULL	NULL	NULL
+3	NULL	NULL	300.75
+3	300.50	NULL	300.75
+3	300.75	NULL	300.75
+4	NULL	NULL	400.00
+4	400.00	NULL	400.00
+5	500.20	NULL	NULL
+5	NULL	NULL	NULL
+6	600.00	NULL	610.00
+6	610.00	NULL	610.00
+7	NULL	NULL	NULL
+NULL	NULL	NULL	800.00
+NULL	800.00	NULL	800.00
+PREHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col) OVER(ORDER BY id ASC NULLS FIRST) AS first_decimal,
+  LAST_VALUE(decimal_col) OVER(ORDER BY id ASC NULLS FIRST) AS last_decimal
+FROM window_decimal_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col) OVER(ORDER BY id ASC NULLS FIRST) AS first_decimal,
+  LAST_VALUE(decimal_col) OVER(ORDER BY id ASC NULLS FIRST) AS last_decimal
+FROM window_decimal_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+id	decimal_col	first_decimal	last_decimal
+NULL	NULL	NULL	800.00
+NULL	800.00	NULL	800.00
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+2	NULL	NULL	200.00
+2	NULL	NULL	200.00
+2	200.00	NULL	200.00
+3	NULL	NULL	300.50
+3	300.75	NULL	300.50
+3	300.50	NULL	300.50
+4	NULL	NULL	400.00
+4	400.00	NULL	400.00
+5	NULL	NULL	500.20
+5	500.20	NULL	500.20
+6	600.00	NULL	610.00
+6	610.00	NULL	610.00
+7	NULL	NULL	NULL
+PREHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col) OVER(PARTITION BY id ORDER BY id) AS first_decimal,
+  LAST_VALUE(decimal_col) OVER(PARTITION BY id ORDER BY id) AS last_decimal
+FROM window_decimal_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col) OVER(PARTITION BY id ORDER BY id) AS first_decimal,
+  LAST_VALUE(decimal_col) OVER(PARTITION BY id ORDER BY id) AS last_decimal
+FROM window_decimal_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+id	decimal_col	first_decimal	last_decimal
+3	NULL	NULL	300.50
+3	300.75	NULL	300.50
+3	300.50	NULL	300.50
+5	500.20	500.20	NULL
+5	NULL	500.20	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+2	NULL	NULL	NULL
+2	200.00	NULL	NULL
+2	NULL	NULL	NULL
+4	NULL	NULL	400.00
+4	400.00	NULL	400.00
+6	610.00	610.00	600.00
+6	600.00	610.00	600.00
+7	NULL	NULL	NULL
+NULL	800.00	800.00	NULL
+NULL	NULL	800.00	NULL
+PREHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS first_decimal,
+  LAST_VALUE(decimal_col) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS last_decimal
+FROM window_decimal_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, decimal_col,
+  FIRST_VALUE(decimal_col) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS first_decimal,
+  LAST_VALUE(decimal_col) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS last_decimal
+FROM window_decimal_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_decimal_test
+#### A masked pattern was here ####
+id	decimal_col	first_decimal	last_decimal
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+NULL	NULL	NULL	800.00
+NULL	800.00	NULL	800.00
+2	200.00	200.00	NULL
+2	NULL	200.00	NULL
+2	NULL	200.00	NULL
+3	NULL	NULL	300.50
+3	300.75	NULL	300.50
+3	300.50	NULL	300.50
+4	400.00	400.00	NULL
+4	NULL	400.00	NULL
+5	NULL	NULL	500.20
+5	500.20	NULL	500.20
+6	610.00	610.00	600.00
+6	600.00	610.00	600.00
+7	NULL	NULL	NULL
diff --git a/ql/src/test/results/clientpositive/llap/vectorized_first_last_value_ignore_nulls_double.q.out b/ql/src/test/results/clientpositive/llap/vectorized_first_last_value_ignore_nulls_double.q.out
new file mode 100644
index 0000000000..1375327e84
--- /dev/null
+++ b/ql/src/test/results/clientpositive/llap/vectorized_first_last_value_ignore_nulls_double.q.out
@@ -0,0 +1,1051 @@
+PREHOOK: query: CREATE TABLE window_double_test (
+  id INT,
+  double_col DOUBLE
+)
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@window_double_test
+POSTHOOK: query: CREATE TABLE window_double_test (
+  id INT,
+  double_col DOUBLE
+)
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@window_double_test
+PREHOOK: query: INSERT INTO window_double_test VALUES
+  (1, NULL),
+  (2, NULL),
+  (1, NULL),
+  (1, NULL),
+  (2, 25.5),
+  (3, NULL),
+  (6, 65.5),
+  (2, NULL),
+  (3, 32.5),
+  (4, NULL),
+  (3, 30.5),
+  (5, 50.5),
+  (4, 42.3),
+  (5, NULL),
+  (6, 65.2),
+  (7, NULL),
+  (NULL, 80.5),
+  (NULL, NULL)
+PREHOOK: type: QUERY
+PREHOOK: Input: _dummy_database@_dummy_table
+PREHOOK: Output: default@window_double_test
+POSTHOOK: query: INSERT INTO window_double_test VALUES
+  (1, NULL),
+  (2, NULL),
+  (1, NULL),
+  (1, NULL),
+  (2, 25.5),
+  (3, NULL),
+  (6, 65.5),
+  (2, NULL),
+  (3, 32.5),
+  (4, NULL),
+  (3, 30.5),
+  (5, 50.5),
+  (4, 42.3),
+  (5, NULL),
+  (6, 65.2),
+  (7, NULL),
+  (NULL, 80.5),
+  (NULL, NULL)
+POSTHOOK: type: QUERY
+POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@window_double_test
+POSTHOOK: Lineage: window_double_test.double_col SCRIPT []
+POSTHOOK: Lineage: window_double_test.id SCRIPT []
+_col0	_col1
+PREHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col) IGNORE NULLS OVER(ORDER BY id) AS first_double,
+  LAST_VALUE(double_col) IGNORE NULLS OVER(ORDER BY id) AS last_double
+FROM window_double_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col) IGNORE NULLS OVER(ORDER BY id) AS first_double,
+  LAST_VALUE(double_col) IGNORE NULLS OVER(ORDER BY id) AS last_double
+FROM window_double_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+id	double_col	first_double	last_double
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+2	NULL	25.5	25.5
+2	25.5	25.5	25.5
+2	NULL	25.5	25.5
+3	NULL	25.5	32.5
+3	30.5	25.5	32.5
+3	32.5	25.5	32.5
+4	NULL	25.5	42.3
+4	42.3	25.5	42.3
+5	50.5	25.5	50.5
+5	NULL	25.5	50.5
+6	65.2	25.5	65.5
+6	65.5	25.5	65.5
+7	NULL	25.5	65.5
+NULL	NULL	25.5	80.5
+NULL	80.5	25.5	80.5
+PREHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col) IGNORE NULLS OVER(ORDER BY id) AS first_double,
+  LAST_VALUE(double_col) IGNORE NULLS OVER(ORDER BY id) AS last_double
+FROM window_double_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col) IGNORE NULLS OVER(ORDER BY id) AS first_double,
+  LAST_VALUE(double_col) IGNORE NULLS OVER(ORDER BY id) AS last_double
+FROM window_double_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+id	double_col	first_double	last_double
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+2	NULL	25.5	25.5
+2	25.5	25.5	25.5
+2	NULL	25.5	25.5
+3	NULL	25.5	32.5
+3	30.5	25.5	32.5
+3	32.5	25.5	32.5
+4	NULL	25.5	42.3
+4	42.3	25.5	42.3
+5	50.5	25.5	50.5
+5	NULL	25.5	50.5
+6	65.2	25.5	65.5
+6	65.5	25.5	65.5
+7	NULL	25.5	65.5
+NULL	NULL	25.5	80.5
+NULL	80.5	25.5	80.5
+PREHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col IGNORE NULLS) OVER(ORDER BY id) AS first_double,
+  LAST_VALUE(double_col IGNORE NULLS) OVER(ORDER BY id) AS last_double
+FROM window_double_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col IGNORE NULLS) OVER(ORDER BY id) AS first_double,
+  LAST_VALUE(double_col IGNORE NULLS) OVER(ORDER BY id) AS last_double
+FROM window_double_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+id	double_col	first_double	last_double
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+2	NULL	25.5	25.5
+2	25.5	25.5	25.5
+2	NULL	25.5	25.5
+3	NULL	25.5	32.5
+3	30.5	25.5	32.5
+3	32.5	25.5	32.5
+4	NULL	25.5	42.3
+4	42.3	25.5	42.3
+5	50.5	25.5	50.5
+5	NULL	25.5	50.5
+6	65.2	25.5	65.5
+6	65.5	25.5	65.5
+7	NULL	25.5	65.5
+NULL	NULL	25.5	80.5
+NULL	80.5	25.5	80.5
+PREHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col IGNORE NULLS) OVER(ORDER BY id) AS first_double,
+  LAST_VALUE(double_col IGNORE NULLS) OVER(ORDER BY id) AS last_double
+FROM window_double_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col IGNORE NULLS) OVER(ORDER BY id) AS first_double,
+  LAST_VALUE(double_col IGNORE NULLS) OVER(ORDER BY id) AS last_double
+FROM window_double_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+id	double_col	first_double	last_double
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+2	NULL	25.5	25.5
+2	25.5	25.5	25.5
+2	NULL	25.5	25.5
+3	NULL	25.5	32.5
+3	30.5	25.5	32.5
+3	32.5	25.5	32.5
+4	NULL	25.5	42.3
+4	42.3	25.5	42.3
+5	50.5	25.5	50.5
+5	NULL	25.5	50.5
+6	65.2	25.5	65.5
+6	65.5	25.5	65.5
+7	NULL	25.5	65.5
+NULL	NULL	25.5	80.5
+NULL	80.5	25.5	80.5
+PREHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id) AS first_double,
+  LAST_VALUE(double_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id) AS last_double
+FROM window_double_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id) AS first_double,
+  LAST_VALUE(double_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id) AS last_double
+FROM window_double_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+id	double_col	first_double	last_double
+3	NULL	32.5	30.5
+3	32.5	32.5	30.5
+3	30.5	32.5	30.5
+5	50.5	50.5	50.5
+5	NULL	50.5	50.5
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+2	NULL	25.5	25.5
+2	25.5	25.5	25.5
+2	NULL	25.5	25.5
+4	NULL	42.3	42.3
+4	42.3	42.3	42.3
+6	65.5	65.5	65.2
+6	65.2	65.5	65.2
+7	NULL	NULL	NULL
+NULL	80.5	80.5	80.5
+NULL	NULL	80.5	80.5
+PREHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id) AS first_double,
+  LAST_VALUE(double_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id) AS last_double
+FROM window_double_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id) AS first_double,
+  LAST_VALUE(double_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id) AS last_double
+FROM window_double_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+id	double_col	first_double	last_double
+3	NULL	32.5	30.5
+3	32.5	32.5	30.5
+3	30.5	32.5	30.5
+5	50.5	50.5	50.5
+5	NULL	50.5	50.5
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+2	NULL	25.5	25.5
+2	25.5	25.5	25.5
+2	NULL	25.5	25.5
+4	NULL	42.3	42.3
+4	42.3	42.3	42.3
+6	65.5	65.5	65.2
+6	65.2	65.5	65.2
+7	NULL	NULL	NULL
+NULL	80.5	80.5	80.5
+NULL	NULL	80.5	80.5
+PREHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col) OVER(ORDER BY id) AS first_double,
+  LAST_VALUE(double_col) OVER(ORDER BY id) AS last_double
+FROM window_double_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col) OVER(ORDER BY id) AS first_double,
+  LAST_VALUE(double_col) OVER(ORDER BY id) AS last_double
+FROM window_double_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+id	double_col	first_double	last_double
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+2	NULL	NULL	NULL
+2	25.5	NULL	NULL
+2	NULL	NULL	NULL
+3	NULL	NULL	32.5
+3	30.5	NULL	32.5
+3	32.5	NULL	32.5
+4	NULL	NULL	42.3
+4	42.3	NULL	42.3
+5	50.5	NULL	NULL
+5	NULL	NULL	NULL
+6	65.2	NULL	65.5
+6	65.5	NULL	65.5
+7	NULL	NULL	NULL
+NULL	NULL	NULL	80.5
+NULL	80.5	NULL	80.5
+PREHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col) OVER(ORDER BY id) AS first_double,
+  LAST_VALUE(double_col) OVER(ORDER BY id) AS last_double
+FROM window_double_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col) OVER(ORDER BY id) AS first_double,
+  LAST_VALUE(double_col) OVER(ORDER BY id) AS last_double
+FROM window_double_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+id	double_col	first_double	last_double
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+2	NULL	NULL	NULL
+2	25.5	NULL	NULL
+2	NULL	NULL	NULL
+3	NULL	NULL	32.5
+3	30.5	NULL	32.5
+3	32.5	NULL	32.5
+4	NULL	NULL	42.3
+4	42.3	NULL	42.3
+5	50.5	NULL	NULL
+5	NULL	NULL	NULL
+6	65.2	NULL	65.5
+6	65.5	NULL	65.5
+7	NULL	NULL	NULL
+NULL	NULL	NULL	80.5
+NULL	80.5	NULL	80.5
+PREHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col) OVER(PARTITION BY id ORDER BY id) AS first_double,
+  LAST_VALUE(double_col) OVER(PARTITION BY id ORDER BY id) AS last_double
+FROM window_double_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col) OVER(PARTITION BY id ORDER BY id) AS first_double,
+  LAST_VALUE(double_col) OVER(PARTITION BY id ORDER BY id) AS last_double
+FROM window_double_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+id	double_col	first_double	last_double
+3	NULL	NULL	30.5
+3	32.5	NULL	30.5
+3	30.5	NULL	30.5
+5	50.5	50.5	NULL
+5	NULL	50.5	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+2	NULL	NULL	NULL
+2	25.5	NULL	NULL
+2	NULL	NULL	NULL
+4	NULL	NULL	42.3
+4	42.3	NULL	42.3
+6	65.5	65.5	65.2
+6	65.2	65.5	65.2
+7	NULL	NULL	NULL
+NULL	80.5	80.5	NULL
+NULL	NULL	80.5	NULL
+PREHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col) OVER(PARTITION BY id ORDER BY id) AS first_double,
+  LAST_VALUE(double_col) OVER(PARTITION BY id ORDER BY id) AS last_double
+FROM window_double_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col) OVER(PARTITION BY id ORDER BY id) AS first_double,
+  LAST_VALUE(double_col) OVER(PARTITION BY id ORDER BY id) AS last_double
+FROM window_double_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+id	double_col	first_double	last_double
+3	NULL	NULL	30.5
+3	32.5	NULL	30.5
+3	30.5	NULL	30.5
+5	50.5	50.5	NULL
+5	NULL	50.5	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+2	NULL	NULL	NULL
+2	25.5	NULL	NULL
+2	NULL	NULL	NULL
+4	NULL	NULL	42.3
+4	42.3	NULL	42.3
+6	65.5	65.5	65.2
+6	65.2	65.5	65.2
+7	NULL	NULL	NULL
+NULL	80.5	80.5	NULL
+NULL	NULL	80.5	NULL
+PREHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col) IGNORE NULLS OVER(ORDER BY id ASC NULLS FIRST) AS first_double,
+  LAST_VALUE(double_col) IGNORE NULLS OVER(ORDER BY id ASC NULLS FIRST) AS last_double
+FROM window_double_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col) IGNORE NULLS OVER(ORDER BY id ASC NULLS FIRST) AS first_double,
+  LAST_VALUE(double_col) IGNORE NULLS OVER(ORDER BY id ASC NULLS FIRST) AS last_double
+FROM window_double_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+id	double_col	first_double	last_double
+NULL	NULL	80.5	80.5
+NULL	80.5	80.5	80.5
+1	NULL	80.5	80.5
+1	NULL	80.5	80.5
+1	NULL	80.5	80.5
+2	NULL	80.5	25.5
+2	NULL	80.5	25.5
+2	25.5	80.5	25.5
+3	NULL	80.5	30.5
+3	32.5	80.5	30.5
+3	30.5	80.5	30.5
+4	NULL	80.5	42.3
+4	42.3	80.5	42.3
+5	NULL	80.5	50.5
+5	50.5	80.5	50.5
+6	65.2	80.5	65.5
+6	65.5	80.5	65.5
+7	NULL	80.5	65.5
+PREHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col) IGNORE NULLS OVER(ORDER BY id ASC NULLS FIRST) AS first_double,
+  LAST_VALUE(double_col) IGNORE NULLS OVER(ORDER BY id ASC NULLS FIRST) AS last_double
+FROM window_double_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col) IGNORE NULLS OVER(ORDER BY id ASC NULLS FIRST) AS first_double,
+  LAST_VALUE(double_col) IGNORE NULLS OVER(ORDER BY id ASC NULLS FIRST) AS last_double
+FROM window_double_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+id	double_col	first_double	last_double
+NULL	NULL	80.5	80.5
+NULL	80.5	80.5	80.5
+1	NULL	80.5	80.5
+1	NULL	80.5	80.5
+1	NULL	80.5	80.5
+2	NULL	80.5	25.5
+2	NULL	80.5	25.5
+2	25.5	80.5	25.5
+3	NULL	80.5	30.5
+3	32.5	80.5	30.5
+3	30.5	80.5	30.5
+4	NULL	80.5	42.3
+4	42.3	80.5	42.3
+5	NULL	80.5	50.5
+5	50.5	80.5	50.5
+6	65.2	80.5	65.5
+6	65.5	80.5	65.5
+7	NULL	80.5	65.5
+PREHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col IGNORE NULLS) OVER(ORDER BY id ASC NULLS FIRST) AS first_double,
+  LAST_VALUE(double_col IGNORE NULLS) OVER(ORDER BY id ASC NULLS FIRST) AS last_double
+FROM window_double_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col IGNORE NULLS) OVER(ORDER BY id ASC NULLS FIRST) AS first_double,
+  LAST_VALUE(double_col IGNORE NULLS) OVER(ORDER BY id ASC NULLS FIRST) AS last_double
+FROM window_double_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+id	double_col	first_double	last_double
+NULL	NULL	80.5	80.5
+NULL	80.5	80.5	80.5
+1	NULL	80.5	80.5
+1	NULL	80.5	80.5
+1	NULL	80.5	80.5
+2	NULL	80.5	25.5
+2	NULL	80.5	25.5
+2	25.5	80.5	25.5
+3	NULL	80.5	30.5
+3	32.5	80.5	30.5
+3	30.5	80.5	30.5
+4	NULL	80.5	42.3
+4	42.3	80.5	42.3
+5	NULL	80.5	50.5
+5	50.5	80.5	50.5
+6	65.2	80.5	65.5
+6	65.5	80.5	65.5
+7	NULL	80.5	65.5
+PREHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col IGNORE NULLS) OVER(ORDER BY id ASC NULLS FIRST) AS first_double,
+  LAST_VALUE(double_col IGNORE NULLS) OVER(ORDER BY id ASC NULLS FIRST) AS last_double
+FROM window_double_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col IGNORE NULLS) OVER(ORDER BY id ASC NULLS FIRST) AS first_double,
+  LAST_VALUE(double_col IGNORE NULLS) OVER(ORDER BY id ASC NULLS FIRST) AS last_double
+FROM window_double_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+id	double_col	first_double	last_double
+NULL	NULL	80.5	80.5
+NULL	80.5	80.5	80.5
+1	NULL	80.5	80.5
+1	NULL	80.5	80.5
+1	NULL	80.5	80.5
+2	NULL	80.5	25.5
+2	NULL	80.5	25.5
+2	25.5	80.5	25.5
+3	NULL	80.5	30.5
+3	32.5	80.5	30.5
+3	30.5	80.5	30.5
+4	NULL	80.5	42.3
+4	42.3	80.5	42.3
+5	NULL	80.5	50.5
+5	50.5	80.5	50.5
+6	65.2	80.5	65.5
+6	65.5	80.5	65.5
+7	NULL	80.5	65.5
+PREHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS first_double,
+  LAST_VALUE(double_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS last_double
+FROM window_double_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS first_double,
+  LAST_VALUE(double_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS last_double
+FROM window_double_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+id	double_col	first_double	last_double
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+NULL	NULL	80.5	80.5
+NULL	80.5	80.5	80.5
+2	25.5	25.5	25.5
+2	NULL	25.5	25.5
+2	NULL	25.5	25.5
+3	NULL	32.5	30.5
+3	32.5	32.5	30.5
+3	30.5	32.5	30.5
+4	42.3	42.3	42.3
+4	NULL	42.3	42.3
+5	NULL	50.5	50.5
+5	50.5	50.5	50.5
+6	65.5	65.5	65.2
+6	65.2	65.5	65.2
+7	NULL	NULL	NULL
+PREHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS first_double,
+  LAST_VALUE(double_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS last_double
+FROM window_double_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS first_double,
+  LAST_VALUE(double_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS last_double
+FROM window_double_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+id	double_col	first_double	last_double
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+NULL	NULL	80.5	80.5
+NULL	80.5	80.5	80.5
+2	25.5	25.5	25.5
+2	NULL	25.5	25.5
+2	NULL	25.5	25.5
+3	NULL	32.5	30.5
+3	32.5	32.5	30.5
+3	30.5	32.5	30.5
+4	42.3	42.3	42.3
+4	NULL	42.3	42.3
+5	NULL	50.5	50.5
+5	50.5	50.5	50.5
+6	65.5	65.5	65.2
+6	65.2	65.5	65.2
+7	NULL	NULL	NULL
+PREHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col) OVER(ORDER BY id ASC NULLS FIRST) AS first_double,
+  LAST_VALUE(double_col) OVER(ORDER BY id ASC NULLS FIRST) AS last_double
+FROM window_double_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col) OVER(ORDER BY id ASC NULLS FIRST) AS first_double,
+  LAST_VALUE(double_col) OVER(ORDER BY id ASC NULLS FIRST) AS last_double
+FROM window_double_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+id	double_col	first_double	last_double
+NULL	NULL	NULL	80.5
+NULL	80.5	NULL	80.5
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+2	NULL	NULL	25.5
+2	NULL	NULL	25.5
+2	25.5	NULL	25.5
+3	NULL	NULL	30.5
+3	32.5	NULL	30.5
+3	30.5	NULL	30.5
+4	NULL	NULL	42.3
+4	42.3	NULL	42.3
+5	NULL	NULL	50.5
+5	50.5	NULL	50.5
+6	65.2	NULL	65.5
+6	65.5	NULL	65.5
+7	NULL	NULL	NULL
+PREHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col) OVER(ORDER BY id ASC NULLS FIRST) AS first_double,
+  LAST_VALUE(double_col) OVER(ORDER BY id ASC NULLS FIRST) AS last_double
+FROM window_double_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col) OVER(ORDER BY id ASC NULLS FIRST) AS first_double,
+  LAST_VALUE(double_col) OVER(ORDER BY id ASC NULLS FIRST) AS last_double
+FROM window_double_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+id	double_col	first_double	last_double
+NULL	NULL	NULL	80.5
+NULL	80.5	NULL	80.5
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+2	NULL	NULL	25.5
+2	NULL	NULL	25.5
+2	25.5	NULL	25.5
+3	NULL	NULL	30.5
+3	32.5	NULL	30.5
+3	30.5	NULL	30.5
+4	NULL	NULL	42.3
+4	42.3	NULL	42.3
+5	NULL	NULL	50.5
+5	50.5	NULL	50.5
+6	65.2	NULL	65.5
+6	65.5	NULL	65.5
+7	NULL	NULL	NULL
+PREHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS first_double,
+  LAST_VALUE(double_col) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS last_double
+FROM window_double_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS first_double,
+  LAST_VALUE(double_col) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS last_double
+FROM window_double_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+id	double_col	first_double	last_double
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+NULL	NULL	NULL	80.5
+NULL	80.5	NULL	80.5
+2	25.5	25.5	NULL
+2	NULL	25.5	NULL
+2	NULL	25.5	NULL
+3	NULL	NULL	30.5
+3	32.5	NULL	30.5
+3	30.5	NULL	30.5
+4	42.3	42.3	NULL
+4	NULL	42.3	NULL
+5	NULL	NULL	50.5
+5	50.5	NULL	50.5
+6	65.5	65.5	65.2
+6	65.2	65.5	65.2
+7	NULL	NULL	NULL
+PREHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS first_double,
+  LAST_VALUE(double_col) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS last_double
+FROM window_double_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS first_double,
+  LAST_VALUE(double_col) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS last_double
+FROM window_double_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+id	double_col	first_double	last_double
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+NULL	NULL	NULL	80.5
+NULL	80.5	NULL	80.5
+2	25.5	25.5	NULL
+2	NULL	25.5	NULL
+2	NULL	25.5	NULL
+3	NULL	NULL	30.5
+3	32.5	NULL	30.5
+3	30.5	NULL	30.5
+4	42.3	42.3	NULL
+4	NULL	42.3	NULL
+5	NULL	NULL	50.5
+5	50.5	NULL	50.5
+6	65.5	65.5	65.2
+6	65.2	65.5	65.2
+7	NULL	NULL	NULL
+PREHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col) IGNORE NULLS OVER(ORDER BY id) AS first_double,
+  LAST_VALUE(double_col) IGNORE NULLS OVER(ORDER BY id) AS last_double
+FROM window_double_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col) IGNORE NULLS OVER(ORDER BY id) AS first_double,
+  LAST_VALUE(double_col) IGNORE NULLS OVER(ORDER BY id) AS last_double
+FROM window_double_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+id	double_col	first_double	last_double
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+2	NULL	25.5	25.5
+2	25.5	25.5	25.5
+2	NULL	25.5	25.5
+3	NULL	25.5	32.5
+3	30.5	25.5	32.5
+3	32.5	25.5	32.5
+4	NULL	25.5	42.3
+4	42.3	25.5	42.3
+5	50.5	25.5	50.5
+5	NULL	25.5	50.5
+6	65.2	25.5	65.5
+6	65.5	25.5	65.5
+7	NULL	25.5	65.5
+NULL	NULL	25.5	80.5
+NULL	80.5	25.5	80.5
+PREHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col) IGNORE NULLS OVER(ORDER BY id ASC NULLS FIRST) AS first_double,
+  LAST_VALUE(double_col) IGNORE NULLS OVER(ORDER BY id ASC NULLS FIRST) AS last_double
+FROM window_double_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col) IGNORE NULLS OVER(ORDER BY id ASC NULLS FIRST) AS first_double,
+  LAST_VALUE(double_col) IGNORE NULLS OVER(ORDER BY id ASC NULLS FIRST) AS last_double
+FROM window_double_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+id	double_col	first_double	last_double
+NULL	NULL	80.5	80.5
+NULL	80.5	80.5	80.5
+1	NULL	80.5	80.5
+1	NULL	80.5	80.5
+1	NULL	80.5	80.5
+2	NULL	80.5	25.5
+2	NULL	80.5	25.5
+2	25.5	80.5	25.5
+3	NULL	80.5	30.5
+3	32.5	80.5	30.5
+3	30.5	80.5	30.5
+4	NULL	80.5	42.3
+4	42.3	80.5	42.3
+5	NULL	80.5	50.5
+5	50.5	80.5	50.5
+6	65.2	80.5	65.5
+6	65.5	80.5	65.5
+7	NULL	80.5	65.5
+PREHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col IGNORE NULLS) OVER(ORDER BY id) AS first_double,
+  LAST_VALUE(double_col IGNORE NULLS) OVER(ORDER BY id) AS last_double
+FROM window_double_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col IGNORE NULLS) OVER(ORDER BY id) AS first_double,
+  LAST_VALUE(double_col IGNORE NULLS) OVER(ORDER BY id) AS last_double
+FROM window_double_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+id	double_col	first_double	last_double
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+2	NULL	25.5	25.5
+2	25.5	25.5	25.5
+2	NULL	25.5	25.5
+3	NULL	25.5	32.5
+3	30.5	25.5	32.5
+3	32.5	25.5	32.5
+4	NULL	25.5	42.3
+4	42.3	25.5	42.3
+5	50.5	25.5	50.5
+5	NULL	25.5	50.5
+6	65.2	25.5	65.5
+6	65.5	25.5	65.5
+7	NULL	25.5	65.5
+NULL	NULL	25.5	80.5
+NULL	80.5	25.5	80.5
+PREHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col IGNORE NULLS) OVER(ORDER BY id ASC NULLS FIRST) AS first_double,
+  LAST_VALUE(double_col IGNORE NULLS) OVER(ORDER BY id ASC NULLS FIRST) AS last_double
+FROM window_double_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col IGNORE NULLS) OVER(ORDER BY id ASC NULLS FIRST) AS first_double,
+  LAST_VALUE(double_col IGNORE NULLS) OVER(ORDER BY id ASC NULLS FIRST) AS last_double
+FROM window_double_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+id	double_col	first_double	last_double
+NULL	NULL	80.5	80.5
+NULL	80.5	80.5	80.5
+1	NULL	80.5	80.5
+1	NULL	80.5	80.5
+1	NULL	80.5	80.5
+2	NULL	80.5	25.5
+2	NULL	80.5	25.5
+2	25.5	80.5	25.5
+3	NULL	80.5	30.5
+3	32.5	80.5	30.5
+3	30.5	80.5	30.5
+4	NULL	80.5	42.3
+4	42.3	80.5	42.3
+5	NULL	80.5	50.5
+5	50.5	80.5	50.5
+6	65.2	80.5	65.5
+6	65.5	80.5	65.5
+7	NULL	80.5	65.5
+PREHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id) AS first_double,
+  LAST_VALUE(double_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id) AS last_double
+FROM window_double_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id) AS first_double,
+  LAST_VALUE(double_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id) AS last_double
+FROM window_double_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+id	double_col	first_double	last_double
+3	NULL	32.5	30.5
+3	32.5	32.5	30.5
+3	30.5	32.5	30.5
+5	50.5	50.5	50.5
+5	NULL	50.5	50.5
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+2	NULL	25.5	25.5
+2	25.5	25.5	25.5
+2	NULL	25.5	25.5
+4	NULL	42.3	42.3
+4	42.3	42.3	42.3
+6	65.5	65.5	65.2
+6	65.2	65.5	65.2
+7	NULL	NULL	NULL
+NULL	80.5	80.5	80.5
+NULL	NULL	80.5	80.5
+PREHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS first_double,
+  LAST_VALUE(double_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS last_double
+FROM window_double_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS first_double,
+  LAST_VALUE(double_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS last_double
+FROM window_double_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+id	double_col	first_double	last_double
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+NULL	NULL	80.5	80.5
+NULL	80.5	80.5	80.5
+2	25.5	25.5	25.5
+2	NULL	25.5	25.5
+2	NULL	25.5	25.5
+3	NULL	32.5	30.5
+3	32.5	32.5	30.5
+3	30.5	32.5	30.5
+4	42.3	42.3	42.3
+4	NULL	42.3	42.3
+5	NULL	50.5	50.5
+5	50.5	50.5	50.5
+6	65.5	65.5	65.2
+6	65.2	65.5	65.2
+7	NULL	NULL	NULL
+PREHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col) OVER(ORDER BY id) AS first_double,
+  LAST_VALUE(double_col) OVER(ORDER BY id) AS last_double
+FROM window_double_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col) OVER(ORDER BY id) AS first_double,
+  LAST_VALUE(double_col) OVER(ORDER BY id) AS last_double
+FROM window_double_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+id	double_col	first_double	last_double
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+2	NULL	NULL	NULL
+2	25.5	NULL	NULL
+2	NULL	NULL	NULL
+3	NULL	NULL	32.5
+3	30.5	NULL	32.5
+3	32.5	NULL	32.5
+4	NULL	NULL	42.3
+4	42.3	NULL	42.3
+5	50.5	NULL	NULL
+5	NULL	NULL	NULL
+6	65.2	NULL	65.5
+6	65.5	NULL	65.5
+7	NULL	NULL	NULL
+NULL	NULL	NULL	80.5
+NULL	80.5	NULL	80.5
+PREHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col) OVER(ORDER BY id ASC NULLS FIRST) AS first_double,
+  LAST_VALUE(double_col) OVER(ORDER BY id ASC NULLS FIRST) AS last_double
+FROM window_double_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col) OVER(ORDER BY id ASC NULLS FIRST) AS first_double,
+  LAST_VALUE(double_col) OVER(ORDER BY id ASC NULLS FIRST) AS last_double
+FROM window_double_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+id	double_col	first_double	last_double
+NULL	NULL	NULL	80.5
+NULL	80.5	NULL	80.5
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+2	NULL	NULL	25.5
+2	NULL	NULL	25.5
+2	25.5	NULL	25.5
+3	NULL	NULL	30.5
+3	32.5	NULL	30.5
+3	30.5	NULL	30.5
+4	NULL	NULL	42.3
+4	42.3	NULL	42.3
+5	NULL	NULL	50.5
+5	50.5	NULL	50.5
+6	65.2	NULL	65.5
+6	65.5	NULL	65.5
+7	NULL	NULL	NULL
+PREHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col) OVER(PARTITION BY id ORDER BY id) AS first_double,
+  LAST_VALUE(double_col) OVER(PARTITION BY id ORDER BY id) AS last_double
+FROM window_double_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col) OVER(PARTITION BY id ORDER BY id) AS first_double,
+  LAST_VALUE(double_col) OVER(PARTITION BY id ORDER BY id) AS last_double
+FROM window_double_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+id	double_col	first_double	last_double
+3	NULL	NULL	30.5
+3	32.5	NULL	30.5
+3	30.5	NULL	30.5
+5	50.5	50.5	NULL
+5	NULL	50.5	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+2	NULL	NULL	NULL
+2	25.5	NULL	NULL
+2	NULL	NULL	NULL
+4	NULL	NULL	42.3
+4	42.3	NULL	42.3
+6	65.5	65.5	65.2
+6	65.2	65.5	65.2
+7	NULL	NULL	NULL
+NULL	80.5	80.5	NULL
+NULL	NULL	80.5	NULL
+PREHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS first_double,
+  LAST_VALUE(double_col) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS last_double
+FROM window_double_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, double_col,
+  FIRST_VALUE(double_col) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS first_double,
+  LAST_VALUE(double_col) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS last_double
+FROM window_double_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_double_test
+#### A masked pattern was here ####
+id	double_col	first_double	last_double
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+NULL	NULL	NULL	80.5
+NULL	80.5	NULL	80.5
+2	25.5	25.5	NULL
+2	NULL	25.5	NULL
+2	NULL	25.5	NULL
+3	NULL	NULL	30.5
+3	32.5	NULL	30.5
+3	30.5	NULL	30.5
+4	42.3	42.3	NULL
+4	NULL	42.3	NULL
+5	NULL	NULL	50.5
+5	50.5	NULL	50.5
+6	65.5	65.5	65.2
+6	65.2	65.5	65.2
+7	NULL	NULL	NULL
diff --git a/ql/src/test/results/clientpositive/llap/vectorized_first_last_value_ignore_nulls_int.q.out b/ql/src/test/results/clientpositive/llap/vectorized_first_last_value_ignore_nulls_int.q.out
new file mode 100644
index 0000000000..a89884eaa6
--- /dev/null
+++ b/ql/src/test/results/clientpositive/llap/vectorized_first_last_value_ignore_nulls_int.q.out
@@ -0,0 +1,1051 @@
+PREHOOK: query: CREATE TABLE window_int_test (
+  id INT,
+  int_col INT
+)
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@window_int_test
+POSTHOOK: query: CREATE TABLE window_int_test (
+  id INT,
+  int_col INT
+)
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@window_int_test
+PREHOOK: query: INSERT INTO window_int_test VALUES
+  (1, NULL),
+  (2, NULL),
+  (1, NULL),
+  (1, NULL),
+  (2, 20),
+  (3, NULL),
+  (6, 62),
+  (2, NULL),
+  (3, 30),
+  (4, NULL),
+  (3, 32),
+  (5, 50),
+  (4, 40),
+  (5, NULL),
+  (6, 60),
+  (7, NULL),
+  (NULL, 80),
+  (NULL, NULL)
+PREHOOK: type: QUERY
+PREHOOK: Input: _dummy_database@_dummy_table
+PREHOOK: Output: default@window_int_test
+POSTHOOK: query: INSERT INTO window_int_test VALUES
+  (1, NULL),
+  (2, NULL),
+  (1, NULL),
+  (1, NULL),
+  (2, 20),
+  (3, NULL),
+  (6, 62),
+  (2, NULL),
+  (3, 30),
+  (4, NULL),
+  (3, 32),
+  (5, 50),
+  (4, 40),
+  (5, NULL),
+  (6, 60),
+  (7, NULL),
+  (NULL, 80),
+  (NULL, NULL)
+POSTHOOK: type: QUERY
+POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@window_int_test
+POSTHOOK: Lineage: window_int_test.id SCRIPT []
+POSTHOOK: Lineage: window_int_test.int_col SCRIPT []
+col1	col2
+PREHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col) IGNORE NULLS OVER(ORDER BY id) AS first_int,
+  LAST_VALUE(int_col) IGNORE NULLS OVER(ORDER BY id) AS last_int
+FROM window_int_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col) IGNORE NULLS OVER(ORDER BY id) AS first_int,
+  LAST_VALUE(int_col) IGNORE NULLS OVER(ORDER BY id) AS last_int
+FROM window_int_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+id	int_col	first_int	last_int
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+2	NULL	20	20
+2	20	20	20
+2	NULL	20	20
+3	NULL	20	30
+3	32	20	30
+3	30	20	30
+4	NULL	20	40
+4	40	20	40
+5	50	20	50
+5	NULL	20	50
+6	60	20	62
+6	62	20	62
+7	NULL	20	62
+NULL	NULL	20	80
+NULL	80	20	80
+PREHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col) IGNORE NULLS OVER(ORDER BY id) AS first_int,
+  LAST_VALUE(int_col) IGNORE NULLS OVER(ORDER BY id) AS last_int
+FROM window_int_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col) IGNORE NULLS OVER(ORDER BY id) AS first_int,
+  LAST_VALUE(int_col) IGNORE NULLS OVER(ORDER BY id) AS last_int
+FROM window_int_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+id	int_col	first_int	last_int
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+2	NULL	20	20
+2	20	20	20
+2	NULL	20	20
+3	NULL	20	30
+3	32	20	30
+3	30	20	30
+4	NULL	20	40
+4	40	20	40
+5	50	20	50
+5	NULL	20	50
+6	60	20	62
+6	62	20	62
+7	NULL	20	62
+NULL	NULL	20	80
+NULL	80	20	80
+PREHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col IGNORE NULLS) OVER(ORDER BY id) AS first_int,
+  LAST_VALUE(int_col IGNORE NULLS) OVER(ORDER BY id) AS last_int
+FROM window_int_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col IGNORE NULLS) OVER(ORDER BY id) AS first_int,
+  LAST_VALUE(int_col IGNORE NULLS) OVER(ORDER BY id) AS last_int
+FROM window_int_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+id	int_col	first_int	last_int
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+2	NULL	20	20
+2	20	20	20
+2	NULL	20	20
+3	NULL	20	30
+3	32	20	30
+3	30	20	30
+4	NULL	20	40
+4	40	20	40
+5	50	20	50
+5	NULL	20	50
+6	60	20	62
+6	62	20	62
+7	NULL	20	62
+NULL	NULL	20	80
+NULL	80	20	80
+PREHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col IGNORE NULLS) OVER(ORDER BY id) AS first_int,
+  LAST_VALUE(int_col IGNORE NULLS) OVER(ORDER BY id) AS last_int
+FROM window_int_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col IGNORE NULLS) OVER(ORDER BY id) AS first_int,
+  LAST_VALUE(int_col IGNORE NULLS) OVER(ORDER BY id) AS last_int
+FROM window_int_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+id	int_col	first_int	last_int
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+2	NULL	20	20
+2	20	20	20
+2	NULL	20	20
+3	NULL	20	30
+3	32	20	30
+3	30	20	30
+4	NULL	20	40
+4	40	20	40
+5	50	20	50
+5	NULL	20	50
+6	60	20	62
+6	62	20	62
+7	NULL	20	62
+NULL	NULL	20	80
+NULL	80	20	80
+PREHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id) AS first_int,
+  LAST_VALUE(int_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id) AS last_int
+FROM window_int_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id) AS first_int,
+  LAST_VALUE(int_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id) AS last_int
+FROM window_int_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+id	int_col	first_int	last_int
+3	NULL	30	32
+3	30	30	32
+3	32	30	32
+5	50	50	50
+5	NULL	50	50
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+2	NULL	20	20
+2	20	20	20
+2	NULL	20	20
+4	NULL	40	40
+4	40	40	40
+6	62	62	60
+6	60	62	60
+7	NULL	NULL	NULL
+NULL	80	80	80
+NULL	NULL	80	80
+PREHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id) AS first_int,
+  LAST_VALUE(int_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id) AS last_int
+FROM window_int_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id) AS first_int,
+  LAST_VALUE(int_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id) AS last_int
+FROM window_int_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+id	int_col	first_int	last_int
+3	NULL	30	32
+3	30	30	32
+3	32	30	32
+5	50	50	50
+5	NULL	50	50
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+2	NULL	20	20
+2	20	20	20
+2	NULL	20	20
+4	NULL	40	40
+4	40	40	40
+6	62	62	60
+6	60	62	60
+7	NULL	NULL	NULL
+NULL	80	80	80
+NULL	NULL	80	80
+PREHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col) OVER(ORDER BY id) AS first_int,
+  LAST_VALUE(int_col) OVER(ORDER BY id) AS last_int
+FROM window_int_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col) OVER(ORDER BY id) AS first_int,
+  LAST_VALUE(int_col) OVER(ORDER BY id) AS last_int
+FROM window_int_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+id	int_col	first_int	last_int
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+2	NULL	NULL	NULL
+2	20	NULL	NULL
+2	NULL	NULL	NULL
+3	NULL	NULL	30
+3	32	NULL	30
+3	30	NULL	30
+4	NULL	NULL	40
+4	40	NULL	40
+5	50	NULL	NULL
+5	NULL	NULL	NULL
+6	60	NULL	62
+6	62	NULL	62
+7	NULL	NULL	NULL
+NULL	NULL	NULL	80
+NULL	80	NULL	80
+PREHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col) OVER(ORDER BY id) AS first_int,
+  LAST_VALUE(int_col) OVER(ORDER BY id) AS last_int
+FROM window_int_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col) OVER(ORDER BY id) AS first_int,
+  LAST_VALUE(int_col) OVER(ORDER BY id) AS last_int
+FROM window_int_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+id	int_col	first_int	last_int
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+2	NULL	NULL	NULL
+2	20	NULL	NULL
+2	NULL	NULL	NULL
+3	NULL	NULL	30
+3	32	NULL	30
+3	30	NULL	30
+4	NULL	NULL	40
+4	40	NULL	40
+5	50	NULL	NULL
+5	NULL	NULL	NULL
+6	60	NULL	62
+6	62	NULL	62
+7	NULL	NULL	NULL
+NULL	NULL	NULL	80
+NULL	80	NULL	80
+PREHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col) OVER(PARTITION BY id ORDER BY id) AS first_int,
+  LAST_VALUE(int_col) OVER(PARTITION BY id ORDER BY id) AS last_int
+FROM window_int_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col) OVER(PARTITION BY id ORDER BY id) AS first_int,
+  LAST_VALUE(int_col) OVER(PARTITION BY id ORDER BY id) AS last_int
+FROM window_int_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+id	int_col	first_int	last_int
+3	NULL	NULL	32
+3	30	NULL	32
+3	32	NULL	32
+5	50	50	NULL
+5	NULL	50	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+2	NULL	NULL	NULL
+2	20	NULL	NULL
+2	NULL	NULL	NULL
+4	NULL	NULL	40
+4	40	NULL	40
+6	62	62	60
+6	60	62	60
+7	NULL	NULL	NULL
+NULL	80	80	NULL
+NULL	NULL	80	NULL
+PREHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col) OVER(PARTITION BY id ORDER BY id) AS first_int,
+  LAST_VALUE(int_col) OVER(PARTITION BY id ORDER BY id) AS last_int
+FROM window_int_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col) OVER(PARTITION BY id ORDER BY id) AS first_int,
+  LAST_VALUE(int_col) OVER(PARTITION BY id ORDER BY id) AS last_int
+FROM window_int_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+id	int_col	first_int	last_int
+3	NULL	NULL	32
+3	30	NULL	32
+3	32	NULL	32
+5	50	50	NULL
+5	NULL	50	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+2	NULL	NULL	NULL
+2	20	NULL	NULL
+2	NULL	NULL	NULL
+4	NULL	NULL	40
+4	40	NULL	40
+6	62	62	60
+6	60	62	60
+7	NULL	NULL	NULL
+NULL	80	80	NULL
+NULL	NULL	80	NULL
+PREHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col) IGNORE NULLS OVER(ORDER BY id ASC NULLS FIRST) AS first_int,
+  LAST_VALUE(int_col) IGNORE NULLS OVER(ORDER BY id ASC NULLS FIRST) AS last_int
+FROM window_int_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col) IGNORE NULLS OVER(ORDER BY id ASC NULLS FIRST) AS first_int,
+  LAST_VALUE(int_col) IGNORE NULLS OVER(ORDER BY id ASC NULLS FIRST) AS last_int
+FROM window_int_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+id	int_col	first_int	last_int
+NULL	NULL	80	80
+NULL	80	80	80
+1	NULL	80	80
+1	NULL	80	80
+1	NULL	80	80
+2	NULL	80	20
+2	NULL	80	20
+2	20	80	20
+3	NULL	80	32
+3	30	80	32
+3	32	80	32
+4	NULL	80	40
+4	40	80	40
+5	NULL	80	50
+5	50	80	50
+6	60	80	62
+6	62	80	62
+7	NULL	80	62
+PREHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col) IGNORE NULLS OVER(ORDER BY id ASC NULLS FIRST) AS first_int,
+  LAST_VALUE(int_col) IGNORE NULLS OVER(ORDER BY id ASC NULLS FIRST) AS last_int
+FROM window_int_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col) IGNORE NULLS OVER(ORDER BY id ASC NULLS FIRST) AS first_int,
+  LAST_VALUE(int_col) IGNORE NULLS OVER(ORDER BY id ASC NULLS FIRST) AS last_int
+FROM window_int_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+id	int_col	first_int	last_int
+NULL	NULL	80	80
+NULL	80	80	80
+1	NULL	80	80
+1	NULL	80	80
+1	NULL	80	80
+2	NULL	80	20
+2	NULL	80	20
+2	20	80	20
+3	NULL	80	32
+3	30	80	32
+3	32	80	32
+4	NULL	80	40
+4	40	80	40
+5	NULL	80	50
+5	50	80	50
+6	60	80	62
+6	62	80	62
+7	NULL	80	62
+PREHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col IGNORE NULLS) OVER(ORDER BY id ASC NULLS FIRST) AS first_int,
+  LAST_VALUE(int_col IGNORE NULLS) OVER(ORDER BY id ASC NULLS FIRST) AS last_int
+FROM window_int_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col IGNORE NULLS) OVER(ORDER BY id ASC NULLS FIRST) AS first_int,
+  LAST_VALUE(int_col IGNORE NULLS) OVER(ORDER BY id ASC NULLS FIRST) AS last_int
+FROM window_int_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+id	int_col	first_int	last_int
+NULL	NULL	80	80
+NULL	80	80	80
+1	NULL	80	80
+1	NULL	80	80
+1	NULL	80	80
+2	NULL	80	20
+2	NULL	80	20
+2	20	80	20
+3	NULL	80	32
+3	30	80	32
+3	32	80	32
+4	NULL	80	40
+4	40	80	40
+5	NULL	80	50
+5	50	80	50
+6	60	80	62
+6	62	80	62
+7	NULL	80	62
+PREHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col IGNORE NULLS) OVER(ORDER BY id ASC NULLS FIRST) AS first_int,
+  LAST_VALUE(int_col IGNORE NULLS) OVER(ORDER BY id ASC NULLS FIRST) AS last_int
+FROM window_int_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col IGNORE NULLS) OVER(ORDER BY id ASC NULLS FIRST) AS first_int,
+  LAST_VALUE(int_col IGNORE NULLS) OVER(ORDER BY id ASC NULLS FIRST) AS last_int
+FROM window_int_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+id	int_col	first_int	last_int
+NULL	NULL	80	80
+NULL	80	80	80
+1	NULL	80	80
+1	NULL	80	80
+1	NULL	80	80
+2	NULL	80	20
+2	NULL	80	20
+2	20	80	20
+3	NULL	80	32
+3	30	80	32
+3	32	80	32
+4	NULL	80	40
+4	40	80	40
+5	NULL	80	50
+5	50	80	50
+6	60	80	62
+6	62	80	62
+7	NULL	80	62
+PREHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS first_int,
+  LAST_VALUE(int_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS last_int
+FROM window_int_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS first_int,
+  LAST_VALUE(int_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS last_int
+FROM window_int_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+id	int_col	first_int	last_int
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+NULL	NULL	80	80
+NULL	80	80	80
+2	20	20	20
+2	NULL	20	20
+2	NULL	20	20
+3	NULL	30	32
+3	30	30	32
+3	32	30	32
+4	40	40	40
+4	NULL	40	40
+5	NULL	50	50
+5	50	50	50
+6	62	62	60
+6	60	62	60
+7	NULL	NULL	NULL
+PREHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS first_int,
+  LAST_VALUE(int_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS last_int
+FROM window_int_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS first_int,
+  LAST_VALUE(int_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS last_int
+FROM window_int_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+id	int_col	first_int	last_int
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+NULL	NULL	80	80
+NULL	80	80	80
+2	20	20	20
+2	NULL	20	20
+2	NULL	20	20
+3	NULL	30	32
+3	30	30	32
+3	32	30	32
+4	40	40	40
+4	NULL	40	40
+5	NULL	50	50
+5	50	50	50
+6	62	62	60
+6	60	62	60
+7	NULL	NULL	NULL
+PREHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col) OVER(ORDER BY id ASC NULLS FIRST) AS first_int,
+  LAST_VALUE(int_col) OVER(ORDER BY id ASC NULLS FIRST) AS last_int
+FROM window_int_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col) OVER(ORDER BY id ASC NULLS FIRST) AS first_int,
+  LAST_VALUE(int_col) OVER(ORDER BY id ASC NULLS FIRST) AS last_int
+FROM window_int_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+id	int_col	first_int	last_int
+NULL	NULL	NULL	80
+NULL	80	NULL	80
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+2	NULL	NULL	20
+2	NULL	NULL	20
+2	20	NULL	20
+3	NULL	NULL	32
+3	30	NULL	32
+3	32	NULL	32
+4	NULL	NULL	40
+4	40	NULL	40
+5	NULL	NULL	50
+5	50	NULL	50
+6	60	NULL	62
+6	62	NULL	62
+7	NULL	NULL	NULL
+PREHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col) OVER(ORDER BY id ASC NULLS FIRST) AS first_int,
+  LAST_VALUE(int_col) OVER(ORDER BY id ASC NULLS FIRST) AS last_int
+FROM window_int_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col) OVER(ORDER BY id ASC NULLS FIRST) AS first_int,
+  LAST_VALUE(int_col) OVER(ORDER BY id ASC NULLS FIRST) AS last_int
+FROM window_int_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+id	int_col	first_int	last_int
+NULL	NULL	NULL	80
+NULL	80	NULL	80
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+2	NULL	NULL	20
+2	NULL	NULL	20
+2	20	NULL	20
+3	NULL	NULL	32
+3	30	NULL	32
+3	32	NULL	32
+4	NULL	NULL	40
+4	40	NULL	40
+5	NULL	NULL	50
+5	50	NULL	50
+6	60	NULL	62
+6	62	NULL	62
+7	NULL	NULL	NULL
+PREHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS first_int,
+  LAST_VALUE(int_col) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS last_int
+FROM window_int_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS first_int,
+  LAST_VALUE(int_col) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS last_int
+FROM window_int_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+id	int_col	first_int	last_int
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+NULL	NULL	NULL	80
+NULL	80	NULL	80
+2	20	20	NULL
+2	NULL	20	NULL
+2	NULL	20	NULL
+3	NULL	NULL	32
+3	30	NULL	32
+3	32	NULL	32
+4	40	40	NULL
+4	NULL	40	NULL
+5	NULL	NULL	50
+5	50	NULL	50
+6	62	62	60
+6	60	62	60
+7	NULL	NULL	NULL
+PREHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS first_int,
+  LAST_VALUE(int_col) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS last_int
+FROM window_int_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS first_int,
+  LAST_VALUE(int_col) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS last_int
+FROM window_int_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+id	int_col	first_int	last_int
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+NULL	NULL	NULL	80
+NULL	80	NULL	80
+2	20	20	NULL
+2	NULL	20	NULL
+2	NULL	20	NULL
+3	NULL	NULL	32
+3	30	NULL	32
+3	32	NULL	32
+4	40	40	NULL
+4	NULL	40	NULL
+5	NULL	NULL	50
+5	50	NULL	50
+6	62	62	60
+6	60	62	60
+7	NULL	NULL	NULL
+PREHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col) IGNORE NULLS OVER(ORDER BY id) AS first_int,
+  LAST_VALUE(int_col) IGNORE NULLS OVER(ORDER BY id) AS last_int
+FROM window_int_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col) IGNORE NULLS OVER(ORDER BY id) AS first_int,
+  LAST_VALUE(int_col) IGNORE NULLS OVER(ORDER BY id) AS last_int
+FROM window_int_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+id	int_col	first_int	last_int
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+2	NULL	20	20
+2	20	20	20
+2	NULL	20	20
+3	NULL	20	30
+3	32	20	30
+3	30	20	30
+4	NULL	20	40
+4	40	20	40
+5	50	20	50
+5	NULL	20	50
+6	60	20	62
+6	62	20	62
+7	NULL	20	62
+NULL	NULL	20	80
+NULL	80	20	80
+PREHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col) IGNORE NULLS OVER(ORDER BY id ASC NULLS FIRST) AS first_int,
+  LAST_VALUE(int_col) IGNORE NULLS OVER(ORDER BY id ASC NULLS FIRST) AS last_int
+FROM window_int_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col) IGNORE NULLS OVER(ORDER BY id ASC NULLS FIRST) AS first_int,
+  LAST_VALUE(int_col) IGNORE NULLS OVER(ORDER BY id ASC NULLS FIRST) AS last_int
+FROM window_int_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+id	int_col	first_int	last_int
+NULL	NULL	80	80
+NULL	80	80	80
+1	NULL	80	80
+1	NULL	80	80
+1	NULL	80	80
+2	NULL	80	20
+2	NULL	80	20
+2	20	80	20
+3	NULL	80	32
+3	30	80	32
+3	32	80	32
+4	NULL	80	40
+4	40	80	40
+5	NULL	80	50
+5	50	80	50
+6	60	80	62
+6	62	80	62
+7	NULL	80	62
+PREHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col IGNORE NULLS) OVER(ORDER BY id) AS first_int,
+  LAST_VALUE(int_col IGNORE NULLS) OVER(ORDER BY id) AS last_int
+FROM window_int_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col IGNORE NULLS) OVER(ORDER BY id) AS first_int,
+  LAST_VALUE(int_col IGNORE NULLS) OVER(ORDER BY id) AS last_int
+FROM window_int_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+id	int_col	first_int	last_int
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+2	NULL	20	20
+2	20	20	20
+2	NULL	20	20
+3	NULL	20	30
+3	32	20	30
+3	30	20	30
+4	NULL	20	40
+4	40	20	40
+5	50	20	50
+5	NULL	20	50
+6	60	20	62
+6	62	20	62
+7	NULL	20	62
+NULL	NULL	20	80
+NULL	80	20	80
+PREHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col IGNORE NULLS) OVER(ORDER BY id ASC NULLS FIRST) AS first_int,
+  LAST_VALUE(int_col IGNORE NULLS) OVER(ORDER BY id ASC NULLS FIRST) AS last_int
+FROM window_int_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col IGNORE NULLS) OVER(ORDER BY id ASC NULLS FIRST) AS first_int,
+  LAST_VALUE(int_col IGNORE NULLS) OVER(ORDER BY id ASC NULLS FIRST) AS last_int
+FROM window_int_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+id	int_col	first_int	last_int
+NULL	NULL	80	80
+NULL	80	80	80
+1	NULL	80	80
+1	NULL	80	80
+1	NULL	80	80
+2	NULL	80	20
+2	NULL	80	20
+2	20	80	20
+3	NULL	80	32
+3	30	80	32
+3	32	80	32
+4	NULL	80	40
+4	40	80	40
+5	NULL	80	50
+5	50	80	50
+6	60	80	62
+6	62	80	62
+7	NULL	80	62
+PREHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id) AS first_int,
+  LAST_VALUE(int_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id) AS last_int
+FROM window_int_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id) AS first_int,
+  LAST_VALUE(int_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id) AS last_int
+FROM window_int_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+id	int_col	first_int	last_int
+3	NULL	30	32
+3	30	30	32
+3	32	30	32
+5	50	50	50
+5	NULL	50	50
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+2	NULL	20	20
+2	20	20	20
+2	NULL	20	20
+4	NULL	40	40
+4	40	40	40
+6	62	62	60
+6	60	62	60
+7	NULL	NULL	NULL
+NULL	80	80	80
+NULL	NULL	80	80
+PREHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS first_int,
+  LAST_VALUE(int_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS last_int
+FROM window_int_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS first_int,
+  LAST_VALUE(int_col IGNORE NULLS) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS last_int
+FROM window_int_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+id	int_col	first_int	last_int
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+NULL	NULL	80	80
+NULL	80	80	80
+2	20	20	20
+2	NULL	20	20
+2	NULL	20	20
+3	NULL	30	32
+3	30	30	32
+3	32	30	32
+4	40	40	40
+4	NULL	40	40
+5	NULL	50	50
+5	50	50	50
+6	62	62	60
+6	60	62	60
+7	NULL	NULL	NULL
+PREHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col) OVER(ORDER BY id) AS first_int,
+  LAST_VALUE(int_col) OVER(ORDER BY id) AS last_int
+FROM window_int_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col) OVER(ORDER BY id) AS first_int,
+  LAST_VALUE(int_col) OVER(ORDER BY id) AS last_int
+FROM window_int_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+id	int_col	first_int	last_int
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+2	NULL	NULL	NULL
+2	20	NULL	NULL
+2	NULL	NULL	NULL
+3	NULL	NULL	30
+3	32	NULL	30
+3	30	NULL	30
+4	NULL	NULL	40
+4	40	NULL	40
+5	50	NULL	NULL
+5	NULL	NULL	NULL
+6	60	NULL	62
+6	62	NULL	62
+7	NULL	NULL	NULL
+NULL	NULL	NULL	80
+NULL	80	NULL	80
+PREHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col) OVER(ORDER BY id ASC NULLS FIRST) AS first_int,
+  LAST_VALUE(int_col) OVER(ORDER BY id ASC NULLS FIRST) AS last_int
+FROM window_int_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col) OVER(ORDER BY id ASC NULLS FIRST) AS first_int,
+  LAST_VALUE(int_col) OVER(ORDER BY id ASC NULLS FIRST) AS last_int
+FROM window_int_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+id	int_col	first_int	last_int
+NULL	NULL	NULL	80
+NULL	80	NULL	80
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+2	NULL	NULL	20
+2	NULL	NULL	20
+2	20	NULL	20
+3	NULL	NULL	32
+3	30	NULL	32
+3	32	NULL	32
+4	NULL	NULL	40
+4	40	NULL	40
+5	NULL	NULL	50
+5	50	NULL	50
+6	60	NULL	62
+6	62	NULL	62
+7	NULL	NULL	NULL
+PREHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col) OVER(PARTITION BY id ORDER BY id) AS first_int,
+  LAST_VALUE(int_col) OVER(PARTITION BY id ORDER BY id) AS last_int
+FROM window_int_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col) OVER(PARTITION BY id ORDER BY id) AS first_int,
+  LAST_VALUE(int_col) OVER(PARTITION BY id ORDER BY id) AS last_int
+FROM window_int_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+id	int_col	first_int	last_int
+3	NULL	NULL	32
+3	30	NULL	32
+3	32	NULL	32
+5	50	50	NULL
+5	NULL	50	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+2	NULL	NULL	NULL
+2	20	NULL	NULL
+2	NULL	NULL	NULL
+4	NULL	NULL	40
+4	40	NULL	40
+6	62	62	60
+6	60	62	60
+7	NULL	NULL	NULL
+NULL	80	80	NULL
+NULL	NULL	80	NULL
+PREHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS first_int,
+  LAST_VALUE(int_col) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS last_int
+FROM window_int_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT id, int_col,
+  FIRST_VALUE(int_col) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS first_int,
+  LAST_VALUE(int_col) OVER(PARTITION BY id ORDER BY id ASC NULLS FIRST) AS last_int
+FROM window_int_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@window_int_test
+#### A masked pattern was here ####
+id	int_col	first_int	last_int
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+1	NULL	NULL	NULL
+NULL	NULL	NULL	80
+NULL	80	NULL	80
+2	20	20	NULL
+2	NULL	20	NULL
+2	NULL	20	NULL
+3	NULL	NULL	32
+3	30	NULL	32
+3	32	NULL	32
+4	40	40	NULL
+4	NULL	40	NULL
+5	NULL	NULL	50
+5	50	NULL	50
+6	62	62	60
+6	60	62	60
+7	NULL	NULL	NULL
