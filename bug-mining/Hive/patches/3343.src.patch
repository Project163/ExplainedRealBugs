diff --git a/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java b/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java
index d31d772761..3f215955e3 100644
--- a/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java
+++ b/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java
@@ -711,8 +711,8 @@ public static enum ConfVars {
     HIVEMAPJOINUSEOPTIMIZEDTABLE("hive.mapjoin.optimized.hashtable", true,
         "Whether Hive should use memory-optimized hash table for MapJoin. Only works on Tez,\n" +
         "because memory-optimized hashtable cannot be serialized."),
-    HIVEUSEHYBRIDGRACEHASHJOIN("hive.mapjoin.hybridgrace.hashtable", false, "Whether to use hybrid" +
-        "grace hash join as the join method for mapjoin."),
+    HIVEUSEHYBRIDGRACEHASHJOIN("hive.mapjoin.hybridgrace.hashtable", true, "Whether to use hybrid" +
+        "grace hash join as the join method for mapjoin. Tez only."),
     HIVEHYBRIDGRACEHASHJOINMEMCHECKFREQ("hive.mapjoin.hybridgrace.memcheckfrequency", 1024, "For " +
         "hybrid grace hash join, how often (how many rows apart) we check if memory is full. " +
         "This number should be power of 2."),
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/MapJoinOperator.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/MapJoinOperator.java
index 2499f33bed..38d72f52f8 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/MapJoinOperator.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/MapJoinOperator.java
@@ -37,18 +37,20 @@
 import org.apache.hadoop.hive.ql.HashTableLoaderFactory;
 import org.apache.hadoop.hive.ql.exec.mapjoin.MapJoinMemoryExhaustionHandler;
 import org.apache.hadoop.hive.ql.exec.mr.ExecMapperContext;
+import org.apache.hadoop.hive.ql.exec.persistence.BytesBytesMultiHashMap;
+import org.apache.hadoop.hive.ql.exec.persistence.HybridHashTableContainer;
+import org.apache.hadoop.hive.ql.exec.persistence.HybridHashTableContainer.HashPartition;
+import org.apache.hadoop.hive.ql.exec.persistence.KeyValueContainer;
+import org.apache.hadoop.hive.ql.exec.persistence.MapJoinBytesTableContainer;
+import org.apache.hadoop.hive.ql.exec.persistence.MapJoinBytesTableContainer.KeyValueHelper;
 import org.apache.hadoop.hive.ql.exec.persistence.MapJoinKey;
 import org.apache.hadoop.hive.ql.exec.persistence.MapJoinObjectSerDeContext;
 import org.apache.hadoop.hive.ql.exec.persistence.MapJoinRowContainer;
 import org.apache.hadoop.hive.ql.exec.persistence.MapJoinTableContainer;
-import org.apache.hadoop.hive.ql.exec.persistence.MapJoinTableContainerSerDe;
 import org.apache.hadoop.hive.ql.exec.persistence.MapJoinTableContainer.ReusableGetAdaptor;
-import org.apache.hadoop.hive.ql.exec.persistence.UnwrapRowContainer;
-import org.apache.hadoop.hive.ql.exec.persistence.BytesBytesMultiHashMap;
-import org.apache.hadoop.hive.ql.exec.persistence.MapJoinBytesTableContainer;
-import org.apache.hadoop.hive.ql.exec.persistence.HybridHashTableContainer;
-import org.apache.hadoop.hive.ql.exec.persistence.KeyValueContainer;
+import org.apache.hadoop.hive.ql.exec.persistence.MapJoinTableContainerSerDe;
 import org.apache.hadoop.hive.ql.exec.persistence.ObjectContainer;
+import org.apache.hadoop.hive.ql.exec.persistence.UnwrapRowContainer;
 import org.apache.hadoop.hive.ql.io.HiveKey;
 import org.apache.hadoop.hive.ql.log.PerfLogger;
 import org.apache.hadoop.hive.ql.metadata.HiveException;
@@ -63,9 +65,6 @@
 import org.apache.hadoop.io.Writable;
 import org.apache.hive.common.util.ReflectionUtil;
 
-import static org.apache.hadoop.hive.ql.exec.persistence.HybridHashTableContainer.HashPartition;
-import static org.apache.hadoop.hive.ql.exec.persistence.MapJoinBytesTableContainer.KeyValueHelper;
-
 /**
  * Map side Join operator implementation.
  */
@@ -80,6 +79,7 @@ public class MapJoinOperator extends AbstractMapJoinOperator<MapJoinDesc> implem
   private transient ObjectCache cache;
 
   protected HashTableLoader loader;
+  private boolean loadCalled;
 
   protected transient MapJoinTableContainer[] mapJoinTables;
   private transient MapJoinTableContainerSerDe[] mapJoinTableSerdes;
@@ -88,7 +88,6 @@ public class MapJoinOperator extends AbstractMapJoinOperator<MapJoinDesc> implem
 
   private UnwrapRowContainer[] unwrapContainer;
   private transient Configuration hconf;
-  private transient boolean useHybridGraceHashJoin; // whether Hybrid Grace Hash Join is enabled
   private transient boolean hybridMapJoinLeftover;  // whether there's spilled data to be processed
   private transient MapJoinBytesTableContainer currentSmallTable; // reloaded hashmap from disk
   private transient int tag;        // big table alias
@@ -141,15 +140,13 @@ protected Collection<Future<?>> initializeOp(Configuration hconf) throws HiveExc
     mapJoinTables = new MapJoinTableContainer[tagLen];
     mapJoinTableSerdes = new MapJoinTableContainerSerDe[tagLen];
     hashTblInitedOnce = false;
-    useHybridGraceHashJoin =
-        HiveConf.getBoolVar(hconf, HiveConf.ConfVars.HIVEUSEHYBRIDGRACEHASHJOIN);
 
     generateMapMetaData();
 
     final ExecMapperContext mapContext = getExecContext();
     final MapredContext mrContext = MapredContext.get();
 
-    if (!conf.isBucketMapJoin() && !useHybridGraceHashJoin) {
+    if (!conf.isBucketMapJoin()) {
       /*
        * The issue with caching in case of bucket map join is that different tasks
        * process different buckets and if the container is reused to join a different bucket,
@@ -187,8 +184,22 @@ protected final void completeInitializationOp(Object[] os) throws HiveException
     if (os.length != 0) {
       Pair<MapJoinTableContainer[], MapJoinTableContainerSerDe[]> pair =
           (Pair<MapJoinTableContainer[], MapJoinTableContainerSerDe[]>) os[0];
-      mapJoinTables = pair.getLeft();
-      mapJoinTableSerdes = pair.getRight();
+
+      boolean spilled = false;
+      for (MapJoinTableContainer container : pair.getLeft()) {
+        if (container != null) {
+          spilled = spilled || container.hasSpill();
+        }
+      }
+
+      if (!loadCalled && spilled) {
+        // we can't use the cached table because it has spilled.
+        loadHashTable(getExecContext(), MapredContext.get());
+      } else {
+        // let's use the table from the cache.
+        mapJoinTables = pair.getLeft();
+        mapJoinTableSerdes = pair.getRight();
+      }
       hashTblInitedOnce = true;
     }
 
@@ -258,6 +269,8 @@ public void generateMapMetaData() throws HiveException {
   private Pair<MapJoinTableContainer[], MapJoinTableContainerSerDe[]> loadHashTable(
       ExecMapperContext mapContext, MapredContext mrContext) throws HiveException {
 
+    loadCalled = true;
+
     if (this.hashTblInitedOnce
         && ((mapContext == null) || (mapContext.getLocalWork() == null) || (mapContext
             .getLocalWork().getInputFileChangeSensitive() == false))) {
@@ -359,8 +372,8 @@ public void process(Object row, int tag) throws HiveException {
             if (!noOuterJoin) {
               // For Hybrid Grace Hash Join, during the 1st round processing,
               // we only keep the LEFT side if the row is not spilled
-              if (!useHybridGraceHashJoin || hybridMapJoinLeftover ||
-                  (!hybridMapJoinLeftover && joinResult != JoinUtil.JoinResult.SPILL)) {
+              if (!conf.isHybridHashJoin() || hybridMapJoinLeftover
+                  || (!hybridMapJoinLeftover && joinResult != JoinUtil.JoinResult.SPILL)) {
                 joinNeeded = true;
                 storage[pos] = dummyObjVectors[pos];
               }
@@ -414,47 +427,57 @@ protected void spillBigTableRow(MapJoinTableContainer hybridHtContainer, Object
 
   @Override
   public void closeOp(boolean abort) throws HiveException {
-    for (MapJoinTableContainer tableContainer : mapJoinTables) {
-      if (tableContainer != null) {
-        tableContainer.dumpMetrics();
-
-        if (tableContainer instanceof HybridHashTableContainer) {
-          HybridHashTableContainer hybridHtContainer = (HybridHashTableContainer) tableContainer;
-          hybridHtContainer.dumpStats();
-
-          HashPartition[] hashPartitions = hybridHtContainer.getHashPartitions();
-          // Clear all in memory partitions first
-          for (int i = 0; i < hashPartitions.length; i++) {
-            if (!hashPartitions[i].isHashMapOnDisk()) {
-              hybridHtContainer.setTotalInMemRowCount(
-                  hybridHtContainer.getTotalInMemRowCount() -
-                      hashPartitions[i].getHashMapFromMemory().getNumValues());
-              hashPartitions[i].getHashMapFromMemory().clear();
+
+    boolean spilled = false;
+    for (MapJoinTableContainer container: mapJoinTables) {
+      if (container != null) {
+        spilled = spilled || container.hasSpill();
+        container.dumpMetrics();
+      }
+    }
+
+    if (spilled) {
+      for (MapJoinTableContainer tableContainer : mapJoinTables) {
+        if (tableContainer != null) {
+          if (tableContainer instanceof HybridHashTableContainer) {
+            HybridHashTableContainer hybridHtContainer = (HybridHashTableContainer) tableContainer;
+            hybridHtContainer.dumpStats();
+
+            HashPartition[] hashPartitions = hybridHtContainer.getHashPartitions();
+            // Clear all in memory partitions first
+            for (int i = 0; i < hashPartitions.length; i++) {
+              if (!hashPartitions[i].isHashMapOnDisk()) {
+                hybridHtContainer.setTotalInMemRowCount(
+                    hybridHtContainer.getTotalInMemRowCount() -
+                    hashPartitions[i].getHashMapFromMemory().getNumValues());
+                hashPartitions[i].getHashMapFromMemory().clear();
+              }
             }
-          }
-          assert hybridHtContainer.getTotalInMemRowCount() == 0;
-
-          for (int i = 0; i < hashPartitions.length; i++) {
-            if (hashPartitions[i].isHashMapOnDisk()) {
-              // Recursively process on-disk triplets (hash partition, sidefile, matchfile)
-              try {
-                hybridMapJoinLeftover = true;
-                hashMapRowGetters[smallTable] = null;
-                continueProcess(hashPartitions[i], hybridHtContainer);
-              } catch (IOException e) {
-                e.printStackTrace();
-              } catch (ClassNotFoundException e) {
-                e.printStackTrace();
-              } catch (SerDeException e) {
-                e.printStackTrace();
+            assert hybridHtContainer.getTotalInMemRowCount() == 0;
+
+            for (int i = 0; i < hashPartitions.length; i++) {
+              if (hashPartitions[i].isHashMapOnDisk()) {
+                // Recursively process on-disk triplets (hash partition, sidefile, matchfile)
+                try {
+                  hybridMapJoinLeftover = true;
+                  hashMapRowGetters[smallTable] = null;
+                  continueProcess(hashPartitions[i], hybridHtContainer);
+                } catch (IOException e) {
+                  e.printStackTrace();
+                } catch (ClassNotFoundException e) {
+                  e.printStackTrace();
+                } catch (SerDeException e) {
+                  e.printStackTrace();
+                }
               }
+              hybridMapJoinLeftover = false;
+              currentSmallTable = null;
             }
-            hybridMapJoinLeftover = false;
-            currentSmallTable = null;
           }
         }
       }
     }
+
     if ((this.getExecContext() != null) && (this.getExecContext().getLocalWork() != null)
         && (this.getExecContext().getLocalWork().getInputFileChangeSensitive())
         && mapJoinTables != null) {
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/persistence/HybridHashTableContainer.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/persistence/HybridHashTableContainer.java
index c2abba230f..67477c2f87 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/persistence/HybridHashTableContainer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/persistence/HybridHashTableContainer.java
@@ -19,7 +19,14 @@
 package org.apache.hadoop.hive.ql.exec.persistence;
 
 
-import com.esotericsoftware.kryo.Kryo;
+import java.io.IOException;
+import java.io.InputStream;
+import java.io.ObjectOutputStream;
+import java.io.OutputStream;
+import java.nio.file.Files;
+import java.nio.file.Path;
+import java.util.ArrayList;
+import java.util.List;
 
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
@@ -33,26 +40,20 @@
 import org.apache.hadoop.hive.ql.exec.vector.expressions.VectorExpressionWriter;
 import org.apache.hadoop.hive.ql.io.HiveKey;
 import org.apache.hadoop.hive.ql.metadata.HiveException;
+import org.apache.hadoop.hive.serde2.ByteStream.Output;
 import org.apache.hadoop.hive.serde2.SerDe;
 import org.apache.hadoop.hive.serde2.SerDeException;
 import org.apache.hadoop.hive.serde2.WriteBuffers;
-import org.apache.hadoop.hive.serde2.ByteStream.Output;
 import org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe;
 import org.apache.hadoop.hive.serde2.lazy.ByteArrayRef;
-import org.apache.hadoop.hive.serde2.lazybinary.objectinspector.LazyBinaryStructObjectInspector;
 import org.apache.hadoop.hive.serde2.lazybinary.LazyBinaryFactory;
 import org.apache.hadoop.hive.serde2.lazybinary.LazyBinaryStruct;
+import org.apache.hadoop.hive.serde2.lazybinary.objectinspector.LazyBinaryStructObjectInspector;
 import org.apache.hadoop.hive.serde2.objectinspector.ObjectInspector;
 import org.apache.hadoop.io.BytesWritable;
 import org.apache.hadoop.io.Writable;
 
-import java.io.IOException;
-import java.io.InputStream;
-import java.io.ObjectOutputStream;
-import java.io.OutputStream;
-import java.nio.file.Files;
-import java.nio.file.Path;
-import java.util.*;
+import com.esotericsoftware.kryo.Kryo;
 
 /**
  * Hash table container that can have many partitions -- each partition has its own hashmap,
@@ -67,16 +68,16 @@
 public class HybridHashTableContainer implements MapJoinTableContainer {
   private static final Log LOG = LogFactory.getLog(HybridHashTableContainer.class);
 
-  private HashPartition[] hashPartitions; // an array of partitions holding the triplets
+  private final HashPartition[] hashPartitions; // an array of partitions holding the triplets
   private int totalInMemRowCount = 0;     // total number of small table rows in memory
-  private long memoryThreshold;           // the max memory limit allocated
-  private long tableRowSize;              // row size of the small table
+  private final long memoryThreshold;           // the max memory limit allocated
+  private final long tableRowSize;              // row size of the small table
   private boolean isSpilled;              // whether there's any spilled partition
   private int toSpillPartitionId;         // the partition into which to spill the big table row;
                                           // This may change after every setMapJoinKey call
   private int numPartitionsSpilled;       // number of spilled partitions
   private boolean lastPartitionInMem;     // only one (last one) partition is left in memory
-  private int memoryCheckFrequency;       // how often (# of rows apart) to check if memory is full
+  private final int memoryCheckFrequency;       // how often (# of rows apart) to check if memory is full
 
   /** The OI used to deserialize values. We never deserialize keys. */
   private LazyBinaryStructObjectInspector internalValueOi;
@@ -182,6 +183,11 @@ private HybridHashTableContainer(float keyCountAdj, int threshold, float loadFac
                                    long noConditionalTaskThreshold, int memCheckFreq, long tableSize,
                                    long keyCount, long memUsage) throws SerDeException {
 
+    if (wbSize > noConditionalTaskThreshold) {
+      LOG.warn("adjusting hash table write buffer size to be smaller than noconditionaltasksize");
+      wbSize = (int) noConditionalTaskThreshold;
+    }
+
     int newKeyCount = HashMapWrapper.calculateTableSize(
         keyCountAdj, threshold, loadFactor, keyCount);
 
@@ -204,6 +210,7 @@ private HybridHashTableContainer(float keyCountAdj, int threshold, float loadFac
       if (isHashMapSpilledOnCreation(i)) {
         numPartitionsSpilledOnCreation++;
         numPartitionsSpilled++;
+        this.setSpill(true);
       } else {
         memoryAllocated += hashPartitions[i].hashMap.memorySize();
       }
@@ -398,8 +405,8 @@ private void spillPartition(int partitionId) throws IOException {
    */
   private int calcNumPartitions(long dataSize, int wbSize) {
     if (memoryThreshold < wbSize) {
-      throw new RuntimeException("Available memory is less than hashtable writebuffer size!" +
-          " Try increasing hive.auto.convert.join.noconditionaltask.size.");
+      throw new IllegalStateException("Available memory is less than hashtable writebuffer size!"
+          + " Try increasing hive.auto.convert.join.noconditionaltask.size.");
     }
 
     int lowerLimit = 2;
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/tez/HashTableLoader.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/tez/HashTableLoader.java
index 2e1592259b..90342532f6 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/tez/HashTableLoader.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/tez/HashTableLoader.java
@@ -29,11 +29,11 @@
 import org.apache.hadoop.hive.ql.exec.MapredContext;
 import org.apache.hadoop.hive.ql.exec.mr.ExecMapperContext;
 import org.apache.hadoop.hive.ql.exec.persistence.HashMapWrapper;
+import org.apache.hadoop.hive.ql.exec.persistence.HybridHashTableContainer;
 import org.apache.hadoop.hive.ql.exec.persistence.MapJoinBytesTableContainer;
 import org.apache.hadoop.hive.ql.exec.persistence.MapJoinObjectSerDeContext;
 import org.apache.hadoop.hive.ql.exec.persistence.MapJoinTableContainer;
 import org.apache.hadoop.hive.ql.exec.persistence.MapJoinTableContainerSerDe;
-import org.apache.hadoop.hive.ql.exec.persistence.HybridHashTableContainer;
 import org.apache.hadoop.hive.ql.metadata.HiveException;
 import org.apache.hadoop.hive.ql.plan.MapJoinDesc;
 import org.apache.hadoop.hive.serde2.SerDeException;
@@ -77,8 +77,7 @@ public void load(MapJoinTableContainer[] mapJoinTables,
 
     boolean useOptimizedTables = HiveConf.getBoolVar(
         hconf, HiveConf.ConfVars.HIVEMAPJOINUSEOPTIMIZEDTABLE);
-    boolean useHybridGraceHashJoin = HiveConf.getBoolVar(
-        hconf, HiveConf.ConfVars.HIVEUSEHYBRIDGRACEHASHJOIN);
+    boolean useHybridGraceHashJoin = desc.isHybridHashJoin();
     boolean isFirstKey = true;
 
     // Disable hybrid grace hash join for n-way join
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/ConvertJoinMapJoin.java b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/ConvertJoinMapJoin.java
index 8423698ed9..d42b643c96 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/ConvertJoinMapJoin.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/ConvertJoinMapJoin.java
@@ -626,6 +626,8 @@ public MapJoinOperator convertJoinMapJoin(JoinOperator joinOp, OptimizeTezProcCo
         MapJoinProcessor.convertJoinOpMapJoinOp(context.conf, joinOp,
             joinOp.getConf().isLeftInputJoin(), joinOp.getConf().getBaseSrc(),
             joinOp.getConf().getMapAliases(), bigTablePosition, true);
+    mapJoinOp.getConf().setHybridHashJoin(HiveConf.getBoolVar(context.conf,
+      HiveConf.ConfVars.HIVEUSEHYBRIDGRACEHASHJOIN));
 
     Operator<? extends OperatorDesc> parentBigTableOp =
         mapJoinOp.getParentOperators().get(bigTablePosition);
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/plan/MapJoinDesc.java b/ql/src/java/org/apache/hadoop/hive/ql/plan/MapJoinDesc.java
index 664d6e529c..c2c1b955dc 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/plan/MapJoinDesc.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/plan/MapJoinDesc.java
@@ -70,6 +70,8 @@ public class MapJoinDesc extends JoinDesc implements Serializable {
   private float hashtableMemoryUsage;
   protected boolean genJoinKeys = true;
 
+  private boolean isHybridHashJoin;
+
   public MapJoinDesc() {
     bigTableBucketNumMapping = new LinkedHashMap<String, Integer>();
   }
@@ -90,6 +92,8 @@ public MapJoinDesc(MapJoinDesc clone) {
     this.parentToInput = clone.parentToInput;
     this.parentKeyCounts = clone.parentKeyCounts;
     this.parentDataSizes = clone.parentDataSizes;
+    this.isBucketMapJoin = clone.isBucketMapJoin;
+    this.isHybridHashJoin = clone.isHybridHashJoin;
   }
 
   public MapJoinDesc(final Map<Byte, List<ExprNodeDesc>> keys,
@@ -322,6 +326,15 @@ public void setBucketMapJoin(boolean isBucketMapJoin) {
     this.isBucketMapJoin = isBucketMapJoin;
   }
 
+  @Explain(displayName = "HybridGraceHashJoin", displayOnlyOnTrue = true)
+  public boolean isHybridHashJoin() {
+    return isHybridHashJoin;
+  }
+
+  public void setHybridHashJoin(boolean isHybridHashJoin) {
+    this.isHybridHashJoin = isHybridHashJoin;
+  }
+
   public void setHashTableMemoryUsage(float hashtableMemoryUsage) {
     this.hashtableMemoryUsage = hashtableMemoryUsage;
   }
diff --git a/ql/src/test/queries/clientpositive/vectorized_context.q b/ql/src/test/queries/clientpositive/vectorized_context.q
index 381e4255ca..5706b3ae08 100644
--- a/ql/src/test/queries/clientpositive/vectorized_context.q
+++ b/ql/src/test/queries/clientpositive/vectorized_context.q
@@ -22,6 +22,7 @@ where cint not in (
 set hive.auto.convert.join=true;
 set hive.vectorized.execution.enabled=true;
 
+set hive.mapjoin.hybridgrace.hashtable=false;
 
 explain 
 select store.s_city, ss_net_profit
diff --git a/ql/src/test/results/clientpositive/auto_sortmerge_join_1.q.out b/ql/src/test/results/clientpositive/auto_sortmerge_join_1.q.out
index 34a1820b11..383defd320 100644
--- a/ql/src/test/results/clientpositive/auto_sortmerge_join_1.q.out
+++ b/ql/src/test/results/clientpositive/auto_sortmerge_join_1.q.out
@@ -164,6 +164,7 @@ STAGE PLANS:
                   0 key (type: string)
                   1 key (type: string)
                 Position of Big Table: 1
+                BucketMapJoin: true
                 Group By Operator
                   aggregations: count()
                   mode: hash
@@ -384,6 +385,7 @@ STAGE PLANS:
                   0 key (type: string)
                   1 key (type: string)
                 Position of Big Table: 0
+                BucketMapJoin: true
                 Group By Operator
                   aggregations: count()
                   mode: hash
@@ -1199,6 +1201,7 @@ STAGE PLANS:
                   0 key (type: string)
                   1 key (type: string)
                 Position of Big Table: 0
+                BucketMapJoin: true
                 Group By Operator
                   aggregations: count()
                   mode: hash
diff --git a/ql/src/test/results/clientpositive/auto_sortmerge_join_2.q.out b/ql/src/test/results/clientpositive/auto_sortmerge_join_2.q.out
index 34c8a26b05..c0894199b3 100644
--- a/ql/src/test/results/clientpositive/auto_sortmerge_join_2.q.out
+++ b/ql/src/test/results/clientpositive/auto_sortmerge_join_2.q.out
@@ -144,6 +144,7 @@ STAGE PLANS:
                   0 key (type: string)
                   1 key (type: string)
                 Position of Big Table: 0
+                BucketMapJoin: true
                 Group By Operator
                   aggregations: count()
                   mode: hash
@@ -961,6 +962,7 @@ STAGE PLANS:
                   0 key (type: string)
                   1 key (type: string)
                 Position of Big Table: 0
+                BucketMapJoin: true
                 Group By Operator
                   aggregations: count()
                   mode: hash
diff --git a/ql/src/test/results/clientpositive/auto_sortmerge_join_3.q.out b/ql/src/test/results/clientpositive/auto_sortmerge_join_3.q.out
index 9af82b958e..6e443fae30 100644
--- a/ql/src/test/results/clientpositive/auto_sortmerge_join_3.q.out
+++ b/ql/src/test/results/clientpositive/auto_sortmerge_join_3.q.out
@@ -144,6 +144,7 @@ STAGE PLANS:
                   0 key (type: string)
                   1 key (type: string)
                 Position of Big Table: 1
+                BucketMapJoin: true
                 Group By Operator
                   aggregations: count()
                   mode: hash
@@ -315,6 +316,7 @@ STAGE PLANS:
                   0 key (type: string)
                   1 key (type: string)
                 Position of Big Table: 0
+                BucketMapJoin: true
                 Group By Operator
                   aggregations: count()
                   mode: hash
@@ -1078,6 +1080,7 @@ STAGE PLANS:
                   0 key (type: string)
                   1 key (type: string)
                 Position of Big Table: 0
+                BucketMapJoin: true
                 Group By Operator
                   aggregations: count()
                   mode: hash
diff --git a/ql/src/test/results/clientpositive/auto_sortmerge_join_4.q.out b/ql/src/test/results/clientpositive/auto_sortmerge_join_4.q.out
index 0bf80f4e6d..feaea0435a 100644
--- a/ql/src/test/results/clientpositive/auto_sortmerge_join_4.q.out
+++ b/ql/src/test/results/clientpositive/auto_sortmerge_join_4.q.out
@@ -160,6 +160,7 @@ STAGE PLANS:
                   0 key (type: string)
                   1 key (type: string)
                 Position of Big Table: 1
+                BucketMapJoin: true
                 Group By Operator
                   aggregations: count()
                   mode: hash
@@ -331,6 +332,7 @@ STAGE PLANS:
                   0 key (type: string)
                   1 key (type: string)
                 Position of Big Table: 0
+                BucketMapJoin: true
                 Group By Operator
                   aggregations: count()
                   mode: hash
@@ -1094,6 +1096,7 @@ STAGE PLANS:
                   0 key (type: string)
                   1 key (type: string)
                 Position of Big Table: 0
+                BucketMapJoin: true
                 Group By Operator
                   aggregations: count()
                   mode: hash
diff --git a/ql/src/test/results/clientpositive/auto_sortmerge_join_5.q.out b/ql/src/test/results/clientpositive/auto_sortmerge_join_5.q.out
index 70665c2a9f..f64ecf0521 100644
--- a/ql/src/test/results/clientpositive/auto_sortmerge_join_5.q.out
+++ b/ql/src/test/results/clientpositive/auto_sortmerge_join_5.q.out
@@ -125,6 +125,7 @@ STAGE PLANS:
                   0 key (type: string)
                   1 key (type: string)
                 Position of Big Table: 1
+                BucketMapJoin: true
                 Group By Operator
                   aggregations: count()
                   mode: hash
@@ -286,6 +287,7 @@ STAGE PLANS:
                   0 key (type: string)
                   1 key (type: string)
                 Position of Big Table: 0
+                BucketMapJoin: true
                 Group By Operator
                   aggregations: count()
                   mode: hash
@@ -777,6 +779,7 @@ STAGE PLANS:
                   0 key (type: string)
                   1 key (type: string)
                 Position of Big Table: 0
+                BucketMapJoin: true
                 Group By Operator
                   aggregations: count()
                   mode: hash
diff --git a/ql/src/test/results/clientpositive/auto_sortmerge_join_7.q.out b/ql/src/test/results/clientpositive/auto_sortmerge_join_7.q.out
index 446bb02364..e89f548b76 100644
--- a/ql/src/test/results/clientpositive/auto_sortmerge_join_7.q.out
+++ b/ql/src/test/results/clientpositive/auto_sortmerge_join_7.q.out
@@ -177,6 +177,7 @@ STAGE PLANS:
                   0 key (type: string)
                   1 key (type: string)
                 Position of Big Table: 1
+                BucketMapJoin: true
                 Group By Operator
                   aggregations: count()
                   mode: hash
@@ -399,6 +400,7 @@ STAGE PLANS:
                   0 key (type: string)
                   1 key (type: string)
                 Position of Big Table: 0
+                BucketMapJoin: true
                 Group By Operator
                   aggregations: count()
                   mode: hash
@@ -1357,6 +1359,7 @@ STAGE PLANS:
                   0 key (type: string)
                   1 key (type: string)
                 Position of Big Table: 0
+                BucketMapJoin: true
                 Group By Operator
                   aggregations: count()
                   mode: hash
diff --git a/ql/src/test/results/clientpositive/auto_sortmerge_join_8.q.out b/ql/src/test/results/clientpositive/auto_sortmerge_join_8.q.out
index b5b59132b0..44c037f909 100644
--- a/ql/src/test/results/clientpositive/auto_sortmerge_join_8.q.out
+++ b/ql/src/test/results/clientpositive/auto_sortmerge_join_8.q.out
@@ -177,6 +177,7 @@ STAGE PLANS:
                   0 key (type: string)
                   1 key (type: string)
                 Position of Big Table: 1
+                BucketMapJoin: true
                 Group By Operator
                   aggregations: count()
                   mode: hash
@@ -399,6 +400,7 @@ STAGE PLANS:
                   0 key (type: string)
                   1 key (type: string)
                 Position of Big Table: 0
+                BucketMapJoin: true
                 Group By Operator
                   aggregations: count()
                   mode: hash
@@ -1359,6 +1361,7 @@ STAGE PLANS:
                   0 key (type: string)
                   1 key (type: string)
                 Position of Big Table: 0
+                BucketMapJoin: true
                 Group By Operator
                   aggregations: count()
                   mode: hash
diff --git a/ql/src/test/results/clientpositive/bucketcontext_1.q.out b/ql/src/test/results/clientpositive/bucketcontext_1.q.out
index 37e05148d2..77bfcf92b9 100644
--- a/ql/src/test/results/clientpositive/bucketcontext_1.q.out
+++ b/ql/src/test/results/clientpositive/bucketcontext_1.q.out
@@ -473,6 +473,7 @@ STAGE PLANS:
                   0 key (type: string)
                   1 key (type: string)
                 Position of Big Table: 1
+                BucketMapJoin: true
                 Group By Operator
                   aggregations: count()
                   mode: hash
diff --git a/ql/src/test/results/clientpositive/bucketcontext_2.q.out b/ql/src/test/results/clientpositive/bucketcontext_2.q.out
index 5cb6845a15..a9db13d688 100644
--- a/ql/src/test/results/clientpositive/bucketcontext_2.q.out
+++ b/ql/src/test/results/clientpositive/bucketcontext_2.q.out
@@ -457,6 +457,7 @@ STAGE PLANS:
                   0 key (type: string)
                   1 key (type: string)
                 Position of Big Table: 1
+                BucketMapJoin: true
                 Group By Operator
                   aggregations: count()
                   mode: hash
diff --git a/ql/src/test/results/clientpositive/bucketcontext_3.q.out b/ql/src/test/results/clientpositive/bucketcontext_3.q.out
index 2433a67da0..9ba3e0c0fa 100644
--- a/ql/src/test/results/clientpositive/bucketcontext_3.q.out
+++ b/ql/src/test/results/clientpositive/bucketcontext_3.q.out
@@ -454,6 +454,7 @@ STAGE PLANS:
                   0 key (type: string)
                   1 key (type: string)
                 Position of Big Table: 1
+                BucketMapJoin: true
                 Group By Operator
                   aggregations: count()
                   mode: hash
diff --git a/ql/src/test/results/clientpositive/bucketcontext_4.q.out b/ql/src/test/results/clientpositive/bucketcontext_4.q.out
index c039126a71..a2b37a80b2 100644
--- a/ql/src/test/results/clientpositive/bucketcontext_4.q.out
+++ b/ql/src/test/results/clientpositive/bucketcontext_4.q.out
@@ -470,6 +470,7 @@ STAGE PLANS:
                   0 key (type: string)
                   1 key (type: string)
                 Position of Big Table: 1
+                BucketMapJoin: true
                 Group By Operator
                   aggregations: count()
                   mode: hash
diff --git a/ql/src/test/results/clientpositive/bucketcontext_5.q.out b/ql/src/test/results/clientpositive/bucketcontext_5.q.out
index 4b9ade6559..3ee1f0ece9 100644
--- a/ql/src/test/results/clientpositive/bucketcontext_5.q.out
+++ b/ql/src/test/results/clientpositive/bucketcontext_5.q.out
@@ -332,6 +332,7 @@ STAGE PLANS:
                   0 key (type: string)
                   1 key (type: string)
                 Position of Big Table: 1
+                BucketMapJoin: true
                 Group By Operator
                   aggregations: count()
                   mode: hash
diff --git a/ql/src/test/results/clientpositive/bucketcontext_6.q.out b/ql/src/test/results/clientpositive/bucketcontext_6.q.out
index 66c159bb3e..d2304fa142 100644
--- a/ql/src/test/results/clientpositive/bucketcontext_6.q.out
+++ b/ql/src/test/results/clientpositive/bucketcontext_6.q.out
@@ -407,6 +407,7 @@ STAGE PLANS:
                   0 key (type: string)
                   1 key (type: string)
                 Position of Big Table: 1
+                BucketMapJoin: true
                 Group By Operator
                   aggregations: count()
                   mode: hash
diff --git a/ql/src/test/results/clientpositive/bucketcontext_7.q.out b/ql/src/test/results/clientpositive/bucketcontext_7.q.out
index 4228a4d7ac..1a105ed8c2 100644
--- a/ql/src/test/results/clientpositive/bucketcontext_7.q.out
+++ b/ql/src/test/results/clientpositive/bucketcontext_7.q.out
@@ -538,6 +538,7 @@ STAGE PLANS:
                   0 key (type: string)
                   1 key (type: string)
                 Position of Big Table: 1
+                BucketMapJoin: true
                 Group By Operator
                   aggregations: count()
                   mode: hash
diff --git a/ql/src/test/results/clientpositive/bucketcontext_8.q.out b/ql/src/test/results/clientpositive/bucketcontext_8.q.out
index dfa0cd8e5d..138e41516b 100644
--- a/ql/src/test/results/clientpositive/bucketcontext_8.q.out
+++ b/ql/src/test/results/clientpositive/bucketcontext_8.q.out
@@ -538,6 +538,7 @@ STAGE PLANS:
                   0 key (type: string)
                   1 key (type: string)
                 Position of Big Table: 1
+                BucketMapJoin: true
                 Group By Operator
                   aggregations: count()
                   mode: hash
diff --git a/ql/src/test/results/clientpositive/smb_mapjoin9.q.out b/ql/src/test/results/clientpositive/smb_mapjoin9.q.out
index 9530be1129..cbaf7e1a53 100644
--- a/ql/src/test/results/clientpositive/smb_mapjoin9.q.out
+++ b/ql/src/test/results/clientpositive/smb_mapjoin9.q.out
@@ -129,6 +129,7 @@ STAGE PLANS:
                   1 key (type: int)
                 outputColumnNames: _col0, _col6, _col7
                 Position of Big Table: 0
+                BucketMapJoin: true
                 Select Operator
                   expressions: _col6 (type: int), _col7 (type: string), '2010-10-15' (type: string), _col0 (type: int)
                   outputColumnNames: _col0, _col1, _col2, _col3
@@ -288,6 +289,7 @@ STAGE PLANS:
                   1 key (type: int)
                 outputColumnNames: _col0, _col6, _col7
                 Position of Big Table: 1
+                BucketMapJoin: true
                 Select Operator
                   expressions: _col6 (type: int), _col7 (type: string), '2010-10-15' (type: string), _col0 (type: int)
                   outputColumnNames: _col0, _col1, _col2, _col3
diff --git a/ql/src/test/results/clientpositive/smb_mapjoin_11.q.out b/ql/src/test/results/clientpositive/smb_mapjoin_11.q.out
index 691cb46f15..e1d049daca 100644
--- a/ql/src/test/results/clientpositive/smb_mapjoin_11.q.out
+++ b/ql/src/test/results/clientpositive/smb_mapjoin_11.q.out
@@ -144,6 +144,7 @@ STAGE PLANS:
                   1 key (type: int)
                 outputColumnNames: _col0, _col7
                 Position of Big Table: 0
+                BucketMapJoin: true
                 Select Operator
                   expressions: _col0 (type: int), _col7 (type: string)
                   outputColumnNames: _col0, _col1
diff --git a/ql/src/test/results/clientpositive/smb_mapjoin_12.q.out b/ql/src/test/results/clientpositive/smb_mapjoin_12.q.out
index e5457dd01f..777ff8af17 100644
--- a/ql/src/test/results/clientpositive/smb_mapjoin_12.q.out
+++ b/ql/src/test/results/clientpositive/smb_mapjoin_12.q.out
@@ -156,6 +156,7 @@ STAGE PLANS:
                   1 key (type: int)
                 outputColumnNames: _col0, _col7
                 Position of Big Table: 0
+                BucketMapJoin: true
                 Select Operator
                   expressions: _col0 (type: int), _col7 (type: string)
                   outputColumnNames: _col0, _col1
@@ -416,6 +417,7 @@ STAGE PLANS:
                   1 key (type: int)
                 outputColumnNames: _col0, _col1, _col7
                 Position of Big Table: 0
+                BucketMapJoin: true
                 Select Operator
                   expressions: _col0 (type: int), concat(_col1, _col7) (type: string)
                   outputColumnNames: _col0, _col1
diff --git a/ql/src/test/results/clientpositive/smb_mapjoin_13.q.out b/ql/src/test/results/clientpositive/smb_mapjoin_13.q.out
index bd28bbb5db..8eb9dbd5de 100644
--- a/ql/src/test/results/clientpositive/smb_mapjoin_13.q.out
+++ b/ql/src/test/results/clientpositive/smb_mapjoin_13.q.out
@@ -144,6 +144,7 @@ STAGE PLANS:
                   1 value (type: int)
                 outputColumnNames: _col0, _col1, _col5, _col6
                 Position of Big Table: 0
+                BucketMapJoin: true
                 Select Operator
                   expressions: _col0 (type: int), _col1 (type: string), _col5 (type: int), _col6 (type: string)
                   outputColumnNames: _col0, _col1, _col2, _col3
diff --git a/ql/src/test/results/clientpositive/smb_mapjoin_15.q.out b/ql/src/test/results/clientpositive/smb_mapjoin_15.q.out
index 2b6a62e3e7..0f747f0fbe 100644
--- a/ql/src/test/results/clientpositive/smb_mapjoin_15.q.out
+++ b/ql/src/test/results/clientpositive/smb_mapjoin_15.q.out
@@ -116,6 +116,7 @@ STAGE PLANS:
                   1 key (type: int)
                 outputColumnNames: _col0, _col1, _col5, _col6
                 Position of Big Table: 0
+                BucketMapJoin: true
                 Select Operator
                   expressions: _col0 (type: int), _col1 (type: string), _col5 (type: int), _col6 (type: string)
                   outputColumnNames: _col0, _col1, _col2, _col3
@@ -372,6 +373,7 @@ STAGE PLANS:
                   1 key (type: int), key2 (type: int)
                 outputColumnNames: _col0, _col1, _col2, _col6, _col7, _col8
                 Position of Big Table: 0
+                BucketMapJoin: true
                 Select Operator
                   expressions: _col0 (type: int), _col1 (type: int), _col2 (type: string), _col6 (type: int), _col7 (type: int), _col8 (type: string)
                   outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
@@ -576,6 +578,7 @@ STAGE PLANS:
                   1 key2 (type: int), key (type: int)
                 outputColumnNames: _col0, _col1, _col2, _col6, _col7, _col8
                 Position of Big Table: 0
+                BucketMapJoin: true
                 Select Operator
                   expressions: _col0 (type: int), _col1 (type: int), _col2 (type: string), _col6 (type: int), _col7 (type: int), _col8 (type: string)
                   outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
diff --git a/ql/src/test/results/clientpositive/sort_merge_join_desc_5.q.out b/ql/src/test/results/clientpositive/sort_merge_join_desc_5.q.out
index 13cfb1acfa..91cd338ef7 100644
--- a/ql/src/test/results/clientpositive/sort_merge_join_desc_5.q.out
+++ b/ql/src/test/results/clientpositive/sort_merge_join_desc_5.q.out
@@ -134,6 +134,7 @@ STAGE PLANS:
                   0 key (type: int)
                   1 key (type: int)
                 Position of Big Table: 0
+                BucketMapJoin: true
                 Group By Operator
                   aggregations: count()
                   mode: hash
diff --git a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_1.q.out b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_1.q.out
index 3177b2f146..09d2692ab2 100644
--- a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_1.q.out
+++ b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_1.q.out
@@ -170,6 +170,7 @@ STAGE PLANS:
                         1 key (type: string)
                       Position of Big Table: 1
                       Statistics: Num rows: 63 Data size: 6393 Basic stats: COMPLETE Column stats: NONE
+                      BucketMapJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
@@ -401,6 +402,7 @@ STAGE PLANS:
                         1 key (type: string)
                       Position of Big Table: 0
                       Statistics: Num rows: 63 Data size: 6393 Basic stats: COMPLETE Column stats: NONE
+                      BucketMapJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
diff --git a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_2.q.out b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_2.q.out
index e528a1af33..2ea0a65118 100644
--- a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_2.q.out
+++ b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_2.q.out
@@ -150,6 +150,7 @@ STAGE PLANS:
                         1 key (type: string)
                       Position of Big Table: 0
                       Statistics: Num rows: 29 Data size: 3025 Basic stats: COMPLETE Column stats: NONE
+                      BucketMapJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
diff --git a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_3.q.out b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_3.q.out
index f4d9b066e7..6281929764 100644
--- a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_3.q.out
+++ b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_3.q.out
@@ -150,6 +150,7 @@ STAGE PLANS:
                         1 key (type: string)
                       Position of Big Table: 1
                       Statistics: Num rows: 31 Data size: 3196 Basic stats: COMPLETE Column stats: NONE
+                      BucketMapJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
@@ -332,6 +333,7 @@ STAGE PLANS:
                         1 key (type: string)
                       Position of Big Table: 0
                       Statistics: Num rows: 31 Data size: 3196 Basic stats: COMPLETE Column stats: NONE
+                      BucketMapJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
diff --git a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_4.q.out b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_4.q.out
index 2423eec4c1..31e9d86155 100644
--- a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_4.q.out
+++ b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_4.q.out
@@ -166,6 +166,7 @@ STAGE PLANS:
                         1 key (type: string)
                       Position of Big Table: 1
                       Statistics: Num rows: 15 Data size: 1567 Basic stats: COMPLETE Column stats: NONE
+                      BucketMapJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
@@ -348,6 +349,7 @@ STAGE PLANS:
                         1 key (type: string)
                       Position of Big Table: 0
                       Statistics: Num rows: 15 Data size: 1567 Basic stats: COMPLETE Column stats: NONE
+                      BucketMapJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
diff --git a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_5.q.out b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_5.q.out
index 732beb58fd..3eceb0bc65 100644
--- a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_5.q.out
+++ b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_5.q.out
@@ -131,6 +131,7 @@ STAGE PLANS:
                         1 key (type: string)
                       Position of Big Table: 1
                       Statistics: Num rows: 15 Data size: 1567 Basic stats: COMPLETE Column stats: NONE
+                      BucketMapJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
@@ -303,6 +304,7 @@ STAGE PLANS:
                         1 key (type: string)
                       Position of Big Table: 0
                       Statistics: Num rows: 15 Data size: 1567 Basic stats: COMPLETE Column stats: NONE
+                      BucketMapJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
diff --git a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_7.q.out b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_7.q.out
index ff9b8e4d4f..ddbca05cff 100644
--- a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_7.q.out
+++ b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_7.q.out
@@ -183,6 +183,7 @@ STAGE PLANS:
                         1 key (type: string)
                       Position of Big Table: 1
                       Statistics: Num rows: 29 Data size: 3025 Basic stats: COMPLETE Column stats: NONE
+                      BucketMapJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
@@ -416,6 +417,7 @@ STAGE PLANS:
                         1 key (type: string)
                       Position of Big Table: 0
                       Statistics: Num rows: 29 Data size: 3025 Basic stats: COMPLETE Column stats: NONE
+                      BucketMapJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
diff --git a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_8.q.out b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_8.q.out
index 05b63c29a1..88d4dcb21f 100644
--- a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_8.q.out
+++ b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_8.q.out
@@ -183,6 +183,7 @@ STAGE PLANS:
                         1 key (type: string)
                       Position of Big Table: 1
                       Statistics: Num rows: 63 Data size: 6393 Basic stats: COMPLETE Column stats: NONE
+                      BucketMapJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
@@ -416,6 +417,7 @@ STAGE PLANS:
                         1 key (type: string)
                       Position of Big Table: 0
                       Statistics: Num rows: 63 Data size: 6393 Basic stats: COMPLETE Column stats: NONE
+                      BucketMapJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
diff --git a/ql/src/test/results/clientpositive/spark/smb_mapjoin_11.q.out b/ql/src/test/results/clientpositive/spark/smb_mapjoin_11.q.out
index c3f996febe..c94cc5bfc4 100644
--- a/ql/src/test/results/clientpositive/spark/smb_mapjoin_11.q.out
+++ b/ql/src/test/results/clientpositive/spark/smb_mapjoin_11.q.out
@@ -148,6 +148,7 @@ STAGE PLANS:
                       outputColumnNames: _col0, _col7
                       Position of Big Table: 0
                       Statistics: Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
+                      BucketMapJoin: true
                       Select Operator
                         expressions: _col0 (type: int), _col7 (type: string)
                         outputColumnNames: _col0, _col1
diff --git a/ql/src/test/results/clientpositive/spark/smb_mapjoin_12.q.out b/ql/src/test/results/clientpositive/spark/smb_mapjoin_12.q.out
index 50bc19e127..eeb23a8487 100644
--- a/ql/src/test/results/clientpositive/spark/smb_mapjoin_12.q.out
+++ b/ql/src/test/results/clientpositive/spark/smb_mapjoin_12.q.out
@@ -160,6 +160,7 @@ STAGE PLANS:
                       outputColumnNames: _col0, _col7
                       Position of Big Table: 0
                       Statistics: Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
+                      BucketMapJoin: true
                       Select Operator
                         expressions: _col0 (type: int), _col7 (type: string)
                         outputColumnNames: _col0, _col1
@@ -426,6 +427,7 @@ STAGE PLANS:
                       outputColumnNames: _col0, _col1, _col7
                       Position of Big Table: 0
                       Statistics: Num rows: 1696 Data size: 18097 Basic stats: COMPLETE Column stats: NONE
+                      BucketMapJoin: true
                       Select Operator
                         expressions: _col0 (type: int), concat(_col1, _col7) (type: string)
                         outputColumnNames: _col0, _col1
diff --git a/ql/src/test/results/clientpositive/spark/smb_mapjoin_13.q.out b/ql/src/test/results/clientpositive/spark/smb_mapjoin_13.q.out
index 7786da1fc6..7c34ceb5d6 100644
--- a/ql/src/test/results/clientpositive/spark/smb_mapjoin_13.q.out
+++ b/ql/src/test/results/clientpositive/spark/smb_mapjoin_13.q.out
@@ -150,6 +150,7 @@ STAGE PLANS:
                       outputColumnNames: _col0, _col1, _col5, _col6
                       Position of Big Table: 0
                       Statistics: Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
+                      BucketMapJoin: true
                       Select Operator
                         expressions: _col0 (type: int), _col1 (type: string), _col5 (type: int), _col6 (type: string)
                         outputColumnNames: _col0, _col1, _col2, _col3
diff --git a/ql/src/test/results/clientpositive/spark/smb_mapjoin_15.q.out b/ql/src/test/results/clientpositive/spark/smb_mapjoin_15.q.out
index 70e307731c..403217036c 100644
--- a/ql/src/test/results/clientpositive/spark/smb_mapjoin_15.q.out
+++ b/ql/src/test/results/clientpositive/spark/smb_mapjoin_15.q.out
@@ -122,6 +122,7 @@ STAGE PLANS:
                       outputColumnNames: _col0, _col1, _col5, _col6
                       Position of Big Table: 0
                       Statistics: Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
+                      BucketMapJoin: true
                       Select Operator
                         expressions: _col0 (type: int), _col1 (type: string), _col5 (type: int), _col6 (type: string)
                         outputColumnNames: _col0, _col1, _col2, _col3
@@ -390,6 +391,7 @@ STAGE PLANS:
                       outputColumnNames: _col0, _col1, _col2, _col6, _col7, _col8
                       Position of Big Table: 0
                       Statistics: Num rows: 137 Data size: 1984 Basic stats: COMPLETE Column stats: NONE
+                      BucketMapJoin: true
                       Select Operator
                         expressions: _col0 (type: int), _col1 (type: int), _col2 (type: string), _col6 (type: int), _col7 (type: int), _col8 (type: string)
                         outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
@@ -606,6 +608,7 @@ STAGE PLANS:
                       outputColumnNames: _col0, _col1, _col2, _col6, _col7, _col8
                       Position of Big Table: 0
                       Statistics: Num rows: 137 Data size: 1984 Basic stats: COMPLETE Column stats: NONE
+                      BucketMapJoin: true
                       Select Operator
                         expressions: _col0 (type: int), _col1 (type: int), _col2 (type: string), _col6 (type: int), _col7 (type: int), _col8 (type: string)
                         outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
diff --git a/ql/src/test/results/clientpositive/spark/sort_merge_join_desc_5.q.out b/ql/src/test/results/clientpositive/spark/sort_merge_join_desc_5.q.out
index 54ff1afa39..5c7f0d043a 100644
--- a/ql/src/test/results/clientpositive/spark/sort_merge_join_desc_5.q.out
+++ b/ql/src/test/results/clientpositive/spark/sort_merge_join_desc_5.q.out
@@ -140,6 +140,7 @@ STAGE PLANS:
                         1 key (type: int)
                       Position of Big Table: 0
                       Statistics: Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
+                      BucketMapJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
@@ -212,31 +213,27 @@ STAGE PLANS:
                 mode: mergepartial
                 outputColumnNames: _col0
                 Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
-                Select Operator
-                  expressions: _col0 (type: bigint)
-                  outputColumnNames: _col0
-                  Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
-                  File Output Operator
-                    compressed: false
-                    GlobalTableId: 0
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 0
 #### A masked pattern was here ####
-                    NumFilesPerFileSink: 1
-                    Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
+                  NumFilesPerFileSink: 1
+                  Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
 #### A masked pattern was here ####
-                    table:
-                        input format: org.apache.hadoop.mapred.TextInputFormat
-                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                        properties:
-                          columns _col0
-                          columns.types bigint
-                          escape.delim \
-                          hive.serialization.extend.additional.nesting.levels true
-                          serialization.format 1
-                          serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                    TotalFiles: 1
-                    GatherStats: false
-                    MultiFileSpray: false
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                      properties:
+                        columns _col0
+                        columns.types bigint
+                        escape.delim \
+                        hive.serialization.extend.additional.nesting.levels true
+                        serialization.format 1
+                        serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                  TotalFiles: 1
+                  GatherStats: false
+                  MultiFileSpray: false
 
   Stage: Stage-0
     Fetch Operator
diff --git a/ql/src/test/results/clientpositive/tez/auto_join0.q.out b/ql/src/test/results/clientpositive/tez/auto_join0.q.out
index 0b27ab372e..cea6f998c9 100644
--- a/ql/src/test/results/clientpositive/tez/auto_join0.q.out
+++ b/ql/src/test/results/clientpositive/tez/auto_join0.q.out
@@ -56,6 +56,7 @@ STAGE PLANS:
                         input vertices:
                           1 Map 4
                         Statistics: Num rows: 182 Data size: 1939 Basic stats: COMPLETE Column stats: NONE
+                        HybridGraceHashJoin: true
                         Reduce Output Operator
                           key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string)
                           sort order: ++++
diff --git a/ql/src/test/results/clientpositive/tez/auto_join1.q.out b/ql/src/test/results/clientpositive/tez/auto_join1.q.out
index 4dab4e3268..078d504f5d 100644
--- a/ql/src/test/results/clientpositive/tez/auto_join1.q.out
+++ b/ql/src/test/results/clientpositive/tez/auto_join1.q.out
@@ -49,6 +49,7 @@ STAGE PLANS:
                         input vertices:
                           1 Map 2
                         Statistics: Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
+                        HybridGraceHashJoin: true
                         Select Operator
                           expressions: UDFToInteger(_col2) (type: int), _col1 (type: string)
                           outputColumnNames: _col0, _col1
diff --git a/ql/src/test/results/clientpositive/tez/auto_join29.q.out b/ql/src/test/results/clientpositive/tez/auto_join29.q.out
index 10c8fcd407..2cab06e3cf 100644
--- a/ql/src/test/results/clientpositive/tez/auto_join29.q.out
+++ b/ql/src/test/results/clientpositive/tez/auto_join29.q.out
@@ -2713,6 +2713,7 @@ STAGE PLANS:
                       1 Map 3
                       2 Map 4
                     Statistics: Num rows: 1100 Data size: 11686 Basic stats: COMPLETE Column stats: NONE
+                    HybridGraceHashJoin: true
                     Select Operator
                       expressions: _col0 (type: string), _col1 (type: string), _col5 (type: string), _col6 (type: string), _col10 (type: string), _col11 (type: string)
                       outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
@@ -2834,6 +2835,7 @@ STAGE PLANS:
                         0 Map 1
                         2 Map 4
                       Statistics: Num rows: 365 Data size: 3878 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Select Operator
                         expressions: _col0 (type: string), _col1 (type: string), _col5 (type: string), _col6 (type: string), _col10 (type: string), _col11 (type: string)
                         outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
@@ -2945,6 +2947,7 @@ STAGE PLANS:
                         1 Map 3
                         2 Map 4
                       Statistics: Num rows: 121 Data size: 1284 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Select Operator
                         expressions: _col0 (type: string), _col1 (type: string), _col5 (type: string), _col6 (type: string), _col10 (type: string), _col11 (type: string)
                         outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
diff --git a/ql/src/test/results/clientpositive/tez/auto_join30.q.out b/ql/src/test/results/clientpositive/tez/auto_join30.q.out
index 27fe242d71..8c20985bd6 100644
--- a/ql/src/test/results/clientpositive/tez/auto_join30.q.out
+++ b/ql/src/test/results/clientpositive/tez/auto_join30.q.out
@@ -76,6 +76,7 @@ STAGE PLANS:
                   input vertices:
                     1 Reducer 5
                   Statistics: Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
+                  HybridGraceHashJoin: true
                   Group By Operator
                     aggregations: sum(hash(_col2,_col3))
                     mode: hash
@@ -209,6 +210,7 @@ STAGE PLANS:
                   input vertices:
                     1 Reducer 5
                   Statistics: Num rows: 550 Data size: 5843 Basic stats: COMPLETE Column stats: NONE
+                  HybridGraceHashJoin: true
                   Group By Operator
                     aggregations: sum(hash(_col2,_col3))
                     mode: hash
@@ -353,6 +355,7 @@ STAGE PLANS:
                   input vertices:
                     0 Reducer 2
                   Statistics: Num rows: 550 Data size: 5843 Basic stats: COMPLETE Column stats: NONE
+                  HybridGraceHashJoin: true
                   Group By Operator
                     aggregations: sum(hash(_col2,_col3))
                     mode: hash
@@ -507,6 +510,7 @@ STAGE PLANS:
                     1 Reducer 5
                     2 Reducer 7
                   Statistics: Num rows: 550 Data size: 5843 Basic stats: COMPLETE Column stats: NONE
+                  HybridGraceHashJoin: true
                   Group By Operator
                     aggregations: sum(hash(_col2,_col3))
                     mode: hash
diff --git a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_1.q.out b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_1.q.out
index f05295ebb1..a275d27cc0 100644
--- a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_1.q.out
+++ b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_1.q.out
@@ -244,6 +244,7 @@ STAGE PLANS:
                         0 Map 1
                       Position of Big Table: 1
                       Statistics: Num rows: 63 Data size: 6393 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
@@ -479,6 +480,7 @@ STAGE PLANS:
                         1 Map 3
                       Position of Big Table: 0
                       Statistics: Num rows: 63 Data size: 6393 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
@@ -784,6 +786,7 @@ STAGE PLANS:
                         1 Map 3
                       Position of Big Table: 0
                       Statistics: Num rows: 63 Data size: 6393 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
diff --git a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_10.q.out b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_10.q.out
index 3c128fa0a7..28268fcca1 100644
--- a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_10.q.out
+++ b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_10.q.out
@@ -97,6 +97,7 @@ STAGE PLANS:
                             1 _col0 (type: int)
                           input vertices:
                             1 Map 5
+                          HybridGraceHashJoin: true
                           Group By Operator
                             aggregations: count()
                             mode: hash
@@ -124,6 +125,7 @@ STAGE PLANS:
                             1 _col0 (type: int)
                           input vertices:
                             1 Map 5
+                          HybridGraceHashJoin: true
                           Group By Operator
                             aggregations: count()
                             mode: hash
@@ -276,6 +278,7 @@ STAGE PLANS:
                         input vertices:
                           0 Reducer 2
                         Statistics: Num rows: 3 Data size: 23 Basic stats: COMPLETE Column stats: NONE
+                        HybridGraceHashJoin: true
                         Group By Operator
                           aggregations: count()
                           mode: hash
diff --git a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_11.q.out b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_11.q.out
index a555700677..6ac74ca3d3 100644
--- a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_11.q.out
+++ b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_11.q.out
@@ -239,6 +239,7 @@ STAGE PLANS:
                         0 Map 1
                       Position of Big Table: 1
                       Statistics: Num rows: 63 Data size: 6393 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
@@ -549,6 +550,7 @@ STAGE PLANS:
                         0 Map 1
                       Position of Big Table: 1
                       Statistics: Num rows: 63 Data size: 6393 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
@@ -858,6 +860,7 @@ STAGE PLANS:
                         0 Map 1
                       Position of Big Table: 1
                       Statistics: Num rows: 63 Data size: 6393 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
@@ -1185,6 +1188,7 @@ STAGE PLANS:
                         2 Map 4
                       Position of Big Table: 1
                       Statistics: Num rows: 127 Data size: 12786 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
diff --git a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_12.q.out b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_12.q.out
index 7d66a04b74..8c8a3bfefa 100644
--- a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_12.q.out
+++ b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_12.q.out
@@ -308,6 +308,7 @@ STAGE PLANS:
                         0 Map 1
                       Position of Big Table: 1
                       Statistics: Num rows: 1 Data size: 125 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Reduce Output Operator
                         key expressions: _col6 (type: string), _col6 (type: string)
                         sort order: ++
@@ -389,6 +390,7 @@ STAGE PLANS:
                         0 Map 2
                       Position of Big Table: 1
                       Statistics: Num rows: 63 Data size: 6393 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Map Join Operator
                         condition map:
                              Inner Join 0 to 1
@@ -399,6 +401,7 @@ STAGE PLANS:
                           1 Map 5
                         Position of Big Table: 0
                         Statistics: Num rows: 69 Data size: 7032 Basic stats: COMPLETE Column stats: NONE
+                        HybridGraceHashJoin: true
                         Group By Operator
                           aggregations: count()
                           mode: hash
diff --git a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_13.q.out b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_13.q.out
index 936dae3718..c0f99cc248 100644
--- a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_13.q.out
+++ b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_13.q.out
@@ -105,6 +105,7 @@ STAGE PLANS:
                       input vertices:
                         1 Map 2
                       Statistics: Num rows: 5 Data size: 38 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Select Operator
                         expressions: _col0 (type: int), _col1 (type: string), _col5 (type: int), _col6 (type: string)
                         outputColumnNames: _col0, _col1, _col2, _col3
@@ -314,6 +315,7 @@ STAGE PLANS:
                       input vertices:
                         1 Map 2
                       Statistics: Num rows: 5 Data size: 38 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Select Operator
                         expressions: _col0 (type: int), _col1 (type: string), _col5 (type: int), _col6 (type: string)
                         outputColumnNames: _col0, _col1, _col2, _col3
@@ -523,6 +525,7 @@ STAGE PLANS:
                       input vertices:
                         1 Map 2
                       Statistics: Num rows: 5 Data size: 38 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Select Operator
                         expressions: _col0 (type: int), _col1 (type: string), _col5 (type: int), _col6 (type: string)
                         outputColumnNames: _col0, _col1, _col2, _col3
diff --git a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_14.q.out b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_14.q.out
index c6bf5b88c5..81b6fe6ce4 100644
--- a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_14.q.out
+++ b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_14.q.out
@@ -68,6 +68,7 @@ STAGE PLANS:
                     input vertices:
                       1 Map 3
                     Statistics: Num rows: 22 Data size: 176 Basic stats: COMPLETE Column stats: NONE
+                    HybridGraceHashJoin: true
                     Group By Operator
                       aggregations: count()
                       mode: hash
@@ -173,6 +174,7 @@ STAGE PLANS:
                     input vertices:
                       0 Map 1
                     Statistics: Num rows: 207 Data size: 2080 Basic stats: COMPLETE Column stats: NONE
+                    HybridGraceHashJoin: true
                     Group By Operator
                       aggregations: count()
                       mode: hash
diff --git a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_15.q.out b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_15.q.out
index 4a0c303860..5e30dffb33 100644
--- a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_15.q.out
+++ b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_15.q.out
@@ -66,6 +66,7 @@ STAGE PLANS:
                     input vertices:
                       1 Map 3
                     Statistics: Num rows: 22 Data size: 176 Basic stats: COMPLETE Column stats: NONE
+                    HybridGraceHashJoin: true
                     Group By Operator
                       aggregations: count()
                       mode: hash
@@ -148,6 +149,7 @@ STAGE PLANS:
                     input vertices:
                       0 Map 1
                     Statistics: Num rows: 22 Data size: 176 Basic stats: COMPLETE Column stats: NONE
+                    HybridGraceHashJoin: true
                     Group By Operator
                       aggregations: count()
                       mode: hash
diff --git a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_2.q.out b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_2.q.out
index 7997c4de7e..2cb8416760 100644
--- a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_2.q.out
+++ b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_2.q.out
@@ -154,6 +154,7 @@ STAGE PLANS:
                         1 Map 3
                       Position of Big Table: 0
                       Statistics: Num rows: 29 Data size: 3025 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
@@ -461,6 +462,7 @@ STAGE PLANS:
                         1 Map 3
                       Position of Big Table: 0
                       Statistics: Num rows: 29 Data size: 3025 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
diff --git a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_3.q.out b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_3.q.out
index d6ed0c5c99..abeceb8aa8 100644
--- a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_3.q.out
+++ b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_3.q.out
@@ -273,6 +273,7 @@ STAGE PLANS:
                         0 Map 1
                       Position of Big Table: 1
                       Statistics: Num rows: 31 Data size: 3196 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
@@ -459,6 +460,7 @@ STAGE PLANS:
                         1 Map 3
                       Position of Big Table: 0
                       Statistics: Num rows: 31 Data size: 3196 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
@@ -764,6 +766,7 @@ STAGE PLANS:
                         1 Map 3
                       Position of Big Table: 0
                       Statistics: Num rows: 31 Data size: 3196 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
diff --git a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_4.q.out b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_4.q.out
index 5fb23bbdfd..8eb9ce506a 100644
--- a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_4.q.out
+++ b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_4.q.out
@@ -289,6 +289,7 @@ STAGE PLANS:
                         0 Map 1
                       Position of Big Table: 1
                       Statistics: Num rows: 15 Data size: 1567 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
@@ -475,6 +476,7 @@ STAGE PLANS:
                         1 Map 3
                       Position of Big Table: 0
                       Statistics: Num rows: 15 Data size: 1567 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
@@ -780,6 +782,7 @@ STAGE PLANS:
                         1 Map 3
                       Position of Big Table: 0
                       Statistics: Num rows: 15 Data size: 1567 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
diff --git a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_5.q.out b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_5.q.out
index e285b28673..adcc1fa03e 100644
--- a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_5.q.out
+++ b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_5.q.out
@@ -591,6 +591,7 @@ STAGE PLANS:
                         1 Map 3
                       Position of Big Table: 0
                       Statistics: Num rows: 15 Data size: 1567 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
diff --git a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_7.q.out b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_7.q.out
index 5f8eacf0fe..2562cb0827 100644
--- a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_7.q.out
+++ b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_7.q.out
@@ -306,6 +306,7 @@ STAGE PLANS:
                         0 Map 1
                       Position of Big Table: 1
                       Statistics: Num rows: 29 Data size: 3025 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
@@ -543,6 +544,7 @@ STAGE PLANS:
                         1 Map 3
                       Position of Big Table: 0
                       Statistics: Num rows: 29 Data size: 3025 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
@@ -899,6 +901,7 @@ STAGE PLANS:
                         1 Map 3
                       Position of Big Table: 0
                       Statistics: Num rows: 29 Data size: 3025 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
diff --git a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_8.q.out b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_8.q.out
index 92eef8f879..31b0a97dd3 100644
--- a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_8.q.out
+++ b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_8.q.out
@@ -306,6 +306,7 @@ STAGE PLANS:
                         0 Map 1
                       Position of Big Table: 1
                       Statistics: Num rows: 63 Data size: 6393 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
@@ -543,6 +544,7 @@ STAGE PLANS:
                         1 Map 3
                       Position of Big Table: 0
                       Statistics: Num rows: 63 Data size: 6393 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
@@ -901,6 +903,7 @@ STAGE PLANS:
                         1 Map 3
                       Position of Big Table: 0
                       Statistics: Num rows: 63 Data size: 6393 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
diff --git a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_9.q.out b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_9.q.out
index 09199986f5..9f3e6989b1 100644
--- a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_9.q.out
+++ b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_9.q.out
@@ -83,6 +83,7 @@ STAGE PLANS:
                       input vertices:
                         1 Map 3
                       Statistics: Num rows: 5 Data size: 38 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
@@ -187,6 +188,7 @@ STAGE PLANS:
                       input vertices:
                         1 Map 3
                       Statistics: Num rows: 5 Data size: 38 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         keys: _col0 (type: int)
@@ -311,6 +313,7 @@ STAGE PLANS:
                       input vertices:
                         1 Map 4
                       Statistics: Num rows: 5 Data size: 38 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         keys: _col0 (type: int)
@@ -471,6 +474,7 @@ STAGE PLANS:
                       input vertices:
                         1 Map 3
                       Statistics: Num rows: 5 Data size: 38 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         keys: _col0 (type: int)
@@ -514,6 +518,7 @@ STAGE PLANS:
                       input vertices:
                         1 Map 6
                       Statistics: Num rows: 5 Data size: 38 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         keys: _col0 (type: int)
@@ -557,6 +562,7 @@ STAGE PLANS:
                   input vertices:
                     1 Reducer 5
                   Statistics: Num rows: 2 Data size: 16 Basic stats: COMPLETE Column stats: NONE
+                  HybridGraceHashJoin: true
                   Select Operator
                     expressions: _col0 (type: int), _col1 (type: bigint), _col3 (type: bigint)
                     outputColumnNames: _col0, _col1, _col2
@@ -684,6 +690,7 @@ STAGE PLANS:
                         input vertices:
                           1 Map 3
                         Statistics: Num rows: 3 Data size: 23 Basic stats: COMPLETE Column stats: NONE
+                        HybridGraceHashJoin: true
                         Group By Operator
                           aggregations: count()
                           mode: hash
@@ -824,6 +831,7 @@ STAGE PLANS:
                       input vertices:
                         0 Map 1
                       Statistics: Num rows: 5 Data size: 38 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
@@ -958,6 +966,7 @@ STAGE PLANS:
                         input vertices:
                           1 Map 3
                         Statistics: Num rows: 1 Data size: 7 Basic stats: COMPLETE Column stats: NONE
+                        HybridGraceHashJoin: true
                         Group By Operator
                           aggregations: count()
                           mode: hash
@@ -1099,6 +1108,7 @@ STAGE PLANS:
                         input vertices:
                           1 Map 3
                         Statistics: Num rows: 3 Data size: 23 Basic stats: COMPLETE Column stats: NONE
+                        HybridGraceHashJoin: true
                         Group By Operator
                           aggregations: count()
                           mode: hash
@@ -1216,6 +1226,7 @@ STAGE PLANS:
                         input vertices:
                           1 Map 3
                         Statistics: Num rows: 5 Data size: 38 Basic stats: COMPLETE Column stats: NONE
+                        HybridGraceHashJoin: true
                         Group By Operator
                           aggregations: count()
                           mode: hash
@@ -1342,6 +1353,7 @@ STAGE PLANS:
                       input vertices:
                         0 Map 1
                       Statistics: Num rows: 5 Data size: 38 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
@@ -1449,6 +1461,7 @@ STAGE PLANS:
                       input vertices:
                         1 Map 1
                       Statistics: Num rows: 5 Data size: 38 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
@@ -1556,6 +1569,7 @@ STAGE PLANS:
                           1 Map 3
                           2 Map 4
                         Statistics: Num rows: 6 Data size: 46 Basic stats: COMPLETE Column stats: NONE
+                        HybridGraceHashJoin: true
                         Group By Operator
                           aggregations: count()
                           mode: hash
@@ -1721,6 +1735,7 @@ STAGE PLANS:
                       input vertices:
                         0 Map 1
                       Statistics: Num rows: 5 Data size: 38 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
@@ -1823,6 +1838,7 @@ STAGE PLANS:
                       input vertices:
                         1 Map 3
                       Statistics: Num rows: 5 Data size: 38 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
@@ -1927,6 +1943,7 @@ STAGE PLANS:
                       input vertices:
                         1 Map 3
                       Statistics: Num rows: 5 Data size: 38 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         keys: _col0 (type: int)
@@ -2051,6 +2068,7 @@ STAGE PLANS:
                       input vertices:
                         1 Map 4
                       Statistics: Num rows: 5 Data size: 38 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         keys: _col0 (type: int)
@@ -2211,6 +2229,7 @@ STAGE PLANS:
                       input vertices:
                         1 Map 3
                       Statistics: Num rows: 5 Data size: 38 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         keys: _col0 (type: int)
@@ -2254,6 +2273,7 @@ STAGE PLANS:
                       input vertices:
                         1 Map 6
                       Statistics: Num rows: 5 Data size: 38 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         keys: _col0 (type: int)
@@ -2297,6 +2317,7 @@ STAGE PLANS:
                   input vertices:
                     1 Reducer 5
                   Statistics: Num rows: 2 Data size: 16 Basic stats: COMPLETE Column stats: NONE
+                  HybridGraceHashJoin: true
                   Select Operator
                     expressions: _col0 (type: int), _col1 (type: bigint), _col3 (type: bigint)
                     outputColumnNames: _col0, _col1, _col2
@@ -2424,6 +2445,7 @@ STAGE PLANS:
                         input vertices:
                           1 Map 3
                         Statistics: Num rows: 3 Data size: 23 Basic stats: COMPLETE Column stats: NONE
+                        HybridGraceHashJoin: true
                         Group By Operator
                           aggregations: count()
                           mode: hash
@@ -2564,6 +2586,7 @@ STAGE PLANS:
                       input vertices:
                         0 Map 1
                       Statistics: Num rows: 5 Data size: 38 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
@@ -2698,6 +2721,7 @@ STAGE PLANS:
                         input vertices:
                           1 Map 3
                         Statistics: Num rows: 1 Data size: 7 Basic stats: COMPLETE Column stats: NONE
+                        HybridGraceHashJoin: true
                         Group By Operator
                           aggregations: count()
                           mode: hash
@@ -2839,6 +2863,7 @@ STAGE PLANS:
                         input vertices:
                           1 Map 3
                         Statistics: Num rows: 3 Data size: 23 Basic stats: COMPLETE Column stats: NONE
+                        HybridGraceHashJoin: true
                         Group By Operator
                           aggregations: count()
                           mode: hash
@@ -2965,6 +2990,7 @@ STAGE PLANS:
                       input vertices:
                         0 Map 1
                       Statistics: Num rows: 5 Data size: 38 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
@@ -3072,6 +3098,7 @@ STAGE PLANS:
                       input vertices:
                         1 Map 1
                       Statistics: Num rows: 5 Data size: 38 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
@@ -3179,6 +3206,7 @@ STAGE PLANS:
                           1 Map 3
                           2 Map 4
                         Statistics: Num rows: 6 Data size: 46 Basic stats: COMPLETE Column stats: NONE
+                        HybridGraceHashJoin: true
                         Group By Operator
                           aggregations: count()
                           mode: hash
@@ -3344,6 +3372,7 @@ STAGE PLANS:
                       input vertices:
                         0 Map 1
                       Statistics: Num rows: 5 Data size: 38 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
diff --git a/ql/src/test/results/clientpositive/tez/bucket_map_join_tez1.q.out b/ql/src/test/results/clientpositive/tez/bucket_map_join_tez1.q.out
index 8ff9f7c43f..61c197f691 100644
--- a/ql/src/test/results/clientpositive/tez/bucket_map_join_tez1.q.out
+++ b/ql/src/test/results/clientpositive/tez/bucket_map_join_tez1.q.out
@@ -159,6 +159,7 @@ STAGE PLANS:
                       input vertices:
                         0 Map 1
                       Statistics: Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Select Operator
                         expressions: _col0 (type: int), _col1 (type: string), _col7 (type: string)
                         outputColumnNames: _col0, _col1, _col2
@@ -241,6 +242,7 @@ STAGE PLANS:
                       input vertices:
                         0 Reducer 2
                       Statistics: Num rows: 133 Data size: 1411 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Select Operator
                         expressions: _col1 (type: int), _col0 (type: double), _col3 (type: string)
                         outputColumnNames: _col0, _col1, _col2
@@ -317,6 +319,7 @@ STAGE PLANS:
                       input vertices:
                         1 Map 3
                       Statistics: Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: sum(substr(_col7, 5))
                         keys: _col6 (type: int)
@@ -379,6 +382,7 @@ STAGE PLANS:
                     input vertices:
                       1 Map 4
                     Statistics: Num rows: 150 Data size: 1600 Basic stats: COMPLETE Column stats: NONE
+                    HybridGraceHashJoin: true
                     Select Operator
                       expressions: _col1 (type: int), _col0 (type: double), _col3 (type: string)
                       outputColumnNames: _col0, _col1, _col2
@@ -438,6 +442,7 @@ STAGE PLANS:
                       input vertices:
                         1 Map 3
                       Statistics: Num rows: 133 Data size: 1411 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: sum(substr(_col1, 5))
                         keys: _col0 (type: int)
@@ -481,6 +486,7 @@ STAGE PLANS:
                       input vertices:
                         0 Reducer 2
                       Statistics: Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Select Operator
                         expressions: _col1 (type: int), _col0 (type: double), _col3 (type: string)
                         outputColumnNames: _col0, _col1, _col2
@@ -559,6 +565,7 @@ STAGE PLANS:
                         1 Map 2
                         2 Map 3
                       Statistics: Num rows: 550 Data size: 5843 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Select Operator
                         expressions: _col0 (type: int), _col1 (type: string), _col7 (type: string)
                         outputColumnNames: _col0, _col1, _col2
@@ -641,6 +648,7 @@ STAGE PLANS:
                       input vertices:
                         1 Map 2
                       Statistics: Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Map Join Operator
                         condition map:
                              Inner Join 0 to 1
@@ -651,6 +659,7 @@ STAGE PLANS:
                         input vertices:
                           1 Map 3
                         Statistics: Num rows: 302 Data size: 3213 Basic stats: COMPLETE Column stats: NONE
+                        HybridGraceHashJoin: true
                         Select Operator
                           expressions: _col0 (type: int), _col1 (type: string), _col3 (type: string)
                           outputColumnNames: _col0, _col1, _col2
@@ -758,6 +767,7 @@ STAGE PLANS:
                       input vertices:
                         0 Reducer 2
                       Statistics: Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Select Operator
                         expressions: _col0 (type: int), _col1 (type: double), _col3 (type: string)
                         outputColumnNames: _col0, _col1, _col2
@@ -844,6 +854,7 @@ STAGE PLANS:
                       input vertices:
                         0 Reducer 2
                       Statistics: Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Select Operator
                         expressions: _col0 (type: int), _col1 (type: double), _col3 (type: string)
                         outputColumnNames: _col0, _col1, _col2
@@ -929,6 +940,7 @@ STAGE PLANS:
                       input vertices:
                         0 Map 1
                       Statistics: Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Select Operator
                         expressions: _col0 (type: int), _col1 (type: string), _col7 (type: string)
                         outputColumnNames: _col0, _col1, _col2
@@ -1020,6 +1032,7 @@ STAGE PLANS:
                       input vertices:
                         0 Map 1
                       Statistics: Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Select Operator
                         expressions: _col0 (type: int), _col1 (type: string), _col6 (type: string)
                         outputColumnNames: _col0, _col1, _col2
@@ -1085,6 +1098,7 @@ STAGE PLANS:
                       input vertices:
                         0 Map 1
                       Statistics: Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Map Join Operator
                         condition map:
                              Inner Join 0 to 1
@@ -1095,6 +1109,7 @@ STAGE PLANS:
                         input vertices:
                           1 Map 3
                         Statistics: Num rows: 302 Data size: 3213 Basic stats: COMPLETE Column stats: NONE
+                        HybridGraceHashJoin: true
                         Select Operator
                           expressions: _col0 (type: int), _col12 (type: int)
                           outputColumnNames: _col0, _col1
@@ -1193,6 +1208,7 @@ STAGE PLANS:
                       input vertices:
                         0 Map 1
                       Statistics: Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Select Operator
                         expressions: _col0 (type: int), _col1 (type: string), _col7 (type: string)
                         outputColumnNames: _col0, _col1, _col2
diff --git a/ql/src/test/results/clientpositive/tez/bucket_map_join_tez2.q.out b/ql/src/test/results/clientpositive/tez/bucket_map_join_tez2.q.out
index 6773593f49..3f980b600d 100644
--- a/ql/src/test/results/clientpositive/tez/bucket_map_join_tez2.q.out
+++ b/ql/src/test/results/clientpositive/tez/bucket_map_join_tez2.q.out
@@ -155,6 +155,7 @@ STAGE PLANS:
                       input vertices:
                         0 Map 1
                       Statistics: Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Map Join Operator
                         condition map:
                              Inner Join 0 to 1
@@ -165,6 +166,7 @@ STAGE PLANS:
                         input vertices:
                           1 Map 3
                         Statistics: Num rows: 302 Data size: 3213 Basic stats: COMPLETE Column stats: NONE
+                        HybridGraceHashJoin: true
                         Select Operator
                           expressions: _col0 (type: int), _col12 (type: int)
                           outputColumnNames: _col0, _col1
@@ -270,6 +272,7 @@ STAGE PLANS:
                       input vertices:
                         0 Map 1
                       Statistics: Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Select Operator
                         expressions: _col0 (type: int), _col1 (type: string), _col6 (type: string)
                         outputColumnNames: _col0, _col1, _col2
@@ -327,6 +330,7 @@ STAGE PLANS:
                         input vertices:
                           1 Map 2
                         Statistics: Num rows: 182 Data size: 1939 Basic stats: COMPLETE Column stats: NONE
+                        HybridGraceHashJoin: true
                         File Output Operator
                           compressed: false
                           Statistics: Num rows: 182 Data size: 1939 Basic stats: COMPLETE Column stats: NONE
@@ -397,6 +401,7 @@ STAGE PLANS:
                         input vertices:
                           1 Map 2
                         Statistics: Num rows: 182 Data size: 1939 Basic stats: COMPLETE Column stats: NONE
+                        HybridGraceHashJoin: true
                         File Output Operator
                           compressed: false
                           Statistics: Num rows: 182 Data size: 1939 Basic stats: COMPLETE Column stats: NONE
@@ -484,6 +489,7 @@ STAGE PLANS:
                         input vertices:
                           0 Map 1
                         Statistics: Num rows: 182 Data size: 1939 Basic stats: COMPLETE Column stats: NONE
+                        HybridGraceHashJoin: true
                         File Output Operator
                           compressed: false
                           Statistics: Num rows: 182 Data size: 1939 Basic stats: COMPLETE Column stats: NONE
@@ -550,6 +556,7 @@ STAGE PLANS:
                       input vertices:
                         0 Reducer 2
                       Statistics: Num rows: 133 Data size: 1411 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       File Output Operator
                         compressed: false
                         Statistics: Num rows: 133 Data size: 1411 Basic stats: COMPLETE Column stats: NONE
@@ -628,6 +635,7 @@ STAGE PLANS:
                       input vertices:
                         0 Reducer 2
                       Statistics: Num rows: 133 Data size: 1411 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Select Operator
                         expressions: _col0 (type: string), _col2 (type: string)
                         outputColumnNames: _col0, _col1
diff --git a/ql/src/test/results/clientpositive/tez/correlationoptimizer1.q.out b/ql/src/test/results/clientpositive/tez/correlationoptimizer1.q.out
index ff8eafb4b6..444f93180c 100644
--- a/ql/src/test/results/clientpositive/tez/correlationoptimizer1.q.out
+++ b/ql/src/test/results/clientpositive/tez/correlationoptimizer1.q.out
@@ -351,6 +351,7 @@ STAGE PLANS:
                         input vertices:
                           1 Map 4
                         Statistics: Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
+                        HybridGraceHashJoin: true
                         Select Operator
                           expressions: _col1 (type: string)
                           outputColumnNames: _col0
diff --git a/ql/src/test/results/clientpositive/tez/cross_product_check_2.q.out b/ql/src/test/results/clientpositive/tez/cross_product_check_2.q.out
index d115044f5a..f732a8d7a0 100644
--- a/ql/src/test/results/clientpositive/tez/cross_product_check_2.q.out
+++ b/ql/src/test/results/clientpositive/tez/cross_product_check_2.q.out
@@ -59,6 +59,7 @@ STAGE PLANS:
                       input vertices:
                         1 Map 2
                       Statistics: Num rows: 550 Data size: 5843 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       File Output Operator
                         compressed: false
                         Statistics: Num rows: 550 Data size: 5843 Basic stats: COMPLETE Column stats: NONE
@@ -121,6 +122,7 @@ STAGE PLANS:
                       input vertices:
                         1 Map 2
                       Statistics: Num rows: 5 Data size: 57 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Reduce Output Operator
                         sort order: 
                         Statistics: Num rows: 5 Data size: 57 Basic stats: COMPLETE Column stats: NONE
@@ -154,6 +156,7 @@ STAGE PLANS:
                     input vertices:
                       0 Map 1
                     Statistics: Num rows: 550 Data size: 5843 Basic stats: COMPLETE Column stats: NONE
+                    HybridGraceHashJoin: true
                     Select Operator
                       expressions: _col0 (type: string), _col1 (type: string), _col5 (type: string), _col6 (type: string), _col10 (type: string), _col11 (type: string)
                       outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
@@ -214,6 +217,7 @@ STAGE PLANS:
                       input vertices:
                         1 Map 3
                       Statistics: Num rows: 5 Data size: 57 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         keys: _col0 (type: string)
                         mode: hash
@@ -252,6 +256,7 @@ STAGE PLANS:
                     input vertices:
                       1 Reducer 2
                     Statistics: Num rows: 550 Data size: 5843 Basic stats: COMPLETE Column stats: NONE
+                    HybridGraceHashJoin: true
                     Select Operator
                       expressions: _col0 (type: string), _col1 (type: string), _col5 (type: string)
                       outputColumnNames: _col0, _col1, _col2
@@ -315,6 +320,7 @@ STAGE PLANS:
                     input vertices:
                       1 Map 3
                     Statistics: Num rows: 11 Data size: 114 Basic stats: COMPLETE Column stats: NONE
+                    HybridGraceHashJoin: true
                     Group By Operator
                       keys: _col0 (type: string)
                       mode: hash
@@ -348,6 +354,7 @@ STAGE PLANS:
                     input vertices:
                       1 Reducer 2
                     Statistics: Num rows: 550 Data size: 5843 Basic stats: COMPLETE Column stats: NONE
+                    HybridGraceHashJoin: true
                     Select Operator
                       expressions: _col0 (type: string), _col1 (type: string), _col5 (type: string)
                       outputColumnNames: _col0, _col1, _col2
@@ -436,6 +443,7 @@ STAGE PLANS:
                       input vertices:
                         1 Map 5
                       Statistics: Num rows: 5 Data size: 57 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         keys: _col0 (type: string)
                         mode: hash
@@ -476,6 +484,7 @@ STAGE PLANS:
                   input vertices:
                     1 Reducer 4
                   Statistics: Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
+                  HybridGraceHashJoin: true
                   File Output Operator
                     compressed: false
                     Statistics: Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
diff --git a/ql/src/test/results/clientpositive/tez/dynamic_partition_pruning.q.out b/ql/src/test/results/clientpositive/tez/dynamic_partition_pruning.q.out
index 9a04fa2d21..8b3d6379a1 100644
--- a/ql/src/test/results/clientpositive/tez/dynamic_partition_pruning.q.out
+++ b/ql/src/test/results/clientpositive/tez/dynamic_partition_pruning.q.out
@@ -3344,6 +3344,7 @@ STAGE PLANS:
                     input vertices:
                       1 Map 3
                     Statistics: Num rows: 2200 Data size: 23372 Basic stats: COMPLETE Column stats: NONE
+                    HybridGraceHashJoin: true
                     Group By Operator
                       aggregations: count()
                       mode: hash
@@ -3470,6 +3471,7 @@ STAGE PLANS:
                     input vertices:
                       1 Map 3
                     Statistics: Num rows: 2200 Data size: 23372 Basic stats: COMPLETE Column stats: NONE
+                    HybridGraceHashJoin: true
                     Map Join Operator
                       condition map:
                            Inner Join 0 to 1
@@ -3479,6 +3481,7 @@ STAGE PLANS:
                       input vertices:
                         1 Map 4
                       Statistics: Num rows: 2420 Data size: 25709 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
@@ -3633,6 +3636,7 @@ STAGE PLANS:
                     input vertices:
                       1 Map 3
                     Statistics: Num rows: 2200 Data size: 23372 Basic stats: COMPLETE Column stats: NONE
+                    HybridGraceHashJoin: true
                     Group By Operator
                       aggregations: count()
                       mode: hash
@@ -3770,6 +3774,7 @@ STAGE PLANS:
                     input vertices:
                       1 Map 3
                     Statistics: Num rows: 2200 Data size: 23372 Basic stats: COMPLETE Column stats: NONE
+                    HybridGraceHashJoin: true
                     Group By Operator
                       aggregations: count()
                       mode: hash
@@ -3871,6 +3876,7 @@ STAGE PLANS:
                       input vertices:
                         1 Map 3
                       Statistics: Num rows: 1100 Data size: 11686 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
@@ -3983,6 +3989,7 @@ STAGE PLANS:
                       input vertices:
                         1 Map 3
                       Statistics: Num rows: 1100 Data size: 11686 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
@@ -4111,6 +4118,7 @@ STAGE PLANS:
                       input vertices:
                         1 Reducer 4
                       Statistics: Num rows: 1100 Data size: 11686 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
@@ -4233,6 +4241,7 @@ STAGE PLANS:
                     input vertices:
                       1 Map 3
                     Statistics: Num rows: 2200 Data size: 23372 Basic stats: COMPLETE Column stats: NONE
+                    HybridGraceHashJoin: true
                     Filter Operator
                       predicate: (_col8 = '2008-04-08') (type: boolean)
                       Statistics: Num rows: 1100 Data size: 11686 Basic stats: COMPLETE Column stats: NONE
@@ -4313,6 +4322,7 @@ STAGE PLANS:
                       input vertices:
                         1 Map 3
                       Statistics: Num rows: 2200 Data size: 23372 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
@@ -4472,6 +4482,7 @@ STAGE PLANS:
                     input vertices:
                       1 Map 3
                     Statistics: Num rows: 1100 Data size: 11686 Basic stats: COMPLETE Column stats: NONE
+                    HybridGraceHashJoin: true
                     Map Join Operator
                       condition map:
                            Inner Join 0 to 1
@@ -4481,6 +4492,7 @@ STAGE PLANS:
                       input vertices:
                         1 Map 4
                       Statistics: Num rows: 1210 Data size: 12854 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
@@ -4625,6 +4637,7 @@ STAGE PLANS:
                       input vertices:
                         1 Map 2
                       Statistics: Num rows: 0 Data size: 0 Basic stats: NONE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Reduce Output Operator
                         key expressions: '13' (type: string)
                         sort order: +
@@ -4662,6 +4675,7 @@ STAGE PLANS:
                       input vertices:
                         0 Map 1
                       Statistics: Num rows: 1 Data size: 5 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
@@ -4740,6 +4754,7 @@ STAGE PLANS:
                       input vertices:
                         1 Union 5
                       Statistics: Num rows: 2200 Data size: 23372 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         keys: _col0 (type: string)
                         mode: hash
@@ -4954,6 +4969,7 @@ STAGE PLANS:
                       input vertices:
                         1 Map 3
                       Statistics: Num rows: 1100 Data size: 103400 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
diff --git a/ql/src/test/results/clientpositive/tez/dynamic_partition_pruning_2.q.out b/ql/src/test/results/clientpositive/tez/dynamic_partition_pruning_2.q.out
index 51b08040e2..8c8531cedb 100644
--- a/ql/src/test/results/clientpositive/tez/dynamic_partition_pruning_2.q.out
+++ b/ql/src/test/results/clientpositive/tez/dynamic_partition_pruning_2.q.out
@@ -176,6 +176,7 @@ STAGE PLANS:
                     input vertices:
                       1 Map 4
                     Statistics: Num rows: 9 Data size: 29 Basic stats: COMPLETE Column stats: NONE
+                    HybridGraceHashJoin: true
                     Filter Operator
                       predicate: ((_col1 = _col5) and (_col6) IN ('foo', 'bar')) (type: boolean)
                       Statistics: Num rows: 2 Data size: 6 Basic stats: COMPLETE Column stats: NONE
@@ -337,6 +338,7 @@ STAGE PLANS:
                     input vertices:
                       1 Map 4
                     Statistics: Num rows: 9 Data size: 29 Basic stats: COMPLETE Column stats: NONE
+                    HybridGraceHashJoin: true
                     Filter Operator
                       predicate: ((_col1 = _col5) and (_col6) IN ('foo', 'bar')) (type: boolean)
                       Statistics: Num rows: 2 Data size: 6 Basic stats: COMPLETE Column stats: NONE
@@ -473,6 +475,7 @@ STAGE PLANS:
                     input vertices:
                       1 Map 2
                     Statistics: Num rows: 9 Data size: 29 Basic stats: COMPLETE Column stats: NONE
+                    HybridGraceHashJoin: true
                     Filter Operator
                       predicate: (_col1 = _col5) (type: boolean)
                       Statistics: Num rows: 4 Data size: 12 Basic stats: COMPLETE Column stats: NONE
@@ -579,6 +582,7 @@ STAGE PLANS:
                     input vertices:
                       1 Map 2
                     Statistics: Num rows: 3 Data size: 9 Basic stats: COMPLETE Column stats: NONE
+                    HybridGraceHashJoin: true
                     File Output Operator
                       compressed: false
                       Statistics: Num rows: 3 Data size: 9 Basic stats: COMPLETE Column stats: NONE
@@ -677,6 +681,7 @@ STAGE PLANS:
                     input vertices:
                       1 Map 4
                     Statistics: Num rows: 9 Data size: 29 Basic stats: COMPLETE Column stats: NONE
+                    HybridGraceHashJoin: true
                     Filter Operator
                       predicate: ((_col1 = _col5) and (_col6) IN ('foo', 'bar')) (type: boolean)
                       Statistics: Num rows: 2 Data size: 6 Basic stats: COMPLETE Column stats: NONE
@@ -827,6 +832,7 @@ STAGE PLANS:
                     outputColumnNames: _col0, _col1, _col5
                     input vertices:
                       1 Map 3
+                    HybridGraceHashJoin: true
                     Filter Operator
                       predicate: (_col1 = _col5) (type: boolean)
                       Select Operator
@@ -881,6 +887,7 @@ STAGE PLANS:
                     outputColumnNames: _col0, _col1, _col5
                     input vertices:
                       1 Map 5
+                    HybridGraceHashJoin: true
                     Filter Operator
                       predicate: (_col1 = _col5) (type: boolean)
                       Select Operator
diff --git a/ql/src/test/results/clientpositive/tez/hybridhashjoin.q.out b/ql/src/test/results/clientpositive/tez/hybridhashjoin.q.out
index 842ba034bb..5d5b850dde 100644
--- a/ql/src/test/results/clientpositive/tez/hybridhashjoin.q.out
+++ b/ql/src/test/results/clientpositive/tez/hybridhashjoin.q.out
@@ -168,6 +168,7 @@ STAGE PLANS:
                         input vertices:
                           1 Map 3
                         Statistics: Num rows: 4505 Data size: 968719 Basic stats: COMPLETE Column stats: NONE
+                        HybridGraceHashJoin: true
                         Group By Operator
                           aggregations: count()
                           mode: hash
@@ -398,6 +399,7 @@ STAGE PLANS:
                         input vertices:
                           1 Map 3
                         Statistics: Num rows: 6758 Data size: 1453080 Basic stats: COMPLETE Column stats: NONE
+                        HybridGraceHashJoin: true
                         Group By Operator
                           aggregations: count()
                           mode: hash
@@ -615,6 +617,7 @@ STAGE PLANS:
                       input vertices:
                         1 Map 3
                       Statistics: Num rows: 13516 Data size: 2906160 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
@@ -864,6 +867,7 @@ STAGE PLANS:
                       input vertices:
                         1 Map 3
                       Statistics: Num rows: 289 Data size: 6872 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
@@ -1082,6 +1086,7 @@ STAGE PLANS:
                       input vertices:
                         1 Map 3
                       Statistics: Num rows: 289 Data size: 6872 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
@@ -1402,6 +1407,7 @@ STAGE PLANS:
                       input vertices:
                         1 Map 2
                       Statistics: Num rows: 6758 Data size: 1190783 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Select Operator
                         expressions: 6981 (type: int), 6981 (type: int), _col1 (type: decimal(20,10)), _col9 (type: decimal(23,14))
                         outputColumnNames: _col0, _col1, _col2, _col3
diff --git a/ql/src/test/results/clientpositive/tez/lvj_mapjoin.q.out b/ql/src/test/results/clientpositive/tez/lvj_mapjoin.q.out
index 7268bae3aa..0a6be5f199 100644
--- a/ql/src/test/results/clientpositive/tez/lvj_mapjoin.q.out
+++ b/ql/src/test/results/clientpositive/tez/lvj_mapjoin.q.out
@@ -144,6 +144,7 @@ STAGE PLANS:
                               input vertices:
                                 1 Map 2
                               Statistics: Num rows: 4 Data size: 57 Basic stats: COMPLETE Column stats: NONE
+                              HybridGraceHashJoin: true
                               Filter Operator
                                 predicate: (_col0 = _col2) (type: boolean)
                                 Statistics: Num rows: 2 Data size: 28 Basic stats: COMPLETE Column stats: NONE
@@ -182,6 +183,7 @@ STAGE PLANS:
                                 input vertices:
                                   1 Map 2
                                 Statistics: Num rows: 4 Data size: 57 Basic stats: COMPLETE Column stats: NONE
+                                HybridGraceHashJoin: true
                                 Filter Operator
                                   predicate: (_col0 = _col2) (type: boolean)
                                   Statistics: Num rows: 2 Data size: 28 Basic stats: COMPLETE Column stats: NONE
diff --git a/ql/src/test/results/clientpositive/tez/mapjoin_decimal.q.out b/ql/src/test/results/clientpositive/tez/mapjoin_decimal.q.out
index 7c968ae651..e9766db033 100644
--- a/ql/src/test/results/clientpositive/tez/mapjoin_decimal.q.out
+++ b/ql/src/test/results/clientpositive/tez/mapjoin_decimal.q.out
@@ -111,6 +111,7 @@ STAGE PLANS:
                       input vertices:
                         1 Map 2
                       Statistics: Num rows: 577 Data size: 64680 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Select Operator
                         expressions: _col0 (type: decimal(4,2)), _col4 (type: decimal(4,0))
                         outputColumnNames: _col0, _col1
diff --git a/ql/src/test/results/clientpositive/tez/mapjoin_mapjoin.q.out b/ql/src/test/results/clientpositive/tez/mapjoin_mapjoin.q.out
index fb34588db2..f2610ded5e 100644
--- a/ql/src/test/results/clientpositive/tez/mapjoin_mapjoin.q.out
+++ b/ql/src/test/results/clientpositive/tez/mapjoin_mapjoin.q.out
@@ -162,6 +162,7 @@ STAGE PLANS:
                           1 Map 3
                         Position of Big Table: 0
                         Statistics: Num rows: 550 Data size: 5843 Basic stats: COMPLETE Column stats: NONE
+                        HybridGraceHashJoin: true
                         Map Join Operator
                           condition map:
                                Inner Join 0 to 1
@@ -174,6 +175,7 @@ STAGE PLANS:
                             0 Map 1
                           Position of Big Table: 1
                           Statistics: Num rows: 605 Data size: 6427 Basic stats: COMPLETE Column stats: NONE
+                          HybridGraceHashJoin: true
                           Select Operator
                             expressions: _col1 (type: string)
                             outputColumnNames: _col0
@@ -524,6 +526,7 @@ STAGE PLANS:
                         input vertices:
                           1 Map 3
                         Statistics: Num rows: 183 Data size: 1951 Basic stats: COMPLETE Column stats: NONE
+                        HybridGraceHashJoin: true
                         Map Join Operator
                           condition map:
                                Inner Join 0 to 1
@@ -534,6 +537,7 @@ STAGE PLANS:
                           input vertices:
                             0 Map 1
                           Statistics: Num rows: 201 Data size: 2146 Basic stats: COMPLETE Column stats: NONE
+                          HybridGraceHashJoin: true
                           Select Operator
                             expressions: _col1 (type: string)
                             outputColumnNames: _col0
@@ -609,6 +613,7 @@ STAGE PLANS:
                         input vertices:
                           1 Map 3
                         Statistics: Num rows: 550 Data size: 5843 Basic stats: COMPLETE Column stats: NONE
+                        HybridGraceHashJoin: true
                         Map Join Operator
                           condition map:
                                Inner Join 0 to 1
@@ -619,6 +624,7 @@ STAGE PLANS:
                           input vertices:
                             1 Map 4
                           Statistics: Num rows: 605 Data size: 6427 Basic stats: COMPLETE Column stats: NONE
+                          HybridGraceHashJoin: true
                           Select Operator
                             expressions: _col2 (type: string)
                             outputColumnNames: _col0
diff --git a/ql/src/test/results/clientpositive/tez/mrr.q.out b/ql/src/test/results/clientpositive/tez/mrr.q.out
index e7a3b3ca4d..ac5ac5cc15 100644
--- a/ql/src/test/results/clientpositive/tez/mrr.q.out
+++ b/ql/src/test/results/clientpositive/tez/mrr.q.out
@@ -853,6 +853,7 @@ STAGE PLANS:
                         input vertices:
                           1 Map 4
                         Statistics: Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
+                        HybridGraceHashJoin: true
                         Group By Operator
                           aggregations: count(DISTINCT _col1)
                           keys: _col0 (type: string), _col1 (type: string)
@@ -1693,6 +1694,7 @@ STAGE PLANS:
                         input vertices:
                           1 Reducer 4
                         Statistics: Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
+                        HybridGraceHashJoin: true
                         Select Operator
                           expressions: _col0 (type: string), _col3 (type: bigint), _col1 (type: string)
                           outputColumnNames: _col0, _col1, _col3
diff --git a/ql/src/test/results/clientpositive/tez/tez_bmj_schema_evolution.q.out b/ql/src/test/results/clientpositive/tez/tez_bmj_schema_evolution.q.out
index d138885ee3..b31a403373 100644
--- a/ql/src/test/results/clientpositive/tez/tez_bmj_schema_evolution.q.out
+++ b/ql/src/test/results/clientpositive/tez/tez_bmj_schema_evolution.q.out
@@ -100,6 +100,7 @@ STAGE PLANS:
                       input vertices:
                         1 Map 3
                       Statistics: Num rows: 550 Data size: 28771 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Reduce Output Operator
                         key expressions: _col0 (type: int)
                         sort order: +
diff --git a/ql/src/test/results/clientpositive/tez/tez_join_hash.q.out b/ql/src/test/results/clientpositive/tez/tez_join_hash.q.out
index bf60681381..c4bec62da3 100644
--- a/ql/src/test/results/clientpositive/tez/tez_join_hash.q.out
+++ b/ql/src/test/results/clientpositive/tez/tez_join_hash.q.out
@@ -196,6 +196,7 @@ STAGE PLANS:
                         outputColumnNames: _col0, _col1
                         input vertices:
                           1 Map 7
+                        HybridGraceHashJoin: true
                         Group By Operator
                           aggregations: count()
                           keys: _col0 (type: string), _col1 (type: string)
@@ -249,6 +250,7 @@ STAGE PLANS:
                     outputColumnNames: _col0, _col1
                     input vertices:
                       1 Map 7
+                    HybridGraceHashJoin: true
                     Group By Operator
                       aggregations: count()
                       keys: _col0 (type: string), _col1 (type: string)
diff --git a/ql/src/test/results/clientpositive/tez/tez_smb_main.q.out b/ql/src/test/results/clientpositive/tez/tez_smb_main.q.out
index f0bcea61e5..61833907d4 100644
--- a/ql/src/test/results/clientpositive/tez/tez_smb_main.q.out
+++ b/ql/src/test/results/clientpositive/tez/tez_smb_main.q.out
@@ -282,6 +282,7 @@ STAGE PLANS:
                       input vertices:
                         0 Map 1
                       Statistics: Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
@@ -379,6 +380,7 @@ STAGE PLANS:
                       input vertices:
                         0 Map 1
                       Statistics: Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
@@ -476,6 +478,7 @@ STAGE PLANS:
                       input vertices:
                         0 Map 1
                       Statistics: Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
@@ -571,6 +574,7 @@ STAGE PLANS:
                       input vertices:
                         0 Map 1
                       Statistics: Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Map Join Operator
                         condition map:
                              Inner Join 0 to 1
@@ -580,6 +584,7 @@ STAGE PLANS:
                         input vertices:
                           1 Map 4
                         Statistics: Num rows: 302 Data size: 3213 Basic stats: COMPLETE Column stats: NONE
+                        HybridGraceHashJoin: true
                         Group By Operator
                           aggregations: count()
                           mode: hash
@@ -899,6 +904,7 @@ STAGE PLANS:
                       input vertices:
                         0 Map 1
                       Statistics: Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
@@ -992,6 +998,7 @@ STAGE PLANS:
                       input vertices:
                         0 Map 1
                       Statistics: Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Map Join Operator
                         condition map:
                              Inner Join 0 to 1
@@ -1001,6 +1008,7 @@ STAGE PLANS:
                         input vertices:
                           1 Map 4
                         Statistics: Num rows: 302 Data size: 3213 Basic stats: COMPLETE Column stats: NONE
+                        HybridGraceHashJoin: true
                         Group By Operator
                           aggregations: count()
                           mode: hash
@@ -1101,6 +1109,7 @@ STAGE PLANS:
                       outputColumnNames: _col0
                       input vertices:
                         1 Map 4
+                      HybridGraceHashJoin: true
                       Map Join Operator
                         condition map:
                              Inner Join 0 to 1
@@ -1109,6 +1118,7 @@ STAGE PLANS:
                           1 key (type: int)
                         input vertices:
                           1 Map 6
+                        HybridGraceHashJoin: true
                         Group By Operator
                           aggregations: count()
                           mode: hash
@@ -1146,6 +1156,7 @@ STAGE PLANS:
                           1 key (type: int)
                         input vertices:
                           1 Map 6
+                        HybridGraceHashJoin: true
                         Group By Operator
                           aggregations: count()
                           mode: hash
@@ -1284,6 +1295,7 @@ STAGE PLANS:
                   input vertices:
                     0 Reducer 2
                   Statistics: Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
+                  HybridGraceHashJoin: true
                   Filter Operator
                     predicate: (_col0 = _col1) (type: boolean)
                     Statistics: Num rows: 137 Data size: 1455 Basic stats: COMPLETE Column stats: NONE
diff --git a/ql/src/test/results/clientpositive/tez/tez_union.q.out b/ql/src/test/results/clientpositive/tez/tez_union.q.out
index 6f6e8cab6e..4c9368ee05 100644
--- a/ql/src/test/results/clientpositive/tez/tez_union.q.out
+++ b/ql/src/test/results/clientpositive/tez/tez_union.q.out
@@ -38,6 +38,7 @@ STAGE PLANS:
                         outputColumnNames: _col0, _col1
                         input vertices:
                           1 Map 3
+                        HybridGraceHashJoin: true
                         File Output Operator
                           compressed: false
                           table:
@@ -327,6 +328,7 @@ STAGE PLANS:
                         outputColumnNames: _col0, _col1
                         input vertices:
                           1 Map 4
+                        HybridGraceHashJoin: true
                         Select Operator
                           expressions: _col1 (type: string), _col0 (type: string)
                           outputColumnNames: _col0, _col1
@@ -354,6 +356,7 @@ STAGE PLANS:
                         outputColumnNames: _col0, _col1
                         input vertices:
                           1 Map 4
+                        HybridGraceHashJoin: true
                         Select Operator
                           expressions: _col1 (type: string), _col0 (type: string)
                           outputColumnNames: _col0, _col1
@@ -494,6 +497,7 @@ STAGE PLANS:
                         outputColumnNames: _col0
                         input vertices:
                           1 Map 4
+                        HybridGraceHashJoin: true
                         Map Join Operator
                           condition map:
                                Inner Join 0 to 1
@@ -506,6 +510,7 @@ STAGE PLANS:
                           input vertices:
                             1 Map 9
                             2 Map 10
+                          HybridGraceHashJoin: true
                           Select Operator
                             expressions: _col1 (type: string), _col0 (type: string), _col2 (type: string)
                             outputColumnNames: _col0, _col1, _col2
@@ -575,6 +580,7 @@ STAGE PLANS:
                         outputColumnNames: _col0
                         input vertices:
                           1 Map 6
+                        HybridGraceHashJoin: true
                         Map Join Operator
                           condition map:
                                Inner Join 0 to 1
@@ -587,6 +593,7 @@ STAGE PLANS:
                           input vertices:
                             1 Map 9
                             2 Map 10
+                          HybridGraceHashJoin: true
                           Select Operator
                             expressions: _col1 (type: string), _col0 (type: string), _col2 (type: string)
                             outputColumnNames: _col0, _col1, _col2
@@ -629,6 +636,7 @@ STAGE PLANS:
                         outputColumnNames: _col0
                         input vertices:
                           1 Map 8
+                        HybridGraceHashJoin: true
                         Map Join Operator
                           condition map:
                                Inner Join 0 to 1
@@ -641,6 +649,7 @@ STAGE PLANS:
                           input vertices:
                             1 Map 9
                             2 Map 10
+                          HybridGraceHashJoin: true
                           Select Operator
                             expressions: _col1 (type: string), _col0 (type: string), _col2 (type: string)
                             outputColumnNames: _col0, _col1, _col2
@@ -892,6 +901,7 @@ STAGE PLANS:
                         outputColumnNames: _col0
                         input vertices:
                           1 Map 3
+                        HybridGraceHashJoin: true
                         File Output Operator
                           compressed: false
                           table:
@@ -933,6 +943,7 @@ STAGE PLANS:
                         outputColumnNames: _col0
                         input vertices:
                           1 Map 5
+                        HybridGraceHashJoin: true
                         File Output Operator
                           compressed: false
                           table:
@@ -1063,6 +1074,7 @@ STAGE PLANS:
                       outputColumnNames: _col0, _col1, _col2, _col3
                       input vertices:
                         1 Map 4
+                      HybridGraceHashJoin: true
                       File Output Operator
                         compressed: false
                         table:
@@ -1085,6 +1097,7 @@ STAGE PLANS:
                       outputColumnNames: _col0, _col1, _col2, _col3
                       input vertices:
                         1 Map 4
+                      HybridGraceHashJoin: true
                       File Output Operator
                         compressed: false
                         table:
@@ -1185,6 +1198,7 @@ STAGE PLANS:
                       input vertices:
                         0 Union 2
                       Statistics: Num rows: 1100 Data size: 11686 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       File Output Operator
                         compressed: false
                         Statistics: Num rows: 1100 Data size: 11686 Basic stats: COMPLETE Column stats: NONE
diff --git a/ql/src/test/results/clientpositive/tez/unionDistinct_1.q.out b/ql/src/test/results/clientpositive/tez/unionDistinct_1.q.out
index 49fbc1b484..9940e4bb4d 100644
--- a/ql/src/test/results/clientpositive/tez/unionDistinct_1.q.out
+++ b/ql/src/test/results/clientpositive/tez/unionDistinct_1.q.out
@@ -6452,6 +6452,7 @@ STAGE PLANS:
                       input vertices:
                         1 Map 4
                       Position of Big Table: 0
+                      HybridGraceHashJoin: true
                       Select Operator
                         expressions: _col0 (type: string), _col1 (type: string), _col11 (type: string), _col12 (type: string)
                         outputColumnNames: _col0, _col1, _col2, _col3
@@ -8372,6 +8373,7 @@ STAGE PLANS:
                       input vertices:
                         1 Map 8
                       Position of Big Table: 0
+                      HybridGraceHashJoin: true
                       Select Operator
                         expressions: _col0 (type: string), _col6 (type: bigint)
                         outputColumnNames: _col0, _col1
@@ -8923,6 +8925,7 @@ STAGE PLANS:
                         1 Map 9
                       Position of Big Table: 0
                       Statistics: Num rows: 113 Data size: 543 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count(1)
                         keys: _col0 (type: string)
@@ -9441,6 +9444,7 @@ STAGE PLANS:
                       outputColumnNames: _col0, _col1
                       input vertices:
                         1 Map 4
+                      HybridGraceHashJoin: true
                       Group By Operator
                         keys: _col0 (type: string), _col1 (type: string)
                         mode: hash
@@ -10723,6 +10727,7 @@ STAGE PLANS:
                       input vertices:
                         1 Reducer 3
                       Statistics: Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Select Operator
                         expressions: '97' (type: string), _col6 (type: string)
                         outputColumnNames: _col0, _col1
@@ -12904,6 +12909,7 @@ STAGE PLANS:
                       outputColumnNames: _col0
                       input vertices:
                         1 Map 4
+                      HybridGraceHashJoin: true
                       Select Operator
                         expressions: UDFToDouble(UDFToLong(_col0)) (type: double)
                         outputColumnNames: _col0
@@ -13045,6 +13051,7 @@ STAGE PLANS:
                       outputColumnNames: _col0
                       input vertices:
                         1 Map 5
+                      HybridGraceHashJoin: true
                       Select Operator
                         expressions: UDFToDouble(UDFToLong(_col0)) (type: double)
                         outputColumnNames: _col0
@@ -13156,6 +13163,7 @@ STAGE PLANS:
                       outputColumnNames: _col0, _col5
                       input vertices:
                         1 Map 4
+                      HybridGraceHashJoin: true
                       Select Operator
                         expressions: UDFToDouble(UDFToLong(_col0)) (type: double), UDFToString(UDFToDouble(_col5)) (type: string)
                         outputColumnNames: _col0, _col1
@@ -13303,6 +13311,7 @@ STAGE PLANS:
                       outputColumnNames: _col0, _col5
                       input vertices:
                         1 Map 5
+                      HybridGraceHashJoin: true
                       Select Operator
                         expressions: UDFToDouble(UDFToLong(_col0)) (type: double), UDFToDouble(_col5) (type: double)
                         outputColumnNames: _col0, _col1
@@ -13826,6 +13835,7 @@ STAGE PLANS:
                         outputColumnNames: _col0, _col1
                         input vertices:
                           1 Map 5
+                        HybridGraceHashJoin: true
                         Group By Operator
                           keys: _col0 (type: string), _col1 (type: string)
                           mode: hash
diff --git a/ql/src/test/results/clientpositive/tez/vector_char_mapjoin1.q.out b/ql/src/test/results/clientpositive/tez/vector_char_mapjoin1.q.out
index 1484d6fb75..b01469903f 100644
--- a/ql/src/test/results/clientpositive/tez/vector_char_mapjoin1.q.out
+++ b/ql/src/test/results/clientpositive/tez/vector_char_mapjoin1.q.out
@@ -154,6 +154,7 @@ STAGE PLANS:
                       input vertices:
                         1 Map 3
                       Statistics: Num rows: 2 Data size: 215 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Select Operator
                         expressions: _col0 (type: int), _col1 (type: char(10)), _col5 (type: int), _col6 (type: char(10))
                         outputColumnNames: _col0, _col1, _col2, _col3
@@ -264,6 +265,7 @@ STAGE PLANS:
                       input vertices:
                         0 Map 1
                       Statistics: Num rows: 2 Data size: 215 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Select Operator
                         expressions: _col0 (type: int), _col1 (type: char(10)), _col5 (type: int), _col6 (type: char(20))
                         outputColumnNames: _col0, _col1, _col2, _col3
@@ -346,6 +348,7 @@ STAGE PLANS:
                       input vertices:
                         1 Map 3
                       Statistics: Num rows: 2 Data size: 215 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Select Operator
                         expressions: _col0 (type: int), _col1 (type: char(10)), _col5 (type: int), _col6 (type: string)
                         outputColumnNames: _col0, _col1, _col2, _col3
diff --git a/ql/src/test/results/clientpositive/tez/vector_decimal_mapjoin.q.out b/ql/src/test/results/clientpositive/tez/vector_decimal_mapjoin.q.out
index fc72adae97..f418ae0ee9 100644
--- a/ql/src/test/results/clientpositive/tez/vector_decimal_mapjoin.q.out
+++ b/ql/src/test/results/clientpositive/tez/vector_decimal_mapjoin.q.out
@@ -59,6 +59,7 @@ STAGE PLANS:
                       input vertices:
                         1 Map 2
                       Statistics: Num rows: 6758 Data size: 1190783 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Select Operator
                         expressions: 6981 (type: int), 6981 (type: int), _col1 (type: decimal(20,10)), _col9 (type: decimal(23,14))
                         outputColumnNames: _col0, _col1, _col2, _col3
diff --git a/ql/src/test/results/clientpositive/tez/vector_left_outer_join.q.out b/ql/src/test/results/clientpositive/tez/vector_left_outer_join.q.out
index ce722e8d77..5fc05ea8c5 100644
--- a/ql/src/test/results/clientpositive/tez/vector_left_outer_join.q.out
+++ b/ql/src/test/results/clientpositive/tez/vector_left_outer_join.q.out
@@ -47,6 +47,7 @@ STAGE PLANS:
                       input vertices:
                         1 Map 3
                       Statistics: Num rows: 13516 Data size: 2906160 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Map Join Operator
                         condition map:
                              Left Outer Join0 to 1
@@ -56,6 +57,7 @@ STAGE PLANS:
                         input vertices:
                           1 Map 4
                         Statistics: Num rows: 14867 Data size: 3196776 Basic stats: COMPLETE Column stats: NONE
+                        HybridGraceHashJoin: true
                         Group By Operator
                           aggregations: count()
                           mode: hash
diff --git a/ql/src/test/results/clientpositive/tez/vector_mapjoin_reduce.q.out b/ql/src/test/results/clientpositive/tez/vector_mapjoin_reduce.q.out
index 053cda456e..29b86bdf33 100644
--- a/ql/src/test/results/clientpositive/tez/vector_mapjoin_reduce.q.out
+++ b/ql/src/test/results/clientpositive/tez/vector_mapjoin_reduce.q.out
@@ -56,6 +56,7 @@ STAGE PLANS:
                         input vertices:
                           1 Map 2
                         Statistics: Num rows: 27 Data size: 3298 Basic stats: COMPLETE Column stats: NONE
+                        HybridGraceHashJoin: true
                         Map Join Operator
                           condition map:
                                Inner Join 0 to 1
@@ -66,6 +67,7 @@ STAGE PLANS:
                           input vertices:
                             1 Reducer 4
                           Statistics: Num rows: 29 Data size: 3627 Basic stats: COMPLETE Column stats: NONE
+                          HybridGraceHashJoin: true
                           Select Operator
                             expressions: _col1 (type: int), _col2 (type: int)
                             outputColumnNames: _col0, _col1
@@ -213,6 +215,7 @@ STAGE PLANS:
                         input vertices:
                           1 Map 2
                         Statistics: Num rows: 14 Data size: 1714 Basic stats: COMPLETE Column stats: NONE
+                        HybridGraceHashJoin: true
                         Reduce Output Operator
                           key expressions: _col1 (type: int)
                           sort order: +
@@ -280,6 +283,7 @@ STAGE PLANS:
                   input vertices:
                     0 Map 1
                   Statistics: Num rows: 27 Data size: 3298 Basic stats: COMPLETE Column stats: NONE
+                  HybridGraceHashJoin: true
                   Select Operator
                     expressions: _col1 (type: int), _col2 (type: int)
                     outputColumnNames: _col0, _col1
diff --git a/ql/src/test/results/clientpositive/tez/vector_varchar_mapjoin1.q.out b/ql/src/test/results/clientpositive/tez/vector_varchar_mapjoin1.q.out
index 2698aecc75..ae5be449f2 100644
--- a/ql/src/test/results/clientpositive/tez/vector_varchar_mapjoin1.q.out
+++ b/ql/src/test/results/clientpositive/tez/vector_varchar_mapjoin1.q.out
@@ -154,6 +154,7 @@ STAGE PLANS:
                       input vertices:
                         1 Map 3
                       Statistics: Num rows: 2 Data size: 200 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Select Operator
                         expressions: _col0 (type: int), _col1 (type: varchar(10)), _col5 (type: int), _col6 (type: varchar(10))
                         outputColumnNames: _col0, _col1, _col2, _col3
@@ -247,6 +248,7 @@ STAGE PLANS:
                       input vertices:
                         1 Map 3
                       Statistics: Num rows: 2 Data size: 200 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Select Operator
                         expressions: _col0 (type: int), _col1 (type: varchar(10)), _col5 (type: int), _col6 (type: varchar(20))
                         outputColumnNames: _col0, _col1, _col2, _col3
@@ -342,6 +344,7 @@ STAGE PLANS:
                       input vertices:
                         1 Map 3
                       Statistics: Num rows: 2 Data size: 200 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Select Operator
                         expressions: _col0 (type: int), _col1 (type: varchar(10)), _col5 (type: int), _col6 (type: string)
                         outputColumnNames: _col0, _col1, _col2, _col3
diff --git a/ql/src/test/results/clientpositive/tez/vectorized_dynamic_partition_pruning.q.out b/ql/src/test/results/clientpositive/tez/vectorized_dynamic_partition_pruning.q.out
index a8b25dba66..fd6c629a50 100644
--- a/ql/src/test/results/clientpositive/tez/vectorized_dynamic_partition_pruning.q.out
+++ b/ql/src/test/results/clientpositive/tez/vectorized_dynamic_partition_pruning.q.out
@@ -3382,6 +3382,7 @@ STAGE PLANS:
                     input vertices:
                       1 Map 3
                     Statistics: Num rows: 2200 Data size: 23372 Basic stats: COMPLETE Column stats: NONE
+                    HybridGraceHashJoin: true
                     Group By Operator
                       aggregations: count()
                       mode: hash
@@ -3510,6 +3511,7 @@ STAGE PLANS:
                     input vertices:
                       1 Map 3
                     Statistics: Num rows: 2200 Data size: 23372 Basic stats: COMPLETE Column stats: NONE
+                    HybridGraceHashJoin: true
                     Map Join Operator
                       condition map:
                            Inner Join 0 to 1
@@ -3519,6 +3521,7 @@ STAGE PLANS:
                       input vertices:
                         1 Map 4
                       Statistics: Num rows: 2420 Data size: 25709 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
@@ -3675,6 +3678,7 @@ STAGE PLANS:
                     input vertices:
                       1 Map 3
                     Statistics: Num rows: 2200 Data size: 23372 Basic stats: COMPLETE Column stats: NONE
+                    HybridGraceHashJoin: true
                     Group By Operator
                       aggregations: count()
                       mode: hash
@@ -3813,6 +3817,7 @@ STAGE PLANS:
                     input vertices:
                       1 Map 3
                     Statistics: Num rows: 2200 Data size: 23372 Basic stats: COMPLETE Column stats: NONE
+                    HybridGraceHashJoin: true
                     Group By Operator
                       aggregations: count()
                       mode: hash
@@ -3916,6 +3921,7 @@ STAGE PLANS:
                       input vertices:
                         1 Map 3
                       Statistics: Num rows: 1100 Data size: 11686 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
@@ -4029,6 +4035,7 @@ STAGE PLANS:
                       input vertices:
                         1 Map 3
                       Statistics: Num rows: 1100 Data size: 11686 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
@@ -4158,6 +4165,7 @@ STAGE PLANS:
                       input vertices:
                         1 Reducer 4
                       Statistics: Num rows: 1100 Data size: 11686 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
@@ -4282,6 +4290,7 @@ STAGE PLANS:
                     input vertices:
                       1 Map 3
                     Statistics: Num rows: 2200 Data size: 23372 Basic stats: COMPLETE Column stats: NONE
+                    HybridGraceHashJoin: true
                     Filter Operator
                       predicate: (_col8 = '2008-04-08') (type: boolean)
                       Statistics: Num rows: 1100 Data size: 11686 Basic stats: COMPLETE Column stats: NONE
@@ -4364,6 +4373,7 @@ STAGE PLANS:
                       input vertices:
                         1 Map 3
                       Statistics: Num rows: 2200 Data size: 23372 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
@@ -4527,6 +4537,7 @@ STAGE PLANS:
                     input vertices:
                       1 Map 3
                     Statistics: Num rows: 1100 Data size: 11686 Basic stats: COMPLETE Column stats: NONE
+                    HybridGraceHashJoin: true
                     Map Join Operator
                       condition map:
                            Inner Join 0 to 1
@@ -4536,6 +4547,7 @@ STAGE PLANS:
                       input vertices:
                         1 Map 4
                       Statistics: Num rows: 1210 Data size: 12854 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
@@ -4682,6 +4694,7 @@ STAGE PLANS:
                       input vertices:
                         1 Map 2
                       Statistics: Num rows: 0 Data size: 0 Basic stats: NONE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Reduce Output Operator
                         key expressions: '13' (type: string)
                         sort order: +
@@ -4720,6 +4733,7 @@ STAGE PLANS:
                       input vertices:
                         0 Map 1
                       Statistics: Num rows: 1 Data size: 189 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
@@ -4799,6 +4813,7 @@ STAGE PLANS:
                       input vertices:
                         1 Union 5
                       Statistics: Num rows: 2200 Data size: 23372 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         keys: _col0 (type: string)
                         mode: hash
@@ -5014,6 +5029,7 @@ STAGE PLANS:
                       input vertices:
                         1 Map 3
                       Statistics: Num rows: 1100 Data size: 103400 Basic stats: COMPLETE Column stats: NONE
+                      HybridGraceHashJoin: true
                       Group By Operator
                         aggregations: count()
                         mode: hash
diff --git a/ql/src/test/results/clientpositive/tez/vectorized_mapjoin.q.out b/ql/src/test/results/clientpositive/tez/vectorized_mapjoin.q.out
index 884d114e4b..edc33af97a 100644
--- a/ql/src/test/results/clientpositive/tez/vectorized_mapjoin.q.out
+++ b/ql/src/test/results/clientpositive/tez/vectorized_mapjoin.q.out
@@ -40,6 +40,7 @@ STAGE PLANS:
                         input vertices:
                           1 Map 3
                         Statistics: Num rows: 6758 Data size: 1453080 Basic stats: COMPLETE Column stats: NONE
+                        HybridGraceHashJoin: true
                         Select Operator
                           expressions: _col0 (type: int), _col1 (type: int), (_col0 + _col1) (type: int)
                           outputColumnNames: _col0, _col1, _col2
diff --git a/ql/src/test/results/clientpositive/tez/vectorized_nested_mapjoin.q.out b/ql/src/test/results/clientpositive/tez/vectorized_nested_mapjoin.q.out
index 7c73f91e0e..c49192bb06 100644
--- a/ql/src/test/results/clientpositive/tez/vectorized_nested_mapjoin.q.out
+++ b/ql/src/test/results/clientpositive/tez/vectorized_nested_mapjoin.q.out
@@ -55,6 +55,7 @@ STAGE PLANS:
                         input vertices:
                           0 Map 1
                         Statistics: Num rows: 6758 Data size: 1453080 Basic stats: COMPLETE Column stats: NONE
+                        HybridGraceHashJoin: true
                         Select Operator
                           expressions: _col1 (type: smallint), _col2 (type: double)
                           outputColumnNames: _col0, _col1
@@ -69,6 +70,7 @@ STAGE PLANS:
                             input vertices:
                               1 Map 4
                             Statistics: Num rows: 7433 Data size: 1598388 Basic stats: COMPLETE Column stats: NONE
+                            HybridGraceHashJoin: true
                             Select Operator
                               expressions: _col1 (type: double)
                               outputColumnNames: _col0
