diff --git a/CHANGES.txt b/CHANGES.txt
index dd64a5ead4..9d045135d0 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -140,6 +140,8 @@ Release 0.3.0 - Unreleased
 
     HIVE-394. Break plans in Cluster Mode. (Namit Jain via zshao)
 
+    HIVE-400. Fix bug in genColList. (Namit Jain via zshao)
+
 Release 0.2.0 - Unreleased
 
   INCOMPATIBLE CHANGES
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
index e8bc59f8c8..adb5475a2d 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
@@ -990,7 +990,7 @@ private Operator genFilterPlan(QB qb, ASTNode condn, Operator input) throws Sema
   }
 
   @SuppressWarnings("nls")
-  private void genColList(String tabAlias, String alias, ASTNode sel,
+  private Integer genColList(String tabAlias, String alias, ASTNode sel,
     ArrayList<exprNodeDesc> col_list, RowResolver input, Integer pos,
     RowResolver output) throws SemanticException {
 
@@ -1017,6 +1017,7 @@ private void genColList(String tabAlias, String alias, ASTNode sel,
       output.put(tmp[0], tmp[1], new ColumnInfo(pos.toString(), colInfo.getType()));
       pos = Integer.valueOf(pos.intValue() + 1);
     }
+    return pos;
   }
 
   /**
@@ -1193,7 +1194,7 @@ private Operator genSelectPlan(String dest, QB qb,
         tabAlias = null;
         if (sel.getChildCount() == 1)
           tabAlias = unescapeIdentifier(sel.getChild(0).getText().toLowerCase());
-        genColList(tabAlias, alias, sel, col_list, inputRR, pos, out_rwsch);
+        pos = genColList(tabAlias, alias, sel, col_list, inputRR, pos, out_rwsch);
         selectStar = true;
       } else if (sel.getToken().getType() == HiveParser.TOK_TRANSFORM) {
         if (i > 0) {
@@ -1208,7 +1209,7 @@ private Operator genSelectPlan(String dest, QB qb,
             if (sel.getChildCount() == 1)
               tabAlias = unescapeIdentifier(sel.getChild(0).getText().toLowerCase());
 
-            genColList(tabAlias, alias, expr, col_list, inputRR, pos, out_rwsch);
+            pos = genColList(tabAlias, alias, expr, col_list, inputRR, pos, out_rwsch);
             selectStar = true;
           } else {
             exprNodeDesc exp = genExprNodeDesc(expr, inputRR);
