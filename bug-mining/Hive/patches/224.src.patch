diff --git a/CHANGES.txt b/CHANGES.txt
index 13db9ffb06..e163b318d3 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -195,6 +195,9 @@ Trunk - Unreleased
     HIVE-454. Support escaping of ; in cli
     (Edward Capriolo via namit)
 
+    HIVE-736. Provide a function in Metastore to return the schema of a table.
+    (Eric Hwang via rmurthy)
+
   OPTIMIZATIONS
 
     HIVE-279. Predicate Pushdown support (Prasad Chakka via athusoo).
diff --git a/metastore/if/hive_metastore.thrift b/metastore/if/hive_metastore.thrift
index ba668eec85..273f99b01f 100755
--- a/metastore/if/hive_metastore.thrift
+++ b/metastore/if/hive_metastore.thrift
@@ -151,8 +151,12 @@ service ThriftHiveMetastore extends fb303.FacebookService
   map<string, Type> get_type_all(1:string name)
                                 throws(1:MetaException o2)
 
+  // Gets a list of FieldSchemas describing the columns of a particular table
   list<FieldSchema> get_fields(1: string db_name, 2: string table_name) throws (1: MetaException o1, 2: UnknownTableException o2, 3: UnknownDBException o3),
 
+  // Gets a list of FieldSchemas describing both the columns and the partition keys of a particular table
+  list<FieldSchema> get_schema(1: string db_name, 2: string table_name) throws (1: MetaException o1, 2: UnknownTableException o2, 3: UnknownDBException o3)
+
   // create a Hive table. Following fields must be set
   // tableName
   // database        (only 'default' for now until Hive QL supports databases)
diff --git a/metastore/src/gen-javabean/org/apache/hadoop/hive/metastore/api/Index.java b/metastore/src/gen-javabean/org/apache/hadoop/hive/metastore/api/Index.java
index d1625a3052..0229802811 100644
--- a/metastore/src/gen-javabean/org/apache/hadoop/hive/metastore/api/Index.java
+++ b/metastore/src/gen-javabean/org/apache/hadoop/hive/metastore/api/Index.java
@@ -25,6 +25,7 @@ public class Index implements TBase, java.io.Serializable, Cloneable {
   private static final TField TABLE_NAME_FIELD_DESC = new TField("tableName", TType.STRING, (short)3);
   private static final TField DB_NAME_FIELD_DESC = new TField("dbName", TType.STRING, (short)4);
   private static final TField COL_NAMES_FIELD_DESC = new TField("colNames", TType.LIST, (short)5);
+  private static final TField PART_NAME_FIELD_DESC = new TField("partName", TType.STRING, (short)6);
 
   private String indexName;
   public static final int INDEXNAME = 1;
@@ -36,6 +37,8 @@ public class Index implements TBase, java.io.Serializable, Cloneable {
   public static final int DBNAME = 4;
   private List<String> colNames;
   public static final int COLNAMES = 5;
+  private String partName;
+  public static final int PARTNAME = 6;
 
   private final Isset __isset = new Isset();
   private static final class Isset implements java.io.Serializable {
@@ -54,6 +57,8 @@ private static final class Isset implements java.io.Serializable {
     put(COLNAMES, new FieldMetaData("colNames", TFieldRequirementType.DEFAULT, 
         new ListMetaData(TType.LIST, 
             new FieldValueMetaData(TType.STRING))));
+    put(PARTNAME, new FieldMetaData("partName", TFieldRequirementType.DEFAULT, 
+        new FieldValueMetaData(TType.STRING)));
   }});
 
   static {
@@ -68,7 +73,8 @@ public Index(
     int indexType,
     String tableName,
     String dbName,
-    List<String> colNames)
+    List<String> colNames,
+    String partName)
   {
     this();
     this.indexName = indexName;
@@ -77,6 +83,7 @@ public Index(
     this.tableName = tableName;
     this.dbName = dbName;
     this.colNames = colNames;
+    this.partName = partName;
   }
 
   /**
@@ -101,6 +108,9 @@ public Index(Index other) {
       }
       this.colNames = __this__colNames;
     }
+    if (other.isSetPartName()) {
+      this.partName = other.partName;
+    }
   }
 
   @Override
@@ -209,6 +219,23 @@ public boolean isSetColNames() {
     return this.colNames != null;
   }
 
+  public String getPartName() {
+    return this.partName;
+  }
+
+  public void setPartName(String partName) {
+    this.partName = partName;
+  }
+
+  public void unsetPartName() {
+    this.partName = null;
+  }
+
+  // Returns true if field partName is set (has been asigned a value) and false otherwise
+  public boolean isSetPartName() {
+    return this.partName != null;
+  }
+
   public void setFieldValue(int fieldID, Object value) {
     switch (fieldID) {
     case INDEXNAME:
@@ -251,6 +278,14 @@ public void setFieldValue(int fieldID, Object value) {
       }
       break;
 
+    case PARTNAME:
+      if (value == null) {
+        unsetPartName();
+      } else {
+        setPartName((String)value);
+      }
+      break;
+
     default:
       throw new IllegalArgumentException("Field " + fieldID + " doesn't exist!");
     }
@@ -273,6 +308,9 @@ public Object getFieldValue(int fieldID) {
     case COLNAMES:
       return getColNames();
 
+    case PARTNAME:
+      return getPartName();
+
     default:
       throw new IllegalArgumentException("Field " + fieldID + " doesn't exist!");
     }
@@ -291,6 +329,8 @@ public boolean isSet(int fieldID) {
       return isSetDbName();
     case COLNAMES:
       return isSetColNames();
+    case PARTNAME:
+      return isSetPartName();
     default:
       throw new IllegalArgumentException("Field " + fieldID + " doesn't exist!");
     }
@@ -354,6 +394,15 @@ public boolean equals(Index that) {
         return false;
     }
 
+    boolean this_present_partName = true && this.isSetPartName();
+    boolean that_present_partName = true && that.isSetPartName();
+    if (this_present_partName || that_present_partName) {
+      if (!(this_present_partName && that_present_partName))
+        return false;
+      if (!this.partName.equals(that.partName))
+        return false;
+    }
+
     return true;
   }
 
@@ -419,6 +468,13 @@ public void read(TProtocol iprot) throws TException {
             TProtocolUtil.skip(iprot, field.type);
           }
           break;
+        case PARTNAME:
+          if (field.type == TType.STRING) {
+            this.partName = iprot.readString();
+          } else { 
+            TProtocolUtil.skip(iprot, field.type);
+          }
+          break;
         default:
           TProtocolUtil.skip(iprot, field.type);
           break;
@@ -463,6 +519,11 @@ public void write(TProtocol oprot) throws TException {
       }
       oprot.writeFieldEnd();
     }
+    if (this.partName != null) {
+      oprot.writeFieldBegin(PART_NAME_FIELD_DESC);
+      oprot.writeString(this.partName);
+      oprot.writeFieldEnd();
+    }
     oprot.writeFieldStop();
     oprot.writeStructEnd();
   }
@@ -507,6 +568,14 @@ public String toString() {
       sb.append(this.colNames);
     }
     first = false;
+    if (!first) sb.append(", ");
+    sb.append("partName:");
+    if (this.partName == null) {
+      sb.append("null");
+    } else {
+      sb.append(this.partName);
+    }
+    first = false;
     sb.append(")");
     return sb.toString();
   }
diff --git a/metastore/src/gen-javabean/org/apache/hadoop/hive/metastore/api/ThriftHiveMetastore.java b/metastore/src/gen-javabean/org/apache/hadoop/hive/metastore/api/ThriftHiveMetastore.java
index 573d713b5f..fd1c98398c 100644
--- a/metastore/src/gen-javabean/org/apache/hadoop/hive/metastore/api/ThriftHiveMetastore.java
+++ b/metastore/src/gen-javabean/org/apache/hadoop/hive/metastore/api/ThriftHiveMetastore.java
@@ -43,6 +43,8 @@ public interface Iface extends com.facebook.fb303.FacebookService.Iface {
 
     public List<FieldSchema> get_fields(String db_name, String table_name) throws MetaException, UnknownTableException, UnknownDBException, TException;
 
+    public List<FieldSchema> get_schema(String db_name, String table_name) throws MetaException, UnknownTableException, UnknownDBException, TException;
+
     public void create_table(Table tbl) throws AlreadyExistsException, InvalidObjectException, MetaException, NoSuchObjectException, TException;
 
     public void drop_table(String dbname, String name, boolean deleteData) throws NoSuchObjectException, MetaException, TException;
@@ -423,6 +425,49 @@ public List<FieldSchema> recv_get_fields() throws MetaException, UnknownTableExc
       throw new TApplicationException(TApplicationException.MISSING_RESULT, "get_fields failed: unknown result");
     }
 
+    public List<FieldSchema> get_schema(String db_name, String table_name) throws MetaException, UnknownTableException, UnknownDBException, TException
+    {
+      send_get_schema(db_name, table_name);
+      return recv_get_schema();
+    }
+
+    public void send_get_schema(String db_name, String table_name) throws TException
+    {
+      oprot_.writeMessageBegin(new TMessage("get_schema", TMessageType.CALL, seqid_));
+      get_schema_args args = new get_schema_args();
+      args.db_name = db_name;
+      args.table_name = table_name;
+      args.write(oprot_);
+      oprot_.writeMessageEnd();
+      oprot_.getTransport().flush();
+    }
+
+    public List<FieldSchema> recv_get_schema() throws MetaException, UnknownTableException, UnknownDBException, TException
+    {
+      TMessage msg = iprot_.readMessageBegin();
+      if (msg.type == TMessageType.EXCEPTION) {
+        TApplicationException x = TApplicationException.read(iprot_);
+        iprot_.readMessageEnd();
+        throw x;
+      }
+      get_schema_result result = new get_schema_result();
+      result.read(iprot_);
+      iprot_.readMessageEnd();
+      if (result.isSetSuccess()) {
+        return result.success;
+      }
+      if (result.o1 != null) {
+        throw result.o1;
+      }
+      if (result.o2 != null) {
+        throw result.o2;
+      }
+      if (result.o3 != null) {
+        throw result.o3;
+      }
+      throw new TApplicationException(TApplicationException.MISSING_RESULT, "get_schema failed: unknown result");
+    }
+
     public void create_table(Table tbl) throws AlreadyExistsException, InvalidObjectException, MetaException, NoSuchObjectException, TException
     {
       send_create_table(tbl);
@@ -917,6 +962,7 @@ public Processor(Iface iface)
       processMap_.put("drop_type", new drop_type());
       processMap_.put("get_type_all", new get_type_all());
       processMap_.put("get_fields", new get_fields());
+      processMap_.put("get_schema", new get_schema());
       processMap_.put("create_table", new create_table());
       processMap_.put("drop_table", new drop_table());
       processMap_.put("get_tables", new get_tables());
@@ -1219,6 +1265,38 @@ public void process(int seqid, TProtocol iprot, TProtocol oprot) throws TExcepti
 
     }
 
+    private class get_schema implements ProcessFunction {
+      public void process(int seqid, TProtocol iprot, TProtocol oprot) throws TException
+      {
+        get_schema_args args = new get_schema_args();
+        args.read(iprot);
+        iprot.readMessageEnd();
+        get_schema_result result = new get_schema_result();
+        try {
+          result.success = iface_.get_schema(args.db_name, args.table_name);
+        } catch (MetaException o1) {
+          result.o1 = o1;
+        } catch (UnknownTableException o2) {
+          result.o2 = o2;
+        } catch (UnknownDBException o3) {
+          result.o3 = o3;
+        } catch (Throwable th) {
+          LOGGER.error("Internal error processing get_schema", th);
+          TApplicationException x = new TApplicationException(TApplicationException.INTERNAL_ERROR, "Internal error processing get_schema");
+          oprot.writeMessageBegin(new TMessage("get_schema", TMessageType.EXCEPTION, seqid));
+          x.write(oprot);
+          oprot.writeMessageEnd();
+          oprot.getTransport().flush();
+          return;
+        }
+        oprot.writeMessageBegin(new TMessage("get_schema", TMessageType.REPLY, seqid));
+        result.write(oprot);
+        oprot.writeMessageEnd();
+        oprot.getTransport().flush();
+      }
+
+    }
+
     private class create_table implements ProcessFunction {
       public void process(int seqid, TProtocol iprot, TProtocol oprot) throws TException
       {
@@ -5323,11 +5401,607 @@ public boolean isSetSuccess() {
       return this.success != null;
     }
 
-    public MetaException getO2() {
+    public MetaException getO2() {
+      return this.o2;
+    }
+
+    public void setO2(MetaException o2) {
+      this.o2 = o2;
+    }
+
+    public void unsetO2() {
+      this.o2 = null;
+    }
+
+    // Returns true if field o2 is set (has been asigned a value) and false otherwise
+    public boolean isSetO2() {
+      return this.o2 != null;
+    }
+
+    public void setFieldValue(int fieldID, Object value) {
+      switch (fieldID) {
+      case SUCCESS:
+        if (value == null) {
+          unsetSuccess();
+        } else {
+          setSuccess((Map<String,Type>)value);
+        }
+        break;
+
+      case O2:
+        if (value == null) {
+          unsetO2();
+        } else {
+          setO2((MetaException)value);
+        }
+        break;
+
+      default:
+        throw new IllegalArgumentException("Field " + fieldID + " doesn't exist!");
+      }
+    }
+
+    public Object getFieldValue(int fieldID) {
+      switch (fieldID) {
+      case SUCCESS:
+        return getSuccess();
+
+      case O2:
+        return getO2();
+
+      default:
+        throw new IllegalArgumentException("Field " + fieldID + " doesn't exist!");
+      }
+    }
+
+    // Returns true if field corresponding to fieldID is set (has been asigned a value) and false otherwise
+    public boolean isSet(int fieldID) {
+      switch (fieldID) {
+      case SUCCESS:
+        return isSetSuccess();
+      case O2:
+        return isSetO2();
+      default:
+        throw new IllegalArgumentException("Field " + fieldID + " doesn't exist!");
+      }
+    }
+
+    @Override
+    public boolean equals(Object that) {
+      if (that == null)
+        return false;
+      if (that instanceof get_type_all_result)
+        return this.equals((get_type_all_result)that);
+      return false;
+    }
+
+    public boolean equals(get_type_all_result that) {
+      if (that == null)
+        return false;
+
+      boolean this_present_success = true && this.isSetSuccess();
+      boolean that_present_success = true && that.isSetSuccess();
+      if (this_present_success || that_present_success) {
+        if (!(this_present_success && that_present_success))
+          return false;
+        if (!this.success.equals(that.success))
+          return false;
+      }
+
+      boolean this_present_o2 = true && this.isSetO2();
+      boolean that_present_o2 = true && that.isSetO2();
+      if (this_present_o2 || that_present_o2) {
+        if (!(this_present_o2 && that_present_o2))
+          return false;
+        if (!this.o2.equals(that.o2))
+          return false;
+      }
+
+      return true;
+    }
+
+    @Override
+    public int hashCode() {
+      return 0;
+    }
+
+    public void read(TProtocol iprot) throws TException {
+      TField field;
+      iprot.readStructBegin();
+      while (true)
+      {
+        field = iprot.readFieldBegin();
+        if (field.type == TType.STOP) { 
+          break;
+        }
+        switch (field.id)
+        {
+          case SUCCESS:
+            if (field.type == TType.MAP) {
+              {
+                TMap _map61 = iprot.readMapBegin();
+                this.success = new HashMap<String,Type>(2*_map61.size);
+                for (int _i62 = 0; _i62 < _map61.size; ++_i62)
+                {
+                  String _key63;
+                  Type _val64;
+                  _key63 = iprot.readString();
+                  _val64 = new Type();
+                  _val64.read(iprot);
+                  this.success.put(_key63, _val64);
+                }
+                iprot.readMapEnd();
+              }
+            } else { 
+              TProtocolUtil.skip(iprot, field.type);
+            }
+            break;
+          case O2:
+            if (field.type == TType.STRUCT) {
+              this.o2 = new MetaException();
+              this.o2.read(iprot);
+            } else { 
+              TProtocolUtil.skip(iprot, field.type);
+            }
+            break;
+          default:
+            TProtocolUtil.skip(iprot, field.type);
+            break;
+        }
+        iprot.readFieldEnd();
+      }
+      iprot.readStructEnd();
+
+      validate();
+    }
+
+    public void write(TProtocol oprot) throws TException {
+      oprot.writeStructBegin(STRUCT_DESC);
+
+      if (this.isSetSuccess()) {
+        oprot.writeFieldBegin(SUCCESS_FIELD_DESC);
+        {
+          oprot.writeMapBegin(new TMap(TType.STRING, TType.STRUCT, this.success.size()));
+          for (Map.Entry<String, Type> _iter65 : this.success.entrySet())          {
+            oprot.writeString(_iter65.getKey());
+            _iter65.getValue().write(oprot);
+          }
+          oprot.writeMapEnd();
+        }
+        oprot.writeFieldEnd();
+      } else if (this.isSetO2()) {
+        oprot.writeFieldBegin(O2_FIELD_DESC);
+        this.o2.write(oprot);
+        oprot.writeFieldEnd();
+      }
+      oprot.writeFieldStop();
+      oprot.writeStructEnd();
+    }
+
+    @Override
+    public String toString() {
+      StringBuilder sb = new StringBuilder("get_type_all_result(");
+      boolean first = true;
+
+      sb.append("success:");
+      if (this.success == null) {
+        sb.append("null");
+      } else {
+        sb.append(this.success);
+      }
+      first = false;
+      if (!first) sb.append(", ");
+      sb.append("o2:");
+      if (this.o2 == null) {
+        sb.append("null");
+      } else {
+        sb.append(this.o2);
+      }
+      first = false;
+      sb.append(")");
+      return sb.toString();
+    }
+
+    public void validate() throws TException {
+      // check for required fields
+      // check that fields of type enum have valid values
+    }
+
+  }
+
+  public static class get_fields_args implements TBase, java.io.Serializable, Cloneable   {
+    private static final TStruct STRUCT_DESC = new TStruct("get_fields_args");
+    private static final TField DB_NAME_FIELD_DESC = new TField("db_name", TType.STRING, (short)1);
+    private static final TField TABLE_NAME_FIELD_DESC = new TField("table_name", TType.STRING, (short)2);
+
+    private String db_name;
+    public static final int DB_NAME = 1;
+    private String table_name;
+    public static final int TABLE_NAME = 2;
+
+    private final Isset __isset = new Isset();
+    private static final class Isset implements java.io.Serializable {
+    }
+
+    public static final Map<Integer, FieldMetaData> metaDataMap = Collections.unmodifiableMap(new HashMap<Integer, FieldMetaData>() {{
+      put(DB_NAME, new FieldMetaData("db_name", TFieldRequirementType.DEFAULT, 
+          new FieldValueMetaData(TType.STRING)));
+      put(TABLE_NAME, new FieldMetaData("table_name", TFieldRequirementType.DEFAULT, 
+          new FieldValueMetaData(TType.STRING)));
+    }});
+
+    static {
+      FieldMetaData.addStructMetaDataMap(get_fields_args.class, metaDataMap);
+    }
+
+    public get_fields_args() {
+    }
+
+    public get_fields_args(
+      String db_name,
+      String table_name)
+    {
+      this();
+      this.db_name = db_name;
+      this.table_name = table_name;
+    }
+
+    /**
+     * Performs a deep copy on <i>other</i>.
+     */
+    public get_fields_args(get_fields_args other) {
+      if (other.isSetDb_name()) {
+        this.db_name = other.db_name;
+      }
+      if (other.isSetTable_name()) {
+        this.table_name = other.table_name;
+      }
+    }
+
+    @Override
+    public get_fields_args clone() {
+      return new get_fields_args(this);
+    }
+
+    public String getDb_name() {
+      return this.db_name;
+    }
+
+    public void setDb_name(String db_name) {
+      this.db_name = db_name;
+    }
+
+    public void unsetDb_name() {
+      this.db_name = null;
+    }
+
+    // Returns true if field db_name is set (has been asigned a value) and false otherwise
+    public boolean isSetDb_name() {
+      return this.db_name != null;
+    }
+
+    public String getTable_name() {
+      return this.table_name;
+    }
+
+    public void setTable_name(String table_name) {
+      this.table_name = table_name;
+    }
+
+    public void unsetTable_name() {
+      this.table_name = null;
+    }
+
+    // Returns true if field table_name is set (has been asigned a value) and false otherwise
+    public boolean isSetTable_name() {
+      return this.table_name != null;
+    }
+
+    public void setFieldValue(int fieldID, Object value) {
+      switch (fieldID) {
+      case DB_NAME:
+        if (value == null) {
+          unsetDb_name();
+        } else {
+          setDb_name((String)value);
+        }
+        break;
+
+      case TABLE_NAME:
+        if (value == null) {
+          unsetTable_name();
+        } else {
+          setTable_name((String)value);
+        }
+        break;
+
+      default:
+        throw new IllegalArgumentException("Field " + fieldID + " doesn't exist!");
+      }
+    }
+
+    public Object getFieldValue(int fieldID) {
+      switch (fieldID) {
+      case DB_NAME:
+        return getDb_name();
+
+      case TABLE_NAME:
+        return getTable_name();
+
+      default:
+        throw new IllegalArgumentException("Field " + fieldID + " doesn't exist!");
+      }
+    }
+
+    // Returns true if field corresponding to fieldID is set (has been asigned a value) and false otherwise
+    public boolean isSet(int fieldID) {
+      switch (fieldID) {
+      case DB_NAME:
+        return isSetDb_name();
+      case TABLE_NAME:
+        return isSetTable_name();
+      default:
+        throw new IllegalArgumentException("Field " + fieldID + " doesn't exist!");
+      }
+    }
+
+    @Override
+    public boolean equals(Object that) {
+      if (that == null)
+        return false;
+      if (that instanceof get_fields_args)
+        return this.equals((get_fields_args)that);
+      return false;
+    }
+
+    public boolean equals(get_fields_args that) {
+      if (that == null)
+        return false;
+
+      boolean this_present_db_name = true && this.isSetDb_name();
+      boolean that_present_db_name = true && that.isSetDb_name();
+      if (this_present_db_name || that_present_db_name) {
+        if (!(this_present_db_name && that_present_db_name))
+          return false;
+        if (!this.db_name.equals(that.db_name))
+          return false;
+      }
+
+      boolean this_present_table_name = true && this.isSetTable_name();
+      boolean that_present_table_name = true && that.isSetTable_name();
+      if (this_present_table_name || that_present_table_name) {
+        if (!(this_present_table_name && that_present_table_name))
+          return false;
+        if (!this.table_name.equals(that.table_name))
+          return false;
+      }
+
+      return true;
+    }
+
+    @Override
+    public int hashCode() {
+      return 0;
+    }
+
+    public void read(TProtocol iprot) throws TException {
+      TField field;
+      iprot.readStructBegin();
+      while (true)
+      {
+        field = iprot.readFieldBegin();
+        if (field.type == TType.STOP) { 
+          break;
+        }
+        switch (field.id)
+        {
+          case DB_NAME:
+            if (field.type == TType.STRING) {
+              this.db_name = iprot.readString();
+            } else { 
+              TProtocolUtil.skip(iprot, field.type);
+            }
+            break;
+          case TABLE_NAME:
+            if (field.type == TType.STRING) {
+              this.table_name = iprot.readString();
+            } else { 
+              TProtocolUtil.skip(iprot, field.type);
+            }
+            break;
+          default:
+            TProtocolUtil.skip(iprot, field.type);
+            break;
+        }
+        iprot.readFieldEnd();
+      }
+      iprot.readStructEnd();
+
+      validate();
+    }
+
+    public void write(TProtocol oprot) throws TException {
+      validate();
+
+      oprot.writeStructBegin(STRUCT_DESC);
+      if (this.db_name != null) {
+        oprot.writeFieldBegin(DB_NAME_FIELD_DESC);
+        oprot.writeString(this.db_name);
+        oprot.writeFieldEnd();
+      }
+      if (this.table_name != null) {
+        oprot.writeFieldBegin(TABLE_NAME_FIELD_DESC);
+        oprot.writeString(this.table_name);
+        oprot.writeFieldEnd();
+      }
+      oprot.writeFieldStop();
+      oprot.writeStructEnd();
+    }
+
+    @Override
+    public String toString() {
+      StringBuilder sb = new StringBuilder("get_fields_args(");
+      boolean first = true;
+
+      sb.append("db_name:");
+      if (this.db_name == null) {
+        sb.append("null");
+      } else {
+        sb.append(this.db_name);
+      }
+      first = false;
+      if (!first) sb.append(", ");
+      sb.append("table_name:");
+      if (this.table_name == null) {
+        sb.append("null");
+      } else {
+        sb.append(this.table_name);
+      }
+      first = false;
+      sb.append(")");
+      return sb.toString();
+    }
+
+    public void validate() throws TException {
+      // check for required fields
+      // check that fields of type enum have valid values
+    }
+
+  }
+
+  public static class get_fields_result implements TBase, java.io.Serializable, Cloneable   {
+    private static final TStruct STRUCT_DESC = new TStruct("get_fields_result");
+    private static final TField SUCCESS_FIELD_DESC = new TField("success", TType.LIST, (short)0);
+    private static final TField O1_FIELD_DESC = new TField("o1", TType.STRUCT, (short)1);
+    private static final TField O2_FIELD_DESC = new TField("o2", TType.STRUCT, (short)2);
+    private static final TField O3_FIELD_DESC = new TField("o3", TType.STRUCT, (short)3);
+
+    private List<FieldSchema> success;
+    public static final int SUCCESS = 0;
+    private MetaException o1;
+    public static final int O1 = 1;
+    private UnknownTableException o2;
+    public static final int O2 = 2;
+    private UnknownDBException o3;
+    public static final int O3 = 3;
+
+    private final Isset __isset = new Isset();
+    private static final class Isset implements java.io.Serializable {
+    }
+
+    public static final Map<Integer, FieldMetaData> metaDataMap = Collections.unmodifiableMap(new HashMap<Integer, FieldMetaData>() {{
+      put(SUCCESS, new FieldMetaData("success", TFieldRequirementType.DEFAULT, 
+          new ListMetaData(TType.LIST, 
+              new StructMetaData(TType.STRUCT, FieldSchema.class))));
+      put(O1, new FieldMetaData("o1", TFieldRequirementType.DEFAULT, 
+          new FieldValueMetaData(TType.STRUCT)));
+      put(O2, new FieldMetaData("o2", TFieldRequirementType.DEFAULT, 
+          new FieldValueMetaData(TType.STRUCT)));
+      put(O3, new FieldMetaData("o3", TFieldRequirementType.DEFAULT, 
+          new FieldValueMetaData(TType.STRUCT)));
+    }});
+
+    static {
+      FieldMetaData.addStructMetaDataMap(get_fields_result.class, metaDataMap);
+    }
+
+    public get_fields_result() {
+    }
+
+    public get_fields_result(
+      List<FieldSchema> success,
+      MetaException o1,
+      UnknownTableException o2,
+      UnknownDBException o3)
+    {
+      this();
+      this.success = success;
+      this.o1 = o1;
+      this.o2 = o2;
+      this.o3 = o3;
+    }
+
+    /**
+     * Performs a deep copy on <i>other</i>.
+     */
+    public get_fields_result(get_fields_result other) {
+      if (other.isSetSuccess()) {
+        List<FieldSchema> __this__success = new ArrayList<FieldSchema>();
+        for (FieldSchema other_element : other.success) {
+          __this__success.add(new FieldSchema(other_element));
+        }
+        this.success = __this__success;
+      }
+      if (other.isSetO1()) {
+        this.o1 = new MetaException(other.o1);
+      }
+      if (other.isSetO2()) {
+        this.o2 = new UnknownTableException(other.o2);
+      }
+      if (other.isSetO3()) {
+        this.o3 = new UnknownDBException(other.o3);
+      }
+    }
+
+    @Override
+    public get_fields_result clone() {
+      return new get_fields_result(this);
+    }
+
+    public int getSuccessSize() {
+      return (this.success == null) ? 0 : this.success.size();
+    }
+
+    public java.util.Iterator<FieldSchema> getSuccessIterator() {
+      return (this.success == null) ? null : this.success.iterator();
+    }
+
+    public void addToSuccess(FieldSchema elem) {
+      if (this.success == null) {
+        this.success = new ArrayList<FieldSchema>();
+      }
+      this.success.add(elem);
+    }
+
+    public List<FieldSchema> getSuccess() {
+      return this.success;
+    }
+
+    public void setSuccess(List<FieldSchema> success) {
+      this.success = success;
+    }
+
+    public void unsetSuccess() {
+      this.success = null;
+    }
+
+    // Returns true if field success is set (has been asigned a value) and false otherwise
+    public boolean isSetSuccess() {
+      return this.success != null;
+    }
+
+    public MetaException getO1() {
+      return this.o1;
+    }
+
+    public void setO1(MetaException o1) {
+      this.o1 = o1;
+    }
+
+    public void unsetO1() {
+      this.o1 = null;
+    }
+
+    // Returns true if field o1 is set (has been asigned a value) and false otherwise
+    public boolean isSetO1() {
+      return this.o1 != null;
+    }
+
+    public UnknownTableException getO2() {
       return this.o2;
     }
 
-    public void setO2(MetaException o2) {
+    public void setO2(UnknownTableException o2) {
       this.o2 = o2;
     }
 
@@ -5340,13 +6014,38 @@ public boolean isSetO2() {
       return this.o2 != null;
     }
 
+    public UnknownDBException getO3() {
+      return this.o3;
+    }
+
+    public void setO3(UnknownDBException o3) {
+      this.o3 = o3;
+    }
+
+    public void unsetO3() {
+      this.o3 = null;
+    }
+
+    // Returns true if field o3 is set (has been asigned a value) and false otherwise
+    public boolean isSetO3() {
+      return this.o3 != null;
+    }
+
     public void setFieldValue(int fieldID, Object value) {
       switch (fieldID) {
       case SUCCESS:
         if (value == null) {
           unsetSuccess();
         } else {
-          setSuccess((Map<String,Type>)value);
+          setSuccess((List<FieldSchema>)value);
+        }
+        break;
+
+      case O1:
+        if (value == null) {
+          unsetO1();
+        } else {
+          setO1((MetaException)value);
         }
         break;
 
@@ -5354,7 +6053,15 @@ public void setFieldValue(int fieldID, Object value) {
         if (value == null) {
           unsetO2();
         } else {
-          setO2((MetaException)value);
+          setO2((UnknownTableException)value);
+        }
+        break;
+
+      case O3:
+        if (value == null) {
+          unsetO3();
+        } else {
+          setO3((UnknownDBException)value);
         }
         break;
 
@@ -5368,9 +6075,15 @@ public Object getFieldValue(int fieldID) {
       case SUCCESS:
         return getSuccess();
 
+      case O1:
+        return getO1();
+
       case O2:
         return getO2();
 
+      case O3:
+        return getO3();
+
       default:
         throw new IllegalArgumentException("Field " + fieldID + " doesn't exist!");
       }
@@ -5381,8 +6094,12 @@ public boolean isSet(int fieldID) {
       switch (fieldID) {
       case SUCCESS:
         return isSetSuccess();
+      case O1:
+        return isSetO1();
       case O2:
         return isSetO2();
+      case O3:
+        return isSetO3();
       default:
         throw new IllegalArgumentException("Field " + fieldID + " doesn't exist!");
       }
@@ -5392,12 +6109,12 @@ public boolean isSet(int fieldID) {
     public boolean equals(Object that) {
       if (that == null)
         return false;
-      if (that instanceof get_type_all_result)
-        return this.equals((get_type_all_result)that);
+      if (that instanceof get_fields_result)
+        return this.equals((get_fields_result)that);
       return false;
     }
 
-    public boolean equals(get_type_all_result that) {
+    public boolean equals(get_fields_result that) {
       if (that == null)
         return false;
 
@@ -5410,6 +6127,15 @@ public boolean equals(get_type_all_result that) {
           return false;
       }
 
+      boolean this_present_o1 = true && this.isSetO1();
+      boolean that_present_o1 = true && that.isSetO1();
+      if (this_present_o1 || that_present_o1) {
+        if (!(this_present_o1 && that_present_o1))
+          return false;
+        if (!this.o1.equals(that.o1))
+          return false;
+      }
+
       boolean this_present_o2 = true && this.isSetO2();
       boolean that_present_o2 = true && that.isSetO2();
       if (this_present_o2 || that_present_o2) {
@@ -5419,6 +6145,15 @@ public boolean equals(get_type_all_result that) {
           return false;
       }
 
+      boolean this_present_o3 = true && this.isSetO3();
+      boolean that_present_o3 = true && that.isSetO3();
+      if (this_present_o3 || that_present_o3) {
+        if (!(this_present_o3 && that_present_o3))
+          return false;
+        if (!this.o3.equals(that.o3))
+          return false;
+      }
+
       return true;
     }
 
@@ -5439,33 +6174,47 @@ public void read(TProtocol iprot) throws TException {
         switch (field.id)
         {
           case SUCCESS:
-            if (field.type == TType.MAP) {
+            if (field.type == TType.LIST) {
               {
-                TMap _map61 = iprot.readMapBegin();
-                this.success = new HashMap<String,Type>(2*_map61.size);
-                for (int _i62 = 0; _i62 < _map61.size; ++_i62)
+                TList _list66 = iprot.readListBegin();
+                this.success = new ArrayList<FieldSchema>(_list66.size);
+                for (int _i67 = 0; _i67 < _list66.size; ++_i67)
                 {
-                  String _key63;
-                  Type _val64;
-                  _key63 = iprot.readString();
-                  _val64 = new Type();
-                  _val64.read(iprot);
-                  this.success.put(_key63, _val64);
+                  FieldSchema _elem68;
+                  _elem68 = new FieldSchema();
+                  _elem68.read(iprot);
+                  this.success.add(_elem68);
                 }
-                iprot.readMapEnd();
+                iprot.readListEnd();
               }
             } else { 
               TProtocolUtil.skip(iprot, field.type);
             }
             break;
+          case O1:
+            if (field.type == TType.STRUCT) {
+              this.o1 = new MetaException();
+              this.o1.read(iprot);
+            } else { 
+              TProtocolUtil.skip(iprot, field.type);
+            }
+            break;
           case O2:
             if (field.type == TType.STRUCT) {
-              this.o2 = new MetaException();
+              this.o2 = new UnknownTableException();
               this.o2.read(iprot);
             } else { 
               TProtocolUtil.skip(iprot, field.type);
             }
             break;
+          case O3:
+            if (field.type == TType.STRUCT) {
+              this.o3 = new UnknownDBException();
+              this.o3.read(iprot);
+            } else { 
+              TProtocolUtil.skip(iprot, field.type);
+            }
+            break;
           default:
             TProtocolUtil.skip(iprot, field.type);
             break;
@@ -5483,18 +6232,25 @@ public void write(TProtocol oprot) throws TException {
       if (this.isSetSuccess()) {
         oprot.writeFieldBegin(SUCCESS_FIELD_DESC);
         {
-          oprot.writeMapBegin(new TMap(TType.STRING, TType.STRUCT, this.success.size()));
-          for (Map.Entry<String, Type> _iter65 : this.success.entrySet())          {
-            oprot.writeString(_iter65.getKey());
-            _iter65.getValue().write(oprot);
+          oprot.writeListBegin(new TList(TType.STRUCT, this.success.size()));
+          for (FieldSchema _iter69 : this.success)          {
+            _iter69.write(oprot);
           }
-          oprot.writeMapEnd();
+          oprot.writeListEnd();
         }
         oprot.writeFieldEnd();
+      } else if (this.isSetO1()) {
+        oprot.writeFieldBegin(O1_FIELD_DESC);
+        this.o1.write(oprot);
+        oprot.writeFieldEnd();
       } else if (this.isSetO2()) {
         oprot.writeFieldBegin(O2_FIELD_DESC);
         this.o2.write(oprot);
         oprot.writeFieldEnd();
+      } else if (this.isSetO3()) {
+        oprot.writeFieldBegin(O3_FIELD_DESC);
+        this.o3.write(oprot);
+        oprot.writeFieldEnd();
       }
       oprot.writeFieldStop();
       oprot.writeStructEnd();
@@ -5502,7 +6258,7 @@ public void write(TProtocol oprot) throws TException {
 
     @Override
     public String toString() {
-      StringBuilder sb = new StringBuilder("get_type_all_result(");
+      StringBuilder sb = new StringBuilder("get_fields_result(");
       boolean first = true;
 
       sb.append("success:");
@@ -5513,6 +6269,14 @@ public String toString() {
       }
       first = false;
       if (!first) sb.append(", ");
+      sb.append("o1:");
+      if (this.o1 == null) {
+        sb.append("null");
+      } else {
+        sb.append(this.o1);
+      }
+      first = false;
+      if (!first) sb.append(", ");
       sb.append("o2:");
       if (this.o2 == null) {
         sb.append("null");
@@ -5520,6 +6284,14 @@ public String toString() {
         sb.append(this.o2);
       }
       first = false;
+      if (!first) sb.append(", ");
+      sb.append("o3:");
+      if (this.o3 == null) {
+        sb.append("null");
+      } else {
+        sb.append(this.o3);
+      }
+      first = false;
       sb.append(")");
       return sb.toString();
     }
@@ -5531,8 +6303,8 @@ public void validate() throws TException {
 
   }
 
-  public static class get_fields_args implements TBase, java.io.Serializable, Cloneable   {
-    private static final TStruct STRUCT_DESC = new TStruct("get_fields_args");
+  public static class get_schema_args implements TBase, java.io.Serializable, Cloneable   {
+    private static final TStruct STRUCT_DESC = new TStruct("get_schema_args");
     private static final TField DB_NAME_FIELD_DESC = new TField("db_name", TType.STRING, (short)1);
     private static final TField TABLE_NAME_FIELD_DESC = new TField("table_name", TType.STRING, (short)2);
 
@@ -5553,13 +6325,13 @@ private static final class Isset implements java.io.Serializable {
     }});
 
     static {
-      FieldMetaData.addStructMetaDataMap(get_fields_args.class, metaDataMap);
+      FieldMetaData.addStructMetaDataMap(get_schema_args.class, metaDataMap);
     }
 
-    public get_fields_args() {
+    public get_schema_args() {
     }
 
-    public get_fields_args(
+    public get_schema_args(
       String db_name,
       String table_name)
     {
@@ -5571,7 +6343,7 @@ public get_fields_args(
     /**
      * Performs a deep copy on <i>other</i>.
      */
-    public get_fields_args(get_fields_args other) {
+    public get_schema_args(get_schema_args other) {
       if (other.isSetDb_name()) {
         this.db_name = other.db_name;
       }
@@ -5581,8 +6353,8 @@ public get_fields_args(get_fields_args other) {
     }
 
     @Override
-    public get_fields_args clone() {
-      return new get_fields_args(this);
+    public get_schema_args clone() {
+      return new get_schema_args(this);
     }
 
     public String getDb_name() {
@@ -5671,12 +6443,12 @@ public boolean isSet(int fieldID) {
     public boolean equals(Object that) {
       if (that == null)
         return false;
-      if (that instanceof get_fields_args)
-        return this.equals((get_fields_args)that);
+      if (that instanceof get_schema_args)
+        return this.equals((get_schema_args)that);
       return false;
     }
 
-    public boolean equals(get_fields_args that) {
+    public boolean equals(get_schema_args that) {
       if (that == null)
         return false;
 
@@ -5762,7 +6534,7 @@ public void write(TProtocol oprot) throws TException {
 
     @Override
     public String toString() {
-      StringBuilder sb = new StringBuilder("get_fields_args(");
+      StringBuilder sb = new StringBuilder("get_schema_args(");
       boolean first = true;
 
       sb.append("db_name:");
@@ -5791,8 +6563,8 @@ public void validate() throws TException {
 
   }
 
-  public static class get_fields_result implements TBase, java.io.Serializable, Cloneable   {
-    private static final TStruct STRUCT_DESC = new TStruct("get_fields_result");
+  public static class get_schema_result implements TBase, java.io.Serializable, Cloneable   {
+    private static final TStruct STRUCT_DESC = new TStruct("get_schema_result");
     private static final TField SUCCESS_FIELD_DESC = new TField("success", TType.LIST, (short)0);
     private static final TField O1_FIELD_DESC = new TField("o1", TType.STRUCT, (short)1);
     private static final TField O2_FIELD_DESC = new TField("o2", TType.STRUCT, (short)2);
@@ -5824,13 +6596,13 @@ private static final class Isset implements java.io.Serializable {
     }});
 
     static {
-      FieldMetaData.addStructMetaDataMap(get_fields_result.class, metaDataMap);
+      FieldMetaData.addStructMetaDataMap(get_schema_result.class, metaDataMap);
     }
 
-    public get_fields_result() {
+    public get_schema_result() {
     }
 
-    public get_fields_result(
+    public get_schema_result(
       List<FieldSchema> success,
       MetaException o1,
       UnknownTableException o2,
@@ -5846,7 +6618,7 @@ public get_fields_result(
     /**
      * Performs a deep copy on <i>other</i>.
      */
-    public get_fields_result(get_fields_result other) {
+    public get_schema_result(get_schema_result other) {
       if (other.isSetSuccess()) {
         List<FieldSchema> __this__success = new ArrayList<FieldSchema>();
         for (FieldSchema other_element : other.success) {
@@ -5866,8 +6638,8 @@ public get_fields_result(get_fields_result other) {
     }
 
     @Override
-    public get_fields_result clone() {
-      return new get_fields_result(this);
+    public get_schema_result clone() {
+      return new get_schema_result(this);
     }
 
     public int getSuccessSize() {
@@ -6031,12 +6803,12 @@ public boolean isSet(int fieldID) {
     public boolean equals(Object that) {
       if (that == null)
         return false;
-      if (that instanceof get_fields_result)
-        return this.equals((get_fields_result)that);
+      if (that instanceof get_schema_result)
+        return this.equals((get_schema_result)that);
       return false;
     }
 
-    public boolean equals(get_fields_result that) {
+    public boolean equals(get_schema_result that) {
       if (that == null)
         return false;
 
@@ -6098,14 +6870,14 @@ public void read(TProtocol iprot) throws TException {
           case SUCCESS:
             if (field.type == TType.LIST) {
               {
-                TList _list66 = iprot.readListBegin();
-                this.success = new ArrayList<FieldSchema>(_list66.size);
-                for (int _i67 = 0; _i67 < _list66.size; ++_i67)
+                TList _list70 = iprot.readListBegin();
+                this.success = new ArrayList<FieldSchema>(_list70.size);
+                for (int _i71 = 0; _i71 < _list70.size; ++_i71)
                 {
-                  FieldSchema _elem68;
-                  _elem68 = new FieldSchema();
-                  _elem68.read(iprot);
-                  this.success.add(_elem68);
+                  FieldSchema _elem72;
+                  _elem72 = new FieldSchema();
+                  _elem72.read(iprot);
+                  this.success.add(_elem72);
                 }
                 iprot.readListEnd();
               }
@@ -6155,8 +6927,8 @@ public void write(TProtocol oprot) throws TException {
         oprot.writeFieldBegin(SUCCESS_FIELD_DESC);
         {
           oprot.writeListBegin(new TList(TType.STRUCT, this.success.size()));
-          for (FieldSchema _iter69 : this.success)          {
-            _iter69.write(oprot);
+          for (FieldSchema _iter73 : this.success)          {
+            _iter73.write(oprot);
           }
           oprot.writeListEnd();
         }
@@ -6180,7 +6952,7 @@ public void write(TProtocol oprot) throws TException {
 
     @Override
     public String toString() {
-      StringBuilder sb = new StringBuilder("get_fields_result(");
+      StringBuilder sb = new StringBuilder("get_schema_result(");
       boolean first = true;
 
       sb.append("success:");
@@ -7870,13 +8642,13 @@ public void read(TProtocol iprot) throws TException {
           case SUCCESS:
             if (field.type == TType.LIST) {
               {
-                TList _list70 = iprot.readListBegin();
-                this.success = new ArrayList<String>(_list70.size);
-                for (int _i71 = 0; _i71 < _list70.size; ++_i71)
+                TList _list74 = iprot.readListBegin();
+                this.success = new ArrayList<String>(_list74.size);
+                for (int _i75 = 0; _i75 < _list74.size; ++_i75)
                 {
-                  String _elem72;
-                  _elem72 = iprot.readString();
-                  this.success.add(_elem72);
+                  String _elem76;
+                  _elem76 = iprot.readString();
+                  this.success.add(_elem76);
                 }
                 iprot.readListEnd();
               }
@@ -7910,8 +8682,8 @@ public void write(TProtocol oprot) throws TException {
         oprot.writeFieldBegin(SUCCESS_FIELD_DESC);
         {
           oprot.writeListBegin(new TList(TType.STRING, this.success.size()));
-          for (String _iter73 : this.success)          {
-            oprot.writeString(_iter73);
+          for (String _iter77 : this.success)          {
+            oprot.writeString(_iter77);
           }
           oprot.writeListEnd();
         }
@@ -9997,13 +10769,13 @@ public void read(TProtocol iprot) throws TException {
           case PART_VALS:
             if (field.type == TType.LIST) {
               {
-                TList _list74 = iprot.readListBegin();
-                this.part_vals = new ArrayList<String>(_list74.size);
-                for (int _i75 = 0; _i75 < _list74.size; ++_i75)
+                TList _list78 = iprot.readListBegin();
+                this.part_vals = new ArrayList<String>(_list78.size);
+                for (int _i79 = 0; _i79 < _list78.size; ++_i79)
                 {
-                  String _elem76;
-                  _elem76 = iprot.readString();
-                  this.part_vals.add(_elem76);
+                  String _elem80;
+                  _elem80 = iprot.readString();
+                  this.part_vals.add(_elem80);
                 }
                 iprot.readListEnd();
               }
@@ -10040,8 +10812,8 @@ public void write(TProtocol oprot) throws TException {
         oprot.writeFieldBegin(PART_VALS_FIELD_DESC);
         {
           oprot.writeListBegin(new TList(TType.STRING, this.part_vals.size()));
-          for (String _iter77 : this.part_vals)          {
-            oprot.writeString(_iter77);
+          for (String _iter81 : this.part_vals)          {
+            oprot.writeString(_iter81);
           }
           oprot.writeListEnd();
         }
@@ -10811,13 +11583,13 @@ public void read(TProtocol iprot) throws TException {
           case PART_VALS:
             if (field.type == TType.LIST) {
               {
-                TList _list78 = iprot.readListBegin();
-                this.part_vals = new ArrayList<String>(_list78.size);
-                for (int _i79 = 0; _i79 < _list78.size; ++_i79)
+                TList _list82 = iprot.readListBegin();
+                this.part_vals = new ArrayList<String>(_list82.size);
+                for (int _i83 = 0; _i83 < _list82.size; ++_i83)
                 {
-                  String _elem80;
-                  _elem80 = iprot.readString();
-                  this.part_vals.add(_elem80);
+                  String _elem84;
+                  _elem84 = iprot.readString();
+                  this.part_vals.add(_elem84);
                 }
                 iprot.readListEnd();
               }
@@ -10862,8 +11634,8 @@ public void write(TProtocol oprot) throws TException {
         oprot.writeFieldBegin(PART_VALS_FIELD_DESC);
         {
           oprot.writeListBegin(new TList(TType.STRING, this.part_vals.size()));
-          for (String _iter81 : this.part_vals)          {
-            oprot.writeString(_iter81);
+          for (String _iter85 : this.part_vals)          {
+            oprot.writeString(_iter85);
           }
           oprot.writeListEnd();
         }
@@ -11518,13 +12290,13 @@ public void read(TProtocol iprot) throws TException {
           case PART_VALS:
             if (field.type == TType.LIST) {
               {
-                TList _list82 = iprot.readListBegin();
-                this.part_vals = new ArrayList<String>(_list82.size);
-                for (int _i83 = 0; _i83 < _list82.size; ++_i83)
+                TList _list86 = iprot.readListBegin();
+                this.part_vals = new ArrayList<String>(_list86.size);
+                for (int _i87 = 0; _i87 < _list86.size; ++_i87)
                 {
-                  String _elem84;
-                  _elem84 = iprot.readString();
-                  this.part_vals.add(_elem84);
+                  String _elem88;
+                  _elem88 = iprot.readString();
+                  this.part_vals.add(_elem88);
                 }
                 iprot.readListEnd();
               }
@@ -11561,8 +12333,8 @@ public void write(TProtocol oprot) throws TException {
         oprot.writeFieldBegin(PART_VALS_FIELD_DESC);
         {
           oprot.writeListBegin(new TList(TType.STRING, this.part_vals.size()));
-          for (String _iter85 : this.part_vals)          {
-            oprot.writeString(_iter85);
+          for (String _iter89 : this.part_vals)          {
+            oprot.writeString(_iter89);
           }
           oprot.writeListEnd();
         }
@@ -12457,14 +13229,14 @@ public void read(TProtocol iprot) throws TException {
           case SUCCESS:
             if (field.type == TType.LIST) {
               {
-                TList _list86 = iprot.readListBegin();
-                this.success = new ArrayList<Partition>(_list86.size);
-                for (int _i87 = 0; _i87 < _list86.size; ++_i87)
+                TList _list90 = iprot.readListBegin();
+                this.success = new ArrayList<Partition>(_list90.size);
+                for (int _i91 = 0; _i91 < _list90.size; ++_i91)
                 {
-                  Partition _elem88;
-                  _elem88 = new Partition();
-                  _elem88.read(iprot);
-                  this.success.add(_elem88);
+                  Partition _elem92;
+                  _elem92 = new Partition();
+                  _elem92.read(iprot);
+                  this.success.add(_elem92);
                 }
                 iprot.readListEnd();
               }
@@ -12506,8 +13278,8 @@ public void write(TProtocol oprot) throws TException {
         oprot.writeFieldBegin(SUCCESS_FIELD_DESC);
         {
           oprot.writeListBegin(new TList(TType.STRUCT, this.success.size()));
-          for (Partition _iter89 : this.success)          {
-            _iter89.write(oprot);
+          for (Partition _iter93 : this.success)          {
+            _iter93.write(oprot);
           }
           oprot.writeListEnd();
         }
@@ -13101,13 +13873,13 @@ public void read(TProtocol iprot) throws TException {
           case SUCCESS:
             if (field.type == TType.LIST) {
               {
-                TList _list90 = iprot.readListBegin();
-                this.success = new ArrayList<String>(_list90.size);
-                for (int _i91 = 0; _i91 < _list90.size; ++_i91)
+                TList _list94 = iprot.readListBegin();
+                this.success = new ArrayList<String>(_list94.size);
+                for (int _i95 = 0; _i95 < _list94.size; ++_i95)
                 {
-                  String _elem92;
-                  _elem92 = iprot.readString();
-                  this.success.add(_elem92);
+                  String _elem96;
+                  _elem96 = iprot.readString();
+                  this.success.add(_elem96);
                 }
                 iprot.readListEnd();
               }
@@ -13141,8 +13913,8 @@ public void write(TProtocol oprot) throws TException {
         oprot.writeFieldBegin(SUCCESS_FIELD_DESC);
         {
           oprot.writeListBegin(new TList(TType.STRING, this.success.size()));
-          for (String _iter93 : this.success)          {
-            oprot.writeString(_iter93);
+          for (String _iter97 : this.success)          {
+            oprot.writeString(_iter97);
           }
           oprot.writeListEnd();
         }
diff --git a/metastore/src/gen-php/ThriftHiveMetastore.php b/metastore/src/gen-php/ThriftHiveMetastore.php
index 1b81e184b1..9cefcccdb7 100644
--- a/metastore/src/gen-php/ThriftHiveMetastore.php
+++ b/metastore/src/gen-php/ThriftHiveMetastore.php
@@ -19,6 +19,7 @@ interface ThriftHiveMetastoreIf extends FacebookServiceIf {
   public function drop_type($type);
   public function get_type_all($name);
   public function get_fields($db_name, $table_name);
+  public function get_schema($db_name, $table_name);
   public function create_table($tbl);
   public function drop_table($dbname, $name, $deleteData);
   public function get_tables($db_name, $pattern);
@@ -543,6 +544,67 @@ class ThriftHiveMetastoreClient extends FacebookServiceClient implements ThriftH
     throw new Exception("get_fields failed: unknown result");
   }
 
+  public function get_schema($db_name, $table_name)
+  {
+    $this->send_get_schema($db_name, $table_name);
+    return $this->recv_get_schema();
+  }
+
+  public function send_get_schema($db_name, $table_name)
+  {
+    $args = new metastore_ThriftHiveMetastore_get_schema_args();
+    $args->db_name = $db_name;
+    $args->table_name = $table_name;
+    $bin_accel = ($this->output_ instanceof TProtocol::$TBINARYPROTOCOLACCELERATED) && function_exists('thrift_protocol_write_binary');
+    if ($bin_accel)
+    {
+      thrift_protocol_write_binary($this->output_, 'get_schema', TMessageType::CALL, $args, $this->seqid_, $this->output_->isStrictWrite());
+    }
+    else
+    {
+      $this->output_->writeMessageBegin('get_schema', TMessageType::CALL, $this->seqid_);
+      $args->write($this->output_);
+      $this->output_->writeMessageEnd();
+      $this->output_->getTransport()->flush();
+    }
+  }
+
+  public function recv_get_schema()
+  {
+    $bin_accel = ($this->input_ instanceof TProtocol::$TBINARYPROTOCOLACCELERATED) && function_exists('thrift_protocol_read_binary');
+    if ($bin_accel) $result = thrift_protocol_read_binary($this->input_, 'metastore_ThriftHiveMetastore_get_schema_result', $this->input_->isStrictRead());
+    else
+    {
+      $rseqid = 0;
+      $fname = null;
+      $mtype = 0;
+
+      $this->input_->readMessageBegin($fname, $mtype, $rseqid);
+      if ($mtype == TMessageType::EXCEPTION) {
+        $x = new TApplicationException();
+        $x->read($this->input_);
+        $this->input_->readMessageEnd();
+        throw $x;
+      }
+      $result = new metastore_ThriftHiveMetastore_get_schema_result();
+      $result->read($this->input_);
+      $this->input_->readMessageEnd();
+    }
+    if ($result->success !== null) {
+      return $result->success;
+    }
+    if ($result->o1 !== null) {
+      throw $result->o1;
+    }
+    if ($result->o2 !== null) {
+      throw $result->o2;
+    }
+    if ($result->o3 !== null) {
+      throw $result->o3;
+    }
+    throw new Exception("get_schema failed: unknown result");
+  }
+
   public function create_table($tbl)
   {
     $this->send_create_table($tbl);
@@ -2990,6 +3052,264 @@ class metastore_ThriftHiveMetastore_get_fields_result {
 
 }
 
+class metastore_ThriftHiveMetastore_get_schema_args {
+  static $_TSPEC;
+
+  public $db_name = null;
+  public $table_name = null;
+
+  public function __construct($vals=null) {
+    if (!isset(self::$_TSPEC)) {
+      self::$_TSPEC = array(
+        1 => array(
+          'var' => 'db_name',
+          'type' => TType::STRING,
+          ),
+        2 => array(
+          'var' => 'table_name',
+          'type' => TType::STRING,
+          ),
+        );
+    }
+    if (is_array($vals)) {
+      if (isset($vals['db_name'])) {
+        $this->db_name = $vals['db_name'];
+      }
+      if (isset($vals['table_name'])) {
+        $this->table_name = $vals['table_name'];
+      }
+    }
+  }
+
+  public function getName() {
+    return 'ThriftHiveMetastore_get_schema_args';
+  }
+
+  public function read($input)
+  {
+    $xfer = 0;
+    $fname = null;
+    $ftype = 0;
+    $fid = 0;
+    $xfer += $input->readStructBegin($fname);
+    while (true)
+    {
+      $xfer += $input->readFieldBegin($fname, $ftype, $fid);
+      if ($ftype == TType::STOP) {
+        break;
+      }
+      switch ($fid)
+      {
+        case 1:
+          if ($ftype == TType::STRING) {
+            $xfer += $input->readString($this->db_name);
+          } else {
+            $xfer += $input->skip($ftype);
+          }
+          break;
+        case 2:
+          if ($ftype == TType::STRING) {
+            $xfer += $input->readString($this->table_name);
+          } else {
+            $xfer += $input->skip($ftype);
+          }
+          break;
+        default:
+          $xfer += $input->skip($ftype);
+          break;
+      }
+      $xfer += $input->readFieldEnd();
+    }
+    $xfer += $input->readStructEnd();
+    return $xfer;
+  }
+
+  public function write($output) {
+    $xfer = 0;
+    $xfer += $output->writeStructBegin('ThriftHiveMetastore_get_schema_args');
+    if ($this->db_name !== null) {
+      $xfer += $output->writeFieldBegin('db_name', TType::STRING, 1);
+      $xfer += $output->writeString($this->db_name);
+      $xfer += $output->writeFieldEnd();
+    }
+    if ($this->table_name !== null) {
+      $xfer += $output->writeFieldBegin('table_name', TType::STRING, 2);
+      $xfer += $output->writeString($this->table_name);
+      $xfer += $output->writeFieldEnd();
+    }
+    $xfer += $output->writeFieldStop();
+    $xfer += $output->writeStructEnd();
+    return $xfer;
+  }
+
+}
+
+class metastore_ThriftHiveMetastore_get_schema_result {
+  static $_TSPEC;
+
+  public $success = null;
+  public $o1 = null;
+  public $o2 = null;
+  public $o3 = null;
+
+  public function __construct($vals=null) {
+    if (!isset(self::$_TSPEC)) {
+      self::$_TSPEC = array(
+        0 => array(
+          'var' => 'success',
+          'type' => TType::LST,
+          'etype' => TType::STRUCT,
+          'elem' => array(
+            'type' => TType::STRUCT,
+            'class' => 'metastore_FieldSchema',
+            ),
+          ),
+        1 => array(
+          'var' => 'o1',
+          'type' => TType::STRUCT,
+          'class' => 'metastore_MetaException',
+          ),
+        2 => array(
+          'var' => 'o2',
+          'type' => TType::STRUCT,
+          'class' => 'metastore_UnknownTableException',
+          ),
+        3 => array(
+          'var' => 'o3',
+          'type' => TType::STRUCT,
+          'class' => 'metastore_UnknownDBException',
+          ),
+        );
+    }
+    if (is_array($vals)) {
+      if (isset($vals['success'])) {
+        $this->success = $vals['success'];
+      }
+      if (isset($vals['o1'])) {
+        $this->o1 = $vals['o1'];
+      }
+      if (isset($vals['o2'])) {
+        $this->o2 = $vals['o2'];
+      }
+      if (isset($vals['o3'])) {
+        $this->o3 = $vals['o3'];
+      }
+    }
+  }
+
+  public function getName() {
+    return 'ThriftHiveMetastore_get_schema_result';
+  }
+
+  public function read($input)
+  {
+    $xfer = 0;
+    $fname = null;
+    $ftype = 0;
+    $fid = 0;
+    $xfer += $input->readStructBegin($fname);
+    while (true)
+    {
+      $xfer += $input->readFieldBegin($fname, $ftype, $fid);
+      if ($ftype == TType::STOP) {
+        break;
+      }
+      switch ($fid)
+      {
+        case 0:
+          if ($ftype == TType::LST) {
+            $this->success = array();
+            $_size124 = 0;
+            $_etype127 = 0;
+            $xfer += $input->readListBegin($_etype127, $_size124);
+            for ($_i128 = 0; $_i128 < $_size124; ++$_i128)
+            {
+              $elem129 = null;
+              $elem129 = new metastore_FieldSchema();
+              $xfer += $elem129->read($input);
+              $this->success []= $elem129;
+            }
+            $xfer += $input->readListEnd();
+          } else {
+            $xfer += $input->skip($ftype);
+          }
+          break;
+        case 1:
+          if ($ftype == TType::STRUCT) {
+            $this->o1 = new metastore_MetaException();
+            $xfer += $this->o1->read($input);
+          } else {
+            $xfer += $input->skip($ftype);
+          }
+          break;
+        case 2:
+          if ($ftype == TType::STRUCT) {
+            $this->o2 = new metastore_UnknownTableException();
+            $xfer += $this->o2->read($input);
+          } else {
+            $xfer += $input->skip($ftype);
+          }
+          break;
+        case 3:
+          if ($ftype == TType::STRUCT) {
+            $this->o3 = new metastore_UnknownDBException();
+            $xfer += $this->o3->read($input);
+          } else {
+            $xfer += $input->skip($ftype);
+          }
+          break;
+        default:
+          $xfer += $input->skip($ftype);
+          break;
+      }
+      $xfer += $input->readFieldEnd();
+    }
+    $xfer += $input->readStructEnd();
+    return $xfer;
+  }
+
+  public function write($output) {
+    $xfer = 0;
+    $xfer += $output->writeStructBegin('ThriftHiveMetastore_get_schema_result');
+    if ($this->success !== null) {
+      if (!is_array($this->success)) {
+        throw new TProtocolException('Bad type in structure.', TProtocolException::INVALID_DATA);
+      }
+      $xfer += $output->writeFieldBegin('success', TType::LST, 0);
+      {
+        $output->writeListBegin(TType::STRUCT, count($this->success));
+        {
+          foreach ($this->success as $iter130)
+          {
+            $xfer += $iter130->write($output);
+          }
+        }
+        $output->writeListEnd();
+      }
+      $xfer += $output->writeFieldEnd();
+    }
+    if ($this->o1 !== null) {
+      $xfer += $output->writeFieldBegin('o1', TType::STRUCT, 1);
+      $xfer += $this->o1->write($output);
+      $xfer += $output->writeFieldEnd();
+    }
+    if ($this->o2 !== null) {
+      $xfer += $output->writeFieldBegin('o2', TType::STRUCT, 2);
+      $xfer += $this->o2->write($output);
+      $xfer += $output->writeFieldEnd();
+    }
+    if ($this->o3 !== null) {
+      $xfer += $output->writeFieldBegin('o3', TType::STRUCT, 3);
+      $xfer += $this->o3->write($output);
+      $xfer += $output->writeFieldEnd();
+    }
+    $xfer += $output->writeFieldStop();
+    $xfer += $output->writeStructEnd();
+    return $xfer;
+  }
+
+}
+
 class metastore_ThriftHiveMetastore_create_table_args {
   static $_TSPEC;
 
@@ -3563,14 +3883,14 @@ class metastore_ThriftHiveMetastore_get_tables_result {
         case 0:
           if ($ftype == TType::LST) {
             $this->success = array();
-            $_size124 = 0;
-            $_etype127 = 0;
-            $xfer += $input->readListBegin($_etype127, $_size124);
-            for ($_i128 = 0; $_i128 < $_size124; ++$_i128)
+            $_size131 = 0;
+            $_etype134 = 0;
+            $xfer += $input->readListBegin($_etype134, $_size131);
+            for ($_i135 = 0; $_i135 < $_size131; ++$_i135)
             {
-              $elem129 = null;
-              $xfer += $input->readString($elem129);
-              $this->success []= $elem129;
+              $elem136 = null;
+              $xfer += $input->readString($elem136);
+              $this->success []= $elem136;
             }
             $xfer += $input->readListEnd();
           } else {
@@ -3606,9 +3926,9 @@ class metastore_ThriftHiveMetastore_get_tables_result {
       {
         $output->writeListBegin(TType::STRING, count($this->success));
         {
-          foreach ($this->success as $iter130)
+          foreach ($this->success as $iter137)
           {
-            $xfer += $output->writeString($iter130);
+            $xfer += $output->writeString($iter137);
           }
         }
         $output->writeListEnd();
@@ -4350,14 +4670,14 @@ class metastore_ThriftHiveMetastore_append_partition_args {
         case 3:
           if ($ftype == TType::LST) {
             $this->part_vals = array();
-            $_size131 = 0;
-            $_etype134 = 0;
-            $xfer += $input->readListBegin($_etype134, $_size131);
-            for ($_i135 = 0; $_i135 < $_size131; ++$_i135)
+            $_size138 = 0;
+            $_etype141 = 0;
+            $xfer += $input->readListBegin($_etype141, $_size138);
+            for ($_i142 = 0; $_i142 < $_size138; ++$_i142)
             {
-              $elem136 = null;
-              $xfer += $input->readString($elem136);
-              $this->part_vals []= $elem136;
+              $elem143 = null;
+              $xfer += $input->readString($elem143);
+              $this->part_vals []= $elem143;
             }
             $xfer += $input->readListEnd();
           } else {
@@ -4395,9 +4715,9 @@ class metastore_ThriftHiveMetastore_append_partition_args {
       {
         $output->writeListBegin(TType::STRING, count($this->part_vals));
         {
-          foreach ($this->part_vals as $iter137)
+          foreach ($this->part_vals as $iter144)
           {
-            $xfer += $output->writeString($iter137);
+            $xfer += $output->writeString($iter144);
           }
         }
         $output->writeListEnd();
@@ -4639,14 +4959,14 @@ class metastore_ThriftHiveMetastore_drop_partition_args {
         case 3:
           if ($ftype == TType::LST) {
             $this->part_vals = array();
-            $_size138 = 0;
-            $_etype141 = 0;
-            $xfer += $input->readListBegin($_etype141, $_size138);
-            for ($_i142 = 0; $_i142 < $_size138; ++$_i142)
+            $_size145 = 0;
+            $_etype148 = 0;
+            $xfer += $input->readListBegin($_etype148, $_size145);
+            for ($_i149 = 0; $_i149 < $_size145; ++$_i149)
             {
-              $elem143 = null;
-              $xfer += $input->readString($elem143);
-              $this->part_vals []= $elem143;
+              $elem150 = null;
+              $xfer += $input->readString($elem150);
+              $this->part_vals []= $elem150;
             }
             $xfer += $input->readListEnd();
           } else {
@@ -4691,9 +5011,9 @@ class metastore_ThriftHiveMetastore_drop_partition_args {
       {
         $output->writeListBegin(TType::STRING, count($this->part_vals));
         {
-          foreach ($this->part_vals as $iter144)
+          foreach ($this->part_vals as $iter151)
           {
-            $xfer += $output->writeString($iter144);
+            $xfer += $output->writeString($iter151);
           }
         }
         $output->writeListEnd();
@@ -4905,14 +5225,14 @@ class metastore_ThriftHiveMetastore_get_partition_args {
         case 3:
           if ($ftype == TType::LST) {
             $this->part_vals = array();
-            $_size145 = 0;
-            $_etype148 = 0;
-            $xfer += $input->readListBegin($_etype148, $_size145);
-            for ($_i149 = 0; $_i149 < $_size145; ++$_i149)
+            $_size152 = 0;
+            $_etype155 = 0;
+            $xfer += $input->readListBegin($_etype155, $_size152);
+            for ($_i156 = 0; $_i156 < $_size152; ++$_i156)
             {
-              $elem150 = null;
-              $xfer += $input->readString($elem150);
-              $this->part_vals []= $elem150;
+              $elem157 = null;
+              $xfer += $input->readString($elem157);
+              $this->part_vals []= $elem157;
             }
             $xfer += $input->readListEnd();
           } else {
@@ -4950,9 +5270,9 @@ class metastore_ThriftHiveMetastore_get_partition_args {
       {
         $output->writeListBegin(TType::STRING, count($this->part_vals));
         {
-          foreach ($this->part_vals as $iter151)
+          foreach ($this->part_vals as $iter158)
           {
-            $xfer += $output->writeString($iter151);
+            $xfer += $output->writeString($iter158);
           }
         }
         $output->writeListEnd();
@@ -5243,15 +5563,15 @@ class metastore_ThriftHiveMetastore_get_partitions_result {
         case 0:
           if ($ftype == TType::LST) {
             $this->success = array();
-            $_size152 = 0;
-            $_etype155 = 0;
-            $xfer += $input->readListBegin($_etype155, $_size152);
-            for ($_i156 = 0; $_i156 < $_size152; ++$_i156)
+            $_size159 = 0;
+            $_etype162 = 0;
+            $xfer += $input->readListBegin($_etype162, $_size159);
+            for ($_i163 = 0; $_i163 < $_size159; ++$_i163)
             {
-              $elem157 = null;
-              $elem157 = new metastore_Partition();
-              $xfer += $elem157->read($input);
-              $this->success []= $elem157;
+              $elem164 = null;
+              $elem164 = new metastore_Partition();
+              $xfer += $elem164->read($input);
+              $this->success []= $elem164;
             }
             $xfer += $input->readListEnd();
           } else {
@@ -5295,9 +5615,9 @@ class metastore_ThriftHiveMetastore_get_partitions_result {
       {
         $output->writeListBegin(TType::STRUCT, count($this->success));
         {
-          foreach ($this->success as $iter158)
+          foreach ($this->success as $iter165)
           {
-            $xfer += $iter158->write($output);
+            $xfer += $iter165->write($output);
           }
         }
         $output->writeListEnd();
@@ -5489,14 +5809,14 @@ class metastore_ThriftHiveMetastore_get_partition_names_result {
         case 0:
           if ($ftype == TType::LST) {
             $this->success = array();
-            $_size159 = 0;
-            $_etype162 = 0;
-            $xfer += $input->readListBegin($_etype162, $_size159);
-            for ($_i163 = 0; $_i163 < $_size159; ++$_i163)
+            $_size166 = 0;
+            $_etype169 = 0;
+            $xfer += $input->readListBegin($_etype169, $_size166);
+            for ($_i170 = 0; $_i170 < $_size166; ++$_i170)
             {
-              $elem164 = null;
-              $xfer += $input->readString($elem164);
-              $this->success []= $elem164;
+              $elem171 = null;
+              $xfer += $input->readString($elem171);
+              $this->success []= $elem171;
             }
             $xfer += $input->readListEnd();
           } else {
@@ -5532,9 +5852,9 @@ class metastore_ThriftHiveMetastore_get_partition_names_result {
       {
         $output->writeListBegin(TType::STRING, count($this->success));
         {
-          foreach ($this->success as $iter165)
+          foreach ($this->success as $iter172)
           {
-            $xfer += $output->writeString($iter165);
+            $xfer += $output->writeString($iter172);
           }
         }
         $output->writeListEnd();
diff --git a/metastore/src/gen-py/hive_metastore/ThriftHiveMetastore-remote b/metastore/src/gen-py/hive_metastore/ThriftHiveMetastore-remote
index 9fc9ad1afd..2c06709459 100644
--- a/metastore/src/gen-py/hive_metastore/ThriftHiveMetastore-remote
+++ b/metastore/src/gen-py/hive_metastore/ThriftHiveMetastore-remote
@@ -30,6 +30,7 @@ if len(sys.argv) <= 1 or sys.argv[1] == '--help':
   print '  bool drop_type(string type)'
   print '   get_type_all(string name)'
   print '   get_fields(string db_name, string table_name)'
+  print '   get_schema(string db_name, string table_name)'
   print '  void create_table(Table tbl)'
   print '  void drop_table(string dbname, string name, bool deleteData)'
   print '   get_tables(string db_name, string pattern)'
@@ -144,6 +145,12 @@ elif cmd == 'get_fields':
     sys.exit(1)
   pp.pprint(client.get_fields(args[0],args[1],))
 
+elif cmd == 'get_schema':
+  if len(args) != 2:
+    print 'get_schema requires 2 args'
+    sys.exit(1)
+  pp.pprint(client.get_schema(args[0],args[1],))
+
 elif cmd == 'create_table':
   if len(args) != 1:
     print 'create_table requires 1 args'
diff --git a/metastore/src/gen-py/hive_metastore/ThriftHiveMetastore.py b/metastore/src/gen-py/hive_metastore/ThriftHiveMetastore.py
index d15fe3713c..8f75490ffe 100644
--- a/metastore/src/gen-py/hive_metastore/ThriftHiveMetastore.py
+++ b/metastore/src/gen-py/hive_metastore/ThriftHiveMetastore.py
@@ -81,6 +81,14 @@ def get_fields(self, db_name, table_name):
     """
     pass
 
+  def get_schema(self, db_name, table_name):
+    """
+    Parameters:
+     - db_name
+     - table_name
+    """
+    pass
+
   def create_table(self, tbl):
     """
     Parameters:
@@ -491,6 +499,44 @@ def recv_get_fields(self, ):
       raise result.o3
     raise TApplicationException(TApplicationException.MISSING_RESULT, "get_fields failed: unknown result");
 
+  def get_schema(self, db_name, table_name):
+    """
+    Parameters:
+     - db_name
+     - table_name
+    """
+    self.send_get_schema(db_name, table_name)
+    return self.recv_get_schema()
+
+  def send_get_schema(self, db_name, table_name):
+    self._oprot.writeMessageBegin('get_schema', TMessageType.CALL, self._seqid)
+    args = get_schema_args()
+    args.db_name = db_name
+    args.table_name = table_name
+    args.write(self._oprot)
+    self._oprot.writeMessageEnd()
+    self._oprot.trans.flush()
+
+  def recv_get_schema(self, ):
+    (fname, mtype, rseqid) = self._iprot.readMessageBegin()
+    if mtype == TMessageType.EXCEPTION:
+      x = TApplicationException()
+      x.read(self._iprot)
+      self._iprot.readMessageEnd()
+      raise x
+    result = get_schema_result()
+    result.read(self._iprot)
+    self._iprot.readMessageEnd()
+    if result.success != None:
+      return result.success
+    if result.o1 != None:
+      raise result.o1
+    if result.o2 != None:
+      raise result.o2
+    if result.o3 != None:
+      raise result.o3
+    raise TApplicationException(TApplicationException.MISSING_RESULT, "get_schema failed: unknown result");
+
   def create_table(self, tbl):
     """
     Parameters:
@@ -944,6 +990,7 @@ def __init__(self, handler):
     self._processMap["drop_type"] = Processor.process_drop_type
     self._processMap["get_type_all"] = Processor.process_get_type_all
     self._processMap["get_fields"] = Processor.process_get_fields
+    self._processMap["get_schema"] = Processor.process_get_schema
     self._processMap["create_table"] = Processor.process_create_table
     self._processMap["drop_table"] = Processor.process_drop_table
     self._processMap["get_tables"] = Processor.process_get_tables
@@ -1110,6 +1157,24 @@ def process_get_fields(self, seqid, iprot, oprot):
     oprot.writeMessageEnd()
     oprot.trans.flush()
 
+  def process_get_schema(self, seqid, iprot, oprot):
+    args = get_schema_args()
+    args.read(iprot)
+    iprot.readMessageEnd()
+    result = get_schema_result()
+    try:
+      result.success = self._handler.get_schema(args.db_name, args.table_name)
+    except MetaException, o1:
+      result.o1 = o1
+    except UnknownTableException, o2:
+      result.o2 = o2
+    except UnknownDBException, o3:
+      result.o3 = o3
+    oprot.writeMessageBegin("get_schema", TMessageType.REPLY, seqid)
+    result.write(oprot)
+    oprot.writeMessageEnd()
+    oprot.trans.flush()
+
   def process_create_table(self, seqid, iprot, oprot):
     args = create_table_args()
     args.read(iprot)
@@ -2539,6 +2604,177 @@ def __eq__(self, other):
   def __ne__(self, other):
     return not (self == other)
 
+class get_schema_args:
+  """
+  Attributes:
+   - db_name
+   - table_name
+  """
+
+  thrift_spec = (
+    None, # 0
+    (1, TType.STRING, 'db_name', None, None, ), # 1
+    (2, TType.STRING, 'table_name', None, None, ), # 2
+  )
+
+  def __init__(self, db_name=None, table_name=None,):
+    self.db_name = db_name
+    self.table_name = table_name
+
+  def read(self, iprot):
+    if iprot.__class__ == TBinaryProtocol.TBinaryProtocolAccelerated and isinstance(iprot.trans, TTransport.CReadableTransport) and self.thrift_spec is not None and fastbinary is not None:
+      fastbinary.decode_binary(self, iprot.trans, (self.__class__, self.thrift_spec))
+      return
+    iprot.readStructBegin()
+    while True:
+      (fname, ftype, fid) = iprot.readFieldBegin()
+      if ftype == TType.STOP:
+        break
+      if fid == 1:
+        if ftype == TType.STRING:
+          self.db_name = iprot.readString();
+        else:
+          iprot.skip(ftype)
+      elif fid == 2:
+        if ftype == TType.STRING:
+          self.table_name = iprot.readString();
+        else:
+          iprot.skip(ftype)
+      else:
+        iprot.skip(ftype)
+      iprot.readFieldEnd()
+    iprot.readStructEnd()
+
+  def write(self, oprot):
+    if oprot.__class__ == TBinaryProtocol.TBinaryProtocolAccelerated and self.thrift_spec is not None and fastbinary is not None:
+      oprot.trans.write(fastbinary.encode_binary(self, (self.__class__, self.thrift_spec)))
+      return
+    oprot.writeStructBegin('get_schema_args')
+    if self.db_name != None:
+      oprot.writeFieldBegin('db_name', TType.STRING, 1)
+      oprot.writeString(self.db_name)
+      oprot.writeFieldEnd()
+    if self.table_name != None:
+      oprot.writeFieldBegin('table_name', TType.STRING, 2)
+      oprot.writeString(self.table_name)
+      oprot.writeFieldEnd()
+    oprot.writeFieldStop()
+    oprot.writeStructEnd()
+
+  def __repr__(self):
+    L = ['%s=%r' % (key, value)
+      for key, value in self.__dict__.iteritems()]
+    return '%s(%s)' % (self.__class__.__name__, ', '.join(L))
+
+  def __eq__(self, other):
+    return isinstance(other, self.__class__) and self.__dict__ == other.__dict__
+
+  def __ne__(self, other):
+    return not (self == other)
+
+class get_schema_result:
+  """
+  Attributes:
+   - success
+   - o1
+   - o2
+   - o3
+  """
+
+  thrift_spec = (
+    (0, TType.LIST, 'success', (TType.STRUCT,(FieldSchema, FieldSchema.thrift_spec)), None, ), # 0
+    (1, TType.STRUCT, 'o1', (MetaException, MetaException.thrift_spec), None, ), # 1
+    (2, TType.STRUCT, 'o2', (UnknownTableException, UnknownTableException.thrift_spec), None, ), # 2
+    (3, TType.STRUCT, 'o3', (UnknownDBException, UnknownDBException.thrift_spec), None, ), # 3
+  )
+
+  def __init__(self, success=None, o1=None, o2=None, o3=None,):
+    self.success = success
+    self.o1 = o1
+    self.o2 = o2
+    self.o3 = o3
+
+  def read(self, iprot):
+    if iprot.__class__ == TBinaryProtocol.TBinaryProtocolAccelerated and isinstance(iprot.trans, TTransport.CReadableTransport) and self.thrift_spec is not None and fastbinary is not None:
+      fastbinary.decode_binary(self, iprot.trans, (self.__class__, self.thrift_spec))
+      return
+    iprot.readStructBegin()
+    while True:
+      (fname, ftype, fid) = iprot.readFieldBegin()
+      if ftype == TType.STOP:
+        break
+      if fid == 0:
+        if ftype == TType.LIST:
+          self.success = []
+          (_etype127, _size124) = iprot.readListBegin()
+          for _i128 in xrange(_size124):
+            _elem129 = FieldSchema()
+            _elem129.read(iprot)
+            self.success.append(_elem129)
+          iprot.readListEnd()
+        else:
+          iprot.skip(ftype)
+      elif fid == 1:
+        if ftype == TType.STRUCT:
+          self.o1 = MetaException()
+          self.o1.read(iprot)
+        else:
+          iprot.skip(ftype)
+      elif fid == 2:
+        if ftype == TType.STRUCT:
+          self.o2 = UnknownTableException()
+          self.o2.read(iprot)
+        else:
+          iprot.skip(ftype)
+      elif fid == 3:
+        if ftype == TType.STRUCT:
+          self.o3 = UnknownDBException()
+          self.o3.read(iprot)
+        else:
+          iprot.skip(ftype)
+      else:
+        iprot.skip(ftype)
+      iprot.readFieldEnd()
+    iprot.readStructEnd()
+
+  def write(self, oprot):
+    if oprot.__class__ == TBinaryProtocol.TBinaryProtocolAccelerated and self.thrift_spec is not None and fastbinary is not None:
+      oprot.trans.write(fastbinary.encode_binary(self, (self.__class__, self.thrift_spec)))
+      return
+    oprot.writeStructBegin('get_schema_result')
+    if self.success != None:
+      oprot.writeFieldBegin('success', TType.LIST, 0)
+      oprot.writeListBegin(TType.STRUCT, len(self.success))
+      for iter130 in self.success:
+        iter130.write(oprot)
+      oprot.writeListEnd()
+      oprot.writeFieldEnd()
+    if self.o1 != None:
+      oprot.writeFieldBegin('o1', TType.STRUCT, 1)
+      self.o1.write(oprot)
+      oprot.writeFieldEnd()
+    if self.o2 != None:
+      oprot.writeFieldBegin('o2', TType.STRUCT, 2)
+      self.o2.write(oprot)
+      oprot.writeFieldEnd()
+    if self.o3 != None:
+      oprot.writeFieldBegin('o3', TType.STRUCT, 3)
+      self.o3.write(oprot)
+      oprot.writeFieldEnd()
+    oprot.writeFieldStop()
+    oprot.writeStructEnd()
+
+  def __repr__(self):
+    L = ['%s=%r' % (key, value)
+      for key, value in self.__dict__.iteritems()]
+    return '%s(%s)' % (self.__class__.__name__, ', '.join(L))
+
+  def __eq__(self, other):
+    return isinstance(other, self.__class__) and self.__dict__ == other.__dict__
+
+  def __ne__(self, other):
+    return not (self == other)
+
 class create_table_args:
   """
   Attributes:
@@ -2938,10 +3174,10 @@ def read(self, iprot):
       if fid == 0:
         if ftype == TType.LIST:
           self.success = []
-          (_etype127, _size124) = iprot.readListBegin()
-          for _i128 in xrange(_size124):
-            _elem129 = iprot.readString();
-            self.success.append(_elem129)
+          (_etype134, _size131) = iprot.readListBegin()
+          for _i135 in xrange(_size131):
+            _elem136 = iprot.readString();
+            self.success.append(_elem136)
           iprot.readListEnd()
         else:
           iprot.skip(ftype)
@@ -2964,8 +3200,8 @@ def write(self, oprot):
     if self.success != None:
       oprot.writeFieldBegin('success', TType.LIST, 0)
       oprot.writeListBegin(TType.STRING, len(self.success))
-      for iter130 in self.success:
-        oprot.writeString(iter130)
+      for iter137 in self.success:
+        oprot.writeString(iter137)
       oprot.writeListEnd()
       oprot.writeFieldEnd()
     if self.o1 != None:
@@ -3481,10 +3717,10 @@ def read(self, iprot):
       elif fid == 3:
         if ftype == TType.LIST:
           self.part_vals = []
-          (_etype134, _size131) = iprot.readListBegin()
-          for _i135 in xrange(_size131):
-            _elem136 = iprot.readString();
-            self.part_vals.append(_elem136)
+          (_etype141, _size138) = iprot.readListBegin()
+          for _i142 in xrange(_size138):
+            _elem143 = iprot.readString();
+            self.part_vals.append(_elem143)
           iprot.readListEnd()
         else:
           iprot.skip(ftype)
@@ -3509,8 +3745,8 @@ def write(self, oprot):
     if self.part_vals != None:
       oprot.writeFieldBegin('part_vals', TType.LIST, 3)
       oprot.writeListBegin(TType.STRING, len(self.part_vals))
-      for iter137 in self.part_vals:
-        oprot.writeString(iter137)
+      for iter144 in self.part_vals:
+        oprot.writeString(iter144)
       oprot.writeListEnd()
       oprot.writeFieldEnd()
     oprot.writeFieldStop()
@@ -3667,10 +3903,10 @@ def read(self, iprot):
       elif fid == 3:
         if ftype == TType.LIST:
           self.part_vals = []
-          (_etype141, _size138) = iprot.readListBegin()
-          for _i142 in xrange(_size138):
-            _elem143 = iprot.readString();
-            self.part_vals.append(_elem143)
+          (_etype148, _size145) = iprot.readListBegin()
+          for _i149 in xrange(_size145):
+            _elem150 = iprot.readString();
+            self.part_vals.append(_elem150)
           iprot.readListEnd()
         else:
           iprot.skip(ftype)
@@ -3700,8 +3936,8 @@ def write(self, oprot):
     if self.part_vals != None:
       oprot.writeFieldBegin('part_vals', TType.LIST, 3)
       oprot.writeListBegin(TType.STRING, len(self.part_vals))
-      for iter144 in self.part_vals:
-        oprot.writeString(iter144)
+      for iter151 in self.part_vals:
+        oprot.writeString(iter151)
       oprot.writeListEnd()
       oprot.writeFieldEnd()
     if self.deleteData != None:
@@ -3845,10 +4081,10 @@ def read(self, iprot):
       elif fid == 3:
         if ftype == TType.LIST:
           self.part_vals = []
-          (_etype148, _size145) = iprot.readListBegin()
-          for _i149 in xrange(_size145):
-            _elem150 = iprot.readString();
-            self.part_vals.append(_elem150)
+          (_etype155, _size152) = iprot.readListBegin()
+          for _i156 in xrange(_size152):
+            _elem157 = iprot.readString();
+            self.part_vals.append(_elem157)
           iprot.readListEnd()
         else:
           iprot.skip(ftype)
@@ -3873,8 +4109,8 @@ def write(self, oprot):
     if self.part_vals != None:
       oprot.writeFieldBegin('part_vals', TType.LIST, 3)
       oprot.writeListBegin(TType.STRING, len(self.part_vals))
-      for iter151 in self.part_vals:
-        oprot.writeString(iter151)
+      for iter158 in self.part_vals:
+        oprot.writeString(iter158)
       oprot.writeListEnd()
       oprot.writeFieldEnd()
     oprot.writeFieldStop()
@@ -4071,11 +4307,11 @@ def read(self, iprot):
       if fid == 0:
         if ftype == TType.LIST:
           self.success = []
-          (_etype155, _size152) = iprot.readListBegin()
-          for _i156 in xrange(_size152):
-            _elem157 = Partition()
-            _elem157.read(iprot)
-            self.success.append(_elem157)
+          (_etype162, _size159) = iprot.readListBegin()
+          for _i163 in xrange(_size159):
+            _elem164 = Partition()
+            _elem164.read(iprot)
+            self.success.append(_elem164)
           iprot.readListEnd()
         else:
           iprot.skip(ftype)
@@ -4104,8 +4340,8 @@ def write(self, oprot):
     if self.success != None:
       oprot.writeFieldBegin('success', TType.LIST, 0)
       oprot.writeListBegin(TType.STRUCT, len(self.success))
-      for iter158 in self.success:
-        iter158.write(oprot)
+      for iter165 in self.success:
+        iter165.write(oprot)
       oprot.writeListEnd()
       oprot.writeFieldEnd()
     if self.o1 != None:
@@ -4238,10 +4474,10 @@ def read(self, iprot):
       if fid == 0:
         if ftype == TType.LIST:
           self.success = []
-          (_etype162, _size159) = iprot.readListBegin()
-          for _i163 in xrange(_size159):
-            _elem164 = iprot.readString();
-            self.success.append(_elem164)
+          (_etype169, _size166) = iprot.readListBegin()
+          for _i170 in xrange(_size166):
+            _elem171 = iprot.readString();
+            self.success.append(_elem171)
           iprot.readListEnd()
         else:
           iprot.skip(ftype)
@@ -4264,8 +4500,8 @@ def write(self, oprot):
     if self.success != None:
       oprot.writeFieldBegin('success', TType.LIST, 0)
       oprot.writeListBegin(TType.STRING, len(self.success))
-      for iter165 in self.success:
-        oprot.writeString(iter165)
+      for iter172 in self.success:
+        oprot.writeString(iter172)
       oprot.writeListEnd()
       oprot.writeFieldEnd()
     if self.o2 != None:
diff --git a/metastore/src/gen-py/hive_metastore/ttypes.py b/metastore/src/gen-py/hive_metastore/ttypes.py
index 83277fc3aa..c4454d7b9b 100644
--- a/metastore/src/gen-py/hive_metastore/ttypes.py
+++ b/metastore/src/gen-py/hive_metastore/ttypes.py
@@ -1019,6 +1019,7 @@ class Index:
    - tableName
    - dbName
    - colNames
+   - partName
   """
 
   thrift_spec = (
@@ -1028,14 +1029,16 @@ class Index:
     (3, TType.STRING, 'tableName', None, None, ), # 3
     (4, TType.STRING, 'dbName', None, None, ), # 4
     (5, TType.LIST, 'colNames', (TType.STRING,None), None, ), # 5
+    (6, TType.STRING, 'partName', None, None, ), # 6
   )
 
-  def __init__(self, indexName=None, indexType=None, tableName=None, dbName=None, colNames=None,):
+  def __init__(self, indexName=None, indexType=None, tableName=None, dbName=None, colNames=None, partName=None,):
     self.indexName = indexName
     self.indexType = indexType
     self.tableName = tableName
     self.dbName = dbName
     self.colNames = colNames
+    self.partName = partName
 
   def read(self, iprot):
     if iprot.__class__ == TBinaryProtocol.TBinaryProtocolAccelerated and isinstance(iprot.trans, TTransport.CReadableTransport) and self.thrift_spec is not None and fastbinary is not None:
@@ -1076,6 +1079,11 @@ def read(self, iprot):
           iprot.readListEnd()
         else:
           iprot.skip(ftype)
+      elif fid == 6:
+        if ftype == TType.STRING:
+          self.partName = iprot.readString();
+        else:
+          iprot.skip(ftype)
       else:
         iprot.skip(ftype)
       iprot.readFieldEnd()
@@ -1109,6 +1117,10 @@ def write(self, oprot):
         oprot.writeString(iter84)
       oprot.writeListEnd()
       oprot.writeFieldEnd()
+    if self.partName != None:
+      oprot.writeFieldBegin('partName', TType.STRING, 6)
+      oprot.writeString(self.partName)
+      oprot.writeFieldEnd()
     oprot.writeFieldStop()
     oprot.writeStructEnd()
 
diff --git a/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java b/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java
index 4af35b9477..8947ec1f92 100644
--- a/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java
+++ b/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java
@@ -654,6 +654,42 @@ public List<FieldSchema> get_fields(String db, String tableName)
           }
         }
       }
+      
+      /**
+       * Return the schema of the table. This function includes partition columns
+       * in addition to the regular columns.
+       * @param db Name of the database
+       * @param tableName Name of the table
+       * @return List of columns, each column is a FieldSchema structure
+       * @throws MetaException
+       * @throws UnknownTableException
+       * @throws UnknownDBException
+       */
+      public List<FieldSchema> get_schema(String db, String tableName) 
+        throws MetaException, UnknownTableException, UnknownDBException {
+        this.incrementCounter("get_schema");
+        logStartFunction("get_schema: db=" + db + "tbl=" + tableName);
+        String [] names = tableName.split("\\.");
+        String base_table_name = names[0];
+        
+        Table tbl;
+        try {
+          tbl = this.get_table(db, base_table_name);
+        } catch (NoSuchObjectException e) {
+          throw new UnknownTableException(e.getMessage());
+        }
+        List<FieldSchema> fieldSchemas = this.get_fields(db, base_table_name);
+
+        if (tbl == null || fieldSchemas == null) {
+          throw new UnknownTableException(tableName + " doesn't exist");
+        }
+        
+        if (tbl.getPartitionKeys() != null) {
+          // Combine the column field schemas and the partition keys to create the whole schema
+          fieldSchemas.addAll(tbl.getPartitionKeys());
+        }
+        return fieldSchemas;
+      }
 
       public String getCpuProfile(int profileDurationInSec) throws TException {
         return "";
diff --git a/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStoreClient.java b/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStoreClient.java
index f5668c730f..36be5efc27 100644
--- a/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStoreClient.java
+++ b/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStoreClient.java
@@ -28,6 +28,7 @@
 import org.apache.hadoop.hive.conf.HiveConf;
 import org.apache.hadoop.hive.metastore.api.AlreadyExistsException;
 import org.apache.hadoop.hive.metastore.api.Database;
+import org.apache.hadoop.hive.metastore.api.FieldSchema;
 import org.apache.hadoop.hive.metastore.api.InvalidObjectException;
 import org.apache.hadoop.hive.metastore.api.InvalidOperationException;
 import org.apache.hadoop.hive.metastore.api.MetaException;
@@ -37,6 +38,7 @@
 import org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore;
 import org.apache.hadoop.hive.metastore.api.Type;
 import org.apache.hadoop.hive.metastore.api.UnknownDBException;
+import org.apache.hadoop.hive.metastore.api.UnknownTableException;
 
 import org.apache.thrift.TException;
 import org.apache.thrift.protocol.TBinaryProtocol;
@@ -439,7 +441,7 @@ public Table getTable(String dbname, String name) throws MetaException, TExcepti
   public Type getType(String name) throws MetaException, TException {
     return client.get_type(name);
   }
-
+  
   public List<String> getTables(String dbname, String tablePattern) throws MetaException {
     try {
       return client.get_tables(dbname, tablePattern);
@@ -478,5 +480,33 @@ public void alter_partition(String dbName, String tblName,
       TException {
     client.alter_partition(dbName, tblName, newPart);
   }
+  
+  /**
+   * @param db
+   * @param tableName
+   * @throws UnknownTableException
+   * @throws UnknownDBException
+   * @throws MetaException
+   * @throws TException
+   * @see org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore.Iface#get_fields(java.lang.String, java.lang.String)
+   */
+  public List<FieldSchema> getFields(String db, String tableName) 
+      throws MetaException, TException, UnknownTableException, UnknownDBException {
+    return client.get_fields(db, tableName);
+  }
+
+  /**
+   * @param db
+   * @param tableName
+   * @throws UnknownTableException
+   * @throws UnknownDBException
+   * @throws MetaException
+   * @throws TException
+   * @see org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore.Iface#get_schema(java.lang.String, java.lang.String)
+   */
+  public List<FieldSchema> getSchema(String db, String tableName) 
+      throws MetaException, TException, UnknownTableException, UnknownDBException {
+    return client.get_schema(db, tableName);
+  }
 
 }
diff --git a/metastore/src/java/org/apache/hadoop/hive/metastore/IMetaStoreClient.java b/metastore/src/java/org/apache/hadoop/hive/metastore/IMetaStoreClient.java
index 1e21bb6517..d5fedaed36 100644
--- a/metastore/src/java/org/apache/hadoop/hive/metastore/IMetaStoreClient.java
+++ b/metastore/src/java/org/apache/hadoop/hive/metastore/IMetaStoreClient.java
@@ -21,6 +21,7 @@
 import java.util.List;
 
 import org.apache.hadoop.hive.metastore.api.AlreadyExistsException;
+import org.apache.hadoop.hive.metastore.api.FieldSchema;
 import org.apache.hadoop.hive.metastore.api.InvalidObjectException;
 import org.apache.hadoop.hive.metastore.api.InvalidOperationException;
 import org.apache.hadoop.hive.metastore.api.MetaException;
@@ -190,4 +191,27 @@ public boolean dropPartition(String db_name, String tbl_name, List<String> part_
   public void alter_partition(String dbName, String tblName,
       Partition newPart) throws InvalidOperationException, MetaException,
       TException;
+  
+  /**
+   * @param db
+   * @param tableName
+   * @throws UnknownTableException
+   * @throws UnknownDBException
+   * @throws MetaException
+   * @throws TException
+   * @see org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore.Iface#get_fields(java.lang.String, java.lang.String)
+   */
+  public List<FieldSchema> getFields(String db, String tableName) 
+      throws MetaException, TException, UnknownTableException, UnknownDBException;
+  /**
+   * @param db
+   * @param tableName
+   * @throws UnknownTableException
+   * @throws UnknownDBException
+   * @throws MetaException
+   * @throws TException
+   * @see org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore.Iface#get_schema(java.lang.String, java.lang.String)
+   */
+  public List<FieldSchema> getSchema(String db, String tableName) 
+      throws MetaException, TException, UnknownTableException, UnknownDBException;
 }
diff --git a/metastore/src/test/org/apache/hadoop/hive/metastore/TestHiveMetaStore.java b/metastore/src/test/org/apache/hadoop/hive/metastore/TestHiveMetaStore.java
index a67785269a..863e2a08c5 100644
--- a/metastore/src/test/org/apache/hadoop/hive/metastore/TestHiveMetaStore.java
+++ b/metastore/src/test/org/apache/hadoop/hive/metastore/TestHiveMetaStore.java
@@ -400,6 +400,8 @@ public void testSimpleTable() throws Exception {
     sd.getSerdeInfo().setName(tbl.getTableName());
     sd.getSerdeInfo().setParameters(new HashMap<String, String>());
     sd.getSerdeInfo().getParameters().put(org.apache.hadoop.hive.serde.Constants.SERIALIZATION_FORMAT, "1");
+    sd.getSerdeInfo().setSerializationLib(org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe.class.getName());
+    tbl.setPartitionKeys(new ArrayList<FieldSchema>());
     
     client.createTable(tbl);
     
@@ -420,6 +422,23 @@ public void testSimpleTable() throws Exception {
     tbl2.getParameters().put("EXTERNAL", "TRUE");
     tbl2.getSd().setLocation(tbl.getSd().getLocation() +"-2");
     
+    List<FieldSchema> fieldSchemas = client.getFields(dbName, tblName);
+    assertNotNull(fieldSchemas);
+    assertEquals(fieldSchemas.size(), tbl.getSd().getCols().size());
+    for (FieldSchema fs : tbl.getSd().getCols()) {
+      assertTrue(fieldSchemas.contains(fs));
+    }
+    
+    List<FieldSchema> fieldSchemasFull = client.getSchema(dbName, tblName);
+    assertNotNull(fieldSchemasFull);
+    assertEquals(fieldSchemasFull.size(), tbl.getSd().getCols().size()+tbl.getPartitionKeys().size());
+    for (FieldSchema fs : tbl.getSd().getCols()) {
+      assertTrue(fieldSchemasFull.contains(fs));
+    }
+    for (FieldSchema fs : tbl.getPartitionKeys()) {
+      assertTrue(fieldSchemasFull.contains(fs));
+    }
+    
     client.createTable(tbl2);
   
     Table tbl3 = client.getTable(dbName, tblName2);
@@ -432,6 +451,23 @@ public void testSimpleTable() throws Exception {
     assertEquals(tbl3.getSd().getLocation(), tbl2.getSd().getLocation());
     assertEquals(tbl3.getParameters(), tbl2.getParameters());
     
+    fieldSchemas = client.getFields(dbName, tblName2);
+    assertNotNull(fieldSchemas);
+    assertEquals(fieldSchemas.size(), tbl2.getSd().getCols().size());
+    for (FieldSchema fs : tbl2.getSd().getCols()) {
+      assertTrue(fieldSchemas.contains(fs));
+    }
+    
+    fieldSchemasFull = client.getSchema(dbName, tblName2);
+    assertNotNull(fieldSchemasFull);
+    assertEquals(fieldSchemasFull.size(), tbl2.getSd().getCols().size()+tbl2.getPartitionKeys().size());
+    for (FieldSchema fs : tbl2.getSd().getCols()) {
+      assertTrue(fieldSchemasFull.contains(fs));
+    }
+    for (FieldSchema fs : tbl2.getPartitionKeys()) {
+      assertTrue(fieldSchemasFull.contains(fs));
+    }
+    
   
     assertEquals("Use this for comments etc", tbl2.getSd().getParameters().get("test_param_1"));
     assertEquals("name", tbl2.getSd().getBucketCols().get(0));
@@ -574,6 +610,7 @@ public void testComplexTable() throws Exception {
       sd.getSerdeInfo().setName(tbl.getTableName());
       sd.getSerdeInfo().setParameters(new HashMap<String, String>());
       sd.getSerdeInfo().getParameters().put(org.apache.hadoop.hive.serde.Constants.SERIALIZATION_FORMAT, "9");
+      sd.getSerdeInfo().setSerializationLib(org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe.class.getName());
   
       tbl.setPartitionKeys(new ArrayList<FieldSchema>(2));
       tbl.getPartitionKeys().add(new FieldSchema("ds", org.apache.hadoop.hive.serde.Constants.DATE_TYPE_NAME, ""));
@@ -597,6 +634,23 @@ public void testComplexTable() throws Exception {
       assertEquals(Constants.INT_TYPE_NAME, tbl2.getPartitionKeys().get(1).getType());
       assertEquals("ds", tbl2.getPartitionKeys().get(0).getName());
       assertEquals("hr", tbl2.getPartitionKeys().get(1).getName());
+      
+      List<FieldSchema> fieldSchemas = client.getFields(dbName, tblName);
+      assertNotNull(fieldSchemas);
+      assertEquals(fieldSchemas.size(), tbl.getSd().getCols().size());
+      for (FieldSchema fs : tbl.getSd().getCols()) {
+        assertTrue(fieldSchemas.contains(fs));
+      }
+      
+      List<FieldSchema> fieldSchemasFull = client.getSchema(dbName, tblName);
+      assertNotNull(fieldSchemasFull);
+      assertEquals(fieldSchemasFull.size(), tbl.getSd().getCols().size()+tbl.getPartitionKeys().size());
+      for (FieldSchema fs : tbl.getSd().getCols()) {
+        assertTrue(fieldSchemasFull.contains(fs));
+      }
+      for (FieldSchema fs : tbl.getPartitionKeys()) {
+        assertTrue(fieldSchemasFull.contains(fs));
+      }
     } catch (Exception e) {
       System.err.println(StringUtils.stringifyException(e));
       System.err.println("testComplexTable() failed.");
