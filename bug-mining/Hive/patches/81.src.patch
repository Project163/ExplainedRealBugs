diff --git a/CHANGES.txt b/CHANGES.txt
index 85b42e89b6..ac6d147dae 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -23,6 +23,9 @@ Trunk (unreleased changes)
     HIVE-286. Use round(xxx,12) to make sure there is no precision
     matching problem in testCliDriver_udf7. (zshao via johan)    
 
+    HIVE-327. Fix row counts printed in hive history to reflect the
+    count of rows from the query in the session. (Suresh Anthony via athusoo)
+
 Release 0.2.0 - Unreleased
 
   INCOMPATIBLE CHANGES
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/Driver.java b/ql/src/java/org/apache/hadoop/hive/ql/Driver.java
index 2fc69060c2..e7a414c31b 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/Driver.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/Driver.java
@@ -267,7 +267,7 @@ public int run(String command) {
       if (SessionState.get() != null){
         SessionState.get().getHiveHistory().setQueryProperty(queryId,
             Keys.QUERY_RET_CODE, String.valueOf(0));
-        SessionState.get().getHiveHistory().printRowCount();
+        SessionState.get().getHiveHistory().printRowCount(queryId);
       }
     } catch (SemanticException e) {
       if (SessionState.get() != null)
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/history/HiveHistory.java b/ql/src/java/org/apache/hadoop/hive/ql/history/HiveHistory.java
index 00ea70304e..56ea5414a7 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/history/HiveHistory.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/history/HiveHistory.java
@@ -61,7 +61,6 @@ public class HiveHistory {
   // Task Hash Map
   private HashMap<String, TaskInfo> taskInfoMap = new HashMap<String, TaskInfo>();
   
-  private HashMap<String, Long> rowCountMap = new HashMap<String, Long>();
 
   private static final String DELIMITER = " ";
 
@@ -164,6 +163,7 @@ public static class SessionInfo extends Info {
 
   public static class QueryInfo extends Info {
     public Map<String, String> hm = new HashMap<String, String>();
+    public Map<String, Long> rowCountMap = new HashMap<String, Long>();
   };
 
   public static class TaskInfo extends Info {
@@ -307,6 +307,7 @@ public void setTaskProperty(String queryId, String taskId, Keys propName,
    */
   public void setTaskCounters(String queryId, String taskId, RunningJob rj) {
     String id = queryId + ":" + taskId;
+    QueryInfo ji = queryInfoMap.get(queryId);
     StringBuilder sb1 = new StringBuilder("");
     TaskInfo ti = taskInfoMap.get(id);
     if (ti == null)
@@ -334,7 +335,7 @@ public void setTaskCounters(String queryId, String taskId, RunningJob rj) {
             sb1.append(tab);
             sb1.append('~');
             sb1.append(counter.getCounter());
-            rowCountMap.put(tab, counter.getCounter());
+            ji.rowCountMap.put(tab, counter.getCounter());
             
             
           }
@@ -355,9 +356,10 @@ public void setTaskCounters(String queryId, String taskId, RunningJob rj) {
       taskInfoMap.get(id).hm.put(Keys.TASK_COUNTERS.name(), sb.toString());
   }
 
-  public void printRowCount(){
-    for (String tab: rowCountMap.keySet()){
-      console.printInfo(rowCountMap.get(tab)+" Rows loaded to "+ tab);
+  public void printRowCount(String queryId){
+    QueryInfo ji = queryInfoMap.get(queryId);
+    for (String tab: ji.rowCountMap.keySet()){
+      console.printInfo(ji.rowCountMap.get(tab)+" Rows loaded to "+ tab);
     }
   }
   /**
