diff --git a/eclipse-templates/.classpath b/eclipse-templates/.classpath
index 1af41feb47..7d682a4e75 100644
--- a/eclipse-templates/.classpath
+++ b/eclipse-templates/.classpath
@@ -75,6 +75,7 @@
   <classpathentry kind="lib" path="build/ivy/lib/default/commons-collections-@commons-collections.version@.jar"/>
   <classpathentry kind="lib" path="build/ivy/lib/default/bonecp-@BoneCP.version@.jar"/>
   <classpathentry kind="lib" path="build/ivy/lib/default/commons-pool-@commons-pool.version@.jar"/>
+  <classpathentry kind="lib" path="build/ivy/lib/default/commons-lang3-@commons-lang3.version@.jar"/>
   <classpathentry kind="lib" path="build/ivy/lib/default/slf4j-api-@slf4j-api.version@.jar"/>
   <classpathentry kind="lib" path="build/ivy/lib/default/slf4j-log4j12-@slf4j-log4j12.version@.jar"/>
   <classpathentry kind="lib" path="build/ivy/lib/default/JavaEWAH-@javaewah.version@.jar"/>
diff --git a/ivy/libraries.properties b/ivy/libraries.properties
index d94277745f..63ae73f75f 100644
--- a/ivy/libraries.properties
+++ b/ivy/libraries.properties
@@ -40,6 +40,7 @@ commons-lang.version=2.4
 commons-logging.version=1.0.4
 commons-logging-api.version=1.0.4
 commons-pool.version=1.5.4
+commons-lang3.version=3.1
 derby.version=10.4.2.0
 guava.version=11.0.2
 hbase.version=0.94.6.1
diff --git a/ql/ivy.xml b/ql/ivy.xml
index 276c2ffe4e..d0159d983e 100644
--- a/ql/ivy.xml
+++ b/ql/ivy.xml
@@ -66,7 +66,8 @@
     <dependency org="org.json" name="json" rev="${json.version}"/>
     <dependency org="commons-collections" name="commons-collections" rev="${commons-collections.version}"/>
     <dependency org="commons-configuration" name="commons-configuration" rev="${commons-configuration.version}"
-                transitive="false"/>
+      transitive="false"/>
+    <dependency org="org.apache.commons" name="commons-lang3" rev="${commons-lang3.version}"/>
     <dependency org="com.googlecode.javaewah" name="JavaEWAH" rev="${javaewah.version}"/>
     <dependency org="javolution" name="javolution" rev="${javolution.version}"/>
 
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/tez/TezTask.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/tez/TezTask.java
index ed78589edf..798f4a30cf 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/tez/TezTask.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/tez/TezTask.java
@@ -174,10 +174,8 @@ private DAG build(JobConf conf, TezWork work, Path scratchDir,
       for (BaseWork v: work.getChildren(w)) {
         assert workToVertex.containsKey(v);
         Edge e = null;
-        EdgeType edgeType = EdgeType.SIMPLE_EDGE;
-        if (work.isBroadCastEdge(w, v)) {
-          edgeType = EdgeType.BROADCAST_EDGE;
-        }
+
+        EdgeType edgeType = work.getEdgeProperty(w, v);
 
         e = DagUtils.createEdge(wxConf, wx, workToConf.get(v), workToVertex.get(v), edgeType);
         dag.addEdge(e);
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/plan/TezWork.java b/ql/src/java/org/apache/hadoop/hive/ql/plan/TezWork.java
index 6db009965b..5e0ff0f348 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/plan/TezWork.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/plan/TezWork.java
@@ -25,6 +25,8 @@
 import java.util.Map;
 import java.util.Set;
 
+import org.apache.commons.lang3.tuple.ImmutablePair;
+import org.apache.commons.lang3.tuple.Pair;
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
 
@@ -49,7 +51,8 @@ public enum EdgeType {
   private final Set<BaseWork> leaves = new HashSet<BaseWork>();
   private final Map<BaseWork, List<BaseWork>> workGraph = new HashMap<BaseWork, List<BaseWork>>();
   private final Map<BaseWork, List<BaseWork>> invertedWorkGraph = new HashMap<BaseWork, List<BaseWork>>();
-  private final Map<BaseWork, List<BaseWork>> broadcastEdge = new HashMap<BaseWork, List<BaseWork>>();
+  private final Map<Pair<BaseWork, BaseWork>, EdgeType> edgeProperties =
+      new HashMap<Pair<BaseWork, BaseWork>, EdgeType>();
 
   /**
    * getAllWork returns a topologically sorted list of BaseWork
@@ -95,7 +98,6 @@ public void add(BaseWork w) {
     }
     workGraph.put(w, new LinkedList<BaseWork>());
     invertedWorkGraph.put(w, new LinkedList<BaseWork>());
-    broadcastEdge.put(w, new LinkedList<BaseWork>());
     roots.add(w);
     leaves.add(w);
   }
@@ -109,13 +111,8 @@ public void connect(BaseWork a, BaseWork b, EdgeType edgeType) {
     invertedWorkGraph.get(b).add(a);
     roots.remove(b);
     leaves.remove(a);
-    switch (edgeType) {
-    case BROADCAST_EDGE:
-      broadcastEdge.get(a).add(b);
-      break;
-    default:
-      break;
-    }
+    ImmutablePair workPair = new ImmutablePair(a, b);
+    edgeProperties.put(workPair, edgeType);
   }
 
   /**
@@ -201,11 +198,7 @@ public void remove(BaseWork work) {
     invertedWorkGraph.remove(work);
   }
 
-  // checks if a and b need a broadcast edge between them
-  public boolean isBroadCastEdge(BaseWork a, BaseWork b) {
-    if ((broadcastEdge.get(a).contains(b)) || (broadcastEdge.get(b).contains(a))) {
-      return true;
-    }
-    return false;
+  public EdgeType getEdgeProperty(BaseWork a, BaseWork b) {
+    return edgeProperties.get(new ImmutablePair(a,b));
   }
 }
diff --git a/ql/src/test/org/apache/hadoop/hive/ql/plan/TestTezWork.java b/ql/src/test/org/apache/hadoop/hive/ql/plan/TestTezWork.java
index c4c3ddf997..a11d418966 100644
--- a/ql/src/test/org/apache/hadoop/hive/ql/plan/TestTezWork.java
+++ b/ql/src/test/org/apache/hadoop/hive/ql/plan/TestTezWork.java
@@ -77,6 +77,8 @@ public void testConnect() throws Exception {
       Assert.assertEquals(work.getParents(w).size(), 0);
       Assert.assertEquals(work.getChildren(w).size(), 0);
     }
+
+    Assert.assertEquals(work.getEdgeProperty(parent, child), EdgeType.SIMPLE_EDGE);
   }
 
   @Test
@@ -99,6 +101,8 @@ public void testBroadcastConnect() throws Exception {
       Assert.assertEquals(work.getParents(w).size(), 0);
       Assert.assertEquals(work.getChildren(w).size(), 0);
     }
+
+    Assert.assertEquals(work.getEdgeProperty(parent, child), EdgeType.BROADCAST_EDGE);
   }
 
   @Test
