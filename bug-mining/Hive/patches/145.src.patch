diff --git a/CHANGES.txt b/CHANGES.txt
index 79cdf458be..e64ad38dbb 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -120,6 +120,9 @@ Trunk - Unreleased
     HIVE-453. Use FileSystem derived from user supplied path when present
     instead of default. (Joydeep Sen Sarma via prasadc)
 
+    HIVE-442. Create partitions after data is moved in the query
+    in order to close out an inconsistent window. (Prasad Chakka via athusoo)
+
 Release 0.3.1 - Unreleased
 
   INCOMPATIBLE CHANGES
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/BaseSemanticAnalyzer.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/BaseSemanticAnalyzer.java
index c7998a2541..5803c44165 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/BaseSemanticAnalyzer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/BaseSemanticAnalyzer.java
@@ -25,6 +25,7 @@
 
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
+import org.apache.hadoop.hive.metastore.MetaStoreUtils;
 import org.apache.hadoop.hive.ql.Context;
 import org.apache.hadoop.hive.ql.metadata.*;
 import org.apache.hadoop.hive.conf.HiveConf;
@@ -259,7 +260,7 @@ public static class tableSpec {
     public HashMap<String, String> partSpec;
     public Partition partHandle;
 
-    public tableSpec(Hive db, ASTNode ast, boolean forceCreatePartition) throws SemanticException {
+    public tableSpec(Hive db, ASTNode ast) throws SemanticException {
 
       assert(ast.getToken().getType() == HiveParser.TOK_TAB);
       int childIndex = 0;
@@ -267,28 +268,29 @@ public tableSpec(Hive db, ASTNode ast, boolean forceCreatePartition) throws Sema
       try {
         // get table metadata
         tableName = unescapeIdentifier(ast.getChild(0).getText());
-        tableHandle = db.getTable(tableName);
-
-        // get partition metadata if partition specified
-        if (ast.getChildCount() == 2) {
-          childIndex = 1;
-          ASTNode partspec = (ASTNode) ast.getChild(1);
-          partSpec = new LinkedHashMap<String, String>();
-          for (int i = 0; i < partspec.getChildCount(); ++i) {
-            ASTNode partspec_val = (ASTNode) partspec.getChild(i);
-            String val = stripQuotes(partspec_val.getChild(1).getText());
-            partSpec.put(unescapeIdentifier(partspec_val.getChild(0).getText()), val);
-          }
-          partHandle = Hive.get().getPartition(tableHandle, partSpec, forceCreatePartition);
-          if(partHandle == null) {
-            throw new SemanticException(ErrorMsg.INVALID_PARTITION.getMsg(ast.getChild(childIndex)));
-          }
-        }
+        tableHandle = db.getTable(MetaStoreUtils.DEFAULT_DATABASE_NAME, tableName);
       } catch (InvalidTableException ite) {
         throw new SemanticException(ErrorMsg.INVALID_TABLE.getMsg(ast.getChild(0)), ite);
       } catch (HiveException e) {
         throw new SemanticException(ErrorMsg.GENERIC_ERROR.getMsg(ast.getChild(childIndex), e.getMessage()), e);
       }
+      // get partition metadata if partition specified
+      if (ast.getChildCount() == 2) {
+        childIndex = 1;
+        ASTNode partspec = (ASTNode) ast.getChild(1);
+        partSpec = new LinkedHashMap<String, String>();
+        for (int i = 0; i < partspec.getChildCount(); ++i) {
+          ASTNode partspec_val = (ASTNode) partspec.getChild(i);
+          String val = stripQuotes(partspec_val.getChild(1).getText());
+          partSpec.put(unescapeIdentifier(partspec_val.getChild(0).getText()), val);
+        }
+        try {
+          // this doesn't create partition. partition is created in MoveTask
+          partHandle = new Partition(tableHandle, partSpec, null);
+        } catch (HiveException e) {
+          throw new SemanticException(ErrorMsg.INVALID_PARTITION.getMsg(ast.getChild(childIndex)));
+        }
+      }
     }
 
 
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/LoadSemanticAnalyzer.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/LoadSemanticAnalyzer.java
index abc6653e71..1b423ed949 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/LoadSemanticAnalyzer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/LoadSemanticAnalyzer.java
@@ -177,7 +177,7 @@ public void analyzeInternal(ASTNode ast, Context ctx) throws SemanticException {
     }
 
     // initialize destination table/partition
-    tableSpec ts = new tableSpec(db, (ASTNode) table_t, true);
+    tableSpec ts = new tableSpec(db, (ASTNode) table_t);
     URI toURI = (ts.partHandle != null) ? ts.partHandle.getDataLocation() : ts.tableHandle.getDataLocation();
 
     // make sure the arguments make sense
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
index 7672957b36..7f4dc60137 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
@@ -721,7 +721,7 @@ public void getMetaData(QB qb) throws SemanticException {
         ASTNode ast = qbp.getDestForClause(name);
         switch (ast.getToken().getType()) {
         case HiveParser.TOK_TAB: {
-          tableSpec ts = new tableSpec(this.db, ast, true);
+          tableSpec ts = new tableSpec(this.db, ast);
 
           if (!HiveOutputFormat.class.isAssignableFrom(ts.tableHandle.getOutputFormatClass()))
             throw new SemanticException(ErrorMsg.INVALID_OUTPUT_FORMAT_TYPE.getMsg(ast));
diff --git a/ql/src/test/queries/clientpositive/loadpart_err.q b/ql/src/test/queries/clientpositive/loadpart_err.q
new file mode 100644
index 0000000000..8fadc3a556
--- /dev/null
+++ b/ql/src/test/queries/clientpositive/loadpart_err.q
@@ -0,0 +1,15 @@
+set hive.cli.errors.ignore=true;
+DROP TABLE loadpart1;
+CREATE TABLE loadpart1(a STRING, b STRING) PARTITIONED BY (ds STRING);
+
+INSERT OVERWRITE TABLE loadpart1 PARTITION (ds='2009-01-01')
+SELECT TRANSFORM(src.key, src.value) USING '../data/scripts/error_script' AS (tkey, tvalue)
+FROM src;
+
+DESCRIBE loadpart1;
+SHOW PARTITIONS loadpart1;
+
+LOAD DATA LOCAL INPATH '../data1/files/kv1.txt' INTO TABLE loadpart1 PARTITION(ds='2009-05-05');
+SHOW PARTITIONS loadpart1;
+
+DROP TABLE loadpart1;
diff --git a/ql/src/test/results/clientpositive/loadpart_err.q.out b/ql/src/test/results/clientpositive/loadpart_err.q.out
new file mode 100644
index 0000000000..7dffe2eb8b
--- /dev/null
+++ b/ql/src/test/results/clientpositive/loadpart_err.q.out
@@ -0,0 +1,16 @@
+query: DROP TABLE loadpart1
+query: CREATE TABLE loadpart1(a STRING, b STRING) PARTITIONED BY (ds STRING)
+query: INSERT OVERWRITE TABLE loadpart1 PARTITION (ds='2009-01-01')
+SELECT TRANSFORM(src.key, src.value) USING '../data/scripts/error_script' AS (tkey, tvalue)
+FROM src
+Input: default/src
+Output: default/loadpart1/ds=2009-01-01
+FAILED: Execution Error, return code 2 from org.apache.hadoop.hive.ql.exec.MapRedTask
+query: DESCRIBE loadpart1
+a	string	
+b	string	
+ds	string	
+query: SHOW PARTITIONS loadpart1
+FAILED: Error in semantic analysis: line 3:23 Invalid Path '../data1/files/kv1.txt': No files matching path file:/data/users/pchakka/workspace/oshive/data1/files/kv1.txt
+query: SHOW PARTITIONS loadpart1
+query: DROP TABLE loadpart1
