diff --git a/CHANGES.txt b/CHANGES.txt
index caef511223..d20b6c357a 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -745,6 +745,10 @@ Trunk -  Unreleased
 
     HIVE-1934 Alter table rename messes the location
     (Paul Yang via namit)
+
+    HIVE-1944 Dynamic partition insert creating different directories for the
+    same partition during merge (Ning Zhang via namit)
+
   TESTS
 
     HIVE-1464. improve  test query performance
diff --git a/eclipse-templates/.classpath b/eclipse-templates/.classpath
index d95192774f..e40a07ac4a 100644
--- a/eclipse-templates/.classpath
+++ b/eclipse-templates/.classpath
@@ -16,11 +16,11 @@
   <classpathentry exported="true" kind="lib" path="lib/commons-logging-@commons-logging.version@.jar"/>
   <classpathentry exported="true" kind="lib" path="lib/commons-logging-api-@commons-logging-api.version@.jar"/>
   <classpathentry exported="true" kind="lib" path="lib/derby.jar"/>
-  <classpathentry exported="true" kind="lib" path="lib/hbase-@hbase.version@.jar"/>
-  <classpathentry exported="true" kind="lib" path="lib/hbase-@hbase-test.version@-test.jar"/>
+  <classpathentry exported="true" kind="lib" path="build/dist/lib/hbase-@hbase.version@.jar"/>
+  <classpathentry exported="true" kind="lib" path="build/dist/lib/hbase-@hbase-test.version@-tests.jar"/>
   <classpathentry exported="true" kind="lib" path="lib/thrift-fb303-@thrift-fb303.version@.jar"/>
   <classpathentry exported="true" kind="lib" path="lib/thrift-@thrift.version@.jar"/>
-  <classpathentry exported="true" kind="lib" path="lib/zookeeper-@zookeeper.version@.jar"/>
+  <classpathentry exported="true" kind="lib" path="build/dist/lib/zookeeper-@zookeeper.version@.jar"/>
   <classpathentry exported="true" kind="lib" path="lib/log4j-@log4j.version@.jar"/>
   <classpathentry exported="true" kind="lib" path="ql/lib/antlr-@antlr.version@.jar"/>
   <classpathentry exported="true" kind="lib" path="ql/lib/antlr-runtime-@antlr-runtime.version@.jar"/>
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/plan/ConditionalResolverMergeFiles.java b/ql/src/java/org/apache/hadoop/hive/ql/plan/ConditionalResolverMergeFiles.java
index ef996b960a..4a847da53e 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/plan/ConditionalResolverMergeFiles.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/plan/ConditionalResolverMergeFiles.java
@@ -21,6 +21,7 @@
 import java.io.IOException;
 import java.io.Serializable;
 import java.util.ArrayList;
+import java.util.Iterator;
 import java.util.LinkedHashMap;
 import java.util.List;
 import java.util.Map;
@@ -177,13 +178,13 @@ public List<Task<? extends Serializable>> getTasks(HiveConf conf,
             // add the merge MR job
             setupMapRedWork(conf, work, trgtSize, totalSz);
             resTsks.add(mrTask);
-            
+
             // add the move task for those partitions that do not need merging
           	if (toMove.size() > 0) { //
           	  // modify the existing move task as it is already in the candidate running tasks
           	  MoveWork mvWork = (MoveWork) mvTask.getWork();
           	  LoadFileDesc lfd = mvWork.getLoadFileWork();
-          	  
+
           	  String targetDir = lfd.getTargetDir();
           	  List<String> targetDirs = new ArrayList<String>(toMove.size());
           	  int numDPCols = dpCtx.getNumDPCols();
@@ -200,7 +201,7 @@ public List<Task<? extends Serializable>> getTasks(HiveConf conf,
                   target = target + Path.SEPARATOR + moveStrSplits[dpIndex];
                   dpIndex ++;
                 }
-                
+
                 targetDirs.add(target);
               }
 
@@ -209,7 +210,21 @@ public List<Task<? extends Serializable>> getTasks(HiveConf conf,
           	  mvWork.setLoadFileWork(null);
           	  mvWork.setLoadTableWork(null);
           	  mvWork.setMultiFilesDesc(lmfd);
-          	  resTsks.add(mvTask);
+
+          	  // running the MoveTask and MR task in parallel may
+          	  // cause the mvTask write to /ds=1 and MR task write
+          	  // to /ds=1_1 for the same partition.
+          	  // make the MoveTask as the child of the MR Task
+          	  List<Task <? extends Serializable>> cTasks = mrTask.getDependentTasks();
+          	  if (cTasks != null) {
+          	    Iterator<Task <? extends Serializable>> itr = cTasks.iterator();
+          	    while (itr.hasNext()) {
+          	      Task<? extends Serializable> cld = itr.next();
+          	      itr.remove();
+          	      mvTask.addDependentTask(cld);
+          	    }
+          	  }
+          	  mrTask.addDependentTask(mvTask);
           	}
           } else { // add the move task
             resTsks.add(mvTask);
@@ -263,7 +278,7 @@ private long getMergeSize(FileSystem inpFs, Path dirPath, long avgSize) {
       for (FileStatus fStat : fStats) {
         totalSz += fStat.getLen();
       }
-      
+
       if (totalSz < avgSize * fStats.length) {
         return totalSz;
       } else {
