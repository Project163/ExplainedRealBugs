diff --git a/itests/src/test/resources/testconfiguration.properties b/itests/src/test/resources/testconfiguration.properties
index 07fd5bfe48..ac62dcc2b6 100644
--- a/itests/src/test/resources/testconfiguration.properties
+++ b/itests/src/test/resources/testconfiguration.properties
@@ -912,6 +912,7 @@ spark.query.files=add_part_multiple.q, \
   escape_distributeby1.q, \
   escape_orderby1.q, \
   escape_sortby1.q, \
+  explaindenpendencydiffengs.q, \
   filter_join_breaktask.q, \
   filter_join_breaktask2.q, \
   groupby1.q, \
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/spark/GenSparkUtils.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/spark/GenSparkUtils.java
index d0a82afee6..b9901dacf2 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/spark/GenSparkUtils.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/spark/GenSparkUtils.java
@@ -157,10 +157,20 @@ public MapWork createMapWork(GenSparkProcContext context, Operator<?> root,
     Preconditions.checkArgument(root instanceof TableScanOperator,
       "AssertionError: expected root to be an instance of TableScanOperator, but was "
       + root.getClass().getName());
-    String alias = ((TableScanOperator) root).getConf().getAlias();
-
+    String alias_id = null;
+    if (context.parseContext != null && context.parseContext.getTopOps() != null) {
+      for (String currentAliasID : context.parseContext.getTopOps().keySet()) {
+        Operator<? extends OperatorDesc> currOp = context.parseContext.getTopOps().get(currentAliasID);
+        if (currOp == root) {
+          alias_id = currentAliasID;
+          break;
+        }
+      }
+    }
+    if (alias_id == null)
+      alias_id = ((TableScanOperator) root).getConf().getAlias();
     if (!deferSetup) {
-      setupMapWork(mapWork, context, partitions,(TableScanOperator) root, alias);
+      setupMapWork(mapWork, context, partitions,(TableScanOperator) root, alias_id);
     }
 
     // add new item to the Spark work
@@ -172,10 +182,10 @@ public MapWork createMapWork(GenSparkProcContext context, Operator<?> root,
   // this method's main use is to help unit testing this class
   protected void setupMapWork(MapWork mapWork, GenSparkProcContext context,
       PrunedPartitionList partitions, TableScanOperator root,
-      String alias) throws SemanticException {
+      String alias_id) throws SemanticException {
     // All the setup is done in GenMapRedUtils
     GenMapRedUtils.setMapWork(mapWork, context.parseContext,
-        context.inputs, partitions, root, alias, context.conf, false);
+        context.inputs, partitions, root, alias_id, context.conf, false);
   }
 
   private void collectOperators(Operator<?> op, List<Operator<?>> opList) {
diff --git a/ql/src/test/queries/clientpositive/explaindenpendencydiffengs.q b/ql/src/test/queries/clientpositive/explaindenpendencydiffengs.q
new file mode 100644
index 0000000000..38f9affe18
--- /dev/null
+++ b/ql/src/test/queries/clientpositive/explaindenpendencydiffengs.q
@@ -0,0 +1,10 @@
+drop table if exists dependtest;
+create table dependtest (a string) partitioned by (b int);
+insert into table dependtest partition (b=1) values ("hello");
+create view viewtest as select * from dependtest where b = 1;
+set hive.cbo.enable=false;
+set hive.compute.query.using.stats=false;
+explain dependency select count(*) from viewtest ;
+drop view viewtest;
+drop table dependtest;
+
diff --git a/ql/src/test/results/clientpositive/explaindenpendencydiffengs.q.out b/ql/src/test/results/clientpositive/explaindenpendencydiffengs.q.out
new file mode 100644
index 0000000000..bf1c78135e
--- /dev/null
+++ b/ql/src/test/results/clientpositive/explaindenpendencydiffengs.q.out
@@ -0,0 +1,52 @@
+PREHOOK: query: drop table if exists dependtest
+PREHOOK: type: DROPTABLE
+POSTHOOK: query: drop table if exists dependtest
+POSTHOOK: type: DROPTABLE
+PREHOOK: query: create table dependtest (a string) partitioned by (b int)
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@dependtest
+POSTHOOK: query: create table dependtest (a string) partitioned by (b int)
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@dependtest
+PREHOOK: query: insert into table dependtest partition (b=1) values ("hello")
+PREHOOK: type: QUERY
+PREHOOK: Output: default@dependtest@b=1
+POSTHOOK: query: insert into table dependtest partition (b=1) values ("hello")
+POSTHOOK: type: QUERY
+POSTHOOK: Output: default@dependtest@b=1
+POSTHOOK: Lineage: dependtest PARTITION(b=1).a SIMPLE [(values__tmp__table__1)values__tmp__table__1.FieldSchema(name:tmp_values_col1, type:string, comment:), ]
+PREHOOK: query: create view viewtest as select * from dependtest where b = 1
+PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@dependtest
+PREHOOK: Output: database:default
+PREHOOK: Output: default@viewtest
+POSTHOOK: query: create view viewtest as select * from dependtest where b = 1
+POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@dependtest
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@viewtest
+POSTHOOK: Lineage: viewtest.a SIMPLE [(dependtest)dependtest.FieldSchema(name:a, type:string, comment:null), ]
+POSTHOOK: Lineage: viewtest.b SIMPLE []
+PREHOOK: query: explain dependency select count(*) from viewtest
+PREHOOK: type: QUERY
+POSTHOOK: query: explain dependency select count(*) from viewtest
+POSTHOOK: type: QUERY
+{"input_tables":[{"tablename":"default@viewtest","tabletype":"VIRTUAL_VIEW"},{"tablename":"default@dependtest","tabletype":"MANAGED_TABLE","tableParents":"[default@viewtest]"}],"input_partitions":[{"partitionName":"default@dependtest@b=1","partitionParents":"[default@viewtest]"}]}
+PREHOOK: query: drop view viewtest
+PREHOOK: type: DROPVIEW
+PREHOOK: Input: default@viewtest
+PREHOOK: Output: default@viewtest
+POSTHOOK: query: drop view viewtest
+POSTHOOK: type: DROPVIEW
+POSTHOOK: Input: default@viewtest
+POSTHOOK: Output: default@viewtest
+PREHOOK: query: drop table dependtest
+PREHOOK: type: DROPTABLE
+PREHOOK: Input: default@dependtest
+PREHOOK: Output: default@dependtest
+POSTHOOK: query: drop table dependtest
+POSTHOOK: type: DROPTABLE
+POSTHOOK: Input: default@dependtest
+POSTHOOK: Output: default@dependtest
diff --git a/ql/src/test/results/clientpositive/spark/auto_join_reordering_values.q.out b/ql/src/test/results/clientpositive/spark/auto_join_reordering_values.q.out
index 4527b35ae1..29b4419e94 100644
--- a/ql/src/test/results/clientpositive/spark/auto_join_reordering_values.q.out
+++ b/ql/src/test/results/clientpositive/spark/auto_join_reordering_values.q.out
@@ -167,7 +167,7 @@ STAGE PLANS:
                     name: default.orderpayment_small
                   name: default.orderpayment_small
             Truncated Path -> Alias:
-              /orderpayment_small [orderpayment]
+              /orderpayment_small [$hdt$_0:orderpayment]
         Map 6 
             Map Operator Tree:
                 TableScan
@@ -240,7 +240,7 @@ STAGE PLANS:
                     name: default.orderpayment_small
                   name: default.orderpayment_small
             Truncated Path -> Alias:
-              /orderpayment_small [dim_pay_date]
+              /orderpayment_small [$hdt$_1:dim_pay_date]
         Map 7 
             Map Operator Tree:
                 TableScan
@@ -313,7 +313,7 @@ STAGE PLANS:
                     name: default.orderpayment_small
                   name: default.orderpayment_small
             Truncated Path -> Alias:
-              /orderpayment_small [deal]
+              /orderpayment_small [$hdt$_2:deal]
         Map 8 
             Map Operator Tree:
                 TableScan
@@ -386,7 +386,7 @@ STAGE PLANS:
                     name: default.orderpayment_small
                   name: default.orderpayment_small
             Truncated Path -> Alias:
-              /orderpayment_small [order_city]
+              /orderpayment_small [$hdt$_3:order_city]
         Map 9 
             Map Operator Tree:
                 TableScan
@@ -459,7 +459,7 @@ STAGE PLANS:
                     name: default.user_small
                   name: default.user_small
             Truncated Path -> Alias:
-              /user_small [user]
+              /user_small [$hdt$_4:user]
         Reducer 2 
             Needs Tagging: true
             Reduce Operator Tree:
diff --git a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_1.q.out b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_1.q.out
index 49725924f4..e6038b857d 100644
--- a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_1.q.out
+++ b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_1.q.out
@@ -608,7 +608,7 @@ STAGE PLANS:
                     name: default.bucket_small
                   name: default.bucket_small
             Truncated Path -> Alias:
-              /bucket_small/ds=2008-04-08 [b]
+              /bucket_small/ds=2008-04-08 [$hdt$_1:b]
 
   Stage: Stage-1
     Spark
@@ -762,8 +762,8 @@ STAGE PLANS:
                     name: default.bucket_big
                   name: default.bucket_big
             Truncated Path -> Alias:
-              /bucket_big/ds=2008-04-08 [a]
-              /bucket_big/ds=2008-04-09 [a]
+              /bucket_big/ds=2008-04-08 [$hdt$_0:a]
+              /bucket_big/ds=2008-04-09 [$hdt$_0:a]
         Reducer 2 
             Needs Tagging: false
             Reduce Operator Tree:
diff --git a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_12.q.out b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_12.q.out
index a2fe5287b8..d76360de6c 100644
--- a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_12.q.out
+++ b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_12.q.out
@@ -224,7 +224,7 @@ STAGE PLANS:
                     name: default.bucket_small
                   name: default.bucket_small
             Truncated Path -> Alias:
-              /bucket_small/ds=2008-04-08 [a]
+              /bucket_small/ds=2008-04-08 [$hdt$_0:a]
         Map 2 
             Map Operator Tree:
                 TableScan
@@ -300,7 +300,7 @@ STAGE PLANS:
                     name: default.bucket_medium
                   name: default.bucket_medium
             Truncated Path -> Alias:
-              /bucket_medium/ds=2008-04-08 [b]
+              /bucket_medium/ds=2008-04-08 [$hdt$_1:b]
         Map 5 
             Map Operator Tree:
                 TableScan
@@ -369,7 +369,7 @@ STAGE PLANS:
                     name: default.bucket_medium
                   name: default.bucket_medium
             Truncated Path -> Alias:
-              /bucket_medium/ds=2008-04-08 [d]
+              /bucket_medium/ds=2008-04-08 [$hdt$_3:d]
 
   Stage: Stage-1
     Spark
@@ -530,8 +530,8 @@ STAGE PLANS:
                     name: default.bucket_big
                   name: default.bucket_big
             Truncated Path -> Alias:
-              /bucket_big/ds=2008-04-08 [c]
-              /bucket_big/ds=2008-04-09 [c]
+              /bucket_big/ds=2008-04-08 [$hdt$_2:c]
+              /bucket_big/ds=2008-04-09 [$hdt$_2:c]
         Reducer 4 
             Needs Tagging: false
             Reduce Operator Tree:
diff --git a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_3.q.out b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_3.q.out
index 7091236afd..3ad950a107 100644
--- a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_3.q.out
+++ b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_3.q.out
@@ -539,8 +539,8 @@ STAGE PLANS:
                     name: default.bucket_small
                   name: default.bucket_small
             Truncated Path -> Alias:
-              /bucket_small/ds=2008-04-08 [b]
-              /bucket_small/ds=2008-04-09 [b]
+              /bucket_small/ds=2008-04-08 [$hdt$_1:b]
+              /bucket_small/ds=2008-04-09 [$hdt$_1:b]
 
   Stage: Stage-1
     Spark
@@ -645,7 +645,7 @@ STAGE PLANS:
                     name: default.bucket_big
                   name: default.bucket_big
             Truncated Path -> Alias:
-              /bucket_big/ds=2008-04-08 [a]
+              /bucket_big/ds=2008-04-08 [$hdt$_0:a]
         Reducer 2 
             Needs Tagging: false
             Reduce Operator Tree:
diff --git a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_4.q.out b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_4.q.out
index 6a40c48caa..60437ec56d 100644
--- a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_4.q.out
+++ b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_4.q.out
@@ -555,8 +555,8 @@ STAGE PLANS:
                     name: default.bucket_small
                   name: default.bucket_small
             Truncated Path -> Alias:
-              /bucket_small/ds=2008-04-08 [b]
-              /bucket_small/ds=2008-04-09 [b]
+              /bucket_small/ds=2008-04-08 [$hdt$_1:b]
+              /bucket_small/ds=2008-04-09 [$hdt$_1:b]
 
   Stage: Stage-1
     Spark
@@ -661,7 +661,7 @@ STAGE PLANS:
                     name: default.bucket_big
                   name: default.bucket_big
             Truncated Path -> Alias:
-              /bucket_big/ds=2008-04-08 [a]
+              /bucket_big/ds=2008-04-08 [$hdt$_0:a]
         Reducer 2 
             Needs Tagging: false
             Reduce Operator Tree:
diff --git a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_5.q.out b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_5.q.out
index e3eddb54b2..50468e94ea 100644
--- a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_5.q.out
+++ b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_5.q.out
@@ -456,7 +456,7 @@ STAGE PLANS:
                     name: default.bucket_small
                   name: default.bucket_small
             Truncated Path -> Alias:
-              /bucket_small [b]
+              /bucket_small [$hdt$_1:b]
 
   Stage: Stage-1
     Spark
@@ -560,7 +560,7 @@ STAGE PLANS:
                     name: default.bucket_big
                   name: default.bucket_big
             Truncated Path -> Alias:
-              /bucket_big [a]
+              /bucket_big [$hdt$_0:a]
         Reducer 2 
             Needs Tagging: false
             Reduce Operator Tree:
diff --git a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_7.q.out b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_7.q.out
index 87b6e6a36d..16ecabe05d 100644
--- a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_7.q.out
+++ b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_7.q.out
@@ -676,8 +676,8 @@ STAGE PLANS:
                     name: default.bucket_small
                   name: default.bucket_small
             Truncated Path -> Alias:
-              /bucket_small/ds=2008-04-08 [b]
-              /bucket_small/ds=2008-04-09 [b]
+              /bucket_small/ds=2008-04-08 [$hdt$_1:b]
+              /bucket_small/ds=2008-04-09 [$hdt$_1:b]
 
   Stage: Stage-1
     Spark
@@ -831,8 +831,8 @@ STAGE PLANS:
                     name: default.bucket_big
                   name: default.bucket_big
             Truncated Path -> Alias:
-              /bucket_big/ds=2008-04-08 [a]
-              /bucket_big/ds=2008-04-09 [a]
+              /bucket_big/ds=2008-04-08 [$hdt$_0:a]
+              /bucket_big/ds=2008-04-09 [$hdt$_0:a]
         Reducer 2 
             Needs Tagging: false
             Reduce Operator Tree:
diff --git a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_8.q.out b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_8.q.out
index 1963b7f5c1..e180471dcb 100644
--- a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_8.q.out
+++ b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_8.q.out
@@ -676,8 +676,8 @@ STAGE PLANS:
                     name: default.bucket_small
                   name: default.bucket_small
             Truncated Path -> Alias:
-              /bucket_small/ds=2008-04-08 [b]
-              /bucket_small/ds=2008-04-09 [b]
+              /bucket_small/ds=2008-04-08 [$hdt$_1:b]
+              /bucket_small/ds=2008-04-09 [$hdt$_1:b]
 
   Stage: Stage-1
     Spark
@@ -831,8 +831,8 @@ STAGE PLANS:
                     name: default.bucket_big
                   name: default.bucket_big
             Truncated Path -> Alias:
-              /bucket_big/ds=2008-04-08 [a]
-              /bucket_big/ds=2008-04-09 [a]
+              /bucket_big/ds=2008-04-08 [$hdt$_0:a]
+              /bucket_big/ds=2008-04-09 [$hdt$_0:a]
         Reducer 2 
             Needs Tagging: false
             Reduce Operator Tree:
diff --git a/ql/src/test/results/clientpositive/spark/bucket_map_join_spark1.q.out b/ql/src/test/results/clientpositive/spark/bucket_map_join_spark1.q.out
index 72297343ca..194f16ed9c 100644
--- a/ql/src/test/results/clientpositive/spark/bucket_map_join_spark1.q.out
+++ b/ql/src/test/results/clientpositive/spark/bucket_map_join_spark1.q.out
@@ -205,7 +205,7 @@ STAGE PLANS:
                     name: default.srcbucket_mapjoin_part_2
                   name: default.srcbucket_mapjoin_part_2
             Truncated Path -> Alias:
-              /srcbucket_mapjoin_part_2/ds=2008-04-08 [b]
+              /srcbucket_mapjoin_part_2/ds=2008-04-08 [$hdt$_1:b]
 
   Stage: Stage-1
     Spark
@@ -332,7 +332,7 @@ STAGE PLANS:
                     name: default.srcbucket_mapjoin_part
                   name: default.srcbucket_mapjoin_part
             Truncated Path -> Alias:
-              /srcbucket_mapjoin_part/ds=2008-04-08 [a]
+              /srcbucket_mapjoin_part/ds=2008-04-08 [$hdt$_0:a]
 
   Stage: Stage-0
     Move Operator
@@ -507,7 +507,7 @@ STAGE PLANS:
                     name: default.srcbucket_mapjoin_part_2
                   name: default.srcbucket_mapjoin_part_2
             Truncated Path -> Alias:
-              /srcbucket_mapjoin_part_2/ds=2008-04-08 [b]
+              /srcbucket_mapjoin_part_2/ds=2008-04-08 [$hdt$_1:b]
 
   Stage: Stage-1
     Spark
@@ -628,7 +628,7 @@ STAGE PLANS:
                     name: default.srcbucket_mapjoin_part
                   name: default.srcbucket_mapjoin_part
             Truncated Path -> Alias:
-              /srcbucket_mapjoin_part/ds=2008-04-08 [a]
+              /srcbucket_mapjoin_part/ds=2008-04-08 [$hdt$_0:a]
 
   Stage: Stage-0
     Move Operator
diff --git a/ql/src/test/results/clientpositive/spark/bucket_map_join_spark2.q.out b/ql/src/test/results/clientpositive/spark/bucket_map_join_spark2.q.out
index 4592f214e0..bb66d1ec47 100644
--- a/ql/src/test/results/clientpositive/spark/bucket_map_join_spark2.q.out
+++ b/ql/src/test/results/clientpositive/spark/bucket_map_join_spark2.q.out
@@ -189,7 +189,7 @@ STAGE PLANS:
                     name: default.srcbucket_mapjoin_part_2
                   name: default.srcbucket_mapjoin_part_2
             Truncated Path -> Alias:
-              /srcbucket_mapjoin_part_2/ds=2008-04-08 [b]
+              /srcbucket_mapjoin_part_2/ds=2008-04-08 [$hdt$_1:b]
 
   Stage: Stage-1
     Spark
@@ -316,7 +316,7 @@ STAGE PLANS:
                     name: default.srcbucket_mapjoin_part
                   name: default.srcbucket_mapjoin_part
             Truncated Path -> Alias:
-              /srcbucket_mapjoin_part/ds=2008-04-08 [a]
+              /srcbucket_mapjoin_part/ds=2008-04-08 [$hdt$_0:a]
 
   Stage: Stage-0
     Move Operator
@@ -496,7 +496,7 @@ STAGE PLANS:
                     name: default.srcbucket_mapjoin_part_2
                   name: default.srcbucket_mapjoin_part_2
             Truncated Path -> Alias:
-              /srcbucket_mapjoin_part_2/ds=2008-04-08 [b]
+              /srcbucket_mapjoin_part_2/ds=2008-04-08 [$hdt$_1:b]
 
   Stage: Stage-1
     Spark
@@ -623,7 +623,7 @@ STAGE PLANS:
                     name: default.srcbucket_mapjoin_part
                   name: default.srcbucket_mapjoin_part
             Truncated Path -> Alias:
-              /srcbucket_mapjoin_part/ds=2008-04-08 [a]
+              /srcbucket_mapjoin_part/ds=2008-04-08 [$hdt$_0:a]
 
   Stage: Stage-0
     Move Operator
diff --git a/ql/src/test/results/clientpositive/spark/bucket_map_join_spark3.q.out b/ql/src/test/results/clientpositive/spark/bucket_map_join_spark3.q.out
index add6ac48d2..10678a4c26 100644
--- a/ql/src/test/results/clientpositive/spark/bucket_map_join_spark3.q.out
+++ b/ql/src/test/results/clientpositive/spark/bucket_map_join_spark3.q.out
@@ -189,7 +189,7 @@ STAGE PLANS:
                     name: default.srcbucket_mapjoin_part
                   name: default.srcbucket_mapjoin_part
             Truncated Path -> Alias:
-              /srcbucket_mapjoin_part/ds=2008-04-08 [a]
+              /srcbucket_mapjoin_part/ds=2008-04-08 [$hdt$_0:a]
 
   Stage: Stage-1
     Spark
@@ -316,7 +316,7 @@ STAGE PLANS:
                     name: default.srcbucket_mapjoin_part_2
                   name: default.srcbucket_mapjoin_part_2
             Truncated Path -> Alias:
-              /srcbucket_mapjoin_part_2/ds=2008-04-08 [b]
+              /srcbucket_mapjoin_part_2/ds=2008-04-08 [$hdt$_1:b]
 
   Stage: Stage-0
     Move Operator
@@ -491,7 +491,7 @@ STAGE PLANS:
                     name: default.srcbucket_mapjoin_part
                   name: default.srcbucket_mapjoin_part
             Truncated Path -> Alias:
-              /srcbucket_mapjoin_part/ds=2008-04-08 [a]
+              /srcbucket_mapjoin_part/ds=2008-04-08 [$hdt$_0:a]
 
   Stage: Stage-1
     Spark
@@ -612,7 +612,7 @@ STAGE PLANS:
                     name: default.srcbucket_mapjoin_part_2
                   name: default.srcbucket_mapjoin_part_2
             Truncated Path -> Alias:
-              /srcbucket_mapjoin_part_2/ds=2008-04-08 [b]
+              /srcbucket_mapjoin_part_2/ds=2008-04-08 [$hdt$_1:b]
 
   Stage: Stage-0
     Move Operator
diff --git a/ql/src/test/results/clientpositive/spark/bucket_map_join_spark4.q.out b/ql/src/test/results/clientpositive/spark/bucket_map_join_spark4.q.out
index bd67ee3b9a..2eb5db1d20 100644
--- a/ql/src/test/results/clientpositive/spark/bucket_map_join_spark4.q.out
+++ b/ql/src/test/results/clientpositive/spark/bucket_map_join_spark4.q.out
@@ -156,7 +156,7 @@ STAGE PLANS:
                     name: default.tbl2
                   name: default.tbl2
             Truncated Path -> Alias:
-              /tbl2 [b]
+              /tbl2 [$hdt$_1:b]
         Map 3 
             Map Operator Tree:
                 TableScan
@@ -232,7 +232,7 @@ STAGE PLANS:
                     name: default.tbl3
                   name: default.tbl3
             Truncated Path -> Alias:
-              /tbl3 [c]
+              /tbl3 [$hdt$_2:c]
 
   Stage: Stage-1
     Spark
@@ -362,7 +362,7 @@ STAGE PLANS:
                     name: default.tbl1
                   name: default.tbl1
             Truncated Path -> Alias:
-              /tbl1 [a]
+              /tbl1 [$hdt$_0:a]
 
   Stage: Stage-0
     Fetch Operator
@@ -535,7 +535,7 @@ STAGE PLANS:
                     name: default.tbl2
                   name: default.tbl2
             Truncated Path -> Alias:
-              /tbl2 [b]
+              /tbl2 [$hdt$_1:b]
         Map 3 
             Map Operator Tree:
                 TableScan
@@ -611,7 +611,7 @@ STAGE PLANS:
                     name: default.tbl3
                   name: default.tbl3
             Truncated Path -> Alias:
-              /tbl3 [c]
+              /tbl3 [$hdt$_2:c]
 
   Stage: Stage-1
     Spark
@@ -735,7 +735,7 @@ STAGE PLANS:
                     name: default.tbl1
                   name: default.tbl1
             Truncated Path -> Alias:
-              /tbl1 [a]
+              /tbl1 [$hdt$_0:a]
 
   Stage: Stage-0
     Fetch Operator
diff --git a/ql/src/test/results/clientpositive/spark/bucketmapjoin1.q.out b/ql/src/test/results/clientpositive/spark/bucketmapjoin1.q.out
index 5943fdfc0c..724f9829db 100644
--- a/ql/src/test/results/clientpositive/spark/bucketmapjoin1.q.out
+++ b/ql/src/test/results/clientpositive/spark/bucketmapjoin1.q.out
@@ -459,7 +459,7 @@ STAGE PLANS:
                     name: default.srcbucket_mapjoin
                   name: default.srcbucket_mapjoin
             Truncated Path -> Alias:
-              /srcbucket_mapjoin [a]
+              /srcbucket_mapjoin [$hdt$_0:a]
         Map 3 
             Map Operator Tree:
                 TableScan
@@ -535,7 +535,7 @@ STAGE PLANS:
                     name: default.srcbucket_mapjoin_part
                   name: default.srcbucket_mapjoin_part
             Truncated Path -> Alias:
-              /srcbucket_mapjoin_part/ds=2008-04-08 [b]
+              /srcbucket_mapjoin_part/ds=2008-04-08 [$hdt$_1:b]
         Reducer 2 
             Needs Tagging: true
             Reduce Operator Tree:
@@ -814,7 +814,7 @@ STAGE PLANS:
                     name: default.srcbucket_mapjoin
                   name: default.srcbucket_mapjoin
             Truncated Path -> Alias:
-              /srcbucket_mapjoin [a]
+              /srcbucket_mapjoin [$hdt$_0:a]
         Map 3 
             Map Operator Tree:
                 TableScan
@@ -890,7 +890,7 @@ STAGE PLANS:
                     name: default.srcbucket_mapjoin_part
                   name: default.srcbucket_mapjoin_part
             Truncated Path -> Alias:
-              /srcbucket_mapjoin_part/ds=2008-04-08 [b]
+              /srcbucket_mapjoin_part/ds=2008-04-08 [$hdt$_1:b]
         Reducer 2 
             Needs Tagging: true
             Reduce Operator Tree:
diff --git a/ql/src/test/results/clientpositive/spark/bucketmapjoin2.q.out b/ql/src/test/results/clientpositive/spark/bucketmapjoin2.q.out
index ed95995253..49d7cc9928 100644
--- a/ql/src/test/results/clientpositive/spark/bucketmapjoin2.q.out
+++ b/ql/src/test/results/clientpositive/spark/bucketmapjoin2.q.out
@@ -187,7 +187,7 @@ STAGE PLANS:
                     name: default.srcbucket_mapjoin_part
                   name: default.srcbucket_mapjoin_part
             Truncated Path -> Alias:
-              /srcbucket_mapjoin_part/ds=2008-04-08 [a]
+              /srcbucket_mapjoin_part/ds=2008-04-08 [$hdt$_0:a]
         Map 3 
             Map Operator Tree:
                 TableScan
@@ -263,7 +263,7 @@ STAGE PLANS:
                     name: default.srcbucket_mapjoin_part_2
                   name: default.srcbucket_mapjoin_part_2
             Truncated Path -> Alias:
-              /srcbucket_mapjoin_part_2/ds=2008-04-08 [b]
+              /srcbucket_mapjoin_part_2/ds=2008-04-08 [$hdt$_1:b]
         Reducer 2 
             Needs Tagging: true
             Reduce Operator Tree:
@@ -548,7 +548,7 @@ STAGE PLANS:
                     name: default.srcbucket_mapjoin_part
                   name: default.srcbucket_mapjoin_part
             Truncated Path -> Alias:
-              /srcbucket_mapjoin_part/ds=2008-04-08 [a]
+              /srcbucket_mapjoin_part/ds=2008-04-08 [$hdt$_0:a]
         Map 3 
             Map Operator Tree:
                 TableScan
@@ -624,7 +624,7 @@ STAGE PLANS:
                     name: default.srcbucket_mapjoin_part_2
                   name: default.srcbucket_mapjoin_part_2
             Truncated Path -> Alias:
-              /srcbucket_mapjoin_part_2/ds=2008-04-08 [b]
+              /srcbucket_mapjoin_part_2/ds=2008-04-08 [$hdt$_1:b]
         Reducer 2 
             Needs Tagging: true
             Reduce Operator Tree:
@@ -926,7 +926,7 @@ STAGE PLANS:
                     name: default.srcbucket_mapjoin_part
                   name: default.srcbucket_mapjoin_part
             Truncated Path -> Alias:
-              /srcbucket_mapjoin_part/ds=2008-04-08 [a]
+              /srcbucket_mapjoin_part/ds=2008-04-08 [$hdt$_0:a]
         Map 3 
             Map Operator Tree:
                 TableScan
@@ -1050,8 +1050,8 @@ STAGE PLANS:
                     name: default.srcbucket_mapjoin_part_2
                   name: default.srcbucket_mapjoin_part_2
             Truncated Path -> Alias:
-              /srcbucket_mapjoin_part_2/ds=2008-04-08 [b]
-              /srcbucket_mapjoin_part_2/ds=2008-04-09 [b]
+              /srcbucket_mapjoin_part_2/ds=2008-04-08 [$hdt$_1:b]
+              /srcbucket_mapjoin_part_2/ds=2008-04-09 [$hdt$_1:b]
         Reducer 2 
             Needs Tagging: true
             Reduce Operator Tree:
diff --git a/ql/src/test/results/clientpositive/spark/bucketmapjoin3.q.out b/ql/src/test/results/clientpositive/spark/bucketmapjoin3.q.out
index 14139bb448..1db5b2c142 100644
--- a/ql/src/test/results/clientpositive/spark/bucketmapjoin3.q.out
+++ b/ql/src/test/results/clientpositive/spark/bucketmapjoin3.q.out
@@ -211,7 +211,7 @@ STAGE PLANS:
                     name: default.srcbucket_mapjoin_part_2
                   name: default.srcbucket_mapjoin_part_2
             Truncated Path -> Alias:
-              /srcbucket_mapjoin_part_2/ds=2008-04-08 [a]
+              /srcbucket_mapjoin_part_2/ds=2008-04-08 [$hdt$_0:a]
         Map 3 
             Map Operator Tree:
                 TableScan
@@ -287,7 +287,7 @@ STAGE PLANS:
                     name: default.srcbucket_mapjoin_part
                   name: default.srcbucket_mapjoin_part
             Truncated Path -> Alias:
-              /srcbucket_mapjoin_part/ds=2008-04-08 [b]
+              /srcbucket_mapjoin_part/ds=2008-04-08 [$hdt$_1:b]
         Reducer 2 
             Needs Tagging: true
             Reduce Operator Tree:
@@ -572,7 +572,7 @@ STAGE PLANS:
                     name: default.srcbucket_mapjoin_part_2
                   name: default.srcbucket_mapjoin_part_2
             Truncated Path -> Alias:
-              /srcbucket_mapjoin_part_2/ds=2008-04-08 [a]
+              /srcbucket_mapjoin_part_2/ds=2008-04-08 [$hdt$_0:a]
         Map 3 
             Map Operator Tree:
                 TableScan
@@ -648,7 +648,7 @@ STAGE PLANS:
                     name: default.srcbucket_mapjoin_part
                   name: default.srcbucket_mapjoin_part
             Truncated Path -> Alias:
-              /srcbucket_mapjoin_part/ds=2008-04-08 [b]
+              /srcbucket_mapjoin_part/ds=2008-04-08 [$hdt$_1:b]
         Reducer 2 
             Needs Tagging: true
             Reduce Operator Tree:
diff --git a/ql/src/test/results/clientpositive/spark/bucketmapjoin4.q.out b/ql/src/test/results/clientpositive/spark/bucketmapjoin4.q.out
index cbc2110ff2..7fb61f0645 100644
--- a/ql/src/test/results/clientpositive/spark/bucketmapjoin4.q.out
+++ b/ql/src/test/results/clientpositive/spark/bucketmapjoin4.q.out
@@ -209,7 +209,7 @@ STAGE PLANS:
                     name: default.srcbucket_mapjoin
                   name: default.srcbucket_mapjoin
             Truncated Path -> Alias:
-              /srcbucket_mapjoin [a]
+              /srcbucket_mapjoin [$hdt$_0:a]
         Map 3 
             Map Operator Tree:
                 TableScan
@@ -283,7 +283,7 @@ STAGE PLANS:
                     name: default.srcbucket_mapjoin
                   name: default.srcbucket_mapjoin
             Truncated Path -> Alias:
-              /srcbucket_mapjoin [b]
+              /srcbucket_mapjoin [$hdt$_1:b]
         Reducer 2 
             Needs Tagging: true
             Reduce Operator Tree:
@@ -554,7 +554,7 @@ STAGE PLANS:
                     name: default.srcbucket_mapjoin
                   name: default.srcbucket_mapjoin
             Truncated Path -> Alias:
-              /srcbucket_mapjoin [a]
+              /srcbucket_mapjoin [$hdt$_0:a]
         Map 3 
             Map Operator Tree:
                 TableScan
@@ -628,7 +628,7 @@ STAGE PLANS:
                     name: default.srcbucket_mapjoin
                   name: default.srcbucket_mapjoin
             Truncated Path -> Alias:
-              /srcbucket_mapjoin [b]
+              /srcbucket_mapjoin [$hdt$_1:b]
         Reducer 2 
             Needs Tagging: true
             Reduce Operator Tree:
diff --git a/ql/src/test/results/clientpositive/spark/explaindenpendencydiffengs.q.out b/ql/src/test/results/clientpositive/spark/explaindenpendencydiffengs.q.out
new file mode 100644
index 0000000000..bf1c78135e
--- /dev/null
+++ b/ql/src/test/results/clientpositive/spark/explaindenpendencydiffengs.q.out
@@ -0,0 +1,52 @@
+PREHOOK: query: drop table if exists dependtest
+PREHOOK: type: DROPTABLE
+POSTHOOK: query: drop table if exists dependtest
+POSTHOOK: type: DROPTABLE
+PREHOOK: query: create table dependtest (a string) partitioned by (b int)
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@dependtest
+POSTHOOK: query: create table dependtest (a string) partitioned by (b int)
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@dependtest
+PREHOOK: query: insert into table dependtest partition (b=1) values ("hello")
+PREHOOK: type: QUERY
+PREHOOK: Output: default@dependtest@b=1
+POSTHOOK: query: insert into table dependtest partition (b=1) values ("hello")
+POSTHOOK: type: QUERY
+POSTHOOK: Output: default@dependtest@b=1
+POSTHOOK: Lineage: dependtest PARTITION(b=1).a SIMPLE [(values__tmp__table__1)values__tmp__table__1.FieldSchema(name:tmp_values_col1, type:string, comment:), ]
+PREHOOK: query: create view viewtest as select * from dependtest where b = 1
+PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@dependtest
+PREHOOK: Output: database:default
+PREHOOK: Output: default@viewtest
+POSTHOOK: query: create view viewtest as select * from dependtest where b = 1
+POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@dependtest
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@viewtest
+POSTHOOK: Lineage: viewtest.a SIMPLE [(dependtest)dependtest.FieldSchema(name:a, type:string, comment:null), ]
+POSTHOOK: Lineage: viewtest.b SIMPLE []
+PREHOOK: query: explain dependency select count(*) from viewtest
+PREHOOK: type: QUERY
+POSTHOOK: query: explain dependency select count(*) from viewtest
+POSTHOOK: type: QUERY
+{"input_tables":[{"tablename":"default@viewtest","tabletype":"VIRTUAL_VIEW"},{"tablename":"default@dependtest","tabletype":"MANAGED_TABLE","tableParents":"[default@viewtest]"}],"input_partitions":[{"partitionName":"default@dependtest@b=1","partitionParents":"[default@viewtest]"}]}
+PREHOOK: query: drop view viewtest
+PREHOOK: type: DROPVIEW
+PREHOOK: Input: default@viewtest
+PREHOOK: Output: default@viewtest
+POSTHOOK: query: drop view viewtest
+POSTHOOK: type: DROPVIEW
+POSTHOOK: Input: default@viewtest
+POSTHOOK: Output: default@viewtest
+PREHOOK: query: drop table dependtest
+PREHOOK: type: DROPTABLE
+PREHOOK: Input: default@dependtest
+PREHOOK: Output: default@dependtest
+POSTHOOK: query: drop table dependtest
+POSTHOOK: type: DROPTABLE
+POSTHOOK: Input: default@dependtest
+POSTHOOK: Output: default@dependtest
diff --git a/ql/src/test/results/clientpositive/spark/filter_join_breaktask.q.out b/ql/src/test/results/clientpositive/spark/filter_join_breaktask.q.out
index 52aa055cf9..718346f83a 100644
--- a/ql/src/test/results/clientpositive/spark/filter_join_breaktask.q.out
+++ b/ql/src/test/results/clientpositive/spark/filter_join_breaktask.q.out
@@ -113,7 +113,7 @@ STAGE PLANS:
                     name: default.filter_join_breaktask
                   name: default.filter_join_breaktask
             Truncated Path -> Alias:
-              /filter_join_breaktask/ds=2008-04-08 [f]
+              /filter_join_breaktask/ds=2008-04-08 [$hdt$_0:f]
         Map 4 
             Map Operator Tree:
                 TableScan
@@ -188,7 +188,7 @@ STAGE PLANS:
                     name: default.filter_join_breaktask
                   name: default.filter_join_breaktask
             Truncated Path -> Alias:
-              /filter_join_breaktask/ds=2008-04-08 [m]
+              /filter_join_breaktask/ds=2008-04-08 [$hdt$_1:m]
         Map 5 
             Map Operator Tree:
                 TableScan
@@ -262,7 +262,7 @@ STAGE PLANS:
                     name: default.filter_join_breaktask
                   name: default.filter_join_breaktask
             Truncated Path -> Alias:
-              /filter_join_breaktask/ds=2008-04-08 [g]
+              /filter_join_breaktask/ds=2008-04-08 [$hdt$_2:g]
         Reducer 2 
             Needs Tagging: true
             Reduce Operator Tree:
diff --git a/ql/src/test/results/clientpositive/spark/groupby_map_ppr.q.out b/ql/src/test/results/clientpositive/spark/groupby_map_ppr.q.out
index e5c0402403..f3a95bdde5 100644
--- a/ql/src/test/results/clientpositive/spark/groupby_map_ppr.q.out
+++ b/ql/src/test/results/clientpositive/spark/groupby_map_ppr.q.out
@@ -157,8 +157,8 @@ STAGE PLANS:
                     name: default.srcpart
                   name: default.srcpart
             Truncated Path -> Alias:
-              /srcpart/ds=2008-04-08/hr=11 [src]
-              /srcpart/ds=2008-04-08/hr=12 [src]
+              /srcpart/ds=2008-04-08/hr=11 [$hdt$_0:src]
+              /srcpart/ds=2008-04-08/hr=12 [$hdt$_0:src]
         Reducer 2 
             Needs Tagging: false
             Reduce Operator Tree:
diff --git a/ql/src/test/results/clientpositive/spark/groupby_map_ppr_multi_distinct.q.out b/ql/src/test/results/clientpositive/spark/groupby_map_ppr_multi_distinct.q.out
index 9895aec727..666f355a4c 100644
--- a/ql/src/test/results/clientpositive/spark/groupby_map_ppr_multi_distinct.q.out
+++ b/ql/src/test/results/clientpositive/spark/groupby_map_ppr_multi_distinct.q.out
@@ -157,8 +157,8 @@ STAGE PLANS:
                     name: default.srcpart
                   name: default.srcpart
             Truncated Path -> Alias:
-              /srcpart/ds=2008-04-08/hr=11 [src]
-              /srcpart/ds=2008-04-08/hr=12 [src]
+              /srcpart/ds=2008-04-08/hr=11 [$hdt$_0:src]
+              /srcpart/ds=2008-04-08/hr=12 [$hdt$_0:src]
         Reducer 2 
             Needs Tagging: false
             Reduce Operator Tree:
diff --git a/ql/src/test/results/clientpositive/spark/groupby_ppr.q.out b/ql/src/test/results/clientpositive/spark/groupby_ppr.q.out
index bc14fe054a..e45b5c2030 100644
--- a/ql/src/test/results/clientpositive/spark/groupby_ppr.q.out
+++ b/ql/src/test/results/clientpositive/spark/groupby_ppr.q.out
@@ -150,8 +150,8 @@ STAGE PLANS:
                     name: default.srcpart
                   name: default.srcpart
             Truncated Path -> Alias:
-              /srcpart/ds=2008-04-08/hr=11 [src]
-              /srcpart/ds=2008-04-08/hr=12 [src]
+              /srcpart/ds=2008-04-08/hr=11 [$hdt$_0:src]
+              /srcpart/ds=2008-04-08/hr=12 [$hdt$_0:src]
         Reducer 2 
             Needs Tagging: false
             Reduce Operator Tree:
diff --git a/ql/src/test/results/clientpositive/spark/groupby_ppr_multi_distinct.q.out b/ql/src/test/results/clientpositive/spark/groupby_ppr_multi_distinct.q.out
index a8eafaf867..c3c97f5a10 100644
--- a/ql/src/test/results/clientpositive/spark/groupby_ppr_multi_distinct.q.out
+++ b/ql/src/test/results/clientpositive/spark/groupby_ppr_multi_distinct.q.out
@@ -150,8 +150,8 @@ STAGE PLANS:
                     name: default.srcpart
                   name: default.srcpart
             Truncated Path -> Alias:
-              /srcpart/ds=2008-04-08/hr=11 [src]
-              /srcpart/ds=2008-04-08/hr=12 [src]
+              /srcpart/ds=2008-04-08/hr=11 [$hdt$_0:src]
+              /srcpart/ds=2008-04-08/hr=12 [$hdt$_0:src]
         Reducer 2 
             Needs Tagging: false
             Reduce Operator Tree:
diff --git a/ql/src/test/results/clientpositive/spark/groupby_sort_1_23.q.out b/ql/src/test/results/clientpositive/spark/groupby_sort_1_23.q.out
index 7bb31111bb..e2c1a91fd1 100644
--- a/ql/src/test/results/clientpositive/spark/groupby_sort_1_23.q.out
+++ b/ql/src/test/results/clientpositive/spark/groupby_sort_1_23.q.out
@@ -158,7 +158,7 @@ STAGE PLANS:
                     name: default.t1
                   name: default.t1
             Truncated Path -> Alias:
-              /t1 [t1]
+              /t1 [$hdt$_0:t1]
 
   Stage: Stage-0
     Move Operator
@@ -324,7 +324,7 @@ STAGE PLANS:
                     name: default.t1
                   name: default.t1
             Truncated Path -> Alias:
-              /t1 [t1]
+              /t1 [$hdt$_0:t1]
         Reducer 2 
             Needs Tagging: false
             Reduce Operator Tree:
@@ -554,7 +554,7 @@ STAGE PLANS:
                     name: default.t1
                   name: default.t1
             Truncated Path -> Alias:
-              /t1 [t1]
+              /t1 [$hdt$_0:t1]
 
   Stage: Stage-0
     Move Operator
@@ -737,7 +737,7 @@ STAGE PLANS:
                     name: default.t1
                   name: default.t1
             Truncated Path -> Alias:
-              /t1 [t1]
+              /t1 [$hdt$_0:t1]
 
   Stage: Stage-0
     Move Operator
@@ -928,7 +928,7 @@ STAGE PLANS:
                     name: default.t1
                   name: default.t1
             Truncated Path -> Alias:
-              /t1 [t1]
+              /t1 [$hdt$_0:t1]
 
   Stage: Stage-0
     Move Operator
@@ -1095,7 +1095,7 @@ STAGE PLANS:
                     name: default.t1
                   name: default.t1
             Truncated Path -> Alias:
-              /t1 [t1]
+              /t1 [$hdt$_0:t1]
         Reducer 2 
             Needs Tagging: false
             Reduce Operator Tree:
@@ -1301,7 +1301,7 @@ STAGE PLANS:
                     name: default.t1
                   name: default.t1
             Truncated Path -> Alias:
-              /t1 [t1]
+              /t1 [$hdt$_0:t1]
         Reducer 2 
             Needs Tagging: false
             Reduce Operator Tree:
@@ -1519,7 +1519,7 @@ STAGE PLANS:
                     name: default.t1
                   name: default.t1
             Truncated Path -> Alias:
-              /t1 [t1]
+              /t1 [$hdt$_0:$hdt$_0:t1]
         Reducer 2 
             Needs Tagging: false
             Reduce Operator Tree:
@@ -1759,7 +1759,7 @@ STAGE PLANS:
                     name: default.t1
                   name: default.t1
             Truncated Path -> Alias:
-              /t1 [t1]
+              /t1 [null-subquery1:$hdt$_0-subquery1:$hdt$_0:t1]
         Map 2 
             Map Operator Tree:
                 TableScan
@@ -1866,7 +1866,7 @@ STAGE PLANS:
                     name: default.t1
                   name: default.t1
             Truncated Path -> Alias:
-              /t1 [t1]
+              /t1 [null-subquery2:$hdt$_0-subquery2:$hdt$_0:t1]
 
   Stage: Stage-0
     Move Operator
@@ -2072,7 +2072,7 @@ STAGE PLANS:
                     name: default.t1
                   name: default.t1
             Truncated Path -> Alias:
-              /t1 [t1]
+              /t1 [null-subquery1:$hdt$_0-subquery1:$hdt$_0:t1]
         Map 2 
             Map Operator Tree:
                 TableScan
@@ -2152,7 +2152,7 @@ STAGE PLANS:
                     name: default.t1
                   name: default.t1
             Truncated Path -> Alias:
-              /t1 [t1]
+              /t1 [null-subquery2:$hdt$_0-subquery2:$hdt$_0:t1]
         Reducer 3 
             Needs Tagging: false
             Reduce Operator Tree:
@@ -2384,7 +2384,7 @@ STAGE PLANS:
                     name: default.t1
                   name: default.t1
             Truncated Path -> Alias:
-              /t1 [t1]
+              /t1 [$hdt$_0:$hdt$_0:t1]
         Map 3 
             Map Operator Tree:
                 TableScan
@@ -2468,7 +2468,7 @@ STAGE PLANS:
                     name: default.t1
                   name: default.t1
             Truncated Path -> Alias:
-              /t1 [t1]
+              /t1 [$hdt$_1:$hdt$_1:t1]
         Reducer 2 
             Needs Tagging: true
             Reduce Operator Tree:
@@ -2691,7 +2691,7 @@ STAGE PLANS:
                     name: default.t1
                   name: default.t1
             Truncated Path -> Alias:
-              /t1 [t1]
+              /t1 [$hdt$_0:$hdt$_0:t1]
         Map 3 
             Map Operator Tree:
                 TableScan
@@ -2775,7 +2775,7 @@ STAGE PLANS:
                     name: default.t1
                   name: default.t1
             Truncated Path -> Alias:
-              /t1 [t1]
+              /t1 [$hdt$_1:$hdt$_1:t1]
         Reducer 2 
             Needs Tagging: true
             Reduce Operator Tree:
@@ -2954,7 +2954,7 @@ STAGE PLANS:
                     name: default.t2
                   name: default.t2
             Truncated Path -> Alias:
-              /t2 [t2]
+              /t2 [$hdt$_0:t2]
         Reducer 2 
             Needs Tagging: false
             Reduce Operator Tree:
@@ -3182,7 +3182,7 @@ STAGE PLANS:
                     name: default.t2
                   name: default.t2
             Truncated Path -> Alias:
-              /t2 [t2]
+              /t2 [$hdt$_0:t2]
 
   Stage: Stage-0
     Move Operator
@@ -3376,7 +3376,7 @@ STAGE PLANS:
                     name: default.t2
                   name: default.t2
             Truncated Path -> Alias:
-              /t2 [t2]
+              /t2 [$hdt$_0:t2]
 
   Stage: Stage-0
     Move Operator
@@ -3569,7 +3569,7 @@ STAGE PLANS:
                     name: default.t2
                   name: default.t2
             Truncated Path -> Alias:
-              /t2 [t2]
+              /t2 [$hdt$_0:t2]
 
   Stage: Stage-0
     Move Operator
@@ -3769,7 +3769,7 @@ STAGE PLANS:
                     name: default.t2
                   name: default.t2
             Truncated Path -> Alias:
-              /t2 [t2]
+              /t2 [$hdt$_0:t2]
 
   Stage: Stage-0
     Move Operator
diff --git a/ql/src/test/results/clientpositive/spark/groupby_sort_skew_1_23.q.out b/ql/src/test/results/clientpositive/spark/groupby_sort_skew_1_23.q.out
index bf573b744c..6745d7eb5a 100644
--- a/ql/src/test/results/clientpositive/spark/groupby_sort_skew_1_23.q.out
+++ b/ql/src/test/results/clientpositive/spark/groupby_sort_skew_1_23.q.out
@@ -158,7 +158,7 @@ STAGE PLANS:
                     name: default.t1
                   name: default.t1
             Truncated Path -> Alias:
-              /t1 [t1]
+              /t1 [$hdt$_0:t1]
 
   Stage: Stage-0
     Move Operator
@@ -325,7 +325,7 @@ STAGE PLANS:
                     name: default.t1
                   name: default.t1
             Truncated Path -> Alias:
-              /t1 [t1]
+              /t1 [$hdt$_0:t1]
         Reducer 2 
             Needs Tagging: false
             Reduce Operator Tree:
@@ -573,7 +573,7 @@ STAGE PLANS:
                     name: default.t1
                   name: default.t1
             Truncated Path -> Alias:
-              /t1 [t1]
+              /t1 [$hdt$_0:t1]
 
   Stage: Stage-0
     Move Operator
@@ -756,7 +756,7 @@ STAGE PLANS:
                     name: default.t1
                   name: default.t1
             Truncated Path -> Alias:
-              /t1 [t1]
+              /t1 [$hdt$_0:t1]
 
   Stage: Stage-0
     Move Operator
@@ -947,7 +947,7 @@ STAGE PLANS:
                     name: default.t1
                   name: default.t1
             Truncated Path -> Alias:
-              /t1 [t1]
+              /t1 [$hdt$_0:t1]
 
   Stage: Stage-0
     Move Operator
@@ -1115,7 +1115,7 @@ STAGE PLANS:
                     name: default.t1
                   name: default.t1
             Truncated Path -> Alias:
-              /t1 [t1]
+              /t1 [$hdt$_0:t1]
         Reducer 2 
             Needs Tagging: false
             Reduce Operator Tree:
@@ -1340,7 +1340,7 @@ STAGE PLANS:
                     name: default.t1
                   name: default.t1
             Truncated Path -> Alias:
-              /t1 [t1]
+              /t1 [$hdt$_0:t1]
         Reducer 2 
             Needs Tagging: false
             Reduce Operator Tree:
@@ -1577,7 +1577,7 @@ STAGE PLANS:
                     name: default.t1
                   name: default.t1
             Truncated Path -> Alias:
-              /t1 [t1]
+              /t1 [$hdt$_0:$hdt$_0:t1]
         Reducer 2 
             Needs Tagging: false
             Reduce Operator Tree:
@@ -1835,7 +1835,7 @@ STAGE PLANS:
                     name: default.t1
                   name: default.t1
             Truncated Path -> Alias:
-              /t1 [t1]
+              /t1 [null-subquery1:$hdt$_0-subquery1:$hdt$_0:t1]
         Map 2 
             Map Operator Tree:
                 TableScan
@@ -1942,7 +1942,7 @@ STAGE PLANS:
                     name: default.t1
                   name: default.t1
             Truncated Path -> Alias:
-              /t1 [t1]
+              /t1 [null-subquery2:$hdt$_0-subquery2:$hdt$_0:t1]
 
   Stage: Stage-0
     Move Operator
@@ -2149,7 +2149,7 @@ STAGE PLANS:
                     name: default.t1
                   name: default.t1
             Truncated Path -> Alias:
-              /t1 [t1]
+              /t1 [null-subquery1:$hdt$_0-subquery1:$hdt$_0:t1]
         Map 2 
             Map Operator Tree:
                 TableScan
@@ -2229,7 +2229,7 @@ STAGE PLANS:
                     name: default.t1
                   name: default.t1
             Truncated Path -> Alias:
-              /t1 [t1]
+              /t1 [null-subquery2:$hdt$_0-subquery2:$hdt$_0:t1]
         Reducer 3 
             Needs Tagging: false
             Reduce Operator Tree:
@@ -2479,7 +2479,7 @@ STAGE PLANS:
                     name: default.t1
                   name: default.t1
             Truncated Path -> Alias:
-              /t1 [t1]
+              /t1 [$hdt$_0:$hdt$_0:t1]
         Map 3 
             Map Operator Tree:
                 TableScan
@@ -2563,7 +2563,7 @@ STAGE PLANS:
                     name: default.t1
                   name: default.t1
             Truncated Path -> Alias:
-              /t1 [t1]
+              /t1 [$hdt$_1:$hdt$_1:t1]
         Reducer 2 
             Needs Tagging: true
             Reduce Operator Tree:
@@ -2787,7 +2787,7 @@ STAGE PLANS:
                     name: default.t1
                   name: default.t1
             Truncated Path -> Alias:
-              /t1 [t1]
+              /t1 [$hdt$_0:$hdt$_0:t1]
         Map 3 
             Map Operator Tree:
                 TableScan
@@ -2871,7 +2871,7 @@ STAGE PLANS:
                     name: default.t1
                   name: default.t1
             Truncated Path -> Alias:
-              /t1 [t1]
+              /t1 [$hdt$_1:$hdt$_1:t1]
         Reducer 2 
             Needs Tagging: true
             Reduce Operator Tree:
@@ -3069,7 +3069,7 @@ STAGE PLANS:
                     name: default.t2
                   name: default.t2
             Truncated Path -> Alias:
-              /t2 [t2]
+              /t2 [$hdt$_0:t2]
         Reducer 2 
             Needs Tagging: false
             Reduce Operator Tree:
@@ -3315,7 +3315,7 @@ STAGE PLANS:
                     name: default.t2
                   name: default.t2
             Truncated Path -> Alias:
-              /t2 [t2]
+              /t2 [$hdt$_0:t2]
 
   Stage: Stage-0
     Move Operator
@@ -3509,7 +3509,7 @@ STAGE PLANS:
                     name: default.t2
                   name: default.t2
             Truncated Path -> Alias:
-              /t2 [t2]
+              /t2 [$hdt$_0:t2]
 
   Stage: Stage-0
     Move Operator
@@ -3702,7 +3702,7 @@ STAGE PLANS:
                     name: default.t2
                   name: default.t2
             Truncated Path -> Alias:
-              /t2 [t2]
+              /t2 [$hdt$_0:t2]
 
   Stage: Stage-0
     Move Operator
@@ -3902,7 +3902,7 @@ STAGE PLANS:
                     name: default.t2
                   name: default.t2
             Truncated Path -> Alias:
-              /t2 [t2]
+              /t2 [$hdt$_0:t2]
 
   Stage: Stage-0
     Move Operator
diff --git a/ql/src/test/results/clientpositive/spark/join17.q.out b/ql/src/test/results/clientpositive/spark/join17.q.out
index aa4736c860..3644efdde1 100644
--- a/ql/src/test/results/clientpositive/spark/join17.q.out
+++ b/ql/src/test/results/clientpositive/spark/join17.q.out
@@ -99,7 +99,7 @@ STAGE PLANS:
                     name: default.src
                   name: default.src
             Truncated Path -> Alias:
-              /src [src1]
+              /src [$hdt$_0:src1]
         Map 3 
             Map Operator Tree:
                 TableScan
@@ -173,7 +173,7 @@ STAGE PLANS:
                     name: default.src
                   name: default.src
             Truncated Path -> Alias:
-              /src [src2]
+              /src [$hdt$_1:src2]
         Reducer 2 
             Needs Tagging: true
             Reduce Operator Tree:
diff --git a/ql/src/test/results/clientpositive/spark/join26.q.out b/ql/src/test/results/clientpositive/spark/join26.q.out
index 9f85a3e995..ccd4526707 100644
--- a/ql/src/test/results/clientpositive/spark/join26.q.out
+++ b/ql/src/test/results/clientpositive/spark/join26.q.out
@@ -101,7 +101,7 @@ STAGE PLANS:
                     name: default.src1
                   name: default.src1
             Truncated Path -> Alias:
-              /src1 [x]
+              /src1 [$hdt$_2:x]
         Map 3 
             Map Operator Tree:
                 TableScan
@@ -176,7 +176,7 @@ STAGE PLANS:
                     name: default.srcpart
                   name: default.srcpart
             Truncated Path -> Alias:
-              /srcpart/ds=2008-04-08/hr=11 [z]
+              /srcpart/ds=2008-04-08/hr=11 [$hdt$_0:z]
 
   Stage: Stage-1
     Spark
@@ -298,7 +298,7 @@ STAGE PLANS:
                     name: default.src
                   name: default.src
             Truncated Path -> Alias:
-              /src [y]
+              /src [$hdt$_1:y]
 
   Stage: Stage-0
     Move Operator
diff --git a/ql/src/test/results/clientpositive/spark/join32.q.out b/ql/src/test/results/clientpositive/spark/join32.q.out
index 2f50aef7ae..c1f14677c0 100644
--- a/ql/src/test/results/clientpositive/spark/join32.q.out
+++ b/ql/src/test/results/clientpositive/spark/join32.q.out
@@ -100,7 +100,7 @@ STAGE PLANS:
                     name: default.src1
                   name: default.src1
             Truncated Path -> Alias:
-              /src1 [x]
+              /src1 [$hdt$_2:x]
         Map 3 
             Map Operator Tree:
                 TableScan
@@ -172,7 +172,7 @@ STAGE PLANS:
                     name: default.src
                   name: default.src
             Truncated Path -> Alias:
-              /src [y]
+              /src [$hdt$_0:y]
 
   Stage: Stage-1
     Spark
@@ -304,7 +304,7 @@ STAGE PLANS:
                     name: default.srcpart
                   name: default.srcpart
             Truncated Path -> Alias:
-              /srcpart/ds=2008-04-08/hr=11 [z]
+              /srcpart/ds=2008-04-08/hr=11 [$hdt$_1:z]
 
   Stage: Stage-0
     Move Operator
diff --git a/ql/src/test/results/clientpositive/spark/join32_lessSize.q.out b/ql/src/test/results/clientpositive/spark/join32_lessSize.q.out
index f9e81aa47a..82836f6828 100644
--- a/ql/src/test/results/clientpositive/spark/join32_lessSize.q.out
+++ b/ql/src/test/results/clientpositive/spark/join32_lessSize.q.out
@@ -108,7 +108,7 @@ STAGE PLANS:
                     name: default.src1
                   name: default.src1
             Truncated Path -> Alias:
-              /src1 [x]
+              /src1 [$hdt$_2:x]
         Map 3 
             Map Operator Tree:
                 TableScan
@@ -180,7 +180,7 @@ STAGE PLANS:
                     name: default.src
                   name: default.src
             Truncated Path -> Alias:
-              /src [y]
+              /src [$hdt$_0:y]
 
   Stage: Stage-1
     Spark
@@ -312,7 +312,7 @@ STAGE PLANS:
                     name: default.srcpart
                   name: default.srcpart
             Truncated Path -> Alias:
-              /srcpart/ds=2008-04-08/hr=11 [z]
+              /srcpart/ds=2008-04-08/hr=11 [$hdt$_1:z]
 
   Stage: Stage-0
     Move Operator
@@ -559,7 +559,7 @@ STAGE PLANS:
                     name: default.src1
                   name: default.src1
             Truncated Path -> Alias:
-              /src1 [z]
+              /src1 [$hdt$_3:z]
 
   Stage: Stage-3
     Spark
@@ -647,7 +647,7 @@ STAGE PLANS:
                     name: default.src1
                   name: default.src1
             Truncated Path -> Alias:
-              /src1 [x]
+              /src1 [$hdt$_2:x]
         Map 4 
             Map Operator Tree:
                 TableScan
@@ -719,7 +719,7 @@ STAGE PLANS:
                     name: default.src
                   name: default.src
             Truncated Path -> Alias:
-              /src [y]
+              /src [$hdt$_0:y]
 
   Stage: Stage-1
     Spark
@@ -849,7 +849,7 @@ STAGE PLANS:
                     name: default.src
                   name: default.src
             Truncated Path -> Alias:
-              /src [w]
+              /src [$hdt$_1:w]
 
   Stage: Stage-0
     Move Operator
@@ -1093,7 +1093,7 @@ STAGE PLANS:
                     name: default.srcpart
                   name: default.srcpart
             Truncated Path -> Alias:
-              /srcpart/ds=2008-04-08/hr=11 [z]
+              /srcpart/ds=2008-04-08/hr=11 [$hdt$_0:z]
         Map 3 
             Map Operator Tree:
                 TableScan
@@ -1165,7 +1165,7 @@ STAGE PLANS:
                     name: default.src1
                   name: default.src1
             Truncated Path -> Alias:
-              /src1 [x]
+              /src1 [$hdt$_1:$hdt$_2:x]
 
   Stage: Stage-1
     Spark
@@ -1299,7 +1299,7 @@ STAGE PLANS:
                     name: default.src
                   name: default.src
             Truncated Path -> Alias:
-              /src [y]
+              /src [$hdt$_1:$hdt$_1:y]
 
   Stage: Stage-0
     Move Operator
@@ -1545,7 +1545,7 @@ STAGE PLANS:
                     name: default.srcpart
                   name: default.srcpart
             Truncated Path -> Alias:
-              /srcpart/ds=2008-04-08/hr=11 [z]
+              /srcpart/ds=2008-04-08/hr=11 [$hdt$_0:z]
         Map 2 
             Map Operator Tree:
                 TableScan
@@ -1613,7 +1613,7 @@ STAGE PLANS:
                     name: default.src
                   name: default.src
             Truncated Path -> Alias:
-              /src [y]
+              /src [$hdt$_1:$hdt$_1:y]
 
   Stage: Stage-1
     Spark
@@ -1747,7 +1747,7 @@ STAGE PLANS:
                     name: default.src1
                   name: default.src1
             Truncated Path -> Alias:
-              /src1 [x]
+              /src1 [$hdt$_1:$hdt$_2:x]
 
   Stage: Stage-0
     Move Operator
diff --git a/ql/src/test/results/clientpositive/spark/join33.q.out b/ql/src/test/results/clientpositive/spark/join33.q.out
index 2f50aef7ae..c1f14677c0 100644
--- a/ql/src/test/results/clientpositive/spark/join33.q.out
+++ b/ql/src/test/results/clientpositive/spark/join33.q.out
@@ -100,7 +100,7 @@ STAGE PLANS:
                     name: default.src1
                   name: default.src1
             Truncated Path -> Alias:
-              /src1 [x]
+              /src1 [$hdt$_2:x]
         Map 3 
             Map Operator Tree:
                 TableScan
@@ -172,7 +172,7 @@ STAGE PLANS:
                     name: default.src
                   name: default.src
             Truncated Path -> Alias:
-              /src [y]
+              /src [$hdt$_0:y]
 
   Stage: Stage-1
     Spark
@@ -304,7 +304,7 @@ STAGE PLANS:
                     name: default.srcpart
                   name: default.srcpart
             Truncated Path -> Alias:
-              /srcpart/ds=2008-04-08/hr=11 [z]
+              /srcpart/ds=2008-04-08/hr=11 [$hdt$_1:z]
 
   Stage: Stage-0
     Move Operator
diff --git a/ql/src/test/results/clientpositive/spark/join34.q.out b/ql/src/test/results/clientpositive/spark/join34.q.out
index e32f3e4d11..503235f607 100644
--- a/ql/src/test/results/clientpositive/spark/join34.q.out
+++ b/ql/src/test/results/clientpositive/spark/join34.q.out
@@ -111,7 +111,7 @@ STAGE PLANS:
                     name: default.src
                   name: default.src
             Truncated Path -> Alias:
-              /src [x]
+              /src [$hdt$_0-subquery1:$hdt$_0-subquery1:x]
         Map 3 
             Map Operator Tree:
                 TableScan
@@ -185,7 +185,7 @@ STAGE PLANS:
                     name: default.src
                   name: default.src
             Truncated Path -> Alias:
-              /src [x1]
+              /src [$hdt$_0-subquery2:$hdt$_0-subquery2:x1]
         Map 4 
             Map Operator Tree:
                 TableScan
@@ -259,7 +259,7 @@ STAGE PLANS:
                     name: default.src1
                   name: default.src1
             Truncated Path -> Alias:
-              /src1 [x]
+              /src1 [$hdt$_1:x]
         Reducer 2 
             Needs Tagging: true
             Reduce Operator Tree:
diff --git a/ql/src/test/results/clientpositive/spark/join35.q.out b/ql/src/test/results/clientpositive/spark/join35.q.out
index e1a96f66a0..74e8ee90d5 100644
--- a/ql/src/test/results/clientpositive/spark/join35.q.out
+++ b/ql/src/test/results/clientpositive/spark/join35.q.out
@@ -119,7 +119,7 @@ STAGE PLANS:
                     name: default.src
                   name: default.src
             Truncated Path -> Alias:
-              /src [x]
+              /src [$hdt$_0-subquery1:$hdt$_0-subquery1:$hdt$_0:x]
         Map 4 
             Map Operator Tree:
                 TableScan
@@ -199,7 +199,7 @@ STAGE PLANS:
                     name: default.src
                   name: default.src
             Truncated Path -> Alias:
-              /src [x1]
+              /src [$hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_0:x1]
         Map 6 
             Map Operator Tree:
                 TableScan
@@ -273,7 +273,7 @@ STAGE PLANS:
                     name: default.src1
                   name: default.src1
             Truncated Path -> Alias:
-              /src1 [x]
+              /src1 [$hdt$_1:x]
         Reducer 2 
             Needs Tagging: false
             Reduce Operator Tree:
diff --git a/ql/src/test/results/clientpositive/spark/join9.q.out b/ql/src/test/results/clientpositive/spark/join9.q.out
index 373ac8b984..c7a191a4c0 100644
--- a/ql/src/test/results/clientpositive/spark/join9.q.out
+++ b/ql/src/test/results/clientpositive/spark/join9.q.out
@@ -100,7 +100,7 @@ STAGE PLANS:
                     name: default.srcpart
                   name: default.srcpart
             Truncated Path -> Alias:
-              /srcpart/ds=2008-04-08/hr=12 [src1]
+              /srcpart/ds=2008-04-08/hr=12 [$hdt$_0:src1]
         Map 3 
             Map Operator Tree:
                 TableScan
@@ -174,7 +174,7 @@ STAGE PLANS:
                     name: default.src
                   name: default.src
             Truncated Path -> Alias:
-              /src [src2]
+              /src [$hdt$_1:src2]
         Reducer 2 
             Needs Tagging: true
             Reduce Operator Tree:
diff --git a/ql/src/test/results/clientpositive/spark/join_filters_overlap.q.out b/ql/src/test/results/clientpositive/spark/join_filters_overlap.q.out
index 5bdd73b680..ac056b7dc0 100644
--- a/ql/src/test/results/clientpositive/spark/join_filters_overlap.q.out
+++ b/ql/src/test/results/clientpositive/spark/join_filters_overlap.q.out
@@ -94,7 +94,7 @@ STAGE PLANS:
                     name: default.a
                   name: default.a
             Truncated Path -> Alias:
-              /a [a]
+              /a [$hdt$_0:a]
         Map 3 
             Map Operator Tree:
                 TableScan
@@ -168,7 +168,7 @@ STAGE PLANS:
                     name: default.a
                   name: default.a
             Truncated Path -> Alias:
-              /a [b]
+              /a [$hdt$_1:b]
         Map 4 
             Map Operator Tree:
                 TableScan
@@ -242,7 +242,7 @@ STAGE PLANS:
                     name: default.a
                   name: default.a
             Truncated Path -> Alias:
-              /a [c]
+              /a [$hdt$_2:c]
         Reducer 2 
             Needs Tagging: true
             Reduce Operator Tree:
@@ -401,7 +401,7 @@ STAGE PLANS:
                     name: default.a
                   name: default.a
             Truncated Path -> Alias:
-              /a [a]
+              /a [$hdt$_0:a]
         Map 3 
             Map Operator Tree:
                 TableScan
@@ -471,7 +471,7 @@ STAGE PLANS:
                     name: default.a
                   name: default.a
             Truncated Path -> Alias:
-              /a [b]
+              /a [$hdt$_1:b]
         Map 4 
             Map Operator Tree:
                 TableScan
@@ -545,7 +545,7 @@ STAGE PLANS:
                     name: default.a
                   name: default.a
             Truncated Path -> Alias:
-              /a [c]
+              /a [$hdt$_2:c]
         Reducer 2 
             Needs Tagging: true
             Reduce Operator Tree:
@@ -704,7 +704,7 @@ STAGE PLANS:
                     name: default.a
                   name: default.a
             Truncated Path -> Alias:
-              /a [a]
+              /a [$hdt$_0:a]
         Map 3 
             Map Operator Tree:
                 TableScan
@@ -774,7 +774,7 @@ STAGE PLANS:
                     name: default.a
                   name: default.a
             Truncated Path -> Alias:
-              /a [b]
+              /a [$hdt$_1:b]
         Map 4 
             Map Operator Tree:
                 TableScan
@@ -848,7 +848,7 @@ STAGE PLANS:
                     name: default.a
                   name: default.a
             Truncated Path -> Alias:
-              /a [c]
+              /a [$hdt$_2:c]
         Reducer 2 
             Needs Tagging: true
             Reduce Operator Tree:
@@ -1003,7 +1003,7 @@ STAGE PLANS:
                     name: default.a
                   name: default.a
             Truncated Path -> Alias:
-              /a [a]
+              /a [$hdt$_0:a]
         Map 3 
             Map Operator Tree:
                 TableScan
@@ -1073,7 +1073,7 @@ STAGE PLANS:
                     name: default.a
                   name: default.a
             Truncated Path -> Alias:
-              /a [b]
+              /a [$hdt$_1:b]
         Map 4 
             Map Operator Tree:
                 TableScan
@@ -1147,7 +1147,7 @@ STAGE PLANS:
                     name: default.a
                   name: default.a
             Truncated Path -> Alias:
-              /a [c]
+              /a [$hdt$_2:c]
         Map 5 
             Map Operator Tree:
                 TableScan
@@ -1221,7 +1221,7 @@ STAGE PLANS:
                     name: default.a
                   name: default.a
             Truncated Path -> Alias:
-              /a [d]
+              /a [$hdt$_3:d]
         Reducer 2 
             Needs Tagging: true
             Reduce Operator Tree:
@@ -1371,7 +1371,7 @@ STAGE PLANS:
                     name: default.a
                   name: default.a
             Truncated Path -> Alias:
-              /a [a]
+              /a [$hdt$_0:a]
         Map 3 
             Map Operator Tree:
                 TableScan
@@ -1445,7 +1445,7 @@ STAGE PLANS:
                     name: default.a
                   name: default.a
             Truncated Path -> Alias:
-              /a [b]
+              /a [$hdt$_1:b]
         Map 4 
             Map Operator Tree:
                 TableScan
@@ -1519,7 +1519,7 @@ STAGE PLANS:
                     name: default.a
                   name: default.a
             Truncated Path -> Alias:
-              /a [c]
+              /a [$hdt$_2:c]
         Map 5 
             Map Operator Tree:
                 TableScan
@@ -1593,7 +1593,7 @@ STAGE PLANS:
                     name: default.a
                   name: default.a
             Truncated Path -> Alias:
-              /a [d]
+              /a [$hdt$_3:d]
         Reducer 2 
             Needs Tagging: true
             Reduce Operator Tree:
diff --git a/ql/src/test/results/clientpositive/spark/louter_join_ppr.q.out b/ql/src/test/results/clientpositive/spark/louter_join_ppr.q.out
index 71e06bbb48..5de7733c51 100644
--- a/ql/src/test/results/clientpositive/spark/louter_join_ppr.q.out
+++ b/ql/src/test/results/clientpositive/spark/louter_join_ppr.q.out
@@ -100,7 +100,7 @@ STAGE PLANS:
                     name: default.src
                   name: default.src
             Truncated Path -> Alias:
-              /src [a]
+              /src [$hdt$_0:a]
         Map 3 
             Map Operator Tree:
                 TableScan
@@ -224,8 +224,8 @@ STAGE PLANS:
                     name: default.srcpart
                   name: default.srcpart
             Truncated Path -> Alias:
-              /srcpart/ds=2008-04-08/hr=11 [b]
-              /srcpart/ds=2008-04-08/hr=12 [b]
+              /srcpart/ds=2008-04-08/hr=11 [$hdt$_1:b]
+              /srcpart/ds=2008-04-08/hr=12 [$hdt$_1:b]
         Reducer 2 
             Needs Tagging: true
             Reduce Operator Tree:
@@ -456,8 +456,8 @@ STAGE PLANS:
                     name: default.srcpart
                   name: default.srcpart
             Truncated Path -> Alias:
-              /srcpart/ds=2008-04-08/hr=11 [a]
-              /srcpart/ds=2008-04-08/hr=12 [a]
+              /srcpart/ds=2008-04-08/hr=11 [$hdt$_0:a]
+              /srcpart/ds=2008-04-08/hr=12 [$hdt$_0:a]
         Map 3 
             Map Operator Tree:
                 TableScan
@@ -531,7 +531,7 @@ STAGE PLANS:
                     name: default.src
                   name: default.src
             Truncated Path -> Alias:
-              /src [b]
+              /src [$hdt$_1:b]
         Reducer 2 
             Needs Tagging: true
             Reduce Operator Tree:
@@ -716,7 +716,7 @@ STAGE PLANS:
                     name: default.src
                   name: default.src
             Truncated Path -> Alias:
-              /src [a]
+              /src [$hdt$_0:a]
         Map 3 
             Map Operator Tree:
                 TableScan
@@ -840,8 +840,8 @@ STAGE PLANS:
                     name: default.srcpart
                   name: default.srcpart
             Truncated Path -> Alias:
-              /srcpart/ds=2008-04-08/hr=11 [b]
-              /srcpart/ds=2008-04-08/hr=12 [b]
+              /srcpart/ds=2008-04-08/hr=11 [$hdt$_1:b]
+              /srcpart/ds=2008-04-08/hr=12 [$hdt$_1:b]
         Reducer 2 
             Needs Tagging: true
             Reduce Operator Tree:
@@ -1072,8 +1072,8 @@ STAGE PLANS:
                     name: default.srcpart
                   name: default.srcpart
             Truncated Path -> Alias:
-              /srcpart/ds=2008-04-08/hr=11 [a]
-              /srcpart/ds=2008-04-08/hr=12 [a]
+              /srcpart/ds=2008-04-08/hr=11 [$hdt$_0:a]
+              /srcpart/ds=2008-04-08/hr=12 [$hdt$_0:a]
         Map 3 
             Map Operator Tree:
                 TableScan
@@ -1147,7 +1147,7 @@ STAGE PLANS:
                     name: default.src
                   name: default.src
             Truncated Path -> Alias:
-              /src [b]
+              /src [$hdt$_1:b]
         Reducer 2 
             Needs Tagging: true
             Reduce Operator Tree:
diff --git a/ql/src/test/results/clientpositive/spark/mapjoin_mapjoin.q.out b/ql/src/test/results/clientpositive/spark/mapjoin_mapjoin.q.out
index 6ed0c68093..00b285c073 100644
--- a/ql/src/test/results/clientpositive/spark/mapjoin_mapjoin.q.out
+++ b/ql/src/test/results/clientpositive/spark/mapjoin_mapjoin.q.out
@@ -83,7 +83,7 @@ STAGE PLANS:
                     name: default.src1
                   name: default.src1
             Truncated Path -> Alias:
-              /src1 [src1]
+              /src1 [$hdt$_2:src1]
         Map 3 
             Map Operator Tree:
                 TableScan
@@ -155,7 +155,7 @@ STAGE PLANS:
                     name: default.src
                   name: default.src
             Truncated Path -> Alias:
-              /src [src]
+              /src [$hdt$_0:src]
 
   Stage: Stage-1
     Spark
@@ -417,10 +417,10 @@ STAGE PLANS:
                     name: default.srcpart
                   name: default.srcpart
             Truncated Path -> Alias:
-              /srcpart/ds=2008-04-08/hr=11 [srcpart]
-              /srcpart/ds=2008-04-08/hr=12 [srcpart]
-              /srcpart/ds=2008-04-09/hr=11 [srcpart]
-              /srcpart/ds=2008-04-09/hr=12 [srcpart]
+              /srcpart/ds=2008-04-08/hr=11 [$hdt$_1:srcpart]
+              /srcpart/ds=2008-04-08/hr=12 [$hdt$_1:srcpart]
+              /srcpart/ds=2008-04-09/hr=11 [$hdt$_1:srcpart]
+              /srcpart/ds=2008-04-09/hr=12 [$hdt$_1:srcpart]
 
   Stage: Stage-0
     Fetch Operator
diff --git a/ql/src/test/results/clientpositive/spark/optimize_nullscan.q.out b/ql/src/test/results/clientpositive/spark/optimize_nullscan.q.out
index b3478bfee5..d294f4910c 100644
--- a/ql/src/test/results/clientpositive/spark/optimize_nullscan.q.out
+++ b/ql/src/test/results/clientpositive/spark/optimize_nullscan.q.out
@@ -164,7 +164,7 @@ STAGE PLANS:
                         tag: 0
                         auto parallelism: false
             Path -> Alias:
-              nullscan://null/default.src/part_ [src]
+              nullscan://null/default.src/part_ [a:src]
             Path -> Partition:
               nullscan://null/default.src/part_ 
                 Partition
@@ -212,7 +212,7 @@ STAGE PLANS:
                     name: default.src
                   name: default.src
             Truncated Path -> Alias:
-              nullscan://null/default.src/part_ [src]
+              nullscan://null/default.src/part_ [a:src]
         Map 3 
             Map Operator Tree:
                 TableScan
@@ -234,10 +234,10 @@ STAGE PLANS:
                         value expressions: _col0 (type: string)
                         auto parallelism: false
             Path -> Alias:
-              nullscan://null/default.srcpart/part_ds=2008-04-08_hr=11_ [srcpart]
-              nullscan://null/default.srcpart/part_ds=2008-04-08_hr=12_ [srcpart]
-              nullscan://null/default.srcpart/part_ds=2008-04-09_hr=11_ [srcpart]
-              nullscan://null/default.srcpart/part_ds=2008-04-09_hr=12_ [srcpart]
+              nullscan://null/default.srcpart/part_ds=2008-04-08_hr=11_ [b:srcpart]
+              nullscan://null/default.srcpart/part_ds=2008-04-08_hr=12_ [b:srcpart]
+              nullscan://null/default.srcpart/part_ds=2008-04-09_hr=11_ [b:srcpart]
+              nullscan://null/default.srcpart/part_ds=2008-04-09_hr=12_ [b:srcpart]
             Path -> Partition:
               nullscan://null/default.srcpart/part_ds=2008-04-08_hr=11_ 
                 Partition
@@ -428,10 +428,10 @@ STAGE PLANS:
                     name: default.srcpart
                   name: default.srcpart
             Truncated Path -> Alias:
-              nullscan://null/default.srcpart/part_ds=2008-04-08_hr=11_ [srcpart]
-              nullscan://null/default.srcpart/part_ds=2008-04-08_hr=12_ [srcpart]
-              nullscan://null/default.srcpart/part_ds=2008-04-09_hr=11_ [srcpart]
-              nullscan://null/default.srcpart/part_ds=2008-04-09_hr=12_ [srcpart]
+              nullscan://null/default.srcpart/part_ds=2008-04-08_hr=11_ [b:srcpart]
+              nullscan://null/default.srcpart/part_ds=2008-04-08_hr=12_ [b:srcpart]
+              nullscan://null/default.srcpart/part_ds=2008-04-09_hr=11_ [b:srcpart]
+              nullscan://null/default.srcpart/part_ds=2008-04-09_hr=12_ [b:srcpart]
         Reducer 2 
             Needs Tagging: true
             Reduce Operator Tree:
@@ -549,7 +549,7 @@ STAGE PLANS:
                         value expressions: _col0 (type: bigint)
                         auto parallelism: false
             Path -> Alias:
-              nullscan://null/default.src/part_ [src]
+              nullscan://null/default.src/part_ [null-subquery1:_u1-subquery1:src]
             Path -> Partition:
               nullscan://null/default.src/part_ 
                 Partition
@@ -597,7 +597,7 @@ STAGE PLANS:
                     name: default.src
                   name: default.src
             Truncated Path -> Alias:
-              nullscan://null/default.src/part_ [src]
+              nullscan://null/default.src/part_ [null-subquery1:_u1-subquery1:src]
         Map 3 
             Map Operator Tree:
                 TableScan
@@ -816,10 +816,10 @@ STAGE PLANS:
                     name: default.srcpart
                   name: default.srcpart
             Truncated Path -> Alias:
-              /srcpart/ds=2008-04-08/hr=11 [srcpart]
-              /srcpart/ds=2008-04-08/hr=12 [srcpart]
-              /srcpart/ds=2008-04-09/hr=11 [srcpart]
-              /srcpart/ds=2008-04-09/hr=12 [srcpart]
+              /srcpart/ds=2008-04-08/hr=11 [null-subquery2:_u1-subquery2:srcpart]
+              /srcpart/ds=2008-04-08/hr=12 [null-subquery2:_u1-subquery2:srcpart]
+              /srcpart/ds=2008-04-09/hr=11 [null-subquery2:_u1-subquery2:srcpart]
+              /srcpart/ds=2008-04-09/hr=12 [null-subquery2:_u1-subquery2:srcpart]
         Reducer 2 
             Needs Tagging: false
             Reduce Operator Tree:
@@ -948,7 +948,7 @@ STAGE PLANS:
                         value expressions: _col0 (type: string)
                         auto parallelism: false
             Path -> Alias:
-              nullscan://null/default.src/part_ [src]
+              nullscan://null/default.src/part_ [a:src]
             Path -> Partition:
               nullscan://null/default.src/part_ 
                 Partition
@@ -996,7 +996,7 @@ STAGE PLANS:
                     name: default.src
                   name: default.src
             Truncated Path -> Alias:
-              nullscan://null/default.src/part_ [src]
+              nullscan://null/default.src/part_ [a:src]
         Map 3 
             Map Operator Tree:
                 TableScan
@@ -1018,10 +1018,10 @@ STAGE PLANS:
                         value expressions: _col0 (type: string)
                         auto parallelism: false
             Path -> Alias:
-              nullscan://null/default.srcpart/part_ds=2008-04-08_hr=11_ [srcpart]
-              nullscan://null/default.srcpart/part_ds=2008-04-08_hr=12_ [srcpart]
-              nullscan://null/default.srcpart/part_ds=2008-04-09_hr=11_ [srcpart]
-              nullscan://null/default.srcpart/part_ds=2008-04-09_hr=12_ [srcpart]
+              nullscan://null/default.srcpart/part_ds=2008-04-08_hr=11_ [b:srcpart]
+              nullscan://null/default.srcpart/part_ds=2008-04-08_hr=12_ [b:srcpart]
+              nullscan://null/default.srcpart/part_ds=2008-04-09_hr=11_ [b:srcpart]
+              nullscan://null/default.srcpart/part_ds=2008-04-09_hr=12_ [b:srcpart]
             Path -> Partition:
               nullscan://null/default.srcpart/part_ds=2008-04-08_hr=11_ 
                 Partition
@@ -1212,10 +1212,10 @@ STAGE PLANS:
                     name: default.srcpart
                   name: default.srcpart
             Truncated Path -> Alias:
-              nullscan://null/default.srcpart/part_ds=2008-04-08_hr=11_ [srcpart]
-              nullscan://null/default.srcpart/part_ds=2008-04-08_hr=12_ [srcpart]
-              nullscan://null/default.srcpart/part_ds=2008-04-09_hr=11_ [srcpart]
-              nullscan://null/default.srcpart/part_ds=2008-04-09_hr=12_ [srcpart]
+              nullscan://null/default.srcpart/part_ds=2008-04-08_hr=11_ [b:srcpart]
+              nullscan://null/default.srcpart/part_ds=2008-04-08_hr=12_ [b:srcpart]
+              nullscan://null/default.srcpart/part_ds=2008-04-09_hr=11_ [b:srcpart]
+              nullscan://null/default.srcpart/part_ds=2008-04-09_hr=12_ [b:srcpart]
         Reducer 2 
             Needs Tagging: true
             Reduce Operator Tree:
@@ -1395,7 +1395,7 @@ STAGE PLANS:
                     name: default.src
                   name: default.src
             Truncated Path -> Alias:
-              /src [src]
+              /src [a-subquery1:_u1-subquery1:src]
         Map 2 
             Map Operator Tree:
                 TableScan
@@ -1415,7 +1415,7 @@ STAGE PLANS:
                       tag: 0
                       auto parallelism: false
             Path -> Alias:
-              nullscan://null/default.src/part_ [src]
+              nullscan://null/default.src/part_ [a-subquery2:_u1-subquery2:src]
             Path -> Partition:
               nullscan://null/default.src/part_ 
                 Partition
@@ -1463,7 +1463,7 @@ STAGE PLANS:
                     name: default.src
                   name: default.src
             Truncated Path -> Alias:
-              nullscan://null/default.src/part_ [src]
+              nullscan://null/default.src/part_ [a-subquery2:_u1-subquery2:src]
         Map 4 
             Map Operator Tree:
                 TableScan
diff --git a/ql/src/test/results/clientpositive/spark/outer_join_ppr.q.out b/ql/src/test/results/clientpositive/spark/outer_join_ppr.q.out
index 497a29eb75..b2ab7d714c 100644
--- a/ql/src/test/results/clientpositive/spark/outer_join_ppr.q.out
+++ b/ql/src/test/results/clientpositive/spark/outer_join_ppr.q.out
@@ -100,7 +100,7 @@ STAGE PLANS:
                     name: default.src
                   name: default.src
             Truncated Path -> Alias:
-              /src [a]
+              /src [$hdt$_0:a]
         Map 3 
             Map Operator Tree:
                 TableScan
@@ -224,8 +224,8 @@ STAGE PLANS:
                     name: default.srcpart
                   name: default.srcpart
             Truncated Path -> Alias:
-              /srcpart/ds=2008-04-08/hr=11 [b]
-              /srcpart/ds=2008-04-08/hr=12 [b]
+              /srcpart/ds=2008-04-08/hr=11 [$hdt$_1:b]
+              /srcpart/ds=2008-04-08/hr=12 [$hdt$_1:b]
         Reducer 2 
             Needs Tagging: true
             Reduce Operator Tree:
@@ -406,7 +406,7 @@ STAGE PLANS:
                     name: default.src
                   name: default.src
             Truncated Path -> Alias:
-              /src [a]
+              /src [$hdt$_0:a]
         Map 3 
             Map Operator Tree:
                 TableScan
@@ -530,8 +530,8 @@ STAGE PLANS:
                     name: default.srcpart
                   name: default.srcpart
             Truncated Path -> Alias:
-              /srcpart/ds=2008-04-08/hr=11 [b]
-              /srcpart/ds=2008-04-08/hr=12 [b]
+              /srcpart/ds=2008-04-08/hr=11 [$hdt$_1:b]
+              /srcpart/ds=2008-04-08/hr=12 [$hdt$_1:b]
         Reducer 2 
             Needs Tagging: true
             Reduce Operator Tree:
diff --git a/ql/src/test/results/clientpositive/spark/pcr.q.out b/ql/src/test/results/clientpositive/spark/pcr.q.out
index 74e1845dd2..3ed71afc4d 100644
--- a/ql/src/test/results/clientpositive/spark/pcr.q.out
+++ b/ql/src/test/results/clientpositive/spark/pcr.q.out
@@ -1575,8 +1575,8 @@ STAGE PLANS:
                     name: default.pcr_t1
                   name: default.pcr_t1
             Truncated Path -> Alias:
-              /pcr_t1/ds=2000-04-08 [pcr_t1]
-              /pcr_t1/ds=2000-04-09 [pcr_t1]
+              /pcr_t1/ds=2000-04-08 [$hdt$_0:pcr_t1]
+              /pcr_t1/ds=2000-04-09 [$hdt$_0:pcr_t1]
         Reducer 2 
             Needs Tagging: false
             Reduce Operator Tree:
@@ -2410,7 +2410,7 @@ STAGE PLANS:
                     name: default.pcr_t1
                   name: default.pcr_t1
             Truncated Path -> Alias:
-              /pcr_t1/ds=2000-04-08 [t1]
+              /pcr_t1/ds=2000-04-08 [$hdt$_0:$hdt$_0:t1]
         Map 4 
             Map Operator Tree:
                 TableScan
@@ -2485,7 +2485,7 @@ STAGE PLANS:
                     name: default.pcr_t1
                   name: default.pcr_t1
             Truncated Path -> Alias:
-              /pcr_t1/ds=2000-04-08 [t2]
+              /pcr_t1/ds=2000-04-08 [$hdt$_0:$hdt$_1:t2]
         Reducer 2 
             Needs Tagging: true
             Reduce Operator Tree:
@@ -2683,7 +2683,7 @@ STAGE PLANS:
                     name: default.pcr_t1
                   name: default.pcr_t1
             Truncated Path -> Alias:
-              /pcr_t1/ds=2000-04-08 [t1]
+              /pcr_t1/ds=2000-04-08 [$hdt$_0:$hdt$_0:t1]
         Map 4 
             Map Operator Tree:
                 TableScan
@@ -2758,7 +2758,7 @@ STAGE PLANS:
                     name: default.pcr_t1
                   name: default.pcr_t1
             Truncated Path -> Alias:
-              /pcr_t1/ds=2000-04-09 [t2]
+              /pcr_t1/ds=2000-04-09 [$hdt$_0:$hdt$_1:t2]
         Reducer 2 
             Needs Tagging: true
             Reduce Operator Tree:
@@ -4249,8 +4249,8 @@ STAGE PLANS:
                     name: default.srcpart
                   name: default.srcpart
             Truncated Path -> Alias:
-              /srcpart/ds=2008-04-08/hr=11 [srcpart]
-              /srcpart/ds=2008-04-08/hr=12 [srcpart]
+              /srcpart/ds=2008-04-08/hr=11 [$hdt$_0:srcpart]
+              /srcpart/ds=2008-04-08/hr=12 [$hdt$_0:srcpart]
         Reducer 2 
             Needs Tagging: false
             Reduce Operator Tree:
@@ -4438,8 +4438,8 @@ STAGE PLANS:
                     name: default.srcpart
                   name: default.srcpart
             Truncated Path -> Alias:
-              /srcpart/ds=2008-04-08/hr=11 [srcpart]
-              /srcpart/ds=2008-04-09/hr=11 [srcpart]
+              /srcpart/ds=2008-04-08/hr=11 [$hdt$_0:srcpart]
+              /srcpart/ds=2008-04-09/hr=11 [$hdt$_0:srcpart]
         Reducer 2 
             Needs Tagging: false
             Reduce Operator Tree:
diff --git a/ql/src/test/results/clientpositive/spark/ppd_join_filter.q.out b/ql/src/test/results/clientpositive/spark/ppd_join_filter.q.out
index ca2db3f55e..b017647f69 100644
--- a/ql/src/test/results/clientpositive/spark/ppd_join_filter.q.out
+++ b/ql/src/test/results/clientpositive/spark/ppd_join_filter.q.out
@@ -108,7 +108,7 @@ STAGE PLANS:
                     name: default.src
                   name: default.src
             Truncated Path -> Alias:
-              /src [a]
+              /src [$hdt$_0:a]
         Map 3 
             Map Operator Tree:
                 TableScan
@@ -184,7 +184,7 @@ STAGE PLANS:
                     name: default.src
                   name: default.src
             Truncated Path -> Alias:
-              /src [src]
+              /src [$hdt$_1:src]
         Reducer 2 
             Needs Tagging: true
             Reduce Operator Tree:
@@ -399,7 +399,7 @@ STAGE PLANS:
                     name: default.src
                   name: default.src
             Truncated Path -> Alias:
-              /src [a]
+              /src [$hdt$_0:a]
         Map 3 
             Map Operator Tree:
                 TableScan
@@ -475,7 +475,7 @@ STAGE PLANS:
                     name: default.src
                   name: default.src
             Truncated Path -> Alias:
-              /src [src]
+              /src [$hdt$_1:src]
         Reducer 2 
             Needs Tagging: true
             Reduce Operator Tree:
@@ -690,7 +690,7 @@ STAGE PLANS:
                     name: default.src
                   name: default.src
             Truncated Path -> Alias:
-              /src [a]
+              /src [$hdt$_0:a]
         Map 3 
             Map Operator Tree:
                 TableScan
@@ -766,7 +766,7 @@ STAGE PLANS:
                     name: default.src
                   name: default.src
             Truncated Path -> Alias:
-              /src [src]
+              /src [$hdt$_1:src]
         Reducer 2 
             Needs Tagging: true
             Reduce Operator Tree:
@@ -981,7 +981,7 @@ STAGE PLANS:
                     name: default.src
                   name: default.src
             Truncated Path -> Alias:
-              /src [a]
+              /src [$hdt$_0:a]
         Map 3 
             Map Operator Tree:
                 TableScan
@@ -1057,7 +1057,7 @@ STAGE PLANS:
                     name: default.src
                   name: default.src
             Truncated Path -> Alias:
-              /src [src]
+              /src [$hdt$_1:src]
         Reducer 2 
             Needs Tagging: true
             Reduce Operator Tree:
diff --git a/ql/src/test/results/clientpositive/spark/router_join_ppr.q.out b/ql/src/test/results/clientpositive/spark/router_join_ppr.q.out
index 641af3c5e3..907977b47d 100644
--- a/ql/src/test/results/clientpositive/spark/router_join_ppr.q.out
+++ b/ql/src/test/results/clientpositive/spark/router_join_ppr.q.out
@@ -100,7 +100,7 @@ STAGE PLANS:
                     name: default.src
                   name: default.src
             Truncated Path -> Alias:
-              /src [a]
+              /src [$hdt$_0:a]
         Map 3 
             Map Operator Tree:
                 TableScan
@@ -224,8 +224,8 @@ STAGE PLANS:
                     name: default.srcpart
                   name: default.srcpart
             Truncated Path -> Alias:
-              /srcpart/ds=2008-04-08/hr=11 [b]
-              /srcpart/ds=2008-04-08/hr=12 [b]
+              /srcpart/ds=2008-04-08/hr=11 [$hdt$_1:b]
+              /srcpart/ds=2008-04-08/hr=12 [$hdt$_1:b]
         Reducer 2 
             Needs Tagging: true
             Reduce Operator Tree:
@@ -456,8 +456,8 @@ STAGE PLANS:
                     name: default.srcpart
                   name: default.srcpart
             Truncated Path -> Alias:
-              /srcpart/ds=2008-04-08/hr=11 [a]
-              /srcpart/ds=2008-04-08/hr=12 [a]
+              /srcpart/ds=2008-04-08/hr=11 [$hdt$_0:a]
+              /srcpart/ds=2008-04-08/hr=12 [$hdt$_0:a]
         Map 3 
             Map Operator Tree:
                 TableScan
@@ -531,7 +531,7 @@ STAGE PLANS:
                     name: default.src
                   name: default.src
             Truncated Path -> Alias:
-              /src [b]
+              /src [$hdt$_1:b]
         Reducer 2 
             Needs Tagging: true
             Reduce Operator Tree:
@@ -716,7 +716,7 @@ STAGE PLANS:
                     name: default.src
                   name: default.src
             Truncated Path -> Alias:
-              /src [a]
+              /src [$hdt$_0:a]
         Map 3 
             Map Operator Tree:
                 TableScan
@@ -840,8 +840,8 @@ STAGE PLANS:
                     name: default.srcpart
                   name: default.srcpart
             Truncated Path -> Alias:
-              /srcpart/ds=2008-04-08/hr=11 [b]
-              /srcpart/ds=2008-04-08/hr=12 [b]
+              /srcpart/ds=2008-04-08/hr=11 [$hdt$_1:b]
+              /srcpart/ds=2008-04-08/hr=12 [$hdt$_1:b]
         Reducer 2 
             Needs Tagging: true
             Reduce Operator Tree:
@@ -1072,8 +1072,8 @@ STAGE PLANS:
                     name: default.srcpart
                   name: default.srcpart
             Truncated Path -> Alias:
-              /srcpart/ds=2008-04-08/hr=11 [a]
-              /srcpart/ds=2008-04-08/hr=12 [a]
+              /srcpart/ds=2008-04-08/hr=11 [$hdt$_0:a]
+              /srcpart/ds=2008-04-08/hr=12 [$hdt$_0:a]
         Map 3 
             Map Operator Tree:
                 TableScan
@@ -1147,7 +1147,7 @@ STAGE PLANS:
                     name: default.src
                   name: default.src
             Truncated Path -> Alias:
-              /src [b]
+              /src [$hdt$_1:b]
         Reducer 2 
             Needs Tagging: true
             Reduce Operator Tree:
diff --git a/ql/src/test/results/clientpositive/spark/smb_mapjoin_15.q.out b/ql/src/test/results/clientpositive/spark/smb_mapjoin_15.q.out
index d652926ae9..1916075436 100644
--- a/ql/src/test/results/clientpositive/spark/smb_mapjoin_15.q.out
+++ b/ql/src/test/results/clientpositive/spark/smb_mapjoin_15.q.out
@@ -127,7 +127,7 @@ STAGE PLANS:
                     name: default.test_table1
                   name: default.test_table1
             Truncated Path -> Alias:
-              /test_table1 [a]
+              /test_table1 [$hdt$_0:a]
         Map 4 
             Map Operator Tree:
                 TableScan
@@ -205,7 +205,7 @@ STAGE PLANS:
                     name: default.test_table2
                   name: default.test_table2
             Truncated Path -> Alias:
-              /test_table2 [b]
+              /test_table2 [$hdt$_1:b]
         Reducer 2 
             Needs Tagging: true
             Reduce Operator Tree:
@@ -433,7 +433,7 @@ STAGE PLANS:
                     name: default.test_table1
                   name: default.test_table1
             Truncated Path -> Alias:
-              /test_table1 [a]
+              /test_table1 [$hdt$_0:a]
         Map 4 
             Map Operator Tree:
                 TableScan
@@ -511,7 +511,7 @@ STAGE PLANS:
                     name: default.test_table2
                   name: default.test_table2
             Truncated Path -> Alias:
-              /test_table2 [b]
+              /test_table2 [$hdt$_1:b]
         Reducer 2 
             Needs Tagging: true
             Reduce Operator Tree:
@@ -687,7 +687,7 @@ STAGE PLANS:
                     name: default.test_table1
                   name: default.test_table1
             Truncated Path -> Alias:
-              /test_table1 [a]
+              /test_table1 [$hdt$_0:a]
         Map 4 
             Map Operator Tree:
                 TableScan
@@ -765,7 +765,7 @@ STAGE PLANS:
                     name: default.test_table2
                   name: default.test_table2
             Truncated Path -> Alias:
-              /test_table2 [b]
+              /test_table2 [$hdt$_1:b]
         Reducer 2 
             Needs Tagging: true
             Reduce Operator Tree:
@@ -941,7 +941,7 @@ STAGE PLANS:
                     name: default.test_table1
                   name: default.test_table1
             Truncated Path -> Alias:
-              /test_table1 [a]
+              /test_table1 [$hdt$_0:a]
         Map 4 
             Map Operator Tree:
                 TableScan
@@ -1019,7 +1019,7 @@ STAGE PLANS:
                     name: default.test_table2
                   name: default.test_table2
             Truncated Path -> Alias:
-              /test_table2 [b]
+              /test_table2 [$hdt$_1:b]
         Reducer 2 
             Needs Tagging: true
             Reduce Operator Tree:
diff --git a/ql/src/test/results/clientpositive/spark/transform_ppr1.q.out b/ql/src/test/results/clientpositive/spark/transform_ppr1.q.out
index 637faa741b..bd28ff0b90 100644
--- a/ql/src/test/results/clientpositive/spark/transform_ppr1.q.out
+++ b/ql/src/test/results/clientpositive/spark/transform_ppr1.q.out
@@ -259,10 +259,10 @@ STAGE PLANS:
                     name: default.srcpart
                   name: default.srcpart
             Truncated Path -> Alias:
-              /srcpart/ds=2008-04-08/hr=11 [src]
-              /srcpart/ds=2008-04-08/hr=12 [src]
-              /srcpart/ds=2008-04-09/hr=11 [src]
-              /srcpart/ds=2008-04-09/hr=12 [src]
+              /srcpart/ds=2008-04-08/hr=11 [tmap:src]
+              /srcpart/ds=2008-04-08/hr=12 [tmap:src]
+              /srcpart/ds=2008-04-09/hr=11 [tmap:src]
+              /srcpart/ds=2008-04-09/hr=12 [tmap:src]
         Reducer 2 
             Needs Tagging: false
             Reduce Operator Tree:
diff --git a/ql/src/test/results/clientpositive/spark/transform_ppr2.q.out b/ql/src/test/results/clientpositive/spark/transform_ppr2.q.out
index ed22d54aae..d08ace613a 100644
--- a/ql/src/test/results/clientpositive/spark/transform_ppr2.q.out
+++ b/ql/src/test/results/clientpositive/spark/transform_ppr2.q.out
@@ -165,8 +165,8 @@ STAGE PLANS:
                     name: default.srcpart
                   name: default.srcpart
             Truncated Path -> Alias:
-              /srcpart/ds=2008-04-08/hr=11 [src]
-              /srcpart/ds=2008-04-08/hr=12 [src]
+              /srcpart/ds=2008-04-08/hr=11 [tmap:src]
+              /srcpart/ds=2008-04-08/hr=12 [tmap:src]
         Reducer 2 
             Needs Tagging: false
             Reduce Operator Tree:
diff --git a/ql/src/test/results/clientpositive/spark/union22.q.out b/ql/src/test/results/clientpositive/spark/union22.q.out
index 0aaf4754fe..6acaba8f70 100644
--- a/ql/src/test/results/clientpositive/spark/union22.q.out
+++ b/ql/src/test/results/clientpositive/spark/union22.q.out
@@ -158,7 +158,7 @@ STAGE PLANS:
                     name: default.dst_union22_delta
                   name: default.dst_union22_delta
             Truncated Path -> Alias:
-              /dst_union22_delta/ds=1 [dst_union22_delta]
+              /dst_union22_delta/ds=1 [null-subquery2:$hdt$_0-subquery2:$hdt$_1:dst_union22_delta]
 
   Stage: Stage-1
     Spark
@@ -259,7 +259,7 @@ STAGE PLANS:
                     name: default.dst_union22_delta
                   name: default.dst_union22_delta
             Truncated Path -> Alias:
-              /dst_union22_delta/ds=1 [dst_union22_delta]
+              /dst_union22_delta/ds=1 [null-subquery1:$hdt$_0-subquery1:dst_union22_delta]
         Map 2 
             Map Operator Tree:
                 TableScan
@@ -377,7 +377,7 @@ STAGE PLANS:
                     name: default.dst_union22
                   name: default.dst_union22
             Truncated Path -> Alias:
-              /dst_union22/ds=1 [a]
+              /dst_union22/ds=1 [null-subquery2:$hdt$_0-subquery2:$hdt$_0:a]
 
   Stage: Stage-0
     Move Operator
diff --git a/ql/src/test/results/clientpositive/spark/union24.q.out b/ql/src/test/results/clientpositive/spark/union24.q.out
index f9ac25ff91..6f7e04f2a9 100644
--- a/ql/src/test/results/clientpositive/spark/union24.q.out
+++ b/ql/src/test/results/clientpositive/spark/union24.q.out
@@ -165,7 +165,7 @@ STAGE PLANS:
                     name: default.src2
                   name: default.src2
             Truncated Path -> Alias:
-              /src2 [src2]
+              /src2 [null-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:src2]
         Map 2 
             Map Operator Tree:
                 TableScan
@@ -252,7 +252,7 @@ STAGE PLANS:
                     name: default.src3
                   name: default.src3
             Truncated Path -> Alias:
-              /src3 [src3]
+              /src3 [null-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:src3]
         Map 3 
             Map Operator Tree:
                 TableScan
@@ -339,7 +339,7 @@ STAGE PLANS:
                     name: default.src4
                   name: default.src4
             Truncated Path -> Alias:
-              /src4 [src4]
+              /src4 [null-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:src4]
         Map 4 
             Map Operator Tree:
                 TableScan
@@ -419,7 +419,7 @@ STAGE PLANS:
                     name: default.src5
                   name: default.src5
             Truncated Path -> Alias:
-              /src5 [src5]
+              /src5 [null-subquery2:$hdt$_0-subquery2:$hdt$_0:src5]
         Reducer 5 
             Needs Tagging: false
             Reduce Operator Tree:
@@ -627,7 +627,7 @@ STAGE PLANS:
                     name: default.src2
                   name: default.src2
             Truncated Path -> Alias:
-              /src2 [src2]
+              /src2 [null-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:src2]
         Map 2 
             Map Operator Tree:
                 TableScan
@@ -714,7 +714,7 @@ STAGE PLANS:
                     name: default.src3
                   name: default.src3
             Truncated Path -> Alias:
-              /src3 [src3]
+              /src3 [null-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:src3]
         Map 3 
             Map Operator Tree:
                 TableScan
@@ -787,7 +787,7 @@ STAGE PLANS:
                     name: default.src4
                   name: default.src4
             Truncated Path -> Alias:
-              /src4 [a]
+              /src4 [null-subquery2:$hdt$_0-subquery2:$hdt$_0:a]
         Map 5 
             Map Operator Tree:
                 TableScan
@@ -861,7 +861,7 @@ STAGE PLANS:
                     name: default.src5
                   name: default.src5
             Truncated Path -> Alias:
-              /src5 [b]
+              /src5 [null-subquery2:$hdt$_0-subquery2:$hdt$_1:b]
         Reducer 4 
             Needs Tagging: true
             Reduce Operator Tree:
@@ -1063,7 +1063,7 @@ STAGE PLANS:
                     name: default.src2
                   name: default.src2
             Truncated Path -> Alias:
-              /src2 [src2]
+              /src2 [null-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:src2]
         Map 2 
             Map Operator Tree:
                 TableScan
@@ -1150,7 +1150,7 @@ STAGE PLANS:
                     name: default.src3
                   name: default.src3
             Truncated Path -> Alias:
-              /src3 [src3]
+              /src3 [null-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:src3]
         Map 3 
             Map Operator Tree:
                 TableScan
@@ -1223,7 +1223,7 @@ STAGE PLANS:
                     name: default.src4
                   name: default.src4
             Truncated Path -> Alias:
-              /src4 [a]
+              /src4 [null-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_0:a]
         Map 6 
             Map Operator Tree:
                 TableScan
@@ -1296,7 +1296,7 @@ STAGE PLANS:
                     name: default.src5
                   name: default.src5
             Truncated Path -> Alias:
-              /src5 [b]
+              /src5 [null-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_1:b]
         Reducer 4 
             Needs Tagging: true
             Reduce Operator Tree:
diff --git a/ql/src/test/results/clientpositive/spark/union_ppr.q.out b/ql/src/test/results/clientpositive/spark/union_ppr.q.out
index d024a73f82..c8e678cf8c 100644
--- a/ql/src/test/results/clientpositive/spark/union_ppr.q.out
+++ b/ql/src/test/results/clientpositive/spark/union_ppr.q.out
@@ -152,8 +152,8 @@ STAGE PLANS:
                     name: default.srcpart
                   name: default.srcpart
             Truncated Path -> Alias:
-              /srcpart/ds=2008-04-08/hr=11 [x]
-              /srcpart/ds=2008-04-08/hr=12 [x]
+              /srcpart/ds=2008-04-08/hr=11 [a-subquery1:_u1-subquery1:x]
+              /srcpart/ds=2008-04-08/hr=12 [a-subquery1:_u1-subquery1:x]
         Map 3 
             Map Operator Tree:
                 TableScan
@@ -279,8 +279,8 @@ STAGE PLANS:
                     name: default.srcpart
                   name: default.srcpart
             Truncated Path -> Alias:
-              /srcpart/ds=2008-04-08/hr=11 [y]
-              /srcpart/ds=2008-04-08/hr=12 [y]
+              /srcpart/ds=2008-04-08/hr=11 [a-subquery2:_u1-subquery2:y]
+              /srcpart/ds=2008-04-08/hr=12 [a-subquery2:_u1-subquery2:y]
         Reducer 2 
             Needs Tagging: false
             Reduce Operator Tree:
