diff --git a/CHANGES.txt b/CHANGES.txt
index 6c6bc74fd0..cb260e81ec 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -310,6 +310,9 @@ Trunk - Unreleased
     HIVE-590. Pass type information in genFileSinkPlan and improve getSchema
     call in Driver. (Namit Jain via rmurthy)
 
+    HIVE-612. Problem in removing temp files in FileSinkOperator.jobClose
+    (Zheng Shao via namit)
+
 Release 0.3.1 - Unreleased
 
   INCOMPATIBLE CHANGES
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/Utilities.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/Utilities.java
index 04b8b1ee8d..0f6b526b40 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/Utilities.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/Utilities.java
@@ -696,18 +696,19 @@ public static void removeTempOrDuplicateFiles(FileSystem fs, Path path) throws I
         if(!fs.delete(one.getPath(), true)) {
           throw new IOException ("Unable to delete tmp file: " + one.getPath());
         }
-      }
-      String taskId = getTaskIdFromFilename(one.getPath().getName());
-      FileStatus otherFile = taskIdToFile.get(taskId);
-      if (otherFile == null) {
-        taskIdToFile.put(taskId, one);
       } else {
-        if(!fs.delete(one.getPath(), true)) {
-          throw new IOException ("Unable to delete duplicate file: "
-              + one.getPath() + ". Existing file: " + otherFile.getPath());
+        String taskId = getTaskIdFromFilename(one.getPath().getName());
+        FileStatus otherFile = taskIdToFile.get(taskId);
+        if (otherFile == null) {
+          taskIdToFile.put(taskId, one);
         } else {
-          LOG.warn("Duplicate taskid file removed: " + one.getPath() 
-              + ". Existing file: " + otherFile.getPath());
+          if(!fs.delete(one.getPath(), true)) {
+            throw new IOException ("Unable to delete duplicate file: "
+                + one.getPath() + ". Existing file: " + otherFile.getPath());
+          } else {
+            LOG.warn("Duplicate taskid file removed: " + one.getPath() 
+                + ". Existing file: " + otherFile.getPath());
+          }
         }
       }
     }
