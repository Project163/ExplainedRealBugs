diff --git a/CHANGES.txt b/CHANGES.txt
index 35b85a3609..2bdf049bfc 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -551,6 +551,8 @@ Release 0.4.0 -  Unreleased
     HIVE-772. Fix genConversionSelect for init serde with null.
     (Namit Jain via zshao)
 
+    HIVE-774. Fix the behavior of "/" and add "DIV". (Ning Zhang via zshao)
+
 Release 0.3.1 - Unreleased
 
   INCOMPATIBLE CHANGES
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/FunctionRegistry.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/FunctionRegistry.java
index c54195ec81..c88ef3cf3e 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/FunctionRegistry.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/FunctionRegistry.java
@@ -135,6 +135,7 @@ public class FunctionRegistry {
     registerUDF("*", UDFOPMultiply.class, true);
     registerUDF("/", UDFOPDivide.class, true);
     registerUDF("%", UDFOPMod.class, true);
+    registerUDF("div", UDFOPLongDivide.class, true);
 
     registerUDF("&", UDFOPBitAnd.class, true);
     registerUDF("|", UDFOPBitOr.class, true);
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/udf/UDFOPDivide.java b/ql/src/java/org/apache/hadoop/hive/ql/udf/UDFOPDivide.java
index 893b8d25b3..bb560b5b80 100755
--- a/ql/src/java/org/apache/hadoop/hive/ql/udf/UDFOPDivide.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/udf/UDFOPDivide.java
@@ -28,72 +28,21 @@
 import org.apache.hadoop.io.FloatWritable;
 import org.apache.hadoop.io.IntWritable;
 import org.apache.hadoop.io.LongWritable;
+import org.apache.hadoop.hive.ql.exec.NumericOpMethodResolver;
 
 @description(
     name = "/",
     value = "a _FUNC_ b - Divide a by b",
     extended = "Example:\n" +
-        "  > SELECT 10 _FUNC_ 2 FROM src LIMIT 1;\n" +
-        "  5"
+        "  > SELECT 3 _FUNC_ 2 FROM src LIMIT 1;\n" +
+        "  1.5"
 )
-public class UDFOPDivide extends UDFBaseNumericOp {
+public class UDFOPDivide extends UDF {
 
   private static Log LOG = LogFactory.getLog("org.apache.hadoop.hive.ql.udf.UDFOPDivide");
 
-  public UDFOPDivide() {
-  }
-
-  @Override
-  public ByteWritable evaluate(ByteWritable a, ByteWritable b)  {
-    // LOG.info("Get input " + a.getClass() + ":" + a + " " + b.getClass() + ":" + b);
-    if ((a == null) || (b == null))
-      return null;
-
-    byteWritable.set((byte)(a.get()/b.get()));
-    return byteWritable;
-  }
-
-  @Override
-  public ShortWritable evaluate(ShortWritable a, ShortWritable b)  {
-    // LOG.info("Get input " + a.getClass() + ":" + a + " " + b.getClass() + ":" + b);
-    if ((a == null) || (b == null))
-      return null;
-
-    shortWritable.set((short)(a.get()/b.get()));
-    return shortWritable;
-  }
-
-  @Override
-  public IntWritable evaluate(IntWritable a, IntWritable b)  {
-    // LOG.info("Get input " + a.getClass() + ":" + a + " " + b.getClass() + ":" + b);
-    if ((a == null) || (b == null))
-      return null;
-
-    intWritable.set((int)(a.get()/b.get()));
-    return intWritable;
-  }
-
-  @Override
-  public LongWritable evaluate(LongWritable a, LongWritable b)  {
-    // LOG.info("Get input " + a.getClass() + ":" + a + " " + b.getClass() + ":" + b);
-    if ((a == null) || (b == null))
-      return null;
-
-    longWritable.set(a.get()/b.get());
-    return longWritable;
-  }
-
-  @Override
-  public FloatWritable evaluate(FloatWritable a, FloatWritable b)  {
-    // LOG.info("Get input " + a.getClass() + ":" + a + " " + b.getClass() + ":" + b);
-    if ((a == null) || (b == null))
-      return null;
-
-    floatWritable.set(a.get()/b.get());
-    return floatWritable;
-  }
+  protected DoubleWritable doubleWritable = new DoubleWritable();
   
-  @Override
   public DoubleWritable evaluate(DoubleWritable a, DoubleWritable b)  {
     // LOG.info("Get input " + a.getClass() + ":" + a + " " + b.getClass() + ":" + b);
     if ((a == null) || (b == null))
@@ -102,5 +51,4 @@ public DoubleWritable evaluate(DoubleWritable a, DoubleWritable b)  {
     doubleWritable.set(a.get()/b.get());
     return doubleWritable;
   }
-
 }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/udf/UDFOPLongDivide.java b/ql/src/java/org/apache/hadoop/hive/ql/udf/UDFOPLongDivide.java
new file mode 100644
index 0000000000..2fcd067ff3
--- /dev/null
+++ b/ql/src/java/org/apache/hadoop/hive/ql/udf/UDFOPLongDivide.java
@@ -0,0 +1,53 @@
+/**
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.hadoop.hive.ql.udf;
+
+import org.apache.commons.logging.Log;
+import org.apache.commons.logging.LogFactory;
+import org.apache.hadoop.hive.ql.exec.UDF;
+import org.apache.hadoop.hive.ql.exec.description;
+import org.apache.hadoop.hive.serde2.io.ByteWritable;
+import org.apache.hadoop.hive.serde2.io.DoubleWritable;
+import org.apache.hadoop.hive.serde2.io.ShortWritable;
+import org.apache.hadoop.io.FloatWritable;
+import org.apache.hadoop.io.IntWritable;
+import org.apache.hadoop.io.LongWritable;
+
+@description(
+    name = "/",
+    value = "a _FUNC_ b - Divide a by b rounded to the long integer",
+    extended = "Example:\n" +
+        "  > SELECT 3 _FUNC_ 2 FROM src LIMIT 1;\n" +
+        "  1"
+)
+public class UDFOPLongDivide extends UDF {
+
+  private static Log LOG = LogFactory.getLog("org.apache.hadoop.hive.ql.udf.UDFOPLongDivide");
+
+  protected LongWritable longWritable = new LongWritable();
+  
+  public LongWritable evaluate(LongWritable a, LongWritable b)  {
+    // LOG.info("Get input " + a.getClass() + ":" + a + " " + b.getClass() + ":" + b);
+    if ((a == null) || (b == null))
+      return null;
+
+    longWritable.set((long)a.get()/b.get());
+    return longWritable;
+  }
+}
diff --git a/ql/src/test/queries/clientpositive/udf_divider.q b/ql/src/test/queries/clientpositive/udf_divider.q
new file mode 100644
index 0000000000..56a34040aa
--- /dev/null
+++ b/ql/src/test/queries/clientpositive/udf_divider.q
@@ -0,0 +1,3 @@
+SELECT 3 / 2 FROM SRC LIMIT 1;
+
+SELECT DIV(3, 2) FROM SRC LIMIT 1;
diff --git a/ql/src/test/results/clientpositive/show_functions.q.out b/ql/src/test/results/clientpositive/show_functions.q.out
index c925d8b392..9fff2c469f 100644
--- a/ql/src/test/results/clientpositive/show_functions.q.out
+++ b/ql/src/test/results/clientpositive/show_functions.q.out
@@ -37,6 +37,7 @@ date_sub
 datediff
 day
 dayofmonth
+div
 double
 elt
 exp
diff --git a/ql/src/test/results/clientpositive/udf_divider.q.out b/ql/src/test/results/clientpositive/udf_divider.q.out
new file mode 100644
index 0000000000..42ac7e0536
--- /dev/null
+++ b/ql/src/test/results/clientpositive/udf_divider.q.out
@@ -0,0 +1,8 @@
+query: SELECT 3 / 2 FROM SRC LIMIT 1
+Input: default/src
+Output: file:/data/users/nzhang/work/774/774-trunk-apache-hive/build/ql/tmp/2108880178/10000
+1.5
+query: SELECT DIV(3, 2) FROM SRC LIMIT 1
+Input: default/src
+Output: file:/data/users/nzhang/work/774/774-trunk-apache-hive/build/ql/tmp/166968095/10000
+1
