diff --git a/ql/src/test/org/apache/hadoop/hive/ql/QTestUtil.java b/ql/src/test/org/apache/hadoop/hive/ql/QTestUtil.java
index f167fad0a6..8d7d6bf0b3 100644
--- a/ql/src/test/org/apache/hadoop/hive/ql/QTestUtil.java
+++ b/ql/src/test/org/apache/hadoop/hive/ql/QTestUtil.java
@@ -35,6 +35,7 @@
 import java.io.UnsupportedEncodingException;
 import java.util.ArrayList;
 import java.util.Arrays;
+import java.util.Collection;
 import java.util.Deque;
 import java.util.HashMap;
 import java.util.HashSet;
@@ -100,6 +101,8 @@ public class QTestUtil {
   protected final String logDir;
   private final TreeMap<String, String> qMap;
   private final Set<String> qSkipSet;
+  private final Set<String> qSortSet;
+  private static final String SORT_SUFFIX = ".sorted";
   public static final HashSet<String> srcTables = new HashSet<String>
     (Arrays.asList(new String [] {
         "src", "src1", "srcbucket", "srcbucket2", "src_json", "src_thrift",
@@ -286,6 +289,7 @@ public QTestUtil(String outDir, String logDir, boolean miniMr, String hadoopVer)
     this.hadoopVer = getHadoopMainVersion(hadoopVer);
     qMap = new TreeMap<String, String>();
     qSkipSet = new HashSet<String>();
+    qSortSet = new HashSet<String>();
 
     if (miniMr) {
       dfs = ShimLoader.getHadoopShims().getMiniDfs(conf, 4, true, null);
@@ -347,15 +351,29 @@ public void addFile(File qf) throws Exception {
     while ((line = br.readLine()) != null) {
       qsb.append(line + "\n");
     }
-    String query = qsb.toString();
+    br.close();
 
+    String query = qsb.toString();
     qMap.put(qf.getName(), query);
 
     if(checkHadoopVersionExclude(qf.getName(), query)
       || checkOSExclude(qf.getName(), query)) {
       qSkipSet.add(qf.getName());
     }
-    br.close();
+
+    if (checkNeedsSort(qf.getName(), query)) {
+      qSortSet.add(qf.getName());
+    }
+  }
+
+  private boolean checkNeedsSort(String fileName, String query) {
+    Pattern pattern = Pattern.compile("-- SORT_BEFORE_DIFF");
+    Matcher matcher = pattern.matcher(query);
+    
+    if (matcher.find()) {
+      return true;
+    }
+    return false;
   }
 
   private boolean checkHadoopVersionExclude(String fileName, String query){
@@ -394,14 +412,14 @@ private boolean checkHadoopVersionExclude(String fileName, String query){
       String versions = matcher.group(2);
       for (String s : versions.split("\\,")) {
         s = s.trim();
-	versionSet.add(s);
+        versionSet.add(s);
       }
     }
 
     if (matcher.find()) {
       //2nd match is not supposed to be there
       String message = "QTestUtil: qfile " + fileName
-	  + " contains more than one reference to (EX|IN)CLUDE_HADOOP_MAJOR_VERSIONS";
+        + " contains more than one reference to (EX|IN)CLUDE_HADOOP_MAJOR_VERSIONS";
       throw new UnsupportedOperationException(message);
     }
 
@@ -427,20 +445,20 @@ private boolean checkOSExclude(String fileName, String query){
     if (matcher.find()) {
       String prefix = matcher.group(1);
       if ("EX".equals(prefix)) {
-	//windows is to be exluded
-	if(Shell.WINDOWS){
-	  System.out.println("Due to the OS being windows " +
-	    "adding the  query " + fileName +
-	    " to the set of tests to skip");
-	  return true;
-	}
+        //windows is to be exluded
+        if(Shell.WINDOWS){
+          System.out.println("Due to the OS being windows " +
+                             "adding the  query " + fileName +
+                             " to the set of tests to skip");
+          return true;
+        }
       }
       else  if(!Shell.WINDOWS){
-	//non windows to be exluded
-	System.out.println("Due to the OS not being windows " +
-	    "adding the  query " + fileName +
-	    " to the set of tests to skip");
-	return true;
+        //non windows to be exluded
+        System.out.println("Due to the OS not being windows " +
+                           "adding the  query " + fileName +
+                           " to the set of tests to skip");
+        return true;
       }
     }
     return false;
@@ -817,7 +835,8 @@ public int checkNegativeResults(String tname, Exception e) throws Exception {
     outfd.write(e.getMessage());
     outfd.close();
 
-    int exitVal = executeDiffCommand(outf.getPath(), expf, false);
+    int exitVal = executeDiffCommand(outf.getPath(), expf, false, 
+                                     qSortSet.contains(qf.getName()));
     if (exitVal != 0 && overWrite) {
       exitVal = overwriteResults(outf.getPath(), expf);
     }
@@ -839,7 +858,7 @@ public int checkParseResults(String tname, ASTNode tree) throws Exception {
       outfd.write(tree.toStringTree());
       outfd.close();
 
-      int exitVal = executeDiffCommand(outf.getPath(), expf, false);
+      int exitVal = executeDiffCommand(outf.getPath(), expf, false, false);
 
       if (exitVal != 0 && overWrite) {
         exitVal = overwriteResults(outf.getPath(), expf);
@@ -876,7 +895,7 @@ public int checkPlan(String tname, List<Task<? extends Serializable>> tasks) thr
       };
       maskPatterns(patterns, outf.getPath());
 
-      int exitVal = executeDiffCommand(outf.getPath(), planFile, true);
+      int exitVal = executeDiffCommand(outf.getPath(), planFile, true, false);
 
       if (exitVal != 0 && overWrite) {
         exitVal = overwriteResults(outf.getPath(), planFile);
@@ -1009,7 +1028,8 @@ public int checkCliDriverResults(String tname) throws Exception {
 
     maskPatterns(patterns, f.getPath());
     int exitVal = executeDiffCommand(f.getPath(),
-                    outFileName, false);
+                                     outFileName, false,
+                                     qSortSet.contains(tname));
 
     if (exitVal != 0 && overWrite) {
       exitVal = overwriteResults(f.getPath(), outFileName);
@@ -1022,18 +1042,42 @@ private static int overwriteResults(String inFileName, String outFileName) throw
     // This method can be replaced with Files.copy(source, target, REPLACE_EXISTING)
     // once Hive uses JAVA 7.
     System.out.println("Overwriting results");
-    String[] cmdArray = new String[] {
+    return executeCmd(new String[] {
         "cp",
-        Shell.WINDOWS ? getQuotedString(inFileName) : inFileName,
-        Shell.WINDOWS ? getQuotedString(outFileName) : outFileName
-    };
-    Process executor = Runtime.getRuntime().exec(cmdArray);
-    return executor.waitFor();
+        getQuotedString(inFileName),
+        getQuotedString(outFileName)
+      });
   }
 
   private static int executeDiffCommand(String inFileName,
       String outFileName,
-      boolean ignoreWhiteSpace) throws Exception {
+      boolean ignoreWhiteSpace,
+      boolean sortResults
+      ) throws Exception {
+
+    int result = 0;
+    
+    if (sortResults) {
+      // sort will try to open the output file in write mode on windows. We need to
+      // close it first.
+      SessionState ss = SessionState.get();
+      if (ss != null && ss.out != null && ss.out != System.out) {
+	ss.out.close();
+      }
+
+      String inSorted = inFileName + SORT_SUFFIX;
+      String outSorted = outFileName + SORT_SUFFIX;
+
+      result = sortFiles(inFileName, inSorted);
+      result |= sortFiles(outFileName, outSorted);
+      if (result != 0) {
+        System.err.println("ERROR: Could not sort files before comparing");
+        return result;
+      }
+      inFileName = inSorted;
+      outFileName = outSorted;
+    }
+
     ArrayList<String> diffCommandArgs = new ArrayList<String>();
     diffCommandArgs.add("diff");
 
@@ -1055,26 +1099,75 @@ private static int executeDiffCommand(String inFileName,
       diffCommandArgs.add("-B"); // Ignore changes whose lines are all blank
     }
     // Add files to compare to the arguments list
-    diffCommandArgs.add(Shell.WINDOWS ? getQuotedString(inFileName) : inFileName);
-    diffCommandArgs.add(Shell.WINDOWS ? getQuotedString(outFileName) : outFileName);
-    String[] cmdArray =(String [])diffCommandArgs.toArray(new String [diffCommandArgs.size ()]);
-    System.out.println(org.apache.commons.lang.StringUtils.join(cmdArray, ' '));
+    diffCommandArgs.add(getQuotedString(inFileName));
+    diffCommandArgs.add(getQuotedString(outFileName));
 
-    Process executor = Runtime.getRuntime().exec(cmdArray);
+    result = executeCmd(diffCommandArgs);
 
-    StreamPrinter outPrinter = new StreamPrinter(
-        executor.getInputStream(), null, SessionState.getConsole().getChildOutStream());
-    StreamPrinter errPrinter = new StreamPrinter(
-        executor.getErrorStream(), null, SessionState.getConsole().getChildErrStream());
+    if (sortResults) {
+      new File(inFileName).delete();
+      new File(outFileName).delete();
+    }
+
+    return result;
+  }
+
+  private static int sortFiles(String in, String out) throws Exception {
+    return executeCmd(new String[] {
+        "sort",
+        getQuotedString(in),
+      }, out, null);
+  }
+
+  private static int executeCmd(Collection<String> args) throws Exception {
+    return executeCmd(args, null, null);
+  }
+
+  private static int executeCmd(String[] args) throws Exception {
+    return executeCmd(args, null, null);
+  }
+
+  private static int executeCmd(Collection<String> args, String outFile, String errFile) throws Exception {
+    String[] cmdArray = (String[]) args.toArray(new String[args.size()]);
+    return executeCmd(cmdArray, outFile, errFile);
+  }
+
+  private static int executeCmd(String[] args, String outFile, String errFile) throws Exception {
+    System.out.println("Running: " + org.apache.commons.lang.StringUtils.join(args, ' '));
+
+    PrintStream out = outFile == null ? 
+      SessionState.getConsole().getChildOutStream() : 
+      new PrintStream(new FileOutputStream(outFile), true);
+    PrintStream err = errFile == null ? 
+      SessionState.getConsole().getChildErrStream() : 
+      new PrintStream(new FileOutputStream(errFile), true);
 
+    Process executor = Runtime.getRuntime().exec(args);
+
+    StreamPrinter errPrinter = new StreamPrinter(executor.getErrorStream(), null, err);
+    StreamPrinter outPrinter = new StreamPrinter(executor.getInputStream(), null, out);
+    
     outPrinter.start();
     errPrinter.start();
 
-    return executor.waitFor();
+    int result = executor.waitFor();
+
+    outPrinter.join();
+    errPrinter.join();
+
+    if (outFile != null) {
+      out.close();
+    }
+
+    if (errFile != null) {
+      err.close();
+    }
+
+    return result;
   }
 
   private static String getQuotedString(String str){
-    return String.format("\"%s\"", str);
+    return Shell.WINDOWS ? String.format("\"%s\"", str) : str;
   }
 
   public ASTNode parseQuery(String tname) throws Exception {
diff --git a/ql/src/test/queries/clientnegative/authorization_fail_3.q b/ql/src/test/queries/clientnegative/authorization_fail_3.q
index d1cf11d0f5..6a56daa05f 100644
--- a/ql/src/test/queries/clientnegative/authorization_fail_3.q
+++ b/ql/src/test/queries/clientnegative/authorization_fail_3.q
@@ -1,3 +1,5 @@
+-- SORT_BEFORE_DIFF
+
 create table authorization_fail_3 (key int, value string) partitioned by (ds string);
 set hive.security.authorization.enabled=true;
 
diff --git a/ql/src/test/queries/clientnegative/authorization_fail_4.q b/ql/src/test/queries/clientnegative/authorization_fail_4.q
index a4d78fa874..f0cb6459a2 100644
--- a/ql/src/test/queries/clientnegative/authorization_fail_4.q
+++ b/ql/src/test/queries/clientnegative/authorization_fail_4.q
@@ -1,3 +1,5 @@
+-- SORT_BEFORE_DIFF
+
 create table authorization_fail_4 (key int, value string) partitioned by (ds string);
 
 set hive.security.authorization.enabled=true;
diff --git a/ql/src/test/queries/clientnegative/authorization_fail_5.q b/ql/src/test/queries/clientnegative/authorization_fail_5.q
index a0f1febda7..b4efab5667 100644
--- a/ql/src/test/queries/clientnegative/authorization_fail_5.q
+++ b/ql/src/test/queries/clientnegative/authorization_fail_5.q
@@ -1,3 +1,5 @@
+-- SORT_BEFORE_DIFF
+
 create table authorization_fail (key int, value string) partitioned by (ds string);
 set hive.security.authorization.enabled=true;
 
diff --git a/ql/src/test/queries/clientnegative/authorization_fail_6.q b/ql/src/test/queries/clientnegative/authorization_fail_6.q
index e42da4f428..977246948c 100644
--- a/ql/src/test/queries/clientnegative/authorization_fail_6.q
+++ b/ql/src/test/queries/clientnegative/authorization_fail_6.q
@@ -1,3 +1,5 @@
+-- SORT_BEFORE_DIFF
+
 create table authorization_part_fail (key int, value string) partitioned by (ds string);
 set hive.security.authorization.enabled=true;
 
diff --git a/ql/src/test/queries/clientnegative/authorization_fail_7.q b/ql/src/test/queries/clientnegative/authorization_fail_7.q
index 62a1d8d9e1..492deed10b 100644
--- a/ql/src/test/queries/clientnegative/authorization_fail_7.q
+++ b/ql/src/test/queries/clientnegative/authorization_fail_7.q
@@ -1,3 +1,5 @@
+-- SORT_BEFORE_DIFF
+
 create table authorization_fail (key int, value string);
 
 set hive.security.authorization.enabled=true;
diff --git a/ql/src/test/queries/clientnegative/authorization_part.q b/ql/src/test/queries/clientnegative/authorization_part.q
index a825305228..a654a2380c 100644
--- a/ql/src/test/queries/clientnegative/authorization_part.q
+++ b/ql/src/test/queries/clientnegative/authorization_part.q
@@ -1,3 +1,5 @@
+-- SORT_BEFORE_DIFF
+
 create table authorization_part_fail (key int, value string) partitioned by (ds string);
 ALTER TABLE authorization_part_fail SET TBLPROPERTIES ("PARTITION_LEVEL_PRIVILEGE"="TRUE");
 create table src_auth as select * from src;
diff --git a/ql/src/test/queries/clientpositive/alter_rename_partition_authorization.q b/ql/src/test/queries/clientpositive/alter_rename_partition_authorization.q
index 7c4495a971..cdefc2dcbe 100644
--- a/ql/src/test/queries/clientpositive/alter_rename_partition_authorization.q
+++ b/ql/src/test/queries/clientpositive/alter_rename_partition_authorization.q
@@ -1,3 +1,5 @@
+-- SORT_BEFORE_DIFF
+
 create table src_auth_tmp as select * from src;
 
 create table authorization_part (key int, value string) partitioned by (ds string);
diff --git a/ql/src/test/queries/clientpositive/authorization_1.q b/ql/src/test/queries/clientpositive/authorization_1.q
index 2f0ab2e272..25c99187f3 100644
--- a/ql/src/test/queries/clientpositive/authorization_1.q
+++ b/ql/src/test/queries/clientpositive/authorization_1.q
@@ -1,3 +1,5 @@
+-- SORT_BEFORE_DIFF
+
 create table src_autho_test as select * from src;
 
 set hive.security.authorization.enabled=true;
diff --git a/ql/src/test/queries/clientpositive/authorization_2.q b/ql/src/test/queries/clientpositive/authorization_2.q
index 6b8de02b98..4fc79b9ed2 100644
--- a/ql/src/test/queries/clientpositive/authorization_2.q
+++ b/ql/src/test/queries/clientpositive/authorization_2.q
@@ -1,3 +1,5 @@
+-- SORT_BEFORE_DIFF
+
 create table authorization_part (key int, value string) partitioned by (ds string);
 create table src_auth_tmp as select * from src;
 ALTER TABLE authorization_part SET TBLPROPERTIES ("PARTITION_LEVEL_PRIVILEGE"="TRUE");
diff --git a/ql/src/test/queries/clientpositive/authorization_3.q b/ql/src/test/queries/clientpositive/authorization_3.q
index ab5fe6e20d..ba76b0002f 100644
--- a/ql/src/test/queries/clientpositive/authorization_3.q
+++ b/ql/src/test/queries/clientpositive/authorization_3.q
@@ -1,3 +1,5 @@
+-- SORT_BEFORE_DIFF
+
 create table src_autho_test as select * from src;
 
 grant drop on table src_autho_test to user hive_test_user;
diff --git a/ql/src/test/queries/clientpositive/authorization_4.q b/ql/src/test/queries/clientpositive/authorization_4.q
index e624102a74..152c8e5cf3 100644
--- a/ql/src/test/queries/clientpositive/authorization_4.q
+++ b/ql/src/test/queries/clientpositive/authorization_4.q
@@ -1,3 +1,5 @@
+-- SORT_BEFORE_DIFF
+
 create table src_autho_test as select * from src;
 
 grant All on table src_autho_test to user hive_test_user;
diff --git a/ql/src/test/queries/clientpositive/authorization_5.q b/ql/src/test/queries/clientpositive/authorization_5.q
index 2caf8f0b3a..8869edce2f 100644
--- a/ql/src/test/queries/clientpositive/authorization_5.q
+++ b/ql/src/test/queries/clientpositive/authorization_5.q
@@ -1,3 +1,5 @@
+-- SORT_BEFORE_DIFF
+
 CREATE DATABASE IF NOT EXISTS test_db COMMENT 'Hive test database';
 SHOW DATABASES;
 
diff --git a/ql/src/test/queries/clientpositive/authorization_6.q b/ql/src/test/queries/clientpositive/authorization_6.q
index 9632cfee9d..258ada4988 100644
--- a/ql/src/test/queries/clientpositive/authorization_6.q
+++ b/ql/src/test/queries/clientpositive/authorization_6.q
@@ -1,3 +1,5 @@
+-- SORT_BEFORE_DIFF
+
 create table src_auth_tmp as select * from src;
 
 create table authorization_part (key int, value string) partitioned by (ds string);
diff --git a/ql/src/test/queries/clientpositive/keyword_1.q b/ql/src/test/queries/clientpositive/keyword_1.q
index 718a90da94..2e996af28e 100644
--- a/ql/src/test/queries/clientpositive/keyword_1.q
+++ b/ql/src/test/queries/clientpositive/keyword_1.q
@@ -1,3 +1,5 @@
+-- SORT_BEFORE_DIFF
+
 create table test_user (user string, `group` string);
 grant select on table test_user to user hive_test;
 
diff --git a/ql/src/test/results/clientnegative/authorization_fail_3.q.out b/ql/src/test/results/clientnegative/authorization_fail_3.q.out
index 923b68cc7b..221fcad705 100644
--- a/ql/src/test/results/clientnegative/authorization_fail_3.q.out
+++ b/ql/src/test/results/clientnegative/authorization_fail_3.q.out
@@ -1,6 +1,10 @@
-PREHOOK: query: create table authorization_fail_3 (key int, value string) partitioned by (ds string)
+PREHOOK: query: -- SORT_BEFORE_DIFF
+
+create table authorization_fail_3 (key int, value string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
-POSTHOOK: query: create table authorization_fail_3 (key int, value string) partitioned by (ds string)
+POSTHOOK: query: -- SORT_BEFORE_DIFF
+
+create table authorization_fail_3 (key int, value string) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: default@authorization_fail_3
 PREHOOK: query: grant Create on table authorization_fail_3 to user hive_test_user
diff --git a/ql/src/test/results/clientnegative/authorization_fail_4.q.out b/ql/src/test/results/clientnegative/authorization_fail_4.q.out
index 4fae1c83ce..9e5cbe777c 100644
--- a/ql/src/test/results/clientnegative/authorization_fail_4.q.out
+++ b/ql/src/test/results/clientnegative/authorization_fail_4.q.out
@@ -1,6 +1,10 @@
-PREHOOK: query: create table authorization_fail_4 (key int, value string) partitioned by (ds string)
+PREHOOK: query: -- SORT_BEFORE_DIFF
+
+create table authorization_fail_4 (key int, value string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
-POSTHOOK: query: create table authorization_fail_4 (key int, value string) partitioned by (ds string)
+POSTHOOK: query: -- SORT_BEFORE_DIFF
+
+create table authorization_fail_4 (key int, value string) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: default@authorization_fail_4
 PREHOOK: query: grant Alter on table authorization_fail_4 to user hive_test_user
diff --git a/ql/src/test/results/clientnegative/authorization_fail_5.q.out b/ql/src/test/results/clientnegative/authorization_fail_5.q.out
index f2e57404cd..1b4f1890ab 100644
--- a/ql/src/test/results/clientnegative/authorization_fail_5.q.out
+++ b/ql/src/test/results/clientnegative/authorization_fail_5.q.out
@@ -1,6 +1,10 @@
-PREHOOK: query: create table authorization_fail (key int, value string) partitioned by (ds string)
+PREHOOK: query: -- SORT_BEFORE_DIFF
+
+create table authorization_fail (key int, value string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
-POSTHOOK: query: create table authorization_fail (key int, value string) partitioned by (ds string)
+POSTHOOK: query: -- SORT_BEFORE_DIFF
+
+create table authorization_fail (key int, value string) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: default@authorization_fail
 PREHOOK: query: grant Alter on table authorization_fail to user hive_test_user
diff --git a/ql/src/test/results/clientnegative/authorization_fail_6.q.out b/ql/src/test/results/clientnegative/authorization_fail_6.q.out
index 194776aace..69581948c4 100644
--- a/ql/src/test/results/clientnegative/authorization_fail_6.q.out
+++ b/ql/src/test/results/clientnegative/authorization_fail_6.q.out
@@ -1,6 +1,10 @@
-PREHOOK: query: create table authorization_part_fail (key int, value string) partitioned by (ds string)
+PREHOOK: query: -- SORT_BEFORE_DIFF
+
+create table authorization_part_fail (key int, value string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
-POSTHOOK: query: create table authorization_part_fail (key int, value string) partitioned by (ds string)
+POSTHOOK: query: -- SORT_BEFORE_DIFF
+
+create table authorization_part_fail (key int, value string) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: default@authorization_part_fail
 Authorization failed:No privilege 'Alter' found for inputs { database:default, table:authorization_part_fail}. Use show grant to get more details.
diff --git a/ql/src/test/results/clientnegative/authorization_fail_7.q.out b/ql/src/test/results/clientnegative/authorization_fail_7.q.out
index 34b8b2cb38..b93d7a28dd 100644
--- a/ql/src/test/results/clientnegative/authorization_fail_7.q.out
+++ b/ql/src/test/results/clientnegative/authorization_fail_7.q.out
@@ -1,6 +1,10 @@
-PREHOOK: query: create table authorization_fail (key int, value string)
+PREHOOK: query: -- SORT_BEFORE_DIFF
+
+create table authorization_fail (key int, value string)
 PREHOOK: type: CREATETABLE
-POSTHOOK: query: create table authorization_fail (key int, value string)
+POSTHOOK: query: -- SORT_BEFORE_DIFF
+
+create table authorization_fail (key int, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: default@authorization_fail
 PREHOOK: query: create role hive_test_role_fail
diff --git a/ql/src/test/results/clientnegative/authorization_part.q.out b/ql/src/test/results/clientnegative/authorization_part.q.out
index affc89c41f..c45fd4f708 100644
--- a/ql/src/test/results/clientnegative/authorization_part.q.out
+++ b/ql/src/test/results/clientnegative/authorization_part.q.out
@@ -1,6 +1,10 @@
-PREHOOK: query: create table authorization_part_fail (key int, value string) partitioned by (ds string)
+PREHOOK: query: -- SORT_BEFORE_DIFF
+
+create table authorization_part_fail (key int, value string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
-POSTHOOK: query: create table authorization_part_fail (key int, value string) partitioned by (ds string)
+POSTHOOK: query: -- SORT_BEFORE_DIFF
+
+create table authorization_part_fail (key int, value string) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: default@authorization_part_fail
 PREHOOK: query: ALTER TABLE authorization_part_fail SET TBLPROPERTIES ("PARTITION_LEVEL_PRIVILEGE"="TRUE")
diff --git a/ql/src/test/results/clientpositive/alter_rename_partition_authorization.q.out b/ql/src/test/results/clientpositive/alter_rename_partition_authorization.q.out
index ce0511b67e..4262b7c9a9 100644
--- a/ql/src/test/results/clientpositive/alter_rename_partition_authorization.q.out
+++ b/ql/src/test/results/clientpositive/alter_rename_partition_authorization.q.out
@@ -1,7 +1,11 @@
-PREHOOK: query: create table src_auth_tmp as select * from src
+PREHOOK: query: -- SORT_BEFORE_DIFF
+
+create table src_auth_tmp as select * from src
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
-POSTHOOK: query: create table src_auth_tmp as select * from src
+POSTHOOK: query: -- SORT_BEFORE_DIFF
+
+create table src_auth_tmp as select * from src
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
 POSTHOOK: Output: default@src_auth_tmp
diff --git a/ql/src/test/results/clientpositive/authorization_1.q.out b/ql/src/test/results/clientpositive/authorization_1.q.out
index 04d5fb010d..0970ef606e 100644
--- a/ql/src/test/results/clientpositive/authorization_1.q.out
+++ b/ql/src/test/results/clientpositive/authorization_1.q.out
@@ -1,7 +1,11 @@
-PREHOOK: query: create table src_autho_test as select * from src
+PREHOOK: query: -- SORT_BEFORE_DIFF
+
+create table src_autho_test as select * from src
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
-POSTHOOK: query: create table src_autho_test as select * from src
+POSTHOOK: query: -- SORT_BEFORE_DIFF
+
+create table src_autho_test as select * from src
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
 POSTHOOK: Output: default@src_autho_test
diff --git a/ql/src/test/results/clientpositive/authorization_2.q.out b/ql/src/test/results/clientpositive/authorization_2.q.out
index da1cad9d84..c934a2a5cc 100644
--- a/ql/src/test/results/clientpositive/authorization_2.q.out
+++ b/ql/src/test/results/clientpositive/authorization_2.q.out
@@ -1,6 +1,10 @@
-PREHOOK: query: create table authorization_part (key int, value string) partitioned by (ds string)
+PREHOOK: query: -- SORT_BEFORE_DIFF
+
+create table authorization_part (key int, value string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
-POSTHOOK: query: create table authorization_part (key int, value string) partitioned by (ds string)
+POSTHOOK: query: -- SORT_BEFORE_DIFF
+
+create table authorization_part (key int, value string) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: default@authorization_part
 PREHOOK: query: create table src_auth_tmp as select * from src
diff --git a/ql/src/test/results/clientpositive/authorization_3.q.out b/ql/src/test/results/clientpositive/authorization_3.q.out
index 5441ff35d1..455589227e 100644
--- a/ql/src/test/results/clientpositive/authorization_3.q.out
+++ b/ql/src/test/results/clientpositive/authorization_3.q.out
@@ -1,7 +1,11 @@
-PREHOOK: query: create table src_autho_test as select * from src
+PREHOOK: query: -- SORT_BEFORE_DIFF
+
+create table src_autho_test as select * from src
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
-POSTHOOK: query: create table src_autho_test as select * from src
+POSTHOOK: query: -- SORT_BEFORE_DIFF
+
+create table src_autho_test as select * from src
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
 POSTHOOK: Output: default@src_autho_test
diff --git a/ql/src/test/results/clientpositive/authorization_4.q.out b/ql/src/test/results/clientpositive/authorization_4.q.out
index 9dded39617..f80b51716c 100644
--- a/ql/src/test/results/clientpositive/authorization_4.q.out
+++ b/ql/src/test/results/clientpositive/authorization_4.q.out
@@ -1,7 +1,11 @@
-PREHOOK: query: create table src_autho_test as select * from src
+PREHOOK: query: -- SORT_BEFORE_DIFF
+
+create table src_autho_test as select * from src
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
-POSTHOOK: query: create table src_autho_test as select * from src
+POSTHOOK: query: -- SORT_BEFORE_DIFF
+
+create table src_autho_test as select * from src
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
 POSTHOOK: Output: default@src_autho_test
diff --git a/ql/src/test/results/clientpositive/authorization_5.q.out b/ql/src/test/results/clientpositive/authorization_5.q.out
index ed6dd89bd9..11effa7eb0 100644
--- a/ql/src/test/results/clientpositive/authorization_5.q.out
+++ b/ql/src/test/results/clientpositive/authorization_5.q.out
@@ -1,6 +1,10 @@
-PREHOOK: query: CREATE DATABASE IF NOT EXISTS test_db COMMENT 'Hive test database'
+PREHOOK: query: -- SORT_BEFORE_DIFF
+
+CREATE DATABASE IF NOT EXISTS test_db COMMENT 'Hive test database'
 PREHOOK: type: CREATEDATABASE
-POSTHOOK: query: CREATE DATABASE IF NOT EXISTS test_db COMMENT 'Hive test database'
+POSTHOOK: query: -- SORT_BEFORE_DIFF
+
+CREATE DATABASE IF NOT EXISTS test_db COMMENT 'Hive test database'
 POSTHOOK: type: CREATEDATABASE
 PREHOOK: query: SHOW DATABASES
 PREHOOK: type: SHOWDATABASES
diff --git a/ql/src/test/results/clientpositive/authorization_6.q.out b/ql/src/test/results/clientpositive/authorization_6.q.out
index 583d045fb4..b8483ca5ee 100644
--- a/ql/src/test/results/clientpositive/authorization_6.q.out
+++ b/ql/src/test/results/clientpositive/authorization_6.q.out
@@ -1,7 +1,11 @@
-PREHOOK: query: create table src_auth_tmp as select * from src
+PREHOOK: query: -- SORT_BEFORE_DIFF
+
+create table src_auth_tmp as select * from src
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
-POSTHOOK: query: create table src_auth_tmp as select * from src
+POSTHOOK: query: -- SORT_BEFORE_DIFF
+
+create table src_auth_tmp as select * from src
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
 POSTHOOK: Output: default@src_auth_tmp
diff --git a/ql/src/test/results/clientpositive/keyword_1.q.out b/ql/src/test/results/clientpositive/keyword_1.q.out
index 2e55c828c6..8ee3d86fcd 100644
--- a/ql/src/test/results/clientpositive/keyword_1.q.out
+++ b/ql/src/test/results/clientpositive/keyword_1.q.out
@@ -1,6 +1,10 @@
-PREHOOK: query: create table test_user (user string, `group` string)
+PREHOOK: query: -- SORT_BEFORE_DIFF
+
+create table test_user (user string, `group` string)
 PREHOOK: type: CREATETABLE
-POSTHOOK: query: create table test_user (user string, `group` string)
+POSTHOOK: query: -- SORT_BEFORE_DIFF
+
+create table test_user (user string, `group` string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: default@test_user
 PREHOOK: query: grant select on table test_user to user hive_test
