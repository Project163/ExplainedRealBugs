diff --git a/ql/src/java/org/apache/hadoop/hive/ql/ErrorMsg.java b/ql/src/java/org/apache/hadoop/hive/ql/ErrorMsg.java
index bc18ef5423..8ae1c73f3a 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/ErrorMsg.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/ErrorMsg.java
@@ -404,6 +404,7 @@ public enum ErrorMsg {
   NO_COMPACTION_PARTITION(10283, "You must specify a partition to compact for partitioned tables"),
   TOO_MANY_COMPACTION_PARTITIONS(10284, "Compaction can only be requested on one partition at a " +
       "time."),
+  DISTINCT_NOT_SUPPORTED(10285, "Distinct keyword is not support in current context"),
 
   //========================== 20000 range starts here ========================//
   SCRIPT_INIT_ERROR(20000, "Unable to initialize custom script."),
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
index d5acb2e15b..f6b4c1a40a 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
@@ -3191,6 +3191,7 @@ && isRegex(unescapeIdentifier(expr.getChild(1).getText()), conf)) {
         TypeCheckCtx tcCtx = new TypeCheckCtx(inputRR);
         // We allow stateful functions in the SELECT list (but nowhere else)
         tcCtx.setAllowStatefulFunctions(true);
+        tcCtx.setAllowDistinctFunctions(false);
         ExprNodeDesc exp = genExprNodeDesc(expr, inputRR, tcCtx);
         String recommended = recommendName(exp, colAlias);
         if (recommended != null && out_rwsch.get(null, recommended) == null) {
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/TypeCheckCtx.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/TypeCheckCtx.java
index 5b0538ca78..a95ae20b4f 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/TypeCheckCtx.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/TypeCheckCtx.java
@@ -52,6 +52,8 @@ public class TypeCheckCtx implements NodeProcessorCtx {
    */
   private boolean allowStatefulFunctions;
 
+  private boolean allowDistinctFunctions;
+
   /**
    * Constructor.
    *
@@ -62,6 +64,7 @@ public TypeCheckCtx(RowResolver inputRR) {
     setInputRR(inputRR);
     error = null;
     allowStatefulFunctions = false;
+    allowDistinctFunctions = true;
   }
 
   /**
@@ -129,4 +132,11 @@ public ASTNode getErrorSrcNode() {
     return errorSrcNode;
   }
 
+  public void setAllowDistinctFunctions(boolean allowDistinctFunctions) {
+    this.allowDistinctFunctions = allowDistinctFunctions;
+  }
+
+  public boolean isAllowDistinctFunctions() {
+    return allowDistinctFunctions;
+  }
 }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/TypeCheckProcFactory.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/TypeCheckProcFactory.java
index 9a947ec374..e7da2895ef 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/TypeCheckProcFactory.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/TypeCheckProcFactory.java
@@ -1088,6 +1088,11 @@ public Object process(Node nd, Stack<Node> stack, NodeProcessorCtx procCtx,
           expr.getType() == HiveParser.TOK_FUNCTIONSTAR ||
           expr.getType() == HiveParser.TOK_FUNCTIONDI);
 
+      if (!ctx.isAllowDistinctFunctions() && expr.getType() == HiveParser.TOK_FUNCTIONDI) {
+        throw new SemanticException(
+            SemanticAnalyzer.generateErrorMessage(expr, ErrorMsg.DISTINCT_NOT_SUPPORTED.getMsg()));
+      }
+
       // Create all children
       int childrenBegin = (isFunction ? 1 : 0);
       ArrayList<ExprNodeDesc> children = new ArrayList<ExprNodeDesc>(expr
diff --git a/ql/src/test/queries/clientnegative/invalid_distinct1.q b/ql/src/test/queries/clientnegative/invalid_distinct1.q
new file mode 100644
index 0000000000..538ef8164f
--- /dev/null
+++ b/ql/src/test/queries/clientnegative/invalid_distinct1.q
@@ -0,0 +1 @@
+explain select hash(distinct value) from src;
diff --git a/ql/src/test/queries/clientnegative/invalid_distinct2.q b/ql/src/test/queries/clientnegative/invalid_distinct2.q
new file mode 100644
index 0000000000..b01218eb00
--- /dev/null
+++ b/ql/src/test/queries/clientnegative/invalid_distinct2.q
@@ -0,0 +1 @@
+explain select explode(distinct value) from src;
diff --git a/ql/src/test/queries/clientnegative/invalid_distinct3.q b/ql/src/test/queries/clientnegative/invalid_distinct3.q
new file mode 100644
index 0000000000..ec8026b130
--- /dev/null
+++ b/ql/src/test/queries/clientnegative/invalid_distinct3.q
@@ -0,0 +1 @@
+explain select hash(upper(distinct value)) from src;
diff --git a/ql/src/test/results/clientnegative/invalid_distinct1.q.out b/ql/src/test/results/clientnegative/invalid_distinct1.q.out
new file mode 100644
index 0000000000..c1c95a97c5
--- /dev/null
+++ b/ql/src/test/results/clientnegative/invalid_distinct1.q.out
@@ -0,0 +1 @@
+FAILED: SemanticException 1:15 Distinct keyword is not support in current context. Error encountered near token 'value'
diff --git a/ql/src/test/results/clientnegative/invalid_distinct2.q.out b/ql/src/test/results/clientnegative/invalid_distinct2.q.out
new file mode 100644
index 0000000000..c1c95a97c5
--- /dev/null
+++ b/ql/src/test/results/clientnegative/invalid_distinct2.q.out
@@ -0,0 +1 @@
+FAILED: SemanticException 1:15 Distinct keyword is not support in current context. Error encountered near token 'value'
diff --git a/ql/src/test/results/clientnegative/invalid_distinct3.q.out b/ql/src/test/results/clientnegative/invalid_distinct3.q.out
new file mode 100644
index 0000000000..e478860e2a
--- /dev/null
+++ b/ql/src/test/results/clientnegative/invalid_distinct3.q.out
@@ -0,0 +1 @@
+FAILED: SemanticException 1:20 Distinct keyword is not support in current context. Error encountered near token 'value'
