diff --git a/ql/src/java/org/apache/hadoop/hive/ql/hooks/ATSHook.java b/ql/src/java/org/apache/hadoop/hive/ql/hooks/ATSHook.java
index 9cb4d8c4b7..0632f6ee2c 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/hooks/ATSHook.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/hooks/ATSHook.java
@@ -68,6 +68,7 @@
 public class ATSHook implements ExecuteWithHookContext {
 
   private static final Logger LOG = LoggerFactory.getLogger(ATSHook.class.getName());
+  private boolean isATSEnabled = false;
   private static final Object LOCK = new Object();
   private static final int VERSION = 2;
   private static ExecutorService executor;
@@ -143,7 +144,15 @@ public void run() {
   }
 
   public ATSHook() {
-    LOG.info("Created ATS Hook");
+    YarnConfiguration yarnConf = new YarnConfiguration();
+    if (yarnConf.getBoolean(YarnConfiguration.TIMELINE_SERVICE_ENABLED,
+            YarnConfiguration.DEFAULT_TIMELINE_SERVICE_ENABLED)) {
+      isATSEnabled = true;
+      LOG.info("Created ATS Hook");
+    } else {
+      isATSEnabled = false;
+      LOG.warn("ATSHook is disabled due to Timeline Service being disabled");
+    }
   }
 
   private void createTimelineDomain(String domainId, String readers, String writers) throws Exception {
@@ -219,6 +228,9 @@ public void run() {
   }
   @Override
   public void run(final HookContext hookContext) throws Exception {
+    if (!isATSEnabled) {
+      return;
+    }
     final long currentTime = System.currentTimeMillis();
 
     final HiveConf conf = new HiveConf(hookContext.getConf());
