diff --git a/common/src/java/org/apache/hadoop/hive/common/type/Decimal128.java b/common/src/java/org/apache/hadoop/hive/common/type/Decimal128.java
index bd3e99777f..d4cc32dd0d 100644
--- a/common/src/java/org/apache/hadoop/hive/common/type/Decimal128.java
+++ b/common/src/java/org/apache/hadoop/hive/common/type/Decimal128.java
@@ -102,13 +102,6 @@ public final class Decimal128 extends Number implements Comparable<Decimal128> {
    */
   private short scale;
 
-  /**
-   * This is the actual scale detected from the value passed to this Decimal128.
-   * The value is always equals or less than #scale. It is used to return the correct
-   * decimal string from {@link #getHiveDecimalString()}.
-   */
-  private short actualScale;
-
   /**
    * -1 means negative, 0 means zero, 1 means positive.
    *
@@ -134,7 +127,6 @@ public Decimal128() {
     this.unscaledValue = new UnsignedInt128();
     this.scale = 0;
     this.signum = 0;
-    this.actualScale = 0;
   }
 
   /**
@@ -147,7 +139,6 @@ public Decimal128(Decimal128 o) {
     this.unscaledValue = new UnsignedInt128(o.unscaledValue);
     this.scale = o.scale;
     this.signum = o.signum;
-    this.actualScale = o.actualScale;
   }
 
   /**
@@ -187,7 +178,6 @@ public Decimal128(UnsignedInt128 unscaledVal, short scale, boolean negative) {
     checkScaleRange(scale);
     this.unscaledValue = new UnsignedInt128(unscaledVal);
     this.scale = scale;
-    this.actualScale = scale;
     if (unscaledValue.isZero()) {
       this.signum = 0;
     } else {
@@ -274,7 +264,6 @@ public Decimal128 update(Decimal128 o) {
     this.unscaledValue.update(o.unscaledValue);
     this.scale = o.scale;
     this.signum = o.signum;
-    this.actualScale = o.actualScale;
     return this;
   }
 
@@ -303,7 +292,7 @@ public Decimal128 update(long val) {
 
   /**
    * Update the value of this object with the given {@code long} with the given
-   * scale.
+   * scal.
    *
    * @param val
    *          {@code long} value to be set to {@code Decimal128}.
@@ -325,8 +314,6 @@ public Decimal128 update(long val, short scale) {
     if (scale != 0) {
       changeScaleDestructive(scale);
     }
-    // set actualScale to 0 because there is no fractional digits on integer values
-    this.actualScale = 0;
     return this;
   }
 
@@ -354,11 +341,6 @@ public Decimal128 update(double val, short scale) {
     checkScaleRange(scale);
     this.scale = scale;
 
-    // Obtains the scale of the double value to keep a record of the original
-    // scale. This will be used to print the HiveDecimal string with the
-    // correct value scale.
-    this.actualScale = (short) BigDecimal.valueOf(val).scale();
-
     // Translate the double into sign, exponent and significand, according
     // to the formulae in JLS, Section 20.10.22.
     long valBits = Double.doubleToLongBits(val);
@@ -382,10 +364,6 @@ public Decimal128 update(double val, short scale) {
       exponent++;
     }
 
-    // Calculate the real number of fractional digits from the double value
-    this.actualScale -= (exponent > 0) ? exponent : 0;
-    this.actualScale = (this.actualScale < 0) ? 0 : this.actualScale;
-
     // so far same as java.math.BigDecimal, but the scaling below is
     // specific to ANSI SQL Numeric.
 
@@ -448,7 +426,6 @@ public Decimal128 update(double val, short scale) {
   public Decimal128 update(IntBuffer buf, int precision) {
     int scaleAndSignum = buf.get();
     this.scale = (short) (scaleAndSignum >> 16);
-    this.actualScale = this.scale;
     this.signum = (byte) (scaleAndSignum & 0xFF);
     this.unscaledValue.update(buf, precision);
     assert ((signum == 0) == unscaledValue.isZero());
@@ -465,7 +442,6 @@ public Decimal128 update(IntBuffer buf, int precision) {
   public Decimal128 update128(IntBuffer buf) {
     int scaleAndSignum = buf.get();
     this.scale = (short) (scaleAndSignum >> 16);
-    this.actualScale = this.scale;
     this.signum = (byte) (scaleAndSignum & 0xFF);
     this.unscaledValue.update128(buf);
     assert ((signum == 0) == unscaledValue.isZero());
@@ -482,7 +458,6 @@ public Decimal128 update128(IntBuffer buf) {
   public Decimal128 update96(IntBuffer buf) {
     int scaleAndSignum = buf.get();
     this.scale = (short) (scaleAndSignum >> 16);
-    this.actualScale = this.scale;
     this.signum = (byte) (scaleAndSignum & 0xFF);
     this.unscaledValue.update96(buf);
     assert ((signum == 0) == unscaledValue.isZero());
@@ -499,7 +474,6 @@ public Decimal128 update96(IntBuffer buf) {
   public Decimal128 update64(IntBuffer buf) {
     int scaleAndSignum = buf.get();
     this.scale = (short) (scaleAndSignum >> 16);
-    this.actualScale = this.scale;
     this.signum = (byte) (scaleAndSignum & 0xFF);
     this.unscaledValue.update64(buf);
     assert ((signum == 0) == unscaledValue.isZero());
@@ -516,7 +490,6 @@ public Decimal128 update64(IntBuffer buf) {
   public Decimal128 update32(IntBuffer buf) {
     int scaleAndSignum = buf.get();
     this.scale = (short) (scaleAndSignum >> 16);
-    this.actualScale = this.scale;
     this.signum = (byte) (scaleAndSignum & 0xFF);
     this.unscaledValue.update32(buf);
     assert ((signum == 0) == unscaledValue.isZero());
@@ -537,7 +510,6 @@ public Decimal128 update32(IntBuffer buf) {
   public Decimal128 update(int[] array, int offset, int precision) {
     int scaleAndSignum = array[offset];
     this.scale = (short) (scaleAndSignum >> 16);
-    this.actualScale = this.scale;
     this.signum = (byte) (scaleAndSignum & 0xFF);
     this.unscaledValue.update(array, offset + 1, precision);
     return this;
@@ -555,7 +527,6 @@ public Decimal128 update(int[] array, int offset, int precision) {
   public Decimal128 update128(int[] array, int offset) {
     int scaleAndSignum = array[offset];
     this.scale = (short) (scaleAndSignum >> 16);
-    this.actualScale = this.scale;
     this.signum = (byte) (scaleAndSignum & 0xFF);
     this.unscaledValue.update128(array, offset + 1);
     return this;
@@ -573,7 +544,6 @@ public Decimal128 update128(int[] array, int offset) {
   public Decimal128 update96(int[] array, int offset) {
     int scaleAndSignum = array[offset];
     this.scale = (short) (scaleAndSignum >> 16);
-    this.actualScale = this.scale;
     this.signum = (byte) (scaleAndSignum & 0xFF);
     this.unscaledValue.update96(array, offset + 1);
     return this;
@@ -591,7 +561,6 @@ public Decimal128 update96(int[] array, int offset) {
   public Decimal128 update64(int[] array, int offset) {
     int scaleAndSignum = array[offset];
     this.scale = (short) (scaleAndSignum >> 16);
-    this.actualScale = this.scale;
     this.signum = (byte) (scaleAndSignum & 0xFF);
     this.unscaledValue.update64(array, offset + 1);
     return this;
@@ -609,7 +578,6 @@ public Decimal128 update64(int[] array, int offset) {
   public Decimal128 update32(int[] array, int offset) {
     int scaleAndSignum = array[offset];
     this.scale = (short) (scaleAndSignum >> 16);
-    this.actualScale = this.scale;
     this.signum = (byte) (scaleAndSignum & 0xFF);
     this.unscaledValue.update32(array, offset + 1);
     return this;
@@ -632,6 +600,7 @@ public Decimal128 update(BigDecimal bigDecimal) {
    * @param scale
    */
   public Decimal128 update(BigInteger bigInt, short scale) {
+    this.scale = scale;
     this.signum = (byte) bigInt.compareTo(BigInteger.ZERO);
     if (signum == 0) {
       update(0);
@@ -640,9 +609,6 @@ public Decimal128 update(BigInteger bigInt, short scale) {
     } else {
       unscaledValue.update(bigInt);
     }
-    this.scale = scale;
-    this.actualScale = scale;
-
     return this;
   }
 
@@ -765,9 +731,6 @@ public Decimal128 update(char[] str, int offset, int length, short scale) {
       this.unscaledValue.addDestructive(accumulated);
     }
 
-    this.actualScale = (short) (fractionalDigits - exponent);
-    this.actualScale = (this.actualScale < 0) ? 0 : this.actualScale;
-
     int scaleAdjust = scale - fractionalDigits + exponent;
     if (scaleAdjust > 0) {
       this.unscaledValue.scaleUpTenDestructive((short) scaleAdjust);
@@ -961,7 +924,6 @@ public void changeScaleDestructive(short scale) {
       this.unscaledValue.scaleUpTenDestructive((short) -scaleDown);
     }
     this.scale = scale;
-    this.actualScale = scale;
 
     this.unscaledValue.throwIfExceedsTenToThirtyEight();
   }
@@ -1163,7 +1125,6 @@ public void multiplyDestructiveNativeDecimal128(Decimal128 right, short newScale
     if (this.signum == 0 || right.signum == 0) {
       this.zeroClear();
       this.scale = newScale;
-      this.actualScale = newScale;
       return;
     }
 
@@ -1193,7 +1154,6 @@ public void multiplyDestructiveNativeDecimal128(Decimal128 right, short newScale
     }
 
     this.scale = newScale;
-    this.actualScale = newScale;
     this.signum = (byte) (this.signum * right.signum);
     if (this.unscaledValue.isZero()) {
       this.signum = 0; // because of scaling down, this could happen
@@ -1284,7 +1244,6 @@ public void divideDestructiveNativeDecimal128(Decimal128 right, short newScale,
     }
     if (this.signum == 0) {
       this.scale = newScale;
-      this.actualScale = newScale;
       remainder.update(this);
       return;
     }
@@ -1312,7 +1271,6 @@ public void divideDestructiveNativeDecimal128(Decimal128 right, short newScale,
     }
 
     this.scale = newScale;
-    this.actualScale = newScale;
     this.signum = (byte) (this.unscaledValue.isZero() ? 0
         : (this.signum * right.signum));
     remainder.scale = scale;
@@ -1773,13 +1731,17 @@ private static void checkScaleRange(short scale) {
   private int [] tmpArray = new int[2];
 
   /**
-   * Returns the string representation of this value. It returns the original
-   * {@code actualScale} fractional part when this value was created. However,
+   * Returns the string representation of this value. It discards the trailing zeros
+   * in the fractional part to match the HiveDecimal's string representation. However,
    * don't use this string representation for the reconstruction of the object.
    *
    * @return string representation of this value
    */
   public String getHiveDecimalString() {
+    if (this.signum == 0) {
+      return "0";
+    }
+
     StringBuilder buf = new StringBuilder(50);
     if (this.signum < 0) {
       buf.append('-');
@@ -1790,40 +1752,32 @@ public String getHiveDecimalString() {
     int trailingZeros = tmpArray[1];
     int numIntegerDigits = unscaledLength - this.scale;
     if (numIntegerDigits > 0) {
+
       // write out integer part first
       // then write out fractional part
       for (int i=0; i < numIntegerDigits; i++) {
         buf.append(unscaled[i]);
       }
 
-      if (this.actualScale > 0) {
+      if (this.scale > trailingZeros) {
         buf.append('.');
-
-        if (trailingZeros > this.actualScale) {
-          for (int i=0; i < (trailingZeros - this.scale); i++) {
-            buf.append("0");
-          }
-        }
-
-        for (int i = numIntegerDigits; i < (numIntegerDigits + this.actualScale); i++) {
+        for (int i = numIntegerDigits; i < (unscaledLength - trailingZeros); i++) {
           buf.append(unscaled[i]);
         }
       }
     } else {
+
       // no integer part
       buf.append('0');
 
-      if (this.actualScale > 0) {
+      if (this.scale > trailingZeros) {
+
         // fractional part has, starting with zeros
         buf.append('.');
-
-        if (this.actualScale > trailingZeros) {
-          for (int i = unscaledLength; i < this.scale; ++i) {
-            buf.append('0');
-          }
+        for (int i = unscaledLength; i < this.scale; ++i) {
+          buf.append('0');
         }
-
-        for (int i = 0; i < (numIntegerDigits + this.actualScale); i++) {
+        for (int i = 0; i < (unscaledLength - trailingZeros); i++) {
           buf.append(unscaled[i]);
         }
       }
@@ -1882,10 +1836,9 @@ public String toFormalString() {
 
   @Override
   public String toString() {
-    return toFormalString() + "(Decimal128: scale=" + scale + ", actualScale="
-        + this.actualScale + ", signum=" + signum + ", BigDecimal.toString="
-        + toBigDecimal().toString() + ", unscaledValue=[" + unscaledValue.toString()
-        + "])";
+    return toFormalString() + "(Decimal128: scale=" + scale + ", signum="
+        + signum + ", BigDecimal.toString=" + toBigDecimal().toString()
+        + ", unscaledValue=[" + unscaledValue.toString() + "])";
   }
 
   /**
@@ -2003,7 +1956,6 @@ public Decimal128 updateVarianceDestructive(
    */
   public Decimal128 fastUpdateFromInternalStorage(byte[] internalStorage, short scale) {
     this.scale = scale;
-    this.actualScale = scale;
     this.signum = this.unscaledValue.fastUpdateFromInternalStorage(internalStorage);
 
     return this;
diff --git a/common/src/java/org/apache/hadoop/hive/common/type/HiveDecimal.java b/common/src/java/org/apache/hadoop/hive/common/type/HiveDecimal.java
index 0bb84e18d4..c2bf6d79ab 100644
--- a/common/src/java/org/apache/hadoop/hive/common/type/HiveDecimal.java
+++ b/common/src/java/org/apache/hadoop/hive/common/type/HiveDecimal.java
@@ -30,6 +30,7 @@
 public class HiveDecimal implements Comparable<HiveDecimal> {
   public static final int MAX_PRECISION = 38;
   public static final int MAX_SCALE = 38;
+
   /**
    * Default precision/scale when user doesn't specify in the column metadata, such as
    * decimal and decimal(8).
@@ -112,7 +113,7 @@ public int compareTo(HiveDecimal dec) {
 
   @Override
   public int hashCode() {
-    return trim(bd).hashCode();
+    return bd.hashCode();
   }
 
   @Override
@@ -168,7 +169,7 @@ public HiveDecimal subtract(HiveDecimal dec) {
   }
 
   public HiveDecimal multiply(HiveDecimal dec) {
-    return create(bd.multiply(dec.bd), true);
+    return create(bd.multiply(dec.bd), false);
   }
 
   public BigInteger unscaledValue() {
@@ -201,7 +202,7 @@ public HiveDecimal remainder(HiveDecimal dec) {
   }
 
   public HiveDecimal divide(HiveDecimal dec) {
-    return create(trim(bd.divide(dec.bd, MAX_SCALE, RoundingMode.HALF_UP)), true);
+    return create(bd.divide(dec.bd, MAX_SCALE, RoundingMode.HALF_UP), true);
   }
 
   /**
@@ -231,6 +232,8 @@ private static BigDecimal normalize(BigDecimal bd, boolean allowRounding) {
       return null;
     }
 
+    bd = trim(bd);
+
     int intDigits = bd.precision() - bd.scale();
 
     if (intDigits > MAX_PRECISION) {
@@ -241,6 +244,8 @@ private static BigDecimal normalize(BigDecimal bd, boolean allowRounding) {
     if (bd.scale() > maxScale ) {
       if (allowRounding) {
         bd = bd.setScale(maxScale, RoundingMode.HALF_UP);
+        // Trimming is again necessary, because rounding may introduce new trailing 0's.
+        bd = trim(bd);
       } else {
         bd = null;
       }
@@ -254,6 +259,8 @@ public static BigDecimal enforcePrecisionScale(BigDecimal bd, int maxPrecision,
       return null;
     }
 
+    bd = trim(bd);
+
     if (bd.scale() > maxScale) {
       bd = bd.setScale(maxScale, RoundingMode.HALF_UP);
     }
diff --git a/common/src/test/org/apache/hadoop/hive/common/type/TestDecimal128.java b/common/src/test/org/apache/hadoop/hive/common/type/TestDecimal128.java
index 0786ccacce..46236a5200 100644
--- a/common/src/test/org/apache/hadoop/hive/common/type/TestDecimal128.java
+++ b/common/src/test/org/apache/hadoop/hive/common/type/TestDecimal128.java
@@ -811,7 +811,7 @@ public void testToHiveDecimalString() {
     assertEquals("0.00923076923", d2.getHiveDecimalString());
 
     Decimal128 d3 = new Decimal128("0.00923076000", (short) 15);
-    assertEquals("0.00923076000", d3.getHiveDecimalString());
+    assertEquals("0.00923076", d3.getHiveDecimalString());
 
     Decimal128 d4 = new Decimal128("4294967296.01", (short) 15);
     assertEquals("4294967296.01", d4.getHiveDecimalString());
@@ -849,37 +849,15 @@ public void testToHiveDecimalString() {
     d11.update(hd6.bigDecimalValue());
     assertEquals(hd6.toString(), d11.getHiveDecimalString());
 
-    // The trailing zeros from a double value are trimmed automatically
-    // by the double data type
     Decimal128 d12 = new Decimal128(27.000, (short)3);
-    HiveDecimal hd7 = HiveDecimal.create(new BigDecimal("27.0"));
+    HiveDecimal hd7 = HiveDecimal.create(new BigDecimal("27.000"));
     assertEquals(hd7.toString(), d12.getHiveDecimalString());
-    assertEquals("27.0", d12.getHiveDecimalString());
+    assertEquals("27", d12.getHiveDecimalString());
 
     Decimal128 d13 = new Decimal128(1234123000, (short)3);
     HiveDecimal hd8 = HiveDecimal.create(new BigDecimal("1234123000"));
     assertEquals(hd8.toString(), d13.getHiveDecimalString());
     assertEquals("1234123000", d13.getHiveDecimalString());
-
-    Decimal128 d14 = new Decimal128(1.33e4, (short)10);
-    HiveDecimal hd9 = HiveDecimal.create(new BigDecimal("1.33e4"));
-    assertEquals(hd9.toString(), d14.getHiveDecimalString());
-    assertEquals("13300", d14.getHiveDecimalString());
-
-    Decimal128 d15 = new Decimal128(1.33e-4, (short)10);
-    HiveDecimal hd10 = HiveDecimal.create(new BigDecimal("1.33e-4"));
-    assertEquals(hd10.toString(), d15.getHiveDecimalString());
-    assertEquals("0.000133", d15.getHiveDecimalString());
-
-    Decimal128 d16 = new Decimal128("1.33e4", (short)10);
-    HiveDecimal hd11 = HiveDecimal.create(new BigDecimal("1.33e4"));
-    assertEquals(hd11.toString(), d16.getHiveDecimalString());
-    assertEquals("13300", d16.getHiveDecimalString());
-
-    Decimal128 d17 = new Decimal128("1.33e-4", (short)10);
-    HiveDecimal hd12 = HiveDecimal.create(new BigDecimal("1.33e-4"));
-    assertEquals(hd12.toString(), d17.getHiveDecimalString());
-    assertEquals("0.000133", d17.getHiveDecimalString());
   }
 
   @Test
diff --git a/common/src/test/org/apache/hadoop/hive/common/type/TestHiveDecimal.java b/common/src/test/org/apache/hadoop/hive/common/type/TestHiveDecimal.java
index 959989a143..ba5ef71d29 100644
--- a/common/src/test/org/apache/hadoop/hive/common/type/TestHiveDecimal.java
+++ b/common/src/test/org/apache/hadoop/hive/common/type/TestHiveDecimal.java
@@ -57,35 +57,27 @@ public void testPrecisionScaleEnforcement() {
     Assert.assertEquals("-1786135888657847525803324040144343378.1", dec.toString());
 
     dec = HiveDecimal.create("005.34000");
-    Assert.assertEquals(dec.precision(), 6);
-    Assert.assertEquals(dec.scale(), 5);
+    Assert.assertEquals(dec.precision(), 3);
+    Assert.assertEquals(dec.scale(), 2);
 
     dec = HiveDecimal.create("178613588865784752580332404014434337809799306448796128931113691624");
     Assert.assertNull(dec);
 
-    // Leaving trailing zeros
-    Assert.assertEquals("0.0", HiveDecimal.enforcePrecisionScale(new BigDecimal("0.0"), 2, 1).toString());
-    Assert.assertEquals("0.00", HiveDecimal.enforcePrecisionScale(new BigDecimal("0.00"), 3, 2).toString());
-    Assert.assertEquals("0.0000", HiveDecimal.enforcePrecisionScale(new BigDecimal("0.0000"), 10, 4).toString());
-    Assert.assertEquals("100.00000", HiveDecimal.enforcePrecisionScale(new BigDecimal("100.00000"), 15, 5).toString());
-    Assert.assertEquals("100.00", HiveDecimal.enforcePrecisionScale(new BigDecimal("100.00"), 15, 5).toString());
-
-    // Rounding numbers
-    Assert.assertEquals("0.01", HiveDecimal.enforcePrecisionScale(new BigDecimal("0.012"), 3, 2).toString());
-    Assert.assertEquals("0.02", HiveDecimal.enforcePrecisionScale(new BigDecimal("0.015"), 3, 2).toString());
-    Assert.assertEquals("0.01", HiveDecimal.enforcePrecisionScale(new BigDecimal("0.0145"), 3, 2).toString());
-
     // Rounding numbers that increase int digits
     Assert.assertEquals("10",
         HiveDecimal.enforcePrecisionScale(new BigDecimal("9.5"), 2, 0).toString());
     Assert.assertNull(HiveDecimal.enforcePrecisionScale(new BigDecimal("9.5"), 1, 0));
     Assert.assertEquals("9",
         HiveDecimal.enforcePrecisionScale(new BigDecimal("9.4"), 1, 0).toString());
+  }
 
-    // Integers with no scale values are not modified (zeros are not null)
-    Assert.assertEquals("0", HiveDecimal.enforcePrecisionScale(new BigDecimal("0"), 1, 0).toString());
-    Assert.assertEquals("30", HiveDecimal.enforcePrecisionScale(new BigDecimal("30"), 2, 0).toString());
-    Assert.assertEquals("5", HiveDecimal.enforcePrecisionScale(new BigDecimal("5"), 3, 2).toString());
+  @Test
+  @Concurrent(count=4)
+  @Repeating(repetition=100)
+  public void testTrailingZeroRemovalAfterEnforcement() {
+    String decStr = "8.090000000000000000000000000000000000000123456";
+    HiveDecimal dec = HiveDecimal.create(decStr);
+    Assert.assertEquals("8.09", dec.toString());
   }
 
   @Test
@@ -94,7 +86,7 @@ public void testPrecisionScaleEnforcement() {
   public void testMultiply() {
     HiveDecimal dec1 = HiveDecimal.create("0.00001786135888657847525803");
     HiveDecimal dec2 = HiveDecimal.create("3.0000123456789");
-    Assert.assertNotNull(dec1.multiply(dec2));
+    Assert.assertNull(dec1.multiply(dec2));
 
     dec1 = HiveDecimal.create("178613588865784752580323232232323444.4");
     dec2 = HiveDecimal.create("178613588865784752580302323232.3");
@@ -106,11 +98,11 @@ public void testMultiply() {
 
     dec1 = HiveDecimal.create("3.140");
     dec2 = HiveDecimal.create("1.00");
-    Assert.assertEquals("3.14000", dec1.multiply(dec2).toString());
+    Assert.assertEquals("3.14", dec1.multiply(dec2).toString());
 
     dec1 = HiveDecimal.create("43.010");
     dec2 = HiveDecimal.create("2");
-    Assert.assertEquals("86.020", dec1.multiply(dec2).toString());
+    Assert.assertEquals("86.02", dec1.multiply(dec2).toString());
   }
 
   @Test
@@ -125,7 +117,7 @@ public void testPow() {
     Assert.assertNull(dec1);
 
     dec1 = HiveDecimal.create("3.140");
-    Assert.assertEquals("9.859600", dec1.pow(2).toString());
+    Assert.assertEquals("9.8596", dec1.pow(2).toString());
   }
 
   @Test
@@ -155,7 +147,7 @@ public void testPlus() {
 
     dec1 = HiveDecimal.create("3.140");
     dec2 = HiveDecimal.create("1.00");
-    Assert.assertEquals("4.140", dec1.add(dec2).toString());
+    Assert.assertEquals("4.14", dec1.add(dec2).toString());
   }
 
 
@@ -165,7 +157,7 @@ public void testPlus() {
   public void testSubtract() {
       HiveDecimal dec1 = HiveDecimal.create("3.140");
       HiveDecimal dec2 = HiveDecimal.create("1.00");
-      Assert.assertEquals("2.140", dec1.subtract(dec2).toString());
+      Assert.assertEquals("2.14", dec1.subtract(dec2).toString());
   }
 
   @Test
diff --git a/ql/src/test/org/apache/hadoop/hive/ql/exec/vector/expressions/TestDecimalUtil.java b/ql/src/test/org/apache/hadoop/hive/ql/exec/vector/expressions/TestDecimalUtil.java
index e0ca6fbcc2..da9ebca154 100644
--- a/ql/src/test/org/apache/hadoop/hive/ql/exec/vector/expressions/TestDecimalUtil.java
+++ b/ql/src/test/org/apache/hadoop/hive/ql/exec/vector/expressions/TestDecimalUtil.java
@@ -38,8 +38,9 @@ public void testFloor() {
     DecimalUtil.floor(0, d1, dcv);
     Assert.assertEquals(0, expected1.compareTo(dcv.vector[0].getHiveDecimal()));
 
+    // As of HIVE-8745, these decimal values should be trimmed of trailing zeros.
     HiveDecimal d2 = HiveDecimal.create("23.00000");
-    Assert.assertEquals(5, d2.scale());
+    Assert.assertEquals(0, d2.scale());
     HiveDecimal expected2 = HiveDecimal.create("23");
     DecimalUtil.floor(0, d2, dcv);
     Assert.assertEquals(0, expected2.compareTo(dcv.vector[0].getHiveDecimal()));
@@ -50,19 +51,19 @@ public void testFloor() {
     Assert.assertEquals(0, expected3.compareTo(dcv.vector[0].getHiveDecimal()));
 
     HiveDecimal d4 = HiveDecimal.create("-17.00000");
-    Assert.assertEquals(5, d4.scale());
+    Assert.assertEquals(0, d4.scale());
     HiveDecimal expected4 = HiveDecimal.create("-17");
     DecimalUtil.floor(0, d4, dcv);
     Assert.assertEquals(0, expected4.compareTo(dcv.vector[0].getHiveDecimal()));
 
     HiveDecimal d5 = HiveDecimal.create("-0.30000");
-    Assert.assertEquals(5, d5.scale());
+    Assert.assertEquals(1, d5.scale());
     HiveDecimal expected5 = HiveDecimal.create("-1");
     DecimalUtil.floor(0, d5, dcv);
     Assert.assertEquals(0, expected5.compareTo(dcv.vector[0].getHiveDecimal()));
 
     HiveDecimal d6 = HiveDecimal.create("0.30000");
-    Assert.assertEquals(5, d6.scale());
+    Assert.assertEquals(1, d6.scale());
     HiveDecimal expected6 = HiveDecimal.create("0");
     DecimalUtil.floor(0, d6, dcv);
     Assert.assertEquals(0, expected6.compareTo(dcv.vector[0].getHiveDecimal()));
@@ -76,8 +77,9 @@ public void testCeiling() {
     DecimalUtil.ceiling(0, d1, dcv);
     Assert.assertEquals(0, expected1.compareTo(dcv.vector[0].getHiveDecimal()));
 
+    // As of HIVE-8745, these decimal values should be trimmed of trailing zeros.
     HiveDecimal d2 = HiveDecimal.create("23.00000");
-    Assert.assertEquals(5, d2.scale());
+    Assert.assertEquals(0, d2.scale());
     HiveDecimal expected2 = HiveDecimal.create("23");
     DecimalUtil.ceiling(0, d2, dcv);
     Assert.assertEquals(0, expected2.compareTo(dcv.vector[0].getHiveDecimal()));
@@ -88,19 +90,19 @@ public void testCeiling() {
     Assert.assertEquals(0, expected3.compareTo(dcv.vector[0].getHiveDecimal()));
 
     HiveDecimal d4 = HiveDecimal.create("-17.00000");
-    Assert.assertEquals(5, d4.scale());
+    Assert.assertEquals(0, d4.scale());
     HiveDecimal expected4 = HiveDecimal.create("-17");
     DecimalUtil.ceiling(0, d4, dcv);
     Assert.assertEquals(0, expected4.compareTo(dcv.vector[0].getHiveDecimal()));
 
     HiveDecimal d5 = HiveDecimal.create("-0.30000");
-    Assert.assertEquals(5, d5.scale());
+    Assert.assertEquals(1, d5.scale());
     HiveDecimal expected5 = HiveDecimal.create("0");
     DecimalUtil.ceiling(0, d5, dcv);
     Assert.assertEquals(0, expected5.compareTo(dcv.vector[0].getHiveDecimal()));
 
     HiveDecimal d6 = HiveDecimal.create("0.30000");
-    Assert.assertEquals(5, d6.scale());
+    Assert.assertEquals(1, d6.scale());
     HiveDecimal expected6 = HiveDecimal.create("1");
     DecimalUtil.ceiling(0, d6, dcv);
     Assert.assertEquals(0, expected6.compareTo(dcv.vector[0].getHiveDecimal()));
@@ -127,8 +129,9 @@ public void testRound() {
     DecimalUtil.round(0, d1, dcv);
     Assert.assertEquals(0, expected1.compareTo(dcv.vector[0].getHiveDecimal()));
 
+    // As of HIVE-8745, these decimal values should be trimmed of trailing zeros.
     HiveDecimal d2 = HiveDecimal.create("23.00000");
-    Assert.assertEquals(5, d2.scale());
+    Assert.assertEquals(0, d2.scale());
     HiveDecimal expected2 = HiveDecimal.create("23");
     DecimalUtil.round(0, d2, dcv);
     Assert.assertEquals(0, expected2.compareTo(dcv.vector[0].getHiveDecimal()));
@@ -139,7 +142,7 @@ public void testRound() {
     Assert.assertEquals(0, expected3.compareTo(dcv.vector[0].getHiveDecimal()));
 
     HiveDecimal d4 = HiveDecimal.create("-17.00000");
-    Assert.assertEquals(5, d4.scale());
+    Assert.assertEquals(0, d4.scale());
     HiveDecimal expected4 = HiveDecimal.create("-17");
     DecimalUtil.round(0, d4, dcv);
     Assert.assertEquals(0, expected4.compareTo(dcv.vector[0].getHiveDecimal()));
@@ -163,8 +166,9 @@ public void testRoundWithDigits() {
     DecimalUtil.round(0, d1, dcv);
     Assert.assertEquals(0, expected1.compareTo(dcv.vector[0].getHiveDecimal()));
 
+    // As of HIVE-8745, these decimal values should be trimmed of trailing zeros.
     HiveDecimal d2 = HiveDecimal.create("23.56700");
-    Assert.assertEquals(5, d2.scale());
+    Assert.assertEquals(3, d2.scale());
     HiveDecimal expected2 = HiveDecimal.create("23.567");
     DecimalUtil.round(0, d2, dcv);
     Assert.assertEquals(0, expected2.compareTo(dcv.vector[0].getHiveDecimal()));
@@ -175,7 +179,7 @@ public void testRoundWithDigits() {
     Assert.assertEquals(0, expected3.compareTo(dcv.vector[0].getHiveDecimal()));
 
     HiveDecimal d4 = HiveDecimal.create("-17.23400");
-    Assert.assertEquals(5, d4.scale());
+    Assert.assertEquals(3, d4.scale());
     HiveDecimal expected4 = HiveDecimal.create("-17.234");
     DecimalUtil.round(0, d4, dcv);
     Assert.assertEquals(0, expected4.compareTo(dcv.vector[0].getHiveDecimal()));
@@ -204,8 +208,9 @@ public void testNegate() {
     DecimalUtil.negate(0, d2, dcv);
     Assert.assertEquals(0, expected2.compareTo(dcv.vector[0].getHiveDecimal()));
 
+    // As of HIVE-8745, these decimal values should be trimmed of trailing zeros.
     HiveDecimal d3 = HiveDecimal.create("0.00000");
-    Assert.assertEquals(5, d3.scale());
+    Assert.assertEquals(0, d3.scale());
     HiveDecimal expected3 = HiveDecimal.create("0");
     DecimalUtil.negate(0, d3, dcv);
     Assert.assertEquals(0, expected3.compareTo(dcv.vector[0].getHiveDecimal()));
@@ -223,7 +228,7 @@ public void testSign() {
     Assert.assertEquals(-1, lcv.vector[0]);
 
     HiveDecimal d3 = HiveDecimal.create("0.00000");
-    Assert.assertEquals(5, d3.scale());
+    Assert.assertEquals(0, d3.scale());
     d3.setScale(5);
     DecimalUtil.sign(0, d3, lcv);
     Assert.assertEquals(0, lcv.vector[0]);
diff --git a/ql/src/test/org/apache/hadoop/hive/ql/exec/vector/expressions/TestVectorTypeCasts.java b/ql/src/test/org/apache/hadoop/hive/ql/exec/vector/expressions/TestVectorTypeCasts.java
index 0802e3ba66..c867a3cfb1 100644
--- a/ql/src/test/org/apache/hadoop/hive/ql/exec/vector/expressions/TestVectorTypeCasts.java
+++ b/ql/src/test/org/apache/hadoop/hive/ql/exec/vector/expressions/TestVectorTypeCasts.java
@@ -323,18 +323,19 @@ public void testCastDecimalToString() {
     expr.evaluate(b);
     BytesColumnVector r = (BytesColumnVector) b.cols[1];
 
-    byte[] v = toBytes("1.10");
+    // As of HIVE-8745, these decimal values should be trimmed of trailing zeros.
+    byte[] v = toBytes("1.1");
     assertTrue(((Integer) v.length).toString() + " " + r.length[0], v.length == r.length[0]);
     Assert.assertEquals(0,
         StringExpr.compare(v, 0, v.length,
             r.vector[0], r.start[0], r.length[0]));
 
-    v = toBytes("-2.20");
+    v = toBytes("-2.2");
     Assert.assertEquals(0,
         StringExpr.compare(v, 0, v.length,
             r.vector[1], r.start[1], r.length[1]));
 
-    v = toBytes("9999999999999999.00");
+    v = toBytes("9999999999999999");
     Assert.assertEquals(0,
         StringExpr.compare(v, 0, v.length,
             r.vector[2], r.start[2], r.length[2]));
diff --git a/ql/src/test/org/apache/hadoop/hive/ql/io/sarg/TestSearchArgumentImpl.java b/ql/src/test/org/apache/hadoop/hive/ql/io/sarg/TestSearchArgumentImpl.java
index 831ef8c8ec..c91644c962 100644
--- a/ql/src/test/org/apache/hadoop/hive/ql/io/sarg/TestSearchArgumentImpl.java
+++ b/ql/src/test/org/apache/hadoop/hive/ql/io/sarg/TestSearchArgumentImpl.java
@@ -2830,7 +2830,7 @@ public void testBuilderComplexTypes() throws Exception {
             .build();
     assertEquals("leaf-0 = (LESS_THAN x 1970-01-11)\n" +
         "leaf-1 = (LESS_THAN_EQUALS y hi)\n" +
-        "leaf-2 = (EQUALS z 1.0)\n" +
+        "leaf-2 = (EQUALS z 1)\n" +
         "expr = (and leaf-0 leaf-1 leaf-2)", sarg.toString());
 
     sarg = SearchArgumentFactory.newBuilder()
diff --git a/ql/src/test/org/apache/hadoop/hive/ql/udf/generic/TestGenericUDFOPDivide.java b/ql/src/test/org/apache/hadoop/hive/ql/udf/generic/TestGenericUDFOPDivide.java
index ce578a0934..4c5b3a5740 100644
--- a/ql/src/test/org/apache/hadoop/hive/ql/udf/generic/TestGenericUDFOPDivide.java
+++ b/ql/src/test/org/apache/hadoop/hive/ql/udf/generic/TestGenericUDFOPDivide.java
@@ -187,7 +187,7 @@ public void testDecimalDivideDecimal() throws HiveException {
     PrimitiveObjectInspector oi = (PrimitiveObjectInspector) udf.initialize(inputOIs);
     Assert.assertEquals(TypeInfoFactory.getDecimalTypeInfo(11, 7), oi.getTypeInfo());
     HiveDecimalWritable res = (HiveDecimalWritable) udf.evaluate(args);
-    Assert.assertEquals(HiveDecimal.create("0.0617100"), res.getHiveDecimal());
+    Assert.assertEquals(HiveDecimal.create("0.06171"), res.getHiveDecimal());
   }
 
   @Test
diff --git a/ql/src/test/queries/clientpositive/decimal_join2.q b/ql/src/test/queries/clientpositive/decimal_join2.q
new file mode 100644
index 0000000000..fb45367646
--- /dev/null
+++ b/ql/src/test/queries/clientpositive/decimal_join2.q
@@ -0,0 +1,26 @@
+DROP TABLE IF EXISTS DECIMAL_3_txt;
+DROP TABLE IF EXISTS DECIMAL_3;
+
+CREATE TABLE DECIMAL_3_txt(key decimal(38,18), value int)
+ROW FORMAT DELIMITED
+   FIELDS TERMINATED BY ' '
+STORED AS TEXTFILE;
+
+LOAD DATA LOCAL INPATH '../../data/files/kv7.txt' INTO TABLE DECIMAL_3_txt;
+
+CREATE TABLE DECIMAL_3 STORED AS ORC AS SELECT * FROM DECIMAL_3_txt;
+
+set hive.auto.convert.join=false;
+EXPLAIN
+SELECT * FROM DECIMAL_3 a JOIN DECIMAL_3 b ON (a.key = b.key) ORDER BY a.key, a.value, b.key, b.value;
+
+SELECT * FROM DECIMAL_3 a JOIN DECIMAL_3 b ON (a.key = b.key) ORDER BY a.key, a.value, b.key, b.value;
+
+set hive.auto.convert.join=true;
+EXPLAIN
+SELECT * FROM DECIMAL_3 a JOIN DECIMAL_3 b ON (a.key = b.key) ORDER BY a.key, a.value, b.key, b.value;
+
+SELECT * FROM DECIMAL_3 a JOIN DECIMAL_3 b ON (a.key = b.key) ORDER BY a.key, a.value, b.key, b.value;
+
+DROP TABLE DECIMAL_3_txt;
+DROP TABLE DECIMAL_3;
diff --git a/ql/src/test/results/clientpositive/alter_partition_change_col.q.out b/ql/src/test/results/clientpositive/alter_partition_change_col.q.out
index 148bff47dc..0d97b7ac43 100644
--- a/ql/src/test/results/clientpositive/alter_partition_change_col.q.out
+++ b/ql/src/test/results/clientpositive/alter_partition_change_col.q.out
@@ -280,7 +280,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alter_partition_change_col1
 POSTHOOK: Input: default@alter_partition_change_col1@p1=abc/p2=123
 #### A masked pattern was here ####
-Beck	0.0	abc	123
+Beck	0	abc	123
 Beck	77.341	abc	123
 Beck	79.9	abc	123
 Cluck	5.96	abc	123
@@ -288,7 +288,7 @@ Mary	33.33	abc	123
 Mary	4.329	abc	123
 Snow	55.71	abc	123
 Tom	-12.25	abc	123
-Tom	19.00	abc	123
+Tom	19	abc	123
 Tom	234.79	abc	123
 PREHOOK: query: select * from alter_partition_change_col1 where p1='__HIVE_DEFAULT_PARTITION__'
 PREHOOK: type: QUERY
@@ -347,7 +347,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alter_partition_change_col1
 POSTHOOK: Input: default@alter_partition_change_col1@p1=abc/p2=123
 #### A masked pattern was here ####
-Beck	0.0	abc	123
+Beck	0	abc	123
 Beck	77.341	abc	123
 Beck	79.9	abc	123
 Cluck	5.96	abc	123
@@ -355,7 +355,7 @@ Mary	33.33	abc	123
 Mary	4.329	abc	123
 Snow	55.71	abc	123
 Tom	-12.25	abc	123
-Tom	19.00	abc	123
+Tom	19	abc	123
 Tom	234.79	abc	123
 PREHOOK: query: select * from alter_partition_change_col1 where p1='__HIVE_DEFAULT_PARTITION__'
 PREHOOK: type: QUERY
@@ -367,7 +367,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alter_partition_change_col1
 POSTHOOK: Input: default@alter_partition_change_col1@p1=__HIVE_DEFAULT_PARTITION__/p2=123
 #### A masked pattern was here ####
-Beck	0.0	__HIVE_DEFAULT_PARTITION__	123
+Beck	0	__HIVE_DEFAULT_PARTITION__	123
 Beck	77.341	__HIVE_DEFAULT_PARTITION__	123
 Beck	79.9	__HIVE_DEFAULT_PARTITION__	123
 Cluck	5.96	__HIVE_DEFAULT_PARTITION__	123
@@ -375,7 +375,7 @@ Mary	33.33	__HIVE_DEFAULT_PARTITION__	123
 Mary	4.329	__HIVE_DEFAULT_PARTITION__	123
 Snow	55.71	__HIVE_DEFAULT_PARTITION__	123
 Tom	-12.25	__HIVE_DEFAULT_PARTITION__	123
-Tom	19.00	__HIVE_DEFAULT_PARTITION__	123
+Tom	19	__HIVE_DEFAULT_PARTITION__	123
 Tom	234.79	__HIVE_DEFAULT_PARTITION__	123
 PREHOOK: query: -- Try out replace columns
 alter table alter_partition_change_col1 partition (p1='abc', p2='123') replace columns (c1 string)
@@ -449,7 +449,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alter_partition_change_col1
 POSTHOOK: Input: default@alter_partition_change_col1@p1=__HIVE_DEFAULT_PARTITION__/p2=123
 #### A masked pattern was here ####
-Beck	0.0	__HIVE_DEFAULT_PARTITION__	123
+Beck	0	__HIVE_DEFAULT_PARTITION__	123
 Beck	77.341	__HIVE_DEFAULT_PARTITION__	123
 Beck	79.9	__HIVE_DEFAULT_PARTITION__	123
 Cluck	5.96	__HIVE_DEFAULT_PARTITION__	123
@@ -457,7 +457,7 @@ Mary	33.33	__HIVE_DEFAULT_PARTITION__	123
 Mary	4.329	__HIVE_DEFAULT_PARTITION__	123
 Snow	55.71	__HIVE_DEFAULT_PARTITION__	123
 Tom	-12.25	__HIVE_DEFAULT_PARTITION__	123
-Tom	19.00	__HIVE_DEFAULT_PARTITION__	123
+Tom	19	__HIVE_DEFAULT_PARTITION__	123
 Tom	234.79	__HIVE_DEFAULT_PARTITION__	123
 PREHOOK: query: alter table alter_partition_change_col1 replace columns (c1 string)
 PREHOOK: type: ALTERTABLE_REPLACECOLS
@@ -593,7 +593,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alter_partition_change_col1
 POSTHOOK: Input: default@alter_partition_change_col1@p1=__HIVE_DEFAULT_PARTITION__/p2=123
 #### A masked pattern was here ####
-Beck	0.0	__HIVE_DEFAULT_PARTITION__	123
+Beck	0	__HIVE_DEFAULT_PARTITION__	123
 Beck	77.341	__HIVE_DEFAULT_PARTITION__	123
 Beck	79.9	__HIVE_DEFAULT_PARTITION__	123
 Cluck	5.96	__HIVE_DEFAULT_PARTITION__	123
@@ -601,7 +601,7 @@ Mary	33.33	__HIVE_DEFAULT_PARTITION__	123
 Mary	4.329	__HIVE_DEFAULT_PARTITION__	123
 Snow	55.71	__HIVE_DEFAULT_PARTITION__	123
 Tom	-12.25	__HIVE_DEFAULT_PARTITION__	123
-Tom	19.00	__HIVE_DEFAULT_PARTITION__	123
+Tom	19	__HIVE_DEFAULT_PARTITION__	123
 Tom	234.79	__HIVE_DEFAULT_PARTITION__	123
 PREHOOK: query: alter table alter_partition_change_col1 partition (p1='abc', p2='123') add columns (c2 decimal(14,4))
 PREHOOK: type: ALTERTABLE_ADDCOLS
@@ -638,7 +638,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alter_partition_change_col1
 POSTHOOK: Input: default@alter_partition_change_col1@p1=abc/p2=123
 #### A masked pattern was here ####
-Beck	0.0	abc	123
+Beck	0	abc	123
 Beck	77.341	abc	123
 Beck	79.9	abc	123
 Cluck	5.96	abc	123
@@ -646,7 +646,7 @@ Mary	33.33	abc	123
 Mary	4.329	abc	123
 Snow	55.71	abc	123
 Tom	-12.25	abc	123
-Tom	19.00	abc	123
+Tom	19	abc	123
 Tom	234.79	abc	123
 PREHOOK: query: select * from alter_partition_change_col1 where p1='__HIVE_DEFAULT_PARTITION__'
 PREHOOK: type: QUERY
@@ -658,7 +658,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alter_partition_change_col1
 POSTHOOK: Input: default@alter_partition_change_col1@p1=__HIVE_DEFAULT_PARTITION__/p2=123
 #### A masked pattern was here ####
-Beck	0.0	__HIVE_DEFAULT_PARTITION__	123
+Beck	0	__HIVE_DEFAULT_PARTITION__	123
 Beck	77.341	__HIVE_DEFAULT_PARTITION__	123
 Beck	79.9	__HIVE_DEFAULT_PARTITION__	123
 Cluck	5.96	__HIVE_DEFAULT_PARTITION__	123
@@ -666,7 +666,7 @@ Mary	33.33	__HIVE_DEFAULT_PARTITION__	123
 Mary	4.329	__HIVE_DEFAULT_PARTITION__	123
 Snow	55.71	__HIVE_DEFAULT_PARTITION__	123
 Tom	-12.25	__HIVE_DEFAULT_PARTITION__	123
-Tom	19.00	__HIVE_DEFAULT_PARTITION__	123
+Tom	19	__HIVE_DEFAULT_PARTITION__	123
 Tom	234.79	__HIVE_DEFAULT_PARTITION__	123
 PREHOOK: query: -- Try changing column for all partitions at once
 alter table alter_partition_change_col1 partition (p1, p2='123') change column c2 c2 decimal(10,0)
diff --git a/ql/src/test/results/clientpositive/avro_decimal.q.out b/ql/src/test/results/clientpositive/avro_decimal.q.out
index 921a418f26..88268ceb3a 100644
--- a/ql/src/test/results/clientpositive/avro_decimal.q.out
+++ b/ql/src/test/results/clientpositive/avro_decimal.q.out
@@ -106,9 +106,9 @@ Mary	4.33
 Cluck	5.96
 Tom	-12.25
 Mary	33.33
-Tom	19.00
-Beck	0.00
-Beck	79.90
+Tom	19
+Beck	0
+Beck	79.9
 PREHOOK: query: DROP TABLE IF EXISTS avro_dec1
 PREHOOK: type: DROPTABLE
 POSTHOOK: query: DROP TABLE IF EXISTS avro_dec1
@@ -175,10 +175,10 @@ POSTHOOK: Input: default@avro_dec1
 77.3
 55.7
 4.3
-6.0
+6
 12.3
 33.3
-19.0
+19
 3.2
 79.9
 PREHOOK: query: DROP TABLE dec
diff --git a/ql/src/test/results/clientpositive/avro_decimal_native.q.out b/ql/src/test/results/clientpositive/avro_decimal_native.q.out
index 60b4ccc0e9..c8ae0fb240 100644
--- a/ql/src/test/results/clientpositive/avro_decimal_native.q.out
+++ b/ql/src/test/results/clientpositive/avro_decimal_native.q.out
@@ -92,9 +92,9 @@ Mary	4.33
 Cluck	5.96
 Tom	-12.25
 Mary	33.33
-Tom	19.00
-Beck	0.00
-Beck	79.90
+Tom	19
+Beck	0
+Beck	79.9
 PREHOOK: query: DROP TABLE IF EXISTS avro_dec1
 PREHOOK: type: DROPTABLE
 POSTHOOK: query: DROP TABLE IF EXISTS avro_dec1
@@ -143,10 +143,10 @@ POSTHOOK: Input: default@avro_dec1
 77.3
 55.7
 4.3
-6.0
+6
 12.3
 33.3
-19.0
+19
 3.2
 79.9
 PREHOOK: query: DROP TABLE dec
diff --git a/ql/src/test/results/clientpositive/char_pad_convert.q.out b/ql/src/test/results/clientpositive/char_pad_convert.q.out
index 63568af15e..26102e43f8 100644
--- a/ql/src/test/results/clientpositive/char_pad_convert.q.out
+++ b/ql/src/test/results/clientpositive/char_pad_convert.q.out
@@ -144,7 +144,7 @@ select lpad(f, 4, ' '),
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k
 #### A masked pattern was here ####
-74.7	42	zzzzzTRUE	20	dd45.40	yard du
+74.7	42	zzzzzTRUE	20	ddd45.4	yard du
 26.4	37	zzzzzTRUE	20	dd29.62	history
 96.9	18	zzzzFALSE	20	dd27.32	history
 13.0	34	zzzzFALSE	20	dd23.91	topolog
@@ -190,7 +190,7 @@ POSTHOOK: query: select rpad(f, 4, ' '),
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k
 #### A masked pattern was here ####
-74.7	42	TRUEzzzzz	20	45.40dd	yard du
+74.7	42	TRUEzzzzz	20	45.4ddd	yard du
 26.4	37	TRUEzzzzz	20	29.62dd	history
 96.9	18	FALSEzzzz	20	27.32dd	history
 13.0	34	FALSEzzzz	20	23.91dd	topolog
diff --git a/ql/src/test/results/clientpositive/decimal_2.q.out b/ql/src/test/results/clientpositive/decimal_2.q.out
index 759ecf47a6..934590c66d 100644
--- a/ql/src/test/results/clientpositive/decimal_2.q.out
+++ b/ql/src/test/results/clientpositive/decimal_2.q.out
@@ -264,7 +264,7 @@ POSTHOOK: query: select cast(0.99999999999999999999 as decimal(20,19)) from deci
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@decimal_2
 #### A masked pattern was here ####
-1.0
+1
 PREHOOK: query: select cast('0.99999999999999999999' as decimal(20,20)) from decimal_2
 PREHOOK: type: QUERY
 PREHOOK: Input: default@decimal_2
diff --git a/ql/src/test/results/clientpositive/decimal_3.q.out b/ql/src/test/results/clientpositive/decimal_3.q.out
index acaae655d6..8e9a30a8e2 100644
--- a/ql/src/test/results/clientpositive/decimal_3.q.out
+++ b/ql/src/test/results/clientpositive/decimal_3.q.out
@@ -33,7 +33,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@decimal_3
 #### A masked pattern was here ####
 NULL	0
--1234567890.1234567890	-1234567890
+-1234567890.123456789	-1234567890
 -4400	4400
 -1255.49	-1255
 -1.122	-11
@@ -42,7 +42,7 @@ NULL	0
 -0.333	0
 -0.33	0
 -0.3	0
-0.000000000000000000	0
+0	0
 0	0
 0	0
 0.01	0
@@ -53,8 +53,8 @@ NULL	0
 0.33	0
 0.333	0
 1	1
-1.0	1
-1.000000000000000000	1
+1	1
+1	1
 1.12	1
 1.122	1
 2	2
@@ -62,14 +62,14 @@ NULL	0
 3.14	3
 3.14	3
 3.14	3
-3.140	4
+3.14	4
 10	10
 20	20
 100	100
-124.00	124
+124	124
 125.2	125
 200	200
-1234567890.1234567800	1234567890
+1234567890.12345678	1234567890
 PREHOOK: query: SELECT * FROM DECIMAL_3 ORDER BY key DESC, value DESC
 PREHOOK: type: QUERY
 PREHOOK: Input: default@decimal_3
@@ -78,14 +78,14 @@ POSTHOOK: query: SELECT * FROM DECIMAL_3 ORDER BY key DESC, value DESC
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@decimal_3
 #### A masked pattern was here ####
-1234567890.1234567800	1234567890
+1234567890.12345678	1234567890
 200	200
 125.2	125
-124.00	124
+124	124
 100	100
 20	20
 10	10
-3.140	4
+3.14	4
 3.14	3
 3.14	3
 3.14	3
@@ -93,8 +93,8 @@ POSTHOOK: Input: default@decimal_3
 2	2
 1.122	1
 1.12	1
-1.000000000000000000	1
-1.0	1
+1	1
+1	1
 1	1
 0.333	0
 0.33	0
@@ -105,7 +105,7 @@ POSTHOOK: Input: default@decimal_3
 0.01	0
 0	0
 0	0
-0.000000000000000000	0
+0	0
 -0.3	0
 -0.33	0
 -0.333	0
@@ -114,7 +114,7 @@ POSTHOOK: Input: default@decimal_3
 -1.122	-11
 -1255.49	-1255
 -4400	4400
--1234567890.1234567890	-1234567890
+-1234567890.123456789	-1234567890
 NULL	0
 PREHOOK: query: SELECT * FROM DECIMAL_3 ORDER BY key, value
 PREHOOK: type: QUERY
@@ -125,7 +125,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@decimal_3
 #### A masked pattern was here ####
 NULL	0
--1234567890.1234567890	-1234567890
+-1234567890.123456789	-1234567890
 -4400	4400
 -1255.49	-1255
 -1.122	-11
@@ -134,7 +134,7 @@ NULL	0
 -0.333	0
 -0.33	0
 -0.3	0
-0.000000000000000000	0
+0	0
 0	0
 0	0
 0.01	0
@@ -145,8 +145,8 @@ NULL	0
 0.33	0
 0.333	0
 1	1
-1.0	1
-1.000000000000000000	1
+1	1
+1	1
 1.12	1
 1.122	1
 2	2
@@ -154,14 +154,14 @@ NULL	0
 3.14	3
 3.14	3
 3.14	3
-3.140	4
+3.14	4
 10	10
 20	20
 100	100
-124.00	124
+124	124
 125.2	125
 200	200
-1234567890.1234567800	1234567890
+1234567890.12345678	1234567890
 PREHOOK: query: SELECT DISTINCT key FROM DECIMAL_3 ORDER BY key
 PREHOOK: type: QUERY
 PREHOOK: Input: default@decimal_3
@@ -171,7 +171,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@decimal_3
 #### A masked pattern was here ####
 NULL
--1234567890.1234567890
+-1234567890.123456789
 -4400
 -1255.49
 -1.122
@@ -179,7 +179,7 @@ NULL
 -0.333
 -0.33
 -0.3
-0.000000000000000000
+0
 0.01
 0.02
 0.1
@@ -195,10 +195,10 @@ NULL
 10
 20
 100
-124.00
+124
 125.2
 200
-1234567890.1234567800
+1234567890.12345678
 PREHOOK: query: SELECT key, sum(value) FROM DECIMAL_3 GROUP BY key ORDER BY key
 PREHOOK: type: QUERY
 PREHOOK: Input: default@decimal_3
@@ -208,7 +208,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@decimal_3
 #### A masked pattern was here ####
 NULL	0
--1234567890.1234567890	-1234567890
+-1234567890.123456789	-1234567890
 -4400	4400
 -1255.49	-1255
 -1.122	-11
@@ -216,7 +216,7 @@ NULL	0
 -0.333	0
 -0.33	0
 -0.3	0
-0.000000000000000000	0
+0	0
 0.01	0
 0.02	0
 0.1	0
@@ -232,10 +232,10 @@ NULL	0
 10	10
 20	20
 100	100
-124.00	124
+124	124
 125.2	125
 200	200
-1234567890.1234567800	1234567890
+1234567890.12345678	1234567890
 PREHOOK: query: SELECT value, sum(key) FROM DECIMAL_3 GROUP BY value ORDER BY value
 PREHOOK: type: QUERY
 PREHOOK: Input: default@decimal_3
@@ -244,23 +244,23 @@ POSTHOOK: query: SELECT value, sum(key) FROM DECIMAL_3 GROUP BY value ORDER BY v
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@decimal_3
 #### A masked pattern was here ####
--1234567890	-1234567890.1234567890
+-1234567890	-1234567890.123456789
 -1255	-1255.49
 -11	-1.122
 -1	-2.24
-0	0.330000000000000000
-1	5.242000000000000000
+0	0.33
+1	5.242
 2	4
 3	9.42
-4	3.140
+4	3.14
 10	10
 20	20
 100	100
-124	124.00
+124	124
 125	125.2
 200	200
 4400	-4400
-1234567890	1234567890.1234567800
+1234567890	1234567890.12345678
 PREHOOK: query: SELECT * FROM DECIMAL_3 a JOIN DECIMAL_3 b ON (a.key = b.key) ORDER BY a.key, a.value, b.value
 PREHOOK: type: QUERY
 PREHOOK: Input: default@decimal_3
@@ -269,7 +269,7 @@ POSTHOOK: query: SELECT * FROM DECIMAL_3 a JOIN DECIMAL_3 b ON (a.key = b.key) O
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@decimal_3
 #### A masked pattern was here ####
--1234567890.1234567890	-1234567890	-1234567890.1234567890	-1234567890
+-1234567890.123456789	-1234567890	-1234567890.123456789	-1234567890
 -4400	4400	-4400	4400
 -1255.49	-1255	-1255.49	-1255
 -1.122	-11	-1.122	-11
@@ -280,7 +280,11 @@ POSTHOOK: Input: default@decimal_3
 -0.333	0	-0.333	0
 -0.33	0	-0.33	0
 -0.3	0	-0.3	0
-0.000000000000000000	0	0.000000000000000000	0
+0	0	0	0
+0	0	0	0
+0	0	0	0
+0	0	0	0
+0	0	0	0
 0	0	0	0
 0	0	0	0
 0	0	0	0
@@ -293,8 +297,14 @@ POSTHOOK: Input: default@decimal_3
 0.33	0	0.33	0
 0.333	0	0.333	0
 1	1	1	1
-1.0	1	1.0	1
-1.000000000000000000	1	1.000000000000000000	1
+1	1	1	1
+1	1	1	1
+1	1	1	1
+1	1	1	1
+1	1	1	1
+1	1	1	1
+1	1	1	1
+1	1	1	1
 1.12	1	1.12	1
 1.122	1	1.122	1
 2	2	2	2
@@ -310,14 +320,20 @@ POSTHOOK: Input: default@decimal_3
 3.14	3	3.14	3
 3.14	3	3.14	3
 3.14	3	3.14	3
-3.140	4	3.140	4
+3.14	3	3.14	4
+3.14	3	3.14	4
+3.14	3	3.14	4
+3.14	4	3.14	3
+3.14	4	3.14	3
+3.14	4	3.14	3
+3.14	4	3.14	4
 10	10	10	10
 20	20	20	20
 100	100	100	100
-124.00	124	124.00	124
+124	124	124	124
 125.2	125	125.2	125
 200	200	200	200
-1234567890.1234567800	1234567890	1234567890.1234567800	1234567890
+1234567890.12345678	1234567890	1234567890.12345678	1234567890
 PREHOOK: query: SELECT * FROM DECIMAL_3 WHERE key=3.14 ORDER BY key, value
 PREHOOK: type: QUERY
 PREHOOK: Input: default@decimal_3
@@ -329,7 +345,7 @@ POSTHOOK: Input: default@decimal_3
 3.14	3
 3.14	3
 3.14	3
-3.140	4
+3.14	4
 PREHOOK: query: SELECT * FROM DECIMAL_3 WHERE key=3.140 ORDER BY key, value
 PREHOOK: type: QUERY
 PREHOOK: Input: default@decimal_3
@@ -341,7 +357,7 @@ POSTHOOK: Input: default@decimal_3
 3.14	3
 3.14	3
 3.14	3
-3.140	4
+3.14	4
 PREHOOK: query: DROP TABLE DECIMAL_3
 PREHOOK: type: DROPTABLE
 PREHOOK: Input: default@decimal_3
diff --git a/ql/src/test/results/clientpositive/decimal_4.q.out b/ql/src/test/results/clientpositive/decimal_4.q.out
index a31d27a950..50662af1ed 100644
--- a/ql/src/test/results/clientpositive/decimal_4.q.out
+++ b/ql/src/test/results/clientpositive/decimal_4.q.out
@@ -57,7 +57,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@decimal_4_1
 #### A masked pattern was here ####
 NULL	0
--1234567890.1234567890	-1234567890
+-1234567890.123456789	-1234567890
 -4400	4400
 -1255.49	-1255
 -1.122	-11
@@ -66,7 +66,7 @@ NULL	0
 -0.333	0
 -0.33	0
 -0.3	0
-0.0000000000000000000000000	0
+0	0
 0	0
 0	0
 0.01	0
@@ -78,7 +78,7 @@ NULL	0
 0.333	0
 0.9999999999999999999999999	1
 1	1
-1.0	1
+1	1
 1.12	1
 1.122	1
 2	2
@@ -86,14 +86,14 @@ NULL	0
 3.14	3
 3.14	3
 3.14	3
-3.140	4
+3.14	4
 10	10
 20	20
 100	100
-124.00	124
+124	124
 125.2	125
 200	200
-1234567890.1234567800	1234567890
+1234567890.12345678	1234567890
 PREHOOK: query: SELECT * FROM DECIMAL_4_2 ORDER BY key
 PREHOOK: type: QUERY
 PREHOOK: Input: default@decimal_4_2
@@ -103,7 +103,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@decimal_4_2
 #### A masked pattern was here ####
 NULL	NULL
--1234567890.1234567890	-3703703670.3703703670
+-1234567890.123456789	-3703703670.370370367
 -4400	-13200
 -1255.49	-3766.47
 -1.122	-3.366
@@ -112,7 +112,7 @@ NULL	NULL
 -0.333	-0.999
 -0.33	-0.99
 -0.3	-0.9
-0.0000000000000000000000000	0.0000000000000000000000000
+0	0
 0	0
 0	0
 0.01	0.03
@@ -124,7 +124,7 @@ NULL	NULL
 0.333	0.999
 0.9999999999999999999999999	2.9999999999999999999999997
 1	3
-1.0	3.0
+1	3
 1.12	3.36
 1.122	3.366
 2	6
@@ -132,14 +132,14 @@ NULL	NULL
 3.14	9.42
 3.14	9.42
 3.14	9.42
-3.140	9.420
+3.14	9.42
 10	30
 20	60
 100	300
-124.00	372.00
+124	372
 125.2	375.6
 200	600
-1234567890.1234567800	3703703670.3703703400
+1234567890.12345678	3703703670.37037034
 PREHOOK: query: DROP TABLE DECIMAL_4_1
 PREHOOK: type: DROPTABLE
 PREHOOK: Input: default@decimal_4_1
diff --git a/ql/src/test/results/clientpositive/decimal_5.q.out b/ql/src/test/results/clientpositive/decimal_5.q.out
index 6df509761c..0f24b8a9e8 100644
--- a/ql/src/test/results/clientpositive/decimal_5.q.out
+++ b/ql/src/test/results/clientpositive/decimal_5.q.out
@@ -43,7 +43,7 @@ NULL
 -0.333
 -0.33
 -0.3
-0.00000
+0
 0
 0
 0.01
@@ -54,8 +54,8 @@ NULL
 0.33
 0.333
 1
-1.0
-1.00000
+1
+1
 1.12
 1.122
 2
@@ -63,11 +63,11 @@ NULL
 3.14
 3.14
 3.14
-3.140
+3.14
 10
 20
 100
-124.00
+124
 125.2
 200
 PREHOOK: query: SELECT DISTINCT key FROM DECIMAL_5 ORDER BY key
@@ -86,7 +86,7 @@ NULL
 -0.333
 -0.33
 -0.3
-0.00000
+0
 0.01
 0.02
 0.1
@@ -102,7 +102,7 @@ NULL
 10
 20
 100
-124.00
+124
 125.2
 200
 PREHOOK: query: SELECT cast(key as decimal) FROM DECIMAL_5
@@ -161,7 +161,7 @@ POSTHOOK: Input: default@decimal_5
 #### A masked pattern was here ####
 NULL
 NULL
-0.000
+0
 0
 100
 10
@@ -180,7 +180,7 @@ NULL
 -0.3
 -0.33
 -0.333
-1.0
+1
 2
 3.14
 -1.12
@@ -188,13 +188,13 @@ NULL
 -1.122
 1.12
 1.122
-124.00
+124
 125.2
 NULL
 3.14
 3.14
-3.140
-1.000
+3.14
+1
 NULL
 NULL
 PREHOOK: query: DROP TABLE DECIMAL_5
diff --git a/ql/src/test/results/clientpositive/decimal_6.q.out b/ql/src/test/results/clientpositive/decimal_6.q.out
index 2bbd48ad0d..0344fa9e1d 100644
--- a/ql/src/test/results/clientpositive/decimal_6.q.out
+++ b/ql/src/test/results/clientpositive/decimal_6.q.out
@@ -91,16 +91,16 @@ NULL
 -0.333
 -0.3
 -0.3
-0.00000
-0.0000
+0
+0
 0
 0
 0.333
 0.333
-1.0
-1.0
-1.0000
-1.00000
+1
+1
+1
+1
 1.12
 1.12
 1.122
@@ -111,14 +111,14 @@ NULL
 3.14
 3.14
 3.14
-3.140
-3.140
+3.14
+3.14
 10
 10
 10.7343
 10.73433
-124.00
-124.00
+124
+124
 125.2
 125.2
 23232.23435
diff --git a/ql/src/test/results/clientpositive/decimal_join2.q.out b/ql/src/test/results/clientpositive/decimal_join2.q.out
new file mode 100644
index 0000000000..f9c33b7d65
--- /dev/null
+++ b/ql/src/test/results/clientpositive/decimal_join2.q.out
@@ -0,0 +1,371 @@
+PREHOOK: query: DROP TABLE IF EXISTS DECIMAL_3_txt
+PREHOOK: type: DROPTABLE
+POSTHOOK: query: DROP TABLE IF EXISTS DECIMAL_3_txt
+POSTHOOK: type: DROPTABLE
+PREHOOK: query: DROP TABLE IF EXISTS DECIMAL_3
+PREHOOK: type: DROPTABLE
+POSTHOOK: query: DROP TABLE IF EXISTS DECIMAL_3
+POSTHOOK: type: DROPTABLE
+PREHOOK: query: CREATE TABLE DECIMAL_3_txt(key decimal(38,18), value int)
+ROW FORMAT DELIMITED
+   FIELDS TERMINATED BY ' '
+STORED AS TEXTFILE
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@DECIMAL_3_txt
+POSTHOOK: query: CREATE TABLE DECIMAL_3_txt(key decimal(38,18), value int)
+ROW FORMAT DELIMITED
+   FIELDS TERMINATED BY ' '
+STORED AS TEXTFILE
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@DECIMAL_3_txt
+PREHOOK: query: LOAD DATA LOCAL INPATH '../../data/files/kv7.txt' INTO TABLE DECIMAL_3_txt
+PREHOOK: type: LOAD
+#### A masked pattern was here ####
+PREHOOK: Output: default@decimal_3_txt
+POSTHOOK: query: LOAD DATA LOCAL INPATH '../../data/files/kv7.txt' INTO TABLE DECIMAL_3_txt
+POSTHOOK: type: LOAD
+#### A masked pattern was here ####
+POSTHOOK: Output: default@decimal_3_txt
+PREHOOK: query: CREATE TABLE DECIMAL_3 STORED AS ORC AS SELECT * FROM DECIMAL_3_txt
+PREHOOK: type: CREATETABLE_AS_SELECT
+PREHOOK: Input: default@decimal_3_txt
+PREHOOK: Output: database:default
+PREHOOK: Output: default@DECIMAL_3
+POSTHOOK: query: CREATE TABLE DECIMAL_3 STORED AS ORC AS SELECT * FROM DECIMAL_3_txt
+POSTHOOK: type: CREATETABLE_AS_SELECT
+POSTHOOK: Input: default@decimal_3_txt
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@DECIMAL_3
+PREHOOK: query: EXPLAIN
+SELECT * FROM DECIMAL_3 a JOIN DECIMAL_3 b ON (a.key = b.key) ORDER BY a.key, a.value, b.key, b.value
+PREHOOK: type: QUERY
+POSTHOOK: query: EXPLAIN
+SELECT * FROM DECIMAL_3 a JOIN DECIMAL_3 b ON (a.key = b.key) ORDER BY a.key, a.value, b.key, b.value
+POSTHOOK: type: QUERY
+STAGE DEPENDENCIES:
+  Stage-1 is a root stage
+  Stage-2 depends on stages: Stage-1
+  Stage-0 depends on stages: Stage-2
+
+STAGE PLANS:
+  Stage: Stage-1
+    Map Reduce
+      Map Operator Tree:
+          TableScan
+            alias: b
+            Statistics: Num rows: 38 Data size: 4296 Basic stats: COMPLETE Column stats: NONE
+            Filter Operator
+              predicate: key is not null (type: boolean)
+              Statistics: Num rows: 19 Data size: 2148 Basic stats: COMPLETE Column stats: NONE
+              Reduce Output Operator
+                key expressions: key (type: decimal(38,18))
+                sort order: +
+                Map-reduce partition columns: key (type: decimal(38,18))
+                Statistics: Num rows: 19 Data size: 2148 Basic stats: COMPLETE Column stats: NONE
+                value expressions: value (type: int)
+          TableScan
+            alias: a
+            Statistics: Num rows: 38 Data size: 4296 Basic stats: COMPLETE Column stats: NONE
+            Filter Operator
+              predicate: key is not null (type: boolean)
+              Statistics: Num rows: 19 Data size: 2148 Basic stats: COMPLETE Column stats: NONE
+              Reduce Output Operator
+                key expressions: key (type: decimal(38,18))
+                sort order: +
+                Map-reduce partition columns: key (type: decimal(38,18))
+                Statistics: Num rows: 19 Data size: 2148 Basic stats: COMPLETE Column stats: NONE
+                value expressions: value (type: int)
+      Reduce Operator Tree:
+        Join Operator
+          condition map:
+               Inner Join 0 to 1
+          condition expressions:
+            0 {KEY.reducesinkkey0} {VALUE._col0}
+            1 {KEY.reducesinkkey0} {VALUE._col0}
+          outputColumnNames: _col0, _col1, _col5, _col6
+          Statistics: Num rows: 20 Data size: 2362 Basic stats: COMPLETE Column stats: NONE
+          Select Operator
+            expressions: _col0 (type: decimal(38,18)), _col1 (type: int), _col5 (type: decimal(38,18)), _col6 (type: int)
+            outputColumnNames: _col0, _col1, _col2, _col3
+            Statistics: Num rows: 20 Data size: 2362 Basic stats: COMPLETE Column stats: NONE
+            File Output Operator
+              compressed: false
+              table:
+                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
+
+  Stage: Stage-2
+    Map Reduce
+      Map Operator Tree:
+          TableScan
+            Reduce Output Operator
+              key expressions: _col0 (type: decimal(38,18)), _col1 (type: int), _col2 (type: decimal(38,18)), _col3 (type: int)
+              sort order: ++++
+              Statistics: Num rows: 20 Data size: 2362 Basic stats: COMPLETE Column stats: NONE
+      Reduce Operator Tree:
+        Select Operator
+          expressions: KEY.reducesinkkey0 (type: decimal(38,18)), KEY.reducesinkkey1 (type: int), KEY.reducesinkkey2 (type: decimal(38,18)), KEY.reducesinkkey3 (type: int)
+          outputColumnNames: _col0, _col1, _col2, _col3
+          Statistics: Num rows: 20 Data size: 2362 Basic stats: COMPLETE Column stats: NONE
+          File Output Operator
+            compressed: false
+            Statistics: Num rows: 20 Data size: 2362 Basic stats: COMPLETE Column stats: NONE
+            table:
+                input format: org.apache.hadoop.mapred.TextInputFormat
+                output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+
+  Stage: Stage-0
+    Fetch Operator
+      limit: -1
+      Processor Tree:
+        ListSink
+
+PREHOOK: query: SELECT * FROM DECIMAL_3 a JOIN DECIMAL_3 b ON (a.key = b.key) ORDER BY a.key, a.value, b.key, b.value
+PREHOOK: type: QUERY
+PREHOOK: Input: default@decimal_3
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT * FROM DECIMAL_3 a JOIN DECIMAL_3 b ON (a.key = b.key) ORDER BY a.key, a.value, b.key, b.value
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@decimal_3
+#### A masked pattern was here ####
+-1234567890.123456789	-1234567890	-1234567890.123456789	-1234567890
+-4400	4400	-4400	4400
+-1255.49	-1255	-1255.49	-1255
+-1.122	-11	-1.122	-11
+-1.12	-1	-1.12	-1
+-1.12	-1	-1.12	-1
+-1.12	-1	-1.12	-1
+-1.12	-1	-1.12	-1
+-0.333	0	-0.333	0
+-0.33	0	-0.33	0
+-0.3	0	-0.3	0
+0	0	0	0
+0	0	0	0
+0	0	0	0
+0	0	0	0
+0	0	0	0
+0	0	0	0
+0	0	0	0
+0	0	0	0
+0	0	0	0
+0.01	0	0.01	0
+0.02	0	0.02	0
+0.1	0	0.1	0
+0.2	0	0.2	0
+0.3	0	0.3	0
+0.33	0	0.33	0
+0.333	0	0.333	0
+1	1	1	1
+1	1	1	1
+1	1	1	1
+1	1	1	1
+1	1	1	1
+1	1	1	1
+1	1	1	1
+1	1	1	1
+1	1	1	1
+1.12	1	1.12	1
+1.122	1	1.122	1
+2	2	2	2
+2	2	2	2
+2	2	2	2
+2	2	2	2
+3.14	3	3.14	3
+3.14	3	3.14	3
+3.14	3	3.14	3
+3.14	3	3.14	3
+3.14	3	3.14	3
+3.14	3	3.14	3
+3.14	3	3.14	3
+3.14	3	3.14	3
+3.14	3	3.14	3
+3.14	3	3.14	4
+3.14	3	3.14	4
+3.14	3	3.14	4
+3.14	4	3.14	3
+3.14	4	3.14	3
+3.14	4	3.14	3
+3.14	4	3.14	4
+10	10	10	10
+20	20	20	20
+100	100	100	100
+124	124	124	124
+125.2	125	125.2	125
+200	200	200	200
+1234567890.12345678	1234567890	1234567890.12345678	1234567890
+PREHOOK: query: EXPLAIN
+SELECT * FROM DECIMAL_3 a JOIN DECIMAL_3 b ON (a.key = b.key) ORDER BY a.key, a.value, b.key, b.value
+PREHOOK: type: QUERY
+POSTHOOK: query: EXPLAIN
+SELECT * FROM DECIMAL_3 a JOIN DECIMAL_3 b ON (a.key = b.key) ORDER BY a.key, a.value, b.key, b.value
+POSTHOOK: type: QUERY
+STAGE DEPENDENCIES:
+  Stage-5 is a root stage
+  Stage-2 depends on stages: Stage-5
+  Stage-0 depends on stages: Stage-2
+
+STAGE PLANS:
+  Stage: Stage-5
+    Map Reduce Local Work
+      Alias -> Map Local Tables:
+        a 
+          Fetch Operator
+            limit: -1
+      Alias -> Map Local Operator Tree:
+        a 
+          TableScan
+            alias: a
+            Statistics: Num rows: 38 Data size: 4296 Basic stats: COMPLETE Column stats: NONE
+            Filter Operator
+              predicate: key is not null (type: boolean)
+              Statistics: Num rows: 19 Data size: 2148 Basic stats: COMPLETE Column stats: NONE
+              HashTable Sink Operator
+                condition expressions:
+                  0 {value}
+                  1 {key} {value}
+                keys:
+                  0 key (type: decimal(38,18))
+                  1 key (type: decimal(38,18))
+
+  Stage: Stage-2
+    Map Reduce
+      Map Operator Tree:
+          TableScan
+            alias: b
+            Statistics: Num rows: 38 Data size: 4296 Basic stats: COMPLETE Column stats: NONE
+            Filter Operator
+              predicate: key is not null (type: boolean)
+              Statistics: Num rows: 19 Data size: 2148 Basic stats: COMPLETE Column stats: NONE
+              Map Join Operator
+                condition map:
+                     Inner Join 0 to 1
+                condition expressions:
+                  0 {key} {value}
+                  1 {key} {value}
+                keys:
+                  0 key (type: decimal(38,18))
+                  1 key (type: decimal(38,18))
+                outputColumnNames: _col0, _col1, _col5, _col6
+                Statistics: Num rows: 20 Data size: 2362 Basic stats: COMPLETE Column stats: NONE
+                Select Operator
+                  expressions: _col0 (type: decimal(38,18)), _col1 (type: int), _col5 (type: decimal(38,18)), _col6 (type: int)
+                  outputColumnNames: _col0, _col1, _col2, _col3
+                  Statistics: Num rows: 20 Data size: 2362 Basic stats: COMPLETE Column stats: NONE
+                  Reduce Output Operator
+                    key expressions: _col0 (type: decimal(38,18)), _col1 (type: int), _col2 (type: decimal(38,18)), _col3 (type: int)
+                    sort order: ++++
+                    Statistics: Num rows: 20 Data size: 2362 Basic stats: COMPLETE Column stats: NONE
+      Local Work:
+        Map Reduce Local Work
+      Reduce Operator Tree:
+        Select Operator
+          expressions: KEY.reducesinkkey0 (type: decimal(38,18)), KEY.reducesinkkey1 (type: int), KEY.reducesinkkey2 (type: decimal(38,18)), KEY.reducesinkkey3 (type: int)
+          outputColumnNames: _col0, _col1, _col2, _col3
+          Statistics: Num rows: 20 Data size: 2362 Basic stats: COMPLETE Column stats: NONE
+          File Output Operator
+            compressed: false
+            Statistics: Num rows: 20 Data size: 2362 Basic stats: COMPLETE Column stats: NONE
+            table:
+                input format: org.apache.hadoop.mapred.TextInputFormat
+                output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+
+  Stage: Stage-0
+    Fetch Operator
+      limit: -1
+      Processor Tree:
+        ListSink
+
+PREHOOK: query: SELECT * FROM DECIMAL_3 a JOIN DECIMAL_3 b ON (a.key = b.key) ORDER BY a.key, a.value, b.key, b.value
+PREHOOK: type: QUERY
+PREHOOK: Input: default@decimal_3
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT * FROM DECIMAL_3 a JOIN DECIMAL_3 b ON (a.key = b.key) ORDER BY a.key, a.value, b.key, b.value
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@decimal_3
+#### A masked pattern was here ####
+-1234567890.123456789	-1234567890	-1234567890.123456789	-1234567890
+-4400	4400	-4400	4400
+-1255.49	-1255	-1255.49	-1255
+-1.122	-11	-1.122	-11
+-1.12	-1	-1.12	-1
+-1.12	-1	-1.12	-1
+-1.12	-1	-1.12	-1
+-1.12	-1	-1.12	-1
+-0.333	0	-0.333	0
+-0.33	0	-0.33	0
+-0.3	0	-0.3	0
+0	0	0	0
+0	0	0	0
+0	0	0	0
+0	0	0	0
+0	0	0	0
+0	0	0	0
+0	0	0	0
+0	0	0	0
+0	0	0	0
+0.01	0	0.01	0
+0.02	0	0.02	0
+0.1	0	0.1	0
+0.2	0	0.2	0
+0.3	0	0.3	0
+0.33	0	0.33	0
+0.333	0	0.333	0
+1	1	1	1
+1	1	1	1
+1	1	1	1
+1	1	1	1
+1	1	1	1
+1	1	1	1
+1	1	1	1
+1	1	1	1
+1	1	1	1
+1.12	1	1.12	1
+1.122	1	1.122	1
+2	2	2	2
+2	2	2	2
+2	2	2	2
+2	2	2	2
+3.14	3	3.14	3
+3.14	3	3.14	3
+3.14	3	3.14	3
+3.14	3	3.14	3
+3.14	3	3.14	3
+3.14	3	3.14	3
+3.14	3	3.14	3
+3.14	3	3.14	3
+3.14	3	3.14	3
+3.14	3	3.14	4
+3.14	3	3.14	4
+3.14	3	3.14	4
+3.14	4	3.14	3
+3.14	4	3.14	3
+3.14	4	3.14	3
+3.14	4	3.14	4
+10	10	10	10
+20	20	20	20
+100	100	100	100
+124	124	124	124
+125.2	125	125.2	125
+200	200	200	200
+1234567890.12345678	1234567890	1234567890.12345678	1234567890
+PREHOOK: query: DROP TABLE DECIMAL_3_txt
+PREHOOK: type: DROPTABLE
+PREHOOK: Input: default@decimal_3_txt
+PREHOOK: Output: default@decimal_3_txt
+POSTHOOK: query: DROP TABLE DECIMAL_3_txt
+POSTHOOK: type: DROPTABLE
+POSTHOOK: Input: default@decimal_3_txt
+POSTHOOK: Output: default@decimal_3_txt
+PREHOOK: query: DROP TABLE DECIMAL_3
+PREHOOK: type: DROPTABLE
+PREHOOK: Input: default@decimal_3
+PREHOOK: Output: default@decimal_3
+POSTHOOK: query: DROP TABLE DECIMAL_3
+POSTHOOK: type: DROPTABLE
+POSTHOOK: Input: default@decimal_3
+POSTHOOK: Output: default@decimal_3
diff --git a/ql/src/test/results/clientpositive/decimal_precision.q.out b/ql/src/test/results/clientpositive/decimal_precision.q.out
index 94c63cb9d2..f3f2cbc1a2 100644
--- a/ql/src/test/results/clientpositive/decimal_precision.q.out
+++ b/ql/src/test/results/clientpositive/decimal_precision.q.out
@@ -76,13 +76,13 @@ NULL
 NULL
 NULL
 NULL
-0.0000000000
-0.0000000000
-0.0000000000
-0.0000000000
 0
-0.1234567890
-0.1234567890
+0
+0
+0
+0
+0.123456789
+0.123456789
 1.2345678901
 1.2345678901
 1.2345678901
@@ -106,7 +106,7 @@ NULL
 123456789.0123456
 123456789.0123456789
 1234567890.123456
-1234567890.1234567890
+1234567890.123456789
 PREHOOK: query: SELECT dec, dec + 1, dec - 1 FROM DECIMAL_PRECISION ORDER BY dec
 PREHOOK: type: QUERY
 PREHOOK: Input: default@decimal_precision
@@ -159,13 +159,13 @@ NULL	NULL	NULL
 NULL	NULL	NULL
 NULL	NULL	NULL
 NULL	NULL	NULL
-0.0000000000	1.0000000000	-1.0000000000
-0.0000000000	1.0000000000	-1.0000000000
-0.0000000000	1.0000000000	-1.0000000000
-0.0000000000	1.0000000000	-1.0000000000
 0	1	-1
-0.1234567890	1.1234567890	-0.8765432110
-0.1234567890	1.1234567890	-0.8765432110
+0	1	-1
+0	1	-1
+0	1	-1
+0	1	-1
+0.123456789	1.123456789	-0.876543211
+0.123456789	1.123456789	-0.876543211
 1.2345678901	2.2345678901	0.2345678901
 1.2345678901	2.2345678901	0.2345678901
 1.2345678901	2.2345678901	0.2345678901
@@ -189,7 +189,7 @@ NULL	NULL	NULL
 123456789.0123456	123456790.0123456	123456788.0123456
 123456789.0123456789	123456790.0123456789	123456788.0123456789
 1234567890.123456	1234567891.123456	1234567889.123456
-1234567890.1234567890	1234567891.1234567890	1234567889.1234567890
+1234567890.123456789	1234567891.123456789	1234567889.123456789
 PREHOOK: query: SELECT dec, dec * 2, dec / 3  FROM DECIMAL_PRECISION ORDER BY dec
 PREHOOK: type: QUERY
 PREHOOK: Input: default@decimal_precision
@@ -242,13 +242,13 @@ NULL	NULL	NULL
 NULL	NULL	NULL
 NULL	NULL	NULL
 NULL	NULL	NULL
-0.0000000000	0.0000000000	0
-0.0000000000	0.0000000000	0
-0.0000000000	0.0000000000	0
-0.0000000000	0.0000000000	0
 0	0	0
-0.1234567890	0.2469135780	0.041152263
-0.1234567890	0.2469135780	0.041152263
+0	0	0
+0	0	0
+0	0	0
+0	0	0
+0.123456789	0.246913578	0.041152263
+0.123456789	0.246913578	0.041152263
 1.2345678901	2.4691357802	0.411522630033
 1.2345678901	2.4691357802	0.411522630033
 1.2345678901	2.4691357802	0.411522630033
@@ -258,9 +258,9 @@ NULL	NULL	NULL
 123.4567890123	246.9135780246	41.1522630041
 123.4567890123	246.9135780246	41.1522630041
 123.4567890123	246.9135780246	41.1522630041
-1234.5678901235	2469.1357802470	411.522630041167
-1234.5678901235	2469.1357802470	411.522630041167
-1234.5678901235	2469.1357802470	411.522630041167
+1234.5678901235	2469.135780247	411.522630041167
+1234.5678901235	2469.135780247	411.522630041167
+1234.5678901235	2469.135780247	411.522630041167
 12345.6789012346	24691.3578024692	4115.226300411533
 12345.6789012346	24691.3578024692	4115.226300411533
 123456.7890123456	246913.5780246912	41152.2630041152
@@ -272,7 +272,7 @@ NULL	NULL	NULL
 123456789.0123456	246913578.0246912	41152263.0041152
 123456789.0123456789	246913578.0246913578	41152263.0041152263
 1234567890.123456	2469135780.246912	411522630.041152
-1234567890.1234567890	2469135780.2469135780	411522630.041152263
+1234567890.123456789	2469135780.246913578	411522630.041152263
 PREHOOK: query: SELECT dec, dec / 9 FROM DECIMAL_PRECISION ORDER BY dec
 PREHOOK: type: QUERY
 PREHOOK: Input: default@decimal_precision
@@ -325,13 +325,13 @@ NULL	NULL
 NULL	NULL
 NULL	NULL
 NULL	NULL
-0.0000000000	0
-0.0000000000	0
-0.0000000000	0
-0.0000000000	0
 0	0
-0.1234567890	0.013717421
-0.1234567890	0.013717421
+0	0
+0	0
+0	0
+0	0
+0.123456789	0.013717421
+0.123456789	0.013717421
 1.2345678901	0.137174210011
 1.2345678901	0.137174210011
 1.2345678901	0.137174210011
@@ -355,7 +355,7 @@ NULL	NULL
 123456789.0123456	13717421.001371733333
 123456789.0123456789	13717421.0013717421
 1234567890.123456	137174210.013717333333
-1234567890.1234567890	137174210.013717421
+1234567890.123456789	137174210.013717421
 PREHOOK: query: SELECT dec, dec / 27 FROM DECIMAL_PRECISION ORDER BY dec
 PREHOOK: type: QUERY
 PREHOOK: Input: default@decimal_precision
@@ -408,13 +408,13 @@ NULL	NULL
 NULL	NULL
 NULL	NULL
 NULL	NULL
-0.0000000000	0
-0.0000000000	0
-0.0000000000	0
-0.0000000000	0
 0	0
-0.1234567890	0.0045724736667
-0.1234567890	0.0045724736667
+0	0
+0	0
+0	0
+0	0
+0.123456789	0.0045724736667
+0.123456789	0.0045724736667
 1.2345678901	0.0457247366704
 1.2345678901	0.0457247366704
 1.2345678901	0.0457247366704
@@ -438,7 +438,7 @@ NULL	NULL
 123456789.0123456	4572473.6671239111111
 123456789.0123456789	4572473.6671239140333
 1234567890.123456	45724736.6712391111111
-1234567890.1234567890	45724736.6712391403333
+1234567890.123456789	45724736.6712391403333
 PREHOOK: query: SELECT dec, dec * dec FROM DECIMAL_PRECISION ORDER BY dec
 PREHOOK: type: QUERY
 PREHOOK: Input: default@decimal_precision
@@ -491,13 +491,13 @@ NULL	NULL
 NULL	NULL
 NULL	NULL
 NULL	NULL
-0.0000000000	0.00000000000000000000
-0.0000000000	0.00000000000000000000
-0.0000000000	0.00000000000000000000
-0.0000000000	0.00000000000000000000
 0	0
-0.1234567890	0.01524157875019052100
-0.1234567890	0.01524157875019052100
+0	0
+0	0
+0	0
+0	0
+0.123456789	0.015241578750190521
+0.123456789	0.015241578750190521
 1.2345678901	1.52415787526596567801
 1.2345678901	1.52415787526596567801
 1.2345678901	1.52415787526596567801
@@ -521,7 +521,7 @@ NULL	NULL
 123456789.0123456	15241578753238817.26870921383936
 123456789.0123456789	15241578753238836.75019051998750190521
 1234567890.123456	NULL
-1234567890.1234567890	NULL
+1234567890.123456789	NULL
 PREHOOK: query: EXPLAIN SELECT avg(dec), sum(dec) FROM DECIMAL_PRECISION
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN SELECT avg(dec), sum(dec) FROM DECIMAL_PRECISION
diff --git a/ql/src/test/results/clientpositive/decimal_trailing.q.out b/ql/src/test/results/clientpositive/decimal_trailing.q.out
index c6991fd15b..6cfe282f1f 100644
--- a/ql/src/test/results/clientpositive/decimal_trailing.q.out
+++ b/ql/src/test/results/clientpositive/decimal_trailing.q.out
@@ -43,13 +43,13 @@ POSTHOOK: Input: default@decimal_trailing
 0	0	0
 1	0	0
 2	NULL	NULL
-3	1.0000	1.00000000
-4	10.0000	10.00000000
-5	100.0000	100.00000000
-6	1000.0000	1000.00000000
-7	10000.0000	10000.00000000
-8	100000.0000	100000.00000000
-9	NULL	1000000.00000000
+3	1	1
+4	10	10
+5	100	100
+6	1000	1000
+7	10000	10000
+8	100000	100000
+9	NULL	1000000
 10	NULL	NULL
 11	NULL	NULL
 12	NULL	NULL
@@ -58,18 +58,18 @@ POSTHOOK: Input: default@decimal_trailing
 15	NULL	NULL
 16	NULL	NULL
 17	NULL	NULL
-18	1.0000	1.00000000
-19	10.000	10.0000000
-20	100.00	100.000000
-21	1000.0	1000.00000
-22	100000	10000.0000
-23	0.0000	0.00000000
-24	0.000	0.0000000
-25	0.00	0.000000
-26	0.0	0.00000
-27	0	0.00000
-28	12313.2000	134134.31252500
-29	99999.9990	134134.31242553
+18	1	1
+19	10	10
+20	100	100
+21	1000	1000
+22	100000	10000
+23	0	0
+24	0	0
+25	0	0
+26	0	0
+27	0	0
+28	12313.2	134134.312525
+29	99999.999	134134.31242553
 PREHOOK: query: DROP TABLE DECIMAL_TRAILING
 PREHOOK: type: DROPTABLE
 PREHOOK: Input: default@decimal_trailing
diff --git a/ql/src/test/results/clientpositive/decimal_udf.q.out b/ql/src/test/results/clientpositive/decimal_udf.q.out
index 6bd876a5a2..1a303468cb 100644
--- a/ql/src/test/results/clientpositive/decimal_udf.q.out
+++ b/ql/src/test/results/clientpositive/decimal_udf.q.out
@@ -57,7 +57,7 @@ POSTHOOK: Input: default@decimal_udf
 #### A masked pattern was here ####
 -8800
 NULL
-0.0000000000
+0
 0
 200
 20
@@ -76,7 +76,7 @@ NULL
 -0.6
 -0.66
 -0.666
-2.0
+2
 4
 6.28
 -2.24
@@ -84,15 +84,15 @@ NULL
 -2.244
 2.24
 2.244
-248.00
+248
 250.4
 -2510.98
 6.28
 6.28
-6.280
-2.0000000000
--2469135780.2469135780
-2469135780.2469135600
+6.28
+2
+-2469135780.246913578
+2469135780.24691356
 PREHOOK: query: EXPLAIN SELECT key + value FROM DECIMAL_UDF
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN SELECT key + value FROM DECIMAL_UDF
@@ -124,7 +124,7 @@ POSTHOOK: Input: default@decimal_udf
 #### A masked pattern was here ####
 0
 NULL
-0.0000000000
+0
 0
 200
 20
@@ -143,7 +143,7 @@ NULL
 -0.3
 -0.33
 -0.333
-2.0
+2
 4
 6.14
 -2.12
@@ -151,15 +151,15 @@ NULL
 -12.122
 2.12
 2.122
-248.00
+248
 250.2
 -2510.49
 6.14
 6.14
-7.140
-2.0000000000
--2469135780.1234567890
-2469135780.1234567800
+7.14
+2
+-2469135780.123456789
+2469135780.12345678
 PREHOOK: query: EXPLAIN SELECT key + (value/2) FROM DECIMAL_UDF
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN SELECT key + (value/2) FROM DECIMAL_UDF
@@ -327,42 +327,42 @@ POSTHOOK: Input: default@decimal_udf
 #### A masked pattern was here ####
 0
 NULL
-0.0000000000
 0
 0
 0
 0
-0.0
-0.00
 0
 0
 0
 0
-0.0
-0.00
-0.0
-0.00
-0.000
-0.0
-0.00
-0.000
-0.0
 0
-0.00
-0.00
-0.00
-0.000
-0.00
-0.000
-0.00
-0.0
-0.00
-0.00
-0.00
-0.000
-0.0000000000
-0.0000000000
-0.0000000000
+0
+0
+0
+0
+0
+0
+0
+0
+0
+0
+0
+0
+0
+0
+0
+0
+0
+0
+0
+0
+0
+0
+0
+0
+0
+0
+0
 PREHOOK: query: EXPLAIN SELECT key - value FROM DECIMAL_UDF
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN SELECT key - value FROM DECIMAL_UDF
@@ -394,7 +394,7 @@ POSTHOOK: Input: default@decimal_udf
 #### A masked pattern was here ####
 -8800
 NULL
-0.0000000000
+0
 0
 0
 0
@@ -413,7 +413,7 @@ NULL
 -0.3
 -0.33
 -0.333
-0.0
+0
 0
 0.14
 -0.12
@@ -421,15 +421,15 @@ NULL
 9.878
 0.12
 0.122
-0.00
+0
 0.2
 -0.49
 0.14
 0.14
--0.860
-0.0000000000
--0.1234567890
-0.1234567800
+-0.86
+0
+-0.123456789
+0.12345678
 PREHOOK: query: EXPLAIN SELECT key - (value/2) FROM DECIMAL_UDF
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN SELECT key - (value/2) FROM DECIMAL_UDF
@@ -597,7 +597,7 @@ POSTHOOK: Input: default@decimal_udf
 #### A masked pattern was here ####
 19360000
 NULL
-0.00000000000000000000
+0
 0
 10000
 100
@@ -616,7 +616,7 @@ NULL
 0.09
 0.1089
 0.110889
-1.00
+1
 4
 9.8596
 1.2544
@@ -624,13 +624,13 @@ NULL
 1.258884
 1.2544
 1.258884
-15376.0000
+15376
 15675.04
 1576255.1401
 9.8596
 9.8596
-9.859600
-1.00000000000000000000
+9.8596
+1
 NULL
 NULL
 PREHOOK: query: EXPLAIN SELECT key, value FROM DECIMAL_UDF where key * value > 0
@@ -671,7 +671,7 @@ POSTHOOK: Input: default@decimal_udf
 200	200
 20	20
 2	2
-1.0	1
+1	1
 2	2
 3.14	3
 -1.12	-1
@@ -679,15 +679,15 @@ POSTHOOK: Input: default@decimal_udf
 -1.122	-11
 1.12	1
 1.122	1
-124.00	124
+124	124
 125.2	125
 -1255.49	-1255
 3.14	3
 3.14	3
-3.140	4
-1.0000000000	1
--1234567890.1234567890	-1234567890
-1234567890.1234567800	1234567890
+3.14	4
+1	1
+-1234567890.123456789	-1234567890
+1234567890.12345678	1234567890
 PREHOOK: query: EXPLAIN SELECT key * value FROM DECIMAL_UDF
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN SELECT key * value FROM DECIMAL_UDF
@@ -719,26 +719,26 @@ POSTHOOK: Input: default@decimal_udf
 #### A masked pattern was here ####
 -19360000
 NULL
-0.0000000000
+0
 0
 10000
 100
 1
-0.0
-0.00
+0
+0
 40000
 400
 4
 0
-0.0
-0.00
-0.0
-0.00
-0.000
-0.0
-0.00
-0.000
-1.0
+0
+0
+0
+0
+0
+0
+0
+0
+1
 4
 9.42
 1.12
@@ -746,15 +746,15 @@ NULL
 12.342
 1.12
 1.122
-15376.00
-15650.0
+15376
+15650
 1575639.95
 9.42
 9.42
-12.560
-1.0000000000
-1524157875171467887.5019052100
-1524157875171467876.3907942000
+12.56
+1
+1524157875171467887.50190521
+1524157875171467876.3907942
 PREHOOK: query: EXPLAIN SELECT key * (value/2) FROM DECIMAL_UDF
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN SELECT key * (value/2) FROM DECIMAL_UDF
@@ -1078,7 +1078,7 @@ POSTHOOK: Input: default@decimal_udf
 0.785
 1
 1.0000000001
-1.000000000099999992710
+1.00000000009999999271
 PREHOOK: query: EXPLAIN SELECT key / (value/2) FROM DECIMAL_UDF  WHERE value is not null and value <> 0
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN SELECT key / (value/2) FROM DECIMAL_UDF  WHERE value is not null and value <> 0
@@ -1235,7 +1235,7 @@ POSTHOOK: Input: default@decimal_udf
 #### A masked pattern was here ####
 4400
 NULL
-0.0000000000
+0
 0
 100
 10
@@ -1254,7 +1254,7 @@ NULL
 0.3
 0.33
 0.333
-1.0
+1
 2
 3.14
 1.12
@@ -1262,15 +1262,15 @@ NULL
 1.122
 1.12
 1.122
-124.00
+124
 125.2
 1255.49
 3.14
 3.14
-3.140
-1.0000000000
-1234567890.1234567890
-1234567890.1234567800
+3.14
+1
+1234567890.123456789
+1234567890.12345678
 PREHOOK: query: -- avg
 EXPLAIN SELECT value, sum(key) / count(key), avg(key), sum(key) FROM DECIMAL_UDF GROUP BY value ORDER BY value
 PREHOOK: type: QUERY
@@ -1359,23 +1359,23 @@ POSTHOOK: query: SELECT value, sum(key) / count(key), avg(key), sum(key) FROM DE
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@decimal_udf
 #### A masked pattern was here ####
--1234567890	-1234567890.123456789	-1234567890.123456789	-1234567890.1234567890
+-1234567890	-1234567890.123456789	-1234567890.123456789	-1234567890.123456789
 -1255	-1255.49	-1255.49	-1255.49
 -11	-1.122	-1.122	-1.122
 -1	-1.12	-1.12	-2.24
-0	0.02538461538461538461538	0.02538461538462	0.3300000000
-1	1.0484	1.0484	5.2420000000
+0	0.02538461538461538461538	0.02538461538462	0.33
+1	1.0484	1.0484	5.242
 2	2	2	4
 3	3.14	3.14	9.42
-4	3.14	3.14	3.140
+4	3.14	3.14	3.14
 10	10	10	10
 20	20	20	20
 100	100	100	100
-124	124	124	124.00
+124	124	124	124
 125	125.2	125.2	125.2
 200	200	200	200
 4400	-4400	-4400	-4400
-1234567890	1234567890.12345678	1234567890.12345678	1234567890.1234567800
+1234567890	1234567890.12345678	1234567890.12345678	1234567890.12345678
 PREHOOK: query: -- negative
 EXPLAIN SELECT -key FROM DECIMAL_UDF
 PREHOOK: type: QUERY
@@ -1409,7 +1409,7 @@ POSTHOOK: Input: default@decimal_udf
 #### A masked pattern was here ####
 4400
 NULL
-0.0000000000
+0
 0
 -100
 -10
@@ -1428,7 +1428,7 @@ NULL
 0.3
 0.33
 0.333
--1.0
+-1
 -2
 -3.14
 1.12
@@ -1436,15 +1436,15 @@ NULL
 1.122
 -1.12
 -1.122
--124.00
+-124
 -125.2
 1255.49
 -3.14
 -3.14
--3.140
--1.0000000000
-1234567890.1234567890
--1234567890.1234567800
+-3.14
+-1
+1234567890.123456789
+-1234567890.12345678
 PREHOOK: query: -- positive
 EXPLAIN SELECT +key FROM DECIMAL_UDF
 PREHOOK: type: QUERY
@@ -1478,7 +1478,7 @@ POSTHOOK: Input: default@decimal_udf
 #### A masked pattern was here ####
 -4400
 NULL
-0.0000000000
+0
 0
 100
 10
@@ -1497,7 +1497,7 @@ NULL
 -0.3
 -0.33
 -0.333
-1.0
+1
 2
 3.14
 -1.12
@@ -1505,15 +1505,15 @@ NULL
 -1.122
 1.12
 1.122
-124.00
+124
 125.2
 -1255.49
 3.14
 3.14
-3.140
-1.0000000000
--1234567890.1234567890
-1234567890.1234567800
+3.14
+1
+-1234567890.123456789
+1234567890.12345678
 PREHOOK: query: -- ceiling
 EXPlAIN SELECT CEIL(key) FROM DECIMAL_UDF
 PREHOOK: type: QUERY
@@ -1683,42 +1683,42 @@ POSTHOOK: query: SELECT ROUND(key, 2) FROM DECIMAL_UDF
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@decimal_udf
 #### A masked pattern was here ####
--4400.00
+-4400
 NULL
-0.00
-0.00
-100.00
-10.00
-1.00
-0.10
+0
+0
+100
+10
+1
+0.1
 0.01
-200.00
-20.00
-2.00
-0.00
-0.20
+200
+20
+2
+0
+0.2
 0.02
-0.30
+0.3
 0.33
 0.33
--0.30
+-0.3
 -0.33
 -0.33
-1.00
-2.00
+1
+2
 3.14
 -1.12
 -1.12
 -1.12
 1.12
 1.12
-124.00
-125.20
+124
+125.2
 -1255.49
 3.14
 3.14
 3.14
-1.00
+1
 -1234567890.12
 1234567890.12
 PREHOOK: query: -- power
@@ -1827,38 +1827,38 @@ NULL
 NULL
 1
 1
-0.0
-0.00
-0.000
+0
+0
+0
 1
 1
 0
 NULL
-0.0
-0.00
-0.10
-0.010
-0.0010
-0.10
-0.010
-0.0010
-0.0
 0
-1.00
+0
+0.1
+0.01
+0.001
+0.1
+0.01
+0.001
+0
+0
+1
 -0.12
 -0.12
 -0.122
 0.44
 0.439
-1.00
-1.0
+1
+1
 -626.745
-1.00
-1.00
-1.000
-0.0000000000
+1
+1
+1
+0
 -617283944.0617283945
-1.0000000000
+1
 PREHOOK: query: -- stddev, var
 EXPLAIN SELECT value, stddev(key), variance(key) FROM DECIMAL_UDF GROUP BY value
 PREHOOK: type: QUERY
@@ -2150,7 +2150,7 @@ POSTHOOK: query: SELECT MIN(key) FROM DECIMAL_UDF
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@decimal_udf
 #### A masked pattern was here ####
--1234567890.1234567890
+-1234567890.123456789
 PREHOOK: query: -- max
 EXPLAIN SELECT MAX(key) FROM DECIMAL_UDF
 PREHOOK: type: QUERY
@@ -2213,7 +2213,7 @@ POSTHOOK: query: SELECT MAX(key) FROM DECIMAL_UDF
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@decimal_udf
 #### A masked pattern was here ####
-1234567890.1234567800
+1234567890.12345678
 PREHOOK: query: -- count
 EXPLAIN SELECT COUNT(key) FROM DECIMAL_UDF
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/orc_predicate_pushdown.q.out b/ql/src/test/results/clientpositive/orc_predicate_pushdown.q.out
index 359d4ac3c2..9a7b2b7c8d 100644
--- a/ql/src/test/results/clientpositive/orc_predicate_pushdown.q.out
+++ b/ql/src/test/results/clientpositive/orc_predicate_pushdown.q.out
@@ -259,7 +259,7 @@ POSTHOOK: query: SELECT * FROM orc_pred WHERE t>2 limit 1
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@orc_pred
 #### A masked pattern was here ####
-124	336	65664	4294967435	74.72	42.47	true	bob davidson	2013-03-01 09:11:58.703302	45.40	yard duty
+124	336	65664	4294967435	74.72	42.47	true	bob davidson	2013-03-01 09:11:58.703302	45.4	yard duty
 PREHOOK: query: SELECT * FROM orc_pred WHERE t>2 limit 1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@orc_pred
@@ -268,7 +268,7 @@ POSTHOOK: query: SELECT * FROM orc_pred WHERE t>2 limit 1
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@orc_pred
 #### A masked pattern was here ####
-124	336	65664	4294967435	74.72	42.47	true	bob davidson	2013-03-01 09:11:58.703302	45.40	yard duty
+124	336	65664	4294967435	74.72	42.47	true	bob davidson	2013-03-01 09:11:58.703302	45.4	yard duty
 PREHOOK: query: SELECT SUM(HASH(t)) FROM orc_pred
   WHERE t IS NOT NULL
   AND t < 0
diff --git a/ql/src/test/results/clientpositive/parquet_decimal.q.out b/ql/src/test/results/clientpositive/parquet_decimal.q.out
index 5767c57d10..cd87b925e1 100644
--- a/ql/src/test/results/clientpositive/parquet_decimal.q.out
+++ b/ql/src/test/results/clientpositive/parquet_decimal.q.out
@@ -63,9 +63,9 @@ Mary	4.33
 Cluck	5.96
 Tom	-12.25
 Mary	33.33
-Tom	19.00
-Beck	0.00
-Beck	79.90
+Tom	19
+Beck	0
+Beck	79.9
 PREHOOK: query: TRUNCATE TABLE parq_dec
 PREHOOK: type: TRUNCATETABLE
 PREHOOK: Output: default@parq_dec
@@ -140,12 +140,12 @@ POSTHOOK: Input: default@parq_dec1
 77.3
 55.7
 4.3
-6.0
+6
 12.3
 33.3
 0.2
 3.2
-8.0
+8
 PREHOOK: query: DROP TABLE dec
 PREHOOK: type: DROPTABLE
 PREHOOK: Input: default@dec
diff --git a/ql/src/test/results/clientpositive/parquet_decimal1.q.out b/ql/src/test/results/clientpositive/parquet_decimal1.q.out
index 0f71b1efb2..bd146f89bd 100644
--- a/ql/src/test/results/clientpositive/parquet_decimal1.q.out
+++ b/ql/src/test/results/clientpositive/parquet_decimal1.q.out
@@ -28,7 +28,7 @@ POSTHOOK: query: SELECT * FROM dec_comp
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@dec_comp
 #### A masked pattern was here ####
-[3.14,6.28,7.30]	{"k1":92.77,"k2":29.39}	{"i":5,"d":9.03}
+[3.14,6.28,7.3]	{"k1":92.77,"k2":29.39}	{"i":5,"d":9.03}
 [12.4,1.33,0.34]	{"k2":2.79,"k4":29.09}	{"i":11,"d":0.03}
 PREHOOK: query: DROP TABLE IF EXISTS parq_dec_comp
 PREHOOK: type: DROPTABLE
@@ -72,8 +72,8 @@ POSTHOOK: query: SELECT * FROM parq_dec_comp
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@parq_dec_comp
 #### A masked pattern was here ####
-[3.14,6.28,7.30]	{"k2":29.39,"k1":92.77}	{"i":5,"d":9.03}
-[12.40,1.33,0.34]	{"k4":29.09,"k2":2.79}	{"i":11,"d":0.03}
+[3.14,6.28,7.3]	{"k2":29.39,"k1":92.77}	{"i":5,"d":9.03}
+[12.4,1.33,0.34]	{"k4":29.09,"k2":2.79}	{"i":11,"d":0.03}
 PREHOOK: query: DROP TABLE dec_comp
 PREHOOK: type: DROPTABLE
 PREHOOK: Input: default@dec_comp
diff --git a/ql/src/test/results/clientpositive/serde_regex.q.out b/ql/src/test/results/clientpositive/serde_regex.q.out
index 65eef4f212..19187ba542 100644
--- a/ql/src/test/results/clientpositive/serde_regex.q.out
+++ b/ql/src/test/results/clientpositive/serde_regex.q.out
@@ -201,7 +201,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@serde_regex1
 #### A masked pattern was here ####
 NULL	0
--1234567890.1234567890	-1234567890
+-1234567890.123456789	-1234567890
 -4400	4400
 -1255.49	-1255
 -1.122	-11
@@ -210,7 +210,7 @@ NULL	0
 -0.333	0
 -0.33	0
 -0.3	0
-0.000000000000000000	0
+0	0
 0	0
 0	0
 0.01	0
@@ -221,8 +221,8 @@ NULL	0
 0.33	0
 0.333	0
 1	1
-1.0	1
-1.000000000000000000	1
+1	1
+1	1
 1.12	1
 1.122	1
 2	2
@@ -230,14 +230,14 @@ NULL	0
 3.14	3
 3.14	3
 3.14	3
-3.140	4
+3.14	4
 10	10
 20	20
 100	100
-124.00	124
+124	124
 125.2	125
 200	200
-1234567890.1234567800	1234567890
+1234567890.12345678	1234567890
 PREHOOK: query: DROP TABLE serde_regex1
 PREHOOK: type: DROPTABLE
 PREHOOK: Input: default@serde_regex1
diff --git a/ql/src/test/results/clientpositive/tez/mapjoin_decimal.q.out b/ql/src/test/results/clientpositive/tez/mapjoin_decimal.q.out
index a2f677d29c..bffcd2380a 100644
--- a/ql/src/test/results/clientpositive/tez/mapjoin_decimal.q.out
+++ b/ql/src/test/results/clientpositive/tez/mapjoin_decimal.q.out
@@ -151,112 +151,112 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@t1
 POSTHOOK: Input: default@t2
 #### A masked pattern was here ####
-9.00	9
-9.00	9
-9.00	9
-9.00	9
-9.00	9
-9.00	9
-9.00	9
-9.00	9
-9.00	9
-9.00	9
-9.00	9
-9.00	9
-9.00	9
-9.00	9
-9.00	9
-9.00	9
-9.00	9
-9.00	9
-9.00	9
-9.00	9
-9.00	9
-45.00	45
-45.00	45
-45.00	45
-45.00	45
-45.00	45
-79.00	79
-79.00	79
-79.00	79
-79.00	79
-79.00	79
-79.00	79
-17.00	17
-17.00	17
-17.00	17
-17.00	17
-17.00	17
-17.00	17
-17.00	17
-17.00	17
-17.00	17
-17.00	17
-6.00	6
-6.00	6
-6.00	6
-6.00	6
-6.00	6
-6.00	6
-62.00	62
-62.00	62
-62.00	62
-62.00	62
-62.00	62
-62.00	62
-62.00	62
-62.00	62
-62.00	62
-62.00	62
-62.00	62
-62.00	62
-64.00	64
-64.00	64
-64.00	64
-64.00	64
-64.00	64
-64.00	64
-64.00	64
-64.00	64
-64.00	64
-64.00	64
-64.00	64
-64.00	64
-64.00	64
-64.00	64
-64.00	64
-64.00	64
-64.00	64
-64.00	64
-89.00	89
-89.00	89
-89.00	89
-89.00	89
-89.00	89
-89.00	89
-89.00	89
-89.00	89
-89.00	89
-89.00	89
-89.00	89
-89.00	89
-70.00	70
-70.00	70
-70.00	70
-70.00	70
-70.00	70
-70.00	70
-70.00	70
-14.00	14
-14.00	14
-14.00	14
-14.00	14
-14.00	14
-14.00	14
-14.00	14
-14.00	14
-14.00	14
+9	9
+9	9
+9	9
+9	9
+9	9
+9	9
+9	9
+9	9
+9	9
+9	9
+9	9
+9	9
+9	9
+9	9
+9	9
+9	9
+9	9
+9	9
+9	9
+9	9
+9	9
+45	45
+45	45
+45	45
+45	45
+45	45
+79	79
+79	79
+79	79
+79	79
+79	79
+79	79
+17	17
+17	17
+17	17
+17	17
+17	17
+17	17
+17	17
+17	17
+17	17
+17	17
+6	6
+6	6
+6	6
+6	6
+6	6
+6	6
+62	62
+62	62
+62	62
+62	62
+62	62
+62	62
+62	62
+62	62
+62	62
+62	62
+62	62
+62	62
+64	64
+64	64
+64	64
+64	64
+64	64
+64	64
+64	64
+64	64
+64	64
+64	64
+64	64
+64	64
+64	64
+64	64
+64	64
+64	64
+64	64
+64	64
+89	89
+89	89
+89	89
+89	89
+89	89
+89	89
+89	89
+89	89
+89	89
+89	89
+89	89
+89	89
+70	70
+70	70
+70	70
+70	70
+70	70
+70	70
+70	70
+14	14
+14	14
+14	14
+14	14
+14	14
+14	14
+14	14
+14	14
+14	14
 PREHOOK: query: select t1.dec, t2.dec from t1 join t2 on (t1.dec=t2.dec)
 PREHOOK: type: QUERY
 PREHOOK: Input: default@t1
@@ -267,112 +267,112 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@t1
 POSTHOOK: Input: default@t2
 #### A masked pattern was here ####
-9.00	9
-9.00	9
-9.00	9
-9.00	9
-9.00	9
-9.00	9
-9.00	9
-9.00	9
-9.00	9
-9.00	9
-9.00	9
-9.00	9
-9.00	9
-9.00	9
-9.00	9
-9.00	9
-9.00	9
-9.00	9
-9.00	9
-9.00	9
-9.00	9
-45.00	45
-45.00	45
-45.00	45
-45.00	45
-45.00	45
-79.00	79
-79.00	79
-79.00	79
-79.00	79
-79.00	79
-79.00	79
-17.00	17
-17.00	17
-17.00	17
-17.00	17
-17.00	17
-17.00	17
-17.00	17
-17.00	17
-17.00	17
-17.00	17
-6.00	6
-6.00	6
-6.00	6
-6.00	6
-6.00	6
-6.00	6
-62.00	62
-62.00	62
-62.00	62
-62.00	62
-62.00	62
-62.00	62
-62.00	62
-62.00	62
-62.00	62
-62.00	62
-62.00	62
-62.00	62
-64.00	64
-64.00	64
-64.00	64
-64.00	64
-64.00	64
-64.00	64
-64.00	64
-64.00	64
-64.00	64
-64.00	64
-64.00	64
-64.00	64
-64.00	64
-64.00	64
-64.00	64
-64.00	64
-64.00	64
-64.00	64
-89.00	89
-89.00	89
-89.00	89
-89.00	89
-89.00	89
-89.00	89
-89.00	89
-89.00	89
-89.00	89
-89.00	89
-89.00	89
-89.00	89
-70.00	70
-70.00	70
-70.00	70
-70.00	70
-70.00	70
-70.00	70
-70.00	70
-14.00	14
-14.00	14
-14.00	14
-14.00	14
-14.00	14
-14.00	14
-14.00	14
-14.00	14
-14.00	14
+9	9
+9	9
+9	9
+9	9
+9	9
+9	9
+9	9
+9	9
+9	9
+9	9
+9	9
+9	9
+9	9
+9	9
+9	9
+9	9
+9	9
+9	9
+9	9
+9	9
+9	9
+45	45
+45	45
+45	45
+45	45
+45	45
+79	79
+79	79
+79	79
+79	79
+79	79
+79	79
+17	17
+17	17
+17	17
+17	17
+17	17
+17	17
+17	17
+17	17
+17	17
+17	17
+6	6
+6	6
+6	6
+6	6
+6	6
+6	6
+62	62
+62	62
+62	62
+62	62
+62	62
+62	62
+62	62
+62	62
+62	62
+62	62
+62	62
+62	62
+64	64
+64	64
+64	64
+64	64
+64	64
+64	64
+64	64
+64	64
+64	64
+64	64
+64	64
+64	64
+64	64
+64	64
+64	64
+64	64
+64	64
+64	64
+89	89
+89	89
+89	89
+89	89
+89	89
+89	89
+89	89
+89	89
+89	89
+89	89
+89	89
+89	89
+70	70
+70	70
+70	70
+70	70
+70	70
+70	70
+70	70
+14	14
+14	14
+14	14
+14	14
+14	14
+14	14
+14	14
+14	14
+14	14
 PREHOOK: query: select t1.dec, t2.dec from t1 join t2 on (t1.dec=t2.dec)
 PREHOOK: type: QUERY
 PREHOOK: Input: default@t1
@@ -383,109 +383,109 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@t1
 POSTHOOK: Input: default@t2
 #### A masked pattern was here ####
-9.00	9
-9.00	9
-9.00	9
-9.00	9
-9.00	9
-9.00	9
-9.00	9
-9.00	9
-9.00	9
-9.00	9
-9.00	9
-9.00	9
-9.00	9
-9.00	9
-9.00	9
-9.00	9
-9.00	9
-9.00	9
-9.00	9
-9.00	9
-9.00	9
-45.00	45
-45.00	45
-45.00	45
-45.00	45
-45.00	45
-79.00	79
-79.00	79
-79.00	79
-79.00	79
-79.00	79
-79.00	79
-17.00	17
-17.00	17
-17.00	17
-17.00	17
-17.00	17
-17.00	17
-17.00	17
-17.00	17
-17.00	17
-17.00	17
-6.00	6
-6.00	6
-6.00	6
-6.00	6
-6.00	6
-6.00	6
-62.00	62
-62.00	62
-62.00	62
-62.00	62
-62.00	62
-62.00	62
-62.00	62
-62.00	62
-62.00	62
-62.00	62
-62.00	62
-62.00	62
-64.00	64
-64.00	64
-64.00	64
-64.00	64
-64.00	64
-64.00	64
-64.00	64
-64.00	64
-64.00	64
-64.00	64
-64.00	64
-64.00	64
-64.00	64
-64.00	64
-64.00	64
-64.00	64
-64.00	64
-64.00	64
-89.00	89
-89.00	89
-89.00	89
-89.00	89
-89.00	89
-89.00	89
-89.00	89
-89.00	89
-89.00	89
-89.00	89
-89.00	89
-89.00	89
-70.00	70
-70.00	70
-70.00	70
-70.00	70
-70.00	70
-70.00	70
-70.00	70
-14.00	14
-14.00	14
-14.00	14
-14.00	14
-14.00	14
-14.00	14
-14.00	14
-14.00	14
-14.00	14
+9	9
+9	9
+9	9
+9	9
+9	9
+9	9
+9	9
+9	9
+9	9
+9	9
+9	9
+9	9
+9	9
+9	9
+9	9
+9	9
+9	9
+9	9
+9	9
+9	9
+9	9
+45	45
+45	45
+45	45
+45	45
+45	45
+79	79
+79	79
+79	79
+79	79
+79	79
+79	79
+17	17
+17	17
+17	17
+17	17
+17	17
+17	17
+17	17
+17	17
+17	17
+17	17
+6	6
+6	6
+6	6
+6	6
+6	6
+6	6
+62	62
+62	62
+62	62
+62	62
+62	62
+62	62
+62	62
+62	62
+62	62
+62	62
+62	62
+62	62
+64	64
+64	64
+64	64
+64	64
+64	64
+64	64
+64	64
+64	64
+64	64
+64	64
+64	64
+64	64
+64	64
+64	64
+64	64
+64	64
+64	64
+64	64
+89	89
+89	89
+89	89
+89	89
+89	89
+89	89
+89	89
+89	89
+89	89
+89	89
+89	89
+89	89
+70	70
+70	70
+70	70
+70	70
+70	70
+70	70
+70	70
+14	14
+14	14
+14	14
+14	14
+14	14
+14	14
+14	14
+14	14
+14	14
diff --git a/ql/src/test/results/clientpositive/tez/update_all_types.q.out b/ql/src/test/results/clientpositive/tez/update_all_types.q.out
index f1353d068a..eba4dde4cf 100644
--- a/ql/src/test/results/clientpositive/tez/update_all_types.q.out
+++ b/ql/src/test/results/clientpositive/tez/update_all_types.q.out
@@ -87,16 +87,16 @@ POSTHOOK: query: select * from acid_uat order by i
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@acid_uat
 #### A masked pattern was here ####
-11	NULL	-1073279343	-1595604468	11.0	NULL	11.0	1969-12-31 16:00:02.351	NULL	oj1YrV5Wa	oj1YrV5Wa	P76636jJ6qM17d7DIy                  	true
+11	NULL	-1073279343	-1595604468	11.0	NULL	11	1969-12-31 16:00:02.351	NULL	oj1YrV5Wa	oj1YrV5Wa	P76636jJ6qM17d7DIy                  	true
 NULL	-7382	-1073051226	-1887561756	NULL	-7382.0	NULL	NULL	1970-01-01	A34p7oRr2WvUJNf	A34p7oRr2WvUJNf	4hA4KQj2vD3fI6gX82220d              	false
-11	NULL	-1072910839	2048385991	11.0	NULL	11.0	1969-12-31 16:00:02.351	NULL	0iqrc5	0iqrc5	KbaDXiN85adbHRx58v                  	false
+11	NULL	-1072910839	2048385991	11.0	NULL	11	1969-12-31 16:00:02.351	NULL	0iqrc5	0iqrc5	KbaDXiN85adbHRx58v                  	false
 NULL	8373	-1072081801	1864027286	NULL	8373.0	NULL	NULL	1970-01-01	dPkN74F7	dPkN74F7	4KWs6gw7lv2WYd66P                   	true
 NULL	-5470	-1072076362	1864027286	NULL	-5470.0	NULL	NULL	1970-01-01	2uLyD28144vklju213J1mr	2uLyD28144vklju213J1mr	4KWs6gw7lv2WYd66P                   	true
--51	NULL	-1071480828	-1401575336	-51.0	NULL	-51.0	1969-12-31 16:00:08.451	NULL	aw724t8c5558x2xneC624	aw724t8c5558x2xneC624	4uE7l74tESBiKfu7c8wM7GA             	true
-8	NULL	-1071363017	1349676361	8.0	NULL	8.0	1969-12-31 16:00:15.892	NULL	Anj0oF	Anj0oF	IwE1G7Qb0B1NEfV030g                 	true
+-51	NULL	-1071480828	-1401575336	-51.0	NULL	-51	1969-12-31 16:00:08.451	NULL	aw724t8c5558x2xneC624	aw724t8c5558x2xneC624	4uE7l74tESBiKfu7c8wM7GA             	true
+8	NULL	-1071363017	1349676361	8.0	NULL	8	1969-12-31 16:00:15.892	NULL	Anj0oF	Anj0oF	IwE1G7Qb0B1NEfV030g                 	true
 NULL	-741	-1070883071	-1645852809	NULL	-741.0	NULL	NULL	1970-01-01	0ruyd6Y50JpdGRf6HqD	0ruyd6Y50JpdGRf6HqD	xH7445Rals48VOulSyR5F               	false
 NULL	-947	-1070551679	1864027286	NULL	-947.0	NULL	NULL	1970-01-01	iUR3Q	iUR3Q	4KWs6gw7lv2WYd66P                   	false
-11	NULL	-1069736047	-453772520	11.0	NULL	11.0	1969-12-31 16:00:02.351	NULL	k17Am8uPHWk02cEf1jet	k17Am8uPHWk02cEf1jet	qrXLLNX1                            	true
+11	NULL	-1069736047	-453772520	11.0	NULL	11	1969-12-31 16:00:02.351	NULL	k17Am8uPHWk02cEf1jet	k17Am8uPHWk02cEf1jet	qrXLLNX1                            	true
 PREHOOK: query: update acid_uat set
     ti = 1,
     si = 2,
@@ -141,15 +141,15 @@ POSTHOOK: query: select * from acid_uat order by i
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@acid_uat
 #### A masked pattern was here ####
-11	NULL	-1073279343	-1595604468	11.0	NULL	11.0	1969-12-31 16:00:02.351	NULL	oj1YrV5Wa	oj1YrV5Wa	P76636jJ6qM17d7DIy                  	true
+11	NULL	-1073279343	-1595604468	11.0	NULL	11	1969-12-31 16:00:02.351	NULL	oj1YrV5Wa	oj1YrV5Wa	P76636jJ6qM17d7DIy                  	true
 NULL	-7382	-1073051226	-1887561756	NULL	-7382.0	NULL	NULL	1970-01-01	A34p7oRr2WvUJNf	A34p7oRr2WvUJNf	4hA4KQj2vD3fI6gX82220d              	false
-11	NULL	-1072910839	2048385991	11.0	NULL	11.0	1969-12-31 16:00:02.351	NULL	0iqrc5	0iqrc5	KbaDXiN85adbHRx58v                  	false
+11	NULL	-1072910839	2048385991	11.0	NULL	11	1969-12-31 16:00:02.351	NULL	0iqrc5	0iqrc5	KbaDXiN85adbHRx58v                  	false
 NULL	8373	-1072081801	1864027286	NULL	8373.0	NULL	NULL	1970-01-01	dPkN74F7	dPkN74F7	4KWs6gw7lv2WYd66P                   	true
 NULL	-5470	-1072076362	1864027286	NULL	-5470.0	NULL	NULL	1970-01-01	2uLyD28144vklju213J1mr	2uLyD28144vklju213J1mr	4KWs6gw7lv2WYd66P                   	true
--51	NULL	-1071480828	-1401575336	-51.0	NULL	-51.0	1969-12-31 16:00:08.451	NULL	aw724t8c5558x2xneC624	aw724t8c5558x2xneC624	4uE7l74tESBiKfu7c8wM7GA             	true
-8	NULL	-1071363017	1349676361	8.0	NULL	8.0	1969-12-31 16:00:15.892	NULL	Anj0oF	Anj0oF	IwE1G7Qb0B1NEfV030g                 	true
+-51	NULL	-1071480828	-1401575336	-51.0	NULL	-51	1969-12-31 16:00:08.451	NULL	aw724t8c5558x2xneC624	aw724t8c5558x2xneC624	4uE7l74tESBiKfu7c8wM7GA             	true
+8	NULL	-1071363017	1349676361	8.0	NULL	8	1969-12-31 16:00:15.892	NULL	Anj0oF	Anj0oF	IwE1G7Qb0B1NEfV030g                 	true
 NULL	-947	-1070551679	1864027286	NULL	-947.0	NULL	NULL	1970-01-01	iUR3Q	iUR3Q	4KWs6gw7lv2WYd66P                   	false
-11	NULL	-1069736047	-453772520	11.0	NULL	11.0	1969-12-31 16:00:02.351	NULL	k17Am8uPHWk02cEf1jet	k17Am8uPHWk02cEf1jet	qrXLLNX1                            	true
+11	NULL	-1069736047	-453772520	11.0	NULL	11	1969-12-31 16:00:02.351	NULL	k17Am8uPHWk02cEf1jet	k17Am8uPHWk02cEf1jet	qrXLLNX1                            	true
 1	2	3	4	3.14	6.28	5.99	NULL	2014-09-01	its a beautiful day in the neighbhorhood	a beautiful day for a neighbor	wont you be mine                    	true
 PREHOOK: query: update acid_uat set
   ti = ti * 2,
@@ -175,13 +175,13 @@ POSTHOOK: query: select * from acid_uat order by i
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@acid_uat
 #### A masked pattern was here ####
-11	NULL	-1073279343	-1595604468	11.0	NULL	11.0	1969-12-31 16:00:02.351	NULL	oj1YrV5Wa	oj1YrV5Wa	P76636jJ6qM17d7DIy                  	true
+11	NULL	-1073279343	-1595604468	11.0	NULL	11	1969-12-31 16:00:02.351	NULL	oj1YrV5Wa	oj1YrV5Wa	P76636jJ6qM17d7DIy                  	true
 NULL	-7382	-1073051226	-1887561756	NULL	-7382.0	NULL	NULL	1970-01-01	A34p7oRr2WvUJNf	A34p7oRr2WvUJNf	4hA4KQj2vD3fI6gX82220d              	false
-11	NULL	-1072910839	2048385991	11.0	NULL	11.0	1969-12-31 16:00:02.351	NULL	0iqrc5	0iqrc5	KbaDXiN85adbHRx58v                  	false
+11	NULL	-1072910839	2048385991	11.0	NULL	11	1969-12-31 16:00:02.351	NULL	0iqrc5	0iqrc5	KbaDXiN85adbHRx58v                  	false
 NULL	8373	-1072081801	1864027286	NULL	8373.0	NULL	NULL	1970-01-01	dPkN74F7	dPkN74F7	4KWs6gw7lv2WYd66P                   	true
 NULL	-5470	-1072076362	1864027286	NULL	-5470.0	NULL	NULL	1970-01-01	2uLyD28144vklju213J1mr	2uLyD28144vklju213J1mr	4KWs6gw7lv2WYd66P                   	true
--102	-51	-1071480828	-1401575336	-51.0	-51.0	-51.0	1969-12-31 16:00:08.451	NULL	aw724t8c5558x2xneC624	aw724t8c5558x2xneC624	4uE7l74tESBiKfu7c8wM7GA             	true
-8	NULL	-1071363017	1349676361	8.0	NULL	8.0	1969-12-31 16:00:15.892	NULL	Anj0oF	Anj0oF	IwE1G7Qb0B1NEfV030g                 	true
+-102	-51	-1071480828	-1401575336	-51.0	-51.0	-51	1969-12-31 16:00:08.451	NULL	aw724t8c5558x2xneC624	aw724t8c5558x2xneC624	4uE7l74tESBiKfu7c8wM7GA             	true
+8	NULL	-1071363017	1349676361	8.0	NULL	8	1969-12-31 16:00:15.892	NULL	Anj0oF	Anj0oF	IwE1G7Qb0B1NEfV030g                 	true
 NULL	-947	-1070551679	1864027286	NULL	-947.0	NULL	NULL	1970-01-01	iUR3Q	iUR3Q	4KWs6gw7lv2WYd66P                   	false
-11	NULL	-1069736047	-453772520	11.0	NULL	11.0	1969-12-31 16:00:02.351	NULL	k17Am8uPHWk02cEf1jet	k17Am8uPHWk02cEf1jet	qrXLLNX1                            	true
+11	NULL	-1069736047	-453772520	11.0	NULL	11	1969-12-31 16:00:02.351	NULL	k17Am8uPHWk02cEf1jet	k17Am8uPHWk02cEf1jet	qrXLLNX1                            	true
 1	2	3	4	3.14	6.28	5.99	NULL	2014-09-01	its a beautiful day in the neighbhorhood	a beautiful day for a neighbor	wont you be mine                    	true
diff --git a/ql/src/test/results/clientpositive/tez/vector_between_in.q.out b/ql/src/test/results/clientpositive/tez/vector_between_in.q.out
index ad8c4c0eb2..bf979001ef 100644
--- a/ql/src/test/results/clientpositive/tez/vector_between_in.q.out
+++ b/ql/src/test/results/clientpositive/tez/vector_between_in.q.out
@@ -699,19 +699,19 @@ POSTHOOK: Input: default@decimal_date_test
 -18.5162162162
 -17.3216216216
 -16.7243243243
--16.1270270270
+-16.127027027
 -15.5297297297
 -10.7513513514
 -9.5567567568
 -8.3621621622
--5.9729729730
+-5.972972973
 -3.5837837838
 4.1810810811
 4.7783783784
 4.7783783784
 5.3756756757
-5.9729729730
-5.9729729730
+5.972972973
+5.972972973
 11.3486486486
 11.3486486486
 11.9459459459
diff --git a/ql/src/test/results/clientpositive/tez/vector_data_types.q.out b/ql/src/test/results/clientpositive/tez/vector_data_types.q.out
index 3f38a45170..eca2cbc554 100644
--- a/ql/src/test/results/clientpositive/tez/vector_data_types.q.out
+++ b/ql/src/test/results/clientpositive/tez/vector_data_types.q.out
@@ -157,7 +157,7 @@ POSTHOOK: query: SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc OR
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1korc
 #### A masked pattern was here ####
-108	301	65536	4294967357	90.05	17.59	true	ethan johnson	2013-03-01 09:11:58.703271	75.70	undecided
+108	301	65536	4294967357	90.05	17.59	true	ethan johnson	2013-03-01 09:11:58.703271	75.7	undecided
 118	497	65536	4294967381	50.32	12.72	false	david nixon	2013-03-01 09:11:58.703285	83.48	values clariffication
 18	280	65536	4294967320	32.92	45.94	false	holly white	2013-03-01 09:11:58.703086	58.86	topology
 69	489	65536	4294967404	33.52	17.99	false	oscar ichabod	2013-03-01 09:11:58.703247	32.68	topology
@@ -250,7 +250,7 @@ POSTHOOK: query: SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc OR
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1korc
 #### A masked pattern was here ####
-108	301	65536	4294967357	90.05	17.59	true	ethan johnson	2013-03-01 09:11:58.703271	75.70	undecided
+108	301	65536	4294967357	90.05	17.59	true	ethan johnson	2013-03-01 09:11:58.703271	75.7	undecided
 118	497	65536	4294967381	50.32	12.72	false	david nixon	2013-03-01 09:11:58.703285	83.48	values clariffication
 18	280	65536	4294967320	32.92	45.94	false	holly white	2013-03-01 09:11:58.703086	58.86	topology
 69	489	65536	4294967404	33.52	17.99	false	oscar ichabod	2013-03-01 09:11:58.703247	32.68	topology
diff --git a/ql/src/test/results/clientpositive/tez/vector_decimal_2.q.out b/ql/src/test/results/clientpositive/tez/vector_decimal_2.q.out
index af9459f107..ba84822731 100644
--- a/ql/src/test/results/clientpositive/tez/vector_decimal_2.q.out
+++ b/ql/src/test/results/clientpositive/tez/vector_decimal_2.q.out
@@ -1605,7 +1605,7 @@ POSTHOOK: query: select cast(0.99999999999999999999 as decimal(20,19)) as c from
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@decimal_2
 #### A masked pattern was here ####
-1.0
+1
 PREHOOK: query: explain
 select cast('0.99999999999999999999' as decimal(20,20)) as c from decimal_2 order by c
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/tez/vector_decimal_3.q.out b/ql/src/test/results/clientpositive/tez/vector_decimal_3.q.out
index 7987d080b3..75f872e279 100644
--- a/ql/src/test/results/clientpositive/tez/vector_decimal_3.q.out
+++ b/ql/src/test/results/clientpositive/tez/vector_decimal_3.q.out
@@ -47,7 +47,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@decimal_3
 #### A masked pattern was here ####
 NULL	0
--1234567890.1234567890	-1234567890
+-1234567890.123456789	-1234567890
 -4400	4400
 -1255.49	-1255
 -1.122	-11
@@ -56,7 +56,7 @@ NULL	0
 -0.333	0
 -0.33	0
 -0.3	0
-0.000000000000000000	0
+0	0
 0	0
 0	0
 0.01	0
@@ -67,8 +67,8 @@ NULL	0
 0.33	0
 0.333	0
 1	1
-1.0	1
-1.000000000000000000	1
+1	1
+1	1
 1.12	1
 1.122	1
 2	2
@@ -76,14 +76,14 @@ NULL	0
 3.14	3
 3.14	3
 3.14	3
-3.140	4
+3.14	4
 10	10
 20	20
 100	100
-124.00	124
+124	124
 125.2	125
 200	200
-1234567890.1234567800	1234567890
+1234567890.12345678	1234567890
 PREHOOK: query: SELECT * FROM DECIMAL_3 ORDER BY key DESC, value DESC
 PREHOOK: type: QUERY
 PREHOOK: Input: default@decimal_3
@@ -92,14 +92,14 @@ POSTHOOK: query: SELECT * FROM DECIMAL_3 ORDER BY key DESC, value DESC
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@decimal_3
 #### A masked pattern was here ####
-1234567890.1234567800	1234567890
+1234567890.12345678	1234567890
 200	200
 125.2	125
-124.00	124
+124	124
 100	100
 20	20
 10	10
-3.140	4
+3.14	4
 3.14	3
 3.14	3
 3.14	3
@@ -107,8 +107,8 @@ POSTHOOK: Input: default@decimal_3
 2	2
 1.122	1
 1.12	1
-1.000000000000000000	1
-1.0	1
+1	1
+1	1
 1	1
 0.333	0
 0.33	0
@@ -119,7 +119,7 @@ POSTHOOK: Input: default@decimal_3
 0.01	0
 0	0
 0	0
-0.000000000000000000	0
+0	0
 -0.3	0
 -0.33	0
 -0.333	0
@@ -128,7 +128,7 @@ POSTHOOK: Input: default@decimal_3
 -1.122	-11
 -1255.49	-1255
 -4400	4400
--1234567890.1234567890	-1234567890
+-1234567890.123456789	-1234567890
 NULL	0
 PREHOOK: query: SELECT * FROM DECIMAL_3 ORDER BY key, value
 PREHOOK: type: QUERY
@@ -139,7 +139,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@decimal_3
 #### A masked pattern was here ####
 NULL	0
--1234567890.1234567890	-1234567890
+-1234567890.123456789	-1234567890
 -4400	4400
 -1255.49	-1255
 -1.122	-11
@@ -148,7 +148,7 @@ NULL	0
 -0.333	0
 -0.33	0
 -0.3	0
-0.000000000000000000	0
+0	0
 0	0
 0	0
 0.01	0
@@ -159,8 +159,8 @@ NULL	0
 0.33	0
 0.333	0
 1	1
-1.0	1
-1.000000000000000000	1
+1	1
+1	1
 1.12	1
 1.122	1
 2	2
@@ -168,14 +168,14 @@ NULL	0
 3.14	3
 3.14	3
 3.14	3
-3.140	4
+3.14	4
 10	10
 20	20
 100	100
-124.00	124
+124	124
 125.2	125
 200	200
-1234567890.1234567800	1234567890
+1234567890.12345678	1234567890
 PREHOOK: query: SELECT DISTINCT key FROM DECIMAL_3 ORDER BY key
 PREHOOK: type: QUERY
 PREHOOK: Input: default@decimal_3
@@ -185,7 +185,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@decimal_3
 #### A masked pattern was here ####
 NULL
--1234567890.1234567890
+-1234567890.123456789
 -4400
 -1255.49
 -1.122
@@ -193,7 +193,7 @@ NULL
 -0.333
 -0.33
 -0.3
-0.000000000000000000
+0
 0.01
 0.02
 0.1
@@ -209,10 +209,10 @@ NULL
 10
 20
 100
-124.00
+124
 125.2
 200
-1234567890.1234567800
+1234567890.12345678
 PREHOOK: query: SELECT key, sum(value) FROM DECIMAL_3 GROUP BY key ORDER BY key
 PREHOOK: type: QUERY
 PREHOOK: Input: default@decimal_3
@@ -222,7 +222,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@decimal_3
 #### A masked pattern was here ####
 NULL	0
--1234567890.1234567890	-1234567890
+-1234567890.123456789	-1234567890
 -4400	4400
 -1255.49	-1255
 -1.122	-11
@@ -230,7 +230,7 @@ NULL	0
 -0.333	0
 -0.33	0
 -0.3	0
-0.000000000000000000	0
+0	0
 0.01	0
 0.02	0
 0.1	0
@@ -246,10 +246,10 @@ NULL	0
 10	10
 20	20
 100	100
-124.00	124
+124	124
 125.2	125
 200	200
-1234567890.1234567800	1234567890
+1234567890.12345678	1234567890
 PREHOOK: query: SELECT value, sum(key) FROM DECIMAL_3 GROUP BY value ORDER BY value
 PREHOOK: type: QUERY
 PREHOOK: Input: default@decimal_3
@@ -258,23 +258,23 @@ POSTHOOK: query: SELECT value, sum(key) FROM DECIMAL_3 GROUP BY value ORDER BY v
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@decimal_3
 #### A masked pattern was here ####
--1234567890	-1234567890.1234567890
+-1234567890	-1234567890.123456789
 -1255	-1255.49
 -11	-1.122
 -1	-2.24
-0	0.330000000000000000
-1	5.242000000000000000
+0	0.33
+1	5.242
 2	4
 3	9.42
-4	3.140
+4	3.14
 10	10
 20	20
 100	100
-124	124.00
+124	124
 125	125.2
 200	200
 4400	-4400
-1234567890	1234567890.1234567800
+1234567890	1234567890.12345678
 PREHOOK: query: SELECT * FROM DECIMAL_3 a JOIN DECIMAL_3 b ON (a.key = b.key) ORDER BY a.key, a.value, b.value
 PREHOOK: type: QUERY
 PREHOOK: Input: default@decimal_3
@@ -283,7 +283,7 @@ POSTHOOK: query: SELECT * FROM DECIMAL_3 a JOIN DECIMAL_3 b ON (a.key = b.key) O
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@decimal_3
 #### A masked pattern was here ####
--1234567890.1234567890	-1234567890	-1234567890.1234567890	-1234567890
+-1234567890.123456789	-1234567890	-1234567890.123456789	-1234567890
 -4400	4400	-4400	4400
 -1255.49	-1255	-1255.49	-1255
 -1.122	-11	-1.122	-11
@@ -294,13 +294,13 @@ POSTHOOK: Input: default@decimal_3
 -0.333	0	-0.333	0
 -0.33	0	-0.33	0
 -0.3	0	-0.3	0
-0.000000000000000000	0	0.000000000000000000	0
-0.000000000000000000	0	0	0
-0.000000000000000000	0	0	0
 0	0	0	0
-0	0	0.000000000000000000	0
 0	0	0	0
-0	0	0.000000000000000000	0
+0	0	0	0
+0	0	0	0
+0	0	0	0
+0	0	0	0
+0	0	0	0
 0	0	0	0
 0	0	0	0
 0.01	0	0.01	0
@@ -311,14 +311,14 @@ POSTHOOK: Input: default@decimal_3
 0.33	0	0.33	0
 0.333	0	0.333	0
 1	1	1	1
-1	1	1.0	1
-1	1	1.000000000000000000	1
-1.0	1	1.000000000000000000	1
-1.0	1	1.0	1
-1.0	1	1	1
-1.000000000000000000	1	1.000000000000000000	1
-1.000000000000000000	1	1	1
-1.000000000000000000	1	1.0	1
+1	1	1	1
+1	1	1	1
+1	1	1	1
+1	1	1	1
+1	1	1	1
+1	1	1	1
+1	1	1	1
+1	1	1	1
 1.12	1	1.12	1
 1.122	1	1.122	1
 2	2	2	2
@@ -334,20 +334,20 @@ POSTHOOK: Input: default@decimal_3
 3.14	3	3.14	3
 3.14	3	3.14	3
 3.14	3	3.14	3
-3.14	3	3.140	4
-3.14	3	3.140	4
-3.14	3	3.140	4
-3.140	4	3.14	3
-3.140	4	3.14	3
-3.140	4	3.14	3
-3.140	4	3.140	4
+3.14	3	3.14	4
+3.14	3	3.14	4
+3.14	3	3.14	4
+3.14	4	3.14	3
+3.14	4	3.14	3
+3.14	4	3.14	3
+3.14	4	3.14	4
 10	10	10	10
 20	20	20	20
 100	100	100	100
-124.00	124	124.00	124
+124	124	124	124
 125.2	125	125.2	125
 200	200	200	200
-1234567890.1234567800	1234567890	1234567890.1234567800	1234567890
+1234567890.12345678	1234567890	1234567890.12345678	1234567890
 PREHOOK: query: SELECT * FROM DECIMAL_3 WHERE key=3.14 ORDER BY key, value
 PREHOOK: type: QUERY
 PREHOOK: Input: default@decimal_3
@@ -359,7 +359,7 @@ POSTHOOK: Input: default@decimal_3
 3.14	3
 3.14	3
 3.14	3
-3.140	4
+3.14	4
 PREHOOK: query: SELECT * FROM DECIMAL_3 WHERE key=3.140 ORDER BY key, value
 PREHOOK: type: QUERY
 PREHOOK: Input: default@decimal_3
@@ -371,7 +371,7 @@ POSTHOOK: Input: default@decimal_3
 3.14	3
 3.14	3
 3.14	3
-3.140	4
+3.14	4
 PREHOOK: query: DROP TABLE DECIMAL_3_txt
 PREHOOK: type: DROPTABLE
 PREHOOK: Input: default@decimal_3_txt
diff --git a/ql/src/test/results/clientpositive/tez/vector_decimal_4.q.out b/ql/src/test/results/clientpositive/tez/vector_decimal_4.q.out
index 483ae1f279..613f5a8da9 100644
--- a/ql/src/test/results/clientpositive/tez/vector_decimal_4.q.out
+++ b/ql/src/test/results/clientpositive/tez/vector_decimal_4.q.out
@@ -57,7 +57,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@decimal_4_1
 #### A masked pattern was here ####
 NULL	0
--1234567890.1234567890	-1234567890
+-1234567890.123456789	-1234567890
 -4400	4400
 -1255.49	-1255
 -1.122	-11
@@ -66,7 +66,7 @@ NULL	0
 -0.333	0
 -0.33	0
 -0.3	0
-0.0000000000000000000000000	0
+0	0
 0	0
 0	0
 0.01	0
@@ -78,7 +78,7 @@ NULL	0
 0.333	0
 0.9999999999999999999999999	1
 1	1
-1.0	1
+1	1
 1.12	1
 1.122	1
 2	2
@@ -86,14 +86,14 @@ NULL	0
 3.14	3
 3.14	3
 3.14	3
-3.140	4
+3.14	4
 10	10
 20	20
 100	100
-124.00	124
+124	124
 125.2	125
 200	200
-1234567890.1234567800	1234567890
+1234567890.12345678	1234567890
 PREHOOK: query: SELECT * FROM DECIMAL_4_2 ORDER BY key, value
 PREHOOK: type: QUERY
 PREHOOK: Input: default@decimal_4_2
@@ -103,7 +103,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@decimal_4_2
 #### A masked pattern was here ####
 NULL	NULL
--1234567890.1234567890	-3703703670.3703703670
+-1234567890.123456789	-3703703670.370370367
 -4400	-13200
 -1255.49	-3766.47
 -1.122	-3.366
@@ -112,7 +112,7 @@ NULL	NULL
 -0.333	-0.999
 -0.33	-0.99
 -0.3	-0.9
-0.0000000000000000000000000	0.0000000000000000000000000
+0	0
 0	0
 0	0
 0.01	0.03
@@ -124,7 +124,7 @@ NULL	NULL
 0.333	0.999
 0.9999999999999999999999999	2.9999999999999999999999997
 1	3
-1.0	3.0
+1	3
 1.12	3.36
 1.122	3.366
 2	6
@@ -132,14 +132,14 @@ NULL	NULL
 3.14	9.42
 3.14	9.42
 3.14	9.42
-3.140	9.420
+3.14	9.42
 10	30
 20	60
 100	300
-124.00	372.00
+124	372
 125.2	375.6
 200	600
-1234567890.1234567800	3703703670.3703703400
+1234567890.12345678	3703703670.37037034
 PREHOOK: query: SELECT * FROM DECIMAL_4_2 ORDER BY key
 PREHOOK: type: QUERY
 PREHOOK: Input: default@decimal_4_2
@@ -149,7 +149,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@decimal_4_2
 #### A masked pattern was here ####
 NULL	NULL
--1234567890.1234567890	-3703703670.3703703670
+-1234567890.123456789	-3703703670.370370367
 -4400	-13200
 -1255.49	-3766.47
 -1.122	-3.366
@@ -158,7 +158,7 @@ NULL	NULL
 -0.333	-0.999
 -0.33	-0.99
 -0.3	-0.9
-0.0000000000000000000000000	0.0000000000000000000000000
+0	0
 0	0
 0	0
 0.01	0.03
@@ -170,7 +170,7 @@ NULL	NULL
 0.333	0.999
 0.9999999999999999999999999	2.9999999999999999999999997
 1	3
-1.0	3.0
+1	3
 1.12	3.36
 1.122	3.366
 2	6
@@ -178,14 +178,14 @@ NULL	NULL
 3.14	9.42
 3.14	9.42
 3.14	9.42
-3.140	9.420
+3.14	9.42
 10	30
 20	60
 100	300
-124.00	372.00
+124	372
 125.2	375.6
 200	600
-1234567890.1234567800	3703703670.3703703400
+1234567890.12345678	3703703670.37037034
 PREHOOK: query: SELECT * FROM DECIMAL_4_2 ORDER BY key, value
 PREHOOK: type: QUERY
 PREHOOK: Input: default@decimal_4_2
@@ -195,7 +195,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@decimal_4_2
 #### A masked pattern was here ####
 NULL	NULL
--1234567890.1234567890	-3703703670.3703703670
+-1234567890.123456789	-3703703670.370370367
 -4400	-13200
 -1255.49	-3766.47
 -1.122	-3.366
@@ -204,7 +204,7 @@ NULL	NULL
 -0.333	-0.999
 -0.33	-0.99
 -0.3	-0.9
-0.0000000000000000000000000	0.0000000000000000000000000
+0	0
 0	0
 0	0
 0.01	0.03
@@ -216,7 +216,7 @@ NULL	NULL
 0.333	0.999
 0.9999999999999999999999999	2.9999999999999999999999997
 1	3
-1.0	3.0
+1	3
 1.12	3.36
 1.122	3.366
 2	6
@@ -224,14 +224,14 @@ NULL	NULL
 3.14	9.42
 3.14	9.42
 3.14	9.42
-3.140	9.420
+3.14	9.42
 10	30
 20	60
 100	300
-124.00	372.00
+124	372
 125.2	375.6
 200	600
-1234567890.1234567800	3703703670.3703703400
+1234567890.12345678	3703703670.37037034
 PREHOOK: query: DROP TABLE DECIMAL_4_1
 PREHOOK: type: DROPTABLE
 PREHOOK: Input: default@decimal_4_1
diff --git a/ql/src/test/results/clientpositive/tez/vector_decimal_5.q.out b/ql/src/test/results/clientpositive/tez/vector_decimal_5.q.out
index 01b5f42b44..34c33513eb 100644
--- a/ql/src/test/results/clientpositive/tez/vector_decimal_5.q.out
+++ b/ql/src/test/results/clientpositive/tez/vector_decimal_5.q.out
@@ -67,7 +67,7 @@ NULL
 -0.333
 -0.33
 -0.3
-0.00000
+0
 0
 0
 0.01
@@ -78,8 +78,8 @@ NULL
 0.33
 0.333
 1
-1.0
-1.00000
+1
+1
 1.12
 1.122
 2
@@ -87,11 +87,11 @@ NULL
 3.14
 3.14
 3.14
-3.140
+3.14
 10
 20
 100
-124.00
+124
 125.2
 200
 PREHOOK: query: SELECT DISTINCT key FROM DECIMAL_5 ORDER BY key
@@ -110,7 +110,7 @@ NULL
 -0.333
 -0.33
 -0.3
-0.00000
+0
 0.01
 0.02
 0.1
@@ -126,7 +126,7 @@ NULL
 10
 20
 100
-124.00
+124
 125.2
 200
 PREHOOK: query: SELECT cast(key as decimal) FROM DECIMAL_5
@@ -185,7 +185,7 @@ POSTHOOK: Input: default@decimal_5
 #### A masked pattern was here ####
 NULL
 NULL
-0.000
+0
 0
 100
 10
@@ -204,7 +204,7 @@ NULL
 -0.3
 -0.33
 -0.333
-1.0
+1
 2
 3.14
 -1.12
@@ -212,13 +212,13 @@ NULL
 -1.122
 1.12
 1.122
-124.00
+124
 125.2
 NULL
 3.14
 3.14
-3.140
-1.000
+3.14
+1
 NULL
 NULL
 PREHOOK: query: DROP TABLE DECIMAL_5_txt
diff --git a/ql/src/test/results/clientpositive/tez/vector_decimal_6.q.out b/ql/src/test/results/clientpositive/tez/vector_decimal_6.q.out
index 7ecd50056a..9cdd7fc03b 100644
--- a/ql/src/test/results/clientpositive/tez/vector_decimal_6.q.out
+++ b/ql/src/test/results/clientpositive/tez/vector_decimal_6.q.out
@@ -125,20 +125,20 @@ NULL	1234567890
 -1.12	-1
 -0.333	0
 -0.3	0
-0.00000	0
+0	0
 0	0
 0.333	0
-1.0	1
-1.00000	1
+1	1
+1	1
 1.12	1
 1.122	1
 2	2
 3.14	3
 3.14	3
-3.140	4
+3.14	4
 10	10
 10.73433	5
-124.00	124
+124	124
 125.2	125
 23232.23435	2
 PREHOOK: query: SELECT * FROM DECIMAL_6_2 ORDER BY key, value
@@ -157,20 +157,20 @@ NULL	0
 -1.12	-1
 -0.333	0
 -0.3	0
-0.0000	0
+0	0
 0	0
 0.333	0
-1.0	1
-1.0000	1
+1	1
+1	1
 1.12	1
 1.122	1
 2	2
 3.14	3
 3.14	3
-3.140	4
+3.14	4
 10	10
 10.7343	5
-124.00	124
+124	124
 125.2	125
 23232.2344	2
 2389432.2375	3
@@ -213,16 +213,16 @@ NULL
 -0.333
 -0.3
 -0.3
-0.00000
-0.0000
+0
+0
 0
 0
 0.333
 0.333
-1.0
-1.0
-1.0000
-1.00000
+1
+1
+1
+1
 1.12
 1.12
 1.122
@@ -233,14 +233,14 @@ NULL
 3.14
 3.14
 3.14
-3.140
-3.140
+3.14
+3.14
 10
 10
 10.7343
 10.73433
-124.00
-124.00
+124
+124
 125.2
 125.2
 23232.23435
diff --git a/ql/src/test/results/clientpositive/tez/vector_decimal_aggregate.q.out b/ql/src/test/results/clientpositive/tez/vector_decimal_aggregate.q.out
index e4b2c56190..0037e2a0bd 100644
--- a/ql/src/test/results/clientpositive/tez/vector_decimal_aggregate.q.out
+++ b/ql/src/test/results/clientpositive/tez/vector_decimal_aggregate.q.out
@@ -115,9 +115,9 @@ POSTHOOK: Input: default@decimal_vgby
 #### A masked pattern was here ####
 NULL	3072	9318.4351351351	-4298.1513513514	5018444.1081079808	3072	11160.715384615385	-5147.907692307693	6010604.3076923073536
 -3728	6	5831542.269248378	-3367.6517567568	5817556.0411483778	6	6984454.211097692	-4033.445769230769	6967702.8672438458471
--563	2	-515.6210729730	-3367.6517567568	-3883.2728297298	2	-617.5607769230769	-4033.445769230769	-4651.0065461538459
+-563	2	-515.621072973	-3367.6517567568	-3883.2728297298	2	-617.5607769230769	-4033.445769230769	-4651.0065461538459
 762	2	5831542.269248378	1531.2194054054	5833073.4886537834	2	6984454.211097692	1833.9456923076925	6986288.1567899996925
-6981	3	5831542.269248378	-515.6210729730	5830511.0271024320	3	6984454.211097692	-617.5607769230769	6983219.0895438458462
+6981	3	5831542.269248378	-515.621072973	5830511.027102432	3	6984454.211097692	-617.5607769230769	6983219.0895438458462
 253665376	1024	9767.0054054054	-9779.5486486487	-347484.0818378374	1024	11697.969230769231	-11712.99230769231	-416182.64030769233089
 528534767	1024	5831542.269248378	-9777.1594594595	11646372.8607481068	1024	6984454.211097692	-11710.130769230771	13948892.79980307629003
 626923679	1024	9723.4027027027	-9778.9513513514	10541.0525297287	1024	11645.746153846154	-11712.276923076923	12625.04759999997746
@@ -219,9 +219,9 @@ POSTHOOK: Input: default@decimal_vgby
 #### A masked pattern was here ####
 NULL	3072	9318.4351351351	-4298.1513513514	5018444.1081079808	1633.60810810806667	5695.483082135364	5696.4103077145055	3072	11160.715384615385	-5147.907692307693	6010604.3076923073536	1956.576923076922966667	6821.495748565159	6822.606289190924
 -3728	6	5831542.269248378	-3367.6517567568	5817556.0411483778	969592.67352472963333	2174330.2092403853	2381859.406131774	6	6984454.211097692	-4033.445769230769	6967702.8672438458471	1161283.811207307641183333	2604201.2704476737	2852759.5602156054
--563	2	-515.6210729730	-3367.6517567568	-3883.2728297298	-1941.6364148649	1426.0153418918999	2016.6902366556308	2	-617.5607769230769	-4033.445769230769	-4651.0065461538459	-2325.50327307692295	1707.9424961538462	2415.395441814127
+-563	2	-515.621072973	-3367.6517567568	-3883.2728297298	-1941.6364148649	1426.0153418918999	2016.6902366556308	2	-617.5607769230769	-4033.445769230769	-4651.0065461538459	-2325.50327307692295	1707.9424961538462	2415.395441814127
 762	2	5831542.269248378	1531.2194054054	5833073.4886537834	2916536.7443268917	2915005.5249214866	4122440.3477364695	2	6984454.211097692	1833.9456923076925	6986288.1567899996925	3493144.07839499984625	3491310.1327026924	4937458.140118758
-6981	3	5831542.269248378	-515.6210729730	5830511.0271024320	1943503.67570081066667	2749258.455012492	3367140.1929065133	3	6984454.211097692	-617.5607769230769	6983219.0895438458462	2327739.696514615282066667	3292794.4113115156	4032833.0678006653
+6981	3	5831542.269248378	-515.621072973	5830511.027102432	1943503.67570081066667	2749258.455012492	3367140.1929065133	3	6984454.211097692	-617.5607769230769	6983219.0895438458462	2327739.696514615282066667	3292794.4113115156	4032833.0678006653
 253665376	1024	9767.0054054054	-9779.5486486487	-347484.0818378374	-339.33992366976309	5708.9563478862	5711.745967572779	1024	11697.969230769231	-11712.99230769231	-416182.64030769233089	-406.428359675480791885	6837.632716002934	6840.973851172274
 528534767	1024	5831542.269248378	-9777.1594594595	11646372.8607481068	11373.41099682432305	257528.92988206653	257654.7686043977	1024	6984454.211097692	-11710.130769230771	13948892.79980307629003	13621.965624807691689482	308443.1074570801	308593.82484083984
 626923679	1024	9723.4027027027	-9778.9513513514	10541.0525297287	10.29399661106318	5742.09145323734	5744.897264034267	1024	11645.746153846154	-11712.276923076923	12625.04759999997746	12.329148046874977988	6877.318722794877	6880.679250101603
diff --git a/ql/src/test/results/clientpositive/tez/vector_decimal_cast.q.out b/ql/src/test/results/clientpositive/tez/vector_decimal_cast.q.out
index e2fe3a2111..59b80f209d 100644
--- a/ql/src/test/results/clientpositive/tez/vector_decimal_cast.q.out
+++ b/ql/src/test/results/clientpositive/tez/vector_decimal_cast.q.out
@@ -29,13 +29,13 @@ POSTHOOK: query: SELECT cdouble, cint, cboolean1, ctimestamp1, CAST(cdouble AS D
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc
 #### A masked pattern was here ####
--13326.0	528534767	true	1969-12-31 15:59:46.674	-13326.0	528534767	1	-13
--15813.0	528534767	true	1969-12-31 15:59:55.787	-15813.0	528534767	1	-4
--9566.0	528534767	true	1969-12-31 15:59:44.187	-9566.0	528534767	1	-16
-15007.0	528534767	true	1969-12-31 15:59:50.434	15007.0	528534767	1	-10
-7021.0	528534767	true	1969-12-31 16:00:15.007	7021.0	528534767	1	15
-4963.0	528534767	true	1969-12-31 16:00:07.021	4963.0	528534767	1	7
--7824.0	528534767	true	1969-12-31 16:00:04.963	-7824.0	528534767	1	5
--15431.0	528534767	true	1969-12-31 15:59:52.176	-15431.0	528534767	1	-8
--15549.0	528534767	true	1969-12-31 15:59:44.569	-15549.0	528534767	1	-15
-5780.0	528534767	true	1969-12-31 15:59:44.451	5780.0	528534767	1	-16
+-13326.0	528534767	true	1969-12-31 15:59:46.674	-13326	528534767	1	-13
+-15813.0	528534767	true	1969-12-31 15:59:55.787	-15813	528534767	1	-4
+-9566.0	528534767	true	1969-12-31 15:59:44.187	-9566	528534767	1	-16
+15007.0	528534767	true	1969-12-31 15:59:50.434	15007	528534767	1	-10
+7021.0	528534767	true	1969-12-31 16:00:15.007	7021	528534767	1	15
+4963.0	528534767	true	1969-12-31 16:00:07.021	4963	528534767	1	7
+-7824.0	528534767	true	1969-12-31 16:00:04.963	-7824	528534767	1	5
+-15431.0	528534767	true	1969-12-31 15:59:52.176	-15431	528534767	1	-8
+-15549.0	528534767	true	1969-12-31 15:59:44.569	-15549	528534767	1	-15
+5780.0	528534767	true	1969-12-31 15:59:44.451	5780	528534767	1	-16
diff --git a/ql/src/test/results/clientpositive/tez/vector_decimal_expressions.q.out b/ql/src/test/results/clientpositive/tez/vector_decimal_expressions.q.out
index 7faa6305fa..a1e95e8b17 100644
--- a/ql/src/test/results/clientpositive/tez/vector_decimal_expressions.q.out
+++ b/ql/src/test/results/clientpositive/tez/vector_decimal_expressions.q.out
@@ -40,12 +40,12 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@decimal_test
 #### A masked pattern was here ####
 19699.417463617423	-12507.913305613346	0.8351496686995997	2.8303425077026896E7	3.6405405405	8963	10735	-17	8963	true	10735.776923076923	8963.641	10735.776923076923	1969-12-31 18:29:23.64054054
-9216.339708939685	-5851.806444906470	0.8353975893550668	6195112.1797296945	3.6243243243	4193	5022	-98	4193	true	5022.715384615385	4193.6245	5022.715384615385	1969-12-31 17:09:53.624324324
+9216.339708939685	-5851.80644490647	0.8353975893550668	6195112.1797296945	3.6243243243	4193	5022	-98	4193	true	5022.715384615385	4193.6245	5022.715384615385	1969-12-31 17:09:53.624324324
 6514.8403326403464	-4136.5212058211928	0.8355907765708067	3095563.9418919063	4.3864864865	2964	3550	-34	2964	true	3550.4538461538464	2964.3865	3550.4538461538464	1969-12-31 16:49:24.386486486
 7587.301455301477	-4817.467775467754	0.8354976172734904	4198623.24324327	2.3783783784	3452	4134	38	3452	true	4134.923076923077	3452.3784	4134.923076923077	1969-12-31 16:57:32.378378378
-19197.9729729730	-12189.5270270270	0.835155361813429	2.6880848817567654E7	5.4729729730	8735	10462	-34	8735	true	10462.5	8735.473	10462.5	1969-12-31 18:25:35.472972973
+19197.972972973	-12189.527027027	0.835155361813429	2.6880848817567654E7	5.472972973	8735	10462	-34	8735	true	10462.5	8735.473	10462.5	1969-12-31 18:25:35.472972973
 17098.9945945946	-10856.8054054054	0.8351828165813104	2.132423090270272E7	0.3945945946	7780	9318	102	7780	true	9318.6	7780.3945	9318.6	1969-12-31 18:09:40.394594594
 12433.723076923077	-7894.646153846154	0.8352770361086894	1.12754688E7	7.6	5657	6776	120	5657	true	6776.123076923077	5657.6	6776.123076923077	1969-12-31 17:34:17.6
 7247.316839916862	-4601.598544698524	0.8355241651897876	3830775.6932432684	7.6783783784	3297	3949	109	3297	true	3949.638461538462	3297.6785	3949.638461538462	1969-12-31 16:54:57.678378378
-14757.1700623700465	-9369.8914760914930	0.8352226654922171	1.5883214124324286E7	4.8162162162	6714	8042	106	6714	true	8042.3538461538465	6714.8164	8042.3538461538465	1969-12-31 17:51:54.816216216
+14757.1700623700465	-9369.891476091493	0.8352226654922171	1.5883214124324286E7	4.8162162162	6714	8042	106	6714	true	8042.3538461538465	6714.8164	8042.3538461538465	1969-12-31 17:51:54.816216216
 10964.832016631993	-6961.991060291086	0.8353232978714221	8768719.779729689	9.2243243243	4989	5975	87	4989	true	5975.607692307693	4989.224	5975.607692307693	1969-12-31 17:23:09.224324324
diff --git a/ql/src/test/results/clientpositive/tez/vector_decimal_mapjoin.q.out b/ql/src/test/results/clientpositive/tez/vector_decimal_mapjoin.q.out
index 6a5ccc65cf..049be2611e 100644
--- a/ql/src/test/results/clientpositive/tez/vector_decimal_mapjoin.q.out
+++ b/ql/src/test/results/clientpositive/tez/vector_decimal_mapjoin.q.out
@@ -109,26 +109,26 @@ POSTHOOK: query: SELECT l.cint, r.cint, l.cdecimal1, r.cdecimal2
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@decimal_mapjoin
 #### A masked pattern was here ####
-6981	6981	-515.6210729730	-617.5607769230769
-6981	6981	-515.6210729730	-617.5607769230769
-6981	6981	-515.6210729730	-617.5607769230769
-6981	6981	-515.6210729730	-617.5607769230769
-6981	6981	-515.6210729730	6984454.211097692
-6981	6981	-515.6210729730	6984454.211097692
-6981	6981	-515.6210729730	NULL
-6981	6981	-515.6210729730	NULL
-6981	6981	-515.6210729730	NULL
-6981	6981	-515.6210729730	NULL
-6981	6981	-515.6210729730	NULL
-6981	6981	-515.6210729730	NULL
-6981	6981	-515.6210729730	NULL
-6981	6981	-515.6210729730	NULL
-6981	6981	-515.6210729730	NULL
-6981	6981	-515.6210729730	NULL
-6981	6981	-515.6210729730	NULL
-6981	6981	-515.6210729730	NULL
-6981	6981	-515.6210729730	NULL
-6981	6981	-515.6210729730	NULL
+6981	6981	-515.621072973	-617.5607769230769
+6981	6981	-515.621072973	-617.5607769230769
+6981	6981	-515.621072973	-617.5607769230769
+6981	6981	-515.621072973	-617.5607769230769
+6981	6981	-515.621072973	6984454.211097692
+6981	6981	-515.621072973	6984454.211097692
+6981	6981	-515.621072973	NULL
+6981	6981	-515.621072973	NULL
+6981	6981	-515.621072973	NULL
+6981	6981	-515.621072973	NULL
+6981	6981	-515.621072973	NULL
+6981	6981	-515.621072973	NULL
+6981	6981	-515.621072973	NULL
+6981	6981	-515.621072973	NULL
+6981	6981	-515.621072973	NULL
+6981	6981	-515.621072973	NULL
+6981	6981	-515.621072973	NULL
+6981	6981	-515.621072973	NULL
+6981	6981	-515.621072973	NULL
+6981	6981	-515.621072973	NULL
 6981	6981	5831542.269248378	-617.5607769230769
 6981	6981	5831542.269248378	-617.5607769230769
 6981	6981	5831542.269248378	6984454.211097692
diff --git a/ql/src/test/results/clientpositive/tez/vector_decimal_precision.q.out b/ql/src/test/results/clientpositive/tez/vector_decimal_precision.q.out
index d15562313b..3d9d89a768 100644
--- a/ql/src/test/results/clientpositive/tez/vector_decimal_precision.q.out
+++ b/ql/src/test/results/clientpositive/tez/vector_decimal_precision.q.out
@@ -99,13 +99,13 @@ NULL
 NULL
 NULL
 NULL
-0.0000000000
-0.0000000000
-0.0000000000
-0.0000000000
 0
-0.1234567890
-0.1234567890
+0
+0
+0
+0
+0.123456789
+0.123456789
 1.2345678901
 1.2345678901
 1.2345678901
@@ -129,7 +129,7 @@ NULL
 123456789.0123456
 123456789.0123456789
 1234567890.123456
-1234567890.1234567890
+1234567890.123456789
 PREHOOK: query: SELECT dec, dec + 1, dec - 1 FROM DECIMAL_PRECISION ORDER BY dec
 PREHOOK: type: QUERY
 PREHOOK: Input: default@decimal_precision
@@ -182,13 +182,13 @@ NULL	NULL	NULL
 NULL	NULL	NULL
 NULL	NULL	NULL
 NULL	NULL	NULL
-0.0000000000	1.0000000000	-1.0000000000
-0.0000000000	1.0000000000	-1.0000000000
-0.0000000000	1.0000000000	-1.0000000000
-0.0000000000	1.0000000000	-1.0000000000
 0	1	-1
-0.1234567890	1.1234567890	-0.8765432110
-0.1234567890	1.1234567890	-0.8765432110
+0	1	-1
+0	1	-1
+0	1	-1
+0	1	-1
+0.123456789	1.123456789	-0.876543211
+0.123456789	1.123456789	-0.876543211
 1.2345678901	2.2345678901	0.2345678901
 1.2345678901	2.2345678901	0.2345678901
 1.2345678901	2.2345678901	0.2345678901
@@ -212,7 +212,7 @@ NULL	NULL	NULL
 123456789.0123456	123456790.0123456	123456788.0123456
 123456789.0123456789	123456790.0123456789	123456788.0123456789
 1234567890.123456	1234567891.123456	1234567889.123456
-1234567890.1234567890	1234567891.1234567890	1234567889.1234567890
+1234567890.123456789	1234567891.123456789	1234567889.123456789
 PREHOOK: query: SELECT dec, dec * 2, dec / 3  FROM DECIMAL_PRECISION ORDER BY dec
 PREHOOK: type: QUERY
 PREHOOK: Input: default@decimal_precision
@@ -265,13 +265,13 @@ NULL	NULL	NULL
 NULL	NULL	NULL
 NULL	NULL	NULL
 NULL	NULL	NULL
-0.0000000000	0.0000000000	0
-0.0000000000	0.0000000000	0
-0.0000000000	0.0000000000	0
-0.0000000000	0.0000000000	0
 0	0	0
-0.1234567890	0.2469135780	0.041152263
-0.1234567890	0.2469135780	0.041152263
+0	0	0
+0	0	0
+0	0	0
+0	0	0
+0.123456789	0.246913578	0.041152263
+0.123456789	0.246913578	0.041152263
 1.2345678901	2.4691357802	0.411522630033
 1.2345678901	2.4691357802	0.411522630033
 1.2345678901	2.4691357802	0.411522630033
@@ -281,9 +281,9 @@ NULL	NULL	NULL
 123.4567890123	246.9135780246	41.1522630041
 123.4567890123	246.9135780246	41.1522630041
 123.4567890123	246.9135780246	41.1522630041
-1234.5678901235	2469.1357802470	411.522630041167
-1234.5678901235	2469.1357802470	411.522630041167
-1234.5678901235	2469.1357802470	411.522630041167
+1234.5678901235	2469.135780247	411.522630041167
+1234.5678901235	2469.135780247	411.522630041167
+1234.5678901235	2469.135780247	411.522630041167
 12345.6789012346	24691.3578024692	4115.226300411533
 12345.6789012346	24691.3578024692	4115.226300411533
 123456.7890123456	246913.5780246912	41152.2630041152
@@ -295,7 +295,7 @@ NULL	NULL	NULL
 123456789.0123456	246913578.0246912	41152263.0041152
 123456789.0123456789	246913578.0246913578	41152263.0041152263
 1234567890.123456	2469135780.246912	411522630.041152
-1234567890.1234567890	2469135780.2469135780	411522630.041152263
+1234567890.123456789	2469135780.246913578	411522630.041152263
 PREHOOK: query: SELECT dec, dec / 9 FROM DECIMAL_PRECISION ORDER BY dec
 PREHOOK: type: QUERY
 PREHOOK: Input: default@decimal_precision
@@ -348,13 +348,13 @@ NULL	NULL
 NULL	NULL
 NULL	NULL
 NULL	NULL
-0.0000000000	0
-0.0000000000	0
-0.0000000000	0
-0.0000000000	0
 0	0
-0.1234567890	0.013717421
-0.1234567890	0.013717421
+0	0
+0	0
+0	0
+0	0
+0.123456789	0.013717421
+0.123456789	0.013717421
 1.2345678901	0.137174210011
 1.2345678901	0.137174210011
 1.2345678901	0.137174210011
@@ -378,7 +378,7 @@ NULL	NULL
 123456789.0123456	13717421.001371733333
 123456789.0123456789	13717421.0013717421
 1234567890.123456	137174210.013717333333
-1234567890.1234567890	137174210.013717421
+1234567890.123456789	137174210.013717421
 PREHOOK: query: SELECT dec, dec / 27 FROM DECIMAL_PRECISION ORDER BY dec
 PREHOOK: type: QUERY
 PREHOOK: Input: default@decimal_precision
@@ -431,13 +431,13 @@ NULL	NULL
 NULL	NULL
 NULL	NULL
 NULL	NULL
-0.0000000000	0
-0.0000000000	0
-0.0000000000	0
-0.0000000000	0
 0	0
-0.1234567890	0.0045724736667
-0.1234567890	0.0045724736667
+0	0
+0	0
+0	0
+0	0
+0.123456789	0.0045724736667
+0.123456789	0.0045724736667
 1.2345678901	0.0457247366704
 1.2345678901	0.0457247366704
 1.2345678901	0.0457247366704
@@ -461,7 +461,7 @@ NULL	NULL
 123456789.0123456	4572473.6671239111111
 123456789.0123456789	4572473.6671239140333
 1234567890.123456	45724736.6712391111111
-1234567890.1234567890	45724736.6712391403333
+1234567890.123456789	45724736.6712391403333
 PREHOOK: query: SELECT dec, dec * dec FROM DECIMAL_PRECISION ORDER BY dec
 PREHOOK: type: QUERY
 PREHOOK: Input: default@decimal_precision
@@ -514,13 +514,13 @@ NULL	NULL
 NULL	NULL
 NULL	NULL
 NULL	NULL
-0.0000000000	0.00000000000000000000
-0.0000000000	0.00000000000000000000
-0.0000000000	0.00000000000000000000
-0.0000000000	0.00000000000000000000
 0	0
-0.1234567890	0.01524157875019052100
-0.1234567890	0.01524157875019052100
+0	0
+0	0
+0	0
+0	0
+0.123456789	0.015241578750190521
+0.123456789	0.015241578750190521
 1.2345678901	1.52415787526596567801
 1.2345678901	1.52415787526596567801
 1.2345678901	1.52415787526596567801
@@ -544,7 +544,7 @@ NULL	NULL
 123456789.0123456	15241578753238817.26870921383936
 123456789.0123456789	15241578753238836.75019051998750190521
 1234567890.123456	NULL
-1234567890.1234567890	NULL
+1234567890.123456789	NULL
 PREHOOK: query: EXPLAIN SELECT avg(dec), sum(dec) FROM DECIMAL_PRECISION
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN SELECT avg(dec), sum(dec) FROM DECIMAL_PRECISION
diff --git a/ql/src/test/results/clientpositive/tez/vector_decimal_trailing.q.out b/ql/src/test/results/clientpositive/tez/vector_decimal_trailing.q.out
index cb0b5a2739..ffdb1c9b67 100644
--- a/ql/src/test/results/clientpositive/tez/vector_decimal_trailing.q.out
+++ b/ql/src/test/results/clientpositive/tez/vector_decimal_trailing.q.out
@@ -76,13 +76,13 @@ POSTHOOK: Input: default@decimal_trailing
 0	0	0
 1	0	0
 2	NULL	NULL
-3	1.0000	1.00000000
-4	10.0000	10.00000000
-5	100.0000	100.00000000
-6	1000.0000	1000.00000000
-7	10000.0000	10000.00000000
-8	100000.0000	100000.00000000
-9	NULL	1000000.00000000
+3	1	1
+4	10	10
+5	100	100
+6	1000	1000
+7	10000	10000
+8	100000	100000
+9	NULL	1000000
 10	NULL	NULL
 11	NULL	NULL
 12	NULL	NULL
@@ -91,18 +91,18 @@ POSTHOOK: Input: default@decimal_trailing
 15	NULL	NULL
 16	NULL	NULL
 17	NULL	NULL
-18	1.0000	1.00000000
-19	10.000	10.0000000
-20	100.00	100.000000
-21	1000.0	1000.00000
-22	100000	10000.0000
-23	0.0000	0.00000000
-24	0.000	0.0000000
-25	0.00	0.000000
-26	0.0	0.00000
-27	0	0.00000
-28	12313.2000	134134.31252500
-29	99999.9990	134134.31242553
+18	1	1
+19	10	10
+20	100	100
+21	1000	1000
+22	100000	10000
+23	0	0
+24	0	0
+25	0	0
+26	0	0
+27	0	0
+28	12313.2	134134.312525
+29	99999.999	134134.31242553
 PREHOOK: query: DROP TABLE DECIMAL_TRAILING_txt
 PREHOOK: type: DROPTABLE
 PREHOOK: Input: default@decimal_trailing_txt
diff --git a/ql/src/test/results/clientpositive/tez/vector_decimal_udf.q.out b/ql/src/test/results/clientpositive/tez/vector_decimal_udf.q.out
index 8e847f6a82..266b4cbceb 100644
--- a/ql/src/test/results/clientpositive/tez/vector_decimal_udf.q.out
+++ b/ql/src/test/results/clientpositive/tez/vector_decimal_udf.q.out
@@ -97,7 +97,7 @@ POSTHOOK: Input: default@decimal_udf
 #### A masked pattern was here ####
 -8800
 NULL
-0.0000000000
+0
 0
 200
 20
@@ -116,7 +116,7 @@ NULL
 -0.6
 -0.66
 -0.666
-2.0
+2
 4
 6.28
 -2.24
@@ -124,15 +124,15 @@ NULL
 -2.244
 2.24
 2.244
-248.00
+248
 250.4
 -2510.98
 6.28
 6.28
-6.280
-2.0000000000
--2469135780.2469135780
-2469135780.2469135600
+6.28
+2
+-2469135780.246913578
+2469135780.24691356
 PREHOOK: query: EXPLAIN SELECT key + value FROM DECIMAL_UDF
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN SELECT key + value FROM DECIMAL_UDF
@@ -180,7 +180,7 @@ POSTHOOK: Input: default@decimal_udf
 #### A masked pattern was here ####
 0
 NULL
-0.0000000000
+0
 0
 200
 20
@@ -199,7 +199,7 @@ NULL
 -0.3
 -0.33
 -0.333
-2.0
+2
 4
 6.14
 -2.12
@@ -207,15 +207,15 @@ NULL
 -12.122
 2.12
 2.122
-248.00
+248
 250.2
 -2510.49
 6.14
 6.14
-7.140
-2.0000000000
--2469135780.1234567890
-2469135780.1234567800
+7.14
+2
+-2469135780.123456789
+2469135780.12345678
 PREHOOK: query: EXPLAIN SELECT key + (value/2) FROM DECIMAL_UDF
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN SELECT key + (value/2) FROM DECIMAL_UDF
@@ -430,42 +430,42 @@ POSTHOOK: Input: default@decimal_udf
 #### A masked pattern was here ####
 0
 NULL
-0.0000000000
 0
 0
 0
 0
-0.0
-0.00
 0
 0
 0
 0
-0.0
-0.00
-0.0
-0.00
-0.000
-0.0
-0.00
-0.000
-0.0
 0
-0.00
-0.00
-0.00
-0.000
-0.00
-0.000
-0.00
-0.0
-0.00
-0.00
-0.00
-0.000
-0.0000000000
-0.0000000000
-0.0000000000
+0
+0
+0
+0
+0
+0
+0
+0
+0
+0
+0
+0
+0
+0
+0
+0
+0
+0
+0
+0
+0
+0
+0
+0
+0
+0
+0
 PREHOOK: query: EXPLAIN SELECT key - value FROM DECIMAL_UDF
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN SELECT key - value FROM DECIMAL_UDF
@@ -513,7 +513,7 @@ POSTHOOK: Input: default@decimal_udf
 #### A masked pattern was here ####
 -8800
 NULL
-0.0000000000
+0
 0
 0
 0
@@ -532,7 +532,7 @@ NULL
 -0.3
 -0.33
 -0.333
-0.0
+0
 0
 0.14
 -0.12
@@ -540,15 +540,15 @@ NULL
 9.878
 0.12
 0.122
-0.00
+0
 0.2
 -0.49
 0.14
 0.14
--0.860
-0.0000000000
--0.1234567890
-0.1234567800
+-0.86
+0
+-0.123456789
+0.12345678
 PREHOOK: query: EXPLAIN SELECT key - (value/2) FROM DECIMAL_UDF
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN SELECT key - (value/2) FROM DECIMAL_UDF
@@ -763,7 +763,7 @@ POSTHOOK: Input: default@decimal_udf
 #### A masked pattern was here ####
 19360000
 NULL
-0.00000000000000000000
+0
 0
 10000
 100
@@ -782,7 +782,7 @@ NULL
 0.09
 0.1089
 0.110889
-1.00
+1
 4
 9.8596
 1.2544
@@ -790,13 +790,13 @@ NULL
 1.258884
 1.2544
 1.258884
-15376.0000
+15376
 15675.04
 1576255.1401
 9.8596
 9.8596
-9.859600
-1.00000000000000000000
+9.8596
+1
 NULL
 NULL
 PREHOOK: query: EXPLAIN SELECT key, value FROM DECIMAL_UDF where key * value > 0
@@ -853,7 +853,7 @@ POSTHOOK: Input: default@decimal_udf
 200	200
 20	20
 2	2
-1.0	1
+1	1
 2	2
 3.14	3
 -1.12	-1
@@ -861,15 +861,15 @@ POSTHOOK: Input: default@decimal_udf
 -1.122	-11
 1.12	1
 1.122	1
-124.00	124
+124	124
 125.2	125
 -1255.49	-1255
 3.14	3
 3.14	3
-3.140	4
-1.0000000000	1
--1234567890.1234567890	-1234567890
-1234567890.1234567800	1234567890
+3.14	4
+1	1
+-1234567890.123456789	-1234567890
+1234567890.12345678	1234567890
 PREHOOK: query: EXPLAIN SELECT key * value FROM DECIMAL_UDF
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN SELECT key * value FROM DECIMAL_UDF
@@ -917,26 +917,26 @@ POSTHOOK: Input: default@decimal_udf
 #### A masked pattern was here ####
 -19360000
 NULL
-0.0000000000
+0
 0
 10000
 100
 1
-0.0
-0.00
+0
+0
 40000
 400
 4
 0
-0.0
-0.00
-0.0
-0.00
-0.000
-0.0
-0.00
-0.000
-1.0
+0
+0
+0
+0
+0
+0
+0
+0
+1
 4
 9.42
 1.12
@@ -944,15 +944,15 @@ NULL
 12.342
 1.12
 1.122
-15376.00
-15650.0
+15376
+15650
 1575639.95
 9.42
 9.42
-12.560
-1.0000000000
-1524157875171467887.5019052100
-1524157875171467876.3907942000
+12.56
+1
+1524157875171467887.50190521
+1524157875171467876.3907942
 PREHOOK: query: EXPLAIN SELECT key * (value/2) FROM DECIMAL_UDF
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN SELECT key * (value/2) FROM DECIMAL_UDF
@@ -1370,7 +1370,7 @@ POSTHOOK: Input: default@decimal_udf
 0.785
 1
 1.0000000001
-1.000000000099999992710
+1.00000000009999999271
 PREHOOK: query: EXPLAIN SELECT key / (value/2) FROM DECIMAL_UDF  WHERE value is not null and value <> 0
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN SELECT key / (value/2) FROM DECIMAL_UDF  WHERE value is not null and value <> 0
@@ -1574,7 +1574,7 @@ POSTHOOK: Input: default@decimal_udf
 #### A masked pattern was here ####
 4400
 NULL
-0.0000000000
+0
 0
 100
 10
@@ -1593,7 +1593,7 @@ NULL
 0.3
 0.33
 0.333
-1.0
+1
 2
 3.14
 1.12
@@ -1601,15 +1601,15 @@ NULL
 1.122
 1.12
 1.122
-124.00
+124
 125.2
 1255.49
 3.14
 3.14
-3.140
-1.0000000000
-1234567890.1234567890
-1234567890.1234567800
+3.14
+1
+1234567890.123456789
+1234567890.12345678
 PREHOOK: query: -- avg
 EXPLAIN SELECT value, sum(key) / count(key), avg(key), sum(key) FROM DECIMAL_UDF GROUP BY value ORDER BY value
 PREHOOK: type: QUERY
@@ -1696,23 +1696,23 @@ POSTHOOK: query: SELECT value, sum(key) / count(key), avg(key), sum(key) FROM DE
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@decimal_udf
 #### A masked pattern was here ####
--1234567890	-1234567890.123456789	-1234567890.123456789	-1234567890.1234567890
+-1234567890	-1234567890.123456789	-1234567890.123456789	-1234567890.123456789
 -1255	-1255.49	-1255.49	-1255.49
 -11	-1.122	-1.122	-1.122
 -1	-1.12	-1.12	-2.24
-0	0.02538461538461538461538	0.02538461538462	0.3300000000
-1	1.0484	1.0484	5.2420000000
+0	0.02538461538461538461538	0.02538461538462	0.33
+1	1.0484	1.0484	5.242
 2	2	2	4
 3	3.14	3.14	9.42
-4	3.14	3.14	3.140
+4	3.14	3.14	3.14
 10	10	10	10
 20	20	20	20
 100	100	100	100
-124	124	124	124.00
+124	124	124	124
 125	125.2	125.2	125.2
 200	200	200	200
 4400	-4400	-4400	-4400
-1234567890	1234567890.12345678	1234567890.12345678	1234567890.1234567800
+1234567890	1234567890.12345678	1234567890.12345678	1234567890.12345678
 PREHOOK: query: -- negative
 EXPLAIN SELECT -key FROM DECIMAL_UDF
 PREHOOK: type: QUERY
@@ -1762,7 +1762,7 @@ POSTHOOK: Input: default@decimal_udf
 #### A masked pattern was here ####
 4400
 NULL
-0.0000000000
+0
 0
 -100
 -10
@@ -1781,7 +1781,7 @@ NULL
 0.3
 0.33
 0.333
--1.0
+-1
 -2
 -3.14
 1.12
@@ -1789,15 +1789,15 @@ NULL
 1.122
 -1.12
 -1.122
--124.00
+-124
 -125.2
 1255.49
 -3.14
 -3.14
--3.140
--1.0000000000
-1234567890.1234567890
--1234567890.1234567800
+-3.14
+-1
+1234567890.123456789
+-1234567890.12345678
 PREHOOK: query: -- positive
 EXPLAIN SELECT +key FROM DECIMAL_UDF
 PREHOOK: type: QUERY
@@ -1829,7 +1829,7 @@ POSTHOOK: Input: default@decimal_udf
 #### A masked pattern was here ####
 -4400
 NULL
-0.0000000000
+0
 0
 100
 10
@@ -1848,7 +1848,7 @@ NULL
 -0.3
 -0.33
 -0.333
-1.0
+1
 2
 3.14
 -1.12
@@ -1856,15 +1856,15 @@ NULL
 -1.122
 1.12
 1.122
-124.00
+124
 125.2
 -1255.49
 3.14
 3.14
-3.140
-1.0000000000
--1234567890.1234567890
-1234567890.1234567800
+3.14
+1
+-1234567890.123456789
+1234567890.12345678
 PREHOOK: query: -- ceiling
 EXPlAIN SELECT CEIL(key) FROM DECIMAL_UDF
 PREHOOK: type: QUERY
@@ -2082,42 +2082,42 @@ POSTHOOK: query: SELECT ROUND(key, 2) FROM DECIMAL_UDF
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@decimal_udf
 #### A masked pattern was here ####
--4400.00
+-4400
 NULL
-0.00
-0.00
-100.00
-10.00
-1.00
-0.10
+0
+0
+100
+10
+1
+0.1
 0.01
-200.00
-20.00
-2.00
-0.00
-0.20
+200
+20
+2
+0
+0.2
 0.02
-0.30
+0.3
 0.33
 0.33
--0.30
+-0.3
 -0.33
 -0.33
-1.00
-2.00
+1
+2
 3.14
 -1.12
 -1.12
 -1.12
 1.12
 1.12
-124.00
-125.20
+124
+125.2
 -1255.49
 3.14
 3.14
 3.14
-1.00
+1
 -1234567890.12
 1234567890.12
 PREHOOK: query: -- power
@@ -2257,38 +2257,38 @@ NULL
 NULL
 1
 1
-0.0
-0.00
-0.000
+0
+0
+0
 1
 1
 0
 NULL
-0.0
-0.00
-0.10
-0.010
-0.0010
-0.10
-0.010
-0.0010
-0.0
 0
-1.00
+0
+0.1
+0.01
+0.001
+0.1
+0.01
+0.001
+0
+0
+1
 -0.12
 -0.12
 -0.122
 0.44
 0.439
-1.00
-1.0
+1
+1
 -626.745
-1.00
-1.00
-1.000
-0.0000000000
+1
+1
+1
+0
 -617283944.0617283945
-1.0000000000
+1
 PREHOOK: query: -- stddev, var
 EXPLAIN SELECT value, stddev(key), variance(key) FROM DECIMAL_UDF GROUP BY value
 PREHOOK: type: QUERY
@@ -2608,7 +2608,7 @@ POSTHOOK: query: SELECT MIN(key) FROM DECIMAL_UDF
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@decimal_udf
 #### A masked pattern was here ####
--1234567890.1234567890
+-1234567890.123456789
 PREHOOK: query: -- max
 EXPLAIN SELECT MAX(key) FROM DECIMAL_UDF
 PREHOOK: type: QUERY
@@ -2679,7 +2679,7 @@ POSTHOOK: query: SELECT MAX(key) FROM DECIMAL_UDF
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@decimal_udf
 #### A masked pattern was here ####
-1234567890.1234567800
+1234567890.12345678
 PREHOOK: query: -- count
 EXPLAIN SELECT COUNT(key) FROM DECIMAL_UDF
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/tez/vector_reduce_groupby_decimal.q.out b/ql/src/test/results/clientpositive/tez/vector_reduce_groupby_decimal.q.out
index 14acfc5cd7..d38faabba9 100644
--- a/ql/src/test/results/clientpositive/tez/vector_reduce_groupby_decimal.q.out
+++ b/ql/src/test/results/clientpositive/tez/vector_reduce_groupby_decimal.q.out
@@ -132,7 +132,7 @@ POSTHOOK: Input: default@decimal_test
 -1066226047	-9439.0	-5637.8891891892	-6752.515384615385	-5637.8891891892
 -1065117869	2538.0	1515.9405405405	1815.646153846154	1515.9405405405
 -1064949302	6454.0	3854.9567567568	4617.092307692308	3854.9567567568
--1063498122	-11480.0	-6856.9729729730	-8212.615384615387	-6856.9729729730
+-1063498122	-11480.0	-6856.972972973	-8212.615384615387	-6856.972972973
 -1062973443	10541.0	6296.1108108108	7540.869230769231	6296.1108108108
 -1061614989	-4234.0	-2528.9567567568	-3028.938461538462	-2528.9567567568
 -1061057428	-1085.0	-648.0675675676	-776.1923076923077	-648.0675675676
@@ -140,14 +140,14 @@ POSTHOOK: Input: default@decimal_test
 -1059338191	7322.0	4373.4108108108	5238.046153846154	4373.4108108108
 -1059047258	12452.0	7437.5459459459	8907.969230769231	7437.5459459459
 -1056684111	13991.0	8356.7864864865	10008.946153846155	8356.7864864865
--1055945837	13690.0	8177.0	9793.615384615387	8177.0
+-1055945837	13690.0	8177	9793.615384615387	8177
 -1055669248	2570.0	1535.0540540541	1838.538461538462	1535.0540540541
 -1055316250	-14990.0	-8953.4864864865	-10723.615384615385	-8953.4864864865
 -1053385587	14504.0	8663.2	10375.938461538462	8663.2
 -1053238077	-3704.0	-2212.3891891892	-2649.784615384616	-2212.3891891892
 -1052745800	-12404.0	-7408.8756756757	-8873.630769230771	-7408.8756756757
 -1052322972	-7433.0	-4439.7108108108	-5317.453846153847	-4439.7108108108
--1050684541	-8261.0	-4934.2729729730	-5909.792307692308	-4934.2729729730
+-1050684541	-8261.0	-4934.272972973	-5909.792307692308	-4934.272972973
 -1050657303	-6999.0	-4180.4837837838	-5006.976923076923	-4180.4837837838
 -1050165799	8634.0	5157.0648648649	6176.63076923077	5157.0648648649
 -1048934049	-524.0	-312.9837837838	-374.86153846153854	-312.9837837838
@@ -158,12 +158,12 @@ POSTHOOK: Input: default@decimal_test
 -1045087657	-5865.0	-3503.1486486486	-4195.7307692307695	-3503.1486486486
 -1044207190	5381.0	3214.0567567568	3849.4846153846156	3214.0567567568
 -1044093617	-3422.0	-2043.9513513514	-2448.046153846154	-2043.9513513514
--1043573508	16216.0	9685.7729729730	11600.676923076924	9685.7729729730
+-1043573508	16216.0	9685.772972973	11600.676923076924	9685.772972973
 -1043132597	12302.0	7347.9513513514	8800.66153846154	7347.9513513514
 -1043082182	9180.0	5483.1891891892	6567.2307692307695	5483.1891891892
--1042805968	5133.0	3065.9270270270	3672.0692307692307	3065.9270270270
+-1042805968	5133.0	3065.927027027	3672.0692307692307	3065.927027027
 -1042712895	9296.0	5552.4756756757	6650.215384615385	5552.4756756757
--1042396242	9583.0	5723.9000000000	6855.53076923077	5723.9000000000
+-1042396242	9583.0	5723.9	6855.53076923077	5723.9
 -1041734429	-836.0	-499.3405405405	-598.0615384615385	-499.3405405405
 -1041391389	-12970.0	-7746.9459459459	-9278.538461538463	-7746.9459459459
 -1041252354	756.0	451.5567567568	540.8307692307692	451.5567567568
diff --git a/ql/src/test/results/clientpositive/udf_case.q.out b/ql/src/test/results/clientpositive/udf_case.q.out
index 29905ab219..ed0aac0313 100644
--- a/ql/src/test/results/clientpositive/udf_case.q.out
+++ b/ql/src/test/results/clientpositive/udf_case.q.out
@@ -208,4 +208,4 @@ FROM src tablesample (1 rows)
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 #### A masked pattern was here ####
-123.0	123.0	abcd
+123	123.0	abcd
diff --git a/ql/src/test/results/clientpositive/udf_when.q.out b/ql/src/test/results/clientpositive/udf_when.q.out
index 696d7b0068..52f15b374a 100644
--- a/ql/src/test/results/clientpositive/udf_when.q.out
+++ b/ql/src/test/results/clientpositive/udf_when.q.out
@@ -191,4 +191,4 @@ FROM src tablesample (1 rows)
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 #### A masked pattern was here ####
-123.0	123.0	abcd
+123	123.0	abcd
diff --git a/ql/src/test/results/clientpositive/update_all_types.q.out b/ql/src/test/results/clientpositive/update_all_types.q.out
index f1353d068a..eba4dde4cf 100644
--- a/ql/src/test/results/clientpositive/update_all_types.q.out
+++ b/ql/src/test/results/clientpositive/update_all_types.q.out
@@ -87,16 +87,16 @@ POSTHOOK: query: select * from acid_uat order by i
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@acid_uat
 #### A masked pattern was here ####
-11	NULL	-1073279343	-1595604468	11.0	NULL	11.0	1969-12-31 16:00:02.351	NULL	oj1YrV5Wa	oj1YrV5Wa	P76636jJ6qM17d7DIy                  	true
+11	NULL	-1073279343	-1595604468	11.0	NULL	11	1969-12-31 16:00:02.351	NULL	oj1YrV5Wa	oj1YrV5Wa	P76636jJ6qM17d7DIy                  	true
 NULL	-7382	-1073051226	-1887561756	NULL	-7382.0	NULL	NULL	1970-01-01	A34p7oRr2WvUJNf	A34p7oRr2WvUJNf	4hA4KQj2vD3fI6gX82220d              	false
-11	NULL	-1072910839	2048385991	11.0	NULL	11.0	1969-12-31 16:00:02.351	NULL	0iqrc5	0iqrc5	KbaDXiN85adbHRx58v                  	false
+11	NULL	-1072910839	2048385991	11.0	NULL	11	1969-12-31 16:00:02.351	NULL	0iqrc5	0iqrc5	KbaDXiN85adbHRx58v                  	false
 NULL	8373	-1072081801	1864027286	NULL	8373.0	NULL	NULL	1970-01-01	dPkN74F7	dPkN74F7	4KWs6gw7lv2WYd66P                   	true
 NULL	-5470	-1072076362	1864027286	NULL	-5470.0	NULL	NULL	1970-01-01	2uLyD28144vklju213J1mr	2uLyD28144vklju213J1mr	4KWs6gw7lv2WYd66P                   	true
--51	NULL	-1071480828	-1401575336	-51.0	NULL	-51.0	1969-12-31 16:00:08.451	NULL	aw724t8c5558x2xneC624	aw724t8c5558x2xneC624	4uE7l74tESBiKfu7c8wM7GA             	true
-8	NULL	-1071363017	1349676361	8.0	NULL	8.0	1969-12-31 16:00:15.892	NULL	Anj0oF	Anj0oF	IwE1G7Qb0B1NEfV030g                 	true
+-51	NULL	-1071480828	-1401575336	-51.0	NULL	-51	1969-12-31 16:00:08.451	NULL	aw724t8c5558x2xneC624	aw724t8c5558x2xneC624	4uE7l74tESBiKfu7c8wM7GA             	true
+8	NULL	-1071363017	1349676361	8.0	NULL	8	1969-12-31 16:00:15.892	NULL	Anj0oF	Anj0oF	IwE1G7Qb0B1NEfV030g                 	true
 NULL	-741	-1070883071	-1645852809	NULL	-741.0	NULL	NULL	1970-01-01	0ruyd6Y50JpdGRf6HqD	0ruyd6Y50JpdGRf6HqD	xH7445Rals48VOulSyR5F               	false
 NULL	-947	-1070551679	1864027286	NULL	-947.0	NULL	NULL	1970-01-01	iUR3Q	iUR3Q	4KWs6gw7lv2WYd66P                   	false
-11	NULL	-1069736047	-453772520	11.0	NULL	11.0	1969-12-31 16:00:02.351	NULL	k17Am8uPHWk02cEf1jet	k17Am8uPHWk02cEf1jet	qrXLLNX1                            	true
+11	NULL	-1069736047	-453772520	11.0	NULL	11	1969-12-31 16:00:02.351	NULL	k17Am8uPHWk02cEf1jet	k17Am8uPHWk02cEf1jet	qrXLLNX1                            	true
 PREHOOK: query: update acid_uat set
     ti = 1,
     si = 2,
@@ -141,15 +141,15 @@ POSTHOOK: query: select * from acid_uat order by i
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@acid_uat
 #### A masked pattern was here ####
-11	NULL	-1073279343	-1595604468	11.0	NULL	11.0	1969-12-31 16:00:02.351	NULL	oj1YrV5Wa	oj1YrV5Wa	P76636jJ6qM17d7DIy                  	true
+11	NULL	-1073279343	-1595604468	11.0	NULL	11	1969-12-31 16:00:02.351	NULL	oj1YrV5Wa	oj1YrV5Wa	P76636jJ6qM17d7DIy                  	true
 NULL	-7382	-1073051226	-1887561756	NULL	-7382.0	NULL	NULL	1970-01-01	A34p7oRr2WvUJNf	A34p7oRr2WvUJNf	4hA4KQj2vD3fI6gX82220d              	false
-11	NULL	-1072910839	2048385991	11.0	NULL	11.0	1969-12-31 16:00:02.351	NULL	0iqrc5	0iqrc5	KbaDXiN85adbHRx58v                  	false
+11	NULL	-1072910839	2048385991	11.0	NULL	11	1969-12-31 16:00:02.351	NULL	0iqrc5	0iqrc5	KbaDXiN85adbHRx58v                  	false
 NULL	8373	-1072081801	1864027286	NULL	8373.0	NULL	NULL	1970-01-01	dPkN74F7	dPkN74F7	4KWs6gw7lv2WYd66P                   	true
 NULL	-5470	-1072076362	1864027286	NULL	-5470.0	NULL	NULL	1970-01-01	2uLyD28144vklju213J1mr	2uLyD28144vklju213J1mr	4KWs6gw7lv2WYd66P                   	true
--51	NULL	-1071480828	-1401575336	-51.0	NULL	-51.0	1969-12-31 16:00:08.451	NULL	aw724t8c5558x2xneC624	aw724t8c5558x2xneC624	4uE7l74tESBiKfu7c8wM7GA             	true
-8	NULL	-1071363017	1349676361	8.0	NULL	8.0	1969-12-31 16:00:15.892	NULL	Anj0oF	Anj0oF	IwE1G7Qb0B1NEfV030g                 	true
+-51	NULL	-1071480828	-1401575336	-51.0	NULL	-51	1969-12-31 16:00:08.451	NULL	aw724t8c5558x2xneC624	aw724t8c5558x2xneC624	4uE7l74tESBiKfu7c8wM7GA             	true
+8	NULL	-1071363017	1349676361	8.0	NULL	8	1969-12-31 16:00:15.892	NULL	Anj0oF	Anj0oF	IwE1G7Qb0B1NEfV030g                 	true
 NULL	-947	-1070551679	1864027286	NULL	-947.0	NULL	NULL	1970-01-01	iUR3Q	iUR3Q	4KWs6gw7lv2WYd66P                   	false
-11	NULL	-1069736047	-453772520	11.0	NULL	11.0	1969-12-31 16:00:02.351	NULL	k17Am8uPHWk02cEf1jet	k17Am8uPHWk02cEf1jet	qrXLLNX1                            	true
+11	NULL	-1069736047	-453772520	11.0	NULL	11	1969-12-31 16:00:02.351	NULL	k17Am8uPHWk02cEf1jet	k17Am8uPHWk02cEf1jet	qrXLLNX1                            	true
 1	2	3	4	3.14	6.28	5.99	NULL	2014-09-01	its a beautiful day in the neighbhorhood	a beautiful day for a neighbor	wont you be mine                    	true
 PREHOOK: query: update acid_uat set
   ti = ti * 2,
@@ -175,13 +175,13 @@ POSTHOOK: query: select * from acid_uat order by i
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@acid_uat
 #### A masked pattern was here ####
-11	NULL	-1073279343	-1595604468	11.0	NULL	11.0	1969-12-31 16:00:02.351	NULL	oj1YrV5Wa	oj1YrV5Wa	P76636jJ6qM17d7DIy                  	true
+11	NULL	-1073279343	-1595604468	11.0	NULL	11	1969-12-31 16:00:02.351	NULL	oj1YrV5Wa	oj1YrV5Wa	P76636jJ6qM17d7DIy                  	true
 NULL	-7382	-1073051226	-1887561756	NULL	-7382.0	NULL	NULL	1970-01-01	A34p7oRr2WvUJNf	A34p7oRr2WvUJNf	4hA4KQj2vD3fI6gX82220d              	false
-11	NULL	-1072910839	2048385991	11.0	NULL	11.0	1969-12-31 16:00:02.351	NULL	0iqrc5	0iqrc5	KbaDXiN85adbHRx58v                  	false
+11	NULL	-1072910839	2048385991	11.0	NULL	11	1969-12-31 16:00:02.351	NULL	0iqrc5	0iqrc5	KbaDXiN85adbHRx58v                  	false
 NULL	8373	-1072081801	1864027286	NULL	8373.0	NULL	NULL	1970-01-01	dPkN74F7	dPkN74F7	4KWs6gw7lv2WYd66P                   	true
 NULL	-5470	-1072076362	1864027286	NULL	-5470.0	NULL	NULL	1970-01-01	2uLyD28144vklju213J1mr	2uLyD28144vklju213J1mr	4KWs6gw7lv2WYd66P                   	true
--102	-51	-1071480828	-1401575336	-51.0	-51.0	-51.0	1969-12-31 16:00:08.451	NULL	aw724t8c5558x2xneC624	aw724t8c5558x2xneC624	4uE7l74tESBiKfu7c8wM7GA             	true
-8	NULL	-1071363017	1349676361	8.0	NULL	8.0	1969-12-31 16:00:15.892	NULL	Anj0oF	Anj0oF	IwE1G7Qb0B1NEfV030g                 	true
+-102	-51	-1071480828	-1401575336	-51.0	-51.0	-51	1969-12-31 16:00:08.451	NULL	aw724t8c5558x2xneC624	aw724t8c5558x2xneC624	4uE7l74tESBiKfu7c8wM7GA             	true
+8	NULL	-1071363017	1349676361	8.0	NULL	8	1969-12-31 16:00:15.892	NULL	Anj0oF	Anj0oF	IwE1G7Qb0B1NEfV030g                 	true
 NULL	-947	-1070551679	1864027286	NULL	-947.0	NULL	NULL	1970-01-01	iUR3Q	iUR3Q	4KWs6gw7lv2WYd66P                   	false
-11	NULL	-1069736047	-453772520	11.0	NULL	11.0	1969-12-31 16:00:02.351	NULL	k17Am8uPHWk02cEf1jet	k17Am8uPHWk02cEf1jet	qrXLLNX1                            	true
+11	NULL	-1069736047	-453772520	11.0	NULL	11	1969-12-31 16:00:02.351	NULL	k17Am8uPHWk02cEf1jet	k17Am8uPHWk02cEf1jet	qrXLLNX1                            	true
 1	2	3	4	3.14	6.28	5.99	NULL	2014-09-01	its a beautiful day in the neighbhorhood	a beautiful day for a neighbor	wont you be mine                    	true
diff --git a/ql/src/test/results/clientpositive/vector_aggregate_9.q.out b/ql/src/test/results/clientpositive/vector_aggregate_9.q.out
index c0fe295e0e..3a3e2de1ca 100644
--- a/ql/src/test/results/clientpositive/vector_aggregate_9.q.out
+++ b/ql/src/test/results/clientpositive/vector_aggregate_9.q.out
@@ -164,4 +164,4 @@ POSTHOOK: query: select min(dc), max(dc), sum(dc), avg(dc) from vectortab2korc
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@vectortab2korc
 #### A masked pattern was here ####
--4997414117561.546875	4994550248722.298828	-10252745435816.024410	-5399023399.587163986308583465
+-4997414117561.546875	4994550248722.298828	-10252745435816.02441	-5399023399.587163986308583465
diff --git a/ql/src/test/results/clientpositive/vector_between_in.q.out b/ql/src/test/results/clientpositive/vector_between_in.q.out
index e21dd85228..22c40feb12 100644
--- a/ql/src/test/results/clientpositive/vector_between_in.q.out
+++ b/ql/src/test/results/clientpositive/vector_between_in.q.out
@@ -643,19 +643,19 @@ POSTHOOK: Input: default@decimal_date_test
 -18.5162162162
 -17.3216216216
 -16.7243243243
--16.1270270270
+-16.127027027
 -15.5297297297
 -10.7513513514
 -9.5567567568
 -8.3621621622
--5.9729729730
+-5.972972973
 -3.5837837838
 4.1810810811
 4.7783783784
 4.7783783784
 5.3756756757
-5.9729729730
-5.9729729730
+5.972972973
+5.972972973
 11.3486486486
 11.3486486486
 11.9459459459
diff --git a/ql/src/test/results/clientpositive/vector_data_types.q.out b/ql/src/test/results/clientpositive/vector_data_types.q.out
index 07d58ed124..65aa5e9b3c 100644
--- a/ql/src/test/results/clientpositive/vector_data_types.q.out
+++ b/ql/src/test/results/clientpositive/vector_data_types.q.out
@@ -151,7 +151,7 @@ POSTHOOK: query: SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc OR
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1korc
 #### A masked pattern was here ####
-108	301	65536	4294967357	90.05	17.59	true	ethan johnson	2013-03-01 09:11:58.703271	75.70	undecided
+108	301	65536	4294967357	90.05	17.59	true	ethan johnson	2013-03-01 09:11:58.703271	75.7	undecided
 118	497	65536	4294967381	50.32	12.72	false	david nixon	2013-03-01 09:11:58.703285	83.48	values clariffication
 18	280	65536	4294967320	32.92	45.94	false	holly white	2013-03-01 09:11:58.703086	58.86	topology
 69	489	65536	4294967404	33.52	17.99	false	oscar ichabod	2013-03-01 09:11:58.703247	32.68	topology
@@ -237,7 +237,7 @@ POSTHOOK: query: SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc OR
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1korc
 #### A masked pattern was here ####
-108	301	65536	4294967357	90.05	17.59	true	ethan johnson	2013-03-01 09:11:58.703271	75.70	undecided
+108	301	65536	4294967357	90.05	17.59	true	ethan johnson	2013-03-01 09:11:58.703271	75.7	undecided
 118	497	65536	4294967381	50.32	12.72	false	david nixon	2013-03-01 09:11:58.703285	83.48	values clariffication
 18	280	65536	4294967320	32.92	45.94	false	holly white	2013-03-01 09:11:58.703086	58.86	topology
 69	489	65536	4294967404	33.52	17.99	false	oscar ichabod	2013-03-01 09:11:58.703247	32.68	topology
diff --git a/ql/src/test/results/clientpositive/vector_decimal_2.q.out b/ql/src/test/results/clientpositive/vector_decimal_2.q.out
index d27381067f..fceb027c4e 100644
--- a/ql/src/test/results/clientpositive/vector_decimal_2.q.out
+++ b/ql/src/test/results/clientpositive/vector_decimal_2.q.out
@@ -1423,7 +1423,7 @@ POSTHOOK: query: select cast(0.99999999999999999999 as decimal(20,19)) as c from
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@decimal_2
 #### A masked pattern was here ####
-1.0
+1
 PREHOOK: query: explain
 select cast('0.99999999999999999999' as decimal(20,20)) as c from decimal_2 order by c
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/vector_decimal_3.q.out b/ql/src/test/results/clientpositive/vector_decimal_3.q.out
index e982e1b848..75f872e279 100644
--- a/ql/src/test/results/clientpositive/vector_decimal_3.q.out
+++ b/ql/src/test/results/clientpositive/vector_decimal_3.q.out
@@ -47,7 +47,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@decimal_3
 #### A masked pattern was here ####
 NULL	0
--1234567890.1234567890	-1234567890
+-1234567890.123456789	-1234567890
 -4400	4400
 -1255.49	-1255
 -1.122	-11
@@ -56,7 +56,7 @@ NULL	0
 -0.333	0
 -0.33	0
 -0.3	0
-0.000000000000000000	0
+0	0
 0	0
 0	0
 0.01	0
@@ -67,8 +67,8 @@ NULL	0
 0.33	0
 0.333	0
 1	1
-1.0	1
-1.000000000000000000	1
+1	1
+1	1
 1.12	1
 1.122	1
 2	2
@@ -76,14 +76,14 @@ NULL	0
 3.14	3
 3.14	3
 3.14	3
-3.140	4
+3.14	4
 10	10
 20	20
 100	100
-124.00	124
+124	124
 125.2	125
 200	200
-1234567890.1234567800	1234567890
+1234567890.12345678	1234567890
 PREHOOK: query: SELECT * FROM DECIMAL_3 ORDER BY key DESC, value DESC
 PREHOOK: type: QUERY
 PREHOOK: Input: default@decimal_3
@@ -92,14 +92,14 @@ POSTHOOK: query: SELECT * FROM DECIMAL_3 ORDER BY key DESC, value DESC
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@decimal_3
 #### A masked pattern was here ####
-1234567890.1234567800	1234567890
+1234567890.12345678	1234567890
 200	200
 125.2	125
-124.00	124
+124	124
 100	100
 20	20
 10	10
-3.140	4
+3.14	4
 3.14	3
 3.14	3
 3.14	3
@@ -107,8 +107,8 @@ POSTHOOK: Input: default@decimal_3
 2	2
 1.122	1
 1.12	1
-1.000000000000000000	1
-1.0	1
+1	1
+1	1
 1	1
 0.333	0
 0.33	0
@@ -119,7 +119,7 @@ POSTHOOK: Input: default@decimal_3
 0.01	0
 0	0
 0	0
-0.000000000000000000	0
+0	0
 -0.3	0
 -0.33	0
 -0.333	0
@@ -128,7 +128,7 @@ POSTHOOK: Input: default@decimal_3
 -1.122	-11
 -1255.49	-1255
 -4400	4400
--1234567890.1234567890	-1234567890
+-1234567890.123456789	-1234567890
 NULL	0
 PREHOOK: query: SELECT * FROM DECIMAL_3 ORDER BY key, value
 PREHOOK: type: QUERY
@@ -139,7 +139,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@decimal_3
 #### A masked pattern was here ####
 NULL	0
--1234567890.1234567890	-1234567890
+-1234567890.123456789	-1234567890
 -4400	4400
 -1255.49	-1255
 -1.122	-11
@@ -148,7 +148,7 @@ NULL	0
 -0.333	0
 -0.33	0
 -0.3	0
-0.000000000000000000	0
+0	0
 0	0
 0	0
 0.01	0
@@ -159,8 +159,8 @@ NULL	0
 0.33	0
 0.333	0
 1	1
-1.0	1
-1.000000000000000000	1
+1	1
+1	1
 1.12	1
 1.122	1
 2	2
@@ -168,14 +168,14 @@ NULL	0
 3.14	3
 3.14	3
 3.14	3
-3.140	4
+3.14	4
 10	10
 20	20
 100	100
-124.00	124
+124	124
 125.2	125
 200	200
-1234567890.1234567800	1234567890
+1234567890.12345678	1234567890
 PREHOOK: query: SELECT DISTINCT key FROM DECIMAL_3 ORDER BY key
 PREHOOK: type: QUERY
 PREHOOK: Input: default@decimal_3
@@ -185,7 +185,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@decimal_3
 #### A masked pattern was here ####
 NULL
--1234567890.1234567890
+-1234567890.123456789
 -4400
 -1255.49
 -1.122
@@ -193,7 +193,7 @@ NULL
 -0.333
 -0.33
 -0.3
-0.000000000000000000
+0
 0.01
 0.02
 0.1
@@ -209,10 +209,10 @@ NULL
 10
 20
 100
-124.00
+124
 125.2
 200
-1234567890.1234567800
+1234567890.12345678
 PREHOOK: query: SELECT key, sum(value) FROM DECIMAL_3 GROUP BY key ORDER BY key
 PREHOOK: type: QUERY
 PREHOOK: Input: default@decimal_3
@@ -222,7 +222,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@decimal_3
 #### A masked pattern was here ####
 NULL	0
--1234567890.1234567890	-1234567890
+-1234567890.123456789	-1234567890
 -4400	4400
 -1255.49	-1255
 -1.122	-11
@@ -230,7 +230,7 @@ NULL	0
 -0.333	0
 -0.33	0
 -0.3	0
-0.000000000000000000	0
+0	0
 0.01	0
 0.02	0
 0.1	0
@@ -246,10 +246,10 @@ NULL	0
 10	10
 20	20
 100	100
-124.00	124
+124	124
 125.2	125
 200	200
-1234567890.1234567800	1234567890
+1234567890.12345678	1234567890
 PREHOOK: query: SELECT value, sum(key) FROM DECIMAL_3 GROUP BY value ORDER BY value
 PREHOOK: type: QUERY
 PREHOOK: Input: default@decimal_3
@@ -258,23 +258,23 @@ POSTHOOK: query: SELECT value, sum(key) FROM DECIMAL_3 GROUP BY value ORDER BY v
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@decimal_3
 #### A masked pattern was here ####
--1234567890	-1234567890.1234567890
+-1234567890	-1234567890.123456789
 -1255	-1255.49
 -11	-1.122
 -1	-2.24
-0	0.330000000000000000
-1	5.242000000000000000
+0	0.33
+1	5.242
 2	4
 3	9.42
-4	3.140
+4	3.14
 10	10
 20	20
 100	100
-124	124.00
+124	124
 125	125.2
 200	200
 4400	-4400
-1234567890	1234567890.1234567800
+1234567890	1234567890.12345678
 PREHOOK: query: SELECT * FROM DECIMAL_3 a JOIN DECIMAL_3 b ON (a.key = b.key) ORDER BY a.key, a.value, b.value
 PREHOOK: type: QUERY
 PREHOOK: Input: default@decimal_3
@@ -283,7 +283,7 @@ POSTHOOK: query: SELECT * FROM DECIMAL_3 a JOIN DECIMAL_3 b ON (a.key = b.key) O
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@decimal_3
 #### A masked pattern was here ####
--1234567890.1234567890	-1234567890	-1234567890.1234567890	-1234567890
+-1234567890.123456789	-1234567890	-1234567890.123456789	-1234567890
 -4400	4400	-4400	4400
 -1255.49	-1255	-1255.49	-1255
 -1.122	-11	-1.122	-11
@@ -294,7 +294,11 @@ POSTHOOK: Input: default@decimal_3
 -0.333	0	-0.333	0
 -0.33	0	-0.33	0
 -0.3	0	-0.3	0
-0.000000000000000000	0	0.000000000000000000	0
+0	0	0	0
+0	0	0	0
+0	0	0	0
+0	0	0	0
+0	0	0	0
 0	0	0	0
 0	0	0	0
 0	0	0	0
@@ -307,8 +311,14 @@ POSTHOOK: Input: default@decimal_3
 0.33	0	0.33	0
 0.333	0	0.333	0
 1	1	1	1
-1.0	1	1.0	1
-1.000000000000000000	1	1.000000000000000000	1
+1	1	1	1
+1	1	1	1
+1	1	1	1
+1	1	1	1
+1	1	1	1
+1	1	1	1
+1	1	1	1
+1	1	1	1
 1.12	1	1.12	1
 1.122	1	1.122	1
 2	2	2	2
@@ -324,14 +334,20 @@ POSTHOOK: Input: default@decimal_3
 3.14	3	3.14	3
 3.14	3	3.14	3
 3.14	3	3.14	3
-3.140	4	3.140	4
+3.14	3	3.14	4
+3.14	3	3.14	4
+3.14	3	3.14	4
+3.14	4	3.14	3
+3.14	4	3.14	3
+3.14	4	3.14	3
+3.14	4	3.14	4
 10	10	10	10
 20	20	20	20
 100	100	100	100
-124.00	124	124.00	124
+124	124	124	124
 125.2	125	125.2	125
 200	200	200	200
-1234567890.1234567800	1234567890	1234567890.1234567800	1234567890
+1234567890.12345678	1234567890	1234567890.12345678	1234567890
 PREHOOK: query: SELECT * FROM DECIMAL_3 WHERE key=3.14 ORDER BY key, value
 PREHOOK: type: QUERY
 PREHOOK: Input: default@decimal_3
@@ -343,7 +359,7 @@ POSTHOOK: Input: default@decimal_3
 3.14	3
 3.14	3
 3.14	3
-3.140	4
+3.14	4
 PREHOOK: query: SELECT * FROM DECIMAL_3 WHERE key=3.140 ORDER BY key, value
 PREHOOK: type: QUERY
 PREHOOK: Input: default@decimal_3
@@ -355,7 +371,7 @@ POSTHOOK: Input: default@decimal_3
 3.14	3
 3.14	3
 3.14	3
-3.140	4
+3.14	4
 PREHOOK: query: DROP TABLE DECIMAL_3_txt
 PREHOOK: type: DROPTABLE
 PREHOOK: Input: default@decimal_3_txt
diff --git a/ql/src/test/results/clientpositive/vector_decimal_4.q.out b/ql/src/test/results/clientpositive/vector_decimal_4.q.out
index 483ae1f279..613f5a8da9 100644
--- a/ql/src/test/results/clientpositive/vector_decimal_4.q.out
+++ b/ql/src/test/results/clientpositive/vector_decimal_4.q.out
@@ -57,7 +57,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@decimal_4_1
 #### A masked pattern was here ####
 NULL	0
--1234567890.1234567890	-1234567890
+-1234567890.123456789	-1234567890
 -4400	4400
 -1255.49	-1255
 -1.122	-11
@@ -66,7 +66,7 @@ NULL	0
 -0.333	0
 -0.33	0
 -0.3	0
-0.0000000000000000000000000	0
+0	0
 0	0
 0	0
 0.01	0
@@ -78,7 +78,7 @@ NULL	0
 0.333	0
 0.9999999999999999999999999	1
 1	1
-1.0	1
+1	1
 1.12	1
 1.122	1
 2	2
@@ -86,14 +86,14 @@ NULL	0
 3.14	3
 3.14	3
 3.14	3
-3.140	4
+3.14	4
 10	10
 20	20
 100	100
-124.00	124
+124	124
 125.2	125
 200	200
-1234567890.1234567800	1234567890
+1234567890.12345678	1234567890
 PREHOOK: query: SELECT * FROM DECIMAL_4_2 ORDER BY key, value
 PREHOOK: type: QUERY
 PREHOOK: Input: default@decimal_4_2
@@ -103,7 +103,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@decimal_4_2
 #### A masked pattern was here ####
 NULL	NULL
--1234567890.1234567890	-3703703670.3703703670
+-1234567890.123456789	-3703703670.370370367
 -4400	-13200
 -1255.49	-3766.47
 -1.122	-3.366
@@ -112,7 +112,7 @@ NULL	NULL
 -0.333	-0.999
 -0.33	-0.99
 -0.3	-0.9
-0.0000000000000000000000000	0.0000000000000000000000000
+0	0
 0	0
 0	0
 0.01	0.03
@@ -124,7 +124,7 @@ NULL	NULL
 0.333	0.999
 0.9999999999999999999999999	2.9999999999999999999999997
 1	3
-1.0	3.0
+1	3
 1.12	3.36
 1.122	3.366
 2	6
@@ -132,14 +132,14 @@ NULL	NULL
 3.14	9.42
 3.14	9.42
 3.14	9.42
-3.140	9.420
+3.14	9.42
 10	30
 20	60
 100	300
-124.00	372.00
+124	372
 125.2	375.6
 200	600
-1234567890.1234567800	3703703670.3703703400
+1234567890.12345678	3703703670.37037034
 PREHOOK: query: SELECT * FROM DECIMAL_4_2 ORDER BY key
 PREHOOK: type: QUERY
 PREHOOK: Input: default@decimal_4_2
@@ -149,7 +149,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@decimal_4_2
 #### A masked pattern was here ####
 NULL	NULL
--1234567890.1234567890	-3703703670.3703703670
+-1234567890.123456789	-3703703670.370370367
 -4400	-13200
 -1255.49	-3766.47
 -1.122	-3.366
@@ -158,7 +158,7 @@ NULL	NULL
 -0.333	-0.999
 -0.33	-0.99
 -0.3	-0.9
-0.0000000000000000000000000	0.0000000000000000000000000
+0	0
 0	0
 0	0
 0.01	0.03
@@ -170,7 +170,7 @@ NULL	NULL
 0.333	0.999
 0.9999999999999999999999999	2.9999999999999999999999997
 1	3
-1.0	3.0
+1	3
 1.12	3.36
 1.122	3.366
 2	6
@@ -178,14 +178,14 @@ NULL	NULL
 3.14	9.42
 3.14	9.42
 3.14	9.42
-3.140	9.420
+3.14	9.42
 10	30
 20	60
 100	300
-124.00	372.00
+124	372
 125.2	375.6
 200	600
-1234567890.1234567800	3703703670.3703703400
+1234567890.12345678	3703703670.37037034
 PREHOOK: query: SELECT * FROM DECIMAL_4_2 ORDER BY key, value
 PREHOOK: type: QUERY
 PREHOOK: Input: default@decimal_4_2
@@ -195,7 +195,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@decimal_4_2
 #### A masked pattern was here ####
 NULL	NULL
--1234567890.1234567890	-3703703670.3703703670
+-1234567890.123456789	-3703703670.370370367
 -4400	-13200
 -1255.49	-3766.47
 -1.122	-3.366
@@ -204,7 +204,7 @@ NULL	NULL
 -0.333	-0.999
 -0.33	-0.99
 -0.3	-0.9
-0.0000000000000000000000000	0.0000000000000000000000000
+0	0
 0	0
 0	0
 0.01	0.03
@@ -216,7 +216,7 @@ NULL	NULL
 0.333	0.999
 0.9999999999999999999999999	2.9999999999999999999999997
 1	3
-1.0	3.0
+1	3
 1.12	3.36
 1.122	3.366
 2	6
@@ -224,14 +224,14 @@ NULL	NULL
 3.14	9.42
 3.14	9.42
 3.14	9.42
-3.140	9.420
+3.14	9.42
 10	30
 20	60
 100	300
-124.00	372.00
+124	372
 125.2	375.6
 200	600
-1234567890.1234567800	3703703670.3703703400
+1234567890.12345678	3703703670.37037034
 PREHOOK: query: DROP TABLE DECIMAL_4_1
 PREHOOK: type: DROPTABLE
 PREHOOK: Input: default@decimal_4_1
diff --git a/ql/src/test/results/clientpositive/vector_decimal_5.q.out b/ql/src/test/results/clientpositive/vector_decimal_5.q.out
index 01b5f42b44..34c33513eb 100644
--- a/ql/src/test/results/clientpositive/vector_decimal_5.q.out
+++ b/ql/src/test/results/clientpositive/vector_decimal_5.q.out
@@ -67,7 +67,7 @@ NULL
 -0.333
 -0.33
 -0.3
-0.00000
+0
 0
 0
 0.01
@@ -78,8 +78,8 @@ NULL
 0.33
 0.333
 1
-1.0
-1.00000
+1
+1
 1.12
 1.122
 2
@@ -87,11 +87,11 @@ NULL
 3.14
 3.14
 3.14
-3.140
+3.14
 10
 20
 100
-124.00
+124
 125.2
 200
 PREHOOK: query: SELECT DISTINCT key FROM DECIMAL_5 ORDER BY key
@@ -110,7 +110,7 @@ NULL
 -0.333
 -0.33
 -0.3
-0.00000
+0
 0.01
 0.02
 0.1
@@ -126,7 +126,7 @@ NULL
 10
 20
 100
-124.00
+124
 125.2
 200
 PREHOOK: query: SELECT cast(key as decimal) FROM DECIMAL_5
@@ -185,7 +185,7 @@ POSTHOOK: Input: default@decimal_5
 #### A masked pattern was here ####
 NULL
 NULL
-0.000
+0
 0
 100
 10
@@ -204,7 +204,7 @@ NULL
 -0.3
 -0.33
 -0.333
-1.0
+1
 2
 3.14
 -1.12
@@ -212,13 +212,13 @@ NULL
 -1.122
 1.12
 1.122
-124.00
+124
 125.2
 NULL
 3.14
 3.14
-3.140
-1.000
+3.14
+1
 NULL
 NULL
 PREHOOK: query: DROP TABLE DECIMAL_5_txt
diff --git a/ql/src/test/results/clientpositive/vector_decimal_6.q.out b/ql/src/test/results/clientpositive/vector_decimal_6.q.out
index 7ecd50056a..9cdd7fc03b 100644
--- a/ql/src/test/results/clientpositive/vector_decimal_6.q.out
+++ b/ql/src/test/results/clientpositive/vector_decimal_6.q.out
@@ -125,20 +125,20 @@ NULL	1234567890
 -1.12	-1
 -0.333	0
 -0.3	0
-0.00000	0
+0	0
 0	0
 0.333	0
-1.0	1
-1.00000	1
+1	1
+1	1
 1.12	1
 1.122	1
 2	2
 3.14	3
 3.14	3
-3.140	4
+3.14	4
 10	10
 10.73433	5
-124.00	124
+124	124
 125.2	125
 23232.23435	2
 PREHOOK: query: SELECT * FROM DECIMAL_6_2 ORDER BY key, value
@@ -157,20 +157,20 @@ NULL	0
 -1.12	-1
 -0.333	0
 -0.3	0
-0.0000	0
+0	0
 0	0
 0.333	0
-1.0	1
-1.0000	1
+1	1
+1	1
 1.12	1
 1.122	1
 2	2
 3.14	3
 3.14	3
-3.140	4
+3.14	4
 10	10
 10.7343	5
-124.00	124
+124	124
 125.2	125
 23232.2344	2
 2389432.2375	3
@@ -213,16 +213,16 @@ NULL
 -0.333
 -0.3
 -0.3
-0.00000
-0.0000
+0
+0
 0
 0
 0.333
 0.333
-1.0
-1.0
-1.0000
-1.00000
+1
+1
+1
+1
 1.12
 1.12
 1.122
@@ -233,14 +233,14 @@ NULL
 3.14
 3.14
 3.14
-3.140
-3.140
+3.14
+3.14
 10
 10
 10.7343
 10.73433
-124.00
-124.00
+124
+124
 125.2
 125.2
 23232.23435
diff --git a/ql/src/test/results/clientpositive/vector_decimal_aggregate.q.out b/ql/src/test/results/clientpositive/vector_decimal_aggregate.q.out
index 7f2cd53144..586f29b2b0 100644
--- a/ql/src/test/results/clientpositive/vector_decimal_aggregate.q.out
+++ b/ql/src/test/results/clientpositive/vector_decimal_aggregate.q.out
@@ -108,9 +108,9 @@ POSTHOOK: Input: default@decimal_vgby
 #### A masked pattern was here ####
 NULL	3072	9318.4351351351	-4298.1513513514	5018444.1081079808	3072	11160.715384615385	-5147.907692307693	6010604.3076923073536
 -3728	6	5831542.269248378	-3367.6517567568	5817556.0411483778	6	6984454.211097692	-4033.445769230769	6967702.8672438458471
--563	2	-515.6210729730	-3367.6517567568	-3883.2728297298	2	-617.5607769230769	-4033.445769230769	-4651.0065461538459
+-563	2	-515.621072973	-3367.6517567568	-3883.2728297298	2	-617.5607769230769	-4033.445769230769	-4651.0065461538459
 762	2	5831542.269248378	1531.2194054054	5833073.4886537834	2	6984454.211097692	1833.9456923076925	6986288.1567899996925
-6981	3	5831542.269248378	-515.6210729730	5830511.0271024320	3	6984454.211097692	-617.5607769230769	6983219.0895438458462
+6981	3	5831542.269248378	-515.621072973	5830511.027102432	3	6984454.211097692	-617.5607769230769	6983219.0895438458462
 253665376	1024	9767.0054054054	-9779.5486486487	-347484.0818378374	1024	11697.969230769231	-11712.99230769231	-416182.64030769233089
 528534767	1024	5831542.269248378	-9777.1594594595	11646372.8607481068	1024	6984454.211097692	-11710.130769230771	13948892.79980307629003
 626923679	1024	9723.4027027027	-9778.9513513514	10541.0525297287	1024	11645.746153846154	-11712.276923076923	12625.04759999997746
@@ -206,9 +206,9 @@ POSTHOOK: Input: default@decimal_vgby
 #### A masked pattern was here ####
 NULL	3072	9318.4351351351	-4298.1513513514	5018444.1081079808	1633.60810810806667	5695.483082135364	5696.4103077145055	3072	11160.715384615385	-5147.907692307693	6010604.3076923073536	1956.576923076922966667	6821.495748565159	6822.606289190924
 -3728	6	5831542.269248378	-3367.6517567568	5817556.0411483778	969592.67352472963333	2174330.2092403853	2381859.406131774	6	6984454.211097692	-4033.445769230769	6967702.8672438458471	1161283.811207307641183333	2604201.2704476737	2852759.5602156054
--563	2	-515.6210729730	-3367.6517567568	-3883.2728297298	-1941.6364148649	1426.0153418918999	2016.6902366556308	2	-617.5607769230769	-4033.445769230769	-4651.0065461538459	-2325.50327307692295	1707.9424961538462	2415.395441814127
+-563	2	-515.621072973	-3367.6517567568	-3883.2728297298	-1941.6364148649	1426.0153418918999	2016.6902366556308	2	-617.5607769230769	-4033.445769230769	-4651.0065461538459	-2325.50327307692295	1707.9424961538462	2415.395441814127
 762	2	5831542.269248378	1531.2194054054	5833073.4886537834	2916536.7443268917	2915005.5249214866	4122440.3477364695	2	6984454.211097692	1833.9456923076925	6986288.1567899996925	3493144.07839499984625	3491310.1327026924	4937458.140118758
-6981	3	5831542.269248378	-515.6210729730	5830511.0271024320	1943503.67570081066667	2749258.455012492	3367140.1929065133	3	6984454.211097692	-617.5607769230769	6983219.0895438458462	2327739.696514615282066667	3292794.4113115156	4032833.0678006653
+6981	3	5831542.269248378	-515.621072973	5830511.027102432	1943503.67570081066667	2749258.455012492	3367140.1929065133	3	6984454.211097692	-617.5607769230769	6983219.0895438458462	2327739.696514615282066667	3292794.4113115156	4032833.0678006653
 253665376	1024	9767.0054054054	-9779.5486486487	-347484.0818378374	-339.33992366976309	5708.9563478862	5711.745967572779	1024	11697.969230769231	-11712.99230769231	-416182.64030769233089	-406.428359675480791885	6837.632716002934	6840.973851172274
 528534767	1024	5831542.269248378	-9777.1594594595	11646372.8607481068	11373.41099682432305	257528.92988206653	257654.7686043977	1024	6984454.211097692	-11710.130769230771	13948892.79980307629003	13621.965624807691689482	308443.1074570801	308593.82484083984
 626923679	1024	9723.4027027027	-9778.9513513514	10541.0525297287	10.29399661106318	5742.09145323734	5744.897264034267	1024	11645.746153846154	-11712.276923076923	12625.04759999997746	12.329148046874977988	6877.318722794877	6880.679250101603
diff --git a/ql/src/test/results/clientpositive/vector_decimal_cast.q.out b/ql/src/test/results/clientpositive/vector_decimal_cast.q.out
index d4890466d4..2053452e6a 100644
--- a/ql/src/test/results/clientpositive/vector_decimal_cast.q.out
+++ b/ql/src/test/results/clientpositive/vector_decimal_cast.q.out
@@ -46,13 +46,13 @@ POSTHOOK: query: SELECT cdouble, cint, cboolean1, ctimestamp1, CAST(cdouble AS D
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc
 #### A masked pattern was here ####
--13326.0	528534767	true	1969-12-31 15:59:46.674	-13326.0	528534767	1	-13
--15813.0	528534767	true	1969-12-31 15:59:55.787	-15813.0	528534767	1	-4
--9566.0	528534767	true	1969-12-31 15:59:44.187	-9566.0	528534767	1	-16
-15007.0	528534767	true	1969-12-31 15:59:50.434	15007.0	528534767	1	-10
-7021.0	528534767	true	1969-12-31 16:00:15.007	7021.0	528534767	1	15
-4963.0	528534767	true	1969-12-31 16:00:07.021	4963.0	528534767	1	7
--7824.0	528534767	true	1969-12-31 16:00:04.963	-7824.0	528534767	1	5
--15431.0	528534767	true	1969-12-31 15:59:52.176	-15431.0	528534767	1	-8
--15549.0	528534767	true	1969-12-31 15:59:44.569	-15549.0	528534767	1	-15
-5780.0	528534767	true	1969-12-31 15:59:44.451	5780.0	528534767	1	-16
+-13326.0	528534767	true	1969-12-31 15:59:46.674	-13326	528534767	1	-13
+-15813.0	528534767	true	1969-12-31 15:59:55.787	-15813	528534767	1	-4
+-9566.0	528534767	true	1969-12-31 15:59:44.187	-9566	528534767	1	-16
+15007.0	528534767	true	1969-12-31 15:59:50.434	15007	528534767	1	-10
+7021.0	528534767	true	1969-12-31 16:00:15.007	7021	528534767	1	15
+4963.0	528534767	true	1969-12-31 16:00:07.021	4963	528534767	1	7
+-7824.0	528534767	true	1969-12-31 16:00:04.963	-7824	528534767	1	5
+-15431.0	528534767	true	1969-12-31 15:59:52.176	-15431	528534767	1	-8
+-15549.0	528534767	true	1969-12-31 15:59:44.569	-15549	528534767	1	-15
+5780.0	528534767	true	1969-12-31 15:59:44.451	5780	528534767	1	-16
diff --git a/ql/src/test/results/clientpositive/vector_decimal_expressions.q.out b/ql/src/test/results/clientpositive/vector_decimal_expressions.q.out
index 2c15b9abb9..9c3b0768f6 100644
--- a/ql/src/test/results/clientpositive/vector_decimal_expressions.q.out
+++ b/ql/src/test/results/clientpositive/vector_decimal_expressions.q.out
@@ -57,12 +57,12 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@decimal_test
 #### A masked pattern was here ####
 19699.417463617423	-12507.913305613346	0.8351496686995997	2.8303425077026896E7	3.6405405405	8963	10735	-17	8963	true	10735.776923076923	8963.641	10735.776923076923	1969-12-31 18:29:23.64054054
-9216.339708939685	-5851.806444906470	0.8353975893550668	6195112.1797296945	3.6243243243	4193	5022	-98	4193	true	5022.715384615385	4193.6245	5022.715384615385	1969-12-31 17:09:53.624324324
+9216.339708939685	-5851.80644490647	0.8353975893550668	6195112.1797296945	3.6243243243	4193	5022	-98	4193	true	5022.715384615385	4193.6245	5022.715384615385	1969-12-31 17:09:53.624324324
 6514.8403326403464	-4136.5212058211928	0.8355907765708067	3095563.9418919063	4.3864864865	2964	3550	-34	2964	true	3550.4538461538464	2964.3865	3550.4538461538464	1969-12-31 16:49:24.386486486
 7587.301455301477	-4817.467775467754	0.8354976172734904	4198623.24324327	2.3783783784	3452	4134	38	3452	true	4134.923076923077	3452.3784	4134.923076923077	1969-12-31 16:57:32.378378378
-19197.9729729730	-12189.5270270270	0.835155361813429	2.6880848817567654E7	5.4729729730	8735	10462	-34	8735	true	10462.5	8735.473	10462.5	1969-12-31 18:25:35.472972973
+19197.972972973	-12189.527027027	0.835155361813429	2.6880848817567654E7	5.472972973	8735	10462	-34	8735	true	10462.5	8735.473	10462.5	1969-12-31 18:25:35.472972973
 17098.9945945946	-10856.8054054054	0.8351828165813104	2.132423090270272E7	0.3945945946	7780	9318	102	7780	true	9318.6	7780.3945	9318.6	1969-12-31 18:09:40.394594594
 12433.723076923077	-7894.646153846154	0.8352770361086894	1.12754688E7	7.6	5657	6776	120	5657	true	6776.123076923077	5657.6	6776.123076923077	1969-12-31 17:34:17.6
 7247.316839916862	-4601.598544698524	0.8355241651897876	3830775.6932432684	7.6783783784	3297	3949	109	3297	true	3949.638461538462	3297.6785	3949.638461538462	1969-12-31 16:54:57.678378378
-14757.1700623700465	-9369.8914760914930	0.8352226654922171	1.5883214124324286E7	4.8162162162	6714	8042	106	6714	true	8042.3538461538465	6714.8164	8042.3538461538465	1969-12-31 17:51:54.816216216
+14757.1700623700465	-9369.891476091493	0.8352226654922171	1.5883214124324286E7	4.8162162162	6714	8042	106	6714	true	8042.3538461538465	6714.8164	8042.3538461538465	1969-12-31 17:51:54.816216216
 10964.832016631993	-6961.991060291086	0.8353232978714221	8768719.779729689	9.2243243243	4989	5975	87	4989	true	5975.607692307693	4989.224	5975.607692307693	1969-12-31 17:23:09.224324324
diff --git a/ql/src/test/results/clientpositive/vector_decimal_mapjoin.q.out b/ql/src/test/results/clientpositive/vector_decimal_mapjoin.q.out
index 193e6f760a..c88322d34f 100644
--- a/ql/src/test/results/clientpositive/vector_decimal_mapjoin.q.out
+++ b/ql/src/test/results/clientpositive/vector_decimal_mapjoin.q.out
@@ -113,26 +113,26 @@ POSTHOOK: query: SELECT l.cint, r.cint, l.cdecimal1, r.cdecimal2
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@decimal_mapjoin
 #### A masked pattern was here ####
-6981	6981	-515.6210729730	-617.5607769230769
-6981	6981	-515.6210729730	-617.5607769230769
-6981	6981	-515.6210729730	-617.5607769230769
-6981	6981	-515.6210729730	-617.5607769230769
-6981	6981	-515.6210729730	6984454.211097692
-6981	6981	-515.6210729730	6984454.211097692
-6981	6981	-515.6210729730	NULL
-6981	6981	-515.6210729730	NULL
-6981	6981	-515.6210729730	NULL
-6981	6981	-515.6210729730	NULL
-6981	6981	-515.6210729730	NULL
-6981	6981	-515.6210729730	NULL
-6981	6981	-515.6210729730	NULL
-6981	6981	-515.6210729730	NULL
-6981	6981	-515.6210729730	NULL
-6981	6981	-515.6210729730	NULL
-6981	6981	-515.6210729730	NULL
-6981	6981	-515.6210729730	NULL
-6981	6981	-515.6210729730	NULL
-6981	6981	-515.6210729730	NULL
+6981	6981	-515.621072973	-617.5607769230769
+6981	6981	-515.621072973	-617.5607769230769
+6981	6981	-515.621072973	-617.5607769230769
+6981	6981	-515.621072973	-617.5607769230769
+6981	6981	-515.621072973	6984454.211097692
+6981	6981	-515.621072973	6984454.211097692
+6981	6981	-515.621072973	NULL
+6981	6981	-515.621072973	NULL
+6981	6981	-515.621072973	NULL
+6981	6981	-515.621072973	NULL
+6981	6981	-515.621072973	NULL
+6981	6981	-515.621072973	NULL
+6981	6981	-515.621072973	NULL
+6981	6981	-515.621072973	NULL
+6981	6981	-515.621072973	NULL
+6981	6981	-515.621072973	NULL
+6981	6981	-515.621072973	NULL
+6981	6981	-515.621072973	NULL
+6981	6981	-515.621072973	NULL
+6981	6981	-515.621072973	NULL
 6981	6981	5831542.269248378	-617.5607769230769
 6981	6981	5831542.269248378	-617.5607769230769
 6981	6981	5831542.269248378	6984454.211097692
diff --git a/ql/src/test/results/clientpositive/vector_decimal_precision.q.out b/ql/src/test/results/clientpositive/vector_decimal_precision.q.out
index 87898644df..438ebc4071 100644
--- a/ql/src/test/results/clientpositive/vector_decimal_precision.q.out
+++ b/ql/src/test/results/clientpositive/vector_decimal_precision.q.out
@@ -99,13 +99,13 @@ NULL
 NULL
 NULL
 NULL
-0.0000000000
-0.0000000000
-0.0000000000
-0.0000000000
 0
-0.1234567890
-0.1234567890
+0
+0
+0
+0
+0.123456789
+0.123456789
 1.2345678901
 1.2345678901
 1.2345678901
@@ -129,7 +129,7 @@ NULL
 123456789.0123456
 123456789.0123456789
 1234567890.123456
-1234567890.1234567890
+1234567890.123456789
 PREHOOK: query: SELECT dec, dec + 1, dec - 1 FROM DECIMAL_PRECISION ORDER BY dec
 PREHOOK: type: QUERY
 PREHOOK: Input: default@decimal_precision
@@ -182,13 +182,13 @@ NULL	NULL	NULL
 NULL	NULL	NULL
 NULL	NULL	NULL
 NULL	NULL	NULL
-0.0000000000	1.0000000000	-1.0000000000
-0.0000000000	1.0000000000	-1.0000000000
-0.0000000000	1.0000000000	-1.0000000000
-0.0000000000	1.0000000000	-1.0000000000
 0	1	-1
-0.1234567890	1.1234567890	-0.8765432110
-0.1234567890	1.1234567890	-0.8765432110
+0	1	-1
+0	1	-1
+0	1	-1
+0	1	-1
+0.123456789	1.123456789	-0.876543211
+0.123456789	1.123456789	-0.876543211
 1.2345678901	2.2345678901	0.2345678901
 1.2345678901	2.2345678901	0.2345678901
 1.2345678901	2.2345678901	0.2345678901
@@ -212,7 +212,7 @@ NULL	NULL	NULL
 123456789.0123456	123456790.0123456	123456788.0123456
 123456789.0123456789	123456790.0123456789	123456788.0123456789
 1234567890.123456	1234567891.123456	1234567889.123456
-1234567890.1234567890	1234567891.1234567890	1234567889.1234567890
+1234567890.123456789	1234567891.123456789	1234567889.123456789
 PREHOOK: query: SELECT dec, dec * 2, dec / 3  FROM DECIMAL_PRECISION ORDER BY dec
 PREHOOK: type: QUERY
 PREHOOK: Input: default@decimal_precision
@@ -265,13 +265,13 @@ NULL	NULL	NULL
 NULL	NULL	NULL
 NULL	NULL	NULL
 NULL	NULL	NULL
-0.0000000000	0.0000000000	0
-0.0000000000	0.0000000000	0
-0.0000000000	0.0000000000	0
-0.0000000000	0.0000000000	0
 0	0	0
-0.1234567890	0.2469135780	0.041152263
-0.1234567890	0.2469135780	0.041152263
+0	0	0
+0	0	0
+0	0	0
+0	0	0
+0.123456789	0.246913578	0.041152263
+0.123456789	0.246913578	0.041152263
 1.2345678901	2.4691357802	0.411522630033
 1.2345678901	2.4691357802	0.411522630033
 1.2345678901	2.4691357802	0.411522630033
@@ -281,9 +281,9 @@ NULL	NULL	NULL
 123.4567890123	246.9135780246	41.1522630041
 123.4567890123	246.9135780246	41.1522630041
 123.4567890123	246.9135780246	41.1522630041
-1234.5678901235	2469.1357802470	411.522630041167
-1234.5678901235	2469.1357802470	411.522630041167
-1234.5678901235	2469.1357802470	411.522630041167
+1234.5678901235	2469.135780247	411.522630041167
+1234.5678901235	2469.135780247	411.522630041167
+1234.5678901235	2469.135780247	411.522630041167
 12345.6789012346	24691.3578024692	4115.226300411533
 12345.6789012346	24691.3578024692	4115.226300411533
 123456.7890123456	246913.5780246912	41152.2630041152
@@ -295,7 +295,7 @@ NULL	NULL	NULL
 123456789.0123456	246913578.0246912	41152263.0041152
 123456789.0123456789	246913578.0246913578	41152263.0041152263
 1234567890.123456	2469135780.246912	411522630.041152
-1234567890.1234567890	2469135780.2469135780	411522630.041152263
+1234567890.123456789	2469135780.246913578	411522630.041152263
 PREHOOK: query: SELECT dec, dec / 9 FROM DECIMAL_PRECISION ORDER BY dec
 PREHOOK: type: QUERY
 PREHOOK: Input: default@decimal_precision
@@ -348,13 +348,13 @@ NULL	NULL
 NULL	NULL
 NULL	NULL
 NULL	NULL
-0.0000000000	0
-0.0000000000	0
-0.0000000000	0
-0.0000000000	0
 0	0
-0.1234567890	0.013717421
-0.1234567890	0.013717421
+0	0
+0	0
+0	0
+0	0
+0.123456789	0.013717421
+0.123456789	0.013717421
 1.2345678901	0.137174210011
 1.2345678901	0.137174210011
 1.2345678901	0.137174210011
@@ -378,7 +378,7 @@ NULL	NULL
 123456789.0123456	13717421.001371733333
 123456789.0123456789	13717421.0013717421
 1234567890.123456	137174210.013717333333
-1234567890.1234567890	137174210.013717421
+1234567890.123456789	137174210.013717421
 PREHOOK: query: SELECT dec, dec / 27 FROM DECIMAL_PRECISION ORDER BY dec
 PREHOOK: type: QUERY
 PREHOOK: Input: default@decimal_precision
@@ -431,13 +431,13 @@ NULL	NULL
 NULL	NULL
 NULL	NULL
 NULL	NULL
-0.0000000000	0
-0.0000000000	0
-0.0000000000	0
-0.0000000000	0
 0	0
-0.1234567890	0.0045724736667
-0.1234567890	0.0045724736667
+0	0
+0	0
+0	0
+0	0
+0.123456789	0.0045724736667
+0.123456789	0.0045724736667
 1.2345678901	0.0457247366704
 1.2345678901	0.0457247366704
 1.2345678901	0.0457247366704
@@ -461,7 +461,7 @@ NULL	NULL
 123456789.0123456	4572473.6671239111111
 123456789.0123456789	4572473.6671239140333
 1234567890.123456	45724736.6712391111111
-1234567890.1234567890	45724736.6712391403333
+1234567890.123456789	45724736.6712391403333
 PREHOOK: query: SELECT dec, dec * dec FROM DECIMAL_PRECISION ORDER BY dec
 PREHOOK: type: QUERY
 PREHOOK: Input: default@decimal_precision
@@ -514,13 +514,13 @@ NULL	NULL
 NULL	NULL
 NULL	NULL
 NULL	NULL
-0.0000000000	0.00000000000000000000
-0.0000000000	0.00000000000000000000
-0.0000000000	0.00000000000000000000
-0.0000000000	0.00000000000000000000
 0	0
-0.1234567890	0.01524157875019052100
-0.1234567890	0.01524157875019052100
+0	0
+0	0
+0	0
+0	0
+0.123456789	0.015241578750190521
+0.123456789	0.015241578750190521
 1.2345678901	1.52415787526596567801
 1.2345678901	1.52415787526596567801
 1.2345678901	1.52415787526596567801
@@ -544,7 +544,7 @@ NULL	NULL
 123456789.0123456	15241578753238817.26870921383936
 123456789.0123456789	15241578753238836.75019051998750190521
 1234567890.123456	NULL
-1234567890.1234567890	NULL
+1234567890.123456789	NULL
 PREHOOK: query: EXPLAIN SELECT avg(dec), sum(dec) FROM DECIMAL_PRECISION
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN SELECT avg(dec), sum(dec) FROM DECIMAL_PRECISION
diff --git a/ql/src/test/results/clientpositive/vector_decimal_round_2.q.out b/ql/src/test/results/clientpositive/vector_decimal_round_2.q.out
index 482f536050..c4a015dd42 100644
--- a/ql/src/test/results/clientpositive/vector_decimal_round_2.q.out
+++ b/ql/src/test/results/clientpositive/vector_decimal_round_2.q.out
@@ -114,7 +114,7 @@ FROM decimal_tbl_1_orc ORDER BY d
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@decimal_tbl_1_orc
 #### A masked pattern was here ####
-55555	55555	55555.0	55555.00	55555.000	55560	55600	56000	60000	100000	0	0	0
+55555	55555	55555	55555	55555	55560	55600	56000	60000	100000	0	0	0
 PREHOOK: query: create table decimal_tbl_2_orc (pos decimal(38,18), neg decimal(38,18)) 
 STORED AS ORC
 PREHOOK: type: CREATETABLE
@@ -226,7 +226,7 @@ FROM decimal_tbl_2_orc ORDER BY p
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@decimal_tbl_2_orc
 #### A masked pattern was here ####
-125	125	125.3	125.32	125.315	125.3150	130	100	0	0	-125	-125	-125.3	-125.32	-125.315	-125.3150	-130	-100	0	0
+125	125	125.3	125.32	125.315	125.315	130	100	0	0	-125	-125	-125.3	-125.32	-125.315	-125.315	-130	-100	0	0
 PREHOOK: query: create table decimal_tbl_3_orc (dec decimal(38,18)) 
 STORED AS ORC
 PREHOOK: type: CREATETABLE
@@ -381,7 +381,7 @@ FROM decimal_tbl_3_orc ORDER BY d
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@decimal_tbl_3_orc
 #### A masked pattern was here ####
-0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	3	3.1	3.14	3.142	3.1416	3.14159	3.141593	3.1415927	3.14159265	3.141592654	3.1415926536	3.14159265359	3.141592653590	3.1415926535898	3.1415926535898	3.14159265358979	3.141592653589793	3.1415926535897930
+0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	3	3.1	3.14	3.142	3.1416	3.14159	3.141593	3.1415927	3.14159265	3.141592654	3.1415926536	3.14159265359	3.14159265359	3.1415926535898	3.1415926535898	3.14159265358979	3.141592653589793	3.141592653589793
 PREHOOK: query: create table decimal_tbl_4_orc (pos decimal(38,18), neg decimal(38,18)) 
 STORED AS ORC
 PREHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/vector_decimal_trailing.q.out b/ql/src/test/results/clientpositive/vector_decimal_trailing.q.out
index cb0b5a2739..ffdb1c9b67 100644
--- a/ql/src/test/results/clientpositive/vector_decimal_trailing.q.out
+++ b/ql/src/test/results/clientpositive/vector_decimal_trailing.q.out
@@ -76,13 +76,13 @@ POSTHOOK: Input: default@decimal_trailing
 0	0	0
 1	0	0
 2	NULL	NULL
-3	1.0000	1.00000000
-4	10.0000	10.00000000
-5	100.0000	100.00000000
-6	1000.0000	1000.00000000
-7	10000.0000	10000.00000000
-8	100000.0000	100000.00000000
-9	NULL	1000000.00000000
+3	1	1
+4	10	10
+5	100	100
+6	1000	1000
+7	10000	10000
+8	100000	100000
+9	NULL	1000000
 10	NULL	NULL
 11	NULL	NULL
 12	NULL	NULL
@@ -91,18 +91,18 @@ POSTHOOK: Input: default@decimal_trailing
 15	NULL	NULL
 16	NULL	NULL
 17	NULL	NULL
-18	1.0000	1.00000000
-19	10.000	10.0000000
-20	100.00	100.000000
-21	1000.0	1000.00000
-22	100000	10000.0000
-23	0.0000	0.00000000
-24	0.000	0.0000000
-25	0.00	0.000000
-26	0.0	0.00000
-27	0	0.00000
-28	12313.2000	134134.31252500
-29	99999.9990	134134.31242553
+18	1	1
+19	10	10
+20	100	100
+21	1000	1000
+22	100000	10000
+23	0	0
+24	0	0
+25	0	0
+26	0	0
+27	0	0
+28	12313.2	134134.312525
+29	99999.999	134134.31242553
 PREHOOK: query: DROP TABLE DECIMAL_TRAILING_txt
 PREHOOK: type: DROPTABLE
 PREHOOK: Input: default@decimal_trailing_txt
diff --git a/ql/src/test/results/clientpositive/vector_decimal_udf.q.out b/ql/src/test/results/clientpositive/vector_decimal_udf.q.out
index 24a87c58cb..05cd5b369f 100644
--- a/ql/src/test/results/clientpositive/vector_decimal_udf.q.out
+++ b/ql/src/test/results/clientpositive/vector_decimal_udf.q.out
@@ -94,7 +94,7 @@ POSTHOOK: Input: default@decimal_udf
 #### A masked pattern was here ####
 -8800
 NULL
-0.0000000000
+0
 0
 200
 20
@@ -113,7 +113,7 @@ NULL
 -0.6
 -0.66
 -0.666
-2.0
+2
 4
 6.28
 -2.24
@@ -121,15 +121,15 @@ NULL
 -2.244
 2.24
 2.244
-248.00
+248
 250.4
 -2510.98
 6.28
 6.28
-6.280
-2.0000000000
--2469135780.2469135780
-2469135780.2469135600
+6.28
+2
+-2469135780.246913578
+2469135780.24691356
 PREHOOK: query: EXPLAIN SELECT key + value FROM DECIMAL_UDF
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN SELECT key + value FROM DECIMAL_UDF
@@ -174,7 +174,7 @@ POSTHOOK: Input: default@decimal_udf
 #### A masked pattern was here ####
 0
 NULL
-0.0000000000
+0
 0
 200
 20
@@ -193,7 +193,7 @@ NULL
 -0.3
 -0.33
 -0.333
-2.0
+2
 4
 6.14
 -2.12
@@ -201,15 +201,15 @@ NULL
 -12.122
 2.12
 2.122
-248.00
+248
 250.2
 -2510.49
 6.14
 6.14
-7.140
-2.0000000000
--2469135780.1234567890
-2469135780.1234567800
+7.14
+2
+-2469135780.123456789
+2469135780.12345678
 PREHOOK: query: EXPLAIN SELECT key + (value/2) FROM DECIMAL_UDF
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN SELECT key + (value/2) FROM DECIMAL_UDF
@@ -415,42 +415,42 @@ POSTHOOK: Input: default@decimal_udf
 #### A masked pattern was here ####
 0
 NULL
-0.0000000000
 0
 0
 0
 0
-0.0
-0.00
 0
 0
 0
 0
-0.0
-0.00
-0.0
-0.00
-0.000
-0.0
-0.00
-0.000
-0.0
 0
-0.00
-0.00
-0.00
-0.000
-0.00
-0.000
-0.00
-0.0
-0.00
-0.00
-0.00
-0.000
-0.0000000000
-0.0000000000
-0.0000000000
+0
+0
+0
+0
+0
+0
+0
+0
+0
+0
+0
+0
+0
+0
+0
+0
+0
+0
+0
+0
+0
+0
+0
+0
+0
+0
+0
 PREHOOK: query: EXPLAIN SELECT key - value FROM DECIMAL_UDF
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN SELECT key - value FROM DECIMAL_UDF
@@ -495,7 +495,7 @@ POSTHOOK: Input: default@decimal_udf
 #### A masked pattern was here ####
 -8800
 NULL
-0.0000000000
+0
 0
 0
 0
@@ -514,7 +514,7 @@ NULL
 -0.3
 -0.33
 -0.333
-0.0
+0
 0
 0.14
 -0.12
@@ -522,15 +522,15 @@ NULL
 9.878
 0.12
 0.122
-0.00
+0
 0.2
 -0.49
 0.14
 0.14
--0.860
-0.0000000000
--0.1234567890
-0.1234567800
+-0.86
+0
+-0.123456789
+0.12345678
 PREHOOK: query: EXPLAIN SELECT key - (value/2) FROM DECIMAL_UDF
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN SELECT key - (value/2) FROM DECIMAL_UDF
@@ -736,7 +736,7 @@ POSTHOOK: Input: default@decimal_udf
 #### A masked pattern was here ####
 19360000
 NULL
-0.00000000000000000000
+0
 0
 10000
 100
@@ -755,7 +755,7 @@ NULL
 0.09
 0.1089
 0.110889
-1.00
+1
 4
 9.8596
 1.2544
@@ -763,13 +763,13 @@ NULL
 1.258884
 1.2544
 1.258884
-15376.0000
+15376
 15675.04
 1576255.1401
 9.8596
 9.8596
-9.859600
-1.00000000000000000000
+9.8596
+1
 NULL
 NULL
 PREHOOK: query: EXPLAIN SELECT key, value FROM DECIMAL_UDF where key * value > 0
@@ -823,7 +823,7 @@ POSTHOOK: Input: default@decimal_udf
 200	200
 20	20
 2	2
-1.0	1
+1	1
 2	2
 3.14	3
 -1.12	-1
@@ -831,15 +831,15 @@ POSTHOOK: Input: default@decimal_udf
 -1.122	-11
 1.12	1
 1.122	1
-124.00	124
+124	124
 125.2	125
 -1255.49	-1255
 3.14	3
 3.14	3
-3.140	4
-1.0000000000	1
--1234567890.1234567890	-1234567890
-1234567890.1234567800	1234567890
+3.14	4
+1	1
+-1234567890.123456789	-1234567890
+1234567890.12345678	1234567890
 PREHOOK: query: EXPLAIN SELECT key * value FROM DECIMAL_UDF
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN SELECT key * value FROM DECIMAL_UDF
@@ -884,26 +884,26 @@ POSTHOOK: Input: default@decimal_udf
 #### A masked pattern was here ####
 -19360000
 NULL
-0.0000000000
+0
 0
 10000
 100
 1
-0.0
-0.00
+0
+0
 40000
 400
 4
 0
-0.0
-0.00
-0.0
-0.00
-0.000
-0.0
-0.00
-0.000
-1.0
+0
+0
+0
+0
+0
+0
+0
+0
+1
 4
 9.42
 1.12
@@ -911,15 +911,15 @@ NULL
 12.342
 1.12
 1.122
-15376.00
-15650.0
+15376
+15650
 1575639.95
 9.42
 9.42
-12.560
-1.0000000000
-1524157875171467887.5019052100
-1524157875171467876.3907942000
+12.56
+1
+1524157875171467887.50190521
+1524157875171467876.3907942
 PREHOOK: query: EXPLAIN SELECT key * (value/2) FROM DECIMAL_UDF
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN SELECT key * (value/2) FROM DECIMAL_UDF
@@ -1319,7 +1319,7 @@ POSTHOOK: Input: default@decimal_udf
 0.785
 1
 1.0000000001
-1.000000000099999992710
+1.00000000009999999271
 PREHOOK: query: EXPLAIN SELECT key / (value/2) FROM DECIMAL_UDF  WHERE value is not null and value <> 0
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN SELECT key / (value/2) FROM DECIMAL_UDF  WHERE value is not null and value <> 0
@@ -1514,7 +1514,7 @@ POSTHOOK: Input: default@decimal_udf
 #### A masked pattern was here ####
 4400
 NULL
-0.0000000000
+0
 0
 100
 10
@@ -1533,7 +1533,7 @@ NULL
 0.3
 0.33
 0.333
-1.0
+1
 2
 3.14
 1.12
@@ -1541,15 +1541,15 @@ NULL
 1.122
 1.12
 1.122
-124.00
+124
 125.2
 1255.49
 3.14
 3.14
-3.140
-1.0000000000
-1234567890.1234567890
-1234567890.1234567800
+3.14
+1
+1234567890.123456789
+1234567890.12345678
 PREHOOK: query: -- avg
 EXPLAIN SELECT value, sum(key) / count(key), avg(key), sum(key) FROM DECIMAL_UDF GROUP BY value ORDER BY value
 PREHOOK: type: QUERY
@@ -1639,23 +1639,23 @@ POSTHOOK: query: SELECT value, sum(key) / count(key), avg(key), sum(key) FROM DE
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@decimal_udf
 #### A masked pattern was here ####
--1234567890	-1234567890.123456789	-1234567890.123456789	-1234567890.1234567890
+-1234567890	-1234567890.123456789	-1234567890.123456789	-1234567890.123456789
 -1255	-1255.49	-1255.49	-1255.49
 -11	-1.122	-1.122	-1.122
 -1	-1.12	-1.12	-2.24
-0	0.02538461538461538461538	0.02538461538462	0.3300000000
-1	1.0484	1.0484	5.2420000000
+0	0.02538461538461538461538	0.02538461538462	0.33
+1	1.0484	1.0484	5.242
 2	2	2	4
 3	3.14	3.14	9.42
-4	3.14	3.14	3.140
+4	3.14	3.14	3.14
 10	10	10	10
 20	20	20	20
 100	100	100	100
-124	124	124	124.00
+124	124	124	124
 125	125.2	125.2	125.2
 200	200	200	200
 4400	-4400	-4400	-4400
-1234567890	1234567890.12345678	1234567890.12345678	1234567890.1234567800
+1234567890	1234567890.12345678	1234567890.12345678	1234567890.12345678
 PREHOOK: query: -- negative
 EXPLAIN SELECT -key FROM DECIMAL_UDF
 PREHOOK: type: QUERY
@@ -1702,7 +1702,7 @@ POSTHOOK: Input: default@decimal_udf
 #### A masked pattern was here ####
 4400
 NULL
-0.0000000000
+0
 0
 -100
 -10
@@ -1721,7 +1721,7 @@ NULL
 0.3
 0.33
 0.333
--1.0
+-1
 -2
 -3.14
 1.12
@@ -1729,15 +1729,15 @@ NULL
 1.122
 -1.12
 -1.122
--124.00
+-124
 -125.2
 1255.49
 -3.14
 -3.14
--3.140
--1.0000000000
-1234567890.1234567890
--1234567890.1234567800
+-3.14
+-1
+1234567890.123456789
+-1234567890.12345678
 PREHOOK: query: -- positive
 EXPLAIN SELECT +key FROM DECIMAL_UDF
 PREHOOK: type: QUERY
@@ -1771,7 +1771,7 @@ POSTHOOK: Input: default@decimal_udf
 #### A masked pattern was here ####
 -4400
 NULL
-0.0000000000
+0
 0
 100
 10
@@ -1790,7 +1790,7 @@ NULL
 -0.3
 -0.33
 -0.333
-1.0
+1
 2
 3.14
 -1.12
@@ -1798,15 +1798,15 @@ NULL
 -1.122
 1.12
 1.122
-124.00
+124
 125.2
 -1255.49
 3.14
 3.14
-3.140
-1.0000000000
--1234567890.1234567890
-1234567890.1234567800
+3.14
+1
+-1234567890.123456789
+1234567890.12345678
 PREHOOK: query: -- ceiling
 EXPlAIN SELECT CEIL(key) FROM DECIMAL_UDF
 PREHOOK: type: QUERY
@@ -2015,42 +2015,42 @@ POSTHOOK: query: SELECT ROUND(key, 2) FROM DECIMAL_UDF
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@decimal_udf
 #### A masked pattern was here ####
--4400.00
+-4400
 NULL
-0.00
-0.00
-100.00
-10.00
-1.00
-0.10
+0
+0
+100
+10
+1
+0.1
 0.01
-200.00
-20.00
-2.00
-0.00
-0.20
+200
+20
+2
+0
+0.2
 0.02
-0.30
+0.3
 0.33
 0.33
--0.30
+-0.3
 -0.33
 -0.33
-1.00
-2.00
+1
+2
 3.14
 -1.12
 -1.12
 -1.12
 1.12
 1.12
-124.00
-125.20
+124
+125.2
 -1255.49
 3.14
 3.14
 3.14
-1.00
+1
 -1234567890.12
 1234567890.12
 PREHOOK: query: -- power
@@ -2184,38 +2184,38 @@ NULL
 NULL
 1
 1
-0.0
-0.00
-0.000
+0
+0
+0
 1
 1
 0
 NULL
-0.0
-0.00
-0.10
-0.010
-0.0010
-0.10
-0.010
-0.0010
-0.0
 0
-1.00
+0
+0.1
+0.01
+0.001
+0.1
+0.01
+0.001
+0
+0
+1
 -0.12
 -0.12
 -0.122
 0.44
 0.439
-1.00
-1.0
+1
+1
 -626.745
-1.00
-1.00
-1.000
-0.0000000000
+1
+1
+1
+0
 -617283944.0617283945
-1.0000000000
+1
 PREHOOK: query: -- stddev, var
 EXPLAIN SELECT value, stddev(key), variance(key) FROM DECIMAL_UDF GROUP BY value
 PREHOOK: type: QUERY
@@ -2510,7 +2510,7 @@ POSTHOOK: query: SELECT MIN(key) FROM DECIMAL_UDF
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@decimal_udf
 #### A masked pattern was here ####
--1234567890.1234567890
+-1234567890.123456789
 PREHOOK: query: -- max
 EXPLAIN SELECT MAX(key) FROM DECIMAL_UDF
 PREHOOK: type: QUERY
@@ -2574,7 +2574,7 @@ POSTHOOK: query: SELECT MAX(key) FROM DECIMAL_UDF
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@decimal_udf
 #### A masked pattern was here ####
-1234567890.1234567800
+1234567890.12345678
 PREHOOK: query: -- count
 EXPLAIN SELECT COUNT(key) FROM DECIMAL_UDF
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/vector_reduce_groupby_decimal.q.out b/ql/src/test/results/clientpositive/vector_reduce_groupby_decimal.q.out
index 2343508f76..527a117187 100644
--- a/ql/src/test/results/clientpositive/vector_reduce_groupby_decimal.q.out
+++ b/ql/src/test/results/clientpositive/vector_reduce_groupby_decimal.q.out
@@ -134,7 +134,7 @@ POSTHOOK: Input: default@decimal_test
 -1066226047	-9439.0	-5637.8891891892	-6752.515384615385	-5637.8891891892
 -1065117869	2538.0	1515.9405405405	1815.646153846154	1515.9405405405
 -1064949302	6454.0	3854.9567567568	4617.092307692308	3854.9567567568
--1063498122	-11480.0	-6856.9729729730	-8212.615384615387	-6856.9729729730
+-1063498122	-11480.0	-6856.972972973	-8212.615384615387	-6856.972972973
 -1062973443	10541.0	6296.1108108108	7540.869230769231	6296.1108108108
 -1061614989	-4234.0	-2528.9567567568	-3028.938461538462	-2528.9567567568
 -1061057428	-1085.0	-648.0675675676	-776.1923076923077	-648.0675675676
@@ -142,14 +142,14 @@ POSTHOOK: Input: default@decimal_test
 -1059338191	7322.0	4373.4108108108	5238.046153846154	4373.4108108108
 -1059047258	12452.0	7437.5459459459	8907.969230769231	7437.5459459459
 -1056684111	13991.0	8356.7864864865	10008.946153846155	8356.7864864865
--1055945837	13690.0	8177.0	9793.615384615387	8177.0
+-1055945837	13690.0	8177	9793.615384615387	8177
 -1055669248	2570.0	1535.0540540541	1838.538461538462	1535.0540540541
 -1055316250	-14990.0	-8953.4864864865	-10723.615384615385	-8953.4864864865
 -1053385587	14504.0	8663.2	10375.938461538462	8663.2
 -1053238077	-3704.0	-2212.3891891892	-2649.784615384616	-2212.3891891892
 -1052745800	-12404.0	-7408.8756756757	-8873.630769230771	-7408.8756756757
 -1052322972	-7433.0	-4439.7108108108	-5317.453846153847	-4439.7108108108
--1050684541	-8261.0	-4934.2729729730	-5909.792307692308	-4934.2729729730
+-1050684541	-8261.0	-4934.272972973	-5909.792307692308	-4934.272972973
 -1050657303	-6999.0	-4180.4837837838	-5006.976923076923	-4180.4837837838
 -1050165799	8634.0	5157.0648648649	6176.63076923077	5157.0648648649
 -1048934049	-524.0	-312.9837837838	-374.86153846153854	-312.9837837838
@@ -160,12 +160,12 @@ POSTHOOK: Input: default@decimal_test
 -1045087657	-5865.0	-3503.1486486486	-4195.7307692307695	-3503.1486486486
 -1044207190	5381.0	3214.0567567568	3849.4846153846156	3214.0567567568
 -1044093617	-3422.0	-2043.9513513514	-2448.046153846154	-2043.9513513514
--1043573508	16216.0	9685.7729729730	11600.676923076924	9685.7729729730
+-1043573508	16216.0	9685.772972973	11600.676923076924	9685.772972973
 -1043132597	12302.0	7347.9513513514	8800.66153846154	7347.9513513514
 -1043082182	9180.0	5483.1891891892	6567.2307692307695	5483.1891891892
--1042805968	5133.0	3065.9270270270	3672.0692307692307	3065.9270270270
+-1042805968	5133.0	3065.927027027	3672.0692307692307	3065.927027027
 -1042712895	9296.0	5552.4756756757	6650.215384615385	5552.4756756757
--1042396242	9583.0	5723.9000000000	6855.53076923077	5723.9000000000
+-1042396242	9583.0	5723.9	6855.53076923077	5723.9
 -1041734429	-836.0	-499.3405405405	-598.0615384615385	-499.3405405405
 -1041391389	-12970.0	-7746.9459459459	-9278.538461538463	-7746.9459459459
 -1041252354	756.0	451.5567567568	540.8307692307692	451.5567567568
diff --git a/ql/src/test/results/clientpositive/windowing_decimal.q.out b/ql/src/test/results/clientpositive/windowing_decimal.q.out
index 194a916d85..60563bad27 100644
--- a/ql/src/test/results/clientpositive/windowing_decimal.q.out
+++ b/ql/src/test/results/clientpositive/windowing_decimal.q.out
@@ -57,8 +57,8 @@ from part_dec
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@part_dec
 #### A masked pattern was here ####
-Manufacturer#1	1173.15	1173.15	2346.30
-Manufacturer#1	1173.15	1173.15	2346.30
+Manufacturer#1	1173.15	1173.15	2346.3
+Manufacturer#1	1173.15	1173.15	2346.3
 Manufacturer#1	1414.42	1173.15	3760.72
 Manufacturer#1	1602.59	1173.15	5363.31
 Manufacturer#1	1632.66	1173.15	6995.97
@@ -76,7 +76,7 @@ Manufacturer#3	1922.98	1190.27	7532.61
 Manufacturer#4	1206.26	1206.26	1206.26
 Manufacturer#4	1290.35	1206.26	2496.61
 Manufacturer#4	1375.42	1206.26	3872.03
-Manufacturer#4	1620.67	1206.26	5492.70
+Manufacturer#4	1620.67	1206.26	5492.7
 Manufacturer#4	1844.92	1206.26	7337.62
 Manufacturer#5	1018.1	1018.1	1018.1
 Manufacturer#5	1464.48	1018.1	2482.58
@@ -97,8 +97,8 @@ from part_dec
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@part_dec
 #### A masked pattern was here ####
-Manufacturer#1	1173.15	1173.15	2346.30
-Manufacturer#1	1173.15	1173.15	2346.30
+Manufacturer#1	1173.15	1173.15	2346.3
+Manufacturer#1	1173.15	1173.15	2346.3
 Manufacturer#1	1414.42	1414.42	1414.42
 Manufacturer#1	1602.59	1602.59	1602.59
 Manufacturer#1	1632.66	1632.66	1632.66
diff --git a/ql/src/test/results/clientpositive/windowing_navfn.q.out b/ql/src/test/results/clientpositive/windowing_navfn.q.out
index 4256640dbd..531ab6b6b2 100644
--- a/ql/src/test/results/clientpositive/windowing_navfn.q.out
+++ b/ql/src/test/results/clientpositive/windowing_navfn.q.out
@@ -277,13 +277,13 @@ POSTHOOK: Input: default@over10k
 65536	98.42
 65536	0.93
 65536	83.48
-65536	75.70
+65536	75.7
 65536	88.04
 65536	94.09
 65536	33.45
 65536	44.41
 65536	22.15
-65536	20.50
+65536	20.5
 65536	58.86
 65536	30.91
 65536	74.47
@@ -300,9 +300,9 @@ POSTHOOK: Input: default@over10k
 65536	80.26
 65536	35.07
 65536	95.88
-65536	30.60
+65536	30.6
 65536	46.97
-65536	58.80
+65536	58.8
 65536	5.72
 65536	29.27
 65536	62.25
@@ -326,7 +326,7 @@ POSTHOOK: Input: default@over10k
 65537	35.86
 65537	47.75
 65537	1.12
-65537	52.90
+65537	52.9
 65537	53.92
 65537	43.45
 65537	7.52
@@ -340,20 +340,20 @@ POSTHOOK: Input: default@over10k
 65537	56.48
 65537	83.21
 65537	56.52
-65537	36.60
-65537	59.70
+65537	36.6
+65537	59.7
 65537	80.14
-65537	66.30
+65537	66.3
 65537	94.87
 65537	40.92
-65537	25.20
+65537	25.2
 65537	7.36
 65538	NULL
 65538	53.35
 65538	54.64
 65538	76.67
 65538	15.17
-65538	1.20
+65538	1.2
 65538	13.71
 65538	81.59
 65538	43.33
diff --git a/ql/src/test/results/clientpositive/windowing_rank.q.out b/ql/src/test/results/clientpositive/windowing_rank.q.out
index 67975f3eaa..6a74a8ee90 100644
--- a/ql/src/test/results/clientpositive/windowing_rank.q.out
+++ b/ql/src/test/results/clientpositive/windowing_rank.q.out
@@ -508,16 +508,16 @@ where rnk =  1 limit 10
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over10k
 #### A masked pattern was here ####
-2013-03-01 09:11:58.70307	0.50	1
-2013-03-01 09:11:58.70307	0.50	1
-2013-03-01 09:11:58.70307	0.50	1
-2013-03-01 09:11:58.70307	0.50	1
-2013-03-01 09:11:58.70307	0.50	1
-2013-03-01 09:11:58.70307	0.50	1
-2013-03-01 09:11:58.70307	0.50	1
-2013-03-01 09:11:58.70307	0.50	1
-2013-03-01 09:11:58.70307	0.50	1
-2013-03-01 09:11:58.70307	0.50	1
+2013-03-01 09:11:58.70307	0.5	1
+2013-03-01 09:11:58.70307	0.5	1
+2013-03-01 09:11:58.70307	0.5	1
+2013-03-01 09:11:58.70307	0.5	1
+2013-03-01 09:11:58.70307	0.5	1
+2013-03-01 09:11:58.70307	0.5	1
+2013-03-01 09:11:58.70307	0.5	1
+2013-03-01 09:11:58.70307	0.5	1
+2013-03-01 09:11:58.70307	0.5	1
+2013-03-01 09:11:58.70307	0.5	1
 PREHOOK: query: select ts, dec, rnk
 from
   (select ts, dec,
@@ -546,16 +546,16 @@ where dec = 89.5 limit 10
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over10k
 #### A masked pattern was here ####
-2013-03-01 09:11:58.703124	89.50	1
-2013-03-01 09:11:58.703124	89.50	1
-2013-03-01 09:11:58.703124	89.50	1
-2013-03-01 09:11:58.703124	89.50	1
-2013-03-01 09:11:58.703124	89.50	1
-2013-03-01 09:11:58.703124	89.50	1
-2013-03-01 09:11:58.703124	89.50	1
-2013-03-01 09:11:58.703124	89.50	1
-2013-03-01 09:11:58.703124	89.50	1
-2013-03-01 09:11:58.703124	89.50	1
+2013-03-01 09:11:58.703124	89.5	1
+2013-03-01 09:11:58.703124	89.5	1
+2013-03-01 09:11:58.703124	89.5	1
+2013-03-01 09:11:58.703124	89.5	1
+2013-03-01 09:11:58.703124	89.5	1
+2013-03-01 09:11:58.703124	89.5	1
+2013-03-01 09:11:58.703124	89.5	1
+2013-03-01 09:11:58.703124	89.5	1
+2013-03-01 09:11:58.703124	89.5	1
+2013-03-01 09:11:58.703124	89.5	1
 PREHOOK: query: select ts, dec, rnk
 from
   (select ts, dec,
@@ -586,13 +586,13 @@ where rnk = 1 limit 10
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over10k
 #### A masked pattern was here ####
-2013-03-01 09:11:58.70307	37.30	1
-2013-03-01 09:11:58.70307	37.30	1
-2013-03-01 09:11:58.70307	37.30	1
-2013-03-01 09:11:58.70307	37.30	1
-2013-03-01 09:11:58.70307	37.30	1
-2013-03-01 09:11:58.70307	37.30	1
-2013-03-01 09:11:58.70307	37.30	1
-2013-03-01 09:11:58.70307	37.30	1
-2013-03-01 09:11:58.70307	37.30	1
-2013-03-01 09:11:58.70307	37.30	1
+2013-03-01 09:11:58.70307	37.3	1
+2013-03-01 09:11:58.70307	37.3	1
+2013-03-01 09:11:58.70307	37.3	1
+2013-03-01 09:11:58.70307	37.3	1
+2013-03-01 09:11:58.70307	37.3	1
+2013-03-01 09:11:58.70307	37.3	1
+2013-03-01 09:11:58.70307	37.3	1
+2013-03-01 09:11:58.70307	37.3	1
+2013-03-01 09:11:58.70307	37.3	1
+2013-03-01 09:11:58.70307	37.3	1
diff --git a/serde/src/java/org/apache/hadoop/hive/serde2/binarysortable/BinarySortableSerDe.java b/serde/src/java/org/apache/hadoop/hive/serde2/binarysortable/BinarySortableSerDe.java
index 73ae2d9099..2b7fba6354 100644
--- a/serde/src/java/org/apache/hadoop/hive/serde2/binarysortable/BinarySortableSerDe.java
+++ b/serde/src/java/org/apache/hadoop/hive/serde2/binarysortable/BinarySortableSerDe.java
@@ -779,7 +779,7 @@ static void serialize(ByteStream.Output buffer, Object o, ObjectInspector oi,
 
         // get the scale factor to turn big decimal into a decimal < 1
         int factor = dec.precision() - dec.scale();
-        factor = sign != -1 ? factor : -factor;
+        factor = sign == 1 ? factor : -factor;
 
         // convert the absolute big decimal to string
         dec.scaleByPowerOfTen(Math.abs(dec.scale()));
