diff --git a/ql/src/test/queries/clientpositive/combine2_win.q b/ql/src/test/queries/clientpositive/combine2_win.q
index b922516925..f6090bb99b 100644
--- a/ql/src/test/queries/clientpositive/combine2_win.q
+++ b/ql/src/test/queries/clientpositive/combine2_win.q
@@ -11,6 +11,8 @@ set hive.merge.smallfiles.avgsize=0;
 -- INCLUDE_OS_WINDOWS
 -- included only on  windows because of difference in file name encoding logic
 
+-- INCLUDE_HADOOP_MAJOR_VERSIONS(0.20, 0.20S)
+
 create table combine2(key string) partitioned by (value string);
 
 insert overwrite table combine2 partition(value) 
diff --git a/ql/src/test/results/clientpositive/combine2_win.q.out b/ql/src/test/results/clientpositive/combine2_win.q.out
index 77989c5fbe..5d5042df36 100644
--- a/ql/src/test/results/clientpositive/combine2_win.q.out
+++ b/ql/src/test/results/clientpositive/combine2_win.q.out
@@ -1,8 +1,14 @@
 PREHOOK: query: -- INCLUDE_OS_WINDOWS
+-- included only on  windows because of difference in file name encoding logic
+
+-- INCLUDE_HADOOP_MAJOR_VERSIONS(0.20, 0.20S)
 
 create table combine2(key string) partitioned by (value string)
 PREHOOK: type: CREATETABLE
 POSTHOOK: query: -- INCLUDE_OS_WINDOWS
+-- included only on  windows because of difference in file name encoding logic
+
+-- INCLUDE_HADOOP_MAJOR_VERSIONS(0.20, 0.20S)
 
 create table combine2(key string) partitioned by (value string)
 POSTHOOK: type: CREATETABLE
@@ -124,6 +130,7 @@ STAGE PLANS:
 
 PREHOOK: query: select key, value from combine2 where value is not null order by key
 PREHOOK: type: QUERY
+PREHOOK: Input: default@combine2
 PREHOOK: Input: default@combine2@value=%7C
 PREHOOK: Input: default@combine2@value=2010-04-21%2009%3A45%3A00
 PREHOOK: Input: default@combine2@value=val_0
@@ -135,6 +142,7 @@ PREHOOK: Input: default@combine2@value=val_9
 #### A masked pattern was here ####
 POSTHOOK: query: select key, value from combine2 where value is not null order by key
 POSTHOOK: type: QUERY
+POSTHOOK: Input: default@combine2
 POSTHOOK: Input: default@combine2@value=%7C
 POSTHOOK: Input: default@combine2@value=2010-04-21%2009%3A45%3A00
 POSTHOOK: Input: default@combine2@value=val_0
@@ -224,7 +232,6 @@ STAGE PLANS:
 #### A masked pattern was here ####
               name default.combine2
               numFiles 1
-              numPartitions 8
               numRows 1
               partition_columns value
               rawDataSize 2
@@ -270,7 +277,6 @@ STAGE PLANS:
 #### A masked pattern was here ####
               name default.combine2
               numFiles 1
-              numPartitions 8
               numRows 1
               partition_columns value
               rawDataSize 2
@@ -316,7 +322,6 @@ STAGE PLANS:
 #### A masked pattern was here ####
               name default.combine2
               numFiles 1
-              numPartitions 8
               numRows 3
               partition_columns value
               rawDataSize 3
@@ -362,7 +367,6 @@ STAGE PLANS:
 #### A masked pattern was here ####
               name default.combine2
               numFiles 1
-              numPartitions 8
               numRows 1
               partition_columns value
               rawDataSize 1
@@ -408,7 +412,6 @@ STAGE PLANS:
 #### A masked pattern was here ####
               name default.combine2
               numFiles 1
-              numPartitions 8
               numRows 1
               partition_columns value
               rawDataSize 1
@@ -454,7 +457,6 @@ STAGE PLANS:
 #### A masked pattern was here ####
               name default.combine2
               numFiles 1
-              numPartitions 8
               numRows 3
               partition_columns value
               rawDataSize 3
@@ -500,7 +502,6 @@ STAGE PLANS:
 #### A masked pattern was here ####
               name default.combine2
               numFiles 1
-              numPartitions 8
               numRows 1
               partition_columns value
               rawDataSize 1
@@ -546,7 +547,6 @@ STAGE PLANS:
 #### A masked pattern was here ####
               name default.combine2
               numFiles 1
-              numPartitions 8
               numRows 1
               partition_columns value
               rawDataSize 1
@@ -607,6 +607,15 @@ STAGE PLANS:
               TotalFiles: 1
               GatherStats: false
               MultiFileSpray: false
+      Truncated Path -> Alias:
+        /combine2/value=%7C [combine2]
+        /combine2/value=2010-04-21%2009%3A45%3A00 [combine2]
+        /combine2/value=val_0 [combine2]
+        /combine2/value=val_2 [combine2]
+        /combine2/value=val_4 [combine2]
+        /combine2/value=val_5 [combine2]
+        /combine2/value=val_8 [combine2]
+        /combine2/value=val_9 [combine2]
 
   Stage: Stage-0
     Fetch Operator
@@ -615,6 +624,7 @@ STAGE PLANS:
 
 PREHOOK: query: select count(1) from combine2 where value is not null
 PREHOOK: type: QUERY
+PREHOOK: Input: default@combine2
 PREHOOK: Input: default@combine2@value=%7C
 PREHOOK: Input: default@combine2@value=2010-04-21%2009%3A45%3A00
 PREHOOK: Input: default@combine2@value=val_0
@@ -626,6 +636,7 @@ PREHOOK: Input: default@combine2@value=val_9
 #### A masked pattern was here ####
 POSTHOOK: query: select count(1) from combine2 where value is not null
 POSTHOOK: type: QUERY
+POSTHOOK: Input: default@combine2
 POSTHOOK: Input: default@combine2@value=%7C
 POSTHOOK: Input: default@combine2@value=2010-04-21%2009%3A45%3A00
 POSTHOOK: Input: default@combine2@value=val_0
@@ -729,6 +740,7 @@ STAGE PLANS:
 
 PREHOOK: query: select ds, count(1) from srcpart where ds is not null group by ds
 PREHOOK: type: QUERY
+PREHOOK: Input: default@srcpart
 PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 PREHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
@@ -736,6 +748,7 @@ PREHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
 #### A masked pattern was here ####
 POSTHOOK: query: select ds, count(1) from srcpart where ds is not null group by ds
 POSTHOOK: type: QUERY
+POSTHOOK: Input: default@srcpart
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
diff --git a/ql/src/test/results/clientpositive/input_part10_win.q.out b/ql/src/test/results/clientpositive/input_part10_win.q.out
index 14651b2296..92df63c983 100644
--- a/ql/src/test/results/clientpositive/input_part10_win.q.out
+++ b/ql/src/test/results/clientpositive/input_part10_win.q.out
@@ -1,4 +1,5 @@
 PREHOOK: query: -- INCLUDE_OS_WINDOWS
+-- included only on  windows because of difference in file name encoding logic
 
 CREATE TABLE part_special (
   a STRING,
@@ -9,6 +10,7 @@ CREATE TABLE part_special (
 )
 PREHOOK: type: CREATETABLE
 POSTHOOK: query: -- INCLUDE_OS_WINDOWS
+-- included only on  windows because of difference in file name encoding logic
 
 CREATE TABLE part_special (
   a STRING,
@@ -105,18 +107,26 @@ POSTHOOK: query: DESCRIBE EXTENDED part_special PARTITION(ds='2008 04 08', ts =
 POSTHOOK: type: DESCTABLE
 POSTHOOK: Lineage: part_special PARTITION(ds=2008 04 08,ts=10:11:12=455).a SIMPLE []
 POSTHOOK: Lineage: part_special PARTITION(ds=2008 04 08,ts=10:11:12=455).b SIMPLE []
-a	string	
-b	string	
-ds	string	
-ts	string	
+a                   	string              	None                
+b                   	string              	None                
+ds                  	string              	None                
+ts                  	string              	None                
+	 	 
+# Partition Information	 	 
+# col_name            	data_type           	comment             
+	 	 
+ds                  	string              	None                
+ts                  	string              	None                
 	 	 
 #### A masked pattern was here ####
 PREHOOK: query: SELECT * FROM part_special WHERE ds='2008 04 08' AND ts = '10:11:12=455'
 PREHOOK: type: QUERY
+PREHOOK: Input: default@part_special
 PREHOOK: Input: default@part_special@ds=2008%2004%2008/ts=10%3A11%3A12%3D455
 #### A masked pattern was here ####
 POSTHOOK: query: SELECT * FROM part_special WHERE ds='2008 04 08' AND ts = '10:11:12=455'
 POSTHOOK: type: QUERY
+POSTHOOK: Input: default@part_special
 POSTHOOK: Input: default@part_special@ds=2008%2004%2008/ts=10%3A11%3A12%3D455
 #### A masked pattern was here ####
 POSTHOOK: Lineage: part_special PARTITION(ds=2008 04 08,ts=10:11:12=455).a SIMPLE []
diff --git a/ql/src/test/results/clientpositive/load_dyn_part14_win.q.out b/ql/src/test/results/clientpositive/load_dyn_part14_win.q.out
index 362cf433ba..13b6c0be9d 100644
--- a/ql/src/test/results/clientpositive/load_dyn_part14_win.q.out
+++ b/ql/src/test/results/clientpositive/load_dyn_part14_win.q.out
@@ -1,9 +1,13 @@
 PREHOOK: query: -- INCLUDE_OS_WINDOWS
+-- included only on  windows because of difference in file name encoding logic
+
 
 create table if not exists nzhang_part14 (key string) 
   partitioned by (value string)
 PREHOOK: type: CREATETABLE
 POSTHOOK: query: -- INCLUDE_OS_WINDOWS
+-- included only on  windows because of difference in file name encoding logic
+
 
 create table if not exists nzhang_part14 (key string) 
   partitioned by (value string)
@@ -13,8 +17,13 @@ PREHOOK: query: describe extended nzhang_part14
 PREHOOK: type: DESCTABLE
 POSTHOOK: query: describe extended nzhang_part14
 POSTHOOK: type: DESCTABLE
-key	string	
-value	string	
+key                 	string              	None                
+value               	string              	None                
+	 	 
+# Partition Information	 	 
+# col_name            	data_type           	comment             
+	 	 
+value               	string              	None                
 	 	 
 #### A masked pattern was here ####
 PREHOOK: query: explain
@@ -42,14 +51,16 @@ ABSTRACT SYNTAX TREE:
 
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
-  Stage-2 depends on stages: Stage-1, Stage-7, Stage-8
-  Stage-6 depends on stages: Stage-2 , consists of Stage-5, Stage-4
+  Stage-2 depends on stages: Stage-1, Stage-9, Stage-10
+  Stage-8 depends on stages: Stage-2 , consists of Stage-5, Stage-4, Stage-6
   Stage-5
-  Stage-0 depends on stages: Stage-5, Stage-4
+  Stage-0 depends on stages: Stage-5, Stage-4, Stage-7
   Stage-3 depends on stages: Stage-0
   Stage-4
-  Stage-7 is a root stage
-  Stage-8 is a root stage
+  Stage-6
+  Stage-7 depends on stages: Stage-6
+  Stage-9 is a root stage
+  Stage-10 is a root stage
 
 STAGE PLANS:
   Stage: Stage-1
@@ -142,7 +153,7 @@ STAGE PLANS:
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       name: default.nzhang_part14
 
-  Stage: Stage-6
+  Stage: Stage-8
     Conditional Operator
 
   Stage: Stage-5
@@ -179,7 +190,26 @@ STAGE PLANS:
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   name: default.nzhang_part14
 
+  Stage: Stage-6
+    Map Reduce
+      Alias -> Map Operator Tree:
+#### A masked pattern was here ####
+            File Output Operator
+              compressed: false
+              GlobalTableId: 0
+              table:
+                  input format: org.apache.hadoop.mapred.TextInputFormat
+                  output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                  name: default.nzhang_part14
+
   Stage: Stage-7
+    Move Operator
+      files:
+          hdfs directory: true
+#### A masked pattern was here ####
+
+  Stage: Stage-9
     Map Reduce
       Alias -> Map Operator Tree:
         null-subquery2:t-subquery2:src 
@@ -211,7 +241,7 @@ STAGE PLANS:
                   input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                   output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
 
-  Stage: Stage-8
+  Stage: Stage-10
     Map Reduce
       Alias -> Map Operator Tree:
         null-subquery1-subquery1:t-subquery1-subquery1:src 
@@ -280,12 +310,14 @@ value=__HIVE_DEFAULT_PARTITION__
 PREHOOK: query: select * from nzhang_part14 where value <> 'a'
 order by key, value
 PREHOOK: type: QUERY
+PREHOOK: Input: default@nzhang_part14
 PREHOOK: Input: default@nzhang_part14@value=%20
 PREHOOK: Input: default@nzhang_part14@value=__HIVE_DEFAULT_PARTITION__
 #### A masked pattern was here ####
 POSTHOOK: query: select * from nzhang_part14 where value <> 'a'
 order by key, value
 POSTHOOK: type: QUERY
+POSTHOOK: Input: default@nzhang_part14
 POSTHOOK: Input: default@nzhang_part14@value=%20
 POSTHOOK: Input: default@nzhang_part14@value=__HIVE_DEFAULT_PARTITION__
 #### A masked pattern was here ####
