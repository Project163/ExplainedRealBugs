diff --git a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFFormatNumber.java b/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFFormatNumber.java
index ce0c9d5f89..71ca8f2241 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFFormatNumber.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFFormatNumber.java
@@ -147,7 +147,13 @@ public ObjectInspector initialize(ObjectInspector[] arguments) throws UDFArgumen
 
   @Override
   public Object evaluate(DeferredObject[] arguments) throws HiveException {
-    int dValue = ((IntObjectInspector) argumentOIs[1]).get(arguments[1].get());
+    Object arg0;
+    Object arg1;
+    if ((arg0 = arguments[0].get()) == null || (arg1 = arguments[1].get()) == null) {
+      return null;
+    }
+
+    int dValue = ((IntObjectInspector) argumentOIs[1]).get(arg1);
 
     if (dValue < 0) {
       throw new HiveException("Argument 2 of function FORMAT_NUMBER must be >= 0, but \""
@@ -181,26 +187,26 @@ public Object evaluate(DeferredObject[] arguments) throws HiveException {
     switch (xObjectInspector.getPrimitiveCategory()) {
       case VOID:
       case DOUBLE:
-        xDoubleValue = ((DoubleObjectInspector) argumentOIs[0]).get(arguments[0].get());
+        xDoubleValue = ((DoubleObjectInspector) argumentOIs[0]).get(arg0);
         resultText.set(numberFormat.format(xDoubleValue));
         break;
       case FLOAT:
-        xFloatValue = ((FloatObjectInspector) argumentOIs[0]).get(arguments[0].get());
+        xFloatValue = ((FloatObjectInspector) argumentOIs[0]).get(arg0);
         resultText.set(numberFormat.format(xFloatValue));
         break;
       case DECIMAL:
         xDecimalValue = ((HiveDecimalObjectInspector) argumentOIs[0])
-            .getPrimitiveJavaObject(arguments[0].get());
+            .getPrimitiveJavaObject(arg0);
         resultText.set(numberFormat.format(xDecimalValue.bigDecimalValue()));
         break;
       case BYTE:
       case SHORT:
       case INT:
-        xIntValue = ((IntObjectInspector) argumentOIs[0]).get(arguments[0].get());
+        xIntValue = ((IntObjectInspector) argumentOIs[0]).get(arg0);
         resultText.set(numberFormat.format(xIntValue));
         break;
       case LONG:
-        xLongValue = ((LongObjectInspector) argumentOIs[0]).get(arguments[0].get());
+        xLongValue = ((LongObjectInspector) argumentOIs[0]).get(arg0);
         resultText.set(numberFormat.format(xLongValue));
         break;
       default:
diff --git a/ql/src/test/queries/clientpositive/udf_format_number.q b/ql/src/test/queries/clientpositive/udf_format_number.q
index 630533dcee..28f087d02d 100644
--- a/ql/src/test/queries/clientpositive/udf_format_number.q
+++ b/ql/src/test/queries/clientpositive/udf_format_number.q
@@ -71,3 +71,9 @@ SELECT format_number(12332.123456BD, 4),
     format_number(-12332.2BD, 0),
     format_number(CAST(12332.567 AS DECIMAL(8, 1)), 4)
 FROM src tablesample (1 rows);
+
+-- nulls
+SELECT
+  format_number(cast(null as int), 0),
+  format_number(12332.123456BD, cast(null as int)),
+  format_number(cast(null as int), cast(null as int));
diff --git a/ql/src/test/results/clientpositive/udf_format_number.q.out b/ql/src/test/results/clientpositive/udf_format_number.q.out
index 4682fb5d2e..4a2c80d39a 100644
--- a/ql/src/test/results/clientpositive/udf_format_number.q.out
+++ b/ql/src/test/results/clientpositive/udf_format_number.q.out
@@ -211,3 +211,20 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 #### A masked pattern was here ####
 12,332.1235	12,332.12	12,332.1000	-12,332	12,332.6000
+PREHOOK: query: -- nulls
+SELECT
+  format_number(cast(null as int), 0),
+  format_number(12332.123456BD, cast(null as int)),
+  format_number(cast(null as int), cast(null as int))
+PREHOOK: type: QUERY
+PREHOOK: Input: _dummy_database@_dummy_table
+#### A masked pattern was here ####
+POSTHOOK: query: -- nulls
+SELECT
+  format_number(cast(null as int), 0),
+  format_number(12332.123456BD, cast(null as int)),
+  format_number(cast(null as int), cast(null as int))
+POSTHOOK: type: QUERY
+POSTHOOK: Input: _dummy_database@_dummy_table
+#### A masked pattern was here ####
+NULL	NULL	NULL
