diff --git a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/calcite/translator/JoinCondTypeCheckProcFactory.java b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/calcite/translator/JoinCondTypeCheckProcFactory.java
index 4cd01c936e..9128d81e59 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/calcite/translator/JoinCondTypeCheckProcFactory.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/calcite/translator/JoinCondTypeCheckProcFactory.java
@@ -288,12 +288,12 @@ private static Set<Integer> getInputRef(Collection<ExprNodeDesc> colDescSet,
           // inputRR.
           if (tableAlias != null) {
             if (inputRR.hasTableAlias(tableAlias)) {
-              if (inputRR.getInvRslvMap().containsKey(colDesc.getColumn())) {
+              if (inputRR.doesInvRslvMapContain(colDesc.getColumn())) {
                 inputLineage.add(i);
               }
             }
           } else {
-            if (inputRR.getInvRslvMap().containsKey(colDesc.getColumn())) {
+            if (inputRR.doesInvRslvMapContain(colDesc.getColumn())) {
               inputLineage.add(i);
             }
           }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/CalcitePlanner.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/CalcitePlanner.java
index 1c44ade230..3fefbd710c 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/CalcitePlanner.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/CalcitePlanner.java
@@ -2938,6 +2938,7 @@ private RelNode genSelectLogicalPlan(QB qb, RelNode srcRel, RelNode starSrcRel)
             ExprNodeColumnDesc colExp = (ExprNodeColumnDesc) exp;
             String[] altMapping = inputRR.getAlternateMappings(colExp.getColumn());
             if (altMapping != null) {
+              // TODO: this can overwrite the mapping. Should this be allowed?
               out_rwsch.put(altMapping[0], altMapping[1], colInfo);
             }
           }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/RowResolver.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/RowResolver.java
index 0bd036f826..512850570c 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/RowResolver.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/RowResolver.java
@@ -38,10 +38,10 @@
  */
 public class RowResolver implements Serializable{
   private static final long serialVersionUID = 1L;
-  private  RowSchema rowSchema;
-  private  HashMap<String, LinkedHashMap<String, ColumnInfo>> rslvMap;
+  private RowSchema rowSchema;
+  private LinkedHashMap<String, LinkedHashMap<String, ColumnInfo>> rslvMap;
 
-  private  HashMap<String, String[]> invRslvMap;
+  private HashMap<String, String[]> invRslvMap;
   /*
    * now a Column can have an alternate mapping.
    * This captures the alternate mapping.
@@ -58,7 +58,7 @@ public class RowResolver implements Serializable{
 
   public RowResolver() {
     rowSchema = new RowSchema();
-    rslvMap = new HashMap<String, LinkedHashMap<String, ColumnInfo>>();
+    rslvMap = new LinkedHashMap<String, LinkedHashMap<String, ColumnInfo>>();
     invRslvMap = new HashMap<String, String[]>();
     altInvRslvMap = new HashMap<String, String[]>();
     expressionMap = new HashMap<String, ASTNode>();
@@ -315,14 +315,10 @@ public RowSchema getRowSchema() {
     return rowSchema;
   }
 
-  public HashMap<String, LinkedHashMap<String, ColumnInfo>> getRslvMap() {
+  public LinkedHashMap<String, LinkedHashMap<String, ColumnInfo>> getRslvMap() {
     return rslvMap;
   }
 
-  public HashMap<String, String[]> getInvRslvMap() {
-    return invRslvMap;
-  }
-
   public Map<String, ASTNode> getExpressionMap() {
     return expressionMap;
   }
@@ -331,19 +327,14 @@ public void setExprResolver(boolean isExprResolver) {
     this.isExprResolver = isExprResolver;
   }
 
+  public boolean doesInvRslvMapContain(String column) {
+    return getInvRslvMap().containsKey(column);
+  }
 
   public void setRowSchema(RowSchema rowSchema) {
     this.rowSchema = rowSchema;
   }
 
-  public void setRslvMap(HashMap<String, LinkedHashMap<String, ColumnInfo>> rslvMap) {
-    this.rslvMap = rslvMap;
-  }
-
-  public void setInvRslvMap(HashMap<String, String[]> invRslvMap) {
-    this.invRslvMap = invRslvMap;
-  }
-
   public void setExpressionMap(Map<String, ASTNode> expressionMap) {
     this.expressionMap = expressionMap;
   }
@@ -474,4 +465,8 @@ public RowResolver duplicate() {
     resolver.isExprResolver = isExprResolver;
     return resolver;
   }
-}
\ No newline at end of file
+
+  private HashMap<String, String[]> getInvRslvMap() {
+    return invRslvMap; // If making this public, note that its ordering is undefined.
+  }
+}
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
index daa9d4a64c..15773e56ea 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
@@ -12230,8 +12230,11 @@ protected boolean deleting() {
     return false;
   }
   public static ASTNode genSelectDIAST(RowResolver rr) {
-    HashMap<String, LinkedHashMap<String, ColumnInfo>> map = rr.getRslvMap();
+    LinkedHashMap<String, LinkedHashMap<String, ColumnInfo>> map = rr.getRslvMap();
     ASTNode selectDI = new ASTNode(new CommonToken(HiveParser.TOK_SELECTDI, "TOK_SELECTDI"));
+    // Note: this will determine the order of columns in the result. For now, the columns for each
+    //       table will be together; the order of the tables, as well as the columns within each
+    //       table, is deterministic, but undefined - RR stores them in the order of addition.
     for (String tabAlias : map.keySet()) {
       for (Entry<String, ColumnInfo> entry : map.get(tabAlias).entrySet()) {
         selectDI.addChild(buildSelExprSubTree(tabAlias, entry.getKey()));
diff --git a/ql/src/test/results/clientpositive/groupby_resolution.q.out b/ql/src/test/results/clientpositive/groupby_resolution.q.out
index 9e58b7558b..0bc365c22b 100644
--- a/ql/src/test/results/clientpositive/groupby_resolution.q.out
+++ b/ql/src/test/results/clientpositive/groupby_resolution.q.out
@@ -766,14 +766,14 @@ STAGE PLANS:
               outputColumnNames: _col0, _col1
               Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
               Reduce Output Operator
-                key expressions: _col0 (type: string)
+                key expressions: _col1 (type: string)
                 sort order: +
-                Map-reduce partition columns: _col0 (type: string)
+                Map-reduce partition columns: _col1 (type: string)
                 Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
-                value expressions: _col1 (type: string)
+                value expressions: _col0 (type: string)
       Reduce Operator Tree:
         Select Operator
-          expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string)
+          expressions: VALUE._col0 (type: string), KEY.reducesinkkey0 (type: string)
           outputColumnNames: _col0, _col1
           Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
           File Output Operator
diff --git a/ql/src/test/results/clientpositive/llap/selectDistinctStar.q.out b/ql/src/test/results/clientpositive/llap/selectDistinctStar.q.out
index 663d999b7a..5594a0e440 100644
--- a/ql/src/test/results/clientpositive/llap/selectDistinctStar.q.out
+++ b/ql/src/test/results/clientpositive/llap/selectDistinctStar.q.out
@@ -1770,17 +1770,17 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Input: default@src1
 #### A masked pattern was here ####
-128		128	val_128
+128	val_128	128	
 146	val_146	146	val_146
 150	val_150	150	val_150
 213	val_213	213	val_213
-224		224	val_224
+224	val_224	224	
 238	val_238	238	val_238
 255	val_255	255	val_255
 273	val_273	273	val_273
 278	val_278	278	val_278
 311	val_311	311	val_311
-369		369	val_369
+369	val_369	369	
 401	val_401	401	val_401
 406	val_406	406	val_406
 66	val_66	66	val_66
@@ -1803,18 +1803,18 @@ POSTHOOK: Input: default@src1
 POSTHOOK: Input: default@srcpart
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 #### A masked pattern was here ####
-146	val_146	2008-04-08	11	146	val_146	146	val_146
-150	val_150	2008-04-08	11	150	val_150	150	val_150
-213	val_213	2008-04-08	11	213	val_213	213	val_213
-238	val_238	2008-04-08	11	238	val_238	238	val_238
-255	val_255	2008-04-08	11	255	val_255	255	val_255
-273	val_273	2008-04-08	11	273	val_273	273	val_273
-278	val_278	2008-04-08	11	278	val_278	278	val_278
-311	val_311	2008-04-08	11	311	val_311	311	val_311
-401	val_401	2008-04-08	11	401	val_401	401	val_401
-406	val_406	2008-04-08	11	406	val_406	406	val_406
-66	val_66	2008-04-08	11	66	val_66	66	val_66
-98	val_98	2008-04-08	11	98	val_98	98	val_98
+146	val_146	146	val_146	146	val_146	2008-04-08	11
+150	val_150	150	val_150	150	val_150	2008-04-08	11
+213	val_213	213	val_213	213	val_213	2008-04-08	11
+238	val_238	238	val_238	238	val_238	2008-04-08	11
+255	val_255	255	val_255	255	val_255	2008-04-08	11
+273	val_273	273	val_273	273	val_273	2008-04-08	11
+278	val_278	278	val_278	278	val_278	2008-04-08	11
+311	val_311	311	val_311	311	val_311	2008-04-08	11
+401	val_401	401	val_401	401	val_401	2008-04-08	11
+406	val_406	406	val_406	406	val_406	2008-04-08	11
+66	val_66	66	val_66	66	val_66	2008-04-08	11
+98	val_98	98	val_98	98	val_98	2008-04-08	11
 PREHOOK: query: select * from (select distinct * from src)src1 
 join 
 (select distinct * from src)src2 
@@ -4223,17 +4223,17 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Input: default@src1
 #### A masked pattern was here ####
-128		128	val_128
+128	val_128	128	
 146	val_146	146	val_146
 150	val_150	150	val_150
 213	val_213	213	val_213
-224		224	val_224
+224	val_224	224	
 238	val_238	238	val_238
 255	val_255	255	val_255
 273	val_273	273	val_273
 278	val_278	278	val_278
 311	val_311	311	val_311
-369		369	val_369
+369	val_369	369	
 401	val_401	401	val_401
 406	val_406	406	val_406
 66	val_66	66	val_66
@@ -4256,18 +4256,18 @@ POSTHOOK: Input: default@src1
 POSTHOOK: Input: default@srcpart
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 #### A masked pattern was here ####
-146	val_146	2008-04-08	11	146	val_146	146	val_146
-150	val_150	2008-04-08	11	150	val_150	150	val_150
-213	val_213	2008-04-08	11	213	val_213	213	val_213
-238	val_238	2008-04-08	11	238	val_238	238	val_238
-255	val_255	2008-04-08	11	255	val_255	255	val_255
-273	val_273	2008-04-08	11	273	val_273	273	val_273
-278	val_278	2008-04-08	11	278	val_278	278	val_278
-311	val_311	2008-04-08	11	311	val_311	311	val_311
-401	val_401	2008-04-08	11	401	val_401	401	val_401
-406	val_406	2008-04-08	11	406	val_406	406	val_406
-66	val_66	2008-04-08	11	66	val_66	66	val_66
-98	val_98	2008-04-08	11	98	val_98	98	val_98
+146	val_146	146	val_146	146	val_146	2008-04-08	11
+150	val_150	150	val_150	150	val_150	2008-04-08	11
+213	val_213	213	val_213	213	val_213	2008-04-08	11
+238	val_238	238	val_238	238	val_238	2008-04-08	11
+255	val_255	255	val_255	255	val_255	2008-04-08	11
+273	val_273	273	val_273	273	val_273	2008-04-08	11
+278	val_278	278	val_278	278	val_278	2008-04-08	11
+311	val_311	311	val_311	311	val_311	2008-04-08	11
+401	val_401	401	val_401	401	val_401	2008-04-08	11
+406	val_406	406	val_406	406	val_406	2008-04-08	11
+66	val_66	66	val_66	66	val_66	2008-04-08	11
+98	val_98	98	val_98	98	val_98	2008-04-08	11
 PREHOOK: query: select * from (select distinct * from src)src1 
 join 
 (select distinct * from src)src2 
diff --git a/ql/src/test/results/clientpositive/selectDistinctStar.q.out b/ql/src/test/results/clientpositive/selectDistinctStar.q.out
index 3f445803cd..4e2d7c8ac8 100644
--- a/ql/src/test/results/clientpositive/selectDistinctStar.q.out
+++ b/ql/src/test/results/clientpositive/selectDistinctStar.q.out
@@ -1743,17 +1743,17 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Input: default@src1
 #### A masked pattern was here ####
-128		128	val_128
+128	val_128	128	
 146	val_146	146	val_146
 150	val_150	150	val_150
 213	val_213	213	val_213
-224		224	val_224
+224	val_224	224	
 238	val_238	238	val_238
 255	val_255	255	val_255
 273	val_273	273	val_273
 278	val_278	278	val_278
 311	val_311	311	val_311
-369		369	val_369
+369	val_369	369	
 401	val_401	401	val_401
 406	val_406	406	val_406
 66	val_66	66	val_66
@@ -1776,18 +1776,18 @@ POSTHOOK: Input: default@src1
 POSTHOOK: Input: default@srcpart
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 #### A masked pattern was here ####
-146	val_146	2008-04-08	11	146	val_146	146	val_146
-150	val_150	2008-04-08	11	150	val_150	150	val_150
-213	val_213	2008-04-08	11	213	val_213	213	val_213
-238	val_238	2008-04-08	11	238	val_238	238	val_238
-255	val_255	2008-04-08	11	255	val_255	255	val_255
-273	val_273	2008-04-08	11	273	val_273	273	val_273
-278	val_278	2008-04-08	11	278	val_278	278	val_278
-311	val_311	2008-04-08	11	311	val_311	311	val_311
-401	val_401	2008-04-08	11	401	val_401	401	val_401
-406	val_406	2008-04-08	11	406	val_406	406	val_406
-66	val_66	2008-04-08	11	66	val_66	66	val_66
-98	val_98	2008-04-08	11	98	val_98	98	val_98
+146	val_146	146	val_146	146	val_146	2008-04-08	11
+150	val_150	150	val_150	150	val_150	2008-04-08	11
+213	val_213	213	val_213	213	val_213	2008-04-08	11
+238	val_238	238	val_238	238	val_238	2008-04-08	11
+255	val_255	255	val_255	255	val_255	2008-04-08	11
+273	val_273	273	val_273	273	val_273	2008-04-08	11
+278	val_278	278	val_278	278	val_278	2008-04-08	11
+311	val_311	311	val_311	311	val_311	2008-04-08	11
+401	val_401	401	val_401	401	val_401	2008-04-08	11
+406	val_406	406	val_406	406	val_406	2008-04-08	11
+66	val_66	66	val_66	66	val_66	2008-04-08	11
+98	val_98	98	val_98	98	val_98	2008-04-08	11
 PREHOOK: query: select * from (select distinct * from src)src1 
 join 
 (select distinct * from src)src2 
@@ -4169,17 +4169,17 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Input: default@src1
 #### A masked pattern was here ####
-128		128	val_128
+128	val_128	128	
 146	val_146	146	val_146
 150	val_150	150	val_150
 213	val_213	213	val_213
-224		224	val_224
+224	val_224	224	
 238	val_238	238	val_238
 255	val_255	255	val_255
 273	val_273	273	val_273
 278	val_278	278	val_278
 311	val_311	311	val_311
-369		369	val_369
+369	val_369	369	
 401	val_401	401	val_401
 406	val_406	406	val_406
 66	val_66	66	val_66
@@ -4202,18 +4202,18 @@ POSTHOOK: Input: default@src1
 POSTHOOK: Input: default@srcpart
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 #### A masked pattern was here ####
-146	val_146	2008-04-08	11	146	val_146	146	val_146
-150	val_150	2008-04-08	11	150	val_150	150	val_150
-213	val_213	2008-04-08	11	213	val_213	213	val_213
-238	val_238	2008-04-08	11	238	val_238	238	val_238
-255	val_255	2008-04-08	11	255	val_255	255	val_255
-273	val_273	2008-04-08	11	273	val_273	273	val_273
-278	val_278	2008-04-08	11	278	val_278	278	val_278
-311	val_311	2008-04-08	11	311	val_311	311	val_311
-401	val_401	2008-04-08	11	401	val_401	401	val_401
-406	val_406	2008-04-08	11	406	val_406	406	val_406
-66	val_66	2008-04-08	11	66	val_66	66	val_66
-98	val_98	2008-04-08	11	98	val_98	98	val_98
+146	val_146	146	val_146	146	val_146	2008-04-08	11
+150	val_150	150	val_150	150	val_150	2008-04-08	11
+213	val_213	213	val_213	213	val_213	2008-04-08	11
+238	val_238	238	val_238	238	val_238	2008-04-08	11
+255	val_255	255	val_255	255	val_255	2008-04-08	11
+273	val_273	273	val_273	273	val_273	2008-04-08	11
+278	val_278	278	val_278	278	val_278	2008-04-08	11
+311	val_311	311	val_311	311	val_311	2008-04-08	11
+401	val_401	401	val_401	401	val_401	2008-04-08	11
+406	val_406	406	val_406	406	val_406	2008-04-08	11
+66	val_66	66	val_66	66	val_66	2008-04-08	11
+98	val_98	98	val_98	98	val_98	2008-04-08	11
 PREHOOK: query: select * from (select distinct * from src)src1 
 join 
 (select distinct * from src)src2 
diff --git a/ql/src/test/results/clientpositive/spark/groupby_resolution.q.out b/ql/src/test/results/clientpositive/spark/groupby_resolution.q.out
index cef5b23c05..72f48ee27a 100644
--- a/ql/src/test/results/clientpositive/spark/groupby_resolution.q.out
+++ b/ql/src/test/results/clientpositive/spark/groupby_resolution.q.out
@@ -765,15 +765,15 @@ STAGE PLANS:
                     outputColumnNames: _col0, _col1
                     Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                     Reduce Output Operator
-                      key expressions: _col0 (type: string)
+                      key expressions: _col1 (type: string)
                       sort order: +
-                      Map-reduce partition columns: _col0 (type: string)
+                      Map-reduce partition columns: _col1 (type: string)
                       Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
-                      value expressions: _col1 (type: string)
+                      value expressions: _col0 (type: string)
         Reducer 2 
             Reduce Operator Tree:
               Select Operator
-                expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string)
+                expressions: VALUE._col0 (type: string), KEY.reducesinkkey0 (type: string)
                 outputColumnNames: _col0, _col1
                 Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                 File Output Operator
diff --git a/ql/src/test/results/clientpositive/tez/selectDistinctStar.q.out b/ql/src/test/results/clientpositive/tez/selectDistinctStar.q.out
index 22ac1157c2..bf665aa7c7 100644
--- a/ql/src/test/results/clientpositive/tez/selectDistinctStar.q.out
+++ b/ql/src/test/results/clientpositive/tez/selectDistinctStar.q.out
@@ -1763,17 +1763,17 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Input: default@src1
 #### A masked pattern was here ####
-128		128	val_128
+128	val_128	128	
 146	val_146	146	val_146
 150	val_150	150	val_150
 213	val_213	213	val_213
-224		224	val_224
+224	val_224	224	
 238	val_238	238	val_238
 255	val_255	255	val_255
 273	val_273	273	val_273
 278	val_278	278	val_278
 311	val_311	311	val_311
-369		369	val_369
+369	val_369	369	
 401	val_401	401	val_401
 406	val_406	406	val_406
 66	val_66	66	val_66
@@ -1796,18 +1796,18 @@ POSTHOOK: Input: default@src1
 POSTHOOK: Input: default@srcpart
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 #### A masked pattern was here ####
-146	val_146	2008-04-08	11	146	val_146	146	val_146
-150	val_150	2008-04-08	11	150	val_150	150	val_150
-213	val_213	2008-04-08	11	213	val_213	213	val_213
-238	val_238	2008-04-08	11	238	val_238	238	val_238
-255	val_255	2008-04-08	11	255	val_255	255	val_255
-273	val_273	2008-04-08	11	273	val_273	273	val_273
-278	val_278	2008-04-08	11	278	val_278	278	val_278
-311	val_311	2008-04-08	11	311	val_311	311	val_311
-401	val_401	2008-04-08	11	401	val_401	401	val_401
-406	val_406	2008-04-08	11	406	val_406	406	val_406
-66	val_66	2008-04-08	11	66	val_66	66	val_66
-98	val_98	2008-04-08	11	98	val_98	98	val_98
+146	val_146	146	val_146	146	val_146	2008-04-08	11
+150	val_150	150	val_150	150	val_150	2008-04-08	11
+213	val_213	213	val_213	213	val_213	2008-04-08	11
+238	val_238	238	val_238	238	val_238	2008-04-08	11
+255	val_255	255	val_255	255	val_255	2008-04-08	11
+273	val_273	273	val_273	273	val_273	2008-04-08	11
+278	val_278	278	val_278	278	val_278	2008-04-08	11
+311	val_311	311	val_311	311	val_311	2008-04-08	11
+401	val_401	401	val_401	401	val_401	2008-04-08	11
+406	val_406	406	val_406	406	val_406	2008-04-08	11
+66	val_66	66	val_66	66	val_66	2008-04-08	11
+98	val_98	98	val_98	98	val_98	2008-04-08	11
 PREHOOK: query: select * from (select distinct * from src)src1 
 join 
 (select distinct * from src)src2 
@@ -4209,17 +4209,17 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Input: default@src1
 #### A masked pattern was here ####
-128		128	val_128
+128	val_128	128	
 146	val_146	146	val_146
 150	val_150	150	val_150
 213	val_213	213	val_213
-224		224	val_224
+224	val_224	224	
 238	val_238	238	val_238
 255	val_255	255	val_255
 273	val_273	273	val_273
 278	val_278	278	val_278
 311	val_311	311	val_311
-369		369	val_369
+369	val_369	369	
 401	val_401	401	val_401
 406	val_406	406	val_406
 66	val_66	66	val_66
@@ -4242,18 +4242,18 @@ POSTHOOK: Input: default@src1
 POSTHOOK: Input: default@srcpart
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 #### A masked pattern was here ####
-146	val_146	2008-04-08	11	146	val_146	146	val_146
-150	val_150	2008-04-08	11	150	val_150	150	val_150
-213	val_213	2008-04-08	11	213	val_213	213	val_213
-238	val_238	2008-04-08	11	238	val_238	238	val_238
-255	val_255	2008-04-08	11	255	val_255	255	val_255
-273	val_273	2008-04-08	11	273	val_273	273	val_273
-278	val_278	2008-04-08	11	278	val_278	278	val_278
-311	val_311	2008-04-08	11	311	val_311	311	val_311
-401	val_401	2008-04-08	11	401	val_401	401	val_401
-406	val_406	2008-04-08	11	406	val_406	406	val_406
-66	val_66	2008-04-08	11	66	val_66	66	val_66
-98	val_98	2008-04-08	11	98	val_98	98	val_98
+146	val_146	146	val_146	146	val_146	2008-04-08	11
+150	val_150	150	val_150	150	val_150	2008-04-08	11
+213	val_213	213	val_213	213	val_213	2008-04-08	11
+238	val_238	238	val_238	238	val_238	2008-04-08	11
+255	val_255	255	val_255	255	val_255	2008-04-08	11
+273	val_273	273	val_273	273	val_273	2008-04-08	11
+278	val_278	278	val_278	278	val_278	2008-04-08	11
+311	val_311	311	val_311	311	val_311	2008-04-08	11
+401	val_401	401	val_401	401	val_401	2008-04-08	11
+406	val_406	406	val_406	406	val_406	2008-04-08	11
+66	val_66	66	val_66	66	val_66	2008-04-08	11
+98	val_98	98	val_98	98	val_98	2008-04-08	11
 PREHOOK: query: select * from (select distinct * from src)src1 
 join 
 (select distinct * from src)src2 
