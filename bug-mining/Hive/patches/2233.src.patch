diff --git a/ql/src/java/org/apache/hadoop/hive/ql/udf/ptf/MatchPath.java b/ql/src/java/org/apache/hadoop/hive/ql/udf/ptf/MatchPath.java
index 9798aa62d6..8215fc0df9 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/udf/ptf/MatchPath.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/udf/ptf/MatchPath.java
@@ -756,8 +756,7 @@ private void setupSelectListInputInfo() throws SemanticException
     private void fixResultExprString()
     {
       String r = resultExprString.trim();
-      String prefix = r.substring(0, 6);
-      if (!prefix.toLowerCase().equals("select"))
+      if (r.length()<6 || !r.substring(0, 6).toLowerCase().equals("select"))
       {
         r = "select " + r;
       }
