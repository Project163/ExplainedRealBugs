diff --git a/ql/src/java/org/apache/hadoop/hive/ql/index/TableBasedIndexHandler.java b/ql/src/java/org/apache/hadoop/hive/ql/index/TableBasedIndexHandler.java
index 02ab78c67e..4a77645557 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/index/TableBasedIndexHandler.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/index/TableBasedIndexHandler.java
@@ -101,7 +101,7 @@ public List<Task<?>> generateIndexBuildTaskList(
   abstract protected Task<?> getIndexBuilderMapRedTask(Set<ReadEntity> inputs, Set<WriteEntity> outputs,
       List<FieldSchema> indexField, boolean partitioned,
       PartitionDesc indexTblPartDesc, String indexTableName,
-      PartitionDesc baseTablePartDesc, String baseTableName, String dbName);
+      PartitionDesc baseTablePartDesc, String baseTableName, String dbName) throws HiveException;
 
   protected List<String> getPartKVPairStringArray(
       LinkedHashMap<String, String> partSpec) {
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapIndexHandler.java b/ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapIndexHandler.java
index 8f185bef3e..c93c852c00 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapIndexHandler.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapIndexHandler.java
@@ -220,7 +220,7 @@ public void analyzeIndexDefinition(Table baseTable, Index index,
   protected Task<?> getIndexBuilderMapRedTask(Set<ReadEntity> inputs, Set<WriteEntity> outputs,
       List<FieldSchema> indexField, boolean partitioned,
       PartitionDesc indexTblPartDesc, String indexTableName,
-      PartitionDesc baseTablePartDesc, String baseTableName, String dbName) {
+      PartitionDesc baseTablePartDesc, String baseTableName, String dbName) throws HiveException {
 
     HiveConf conf = new HiveConf(getConf(), BitmapIndexHandler.class);
     HiveConf.setBoolVar(conf, HiveConf.ConfVars.HIVEROWOFFSET, true);
@@ -280,9 +280,9 @@ protected Task<?> getIndexBuilderMapRedTask(Set<ReadEntity> inputs, Set<WriteEnt
     }
 
     // Require clusterby ROWOFFSET if map-size aggregation is off.
+    // TODO: Make this work without map side aggregation
     if (!conf.get("hive.map.aggr", null).equals("true")) {
-      command.append(" CLUSTER BY ");
-      command.append(VirtualColumn.ROWOFFSET.getName());
+      throw new HiveException("Cannot construct index without map-side aggregation");
     }
 
     Driver driver = new Driver(conf);
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/index/compact/CompactIndexHandler.java b/ql/src/java/org/apache/hadoop/hive/ql/index/compact/CompactIndexHandler.java
index ff9c4cc169..f4b7c15fcd 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/index/compact/CompactIndexHandler.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/index/compact/CompactIndexHandler.java
@@ -81,7 +81,7 @@ public void analyzeIndexDefinition(Table baseTable, Index index,
   protected Task<?> getIndexBuilderMapRedTask(Set<ReadEntity> inputs, Set<WriteEntity> outputs,
       List<FieldSchema> indexField, boolean partitioned,
       PartitionDesc indexTblPartDesc, String indexTableName,
-      PartitionDesc baseTablePartDesc, String baseTableName, String dbName) {
+      PartitionDesc baseTablePartDesc, String baseTableName, String dbName) throws HiveException {
 
     String indexCols = HiveUtils.getUnparsedColumnNamesFromFieldSchema(indexField);
 
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDAFEWAHBitmap.java b/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDAFEWAHBitmap.java
index 0a3df09031..d896b8ee75 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDAFEWAHBitmap.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDAFEWAHBitmap.java
@@ -92,14 +92,19 @@ public ObjectInspector init(Mode m, ObjectInspector[] parameters)
         inputOI = (PrimitiveObjectInspector) parameters[0];
         return ObjectInspectorFactory
             .getStandardListObjectInspector(PrimitiveObjectInspectorFactory.writableLongObjectInspector);
-      } else {
-        //no map aggregation
+      } else if (m == Mode.PARTIAL2 || m == Mode.FINAL) {
         internalMergeOI = (StandardListObjectInspector) parameters[0];
         bitmapLongOI = PrimitiveObjectInspectorFactory.writableLongObjectInspector;
         inputOI = PrimitiveObjectInspectorFactory.writableByteObjectInspector;
         loi = (StandardListObjectInspector) ObjectInspectorFactory
             .getStandardListObjectInspector(PrimitiveObjectInspectorFactory.writableLongObjectInspector);
         return loi;
+      } else { // Mode.COMPLETE, ie. no map-side aggregation, requires ordering
+        bitmapLongOI = PrimitiveObjectInspectorFactory.writableLongObjectInspector;
+        inputOI = PrimitiveObjectInspectorFactory.writableByteObjectInspector;
+        loi = (StandardListObjectInspector) ObjectInspectorFactory
+            .getStandardListObjectInspector(PrimitiveObjectInspectorFactory.writableLongObjectInspector);
+        return loi;
       }
     }
 
diff --git a/ql/src/test/queries/clientnegative/index_bitmap_no_map_aggr.q b/ql/src/test/queries/clientnegative/index_bitmap_no_map_aggr.q
new file mode 100644
index 0000000000..a17cd1fec5
--- /dev/null
+++ b/ql/src/test/queries/clientnegative/index_bitmap_no_map_aggr.q
@@ -0,0 +1,7 @@
+EXPLAIN
+CREATE INDEX src1_index ON TABLE src(key) as 'BITMAP' WITH DEFERRED REBUILD;
+
+SET hive.input.format=org.apache.hadoop.hive.ql.io.HiveInputFormat;
+SET hive.map.aggr=false;
+CREATE INDEX src1_index ON TABLE src(key) as 'BITMAP' WITH DEFERRED REBUILD;
+ALTER INDEX src1_index ON src REBUILD;
diff --git a/ql/src/test/results/clientnegative/index_bitmap_no_map_aggr.q.out b/ql/src/test/results/clientnegative/index_bitmap_no_map_aggr.q.out
new file mode 100644
index 0000000000..b49b4998d5
--- /dev/null
+++ b/ql/src/test/results/clientnegative/index_bitmap_no_map_aggr.q.out
@@ -0,0 +1,21 @@
+PREHOOK: query: EXPLAIN
+CREATE INDEX src1_index ON TABLE src(key) as 'BITMAP' WITH DEFERRED REBUILD
+PREHOOK: type: CREATEINDEX
+POSTHOOK: query: EXPLAIN
+CREATE INDEX src1_index ON TABLE src(key) as 'BITMAP' WITH DEFERRED REBUILD
+POSTHOOK: type: CREATEINDEX
+ABSTRACT SYNTAX TREE:
+  (TOK_CREATEINDEX src1_index 'BITMAP' (TOK_TABNAME src) (TOK_TABCOLNAME key) TOK_DEFERRED_REBUILDINDEX)
+
+STAGE DEPENDENCIES:
+  Stage-0 is a root stage
+
+STAGE PLANS:
+  Stage: Stage-0
+
+
+PREHOOK: query: CREATE INDEX src1_index ON TABLE src(key) as 'BITMAP' WITH DEFERRED REBUILD
+PREHOOK: type: CREATEINDEX
+POSTHOOK: query: CREATE INDEX src1_index ON TABLE src(key) as 'BITMAP' WITH DEFERRED REBUILD
+POSTHOOK: type: CREATEINDEX
+FAILED: Error in semantic analysis: org.apache.hadoop.hive.ql.parse.SemanticException: org.apache.hadoop.hive.ql.metadata.HiveException: Cannot construct index without map-side aggregation
