diff --git a/llap-client/src/java/org/apache/hadoop/hive/llap/registry/impl/LlapZookeeperRegistryImpl.java b/llap-client/src/java/org/apache/hadoop/hive/llap/registry/impl/LlapZookeeperRegistryImpl.java
index 34aaeecd84..d836fd61b3 100644
--- a/llap-client/src/java/org/apache/hadoop/hive/llap/registry/impl/LlapZookeeperRegistryImpl.java
+++ b/llap-client/src/java/org/apache/hadoop/hive/llap/registry/impl/LlapZookeeperRegistryImpl.java
@@ -50,6 +50,7 @@
 import org.apache.hadoop.conf.Configuration;
 import org.apache.hadoop.hive.conf.HiveConf;
 import org.apache.hadoop.hive.conf.HiveConf.ConfVars;
+import org.apache.hadoop.hive.llap.LlapUtil;
 import org.apache.hadoop.hive.llap.registry.ServiceInstance;
 import org.apache.hadoop.hive.llap.registry.ServiceInstanceSet;
 import org.apache.hadoop.hive.llap.registry.ServiceInstanceStateChangeListener;
@@ -735,7 +736,7 @@ private void setZookeeperClientKerberosJaasConfig(String principal, String keyTa
     System.setProperty(ZooKeeperSaslClient.LOGIN_CONTEXT_NAME_KEY, SASL_LOGIN_CONTEXT_NAME);
 
     principal = SecurityUtil.getServerPrincipal(principal, "0.0.0.0");
-    userNameFromPrincipal = getUserNameFromPrincipal(principal);
+    userNameFromPrincipal = LlapUtil.getUserNameFromPrincipal(principal);
     JaasConfiguration jaasConf = new JaasConfiguration(SASL_LOGIN_CONTEXT_NAME, principal,
         keyTabFile);
 
@@ -743,12 +744,6 @@ private void setZookeeperClientKerberosJaasConfig(String principal, String keyTa
     javax.security.auth.login.Configuration.setConfiguration(jaasConf);
   }
 
-  private String getUserNameFromPrincipal(String principal) {
-    // Based on SecurityUtil.
-    String[] components = principal.split("[/@]");
-    return (components == null || components.length != 3) ? principal : components[0];
-  }
-
   /**
    * A JAAS configuration for ZooKeeper clients intended to use for SASL
    * Kerberos.
diff --git a/llap-common/src/java/org/apache/hadoop/hive/llap/LlapUtil.java b/llap-common/src/java/org/apache/hadoop/hive/llap/LlapUtil.java
index 9dcaceadbb..505ddb1cff 100644
--- a/llap-common/src/java/org/apache/hadoop/hive/llap/LlapUtil.java
+++ b/llap-common/src/java/org/apache/hadoop/hive/llap/LlapUtil.java
@@ -49,4 +49,11 @@ public static String generateClusterName(Configuration conf) {
     String hosts = HiveConf.getTrimmedVar(conf, ConfVars.LLAP_DAEMON_SERVICE_HOSTS);
     return hostsRe.matcher(hosts.startsWith("@") ? hosts.substring(1) : hosts).replaceAll("_");
   }
+
+  public static String getUserNameFromPrincipal(String principal) {
+    // Based on SecurityUtil.
+    if (principal == null) return null;
+    String[] components = principal.split("[/@]");
+    return (components == null || components.length != 3) ? principal : components[0];
+  }
 }
diff --git a/llap-common/src/java/org/apache/hadoop/hive/llap/security/SecretManager.java b/llap-common/src/java/org/apache/hadoop/hive/llap/security/SecretManager.java
index f43e74d8f8..8d0fa2e984 100644
--- a/llap-common/src/java/org/apache/hadoop/hive/llap/security/SecretManager.java
+++ b/llap-common/src/java/org/apache/hadoop/hive/llap/security/SecretManager.java
@@ -62,13 +62,16 @@ public SecretManager(Configuration conf, String clusterId) {
 
   @Override
   public void startThreads() throws IOException {
-    LOG.info("Starting ZK threads as user " + UserGroupInformation.getCurrentUser());
+    String principalUser = LlapUtil.getUserNameFromPrincipal(
+        conf.get(SecretManager.ZK_DTSM_ZK_KERBEROS_PRINCIPAL));
+    LOG.info("Starting ZK threads as user " + UserGroupInformation.getCurrentUser()
+        + "; kerberos principal is configured for user (short user name) " + principalUser);
     super.startThreads();
     if (!HiveConf.getBoolVar(conf, ConfVars.LLAP_VALIDATE_ACLS)
       || !UserGroupInformation.isSecurityEnabled()) return;
     String path = conf.get(ZK_DTSM_ZNODE_WORKING_PATH, null);
     if (path == null) throw new AssertionError("Path was not set in config");
-    checkRootAcls(conf, path, UserGroupInformation.getCurrentUser().getShortUserName());
+    checkRootAcls(conf, path, principalUser);
   }
 
   // Workaround for HADOOP-12659 - remove when Hadoop 2.7.X is no longer supported.
