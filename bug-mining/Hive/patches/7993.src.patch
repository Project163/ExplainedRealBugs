diff --git a/ql/src/java/org/apache/hadoop/hive/ql/ddl/view/create/CreateMaterializedViewOperation.java b/ql/src/java/org/apache/hadoop/hive/ql/ddl/view/create/CreateMaterializedViewOperation.java
index 30ff28cae0..6ce5230f12 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/ddl/view/create/CreateMaterializedViewOperation.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/ddl/view/create/CreateMaterializedViewOperation.java
@@ -18,20 +18,23 @@
 
 package org.apache.hadoop.hive.ql.ddl.view.create;
 
+import com.google.common.collect.ImmutableSet;
 import org.apache.hadoop.fs.Path;
 import org.apache.hadoop.hive.common.ValidTxnWriteIdList;
 import org.apache.hadoop.hive.metastore.api.CreationMetadata;
+import org.apache.hadoop.hive.metastore.api.MetaException;
 import org.apache.hadoop.hive.metastore.utils.MetaStoreUtils;
 import org.apache.hadoop.hive.ql.ErrorMsg;
 import org.apache.hadoop.hive.ql.ddl.DDLOperation;
 import org.apache.hadoop.hive.ql.ddl.DDLOperationContext;
 import org.apache.hadoop.hive.ql.ddl.DDLUtils;
-import org.apache.hadoop.hive.ql.hooks.WriteEntity;
 import org.apache.hadoop.hive.ql.hooks.LineageInfo.DataContainer;
+import org.apache.hadoop.hive.ql.hooks.WriteEntity;
 import org.apache.hadoop.hive.ql.metadata.HiveException;
 import org.apache.hadoop.hive.ql.metadata.Table;
-
-import com.google.common.collect.ImmutableSet;
+import org.apache.hadoop.hive.metastore.Warehouse;
+import java.util.Map;
+import org.apache.hadoop.hive.ql.io.AcidUtils;
 
 /**
  * Operation process of creating a view.
@@ -69,7 +72,17 @@ public int execute() throws HiveException {
 
       //set lineage info
       DataContainer dc = new DataContainer(tbl.getTTable());
-      context.getQueryState().getLineageState().setLineage(new Path(desc.getViewName()), dc, tbl.getCols());
+      Map<String, String> tblProps = tbl.getTTable().getParameters();
+      Path tlocation = null;
+      try {
+        Warehouse wh = new Warehouse(context.getConf());
+        tlocation = wh.getDefaultTablePath(context.getDb().getDatabase(tbl.getDbName()), tbl.getTableName(),
+                tblProps == null || !AcidUtils.isTablePropertyTransactional(tblProps));
+      } catch (MetaException e) {
+        throw new HiveException(e);
+      }
+
+      context.getQueryState().getLineageState().setLineage(tlocation, dc, tbl.getCols());
     }
     return 0;
   }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
index ab67de574e..4464095648 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
@@ -8190,6 +8190,20 @@ private void handleLineage(LoadTableDesc ltd, Operator output)
 
       queryState.getLineageState()
           .mapDirToOp(tlocation, output);
+    } else if (queryState.getCommandType().equals(HiveOperation.CREATE_MATERIALIZED_VIEW.getOperationName())) {
+      Path tlocation;
+      String [] dbTable = Utilities.getDbTableName(createVwDesc.getViewName());
+      try {
+        Warehouse wh = new Warehouse(conf);
+        Map<String, String> tblProps = createVwDesc.getTblProps();
+        tlocation = wh.getDefaultTablePath(db.getDatabase(dbTable[0]), dbTable[1],
+          tblProps == null || !AcidUtils.isTablePropertyTransactional(tblProps));
+      } catch (MetaException|HiveException e) {
+        throw new SemanticException(e);
+      }
+
+      queryState.getLineageState()
+        .mapDirToOp(tlocation, output);
     }
   }
 
diff --git a/ql/src/test/results/clientnegative/drop_table_used_by_mv.q.out b/ql/src/test/results/clientnegative/drop_table_used_by_mv.q.out
index 77ec4cf2d5..42f21b9763 100644
--- a/ql/src/test/results/clientnegative/drop_table_used_by_mv.q.out
+++ b/ql/src/test/results/clientnegative/drop_table_used_by_mv.q.out
@@ -28,6 +28,8 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@mytable
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
+POSTHOOK: Lineage: mv1.key SIMPLE [(mytable)mytable.FieldSchema(name:key, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1.value SIMPLE [(mytable)mytable.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: drop table mytable
 PREHOOK: type: DROPTABLE
 PREHOOK: Input: default@mytable
diff --git a/ql/src/test/results/clientnegative/drop_table_used_by_mv2.q.out b/ql/src/test/results/clientnegative/drop_table_used_by_mv2.q.out
index 54da2eaeee..269f2b3c33 100644
--- a/ql/src/test/results/clientnegative/drop_table_used_by_mv2.q.out
+++ b/ql/src/test/results/clientnegative/drop_table_used_by_mv2.q.out
@@ -42,6 +42,8 @@ POSTHOOK: Input: default@mytable
 POSTHOOK: Input: default@myview
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
+POSTHOOK: Lineage: mv1.key SIMPLE [(mytable)mytable.FieldSchema(name:key, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1.value SIMPLE [(mytable)mytable.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: create materialized view mv2 disable rewrite as
 select count(*) from myview
 PREHOOK: type: CREATE_MATERIALIZED_VIEW
@@ -56,6 +58,7 @@ POSTHOOK: Input: default@mytable
 POSTHOOK: Input: default@myview
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv2
+POSTHOOK: Lineage: mv2._c0 EXPRESSION [(mytable)mytable.null, ]
 PREHOOK: query: drop view myview
 PREHOOK: type: DROPVIEW
 PREHOOK: Input: default@myview
diff --git a/ql/src/test/results/clientnegative/export_materialized_view.q.out b/ql/src/test/results/clientnegative/export_materialized_view.q.out
index 239e41ef5f..a2c93030e6 100644
--- a/ql/src/test/results/clientnegative/export_materialized_view.q.out
+++ b/ql/src/test/results/clientnegative/export_materialized_view.q.out
@@ -16,4 +16,5 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@t
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@export_materialized_view
+POSTHOOK: Lineage: export_materialized_view.a SIMPLE [(t)t.FieldSchema(name:a, type:int, comment:null), ]
 FAILED: SemanticException Views and Materialized Views can not be exported.
diff --git a/ql/src/test/results/clientnegative/masking_mv.q.out b/ql/src/test/results/clientnegative/masking_mv.q.out
index b4928a7bf3..27a0d21fc9 100644
--- a/ql/src/test/results/clientnegative/masking_mv.q.out
+++ b/ql/src/test/results/clientnegative/masking_mv.q.out
@@ -138,4 +138,5 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@masking_test_n_mv
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@masking_test_view_n_mv
+POSTHOOK: Lineage: masking_test_view_n_mv.key SIMPLE [(masking_test_n_mv)masking_test_n_mv.FieldSchema(name:key, type:int, comment:null), ]
 FAILED: SemanticException [Error 10288]: Querying directly materialized view contents is not supported since we detected default.masking_test_n_mv used by materialized view has row masking/column filtering enabled
diff --git a/ql/src/test/results/clientnegative/materialized_view_authorization_drop_other.q.out b/ql/src/test/results/clientnegative/materialized_view_authorization_drop_other.q.out
index d95691a761..96aa46a3be 100644
--- a/ql/src/test/results/clientnegative/materialized_view_authorization_drop_other.q.out
+++ b/ql/src/test/results/clientnegative/materialized_view_authorization_drop_other.q.out
@@ -27,4 +27,6 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@amvdo_table
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@amvdo_mat_view
+POSTHOOK: Lineage: amvdo_mat_view.a SIMPLE [(amvdo_table)amvdo_table.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: amvdo_mat_view.c SIMPLE [(amvdo_table)amvdo_table.FieldSchema(name:c, type:decimal(10,2), comment:null), ]
 FAILED: HiveAccessControlException Permission denied: Principal [name=user2, type=USER] does not have following privileges for operation DROP_MATERIALIZED_VIEW [[OBJECT OWNERSHIP] on Object [type=TABLE_OR_VIEW, name=default.amvdo_mat_view], [OBJECT OWNERSHIP] on Object [type=TABLE_OR_VIEW, name=default.amvdo_mat_view]]
diff --git a/ql/src/test/results/clientnegative/materialized_view_authorization_no_select_perm.q.out b/ql/src/test/results/clientnegative/materialized_view_authorization_no_select_perm.q.out
index d647b01529..e1686a27be 100644
--- a/ql/src/test/results/clientnegative/materialized_view_authorization_no_select_perm.q.out
+++ b/ql/src/test/results/clientnegative/materialized_view_authorization_no_select_perm.q.out
@@ -27,4 +27,6 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@amvnsp_table
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@amvnsp_mat_view
+POSTHOOK: Lineage: amvnsp_mat_view.a SIMPLE [(amvnsp_table)amvnsp_table.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: amvnsp_mat_view.c SIMPLE [(amvnsp_table)amvnsp_table.FieldSchema(name:c, type:decimal(10,2), comment:null), ]
 FAILED: HiveAccessControlException Permission denied: Principal [name=user2, type=USER] does not have following privileges for operation QUERY [[SELECT] on Object [type=TABLE_OR_VIEW, name=default.amvnsp_mat_view]]
diff --git a/ql/src/test/results/clientnegative/materialized_view_authorization_rebuild_no_grant.q.out b/ql/src/test/results/clientnegative/materialized_view_authorization_rebuild_no_grant.q.out
index 4c74ef9e36..a3d62189c4 100644
--- a/ql/src/test/results/clientnegative/materialized_view_authorization_rebuild_no_grant.q.out
+++ b/ql/src/test/results/clientnegative/materialized_view_authorization_rebuild_no_grant.q.out
@@ -33,4 +33,6 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@amvrng_table
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@amvrng_mat_view
+POSTHOOK: Lineage: amvrng_mat_view.a SIMPLE [(amvrng_table)amvrng_table.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: amvrng_mat_view.c SIMPLE [(amvrng_table)amvrng_table.FieldSchema(name:c, type:decimal(10,2), comment:null), ]
 FAILED: HiveAccessControlException Permission denied: Principal [name=user1, type=USER] does not have following privileges for operation ALTER_MATERIALIZED_VIEW_REBUILD [[INSERT, DELETE] on Object [type=TABLE_OR_VIEW, name=default.amvrng_mat_view, action=INSERT_OVERWRITE]]
diff --git a/ql/src/test/results/clientnegative/materialized_view_authorization_rebuild_other.q.out b/ql/src/test/results/clientnegative/materialized_view_authorization_rebuild_other.q.out
index 025a24e02e..e6b7769836 100644
--- a/ql/src/test/results/clientnegative/materialized_view_authorization_rebuild_other.q.out
+++ b/ql/src/test/results/clientnegative/materialized_view_authorization_rebuild_other.q.out
@@ -27,4 +27,6 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@amvro_table
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@amvro_mat_view
+POSTHOOK: Lineage: amvro_mat_view.a SIMPLE [(amvro_table)amvro_table.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: amvro_mat_view.c SIMPLE [(amvro_table)amvro_table.FieldSchema(name:c, type:decimal(10,2), comment:null), ]
 FAILED: HiveAccessControlException Permission denied: Principal [name=user2, type=USER] does not have following privileges for operation ALTER_MATERIALIZED_VIEW_REBUILD [[INSERT, DELETE] on Object [type=TABLE_OR_VIEW, name=default.amvro_mat_view, action=INSERT_OVERWRITE], [SELECT] on Object [type=TABLE_OR_VIEW, name=default.amvro_table]]
diff --git a/ql/src/test/results/clientnegative/materialized_view_delete.q.out b/ql/src/test/results/clientnegative/materialized_view_delete.q.out
index 2196615293..12a8f41bf8 100644
--- a/ql/src/test/results/clientnegative/materialized_view_delete.q.out
+++ b/ql/src/test/results/clientnegative/materialized_view_delete.q.out
@@ -16,4 +16,7 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@dmv_basetable
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@dmv_mat_view
+POSTHOOK: Lineage: dmv_mat_view.a SIMPLE [(dmv_basetable)dmv_basetable.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: dmv_mat_view.b SIMPLE [(dmv_basetable)dmv_basetable.FieldSchema(name:b, type:varchar(256), comment:null), ]
+POSTHOOK: Lineage: dmv_mat_view.c SIMPLE [(dmv_basetable)dmv_basetable.FieldSchema(name:c, type:decimal(10,2), comment:null), ]
 FAILED: SemanticException [Error 10402]: You cannot update or delete records in a view
diff --git a/ql/src/test/results/clientnegative/materialized_view_drop.q.out b/ql/src/test/results/clientnegative/materialized_view_drop.q.out
index 35d3c5be20..e39543c438 100644
--- a/ql/src/test/results/clientnegative/materialized_view_drop.q.out
+++ b/ql/src/test/results/clientnegative/materialized_view_drop.q.out
@@ -27,6 +27,9 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@cmv_basetable
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cmv_mat_view
+POSTHOOK: Lineage: cmv_mat_view.a SIMPLE [(cmv_basetable)cmv_basetable.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: cmv_mat_view.b SIMPLE [(cmv_basetable)cmv_basetable.FieldSchema(name:b, type:varchar(256), comment:null), ]
+POSTHOOK: Lineage: cmv_mat_view.c SIMPLE [(cmv_basetable)cmv_basetable.FieldSchema(name:c, type:decimal(10,2), comment:null), ]
 PREHOOK: query: drop materialized view cmv_mat_view
 PREHOOK: type: DROP_MATERIALIZED_VIEW
 PREHOOK: Input: default@cmv_mat_view
diff --git a/ql/src/test/results/clientnegative/materialized_view_drop2.q.out b/ql/src/test/results/clientnegative/materialized_view_drop2.q.out
index 803b5b42da..7b020b47b7 100644
--- a/ql/src/test/results/clientnegative/materialized_view_drop2.q.out
+++ b/ql/src/test/results/clientnegative/materialized_view_drop2.q.out
@@ -27,6 +27,9 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@cmv_basetable
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cmv_mat_view
+POSTHOOK: Lineage: cmv_mat_view.a SIMPLE [(cmv_basetable)cmv_basetable.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: cmv_mat_view.b SIMPLE [(cmv_basetable)cmv_basetable.FieldSchema(name:b, type:varchar(256), comment:null), ]
+POSTHOOK: Lineage: cmv_mat_view.c SIMPLE [(cmv_basetable)cmv_basetable.FieldSchema(name:c, type:decimal(10,2), comment:null), ]
 PREHOOK: query: drop view cmv_mat_view
 PREHOOK: type: DROPVIEW
 PREHOOK: Input: default@cmv_mat_view
diff --git a/ql/src/test/results/clientnegative/materialized_view_insert.q.out b/ql/src/test/results/clientnegative/materialized_view_insert.q.out
index 734cbb223a..d9e896bc86 100644
--- a/ql/src/test/results/clientnegative/materialized_view_insert.q.out
+++ b/ql/src/test/results/clientnegative/materialized_view_insert.q.out
@@ -16,4 +16,7 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@imv_basetable
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@imv_mat_view
+POSTHOOK: Lineage: imv_mat_view.a SIMPLE [(imv_basetable)imv_basetable.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: imv_mat_view.b SIMPLE [(imv_basetable)imv_basetable.FieldSchema(name:b, type:varchar(256), comment:null), ]
+POSTHOOK: Lineage: imv_mat_view.c SIMPLE [(imv_basetable)imv_basetable.FieldSchema(name:c, type:decimal(10,2), comment:null), ]
 FAILED: SemanticException [Error 10090]: A view cannot be used as target table for LOAD or INSERT
diff --git a/ql/src/test/results/clientnegative/materialized_view_load.q.out b/ql/src/test/results/clientnegative/materialized_view_load.q.out
index 29bcfb4ce8..54f799ba59 100644
--- a/ql/src/test/results/clientnegative/materialized_view_load.q.out
+++ b/ql/src/test/results/clientnegative/materialized_view_load.q.out
@@ -16,4 +16,7 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@lmv_basetable
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@lmv_mat_view
+POSTHOOK: Lineage: lmv_mat_view.a SIMPLE [(lmv_basetable)lmv_basetable.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: lmv_mat_view.b SIMPLE [(lmv_basetable)lmv_basetable.FieldSchema(name:b, type:varchar(256), comment:null), ]
+POSTHOOK: Lineage: lmv_mat_view.c SIMPLE [(lmv_basetable)lmv_basetable.FieldSchema(name:c, type:decimal(10,2), comment:null), ]
 FAILED: SemanticException [Error 10090]: A view cannot be used as target table for LOAD or INSERT
diff --git a/ql/src/test/results/clientnegative/materialized_view_name_collusion.q.out b/ql/src/test/results/clientnegative/materialized_view_name_collusion.q.out
index 9a2cb3e340..48c33e2f1a 100644
--- a/ql/src/test/results/clientnegative/materialized_view_name_collusion.q.out
+++ b/ql/src/test/results/clientnegative/materialized_view_name_collusion.q.out
@@ -16,4 +16,7 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@mvnc_basetable
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mvnc_mat_view
+POSTHOOK: Lineage: mvnc_mat_view.a SIMPLE [(mvnc_basetable)mvnc_basetable.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: mvnc_mat_view.b SIMPLE [(mvnc_basetable)mvnc_basetable.FieldSchema(name:b, type:varchar(256), comment:null), ]
+POSTHOOK: Lineage: mvnc_mat_view.c SIMPLE [(mvnc_basetable)mvnc_basetable.FieldSchema(name:c, type:decimal(10,2), comment:null), ]
 FAILED: SemanticException org.apache.hadoop.hive.ql.parse.SemanticException: Table already exists: default.mvnc_mat_view
diff --git a/ql/src/test/results/clientnegative/materialized_view_no_cbo_rewrite_2.q.out b/ql/src/test/results/clientnegative/materialized_view_no_cbo_rewrite_2.q.out
index b2cb1db6c1..9083c736d6 100644
--- a/ql/src/test/results/clientnegative/materialized_view_no_cbo_rewrite_2.q.out
+++ b/ql/src/test/results/clientnegative/materialized_view_no_cbo_rewrite_2.q.out
@@ -29,6 +29,9 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@cmv_basetable
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cmv_mat_view
+POSTHOOK: Lineage: cmv_mat_view.a SIMPLE [(cmv_basetable)cmv_basetable.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: cmv_mat_view.b SIMPLE [(cmv_basetable)cmv_basetable.FieldSchema(name:b, type:varchar(256), comment:null), ]
+POSTHOOK: Lineage: cmv_mat_view.c SIMPLE [(cmv_basetable)cmv_basetable.FieldSchema(name:c, type:decimal(10,2), comment:null), ]
 PREHOOK: query: alter materialized view cmv_mat_view enable rewrite
 PREHOOK: type: ALTER_MATERIALIZED_VIEW_REWRITE
 PREHOOK: Input: default@cmv_mat_view
diff --git a/ql/src/test/results/clientnegative/materialized_view_no_supported_op_rewrite_2.q.out b/ql/src/test/results/clientnegative/materialized_view_no_supported_op_rewrite_2.q.out
index cd2adbb585..bb771614ee 100644
--- a/ql/src/test/results/clientnegative/materialized_view_no_supported_op_rewrite_2.q.out
+++ b/ql/src/test/results/clientnegative/materialized_view_no_supported_op_rewrite_2.q.out
@@ -30,6 +30,7 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@cmv_basetable
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cmv_mat_view
+POSTHOOK: Lineage: cmv_mat_view.a SIMPLE [(cmv_basetable)t1.FieldSchema(name:a, type:int, comment:null), ]
 PREHOOK: query: alter materialized view cmv_mat_view enable rewrite
 PREHOOK: type: ALTER_MATERIALIZED_VIEW_REWRITE
 PREHOOK: Input: default@cmv_mat_view
diff --git a/ql/src/test/results/clientnegative/materialized_view_no_transactional_rewrite_2.q.out b/ql/src/test/results/clientnegative/materialized_view_no_transactional_rewrite_2.q.out
index 45fb2087c7..ab31cc3076 100644
--- a/ql/src/test/results/clientnegative/materialized_view_no_transactional_rewrite_2.q.out
+++ b/ql/src/test/results/clientnegative/materialized_view_no_transactional_rewrite_2.q.out
@@ -27,4 +27,7 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@cmv_basetable
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cmv_mat_view
+POSTHOOK: Lineage: cmv_mat_view.a SIMPLE [(cmv_basetable)cmv_basetable.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: cmv_mat_view.b SIMPLE [(cmv_basetable)cmv_basetable.FieldSchema(name:b, type:varchar(256), comment:null), ]
+POSTHOOK: Lineage: cmv_mat_view.c SIMPLE [(cmv_basetable)cmv_basetable.FieldSchema(name:c, type:decimal(10,2), comment:null), ]
 FAILED: SemanticException Automatic rewriting for materialized view cannot be enabled if the materialized view uses non-transactional tables
diff --git a/ql/src/test/results/clientnegative/materialized_view_replace_with_view.q.out b/ql/src/test/results/clientnegative/materialized_view_replace_with_view.q.out
index 1cc0047660..318499510a 100644
--- a/ql/src/test/results/clientnegative/materialized_view_replace_with_view.q.out
+++ b/ql/src/test/results/clientnegative/materialized_view_replace_with_view.q.out
@@ -27,4 +27,7 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@rmvwv_basetable
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@rmvwv_mat_view
+POSTHOOK: Lineage: rmvwv_mat_view.a SIMPLE [(rmvwv_basetable)rmvwv_basetable.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: rmvwv_mat_view.b SIMPLE [(rmvwv_basetable)rmvwv_basetable.FieldSchema(name:b, type:varchar(256), comment:null), ]
+POSTHOOK: Lineage: rmvwv_mat_view.c SIMPLE [(rmvwv_basetable)rmvwv_basetable.FieldSchema(name:c, type:decimal(10,2), comment:null), ]
 FAILED: SemanticException [Error 10401]: Attempt to replace materialized view rmvwv_mat_view with view
diff --git a/ql/src/test/results/clientnegative/materialized_view_update.q.out b/ql/src/test/results/clientnegative/materialized_view_update.q.out
index 4597022dff..c3f2931427 100644
--- a/ql/src/test/results/clientnegative/materialized_view_update.q.out
+++ b/ql/src/test/results/clientnegative/materialized_view_update.q.out
@@ -16,4 +16,7 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@umv_basetable
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@umv_mat_view
+POSTHOOK: Lineage: umv_mat_view.a SIMPLE [(umv_basetable)umv_basetable.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: umv_mat_view.b SIMPLE [(umv_basetable)umv_basetable.FieldSchema(name:b, type:varchar(256), comment:null), ]
+POSTHOOK: Lineage: umv_mat_view.c SIMPLE [(umv_basetable)umv_basetable.FieldSchema(name:c, type:decimal(10,2), comment:null), ]
 FAILED: SemanticException [Error 10402]: You cannot update or delete records in a view
diff --git a/ql/src/test/results/clientpositive/beeline/materialized_view_create_rewrite.q.out b/ql/src/test/results/clientpositive/beeline/materialized_view_create_rewrite.q.out
index 6ba1829e8b..a93458de03 100644
--- a/ql/src/test/results/clientpositive/beeline/materialized_view_create_rewrite.q.out
+++ b/ql/src/test/results/clientpositive/beeline/materialized_view_create_rewrite.q.out
@@ -40,6 +40,9 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@cmv_basetable_n10
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cmv_mat_view_n10
+POSTHOOK: Lineage: cmv_mat_view_n10.a SIMPLE []
+POSTHOOK: Lineage: cmv_mat_view_n10.b SIMPLE [(cmv_basetable_n10)cmv_basetable_n10.FieldSchema(name:b, type:varchar(256), comment:null), ]
+POSTHOOK: Lineage: cmv_mat_view_n10.c SIMPLE [(cmv_basetable_n10)cmv_basetable_n10.FieldSchema(name:c, type:decimal(10,2), comment:null), ]
 PREHOOK: query: select * from cmv_mat_view_n10
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cmv_mat_view_n10
@@ -74,6 +77,8 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@cmv_basetable_n10
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cmv_mat_view2_n4
+POSTHOOK: Lineage: cmv_mat_view2_n4.a SIMPLE []
+POSTHOOK: Lineage: cmv_mat_view2_n4.c SIMPLE [(cmv_basetable_n10)cmv_basetable_n10.FieldSchema(name:c, type:decimal(10,2), comment:null), ]
 PREHOOK: query: select * from cmv_mat_view2_n4
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cmv_mat_view2_n4
diff --git a/ql/src/test/results/clientpositive/llap/create_view_when_mv_exists.q.out b/ql/src/test/results/clientpositive/llap/create_view_when_mv_exists.q.out
index 14df7dd16f..345858cbdc 100644
--- a/ql/src/test/results/clientpositive/llap/create_view_when_mv_exists.q.out
+++ b/ql/src/test/results/clientpositive/llap/create_view_when_mv_exists.q.out
@@ -27,6 +27,7 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@t1
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
+POSTHOOK: Lineage: mv1.col0 SIMPLE [(t1)t1.FieldSchema(name:col0, type:int, comment:null), ]
 PREHOOK: query: explain cbo
 create view v1 as
 select sub.* from (select * from t1 where col0 > 2) sub
diff --git a/ql/src/test/results/clientpositive/llap/masking_mv.q.out b/ql/src/test/results/clientpositive/llap/masking_mv.q.out
index ab860e7f14..97494e1588 100644
--- a/ql/src/test/results/clientpositive/llap/masking_mv.q.out
+++ b/ql/src/test/results/clientpositive/llap/masking_mv.q.out
@@ -138,6 +138,7 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@masking_test_n_mv
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@masking_test_view_n_mv
+POSTHOOK: Lineage: masking_test_view_n_mv.key SIMPLE [(masking_test_n_mv)masking_test_n_mv.FieldSchema(name:key, type:int, comment:null), ]
 PREHOOK: query: describe formatted `masking_test_view_n_mv`
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@masking_test_view_n_mv
@@ -234,6 +235,8 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@masking_test_n_mv
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@masking_test_view_n_mv_3
+POSTHOOK: Lineage: masking_test_view_n_mv_3._c1 EXPRESSION [(masking_test_n_mv)masking_test_n_mv.FieldSchema(name:key, type:int, comment:null), ]
+POSTHOOK: Lineage: masking_test_view_n_mv_3.value SIMPLE [(masking_test_n_mv)masking_test_n_mv.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: explain
 select key from `masking_test_n_mv` group by key
 PREHOOK: type: QUERY
@@ -506,6 +509,8 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@masking_test_n_mv
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@masking_test_view_n_mv_4
+POSTHOOK: Lineage: masking_test_view_n_mv_4.key SIMPLE [(masking_test_n_mv)masking_test_n_mv.FieldSchema(name:key, type:int, comment:null), ]
+POSTHOOK: Lineage: masking_test_view_n_mv_4.value SIMPLE [(masking_test_n_mv)masking_test_n_mv.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: explain
 select value from `masking_test_n_mv` group by value
 PREHOOK: type: QUERY
@@ -831,6 +836,7 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@srctnx
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@masking_test_view_n_mv_2
+POSTHOOK: Lineage: masking_test_view_n_mv_2.key SIMPLE [(srctnx)srctnx.FieldSchema(name:key, type:int, comment:null), ]
 PREHOOK: query: describe formatted `masking_test_view_n_mv_2`
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@masking_test_view_n_mv_2
diff --git a/ql/src/test/results/clientpositive/llap/masking_mv_by_text.q.out b/ql/src/test/results/clientpositive/llap/masking_mv_by_text.q.out
index eee752bca1..9ad06dc77d 100644
--- a/ql/src/test/results/clientpositive/llap/masking_mv_by_text.q.out
+++ b/ql/src/test/results/clientpositive/llap/masking_mv_by_text.q.out
@@ -138,6 +138,7 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@masking_test_n_mv
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@masking_test_view_n_mv
+POSTHOOK: Lineage: masking_test_view_n_mv.key SIMPLE [(masking_test_n_mv)masking_test_n_mv.FieldSchema(name:key, type:int, comment:null), ]
 PREHOOK: query: describe formatted `masking_test_view_n_mv`
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@masking_test_view_n_mv
@@ -205,6 +206,7 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@masking_test_n_mv
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@masking_test_view_n_mv_masked
+POSTHOOK: Lineage: masking_test_view_n_mv_masked.key SIMPLE [(masking_test_n_mv)masking_test_n_mv.FieldSchema(name:key, type:int, comment:null), ]
 PREHOOK: query: explain cbo
 select key from `masking_test_n_mv`
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_authorization_sqlstd.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_authorization_sqlstd.q.out
index cc9e913808..f1f9526efa 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_authorization_sqlstd.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_authorization_sqlstd.q.out
@@ -27,6 +27,8 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@amvs_table
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@amvs_mat_view
+POSTHOOK: Lineage: amvs_mat_view.a SIMPLE [(amvs_table)amvs_table.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: amvs_mat_view.c SIMPLE [(amvs_table)amvs_table.FieldSchema(name:c, type:decimal(10,2), comment:null), ]
 PREHOOK: query: show grant user user1 on table amvs_mat_view
 PREHOOK: type: SHOW_GRANT
 POSTHOOK: query: show grant user user1 on table amvs_mat_view
@@ -158,6 +160,8 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@amvs_table
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@amvs_mat_view2
+POSTHOOK: Lineage: amvs_mat_view2.a SIMPLE [(amvs_table)amvs_table.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: amvs_mat_view2.b SIMPLE [(amvs_table)amvs_table.FieldSchema(name:b, type:varchar(256), comment:null), ]
 PREHOOK: query: select * from amvs_mat_view2
 PREHOOK: type: QUERY
 PREHOOK: Input: default@amvs_mat_view2
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_cluster.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_cluster.q.out
index 33fd3b4c01..b0035761ab 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_cluster.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_cluster.q.out
@@ -159,6 +159,8 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@src_txn
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cluster_mv_1
+POSTHOOK: Lineage: cluster_mv_1.key SIMPLE [(src_txn)src_txn.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: cluster_mv_1.value SIMPLE [(src_txn)src_txn.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: DESCRIBE FORMATTED cluster_mv_1
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@cluster_mv_1
@@ -307,6 +309,8 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@src_txn
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cluster_mv_2
+POSTHOOK: Lineage: cluster_mv_2.key SIMPLE [(src_txn)src_txn.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: cluster_mv_2.value SIMPLE [(src_txn)src_txn.FieldSchema(name:value, type:string, comment:null), ]
 Found 2 items
 #### A masked pattern was here ####
 202val_202
@@ -622,6 +626,8 @@ POSTHOOK: Input: default@src_txn
 POSTHOOK: Input: default@src_txn_2
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cluster_mv_3
+POSTHOOK: Lineage: cluster_mv_3.key SIMPLE [(src_txn)src_txn.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: cluster_mv_3.value SIMPLE [(src_txn)src_txn.FieldSchema(name:value, type:string, comment:null), ]
 Found 2 items
 #### A masked pattern was here ####
 val_201201
@@ -946,6 +952,10 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@src_txn
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cluster_mv_4
+POSTHOOK: Lineage: cluster_mv_4.key SIMPLE [(src_txn)src_txn.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: cluster_mv_4.te*#"s"t EXPRESSION [(src_txn)src_txn.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: cluster_mv_4.tes"t EXPRESSION [(src_txn)src_txn.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: cluster_mv_4.value SIMPLE [(src_txn)src_txn.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: DESCRIBE FORMATTED cluster_mv_4
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@cluster_mv_4
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_count_distinct.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_count_distinct.q.out
index bb46a4b76a..830fc696b9 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_count_distinct.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_count_distinct.q.out
@@ -71,6 +71,8 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: count_distinct@base
 POSTHOOK: Output: count_distinct@base_mview1
 POSTHOOK: Output: database:count_distinct
+POSTHOOK: Lineage: base_mview1.c1 SIMPLE [(base)base.FieldSchema(name:c1, type:int, comment:null), ]
+POSTHOOK: Lineage: base_mview1.c2 SIMPLE [(base)base.FieldSchema(name:c2, type:int, comment:null), ]
 PREHOOK: query: explain cbo
 select count(distinct c1) from base group by c2
 PREHOOK: type: QUERY
@@ -120,6 +122,9 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: count_distinct@base
 POSTHOOK: Output: count_distinct@base_mview2
 POSTHOOK: Output: database:count_distinct
+POSTHOOK: Lineage: base_mview2._c2 EXPRESSION [(base)base.FieldSchema(name:c2, type:int, comment:null), ]
+POSTHOOK: Lineage: base_mview2.c1 SIMPLE [(base)base.FieldSchema(name:c1, type:int, comment:null), ]
+POSTHOOK: Lineage: base_mview2.c2 SIMPLE [(base)base.FieldSchema(name:c2, type:int, comment:null), ]
 PREHOOK: query: explain cbo
 select count(distinct c1) from base group by c2
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_create.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_create.q.out
index ca5b7fccf5..abc4f85c3e 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_create.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_create.q.out
@@ -27,6 +27,9 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@cmv_basetable_n4
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cmv_mat_view_n4
+POSTHOOK: Lineage: cmv_mat_view_n4.a SIMPLE [(cmv_basetable_n4)cmv_basetable_n4.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: cmv_mat_view_n4.b SIMPLE [(cmv_basetable_n4)cmv_basetable_n4.FieldSchema(name:b, type:varchar(256), comment:null), ]
+POSTHOOK: Lineage: cmv_mat_view_n4.c SIMPLE [(cmv_basetable_n4)cmv_basetable_n4.FieldSchema(name:c, type:decimal(10,2), comment:null), ]
 PREHOOK: query: desc formatted cmv_mat_view_n4
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@cmv_mat_view_n4
@@ -90,6 +93,8 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@cmv_basetable_n4
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cmv_mat_view2_n1
+POSTHOOK: Lineage: cmv_mat_view2_n1.a SIMPLE [(cmv_basetable_n4)cmv_basetable_n4.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: cmv_mat_view2_n1.c SIMPLE [(cmv_basetable_n4)cmv_basetable_n4.FieldSchema(name:c, type:decimal(10,2), comment:null), ]
 PREHOOK: query: desc formatted cmv_mat_view2_n1
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@cmv_mat_view2_n1
@@ -152,6 +157,9 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@cmv_basetable_n4
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cmv_mat_view3
+POSTHOOK: Lineage: cmv_mat_view3.a SIMPLE [(cmv_basetable_n4)cmv_basetable_n4.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: cmv_mat_view3.b SIMPLE [(cmv_basetable_n4)cmv_basetable_n4.FieldSchema(name:b, type:varchar(256), comment:null), ]
+POSTHOOK: Lineage: cmv_mat_view3.c SIMPLE [(cmv_basetable_n4)cmv_basetable_n4.FieldSchema(name:c, type:decimal(10,2), comment:null), ]
 PREHOOK: query: select * from cmv_mat_view3
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cmv_mat_view3
@@ -174,6 +182,8 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@cmv_basetable_n4
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cmv_mat_view4
+POSTHOOK: Lineage: cmv_mat_view4._c1 EXPRESSION [(cmv_basetable_n4)cmv_basetable_n4.FieldSchema(name:c, type:decimal(10,2), comment:null), ]
+POSTHOOK: Lineage: cmv_mat_view4.a SIMPLE [(cmv_basetable_n4)cmv_basetable_n4.FieldSchema(name:a, type:int, comment:null), ]
 PREHOOK: query: select * from cmv_mat_view4
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cmv_mat_view4
@@ -226,6 +236,11 @@ POSTHOOK: Input: default@cmv_basetable2
 POSTHOOK: Input: default@cmv_basetable_n4
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cmv_mat_view5
+POSTHOOK: Lineage: cmv_mat_view5.a SIMPLE [(cmv_basetable_n4)t1.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: cmv_mat_view5.b SIMPLE [(cmv_basetable_n4)t1.FieldSchema(name:b, type:varchar(256), comment:null), ]
+POSTHOOK: Lineage: cmv_mat_view5.c SIMPLE [(cmv_basetable_n4)t1.FieldSchema(name:c, type:decimal(10,2), comment:null), ]
+POSTHOOK: Lineage: cmv_mat_view5.d SIMPLE [(cmv_basetable2)t2.FieldSchema(name:d, type:int, comment:null), ]
+POSTHOOK: Lineage: cmv_mat_view5.f SIMPLE [(cmv_basetable2)t2.FieldSchema(name:f, type:decimal(10,2), comment:null), ]
 PREHOOK: query: select * from cmv_mat_view5
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cmv_mat_view5
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_create_acid.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_create_acid.q.out
index 6b4d3cac4e..887c8532ed 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_create_acid.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_create_acid.q.out
@@ -29,6 +29,9 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@cmv_basetable_n4
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cmv_mat_view_n4
+POSTHOOK: Lineage: cmv_mat_view_n4.a SIMPLE [(cmv_basetable_n4)cmv_basetable_n4.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: cmv_mat_view_n4.b SIMPLE [(cmv_basetable_n4)cmv_basetable_n4.FieldSchema(name:b, type:varchar(256), comment:null), ]
+POSTHOOK: Lineage: cmv_mat_view_n4.c SIMPLE [(cmv_basetable_n4)cmv_basetable_n4.FieldSchema(name:c, type:decimal(10,2), comment:null), ]
 PREHOOK: query: DESCRIBE FORMATTED cmv_mat_view_n4
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@cmv_mat_view_n4
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite.q.out
index 6a0c76911b..d769323845 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite.q.out
@@ -40,6 +40,9 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@cmv_basetable_n10
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cmv_mat_view_n10
+POSTHOOK: Lineage: cmv_mat_view_n10.a SIMPLE []
+POSTHOOK: Lineage: cmv_mat_view_n10.b SIMPLE [(cmv_basetable_n10)cmv_basetable_n10.FieldSchema(name:b, type:varchar(256), comment:null), ]
+POSTHOOK: Lineage: cmv_mat_view_n10.c SIMPLE [(cmv_basetable_n10)cmv_basetable_n10.FieldSchema(name:c, type:decimal(10,2), comment:null), ]
 PREHOOK: query: select * from cmv_mat_view_n10
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cmv_mat_view_n10
@@ -74,6 +77,8 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@cmv_basetable_n10
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cmv_mat_view2_n4
+POSTHOOK: Lineage: cmv_mat_view2_n4.a SIMPLE []
+POSTHOOK: Lineage: cmv_mat_view2_n4.c SIMPLE [(cmv_basetable_n10)cmv_basetable_n10.FieldSchema(name:c, type:decimal(10,2), comment:null), ]
 PREHOOK: query: select * from cmv_mat_view2_n4
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cmv_mat_view2_n4
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_2.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_2.q.out
index 8227edfe09..6328a918d5 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_2.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_2.q.out
@@ -40,6 +40,7 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@cmv_basetable_n9
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cmv_mat_view_n9
+POSTHOOK: Lineage: cmv_mat_view_n9.b SIMPLE [(cmv_basetable_n9)cmv_basetable_n9.FieldSchema(name:b, type:varchar(256), comment:null), ]
 PREHOOK: query: explain
 select b from cmv_basetable_n9 where c > 20.0 group by a, b
 PREHOOK: type: QUERY
@@ -137,6 +138,8 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@cmv_basetable_n9
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cmv_mat_view_2
+POSTHOOK: Lineage: cmv_mat_view_2.b SIMPLE [(cmv_basetable_n9)cmv_basetable_n9.FieldSchema(name:b, type:varchar(256), comment:null), ]
+POSTHOOK: Lineage: cmv_mat_view_2.c SIMPLE [(cmv_basetable_n9)cmv_basetable_n9.FieldSchema(name:c, type:decimal(10,2), comment:null), ]
 PREHOOK: query: explain
 select b from cmv_basetable_n9 where c > 20.0 group by a, b
 PREHOOK: type: QUERY
@@ -234,6 +237,9 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@cmv_basetable_n9
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cmv_mat_view_3
+POSTHOOK: Lineage: cmv_mat_view_3.a SIMPLE [(cmv_basetable_n9)cmv_basetable_n9.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: cmv_mat_view_3.b SIMPLE [(cmv_basetable_n9)cmv_basetable_n9.FieldSchema(name:b, type:varchar(256), comment:null), ]
+POSTHOOK: Lineage: cmv_mat_view_3.c SIMPLE [(cmv_basetable_n9)cmv_basetable_n9.FieldSchema(name:c, type:decimal(10,2), comment:null), ]
 PREHOOK: query: explain
 select b from cmv_basetable_n9 where c > 20.0 group by a, b
 PREHOOK: type: QUERY
@@ -335,6 +341,8 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@cmv_basetable_n9
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cmv_mat_view_4
+POSTHOOK: Lineage: cmv_mat_view_4.a SIMPLE [(cmv_basetable_n9)cmv_basetable_n9.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: cmv_mat_view_4.b SIMPLE [(cmv_basetable_n9)cmv_basetable_n9.FieldSchema(name:b, type:varchar(256), comment:null), ]
 PREHOOK: query: explain
 select b from cmv_basetable_n9 group by b
 PREHOOK: type: QUERY
@@ -463,6 +471,8 @@ POSTHOOK: Input: default@cmv_basetable_2_n4
 POSTHOOK: Input: default@cmv_basetable_n9
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cmv_mat_view_5
+POSTHOOK: Lineage: cmv_mat_view_5.a SIMPLE [(cmv_basetable_n9)cmv_basetable_n9.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: cmv_mat_view_5.c SIMPLE [(cmv_basetable_2_n4)cmv_basetable_2_n4.FieldSchema(name:c, type:decimal(10,2), comment:null), ]
 PREHOOK: query: explain
 select cmv_basetable_n9.a
 from cmv_basetable_n9 join cmv_basetable_2_n4 on (cmv_basetable_n9.a = cmv_basetable_2_n4.a)
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_3.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_3.q.out
index f0ab8b8c9f..c55192b9e9 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_3.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_3.q.out
@@ -265,6 +265,8 @@ POSTHOOK: Input: default@cmv_basetable
 POSTHOOK: Input: default@cmv_basetable_2
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cmv_mat_view
+POSTHOOK: Lineage: cmv_mat_view.a SIMPLE [(cmv_basetable)cmv_basetable.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: cmv_mat_view.c SIMPLE [(cmv_basetable_2)cmv_basetable_2.FieldSchema(name:c, type:decimal(10,2), comment:null), ]
 PREHOOK: query: EXPLAIN
 SELECT cmv_basetable.a
 FROM cmv_basetable join cmv_basetable_2 ON (cmv_basetable.a = cmv_basetable_2.a)
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_4.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_4.q.out
index f93fffc083..d9e2a93a65 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_4.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_4.q.out
@@ -270,6 +270,9 @@ POSTHOOK: Input: default@cmv_basetable_2_n2
 POSTHOOK: Input: default@cmv_basetable_n5
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cmv_mat_view_n5
+POSTHOOK: Lineage: cmv_mat_view_n5._c2 EXPRESSION [(cmv_basetable_2_n2)cmv_basetable_2_n2.FieldSchema(name:d, type:int, comment:null), ]
+POSTHOOK: Lineage: cmv_mat_view_n5.a SIMPLE [(cmv_basetable_n5)cmv_basetable_n5.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: cmv_mat_view_n5.c SIMPLE [(cmv_basetable_2_n2)cmv_basetable_2_n2.FieldSchema(name:c, type:decimal(10,2), comment:null), ]
 PREHOOK: query: DESCRIBE FORMATTED cmv_mat_view_n5
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@cmv_mat_view_n5
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_5.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_5.q.out
index 047555cda9..49dc579edc 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_5.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_5.q.out
@@ -72,6 +72,8 @@ POSTHOOK: Input: default@cmv_basetable_2_n3
 POSTHOOK: Input: default@cmv_basetable_n6
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cmv_mat_view_n6
+POSTHOOK: Lineage: cmv_mat_view_n6.a SIMPLE [(cmv_basetable_n6)cmv_basetable_n6.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: cmv_mat_view_n6.c SIMPLE [(cmv_basetable_2_n3)cmv_basetable_2_n3.FieldSchema(name:c, type:decimal(10,2), comment:null), ]
 PREHOOK: query: insert into cmv_basetable_2_n3 values
  (3, 'charlie', 15.8, 1)
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_6.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_6.q.out
index 93a3890775..19f810bcba 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_6.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_6.q.out
@@ -103,6 +103,9 @@ POSTHOOK: Input: default@t1
 POSTHOOK: Input: default@t2
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mat1
+POSTHOOK: Lineage: mat1._c1 EXPRESSION [(t1)t1.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: mat1._c2 EXPRESSION [(t1)t1.null, (t2)t2.null, ]
+POSTHOOK: Lineage: mat1.a SIMPLE [(t1)t1.FieldSchema(name:a, type:char(15), comment:null), ]
 PREHOOK: query: explain cbo
 select t1.a, sum(t1.b) from t1
 join t2 on (t1.a = t2.a)
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_by_text_multi_db.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_by_text_multi_db.q.out
index 8335c77acb..34d28e3b5e 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_by_text_multi_db.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_by_text_multi_db.q.out
@@ -64,6 +64,9 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: db1@cmv_basetable_n7
 POSTHOOK: Output: database:db2
 POSTHOOK: Output: db2@cmv_mat_view_n7
+POSTHOOK: Lineage: cmv_mat_view_n7.a SIMPLE []
+POSTHOOK: Lineage: cmv_mat_view_n7.b SIMPLE [(cmv_basetable_n7)cmv_basetable_n7.FieldSchema(name:b, type:varchar(256), comment:null), ]
+POSTHOOK: Lineage: cmv_mat_view_n7.c SIMPLE [(cmv_basetable_n7)cmv_basetable_n7.FieldSchema(name:c, type:decimal(10,2), comment:null), ]
 PREHOOK: query: select * from cmv_mat_view_n7
 PREHOOK: type: QUERY
 PREHOOK: Input: db2@cmv_mat_view_n7
@@ -98,6 +101,8 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: db1@cmv_basetable_n7
 POSTHOOK: Output: database:db2
 POSTHOOK: Output: db2@cmv_mat_view2_n2
+POSTHOOK: Lineage: cmv_mat_view2_n2.a SIMPLE []
+POSTHOOK: Lineage: cmv_mat_view2_n2.c SIMPLE [(cmv_basetable_n7)cmv_basetable_n7.FieldSchema(name:c, type:decimal(10,2), comment:null), ]
 PREHOOK: query: select * from cmv_mat_view2_n2
 PREHOOK: type: QUERY
 PREHOOK: Input: db2@cmv_mat_view2_n2
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_dummy.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_dummy.q.out
index 1da917d7b3..d230b1fea0 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_dummy.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_dummy.q.out
@@ -40,6 +40,9 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@cmv_basetable_n0
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cmv_mat_view_n0
+POSTHOOK: Lineage: cmv_mat_view_n0.a SIMPLE []
+POSTHOOK: Lineage: cmv_mat_view_n0.b SIMPLE [(cmv_basetable_n0)cmv_basetable_n0.FieldSchema(name:b, type:varchar(256), comment:null), ]
+POSTHOOK: Lineage: cmv_mat_view_n0.c SIMPLE [(cmv_basetable_n0)cmv_basetable_n0.FieldSchema(name:c, type:decimal(10,2), comment:null), ]
 PREHOOK: query: select * from cmv_mat_view_n0
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cmv_mat_view_n0
@@ -74,6 +77,8 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@cmv_basetable_n0
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cmv_mat_view2
+POSTHOOK: Lineage: cmv_mat_view2.a SIMPLE []
+POSTHOOK: Lineage: cmv_mat_view2.c SIMPLE [(cmv_basetable_n0)cmv_basetable_n0.FieldSchema(name:c, type:decimal(10,2), comment:null), ]
 PREHOOK: query: select * from cmv_mat_view2
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cmv_mat_view2
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_multi_db.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_multi_db.q.out
index 8335c77acb..34d28e3b5e 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_multi_db.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_multi_db.q.out
@@ -64,6 +64,9 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: db1@cmv_basetable_n7
 POSTHOOK: Output: database:db2
 POSTHOOK: Output: db2@cmv_mat_view_n7
+POSTHOOK: Lineage: cmv_mat_view_n7.a SIMPLE []
+POSTHOOK: Lineage: cmv_mat_view_n7.b SIMPLE [(cmv_basetable_n7)cmv_basetable_n7.FieldSchema(name:b, type:varchar(256), comment:null), ]
+POSTHOOK: Lineage: cmv_mat_view_n7.c SIMPLE [(cmv_basetable_n7)cmv_basetable_n7.FieldSchema(name:c, type:decimal(10,2), comment:null), ]
 PREHOOK: query: select * from cmv_mat_view_n7
 PREHOOK: type: QUERY
 PREHOOK: Input: db2@cmv_mat_view_n7
@@ -98,6 +101,8 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: db1@cmv_basetable_n7
 POSTHOOK: Output: database:db2
 POSTHOOK: Output: db2@cmv_mat_view2_n2
+POSTHOOK: Lineage: cmv_mat_view2_n2.a SIMPLE []
+POSTHOOK: Lineage: cmv_mat_view2_n2.c SIMPLE [(cmv_basetable_n7)cmv_basetable_n7.FieldSchema(name:c, type:decimal(10,2), comment:null), ]
 PREHOOK: query: select * from cmv_mat_view2_n2
 PREHOOK: type: QUERY
 PREHOOK: Input: db2@cmv_mat_view2_n2
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_nulls.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_nulls.q.out
index d2375a56ec..36b3c8dea7 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_nulls.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_nulls.q.out
@@ -59,6 +59,11 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@t1
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mat1
+POSTHOOK: Lineage: mat1._c2 EXPRESSION [(t1)t1.FieldSchema(name:d, type:int, comment:null), ]
+POSTHOOK: Lineage: mat1._c3 EXPRESSION [(t1)t1.FieldSchema(name:d, type:int, comment:null), ]
+POSTHOOK: Lineage: mat1._c4 EXPRESSION [(t1)t1.FieldSchema(name:d, type:int, comment:null), ]
+POSTHOOK: Lineage: mat1.a SIMPLE [(t1)t1.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: mat1.b SIMPLE [(t1)t1.FieldSchema(name:b, type:varchar(256), comment:null), ]
 a	b	_c2	_c3	_c4
 PREHOOK: query: INSERT INTO t1 VALUES
  (NULL, 'new row with NULL GBY key', 100.77, 35),
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_one_key_gby.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_one_key_gby.q.out
index d562cef2d6..c1954ad000 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_one_key_gby.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_one_key_gby.q.out
@@ -72,6 +72,8 @@ POSTHOOK: Input: default@cmv_basetable_2_n2
 POSTHOOK: Input: default@cmv_basetable_n5
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cmv_mat_view_n5
+POSTHOOK: Lineage: cmv_mat_view_n5._c1 EXPRESSION [(cmv_basetable_2_n2)cmv_basetable_2_n2.FieldSchema(name:d, type:int, comment:null), ]
+POSTHOOK: Lineage: cmv_mat_view_n5.a SIMPLE [(cmv_basetable_n5)cmv_basetable_n5.FieldSchema(name:a, type:int, comment:null), ]
 PREHOOK: query: insert into cmv_basetable_2_n2 values
  (3, 'charlie', 15.8, 1)
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_rebuild_dummy.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_rebuild_dummy.q.out
index 0ac8b08e3e..a0fb7d9c39 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_rebuild_dummy.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_rebuild_dummy.q.out
@@ -265,6 +265,8 @@ POSTHOOK: Input: default@cmv_basetable_2_n0
 POSTHOOK: Input: default@cmv_basetable_n1
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cmv_mat_view_n1
+POSTHOOK: Lineage: cmv_mat_view_n1.a SIMPLE [(cmv_basetable_n1)cmv_basetable_n1.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: cmv_mat_view_n1.c SIMPLE [(cmv_basetable_2_n0)cmv_basetable_2_n0.FieldSchema(name:c, type:decimal(10,2), comment:null), ]
 PREHOOK: query: EXPLAIN
 SELECT cmv_basetable_n1.a
 FROM cmv_basetable_n1 join cmv_basetable_2_n0 ON (cmv_basetable_n1.a = cmv_basetable_2_n0.a)
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_time_window.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_time_window.q.out
index 4787b57ad2..8f4a888687 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_time_window.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_time_window.q.out
@@ -265,6 +265,8 @@ POSTHOOK: Input: default@cmv_basetable_2_n1
 POSTHOOK: Input: default@cmv_basetable_n3
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cmv_mat_view_n3
+POSTHOOK: Lineage: cmv_mat_view_n3.a SIMPLE [(cmv_basetable_n3)cmv_basetable_n3.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: cmv_mat_view_n3.c SIMPLE [(cmv_basetable_2_n1)cmv_basetable_2_n1.FieldSchema(name:c, type:decimal(10,2), comment:null), ]
 PREHOOK: query: DESCRIBE FORMATTED cmv_mat_view_n3
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@cmv_mat_view_n3
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_time_window_2.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_time_window_2.q.out
index 535544e3e0..c364452171 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_time_window_2.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_create_rewrite_time_window_2.q.out
@@ -72,6 +72,8 @@ POSTHOOK: Input: default@cmv_basetable_2_n100
 POSTHOOK: Input: default@cmv_basetable_n100
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cmv_mat_view_n300
+POSTHOOK: Lineage: cmv_mat_view_n300.a SIMPLE [(cmv_basetable_n100)cmv_basetable_n100.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: cmv_mat_view_n300.c SIMPLE [(cmv_basetable_2_n100)cmv_basetable_2_n100.FieldSchema(name:c, type:decimal(10,2), comment:null), ]
 PREHOOK: query: DESCRIBE FORMATTED cmv_mat_view_n300
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@cmv_mat_view_n300
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_describe.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_describe.q.out
index 9e459b05b2..8d932e9a29 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_describe.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_describe.q.out
@@ -31,6 +31,8 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@cmv_basetable_n8
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cmv_mat_view_n8
+POSTHOOK: Lineage: cmv_mat_view_n8.a SIMPLE [(cmv_basetable_n8)cmv_basetable_n8.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: cmv_mat_view_n8.c SIMPLE [(cmv_basetable_n8)cmv_basetable_n8.FieldSchema(name:c, type:decimal(10,2), comment:null), ]
 PREHOOK: query: describe cmv_mat_view_n8
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@cmv_mat_view_n8
@@ -141,6 +143,7 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@cmv_basetable_n8
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cmv_mat_view2_n3
+POSTHOOK: Lineage: cmv_mat_view2_n3.a SIMPLE [(cmv_basetable_n8)cmv_basetable_n8.FieldSchema(name:a, type:int, comment:null), ]
 PREHOOK: query: describe formatted cmv_mat_view2_n3
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@cmv_mat_view2_n3
@@ -221,6 +224,9 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@cmv_basetable_n8
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cmv_mat_view3_n0
+POSTHOOK: Lineage: cmv_mat_view3_n0.a SIMPLE [(cmv_basetable_n8)cmv_basetable_n8.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: cmv_mat_view3_n0.b SIMPLE [(cmv_basetable_n8)cmv_basetable_n8.FieldSchema(name:b, type:varchar(256), comment:null), ]
+POSTHOOK: Lineage: cmv_mat_view3_n0.c SIMPLE [(cmv_basetable_n8)cmv_basetable_n8.FieldSchema(name:c, type:decimal(10,2), comment:null), ]
 PREHOOK: query: describe formatted cmv_mat_view3_n0
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@cmv_mat_view3_n0
@@ -314,6 +320,7 @@ POSTHOOK: Input: default@cmv_basetable_n8
 #### A masked pattern was here ####
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cmv_mat_view4_n0
+POSTHOOK: Lineage: cmv_mat_view4_n0.a SIMPLE [(cmv_basetable_n8)cmv_basetable_n8.FieldSchema(name:a, type:int, comment:null), ]
 PREHOOK: query: describe formatted cmv_mat_view4_n0
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@cmv_mat_view4_n0
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_distribute_sort.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_distribute_sort.q.out
index c468d4c699..eba1331398 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_distribute_sort.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_distribute_sort.q.out
@@ -159,6 +159,8 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@src_txn
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@distribute_mv_1
+POSTHOOK: Lineage: distribute_mv_1.key SIMPLE [(src_txn)src_txn.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: distribute_mv_1.value SIMPLE [(src_txn)src_txn.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: DESCRIBE FORMATTED distribute_mv_1
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@distribute_mv_1
@@ -441,6 +443,8 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@src_txn
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@distribute_mv_2
+POSTHOOK: Lineage: distribute_mv_2.key SIMPLE [(src_txn)src_txn.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: distribute_mv_2.value SIMPLE [(src_txn)src_txn.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: DESCRIBE FORMATTED distribute_mv_2
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@distribute_mv_2
@@ -985,6 +989,8 @@ POSTHOOK: Input: default@src_txn
 POSTHOOK: Input: default@src_txn_2
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@distribute_mv_3
+POSTHOOK: Lineage: distribute_mv_3.key SIMPLE [(src_txn)src_txn.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: distribute_mv_3.value SIMPLE [(src_txn)src_txn.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: DESCRIBE FORMATTED distribute_mv_3
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@distribute_mv_3
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_drop.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_drop.q.out
index 9f7e3b4192..ce73b68498 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_drop.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_drop.q.out
@@ -8,6 +8,8 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@alltypesorc
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@dmv_mat_view
+POSTHOOK: Lineage: dmv_mat_view.cint SIMPLE [(alltypesorc)alltypesorc.FieldSchema(name:cint, type:int, comment:null), ]
+POSTHOOK: Lineage: dmv_mat_view.cstring1 SIMPLE [(alltypesorc)alltypesorc.FieldSchema(name:cstring1, type:string, comment:null), ]
 PREHOOK: query: show table extended like dmv_mat_view
 PREHOOK: type: SHOW_TABLESTATUS
 POSTHOOK: query: show table extended like dmv_mat_view
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_parquet.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_parquet.q.out
index cd6032f155..12222d4e90 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_parquet.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_parquet.q.out
@@ -146,6 +146,11 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@emps_parquet_n3
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_parquet_n2
+POSTHOOK: Lineage: mv1_parquet_n2.commission SIMPLE [(emps_parquet_n3)emps_parquet_n3.FieldSchema(name:commission, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_parquet_n2.deptno SIMPLE [(emps_parquet_n3)emps_parquet_n3.FieldSchema(name:deptno, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_parquet_n2.empid SIMPLE [(emps_parquet_n3)emps_parquet_n3.FieldSchema(name:empid, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_parquet_n2.name SIMPLE [(emps_parquet_n3)emps_parquet_n3.FieldSchema(name:name, type:varchar(256), comment:null), ]
+POSTHOOK: Lineage: mv1_parquet_n2.salary SIMPLE [(emps_parquet_n3)emps_parquet_n3.FieldSchema(name:salary, type:float, comment:null), ]
 PREHOOK: query: describe formatted mv1_parquet_n2
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@mv1_parquet_n2
@@ -259,6 +264,10 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@emps_parquet_n3
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_parquet_n2
+POSTHOOK: Lineage: mv1_parquet_n2.commission SIMPLE [(emps_parquet_n3)emps_parquet_n3.FieldSchema(name:commission, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_parquet_n2.deptno SIMPLE [(emps_parquet_n3)emps_parquet_n3.FieldSchema(name:deptno, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_parquet_n2.name SIMPLE [(emps_parquet_n3)emps_parquet_n3.FieldSchema(name:name, type:varchar(256), comment:null), ]
+POSTHOOK: Lineage: mv1_parquet_n2.salary SIMPLE [(emps_parquet_n3)emps_parquet_n3.FieldSchema(name:salary, type:float, comment:null), ]
 PREHOOK: query: explain cbo
 select emps_parquet_n3.name, emps_parquet_n3.salary, emps_parquet_n3.commission
 from emps_parquet_n3
@@ -329,6 +338,7 @@ POSTHOOK: Input: default@depts_parquet_n2
 POSTHOOK: Input: default@emps_parquet_n3
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_parquet_n2
+POSTHOOK: Lineage: mv1_parquet_n2.deptno SIMPLE [(emps_parquet_n3)emps_parquet_n3.FieldSchema(name:empid, type:int, comment:null), ]
 PREHOOK: query: explain cbo
 select empid deptno from emps_parquet_n3
 join depts_parquet_n2 using (deptno) where empid = 1
@@ -386,6 +396,11 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@emps_parquet_n3
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_parquet_n2
+POSTHOOK: Lineage: mv1_parquet_n2.commission SIMPLE [(emps_parquet_n3)emps_parquet_n3.FieldSchema(name:commission, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_parquet_n2.deptno SIMPLE [(emps_parquet_n3)emps_parquet_n3.FieldSchema(name:deptno, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_parquet_n2.empid SIMPLE [(emps_parquet_n3)emps_parquet_n3.FieldSchema(name:empid, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_parquet_n2.name SIMPLE [(emps_parquet_n3)emps_parquet_n3.FieldSchema(name:name, type:varchar(256), comment:null), ]
+POSTHOOK: Lineage: mv1_parquet_n2.salary SIMPLE [(emps_parquet_n3)emps_parquet_n3.FieldSchema(name:salary, type:float, comment:null), ]
 PREHOOK: query: explain cbo
 select * from emps_parquet_n3 where empid > 120
 union all select * from emps_parquet_n3 where empid < 150
@@ -448,6 +463,8 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@emps_parquet_n3
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_parquet_n2
+POSTHOOK: Lineage: mv1_parquet_n2.deptno SIMPLE [(emps_parquet_n3)emps_parquet_n3.FieldSchema(name:deptno, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_parquet_n2.empid SIMPLE [(emps_parquet_n3)emps_parquet_n3.FieldSchema(name:empid, type:int, comment:null), ]
 PREHOOK: query: explain cbo
 select empid, deptno from emps_parquet_n3 group by empid, deptno
 PREHOOK: type: QUERY
@@ -501,6 +518,8 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@emps_parquet_n3
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_parquet_n2
+POSTHOOK: Lineage: mv1_parquet_n2.empid SIMPLE [(emps_parquet_n3)emps_parquet_n3.FieldSchema(name:empid, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_parquet_n2.name SIMPLE [(emps_parquet_n3)emps_parquet_n3.FieldSchema(name:name, type:varchar(256), comment:null), ]
 PREHOOK: query: explain cbo
 select empid, name from emps_parquet_n3 group by empid, name
 PREHOOK: type: QUERY
@@ -554,6 +573,8 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@emps_parquet_n3
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_parquet_n2
+POSTHOOK: Lineage: mv1_parquet_n2.name SIMPLE [(emps_parquet_n3)emps_parquet_n3.FieldSchema(name:name, type:varchar(256), comment:null), ]
+POSTHOOK: Lineage: mv1_parquet_n2.salary SIMPLE [(emps_parquet_n3)emps_parquet_n3.FieldSchema(name:salary, type:float, comment:null), ]
 PREHOOK: query: explain cbo
 select name, salary from emps_parquet_n3 group by name, salary
 PREHOOK: type: QUERY
@@ -605,6 +626,8 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@emps_parquet_n3
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_parquet_n2
+POSTHOOK: Lineage: mv1_parquet_n2.name SIMPLE [(emps_parquet_n3)emps_parquet_n3.FieldSchema(name:name, type:varchar(256), comment:null), ]
+POSTHOOK: Lineage: mv1_parquet_n2.salary SIMPLE [(emps_parquet_n3)emps_parquet_n3.FieldSchema(name:salary, type:float, comment:null), ]
 PREHOOK: query: explain cbo
 select name from emps_parquet_n3 group by name
 PREHOOK: type: QUERY
@@ -657,6 +680,8 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@emps_parquet_n3
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_parquet_n2
+POSTHOOK: Lineage: mv1_parquet_n2.name SIMPLE [(emps_parquet_n3)emps_parquet_n3.FieldSchema(name:name, type:varchar(256), comment:null), ]
+POSTHOOK: Lineage: mv1_parquet_n2.salary SIMPLE [(emps_parquet_n3)emps_parquet_n3.FieldSchema(name:salary, type:float, comment:null), ]
 PREHOOK: query: explain cbo
 select name from emps_parquet_n3 where deptno = 10 group by name
 PREHOOK: type: QUERY
@@ -710,6 +735,10 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@emps_parquet_n3
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_parquet_n2
+POSTHOOK: Lineage: mv1_parquet_n2.c EXPRESSION [(emps_parquet_n3)emps_parquet_n3.null, ]
+POSTHOOK: Lineage: mv1_parquet_n2.name SIMPLE [(emps_parquet_n3)emps_parquet_n3.FieldSchema(name:name, type:varchar(256), comment:null), ]
+POSTHOOK: Lineage: mv1_parquet_n2.s EXPRESSION [(emps_parquet_n3)emps_parquet_n3.FieldSchema(name:empid, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_parquet_n2.salary SIMPLE [(emps_parquet_n3)emps_parquet_n3.FieldSchema(name:salary, type:float, comment:null), ]
 PREHOOK: query: explain cbo
 select name from emps_parquet_n3 group by name
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_rebuild.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_rebuild.q.out
index b8c6bf4ab8..1d102bcf03 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_rebuild.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_rebuild.q.out
@@ -37,6 +37,9 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@basetable_rebuild
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv_rebuild
+POSTHOOK: Lineage: mv_rebuild._c2 EXPRESSION [(basetable_rebuild)basetable_rebuild.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: mv_rebuild.a SIMPLE [(basetable_rebuild)basetable_rebuild.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: mv_rebuild.b SIMPLE [(basetable_rebuild)basetable_rebuild.FieldSchema(name:b, type:varchar(256), comment:null), ]
 PREHOOK: query: select * from mv_rebuild
 PREHOOK: type: QUERY
 PREHOOK: Input: default@mv_rebuild
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_rebuild_2.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_rebuild_2.q.out
index 203c5d6a99..8eb693a82e 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_rebuild_2.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_rebuild_2.q.out
@@ -27,6 +27,7 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@t1
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mat1
+POSTHOOK: Lineage: mat1.col0 SIMPLE []
 Materialized view default.mat1 is up to date. Skipping rebuild.
 PREHOOK: query: explain
 alter materialized view mat1 rebuild
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_rebuild_3.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_rebuild_3.q.out
index 4de566ccf0..2ef598e2d9 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_rebuild_3.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_rebuild_3.q.out
@@ -34,6 +34,8 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@t1
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mat1
+POSTHOOK: Lineage: mat1._c1 EXPRESSION [(t1)t1.FieldSchema(name:col1, type:int, comment:null), ]
+POSTHOOK: Lineage: mat1.col0 SIMPLE [(t1)t1.FieldSchema(name:col0, type:int, comment:null), ]
 Materialized view default.mat1 is up to date. Skipping rebuild.
 PREHOOK: query: explain
 alter materialized view mat1 rebuild
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_1.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_1.q.out
index 3c40255530..3b4bf641ae 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_1.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_1.q.out
@@ -144,6 +144,11 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@emps_n3
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_n2
+POSTHOOK: Lineage: mv1_n2.commission SIMPLE [(emps_n3)emps_n3.FieldSchema(name:commission, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n2.deptno SIMPLE [(emps_n3)emps_n3.FieldSchema(name:deptno, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n2.empid SIMPLE [(emps_n3)emps_n3.FieldSchema(name:empid, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n2.name SIMPLE [(emps_n3)emps_n3.FieldSchema(name:name, type:varchar(256), comment:null), ]
+POSTHOOK: Lineage: mv1_n2.salary SIMPLE [(emps_n3)emps_n3.FieldSchema(name:salary, type:float, comment:null), ]
 PREHOOK: query: explain
 select *
 from (select * from emps_n3 where empid < 120) t
@@ -283,6 +288,10 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@emps_n3
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_n2
+POSTHOOK: Lineage: mv1_n2.commission SIMPLE [(emps_n3)emps_n3.FieldSchema(name:commission, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n2.deptno SIMPLE [(emps_n3)emps_n3.FieldSchema(name:deptno, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n2.name SIMPLE [(emps_n3)emps_n3.FieldSchema(name:name, type:varchar(256), comment:null), ]
+POSTHOOK: Lineage: mv1_n2.salary SIMPLE [(emps_n3)emps_n3.FieldSchema(name:salary, type:float, comment:null), ]
 PREHOOK: query: explain
 select emps_n3.name, emps_n3.salary, emps_n3.commission
 from emps_n3
@@ -364,6 +373,7 @@ POSTHOOK: Input: default@depts_n2
 POSTHOOK: Input: default@emps_n3
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_n2
+POSTHOOK: Lineage: mv1_n2.deptno SIMPLE [(emps_n3)emps_n3.FieldSchema(name:empid, type:int, comment:null), ]
 PREHOOK: query: explain
 select empid deptno from emps_n3
 join depts_n2 using (deptno) where empid = 1
@@ -432,6 +442,11 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@emps_n3
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_n2
+POSTHOOK: Lineage: mv1_n2.commission SIMPLE [(emps_n3)emps_n3.FieldSchema(name:commission, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n2.deptno SIMPLE [(emps_n3)emps_n3.FieldSchema(name:deptno, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n2.empid SIMPLE [(emps_n3)emps_n3.FieldSchema(name:empid, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n2.name SIMPLE [(emps_n3)emps_n3.FieldSchema(name:name, type:varchar(256), comment:null), ]
+POSTHOOK: Lineage: mv1_n2.salary SIMPLE [(emps_n3)emps_n3.FieldSchema(name:salary, type:float, comment:null), ]
 PREHOOK: query: explain
 select * from emps_n3 where empid > 120
 union all select * from emps_n3 where empid < 150
@@ -549,6 +564,8 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@emps_n3
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_n2
+POSTHOOK: Lineage: mv1_n2.deptno SIMPLE [(emps_n3)emps_n3.FieldSchema(name:deptno, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n2.empid SIMPLE [(emps_n3)emps_n3.FieldSchema(name:empid, type:int, comment:null), ]
 PREHOOK: query: explain cbo
 select empid, deptno from emps_n3 group by empid, deptno
 PREHOOK: type: QUERY
@@ -621,6 +638,8 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@emps_n3
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_n2
+POSTHOOK: Lineage: mv1_n2.empid SIMPLE [(emps_n3)emps_n3.FieldSchema(name:empid, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n2.name SIMPLE [(emps_n3)emps_n3.FieldSchema(name:name, type:varchar(256), comment:null), ]
 PREHOOK: query: explain
 select empid, name from emps_n3 group by empid, name
 PREHOOK: type: QUERY
@@ -679,6 +698,8 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@emps_n3
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_n2
+POSTHOOK: Lineage: mv1_n2.name SIMPLE [(emps_n3)emps_n3.FieldSchema(name:name, type:varchar(256), comment:null), ]
+POSTHOOK: Lineage: mv1_n2.salary SIMPLE [(emps_n3)emps_n3.FieldSchema(name:salary, type:float, comment:null), ]
 PREHOOK: query: explain
 select name, salary from emps_n3 group by name, salary
 PREHOOK: type: QUERY
@@ -740,6 +761,8 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@emps_n3
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_n2
+POSTHOOK: Lineage: mv1_n2.name SIMPLE [(emps_n3)emps_n3.FieldSchema(name:name, type:varchar(256), comment:null), ]
+POSTHOOK: Lineage: mv1_n2.salary SIMPLE [(emps_n3)emps_n3.FieldSchema(name:salary, type:float, comment:null), ]
 PREHOOK: query: explain
 select name from emps_n3 group by name
 PREHOOK: type: QUERY
@@ -843,6 +866,8 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@emps_n3
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_n2
+POSTHOOK: Lineage: mv1_n2.name SIMPLE [(emps_n3)emps_n3.FieldSchema(name:name, type:varchar(256), comment:null), ]
+POSTHOOK: Lineage: mv1_n2.salary SIMPLE [(emps_n3)emps_n3.FieldSchema(name:salary, type:float, comment:null), ]
 PREHOOK: query: explain
 select name from emps_n3 where deptno = 10 group by name
 PREHOOK: type: QUERY
@@ -947,6 +972,10 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@emps_n3
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_n2
+POSTHOOK: Lineage: mv1_n2.c EXPRESSION [(emps_n3)emps_n3.null, ]
+POSTHOOK: Lineage: mv1_n2.name SIMPLE [(emps_n3)emps_n3.FieldSchema(name:name, type:varchar(256), comment:null), ]
+POSTHOOK: Lineage: mv1_n2.s EXPRESSION [(emps_n3)emps_n3.FieldSchema(name:empid, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n2.salary SIMPLE [(emps_n3)emps_n3.FieldSchema(name:salary, type:float, comment:null), ]
 PREHOOK: query: explain
 select name from emps_n3 group by name
 PREHOOK: type: QUERY
@@ -1054,6 +1083,9 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@depts_n2
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_n2
+POSTHOOK: Lineage: mv1_n2.c EXPRESSION [(depts_n2)depts_n2.null, ]
+POSTHOOK: Lineage: mv1_n2.deptno SIMPLE [(depts_n2)depts_n2.FieldSchema(name:deptno, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n2.name SIMPLE [(depts_n2)depts_n2.FieldSchema(name:name, type:varchar(256), comment:null), ]
 PREHOOK: query: explain
 select name, count(*) as c
 from depts_n2
@@ -1181,6 +1213,10 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@depts_n2
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_n2
+POSTHOOK: Lineage: mv1_n2.c EXPRESSION [(depts_n2)depts_n2.null, ]
+POSTHOOK: Lineage: mv1_n2.deptno SIMPLE [(depts_n2)depts_n2.FieldSchema(name:deptno, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n2.locationid SIMPLE [(depts_n2)depts_n2.FieldSchema(name:locationid, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n2.name SIMPLE [(depts_n2)depts_n2.FieldSchema(name:name, type:varchar(256), comment:null), ]
 PREHOOK: query: explain
 select deptno, name, count(*) as c
 from depts_n2
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_10.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_10.q.out
index b63aac8f86..7130074ba2 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_10.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_10.q.out
@@ -47,6 +47,9 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@emps_n10
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_n10
+POSTHOOK: Lineage: mv1_n10._c1 EXPRESSION [(emps_n10)emps_n10.FieldSchema(name:salary, type:float, comment:null), ]
+POSTHOOK: Lineage: mv1_n10.a EXPRESSION [(emps_n10)emps_n10.FieldSchema(name:salary, type:float, comment:null), ]
+POSTHOOK: Lineage: mv1_n10.deptno SIMPLE [(emps_n10)emps_n10.FieldSchema(name:deptno, type:int, comment:null), ]
 PREHOOK: query: explain
 select deptno, avg(salary) as a
 from emps_n10 group by deptno
@@ -112,6 +115,9 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@emps_n10
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_n10
+POSTHOOK: Lineage: mv1_n10._c1 EXPRESSION [(emps_n10)emps_n10.FieldSchema(name:salary, type:float, comment:null), ]
+POSTHOOK: Lineage: mv1_n10.a EXPRESSION [(emps_n10)emps_n10.FieldSchema(name:salary, type:float, comment:null), ]
+POSTHOOK: Lineage: mv1_n10.salary SIMPLE [(emps_n10)emps_n10.FieldSchema(name:salary, type:float, comment:null), ]
 PREHOOK: query: explain
 select salary, avg(salary) as a
 from emps_n10 group by salary
@@ -178,6 +184,9 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@emps_n10
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_n10
+POSTHOOK: Lineage: mv1_n10._c1 EXPRESSION [(emps_n10)emps_n10.FieldSchema(name:salary, type:float, comment:null), ]
+POSTHOOK: Lineage: mv1_n10.a EXPRESSION [(emps_n10)emps_n10.FieldSchema(name:salary, type:float, comment:null), ]
+POSTHOOK: Lineage: mv1_n10.salary SIMPLE [(emps_n10)emps_n10.FieldSchema(name:salary, type:float, comment:null), ]
 PREHOOK: query: explain
 select salary, avg(salary) as a
 from emps_n10 where salary > 0 group by salary
@@ -279,6 +288,9 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@emps_n10_2
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_n10
+POSTHOOK: Lineage: mv1_n10._c1 EXPRESSION [(emps_n10_2)emps_n10_2.FieldSchema(name:salary, type:tinyint, comment:null), ]
+POSTHOOK: Lineage: mv1_n10.a EXPRESSION [(emps_n10_2)emps_n10_2.FieldSchema(name:salary, type:tinyint, comment:null), ]
+POSTHOOK: Lineage: mv1_n10.salary SIMPLE [(emps_n10_2)emps_n10_2.FieldSchema(name:salary, type:tinyint, comment:null), ]
 PREHOOK: query: explain
 select avg(salary)
 from emps_n10_2 where salary > 0
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_11.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_11.q.out
index 155a909937..b64b90f9cc 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_11.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_11.q.out
@@ -25,6 +25,7 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@t1
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mat1
+POSTHOOK: Lineage: mat1.col0 EXPRESSION []
 PREHOOK: query: explain cbo
 select * from t1 where col0 = 1
 union
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_2.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_2.q.out
index 64cabadacd..4d1e85d9ce 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_2.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_2.q.out
@@ -150,6 +150,8 @@ POSTHOOK: Input: default@depts_n0
 POSTHOOK: Input: default@emps_n0
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_n0
+POSTHOOK: Lineage: mv1_n0.deptno SIMPLE [(depts_n0)depts_n0.FieldSchema(name:deptno, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n0.empid SIMPLE [(emps_n0)emps_n0.FieldSchema(name:empid, type:int, comment:null), ]
 PREHOOK: query: explain
 select empid from emps_n0
 join depts_n0 using (deptno) where depts_n0.deptno > 20
@@ -228,6 +230,8 @@ POSTHOOK: Input: default@depts_n0
 POSTHOOK: Input: default@emps_n0
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_n0
+POSTHOOK: Lineage: mv1_n0.deptno SIMPLE [(depts_n0)depts_n0.FieldSchema(name:deptno, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n0.empid SIMPLE [(emps_n0)emps_n0.FieldSchema(name:empid, type:int, comment:null), ]
 PREHOOK: query: explain
 select empid from emps_n0
 join depts_n0 using (deptno) where depts_n0.deptno > 20
@@ -306,6 +310,8 @@ POSTHOOK: Input: default@depts_n0
 POSTHOOK: Input: default@emps_n0
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_n0
+POSTHOOK: Lineage: mv1_n0.deptno SIMPLE [(depts_n0)depts_n0.FieldSchema(name:deptno, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n0.empid SIMPLE [(emps_n0)emps_n0.FieldSchema(name:empid, type:int, comment:null), ]
 PREHOOK: query: explain
 select empid from emps_n0
 join depts_n0 using (deptno) where depts_n0.deptno > 20
@@ -384,6 +390,8 @@ POSTHOOK: Input: default@depts_n0
 POSTHOOK: Input: default@emps_n0
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_n0
+POSTHOOK: Lineage: mv1_n0.deptno SIMPLE [(emps_n0)emps_n0.FieldSchema(name:deptno, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n0.empid SIMPLE [(emps_n0)emps_n0.FieldSchema(name:empid, type:int, comment:null), ]
 PREHOOK: query: explain
 select depts_n0.deptno from depts_n0
 join emps_n0 using (deptno) where emps_n0.empid > 15
@@ -467,6 +475,8 @@ POSTHOOK: Input: default@depts_n0
 POSTHOOK: Input: default@emps_n0
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_n0
+POSTHOOK: Lineage: mv1_n0.deptno SIMPLE [(emps_n0)emps_n0.FieldSchema(name:deptno, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n0.empid SIMPLE [(emps_n0)emps_n0.FieldSchema(name:empid, type:int, comment:null), ]
 PREHOOK: query: explain
 select depts_n0.deptno from depts_n0
 join emps_n0 using (deptno) where emps_n0.empid > 15
@@ -616,6 +626,11 @@ POSTHOOK: Input: default@depts_n0
 POSTHOOK: Input: default@emps_n0
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_n0
+POSTHOOK: Lineage: mv1_n0.deptno SIMPLE [(emps_n0)emps_n0.FieldSchema(name:deptno, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n0.deptno2 SIMPLE [(depts_n0)depts_n0.FieldSchema(name:deptno, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n0.empid SIMPLE [(dependents_n0)dependents_n0.FieldSchema(name:empid, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n0.name SIMPLE [(depts_n0)depts_n0.FieldSchema(name:name, type:varchar(256), comment:null), ]
+POSTHOOK: Lineage: mv1_n0.name2 SIMPLE [(dependents_n0)dependents_n0.FieldSchema(name:name, type:varchar(256), comment:null), ]
 PREHOOK: query: explain
 select dependents_n0.empid
 from depts_n0
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_3.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_3.q.out
index 1e0d2d23ab..b77f6922f7 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_3.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_3.q.out
@@ -148,6 +148,7 @@ POSTHOOK: Input: default@depts_n7
 POSTHOOK: Input: default@emps_n9
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_n5
+POSTHOOK: Lineage: mv1_n5.deptno SIMPLE [(emps_n9)emps_n9.FieldSchema(name:empid, type:int, comment:null), ]
 PREHOOK: query: explain
 select empid deptno from emps_n9
 join depts_n7 using (deptno) where empid = 1
@@ -220,6 +221,7 @@ POSTHOOK: Input: default@depts_n7
 POSTHOOK: Input: default@emps_n9
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_n5
+POSTHOOK: Lineage: mv1_n5.empid EXPRESSION [(emps_n9)emps_n9.FieldSchema(name:empid, type:int, comment:null), ]
 PREHOOK: query: explain
 select empid deptno from emps_n9
 join depts_n7 using (deptno) where empid > 1
@@ -296,6 +298,7 @@ POSTHOOK: Input: default@depts_n7
 POSTHOOK: Input: default@emps_n9
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_n5
+POSTHOOK: Lineage: mv1_n5.empid EXPRESSION [(emps_n9)emps_n9.FieldSchema(name:empid, type:int, comment:null), ]
 PREHOOK: query: explain
 select empid deptno from emps_n9
 join depts_n7 using (deptno) where empid = 1
@@ -370,6 +373,7 @@ POSTHOOK: Input: default@depts_n7
 POSTHOOK: Input: default@emps_n9
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_n5
+POSTHOOK: Lineage: mv1_n5.name SIMPLE [(depts_n7)depts_n7.FieldSchema(name:name, type:varchar(256), comment:null), ]
 PREHOOK: query: explain
 select dependents_n5.empid
 from depts_n7
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_4.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_4.q.out
index 2ee6edbc81..5294f265f7 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_4.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_4.q.out
@@ -146,6 +146,10 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@emps_n5
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_n3
+POSTHOOK: Lineage: mv1_n3.c EXPRESSION [(emps_n5)emps_n5.null, ]
+POSTHOOK: Lineage: mv1_n3.name SIMPLE [(emps_n5)emps_n5.FieldSchema(name:name, type:varchar(256), comment:null), ]
+POSTHOOK: Lineage: mv1_n3.s EXPRESSION [(emps_n5)emps_n5.FieldSchema(name:empid, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n3.salary SIMPLE [(emps_n5)emps_n5.FieldSchema(name:salary, type:float, comment:null), ]
 PREHOOK: query: explain
 select name, count(*) as c, sum(empid) as s
 from emps_n5 group by name
@@ -262,6 +266,10 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@emps_n5
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_n3
+POSTHOOK: Lineage: mv1_n3.c EXPRESSION [(emps_n5)emps_n5.null, ]
+POSTHOOK: Lineage: mv1_n3.name SIMPLE [(emps_n5)emps_n5.FieldSchema(name:name, type:varchar(256), comment:null), ]
+POSTHOOK: Lineage: mv1_n3.s EXPRESSION [(emps_n5)emps_n5.FieldSchema(name:empid, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n3.salary SIMPLE [(emps_n5)emps_n5.FieldSchema(name:salary, type:float, comment:null), ]
 PREHOOK: query: explain
 select salary, name, sum(empid) as s, count(*) as c
 from emps_n5 group by name, salary
@@ -333,6 +341,10 @@ POSTHOOK: Input: default@depts_n4
 POSTHOOK: Input: default@emps_n5
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_n3
+POSTHOOK: Lineage: mv1_n3.c EXPRESSION [(emps_n5)emps_n5.null, ]
+POSTHOOK: Lineage: mv1_n3.deptno SIMPLE [(emps_n5)emps_n5.FieldSchema(name:deptno, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n3.empid SIMPLE [(emps_n5)emps_n5.FieldSchema(name:empid, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n3.s EXPRESSION [(emps_n5)emps_n5.FieldSchema(name:empid, type:int, comment:null), ]
 PREHOOK: query: explain
 select depts_n4.deptno, count(*) as c, sum(empid) as s
 from emps_n5 join depts_n4 using (deptno)
@@ -459,6 +471,10 @@ POSTHOOK: Input: default@depts_n4
 POSTHOOK: Input: default@emps_n5
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_n3
+POSTHOOK: Lineage: mv1_n3.c EXPRESSION [(emps_n5)emps_n5.null, (depts_n4)depts_n4.null, ]
+POSTHOOK: Lineage: mv1_n3.deptno SIMPLE [(emps_n5)emps_n5.FieldSchema(name:deptno, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n3.empid SIMPLE [(emps_n5)emps_n5.FieldSchema(name:empid, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n3.s EXPRESSION [(emps_n5)emps_n5.FieldSchema(name:empid, type:int, comment:null), ]
 PREHOOK: query: explain
 select depts_n4.deptno, sum(empid) as s
 from emps_n5 join depts_n4 using (deptno)
@@ -580,6 +596,10 @@ POSTHOOK: Input: default@depts_n4
 POSTHOOK: Input: default@emps_n5
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_n3
+POSTHOOK: Lineage: mv1_n3.c EXPRESSION [(emps_n5)emps_n5.null, (depts_n4)depts_n4.null, ]
+POSTHOOK: Lineage: mv1_n3.deptno SIMPLE [(depts_n4)depts_n4.FieldSchema(name:deptno, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n3.empid SIMPLE [(emps_n5)emps_n5.FieldSchema(name:empid, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n3.s EXPRESSION [(emps_n5)emps_n5.FieldSchema(name:empid, type:int, comment:null), ]
 PREHOOK: query: explain
 select depts_n4.deptno, sum(empid) + 1 as s
 from emps_n5 join depts_n4 using (deptno)
@@ -711,6 +731,8 @@ POSTHOOK: Input: default@depts_n4
 POSTHOOK: Input: default@emps_n5
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_n3
+POSTHOOK: Lineage: mv1_n3.name SIMPLE [(depts_n4)depts_n4.FieldSchema(name:name, type:varchar(256), comment:null), ]
+POSTHOOK: Lineage: mv1_n3.s EXPRESSION [(emps_n5)emps_n5.FieldSchema(name:salary, type:float, comment:null), ]
 PREHOOK: query: explain
 select dependents_n3.empid, sum(salary) as s
 from emps_n5
@@ -890,6 +912,9 @@ POSTHOOK: Input: default@dependents_n3
 POSTHOOK: Input: default@emps_n5
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_n3
+POSTHOOK: Lineage: mv1_n3.deptno SIMPLE [(emps_n5)emps_n5.FieldSchema(name:deptno, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n3.empid SIMPLE [(dependents_n3)dependents_n3.FieldSchema(name:empid, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n3.s EXPRESSION [(emps_n5)emps_n5.FieldSchema(name:salary, type:float, comment:null), ]
 PREHOOK: query: explain
 select emps_n5.deptno, count(distinct salary) as s
 from emps_n5
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_5.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_5.q.out
index beb7697351..2e8e80f04b 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_5.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_5.q.out
@@ -160,6 +160,9 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@emps_n2
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_n1
+POSTHOOK: Lineage: mv1_n1.deptno SIMPLE [(emps_n2)emps_n2.FieldSchema(name:deptno, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n1.name SIMPLE [(emps_n2)emps_n2.FieldSchema(name:name, type:varchar(256), comment:null), ]
+POSTHOOK: Lineage: mv1_n1.salary SIMPLE [(emps_n2)emps_n2.FieldSchema(name:salary, type:float, comment:null), ]
 PREHOOK: query: explain
 select name from emps_n2 where deptno >= 20 group by name
 PREHOOK: type: QUERY
@@ -266,6 +269,11 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@emps_n2
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_n1
+POSTHOOK: Lineage: mv1_n1.c EXPRESSION [(emps_n2)emps_n2.null, ]
+POSTHOOK: Lineage: mv1_n1.deptno SIMPLE [(emps_n2)emps_n2.FieldSchema(name:deptno, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n1.name SIMPLE [(emps_n2)emps_n2.FieldSchema(name:name, type:varchar(256), comment:null), ]
+POSTHOOK: Lineage: mv1_n1.s EXPRESSION [(emps_n2)emps_n2.FieldSchema(name:empid, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n1.salary SIMPLE [(emps_n2)emps_n2.FieldSchema(name:salary, type:float, comment:null), ]
 PREHOOK: query: explain
 select name, sum(empid) as s
 from emps_n2 where deptno > 15 group by name
@@ -395,6 +403,8 @@ POSTHOOK: Input: default@emps_n2
 POSTHOOK: Input: default@locations_n1
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_n1
+POSTHOOK: Lineage: mv1_n1.deptno SIMPLE [(depts_n1)depts_n1.FieldSchema(name:deptno, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n1.empid SIMPLE [(dependents_n1)dependents_n1.FieldSchema(name:empid, type:int, comment:null), ]
 PREHOOK: query: explain
 select dependents_n1.empid
 from depts_n1
@@ -540,6 +550,10 @@ POSTHOOK: Input: default@depts_n1
 POSTHOOK: Input: default@emps_n2
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_n1
+POSTHOOK: Lineage: mv1_n1.c EXPRESSION [(emps_n2)emps_n2.null, ]
+POSTHOOK: Lineage: mv1_n1.deptno SIMPLE [(emps_n2)emps_n2.FieldSchema(name:deptno, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n1.empid SIMPLE [(emps_n2)emps_n2.FieldSchema(name:empid, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n1.s EXPRESSION [(emps_n2)emps_n2.FieldSchema(name:empid, type:int, comment:null), ]
 PREHOOK: query: explain
 select deptno from emps_n2 group by deptno
 PREHOOK: type: QUERY
@@ -647,6 +661,10 @@ POSTHOOK: Input: default@depts_n1
 POSTHOOK: Input: default@emps_n2
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_n1
+POSTHOOK: Lineage: mv1_n1.c EXPRESSION [(emps_n2)emps_n2.null, ]
+POSTHOOK: Lineage: mv1_n1.deptno SIMPLE [(emps_n2)emps_n2.FieldSchema(name:deptno, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n1.empid SIMPLE [(emps_n2)emps_n2.FieldSchema(name:empid, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n1.s EXPRESSION [(emps_n2)emps_n2.FieldSchema(name:empid, type:int, comment:null), ]
 PREHOOK: query: explain
 select deptno, empid, sum(empid) as s, count(*) as c
 from emps_n2 group by empid, deptno
@@ -721,6 +739,9 @@ POSTHOOK: Input: default@dependents_n1
 POSTHOOK: Input: default@emps_n2
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_n1
+POSTHOOK: Lineage: mv1_n1.deptno SIMPLE [(emps_n2)emps_n2.FieldSchema(name:deptno, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n1.empid SIMPLE [(dependents_n1)dependents_n1.FieldSchema(name:empid, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n1.s EXPRESSION [(emps_n2)emps_n2.FieldSchema(name:salary, type:float, comment:null), ]
 PREHOOK: query: explain
 select dependents_n1.empid, sum(salary) as s
 from emps_n2
@@ -855,6 +876,9 @@ POSTHOOK: Input: default@dependents_n1
 POSTHOOK: Input: default@emps_n2
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_n1
+POSTHOOK: Lineage: mv1_n1.deptno SIMPLE [(emps_n2)emps_n2.FieldSchema(name:deptno, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n1.empid SIMPLE [(dependents_n1)dependents_n1.FieldSchema(name:empid, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n1.s EXPRESSION [(emps_n2)emps_n2.FieldSchema(name:salary, type:float, comment:null), ]
 PREHOOK: query: explain
 select depts_n1.name, sum(salary) as s
 from emps_n2
@@ -1029,6 +1053,7 @@ POSTHOOK: Input: default@depts_n1
 POSTHOOK: Input: default@emps_n2
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_n1
+POSTHOOK: Lineage: mv1_n1.deptno SIMPLE []
 PREHOOK: query: explain
 select a.empid from 
 (select * from emps_n2 where empid = 1) a
@@ -1109,6 +1134,8 @@ POSTHOOK: Input: default@depts_n1
 POSTHOOK: Input: default@emps_n2
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_n1
+POSTHOOK: Lineage: mv1_n1.deptno SIMPLE [(emps_n2)emps_n2.FieldSchema(name:deptno, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n1.empid SIMPLE []
 PREHOOK: query: explain
 select a.empid from 
 (select * from emps_n2 where empid = 1) a
@@ -1184,6 +1211,7 @@ POSTHOOK: Input: default@depts_n1
 POSTHOOK: Input: default@emps_n2
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_n1
+POSTHOOK: Lineage: mv1_n1.deptno SIMPLE []
 PREHOOK: query: explain
 select empid from emps_n2 where empid = 1
 PREHOOK: type: QUERY
@@ -1252,6 +1280,8 @@ POSTHOOK: Input: default@depts_n1
 POSTHOOK: Input: default@emps_n2
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_n1
+POSTHOOK: Lineage: mv1_n1.deptno SIMPLE [(emps_n2)emps_n2.FieldSchema(name:deptno, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n1.empid SIMPLE []
 PREHOOK: query: explain
 select emps_n2.empid from emps_n2
 join dependents_n1 on (emps_n2.empid = dependents_n1.empid)
@@ -1334,6 +1364,8 @@ POSTHOOK: Input: default@depts_n1
 POSTHOOK: Input: default@emps_n2
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_n1
+POSTHOOK: Lineage: mv1_n1.deptno SIMPLE [(emps_n2)emps_n2.FieldSchema(name:deptno, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n1.empid SIMPLE []
 PREHOOK: query: explain
 select emps_n2.empid from emps_n2
 join dependents_n1 on (emps_n2.empid = dependents_n1.empid)
@@ -1415,6 +1447,8 @@ POSTHOOK: Input: default@depts_n1
 POSTHOOK: Input: default@emps_n2
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_n1
+POSTHOOK: Lineage: mv1_n1.deptno SIMPLE [(emps_n2)emps_n2.FieldSchema(name:deptno, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n1.empid SIMPLE [(emps_n2)emps_n2.FieldSchema(name:empid, type:int, comment:null), ]
 PREHOOK: query: explain
 select emps_n2.empid from emps_n2
 join dependents_n1 on (emps_n2.empid = dependents_n1.empid)
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_6.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_6.q.out
index 00a7838f34..b43f1d62e1 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_6.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_6.q.out
@@ -162,6 +162,11 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@emps
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
+POSTHOOK: Lineage: mv1.c EXPRESSION [(emps)emps.null, ]
+POSTHOOK: Lineage: mv1.deptno SIMPLE [(emps)emps.FieldSchema(name:deptno, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1.name SIMPLE [(emps)emps.FieldSchema(name:name, type:varchar(256), comment:null), ]
+POSTHOOK: Lineage: mv1.s EXPRESSION [(emps)emps.FieldSchema(name:empid, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1.salary SIMPLE [(emps)emps.FieldSchema(name:salary, type:float, comment:null), ]
 PREHOOK: query: explain
 select salary, sum(empid) + 1 as s
 from emps where deptno > 10 group by salary
@@ -279,6 +284,11 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@emps
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
+POSTHOOK: Lineage: mv1.c EXPRESSION [(emps)emps.null, ]
+POSTHOOK: Lineage: mv1.deptno SIMPLE [(emps)emps.FieldSchema(name:deptno, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1.name SIMPLE [(emps)emps.FieldSchema(name:name, type:varchar(256), comment:null), ]
+POSTHOOK: Lineage: mv1.s EXPRESSION [(emps)emps.FieldSchema(name:empid, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1.salary SIMPLE [(emps)emps.FieldSchema(name:salary, type:float, comment:null), ]
 PREHOOK: query: explain
 select salary + 1, sum(empid) + 1 as s
 from emps where deptno > 15 group by salary
@@ -400,6 +410,7 @@ POSTHOOK: Input: default@depts
 POSTHOOK: Input: default@emps
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
+POSTHOOK: Lineage: mv1.name SIMPLE [(depts)depts.FieldSchema(name:name, type:varchar(256), comment:null), ]
 PREHOOK: query: explain
 select dependents.empid
 from emps
@@ -552,6 +563,7 @@ POSTHOOK: Input: default@depts
 POSTHOOK: Input: default@emps
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
+POSTHOOK: Lineage: mv1.name SIMPLE [(depts)depts.FieldSchema(name:name, type:varchar(256), comment:null), ]
 PREHOOK: query: explain
 select dependents.empid
 from depts
@@ -749,6 +761,12 @@ POSTHOOK: Input: default@dependents
 POSTHOOK: Input: default@emps
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1
+POSTHOOK: Lineage: mv1.commission SIMPLE [(emps)emps.FieldSchema(name:commission, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1.deptno SIMPLE [(emps)emps.FieldSchema(name:deptno, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1.empid SIMPLE [(emps)emps.FieldSchema(name:empid, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1.name1 SIMPLE [(emps)emps.FieldSchema(name:name, type:varchar(256), comment:null), ]
+POSTHOOK: Lineage: mv1.name2 SIMPLE [(dependents)dependents.FieldSchema(name:name, type:varchar(256), comment:null), ]
+POSTHOOK: Lineage: mv1.salary SIMPLE [(emps)emps.FieldSchema(name:salary, type:float, comment:null), ]
 PREHOOK: query: explain
 select emps.empid, dependents.empid, emps.deptno
 from emps
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_7.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_7.q.out
index ac4a0a0973..2d4b26ead2 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_7.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_7.q.out
@@ -178,6 +178,8 @@ POSTHOOK: Input: default@emps_n8
 POSTHOOK: Input: default@locations_n4
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_n4
+POSTHOOK: Lineage: mv1_n4.deptno SIMPLE [(depts_n6)depts_n6.FieldSchema(name:deptno, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n4.empid SIMPLE [(dependents_n4)dependents_n4.FieldSchema(name:empid, type:int, comment:null), ]
 PREHOOK: query: explain
 select dependents_n4.empid, depts_n6.deptno
 from depts_n6
@@ -503,6 +505,9 @@ POSTHOOK: Input: default@emps_n8
 POSTHOOK: Input: default@locations_n4
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_n4
+POSTHOOK: Lineage: mv1_n4.deptno SIMPLE [(depts_n6)depts_n6.FieldSchema(name:deptno, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n4.empid SIMPLE [(dependents_n4)dependents_n4.FieldSchema(name:empid, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n4.s EXPRESSION [(emps_n8)emps_n8.FieldSchema(name:salary, type:float, comment:null), ]
 PREHOOK: query: explain
 select dependents_n4.empid, count(emps_n8.salary) + 1
 from depts_n6
@@ -862,6 +867,8 @@ POSTHOOK: Input: default@depts_n6
 POSTHOOK: Input: default@emps_n8
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_n4
+POSTHOOK: Lineage: mv1_n4.deptno SIMPLE [(depts_n6)depts_n6.FieldSchema(name:deptno, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n4.empid SIMPLE [(dependents_n4)dependents_n4.FieldSchema(name:empid, type:int, comment:null), ]
 PREHOOK: query: explain
 select dependents_n4.empid
 from depts_n6
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_8.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_8.q.out
index f3c6464ed1..27d3aa2e64 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_8.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_8.q.out
@@ -62,6 +62,11 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@source_table_001
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@source_table_001_mv
+POSTHOOK: Lineage: source_table_001_mv.down_volume_sum EXPRESSION [(source_table_001)a.FieldSchema(name:down_volume, type:bigint, comment:null), ]
+POSTHOOK: Lineage: source_table_001_mv.environment SIMPLE [(source_table_001)a.FieldSchema(name:environment, type:string, comment:null), ]
+POSTHOOK: Lineage: source_table_001_mv.my_date SIMPLE [(source_table_001)a.FieldSchema(name:my_date, type:date, comment:null), ]
+POSTHOOK: Lineage: source_table_001_mv.my_id2 SIMPLE [(source_table_001)a.FieldSchema(name:my_id2, type:bigint, comment:null), ]
+POSTHOOK: Lineage: source_table_001_mv.up_volume_sum EXPRESSION [(source_table_001)a.FieldSchema(name:up_volume, type:bigint, comment:null), ]
 PREHOOK: query: explain
 select
 SUM(A.DOWN_VOLUME) AS DOWNLOAD_VOLUME_BYTES,
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_9.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_9.q.out
index 42b9180cef..becfffca3e 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_9.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_9.q.out
@@ -62,6 +62,12 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@source_table_001_n0
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@source_table_001_mv_n0
+POSTHOOK: Lineage: source_table_001_mv_n0.down_volume_sum EXPRESSION [(source_table_001_n0)a.FieldSchema(name:down_volume, type:bigint, comment:null), ]
+POSTHOOK: Lineage: source_table_001_mv_n0.environment SIMPLE [(source_table_001_n0)a.FieldSchema(name:environment, type:string, comment:null), ]
+POSTHOOK: Lineage: source_table_001_mv_n0.my_date SIMPLE [(source_table_001_n0)a.FieldSchema(name:my_date, type:timestamp, comment:null), ]
+POSTHOOK: Lineage: source_table_001_mv_n0.my_id SIMPLE [(source_table_001_n0)a.FieldSchema(name:my_id, type:bigint, comment:null), ]
+POSTHOOK: Lineage: source_table_001_mv_n0.my_id2 SIMPLE [(source_table_001_n0)a.FieldSchema(name:my_id2, type:bigint, comment:null), ]
+POSTHOOK: Lineage: source_table_001_mv_n0.up_volume_sum EXPRESSION [(source_table_001_n0)a.FieldSchema(name:up_volume, type:bigint, comment:null), ]
 PREHOOK: query: explain
 select
 SUM(A.DOWN_VOLUME) AS DOWNLOAD_VOLUME_BYTES,
@@ -176,6 +182,12 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@source_table_001_n0
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@source_table_001_mv_n0
+POSTHOOK: Lineage: source_table_001_mv_n0._c3 EXPRESSION [(source_table_001_n0)a.FieldSchema(name:my_date, type:timestamp, comment:null), ]
+POSTHOOK: Lineage: source_table_001_mv_n0.down_volume_sum EXPRESSION [(source_table_001_n0)a.FieldSchema(name:down_volume, type:bigint, comment:null), ]
+POSTHOOK: Lineage: source_table_001_mv_n0.environment SIMPLE [(source_table_001_n0)a.FieldSchema(name:environment, type:string, comment:null), ]
+POSTHOOK: Lineage: source_table_001_mv_n0.my_id SIMPLE [(source_table_001_n0)a.FieldSchema(name:my_id, type:bigint, comment:null), ]
+POSTHOOK: Lineage: source_table_001_mv_n0.my_id2 SIMPLE [(source_table_001_n0)a.FieldSchema(name:my_id2, type:bigint, comment:null), ]
+POSTHOOK: Lineage: source_table_001_mv_n0.up_volume_sum EXPRESSION [(source_table_001_n0)a.FieldSchema(name:up_volume, type:bigint, comment:null), ]
 PREHOOK: query: explain
 select
 SUM(A.DOWN_VOLUME) AS DOWNLOAD_VOLUME_BYTES,
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_by_text.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_by_text.q.out
index 9ab767abab..8a919308a4 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_by_text.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_by_text.q.out
@@ -25,6 +25,7 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@t1
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mat1
+POSTHOOK: Lineage: mat1.col0 EXPRESSION []
 PREHOOK: query: explain cbo
 select * from t1 where col0 = 1
 union
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_by_text_2.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_by_text_2.q.out
index ed6c4a66aa..de0b25612f 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_by_text_2.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_by_text_2.q.out
@@ -18,6 +18,8 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@cmv_basetable_n0
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cmv_mat_view2
+POSTHOOK: Lineage: cmv_mat_view2.a SIMPLE []
+POSTHOOK: Lineage: cmv_mat_view2.c SIMPLE [(cmv_basetable_n0)cmv_basetable_n0.FieldSchema(name:c, type:decimal(10,2), comment:null), ]
 PREHOOK: query: explain cbo
 select a, c from cmv_basetable_n0 where a = 3
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_by_text_3.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_by_text_3.q.out
index 4096a0b1a6..10fd6f81b9 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_by_text_3.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_by_text_3.q.out
@@ -20,6 +20,7 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@t1
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mat1
+POSTHOOK: Lineage: mat1.col0 SIMPLE []
 PREHOOK: query: explain cbo
 SELECT * FROM t1 WHERE col0 = 'FOO'
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_by_text_4.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_by_text_4.q.out
index 92b599f629..469608969f 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_by_text_4.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_by_text_4.q.out
@@ -29,6 +29,7 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@t1
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mat1
+POSTHOOK: Lineage: mat1.col0 SIMPLE []
 PREHOOK: query: explain cbo
 SELECT * FROM t1 WHERE col0 = 'foo'
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_by_text_5.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_by_text_5.q.out
index e28bd902e3..88a17e5591 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_by_text_5.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_by_text_5.q.out
@@ -26,6 +26,7 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: db1@t1
 POSTHOOK: Output: database:db1
 POSTHOOK: Output: db1@mat1
+POSTHOOK: Lineage: mat1.col0 SIMPLE []
 PREHOOK: query: grant select on table db1.t1 to user user2
 PREHOOK: type: GRANT_PRIVILEGE
 PREHOOK: Output: db1@t1
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_empty.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_empty.q.out
index 61a93651b1..e7637f24b6 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_empty.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_empty.q.out
@@ -30,6 +30,11 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@emps_mv_rewrite_empty
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@emps_mv_rewrite_empty_mv1
+POSTHOOK: Lineage: emps_mv_rewrite_empty_mv1.commission SIMPLE [(emps_mv_rewrite_empty)emps_mv_rewrite_empty.FieldSchema(name:commission, type:int, comment:null), ]
+POSTHOOK: Lineage: emps_mv_rewrite_empty_mv1.deptno SIMPLE [(emps_mv_rewrite_empty)emps_mv_rewrite_empty.FieldSchema(name:deptno, type:int, comment:null), ]
+POSTHOOK: Lineage: emps_mv_rewrite_empty_mv1.empid SIMPLE [(emps_mv_rewrite_empty)emps_mv_rewrite_empty.FieldSchema(name:empid, type:int, comment:null), ]
+POSTHOOK: Lineage: emps_mv_rewrite_empty_mv1.name SIMPLE [(emps_mv_rewrite_empty)emps_mv_rewrite_empty.FieldSchema(name:name, type:varchar(256), comment:null), ]
+POSTHOOK: Lineage: emps_mv_rewrite_empty_mv1.salary SIMPLE [(emps_mv_rewrite_empty)emps_mv_rewrite_empty.FieldSchema(name:salary, type:float, comment:null), ]
 PREHOOK: query: explain
 select * from emps_mv_rewrite_empty where empid < 120
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_in_between.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_in_between.q.out
index de303da574..207f3eedcc 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_in_between.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_in_between.q.out
@@ -49,6 +49,13 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: expr2@sales
 POSTHOOK: Output: database:expr2
 POSTHOOK: Output: expr2@mv1
+POSTHOOK: Lineage: mv1.amt SIMPLE [(sales)sales.FieldSchema(name:amt, type:double, comment:null), ]
+POSTHOOK: Lineage: mv1.cust_id SIMPLE [(sales)sales.FieldSchema(name:cust_id, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1.descr SIMPLE [(sales)sales.FieldSchema(name:descr, type:string, comment:null), ]
+POSTHOOK: Lineage: mv1.prod_id SIMPLE [(sales)sales.FieldSchema(name:prod_id, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1.qty SIMPLE [(sales)sales.FieldSchema(name:qty, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1.sale_date SIMPLE [(sales)sales.FieldSchema(name:sale_date, type:timestamp, comment:null), ]
+POSTHOOK: Lineage: mv1.store_id SIMPLE [(sales)sales.FieldSchema(name:store_id, type:int, comment:null), ]
 PREHOOK: query: explain cbo
 select prod_id, cust_id  from sales where cust_id in (1,2,3,4,5)
 PREHOOK: type: QUERY
@@ -134,6 +141,9 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: in_pred@census_pop
 POSTHOOK: Output: database:in_pred
 POSTHOOK: Output: in_pred@mv2
+POSTHOOK: Lineage: mv2._c2 EXPRESSION [(census_pop)census_pop.FieldSchema(name:population, type:bigint, comment:null), ]
+POSTHOOK: Lineage: mv2.state SIMPLE [(census_pop)census_pop.FieldSchema(name:state, type:string, comment:null), ]
+POSTHOOK: Lineage: mv2.year SIMPLE [(census_pop)census_pop.FieldSchema(name:year, type:int, comment:null), ]
 PREHOOK: query: explain cbo
 select state, year, sum(population) from census_pop where year IN (2010, 2018) group by state, year
 PREHOOK: type: QUERY
@@ -244,6 +254,13 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: expr9@sales
 POSTHOOK: Output: database:expr9
 POSTHOOK: Output: expr9@mv3
+POSTHOOK: Lineage: mv3.amt SIMPLE [(sales)sales.FieldSchema(name:amt, type:double, comment:null), ]
+POSTHOOK: Lineage: mv3.cust_id SIMPLE [(sales)sales.FieldSchema(name:cust_id, type:int, comment:null), ]
+POSTHOOK: Lineage: mv3.descr SIMPLE [(sales)sales.FieldSchema(name:descr, type:string, comment:null), ]
+POSTHOOK: Lineage: mv3.prod_id SIMPLE [(sales)sales.FieldSchema(name:prod_id, type:int, comment:null), ]
+POSTHOOK: Lineage: mv3.qty SIMPLE [(sales)sales.FieldSchema(name:qty, type:int, comment:null), ]
+POSTHOOK: Lineage: mv3.sale_date SIMPLE [(sales)sales.FieldSchema(name:sale_date, type:timestamp, comment:null), ]
+POSTHOOK: Lineage: mv3.store_id SIMPLE [(sales)sales.FieldSchema(name:store_id, type:int, comment:null), ]
 PREHOOK: query: explain cbo
 select  * from sales where cust_id >= 1 and  prod_id < 31
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_no_join_opt.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_no_join_opt.q.out
index 79dfd1aa3d..0f3a475a38 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_no_join_opt.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_no_join_opt.q.out
@@ -146,6 +146,10 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@emps_n30
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_n20
+POSTHOOK: Lineage: mv1_n20.commission SIMPLE [(emps_n30)emps_n30.FieldSchema(name:commission, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n20.deptno SIMPLE [(emps_n30)emps_n30.FieldSchema(name:deptno, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n20.name SIMPLE [(emps_n30)emps_n30.FieldSchema(name:name, type:varchar(256), comment:null), ]
+POSTHOOK: Lineage: mv1_n20.salary SIMPLE [(emps_n30)emps_n30.FieldSchema(name:salary, type:float, comment:null), ]
 PREHOOK: query: explain
 select emps_n30.name, emps_n30.salary, emps_n30.commission
 from emps_n30
@@ -291,6 +295,10 @@ POSTHOOK: Input: default@depts_n20
 POSTHOOK: Input: default@emps_n30
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_n20
+POSTHOOK: Lineage: mv1_n20.c EXPRESSION [(emps_n30)emps_n30.null, (depts_n20)depts_n20.null, ]
+POSTHOOK: Lineage: mv1_n20.deptno SIMPLE [(emps_n30)emps_n30.FieldSchema(name:deptno, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n20.empid SIMPLE [(emps_n30)emps_n30.FieldSchema(name:empid, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n20.s EXPRESSION [(emps_n30)emps_n30.FieldSchema(name:empid, type:int, comment:null), ]
 PREHOOK: query: explain
 select depts_n20.deptno, count(*) as c, sum(empid) as s
 from emps_n30 join depts_n20 using (deptno)
@@ -419,6 +427,9 @@ POSTHOOK: Input: default@dependents_n20
 POSTHOOK: Input: default@emps_n30
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_n20
+POSTHOOK: Lineage: mv1_n20.deptno SIMPLE [(emps_n30)emps_n30.FieldSchema(name:deptno, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n20.empid SIMPLE [(dependents_n20)dependents_n20.FieldSchema(name:empid, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n20.s EXPRESSION [(emps_n30)emps_n30.FieldSchema(name:salary, type:float, comment:null), ]
 PREHOOK: query: explain
 select dependents_n20.empid, sum(salary) as s
 from emps_n30
@@ -589,6 +600,12 @@ POSTHOOK: Input: default@dependents_n20
 POSTHOOK: Input: default@emps_n30
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_n20
+POSTHOOK: Lineage: mv1_n20.commission SIMPLE [(emps_n30)emps_n30.FieldSchema(name:commission, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n20.deptno SIMPLE [(emps_n30)emps_n30.FieldSchema(name:deptno, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n20.empid SIMPLE [(emps_n30)emps_n30.FieldSchema(name:empid, type:int, comment:null), ]
+POSTHOOK: Lineage: mv1_n20.name1 SIMPLE [(emps_n30)emps_n30.FieldSchema(name:name, type:varchar(256), comment:null), ]
+POSTHOOK: Lineage: mv1_n20.name2 SIMPLE [(dependents_n20)dependents_n20.FieldSchema(name:name, type:varchar(256), comment:null), ]
+POSTHOOK: Lineage: mv1_n20.salary SIMPLE [(emps_n30)emps_n30.FieldSchema(name:salary, type:float, comment:null), ]
 PREHOOK: query: explain
 select emps_n30.empid, dependents_n20.empid, emps_n30.deptno
 from emps_n30
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_ssb.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_ssb.q.out
index 8b341c787e..e3c589ec50 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_ssb.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_ssb.q.out
@@ -600,6 +600,24 @@ POSTHOOK: Input: default@ssb_part_n0
 POSTHOOK: Input: default@supplier_n0
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@ssb_mv_n0
+POSTHOOK: Lineage: ssb_mv_n0.c_city SIMPLE [(customer_n1)customer_n1.FieldSchema(name:c_city, type:string, comment:null), ]
+POSTHOOK: Lineage: ssb_mv_n0.c_nation SIMPLE [(customer_n1)customer_n1.FieldSchema(name:c_nation, type:string, comment:null), ]
+POSTHOOK: Lineage: ssb_mv_n0.c_region SIMPLE [(customer_n1)customer_n1.FieldSchema(name:c_region, type:string, comment:null), ]
+POSTHOOK: Lineage: ssb_mv_n0.d_weeknuminyear SIMPLE [(dates_n0)dates_n0.FieldSchema(name:d_weeknuminyear, type:int, comment:null), ]
+POSTHOOK: Lineage: ssb_mv_n0.d_year SIMPLE [(dates_n0)dates_n0.FieldSchema(name:d_year, type:int, comment:null), ]
+POSTHOOK: Lineage: ssb_mv_n0.d_yearmonth SIMPLE [(dates_n0)dates_n0.FieldSchema(name:d_yearmonth, type:string, comment:null), ]
+POSTHOOK: Lineage: ssb_mv_n0.d_yearmonthnum SIMPLE [(dates_n0)dates_n0.FieldSchema(name:d_yearmonthnum, type:int, comment:null), ]
+POSTHOOK: Lineage: ssb_mv_n0.discounted_price EXPRESSION [(lineorder_n0)lineorder_n0.FieldSchema(name:lo_extendedprice, type:double, comment:null), (lineorder_n0)lineorder_n0.FieldSchema(name:lo_discount, type:double, comment:null), ]
+POSTHOOK: Lineage: ssb_mv_n0.lo_discount SIMPLE [(lineorder_n0)lineorder_n0.FieldSchema(name:lo_discount, type:double, comment:null), ]
+POSTHOOK: Lineage: ssb_mv_n0.lo_quantity SIMPLE [(lineorder_n0)lineorder_n0.FieldSchema(name:lo_quantity, type:double, comment:null), ]
+POSTHOOK: Lineage: ssb_mv_n0.lo_revenue SIMPLE [(lineorder_n0)lineorder_n0.FieldSchema(name:lo_revenue, type:double, comment:null), ]
+POSTHOOK: Lineage: ssb_mv_n0.net_revenue EXPRESSION [(lineorder_n0)lineorder_n0.FieldSchema(name:lo_revenue, type:double, comment:null), (lineorder_n0)lineorder_n0.FieldSchema(name:lo_supplycost, type:double, comment:null), ]
+POSTHOOK: Lineage: ssb_mv_n0.p_brand1 SIMPLE [(ssb_part_n0)ssb_part_n0.FieldSchema(name:p_brand1, type:string, comment:null), ]
+POSTHOOK: Lineage: ssb_mv_n0.p_category SIMPLE [(ssb_part_n0)ssb_part_n0.FieldSchema(name:p_category, type:string, comment:null), ]
+POSTHOOK: Lineage: ssb_mv_n0.p_mfgr SIMPLE [(ssb_part_n0)ssb_part_n0.FieldSchema(name:p_mfgr, type:string, comment:null), ]
+POSTHOOK: Lineage: ssb_mv_n0.s_city SIMPLE [(supplier_n0)supplier_n0.FieldSchema(name:s_city, type:string, comment:null), ]
+POSTHOOK: Lineage: ssb_mv_n0.s_nation SIMPLE [(supplier_n0)supplier_n0.FieldSchema(name:s_nation, type:string, comment:null), ]
+POSTHOOK: Lineage: ssb_mv_n0.s_region SIMPLE [(supplier_n0)supplier_n0.FieldSchema(name:s_region, type:string, comment:null), ]
 PREHOOK: query: explain
 select 
     sum(lo_extendedprice*lo_discount) as revenue
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_ssb_2.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_ssb_2.q.out
index 62e3dd5a7f..3e73fbd7ac 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_ssb_2.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_ssb_2.q.out
@@ -602,6 +602,25 @@ POSTHOOK: Input: default@ssb_part
 POSTHOOK: Input: default@supplier
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@ssb_mv
+POSTHOOK: Lineage: ssb_mv.__time EXPRESSION [(dates)dates.FieldSchema(name:d_year, type:int, comment:null), (dates)dates.FieldSchema(name:d_monthnuminyear, type:int, comment:null), (dates)dates.FieldSchema(name:d_daynuminmonth, type:int, comment:null), ]
+POSTHOOK: Lineage: ssb_mv.c_city SIMPLE [(customer_n0)customer_n0.FieldSchema(name:c_city, type:string, comment:null), ]
+POSTHOOK: Lineage: ssb_mv.c_nation SIMPLE [(customer_n0)customer_n0.FieldSchema(name:c_nation, type:string, comment:null), ]
+POSTHOOK: Lineage: ssb_mv.c_region SIMPLE [(customer_n0)customer_n0.FieldSchema(name:c_region, type:string, comment:null), ]
+POSTHOOK: Lineage: ssb_mv.d_weeknuminyear EXPRESSION [(dates)dates.FieldSchema(name:d_weeknuminyear, type:int, comment:null), ]
+POSTHOOK: Lineage: ssb_mv.d_year EXPRESSION [(dates)dates.FieldSchema(name:d_year, type:int, comment:null), ]
+POSTHOOK: Lineage: ssb_mv.d_yearmonth SIMPLE [(dates)dates.FieldSchema(name:d_yearmonth, type:string, comment:null), ]
+POSTHOOK: Lineage: ssb_mv.d_yearmonthnum EXPRESSION [(dates)dates.FieldSchema(name:d_yearmonthnum, type:int, comment:null), ]
+POSTHOOK: Lineage: ssb_mv.discounted_price EXPRESSION [(lineorder)lineorder.FieldSchema(name:lo_extendedprice, type:double, comment:null), (lineorder)lineorder.FieldSchema(name:lo_discount, type:double, comment:null), ]
+POSTHOOK: Lineage: ssb_mv.lo_discount EXPRESSION [(lineorder)lineorder.FieldSchema(name:lo_discount, type:double, comment:null), ]
+POSTHOOK: Lineage: ssb_mv.lo_quantity EXPRESSION [(lineorder)lineorder.FieldSchema(name:lo_quantity, type:double, comment:null), ]
+POSTHOOK: Lineage: ssb_mv.lo_revenue SIMPLE [(lineorder)lineorder.FieldSchema(name:lo_revenue, type:double, comment:null), ]
+POSTHOOK: Lineage: ssb_mv.net_revenue EXPRESSION [(lineorder)lineorder.FieldSchema(name:lo_revenue, type:double, comment:null), (lineorder)lineorder.FieldSchema(name:lo_supplycost, type:double, comment:null), ]
+POSTHOOK: Lineage: ssb_mv.p_brand1 SIMPLE [(ssb_part)ssb_part.FieldSchema(name:p_brand1, type:string, comment:null), ]
+POSTHOOK: Lineage: ssb_mv.p_category SIMPLE [(ssb_part)ssb_part.FieldSchema(name:p_category, type:string, comment:null), ]
+POSTHOOK: Lineage: ssb_mv.p_mfgr SIMPLE [(ssb_part)ssb_part.FieldSchema(name:p_mfgr, type:string, comment:null), ]
+POSTHOOK: Lineage: ssb_mv.s_city SIMPLE [(supplier)supplier.FieldSchema(name:s_city, type:string, comment:null), ]
+POSTHOOK: Lineage: ssb_mv.s_nation SIMPLE [(supplier)supplier.FieldSchema(name:s_nation, type:string, comment:null), ]
+POSTHOOK: Lineage: ssb_mv.s_region SIMPLE [(supplier)supplier.FieldSchema(name:s_region, type:string, comment:null), ]
 PREHOOK: query: explain
 select 
     sum(lo_extendedprice*lo_discount) as revenue
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_ssb_grouping_sets_2.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_ssb_grouping_sets_2.q.out
index 1521c8c0b4..3b56282edb 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_ssb_grouping_sets_2.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_ssb_grouping_sets_2.q.out
@@ -608,6 +608,18 @@ POSTHOOK: Input: default@ssb_part_n4
 POSTHOOK: Input: default@supplier_n4
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@ssb_mv_n4
+POSTHOOK: Lineage: ssb_mv_n4._c9 EXPRESSION [(lineorder_n4)lineorder_n4.FieldSchema(name:lo_revenue, type:double, comment:null), ]
+POSTHOOK: Lineage: ssb_mv_n4.d_year SIMPLE [(dates_n4)dates_n4.FieldSchema(name:d_year, type:int, comment:null), ]
+POSTHOOK: Lineage: ssb_mv_n4.d_yearmonth SIMPLE [(dates_n4)dates_n4.FieldSchema(name:d_yearmonth, type:string, comment:null), ]
+POSTHOOK: Lineage: ssb_mv_n4.d_yearmonthnum SIMPLE [(dates_n4)dates_n4.FieldSchema(name:d_yearmonthnum, type:int, comment:null), ]
+POSTHOOK: Lineage: ssb_mv_n4.discounted_price EXPRESSION [(lineorder_n4)lineorder_n4.FieldSchema(name:lo_extendedprice, type:double, comment:null), (lineorder_n4)lineorder_n4.FieldSchema(name:lo_discount, type:double, comment:null), ]
+POSTHOOK: Lineage: ssb_mv_n4.grouping__id SIMPLE []
+POSTHOOK: Lineage: ssb_mv_n4.net_revenue EXPRESSION [(lineorder_n4)lineorder_n4.FieldSchema(name:lo_revenue, type:double, comment:null), (lineorder_n4)lineorder_n4.FieldSchema(name:lo_supplycost, type:double, comment:null), ]
+POSTHOOK: Lineage: ssb_mv_n4.p_brand1 SIMPLE [(ssb_part_n4)ssb_part_n4.FieldSchema(name:p_brand1, type:string, comment:null), ]
+POSTHOOK: Lineage: ssb_mv_n4.p_category SIMPLE [(ssb_part_n4)ssb_part_n4.FieldSchema(name:p_category, type:string, comment:null), ]
+POSTHOOK: Lineage: ssb_mv_n4.s_city SIMPLE [(supplier_n4)supplier_n4.FieldSchema(name:s_city, type:string, comment:null), ]
+POSTHOOK: Lineage: ssb_mv_n4.s_nation SIMPLE [(supplier_n4)supplier_n4.FieldSchema(name:s_nation, type:string, comment:null), ]
+POSTHOOK: Lineage: ssb_mv_n4.s_region SIMPLE [(supplier_n4)supplier_n4.FieldSchema(name:s_region, type:string, comment:null), ]
 PREHOOK: query: explain cbo
 select 
     sum(lo_revenue) as lo_revenue, d_year, p_brand1
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_window.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_window.q.out
index 80211c5fb7..9e40e74dca 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_window.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_window.q.out
@@ -128,6 +128,8 @@ POSTHOOK: Input: arc_view@tv_view_data
 POSTHOOK: Input: arc_view@wealth
 POSTHOOK: Output: arc_view@mv_tv_view_data_av1
 POSTHOOK: Output: database:arc_view
+POSTHOOK: Lineage: mv_tv_view_data_av1.quartile SCRIPT [(tv_view_data)tv_view_data.FieldSchema(name:program, type:string, comment:null), (tv_view_data)tv_view_data.FieldSchema(name:total_views, type:bigint, comment:null), ]
+POSTHOOK: Lineage: mv_tv_view_data_av1.total EXPRESSION [(tv_view_data)tv_view_data.FieldSchema(name:total_views, type:bigint, comment:null), ]
 PREHOOK: query: explain cbo
 select
   t.quartile,
@@ -856,6 +858,9 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: arc_view@tv_view_data
 POSTHOOK: Output: arc_view@mv_tv_view_data_av2
 POSTHOOK: Output: database:arc_view
+POSTHOOK: Lineage: mv_tv_view_data_av2.program SIMPLE [(tv_view_data)tv_view_data.FieldSchema(name:program, type:string, comment:null), ]
+POSTHOOK: Lineage: mv_tv_view_data_av2.quartile SCRIPT [(tv_view_data)tv_view_data.FieldSchema(name:program, type:string, comment:null), (tv_view_data)tv_view_data.FieldSchema(name:total_views, type:bigint, comment:null), ]
+POSTHOOK: Lineage: mv_tv_view_data_av2.total_views SIMPLE [(tv_view_data)tv_view_data.FieldSchema(name:total_views, type:bigint, comment:null), ]
 PREHOOK: query: insert into tv_view_data values ('scream3', 40000000)
 PREHOOK: type: QUERY
 PREHOOK: Input: _dummy_database@_dummy_table
diff --git a/ql/src/test/results/clientpositive/llap/show_json_format.q.out b/ql/src/test/results/clientpositive/llap/show_json_format.q.out
index 2f7591099a..91543d3fb3 100644
--- a/ql/src/test/results/clientpositive/llap/show_json_format.q.out
+++ b/ql/src/test/results/clientpositive/llap/show_json_format.q.out
@@ -70,6 +70,7 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@t
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv
+POSTHOOK: Lineage: mv.i SIMPLE [(t)t.FieldSchema(name:i, type:int, comment:null), ]
 PREHOOK: query: SHOW MATERIALIZED VIEWS
 PREHOOK: type: SHOWMATERIALIZEDVIEWS
 POSTHOOK: query: SHOW MATERIALIZED VIEWS
diff --git a/ql/src/test/results/clientpositive/llap/show_materialized_views.q.out b/ql/src/test/results/clientpositive/llap/show_materialized_views.q.out
index 7a2fcdead1..fdf525c07d 100644
--- a/ql/src/test/results/clientpositive/llap/show_materialized_views.q.out
+++ b/ql/src/test/results/clientpositive/llap/show_materialized_views.q.out
@@ -38,6 +38,9 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: test1@shtb_test1
 POSTHOOK: Output: database:test1
 POSTHOOK: Output: test1@shtb_test1_view1
+POSTHOOK: Lineage: shtb_test1_view1.ds SIMPLE [(shtb_test1)shtb_test1.FieldSchema(name:ds, type:string, comment:null), ]
+POSTHOOK: Lineage: shtb_test1_view1.key SIMPLE [(shtb_test1)shtb_test1.FieldSchema(name:key, type:int, comment:null), ]
+POSTHOOK: Lineage: shtb_test1_view1.value SIMPLE [(shtb_test1)shtb_test1.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: CREATE MATERIALIZED VIEW shtb_test1_view2 
 TBLPROPERTIES ('rewriting.time.window' = '-1min') AS
 SELECT * FROM shtb_test1 where KEY > 100 and KEY < 200
@@ -52,6 +55,9 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: test1@shtb_test1
 POSTHOOK: Output: database:test1
 POSTHOOK: Output: test1@shtb_test1_view2
+POSTHOOK: Lineage: shtb_test1_view2.ds SIMPLE [(shtb_test1)shtb_test1.FieldSchema(name:ds, type:string, comment:null), ]
+POSTHOOK: Lineage: shtb_test1_view2.key SIMPLE [(shtb_test1)shtb_test1.FieldSchema(name:key, type:int, comment:null), ]
+POSTHOOK: Lineage: shtb_test1_view2.value SIMPLE [(shtb_test1)shtb_test1.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: CREATE MATERIALIZED VIEW shtb_full_view2
 TBLPROPERTIES ('rewriting.time.window' = '5min') AS
 SELECT * FROM shtb_test1
@@ -66,6 +72,9 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: test1@shtb_test1
 POSTHOOK: Output: database:test1
 POSTHOOK: Output: test1@shtb_full_view2
+POSTHOOK: Lineage: shtb_full_view2.ds SIMPLE [(shtb_test1)shtb_test1.FieldSchema(name:ds, type:string, comment:null), ]
+POSTHOOK: Lineage: shtb_full_view2.key SIMPLE [(shtb_test1)shtb_test1.FieldSchema(name:key, type:int, comment:null), ]
+POSTHOOK: Lineage: shtb_full_view2.value SIMPLE [(shtb_test1)shtb_test1.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: CREATE MATERIALIZED VIEW shtb_aggr_view1 AS
 SELECT a.value, sum(a.key) FROM shtb_test1 a join shtb_test1 b on (a.key = b.key) group by a.value
 PREHOOK: type: CREATE_MATERIALIZED_VIEW
@@ -78,6 +87,8 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: test1@shtb_test1
 POSTHOOK: Output: database:test1
 POSTHOOK: Output: test1@shtb_aggr_view1
+POSTHOOK: Lineage: shtb_aggr_view1._c1 EXPRESSION [(shtb_test1)a.FieldSchema(name:key, type:int, comment:null), ]
+POSTHOOK: Lineage: shtb_aggr_view1.value SIMPLE [(shtb_test1)a.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: CREATE MATERIALIZED VIEW shtb_aggr_view2 AS
 SELECT a.value, count(1), sum(a.key) FROM shtb_test1 a join shtb_test1 b on (a.key = b.key) group by a.value
 PREHOOK: type: CREATE_MATERIALIZED_VIEW
@@ -90,6 +101,9 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: test1@shtb_test1
 POSTHOOK: Output: database:test1
 POSTHOOK: Output: test1@shtb_aggr_view2
+POSTHOOK: Lineage: shtb_aggr_view2._c1 EXPRESSION [(shtb_test1)a.null, (shtb_test1)b.null, ]
+POSTHOOK: Lineage: shtb_aggr_view2._c2 EXPRESSION [(shtb_test1)a.FieldSchema(name:key, type:int, comment:null), ]
+POSTHOOK: Lineage: shtb_aggr_view2.value SIMPLE [(shtb_test1)a.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: USE test2
 PREHOOK: type: SWITCHDATABASE
 PREHOOK: Input: database:test2
@@ -128,6 +142,9 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: test2@shtb_test1
 POSTHOOK: Output: database:test2
 POSTHOOK: Output: test2@shtb_test1_view1
+POSTHOOK: Lineage: shtb_test1_view1.ds SIMPLE [(shtb_test1)shtb_test1.FieldSchema(name:ds, type:string, comment:null), ]
+POSTHOOK: Lineage: shtb_test1_view1.key SIMPLE [(shtb_test1)shtb_test1.FieldSchema(name:key, type:int, comment:null), ]
+POSTHOOK: Lineage: shtb_test1_view1.value SIMPLE [(shtb_test1)shtb_test1.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: CREATE MATERIALIZED VIEW shtb_test2_view2 DISABLE REWRITE AS
 SELECT * FROM shtb_test2 where KEY > 100 and KEY < 200
 PREHOOK: type: CREATE_MATERIALIZED_VIEW
@@ -140,6 +157,9 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: test2@shtb_test2
 POSTHOOK: Output: database:test2
 POSTHOOK: Output: test2@shtb_test2_view2
+POSTHOOK: Lineage: shtb_test2_view2.ds SIMPLE [(shtb_test2)shtb_test2.FieldSchema(name:ds, type:string, comment:null), ]
+POSTHOOK: Lineage: shtb_test2_view2.key SIMPLE [(shtb_test2)shtb_test2.FieldSchema(name:key, type:int, comment:null), ]
+POSTHOOK: Lineage: shtb_test2_view2.value SIMPLE [(shtb_test2)shtb_test2.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: USE test1
 PREHOOK: type: SWITCHDATABASE
 PREHOOK: Input: database:test1
@@ -487,6 +507,7 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: database@foo_n0
 POSTHOOK: Output: database:database
 POSTHOOK: Output: database@fooview
+POSTHOOK: Lineage: fooview.a SIMPLE [(foo_n0)foo_n0.FieldSchema(name:a, type:int, comment:null), ]
 PREHOOK: query: USE default
 PREHOOK: type: SWITCHDATABASE
 PREHOOK: Input: database:default
diff --git a/ql/src/test/results/clientpositive/llap/sketches_materialized_view_cume_dist.q.out b/ql/src/test/results/clientpositive/llap/sketches_materialized_view_cume_dist.q.out
index ad82104bf8..86d9bd2cd8 100644
--- a/ql/src/test/results/clientpositive/llap/sketches_materialized_view_cume_dist.q.out
+++ b/ql/src/test/results/clientpositive/llap/sketches_materialized_view_cume_dist.q.out
@@ -36,6 +36,8 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@sketch_input
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv_1
+POSTHOOK: Lineage: mv_1._c1 EXPRESSION [(sketch_input)sketch_input.FieldSchema(name:id, type:int, comment:null), ]
+POSTHOOK: Lineage: mv_1.category SIMPLE [(sketch_input)sketch_input.FieldSchema(name:category, type:char(1), comment:null), ]
 Warning: Shuffle Join MERGEJOIN[17][tables = [$hdt$_0, $hdt$_1]] in Stage 'Reducer 2' is a cross product
 PREHOOK: query: explain
 select 'rewrite; mv matching', id, cume_dist() over (order by id) from sketch_input order by id
diff --git a/ql/src/test/results/clientpositive/llap/sketches_materialized_view_ntile.q.out b/ql/src/test/results/clientpositive/llap/sketches_materialized_view_ntile.q.out
index a2fcccc67a..b59707d7db 100644
--- a/ql/src/test/results/clientpositive/llap/sketches_materialized_view_ntile.q.out
+++ b/ql/src/test/results/clientpositive/llap/sketches_materialized_view_ntile.q.out
@@ -36,6 +36,8 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@sketch_input
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv_1
+POSTHOOK: Lineage: mv_1._c1 EXPRESSION [(sketch_input)sketch_input.FieldSchema(name:id, type:int, comment:null), ]
+POSTHOOK: Lineage: mv_1.category SIMPLE [(sketch_input)sketch_input.FieldSchema(name:category, type:char(1), comment:null), ]
 WARNING: Comparing bigint and double may result in loss of information.
 Warning: Shuffle Join MERGEJOIN[17][tables = [$hdt$_0, $hdt$_1]] in Stage 'Reducer 2' is a cross product
 PREHOOK: query: explain
diff --git a/ql/src/test/results/clientpositive/llap/sketches_materialized_view_percentile_disc.q.out b/ql/src/test/results/clientpositive/llap/sketches_materialized_view_percentile_disc.q.out
index e05506ca33..aff6f07613 100644
--- a/ql/src/test/results/clientpositive/llap/sketches_materialized_view_percentile_disc.q.out
+++ b/ql/src/test/results/clientpositive/llap/sketches_materialized_view_percentile_disc.q.out
@@ -36,6 +36,8 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@sketch_input
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv_1
+POSTHOOK: Lineage: mv_1._c1 EXPRESSION [(sketch_input)sketch_input.FieldSchema(name:id, type:int, comment:null), ]
+POSTHOOK: Lineage: mv_1.category SIMPLE [(sketch_input)sketch_input.FieldSchema(name:category, type:char(1), comment:null), ]
 PREHOOK: query: explain
 select 'rewrite; mv matching', category, percentile_disc(0.2) within group (order by id) from sketch_input group by category
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/llap/sketches_materialized_view_rank.q.out b/ql/src/test/results/clientpositive/llap/sketches_materialized_view_rank.q.out
index 94ac6b8712..80e19a8aab 100644
--- a/ql/src/test/results/clientpositive/llap/sketches_materialized_view_rank.q.out
+++ b/ql/src/test/results/clientpositive/llap/sketches_materialized_view_rank.q.out
@@ -36,6 +36,8 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@sketch_input
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv_1
+POSTHOOK: Lineage: mv_1._c1 EXPRESSION [(sketch_input)sketch_input.FieldSchema(name:id, type:int, comment:null), ]
+POSTHOOK: Lineage: mv_1.category SIMPLE [(sketch_input)sketch_input.FieldSchema(name:category, type:char(1), comment:null), ]
 WARNING: Comparing bigint and double may result in loss of information.
 Warning: Shuffle Join MERGEJOIN[17][tables = [$hdt$_0, $hdt$_1]] in Stage 'Reducer 2' is a cross product
 PREHOOK: query: explain
diff --git a/ql/src/test/results/clientpositive/llap/sketches_materialized_view_rollup.q.out b/ql/src/test/results/clientpositive/llap/sketches_materialized_view_rollup.q.out
index ee656b0a43..84c4953219 100644
--- a/ql/src/test/results/clientpositive/llap/sketches_materialized_view_rollup.q.out
+++ b/ql/src/test/results/clientpositive/llap/sketches_materialized_view_rollup.q.out
@@ -36,6 +36,9 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@sketch_input
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv_1
+POSTHOOK: Lineage: mv_1._c1 EXPRESSION [(sketch_input)sketch_input.FieldSchema(name:id, type:int, comment:null), ]
+POSTHOOK: Lineage: mv_1._c2 EXPRESSION [(sketch_input)sketch_input.FieldSchema(name:id, type:int, comment:null), ]
+POSTHOOK: Lineage: mv_1.category SIMPLE [(sketch_input)sketch_input.FieldSchema(name:category, type:char(1), comment:null), ]
 PREHOOK: query: explain
 select category, round(ds_hll_estimate(ds_hll_sketch(id))) from sketch_input group by category
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/llap/sketches_materialized_view_rollup2.q.out b/ql/src/test/results/clientpositive/llap/sketches_materialized_view_rollup2.q.out
index 0404accfd3..96f517f59b 100644
--- a/ql/src/test/results/clientpositive/llap/sketches_materialized_view_rollup2.q.out
+++ b/ql/src/test/results/clientpositive/llap/sketches_materialized_view_rollup2.q.out
@@ -36,6 +36,9 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@sketch_input
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv_1
+POSTHOOK: Lineage: mv_1._c1 EXPRESSION [(sketch_input)sketch_input.FieldSchema(name:id, type:int, comment:null), ]
+POSTHOOK: Lineage: mv_1._c2 EXPRESSION [(sketch_input)sketch_input.FieldSchema(name:id, type:int, comment:null), ]
+POSTHOOK: Lineage: mv_1.category SIMPLE [(sketch_input)sketch_input.FieldSchema(name:category, type:char(1), comment:null), ]
 PREHOOK: query: explain
 select 'rewrite; mv matching', category, count(distinct id) from sketch_input group by category
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/llap/sketches_materialized_view_safety.q.out b/ql/src/test/results/clientpositive/llap/sketches_materialized_view_safety.q.out
index b326270051..605e3adbd8 100644
--- a/ql/src/test/results/clientpositive/llap/sketches_materialized_view_safety.q.out
+++ b/ql/src/test/results/clientpositive/llap/sketches_materialized_view_safety.q.out
@@ -185,6 +185,9 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@sketch_input
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv_1
+POSTHOOK: Lineage: mv_1._c0 SIMPLE []
+POSTHOOK: Lineage: mv_1._c2 EXPRESSION [(sketch_input)sketch_input.FieldSchema(name:id, type:int, comment:null), ]
+POSTHOOK: Lineage: mv_1.category SIMPLE [(sketch_input)sketch_input.FieldSchema(name:category, type:char(1), comment:null), ]
 PREHOOK: query: insert into table sketch_input values
   (1,'a'),(1, 'a'), (2, 'a'), (3, 'a'), (4, 'a'), (5, 'a'), (6, 'a'), (7, 'a'), (8, 'a'), (9, 'a'), (10, 'a'),
   (6,'b'),(6, 'b'), (7, 'b'), (8, 'b'), (9, 'b'), (10, 'b'), (11, 'b'), (12, 'b'), (13, 'b'), (14, 'b'), (15, 'b')
