diff --git a/data/files/vector_ptf_part_simple_all_datatypes.txt b/data/files/vector_ptf_part_simple_all_datatypes.txt
index 661cab6117..4ac49a777d 100644
--- a/data/files/vector_ptf_part_simple_all_datatypes.txt
+++ b/data/files/vector_ptf_part_simple_all_datatypes.txt
@@ -1,40 +1,40 @@
-Manufacturer#2,almond aquamarine rose maroon antique,NULL,900.66,1
-Manufacturer#1,almond aquamarine burnished black steel,1970-01-02,1414.42,2
-Manufacturer#2,almond aquamarine rose maroon antique,1970-01-03,1698.66,3
-Manufacturer#1,almond aquamarine pink moccasin thistle,1970-01-04,NULL,4
-Manufacturer#1,almond antique chartreuse lavender yellow,1970-01-05,1753.76,5
-Manufacturer#5,almond antique medium spring khaki,1970-01-01,1611.66,6
-Manufacturer#5,almond antique blue firebrick mint,NULL,1789.69,7
-Manufacturer#1,almond antique burnished rose metallic,1970-01-03,1173.15,8
-Manufacturer#1,almond aquamarine pink moccasin thistle,1970-01-04,1632.66,9
-Manufacturer#3,almond antique forest lavender goldenrod,1970-01-05,1190.27,10
-Manufacturer#4,almond aquamarine yellow dodger mint,1970-01-01,1844.92,11
-Manufacturer#1,almond antique chartreuse lavender yellow,1970-01-02,1753.76,12
-Manufacturer#2,almond antique violet turquoise frosted,NULL,1800.7,13
-Manufacturer#3,almond antique forest lavender goldenrod,1970-01-04,NULL,14
-Manufacturer#2,almond antique violet chocolate turquoise,1970-01-05,1690.68,15
-Manufacturer#4,almond antique violet mint lemon,1970-01-01,1375.42,16
-Manufacturer#1,almond aquamarine pink moccasin thistle,1970-01-02,1632.66,17
-Manufacturer#5,almond azure blanched chiffon midnight,1970-01-03,1464.48,18
-Manufacturer#3,almond antique forest lavender goldenrod,NULL,590.27,19
-Manufacturer#1,almond antique chartreuse lavender yellow,1970-01-05,1753.76,20
-Manufacturer#2,almond antique violet turquoise frosted,1970-01-01,1800.7,21
-Manufacturer#5,almond antique sky peru orange,1970-01-02,1788.73,22
-Manufacturer#1,almond aquamarine pink moccasin thistle,1970-01-03,1632.66,23
-Manufacturer#3,almond antique chartreuse khaki white,1970-01-04,99.68,24
-Manufacturer#4,almond antique gainsboro frosted violet,NULL,NULL,25
-Manufacturer#1,almond antique chartreuse lavender yellow,NULL,1753.76,26
-Manufacturer#2,almond antique violet turquoise frosted,1970-01-02,1800.7,27
-Manufacturer#3,almond antique olive coral navajo,1970-01-03,1337.29,28
-Manufacturer#5,almond antique medium spring khaki,1970-01-04,1611.66,29
-Manufacturer#1,almond antique salmon chartreuse burlywood,1970-01-05,1602.59,30
-Manufacturer#3,almond antique misty red olive,1970-01-01,1922.98,31
-Manufacturer#2,almond aquamarine sandy cyan gainsboro,NULL,1000.6,32
-Manufacturer#3,almond antique forest lavender goldenrod,1970-01-03,1190.27,33
-Manufacturer#2,almond aquamarine midnight light salmon,1970-01-04,2031.98,34
-Manufacturer#4,almond aquamarine floral ivory bisque,1970-01-05,NULL,35
-Manufacturer#5,almond aquamarine dodger light gainsboro,1970-01-01,1018.1,36
-Manufacturer#4,almond azure aquamarine papaya violet,1970-01-02,1290.35,37
-Manufacturer#3,almond antique metallic orange dim,NULL,55.39,38
-Manufacturer#1,almond antique burnished rose metallic,1970-01-04,1173.15,39
-Manufacturer#4,almond aquamarine floral ivory bisque,1970-01-05,1206.26,40
+Manufacturer#2,almond aquamarine rose maroon antique,NULL,900.66,A,DA,1
+Manufacturer#1,almond aquamarine burnished black steel,1970-01-02,1414.42,B,AB,2
+Manufacturer#2,almond aquamarine rose maroon antique,1970-01-03,1698.66,C,CA,3
+Manufacturer#1,almond aquamarine pink moccasin thistle,1970-01-04,NULL,A,DE,4
+Manufacturer#1,almond antique chartreuse lavender yellow,1970-01-05,1753.76,B,AC,5
+Manufacturer#5,almond antique medium spring khaki,1970-01-01,1611.66,C,AA,6
+Manufacturer#5,almond antique blue firebrick mint,NULL,1789.69,D,FD,7
+Manufacturer#1,almond antique burnished rose metallic,1970-01-03,1173.15,A,SM,8
+Manufacturer#1,almond aquamarine pink moccasin thistle,1970-01-04,1632.66,B,AK,9
+Manufacturer#3,almond antique forest lavender goldenrod,1970-01-05,1190.27,C,AY,10
+Manufacturer#4,almond aquamarine yellow dodger mint,1970-01-01,1844.92,D,FD,11
+Manufacturer#1,almond antique chartreuse lavender yellow,1970-01-02,1753.76,D,DA,12
+Manufacturer#2,almond antique violet turquoise frosted,NULL,1800.7,B,AC,13
+Manufacturer#3,almond antique forest lavender goldenrod,1970-01-04,NULL,C,BB,14
+Manufacturer#2,almond antique violet chocolate turquoise,1970-01-05,1690.68,D,LM,15
+Manufacturer#4,almond antique violet mint lemon,1970-01-01,1375.42,B,OP,16
+Manufacturer#1,almond aquamarine pink moccasin thistle,1970-01-02,1632.66,D,RS,17
+Manufacturer#5,almond azure blanched chiffon midnight,1970-01-03,1464.48,C,AB,18
+Manufacturer#3,almond antique forest lavender goldenrod,NULL,590.27,D,CD,19
+Manufacturer#1,almond antique chartreuse lavender yellow,1970-01-05,1753.76,A,EF,20
+Manufacturer#2,almond antique violet turquoise frosted,1970-01-01,1800.7,B,AA,21
+Manufacturer#5,almond antique sky peru orange,1970-01-02,1788.73,A,BB,22
+Manufacturer#1,almond aquamarine pink moccasin thistle,1970-01-03,1632.66,D,CC,23
+Manufacturer#3,almond antique chartreuse khaki white,1970-01-04,99.68,C,DD,24
+Manufacturer#4,almond antique gainsboro frosted violet,NULL,NULL,A,EE,25
+Manufacturer#1,almond antique chartreuse lavender yellow,NULL,1753.76,C,AD,26
+Manufacturer#2,almond antique violet turquoise frosted,1970-01-02,1800.7,D,AB,27
+Manufacturer#3,almond antique olive coral navajo,1970-01-03,1337.29,A,AC,28
+Manufacturer#5,almond antique medium spring khaki,1970-01-04,1611.66,B,AA,29
+Manufacturer#1,almond antique salmon chartreuse burlywood,1970-01-05,1602.59,C,BB,30
+Manufacturer#3,almond antique misty red olive,1970-01-01,1922.98,D,BC,31
+Manufacturer#2,almond aquamarine sandy cyan gainsboro,NULL,1000.6,A,BD,32
+Manufacturer#3,almond antique forest lavender goldenrod,1970-01-03,1190.27,B,CA,33
+Manufacturer#2,almond aquamarine midnight light salmon,1970-01-04,2031.98,C,CB,34
+Manufacturer#4,almond aquamarine floral ivory bisque,1970-01-05,NULL,A,CC,35
+Manufacturer#5,almond aquamarine dodger light gainsboro,1970-01-01,1018.1,B,CD,36
+Manufacturer#4,almond azure aquamarine papaya violet,1970-01-02,1290.35,C,DA,37
+Manufacturer#3,almond antique metallic orange dim,NULL,55.39,D,DB,38
+Manufacturer#1,almond antique burnished rose metallic,1970-01-04,1173.15,D,DC,39
+Manufacturer#4,almond aquamarine floral ivory bisque,1970-01-05,1206.26,C,DD,40
\ No newline at end of file
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/udf/ptf/ValueBoundaryScanner.java b/ql/src/java/org/apache/hadoop/hive/ql/udf/ptf/ValueBoundaryScanner.java
index c6bb1c2aad..c7325c93e7 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/udf/ptf/ValueBoundaryScanner.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/udf/ptf/ValueBoundaryScanner.java
@@ -23,7 +23,9 @@
 import org.apache.commons.lang3.tuple.ImmutablePair;
 import org.apache.commons.lang3.tuple.Pair;
 import org.apache.hadoop.hive.common.type.Date;
+import org.apache.hadoop.hive.common.type.HiveChar;
 import org.apache.hadoop.hive.common.type.HiveDecimal;
+import org.apache.hadoop.hive.common.type.HiveVarchar;
 import org.apache.hadoop.hive.common.type.Timestamp;
 import org.apache.hadoop.hive.common.type.TimestampTZ;
 import org.apache.hadoop.hive.ql.exec.BoundaryCache;
@@ -740,6 +742,10 @@ public static SingleValueBoundaryScanner getBoundaryScanner(BoundaryDef start, B
       return new DateValueBoundaryScanner(start, end, exprDef, nullsLast);
     case STRING:
       return new StringValueBoundaryScanner(start, end, exprDef, nullsLast);
+    case CHAR:
+      return new CharValueBoundaryScanner(start, end, exprDef, nullsLast);
+    case VARCHAR:
+      return new VarcharValueBoundaryScanner(start, end, exprDef, nullsLast);
     default:
       throw new HiveException(String
           .format("Internal Error: attempt to setup a Window for datatype: '%s'", primitiveCategory));
@@ -748,9 +754,6 @@ public static SingleValueBoundaryScanner getBoundaryScanner(BoundaryDef start, B
 
   public static SingleValueBoundaryScanner getBoundaryScanner(BoundaryDef start, BoundaryDef end,
       boolean nullsLast, OrderExpressionDef exprDef, String typeString) throws HiveException {
-    if (typeString.startsWith("decimal")){
-      typeString = "decimal"; //DecimalTypeInfo.getTypeName() includes scale/precision: "decimal(10,4)"
-    }
     switch (typeString) {
     case "int":
     case "bigint":
@@ -761,13 +764,17 @@ public static SingleValueBoundaryScanner getBoundaryScanner(BoundaryDef start, B
     case "double":
     case "float":
       return new DoublePrimitiveValueBoundaryScanner(start, end, exprDef, nullsLast);
-    case "decimal":
-      return new HiveDecimalPrimitiveValueBoundaryScanner(start, end, exprDef, nullsLast);
     case "date":
       return new DatePrimitiveValueBoundaryScanner(start, end, exprDef, nullsLast);
     case "string":
       return new StringPrimitiveValueBoundaryScanner(start, end, exprDef, nullsLast);
     default:
+      // The following types includes scale/precision: "decimal(10,4), char(10) and varchar(15)"
+      if (typeString.startsWith("char") || typeString.startsWith("varchar")) {
+        return new StringPrimitiveValueBoundaryScanner(start, end, exprDef, nullsLast);
+      } else if (typeString.startsWith("decimal")) {
+        return new HiveDecimalPrimitiveValueBoundaryScanner(start, end, exprDef, nullsLast);
+      }
       throw new HiveException(String
           .format("Internal Error: attempt to setup a Window for typeString: '%s'", typeString));
     }
@@ -1214,6 +1221,55 @@ public boolean isEqualPrimitive(String s1, String s2) {
   }
 }
 
+class CharValueBoundaryScanner extends SingleValueBoundaryScanner {
+  public CharValueBoundaryScanner(BoundaryDef start, BoundaryDef end,
+      OrderExpressionDef expressionDef, boolean nullsLast) {
+    super(start, end, expressionDef, nullsLast);
+  }
+
+  @Override
+  public boolean isDistanceGreater(Object v1, Object v2, int amt) {
+    HiveChar s1 = PrimitiveObjectInspectorUtils.getHiveChar(v1,
+        (PrimitiveObjectInspector) expressionDef.getOI());
+    HiveChar s2 = PrimitiveObjectInspectorUtils.getHiveChar(v2,
+        (PrimitiveObjectInspector) expressionDef.getOI());
+    return s1 != null && s2 != null && s1.compareTo(s2) > 0;
+  }
+
+  @Override
+  public boolean isEqual(Object v1, Object v2) {
+    HiveChar s1 = PrimitiveObjectInspectorUtils.getHiveChar(v1,
+        (PrimitiveObjectInspector) expressionDef.getOI());
+    HiveChar s2 = PrimitiveObjectInspectorUtils.getHiveChar(v2,
+        (PrimitiveObjectInspector) expressionDef.getOI());
+    return (s1 == null && s2 == null) || (s1 != null && s1.equals(s2));
+  }
+}
+
+class VarcharValueBoundaryScanner extends SingleValueBoundaryScanner {
+  public VarcharValueBoundaryScanner(BoundaryDef start, BoundaryDef end,
+      OrderExpressionDef expressionDef, boolean nullsLast) {
+    super(start, end, expressionDef, nullsLast);
+  }
+
+  @Override
+  public boolean isDistanceGreater(Object v1, Object v2, int amt) {
+    HiveVarchar s1 = PrimitiveObjectInspectorUtils.getHiveVarchar(v1,
+        (PrimitiveObjectInspector) expressionDef.getOI());
+    HiveVarchar s2 = PrimitiveObjectInspectorUtils.getHiveVarchar(v2,
+        (PrimitiveObjectInspector) expressionDef.getOI());
+    return s1 != null && s2 != null && s1.compareTo(s2) > 0;
+  }
+
+  @Override
+  public boolean isEqual(Object v1, Object v2) {
+    HiveVarchar s1 = PrimitiveObjectInspectorUtils.getHiveVarchar(v1,
+        (PrimitiveObjectInspector) expressionDef.getOI());
+    HiveVarchar s2 = PrimitiveObjectInspectorUtils.getHiveVarchar(v2,
+        (PrimitiveObjectInspector) expressionDef.getOI());
+    return (s1 == null && s2 == null) || (s1 != null && s1.equals(s2));
+  }
+}
 /*
  */
  class MultiValueBoundaryScanner extends ValueBoundaryScanner {
diff --git a/ql/src/test/org/apache/hadoop/hive/ql/udf/ptf/TestValueBoundaryScanner.java b/ql/src/test/org/apache/hadoop/hive/ql/udf/ptf/TestValueBoundaryScanner.java
index 9c9eb585b3..cc7f5394af 100644
--- a/ql/src/test/org/apache/hadoop/hive/ql/udf/ptf/TestValueBoundaryScanner.java
+++ b/ql/src/test/org/apache/hadoop/hive/ql/udf/ptf/TestValueBoundaryScanner.java
@@ -20,12 +20,16 @@
 import java.time.ZoneId;
 
 import org.apache.hadoop.hive.common.type.Date;
+import org.apache.hadoop.hive.common.type.HiveChar;
+import org.apache.hadoop.hive.common.type.HiveVarchar;
 import org.apache.hadoop.hive.common.type.Timestamp;
 import org.apache.hadoop.hive.common.type.TimestampTZ;
 import org.apache.hadoop.hive.ql.plan.ptf.OrderExpressionDef;
 import org.apache.hadoop.hive.ql.plan.ptf.PTFExpressionDef;
 import org.apache.hadoop.hive.serde2.io.DateWritableV2;
+import org.apache.hadoop.hive.serde2.io.HiveCharWritable;
 import org.apache.hadoop.hive.serde2.io.HiveDecimalWritable;
+import org.apache.hadoop.hive.serde2.io.HiveVarcharWritable;
 import org.apache.hadoop.hive.serde2.io.TimestampLocalTZWritable;
 import org.apache.hadoop.hive.serde2.io.TimestampWritableV2;
 import org.apache.hadoop.hive.serde2.objectinspector.primitive.PrimitiveObjectInspectorFactory;
@@ -185,6 +189,47 @@ public void testStringEquals() {
     Assert.assertTrue(scanner.isEqual(null, null));
   }
 
+  @Test
+  public void testVarcharEquals() {
+    PTFExpressionDef argDef = new PTFExpressionDef();
+    argDef.setOI(PrimitiveObjectInspectorFactory.writableHiveVarcharObjectInspector);
+
+    VarcharValueBoundaryScanner scanner =
+        new VarcharValueBoundaryScanner(null, null, new OrderExpressionDef(argDef), false);
+    HiveVarcharWritable w1 = new HiveVarcharWritable(new HiveVarchar("abc", 3));
+    HiveVarcharWritable w2 = new HiveVarcharWritable(new HiveVarchar("bcd", 3));
+
+    Assert.assertTrue(scanner.isEqual(w1, w1));
+
+    Assert.assertFalse(scanner.isEqual(w1, w2));
+    Assert.assertFalse(scanner.isEqual(w2, w1));
+
+    Assert.assertFalse(scanner.isEqual(null, w2));
+    Assert.assertFalse(scanner.isEqual(w1, null));
+
+    Assert.assertTrue(scanner.isEqual(null, null));
+  }
+
+  @Test
+  public void testCharEquals() {
+    PTFExpressionDef argDef = new PTFExpressionDef();
+    argDef.setOI(PrimitiveObjectInspectorFactory.writableHiveCharObjectInspector);
+
+    CharValueBoundaryScanner scanner = new CharValueBoundaryScanner(null, null, new OrderExpressionDef(argDef), false);
+    HiveCharWritable w1 = new HiveCharWritable(new HiveChar("a", 1));
+    HiveCharWritable w2 = new HiveCharWritable(new HiveChar("b", 1));
+
+    Assert.assertTrue(scanner.isEqual(w1, w1));
+
+    Assert.assertFalse(scanner.isEqual(w1, w2));
+    Assert.assertFalse(scanner.isEqual(w2, w1));
+
+    Assert.assertFalse(scanner.isEqual(null, w2));
+    Assert.assertFalse(scanner.isEqual(w1, null));
+
+    Assert.assertTrue(scanner.isEqual(null, null));
+  }
+
   @Test
   public void testTimestampIsDistanceGreater() {
     PTFExpressionDef argDef = new PTFExpressionDef();
diff --git a/ql/src/test/queries/clientpositive/vector_ptf_bounded_start.q b/ql/src/test/queries/clientpositive/vector_ptf_bounded_start.q
index 09e0f8b1da..9ae99dce71 100644
--- a/ql/src/test/queries/clientpositive/vector_ptf_bounded_start.q
+++ b/ql/src/test/queries/clientpositive/vector_ptf_bounded_start.q
@@ -3,14 +3,16 @@ set hive.vectorized.execution.enabled=true;
 set hive.vectorized.execution.ptf.enabled=true;
 set hive.fetch.task.conversion=none;
 
-CREATE TABLE vector_ptf_part_simple_text(p_mfgr string, p_name string, p_date date, p_retailprice double, rowindex int)
+CREATE TABLE vector_ptf_part_simple_text(p_mfgr string, p_name string, p_date date, p_retailprice double,
+  p_char char(1), p_varchar varchar(5), rowindex int)
         ROW FORMAT DELIMITED
         FIELDS TERMINATED BY ','
         STORED AS TEXTFILE;
 LOAD DATA LOCAL INPATH '../../data/files/vector_ptf_part_simple_all_datatypes.txt' OVERWRITE INTO TABLE vector_ptf_part_simple_text;
 
-CREATE TABLE vector_ptf_part_simple_orc (p_mfgr string, p_name string, p_date date, p_timestamp timestamp, 
-p_int int, p_retailprice double, p_decimal decimal(10,4), rowindex int) stored as orc;
+CREATE TABLE vector_ptf_part_simple_orc (p_mfgr string, p_name string, p_date date, p_timestamp timestamp,
+  p_int int, p_retailprice double, p_decimal decimal(10,4), p_char char(1), p_varchar varchar(5),rowindex int) stored
+as orc;
 
 SELECT * FROM vector_ptf_part_simple_text;
 
@@ -19,7 +21,9 @@ SELECT
 p_mfgr, p_name, p_date, 
 CAST(FROM_UNIXTIME(UNIX_TIMESTAMP(p_date)) as TIMESTAMP), 
 CAST(UNIX_TIMESTAMP(p_date) as int), p_retailprice, 
-CAST(p_retailprice as DECIMAL(10,4)), 
+CAST(p_retailprice as DECIMAL(10,4)),
+p_char,
+p_varchar,
 rowindex 
 FROM vector_ptf_part_simple_text;
 
@@ -628,3 +632,98 @@ count(*) over(partition by p_decimal) as cs,
 sum(p_retailprice) over(partition by p_decimal) as s
 from vector_ptf_part_simple_orc
 where p_decimal = 1800.7000;
+
+
+select "************ CHAR WINDOW RANGE TYPE ************";
+set hive.vectorized.execution.ptf.enabled=false;
+
+select "************ CHAR WINDOW RANGE TYPE (NON-VECTORIZED REFERENCE) ************";
+select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice, p_char,
+       count(*) over(partition by p_mfgr order by p_char range between 3 preceding and current row) as cs,
+       sum(p_retailprice) over(partition by p_mfgr order by p_char range between 3 preceding and current row) as s
+from vector_ptf_part_simple_orc;
+
+select "************ CHAR WINDOW RANGE TYPE (VECTORIZED) ************";
+set hive.vectorized.execution.ptf.enabled=true;
+
+EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_char,
+                                    count(*) over(partition by p_mfgr order by p_char range between 3 preceding and
+                                    current row) as cs,
+                                    sum(p_retailprice) over(partition by p_mfgr order by p_char range between 3 preceding and current row) as s
+from vector_ptf_part_simple_orc;
+
+select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_char,
+       count(*) over(partition by p_mfgr order by p_char range between 3 preceding and current row) as cs,
+       sum(p_retailprice) over(partition by p_mfgr order by p_char range between 3 preceding and current row) as s
+from vector_ptf_part_simple_orc;
+
+select "************ CHAR PARTITION ************";
+EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_char,
+                                    count(*) over(partition by p_char) as cs,
+                                    sum(p_retailprice) over(partition by p_char) as s
+from vector_ptf_part_simple_orc;
+
+select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_char,
+       count(*) over(partition by p_char) as cs,
+       sum(p_retailprice) over(partition by p_char) as s
+from vector_ptf_part_simple_orc;
+
+select "************ CHAR PARTITION WITH CONSTANT PARTITION EXPRESSION ************";
+EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_char,
+                                    count(*) over(partition by p_char) as cs,
+                                    sum(p_retailprice) over(partition by p_char) as s
+from vector_ptf_part_simple_orc
+where p_char = 'D';
+
+select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice, p_char,
+       count(*) over(partition by p_char) as cs,
+       sum(p_retailprice) over(partition by p_char) as s
+from vector_ptf_part_simple_orc
+where p_char = 'D';
+
+
+select "************ VARCHAR WINDOW RANGE TYPE ************";
+set hive.vectorized.execution.ptf.enabled=false;
+
+select "************ VARCHAR WINDOW RANGE TYPE (NON-VECTORIZED REFERENCE) ************";
+select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_varchar,
+       count(*) over(partition by p_mfgr order by p_varchar range between 3 preceding and current row) as cs,
+       sum(p_retailprice) over(partition by p_mfgr order by p_varchar range between 3 preceding and current row) as s
+from vector_ptf_part_simple_orc;
+
+select "************ VARCHAR WINDOW RANGE TYPE (VECTORIZED) ************";
+set hive.vectorized.execution.ptf.enabled=true;
+
+EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_varchar,
+                                    count(*) over(partition by p_mfgr order by p_varchar range between 3 preceding and current row) as cs,
+                                    sum(p_retailprice) over(partition by p_mfgr order by p_varchar range between 3 preceding and current row) as s
+from vector_ptf_part_simple_orc;
+
+select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_varchar,
+       count(*) over(partition by p_mfgr order by p_varchar range between 3 preceding and current row) as cs,
+       sum(p_retailprice) over(partition by p_mfgr order by p_varchar range between 3 preceding and current row) as s
+from vector_ptf_part_simple_orc;
+
+select "************ VARCHAR PARTITION ************";
+EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_varchar,
+                                    count(*) over(partition by p_varchar) as cs,
+                                    sum(p_retailprice) over(partition by p_varchar) as s
+from vector_ptf_part_simple_orc;
+
+select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_varchar,
+       count(*) over(partition by p_varchar) as cs,
+       sum(p_retailprice) over(partition by p_varchar) as s
+from vector_ptf_part_simple_orc;
+
+select "************ VARCHAR PARTITION WITH CONSTANT PARTITION EXPRESSION ************";
+select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_varchar,
+       count(*) over(partition by p_varchar) as cs,
+       sum(p_retailprice) over(partition by p_varchar) as s
+from vector_ptf_part_simple_orc
+where p_name = 'DA';
+
+EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice, p_varchar,
+                                    count(*) over(partition by p_varchar) as cs,
+                                    sum(p_retailprice) over(partition by p_varchar) as s
+from vector_ptf_part_simple_orc
+where p_varchar = 'DA';
\ No newline at end of file
diff --git a/ql/src/test/results/clientpositive/llap/vector_ptf_bounded_start.q.out b/ql/src/test/results/clientpositive/llap/vector_ptf_bounded_start.q.out
index a58a16ac6b..a851a8459e 100644
--- a/ql/src/test/results/clientpositive/llap/vector_ptf_bounded_start.q.out
+++ b/ql/src/test/results/clientpositive/llap/vector_ptf_bounded_start.q.out
@@ -1,11 +1,13 @@
-PREHOOK: query: CREATE TABLE vector_ptf_part_simple_text(p_mfgr string, p_name string, p_date date, p_retailprice double, rowindex int)
+PREHOOK: query: CREATE TABLE vector_ptf_part_simple_text(p_mfgr string, p_name string, p_date date, p_retailprice double,
+  p_char char(1), p_varchar varchar(5), rowindex int)
         ROW FORMAT DELIMITED
         FIELDS TERMINATED BY ','
         STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@vector_ptf_part_simple_text
-POSTHOOK: query: CREATE TABLE vector_ptf_part_simple_text(p_mfgr string, p_name string, p_date date, p_retailprice double, rowindex int)
+POSTHOOK: query: CREATE TABLE vector_ptf_part_simple_text(p_mfgr string, p_name string, p_date date, p_retailprice double,
+  p_char char(1), p_varchar varchar(5), rowindex int)
         ROW FORMAT DELIMITED
         FIELDS TERMINATED BY ','
         STORED AS TEXTFILE
@@ -20,13 +22,15 @@ POSTHOOK: query: LOAD DATA LOCAL INPATH '../../data/files/vector_ptf_part_simple
 POSTHOOK: type: LOAD
 #### A masked pattern was here ####
 POSTHOOK: Output: default@vector_ptf_part_simple_text
-PREHOOK: query: CREATE TABLE vector_ptf_part_simple_orc (p_mfgr string, p_name string, p_date date, p_timestamp timestamp, 
-p_int int, p_retailprice double, p_decimal decimal(10,4), rowindex int) stored as orc
+PREHOOK: query: CREATE TABLE vector_ptf_part_simple_orc (p_mfgr string, p_name string, p_date date, p_timestamp timestamp,
+  p_int int, p_retailprice double, p_decimal decimal(10,4), p_char char(1), p_varchar varchar(5),rowindex int) stored
+as orc
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@vector_ptf_part_simple_orc
-POSTHOOK: query: CREATE TABLE vector_ptf_part_simple_orc (p_mfgr string, p_name string, p_date date, p_timestamp timestamp, 
-p_int int, p_retailprice double, p_decimal decimal(10,4), rowindex int) stored as orc
+POSTHOOK: query: CREATE TABLE vector_ptf_part_simple_orc (p_mfgr string, p_name string, p_date date, p_timestamp timestamp,
+  p_int int, p_retailprice double, p_decimal decimal(10,4), p_char char(1), p_varchar varchar(5),rowindex int) stored
+as orc
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@vector_ptf_part_simple_orc
@@ -38,53 +42,55 @@ POSTHOOK: query: SELECT * FROM vector_ptf_part_simple_text
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@vector_ptf_part_simple_text
 #### A masked pattern was here ####
-vector_ptf_part_simple_text.p_mfgr	vector_ptf_part_simple_text.p_name	vector_ptf_part_simple_text.p_date	vector_ptf_part_simple_text.p_retailprice	vector_ptf_part_simple_text.rowindex
-Manufacturer#2	almond aquamarine rose maroon antique	NULL	900.66	1
-Manufacturer#1	almond aquamarine burnished black steel	1970-01-02	1414.42	2
-Manufacturer#2	almond aquamarine rose maroon antique	1970-01-03	1698.66	3
-Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04	NULL	4
-Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05	1753.76	5
-Manufacturer#5	almond antique medium spring khaki	1970-01-01	1611.66	6
-Manufacturer#5	almond antique blue firebrick mint	NULL	1789.69	7
-Manufacturer#1	almond antique burnished rose metallic	1970-01-03	1173.15	8
-Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04	1632.66	9
-Manufacturer#3	almond antique forest lavender goldenrod	1970-01-05	1190.27	10
-Manufacturer#4	almond aquamarine yellow dodger mint	1970-01-01	1844.92	11
-Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-02	1753.76	12
-Manufacturer#2	almond antique violet turquoise frosted	NULL	1800.7	13
-Manufacturer#3	almond antique forest lavender goldenrod	1970-01-04	NULL	14
-Manufacturer#2	almond antique violet chocolate turquoise	1970-01-05	1690.68	15
-Manufacturer#4	almond antique violet mint lemon	1970-01-01	1375.42	16
-Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-02	1632.66	17
-Manufacturer#5	almond azure blanched chiffon midnight	1970-01-03	1464.48	18
-Manufacturer#3	almond antique forest lavender goldenrod	NULL	590.27	19
-Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05	1753.76	20
-Manufacturer#2	almond antique violet turquoise frosted	1970-01-01	1800.7	21
-Manufacturer#5	almond antique sky peru orange	1970-01-02	1788.73	22
-Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-03	1632.66	23
-Manufacturer#3	almond antique chartreuse khaki white	1970-01-04	99.68	24
-Manufacturer#4	almond antique gainsboro frosted violet	NULL	NULL	25
-Manufacturer#1	almond antique chartreuse lavender yellow	NULL	1753.76	26
-Manufacturer#2	almond antique violet turquoise frosted	1970-01-02	1800.7	27
-Manufacturer#3	almond antique olive coral navajo	1970-01-03	1337.29	28
-Manufacturer#5	almond antique medium spring khaki	1970-01-04	1611.66	29
-Manufacturer#1	almond antique salmon chartreuse burlywood	1970-01-05	1602.59	30
-Manufacturer#3	almond antique misty red olive	1970-01-01	1922.98	31
-Manufacturer#2	almond aquamarine sandy cyan gainsboro	NULL	1000.6	32
-Manufacturer#3	almond antique forest lavender goldenrod	1970-01-03	1190.27	33
-Manufacturer#2	almond aquamarine midnight light salmon	1970-01-04	2031.98	34
-Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05	NULL	35
-Manufacturer#5	almond aquamarine dodger light gainsboro	1970-01-01	1018.1	36
-Manufacturer#4	almond azure aquamarine papaya violet	1970-01-02	1290.35	37
-Manufacturer#3	almond antique metallic orange dim	NULL	55.39	38
-Manufacturer#1	almond antique burnished rose metallic	1970-01-04	1173.15	39
-Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05	1206.26	40
+vector_ptf_part_simple_text.p_mfgr	vector_ptf_part_simple_text.p_name	vector_ptf_part_simple_text.p_date	vector_ptf_part_simple_text.p_retailprice	vector_ptf_part_simple_text.p_char	vector_ptf_part_simple_text.p_varchar	vector_ptf_part_simple_text.rowindex
+Manufacturer#2	almond aquamarine rose maroon antique	NULL	900.66	A	DA	1
+Manufacturer#1	almond aquamarine burnished black steel	1970-01-02	1414.42	B	AB	2
+Manufacturer#2	almond aquamarine rose maroon antique	1970-01-03	1698.66	C	CA	3
+Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04	NULL	A	DE	4
+Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05	1753.76	B	AC	5
+Manufacturer#5	almond antique medium spring khaki	1970-01-01	1611.66	C	AA	6
+Manufacturer#5	almond antique blue firebrick mint	NULL	1789.69	D	FD	7
+Manufacturer#1	almond antique burnished rose metallic	1970-01-03	1173.15	A	SM	8
+Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04	1632.66	B	AK	9
+Manufacturer#3	almond antique forest lavender goldenrod	1970-01-05	1190.27	C	AY	10
+Manufacturer#4	almond aquamarine yellow dodger mint	1970-01-01	1844.92	D	FD	11
+Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-02	1753.76	D	DA	12
+Manufacturer#2	almond antique violet turquoise frosted	NULL	1800.7	B	AC	13
+Manufacturer#3	almond antique forest lavender goldenrod	1970-01-04	NULL	C	BB	14
+Manufacturer#2	almond antique violet chocolate turquoise	1970-01-05	1690.68	D	LM	15
+Manufacturer#4	almond antique violet mint lemon	1970-01-01	1375.42	B	OP	16
+Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-02	1632.66	D	RS	17
+Manufacturer#5	almond azure blanched chiffon midnight	1970-01-03	1464.48	C	AB	18
+Manufacturer#3	almond antique forest lavender goldenrod	NULL	590.27	D	CD	19
+Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05	1753.76	A	EF	20
+Manufacturer#2	almond antique violet turquoise frosted	1970-01-01	1800.7	B	AA	21
+Manufacturer#5	almond antique sky peru orange	1970-01-02	1788.73	A	BB	22
+Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-03	1632.66	D	CC	23
+Manufacturer#3	almond antique chartreuse khaki white	1970-01-04	99.68	C	DD	24
+Manufacturer#4	almond antique gainsboro frosted violet	NULL	NULL	A	EE	25
+Manufacturer#1	almond antique chartreuse lavender yellow	NULL	1753.76	C	AD	26
+Manufacturer#2	almond antique violet turquoise frosted	1970-01-02	1800.7	D	AB	27
+Manufacturer#3	almond antique olive coral navajo	1970-01-03	1337.29	A	AC	28
+Manufacturer#5	almond antique medium spring khaki	1970-01-04	1611.66	B	AA	29
+Manufacturer#1	almond antique salmon chartreuse burlywood	1970-01-05	1602.59	C	BB	30
+Manufacturer#3	almond antique misty red olive	1970-01-01	1922.98	D	BC	31
+Manufacturer#2	almond aquamarine sandy cyan gainsboro	NULL	1000.6	A	BD	32
+Manufacturer#3	almond antique forest lavender goldenrod	1970-01-03	1190.27	B	CA	33
+Manufacturer#2	almond aquamarine midnight light salmon	1970-01-04	2031.98	C	CB	34
+Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05	NULL	A	CC	35
+Manufacturer#5	almond aquamarine dodger light gainsboro	1970-01-01	1018.1	B	CD	36
+Manufacturer#4	almond azure aquamarine papaya violet	1970-01-02	1290.35	C	DA	37
+Manufacturer#3	almond antique metallic orange dim	NULL	55.39	D	DB	38
+Manufacturer#1	almond antique burnished rose metallic	1970-01-04	1173.15	D	DC	39
+Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05	1206.26	C	DD	40
 PREHOOK: query: INSERT INTO TABLE vector_ptf_part_simple_orc 
 SELECT 
 p_mfgr, p_name, p_date, 
 CAST(FROM_UNIXTIME(UNIX_TIMESTAMP(p_date)) as TIMESTAMP), 
 CAST(UNIX_TIMESTAMP(p_date) as int), p_retailprice, 
-CAST(p_retailprice as DECIMAL(10,4)), 
+CAST(p_retailprice as DECIMAL(10,4)),
+p_char,
+p_varchar,
 rowindex 
 FROM vector_ptf_part_simple_text
 PREHOOK: type: QUERY
@@ -95,12 +101,15 @@ SELECT
 p_mfgr, p_name, p_date, 
 CAST(FROM_UNIXTIME(UNIX_TIMESTAMP(p_date)) as TIMESTAMP), 
 CAST(UNIX_TIMESTAMP(p_date) as int), p_retailprice, 
-CAST(p_retailprice as DECIMAL(10,4)), 
+CAST(p_retailprice as DECIMAL(10,4)),
+p_char,
+p_varchar,
 rowindex 
 FROM vector_ptf_part_simple_text
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@vector_ptf_part_simple_text
 POSTHOOK: Output: default@vector_ptf_part_simple_orc
+POSTHOOK: Lineage: vector_ptf_part_simple_orc.p_char SIMPLE [(vector_ptf_part_simple_text)vector_ptf_part_simple_text.FieldSchema(name:p_char, type:char(1), comment:null), ]
 POSTHOOK: Lineage: vector_ptf_part_simple_orc.p_date SIMPLE [(vector_ptf_part_simple_text)vector_ptf_part_simple_text.FieldSchema(name:p_date, type:date, comment:null), ]
 POSTHOOK: Lineage: vector_ptf_part_simple_orc.p_decimal EXPRESSION [(vector_ptf_part_simple_text)vector_ptf_part_simple_text.FieldSchema(name:p_retailprice, type:double, comment:null), ]
 POSTHOOK: Lineage: vector_ptf_part_simple_orc.p_int EXPRESSION [(vector_ptf_part_simple_text)vector_ptf_part_simple_text.FieldSchema(name:p_date, type:date, comment:null), ]
@@ -108,8 +117,9 @@ POSTHOOK: Lineage: vector_ptf_part_simple_orc.p_mfgr SIMPLE [(vector_ptf_part_si
 POSTHOOK: Lineage: vector_ptf_part_simple_orc.p_name SIMPLE [(vector_ptf_part_simple_text)vector_ptf_part_simple_text.FieldSchema(name:p_name, type:string, comment:null), ]
 POSTHOOK: Lineage: vector_ptf_part_simple_orc.p_retailprice SIMPLE [(vector_ptf_part_simple_text)vector_ptf_part_simple_text.FieldSchema(name:p_retailprice, type:double, comment:null), ]
 POSTHOOK: Lineage: vector_ptf_part_simple_orc.p_timestamp EXPRESSION [(vector_ptf_part_simple_text)vector_ptf_part_simple_text.FieldSchema(name:p_date, type:date, comment:null), ]
+POSTHOOK: Lineage: vector_ptf_part_simple_orc.p_varchar SIMPLE [(vector_ptf_part_simple_text)vector_ptf_part_simple_text.FieldSchema(name:p_varchar, type:varchar(5), comment:null), ]
 POSTHOOK: Lineage: vector_ptf_part_simple_orc.rowindex SIMPLE [(vector_ptf_part_simple_text)vector_ptf_part_simple_text.FieldSchema(name:rowindex, type:int, comment:null), ]
-p_mfgr	p_name	p_date	_c3	_c4	p_retailprice	_c6	rowindex
+p_mfgr	p_name	p_date	_c3	_c4	p_retailprice	_c6	p_char	p_varchar	rowindex
 PREHOOK: query: SELECT * FROM vector_ptf_part_simple_orc
 PREHOOK: type: QUERY
 PREHOOK: Input: default@vector_ptf_part_simple_orc
@@ -118,47 +128,47 @@ POSTHOOK: query: SELECT * FROM vector_ptf_part_simple_orc
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@vector_ptf_part_simple_orc
 #### A masked pattern was here ####
-vector_ptf_part_simple_orc.p_mfgr	vector_ptf_part_simple_orc.p_name	vector_ptf_part_simple_orc.p_date	vector_ptf_part_simple_orc.p_timestamp	vector_ptf_part_simple_orc.p_int	vector_ptf_part_simple_orc.p_retailprice	vector_ptf_part_simple_orc.p_decimal	vector_ptf_part_simple_orc.rowindex
-Manufacturer#2	almond aquamarine rose maroon antique	NULL	NULL	NULL	900.66	900.6600	1
-Manufacturer#1	almond aquamarine burnished black steel	1970-01-02	1970-01-02 00:00:00	115200	1414.42	1414.4200	2
-Manufacturer#2	almond aquamarine rose maroon antique	1970-01-03	1970-01-03 00:00:00	201600	1698.66	1698.6600	3
-Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04	1970-01-04 00:00:00	288000	NULL	NULL	4
-Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05	1970-01-05 00:00:00	374400	1753.76	1753.7600	5
-Manufacturer#5	almond antique medium spring khaki	1970-01-01	1970-01-01 00:00:00	28800	1611.66	1611.6600	6
-Manufacturer#5	almond antique blue firebrick mint	NULL	NULL	NULL	1789.69	1789.6900	7
-Manufacturer#1	almond antique burnished rose metallic	1970-01-03	1970-01-03 00:00:00	201600	1173.15	1173.1500	8
-Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04	1970-01-04 00:00:00	288000	1632.66	1632.6600	9
-Manufacturer#3	almond antique forest lavender goldenrod	1970-01-05	1970-01-05 00:00:00	374400	1190.27	1190.2700	10
-Manufacturer#4	almond aquamarine yellow dodger mint	1970-01-01	1970-01-01 00:00:00	28800	1844.92	1844.9200	11
-Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-02	1970-01-02 00:00:00	115200	1753.76	1753.7600	12
-Manufacturer#2	almond antique violet turquoise frosted	NULL	NULL	NULL	1800.7	1800.7000	13
-Manufacturer#3	almond antique forest lavender goldenrod	1970-01-04	1970-01-04 00:00:00	288000	NULL	NULL	14
-Manufacturer#2	almond antique violet chocolate turquoise	1970-01-05	1970-01-05 00:00:00	374400	1690.68	1690.6800	15
-Manufacturer#4	almond antique violet mint lemon	1970-01-01	1970-01-01 00:00:00	28800	1375.42	1375.4200	16
-Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-02	1970-01-02 00:00:00	115200	1632.66	1632.6600	17
-Manufacturer#5	almond azure blanched chiffon midnight	1970-01-03	1970-01-03 00:00:00	201600	1464.48	1464.4800	18
-Manufacturer#3	almond antique forest lavender goldenrod	NULL	NULL	NULL	590.27	590.2700	19
-Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05	1970-01-05 00:00:00	374400	1753.76	1753.7600	20
-Manufacturer#2	almond antique violet turquoise frosted	1970-01-01	1970-01-01 00:00:00	28800	1800.7	1800.7000	21
-Manufacturer#5	almond antique sky peru orange	1970-01-02	1970-01-02 00:00:00	115200	1788.73	1788.7300	22
-Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-03	1970-01-03 00:00:00	201600	1632.66	1632.6600	23
-Manufacturer#3	almond antique chartreuse khaki white	1970-01-04	1970-01-04 00:00:00	288000	99.68	99.6800	24
-Manufacturer#4	almond antique gainsboro frosted violet	NULL	NULL	NULL	NULL	NULL	25
-Manufacturer#1	almond antique chartreuse lavender yellow	NULL	NULL	NULL	1753.76	1753.7600	26
-Manufacturer#2	almond antique violet turquoise frosted	1970-01-02	1970-01-02 00:00:00	115200	1800.7	1800.7000	27
-Manufacturer#3	almond antique olive coral navajo	1970-01-03	1970-01-03 00:00:00	201600	1337.29	1337.2900	28
-Manufacturer#5	almond antique medium spring khaki	1970-01-04	1970-01-04 00:00:00	288000	1611.66	1611.6600	29
-Manufacturer#1	almond antique salmon chartreuse burlywood	1970-01-05	1970-01-05 00:00:00	374400	1602.59	1602.5900	30
-Manufacturer#3	almond antique misty red olive	1970-01-01	1970-01-01 00:00:00	28800	1922.98	1922.9800	31
-Manufacturer#2	almond aquamarine sandy cyan gainsboro	NULL	NULL	NULL	1000.6	1000.6000	32
-Manufacturer#3	almond antique forest lavender goldenrod	1970-01-03	1970-01-03 00:00:00	201600	1190.27	1190.2700	33
-Manufacturer#2	almond aquamarine midnight light salmon	1970-01-04	1970-01-04 00:00:00	288000	2031.98	2031.9800	34
-Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05	1970-01-05 00:00:00	374400	NULL	NULL	35
-Manufacturer#5	almond aquamarine dodger light gainsboro	1970-01-01	1970-01-01 00:00:00	28800	1018.1	1018.1000	36
-Manufacturer#4	almond azure aquamarine papaya violet	1970-01-02	1970-01-02 00:00:00	115200	1290.35	1290.3500	37
-Manufacturer#3	almond antique metallic orange dim	NULL	NULL	NULL	55.39	55.3900	38
-Manufacturer#1	almond antique burnished rose metallic	1970-01-04	1970-01-04 00:00:00	288000	1173.15	1173.1500	39
-Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05	1970-01-05 00:00:00	374400	1206.26	1206.2600	40
+vector_ptf_part_simple_orc.p_mfgr	vector_ptf_part_simple_orc.p_name	vector_ptf_part_simple_orc.p_date	vector_ptf_part_simple_orc.p_timestamp	vector_ptf_part_simple_orc.p_int	vector_ptf_part_simple_orc.p_retailprice	vector_ptf_part_simple_orc.p_decimal	vector_ptf_part_simple_orc.p_char	vector_ptf_part_simple_orc.p_varchar	vector_ptf_part_simple_orc.rowindex
+Manufacturer#2	almond aquamarine rose maroon antique	NULL	NULL	NULL	900.66	900.6600	A	DA	1
+Manufacturer#1	almond aquamarine burnished black steel	1970-01-02	1970-01-02 00:00:00	115200	1414.42	1414.4200	B	AB	2
+Manufacturer#2	almond aquamarine rose maroon antique	1970-01-03	1970-01-03 00:00:00	201600	1698.66	1698.6600	C	CA	3
+Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04	1970-01-04 00:00:00	288000	NULL	NULL	A	DE	4
+Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05	1970-01-05 00:00:00	374400	1753.76	1753.7600	B	AC	5
+Manufacturer#5	almond antique medium spring khaki	1970-01-01	1970-01-01 00:00:00	28800	1611.66	1611.6600	C	AA	6
+Manufacturer#5	almond antique blue firebrick mint	NULL	NULL	NULL	1789.69	1789.6900	D	FD	7
+Manufacturer#1	almond antique burnished rose metallic	1970-01-03	1970-01-03 00:00:00	201600	1173.15	1173.1500	A	SM	8
+Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04	1970-01-04 00:00:00	288000	1632.66	1632.6600	B	AK	9
+Manufacturer#3	almond antique forest lavender goldenrod	1970-01-05	1970-01-05 00:00:00	374400	1190.27	1190.2700	C	AY	10
+Manufacturer#4	almond aquamarine yellow dodger mint	1970-01-01	1970-01-01 00:00:00	28800	1844.92	1844.9200	D	FD	11
+Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-02	1970-01-02 00:00:00	115200	1753.76	1753.7600	D	DA	12
+Manufacturer#2	almond antique violet turquoise frosted	NULL	NULL	NULL	1800.7	1800.7000	B	AC	13
+Manufacturer#3	almond antique forest lavender goldenrod	1970-01-04	1970-01-04 00:00:00	288000	NULL	NULL	C	BB	14
+Manufacturer#2	almond antique violet chocolate turquoise	1970-01-05	1970-01-05 00:00:00	374400	1690.68	1690.6800	D	LM	15
+Manufacturer#4	almond antique violet mint lemon	1970-01-01	1970-01-01 00:00:00	28800	1375.42	1375.4200	B	OP	16
+Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-02	1970-01-02 00:00:00	115200	1632.66	1632.6600	D	RS	17
+Manufacturer#5	almond azure blanched chiffon midnight	1970-01-03	1970-01-03 00:00:00	201600	1464.48	1464.4800	C	AB	18
+Manufacturer#3	almond antique forest lavender goldenrod	NULL	NULL	NULL	590.27	590.2700	D	CD	19
+Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05	1970-01-05 00:00:00	374400	1753.76	1753.7600	A	EF	20
+Manufacturer#2	almond antique violet turquoise frosted	1970-01-01	1970-01-01 00:00:00	28800	1800.7	1800.7000	B	AA	21
+Manufacturer#5	almond antique sky peru orange	1970-01-02	1970-01-02 00:00:00	115200	1788.73	1788.7300	A	BB	22
+Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-03	1970-01-03 00:00:00	201600	1632.66	1632.6600	D	CC	23
+Manufacturer#3	almond antique chartreuse khaki white	1970-01-04	1970-01-04 00:00:00	288000	99.68	99.6800	C	DD	24
+Manufacturer#4	almond antique gainsboro frosted violet	NULL	NULL	NULL	NULL	NULL	A	EE	25
+Manufacturer#1	almond antique chartreuse lavender yellow	NULL	NULL	NULL	1753.76	1753.7600	C	AD	26
+Manufacturer#2	almond antique violet turquoise frosted	1970-01-02	1970-01-02 00:00:00	115200	1800.7	1800.7000	D	AB	27
+Manufacturer#3	almond antique olive coral navajo	1970-01-03	1970-01-03 00:00:00	201600	1337.29	1337.2900	A	AC	28
+Manufacturer#5	almond antique medium spring khaki	1970-01-04	1970-01-04 00:00:00	288000	1611.66	1611.6600	B	AA	29
+Manufacturer#1	almond antique salmon chartreuse burlywood	1970-01-05	1970-01-05 00:00:00	374400	1602.59	1602.5900	C	BB	30
+Manufacturer#3	almond antique misty red olive	1970-01-01	1970-01-01 00:00:00	28800	1922.98	1922.9800	D	BC	31
+Manufacturer#2	almond aquamarine sandy cyan gainsboro	NULL	NULL	NULL	1000.6	1000.6000	A	BD	32
+Manufacturer#3	almond antique forest lavender goldenrod	1970-01-03	1970-01-03 00:00:00	201600	1190.27	1190.2700	B	CA	33
+Manufacturer#2	almond aquamarine midnight light salmon	1970-01-04	1970-01-04 00:00:00	288000	2031.98	2031.9800	C	CB	34
+Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05	1970-01-05 00:00:00	374400	NULL	NULL	A	CC	35
+Manufacturer#5	almond aquamarine dodger light gainsboro	1970-01-01	1970-01-01 00:00:00	28800	1018.1	1018.1000	B	CD	36
+Manufacturer#4	almond azure aquamarine papaya violet	1970-01-02	1970-01-02 00:00:00	115200	1290.35	1290.3500	C	DA	37
+Manufacturer#3	almond antique metallic orange dim	NULL	NULL	NULL	55.39	55.3900	D	DB	38
+Manufacturer#1	almond antique burnished rose metallic	1970-01-04	1970-01-04 00:00:00	288000	1173.15	1173.1500	D	DC	39
+Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05	1970-01-05 00:00:00	374400	1206.26	1206.2600	C	DD	40
 PREHOOK: query: select "************ NON_VECTORIZED REFERENCE ************"
 PREHOOK: type: QUERY
 PREHOOK: Input: _dummy_database@_dummy_table
@@ -346,7 +356,7 @@ STAGE PLANS:
                   Statistics: Num rows: 40 Data size: 11104 Basic stats: COMPLETE Column stats: COMPLETE
                   TableScan Vectorization:
                       native: true
-                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:rowindex:int, 8:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 9:ROW__IS__DELETED:boolean]
+                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:p_char:char(1), 8:p_varchar:varchar(5), 9:rowindex:int, 10:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 11:ROW__IS__DELETED:boolean]
                   Reduce Output Operator
                     key expressions: p_mfgr (type: string), p_date (type: date)
                     null sort order: az
@@ -358,7 +368,7 @@ STAGE PLANS:
                         native: true
                         nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez, spark] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
                         partitionColumns: 0:string
-                        valueColumns: 1:string, 5:double, 7:int
+                        valueColumns: 1:string, 5:double, 9:int
                     Statistics: Num rows: 40 Data size: 11104 Basic stats: COMPLETE Column stats: COMPLETE
                     value expressions: p_name (type: string), p_retailprice (type: double), rowindex (type: int)
             Execution mode: vectorized, llap
@@ -373,9 +383,9 @@ STAGE PLANS:
                 usesVectorUDFAdaptor: false
                 vectorized: true
                 rowBatchContext:
-                    dataColumnCount: 8
-                    includeColumns: [0, 1, 2, 5, 7]
-                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, rowindex:int
+                    dataColumnCount: 10
+                    includeColumns: [0, 1, 2, 5, 9]
+                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, p_char:char(1), p_varchar:varchar(5), rowindex:int
                     partitionColumnCount: 0
                     scratchColumnTypeNames: []
         Reducer 2 
@@ -390,13 +400,13 @@ STAGE PLANS:
                 vectorized: true
                 rowBatchContext:
                     dataColumnCount: 5
-                    dataColumns: KEY.reducesinkkey0:string, KEY.reducesinkkey1:date, VALUE._col0:string, VALUE._col3:double, VALUE._col5:int
+                    dataColumns: KEY.reducesinkkey0:string, KEY.reducesinkkey1:date, VALUE._col0:string, VALUE._col3:double, VALUE._col7:int
                     partitionColumnCount: 0
                     scratchColumnTypeNames: [bigint, bigint, bigint, bigint, bigint, double, double, double, double, double, double, double, double, bigint, bigint]
             Reduce Operator Tree:
               Select Operator
-                expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string), KEY.reducesinkkey1 (type: date), VALUE._col3 (type: double), VALUE._col5 (type: int)
-                outputColumnNames: _col0, _col1, _col2, _col5, _col7
+                expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string), KEY.reducesinkkey1 (type: date), VALUE._col3 (type: double), VALUE._col7 (type: int)
+                outputColumnNames: _col0, _col1, _col2, _col5, _col9
                 Select Vectorization:
                     className: VectorSelectOperator
                     native: true
@@ -406,7 +416,7 @@ STAGE PLANS:
                   Function definitions:
                       Input definition
                         input alias: ptf_0
-                        output shape: _col0: string, _col1: string, _col2: date, _col5: double, _col7: int
+                        output shape: _col0: string, _col1: string, _col2: date, _col5: double, _col9: int
                         type: WINDOWING
                       Windowing table definition
                         input alias: ptf_1
@@ -429,13 +439,13 @@ STAGE PLANS:
                               isStar: true
                             window function definition
                               alias: count_window_2
-                              arguments: _col7
+                              arguments: _col9
                               name: count
                               window function: GenericUDAFCountEvaluator
                               window frame: RANGE PRECEDING(1)~CURRENT
                             window function definition
                               alias: count_window_3
-                              arguments: _col7
+                              arguments: _col9
                               name: count
                               window function: GenericUDAFCountEvaluator
                               window frame: RANGE PRECEDING(3)~CURRENT
@@ -523,8 +533,8 @@ STAGE PLANS:
                       streamingColumns: [18, 19]
                   Statistics: Num rows: 40 Data size: 11104 Basic stats: COMPLETE Column stats: COMPLETE
                   Select Operator
-                    expressions: count_window_0 (type: bigint), count_window_1 (type: bigint), count_window_2 (type: bigint), count_window_3 (type: bigint), count_window_4 (type: bigint), sum_window_5 (type: double), sum_window_6 (type: double), min_window_7 (type: double), min_window_8 (type: double), max_window_9 (type: double), max_window_10 (type: double), avg_window_11 (type: double), avg_window_12 (type: double), rank_window_16 (type: int), dense_rank_window_17 (type: int), _col0 (type: string), _col1 (type: string), _col2 (type: date), _col5 (type: double), _col7 (type: int)
-                    outputColumnNames: count_window_0, count_window_1, count_window_2, count_window_3, count_window_4, sum_window_5, sum_window_6, min_window_7, min_window_8, max_window_9, max_window_10, avg_window_11, avg_window_12, rank_window_16, dense_rank_window_17, _col0, _col1, _col2, _col5, _col7
+                    expressions: count_window_0 (type: bigint), count_window_1 (type: bigint), count_window_2 (type: bigint), count_window_3 (type: bigint), count_window_4 (type: bigint), sum_window_5 (type: double), sum_window_6 (type: double), min_window_7 (type: double), min_window_8 (type: double), max_window_9 (type: double), max_window_10 (type: double), avg_window_11 (type: double), avg_window_12 (type: double), rank_window_16 (type: int), dense_rank_window_17 (type: int), _col0 (type: string), _col1 (type: string), _col2 (type: date), _col5 (type: double), _col9 (type: int)
+                    outputColumnNames: count_window_0, count_window_1, count_window_2, count_window_3, count_window_4, sum_window_5, sum_window_6, min_window_7, min_window_8, max_window_9, max_window_10, avg_window_11, avg_window_12, rank_window_16, dense_rank_window_17, _col0, _col1, _col2, _col5, _col9
                     Select Vectorization:
                         className: VectorSelectOperator
                         native: true
@@ -542,7 +552,7 @@ STAGE PLANS:
                           nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez, spark] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
                           valueColumns: 5:bigint, 6:bigint, 7:bigint, 8:bigint, 9:bigint, 10:double, 11:double, 12:double, 13:double, 14:double, 15:double, 16:double, 17:double, 18:int, 19:int, 2:string, 1:date, 3:double, 4:int
                       Statistics: Num rows: 40 Data size: 11104 Basic stats: COMPLETE Column stats: COMPLETE
-                      value expressions: count_window_0 (type: bigint), count_window_1 (type: bigint), count_window_2 (type: bigint), count_window_3 (type: bigint), count_window_4 (type: bigint), sum_window_5 (type: double), sum_window_6 (type: double), min_window_7 (type: double), min_window_8 (type: double), max_window_9 (type: double), max_window_10 (type: double), avg_window_11 (type: double), avg_window_12 (type: double), rank_window_16 (type: int), dense_rank_window_17 (type: int), _col1 (type: string), _col2 (type: date), _col5 (type: double), _col7 (type: int)
+                      value expressions: count_window_0 (type: bigint), count_window_1 (type: bigint), count_window_2 (type: bigint), count_window_3 (type: bigint), count_window_4 (type: bigint), sum_window_5 (type: double), sum_window_6 (type: double), min_window_7 (type: double), min_window_8 (type: double), max_window_9 (type: double), max_window_10 (type: double), avg_window_11 (type: double), avg_window_12 (type: double), rank_window_16 (type: int), dense_rank_window_17 (type: int), _col1 (type: string), _col2 (type: date), _col5 (type: double), _col9 (type: int)
         Reducer 3 
             Execution mode: vectorized, llap
             Reduce Vectorization:
@@ -555,13 +565,13 @@ STAGE PLANS:
                 vectorized: true
                 rowBatchContext:
                     dataColumnCount: 20
-                    dataColumns: KEY.reducesinkkey0:string, VALUE._col0:bigint, VALUE._col1:bigint, VALUE._col2:bigint, VALUE._col3:bigint, VALUE._col4:bigint, VALUE._col5:double, VALUE._col6:double, VALUE._col7:double, VALUE._col8:double, VALUE._col9:double, VALUE._col10:double, VALUE._col11:double, VALUE._col12:double, VALUE._col13:int, VALUE._col14:int, VALUE._col15:string, VALUE._col16:date, VALUE._col19:double, VALUE._col21:int
+                    dataColumns: KEY.reducesinkkey0:string, VALUE._col0:bigint, VALUE._col1:bigint, VALUE._col2:bigint, VALUE._col3:bigint, VALUE._col4:bigint, VALUE._col5:double, VALUE._col6:double, VALUE._col7:double, VALUE._col8:double, VALUE._col9:double, VALUE._col10:double, VALUE._col11:double, VALUE._col12:double, VALUE._col13:int, VALUE._col14:int, VALUE._col15:string, VALUE._col16:date, VALUE._col19:double, VALUE._col23:int
                     partitionColumnCount: 0
                     scratchColumnTypeNames: [bigint, bigint, bigint, double, double, double]
             Reduce Operator Tree:
               Select Operator
-                expressions: VALUE._col0 (type: bigint), VALUE._col1 (type: bigint), VALUE._col2 (type: bigint), VALUE._col3 (type: bigint), VALUE._col4 (type: bigint), VALUE._col5 (type: double), VALUE._col6 (type: double), VALUE._col7 (type: double), VALUE._col8 (type: double), VALUE._col9 (type: double), VALUE._col10 (type: double), VALUE._col11 (type: double), VALUE._col12 (type: double), VALUE._col13 (type: int), VALUE._col14 (type: int), KEY.reducesinkkey0 (type: string), VALUE._col15 (type: string), VALUE._col16 (type: date), VALUE._col19 (type: double), VALUE._col21 (type: int)
-                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col20, _col22
+                expressions: VALUE._col0 (type: bigint), VALUE._col1 (type: bigint), VALUE._col2 (type: bigint), VALUE._col3 (type: bigint), VALUE._col4 (type: bigint), VALUE._col5 (type: double), VALUE._col6 (type: double), VALUE._col7 (type: double), VALUE._col8 (type: double), VALUE._col9 (type: double), VALUE._col10 (type: double), VALUE._col11 (type: double), VALUE._col12 (type: double), VALUE._col13 (type: int), VALUE._col14 (type: int), KEY.reducesinkkey0 (type: string), VALUE._col15 (type: string), VALUE._col16 (type: date), VALUE._col19 (type: double), VALUE._col23 (type: int)
+                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col20, _col24
                 Select Vectorization:
                     className: VectorSelectOperator
                     native: true
@@ -571,7 +581,7 @@ STAGE PLANS:
                   Function definitions:
                       Input definition
                         input alias: ptf_0
-                        output shape: _col0: bigint, _col1: bigint, _col2: bigint, _col3: bigint, _col4: bigint, _col5: double, _col6: double, _col7: double, _col8: double, _col9: double, _col10: double, _col11: double, _col12: double, _col13: int, _col14: int, _col15: string, _col16: string, _col17: date, _col20: double, _col22: int
+                        output shape: _col0: bigint, _col1: bigint, _col2: bigint, _col3: bigint, _col4: bigint, _col5: double, _col6: double, _col7: double, _col8: double, _col9: double, _col10: double, _col11: double, _col12: double, _col13: int, _col14: int, _col15: string, _col16: string, _col17: date, _col20: double, _col24: int
                         type: WINDOWING
                       Windowing table definition
                         input alias: ptf_1
@@ -636,8 +646,8 @@ STAGE PLANS:
                       streamingColumns: [20, 21, 22, 23]
                   Statistics: Num rows: 40 Data size: 15104 Basic stats: COMPLETE Column stats: COMPLETE
                   Select Operator
-                    expressions: row_number_window_13 (type: int), rank_window_14 (type: int), dense_rank_window_15 (type: int), first_value_window_18 (type: double), lead_window_20 (type: double), lag_window_21 (type: double), _col0 (type: bigint), _col1 (type: bigint), _col2 (type: bigint), _col3 (type: bigint), _col4 (type: bigint), _col5 (type: double), _col6 (type: double), _col7 (type: double), _col8 (type: double), _col9 (type: double), _col10 (type: double), _col11 (type: double), _col12 (type: double), _col13 (type: int), _col14 (type: int), _col15 (type: string), _col16 (type: string), _col17 (type: date), _col20 (type: double), _col22 (type: int)
-                    outputColumnNames: row_number_window_13, rank_window_14, dense_rank_window_15, first_value_window_18, lead_window_20, lag_window_21, _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col20, _col22
+                    expressions: row_number_window_13 (type: int), rank_window_14 (type: int), dense_rank_window_15 (type: int), first_value_window_18 (type: double), lead_window_20 (type: double), lag_window_21 (type: double), _col0 (type: bigint), _col1 (type: bigint), _col2 (type: bigint), _col3 (type: bigint), _col4 (type: bigint), _col5 (type: double), _col6 (type: double), _col7 (type: double), _col8 (type: double), _col9 (type: double), _col10 (type: double), _col11 (type: double), _col12 (type: double), _col13 (type: int), _col14 (type: int), _col15 (type: string), _col16 (type: string), _col17 (type: date), _col20 (type: double), _col24 (type: int)
+                    outputColumnNames: row_number_window_13, rank_window_14, dense_rank_window_15, first_value_window_18, lead_window_20, lag_window_21, _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col20, _col24
                     Select Vectorization:
                         className: VectorSelectOperator
                         native: true
@@ -655,7 +665,7 @@ STAGE PLANS:
                           nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez, spark] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
                           valueColumns: 20:int, 21:int, 22:int, 23:double, 24:double, 25:double, 1:bigint, 2:bigint, 3:bigint, 4:bigint, 5:bigint, 6:double, 7:double, 8:double, 9:double, 10:double, 11:double, 12:double, 13:double, 14:int, 15:int, 16:string, 17:date, 18:double, 19:int
                       Statistics: Num rows: 40 Data size: 15104 Basic stats: COMPLETE Column stats: COMPLETE
-                      value expressions: row_number_window_13 (type: int), rank_window_14 (type: int), dense_rank_window_15 (type: int), first_value_window_18 (type: double), lead_window_20 (type: double), lag_window_21 (type: double), _col0 (type: bigint), _col1 (type: bigint), _col2 (type: bigint), _col3 (type: bigint), _col4 (type: bigint), _col5 (type: double), _col6 (type: double), _col7 (type: double), _col8 (type: double), _col9 (type: double), _col10 (type: double), _col11 (type: double), _col12 (type: double), _col13 (type: int), _col14 (type: int), _col16 (type: string), _col17 (type: date), _col20 (type: double), _col22 (type: int)
+                      value expressions: row_number_window_13 (type: int), rank_window_14 (type: int), dense_rank_window_15 (type: int), first_value_window_18 (type: double), lead_window_20 (type: double), lag_window_21 (type: double), _col0 (type: bigint), _col1 (type: bigint), _col2 (type: bigint), _col3 (type: bigint), _col4 (type: bigint), _col5 (type: double), _col6 (type: double), _col7 (type: double), _col8 (type: double), _col9 (type: double), _col10 (type: double), _col11 (type: double), _col12 (type: double), _col13 (type: int), _col14 (type: int), _col16 (type: string), _col17 (type: date), _col20 (type: double), _col24 (type: int)
         Reducer 4 
             Execution mode: vectorized, llap
             Reduce Vectorization:
@@ -668,13 +678,13 @@ STAGE PLANS:
                 vectorized: true
                 rowBatchContext:
                     dataColumnCount: 26
-                    dataColumns: KEY.reducesinkkey0:string, VALUE._col0:int, VALUE._col1:int, VALUE._col2:int, VALUE._col3:double, VALUE._col4:double, VALUE._col5:double, VALUE._col6:bigint, VALUE._col7:bigint, VALUE._col8:bigint, VALUE._col9:bigint, VALUE._col10:bigint, VALUE._col11:double, VALUE._col12:double, VALUE._col13:double, VALUE._col14:double, VALUE._col15:double, VALUE._col16:double, VALUE._col17:double, VALUE._col18:double, VALUE._col19:int, VALUE._col20:int, VALUE._col21:string, VALUE._col22:date, VALUE._col25:double, VALUE._col27:int
+                    dataColumns: KEY.reducesinkkey0:string, VALUE._col0:int, VALUE._col1:int, VALUE._col2:int, VALUE._col3:double, VALUE._col4:double, VALUE._col5:double, VALUE._col6:bigint, VALUE._col7:bigint, VALUE._col8:bigint, VALUE._col9:bigint, VALUE._col10:bigint, VALUE._col11:double, VALUE._col12:double, VALUE._col13:double, VALUE._col14:double, VALUE._col15:double, VALUE._col16:double, VALUE._col17:double, VALUE._col18:double, VALUE._col19:int, VALUE._col20:int, VALUE._col21:string, VALUE._col22:date, VALUE._col25:double, VALUE._col29:int
                     partitionColumnCount: 0
                     scratchColumnTypeNames: [double]
             Reduce Operator Tree:
               Select Operator
-                expressions: VALUE._col0 (type: int), VALUE._col1 (type: int), VALUE._col2 (type: int), VALUE._col3 (type: double), VALUE._col4 (type: double), VALUE._col5 (type: double), VALUE._col6 (type: bigint), VALUE._col7 (type: bigint), VALUE._col8 (type: bigint), VALUE._col9 (type: bigint), VALUE._col10 (type: bigint), VALUE._col11 (type: double), VALUE._col12 (type: double), VALUE._col13 (type: double), VALUE._col14 (type: double), VALUE._col15 (type: double), VALUE._col16 (type: double), VALUE._col17 (type: double), VALUE._col18 (type: double), VALUE._col19 (type: int), VALUE._col20 (type: int), KEY.reducesinkkey0 (type: string), VALUE._col21 (type: string), VALUE._col22 (type: date), VALUE._col25 (type: double), VALUE._col27 (type: int)
-                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21, _col22, _col23, _col26, _col28
+                expressions: VALUE._col0 (type: int), VALUE._col1 (type: int), VALUE._col2 (type: int), VALUE._col3 (type: double), VALUE._col4 (type: double), VALUE._col5 (type: double), VALUE._col6 (type: bigint), VALUE._col7 (type: bigint), VALUE._col8 (type: bigint), VALUE._col9 (type: bigint), VALUE._col10 (type: bigint), VALUE._col11 (type: double), VALUE._col12 (type: double), VALUE._col13 (type: double), VALUE._col14 (type: double), VALUE._col15 (type: double), VALUE._col16 (type: double), VALUE._col17 (type: double), VALUE._col18 (type: double), VALUE._col19 (type: int), VALUE._col20 (type: int), KEY.reducesinkkey0 (type: string), VALUE._col21 (type: string), VALUE._col22 (type: date), VALUE._col25 (type: double), VALUE._col29 (type: int)
+                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21, _col22, _col23, _col26, _col30
                 Select Vectorization:
                     className: VectorSelectOperator
                     native: true
@@ -684,7 +694,7 @@ STAGE PLANS:
                   Function definitions:
                       Input definition
                         input alias: ptf_0
-                        output shape: _col0: int, _col1: int, _col2: int, _col3: double, _col4: double, _col5: double, _col6: bigint, _col7: bigint, _col8: bigint, _col9: bigint, _col10: bigint, _col11: double, _col12: double, _col13: double, _col14: double, _col15: double, _col16: double, _col17: double, _col18: double, _col19: int, _col20: int, _col21: string, _col22: string, _col23: date, _col26: double, _col28: int
+                        output shape: _col0: int, _col1: int, _col2: int, _col3: double, _col4: double, _col5: double, _col6: bigint, _col7: bigint, _col8: bigint, _col9: bigint, _col10: bigint, _col11: double, _col12: double, _col13: double, _col14: double, _col15: double, _col16: double, _col17: double, _col18: double, _col19: int, _col20: int, _col21: string, _col22: string, _col23: date, _col26: double, _col30: int
                         type: WINDOWING
                       Windowing table definition
                         input alias: ptf_1
@@ -715,7 +725,7 @@ STAGE PLANS:
                       streamingColumns: [26]
                   Statistics: Num rows: 40 Data size: 15584 Basic stats: COMPLETE Column stats: COMPLETE
                   Select Operator
-                    expressions: _col21 (type: string), _col22 (type: string), _col28 (type: int), _col23 (type: date), _col26 (type: double), _col6 (type: bigint), _col7 (type: bigint), _col8 (type: bigint), _col9 (type: bigint), _col10 (type: bigint), _col11 (type: double), _col12 (type: double), _col13 (type: double), _col14 (type: double), _col15 (type: double), _col16 (type: double), _col17 (type: double), _col18 (type: double), _col0 (type: int), _col1 (type: int), _col2 (type: int), _col19 (type: int), _col20 (type: int), _col3 (type: double), first_value_window_19 (type: double), _col4 (type: double), _col5 (type: double)
+                    expressions: _col21 (type: string), _col22 (type: string), _col30 (type: int), _col23 (type: date), _col26 (type: double), _col6 (type: bigint), _col7 (type: bigint), _col8 (type: bigint), _col9 (type: bigint), _col10 (type: bigint), _col11 (type: double), _col12 (type: double), _col13 (type: double), _col14 (type: double), _col15 (type: double), _col16 (type: double), _col17 (type: double), _col18 (type: double), _col0 (type: int), _col1 (type: int), _col2 (type: int), _col19 (type: int), _col20 (type: int), _col3 (type: double), first_value_window_19 (type: double), _col4 (type: double), _col5 (type: double)
                     outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21, _col22, _col23, _col24, _col25, _col26
                     Select Vectorization:
                         className: VectorSelectOperator
@@ -1669,7 +1679,7 @@ STAGE PLANS:
                   Statistics: Num rows: 40 Data size: 11104 Basic stats: COMPLETE Column stats: COMPLETE
                   TableScan Vectorization:
                       native: true
-                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:rowindex:int, 8:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 9:ROW__IS__DELETED:boolean]
+                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:p_char:char(1), 8:p_varchar:varchar(5), 9:rowindex:int, 10:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 11:ROW__IS__DELETED:boolean]
                   Reduce Output Operator
                     key expressions: p_mfgr (type: string), p_date (type: date)
                     null sort order: az
@@ -1681,7 +1691,7 @@ STAGE PLANS:
                         native: true
                         nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez, spark] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
                         partitionColumns: 0:string
-                        valueColumns: 1:string, 5:double, 7:int
+                        valueColumns: 1:string, 5:double, 9:int
                     Statistics: Num rows: 40 Data size: 11104 Basic stats: COMPLETE Column stats: COMPLETE
                     value expressions: p_name (type: string), p_retailprice (type: double), rowindex (type: int)
             Execution mode: vectorized, llap
@@ -1696,9 +1706,9 @@ STAGE PLANS:
                 usesVectorUDFAdaptor: false
                 vectorized: true
                 rowBatchContext:
-                    dataColumnCount: 8
-                    includeColumns: [0, 1, 2, 5, 7]
-                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, rowindex:int
+                    dataColumnCount: 10
+                    includeColumns: [0, 1, 2, 5, 9]
+                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, p_char:char(1), p_varchar:varchar(5), rowindex:int
                     partitionColumnCount: 0
                     scratchColumnTypeNames: []
         Reducer 2 
@@ -1710,14 +1720,14 @@ STAGE PLANS:
                 vectorized: false
             Reduce Operator Tree:
               Select Operator
-                expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string), KEY.reducesinkkey1 (type: date), VALUE._col3 (type: double), VALUE._col5 (type: int)
-                outputColumnNames: _col0, _col1, _col2, _col5, _col7
+                expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string), KEY.reducesinkkey1 (type: date), VALUE._col3 (type: double), VALUE._col7 (type: int)
+                outputColumnNames: _col0, _col1, _col2, _col5, _col9
                 Statistics: Num rows: 40 Data size: 11104 Basic stats: COMPLETE Column stats: COMPLETE
                 PTF Operator
                   Function definitions:
                       Input definition
                         input alias: ptf_0
-                        output shape: _col0: string, _col1: string, _col2: date, _col5: double, _col7: int
+                        output shape: _col0: string, _col1: string, _col2: date, _col5: double, _col9: int
                         type: WINDOWING
                       Windowing table definition
                         input alias: ptf_1
@@ -1740,13 +1750,13 @@ STAGE PLANS:
                               isStar: true
                             window function definition
                               alias: count_window_2
-                              arguments: _col7
+                              arguments: _col9
                               name: count
                               window function: GenericUDAFCountEvaluator
                               window frame: RANGE PRECEDING(1)~FOLLOWING(3)
                             window function definition
                               alias: count_window_3
-                              arguments: _col7
+                              arguments: _col9
                               name: count
                               window function: GenericUDAFCountEvaluator
                               window frame: RANGE PRECEDING(3)~FOLLOWING(1)
@@ -1820,8 +1830,8 @@ STAGE PLANS:
                               isPivotResult: true
                   Statistics: Num rows: 40 Data size: 11104 Basic stats: COMPLETE Column stats: COMPLETE
                   Select Operator
-                    expressions: count_window_0 (type: bigint), count_window_1 (type: bigint), count_window_2 (type: bigint), count_window_3 (type: bigint), count_window_4 (type: bigint), sum_window_5 (type: double), sum_window_6 (type: double), min_window_7 (type: double), min_window_8 (type: double), max_window_9 (type: double), max_window_10 (type: double), avg_window_11 (type: double), avg_window_12 (type: double), rank_window_16 (type: int), dense_rank_window_17 (type: int), _col0 (type: string), _col1 (type: string), _col2 (type: date), _col5 (type: double), _col7 (type: int)
-                    outputColumnNames: count_window_0, count_window_1, count_window_2, count_window_3, count_window_4, sum_window_5, sum_window_6, min_window_7, min_window_8, max_window_9, max_window_10, avg_window_11, avg_window_12, rank_window_16, dense_rank_window_17, _col0, _col1, _col2, _col5, _col7
+                    expressions: count_window_0 (type: bigint), count_window_1 (type: bigint), count_window_2 (type: bigint), count_window_3 (type: bigint), count_window_4 (type: bigint), sum_window_5 (type: double), sum_window_6 (type: double), min_window_7 (type: double), min_window_8 (type: double), max_window_9 (type: double), max_window_10 (type: double), avg_window_11 (type: double), avg_window_12 (type: double), rank_window_16 (type: int), dense_rank_window_17 (type: int), _col0 (type: string), _col1 (type: string), _col2 (type: date), _col5 (type: double), _col9 (type: int)
+                    outputColumnNames: count_window_0, count_window_1, count_window_2, count_window_3, count_window_4, sum_window_5, sum_window_6, min_window_7, min_window_8, max_window_9, max_window_10, avg_window_11, avg_window_12, rank_window_16, dense_rank_window_17, _col0, _col1, _col2, _col5, _col9
                     Statistics: Num rows: 40 Data size: 11104 Basic stats: COMPLETE Column stats: COMPLETE
                     Reduce Output Operator
                       key expressions: _col0 (type: string)
@@ -1829,7 +1839,7 @@ STAGE PLANS:
                       sort order: +
                       Map-reduce partition columns: _col0 (type: string)
                       Statistics: Num rows: 40 Data size: 11104 Basic stats: COMPLETE Column stats: COMPLETE
-                      value expressions: count_window_0 (type: bigint), count_window_1 (type: bigint), count_window_2 (type: bigint), count_window_3 (type: bigint), count_window_4 (type: bigint), sum_window_5 (type: double), sum_window_6 (type: double), min_window_7 (type: double), min_window_8 (type: double), max_window_9 (type: double), max_window_10 (type: double), avg_window_11 (type: double), avg_window_12 (type: double), rank_window_16 (type: int), dense_rank_window_17 (type: int), _col1 (type: string), _col2 (type: date), _col5 (type: double), _col7 (type: int)
+                      value expressions: count_window_0 (type: bigint), count_window_1 (type: bigint), count_window_2 (type: bigint), count_window_3 (type: bigint), count_window_4 (type: bigint), sum_window_5 (type: double), sum_window_6 (type: double), min_window_7 (type: double), min_window_8 (type: double), max_window_9 (type: double), max_window_10 (type: double), avg_window_11 (type: double), avg_window_12 (type: double), rank_window_16 (type: int), dense_rank_window_17 (type: int), _col1 (type: string), _col2 (type: date), _col5 (type: double), _col9 (type: int)
         Reducer 3 
             Execution mode: vectorized, llap
             Reduce Vectorization:
@@ -1842,13 +1852,13 @@ STAGE PLANS:
                 vectorized: true
                 rowBatchContext:
                     dataColumnCount: 20
-                    dataColumns: KEY.reducesinkkey0:string, VALUE._col0:bigint, VALUE._col1:bigint, VALUE._col2:bigint, VALUE._col3:bigint, VALUE._col4:bigint, VALUE._col5:double, VALUE._col6:double, VALUE._col7:double, VALUE._col8:double, VALUE._col9:double, VALUE._col10:double, VALUE._col11:double, VALUE._col12:double, VALUE._col13:int, VALUE._col14:int, VALUE._col15:string, VALUE._col16:date, VALUE._col19:double, VALUE._col21:int
+                    dataColumns: KEY.reducesinkkey0:string, VALUE._col0:bigint, VALUE._col1:bigint, VALUE._col2:bigint, VALUE._col3:bigint, VALUE._col4:bigint, VALUE._col5:double, VALUE._col6:double, VALUE._col7:double, VALUE._col8:double, VALUE._col9:double, VALUE._col10:double, VALUE._col11:double, VALUE._col12:double, VALUE._col13:int, VALUE._col14:int, VALUE._col15:string, VALUE._col16:date, VALUE._col19:double, VALUE._col23:int
                     partitionColumnCount: 0
                     scratchColumnTypeNames: [bigint, bigint, bigint, double, double, double]
             Reduce Operator Tree:
               Select Operator
-                expressions: VALUE._col0 (type: bigint), VALUE._col1 (type: bigint), VALUE._col2 (type: bigint), VALUE._col3 (type: bigint), VALUE._col4 (type: bigint), VALUE._col5 (type: double), VALUE._col6 (type: double), VALUE._col7 (type: double), VALUE._col8 (type: double), VALUE._col9 (type: double), VALUE._col10 (type: double), VALUE._col11 (type: double), VALUE._col12 (type: double), VALUE._col13 (type: int), VALUE._col14 (type: int), KEY.reducesinkkey0 (type: string), VALUE._col15 (type: string), VALUE._col16 (type: date), VALUE._col19 (type: double), VALUE._col21 (type: int)
-                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col20, _col22
+                expressions: VALUE._col0 (type: bigint), VALUE._col1 (type: bigint), VALUE._col2 (type: bigint), VALUE._col3 (type: bigint), VALUE._col4 (type: bigint), VALUE._col5 (type: double), VALUE._col6 (type: double), VALUE._col7 (type: double), VALUE._col8 (type: double), VALUE._col9 (type: double), VALUE._col10 (type: double), VALUE._col11 (type: double), VALUE._col12 (type: double), VALUE._col13 (type: int), VALUE._col14 (type: int), KEY.reducesinkkey0 (type: string), VALUE._col15 (type: string), VALUE._col16 (type: date), VALUE._col19 (type: double), VALUE._col23 (type: int)
+                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col20, _col24
                 Select Vectorization:
                     className: VectorSelectOperator
                     native: true
@@ -1858,7 +1868,7 @@ STAGE PLANS:
                   Function definitions:
                       Input definition
                         input alias: ptf_0
-                        output shape: _col0: bigint, _col1: bigint, _col2: bigint, _col3: bigint, _col4: bigint, _col5: double, _col6: double, _col7: double, _col8: double, _col9: double, _col10: double, _col11: double, _col12: double, _col13: int, _col14: int, _col15: string, _col16: string, _col17: date, _col20: double, _col22: int
+                        output shape: _col0: bigint, _col1: bigint, _col2: bigint, _col3: bigint, _col4: bigint, _col5: double, _col6: double, _col7: double, _col8: double, _col9: double, _col10: double, _col11: double, _col12: double, _col13: int, _col14: int, _col15: string, _col16: string, _col17: date, _col20: double, _col24: int
                         type: WINDOWING
                       Windowing table definition
                         input alias: ptf_1
@@ -1923,8 +1933,8 @@ STAGE PLANS:
                       streamingColumns: [20, 21, 22, 23]
                   Statistics: Num rows: 40 Data size: 15104 Basic stats: COMPLETE Column stats: COMPLETE
                   Select Operator
-                    expressions: row_number_window_13 (type: int), rank_window_14 (type: int), dense_rank_window_15 (type: int), first_value_window_18 (type: double), lead_window_20 (type: double), lag_window_21 (type: double), _col0 (type: bigint), _col1 (type: bigint), _col2 (type: bigint), _col3 (type: bigint), _col4 (type: bigint), _col5 (type: double), _col6 (type: double), _col7 (type: double), _col8 (type: double), _col9 (type: double), _col10 (type: double), _col11 (type: double), _col12 (type: double), _col13 (type: int), _col14 (type: int), _col15 (type: string), _col16 (type: string), _col17 (type: date), _col20 (type: double), _col22 (type: int)
-                    outputColumnNames: row_number_window_13, rank_window_14, dense_rank_window_15, first_value_window_18, lead_window_20, lag_window_21, _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col20, _col22
+                    expressions: row_number_window_13 (type: int), rank_window_14 (type: int), dense_rank_window_15 (type: int), first_value_window_18 (type: double), lead_window_20 (type: double), lag_window_21 (type: double), _col0 (type: bigint), _col1 (type: bigint), _col2 (type: bigint), _col3 (type: bigint), _col4 (type: bigint), _col5 (type: double), _col6 (type: double), _col7 (type: double), _col8 (type: double), _col9 (type: double), _col10 (type: double), _col11 (type: double), _col12 (type: double), _col13 (type: int), _col14 (type: int), _col15 (type: string), _col16 (type: string), _col17 (type: date), _col20 (type: double), _col24 (type: int)
+                    outputColumnNames: row_number_window_13, rank_window_14, dense_rank_window_15, first_value_window_18, lead_window_20, lag_window_21, _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col20, _col24
                     Select Vectorization:
                         className: VectorSelectOperator
                         native: true
@@ -1942,7 +1952,7 @@ STAGE PLANS:
                           nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez, spark] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
                           valueColumns: 20:int, 21:int, 22:int, 23:double, 24:double, 25:double, 1:bigint, 2:bigint, 3:bigint, 4:bigint, 5:bigint, 6:double, 7:double, 8:double, 9:double, 10:double, 11:double, 12:double, 13:double, 14:int, 15:int, 16:string, 17:date, 18:double, 19:int
                       Statistics: Num rows: 40 Data size: 15104 Basic stats: COMPLETE Column stats: COMPLETE
-                      value expressions: row_number_window_13 (type: int), rank_window_14 (type: int), dense_rank_window_15 (type: int), first_value_window_18 (type: double), lead_window_20 (type: double), lag_window_21 (type: double), _col0 (type: bigint), _col1 (type: bigint), _col2 (type: bigint), _col3 (type: bigint), _col4 (type: bigint), _col5 (type: double), _col6 (type: double), _col7 (type: double), _col8 (type: double), _col9 (type: double), _col10 (type: double), _col11 (type: double), _col12 (type: double), _col13 (type: int), _col14 (type: int), _col16 (type: string), _col17 (type: date), _col20 (type: double), _col22 (type: int)
+                      value expressions: row_number_window_13 (type: int), rank_window_14 (type: int), dense_rank_window_15 (type: int), first_value_window_18 (type: double), lead_window_20 (type: double), lag_window_21 (type: double), _col0 (type: bigint), _col1 (type: bigint), _col2 (type: bigint), _col3 (type: bigint), _col4 (type: bigint), _col5 (type: double), _col6 (type: double), _col7 (type: double), _col8 (type: double), _col9 (type: double), _col10 (type: double), _col11 (type: double), _col12 (type: double), _col13 (type: int), _col14 (type: int), _col16 (type: string), _col17 (type: date), _col20 (type: double), _col24 (type: int)
         Reducer 4 
             Execution mode: vectorized, llap
             Reduce Vectorization:
@@ -1955,13 +1965,13 @@ STAGE PLANS:
                 vectorized: true
                 rowBatchContext:
                     dataColumnCount: 26
-                    dataColumns: KEY.reducesinkkey0:string, VALUE._col0:int, VALUE._col1:int, VALUE._col2:int, VALUE._col3:double, VALUE._col4:double, VALUE._col5:double, VALUE._col6:bigint, VALUE._col7:bigint, VALUE._col8:bigint, VALUE._col9:bigint, VALUE._col10:bigint, VALUE._col11:double, VALUE._col12:double, VALUE._col13:double, VALUE._col14:double, VALUE._col15:double, VALUE._col16:double, VALUE._col17:double, VALUE._col18:double, VALUE._col19:int, VALUE._col20:int, VALUE._col21:string, VALUE._col22:date, VALUE._col25:double, VALUE._col27:int
+                    dataColumns: KEY.reducesinkkey0:string, VALUE._col0:int, VALUE._col1:int, VALUE._col2:int, VALUE._col3:double, VALUE._col4:double, VALUE._col5:double, VALUE._col6:bigint, VALUE._col7:bigint, VALUE._col8:bigint, VALUE._col9:bigint, VALUE._col10:bigint, VALUE._col11:double, VALUE._col12:double, VALUE._col13:double, VALUE._col14:double, VALUE._col15:double, VALUE._col16:double, VALUE._col17:double, VALUE._col18:double, VALUE._col19:int, VALUE._col20:int, VALUE._col21:string, VALUE._col22:date, VALUE._col25:double, VALUE._col29:int
                     partitionColumnCount: 0
                     scratchColumnTypeNames: [double]
             Reduce Operator Tree:
               Select Operator
-                expressions: VALUE._col0 (type: int), VALUE._col1 (type: int), VALUE._col2 (type: int), VALUE._col3 (type: double), VALUE._col4 (type: double), VALUE._col5 (type: double), VALUE._col6 (type: bigint), VALUE._col7 (type: bigint), VALUE._col8 (type: bigint), VALUE._col9 (type: bigint), VALUE._col10 (type: bigint), VALUE._col11 (type: double), VALUE._col12 (type: double), VALUE._col13 (type: double), VALUE._col14 (type: double), VALUE._col15 (type: double), VALUE._col16 (type: double), VALUE._col17 (type: double), VALUE._col18 (type: double), VALUE._col19 (type: int), VALUE._col20 (type: int), KEY.reducesinkkey0 (type: string), VALUE._col21 (type: string), VALUE._col22 (type: date), VALUE._col25 (type: double), VALUE._col27 (type: int)
-                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21, _col22, _col23, _col26, _col28
+                expressions: VALUE._col0 (type: int), VALUE._col1 (type: int), VALUE._col2 (type: int), VALUE._col3 (type: double), VALUE._col4 (type: double), VALUE._col5 (type: double), VALUE._col6 (type: bigint), VALUE._col7 (type: bigint), VALUE._col8 (type: bigint), VALUE._col9 (type: bigint), VALUE._col10 (type: bigint), VALUE._col11 (type: double), VALUE._col12 (type: double), VALUE._col13 (type: double), VALUE._col14 (type: double), VALUE._col15 (type: double), VALUE._col16 (type: double), VALUE._col17 (type: double), VALUE._col18 (type: double), VALUE._col19 (type: int), VALUE._col20 (type: int), KEY.reducesinkkey0 (type: string), VALUE._col21 (type: string), VALUE._col22 (type: date), VALUE._col25 (type: double), VALUE._col29 (type: int)
+                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21, _col22, _col23, _col26, _col30
                 Select Vectorization:
                     className: VectorSelectOperator
                     native: true
@@ -1971,7 +1981,7 @@ STAGE PLANS:
                   Function definitions:
                       Input definition
                         input alias: ptf_0
-                        output shape: _col0: int, _col1: int, _col2: int, _col3: double, _col4: double, _col5: double, _col6: bigint, _col7: bigint, _col8: bigint, _col9: bigint, _col10: bigint, _col11: double, _col12: double, _col13: double, _col14: double, _col15: double, _col16: double, _col17: double, _col18: double, _col19: int, _col20: int, _col21: string, _col22: string, _col23: date, _col26: double, _col28: int
+                        output shape: _col0: int, _col1: int, _col2: int, _col3: double, _col4: double, _col5: double, _col6: bigint, _col7: bigint, _col8: bigint, _col9: bigint, _col10: bigint, _col11: double, _col12: double, _col13: double, _col14: double, _col15: double, _col16: double, _col17: double, _col18: double, _col19: int, _col20: int, _col21: string, _col22: string, _col23: date, _col26: double, _col30: int
                         type: WINDOWING
                       Windowing table definition
                         input alias: ptf_1
@@ -2002,7 +2012,7 @@ STAGE PLANS:
                       streamingColumns: [26]
                   Statistics: Num rows: 40 Data size: 15584 Basic stats: COMPLETE Column stats: COMPLETE
                   Select Operator
-                    expressions: _col21 (type: string), _col22 (type: string), _col28 (type: int), _col23 (type: date), _col26 (type: double), _col6 (type: bigint), _col7 (type: bigint), _col8 (type: bigint), _col9 (type: bigint), _col10 (type: bigint), _col11 (type: double), _col12 (type: double), _col13 (type: double), _col14 (type: double), _col15 (type: double), _col16 (type: double), _col17 (type: double), _col18 (type: double), _col0 (type: int), _col1 (type: int), _col2 (type: int), _col19 (type: int), _col20 (type: int), _col3 (type: double), first_value_window_19 (type: double), _col4 (type: double), _col5 (type: double)
+                    expressions: _col21 (type: string), _col22 (type: string), _col30 (type: int), _col23 (type: date), _col26 (type: double), _col6 (type: bigint), _col7 (type: bigint), _col8 (type: bigint), _col9 (type: bigint), _col10 (type: bigint), _col11 (type: double), _col12 (type: double), _col13 (type: double), _col14 (type: double), _col15 (type: double), _col16 (type: double), _col17 (type: double), _col18 (type: double), _col0 (type: int), _col1 (type: int), _col2 (type: int), _col19 (type: int), _col20 (type: int), _col3 (type: double), first_value_window_19 (type: double), _col4 (type: double), _col5 (type: double)
                     outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21, _col22, _col23, _col24, _col25, _col26
                     Select Vectorization:
                         className: VectorSelectOperator
@@ -2244,7 +2254,7 @@ STAGE PLANS:
                   Statistics: Num rows: 40 Data size: 12424 Basic stats: COMPLETE Column stats: COMPLETE
                   TableScan Vectorization:
                       native: true
-                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:rowindex:int, 8:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 9:ROW__IS__DELETED:boolean]
+                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:p_char:char(1), 8:p_varchar:varchar(5), 9:rowindex:int, 10:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 11:ROW__IS__DELETED:boolean]
                   Reduce Output Operator
                     key expressions: p_mfgr (type: string), p_name (type: string)
                     null sort order: az
@@ -2256,7 +2266,7 @@ STAGE PLANS:
                         native: true
                         nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez, spark] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
                         partitionColumns: 0:string
-                        valueColumns: 2:date, 3:timestamp, 5:double, 7:int
+                        valueColumns: 2:date, 3:timestamp, 5:double, 9:int
                     Statistics: Num rows: 40 Data size: 12424 Basic stats: COMPLETE Column stats: COMPLETE
                     value expressions: p_date (type: date), p_timestamp (type: timestamp), p_retailprice (type: double), rowindex (type: int)
             Execution mode: vectorized, llap
@@ -2271,9 +2281,9 @@ STAGE PLANS:
                 usesVectorUDFAdaptor: false
                 vectorized: true
                 rowBatchContext:
-                    dataColumnCount: 8
-                    includeColumns: [0, 1, 2, 3, 5, 7]
-                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, rowindex:int
+                    dataColumnCount: 10
+                    includeColumns: [0, 1, 2, 3, 5, 9]
+                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, p_char:char(1), p_varchar:varchar(5), rowindex:int
                     partitionColumnCount: 0
                     scratchColumnTypeNames: []
         Reducer 2 
@@ -2288,13 +2298,13 @@ STAGE PLANS:
                 vectorized: true
                 rowBatchContext:
                     dataColumnCount: 6
-                    dataColumns: KEY.reducesinkkey0:string, KEY.reducesinkkey1:string, VALUE._col0:date, VALUE._col1:timestamp, VALUE._col3:double, VALUE._col5:int
+                    dataColumns: KEY.reducesinkkey0:string, KEY.reducesinkkey1:string, VALUE._col0:date, VALUE._col1:timestamp, VALUE._col3:double, VALUE._col7:int
                     partitionColumnCount: 0
                     scratchColumnTypeNames: [bigint, double]
             Reduce Operator Tree:
               Select Operator
-                expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), VALUE._col0 (type: date), VALUE._col1 (type: timestamp), VALUE._col3 (type: double), VALUE._col5 (type: int)
-                outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col7
+                expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), VALUE._col0 (type: date), VALUE._col1 (type: timestamp), VALUE._col3 (type: double), VALUE._col7 (type: int)
+                outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col9
                 Select Vectorization:
                     className: VectorSelectOperator
                     native: true
@@ -2304,7 +2314,7 @@ STAGE PLANS:
                   Function definitions:
                       Input definition
                         input alias: ptf_0
-                        output shape: _col0: string, _col1: string, _col2: date, _col3: timestamp, _col5: double, _col7: int
+                        output shape: _col0: string, _col1: string, _col2: date, _col3: timestamp, _col5: double, _col9: int
                         type: WINDOWING
                       Windowing table definition
                         input alias: ptf_1
@@ -2341,7 +2351,7 @@ STAGE PLANS:
                       streamingColumns: []
                   Statistics: Num rows: 40 Data size: 12424 Basic stats: COMPLETE Column stats: COMPLETE
                   Select Operator
-                    expressions: _col0 (type: string), _col1 (type: string), _col3 (type: timestamp), _col7 (type: int), _col2 (type: date), _col5 (type: double), count_window_0 (type: bigint), sum_window_1 (type: double)
+                    expressions: _col0 (type: string), _col1 (type: string), _col3 (type: timestamp), _col9 (type: int), _col2 (type: date), _col5 (type: double), count_window_0 (type: bigint), sum_window_1 (type: double)
                     outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                     Select Vectorization:
                         className: VectorSelectOperator
@@ -2468,7 +2478,7 @@ STAGE PLANS:
                   Statistics: Num rows: 40 Data size: 12424 Basic stats: COMPLETE Column stats: COMPLETE
                   TableScan Vectorization:
                       native: true
-                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:rowindex:int, 8:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 9:ROW__IS__DELETED:boolean]
+                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:p_char:char(1), 8:p_varchar:varchar(5), 9:rowindex:int, 10:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 11:ROW__IS__DELETED:boolean]
                   Reduce Output Operator
                     key expressions: p_name (type: string)
                     null sort order: a
@@ -2479,7 +2489,7 @@ STAGE PLANS:
                         keyColumns: 1:string
                         native: true
                         nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez, spark] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
-                        valueColumns: 0:string, 2:date, 3:timestamp, 5:double, 7:int
+                        valueColumns: 0:string, 2:date, 3:timestamp, 5:double, 9:int
                     Statistics: Num rows: 40 Data size: 12424 Basic stats: COMPLETE Column stats: COMPLETE
                     value expressions: p_mfgr (type: string), p_date (type: date), p_timestamp (type: timestamp), p_retailprice (type: double), rowindex (type: int)
             Execution mode: vectorized, llap
@@ -2494,9 +2504,9 @@ STAGE PLANS:
                 usesVectorUDFAdaptor: false
                 vectorized: true
                 rowBatchContext:
-                    dataColumnCount: 8
-                    includeColumns: [0, 1, 2, 3, 5, 7]
-                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, rowindex:int
+                    dataColumnCount: 10
+                    includeColumns: [0, 1, 2, 3, 5, 9]
+                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, p_char:char(1), p_varchar:varchar(5), rowindex:int
                     partitionColumnCount: 0
                     scratchColumnTypeNames: []
         Reducer 2 
@@ -2511,13 +2521,13 @@ STAGE PLANS:
                 vectorized: true
                 rowBatchContext:
                     dataColumnCount: 6
-                    dataColumns: KEY.reducesinkkey0:string, VALUE._col0:string, VALUE._col1:date, VALUE._col2:timestamp, VALUE._col4:double, VALUE._col6:int
+                    dataColumns: KEY.reducesinkkey0:string, VALUE._col0:string, VALUE._col1:date, VALUE._col2:timestamp, VALUE._col4:double, VALUE._col8:int
                     partitionColumnCount: 0
                     scratchColumnTypeNames: [bigint, double]
             Reduce Operator Tree:
               Select Operator
-                expressions: VALUE._col0 (type: string), KEY.reducesinkkey0 (type: string), VALUE._col1 (type: date), VALUE._col2 (type: timestamp), VALUE._col4 (type: double), VALUE._col6 (type: int)
-                outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col7
+                expressions: VALUE._col0 (type: string), KEY.reducesinkkey0 (type: string), VALUE._col1 (type: date), VALUE._col2 (type: timestamp), VALUE._col4 (type: double), VALUE._col8 (type: int)
+                outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col9
                 Select Vectorization:
                     className: VectorSelectOperator
                     native: true
@@ -2527,7 +2537,7 @@ STAGE PLANS:
                   Function definitions:
                       Input definition
                         input alias: ptf_0
-                        output shape: _col0: string, _col1: string, _col2: date, _col3: timestamp, _col5: double, _col7: int
+                        output shape: _col0: string, _col1: string, _col2: date, _col3: timestamp, _col5: double, _col9: int
                         type: WINDOWING
                       Windowing table definition
                         input alias: ptf_1
@@ -2564,7 +2574,7 @@ STAGE PLANS:
                       streamingColumns: []
                   Statistics: Num rows: 40 Data size: 12424 Basic stats: COMPLETE Column stats: COMPLETE
                   Select Operator
-                    expressions: _col0 (type: string), _col1 (type: string), _col3 (type: timestamp), _col7 (type: int), _col2 (type: date), _col5 (type: double), count_window_0 (type: bigint), sum_window_1 (type: double)
+                    expressions: _col0 (type: string), _col1 (type: string), _col3 (type: timestamp), _col9 (type: int), _col2 (type: date), _col5 (type: double), count_window_0 (type: bigint), sum_window_1 (type: double)
                     outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                     Select Vectorization:
                         className: VectorSelectOperator
@@ -2715,7 +2725,7 @@ STAGE PLANS:
                   Statistics: Num rows: 40 Data size: 12424 Basic stats: COMPLETE Column stats: COMPLETE
                   TableScan Vectorization:
                       native: true
-                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:rowindex:int, 8:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 9:ROW__IS__DELETED:boolean]
+                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:p_char:char(1), 8:p_varchar:varchar(5), 9:rowindex:int, 10:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 11:ROW__IS__DELETED:boolean]
                   Filter Operator
                     Filter Vectorization:
                         className: VectorFilterOperator
@@ -2730,11 +2740,11 @@ STAGE PLANS:
                       Map-reduce partition columns: 'almond antique chartreuse lavender yellow' (type: string)
                       Reduce Sink Vectorization:
                           className: VectorReduceSinkStringOperator
-                          keyColumns: 10:string
-                          keyExpressions: ConstantVectorExpression(val almond antique chartreuse lavender yellow) -> 10:string
+                          keyColumns: 12:string
+                          keyExpressions: ConstantVectorExpression(val almond antique chartreuse lavender yellow) -> 12:string
                           native: true
                           nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez, spark] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
-                          valueColumns: 0:string, 2:date, 3:timestamp, 5:double, 7:int
+                          valueColumns: 0:string, 2:date, 3:timestamp, 5:double, 9:int
                       Statistics: Num rows: 2 Data size: 656 Basic stats: COMPLETE Column stats: COMPLETE
                       value expressions: p_mfgr (type: string), p_date (type: date), p_timestamp (type: timestamp), p_retailprice (type: double), rowindex (type: int)
             Execution mode: vectorized, llap
@@ -2749,9 +2759,9 @@ STAGE PLANS:
                 usesVectorUDFAdaptor: false
                 vectorized: true
                 rowBatchContext:
-                    dataColumnCount: 8
-                    includeColumns: [0, 1, 2, 3, 5, 7]
-                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, rowindex:int
+                    dataColumnCount: 10
+                    includeColumns: [0, 1, 2, 3, 5, 9]
+                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, p_char:char(1), p_varchar:varchar(5), rowindex:int
                     partitionColumnCount: 0
                     scratchColumnTypeNames: [string]
         Reducer 2 
@@ -2766,13 +2776,13 @@ STAGE PLANS:
                 vectorized: true
                 rowBatchContext:
                     dataColumnCount: 6
-                    dataColumns: KEY.reducesinkkey0:string, VALUE._col0:string, VALUE._col2:date, VALUE._col3:timestamp, VALUE._col5:double, VALUE._col7:int
+                    dataColumns: KEY.reducesinkkey0:string, VALUE._col0:string, VALUE._col2:date, VALUE._col3:timestamp, VALUE._col5:double, VALUE._col9:int
                     partitionColumnCount: 0
                     scratchColumnTypeNames: [bigint, double, string, string, string]
             Reduce Operator Tree:
               Select Operator
-                expressions: VALUE._col0 (type: string), VALUE._col2 (type: date), VALUE._col3 (type: timestamp), VALUE._col5 (type: double), VALUE._col7 (type: int)
-                outputColumnNames: _col0, _col2, _col3, _col5, _col7
+                expressions: VALUE._col0 (type: string), VALUE._col2 (type: date), VALUE._col3 (type: timestamp), VALUE._col5 (type: double), VALUE._col9 (type: int)
+                outputColumnNames: _col0, _col2, _col3, _col5, _col9
                 Select Vectorization:
                     className: VectorSelectOperator
                     native: true
@@ -2782,7 +2792,7 @@ STAGE PLANS:
                   Function definitions:
                       Input definition
                         input alias: ptf_0
-                        output shape: _col0: string, _col2: date, _col3: timestamp, _col5: double, _col7: int
+                        output shape: _col0: string, _col2: date, _col3: timestamp, _col5: double, _col9: int
                         type: WINDOWING
                       Windowing table definition
                         input alias: ptf_1
@@ -2819,7 +2829,7 @@ STAGE PLANS:
                       streamingColumns: []
                   Statistics: Num rows: 2 Data size: 412 Basic stats: COMPLETE Column stats: COMPLETE
                   Select Operator
-                    expressions: _col0 (type: string), 'almond antique chartreuse lavender yellow' (type: string), _col3 (type: timestamp), _col7 (type: int), _col2 (type: date), _col5 (type: double), count_window_0 (type: bigint), sum_window_1 (type: double)
+                    expressions: _col0 (type: string), 'almond antique chartreuse lavender yellow' (type: string), _col3 (type: timestamp), _col9 (type: int), _col2 (type: date), _col5 (type: double), count_window_0 (type: bigint), sum_window_1 (type: double)
                     outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                     Select Vectorization:
                         className: VectorSelectOperator
@@ -2967,7 +2977,7 @@ STAGE PLANS:
                   Statistics: Num rows: 40 Data size: 12424 Basic stats: COMPLETE Column stats: COMPLETE
                   TableScan Vectorization:
                       native: true
-                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:rowindex:int, 8:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 9:ROW__IS__DELETED:boolean]
+                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:p_char:char(1), 8:p_varchar:varchar(5), 9:rowindex:int, 10:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 11:ROW__IS__DELETED:boolean]
                   Reduce Output Operator
                     key expressions: p_mfgr (type: string), p_timestamp (type: timestamp)
                     null sort order: az
@@ -2979,7 +2989,7 @@ STAGE PLANS:
                         native: true
                         nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez, spark] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
                         partitionColumns: 0:string
-                        valueColumns: 1:string, 2:date, 5:double, 7:int
+                        valueColumns: 1:string, 2:date, 5:double, 9:int
                     Statistics: Num rows: 40 Data size: 12424 Basic stats: COMPLETE Column stats: COMPLETE
                     value expressions: p_name (type: string), p_date (type: date), p_retailprice (type: double), rowindex (type: int)
             Execution mode: vectorized, llap
@@ -2994,9 +3004,9 @@ STAGE PLANS:
                 usesVectorUDFAdaptor: false
                 vectorized: true
                 rowBatchContext:
-                    dataColumnCount: 8
-                    includeColumns: [0, 1, 2, 3, 5, 7]
-                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, rowindex:int
+                    dataColumnCount: 10
+                    includeColumns: [0, 1, 2, 3, 5, 9]
+                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, p_char:char(1), p_varchar:varchar(5), rowindex:int
                     partitionColumnCount: 0
                     scratchColumnTypeNames: []
         Reducer 2 
@@ -3011,13 +3021,13 @@ STAGE PLANS:
                 vectorized: true
                 rowBatchContext:
                     dataColumnCount: 6
-                    dataColumns: KEY.reducesinkkey0:string, KEY.reducesinkkey1:timestamp, VALUE._col0:string, VALUE._col1:date, VALUE._col3:double, VALUE._col5:int
+                    dataColumns: KEY.reducesinkkey0:string, KEY.reducesinkkey1:timestamp, VALUE._col0:string, VALUE._col1:date, VALUE._col3:double, VALUE._col7:int
                     partitionColumnCount: 0
                     scratchColumnTypeNames: [bigint, double]
             Reduce Operator Tree:
               Select Operator
-                expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string), VALUE._col1 (type: date), KEY.reducesinkkey1 (type: timestamp), VALUE._col3 (type: double), VALUE._col5 (type: int)
-                outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col7
+                expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string), VALUE._col1 (type: date), KEY.reducesinkkey1 (type: timestamp), VALUE._col3 (type: double), VALUE._col7 (type: int)
+                outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col9
                 Select Vectorization:
                     className: VectorSelectOperator
                     native: true
@@ -3027,7 +3037,7 @@ STAGE PLANS:
                   Function definitions:
                       Input definition
                         input alias: ptf_0
-                        output shape: _col0: string, _col1: string, _col2: date, _col3: timestamp, _col5: double, _col7: int
+                        output shape: _col0: string, _col1: string, _col2: date, _col3: timestamp, _col5: double, _col9: int
                         type: WINDOWING
                       Windowing table definition
                         input alias: ptf_1
@@ -3064,7 +3074,7 @@ STAGE PLANS:
                       streamingColumns: []
                   Statistics: Num rows: 40 Data size: 12424 Basic stats: COMPLETE Column stats: COMPLETE
                   Select Operator
-                    expressions: _col0 (type: string), _col1 (type: string), _col3 (type: timestamp), _col7 (type: int), _col2 (type: date), _col5 (type: double), count_window_0 (type: bigint), sum_window_1 (type: double)
+                    expressions: _col0 (type: string), _col1 (type: string), _col3 (type: timestamp), _col9 (type: int), _col2 (type: date), _col5 (type: double), count_window_0 (type: bigint), sum_window_1 (type: double)
                     outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                     Select Vectorization:
                         className: VectorSelectOperator
@@ -3191,7 +3201,7 @@ STAGE PLANS:
                   Statistics: Num rows: 40 Data size: 12424 Basic stats: COMPLETE Column stats: COMPLETE
                   TableScan Vectorization:
                       native: true
-                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:rowindex:int, 8:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 9:ROW__IS__DELETED:boolean]
+                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:p_char:char(1), 8:p_varchar:varchar(5), 9:rowindex:int, 10:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 11:ROW__IS__DELETED:boolean]
                   Reduce Output Operator
                     key expressions: p_timestamp (type: timestamp)
                     null sort order: a
@@ -3202,7 +3212,7 @@ STAGE PLANS:
                         keyColumns: 3:timestamp
                         native: true
                         nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez, spark] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
-                        valueColumns: 0:string, 1:string, 2:date, 5:double, 7:int
+                        valueColumns: 0:string, 1:string, 2:date, 5:double, 9:int
                     Statistics: Num rows: 40 Data size: 12424 Basic stats: COMPLETE Column stats: COMPLETE
                     value expressions: p_mfgr (type: string), p_name (type: string), p_date (type: date), p_retailprice (type: double), rowindex (type: int)
             Execution mode: vectorized, llap
@@ -3217,9 +3227,9 @@ STAGE PLANS:
                 usesVectorUDFAdaptor: false
                 vectorized: true
                 rowBatchContext:
-                    dataColumnCount: 8
-                    includeColumns: [0, 1, 2, 3, 5, 7]
-                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, rowindex:int
+                    dataColumnCount: 10
+                    includeColumns: [0, 1, 2, 3, 5, 9]
+                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, p_char:char(1), p_varchar:varchar(5), rowindex:int
                     partitionColumnCount: 0
                     scratchColumnTypeNames: []
         Reducer 2 
@@ -3234,13 +3244,13 @@ STAGE PLANS:
                 vectorized: true
                 rowBatchContext:
                     dataColumnCount: 6
-                    dataColumns: KEY.reducesinkkey0:timestamp, VALUE._col0:string, VALUE._col1:string, VALUE._col2:date, VALUE._col4:double, VALUE._col6:int
+                    dataColumns: KEY.reducesinkkey0:timestamp, VALUE._col0:string, VALUE._col1:string, VALUE._col2:date, VALUE._col4:double, VALUE._col8:int
                     partitionColumnCount: 0
                     scratchColumnTypeNames: [bigint, double]
             Reduce Operator Tree:
               Select Operator
-                expressions: VALUE._col0 (type: string), VALUE._col1 (type: string), VALUE._col2 (type: date), KEY.reducesinkkey0 (type: timestamp), VALUE._col4 (type: double), VALUE._col6 (type: int)
-                outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col7
+                expressions: VALUE._col0 (type: string), VALUE._col1 (type: string), VALUE._col2 (type: date), KEY.reducesinkkey0 (type: timestamp), VALUE._col4 (type: double), VALUE._col8 (type: int)
+                outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col9
                 Select Vectorization:
                     className: VectorSelectOperator
                     native: true
@@ -3250,7 +3260,7 @@ STAGE PLANS:
                   Function definitions:
                       Input definition
                         input alias: ptf_0
-                        output shape: _col0: string, _col1: string, _col2: date, _col3: timestamp, _col5: double, _col7: int
+                        output shape: _col0: string, _col1: string, _col2: date, _col3: timestamp, _col5: double, _col9: int
                         type: WINDOWING
                       Windowing table definition
                         input alias: ptf_1
@@ -3287,7 +3297,7 @@ STAGE PLANS:
                       streamingColumns: []
                   Statistics: Num rows: 40 Data size: 12424 Basic stats: COMPLETE Column stats: COMPLETE
                   Select Operator
-                    expressions: _col0 (type: string), _col1 (type: string), _col3 (type: timestamp), _col7 (type: int), _col2 (type: date), _col5 (type: double), count_window_0 (type: bigint), sum_window_1 (type: double)
+                    expressions: _col0 (type: string), _col1 (type: string), _col3 (type: timestamp), _col9 (type: int), _col2 (type: date), _col5 (type: double), count_window_0 (type: bigint), sum_window_1 (type: double)
                     outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                     Select Vectorization:
                         className: VectorSelectOperator
@@ -3417,7 +3427,7 @@ STAGE PLANS:
                   Statistics: Num rows: 40 Data size: 12424 Basic stats: COMPLETE Column stats: COMPLETE
                   TableScan Vectorization:
                       native: true
-                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:rowindex:int, 8:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 9:ROW__IS__DELETED:boolean]
+                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:p_char:char(1), 8:p_varchar:varchar(5), 9:rowindex:int, 10:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 11:ROW__IS__DELETED:boolean]
                   Filter Operator
                     Filter Vectorization:
                         className: VectorFilterOperator
@@ -3432,11 +3442,11 @@ STAGE PLANS:
                       Map-reduce partition columns: TIMESTAMP'1970-01-03 00:00:00' (type: timestamp)
                       Reduce Sink Vectorization:
                           className: VectorReduceSinkMultiKeyOperator
-                          keyColumns: 10:timestamp
-                          keyExpressions: ConstantVectorExpression(val 1970-01-03 00:00:00) -> 10:timestamp
+                          keyColumns: 12:timestamp
+                          keyExpressions: ConstantVectorExpression(val 1970-01-03 00:00:00) -> 12:timestamp
                           native: true
                           nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez, spark] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
-                          valueColumns: 0:string, 1:string, 2:date, 5:double, 7:int
+                          valueColumns: 0:string, 1:string, 2:date, 5:double, 9:int
                       Statistics: Num rows: 20 Data size: 6264 Basic stats: COMPLETE Column stats: COMPLETE
                       value expressions: p_mfgr (type: string), p_name (type: string), p_date (type: date), p_retailprice (type: double), rowindex (type: int)
             Execution mode: vectorized, llap
@@ -3451,9 +3461,9 @@ STAGE PLANS:
                 usesVectorUDFAdaptor: false
                 vectorized: true
                 rowBatchContext:
-                    dataColumnCount: 8
-                    includeColumns: [0, 1, 2, 3, 5, 7]
-                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, rowindex:int
+                    dataColumnCount: 10
+                    includeColumns: [0, 1, 2, 3, 5, 9]
+                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, p_char:char(1), p_varchar:varchar(5), rowindex:int
                     partitionColumnCount: 0
                     scratchColumnTypeNames: [timestamp]
         Reducer 2 
@@ -3468,13 +3478,13 @@ STAGE PLANS:
                 vectorized: true
                 rowBatchContext:
                     dataColumnCount: 6
-                    dataColumns: KEY.reducesinkkey0:timestamp, VALUE._col0:string, VALUE._col1:string, VALUE._col2:date, VALUE._col5:double, VALUE._col7:int
+                    dataColumns: KEY.reducesinkkey0:timestamp, VALUE._col0:string, VALUE._col1:string, VALUE._col2:date, VALUE._col5:double, VALUE._col9:int
                     partitionColumnCount: 0
                     scratchColumnTypeNames: [bigint, double, timestamp, timestamp, timestamp]
             Reduce Operator Tree:
               Select Operator
-                expressions: VALUE._col0 (type: string), VALUE._col1 (type: string), VALUE._col2 (type: date), VALUE._col5 (type: double), VALUE._col7 (type: int)
-                outputColumnNames: _col0, _col1, _col2, _col5, _col7
+                expressions: VALUE._col0 (type: string), VALUE._col1 (type: string), VALUE._col2 (type: date), VALUE._col5 (type: double), VALUE._col9 (type: int)
+                outputColumnNames: _col0, _col1, _col2, _col5, _col9
                 Select Vectorization:
                     className: VectorSelectOperator
                     native: true
@@ -3484,7 +3494,7 @@ STAGE PLANS:
                   Function definitions:
                       Input definition
                         input alias: ptf_0
-                        output shape: _col0: string, _col1: string, _col2: date, _col5: double, _col7: int
+                        output shape: _col0: string, _col1: string, _col2: date, _col5: double, _col9: int
                         type: WINDOWING
                       Windowing table definition
                         input alias: ptf_1
@@ -3521,7 +3531,7 @@ STAGE PLANS:
                       streamingColumns: []
                   Statistics: Num rows: 20 Data size: 5584 Basic stats: COMPLETE Column stats: COMPLETE
                   Select Operator
-                    expressions: _col0 (type: string), _col1 (type: string), TIMESTAMP'1970-01-03 00:00:00' (type: timestamp), _col7 (type: int), _col2 (type: date), _col5 (type: double), count_window_0 (type: bigint), sum_window_1 (type: double)
+                    expressions: _col0 (type: string), _col1 (type: string), TIMESTAMP'1970-01-03 00:00:00' (type: timestamp), _col9 (type: int), _col2 (type: date), _col5 (type: double), count_window_0 (type: bigint), sum_window_1 (type: double)
                     outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                     Select Vectorization:
                         className: VectorSelectOperator
@@ -3692,7 +3702,7 @@ STAGE PLANS:
                   Statistics: Num rows: 40 Data size: 12424 Basic stats: COMPLETE Column stats: COMPLETE
                   TableScan Vectorization:
                       native: true
-                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:rowindex:int, 8:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 9:ROW__IS__DELETED:boolean]
+                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:p_char:char(1), 8:p_varchar:varchar(5), 9:rowindex:int, 10:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 11:ROW__IS__DELETED:boolean]
                   Reduce Output Operator
                     key expressions: p_mfgr (type: string), p_date (type: date)
                     null sort order: az
@@ -3704,7 +3714,7 @@ STAGE PLANS:
                         native: true
                         nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez, spark] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
                         partitionColumns: 0:string
-                        valueColumns: 1:string, 3:timestamp, 5:double, 7:int
+                        valueColumns: 1:string, 3:timestamp, 5:double, 9:int
                     Statistics: Num rows: 40 Data size: 12424 Basic stats: COMPLETE Column stats: COMPLETE
                     value expressions: p_name (type: string), p_timestamp (type: timestamp), p_retailprice (type: double), rowindex (type: int)
             Execution mode: vectorized, llap
@@ -3719,9 +3729,9 @@ STAGE PLANS:
                 usesVectorUDFAdaptor: false
                 vectorized: true
                 rowBatchContext:
-                    dataColumnCount: 8
-                    includeColumns: [0, 1, 2, 3, 5, 7]
-                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, rowindex:int
+                    dataColumnCount: 10
+                    includeColumns: [0, 1, 2, 3, 5, 9]
+                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, p_char:char(1), p_varchar:varchar(5), rowindex:int
                     partitionColumnCount: 0
                     scratchColumnTypeNames: []
         Reducer 2 
@@ -3736,13 +3746,13 @@ STAGE PLANS:
                 vectorized: true
                 rowBatchContext:
                     dataColumnCount: 6
-                    dataColumns: KEY.reducesinkkey0:string, KEY.reducesinkkey1:date, VALUE._col0:string, VALUE._col1:timestamp, VALUE._col3:double, VALUE._col5:int
+                    dataColumns: KEY.reducesinkkey0:string, KEY.reducesinkkey1:date, VALUE._col0:string, VALUE._col1:timestamp, VALUE._col3:double, VALUE._col7:int
                     partitionColumnCount: 0
                     scratchColumnTypeNames: [bigint, double]
             Reduce Operator Tree:
               Select Operator
-                expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string), KEY.reducesinkkey1 (type: date), VALUE._col1 (type: timestamp), VALUE._col3 (type: double), VALUE._col5 (type: int)
-                outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col7
+                expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string), KEY.reducesinkkey1 (type: date), VALUE._col1 (type: timestamp), VALUE._col3 (type: double), VALUE._col7 (type: int)
+                outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col9
                 Select Vectorization:
                     className: VectorSelectOperator
                     native: true
@@ -3752,7 +3762,7 @@ STAGE PLANS:
                   Function definitions:
                       Input definition
                         input alias: ptf_0
-                        output shape: _col0: string, _col1: string, _col2: date, _col3: timestamp, _col5: double, _col7: int
+                        output shape: _col0: string, _col1: string, _col2: date, _col3: timestamp, _col5: double, _col9: int
                         type: WINDOWING
                       Windowing table definition
                         input alias: ptf_1
@@ -3789,7 +3799,7 @@ STAGE PLANS:
                       streamingColumns: []
                   Statistics: Num rows: 40 Data size: 12424 Basic stats: COMPLETE Column stats: COMPLETE
                   Select Operator
-                    expressions: _col0 (type: string), _col1 (type: string), _col3 (type: timestamp), _col7 (type: int), _col2 (type: date), _col5 (type: double), count_window_0 (type: bigint), sum_window_1 (type: double)
+                    expressions: _col0 (type: string), _col1 (type: string), _col3 (type: timestamp), _col9 (type: int), _col2 (type: date), _col5 (type: double), count_window_0 (type: bigint), sum_window_1 (type: double)
                     outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                     Select Vectorization:
                         className: VectorSelectOperator
@@ -3916,7 +3926,7 @@ STAGE PLANS:
                   Statistics: Num rows: 40 Data size: 12424 Basic stats: COMPLETE Column stats: COMPLETE
                   TableScan Vectorization:
                       native: true
-                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:rowindex:int, 8:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 9:ROW__IS__DELETED:boolean]
+                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:p_char:char(1), 8:p_varchar:varchar(5), 9:rowindex:int, 10:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 11:ROW__IS__DELETED:boolean]
                   Reduce Output Operator
                     key expressions: p_date (type: date)
                     null sort order: a
@@ -3927,7 +3937,7 @@ STAGE PLANS:
                         keyColumns: 2:date
                         native: true
                         nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez, spark] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
-                        valueColumns: 0:string, 1:string, 3:timestamp, 5:double, 7:int
+                        valueColumns: 0:string, 1:string, 3:timestamp, 5:double, 9:int
                     Statistics: Num rows: 40 Data size: 12424 Basic stats: COMPLETE Column stats: COMPLETE
                     value expressions: p_mfgr (type: string), p_name (type: string), p_timestamp (type: timestamp), p_retailprice (type: double), rowindex (type: int)
             Execution mode: vectorized, llap
@@ -3942,9 +3952,9 @@ STAGE PLANS:
                 usesVectorUDFAdaptor: false
                 vectorized: true
                 rowBatchContext:
-                    dataColumnCount: 8
-                    includeColumns: [0, 1, 2, 3, 5, 7]
-                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, rowindex:int
+                    dataColumnCount: 10
+                    includeColumns: [0, 1, 2, 3, 5, 9]
+                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, p_char:char(1), p_varchar:varchar(5), rowindex:int
                     partitionColumnCount: 0
                     scratchColumnTypeNames: []
         Reducer 2 
@@ -3959,13 +3969,13 @@ STAGE PLANS:
                 vectorized: true
                 rowBatchContext:
                     dataColumnCount: 6
-                    dataColumns: KEY.reducesinkkey0:date, VALUE._col0:string, VALUE._col1:string, VALUE._col2:timestamp, VALUE._col4:double, VALUE._col6:int
+                    dataColumns: KEY.reducesinkkey0:date, VALUE._col0:string, VALUE._col1:string, VALUE._col2:timestamp, VALUE._col4:double, VALUE._col8:int
                     partitionColumnCount: 0
                     scratchColumnTypeNames: [bigint, double]
             Reduce Operator Tree:
               Select Operator
-                expressions: VALUE._col0 (type: string), VALUE._col1 (type: string), KEY.reducesinkkey0 (type: date), VALUE._col2 (type: timestamp), VALUE._col4 (type: double), VALUE._col6 (type: int)
-                outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col7
+                expressions: VALUE._col0 (type: string), VALUE._col1 (type: string), KEY.reducesinkkey0 (type: date), VALUE._col2 (type: timestamp), VALUE._col4 (type: double), VALUE._col8 (type: int)
+                outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col9
                 Select Vectorization:
                     className: VectorSelectOperator
                     native: true
@@ -3975,7 +3985,7 @@ STAGE PLANS:
                   Function definitions:
                       Input definition
                         input alias: ptf_0
-                        output shape: _col0: string, _col1: string, _col2: date, _col3: timestamp, _col5: double, _col7: int
+                        output shape: _col0: string, _col1: string, _col2: date, _col3: timestamp, _col5: double, _col9: int
                         type: WINDOWING
                       Windowing table definition
                         input alias: ptf_1
@@ -4012,7 +4022,7 @@ STAGE PLANS:
                       streamingColumns: []
                   Statistics: Num rows: 40 Data size: 12424 Basic stats: COMPLETE Column stats: COMPLETE
                   Select Operator
-                    expressions: _col0 (type: string), _col1 (type: string), _col3 (type: timestamp), _col7 (type: int), _col2 (type: date), _col5 (type: double), count_window_0 (type: bigint), sum_window_1 (type: double)
+                    expressions: _col0 (type: string), _col1 (type: string), _col3 (type: timestamp), _col9 (type: int), _col2 (type: date), _col5 (type: double), count_window_0 (type: bigint), sum_window_1 (type: double)
                     outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                     Select Vectorization:
                         className: VectorSelectOperator
@@ -4142,7 +4152,7 @@ STAGE PLANS:
                   Statistics: Num rows: 40 Data size: 12424 Basic stats: COMPLETE Column stats: COMPLETE
                   TableScan Vectorization:
                       native: true
-                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:rowindex:int, 8:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 9:ROW__IS__DELETED:boolean]
+                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:p_char:char(1), 8:p_varchar:varchar(5), 9:rowindex:int, 10:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 11:ROW__IS__DELETED:boolean]
                   Filter Operator
                     Filter Vectorization:
                         className: VectorFilterOperator
@@ -4157,11 +4167,11 @@ STAGE PLANS:
                       Map-reduce partition columns: DATE'1970-01-03' (type: date)
                       Reduce Sink Vectorization:
                           className: VectorReduceSinkLongOperator
-                          keyColumns: 10:date
-                          keyExpressions: ConstantVectorExpression(val 2) -> 10:date
+                          keyColumns: 12:date
+                          keyExpressions: ConstantVectorExpression(val 2) -> 12:date
                           native: true
                           nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez, spark] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
-                          valueColumns: 0:string, 1:string, 3:timestamp, 5:double, 7:int
+                          valueColumns: 0:string, 1:string, 3:timestamp, 5:double, 9:int
                       Statistics: Num rows: 20 Data size: 6264 Basic stats: COMPLETE Column stats: COMPLETE
                       value expressions: p_mfgr (type: string), p_name (type: string), p_timestamp (type: timestamp), p_retailprice (type: double), rowindex (type: int)
             Execution mode: vectorized, llap
@@ -4176,9 +4186,9 @@ STAGE PLANS:
                 usesVectorUDFAdaptor: false
                 vectorized: true
                 rowBatchContext:
-                    dataColumnCount: 8
-                    includeColumns: [0, 1, 2, 3, 5, 7]
-                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, rowindex:int
+                    dataColumnCount: 10
+                    includeColumns: [0, 1, 2, 3, 5, 9]
+                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, p_char:char(1), p_varchar:varchar(5), rowindex:int
                     partitionColumnCount: 0
                     scratchColumnTypeNames: [bigint]
         Reducer 2 
@@ -4193,13 +4203,13 @@ STAGE PLANS:
                 vectorized: true
                 rowBatchContext:
                     dataColumnCount: 6
-                    dataColumns: KEY.reducesinkkey0:date, VALUE._col0:string, VALUE._col1:string, VALUE._col3:timestamp, VALUE._col5:double, VALUE._col7:int
+                    dataColumns: KEY.reducesinkkey0:date, VALUE._col0:string, VALUE._col1:string, VALUE._col3:timestamp, VALUE._col5:double, VALUE._col9:int
                     partitionColumnCount: 0
                     scratchColumnTypeNames: [bigint, double, bigint, bigint, bigint]
             Reduce Operator Tree:
               Select Operator
-                expressions: VALUE._col0 (type: string), VALUE._col1 (type: string), VALUE._col3 (type: timestamp), VALUE._col5 (type: double), VALUE._col7 (type: int)
-                outputColumnNames: _col0, _col1, _col3, _col5, _col7
+                expressions: VALUE._col0 (type: string), VALUE._col1 (type: string), VALUE._col3 (type: timestamp), VALUE._col5 (type: double), VALUE._col9 (type: int)
+                outputColumnNames: _col0, _col1, _col3, _col5, _col9
                 Select Vectorization:
                     className: VectorSelectOperator
                     native: true
@@ -4209,7 +4219,7 @@ STAGE PLANS:
                   Function definitions:
                       Input definition
                         input alias: ptf_0
-                        output shape: _col0: string, _col1: string, _col3: timestamp, _col5: double, _col7: int
+                        output shape: _col0: string, _col1: string, _col3: timestamp, _col5: double, _col9: int
                         type: WINDOWING
                       Windowing table definition
                         input alias: ptf_1
@@ -4246,7 +4256,7 @@ STAGE PLANS:
                       streamingColumns: []
                   Statistics: Num rows: 20 Data size: 5312 Basic stats: COMPLETE Column stats: COMPLETE
                   Select Operator
-                    expressions: _col0 (type: string), _col1 (type: string), _col3 (type: timestamp), _col7 (type: int), DATE'1970-01-03' (type: date), _col5 (type: double), count_window_0 (type: bigint), sum_window_1 (type: double)
+                    expressions: _col0 (type: string), _col1 (type: string), _col3 (type: timestamp), _col9 (type: int), DATE'1970-01-03' (type: date), _col5 (type: double), count_window_0 (type: bigint), sum_window_1 (type: double)
                     outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                     Select Vectorization:
                         className: VectorSelectOperator
@@ -4417,7 +4427,7 @@ STAGE PLANS:
                   Statistics: Num rows: 40 Data size: 12556 Basic stats: COMPLETE Column stats: COMPLETE
                   TableScan Vectorization:
                       native: true
-                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:rowindex:int, 8:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 9:ROW__IS__DELETED:boolean]
+                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:p_char:char(1), 8:p_varchar:varchar(5), 9:rowindex:int, 10:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 11:ROW__IS__DELETED:boolean]
                   Reduce Output Operator
                     key expressions: p_mfgr (type: string), p_int (type: int)
                     null sort order: az
@@ -4429,7 +4439,7 @@ STAGE PLANS:
                         native: true
                         nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez, spark] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
                         partitionColumns: 0:string
-                        valueColumns: 1:string, 2:date, 3:timestamp, 5:double, 7:int
+                        valueColumns: 1:string, 2:date, 3:timestamp, 5:double, 9:int
                     Statistics: Num rows: 40 Data size: 12556 Basic stats: COMPLETE Column stats: COMPLETE
                     value expressions: p_name (type: string), p_date (type: date), p_timestamp (type: timestamp), p_retailprice (type: double), rowindex (type: int)
             Execution mode: vectorized, llap
@@ -4444,9 +4454,9 @@ STAGE PLANS:
                 usesVectorUDFAdaptor: false
                 vectorized: true
                 rowBatchContext:
-                    dataColumnCount: 8
-                    includeColumns: [0, 1, 2, 3, 4, 5, 7]
-                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, rowindex:int
+                    dataColumnCount: 10
+                    includeColumns: [0, 1, 2, 3, 4, 5, 9]
+                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, p_char:char(1), p_varchar:varchar(5), rowindex:int
                     partitionColumnCount: 0
                     scratchColumnTypeNames: []
         Reducer 2 
@@ -4461,13 +4471,13 @@ STAGE PLANS:
                 vectorized: true
                 rowBatchContext:
                     dataColumnCount: 7
-                    dataColumns: KEY.reducesinkkey0:string, KEY.reducesinkkey1:int, VALUE._col0:string, VALUE._col1:date, VALUE._col2:timestamp, VALUE._col3:double, VALUE._col5:int
+                    dataColumns: KEY.reducesinkkey0:string, KEY.reducesinkkey1:int, VALUE._col0:string, VALUE._col1:date, VALUE._col2:timestamp, VALUE._col3:double, VALUE._col7:int
                     partitionColumnCount: 0
                     scratchColumnTypeNames: [bigint, double]
             Reduce Operator Tree:
               Select Operator
-                expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string), VALUE._col1 (type: date), VALUE._col2 (type: timestamp), KEY.reducesinkkey1 (type: int), VALUE._col3 (type: double), VALUE._col5 (type: int)
-                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col7
+                expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string), VALUE._col1 (type: date), VALUE._col2 (type: timestamp), KEY.reducesinkkey1 (type: int), VALUE._col3 (type: double), VALUE._col7 (type: int)
+                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col9
                 Select Vectorization:
                     className: VectorSelectOperator
                     native: true
@@ -4477,7 +4487,7 @@ STAGE PLANS:
                   Function definitions:
                       Input definition
                         input alias: ptf_0
-                        output shape: _col0: string, _col1: string, _col2: date, _col3: timestamp, _col4: int, _col5: double, _col7: int
+                        output shape: _col0: string, _col1: string, _col2: date, _col3: timestamp, _col4: int, _col5: double, _col9: int
                         type: WINDOWING
                       Windowing table definition
                         input alias: ptf_1
@@ -4514,7 +4524,7 @@ STAGE PLANS:
                       streamingColumns: []
                   Statistics: Num rows: 40 Data size: 12556 Basic stats: COMPLETE Column stats: COMPLETE
                   Select Operator
-                    expressions: _col0 (type: string), _col1 (type: string), _col3 (type: timestamp), _col7 (type: int), _col2 (type: date), _col5 (type: double), _col4 (type: int), count_window_0 (type: bigint), sum_window_1 (type: double)
+                    expressions: _col0 (type: string), _col1 (type: string), _col3 (type: timestamp), _col9 (type: int), _col2 (type: date), _col5 (type: double), _col4 (type: int), count_window_0 (type: bigint), sum_window_1 (type: double)
                     outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                     Select Vectorization:
                         className: VectorSelectOperator
@@ -4641,7 +4651,7 @@ STAGE PLANS:
                   Statistics: Num rows: 40 Data size: 12556 Basic stats: COMPLETE Column stats: COMPLETE
                   TableScan Vectorization:
                       native: true
-                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:rowindex:int, 8:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 9:ROW__IS__DELETED:boolean]
+                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:p_char:char(1), 8:p_varchar:varchar(5), 9:rowindex:int, 10:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 11:ROW__IS__DELETED:boolean]
                   Reduce Output Operator
                     key expressions: p_int (type: int)
                     null sort order: a
@@ -4652,7 +4662,7 @@ STAGE PLANS:
                         keyColumns: 4:int
                         native: true
                         nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez, spark] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
-                        valueColumns: 0:string, 1:string, 2:date, 3:timestamp, 5:double, 7:int
+                        valueColumns: 0:string, 1:string, 2:date, 3:timestamp, 5:double, 9:int
                     Statistics: Num rows: 40 Data size: 12556 Basic stats: COMPLETE Column stats: COMPLETE
                     value expressions: p_mfgr (type: string), p_name (type: string), p_date (type: date), p_timestamp (type: timestamp), p_retailprice (type: double), rowindex (type: int)
             Execution mode: vectorized, llap
@@ -4667,9 +4677,9 @@ STAGE PLANS:
                 usesVectorUDFAdaptor: false
                 vectorized: true
                 rowBatchContext:
-                    dataColumnCount: 8
-                    includeColumns: [0, 1, 2, 3, 4, 5, 7]
-                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, rowindex:int
+                    dataColumnCount: 10
+                    includeColumns: [0, 1, 2, 3, 4, 5, 9]
+                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, p_char:char(1), p_varchar:varchar(5), rowindex:int
                     partitionColumnCount: 0
                     scratchColumnTypeNames: []
         Reducer 2 
@@ -4684,13 +4694,13 @@ STAGE PLANS:
                 vectorized: true
                 rowBatchContext:
                     dataColumnCount: 7
-                    dataColumns: KEY.reducesinkkey0:int, VALUE._col0:string, VALUE._col1:string, VALUE._col2:date, VALUE._col3:timestamp, VALUE._col4:double, VALUE._col6:int
+                    dataColumns: KEY.reducesinkkey0:int, VALUE._col0:string, VALUE._col1:string, VALUE._col2:date, VALUE._col3:timestamp, VALUE._col4:double, VALUE._col8:int
                     partitionColumnCount: 0
                     scratchColumnTypeNames: [bigint, double]
             Reduce Operator Tree:
               Select Operator
-                expressions: VALUE._col0 (type: string), VALUE._col1 (type: string), VALUE._col2 (type: date), VALUE._col3 (type: timestamp), KEY.reducesinkkey0 (type: int), VALUE._col4 (type: double), VALUE._col6 (type: int)
-                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col7
+                expressions: VALUE._col0 (type: string), VALUE._col1 (type: string), VALUE._col2 (type: date), VALUE._col3 (type: timestamp), KEY.reducesinkkey0 (type: int), VALUE._col4 (type: double), VALUE._col8 (type: int)
+                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col9
                 Select Vectorization:
                     className: VectorSelectOperator
                     native: true
@@ -4700,7 +4710,7 @@ STAGE PLANS:
                   Function definitions:
                       Input definition
                         input alias: ptf_0
-                        output shape: _col0: string, _col1: string, _col2: date, _col3: timestamp, _col4: int, _col5: double, _col7: int
+                        output shape: _col0: string, _col1: string, _col2: date, _col3: timestamp, _col4: int, _col5: double, _col9: int
                         type: WINDOWING
                       Windowing table definition
                         input alias: ptf_1
@@ -4737,7 +4747,7 @@ STAGE PLANS:
                       streamingColumns: []
                   Statistics: Num rows: 40 Data size: 12556 Basic stats: COMPLETE Column stats: COMPLETE
                   Select Operator
-                    expressions: _col0 (type: string), _col1 (type: string), _col3 (type: timestamp), _col7 (type: int), _col2 (type: date), _col5 (type: double), _col4 (type: int), count_window_0 (type: bigint), sum_window_1 (type: double)
+                    expressions: _col0 (type: string), _col1 (type: string), _col3 (type: timestamp), _col9 (type: int), _col2 (type: date), _col5 (type: double), _col4 (type: int), count_window_0 (type: bigint), sum_window_1 (type: double)
                     outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                     Select Vectorization:
                         className: VectorSelectOperator
@@ -4867,12 +4877,12 @@ STAGE PLANS:
                   Statistics: Num rows: 40 Data size: 12556 Basic stats: COMPLETE Column stats: COMPLETE
                   TableScan Vectorization:
                       native: true
-                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:rowindex:int, 8:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 9:ROW__IS__DELETED:boolean]
+                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:p_char:char(1), 8:p_varchar:varchar(5), 9:rowindex:int, 10:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 11:ROW__IS__DELETED:boolean]
                   Filter Operator
                     Filter Vectorization:
                         className: VectorFilterOperator
                         native: true
-                        predicateExpression: FilterStringGroupColEqualStringScalar(col 10:string, val 115200)(children: CastDateToString(col 2:date) -> 10:string)
+                        predicateExpression: FilterStringGroupColEqualStringScalar(col 12:string, val 115200)(children: CastDateToString(col 2:date) -> 12:string)
                     predicate: (CAST( p_date AS STRING) = '115200') (type: boolean)
                     Statistics: Num rows: 20 Data size: 6332 Basic stats: COMPLETE Column stats: COMPLETE
                     Reduce Output Operator
@@ -4885,7 +4895,7 @@ STAGE PLANS:
                           keyColumns: 4:int
                           native: true
                           nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez, spark] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
-                          valueColumns: 0:string, 1:string, 2:date, 3:timestamp, 5:double, 7:int
+                          valueColumns: 0:string, 1:string, 2:date, 3:timestamp, 5:double, 9:int
                       Statistics: Num rows: 20 Data size: 6332 Basic stats: COMPLETE Column stats: COMPLETE
                       value expressions: p_mfgr (type: string), p_name (type: string), p_date (type: date), p_timestamp (type: timestamp), p_retailprice (type: double), rowindex (type: int)
             Execution mode: vectorized, llap
@@ -4900,9 +4910,9 @@ STAGE PLANS:
                 usesVectorUDFAdaptor: false
                 vectorized: true
                 rowBatchContext:
-                    dataColumnCount: 8
-                    includeColumns: [0, 1, 2, 3, 4, 5, 7]
-                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, rowindex:int
+                    dataColumnCount: 10
+                    includeColumns: [0, 1, 2, 3, 4, 5, 9]
+                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, p_char:char(1), p_varchar:varchar(5), rowindex:int
                     partitionColumnCount: 0
                     scratchColumnTypeNames: [string]
         Reducer 2 
@@ -4917,13 +4927,13 @@ STAGE PLANS:
                 vectorized: true
                 rowBatchContext:
                     dataColumnCount: 7
-                    dataColumns: KEY.reducesinkkey0:int, VALUE._col0:string, VALUE._col1:string, VALUE._col2:date, VALUE._col3:timestamp, VALUE._col4:double, VALUE._col6:int
+                    dataColumns: KEY.reducesinkkey0:int, VALUE._col0:string, VALUE._col1:string, VALUE._col2:date, VALUE._col3:timestamp, VALUE._col4:double, VALUE._col8:int
                     partitionColumnCount: 0
                     scratchColumnTypeNames: [bigint, double]
             Reduce Operator Tree:
               Select Operator
-                expressions: VALUE._col0 (type: string), VALUE._col1 (type: string), VALUE._col2 (type: date), VALUE._col3 (type: timestamp), KEY.reducesinkkey0 (type: int), VALUE._col4 (type: double), VALUE._col6 (type: int)
-                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col7
+                expressions: VALUE._col0 (type: string), VALUE._col1 (type: string), VALUE._col2 (type: date), VALUE._col3 (type: timestamp), KEY.reducesinkkey0 (type: int), VALUE._col4 (type: double), VALUE._col8 (type: int)
+                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col9
                 Select Vectorization:
                     className: VectorSelectOperator
                     native: true
@@ -4933,7 +4943,7 @@ STAGE PLANS:
                   Function definitions:
                       Input definition
                         input alias: ptf_0
-                        output shape: _col0: string, _col1: string, _col2: date, _col3: timestamp, _col4: int, _col5: double, _col7: int
+                        output shape: _col0: string, _col1: string, _col2: date, _col3: timestamp, _col4: int, _col5: double, _col9: int
                         type: WINDOWING
                       Windowing table definition
                         input alias: ptf_1
@@ -4970,7 +4980,7 @@ STAGE PLANS:
                       streamingColumns: []
                   Statistics: Num rows: 20 Data size: 6332 Basic stats: COMPLETE Column stats: COMPLETE
                   Select Operator
-                    expressions: _col0 (type: string), _col1 (type: string), _col3 (type: timestamp), _col7 (type: int), _col2 (type: date), _col5 (type: double), _col4 (type: int), count_window_0 (type: bigint), sum_window_1 (type: double)
+                    expressions: _col0 (type: string), _col1 (type: string), _col3 (type: timestamp), _col9 (type: int), _col2 (type: date), _col5 (type: double), _col4 (type: int), count_window_0 (type: bigint), sum_window_1 (type: double)
                     outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                     Select Vectorization:
                         className: VectorSelectOperator
@@ -5140,7 +5150,7 @@ STAGE PLANS:
                   Statistics: Num rows: 40 Data size: 16568 Basic stats: COMPLETE Column stats: COMPLETE
                   TableScan Vectorization:
                       native: true
-                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:rowindex:int, 8:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 9:ROW__IS__DELETED:boolean]
+                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:p_char:char(1), 8:p_varchar:varchar(5), 9:rowindex:int, 10:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 11:ROW__IS__DELETED:boolean]
                   Reduce Output Operator
                     key expressions: p_mfgr (type: string), p_decimal (type: decimal(10,4))
                     null sort order: az
@@ -5152,7 +5162,7 @@ STAGE PLANS:
                         native: true
                         nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez, spark] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
                         partitionColumns: 0:string
-                        valueColumns: 1:string, 2:date, 3:timestamp, 5:double, 7:int
+                        valueColumns: 1:string, 2:date, 3:timestamp, 5:double, 9:int
                     Statistics: Num rows: 40 Data size: 16568 Basic stats: COMPLETE Column stats: COMPLETE
                     value expressions: p_name (type: string), p_date (type: date), p_timestamp (type: timestamp), p_retailprice (type: double), rowindex (type: int)
             Execution mode: vectorized, llap
@@ -5167,9 +5177,9 @@ STAGE PLANS:
                 usesVectorUDFAdaptor: false
                 vectorized: true
                 rowBatchContext:
-                    dataColumnCount: 8
-                    includeColumns: [0, 1, 2, 3, 5, 6, 7]
-                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, rowindex:int
+                    dataColumnCount: 10
+                    includeColumns: [0, 1, 2, 3, 5, 6, 9]
+                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, p_char:char(1), p_varchar:varchar(5), rowindex:int
                     partitionColumnCount: 0
                     scratchColumnTypeNames: []
         Reducer 2 
@@ -5184,13 +5194,13 @@ STAGE PLANS:
                 vectorized: true
                 rowBatchContext:
                     dataColumnCount: 7
-                    dataColumns: KEY.reducesinkkey0:string, KEY.reducesinkkey1:decimal(10,4), VALUE._col0:string, VALUE._col1:date, VALUE._col2:timestamp, VALUE._col4:double, VALUE._col5:int
+                    dataColumns: KEY.reducesinkkey0:string, KEY.reducesinkkey1:decimal(10,4), VALUE._col0:string, VALUE._col1:date, VALUE._col2:timestamp, VALUE._col4:double, VALUE._col7:int
                     partitionColumnCount: 0
                     scratchColumnTypeNames: [bigint, double]
             Reduce Operator Tree:
               Select Operator
-                expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string), VALUE._col1 (type: date), VALUE._col2 (type: timestamp), VALUE._col4 (type: double), KEY.reducesinkkey1 (type: decimal(10,4)), VALUE._col5 (type: int)
-                outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col6, _col7
+                expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string), VALUE._col1 (type: date), VALUE._col2 (type: timestamp), VALUE._col4 (type: double), KEY.reducesinkkey1 (type: decimal(10,4)), VALUE._col7 (type: int)
+                outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col6, _col9
                 Select Vectorization:
                     className: VectorSelectOperator
                     native: true
@@ -5200,7 +5210,7 @@ STAGE PLANS:
                   Function definitions:
                       Input definition
                         input alias: ptf_0
-                        output shape: _col0: string, _col1: string, _col2: date, _col3: timestamp, _col5: double, _col6: decimal(10,4), _col7: int
+                        output shape: _col0: string, _col1: string, _col2: date, _col3: timestamp, _col5: double, _col6: decimal(10,4), _col9: int
                         type: WINDOWING
                       Windowing table definition
                         input alias: ptf_1
@@ -5237,7 +5247,7 @@ STAGE PLANS:
                       streamingColumns: []
                   Statistics: Num rows: 40 Data size: 16568 Basic stats: COMPLETE Column stats: COMPLETE
                   Select Operator
-                    expressions: _col0 (type: string), _col1 (type: string), _col3 (type: timestamp), _col7 (type: int), _col2 (type: date), _col6 (type: decimal(10,4)), _col5 (type: double), count_window_0 (type: bigint), sum_window_1 (type: double)
+                    expressions: _col0 (type: string), _col1 (type: string), _col3 (type: timestamp), _col9 (type: int), _col2 (type: date), _col6 (type: decimal(10,4)), _col5 (type: double), count_window_0 (type: bigint), sum_window_1 (type: double)
                     outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                     Select Vectorization:
                         className: VectorSelectOperator
@@ -5364,7 +5374,7 @@ STAGE PLANS:
                   Statistics: Num rows: 40 Data size: 16568 Basic stats: COMPLETE Column stats: COMPLETE
                   TableScan Vectorization:
                       native: true
-                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:rowindex:int, 8:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 9:ROW__IS__DELETED:boolean]
+                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:p_char:char(1), 8:p_varchar:varchar(5), 9:rowindex:int, 10:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 11:ROW__IS__DELETED:boolean]
                   Reduce Output Operator
                     key expressions: p_decimal (type: decimal(10,4))
                     null sort order: a
@@ -5375,7 +5385,7 @@ STAGE PLANS:
                         keyColumns: 6:decimal(10,4)
                         native: true
                         nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez, spark] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
-                        valueColumns: 0:string, 1:string, 2:date, 3:timestamp, 5:double, 7:int
+                        valueColumns: 0:string, 1:string, 2:date, 3:timestamp, 5:double, 9:int
                     Statistics: Num rows: 40 Data size: 16568 Basic stats: COMPLETE Column stats: COMPLETE
                     value expressions: p_mfgr (type: string), p_name (type: string), p_date (type: date), p_timestamp (type: timestamp), p_retailprice (type: double), rowindex (type: int)
             Execution mode: vectorized, llap
@@ -5390,9 +5400,9 @@ STAGE PLANS:
                 usesVectorUDFAdaptor: false
                 vectorized: true
                 rowBatchContext:
-                    dataColumnCount: 8
-                    includeColumns: [0, 1, 2, 3, 5, 6, 7]
-                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, rowindex:int
+                    dataColumnCount: 10
+                    includeColumns: [0, 1, 2, 3, 5, 6, 9]
+                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, p_char:char(1), p_varchar:varchar(5), rowindex:int
                     partitionColumnCount: 0
                     scratchColumnTypeNames: []
         Reducer 2 
@@ -5407,13 +5417,13 @@ STAGE PLANS:
                 vectorized: true
                 rowBatchContext:
                     dataColumnCount: 7
-                    dataColumns: KEY.reducesinkkey0:decimal(10,4), VALUE._col0:string, VALUE._col1:string, VALUE._col2:date, VALUE._col3:timestamp, VALUE._col5:double, VALUE._col6:int
+                    dataColumns: KEY.reducesinkkey0:decimal(10,4), VALUE._col0:string, VALUE._col1:string, VALUE._col2:date, VALUE._col3:timestamp, VALUE._col5:double, VALUE._col8:int
                     partitionColumnCount: 0
                     scratchColumnTypeNames: [bigint, double]
             Reduce Operator Tree:
               Select Operator
-                expressions: VALUE._col0 (type: string), VALUE._col1 (type: string), VALUE._col2 (type: date), VALUE._col3 (type: timestamp), VALUE._col5 (type: double), KEY.reducesinkkey0 (type: decimal(10,4)), VALUE._col6 (type: int)
-                outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col6, _col7
+                expressions: VALUE._col0 (type: string), VALUE._col1 (type: string), VALUE._col2 (type: date), VALUE._col3 (type: timestamp), VALUE._col5 (type: double), KEY.reducesinkkey0 (type: decimal(10,4)), VALUE._col8 (type: int)
+                outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col6, _col9
                 Select Vectorization:
                     className: VectorSelectOperator
                     native: true
@@ -5423,7 +5433,7 @@ STAGE PLANS:
                   Function definitions:
                       Input definition
                         input alias: ptf_0
-                        output shape: _col0: string, _col1: string, _col2: date, _col3: timestamp, _col5: double, _col6: decimal(10,4), _col7: int
+                        output shape: _col0: string, _col1: string, _col2: date, _col3: timestamp, _col5: double, _col6: decimal(10,4), _col9: int
                         type: WINDOWING
                       Windowing table definition
                         input alias: ptf_1
@@ -5460,7 +5470,7 @@ STAGE PLANS:
                       streamingColumns: []
                   Statistics: Num rows: 40 Data size: 16568 Basic stats: COMPLETE Column stats: COMPLETE
                   Select Operator
-                    expressions: _col0 (type: string), _col1 (type: string), _col3 (type: timestamp), _col7 (type: int), _col2 (type: date), _col6 (type: decimal(10,4)), _col5 (type: double), count_window_0 (type: bigint), sum_window_1 (type: double)
+                    expressions: _col0 (type: string), _col1 (type: string), _col3 (type: timestamp), _col9 (type: int), _col2 (type: date), _col6 (type: decimal(10,4)), _col5 (type: double), count_window_0 (type: bigint), sum_window_1 (type: double)
                     outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                     Select Vectorization:
                         className: VectorSelectOperator
@@ -5590,7 +5600,7 @@ STAGE PLANS:
                   Statistics: Num rows: 40 Data size: 16568 Basic stats: COMPLETE Column stats: COMPLETE
                   TableScan Vectorization:
                       native: true
-                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:rowindex:int, 8:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 9:ROW__IS__DELETED:boolean]
+                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:p_char:char(1), 8:p_varchar:varchar(5), 9:rowindex:int, 10:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 11:ROW__IS__DELETED:boolean]
                   Filter Operator
                     Filter Vectorization:
                         className: VectorFilterOperator
@@ -5605,11 +5615,11 @@ STAGE PLANS:
                       Map-reduce partition columns: CAST( 1800.7 AS decimal(10,4)) (type: decimal(10,4))
                       Reduce Sink Vectorization:
                           className: VectorReduceSinkMultiKeyOperator
-                          keyColumns: 10:decimal(10,4)
-                          keyExpressions: ConstantVectorExpression(val 1800.7) -> 10:decimal(10,4)
+                          keyColumns: 12:decimal(10,4)
+                          keyExpressions: ConstantVectorExpression(val 1800.7) -> 12:decimal(10,4)
                           native: true
                           nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez, spark] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
-                          valueColumns: 0:string, 1:string, 2:date, 3:timestamp, 5:double, 7:int
+                          valueColumns: 0:string, 1:string, 2:date, 3:timestamp, 5:double, 9:int
                       Statistics: Num rows: 2 Data size: 880 Basic stats: COMPLETE Column stats: COMPLETE
                       value expressions: p_mfgr (type: string), p_name (type: string), p_date (type: date), p_timestamp (type: timestamp), p_retailprice (type: double), rowindex (type: int)
             Execution mode: vectorized, llap
@@ -5624,9 +5634,9 @@ STAGE PLANS:
                 usesVectorUDFAdaptor: false
                 vectorized: true
                 rowBatchContext:
-                    dataColumnCount: 8
-                    includeColumns: [0, 1, 2, 3, 5, 6, 7]
-                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, rowindex:int
+                    dataColumnCount: 10
+                    includeColumns: [0, 1, 2, 3, 5, 6, 9]
+                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, p_char:char(1), p_varchar:varchar(5), rowindex:int
                     partitionColumnCount: 0
                     scratchColumnTypeNames: [decimal(10,4)]
         Reducer 2 
@@ -5641,13 +5651,13 @@ STAGE PLANS:
                 vectorized: true
                 rowBatchContext:
                     dataColumnCount: 7
-                    dataColumns: KEY.reducesinkkey0:decimal(10,4), VALUE._col0:string, VALUE._col1:string, VALUE._col2:date, VALUE._col3:timestamp, VALUE._col5:double, VALUE._col7:int
+                    dataColumns: KEY.reducesinkkey0:decimal(10,4), VALUE._col0:string, VALUE._col1:string, VALUE._col2:date, VALUE._col3:timestamp, VALUE._col5:double, VALUE._col9:int
                     partitionColumnCount: 0
                     scratchColumnTypeNames: [bigint, double, decimal(10,4), decimal(10,4), decimal(10,4)]
             Reduce Operator Tree:
               Select Operator
-                expressions: VALUE._col0 (type: string), VALUE._col1 (type: string), VALUE._col2 (type: date), VALUE._col3 (type: timestamp), VALUE._col5 (type: double), VALUE._col7 (type: int)
-                outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col7
+                expressions: VALUE._col0 (type: string), VALUE._col1 (type: string), VALUE._col2 (type: date), VALUE._col3 (type: timestamp), VALUE._col5 (type: double), VALUE._col9 (type: int)
+                outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col9
                 Select Vectorization:
                     className: VectorSelectOperator
                     native: true
@@ -5657,7 +5667,7 @@ STAGE PLANS:
                   Function definitions:
                       Input definition
                         input alias: ptf_0
-                        output shape: _col0: string, _col1: string, _col2: date, _col3: timestamp, _col5: double, _col7: int
+                        output shape: _col0: string, _col1: string, _col2: date, _col3: timestamp, _col5: double, _col9: int
                         type: WINDOWING
                       Windowing table definition
                         input alias: ptf_1
@@ -5694,7 +5704,7 @@ STAGE PLANS:
                       streamingColumns: []
                   Statistics: Num rows: 2 Data size: 656 Basic stats: COMPLETE Column stats: COMPLETE
                   Select Operator
-                    expressions: _col0 (type: string), _col1 (type: string), _col3 (type: timestamp), _col7 (type: int), _col2 (type: date), 1800.7 (type: decimal(10,4)), _col5 (type: double), count_window_0 (type: bigint), sum_window_1 (type: double)
+                    expressions: _col0 (type: string), _col1 (type: string), _col3 (type: timestamp), _col9 (type: int), _col2 (type: date), 1800.7 (type: decimal(10,4)), _col5 (type: double), count_window_0 (type: bigint), sum_window_1 (type: double)
                     outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                     Select Vectorization:
                         className: VectorSelectOperator
@@ -5739,3 +5749,1454 @@ p_mfgr	p_name	p_timestamp	rowindex	p_date	p_decimal	p_retailprice	cs	s
 Manufacturer#2	almond antique violet turquoise frosted	NULL	13	NULL	1800.7000	1800.7	3	5402.1
 Manufacturer#2	almond antique violet turquoise frosted	1970-01-01 00:00:00	21	1970-01-01	1800.7000	1800.7	3	5402.1
 Manufacturer#2	almond antique violet turquoise frosted	1970-01-02 00:00:00	27	1970-01-02	1800.7000	1800.7	3	5402.1
+PREHOOK: query: select "************ CHAR WINDOW RANGE TYPE ************"
+PREHOOK: type: QUERY
+PREHOOK: Input: _dummy_database@_dummy_table
+#### A masked pattern was here ####
+POSTHOOK: query: select "************ CHAR WINDOW RANGE TYPE ************"
+POSTHOOK: type: QUERY
+POSTHOOK: Input: _dummy_database@_dummy_table
+#### A masked pattern was here ####
+_c0
+************ CHAR WINDOW RANGE TYPE ************
+PREHOOK: query: select "************ CHAR WINDOW RANGE TYPE (NON-VECTORIZED REFERENCE) ************"
+PREHOOK: type: QUERY
+PREHOOK: Input: _dummy_database@_dummy_table
+#### A masked pattern was here ####
+POSTHOOK: query: select "************ CHAR WINDOW RANGE TYPE (NON-VECTORIZED REFERENCE) ************"
+POSTHOOK: type: QUERY
+POSTHOOK: Input: _dummy_database@_dummy_table
+#### A masked pattern was here ####
+_c0
+************ CHAR WINDOW RANGE TYPE (NON-VECTORIZED REFERENCE) ************
+PREHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice, p_char,
+       count(*) over(partition by p_mfgr order by p_char range between 3 preceding and current row) as cs,
+       sum(p_retailprice) over(partition by p_mfgr order by p_char range between 3 preceding and current row) as s
+from vector_ptf_part_simple_orc
+PREHOOK: type: QUERY
+PREHOOK: Input: default@vector_ptf_part_simple_orc
+#### A masked pattern was here ####
+POSTHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice, p_char,
+       count(*) over(partition by p_mfgr order by p_char range between 3 preceding and current row) as cs,
+       sum(p_retailprice) over(partition by p_mfgr order by p_char range between 3 preceding and current row) as s
+from vector_ptf_part_simple_orc
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@vector_ptf_part_simple_orc
+#### A masked pattern was here ####
+p_mfgr	p_name	p_timestamp	rowindex	p_date	p_retailprice	p_char	cs	s
+Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	20	1970-01-05	1753.76	A	3	2926.91
+Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	4	1970-01-04	NULL	A	3	2926.91
+Manufacturer#1	almond antique burnished rose metallic	1970-01-03 00:00:00	8	1970-01-03	1173.15	A	3	2926.91
+Manufacturer#1	almond aquamarine burnished black steel	1970-01-02 00:00:00	2	1970-01-02	1414.42	B	3	4800.84
+Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	5	1970-01-05	1753.76	B	3	4800.84
+Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	9	1970-01-04	1632.66	B	3	4800.84
+Manufacturer#1	almond antique salmon chartreuse burlywood	1970-01-05 00:00:00	30	1970-01-05	1602.59	C	2	3356.35
+Manufacturer#1	almond antique chartreuse lavender yellow	NULL	26	NULL	1753.76	C	2	3356.35
+Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-03 00:00:00	23	1970-01-03	1632.66	D	4	6192.23
+Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-02 00:00:00	12	1970-01-02	1753.76	D	4	6192.23
+Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-02 00:00:00	17	1970-01-02	1632.66	D	4	6192.23
+Manufacturer#1	almond antique burnished rose metallic	1970-01-04 00:00:00	39	1970-01-04	1173.15	D	4	6192.23
+Manufacturer#2	almond aquamarine sandy cyan gainsboro	NULL	32	NULL	1000.6	A	2	1901.26
+Manufacturer#2	almond aquamarine rose maroon antique	NULL	1	NULL	900.66	A	2	1901.26
+Manufacturer#2	almond antique violet turquoise frosted	1970-01-01 00:00:00	21	1970-01-01	1800.7	B	2	3601.4
+Manufacturer#2	almond antique violet turquoise frosted	NULL	13	NULL	1800.7	B	2	3601.4
+Manufacturer#2	almond aquamarine midnight light salmon	1970-01-04 00:00:00	34	1970-01-04	2031.98	C	2	3730.6400000000003
+Manufacturer#2	almond aquamarine rose maroon antique	1970-01-03 00:00:00	3	1970-01-03	1698.66	C	2	3730.6400000000003
+Manufacturer#2	almond antique violet turquoise frosted	1970-01-02 00:00:00	27	1970-01-02	1800.7	D	2	3491.38
+Manufacturer#2	almond antique violet chocolate turquoise	1970-01-05 00:00:00	15	1970-01-05	1690.68	D	2	3491.38
+Manufacturer#3	almond antique olive coral navajo	1970-01-03 00:00:00	28	1970-01-03	1337.29	A	1	1337.29
+Manufacturer#3	almond antique forest lavender goldenrod	1970-01-03 00:00:00	33	1970-01-03	1190.27	B	1	1190.27
+Manufacturer#3	almond antique chartreuse khaki white	1970-01-04 00:00:00	24	1970-01-04	99.68	C	3	1289.95
+Manufacturer#3	almond antique forest lavender goldenrod	1970-01-04 00:00:00	14	1970-01-04	NULL	C	3	1289.95
+Manufacturer#3	almond antique forest lavender goldenrod	1970-01-05 00:00:00	10	1970-01-05	1190.27	C	3	1289.95
+Manufacturer#3	almond antique misty red olive	1970-01-01 00:00:00	31	1970-01-01	1922.98	D	3	2568.6400000000003
+Manufacturer#3	almond antique metallic orange dim	NULL	38	NULL	55.39	D	3	2568.6400000000003
+Manufacturer#3	almond antique forest lavender goldenrod	NULL	19	NULL	590.27	D	3	2568.6400000000003
+Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	35	1970-01-05	NULL	A	2	NULL
+Manufacturer#4	almond antique gainsboro frosted violet	NULL	25	NULL	NULL	A	2	NULL
+Manufacturer#4	almond antique violet mint lemon	1970-01-01 00:00:00	16	1970-01-01	1375.42	B	1	1375.42
+Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	40	1970-01-05	1206.26	C	2	2496.6099999999997
+Manufacturer#4	almond azure aquamarine papaya violet	1970-01-02 00:00:00	37	1970-01-02	1290.35	C	2	2496.6099999999997
+Manufacturer#4	almond aquamarine yellow dodger mint	1970-01-01 00:00:00	11	1970-01-01	1844.92	D	1	1844.92
+Manufacturer#5	almond antique sky peru orange	1970-01-02 00:00:00	22	1970-01-02	1788.73	A	1	1788.73
+Manufacturer#5	almond aquamarine dodger light gainsboro	1970-01-01 00:00:00	36	1970-01-01	1018.1	B	2	2629.76
+Manufacturer#5	almond antique medium spring khaki	1970-01-04 00:00:00	29	1970-01-04	1611.66	B	2	2629.76
+Manufacturer#5	almond azure blanched chiffon midnight	1970-01-03 00:00:00	18	1970-01-03	1464.48	C	2	3076.1400000000003
+Manufacturer#5	almond antique medium spring khaki	1970-01-01 00:00:00	6	1970-01-01	1611.66	C	2	3076.1400000000003
+Manufacturer#5	almond antique blue firebrick mint	NULL	7	NULL	1789.69	D	1	1789.69
+PREHOOK: query: select "************ CHAR WINDOW RANGE TYPE (VECTORIZED) ************"
+PREHOOK: type: QUERY
+PREHOOK: Input: _dummy_database@_dummy_table
+#### A masked pattern was here ####
+POSTHOOK: query: select "************ CHAR WINDOW RANGE TYPE (VECTORIZED) ************"
+POSTHOOK: type: QUERY
+POSTHOOK: Input: _dummy_database@_dummy_table
+#### A masked pattern was here ####
+_c0
+************ CHAR WINDOW RANGE TYPE (VECTORIZED) ************
+PREHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_char,
+                                    count(*) over(partition by p_mfgr order by p_char range between 3 preceding and
+                                    current row) as cs,
+                                    sum(p_retailprice) over(partition by p_mfgr order by p_char range between 3 preceding and current row) as s
+from vector_ptf_part_simple_orc
+PREHOOK: type: QUERY
+PREHOOK: Input: default@vector_ptf_part_simple_orc
+#### A masked pattern was here ####
+POSTHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_char,
+                                    count(*) over(partition by p_mfgr order by p_char range between 3 preceding and
+                                    current row) as cs,
+                                    sum(p_retailprice) over(partition by p_mfgr order by p_char range between 3 preceding and current row) as s
+from vector_ptf_part_simple_orc
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@vector_ptf_part_simple_orc
+#### A masked pattern was here ####
+Explain
+PLAN VECTORIZATION:
+  enabled: true
+  enabledConditionsMet: [hive.vectorized.execution.enabled IS true]
+
+STAGE DEPENDENCIES:
+  Stage-1 is a root stage
+  Stage-0 depends on stages: Stage-1
+
+STAGE PLANS:
+  Stage: Stage-1
+    Tez
+#### A masked pattern was here ####
+      Edges:
+        Reducer 2 <- Map 1 (SIMPLE_EDGE)
+#### A masked pattern was here ####
+      Vertices:
+        Map 1 
+            Map Operator Tree:
+                TableScan
+                  alias: vector_ptf_part_simple_orc
+                  Statistics: Num rows: 40 Data size: 15824 Basic stats: COMPLETE Column stats: COMPLETE
+                  TableScan Vectorization:
+                      native: true
+                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:p_char:char(1), 8:p_varchar:varchar(5), 9:rowindex:int, 10:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 11:ROW__IS__DELETED:boolean]
+                  Reduce Output Operator
+                    key expressions: p_mfgr (type: string), p_char (type: char(1))
+                    null sort order: az
+                    sort order: ++
+                    Map-reduce partition columns: p_mfgr (type: string)
+                    Reduce Sink Vectorization:
+                        className: VectorReduceSinkObjectHashOperator
+                        keyColumns: 0:string, 7:char(1)
+                        native: true
+                        nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez, spark] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
+                        partitionColumns: 0:string
+                        valueColumns: 1:string, 2:date, 3:timestamp, 5:double, 9:int
+                    Statistics: Num rows: 40 Data size: 15824 Basic stats: COMPLETE Column stats: COMPLETE
+                    value expressions: p_name (type: string), p_date (type: date), p_timestamp (type: timestamp), p_retailprice (type: double), rowindex (type: int)
+            Execution mode: vectorized, llap
+            LLAP IO: all inputs
+            Map Vectorization:
+                enabled: true
+                enabledConditionsMet: hive.vectorized.use.vectorized.input.format IS true
+                inputFormatFeatureSupport: [DECIMAL_64]
+                featureSupportInUse: [DECIMAL_64]
+                inputFileFormats: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
+                allNative: true
+                usesVectorUDFAdaptor: false
+                vectorized: true
+                rowBatchContext:
+                    dataColumnCount: 10
+                    includeColumns: [0, 1, 2, 3, 5, 7, 9]
+                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, p_char:char(1), p_varchar:varchar(5), rowindex:int
+                    partitionColumnCount: 0
+                    scratchColumnTypeNames: []
+        Reducer 2 
+            Execution mode: vectorized, llap
+            Reduce Vectorization:
+                enabled: true
+                enableConditionsMet: hive.vectorized.execution.reduce.enabled IS true, hive.execution.engine tez IN [tez, spark] IS true
+                reduceColumnNullOrder: az
+                reduceColumnSortOrder: ++
+                allNative: false
+                usesVectorUDFAdaptor: false
+                vectorized: true
+                rowBatchContext:
+                    dataColumnCount: 7
+                    dataColumns: KEY.reducesinkkey0:string, KEY.reducesinkkey1:char(1), VALUE._col0:string, VALUE._col1:date, VALUE._col2:timestamp, VALUE._col4:double, VALUE._col7:int
+                    partitionColumnCount: 0
+                    scratchColumnTypeNames: [bigint, double]
+            Reduce Operator Tree:
+              Select Operator
+                expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string), VALUE._col1 (type: date), VALUE._col2 (type: timestamp), VALUE._col4 (type: double), KEY.reducesinkkey1 (type: char(1)), VALUE._col7 (type: int)
+                outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col7, _col9
+                Select Vectorization:
+                    className: VectorSelectOperator
+                    native: true
+                    projectedOutputColumnNums: [0, 2, 3, 4, 5, 1, 6]
+                Statistics: Num rows: 40 Data size: 15824 Basic stats: COMPLETE Column stats: COMPLETE
+                PTF Operator
+                  Function definitions:
+                      Input definition
+                        input alias: ptf_0
+                        output shape: _col0: string, _col1: string, _col2: date, _col3: timestamp, _col5: double, _col7: char(1), _col9: int
+                        type: WINDOWING
+                      Windowing table definition
+                        input alias: ptf_1
+                        name: windowingtablefunction
+                        order by: _col7 ASC NULLS LAST
+                        partition by: _col0
+                        raw input shape:
+                        window functions:
+                            window function definition
+                              alias: count_window_0
+                              name: count
+                              window function: GenericUDAFCountEvaluator
+                              window frame: RANGE PRECEDING(3)~CURRENT
+                              isStar: true
+                            window function definition
+                              alias: sum_window_1
+                              arguments: _col5
+                              name: sum
+                              window function: GenericUDAFSumDouble
+                              window frame: RANGE PRECEDING(3)~CURRENT
+                  PTF Vectorization:
+                      allEvaluatorsAreStreaming: false
+                      className: VectorPTFOperator
+                      evaluatorClasses: [VectorPTFEvaluatorCountStar, VectorPTFEvaluatorDoubleSum]
+                      functionInputExpressions: [null, col 5:double]
+                      functionNames: [count, sum]
+                      keyInputColumns: [0, 1]
+                      native: true
+                      nonKeyInputColumns: [2, 3, 4, 5, 6]
+                      orderExpressions: [col 1:char(1)]
+                      outputColumns: [7, 8, 0, 2, 3, 4, 5, 1, 6]
+                      outputTypes: [bigint, double, string, string, date, timestamp, double, char(1), int]
+                      partitionExpressions: [col 0:string]
+                      streamingColumns: []
+                  Statistics: Num rows: 40 Data size: 15824 Basic stats: COMPLETE Column stats: COMPLETE
+                  Select Operator
+                    expressions: _col0 (type: string), _col1 (type: string), _col3 (type: timestamp), _col9 (type: int), _col2 (type: date), _col5 (type: double), _col7 (type: char(1)), count_window_0 (type: bigint), sum_window_1 (type: double)
+                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
+                    Select Vectorization:
+                        className: VectorSelectOperator
+                        native: true
+                        projectedOutputColumnNums: [0, 2, 4, 6, 3, 5, 1, 7, 8]
+                    Statistics: Num rows: 40 Data size: 15664 Basic stats: COMPLETE Column stats: COMPLETE
+                    File Output Operator
+                      compressed: false
+                      File Sink Vectorization:
+                          className: VectorFileSinkOperator
+                          native: false
+                      Statistics: Num rows: 40 Data size: 15664 Basic stats: COMPLETE Column stats: COMPLETE
+                      table:
+                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+
+  Stage: Stage-0
+    Fetch Operator
+      limit: -1
+      Processor Tree:
+        ListSink
+
+PREHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_char,
+       count(*) over(partition by p_mfgr order by p_char range between 3 preceding and current row) as cs,
+       sum(p_retailprice) over(partition by p_mfgr order by p_char range between 3 preceding and current row) as s
+from vector_ptf_part_simple_orc
+PREHOOK: type: QUERY
+PREHOOK: Input: default@vector_ptf_part_simple_orc
+#### A masked pattern was here ####
+POSTHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_char,
+       count(*) over(partition by p_mfgr order by p_char range between 3 preceding and current row) as cs,
+       sum(p_retailprice) over(partition by p_mfgr order by p_char range between 3 preceding and current row) as s
+from vector_ptf_part_simple_orc
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@vector_ptf_part_simple_orc
+#### A masked pattern was here ####
+p_mfgr	p_name	p_timestamp	rowindex	p_date	p_retailprice	p_char	cs	s
+Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	20	1970-01-05	1753.76	A	3	2926.91
+Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	4	1970-01-04	NULL	A	3	2926.91
+Manufacturer#1	almond antique burnished rose metallic	1970-01-03 00:00:00	8	1970-01-03	1173.15	A	3	2926.91
+Manufacturer#1	almond aquamarine burnished black steel	1970-01-02 00:00:00	2	1970-01-02	1414.42	B	3	4800.84
+Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	5	1970-01-05	1753.76	B	3	4800.84
+Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	9	1970-01-04	1632.66	B	3	4800.84
+Manufacturer#1	almond antique salmon chartreuse burlywood	1970-01-05 00:00:00	30	1970-01-05	1602.59	C	2	3356.35
+Manufacturer#1	almond antique chartreuse lavender yellow	NULL	26	NULL	1753.76	C	2	3356.35
+Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-03 00:00:00	23	1970-01-03	1632.66	D	4	6192.2300000000005
+Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-02 00:00:00	12	1970-01-02	1753.76	D	4	6192.2300000000005
+Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-02 00:00:00	17	1970-01-02	1632.66	D	4	6192.2300000000005
+Manufacturer#1	almond antique burnished rose metallic	1970-01-04 00:00:00	39	1970-01-04	1173.15	D	4	6192.2300000000005
+Manufacturer#2	almond aquamarine sandy cyan gainsboro	NULL	32	NULL	1000.6	A	2	1901.26
+Manufacturer#2	almond aquamarine rose maroon antique	NULL	1	NULL	900.66	A	2	1901.26
+Manufacturer#2	almond antique violet turquoise frosted	1970-01-01 00:00:00	21	1970-01-01	1800.7	B	2	3601.4
+Manufacturer#2	almond antique violet turquoise frosted	NULL	13	NULL	1800.7	B	2	3601.4
+Manufacturer#2	almond aquamarine midnight light salmon	1970-01-04 00:00:00	34	1970-01-04	2031.98	C	2	3730.6400000000003
+Manufacturer#2	almond aquamarine rose maroon antique	1970-01-03 00:00:00	3	1970-01-03	1698.66	C	2	3730.6400000000003
+Manufacturer#2	almond antique violet turquoise frosted	1970-01-02 00:00:00	27	1970-01-02	1800.7	D	2	3491.38
+Manufacturer#2	almond antique violet chocolate turquoise	1970-01-05 00:00:00	15	1970-01-05	1690.68	D	2	3491.38
+Manufacturer#3	almond antique olive coral navajo	1970-01-03 00:00:00	28	1970-01-03	1337.29	A	1	1337.29
+Manufacturer#3	almond antique forest lavender goldenrod	1970-01-03 00:00:00	33	1970-01-03	1190.27	B	1	1190.27
+Manufacturer#3	almond antique chartreuse khaki white	1970-01-04 00:00:00	24	1970-01-04	99.68	C	3	1289.95
+Manufacturer#3	almond antique forest lavender goldenrod	1970-01-04 00:00:00	14	1970-01-04	NULL	C	3	1289.95
+Manufacturer#3	almond antique forest lavender goldenrod	1970-01-05 00:00:00	10	1970-01-05	1190.27	C	3	1289.95
+Manufacturer#3	almond antique misty red olive	1970-01-01 00:00:00	31	1970-01-01	1922.98	D	3	2568.6400000000003
+Manufacturer#3	almond antique metallic orange dim	NULL	38	NULL	55.39	D	3	2568.6400000000003
+Manufacturer#3	almond antique forest lavender goldenrod	NULL	19	NULL	590.27	D	3	2568.6400000000003
+Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	35	1970-01-05	NULL	A	2	NULL
+Manufacturer#4	almond antique gainsboro frosted violet	NULL	25	NULL	NULL	A	2	NULL
+Manufacturer#4	almond antique violet mint lemon	1970-01-01 00:00:00	16	1970-01-01	1375.42	B	1	1375.42
+Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	40	1970-01-05	1206.26	C	2	2496.6099999999997
+Manufacturer#4	almond azure aquamarine papaya violet	1970-01-02 00:00:00	37	1970-01-02	1290.35	C	2	2496.6099999999997
+Manufacturer#4	almond aquamarine yellow dodger mint	1970-01-01 00:00:00	11	1970-01-01	1844.92	D	1	1844.92
+Manufacturer#5	almond antique sky peru orange	1970-01-02 00:00:00	22	1970-01-02	1788.73	A	1	1788.73
+Manufacturer#5	almond aquamarine dodger light gainsboro	1970-01-01 00:00:00	36	1970-01-01	1018.1	B	2	2629.76
+Manufacturer#5	almond antique medium spring khaki	1970-01-04 00:00:00	29	1970-01-04	1611.66	B	2	2629.76
+Manufacturer#5	almond azure blanched chiffon midnight	1970-01-03 00:00:00	18	1970-01-03	1464.48	C	2	3076.1400000000003
+Manufacturer#5	almond antique medium spring khaki	1970-01-01 00:00:00	6	1970-01-01	1611.66	C	2	3076.1400000000003
+Manufacturer#5	almond antique blue firebrick mint	NULL	7	NULL	1789.69	D	1	1789.69
+PREHOOK: query: select "************ CHAR PARTITION ************"
+PREHOOK: type: QUERY
+PREHOOK: Input: _dummy_database@_dummy_table
+#### A masked pattern was here ####
+POSTHOOK: query: select "************ CHAR PARTITION ************"
+POSTHOOK: type: QUERY
+POSTHOOK: Input: _dummy_database@_dummy_table
+#### A masked pattern was here ####
+_c0
+************ CHAR PARTITION ************
+PREHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_char,
+                                    count(*) over(partition by p_char) as cs,
+                                    sum(p_retailprice) over(partition by p_char) as s
+from vector_ptf_part_simple_orc
+PREHOOK: type: QUERY
+PREHOOK: Input: default@vector_ptf_part_simple_orc
+#### A masked pattern was here ####
+POSTHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_char,
+                                    count(*) over(partition by p_char) as cs,
+                                    sum(p_retailprice) over(partition by p_char) as s
+from vector_ptf_part_simple_orc
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@vector_ptf_part_simple_orc
+#### A masked pattern was here ####
+Explain
+PLAN VECTORIZATION:
+  enabled: true
+  enabledConditionsMet: [hive.vectorized.execution.enabled IS true]
+
+STAGE DEPENDENCIES:
+  Stage-1 is a root stage
+  Stage-0 depends on stages: Stage-1
+
+STAGE PLANS:
+  Stage: Stage-1
+    Tez
+#### A masked pattern was here ####
+      Edges:
+        Reducer 2 <- Map 1 (SIMPLE_EDGE)
+#### A masked pattern was here ####
+      Vertices:
+        Map 1 
+            Map Operator Tree:
+                TableScan
+                  alias: vector_ptf_part_simple_orc
+                  Statistics: Num rows: 40 Data size: 15824 Basic stats: COMPLETE Column stats: COMPLETE
+                  TableScan Vectorization:
+                      native: true
+                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:p_char:char(1), 8:p_varchar:varchar(5), 9:rowindex:int, 10:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 11:ROW__IS__DELETED:boolean]
+                  Reduce Output Operator
+                    key expressions: p_char (type: char(1))
+                    null sort order: a
+                    sort order: +
+                    Map-reduce partition columns: p_char (type: char(1))
+                    Reduce Sink Vectorization:
+                        className: VectorReduceSinkStringOperator
+                        keyColumns: 7:char(1)
+                        native: true
+                        nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez, spark] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
+                        valueColumns: 0:string, 1:string, 2:date, 3:timestamp, 5:double, 9:int
+                    Statistics: Num rows: 40 Data size: 15824 Basic stats: COMPLETE Column stats: COMPLETE
+                    value expressions: p_mfgr (type: string), p_name (type: string), p_date (type: date), p_timestamp (type: timestamp), p_retailprice (type: double), rowindex (type: int)
+            Execution mode: vectorized, llap
+            LLAP IO: all inputs
+            Map Vectorization:
+                enabled: true
+                enabledConditionsMet: hive.vectorized.use.vectorized.input.format IS true
+                inputFormatFeatureSupport: [DECIMAL_64]
+                featureSupportInUse: [DECIMAL_64]
+                inputFileFormats: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
+                allNative: true
+                usesVectorUDFAdaptor: false
+                vectorized: true
+                rowBatchContext:
+                    dataColumnCount: 10
+                    includeColumns: [0, 1, 2, 3, 5, 7, 9]
+                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, p_char:char(1), p_varchar:varchar(5), rowindex:int
+                    partitionColumnCount: 0
+                    scratchColumnTypeNames: []
+        Reducer 2 
+            Execution mode: vectorized, llap
+            Reduce Vectorization:
+                enabled: true
+                enableConditionsMet: hive.vectorized.execution.reduce.enabled IS true, hive.execution.engine tez IN [tez, spark] IS true
+                reduceColumnNullOrder: a
+                reduceColumnSortOrder: +
+                allNative: false
+                usesVectorUDFAdaptor: false
+                vectorized: true
+                rowBatchContext:
+                    dataColumnCount: 7
+                    dataColumns: KEY.reducesinkkey0:char(1), VALUE._col0:string, VALUE._col1:string, VALUE._col2:date, VALUE._col3:timestamp, VALUE._col5:double, VALUE._col8:int
+                    partitionColumnCount: 0
+                    scratchColumnTypeNames: [bigint, double]
+            Reduce Operator Tree:
+              Select Operator
+                expressions: VALUE._col0 (type: string), VALUE._col1 (type: string), VALUE._col2 (type: date), VALUE._col3 (type: timestamp), VALUE._col5 (type: double), KEY.reducesinkkey0 (type: char(1)), VALUE._col8 (type: int)
+                outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col7, _col9
+                Select Vectorization:
+                    className: VectorSelectOperator
+                    native: true
+                    projectedOutputColumnNums: [1, 2, 3, 4, 5, 0, 6]
+                Statistics: Num rows: 40 Data size: 15824 Basic stats: COMPLETE Column stats: COMPLETE
+                PTF Operator
+                  Function definitions:
+                      Input definition
+                        input alias: ptf_0
+                        output shape: _col0: string, _col1: string, _col2: date, _col3: timestamp, _col5: double, _col7: char(1), _col9: int
+                        type: WINDOWING
+                      Windowing table definition
+                        input alias: ptf_1
+                        name: windowingtablefunction
+                        order by: _col7 ASC NULLS FIRST
+                        partition by: _col7
+                        raw input shape:
+                        window functions:
+                            window function definition
+                              alias: count_window_0
+                              name: count
+                              window function: GenericUDAFCountEvaluator
+                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
+                              isStar: true
+                            window function definition
+                              alias: sum_window_1
+                              arguments: _col5
+                              name: sum
+                              window function: GenericUDAFSumDouble
+                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
+                  PTF Vectorization:
+                      allEvaluatorsAreStreaming: false
+                      className: VectorPTFOperator
+                      evaluatorClasses: [VectorPTFEvaluatorCountStar, VectorPTFEvaluatorDoubleSum]
+                      functionInputExpressions: [null, col 5:double]
+                      functionNames: [count, sum]
+                      keyInputColumns: [0]
+                      native: true
+                      nonKeyInputColumns: [1, 2, 3, 4, 5, 6]
+                      orderExpressions: [col 0:char(1)]
+                      outputColumns: [7, 8, 1, 2, 3, 4, 5, 0, 6]
+                      outputTypes: [bigint, double, string, string, date, timestamp, double, char(1), int]
+                      partitionExpressions: [col 0:char(1)]
+                      streamingColumns: []
+                  Statistics: Num rows: 40 Data size: 15824 Basic stats: COMPLETE Column stats: COMPLETE
+                  Select Operator
+                    expressions: _col0 (type: string), _col1 (type: string), _col3 (type: timestamp), _col9 (type: int), _col2 (type: date), _col5 (type: double), _col7 (type: char(1)), count_window_0 (type: bigint), sum_window_1 (type: double)
+                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
+                    Select Vectorization:
+                        className: VectorSelectOperator
+                        native: true
+                        projectedOutputColumnNums: [1, 2, 4, 6, 3, 5, 0, 7, 8]
+                    Statistics: Num rows: 40 Data size: 15664 Basic stats: COMPLETE Column stats: COMPLETE
+                    File Output Operator
+                      compressed: false
+                      File Sink Vectorization:
+                          className: VectorFileSinkOperator
+                          native: false
+                      Statistics: Num rows: 40 Data size: 15664 Basic stats: COMPLETE Column stats: COMPLETE
+                      table:
+                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+
+  Stage: Stage-0
+    Fetch Operator
+      limit: -1
+      Processor Tree:
+        ListSink
+
+PREHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_char,
+       count(*) over(partition by p_char) as cs,
+       sum(p_retailprice) over(partition by p_char) as s
+from vector_ptf_part_simple_orc
+PREHOOK: type: QUERY
+PREHOOK: Input: default@vector_ptf_part_simple_orc
+#### A masked pattern was here ####
+POSTHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_char,
+       count(*) over(partition by p_char) as cs,
+       sum(p_retailprice) over(partition by p_char) as s
+from vector_ptf_part_simple_orc
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@vector_ptf_part_simple_orc
+#### A masked pattern was here ####
+p_mfgr	p_name	p_timestamp	rowindex	p_date	p_retailprice	p_char	cs	s
+Manufacturer#4	almond antique gainsboro frosted violet	NULL	25	NULL	NULL	A	9	7954.1900000000005
+Manufacturer#5	almond antique sky peru orange	1970-01-02 00:00:00	22	1970-01-02	1788.73	A	9	7954.1900000000005
+Manufacturer#2	almond aquamarine rose maroon antique	NULL	1	NULL	900.66	A	9	7954.1900000000005
+Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	35	1970-01-05	NULL	A	9	7954.1900000000005
+Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	20	1970-01-05	1753.76	A	9	7954.1900000000005
+Manufacturer#2	almond aquamarine sandy cyan gainsboro	NULL	32	NULL	1000.6	A	9	7954.1900000000005
+Manufacturer#3	almond antique olive coral navajo	1970-01-03 00:00:00	28	1970-01-03	1337.29	A	9	7954.1900000000005
+Manufacturer#1	almond antique burnished rose metallic	1970-01-03 00:00:00	8	1970-01-03	1173.15	A	9	7954.1900000000005
+Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	4	1970-01-04	NULL	A	9	7954.1900000000005
+Manufacturer#2	almond antique violet turquoise frosted	1970-01-01 00:00:00	21	1970-01-01	1800.7	B	9	13597.69
+Manufacturer#1	almond aquamarine burnished black steel	1970-01-02 00:00:00	2	1970-01-02	1414.42	B	9	13597.69
+Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	5	1970-01-05	1753.76	B	9	13597.69
+Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	9	1970-01-04	1632.66	B	9	13597.69
+Manufacturer#2	almond antique violet turquoise frosted	NULL	13	NULL	1800.7	B	9	13597.69
+Manufacturer#4	almond antique violet mint lemon	1970-01-01 00:00:00	16	1970-01-01	1375.42	B	9	13597.69
+Manufacturer#5	almond antique medium spring khaki	1970-01-04 00:00:00	29	1970-01-04	1611.66	B	9	13597.69
+Manufacturer#3	almond antique forest lavender goldenrod	1970-01-03 00:00:00	33	1970-01-03	1190.27	B	9	13597.69
+Manufacturer#5	almond aquamarine dodger light gainsboro	1970-01-01 00:00:00	36	1970-01-01	1018.1	B	9	13597.69
+Manufacturer#5	almond azure blanched chiffon midnight	1970-01-03 00:00:00	18	1970-01-03	1464.48	C	11	13949.690000000002
+Manufacturer#3	almond antique forest lavender goldenrod	1970-01-04 00:00:00	14	1970-01-04	NULL	C	11	13949.690000000002
+Manufacturer#3	almond antique chartreuse khaki white	1970-01-04 00:00:00	24	1970-01-04	99.68	C	11	13949.690000000002
+Manufacturer#3	almond antique forest lavender goldenrod	1970-01-05 00:00:00	10	1970-01-05	1190.27	C	11	13949.690000000002
+Manufacturer#1	almond antique chartreuse lavender yellow	NULL	26	NULL	1753.76	C	11	13949.690000000002
+Manufacturer#1	almond antique salmon chartreuse burlywood	1970-01-05 00:00:00	30	1970-01-05	1602.59	C	11	13949.690000000002
+Manufacturer#5	almond antique medium spring khaki	1970-01-01 00:00:00	6	1970-01-01	1611.66	C	11	13949.690000000002
+Manufacturer#2	almond aquamarine midnight light salmon	1970-01-04 00:00:00	34	1970-01-04	2031.98	C	11	13949.690000000002
+Manufacturer#2	almond aquamarine rose maroon antique	1970-01-03 00:00:00	3	1970-01-03	1698.66	C	11	13949.690000000002
+Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	40	1970-01-05	1206.26	C	11	13949.690000000002
+Manufacturer#4	almond azure aquamarine papaya violet	1970-01-02 00:00:00	37	1970-01-02	1290.35	C	11	13949.690000000002
+Manufacturer#3	almond antique forest lavender goldenrod	NULL	19	NULL	590.27	D	11	15886.86
+Manufacturer#3	almond antique misty red olive	1970-01-01 00:00:00	31	1970-01-01	1922.98	D	11	15886.86
+Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-02 00:00:00	12	1970-01-02	1753.76	D	11	15886.86
+Manufacturer#4	almond aquamarine yellow dodger mint	1970-01-01 00:00:00	11	1970-01-01	1844.92	D	11	15886.86
+Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-03 00:00:00	23	1970-01-03	1632.66	D	11	15886.86
+Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-02 00:00:00	17	1970-01-02	1632.66	D	11	15886.86
+Manufacturer#1	almond antique burnished rose metallic	1970-01-04 00:00:00	39	1970-01-04	1173.15	D	11	15886.86
+Manufacturer#2	almond antique violet chocolate turquoise	1970-01-05 00:00:00	15	1970-01-05	1690.68	D	11	15886.86
+Manufacturer#2	almond antique violet turquoise frosted	1970-01-02 00:00:00	27	1970-01-02	1800.7	D	11	15886.86
+Manufacturer#5	almond antique blue firebrick mint	NULL	7	NULL	1789.69	D	11	15886.86
+Manufacturer#3	almond antique metallic orange dim	NULL	38	NULL	55.39	D	11	15886.86
+PREHOOK: query: select "************ CHAR PARTITION WITH CONSTANT PARTITION EXPRESSION ************"
+PREHOOK: type: QUERY
+PREHOOK: Input: _dummy_database@_dummy_table
+#### A masked pattern was here ####
+POSTHOOK: query: select "************ CHAR PARTITION WITH CONSTANT PARTITION EXPRESSION ************"
+POSTHOOK: type: QUERY
+POSTHOOK: Input: _dummy_database@_dummy_table
+#### A masked pattern was here ####
+_c0
+************ CHAR PARTITION WITH CONSTANT PARTITION EXPRESSION ************
+PREHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_char,
+                                    count(*) over(partition by p_char) as cs,
+                                    sum(p_retailprice) over(partition by p_char) as s
+from vector_ptf_part_simple_orc
+where p_char = 'D'
+PREHOOK: type: QUERY
+PREHOOK: Input: default@vector_ptf_part_simple_orc
+#### A masked pattern was here ####
+POSTHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_char,
+                                    count(*) over(partition by p_char) as cs,
+                                    sum(p_retailprice) over(partition by p_char) as s
+from vector_ptf_part_simple_orc
+where p_char = 'D'
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@vector_ptf_part_simple_orc
+#### A masked pattern was here ####
+Explain
+PLAN VECTORIZATION:
+  enabled: true
+  enabledConditionsMet: [hive.vectorized.execution.enabled IS true]
+
+STAGE DEPENDENCIES:
+  Stage-1 is a root stage
+  Stage-0 depends on stages: Stage-1
+
+STAGE PLANS:
+  Stage: Stage-1
+    Tez
+#### A masked pattern was here ####
+      Edges:
+        Reducer 2 <- Map 1 (SIMPLE_EDGE)
+#### A masked pattern was here ####
+      Vertices:
+        Map 1 
+            Map Operator Tree:
+                TableScan
+                  alias: vector_ptf_part_simple_orc
+                  filterExpr: (p_char = 'D') (type: boolean)
+                  Statistics: Num rows: 40 Data size: 15824 Basic stats: COMPLETE Column stats: COMPLETE
+                  TableScan Vectorization:
+                      native: true
+                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:p_char:char(1), 8:p_varchar:varchar(5), 9:rowindex:int, 10:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 11:ROW__IS__DELETED:boolean]
+                  Filter Operator
+                    Filter Vectorization:
+                        className: VectorFilterOperator
+                        native: true
+                        predicateExpression: FilterStringGroupColEqualCharScalar(col 7:char(1), val D)
+                    predicate: (p_char = 'D') (type: boolean)
+                    Statistics: Num rows: 10 Data size: 4034 Basic stats: COMPLETE Column stats: COMPLETE
+                    Reduce Output Operator
+                      key expressions: CAST( 'D' AS CHAR(1)) (type: char(1))
+                      null sort order: a
+                      sort order: +
+                      Map-reduce partition columns: CAST( 'D' AS CHAR(1)) (type: char(1))
+                      Reduce Sink Vectorization:
+                          className: VectorReduceSinkStringOperator
+                          keyColumns: 12:char(1)
+                          keyExpressions: VectorUDFAdaptor(CAST( 'D' AS CHAR(1))) -> 12:char(1)
+                          native: true
+                          nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez, spark] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
+                          valueColumns: 0:string, 1:string, 2:date, 3:timestamp, 5:double, 9:int
+                      Statistics: Num rows: 10 Data size: 4034 Basic stats: COMPLETE Column stats: COMPLETE
+                      value expressions: p_mfgr (type: string), p_name (type: string), p_date (type: date), p_timestamp (type: timestamp), p_retailprice (type: double), rowindex (type: int)
+            Execution mode: vectorized, llap
+            LLAP IO: all inputs
+            Map Vectorization:
+                enabled: true
+                enabledConditionsMet: hive.vectorized.use.vectorized.input.format IS true
+                inputFormatFeatureSupport: [DECIMAL_64]
+                featureSupportInUse: [DECIMAL_64]
+                inputFileFormats: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
+                allNative: true
+                usesVectorUDFAdaptor: true
+                vectorized: true
+                rowBatchContext:
+                    dataColumnCount: 10
+                    includeColumns: [0, 1, 2, 3, 5, 7, 9]
+                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, p_char:char(1), p_varchar:varchar(5), rowindex:int
+                    partitionColumnCount: 0
+                    scratchColumnTypeNames: [string]
+        Reducer 2 
+            Execution mode: vectorized, llap
+            Reduce Vectorization:
+                enabled: true
+                enableConditionsMet: hive.vectorized.execution.reduce.enabled IS true, hive.execution.engine tez IN [tez, spark] IS true
+                reduceColumnNullOrder: a
+                reduceColumnSortOrder: +
+                allNative: false
+                usesVectorUDFAdaptor: false
+                vectorized: true
+                rowBatchContext:
+                    dataColumnCount: 7
+                    dataColumns: KEY.reducesinkkey0:char(1), VALUE._col0:string, VALUE._col1:string, VALUE._col2:date, VALUE._col3:timestamp, VALUE._col5:double, VALUE._col9:int
+                    partitionColumnCount: 0
+                    scratchColumnTypeNames: [bigint, double, string, string, string]
+            Reduce Operator Tree:
+              Select Operator
+                expressions: VALUE._col0 (type: string), VALUE._col1 (type: string), VALUE._col2 (type: date), VALUE._col3 (type: timestamp), VALUE._col5 (type: double), VALUE._col9 (type: int)
+                outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col9
+                Select Vectorization:
+                    className: VectorSelectOperator
+                    native: true
+                    projectedOutputColumnNums: [1, 2, 3, 4, 5, 6]
+                Statistics: Num rows: 10 Data size: 3184 Basic stats: COMPLETE Column stats: COMPLETE
+                PTF Operator
+                  Function definitions:
+                      Input definition
+                        input alias: ptf_0
+                        output shape: _col0: string, _col1: string, _col2: date, _col3: timestamp, _col5: double, _col9: int
+                        type: WINDOWING
+                      Windowing table definition
+                        input alias: ptf_1
+                        name: windowingtablefunction
+                        order by: CAST( 'D' AS CHAR(1)) ASC NULLS FIRST
+                        partition by: CAST( 'D' AS CHAR(1))
+                        raw input shape:
+                        window functions:
+                            window function definition
+                              alias: count_window_0
+                              name: count
+                              window function: GenericUDAFCountEvaluator
+                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
+                              isStar: true
+                            window function definition
+                              alias: sum_window_1
+                              arguments: _col5
+                              name: sum
+                              window function: GenericUDAFSumDouble
+                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
+                  PTF Vectorization:
+                      allEvaluatorsAreStreaming: false
+                      className: VectorPTFOperator
+                      evaluatorClasses: [VectorPTFEvaluatorCountStar, VectorPTFEvaluatorDoubleSum]
+                      functionInputExpressions: [null, col 5:double]
+                      functionNames: [count, sum]
+                      keyInputColumns: []
+                      native: true
+                      nonKeyInputColumns: [1, 2, 3, 4, 5, 6]
+                      orderExpressions: [VectorUDFAdaptor(CAST( 'D' AS CHAR(1))) -> 10:char(1)]
+                      outputColumns: [7, 8, 1, 2, 3, 4, 5, 6]
+                      outputTypes: [bigint, double, string, string, date, timestamp, double, int]
+                      partitionExpressions: [VectorUDFAdaptor(CAST( 'D' AS CHAR(1))) -> 9:char(1)]
+                      streamingColumns: []
+                  Statistics: Num rows: 10 Data size: 3184 Basic stats: COMPLETE Column stats: COMPLETE
+                  Select Operator
+                    expressions: _col0 (type: string), _col1 (type: string), _col3 (type: timestamp), _col9 (type: int), _col2 (type: date), _col5 (type: double), 'D' (type: char(1)), count_window_0 (type: bigint), sum_window_1 (type: double)
+                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
+                    Select Vectorization:
+                        className: VectorSelectOperator
+                        native: true
+                        projectedOutputColumnNums: [1, 2, 4, 6, 3, 5, 11, 7, 8]
+                        selectExpressions: ConstantVectorExpression(val D) -> 11:char(1)
+                    Statistics: Num rows: 10 Data size: 3994 Basic stats: COMPLETE Column stats: COMPLETE
+                    File Output Operator
+                      compressed: false
+                      File Sink Vectorization:
+                          className: VectorFileSinkOperator
+                          native: false
+                      Statistics: Num rows: 10 Data size: 3994 Basic stats: COMPLETE Column stats: COMPLETE
+                      table:
+                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+
+  Stage: Stage-0
+    Fetch Operator
+      limit: -1
+      Processor Tree:
+        ListSink
+
+PREHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice, p_char,
+       count(*) over(partition by p_char) as cs,
+       sum(p_retailprice) over(partition by p_char) as s
+from vector_ptf_part_simple_orc
+where p_char = 'D'
+PREHOOK: type: QUERY
+PREHOOK: Input: default@vector_ptf_part_simple_orc
+#### A masked pattern was here ####
+POSTHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice, p_char,
+       count(*) over(partition by p_char) as cs,
+       sum(p_retailprice) over(partition by p_char) as s
+from vector_ptf_part_simple_orc
+where p_char = 'D'
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@vector_ptf_part_simple_orc
+#### A masked pattern was here ####
+p_mfgr	p_name	p_timestamp	rowindex	p_date	p_retailprice	p_char	cs	s
+Manufacturer#5	almond antique blue firebrick mint	NULL	7	NULL	1789.69	D	11	15886.86
+Manufacturer#4	almond aquamarine yellow dodger mint	1970-01-01 00:00:00	11	1970-01-01	1844.92	D	11	15886.86
+Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-02 00:00:00	12	1970-01-02	1753.76	D	11	15886.86
+Manufacturer#2	almond antique violet chocolate turquoise	1970-01-05 00:00:00	15	1970-01-05	1690.68	D	11	15886.86
+Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-02 00:00:00	17	1970-01-02	1632.66	D	11	15886.86
+Manufacturer#3	almond antique forest lavender goldenrod	NULL	19	NULL	590.27	D	11	15886.86
+Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-03 00:00:00	23	1970-01-03	1632.66	D	11	15886.86
+Manufacturer#2	almond antique violet turquoise frosted	1970-01-02 00:00:00	27	1970-01-02	1800.7	D	11	15886.86
+Manufacturer#3	almond antique misty red olive	1970-01-01 00:00:00	31	1970-01-01	1922.98	D	11	15886.86
+Manufacturer#3	almond antique metallic orange dim	NULL	38	NULL	55.39	D	11	15886.86
+Manufacturer#1	almond antique burnished rose metallic	1970-01-04 00:00:00	39	1970-01-04	1173.15	D	11	15886.86
+PREHOOK: query: select "************ VARCHAR WINDOW RANGE TYPE ************"
+PREHOOK: type: QUERY
+PREHOOK: Input: _dummy_database@_dummy_table
+#### A masked pattern was here ####
+POSTHOOK: query: select "************ VARCHAR WINDOW RANGE TYPE ************"
+POSTHOOK: type: QUERY
+POSTHOOK: Input: _dummy_database@_dummy_table
+#### A masked pattern was here ####
+_c0
+************ VARCHAR WINDOW RANGE TYPE ************
+PREHOOK: query: select "************ VARCHAR WINDOW RANGE TYPE (NON-VECTORIZED REFERENCE) ************"
+PREHOOK: type: QUERY
+PREHOOK: Input: _dummy_database@_dummy_table
+#### A masked pattern was here ####
+POSTHOOK: query: select "************ VARCHAR WINDOW RANGE TYPE (NON-VECTORIZED REFERENCE) ************"
+POSTHOOK: type: QUERY
+POSTHOOK: Input: _dummy_database@_dummy_table
+#### A masked pattern was here ####
+_c0
+************ VARCHAR WINDOW RANGE TYPE (NON-VECTORIZED REFERENCE) ************
+PREHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_varchar,
+       count(*) over(partition by p_mfgr order by p_varchar range between 3 preceding and current row) as cs,
+       sum(p_retailprice) over(partition by p_mfgr order by p_varchar range between 3 preceding and current row) as s
+from vector_ptf_part_simple_orc
+PREHOOK: type: QUERY
+PREHOOK: Input: default@vector_ptf_part_simple_orc
+#### A masked pattern was here ####
+POSTHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_varchar,
+       count(*) over(partition by p_mfgr order by p_varchar range between 3 preceding and current row) as cs,
+       sum(p_retailprice) over(partition by p_mfgr order by p_varchar range between 3 preceding and current row) as s
+from vector_ptf_part_simple_orc
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@vector_ptf_part_simple_orc
+#### A masked pattern was here ####
+p_mfgr	p_name	p_timestamp	rowindex	p_date	p_retailprice	p_varchar	cs	s
+Manufacturer#1	almond aquamarine burnished black steel	1970-01-02 00:00:00	2	1970-01-02	1414.42	AB	1	1414.42
+Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	5	1970-01-05	1753.76	AC	1	1753.76
+Manufacturer#1	almond antique chartreuse lavender yellow	NULL	26	NULL	1753.76	AD	1	1753.76
+Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	9	1970-01-04	1632.66	AK	1	1632.66
+Manufacturer#1	almond antique salmon chartreuse burlywood	1970-01-05 00:00:00	30	1970-01-05	1602.59	BB	1	1602.59
+Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-03 00:00:00	23	1970-01-03	1632.66	CC	1	1632.66
+Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-02 00:00:00	12	1970-01-02	1753.76	DA	1	1753.76
+Manufacturer#1	almond antique burnished rose metallic	1970-01-04 00:00:00	39	1970-01-04	1173.15	DC	1	1173.15
+Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	4	1970-01-04	NULL	DE	1	NULL
+Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	20	1970-01-05	1753.76	EF	1	1753.76
+Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-02 00:00:00	17	1970-01-02	1632.66	RS	1	1632.66
+Manufacturer#1	almond antique burnished rose metallic	1970-01-03 00:00:00	8	1970-01-03	1173.15	SM	1	1173.15
+Manufacturer#2	almond antique violet turquoise frosted	1970-01-01 00:00:00	21	1970-01-01	1800.7	AA	1	1800.7
+Manufacturer#2	almond antique violet turquoise frosted	1970-01-02 00:00:00	27	1970-01-02	1800.7	AB	1	1800.7
+Manufacturer#2	almond antique violet turquoise frosted	NULL	13	NULL	1800.7	AC	1	1800.7
+Manufacturer#2	almond aquamarine sandy cyan gainsboro	NULL	32	NULL	1000.6	BD	1	1000.6
+Manufacturer#2	almond aquamarine rose maroon antique	1970-01-03 00:00:00	3	1970-01-03	1698.66	CA	1	1698.66
+Manufacturer#2	almond aquamarine midnight light salmon	1970-01-04 00:00:00	34	1970-01-04	2031.98	CB	1	2031.98
+Manufacturer#2	almond aquamarine rose maroon antique	NULL	1	NULL	900.66	DA	1	900.66
+Manufacturer#2	almond antique violet chocolate turquoise	1970-01-05 00:00:00	15	1970-01-05	1690.68	LM	1	1690.68
+Manufacturer#3	almond antique olive coral navajo	1970-01-03 00:00:00	28	1970-01-03	1337.29	AC	1	1337.29
+Manufacturer#3	almond antique forest lavender goldenrod	1970-01-05 00:00:00	10	1970-01-05	1190.27	AY	1	1190.27
+Manufacturer#3	almond antique forest lavender goldenrod	1970-01-04 00:00:00	14	1970-01-04	NULL	BB	1	NULL
+Manufacturer#3	almond antique misty red olive	1970-01-01 00:00:00	31	1970-01-01	1922.98	BC	1	1922.98
+Manufacturer#3	almond antique forest lavender goldenrod	1970-01-03 00:00:00	33	1970-01-03	1190.27	CA	1	1190.27
+Manufacturer#3	almond antique forest lavender goldenrod	NULL	19	NULL	590.27	CD	1	590.27
+Manufacturer#3	almond antique metallic orange dim	NULL	38	NULL	55.39	DB	1	55.39
+Manufacturer#3	almond antique chartreuse khaki white	1970-01-04 00:00:00	24	1970-01-04	99.68	DD	1	99.68
+Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	35	1970-01-05	NULL	CC	1	NULL
+Manufacturer#4	almond azure aquamarine papaya violet	1970-01-02 00:00:00	37	1970-01-02	1290.35	DA	1	1290.35
+Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	40	1970-01-05	1206.26	DD	1	1206.26
+Manufacturer#4	almond antique gainsboro frosted violet	NULL	25	NULL	NULL	EE	1	NULL
+Manufacturer#4	almond aquamarine yellow dodger mint	1970-01-01 00:00:00	11	1970-01-01	1844.92	FD	1	1844.92
+Manufacturer#4	almond antique violet mint lemon	1970-01-01 00:00:00	16	1970-01-01	1375.42	OP	1	1375.42
+Manufacturer#5	almond antique medium spring khaki	1970-01-04 00:00:00	29	1970-01-04	1611.66	AA	2	3223.32
+Manufacturer#5	almond antique medium spring khaki	1970-01-01 00:00:00	6	1970-01-01	1611.66	AA	2	3223.32
+Manufacturer#5	almond azure blanched chiffon midnight	1970-01-03 00:00:00	18	1970-01-03	1464.48	AB	1	1464.48
+Manufacturer#5	almond antique sky peru orange	1970-01-02 00:00:00	22	1970-01-02	1788.73	BB	1	1788.73
+Manufacturer#5	almond aquamarine dodger light gainsboro	1970-01-01 00:00:00	36	1970-01-01	1018.1	CD	1	1018.1
+Manufacturer#5	almond antique blue firebrick mint	NULL	7	NULL	1789.69	FD	1	1789.69
+PREHOOK: query: select "************ VARCHAR WINDOW RANGE TYPE (VECTORIZED) ************"
+PREHOOK: type: QUERY
+PREHOOK: Input: _dummy_database@_dummy_table
+#### A masked pattern was here ####
+POSTHOOK: query: select "************ VARCHAR WINDOW RANGE TYPE (VECTORIZED) ************"
+POSTHOOK: type: QUERY
+POSTHOOK: Input: _dummy_database@_dummy_table
+#### A masked pattern was here ####
+_c0
+************ VARCHAR WINDOW RANGE TYPE (VECTORIZED) ************
+PREHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_varchar,
+                                    count(*) over(partition by p_mfgr order by p_varchar range between 3 preceding and current row) as cs,
+                                    sum(p_retailprice) over(partition by p_mfgr order by p_varchar range between 3 preceding and current row) as s
+from vector_ptf_part_simple_orc
+PREHOOK: type: QUERY
+PREHOOK: Input: default@vector_ptf_part_simple_orc
+#### A masked pattern was here ####
+POSTHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_varchar,
+                                    count(*) over(partition by p_mfgr order by p_varchar range between 3 preceding and current row) as cs,
+                                    sum(p_retailprice) over(partition by p_mfgr order by p_varchar range between 3 preceding and current row) as s
+from vector_ptf_part_simple_orc
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@vector_ptf_part_simple_orc
+#### A masked pattern was here ####
+Explain
+PLAN VECTORIZATION:
+  enabled: true
+  enabledConditionsMet: [hive.vectorized.execution.enabled IS true]
+
+STAGE DEPENDENCIES:
+  Stage-1 is a root stage
+  Stage-0 depends on stages: Stage-1
+
+STAGE PLANS:
+  Stage: Stage-1
+    Tez
+#### A masked pattern was here ####
+      Edges:
+        Reducer 2 <- Map 1 (SIMPLE_EDGE)
+#### A masked pattern was here ####
+      Vertices:
+        Map 1 
+            Map Operator Tree:
+                TableScan
+                  alias: vector_ptf_part_simple_orc
+                  Statistics: Num rows: 40 Data size: 15864 Basic stats: COMPLETE Column stats: COMPLETE
+                  TableScan Vectorization:
+                      native: true
+                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:p_char:char(1), 8:p_varchar:varchar(5), 9:rowindex:int, 10:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 11:ROW__IS__DELETED:boolean]
+                  Reduce Output Operator
+                    key expressions: p_mfgr (type: string), p_varchar (type: varchar(5))
+                    null sort order: az
+                    sort order: ++
+                    Map-reduce partition columns: p_mfgr (type: string)
+                    Reduce Sink Vectorization:
+                        className: VectorReduceSinkObjectHashOperator
+                        keyColumns: 0:string, 8:varchar(5)
+                        native: true
+                        nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez, spark] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
+                        partitionColumns: 0:string
+                        valueColumns: 1:string, 2:date, 3:timestamp, 5:double, 9:int
+                    Statistics: Num rows: 40 Data size: 15864 Basic stats: COMPLETE Column stats: COMPLETE
+                    value expressions: p_name (type: string), p_date (type: date), p_timestamp (type: timestamp), p_retailprice (type: double), rowindex (type: int)
+            Execution mode: vectorized, llap
+            LLAP IO: all inputs
+            Map Vectorization:
+                enabled: true
+                enabledConditionsMet: hive.vectorized.use.vectorized.input.format IS true
+                inputFormatFeatureSupport: [DECIMAL_64]
+                featureSupportInUse: [DECIMAL_64]
+                inputFileFormats: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
+                allNative: true
+                usesVectorUDFAdaptor: false
+                vectorized: true
+                rowBatchContext:
+                    dataColumnCount: 10
+                    includeColumns: [0, 1, 2, 3, 5, 8, 9]
+                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, p_char:char(1), p_varchar:varchar(5), rowindex:int
+                    partitionColumnCount: 0
+                    scratchColumnTypeNames: []
+        Reducer 2 
+            Execution mode: vectorized, llap
+            Reduce Vectorization:
+                enabled: true
+                enableConditionsMet: hive.vectorized.execution.reduce.enabled IS true, hive.execution.engine tez IN [tez, spark] IS true
+                reduceColumnNullOrder: az
+                reduceColumnSortOrder: ++
+                allNative: false
+                usesVectorUDFAdaptor: false
+                vectorized: true
+                rowBatchContext:
+                    dataColumnCount: 7
+                    dataColumns: KEY.reducesinkkey0:string, KEY.reducesinkkey1:varchar(5), VALUE._col0:string, VALUE._col1:date, VALUE._col2:timestamp, VALUE._col4:double, VALUE._col7:int
+                    partitionColumnCount: 0
+                    scratchColumnTypeNames: [bigint, double]
+            Reduce Operator Tree:
+              Select Operator
+                expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string), VALUE._col1 (type: date), VALUE._col2 (type: timestamp), VALUE._col4 (type: double), KEY.reducesinkkey1 (type: varchar(5)), VALUE._col7 (type: int)
+                outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col8, _col9
+                Select Vectorization:
+                    className: VectorSelectOperator
+                    native: true
+                    projectedOutputColumnNums: [0, 2, 3, 4, 5, 1, 6]
+                Statistics: Num rows: 40 Data size: 15864 Basic stats: COMPLETE Column stats: COMPLETE
+                PTF Operator
+                  Function definitions:
+                      Input definition
+                        input alias: ptf_0
+                        output shape: _col0: string, _col1: string, _col2: date, _col3: timestamp, _col5: double, _col8: varchar(5), _col9: int
+                        type: WINDOWING
+                      Windowing table definition
+                        input alias: ptf_1
+                        name: windowingtablefunction
+                        order by: _col8 ASC NULLS LAST
+                        partition by: _col0
+                        raw input shape:
+                        window functions:
+                            window function definition
+                              alias: count_window_0
+                              name: count
+                              window function: GenericUDAFCountEvaluator
+                              window frame: RANGE PRECEDING(3)~CURRENT
+                              isStar: true
+                            window function definition
+                              alias: sum_window_1
+                              arguments: _col5
+                              name: sum
+                              window function: GenericUDAFSumDouble
+                              window frame: RANGE PRECEDING(3)~CURRENT
+                  PTF Vectorization:
+                      allEvaluatorsAreStreaming: false
+                      className: VectorPTFOperator
+                      evaluatorClasses: [VectorPTFEvaluatorCountStar, VectorPTFEvaluatorDoubleSum]
+                      functionInputExpressions: [null, col 5:double]
+                      functionNames: [count, sum]
+                      keyInputColumns: [0, 1]
+                      native: true
+                      nonKeyInputColumns: [2, 3, 4, 5, 6]
+                      orderExpressions: [col 1:varchar(5)]
+                      outputColumns: [7, 8, 0, 2, 3, 4, 5, 1, 6]
+                      outputTypes: [bigint, double, string, string, date, timestamp, double, varchar(5), int]
+                      partitionExpressions: [col 0:string]
+                      streamingColumns: []
+                  Statistics: Num rows: 40 Data size: 15864 Basic stats: COMPLETE Column stats: COMPLETE
+                  Select Operator
+                    expressions: _col0 (type: string), _col1 (type: string), _col3 (type: timestamp), _col9 (type: int), _col2 (type: date), _col5 (type: double), _col8 (type: varchar(5)), count_window_0 (type: bigint), sum_window_1 (type: double)
+                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
+                    Select Vectorization:
+                        className: VectorSelectOperator
+                        native: true
+                        projectedOutputColumnNums: [0, 2, 4, 6, 3, 5, 1, 7, 8]
+                    Statistics: Num rows: 40 Data size: 15704 Basic stats: COMPLETE Column stats: COMPLETE
+                    File Output Operator
+                      compressed: false
+                      File Sink Vectorization:
+                          className: VectorFileSinkOperator
+                          native: false
+                      Statistics: Num rows: 40 Data size: 15704 Basic stats: COMPLETE Column stats: COMPLETE
+                      table:
+                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+
+  Stage: Stage-0
+    Fetch Operator
+      limit: -1
+      Processor Tree:
+        ListSink
+
+PREHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_varchar,
+       count(*) over(partition by p_mfgr order by p_varchar range between 3 preceding and current row) as cs,
+       sum(p_retailprice) over(partition by p_mfgr order by p_varchar range between 3 preceding and current row) as s
+from vector_ptf_part_simple_orc
+PREHOOK: type: QUERY
+PREHOOK: Input: default@vector_ptf_part_simple_orc
+#### A masked pattern was here ####
+POSTHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_varchar,
+       count(*) over(partition by p_mfgr order by p_varchar range between 3 preceding and current row) as cs,
+       sum(p_retailprice) over(partition by p_mfgr order by p_varchar range between 3 preceding and current row) as s
+from vector_ptf_part_simple_orc
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@vector_ptf_part_simple_orc
+#### A masked pattern was here ####
+p_mfgr	p_name	p_timestamp	rowindex	p_date	p_retailprice	p_varchar	cs	s
+Manufacturer#1	almond aquamarine burnished black steel	1970-01-02 00:00:00	2	1970-01-02	1414.42	AB	1	1414.42
+Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	5	1970-01-05	1753.76	AC	1	1753.76
+Manufacturer#1	almond antique chartreuse lavender yellow	NULL	26	NULL	1753.76	AD	1	1753.76
+Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	9	1970-01-04	1632.66	AK	1	1632.66
+Manufacturer#1	almond antique salmon chartreuse burlywood	1970-01-05 00:00:00	30	1970-01-05	1602.59	BB	1	1602.59
+Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-03 00:00:00	23	1970-01-03	1632.66	CC	1	1632.66
+Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-02 00:00:00	12	1970-01-02	1753.76	DA	1	1753.76
+Manufacturer#1	almond antique burnished rose metallic	1970-01-04 00:00:00	39	1970-01-04	1173.15	DC	1	1173.15
+Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	4	1970-01-04	NULL	DE	1	NULL
+Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	20	1970-01-05	1753.76	EF	1	1753.76
+Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-02 00:00:00	17	1970-01-02	1632.66	RS	1	1632.66
+Manufacturer#1	almond antique burnished rose metallic	1970-01-03 00:00:00	8	1970-01-03	1173.15	SM	1	1173.15
+Manufacturer#2	almond antique violet turquoise frosted	1970-01-01 00:00:00	21	1970-01-01	1800.7	AA	1	1800.7
+Manufacturer#2	almond antique violet turquoise frosted	1970-01-02 00:00:00	27	1970-01-02	1800.7	AB	1	1800.7
+Manufacturer#2	almond antique violet turquoise frosted	NULL	13	NULL	1800.7	AC	1	1800.7
+Manufacturer#2	almond aquamarine sandy cyan gainsboro	NULL	32	NULL	1000.6	BD	1	1000.6
+Manufacturer#2	almond aquamarine rose maroon antique	1970-01-03 00:00:00	3	1970-01-03	1698.66	CA	1	1698.66
+Manufacturer#2	almond aquamarine midnight light salmon	1970-01-04 00:00:00	34	1970-01-04	2031.98	CB	1	2031.98
+Manufacturer#2	almond aquamarine rose maroon antique	NULL	1	NULL	900.66	DA	1	900.66
+Manufacturer#2	almond antique violet chocolate turquoise	1970-01-05 00:00:00	15	1970-01-05	1690.68	LM	1	1690.68
+Manufacturer#3	almond antique olive coral navajo	1970-01-03 00:00:00	28	1970-01-03	1337.29	AC	1	1337.29
+Manufacturer#3	almond antique forest lavender goldenrod	1970-01-05 00:00:00	10	1970-01-05	1190.27	AY	1	1190.27
+Manufacturer#3	almond antique forest lavender goldenrod	1970-01-04 00:00:00	14	1970-01-04	NULL	BB	1	NULL
+Manufacturer#3	almond antique misty red olive	1970-01-01 00:00:00	31	1970-01-01	1922.98	BC	1	1922.98
+Manufacturer#3	almond antique forest lavender goldenrod	1970-01-03 00:00:00	33	1970-01-03	1190.27	CA	1	1190.27
+Manufacturer#3	almond antique forest lavender goldenrod	NULL	19	NULL	590.27	CD	1	590.27
+Manufacturer#3	almond antique metallic orange dim	NULL	38	NULL	55.39	DB	1	55.39
+Manufacturer#3	almond antique chartreuse khaki white	1970-01-04 00:00:00	24	1970-01-04	99.68	DD	1	99.68
+Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	35	1970-01-05	NULL	CC	1	NULL
+Manufacturer#4	almond azure aquamarine papaya violet	1970-01-02 00:00:00	37	1970-01-02	1290.35	DA	1	1290.35
+Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	40	1970-01-05	1206.26	DD	1	1206.26
+Manufacturer#4	almond antique gainsboro frosted violet	NULL	25	NULL	NULL	EE	1	NULL
+Manufacturer#4	almond aquamarine yellow dodger mint	1970-01-01 00:00:00	11	1970-01-01	1844.92	FD	1	1844.92
+Manufacturer#4	almond antique violet mint lemon	1970-01-01 00:00:00	16	1970-01-01	1375.42	OP	1	1375.42
+Manufacturer#5	almond antique medium spring khaki	1970-01-04 00:00:00	29	1970-01-04	1611.66	AA	2	3223.32
+Manufacturer#5	almond antique medium spring khaki	1970-01-01 00:00:00	6	1970-01-01	1611.66	AA	2	3223.32
+Manufacturer#5	almond azure blanched chiffon midnight	1970-01-03 00:00:00	18	1970-01-03	1464.48	AB	1	1464.48
+Manufacturer#5	almond antique sky peru orange	1970-01-02 00:00:00	22	1970-01-02	1788.73	BB	1	1788.73
+Manufacturer#5	almond aquamarine dodger light gainsboro	1970-01-01 00:00:00	36	1970-01-01	1018.1	CD	1	1018.1
+Manufacturer#5	almond antique blue firebrick mint	NULL	7	NULL	1789.69	FD	1	1789.69
+PREHOOK: query: select "************ VARCHAR PARTITION ************"
+PREHOOK: type: QUERY
+PREHOOK: Input: _dummy_database@_dummy_table
+#### A masked pattern was here ####
+POSTHOOK: query: select "************ VARCHAR PARTITION ************"
+POSTHOOK: type: QUERY
+POSTHOOK: Input: _dummy_database@_dummy_table
+#### A masked pattern was here ####
+_c0
+************ VARCHAR PARTITION ************
+PREHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_varchar,
+                                    count(*) over(partition by p_varchar) as cs,
+                                    sum(p_retailprice) over(partition by p_varchar) as s
+from vector_ptf_part_simple_orc
+PREHOOK: type: QUERY
+PREHOOK: Input: default@vector_ptf_part_simple_orc
+#### A masked pattern was here ####
+POSTHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_varchar,
+                                    count(*) over(partition by p_varchar) as cs,
+                                    sum(p_retailprice) over(partition by p_varchar) as s
+from vector_ptf_part_simple_orc
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@vector_ptf_part_simple_orc
+#### A masked pattern was here ####
+Explain
+PLAN VECTORIZATION:
+  enabled: true
+  enabledConditionsMet: [hive.vectorized.execution.enabled IS true]
+
+STAGE DEPENDENCIES:
+  Stage-1 is a root stage
+  Stage-0 depends on stages: Stage-1
+
+STAGE PLANS:
+  Stage: Stage-1
+    Tez
+#### A masked pattern was here ####
+      Edges:
+        Reducer 2 <- Map 1 (SIMPLE_EDGE)
+#### A masked pattern was here ####
+      Vertices:
+        Map 1 
+            Map Operator Tree:
+                TableScan
+                  alias: vector_ptf_part_simple_orc
+                  Statistics: Num rows: 40 Data size: 15864 Basic stats: COMPLETE Column stats: COMPLETE
+                  TableScan Vectorization:
+                      native: true
+                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:p_char:char(1), 8:p_varchar:varchar(5), 9:rowindex:int, 10:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 11:ROW__IS__DELETED:boolean]
+                  Reduce Output Operator
+                    key expressions: p_varchar (type: varchar(5))
+                    null sort order: a
+                    sort order: +
+                    Map-reduce partition columns: p_varchar (type: varchar(5))
+                    Reduce Sink Vectorization:
+                        className: VectorReduceSinkStringOperator
+                        keyColumns: 8:varchar(5)
+                        native: true
+                        nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez, spark] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
+                        valueColumns: 0:string, 1:string, 2:date, 3:timestamp, 5:double, 9:int
+                    Statistics: Num rows: 40 Data size: 15864 Basic stats: COMPLETE Column stats: COMPLETE
+                    value expressions: p_mfgr (type: string), p_name (type: string), p_date (type: date), p_timestamp (type: timestamp), p_retailprice (type: double), rowindex (type: int)
+            Execution mode: vectorized, llap
+            LLAP IO: all inputs
+            Map Vectorization:
+                enabled: true
+                enabledConditionsMet: hive.vectorized.use.vectorized.input.format IS true
+                inputFormatFeatureSupport: [DECIMAL_64]
+                featureSupportInUse: [DECIMAL_64]
+                inputFileFormats: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
+                allNative: true
+                usesVectorUDFAdaptor: false
+                vectorized: true
+                rowBatchContext:
+                    dataColumnCount: 10
+                    includeColumns: [0, 1, 2, 3, 5, 8, 9]
+                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, p_char:char(1), p_varchar:varchar(5), rowindex:int
+                    partitionColumnCount: 0
+                    scratchColumnTypeNames: []
+        Reducer 2 
+            Execution mode: vectorized, llap
+            Reduce Vectorization:
+                enabled: true
+                enableConditionsMet: hive.vectorized.execution.reduce.enabled IS true, hive.execution.engine tez IN [tez, spark] IS true
+                reduceColumnNullOrder: a
+                reduceColumnSortOrder: +
+                allNative: false
+                usesVectorUDFAdaptor: false
+                vectorized: true
+                rowBatchContext:
+                    dataColumnCount: 7
+                    dataColumns: KEY.reducesinkkey0:varchar(5), VALUE._col0:string, VALUE._col1:string, VALUE._col2:date, VALUE._col3:timestamp, VALUE._col5:double, VALUE._col8:int
+                    partitionColumnCount: 0
+                    scratchColumnTypeNames: [bigint, double]
+            Reduce Operator Tree:
+              Select Operator
+                expressions: VALUE._col0 (type: string), VALUE._col1 (type: string), VALUE._col2 (type: date), VALUE._col3 (type: timestamp), VALUE._col5 (type: double), KEY.reducesinkkey0 (type: varchar(5)), VALUE._col8 (type: int)
+                outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col8, _col9
+                Select Vectorization:
+                    className: VectorSelectOperator
+                    native: true
+                    projectedOutputColumnNums: [1, 2, 3, 4, 5, 0, 6]
+                Statistics: Num rows: 40 Data size: 15864 Basic stats: COMPLETE Column stats: COMPLETE
+                PTF Operator
+                  Function definitions:
+                      Input definition
+                        input alias: ptf_0
+                        output shape: _col0: string, _col1: string, _col2: date, _col3: timestamp, _col5: double, _col8: varchar(5), _col9: int
+                        type: WINDOWING
+                      Windowing table definition
+                        input alias: ptf_1
+                        name: windowingtablefunction
+                        order by: _col8 ASC NULLS FIRST
+                        partition by: _col8
+                        raw input shape:
+                        window functions:
+                            window function definition
+                              alias: count_window_0
+                              name: count
+                              window function: GenericUDAFCountEvaluator
+                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
+                              isStar: true
+                            window function definition
+                              alias: sum_window_1
+                              arguments: _col5
+                              name: sum
+                              window function: GenericUDAFSumDouble
+                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
+                  PTF Vectorization:
+                      allEvaluatorsAreStreaming: false
+                      className: VectorPTFOperator
+                      evaluatorClasses: [VectorPTFEvaluatorCountStar, VectorPTFEvaluatorDoubleSum]
+                      functionInputExpressions: [null, col 5:double]
+                      functionNames: [count, sum]
+                      keyInputColumns: [0]
+                      native: true
+                      nonKeyInputColumns: [1, 2, 3, 4, 5, 6]
+                      orderExpressions: [col 0:varchar(5)]
+                      outputColumns: [7, 8, 1, 2, 3, 4, 5, 0, 6]
+                      outputTypes: [bigint, double, string, string, date, timestamp, double, varchar(5), int]
+                      partitionExpressions: [col 0:varchar(5)]
+                      streamingColumns: []
+                  Statistics: Num rows: 40 Data size: 15864 Basic stats: COMPLETE Column stats: COMPLETE
+                  Select Operator
+                    expressions: _col0 (type: string), _col1 (type: string), _col3 (type: timestamp), _col9 (type: int), _col2 (type: date), _col5 (type: double), _col8 (type: varchar(5)), count_window_0 (type: bigint), sum_window_1 (type: double)
+                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
+                    Select Vectorization:
+                        className: VectorSelectOperator
+                        native: true
+                        projectedOutputColumnNums: [1, 2, 4, 6, 3, 5, 0, 7, 8]
+                    Statistics: Num rows: 40 Data size: 15704 Basic stats: COMPLETE Column stats: COMPLETE
+                    File Output Operator
+                      compressed: false
+                      File Sink Vectorization:
+                          className: VectorFileSinkOperator
+                          native: false
+                      Statistics: Num rows: 40 Data size: 15704 Basic stats: COMPLETE Column stats: COMPLETE
+                      table:
+                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+
+  Stage: Stage-0
+    Fetch Operator
+      limit: -1
+      Processor Tree:
+        ListSink
+
+PREHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_varchar,
+       count(*) over(partition by p_varchar) as cs,
+       sum(p_retailprice) over(partition by p_varchar) as s
+from vector_ptf_part_simple_orc
+PREHOOK: type: QUERY
+PREHOOK: Input: default@vector_ptf_part_simple_orc
+#### A masked pattern was here ####
+POSTHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_varchar,
+       count(*) over(partition by p_varchar) as cs,
+       sum(p_retailprice) over(partition by p_varchar) as s
+from vector_ptf_part_simple_orc
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@vector_ptf_part_simple_orc
+#### A masked pattern was here ####
+p_mfgr	p_name	p_timestamp	rowindex	p_date	p_retailprice	p_varchar	cs	s
+Manufacturer#2	almond antique violet turquoise frosted	NULL	13	NULL	1800.7	AC	3	4891.75
+Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	5	1970-01-05	1753.76	AC	3	4891.75
+Manufacturer#3	almond antique olive coral navajo	1970-01-03 00:00:00	28	1970-01-03	1337.29	AC	3	4891.75
+Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	9	1970-01-04	1632.66	AK	1	1632.66
+Manufacturer#3	almond antique forest lavender goldenrod	1970-01-04 00:00:00	14	1970-01-04	NULL	BB	3	3391.3199999999997
+Manufacturer#5	almond antique sky peru orange	1970-01-02 00:00:00	22	1970-01-02	1788.73	BB	3	3391.3199999999997
+Manufacturer#1	almond antique salmon chartreuse burlywood	1970-01-05 00:00:00	30	1970-01-05	1602.59	BB	3	3391.3199999999997
+Manufacturer#2	almond aquamarine sandy cyan gainsboro	NULL	32	NULL	1000.6	BD	1	1000.6
+Manufacturer#2	almond aquamarine rose maroon antique	1970-01-03 00:00:00	3	1970-01-03	1698.66	CA	2	2888.9300000000003
+Manufacturer#3	almond antique forest lavender goldenrod	1970-01-03 00:00:00	33	1970-01-03	1190.27	CA	2	2888.9300000000003
+Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	35	1970-01-05	NULL	CC	2	1632.66
+Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-03 00:00:00	23	1970-01-03	1632.66	CC	2	1632.66
+Manufacturer#3	almond antique forest lavender goldenrod	NULL	19	NULL	590.27	CD	2	1608.37
+Manufacturer#5	almond aquamarine dodger light gainsboro	1970-01-01 00:00:00	36	1970-01-01	1018.1	CD	2	1608.37
+Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-02 00:00:00	12	1970-01-02	1753.76	DA	3	3944.7699999999995
+Manufacturer#4	almond azure aquamarine papaya violet	1970-01-02 00:00:00	37	1970-01-02	1290.35	DA	3	3944.7699999999995
+Manufacturer#2	almond aquamarine rose maroon antique	NULL	1	NULL	900.66	DA	3	3944.7699999999995
+Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	40	1970-01-05	1206.26	DD	2	1305.94
+Manufacturer#3	almond antique chartreuse khaki white	1970-01-04 00:00:00	24	1970-01-04	99.68	DD	2	1305.94
+Manufacturer#4	almond antique gainsboro frosted violet	NULL	25	NULL	NULL	EE	1	NULL
+Manufacturer#2	almond antique violet chocolate turquoise	1970-01-05 00:00:00	15	1970-01-05	1690.68	LM	1	1690.68
+Manufacturer#1	almond antique burnished rose metallic	1970-01-03 00:00:00	8	1970-01-03	1173.15	SM	1	1173.15
+Manufacturer#5	almond antique medium spring khaki	1970-01-01 00:00:00	6	1970-01-01	1611.66	AA	3	5024.02
+Manufacturer#2	almond antique violet turquoise frosted	1970-01-01 00:00:00	21	1970-01-01	1800.7	AA	3	5024.02
+Manufacturer#5	almond antique medium spring khaki	1970-01-04 00:00:00	29	1970-01-04	1611.66	AA	3	5024.02
+Manufacturer#5	almond azure blanched chiffon midnight	1970-01-03 00:00:00	18	1970-01-03	1464.48	AB	3	4679.6
+Manufacturer#1	almond aquamarine burnished black steel	1970-01-02 00:00:00	2	1970-01-02	1414.42	AB	3	4679.6
+Manufacturer#2	almond antique violet turquoise frosted	1970-01-02 00:00:00	27	1970-01-02	1800.7	AB	3	4679.6
+Manufacturer#1	almond antique chartreuse lavender yellow	NULL	26	NULL	1753.76	AD	1	1753.76
+Manufacturer#3	almond antique forest lavender goldenrod	1970-01-05 00:00:00	10	1970-01-05	1190.27	AY	1	1190.27
+Manufacturer#3	almond antique misty red olive	1970-01-01 00:00:00	31	1970-01-01	1922.98	BC	1	1922.98
+Manufacturer#2	almond aquamarine midnight light salmon	1970-01-04 00:00:00	34	1970-01-04	2031.98	CB	1	2031.98
+Manufacturer#3	almond antique metallic orange dim	NULL	38	NULL	55.39	DB	1	55.39
+Manufacturer#1	almond antique burnished rose metallic	1970-01-04 00:00:00	39	1970-01-04	1173.15	DC	1	1173.15
+Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	4	1970-01-04	NULL	DE	1	NULL
+Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	20	1970-01-05	1753.76	EF	1	1753.76
+Manufacturer#4	almond aquamarine yellow dodger mint	1970-01-01 00:00:00	11	1970-01-01	1844.92	FD	2	3634.61
+Manufacturer#5	almond antique blue firebrick mint	NULL	7	NULL	1789.69	FD	2	3634.61
+Manufacturer#4	almond antique violet mint lemon	1970-01-01 00:00:00	16	1970-01-01	1375.42	OP	1	1375.42
+Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-02 00:00:00	17	1970-01-02	1632.66	RS	1	1632.66
+PREHOOK: query: select "************ VARCHAR PARTITION WITH CONSTANT PARTITION EXPRESSION ************"
+PREHOOK: type: QUERY
+PREHOOK: Input: _dummy_database@_dummy_table
+#### A masked pattern was here ####
+POSTHOOK: query: select "************ VARCHAR PARTITION WITH CONSTANT PARTITION EXPRESSION ************"
+POSTHOOK: type: QUERY
+POSTHOOK: Input: _dummy_database@_dummy_table
+#### A masked pattern was here ####
+_c0
+************ VARCHAR PARTITION WITH CONSTANT PARTITION EXPRESSION ************
+PREHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_varchar,
+       count(*) over(partition by p_varchar) as cs,
+       sum(p_retailprice) over(partition by p_varchar) as s
+from vector_ptf_part_simple_orc
+where p_name = 'DA'
+PREHOOK: type: QUERY
+PREHOOK: Input: default@vector_ptf_part_simple_orc
+#### A masked pattern was here ####
+POSTHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_varchar,
+       count(*) over(partition by p_varchar) as cs,
+       sum(p_retailprice) over(partition by p_varchar) as s
+from vector_ptf_part_simple_orc
+where p_name = 'DA'
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@vector_ptf_part_simple_orc
+#### A masked pattern was here ####
+p_mfgr	p_name	p_timestamp	rowindex	p_date	p_retailprice	p_varchar	cs	s
+PREHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice, p_varchar,
+                                    count(*) over(partition by p_varchar) as cs,
+                                    sum(p_retailprice) over(partition by p_varchar) as s
+from vector_ptf_part_simple_orc
+where p_varchar = 'DA'
+PREHOOK: type: QUERY
+PREHOOK: Input: default@vector_ptf_part_simple_orc
+#### A masked pattern was here ####
+POSTHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice, p_varchar,
+                                    count(*) over(partition by p_varchar) as cs,
+                                    sum(p_retailprice) over(partition by p_varchar) as s
+from vector_ptf_part_simple_orc
+where p_varchar = 'DA'
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@vector_ptf_part_simple_orc
+#### A masked pattern was here ####
+Explain
+PLAN VECTORIZATION:
+  enabled: true
+  enabledConditionsMet: [hive.vectorized.execution.enabled IS true]
+
+STAGE DEPENDENCIES:
+  Stage-1 is a root stage
+  Stage-0 depends on stages: Stage-1
+
+STAGE PLANS:
+  Stage: Stage-1
+    Tez
+#### A masked pattern was here ####
+      Edges:
+        Reducer 2 <- Map 1 (SIMPLE_EDGE)
+#### A masked pattern was here ####
+      Vertices:
+        Map 1 
+            Map Operator Tree:
+                TableScan
+                  alias: vector_ptf_part_simple_orc
+                  filterExpr: (p_varchar = 'DA') (type: boolean)
+                  Statistics: Num rows: 40 Data size: 15864 Basic stats: COMPLETE Column stats: COMPLETE
+                  TableScan Vectorization:
+                      native: true
+                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:p_char:char(1), 8:p_varchar:varchar(5), 9:rowindex:int, 10:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 11:ROW__IS__DELETED:boolean]
+                  Filter Operator
+                    Filter Vectorization:
+                        className: VectorFilterOperator
+                        native: true
+                        predicateExpression: FilterStringGroupColEqualVarCharScalar(col 8:varchar(5), val DA)
+                    predicate: (p_varchar = 'DA') (type: boolean)
+                    Statistics: Num rows: 2 Data size: 828 Basic stats: COMPLETE Column stats: COMPLETE
+                    Reduce Output Operator
+                      key expressions: CAST( 'DA' AS varchar(5)) (type: varchar(5))
+                      null sort order: a
+                      sort order: +
+                      Map-reduce partition columns: CAST( 'DA' AS varchar(5)) (type: varchar(5))
+                      Reduce Sink Vectorization:
+                          className: VectorReduceSinkStringOperator
+                          keyColumns: 12:varchar(5)
+                          keyExpressions: VectorUDFAdaptor(CAST( 'DA' AS varchar(5))) -> 12:varchar(5)
+                          native: true
+                          nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez, spark] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
+                          valueColumns: 0:string, 1:string, 2:date, 3:timestamp, 5:double, 9:int
+                      Statistics: Num rows: 2 Data size: 828 Basic stats: COMPLETE Column stats: COMPLETE
+                      value expressions: p_mfgr (type: string), p_name (type: string), p_date (type: date), p_timestamp (type: timestamp), p_retailprice (type: double), rowindex (type: int)
+            Execution mode: vectorized, llap
+            LLAP IO: all inputs
+            Map Vectorization:
+                enabled: true
+                enabledConditionsMet: hive.vectorized.use.vectorized.input.format IS true
+                inputFormatFeatureSupport: [DECIMAL_64]
+                featureSupportInUse: [DECIMAL_64]
+                inputFileFormats: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
+                allNative: true
+                usesVectorUDFAdaptor: true
+                vectorized: true
+                rowBatchContext:
+                    dataColumnCount: 10
+                    includeColumns: [0, 1, 2, 3, 5, 8, 9]
+                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, p_char:char(1), p_varchar:varchar(5), rowindex:int
+                    partitionColumnCount: 0
+                    scratchColumnTypeNames: [string]
+        Reducer 2 
+            Execution mode: vectorized, llap
+            Reduce Vectorization:
+                enabled: true
+                enableConditionsMet: hive.vectorized.execution.reduce.enabled IS true, hive.execution.engine tez IN [tez, spark] IS true
+                reduceColumnNullOrder: a
+                reduceColumnSortOrder: +
+                allNative: false
+                usesVectorUDFAdaptor: false
+                vectorized: true
+                rowBatchContext:
+                    dataColumnCount: 7
+                    dataColumns: KEY.reducesinkkey0:varchar(5), VALUE._col0:string, VALUE._col1:string, VALUE._col2:date, VALUE._col3:timestamp, VALUE._col5:double, VALUE._col9:int
+                    partitionColumnCount: 0
+                    scratchColumnTypeNames: [bigint, double, string, string, string]
+            Reduce Operator Tree:
+              Select Operator
+                expressions: VALUE._col0 (type: string), VALUE._col1 (type: string), VALUE._col2 (type: date), VALUE._col3 (type: timestamp), VALUE._col5 (type: double), VALUE._col9 (type: int)
+                outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col9
+                Select Vectorization:
+                    className: VectorSelectOperator
+                    native: true
+                    projectedOutputColumnNums: [1, 2, 3, 4, 5, 6]
+                Statistics: Num rows: 2 Data size: 656 Basic stats: COMPLETE Column stats: COMPLETE
+                PTF Operator
+                  Function definitions:
+                      Input definition
+                        input alias: ptf_0
+                        output shape: _col0: string, _col1: string, _col2: date, _col3: timestamp, _col5: double, _col9: int
+                        type: WINDOWING
+                      Windowing table definition
+                        input alias: ptf_1
+                        name: windowingtablefunction
+                        order by: CAST( 'DA' AS varchar(5)) ASC NULLS FIRST
+                        partition by: CAST( 'DA' AS varchar(5))
+                        raw input shape:
+                        window functions:
+                            window function definition
+                              alias: count_window_0
+                              name: count
+                              window function: GenericUDAFCountEvaluator
+                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
+                              isStar: true
+                            window function definition
+                              alias: sum_window_1
+                              arguments: _col5
+                              name: sum
+                              window function: GenericUDAFSumDouble
+                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
+                  PTF Vectorization:
+                      allEvaluatorsAreStreaming: false
+                      className: VectorPTFOperator
+                      evaluatorClasses: [VectorPTFEvaluatorCountStar, VectorPTFEvaluatorDoubleSum]
+                      functionInputExpressions: [null, col 5:double]
+                      functionNames: [count, sum]
+                      keyInputColumns: []
+                      native: true
+                      nonKeyInputColumns: [1, 2, 3, 4, 5, 6]
+                      orderExpressions: [VectorUDFAdaptor(CAST( 'DA' AS varchar(5))) -> 10:varchar(5)]
+                      outputColumns: [7, 8, 1, 2, 3, 4, 5, 6]
+                      outputTypes: [bigint, double, string, string, date, timestamp, double, int]
+                      partitionExpressions: [VectorUDFAdaptor(CAST( 'DA' AS varchar(5))) -> 9:varchar(5)]
+                      streamingColumns: []
+                  Statistics: Num rows: 2 Data size: 656 Basic stats: COMPLETE Column stats: COMPLETE
+                  Select Operator
+                    expressions: _col0 (type: string), _col1 (type: string), _col3 (type: timestamp), _col9 (type: int), _col2 (type: date), _col5 (type: double), 'DA' (type: varchar(5)), count_window_0 (type: bigint), sum_window_1 (type: double)
+                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
+                    Select Vectorization:
+                        className: VectorSelectOperator
+                        native: true
+                        projectedOutputColumnNums: [1, 2, 4, 6, 3, 5, 11, 7, 8]
+                        selectExpressions: ConstantVectorExpression(val DA) -> 11:varchar(5)
+                    Statistics: Num rows: 2 Data size: 860 Basic stats: COMPLETE Column stats: COMPLETE
+                    File Output Operator
+                      compressed: false
+                      File Sink Vectorization:
+                          className: VectorFileSinkOperator
+                          native: false
+                      Statistics: Num rows: 2 Data size: 860 Basic stats: COMPLETE Column stats: COMPLETE
+                      table:
+                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+
+  Stage: Stage-0
+    Fetch Operator
+      limit: -1
+      Processor Tree:
+        ListSink
+
