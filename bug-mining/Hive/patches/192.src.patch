diff --git a/CHANGES.txt b/CHANGES.txt
index f88402a0aa..48fc1c2949 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -291,6 +291,9 @@ Trunk - Unreleased
     HIVE-596. Fix PartitionPruner to work with GenericUDF.
     (Namit Jain via zshao)
 
+    HIVE-590. Pass type information in genFileSinkPlan and improve getSchema
+    call in Driver. (Namit Jain via rmurthy)
+
 Release 0.3.1 - Unreleased
 
   INCOMPATIBLE CHANGES
diff --git a/jdbc/src/java/org/apache/hadoop/hive/jdbc/HiveResultSet.java b/jdbc/src/java/org/apache/hadoop/hive/jdbc/HiveResultSet.java
index 1f7f1e12e4..a9778123c2 100644
--- a/jdbc/src/java/org/apache/hadoop/hive/jdbc/HiveResultSet.java
+++ b/jdbc/src/java/org/apache/hadoop/hive/jdbc/HiveResultSet.java
@@ -21,14 +21,15 @@
 import java.sql.Statement;
 import java.sql.Time;
 import java.sql.Timestamp;
-import java.util.Arrays;
 import java.util.Calendar;
 import java.util.Map;
 import java.util.List;
 import java.util.ArrayList;
 import java.util.Properties;
+
+import org.apache.hadoop.hive.metastore.api.FieldSchema;
+import org.apache.hadoop.hive.metastore.api.Schema;
 import org.apache.hadoop.hive.serde2.dynamic_type.DynamicSerDe;
-import org.apache.hadoop.hive.serde2.objectinspector.ObjectInspector;
 import org.apache.hadoop.hive.serde.Constants;
 import org.apache.hadoop.conf.Configuration;
 import org.apache.hadoop.hive.service.HiveInterface;
@@ -57,17 +58,32 @@ public HiveResultSet(HiveInterface client) {
    */
   public void initDynamicSerde() {
     try {
-      String fullSchema = client.getSchema();
-      String[] schemaParts = fullSchema.split("#");
-      if (schemaParts.length > 2) {
-        columnNames = Arrays.asList(schemaParts[1].split(","));
-        columnTypes = Arrays.asList(schemaParts[2].split(":"));
+      Schema fullSchema = client.getSchema();
+      List<FieldSchema> schema = fullSchema.getFieldSchemas();
+      columnNames = new ArrayList<String>();
+      columnTypes = new ArrayList<String>();
+      
+      String serDDL;
+      
+      if ((schema != null) && (!schema.isEmpty())) {
+        serDDL = new String("struct result { ");
+        for (int pos = 0; pos < schema.size(); pos++) {
+          if (pos != 0)
+            serDDL = serDDL.concat(",");
+          serDDL = serDDL.concat(schema.get(pos).getType());
+          serDDL = serDDL.concat(" ");
+          serDDL = serDDL.concat(schema.get(pos).getName());
+        }
+        serDDL = serDDL.concat("}");
       }
+      else
+        serDDL = new String("struct result { string empty }");
+
       ds = new DynamicSerDe();
       Properties dsp = new Properties();
       dsp.setProperty(Constants.SERIALIZATION_FORMAT, org.apache.hadoop.hive.serde2.thrift.TCTLSeparatedProtocol.class.getName());
       dsp.setProperty(org.apache.hadoop.hive.metastore.api.Constants.META_TABLE_NAME, "result");
-      dsp.setProperty(Constants.SERIALIZATION_DDL, schemaParts[0]);
+      dsp.setProperty(Constants.SERIALIZATION_DDL, serDDL);
       dsp.setProperty(Constants.SERIALIZATION_LIB, ds.getClass().toString());
       dsp.setProperty(Constants.FIELD_DELIM, "9");
       ds.initialize(new Configuration(), dsp);
diff --git a/jdbc/src/test/org/apache/hadoop/hive/jdbc/TestJdbcDriver.java b/jdbc/src/test/org/apache/hadoop/hive/jdbc/TestJdbcDriver.java
index 36d085574f..015cb9ff54 100644
--- a/jdbc/src/test/org/apache/hadoop/hive/jdbc/TestJdbcDriver.java
+++ b/jdbc/src/test/org/apache/hadoop/hive/jdbc/TestJdbcDriver.java
@@ -19,6 +19,7 @@
 public class TestJdbcDriver extends TestCase {
   private static String driverName = "org.apache.hadoop.hive.jdbc.HiveDriver";
   private static String tableName = "testHiveDriverTable";
+  private static String partitionedTableName = "testHiveDriverPartitionedTable";
   private HiveConf conf;
   private Path dataFilePath;
   private Connection con;
@@ -29,7 +30,7 @@ public TestJdbcDriver(String name) {
     conf = new HiveConf(TestJdbcDriver.class);
     String dataFileDir = conf.get("test.data.files").replace('\\', '/').replace("c:", "");
     dataFilePath = new Path(dataFileDir, "kv1.txt");
-    //standAloneServer = System.getProperty("test.service.standalone.server").equals("true");
+    standAloneServer = "true".equals(System.getProperty("test.service.standalone.server"));
   }
 
   protected void setUp() throws Exception {
@@ -55,15 +56,29 @@ protected void setUp() throws Exception {
     // create table
     ResultSet res = stmt.executeQuery("create table " + tableName + " (key int, value string)");
     assertFalse(res.next());
-//    res = stmt.executeQuery("describe " + tableName);
-//    while (res.next()) {
-//      System.out.println(res.getString(1));
-//    }
 
     // load data
     res = stmt.executeQuery("load data local inpath '" + dataFilePath.toString() + "' into table " + tableName);
     assertFalse(res.next());
 
+    // also initialize a paritioned table to test against.
+
+    // drop table. ignore error.
+    try {
+      stmt.executeQuery("drop table " + partitionedTableName);
+    } catch (Exception ex) {
+    }
+
+    res = stmt.executeQuery("create table " + partitionedTableName +
+                            " (key int, value string) partitioned by (dt STRING)");
+    assertFalse(res.next());
+
+    // load data
+    res = stmt.executeQuery("load data local inpath '" + dataFilePath.toString() +
+                            "' into table " + partitionedTableName +
+                            " PARTITION (dt='20090619')");
+    assertFalse(res.next());
+
   }
 
   protected void tearDown() throws Exception {
@@ -74,10 +89,12 @@ protected void tearDown() throws Exception {
     assertNotNull("Statement is null", stmt);
     ResultSet res = stmt.executeQuery("drop table " + tableName);
     assertFalse(res.next());
+    res = stmt.executeQuery("drop table " + partitionedTableName);
+    assertFalse(res.next());
 
   }
 
-  public final void testHiveDriver() throws Exception {
+  public final void testSelectAll() throws Exception {
     Statement stmt = con.createStatement();
     assertNotNull("Statement is null", stmt);
 
@@ -108,13 +125,50 @@ public final void testHiveDriver() throws Exception {
     while (moreRow) {
       try {
         i++;
-        res.getString(2);
+        res.getInt(1);
         res.getString(1);
+        res.getString(2);
+        //System.out.println(res.getString(1) + " " + res.getString(2));
+        assertEquals("getInt and getString don't align for the same result value",
+                String.valueOf(res.getInt(1)), res.getString(1));
+        assertEquals("Unexpected result found",
+                "val_" + res.getString(1), res.getString(2));
+        moreRow = res.next();
+      }
+      catch (SQLException e) {
+        System.out.println(e.toString());
+        e.printStackTrace();
+        throw new Exception(e.toString());
+      }
+    }
+    // supposed to get 500 rows
+    assertEquals(500, i);
+
+    // should have no more rows
+    assertEquals(false, moreRow);
+  }
+
+  public final void testSelectAllPartitioned() throws Exception {
+    Statement stmt = con.createStatement();
+    assertNotNull("Statement is null", stmt);
+
+    // run some queries
+    ResultSet res = stmt.executeQuery("select * from " + partitionedTableName);
+    assertNotNull("ResultSet is null", res);
+    int i = 0;
+
+    boolean moreRow = res.next();
+    while (moreRow) {
+      try {
+        i++;
         res.getInt(1);
-        // TODO add assert
-//      System.out.println(res.getString(2));
-//      System.out.println(res.getString(1));
-//      System.out.println(res.getInt(1));
+        res.getString(1);
+        res.getString(2);
+        //System.out.println(res.getString(1) + " " + res.getString(2));
+        assertEquals("getInt and getString don't align for the same result value",
+                String.valueOf(res.getInt(1)), res.getString(1));
+        assertEquals("Unexpected result found",
+                "val_" + res.getString(1), res.getString(2));
         moreRow = res.next();
       }
       catch (SQLException e) {
@@ -129,4 +183,40 @@ public final void testHiveDriver() throws Exception {
     // should have no more rows
     assertEquals(false, moreRow);
   }
+
+  public void testShowTables() throws SQLException {
+    Statement stmt = con.createStatement();
+    assertNotNull("Statement is null", stmt);
+
+    ResultSet res = stmt.executeQuery("show tables");
+
+    boolean testTableExists = false;
+    while (res.next()) {
+      assertNotNull("table name is null in result set", res.getString(1));
+      if (tableName.equalsIgnoreCase(res.getString(1))) testTableExists = true;
+    }
+
+    assertTrue("table name " + tableName + " not found in SHOW TABLES result set",
+               testTableExists);
+  }
+
+  public void testDescribeTable() throws SQLException {
+    Statement stmt = con.createStatement();
+    assertNotNull("Statement is null", stmt);
+
+    ResultSet res = stmt.executeQuery("describe " + tableName);
+
+    res.next();
+    assertEquals("Column name 'key' not found", "key", res.getString(1));
+    assertEquals("Column type 'int' for column key not found",
+                "int", res.getString(2));
+    res.next();
+    assertEquals("Column name 'value' not found", "value", res.getString(1));
+    assertEquals("Column type 'string' for column key not found",
+                "string", res.getString(2));
+
+    assertFalse("More results found than expected", res.next());
+
+  }
+
 }
diff --git a/metastore/if/hive_metastore.thrift b/metastore/if/hive_metastore.thrift
index 061332c80d..dbdd47d4e6 100755
--- a/metastore/if/hive_metastore.thrift
+++ b/metastore/if/hive_metastore.thrift
@@ -92,6 +92,14 @@ struct Index {
   5: list<string> colNames,  // for now columns will be sorted in the ascending order
 }
 
+// schema of the table/query results etc.
+struct Schema {
+ // column names, types, comments
+ 1: list<FieldSchema> fieldSchemas,  // delimiters etc
+ 2: map<string, string> properties
+}
+
+
 exception MetaException {
   string message
 }
diff --git a/metastore/src/gen-javabean/org/apache/hadoop/hive/metastore/api/Partition.java b/metastore/src/gen-javabean/org/apache/hadoop/hive/metastore/api/Partition.java
index bcd8f0de7c..e13bdca578 100644
--- a/metastore/src/gen-javabean/org/apache/hadoop/hive/metastore/api/Partition.java
+++ b/metastore/src/gen-javabean/org/apache/hadoop/hive/metastore/api/Partition.java
@@ -454,7 +454,7 @@ public String toString() {
 sb.append(",lastAccessTime:");
 sb.append(this.lastAccessTime);
 sb.append(",sd:");
-sb.append(this.sd.toString());
+sb.append(this.sd);
 sb.append(",parameters:");
 sb.append(this.parameters);
 sb.append(")");
diff --git a/metastore/src/gen-javabean/org/apache/hadoop/hive/metastore/api/StorageDescriptor.java b/metastore/src/gen-javabean/org/apache/hadoop/hive/metastore/api/StorageDescriptor.java
index 1f6287bd36..2232f5f290 100644
--- a/metastore/src/gen-javabean/org/apache/hadoop/hive/metastore/api/StorageDescriptor.java
+++ b/metastore/src/gen-javabean/org/apache/hadoop/hive/metastore/api/StorageDescriptor.java
@@ -653,7 +653,7 @@ public String toString() {
 sb.append(",numBuckets:");
 sb.append(this.numBuckets);
 sb.append(",serdeInfo:");
-sb.append(this.serdeInfo.toString());
+sb.append(this.serdeInfo);
 sb.append(",bucketCols:");
 sb.append(this.bucketCols);
 sb.append(",sortCols:");
diff --git a/metastore/src/gen-javabean/org/apache/hadoop/hive/metastore/api/Table.java b/metastore/src/gen-javabean/org/apache/hadoop/hive/metastore/api/Table.java
index 96bb09bb18..25f31772c1 100644
--- a/metastore/src/gen-javabean/org/apache/hadoop/hive/metastore/api/Table.java
+++ b/metastore/src/gen-javabean/org/apache/hadoop/hive/metastore/api/Table.java
@@ -541,7 +541,7 @@ public String toString() {
 sb.append(",retention:");
 sb.append(this.retention);
 sb.append(",sd:");
-sb.append(this.sd.toString());
+sb.append(this.sd);
 sb.append(",partitionKeys:");
 sb.append(this.partitionKeys);
 sb.append(",parameters:");
diff --git a/metastore/src/gen-javabean/org/apache/hadoop/hive/metastore/api/ThriftHiveMetastore.java b/metastore/src/gen-javabean/org/apache/hadoop/hive/metastore/api/ThriftHiveMetastore.java
index 895f80adaf..ff975635c4 100644
--- a/metastore/src/gen-javabean/org/apache/hadoop/hive/metastore/api/ThriftHiveMetastore.java
+++ b/metastore/src/gen-javabean/org/apache/hadoop/hive/metastore/api/ThriftHiveMetastore.java
@@ -1826,9 +1826,9 @@ public String toString() {
 sb.append("success:");
 sb.append(this.success);
 sb.append(",o1:");
-sb.append(this.o1.toString());
+sb.append(this.o1);
 sb.append(",o2:");
-sb.append(this.o2.toString());
+sb.append(this.o2);
 sb.append(")");
 return sb.toString();
 }
@@ -2153,11 +2153,11 @@ public void write(TProtocol oprot) throws TException {
 public String toString() {
 StringBuilder sb = new StringBuilder("get_database_result(");
 sb.append("success:");
-sb.append(this.success.toString());
+sb.append(this.success);
 sb.append(",o1:");
-sb.append(this.o1.toString());
+sb.append(this.o1);
 sb.append(",o2:");
-sb.append(this.o2.toString());
+sb.append(this.o2);
 sb.append(")");
 return sb.toString();
 }
@@ -2434,7 +2434,7 @@ public String toString() {
 sb.append("success:");
 sb.append(this.success);
 sb.append(",o2:");
-sb.append(this.o2.toString());
+sb.append(this.o2);
 sb.append(")");
 return sb.toString();
 }
@@ -2618,13 +2618,13 @@ public void read(TProtocol iprot) throws TException {
     case 0:
       if (field.type == TType.LIST) {
         {
-          TList _list48 = iprot.readListBegin();
-          this.success = new ArrayList<String>(_list48.size);
-          for (int _i49 = 0; _i49 < _list48.size; ++_i49)
+          TList _list57 = iprot.readListBegin();
+          this.success = new ArrayList<String>(_list57.size);
+          for (int _i58 = 0; _i58 < _list57.size; ++_i58)
           {
-            String _elem50 = null;
-            _elem50 = iprot.readString();
-            this.success.add(_elem50);
+            String _elem59 = null;
+            _elem59 = iprot.readString();
+            this.success.add(_elem59);
           }
           iprot.readListEnd();
         }
@@ -2664,8 +2664,8 @@ public void write(TProtocol oprot) throws TException {
     oprot.writeFieldBegin(field);
     {
       oprot.writeListBegin(new TList(TType.STRING, this.success.size()));
-      for (String _iter51 : this.success)      {
-        oprot.writeString(_iter51);
+      for (String _iter60 : this.success)      {
+        oprot.writeString(_iter60);
       }
       oprot.writeListEnd();
     }
@@ -2690,7 +2690,7 @@ public String toString() {
 sb.append("success:");
 sb.append(this.success);
 sb.append(",o1:");
-sb.append(this.o1.toString());
+sb.append(this.o1);
 sb.append(")");
 return sb.toString();
 }
@@ -2969,9 +2969,9 @@ public void write(TProtocol oprot) throws TException {
 public String toString() {
 StringBuilder sb = new StringBuilder("get_type_result(");
 sb.append("success:");
-sb.append(this.success.toString());
+sb.append(this.success);
 sb.append(",o2:");
-sb.append(this.o2.toString());
+sb.append(this.o2);
 sb.append(")");
 return sb.toString();
 }
@@ -3087,7 +3087,7 @@ public void write(TProtocol oprot) throws TException {
 public String toString() {
 StringBuilder sb = new StringBuilder("create_type_args(");
 sb.append("type:");
-sb.append(this.type.toString());
+sb.append(this.type);
 sb.append(")");
 return sb.toString();
 }
@@ -3342,11 +3342,11 @@ public String toString() {
 sb.append("success:");
 sb.append(this.success);
 sb.append(",o1:");
-sb.append(this.o1.toString());
+sb.append(this.o1);
 sb.append(",o2:");
-sb.append(this.o2.toString());
+sb.append(this.o2);
 sb.append(",o3:");
-sb.append(this.o3.toString());
+sb.append(this.o3);
 sb.append(")");
 return sb.toString();
 }
@@ -3623,7 +3623,7 @@ public String toString() {
 sb.append("success:");
 sb.append(this.success);
 sb.append(",o2:");
-sb.append(this.o2.toString());
+sb.append(this.o2);
 sb.append(")");
 return sb.toString();
 }
@@ -3859,16 +3859,16 @@ public void read(TProtocol iprot) throws TException {
     case 0:
       if (field.type == TType.MAP) {
         {
-          TMap _map52 = iprot.readMapBegin();
-          this.success = new HashMap<String,Type>(2*_map52.size);
-          for (int _i53 = 0; _i53 < _map52.size; ++_i53)
+          TMap _map61 = iprot.readMapBegin();
+          this.success = new HashMap<String,Type>(2*_map61.size);
+          for (int _i62 = 0; _i62 < _map61.size; ++_i62)
           {
-            String _key54;
-            Type _val55;
-            _key54 = iprot.readString();
-            _val55 = new Type();
-            _val55.read(iprot);
-            this.success.put(_key54, _val55);
+            String _key63;
+            Type _val64;
+            _key63 = iprot.readString();
+            _val64 = new Type();
+            _val64.read(iprot);
+            this.success.put(_key63, _val64);
           }
           iprot.readMapEnd();
         }
@@ -3908,9 +3908,9 @@ public void write(TProtocol oprot) throws TException {
     oprot.writeFieldBegin(field);
     {
       oprot.writeMapBegin(new TMap(TType.STRING, TType.STRUCT, this.success.size()));
-      for (String _iter56 : this.success.keySet())      {
-        oprot.writeString(_iter56);
-        this.success.get(_iter56).write(oprot);
+      for (String _iter65 : this.success.keySet())      {
+        oprot.writeString(_iter65);
+        this.success.get(_iter65).write(oprot);
       }
       oprot.writeMapEnd();
     }
@@ -3935,7 +3935,7 @@ public String toString() {
 sb.append("success:");
 sb.append(this.success);
 sb.append(",o2:");
-sb.append(this.o2.toString());
+sb.append(this.o2);
 sb.append(")");
 return sb.toString();
 }
@@ -4276,14 +4276,14 @@ public void read(TProtocol iprot) throws TException {
     case 0:
       if (field.type == TType.LIST) {
         {
-          TList _list57 = iprot.readListBegin();
-          this.success = new ArrayList<FieldSchema>(_list57.size);
-          for (int _i58 = 0; _i58 < _list57.size; ++_i58)
+          TList _list66 = iprot.readListBegin();
+          this.success = new ArrayList<FieldSchema>(_list66.size);
+          for (int _i67 = 0; _i67 < _list66.size; ++_i67)
           {
-            FieldSchema _elem59 = new FieldSchema();
-            _elem59 = new FieldSchema();
-            _elem59.read(iprot);
-            this.success.add(_elem59);
+            FieldSchema _elem68 = new FieldSchema();
+            _elem68 = new FieldSchema();
+            _elem68.read(iprot);
+            this.success.add(_elem68);
           }
           iprot.readListEnd();
         }
@@ -4341,8 +4341,8 @@ public void write(TProtocol oprot) throws TException {
     oprot.writeFieldBegin(field);
     {
       oprot.writeListBegin(new TList(TType.STRUCT, this.success.size()));
-      for (FieldSchema _iter60 : this.success)      {
-        _iter60.write(oprot);
+      for (FieldSchema _iter69 : this.success)      {
+        _iter69.write(oprot);
       }
       oprot.writeListEnd();
     }
@@ -4385,11 +4385,11 @@ public String toString() {
 sb.append("success:");
 sb.append(this.success);
 sb.append(",o1:");
-sb.append(this.o1.toString());
+sb.append(this.o1);
 sb.append(",o2:");
-sb.append(this.o2.toString());
+sb.append(this.o2);
 sb.append(",o3:");
-sb.append(this.o3.toString());
+sb.append(this.o3);
 sb.append(")");
 return sb.toString();
 }
@@ -4505,7 +4505,7 @@ public void write(TProtocol oprot) throws TException {
 public String toString() {
 StringBuilder sb = new StringBuilder("create_table_args(");
 sb.append("tbl:");
-sb.append(this.tbl.toString());
+sb.append(this.tbl);
 sb.append(")");
 return sb.toString();
 }
@@ -4762,13 +4762,13 @@ public void write(TProtocol oprot) throws TException {
 public String toString() {
 StringBuilder sb = new StringBuilder("create_table_result(");
 sb.append("o1:");
-sb.append(this.o1.toString());
+sb.append(this.o1);
 sb.append(",o2:");
-sb.append(this.o2.toString());
+sb.append(this.o2);
 sb.append(",o3:");
-sb.append(this.o3.toString());
+sb.append(this.o3);
 sb.append(",o4:");
-sb.append(this.o4.toString());
+sb.append(this.o4);
 sb.append(")");
 return sb.toString();
 }
@@ -5135,9 +5135,9 @@ public void write(TProtocol oprot) throws TException {
 public String toString() {
 StringBuilder sb = new StringBuilder("drop_table_result(");
 sb.append("o1:");
-sb.append(this.o1.toString());
+sb.append(this.o1);
 sb.append(",o3:");
-sb.append(this.o3.toString());
+sb.append(this.o3);
 sb.append(")");
 return sb.toString();
 }
@@ -5422,13 +5422,13 @@ public void read(TProtocol iprot) throws TException {
     case 0:
       if (field.type == TType.LIST) {
         {
-          TList _list61 = iprot.readListBegin();
-          this.success = new ArrayList<String>(_list61.size);
-          for (int _i62 = 0; _i62 < _list61.size; ++_i62)
+          TList _list70 = iprot.readListBegin();
+          this.success = new ArrayList<String>(_list70.size);
+          for (int _i71 = 0; _i71 < _list70.size; ++_i71)
           {
-            String _elem63 = null;
-            _elem63 = iprot.readString();
-            this.success.add(_elem63);
+            String _elem72 = null;
+            _elem72 = iprot.readString();
+            this.success.add(_elem72);
           }
           iprot.readListEnd();
         }
@@ -5468,8 +5468,8 @@ public void write(TProtocol oprot) throws TException {
     oprot.writeFieldBegin(field);
     {
       oprot.writeListBegin(new TList(TType.STRING, this.success.size()));
-      for (String _iter64 : this.success)      {
-        oprot.writeString(_iter64);
+      for (String _iter73 : this.success)      {
+        oprot.writeString(_iter73);
       }
       oprot.writeListEnd();
     }
@@ -5494,7 +5494,7 @@ public String toString() {
 sb.append("success:");
 sb.append(this.success);
 sb.append(",o1:");
-sb.append(this.o1.toString());
+sb.append(this.o1);
 sb.append(")");
 return sb.toString();
 }
@@ -5864,11 +5864,11 @@ public void write(TProtocol oprot) throws TException {
 public String toString() {
 StringBuilder sb = new StringBuilder("get_table_result(");
 sb.append("success:");
-sb.append(this.success.toString());
+sb.append(this.success);
 sb.append(",o1:");
-sb.append(this.o1.toString());
+sb.append(this.o1);
 sb.append(",o2:");
-sb.append(this.o2.toString());
+sb.append(this.o2);
 sb.append(")");
 return sb.toString();
 }
@@ -6074,7 +6074,7 @@ public String toString() {
 sb.append(",tbl_name:");
 sb.append(this.tbl_name);
 sb.append(",new_tbl:");
-sb.append(this.new_tbl.toString());
+sb.append(this.new_tbl);
 sb.append(")");
 return sb.toString();
 }
@@ -6239,9 +6239,9 @@ public void write(TProtocol oprot) throws TException {
 public String toString() {
 StringBuilder sb = new StringBuilder("alter_table_result(");
 sb.append("o1:");
-sb.append(this.o1.toString());
+sb.append(this.o1);
 sb.append(",o2:");
-sb.append(this.o2.toString());
+sb.append(this.o2);
 sb.append(")");
 return sb.toString();
 }
@@ -6357,7 +6357,7 @@ public void write(TProtocol oprot) throws TException {
 public String toString() {
 StringBuilder sb = new StringBuilder("add_partition_args(");
 sb.append("new_part:");
-sb.append(this.new_part.toString());
+sb.append(this.new_part);
 sb.append(")");
 return sb.toString();
 }
@@ -6614,13 +6614,13 @@ public void write(TProtocol oprot) throws TException {
 public String toString() {
 StringBuilder sb = new StringBuilder("add_partition_result(");
 sb.append("success:");
-sb.append(this.success.toString());
+sb.append(this.success);
 sb.append(",o1:");
-sb.append(this.o1.toString());
+sb.append(this.o1);
 sb.append(",o2:");
-sb.append(this.o2.toString());
+sb.append(this.o2);
 sb.append(",o3:");
-sb.append(this.o3.toString());
+sb.append(this.o3);
 sb.append(")");
 return sb.toString();
 }
@@ -6788,13 +6788,13 @@ public void read(TProtocol iprot) throws TException {
     case 3:
       if (field.type == TType.LIST) {
         {
-          TList _list65 = iprot.readListBegin();
-          this.part_vals = new ArrayList<String>(_list65.size);
-          for (int _i66 = 0; _i66 < _list65.size; ++_i66)
+          TList _list74 = iprot.readListBegin();
+          this.part_vals = new ArrayList<String>(_list74.size);
+          for (int _i75 = 0; _i75 < _list74.size; ++_i75)
           {
-            String _elem67 = null;
-            _elem67 = iprot.readString();
-            this.part_vals.add(_elem67);
+            String _elem76 = null;
+            _elem76 = iprot.readString();
+            this.part_vals.add(_elem76);
           }
           iprot.readListEnd();
         }
@@ -6839,8 +6839,8 @@ public void write(TProtocol oprot) throws TException {
   oprot.writeFieldBegin(field);
   {
     oprot.writeListBegin(new TList(TType.STRING, this.part_vals.size()));
-    for (String _iter68 : this.part_vals)    {
-      oprot.writeString(_iter68);
+    for (String _iter77 : this.part_vals)    {
+      oprot.writeString(_iter77);
     }
     oprot.writeListEnd();
   }
@@ -7114,13 +7114,13 @@ public void write(TProtocol oprot) throws TException {
 public String toString() {
 StringBuilder sb = new StringBuilder("append_partition_result(");
 sb.append("success:");
-sb.append(this.success.toString());
+sb.append(this.success);
 sb.append(",o1:");
-sb.append(this.o1.toString());
+sb.append(this.o1);
 sb.append(",o2:");
-sb.append(this.o2.toString());
+sb.append(this.o2);
 sb.append(",o3:");
-sb.append(this.o3.toString());
+sb.append(this.o3);
 sb.append(")");
 return sb.toString();
 }
@@ -7315,13 +7315,13 @@ public void read(TProtocol iprot) throws TException {
     case 3:
       if (field.type == TType.LIST) {
         {
-          TList _list69 = iprot.readListBegin();
-          this.part_vals = new ArrayList<String>(_list69.size);
-          for (int _i70 = 0; _i70 < _list69.size; ++_i70)
+          TList _list78 = iprot.readListBegin();
+          this.part_vals = new ArrayList<String>(_list78.size);
+          for (int _i79 = 0; _i79 < _list78.size; ++_i79)
           {
-            String _elem71 = null;
-            _elem71 = iprot.readString();
-            this.part_vals.add(_elem71);
+            String _elem80 = null;
+            _elem80 = iprot.readString();
+            this.part_vals.add(_elem80);
           }
           iprot.readListEnd();
         }
@@ -7374,8 +7374,8 @@ public void write(TProtocol oprot) throws TException {
   oprot.writeFieldBegin(field);
   {
     oprot.writeListBegin(new TList(TType.STRING, this.part_vals.size()));
-    for (String _iter72 : this.part_vals)    {
-      oprot.writeString(_iter72);
+    for (String _iter81 : this.part_vals)    {
+      oprot.writeString(_iter81);
     }
     oprot.writeListEnd();
   }
@@ -7609,9 +7609,9 @@ public String toString() {
 sb.append("success:");
 sb.append(this.success);
 sb.append(",o1:");
-sb.append(this.o1.toString());
+sb.append(this.o1);
 sb.append(",o2:");
-sb.append(this.o2.toString());
+sb.append(this.o2);
 sb.append(")");
 return sb.toString();
 }
@@ -7779,13 +7779,13 @@ public void read(TProtocol iprot) throws TException {
     case 3:
       if (field.type == TType.LIST) {
         {
-          TList _list73 = iprot.readListBegin();
-          this.part_vals = new ArrayList<String>(_list73.size);
-          for (int _i74 = 0; _i74 < _list73.size; ++_i74)
+          TList _list82 = iprot.readListBegin();
+          this.part_vals = new ArrayList<String>(_list82.size);
+          for (int _i83 = 0; _i83 < _list82.size; ++_i83)
           {
-            String _elem75 = null;
-            _elem75 = iprot.readString();
-            this.part_vals.add(_elem75);
+            String _elem84 = null;
+            _elem84 = iprot.readString();
+            this.part_vals.add(_elem84);
           }
           iprot.readListEnd();
         }
@@ -7830,8 +7830,8 @@ public void write(TProtocol oprot) throws TException {
   oprot.writeFieldBegin(field);
   {
     oprot.writeListBegin(new TList(TType.STRING, this.part_vals.size()));
-    for (String _iter76 : this.part_vals)    {
-      oprot.writeString(_iter76);
+    for (String _iter85 : this.part_vals)    {
+      oprot.writeString(_iter85);
     }
     oprot.writeListEnd();
   }
@@ -8013,9 +8013,9 @@ public void write(TProtocol oprot) throws TException {
 public String toString() {
 StringBuilder sb = new StringBuilder("get_partition_result(");
 sb.append("success:");
-sb.append(this.success.toString());
+sb.append(this.success);
 sb.append(",o1:");
-sb.append(this.o1.toString());
+sb.append(this.o1);
 sb.append(")");
 return sb.toString();
 }
@@ -8373,14 +8373,14 @@ public void read(TProtocol iprot) throws TException {
     case 0:
       if (field.type == TType.LIST) {
         {
-          TList _list77 = iprot.readListBegin();
-          this.success = new ArrayList<Partition>(_list77.size);
-          for (int _i78 = 0; _i78 < _list77.size; ++_i78)
+          TList _list86 = iprot.readListBegin();
+          this.success = new ArrayList<Partition>(_list86.size);
+          for (int _i87 = 0; _i87 < _list86.size; ++_i87)
           {
-            Partition _elem79 = new Partition();
-            _elem79 = new Partition();
-            _elem79.read(iprot);
-            this.success.add(_elem79);
+            Partition _elem88 = new Partition();
+            _elem88 = new Partition();
+            _elem88.read(iprot);
+            this.success.add(_elem88);
           }
           iprot.readListEnd();
         }
@@ -8429,8 +8429,8 @@ public void write(TProtocol oprot) throws TException {
     oprot.writeFieldBegin(field);
     {
       oprot.writeListBegin(new TList(TType.STRUCT, this.success.size()));
-      for (Partition _iter80 : this.success)      {
-        _iter80.write(oprot);
+      for (Partition _iter89 : this.success)      {
+        _iter89.write(oprot);
       }
       oprot.writeListEnd();
     }
@@ -8464,9 +8464,9 @@ public String toString() {
 sb.append("success:");
 sb.append(this.success);
 sb.append(",o1:");
-sb.append(this.o1.toString());
+sb.append(this.o1);
 sb.append(",o2:");
-sb.append(this.o2.toString());
+sb.append(this.o2);
 sb.append(")");
 return sb.toString();
 }
@@ -8796,13 +8796,13 @@ public void read(TProtocol iprot) throws TException {
     case 0:
       if (field.type == TType.LIST) {
         {
-          TList _list81 = iprot.readListBegin();
-          this.success = new ArrayList<String>(_list81.size);
-          for (int _i82 = 0; _i82 < _list81.size; ++_i82)
+          TList _list90 = iprot.readListBegin();
+          this.success = new ArrayList<String>(_list90.size);
+          for (int _i91 = 0; _i91 < _list90.size; ++_i91)
           {
-            String _elem83 = null;
-            _elem83 = iprot.readString();
-            this.success.add(_elem83);
+            String _elem92 = null;
+            _elem92 = iprot.readString();
+            this.success.add(_elem92);
           }
           iprot.readListEnd();
         }
@@ -8842,8 +8842,8 @@ public void write(TProtocol oprot) throws TException {
     oprot.writeFieldBegin(field);
     {
       oprot.writeListBegin(new TList(TType.STRING, this.success.size()));
-      for (String _iter84 : this.success)      {
-        oprot.writeString(_iter84);
+      for (String _iter93 : this.success)      {
+        oprot.writeString(_iter93);
       }
       oprot.writeListEnd();
     }
@@ -8868,7 +8868,7 @@ public String toString() {
 sb.append("success:");
 sb.append(this.success);
 sb.append(",o2:");
-sb.append(this.o2.toString());
+sb.append(this.o2);
 sb.append(")");
 return sb.toString();
 }
@@ -9074,7 +9074,7 @@ public String toString() {
 sb.append(",tbl_name:");
 sb.append(this.tbl_name);
 sb.append(",new_part:");
-sb.append(this.new_part.toString());
+sb.append(this.new_part);
 sb.append(")");
 return sb.toString();
 }
@@ -9239,9 +9239,9 @@ public void write(TProtocol oprot) throws TException {
 public String toString() {
 StringBuilder sb = new StringBuilder("alter_partition_result(");
 sb.append("o1:");
-sb.append(this.o1.toString());
+sb.append(this.o1);
 sb.append(",o2:");
-sb.append(this.o2.toString());
+sb.append(this.o2);
 sb.append(")");
 return sb.toString();
 }
diff --git a/metastore/src/gen-php/ThriftHiveMetastore.php b/metastore/src/gen-php/ThriftHiveMetastore.php
index d68cd3f3cb..211fbdeb41 100644
--- a/metastore/src/gen-php/ThriftHiveMetastore.php
+++ b/metastore/src/gen-php/ThriftHiveMetastore.php
@@ -1618,6 +1618,9 @@ class metastore_ThriftHiveMetastore_get_database_result {
     $xfer = 0;
     $xfer += $output->writeStructBegin('ThriftHiveMetastore_get_database_result');
     if ($this->success !== null) {
+      if (!is_object($this->success)) {
+        throw new TProtocolException('Bad type in structure.', TProtocolException::INVALID_DATA);
+      }
       $xfer += $output->writeFieldBegin('success', TType::STRUCT, 0);
       $xfer += $this->success->write($output);
       $xfer += $output->writeFieldEnd();
@@ -1911,14 +1914,14 @@ class metastore_ThriftHiveMetastore_get_databases_result {
         case 0:
           if ($ftype == TType::LST) {
             $this->success = array();
-            $_size85 = 0;
-            $_etype88 = 0;
-            $xfer += $input->readListBegin($_etype88, $_size85);
-            for ($_i89 = 0; $_i89 < $_size85; ++$_i89)
+            $_size101 = 0;
+            $_etype104 = 0;
+            $xfer += $input->readListBegin($_etype104, $_size101);
+            for ($_i105 = 0; $_i105 < $_size101; ++$_i105)
             {
-              $elem90 = null;
-              $xfer += $input->readString($elem90);
-              $this->success []= $elem90;
+              $elem106 = null;
+              $xfer += $input->readString($elem106);
+              $this->success []= $elem106;
             }
             $xfer += $input->readListEnd();
           } else {
@@ -1947,13 +1950,16 @@ class metastore_ThriftHiveMetastore_get_databases_result {
     $xfer = 0;
     $xfer += $output->writeStructBegin('ThriftHiveMetastore_get_databases_result');
     if ($this->success !== null) {
+      if (!is_array($this->success)) {
+        throw new TProtocolException('Bad type in structure.', TProtocolException::INVALID_DATA);
+      }
       $xfer += $output->writeFieldBegin('success', TType::LST, 0);
       {
         $output->writeListBegin(TType::STRING, count($this->success));
         {
-          foreach ($this->success as $iter91)
+          foreach ($this->success as $iter107)
           {
-            $xfer += $output->writeString($iter91);
+            $xfer += $output->writeString($iter107);
           }
         }
         $output->writeListEnd();
@@ -2124,6 +2130,9 @@ class metastore_ThriftHiveMetastore_get_type_result {
     $xfer = 0;
     $xfer += $output->writeStructBegin('ThriftHiveMetastore_get_type_result');
     if ($this->success !== null) {
+      if (!is_object($this->success)) {
+        throw new TProtocolException('Bad type in structure.', TProtocolException::INVALID_DATA);
+      }
       $xfer += $output->writeFieldBegin('success', TType::STRUCT, 0);
       $xfer += $this->success->write($output);
       $xfer += $output->writeFieldEnd();
@@ -2203,6 +2212,9 @@ class metastore_ThriftHiveMetastore_create_type_args {
     $xfer = 0;
     $xfer += $output->writeStructBegin('ThriftHiveMetastore_create_type_args');
     if ($this->type !== null) {
+      if (!is_object($this->type)) {
+        throw new TProtocolException('Bad type in structure.', TProtocolException::INVALID_DATA);
+      }
       $xfer += $output->writeFieldBegin('type', TType::STRUCT, 1);
       $xfer += $this->type->write($output);
       $xfer += $output->writeFieldEnd();
@@ -2651,18 +2663,18 @@ class metastore_ThriftHiveMetastore_get_type_all_result {
         case 0:
           if ($ftype == TType::MAP) {
             $this->success = array();
-            $_size92 = 0;
-            $_ktype93 = 0;
-            $_vtype94 = 0;
-            $xfer += $input->readMapBegin($_ktype93, $_vtype94, $_size92);
-            for ($_i96 = 0; $_i96 < $_size92; ++$_i96)
+            $_size108 = 0;
+            $_ktype109 = 0;
+            $_vtype110 = 0;
+            $xfer += $input->readMapBegin($_ktype109, $_vtype110, $_size108);
+            for ($_i112 = 0; $_i112 < $_size108; ++$_i112)
             {
-              $key97 = '';
-              $val98 = new metastore_Type();
-              $xfer += $input->readString($key97);
-              $val98 = new metastore_Type();
-              $xfer += $val98->read($input);
-              $this->success[$key97] = $val98;
+              $key113 = '';
+              $val114 = new metastore_Type();
+              $xfer += $input->readString($key113);
+              $val114 = new metastore_Type();
+              $xfer += $val114->read($input);
+              $this->success[$key113] = $val114;
             }
             $xfer += $input->readMapEnd();
           } else {
@@ -2691,14 +2703,17 @@ class metastore_ThriftHiveMetastore_get_type_all_result {
     $xfer = 0;
     $xfer += $output->writeStructBegin('ThriftHiveMetastore_get_type_all_result');
     if ($this->success !== null) {
+      if (!is_array($this->success)) {
+        throw new TProtocolException('Bad type in structure.', TProtocolException::INVALID_DATA);
+      }
       $xfer += $output->writeFieldBegin('success', TType::MAP, 0);
       {
         $output->writeMapBegin(TType::STRING, TType::STRUCT, count($this->success));
         {
-          foreach ($this->success as $kiter99 => $viter100)
+          foreach ($this->success as $kiter115 => $viter116)
           {
-            $xfer += $output->writeString($kiter99);
-            $xfer += $viter100->write($output);
+            $xfer += $output->writeString($kiter115);
+            $xfer += $viter116->write($output);
           }
         }
         $output->writeMapEnd();
@@ -2884,15 +2899,15 @@ class metastore_ThriftHiveMetastore_get_fields_result {
         case 0:
           if ($ftype == TType::LST) {
             $this->success = array();
-            $_size101 = 0;
-            $_etype104 = 0;
-            $xfer += $input->readListBegin($_etype104, $_size101);
-            for ($_i105 = 0; $_i105 < $_size101; ++$_i105)
+            $_size117 = 0;
+            $_etype120 = 0;
+            $xfer += $input->readListBegin($_etype120, $_size117);
+            for ($_i121 = 0; $_i121 < $_size117; ++$_i121)
             {
-              $elem106 = null;
-              $elem106 = new metastore_FieldSchema();
-              $xfer += $elem106->read($input);
-              $this->success []= $elem106;
+              $elem122 = null;
+              $elem122 = new metastore_FieldSchema();
+              $xfer += $elem122->read($input);
+              $this->success []= $elem122;
             }
             $xfer += $input->readListEnd();
           } else {
@@ -2937,13 +2952,16 @@ class metastore_ThriftHiveMetastore_get_fields_result {
     $xfer = 0;
     $xfer += $output->writeStructBegin('ThriftHiveMetastore_get_fields_result');
     if ($this->success !== null) {
+      if (!is_array($this->success)) {
+        throw new TProtocolException('Bad type in structure.', TProtocolException::INVALID_DATA);
+      }
       $xfer += $output->writeFieldBegin('success', TType::LST, 0);
       {
         $output->writeListBegin(TType::STRUCT, count($this->success));
         {
-          foreach ($this->success as $iter107)
+          foreach ($this->success as $iter123)
           {
-            $xfer += $iter107->write($output);
+            $xfer += $iter123->write($output);
           }
         }
         $output->writeListEnd();
@@ -3035,6 +3053,9 @@ class metastore_ThriftHiveMetastore_create_table_args {
     $xfer = 0;
     $xfer += $output->writeStructBegin('ThriftHiveMetastore_create_table_args');
     if ($this->tbl !== null) {
+      if (!is_object($this->tbl)) {
+        throw new TProtocolException('Bad type in structure.', TProtocolException::INVALID_DATA);
+      }
       $xfer += $output->writeFieldBegin('tbl', TType::STRUCT, 1);
       $xfer += $this->tbl->write($output);
       $xfer += $output->writeFieldEnd();
@@ -3542,14 +3563,14 @@ class metastore_ThriftHiveMetastore_get_tables_result {
         case 0:
           if ($ftype == TType::LST) {
             $this->success = array();
-            $_size108 = 0;
-            $_etype111 = 0;
-            $xfer += $input->readListBegin($_etype111, $_size108);
-            for ($_i112 = 0; $_i112 < $_size108; ++$_i112)
+            $_size124 = 0;
+            $_etype127 = 0;
+            $xfer += $input->readListBegin($_etype127, $_size124);
+            for ($_i128 = 0; $_i128 < $_size124; ++$_i128)
             {
-              $elem113 = null;
-              $xfer += $input->readString($elem113);
-              $this->success []= $elem113;
+              $elem129 = null;
+              $xfer += $input->readString($elem129);
+              $this->success []= $elem129;
             }
             $xfer += $input->readListEnd();
           } else {
@@ -3578,13 +3599,16 @@ class metastore_ThriftHiveMetastore_get_tables_result {
     $xfer = 0;
     $xfer += $output->writeStructBegin('ThriftHiveMetastore_get_tables_result');
     if ($this->success !== null) {
+      if (!is_array($this->success)) {
+        throw new TProtocolException('Bad type in structure.', TProtocolException::INVALID_DATA);
+      }
       $xfer += $output->writeFieldBegin('success', TType::LST, 0);
       {
         $output->writeListBegin(TType::STRING, count($this->success));
         {
-          foreach ($this->success as $iter114)
+          foreach ($this->success as $iter130)
           {
-            $xfer += $output->writeString($iter114);
+            $xfer += $output->writeString($iter130);
           }
         }
         $output->writeListEnd();
@@ -3792,6 +3816,9 @@ class metastore_ThriftHiveMetastore_get_table_result {
     $xfer = 0;
     $xfer += $output->writeStructBegin('ThriftHiveMetastore_get_table_result');
     if ($this->success !== null) {
+      if (!is_object($this->success)) {
+        throw new TProtocolException('Bad type in structure.', TProtocolException::INVALID_DATA);
+      }
       $xfer += $output->writeFieldBegin('success', TType::STRUCT, 0);
       $xfer += $this->success->write($output);
       $xfer += $output->writeFieldEnd();
@@ -3916,6 +3943,9 @@ class metastore_ThriftHiveMetastore_alter_table_args {
       $xfer += $output->writeFieldEnd();
     }
     if ($this->new_tbl !== null) {
+      if (!is_object($this->new_tbl)) {
+        throw new TProtocolException('Bad type in structure.', TProtocolException::INVALID_DATA);
+      }
       $xfer += $output->writeFieldBegin('new_tbl', TType::STRUCT, 3);
       $xfer += $this->new_tbl->write($output);
       $xfer += $output->writeFieldEnd();
@@ -4086,6 +4116,9 @@ class metastore_ThriftHiveMetastore_add_partition_args {
     $xfer = 0;
     $xfer += $output->writeStructBegin('ThriftHiveMetastore_add_partition_args');
     if ($this->new_part !== null) {
+      if (!is_object($this->new_part)) {
+        throw new TProtocolException('Bad type in structure.', TProtocolException::INVALID_DATA);
+      }
       $xfer += $output->writeFieldBegin('new_part', TType::STRUCT, 1);
       $xfer += $this->new_part->write($output);
       $xfer += $output->writeFieldEnd();
@@ -4211,6 +4244,9 @@ class metastore_ThriftHiveMetastore_add_partition_result {
     $xfer = 0;
     $xfer += $output->writeStructBegin('ThriftHiveMetastore_add_partition_result');
     if ($this->success !== null) {
+      if (!is_object($this->success)) {
+        throw new TProtocolException('Bad type in structure.', TProtocolException::INVALID_DATA);
+      }
       $xfer += $output->writeFieldBegin('success', TType::STRUCT, 0);
       $xfer += $this->success->write($output);
       $xfer += $output->writeFieldEnd();
@@ -4314,14 +4350,14 @@ class metastore_ThriftHiveMetastore_append_partition_args {
         case 3:
           if ($ftype == TType::LST) {
             $this->part_vals = array();
-            $_size115 = 0;
-            $_etype118 = 0;
-            $xfer += $input->readListBegin($_etype118, $_size115);
-            for ($_i119 = 0; $_i119 < $_size115; ++$_i119)
+            $_size131 = 0;
+            $_etype134 = 0;
+            $xfer += $input->readListBegin($_etype134, $_size131);
+            for ($_i135 = 0; $_i135 < $_size131; ++$_i135)
             {
-              $elem120 = null;
-              $xfer += $input->readString($elem120);
-              $this->part_vals []= $elem120;
+              $elem136 = null;
+              $xfer += $input->readString($elem136);
+              $this->part_vals []= $elem136;
             }
             $xfer += $input->readListEnd();
           } else {
@@ -4352,13 +4388,16 @@ class metastore_ThriftHiveMetastore_append_partition_args {
       $xfer += $output->writeFieldEnd();
     }
     if ($this->part_vals !== null) {
+      if (!is_array($this->part_vals)) {
+        throw new TProtocolException('Bad type in structure.', TProtocolException::INVALID_DATA);
+      }
       $xfer += $output->writeFieldBegin('part_vals', TType::LST, 3);
       {
         $output->writeListBegin(TType::STRING, count($this->part_vals));
         {
-          foreach ($this->part_vals as $iter121)
+          foreach ($this->part_vals as $iter137)
           {
-            $xfer += $output->writeString($iter121);
+            $xfer += $output->writeString($iter137);
           }
         }
         $output->writeListEnd();
@@ -4486,6 +4525,9 @@ class metastore_ThriftHiveMetastore_append_partition_result {
     $xfer = 0;
     $xfer += $output->writeStructBegin('ThriftHiveMetastore_append_partition_result');
     if ($this->success !== null) {
+      if (!is_object($this->success)) {
+        throw new TProtocolException('Bad type in structure.', TProtocolException::INVALID_DATA);
+      }
       $xfer += $output->writeFieldBegin('success', TType::STRUCT, 0);
       $xfer += $this->success->write($output);
       $xfer += $output->writeFieldEnd();
@@ -4597,14 +4639,14 @@ class metastore_ThriftHiveMetastore_drop_partition_args {
         case 3:
           if ($ftype == TType::LST) {
             $this->part_vals = array();
-            $_size122 = 0;
-            $_etype125 = 0;
-            $xfer += $input->readListBegin($_etype125, $_size122);
-            for ($_i126 = 0; $_i126 < $_size122; ++$_i126)
+            $_size138 = 0;
+            $_etype141 = 0;
+            $xfer += $input->readListBegin($_etype141, $_size138);
+            for ($_i142 = 0; $_i142 < $_size138; ++$_i142)
             {
-              $elem127 = null;
-              $xfer += $input->readString($elem127);
-              $this->part_vals []= $elem127;
+              $elem143 = null;
+              $xfer += $input->readString($elem143);
+              $this->part_vals []= $elem143;
             }
             $xfer += $input->readListEnd();
           } else {
@@ -4642,13 +4684,16 @@ class metastore_ThriftHiveMetastore_drop_partition_args {
       $xfer += $output->writeFieldEnd();
     }
     if ($this->part_vals !== null) {
+      if (!is_array($this->part_vals)) {
+        throw new TProtocolException('Bad type in structure.', TProtocolException::INVALID_DATA);
+      }
       $xfer += $output->writeFieldBegin('part_vals', TType::LST, 3);
       {
         $output->writeListBegin(TType::STRING, count($this->part_vals));
         {
-          foreach ($this->part_vals as $iter128)
+          foreach ($this->part_vals as $iter144)
           {
-            $xfer += $output->writeString($iter128);
+            $xfer += $output->writeString($iter144);
           }
         }
         $output->writeListEnd();
@@ -4860,14 +4905,14 @@ class metastore_ThriftHiveMetastore_get_partition_args {
         case 3:
           if ($ftype == TType::LST) {
             $this->part_vals = array();
-            $_size129 = 0;
-            $_etype132 = 0;
-            $xfer += $input->readListBegin($_etype132, $_size129);
-            for ($_i133 = 0; $_i133 < $_size129; ++$_i133)
+            $_size145 = 0;
+            $_etype148 = 0;
+            $xfer += $input->readListBegin($_etype148, $_size145);
+            for ($_i149 = 0; $_i149 < $_size145; ++$_i149)
             {
-              $elem134 = null;
-              $xfer += $input->readString($elem134);
-              $this->part_vals []= $elem134;
+              $elem150 = null;
+              $xfer += $input->readString($elem150);
+              $this->part_vals []= $elem150;
             }
             $xfer += $input->readListEnd();
           } else {
@@ -4898,13 +4943,16 @@ class metastore_ThriftHiveMetastore_get_partition_args {
       $xfer += $output->writeFieldEnd();
     }
     if ($this->part_vals !== null) {
+      if (!is_array($this->part_vals)) {
+        throw new TProtocolException('Bad type in structure.', TProtocolException::INVALID_DATA);
+      }
       $xfer += $output->writeFieldBegin('part_vals', TType::LST, 3);
       {
         $output->writeListBegin(TType::STRING, count($this->part_vals));
         {
-          foreach ($this->part_vals as $iter135)
+          foreach ($this->part_vals as $iter151)
           {
-            $xfer += $output->writeString($iter135);
+            $xfer += $output->writeString($iter151);
           }
         }
         $output->writeListEnd();
@@ -4998,6 +5046,9 @@ class metastore_ThriftHiveMetastore_get_partition_result {
     $xfer = 0;
     $xfer += $output->writeStructBegin('ThriftHiveMetastore_get_partition_result');
     if ($this->success !== null) {
+      if (!is_object($this->success)) {
+        throw new TProtocolException('Bad type in structure.', TProtocolException::INVALID_DATA);
+      }
       $xfer += $output->writeFieldBegin('success', TType::STRUCT, 0);
       $xfer += $this->success->write($output);
       $xfer += $output->writeFieldEnd();
@@ -5192,15 +5243,15 @@ class metastore_ThriftHiveMetastore_get_partitions_result {
         case 0:
           if ($ftype == TType::LST) {
             $this->success = array();
-            $_size136 = 0;
-            $_etype139 = 0;
-            $xfer += $input->readListBegin($_etype139, $_size136);
-            for ($_i140 = 0; $_i140 < $_size136; ++$_i140)
+            $_size152 = 0;
+            $_etype155 = 0;
+            $xfer += $input->readListBegin($_etype155, $_size152);
+            for ($_i156 = 0; $_i156 < $_size152; ++$_i156)
             {
-              $elem141 = null;
-              $elem141 = new metastore_Partition();
-              $xfer += $elem141->read($input);
-              $this->success []= $elem141;
+              $elem157 = null;
+              $elem157 = new metastore_Partition();
+              $xfer += $elem157->read($input);
+              $this->success []= $elem157;
             }
             $xfer += $input->readListEnd();
           } else {
@@ -5237,13 +5288,16 @@ class metastore_ThriftHiveMetastore_get_partitions_result {
     $xfer = 0;
     $xfer += $output->writeStructBegin('ThriftHiveMetastore_get_partitions_result');
     if ($this->success !== null) {
+      if (!is_array($this->success)) {
+        throw new TProtocolException('Bad type in structure.', TProtocolException::INVALID_DATA);
+      }
       $xfer += $output->writeFieldBegin('success', TType::LST, 0);
       {
         $output->writeListBegin(TType::STRUCT, count($this->success));
         {
-          foreach ($this->success as $iter142)
+          foreach ($this->success as $iter158)
           {
-            $xfer += $iter142->write($output);
+            $xfer += $iter158->write($output);
           }
         }
         $output->writeListEnd();
@@ -5435,14 +5489,14 @@ class metastore_ThriftHiveMetastore_get_partition_names_result {
         case 0:
           if ($ftype == TType::LST) {
             $this->success = array();
-            $_size143 = 0;
-            $_etype146 = 0;
-            $xfer += $input->readListBegin($_etype146, $_size143);
-            for ($_i147 = 0; $_i147 < $_size143; ++$_i147)
+            $_size159 = 0;
+            $_etype162 = 0;
+            $xfer += $input->readListBegin($_etype162, $_size159);
+            for ($_i163 = 0; $_i163 < $_size159; ++$_i163)
             {
-              $elem148 = null;
-              $xfer += $input->readString($elem148);
-              $this->success []= $elem148;
+              $elem164 = null;
+              $xfer += $input->readString($elem164);
+              $this->success []= $elem164;
             }
             $xfer += $input->readListEnd();
           } else {
@@ -5471,13 +5525,16 @@ class metastore_ThriftHiveMetastore_get_partition_names_result {
     $xfer = 0;
     $xfer += $output->writeStructBegin('ThriftHiveMetastore_get_partition_names_result');
     if ($this->success !== null) {
+      if (!is_array($this->success)) {
+        throw new TProtocolException('Bad type in structure.', TProtocolException::INVALID_DATA);
+      }
       $xfer += $output->writeFieldBegin('success', TType::LST, 0);
       {
         $output->writeListBegin(TType::STRING, count($this->success));
         {
-          foreach ($this->success as $iter149)
+          foreach ($this->success as $iter165)
           {
-            $xfer += $output->writeString($iter149);
+            $xfer += $output->writeString($iter165);
           }
         }
         $output->writeListEnd();
@@ -5599,6 +5656,9 @@ class metastore_ThriftHiveMetastore_alter_partition_args {
       $xfer += $output->writeFieldEnd();
     }
     if ($this->new_part !== null) {
+      if (!is_object($this->new_part)) {
+        throw new TProtocolException('Bad type in structure.', TProtocolException::INVALID_DATA);
+      }
       $xfer += $output->writeFieldBegin('new_part', TType::STRUCT, 3);
       $xfer += $this->new_part->write($output);
       $xfer += $output->writeFieldEnd();
diff --git a/metastore/src/gen-php/hive_metastore_types.php b/metastore/src/gen-php/hive_metastore_types.php
index 52ca99e3bc..a3e99ab15b 100644
--- a/metastore/src/gen-php/hive_metastore_types.php
+++ b/metastore/src/gen-php/hive_metastore_types.php
@@ -349,6 +349,9 @@ class metastore_Type {
       $xfer += $output->writeFieldEnd();
     }
     if ($this->fields !== null) {
+      if (!is_array($this->fields)) {
+        throw new TProtocolException('Bad type in structure.', TProtocolException::INVALID_DATA);
+      }
       $xfer += $output->writeFieldBegin('fields', TType::LST, 4);
       {
         $output->writeListBegin(TType::STRUCT, count($this->fields));
@@ -583,6 +586,9 @@ class metastore_SerDeInfo {
       $xfer += $output->writeFieldEnd();
     }
     if ($this->parameters !== null) {
+      if (!is_array($this->parameters)) {
+        throw new TProtocolException('Bad type in structure.', TProtocolException::INVALID_DATA);
+      }
       $xfer += $output->writeFieldBegin('parameters', TType::MAP, 3);
       {
         $output->writeMapBegin(TType::STRING, TType::STRING, count($this->parameters));
@@ -961,6 +967,9 @@ class metastore_StorageDescriptor {
     $xfer = 0;
     $xfer += $output->writeStructBegin('StorageDescriptor');
     if ($this->cols !== null) {
+      if (!is_array($this->cols)) {
+        throw new TProtocolException('Bad type in structure.', TProtocolException::INVALID_DATA);
+      }
       $xfer += $output->writeFieldBegin('cols', TType::LST, 1);
       {
         $output->writeListBegin(TType::STRUCT, count($this->cols));
@@ -1000,11 +1009,17 @@ class metastore_StorageDescriptor {
       $xfer += $output->writeFieldEnd();
     }
     if ($this->serdeInfo !== null) {
+      if (!is_object($this->serdeInfo)) {
+        throw new TProtocolException('Bad type in structure.', TProtocolException::INVALID_DATA);
+      }
       $xfer += $output->writeFieldBegin('serdeInfo', TType::STRUCT, 7);
       $xfer += $this->serdeInfo->write($output);
       $xfer += $output->writeFieldEnd();
     }
     if ($this->bucketCols !== null) {
+      if (!is_array($this->bucketCols)) {
+        throw new TProtocolException('Bad type in structure.', TProtocolException::INVALID_DATA);
+      }
       $xfer += $output->writeFieldBegin('bucketCols', TType::LST, 8);
       {
         $output->writeListBegin(TType::STRING, count($this->bucketCols));
@@ -1019,6 +1034,9 @@ class metastore_StorageDescriptor {
       $xfer += $output->writeFieldEnd();
     }
     if ($this->sortCols !== null) {
+      if (!is_array($this->sortCols)) {
+        throw new TProtocolException('Bad type in structure.', TProtocolException::INVALID_DATA);
+      }
       $xfer += $output->writeFieldBegin('sortCols', TType::LST, 9);
       {
         $output->writeListBegin(TType::STRUCT, count($this->sortCols));
@@ -1033,6 +1051,9 @@ class metastore_StorageDescriptor {
       $xfer += $output->writeFieldEnd();
     }
     if ($this->parameters !== null) {
+      if (!is_array($this->parameters)) {
+        throw new TProtocolException('Bad type in structure.', TProtocolException::INVALID_DATA);
+      }
       $xfer += $output->writeFieldBegin('parameters', TType::MAP, 10);
       {
         $output->writeMapBegin(TType::STRING, TType::STRING, count($this->parameters));
@@ -1304,11 +1325,17 @@ class metastore_Table {
       $xfer += $output->writeFieldEnd();
     }
     if ($this->sd !== null) {
+      if (!is_object($this->sd)) {
+        throw new TProtocolException('Bad type in structure.', TProtocolException::INVALID_DATA);
+      }
       $xfer += $output->writeFieldBegin('sd', TType::STRUCT, 7);
       $xfer += $this->sd->write($output);
       $xfer += $output->writeFieldEnd();
     }
     if ($this->partitionKeys !== null) {
+      if (!is_array($this->partitionKeys)) {
+        throw new TProtocolException('Bad type in structure.', TProtocolException::INVALID_DATA);
+      }
       $xfer += $output->writeFieldBegin('partitionKeys', TType::LST, 8);
       {
         $output->writeListBegin(TType::STRUCT, count($this->partitionKeys));
@@ -1323,6 +1350,9 @@ class metastore_Table {
       $xfer += $output->writeFieldEnd();
     }
     if ($this->parameters !== null) {
+      if (!is_array($this->parameters)) {
+        throw new TProtocolException('Bad type in structure.', TProtocolException::INVALID_DATA);
+      }
       $xfer += $output->writeFieldBegin('parameters', TType::MAP, 9);
       {
         $output->writeMapBegin(TType::STRING, TType::STRING, count($this->parameters));
@@ -1532,6 +1562,9 @@ class metastore_Partition {
     $xfer = 0;
     $xfer += $output->writeStructBegin('Partition');
     if ($this->values !== null) {
+      if (!is_array($this->values)) {
+        throw new TProtocolException('Bad type in structure.', TProtocolException::INVALID_DATA);
+      }
       $xfer += $output->writeFieldBegin('values', TType::LST, 1);
       {
         $output->writeListBegin(TType::STRING, count($this->values));
@@ -1566,11 +1599,17 @@ class metastore_Partition {
       $xfer += $output->writeFieldEnd();
     }
     if ($this->sd !== null) {
+      if (!is_object($this->sd)) {
+        throw new TProtocolException('Bad type in structure.', TProtocolException::INVALID_DATA);
+      }
       $xfer += $output->writeFieldBegin('sd', TType::STRUCT, 6);
       $xfer += $this->sd->write($output);
       $xfer += $output->writeFieldEnd();
     }
     if ($this->parameters !== null) {
+      if (!is_array($this->parameters)) {
+        throw new TProtocolException('Bad type in structure.', TProtocolException::INVALID_DATA);
+      }
       $xfer += $output->writeFieldBegin('parameters', TType::MAP, 7);
       {
         $output->writeMapBegin(TType::STRING, TType::STRING, count($this->parameters));
@@ -1747,6 +1786,9 @@ class metastore_Index {
       $xfer += $output->writeFieldEnd();
     }
     if ($this->colNames !== null) {
+      if (!is_array($this->colNames)) {
+        throw new TProtocolException('Bad type in structure.', TProtocolException::INVALID_DATA);
+      }
       $xfer += $output->writeFieldBegin('colNames', TType::LST, 5);
       {
         $output->writeListBegin(TType::STRING, count($this->colNames));
@@ -1767,6 +1809,160 @@ class metastore_Index {
 
 }
 
+class metastore_Schema {
+  static $_TSPEC;
+
+  public $fieldSchemas = null;
+  public $properties = null;
+
+  public function __construct($vals=null) {
+    if (!isset(self::$_TSPEC)) {
+      self::$_TSPEC = array(
+        1 => array(
+          'var' => 'fieldSchemas',
+          'type' => TType::LST,
+          'etype' => TType::STRUCT,
+          'elem' => array(
+            'type' => TType::STRUCT,
+            'class' => 'metastore_FieldSchema',
+            ),
+          ),
+        2 => array(
+          'var' => 'properties',
+          'type' => TType::MAP,
+          'ktype' => TType::STRING,
+          'vtype' => TType::STRING,
+          'key' => array(
+            'type' => TType::STRING,
+          ),
+          'val' => array(
+            'type' => TType::STRING,
+            ),
+          ),
+        );
+    }
+    if (is_array($vals)) {
+      if (isset($vals['fieldSchemas'])) {
+        $this->fieldSchemas = $vals['fieldSchemas'];
+      }
+      if (isset($vals['properties'])) {
+        $this->properties = $vals['properties'];
+      }
+    }
+  }
+
+  public function getName() {
+    return 'Schema';
+  }
+
+  public function read($input)
+  {
+    $xfer = 0;
+    $fname = null;
+    $ftype = 0;
+    $fid = 0;
+    $xfer += $input->readStructBegin($fname);
+    while (true)
+    {
+      $xfer += $input->readFieldBegin($fname, $ftype, $fid);
+      if ($ftype == TType::STOP) {
+        break;
+      }
+      switch ($fid)
+      {
+        case 1:
+          if ($ftype == TType::LST) {
+            $this->fieldSchemas = array();
+            $_size85 = 0;
+            $_etype88 = 0;
+            $xfer += $input->readListBegin($_etype88, $_size85);
+            for ($_i89 = 0; $_i89 < $_size85; ++$_i89)
+            {
+              $elem90 = null;
+              $elem90 = new metastore_FieldSchema();
+              $xfer += $elem90->read($input);
+              $this->fieldSchemas []= $elem90;
+            }
+            $xfer += $input->readListEnd();
+          } else {
+            $xfer += $input->skip($ftype);
+          }
+          break;
+        case 2:
+          if ($ftype == TType::MAP) {
+            $this->properties = array();
+            $_size91 = 0;
+            $_ktype92 = 0;
+            $_vtype93 = 0;
+            $xfer += $input->readMapBegin($_ktype92, $_vtype93, $_size91);
+            for ($_i95 = 0; $_i95 < $_size91; ++$_i95)
+            {
+              $key96 = '';
+              $val97 = '';
+              $xfer += $input->readString($key96);
+              $xfer += $input->readString($val97);
+              $this->properties[$key96] = $val97;
+            }
+            $xfer += $input->readMapEnd();
+          } else {
+            $xfer += $input->skip($ftype);
+          }
+          break;
+        default:
+          $xfer += $input->skip($ftype);
+          break;
+      }
+      $xfer += $input->readFieldEnd();
+    }
+    $xfer += $input->readStructEnd();
+    return $xfer;
+  }
+
+  public function write($output) {
+    $xfer = 0;
+    $xfer += $output->writeStructBegin('Schema');
+    if ($this->fieldSchemas !== null) {
+      if (!is_array($this->fieldSchemas)) {
+        throw new TProtocolException('Bad type in structure.', TProtocolException::INVALID_DATA);
+      }
+      $xfer += $output->writeFieldBegin('fieldSchemas', TType::LST, 1);
+      {
+        $output->writeListBegin(TType::STRUCT, count($this->fieldSchemas));
+        {
+          foreach ($this->fieldSchemas as $iter98)
+          {
+            $xfer += $iter98->write($output);
+          }
+        }
+        $output->writeListEnd();
+      }
+      $xfer += $output->writeFieldEnd();
+    }
+    if ($this->properties !== null) {
+      if (!is_array($this->properties)) {
+        throw new TProtocolException('Bad type in structure.', TProtocolException::INVALID_DATA);
+      }
+      $xfer += $output->writeFieldBegin('properties', TType::MAP, 2);
+      {
+        $output->writeMapBegin(TType::STRING, TType::STRING, count($this->properties));
+        {
+          foreach ($this->properties as $kiter99 => $viter100)
+          {
+            $xfer += $output->writeString($kiter99);
+            $xfer += $output->writeString($viter100);
+          }
+        }
+        $output->writeMapEnd();
+      }
+      $xfer += $output->writeFieldEnd();
+    }
+    $xfer += $output->writeFieldStop();
+    $xfer += $output->writeStructEnd();
+    return $xfer;
+  }
+
+}
+
 class metastore_MetaException extends TException {
   static $_TSPEC;
 
diff --git a/metastore/src/gen-py/hive_metastore/ThriftHiveMetastore.py b/metastore/src/gen-py/hive_metastore/ThriftHiveMetastore.py
index e224ba4813..753e98ff49 100644
--- a/metastore/src/gen-py/hive_metastore/ThriftHiveMetastore.py
+++ b/metastore/src/gen-py/hive_metastore/ThriftHiveMetastore.py
@@ -1587,10 +1587,10 @@ def read(self, iprot):
       if fid == 0:
         if ftype == TType.LIST:
           self.success = []
-          (_etype88, _size85) = iprot.readListBegin()
-          for _i89 in xrange(_size85):
-            _elem90 = iprot.readString();
-            self.success.append(_elem90)
+          (_etype104, _size101) = iprot.readListBegin()
+          for _i105 in xrange(_size101):
+            _elem106 = iprot.readString();
+            self.success.append(_elem106)
           iprot.readListEnd()
         else:
           iprot.skip(ftype)
@@ -1613,8 +1613,8 @@ def write(self, oprot):
     if self.success != None:
       oprot.writeFieldBegin('success', TType.LIST, 0)
       oprot.writeListBegin(TType.STRING, len(self.success))
-      for iter91 in self.success:
-        oprot.writeString(iter91)
+      for iter107 in self.success:
+        oprot.writeString(iter107)
       oprot.writeListEnd()
       oprot.writeFieldEnd()
     if self.o1 != None:
@@ -2125,12 +2125,12 @@ def read(self, iprot):
       if fid == 0:
         if ftype == TType.MAP:
           self.success = {}
-          (_ktype93, _vtype94, _size92 ) = iprot.readMapBegin() 
-          for _i96 in xrange(_size92):
-            _key97 = iprot.readString();
-            _val98 = Type()
-            _val98.read(iprot)
-            self.success[_key97] = _val98
+          (_ktype109, _vtype110, _size108 ) = iprot.readMapBegin() 
+          for _i112 in xrange(_size108):
+            _key113 = iprot.readString();
+            _val114 = Type()
+            _val114.read(iprot)
+            self.success[_key113] = _val114
           iprot.readMapEnd()
         else:
           iprot.skip(ftype)
@@ -2153,9 +2153,9 @@ def write(self, oprot):
     if self.success != None:
       oprot.writeFieldBegin('success', TType.MAP, 0)
       oprot.writeMapBegin(TType.STRING, TType.STRUCT, len(self.success))
-      for kiter99,viter100 in self.success.items():
-        oprot.writeString(kiter99)
-        viter100.write(oprot)
+      for kiter115,viter116 in self.success.items():
+        oprot.writeString(kiter115)
+        viter116.write(oprot)
       oprot.writeMapEnd()
       oprot.writeFieldEnd()
     if self.o2 != None:
@@ -2271,11 +2271,11 @@ def read(self, iprot):
       if fid == 0:
         if ftype == TType.LIST:
           self.success = []
-          (_etype104, _size101) = iprot.readListBegin()
-          for _i105 in xrange(_size101):
-            _elem106 = FieldSchema()
-            _elem106.read(iprot)
-            self.success.append(_elem106)
+          (_etype120, _size117) = iprot.readListBegin()
+          for _i121 in xrange(_size117):
+            _elem122 = FieldSchema()
+            _elem122.read(iprot)
+            self.success.append(_elem122)
           iprot.readListEnd()
         else:
           iprot.skip(ftype)
@@ -2310,8 +2310,8 @@ def write(self, oprot):
     if self.success != None:
       oprot.writeFieldBegin('success', TType.LIST, 0)
       oprot.writeListBegin(TType.STRUCT, len(self.success))
-      for iter107 in self.success:
-        iter107.write(oprot)
+      for iter123 in self.success:
+        iter123.write(oprot)
       oprot.writeListEnd()
       oprot.writeFieldEnd()
     if self.o1 != None:
@@ -2738,10 +2738,10 @@ def read(self, iprot):
       if fid == 0:
         if ftype == TType.LIST:
           self.success = []
-          (_etype111, _size108) = iprot.readListBegin()
-          for _i112 in xrange(_size108):
-            _elem113 = iprot.readString();
-            self.success.append(_elem113)
+          (_etype127, _size124) = iprot.readListBegin()
+          for _i128 in xrange(_size124):
+            _elem129 = iprot.readString();
+            self.success.append(_elem129)
           iprot.readListEnd()
         else:
           iprot.skip(ftype)
@@ -2764,8 +2764,8 @@ def write(self, oprot):
     if self.success != None:
       oprot.writeFieldBegin('success', TType.LIST, 0)
       oprot.writeListBegin(TType.STRING, len(self.success))
-      for iter114 in self.success:
-        oprot.writeString(iter114)
+      for iter130 in self.success:
+        oprot.writeString(iter130)
       oprot.writeListEnd()
       oprot.writeFieldEnd()
     if self.o1 != None:
@@ -3292,10 +3292,10 @@ def read(self, iprot):
       elif fid == 3:
         if ftype == TType.LIST:
           self.part_vals = []
-          (_etype118, _size115) = iprot.readListBegin()
-          for _i119 in xrange(_size115):
-            _elem120 = iprot.readString();
-            self.part_vals.append(_elem120)
+          (_etype134, _size131) = iprot.readListBegin()
+          for _i135 in xrange(_size131):
+            _elem136 = iprot.readString();
+            self.part_vals.append(_elem136)
           iprot.readListEnd()
         else:
           iprot.skip(ftype)
@@ -3320,8 +3320,8 @@ def write(self, oprot):
     if self.part_vals != None:
       oprot.writeFieldBegin('part_vals', TType.LIST, 3)
       oprot.writeListBegin(TType.STRING, len(self.part_vals))
-      for iter121 in self.part_vals:
-        oprot.writeString(iter121)
+      for iter137 in self.part_vals:
+        oprot.writeString(iter137)
       oprot.writeListEnd()
       oprot.writeFieldEnd()
     oprot.writeFieldStop()
@@ -3484,10 +3484,10 @@ def read(self, iprot):
       elif fid == 3:
         if ftype == TType.LIST:
           self.part_vals = []
-          (_etype125, _size122) = iprot.readListBegin()
-          for _i126 in xrange(_size122):
-            _elem127 = iprot.readString();
-            self.part_vals.append(_elem127)
+          (_etype141, _size138) = iprot.readListBegin()
+          for _i142 in xrange(_size138):
+            _elem143 = iprot.readString();
+            self.part_vals.append(_elem143)
           iprot.readListEnd()
         else:
           iprot.skip(ftype)
@@ -3517,8 +3517,8 @@ def write(self, oprot):
     if self.part_vals != None:
       oprot.writeFieldBegin('part_vals', TType.LIST, 3)
       oprot.writeListBegin(TType.STRING, len(self.part_vals))
-      for iter128 in self.part_vals:
-        oprot.writeString(iter128)
+      for iter144 in self.part_vals:
+        oprot.writeString(iter144)
       oprot.writeListEnd()
       oprot.writeFieldEnd()
     if self.deleteData != None:
@@ -3666,10 +3666,10 @@ def read(self, iprot):
       elif fid == 3:
         if ftype == TType.LIST:
           self.part_vals = []
-          (_etype132, _size129) = iprot.readListBegin()
-          for _i133 in xrange(_size129):
-            _elem134 = iprot.readString();
-            self.part_vals.append(_elem134)
+          (_etype148, _size145) = iprot.readListBegin()
+          for _i149 in xrange(_size145):
+            _elem150 = iprot.readString();
+            self.part_vals.append(_elem150)
           iprot.readListEnd()
         else:
           iprot.skip(ftype)
@@ -3694,8 +3694,8 @@ def write(self, oprot):
     if self.part_vals != None:
       oprot.writeFieldBegin('part_vals', TType.LIST, 3)
       oprot.writeListBegin(TType.STRING, len(self.part_vals))
-      for iter135 in self.part_vals:
-        oprot.writeString(iter135)
+      for iter151 in self.part_vals:
+        oprot.writeString(iter151)
       oprot.writeListEnd()
       oprot.writeFieldEnd()
     oprot.writeFieldStop()
@@ -3897,11 +3897,11 @@ def read(self, iprot):
       if fid == 0:
         if ftype == TType.LIST:
           self.success = []
-          (_etype139, _size136) = iprot.readListBegin()
-          for _i140 in xrange(_size136):
-            _elem141 = Partition()
-            _elem141.read(iprot)
-            self.success.append(_elem141)
+          (_etype155, _size152) = iprot.readListBegin()
+          for _i156 in xrange(_size152):
+            _elem157 = Partition()
+            _elem157.read(iprot)
+            self.success.append(_elem157)
           iprot.readListEnd()
         else:
           iprot.skip(ftype)
@@ -3930,8 +3930,8 @@ def write(self, oprot):
     if self.success != None:
       oprot.writeFieldBegin('success', TType.LIST, 0)
       oprot.writeListBegin(TType.STRUCT, len(self.success))
-      for iter142 in self.success:
-        iter142.write(oprot)
+      for iter158 in self.success:
+        iter158.write(oprot)
       oprot.writeListEnd()
       oprot.writeFieldEnd()
     if self.o1 != None:
@@ -4067,10 +4067,10 @@ def read(self, iprot):
       if fid == 0:
         if ftype == TType.LIST:
           self.success = []
-          (_etype146, _size143) = iprot.readListBegin()
-          for _i147 in xrange(_size143):
-            _elem148 = iprot.readString();
-            self.success.append(_elem148)
+          (_etype162, _size159) = iprot.readListBegin()
+          for _i163 in xrange(_size159):
+            _elem164 = iprot.readString();
+            self.success.append(_elem164)
           iprot.readListEnd()
         else:
           iprot.skip(ftype)
@@ -4093,8 +4093,8 @@ def write(self, oprot):
     if self.success != None:
       oprot.writeFieldBegin('success', TType.LIST, 0)
       oprot.writeListBegin(TType.STRING, len(self.success))
-      for iter149 in self.success:
-        oprot.writeString(iter149)
+      for iter165 in self.success:
+        oprot.writeString(iter165)
       oprot.writeListEnd()
       oprot.writeFieldEnd()
     if self.o2 != None:
diff --git a/metastore/src/gen-py/hive_metastore/ttypes.py b/metastore/src/gen-py/hive_metastore/ttypes.py
index 312c7b11e9..162300048a 100644
--- a/metastore/src/gen-py/hive_metastore/ttypes.py
+++ b/metastore/src/gen-py/hive_metastore/ttypes.py
@@ -1160,6 +1160,94 @@ def __eq__(self, other):
   def __ne__(self, other):
     return not (self == other)
 
+class Schema:
+
+  thrift_spec = (
+    None, # 0
+    (1, TType.LIST, 'fieldSchemas', (TType.STRUCT,(FieldSchema, FieldSchema.thrift_spec)), None, ), # 1
+    (2, TType.MAP, 'properties', (TType.STRING,None,TType.STRING,None), None, ), # 2
+  )
+
+  def __init__(self, d=None):
+    self.fieldSchemas = None
+    self.properties = None
+    if isinstance(d, dict):
+      if 'fieldSchemas' in d:
+        self.fieldSchemas = d['fieldSchemas']
+      if 'properties' in d:
+        self.properties = d['properties']
+
+  def read(self, iprot):
+    if iprot.__class__ == TBinaryProtocol.TBinaryProtocolAccelerated and isinstance(iprot.trans, TTransport.CReadableTransport) and self.thrift_spec is not None and fastbinary is not None:
+      fastbinary.decode_binary(self, iprot.trans, (self.__class__, self.thrift_spec))
+      return
+    iprot.readStructBegin()
+    while True:
+      (fname, ftype, fid) = iprot.readFieldBegin()
+      if ftype == TType.STOP:
+        break
+      if fid == 1:
+        if ftype == TType.LIST:
+          self.fieldSchemas = []
+          (_etype88, _size85) = iprot.readListBegin()
+          for _i89 in xrange(_size85):
+            _elem90 = FieldSchema()
+            _elem90.read(iprot)
+            self.fieldSchemas.append(_elem90)
+          iprot.readListEnd()
+        else:
+          iprot.skip(ftype)
+      elif fid == 2:
+        if ftype == TType.MAP:
+          self.properties = {}
+          (_ktype92, _vtype93, _size91 ) = iprot.readMapBegin() 
+          for _i95 in xrange(_size91):
+            _key96 = iprot.readString();
+            _val97 = iprot.readString();
+            self.properties[_key96] = _val97
+          iprot.readMapEnd()
+        else:
+          iprot.skip(ftype)
+      else:
+        iprot.skip(ftype)
+      iprot.readFieldEnd()
+    iprot.readStructEnd()
+
+  def write(self, oprot):
+    if oprot.__class__ == TBinaryProtocol.TBinaryProtocolAccelerated and self.thrift_spec is not None and fastbinary is not None:
+      oprot.trans.write(fastbinary.encode_binary(self, (self.__class__, self.thrift_spec)))
+      return
+    oprot.writeStructBegin('Schema')
+    if self.fieldSchemas != None:
+      oprot.writeFieldBegin('fieldSchemas', TType.LIST, 1)
+      oprot.writeListBegin(TType.STRUCT, len(self.fieldSchemas))
+      for iter98 in self.fieldSchemas:
+        iter98.write(oprot)
+      oprot.writeListEnd()
+      oprot.writeFieldEnd()
+    if self.properties != None:
+      oprot.writeFieldBegin('properties', TType.MAP, 2)
+      oprot.writeMapBegin(TType.STRING, TType.STRING, len(self.properties))
+      for kiter99,viter100 in self.properties.items():
+        oprot.writeString(kiter99)
+        oprot.writeString(viter100)
+      oprot.writeMapEnd()
+      oprot.writeFieldEnd()
+    oprot.writeFieldStop()
+    oprot.writeStructEnd()
+
+  def __str__(self): 
+    return str(self.__dict__)
+
+  def __repr__(self): 
+    return repr(self.__dict__)
+
+  def __eq__(self, other):
+    return isinstance(other, self.__class__) and self.__dict__ == other.__dict__
+
+  def __ne__(self, other):
+    return not (self == other)
+
 class MetaException(Exception):
 
   thrift_spec = None
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/Driver.java b/ql/src/java/org/apache/hadoop/hive/ql/Driver.java
index f698ed75b4..e75daad53e 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/Driver.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/Driver.java
@@ -29,6 +29,7 @@
 
 import org.apache.hadoop.hive.metastore.MetaStoreUtils;
 import org.apache.hadoop.hive.metastore.api.FieldSchema;
+import org.apache.hadoop.hive.metastore.api.Schema;
 import org.apache.hadoop.hive.ql.parse.ParseDriver;
 import org.apache.hadoop.hive.ql.parse.SemanticException;
 import org.apache.hadoop.hive.ql.parse.ParseException;
@@ -47,7 +48,6 @@
 import org.apache.hadoop.hive.serde2.ByteStream;
 import org.apache.hadoop.hive.conf.HiveConf;
 import org.apache.hadoop.hive.common.JavaUtils;
-import org.apache.hadoop.hive.conf.HiveConf.ConfVars;
 import org.apache.hadoop.security.UserGroupInformation;
 
 import org.apache.commons.logging.Log;
@@ -89,8 +89,8 @@ public int countJobs(List<Task<? extends Serializable>> tasks, List<Task<? exten
   /**
    * Return the Thrift DDL string of the result
    */
-  public String getSchema() throws Exception {
-    String schema = "";
+  public Schema getSchema() throws Exception {
+    Schema schema;
     try {
       if (plan != null && plan.getPlan().getFetchTask() != null) {
         BaseSemanticAnalyzer sem = plan.getPlan();
@@ -102,13 +102,29 @@ public String getSchema() throws Exception {
         FetchTask ft = (FetchTask) sem.getFetchTask();
 
         tableDesc td = ft.getTblDesc();
+        // partitioned tables don't have tableDesc set on the FetchTask. Instead
+        // they have a list of PartitionDesc objects, each with a table desc. Let's
+        // try to fetch the desc for the first partition and use it's deserializer.
+        if (td == null && ft.getWork() != null && ft.getWork().getPartDesc() != null) {
+          if (ft.getWork().getPartDesc().size() > 0) {
+            td = ft.getWork().getPartDesc().get(0).getTableDesc();
+          }
+        }
+
+        if (td == null) {
+          throw new Exception("No table description found for fetch task: " + ft);
+        }
+ 
         String tableName = "result";
         List<FieldSchema> lst = MetaStoreUtils.getFieldsFromDeserializer(
             tableName, td.getDeserializer());
-        schema = MetaStoreUtils.getFullDDLFromFieldSchema(tableName, lst);
+        // Go over the schema and convert type to thrift type
+        for (FieldSchema f : lst) 
+          f.setType(MetaStoreUtils.typeToThriftType(f.getType()));
+        schema = new Schema(lst, null);
       }
       else {
-        schema = "struct result { string empty }";
+        schema = new Schema();
       }
     }
     catch (Exception e) {
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/FetchTask.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/FetchTask.java
index 1879ea48c2..cdd422c7e0 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/FetchTask.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/FetchTask.java
@@ -82,6 +82,7 @@ public void initialize (HiveConf conf) {
        mSerdeProp.put(Constants.SERIALIZATION_FORMAT, "" + Utilities.tabCode);
        mSerdeProp.put(Constants.SERIALIZATION_NULL_FORMAT, ((fetchWork)work).getSerializationNullFormat());
        mSerde.initialize(job, mSerdeProp);
+       mSerde.setUseJSONSerialize(true);
        
        ftOp = new FetchOperator(work, job);
     } catch (Exception e) {
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/FileSinkOperator.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/FileSinkOperator.java
index 78d437fb4f..14aa3eb49d 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/FileSinkOperator.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/FileSinkOperator.java
@@ -39,8 +39,6 @@
 import org.apache.hadoop.hive.serde2.Serializer;
 import org.apache.hadoop.hive.serde2.objectinspector.ObjectInspector;
 
-import com.sun.corba.se.pept.encoding.InputObject;
-
 /**
  * File Sink operator implementation
  **/
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRFileSink1.java b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRFileSink1.java
index 381ec02f60..c37b05f82a 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRFileSink1.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRFileSink1.java
@@ -161,7 +161,7 @@ private void createMergeJob(FileSinkOperator fsOp, GenMRProcContext ctx, String
     cplan.getPathToPartitionInfo().put(fsConf.getDirName(), new partitionDesc(fsConf.getTableInfo(), null));
     cplan.setNumReduceTasks(-1);
     
-    moveWork dummyMv = new moveWork(null, new loadFileDesc(fsOp.getConf().getDirName(), finalName, true, null), false);
+    moveWork dummyMv = new moveWork(null, new loadFileDesc(fsOp.getConf().getDirName(), finalName, true, null, null), false);
     Task<? extends Serializable> dummyMergeTask = TaskFactory.get(dummyMv, ctx.getConf());
     List<Serializable> listWorks = new ArrayList<Serializable>();
     listWorks.add(dummyMv);
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
index 3bf604d666..ffe63849af 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
@@ -2336,19 +2336,23 @@ private Operator genFileSinkPlan(String dest, QB qb,
           }
         }
         String cols = new String();
+        String colTypes = new String();
         Vector<ColumnInfo> colInfos = inputRR.getColumnInfos();
     
         boolean first = true;
         for (ColumnInfo colInfo:colInfos) {
           String[] nm = inputRR.reverseLookup(colInfo.getInternalName());
-          if (!first)
+          if (!first) {
             cols = cols.concat(",");
+            colTypes = colTypes.concat(":");
+          }
           
           first = false;
           if (nm[0] == null) 
             cols = cols.concat(nm[1]);
           else
             cols = cols.concat(nm[0] + "." + nm[1]);
+          colTypes = colTypes.concat(colInfo.getType().getTypeName());
         }
 
         if (!ctx.isMRTmpFileURI(destStr)) {
@@ -2359,10 +2363,10 @@ private Operator genFileSinkPlan(String dest, QB qb,
 
         boolean isDfsDir = (dest_type.intValue() == QBMetaData.DEST_DFS_FILE);
         this.loadFileWork.add(new loadFileDesc(queryTmpdir, destStr,
-                                               isDfsDir, cols));
+                                               isDfsDir, cols, colTypes));
 
         table_desc = PlanUtils.getDefaultTableDesc(Integer.toString(Utilities.ctrlaCode),
-                                                   cols);
+                                                   cols, colTypes, false);
         outputs.add(new WriteEntity(destStr, !isDfsDir));
         break;
     }
@@ -3719,13 +3723,15 @@ private void genMapRedTasks(QB qb) throws SemanticException {
       if ((!loadTableWork.isEmpty()) || (loadFileWork.size() != 1))
         throw new SemanticException(ErrorMsg.GENERIC_ERROR.getMsg());
       String cols = loadFileWork.get(0).getColumns();
+      String colTypes = loadFileWork.get(0).getColumnTypes();
     
       fetch = new fetchWork(new Path(loadFileWork.get(0).getSourceDir()).toString(),
       			                new tableDesc(LazySimpleSerDe.class, TextInputFormat.class,
                  			                		IgnoreKeyTextOutputFormat.class,
       			                           		Utilities.makeProperties(
       			                                org.apache.hadoop.hive.serde.Constants.SERIALIZATION_FORMAT, "" + Utilities.ctrlaCode,
-      			                                "columns", cols)),    
+      			                                org.apache.hadoop.hive.serde.Constants.LIST_COLUMNS, cols,
+      			                                org.apache.hadoop.hive.serde.Constants.LIST_COLUMN_TYPES, colTypes)),    
       			                qb.getParseInfo().getOuterQueryLimit());    
 
       fetchTask = TaskFactory.get(fetch, this.conf);
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/plan/PlanUtils.java b/ql/src/java/org/apache/hadoop/hive/ql/plan/PlanUtils.java
index 88ae133f17..9e330318dc 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/plan/PlanUtils.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/plan/PlanUtils.java
@@ -71,9 +71,22 @@ public static tableDesc getDefaultTableDesc(String separatorCode, String columns
    */
   public static tableDesc getDefaultTableDesc(String separatorCode, String columns,
       boolean lastColumnTakesRestOfTheLine) {
+    return getDefaultTableDesc(separatorCode, columns, null, lastColumnTakesRestOfTheLine);
+  }
+
+  /** 
+   * Generate the table descriptor of MetadataTypedColumnsetSerDe with the separatorCode
+   * and column names (comma separated string), and whether the last column should take
+   * the rest of the line.
+   */
+  public static tableDesc getDefaultTableDesc(String separatorCode, String columns, String columnTypes,
+      boolean lastColumnTakesRestOfTheLine) {
     Properties properties = Utilities.makeProperties(
-        Constants.SERIALIZATION_FORMAT, separatorCode,
-        "columns", columns);
+      Constants.SERIALIZATION_FORMAT, separatorCode,
+      Constants.LIST_COLUMNS, columns);
+    if (columnTypes != null)
+      properties.setProperty(Constants.LIST_COLUMN_TYPES, columnTypes);
+    
     if (lastColumnTakesRestOfTheLine) {
       properties.setProperty(
           Constants.SERIALIZATION_LAST_COLUMN_TAKES_REST,
@@ -85,7 +98,7 @@ public static tableDesc getDefaultTableDesc(String separatorCode, String columns
         IgnoreKeyTextOutputFormat.class,
         properties);    
   }
-
+  
   /** 
    * Generate the table descriptor of MetadataTypedColumnsetSerDe with the separatorCode.
    * MetaDataTypedColumnsetSerDe is used because LazySimpleSerDe does not support a table
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/plan/loadFileDesc.java b/ql/src/java/org/apache/hadoop/hive/ql/plan/loadFileDesc.java
index 102b80e4d7..3bb1a077d8 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/plan/loadFileDesc.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/plan/loadFileDesc.java
@@ -19,7 +19,6 @@
 package org.apache.hadoop.hive.ql.plan;
 
 import java.io.Serializable;
-import java.util.List;
 
 import org.apache.hadoop.hive.ql.plan.loadDesc;
 
@@ -29,18 +28,21 @@ public class loadFileDesc extends loadDesc implements Serializable {
   private boolean isDfsDir;
   // list of columns, comma separated
   private String  columns;
+  private String  columnTypes;
 
   public loadFileDesc() { }
   public loadFileDesc(
     final String sourceDir,
     final String targetDir,
     final boolean isDfsDir, 
-    final String  columns) {
+    final String  columns,
+    final String  columnTypes) {
 
     super(sourceDir);
     this.targetDir = targetDir;
     this.isDfsDir = isDfsDir;
     this.columns = columns;
+    this.columnTypes = columnTypes;
   }
   
   @explain(displayName="destination")
@@ -72,4 +74,16 @@ public String getColumns() {
 	public void setColumns(String columns) {
 		this.columns = columns;
 	}
+  /**
+   * @return the columnTypes
+   */
+  public String getColumnTypes() {
+    return columnTypes;
+  }
+  /**
+   * @param columnTypes the columnTypes to set
+   */
+  public void setColumnTypes(String columnTypes) {
+    this.columnTypes = columnTypes;
+  }
 }
diff --git a/ql/src/test/results/clientpositive/input23.q.out b/ql/src/test/results/clientpositive/input23.q.out
index 609219145b..1b25dfe690 100644
--- a/ql/src/test/results/clientpositive/input23.q.out
+++ b/ql/src/test/results/clientpositive/input23.q.out
@@ -47,9 +47,9 @@ STAGE PLANS:
                       type: string
       Needs Tagging: true
       Path -> Alias:
-        file:/data/users/pchakka/workspace/oshive/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 
+        file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 
       Path -> Partition:
-        file:/data/users/pchakka/workspace/oshive/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 
+        file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 
           Partition
             partition values:
               ds 2008-04-08
@@ -68,7 +68,7 @@ STAGE PLANS:
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location file:/data/users/pchakka/workspace/oshive/build/ql/test/data/warehouse/srcpart
+                location file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/srcpart
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: srcpart
       Reduce Operator Tree:
@@ -104,13 +104,14 @@ STAGE PLANS:
                 File Output Operator
                   compressed: false
                   GlobalTableId: 0
-                  directory: file:/data/users/pchakka/workspace/oshive/build/ql/tmp/2018964095/10001
+                  directory: file:/data/users/njain/hive1/hive1/build/ql/tmp/518105757/10001
                   table:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                       properties:
                         columns a.key,a.value,a.ds,a.hr,b.key,b.value,b.ds,b.hr
                         serialization.format 1
+                        columns.types string:string:string:string:string:string:string:string
 
   Stage: Stage-0
     Fetch Operator
@@ -119,4 +120,4 @@ STAGE PLANS:
 
 query: select * from srcpart a join srcpart b where a.ds = '2008-04-08' and a.hr = '11' and b.ds = '2008-04-08' and b.hr = '14' limit 5
 Input: default/srcpart/ds=2008-04-08/hr=11
-Output: file:/data/users/pchakka/workspace/oshive/build/ql/tmp/342520994/10000
+Output: file:/data/users/njain/hive1/hive1/build/ql/tmp/1090207992/10000
diff --git a/ql/src/test/results/clientpositive/input_part7.q.out b/ql/src/test/results/clientpositive/input_part7.q.out
index 7cdffa8f1a..29eb2d82cd 100644
--- a/ql/src/test/results/clientpositive/input_part7.q.out
+++ b/ql/src/test/results/clientpositive/input_part7.q.out
@@ -108,10 +108,10 @@ STAGE PLANS:
                               type: string
       Needs Tagging: false
       Path -> Alias:
-        file:/data/users/pchakka/workspace/oshive/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 
-        file:/data/users/pchakka/workspace/oshive/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12 
+        file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 
+        file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12 
       Path -> Partition:
-        file:/data/users/pchakka/workspace/oshive/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 
+        file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 
           Partition
             partition values:
               ds 2008-04-08
@@ -130,10 +130,10 @@ STAGE PLANS:
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location file:/data/users/pchakka/workspace/oshive/build/ql/test/data/warehouse/srcpart
+                location file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/srcpart
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: srcpart
-        file:/data/users/pchakka/workspace/oshive/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12 
+        file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12 
           Partition
             partition values:
               ds 2008-04-08
@@ -152,7 +152,7 @@ STAGE PLANS:
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location file:/data/users/pchakka/workspace/oshive/build/ql/test/data/warehouse/srcpart
+                location file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/srcpart
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: srcpart
       Reduce Operator Tree:
@@ -160,13 +160,14 @@ STAGE PLANS:
           File Output Operator
             compressed: false
             GlobalTableId: 0
-            directory: file:/data/users/pchakka/workspace/oshive/build/ql/tmp/1425223263/10001
+            directory: file:/data/users/njain/hive1/hive1/build/ql/tmp/734706041/10001
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                 properties:
                   columns a.key,a.value,a.ds,a.hr
                   serialization.format 1
+                  columns.types string:string:string:string
 
   Stage: Stage-0
     Fetch Operator
@@ -181,7 +182,7 @@ query: SELECT * FROM (
 SORT BY A.key
 Input: default/srcpart/ds=2008-04-08/hr=11
 Input: default/srcpart/ds=2008-04-08/hr=12
-Output: file:/data/users/pchakka/workspace/oshive/build/ql/tmp/1631529589/10000
+Output: file:/data/users/njain/hive1/hive1/build/ql/tmp/2065508017/10000
 0	val_0	2008-04-08	11
 0	val_0	2008-04-08	11
 0	val_0	2008-04-08	11
diff --git a/ql/src/test/results/clientpositive/input_part9.q.out b/ql/src/test/results/clientpositive/input_part9.q.out
index d670af614f..d4ba9858e2 100644
--- a/ql/src/test/results/clientpositive/input_part9.q.out
+++ b/ql/src/test/results/clientpositive/input_part9.q.out
@@ -33,19 +33,20 @@ STAGE PLANS:
                   File Output Operator
                     compressed: false
                     GlobalTableId: 0
-                    directory: file:/data/users/njain/deploy/hive2/tools/ahive2-trunk-apache-hive/build/ql/tmp/1481007439/10001
+                    directory: file:/data/users/njain/hive1/hive1/build/ql/tmp/1867593931/10001
                     table:
                         input format: org.apache.hadoop.mapred.TextInputFormat
                         output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                         properties:
                           columns x.key,x.value,x.ds,x.hr
                           serialization.format 1
+                          columns.types string:string:string:string
       Needs Tagging: false
       Path -> Alias:
-        file:/data/users/njain/deploy/hive2/tools/ahive2-trunk-apache-hive/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 
-        file:/data/users/njain/deploy/hive2/tools/ahive2-trunk-apache-hive/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12 
+        file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 
+        file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12 
       Path -> Partition:
-        file:/data/users/njain/deploy/hive2/tools/ahive2-trunk-apache-hive/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 
+        file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 
           Partition
             partition values:
               ds 2008-04-08
@@ -64,10 +65,10 @@ STAGE PLANS:
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location file:/data/users/njain/deploy/hive2/tools/ahive2-trunk-apache-hive/build/ql/test/data/warehouse/srcpart
+                location file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/srcpart
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: srcpart
-        file:/data/users/njain/deploy/hive2/tools/ahive2-trunk-apache-hive/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12 
+        file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12 
           Partition
             partition values:
               ds 2008-04-08
@@ -86,7 +87,7 @@ STAGE PLANS:
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location file:/data/users/njain/deploy/hive2/tools/ahive2-trunk-apache-hive/build/ql/test/data/warehouse/srcpart
+                location file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/srcpart
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: srcpart
 
@@ -98,7 +99,7 @@ STAGE PLANS:
 query: SELECT x.* FROM SRCPART x WHERE key IS NOT NULL AND ds = '2008-04-08'
 Input: default/srcpart/ds=2008-04-08/hr=11
 Input: default/srcpart/ds=2008-04-08/hr=12
-Output: file:/data/users/njain/deploy/hive2/tools/ahive2-trunk-apache-hive/build/ql/tmp/983232439/10000
+Output: file:/data/users/njain/hive1/hive1/build/ql/tmp/640376818/10000
 238	val_238	2008-04-08	11
 86	val_86	2008-04-08	11
 311	val_311	2008-04-08	11
diff --git a/ql/src/test/results/clientpositive/rand_partitionpruner1.q.out b/ql/src/test/results/clientpositive/rand_partitionpruner1.q.out
index 2f4f82e5fd..6651e576cf 100644
--- a/ql/src/test/results/clientpositive/rand_partitionpruner1.q.out
+++ b/ql/src/test/results/clientpositive/rand_partitionpruner1.q.out
@@ -25,18 +25,19 @@ STAGE PLANS:
                 File Output Operator
                   compressed: false
                   GlobalTableId: 0
-                  directory: /data/users/njain/hive5/hive5/ql/../build/ql/tmp/552086915/1424484527.10001.insclause-0
+                  directory: file:/data/users/njain/hive1/hive1/build/ql/tmp/1772270999/10001
                   table:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                       properties:
                         columns src.key,src.value
                         serialization.format 1
+                        columns.types string:string
       Needs Tagging: false
       Path -> Alias:
-        file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/src 
+        file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src 
       Path -> Partition:
-        file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/src 
+        file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src 
           Partition
           
               input format: org.apache.hadoop.mapred.TextInputFormat
@@ -51,7 +52,7 @@ STAGE PLANS:
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/src
+                location file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: src
 
@@ -62,7 +63,7 @@ STAGE PLANS:
 
 query: select * from src where rand(1) < 0.1
 Input: default/src
-Output: /data/users/njain/hive5/hive5/ql/../build/ql/tmp/258191470/334752323.10000
+Output: file:/data/users/njain/hive1/hive1/build/ql/tmp/1857203962/10000
 409	val_409
 429	val_429
 209	val_209
diff --git a/ql/src/test/results/clientpositive/rand_partitionpruner3.q.out b/ql/src/test/results/clientpositive/rand_partitionpruner3.q.out
index 8af834efce..e9c02fe42c 100644
--- a/ql/src/test/results/clientpositive/rand_partitionpruner3.q.out
+++ b/ql/src/test/results/clientpositive/rand_partitionpruner3.q.out
@@ -30,18 +30,19 @@ STAGE PLANS:
                 File Output Operator
                   compressed: false
                   GlobalTableId: 0
-                  directory: file:/data/users/pchakka/workspace/oshive2/build/ql/tmp/868971644/10001
+                  directory: file:/data/users/njain/hive1/hive1/build/ql/tmp/199516785/10001
                   table:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                       properties:
                         columns a.key,a.value,a.ds,a.hr
                         serialization.format 1
+                        columns.types string:string:string:string
       Needs Tagging: false
       Path -> Alias:
-        file:/data/users/pchakka/workspace/oshive2/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12 
+        file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12 
       Path -> Partition:
-        file:/data/users/pchakka/workspace/oshive2/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12 
+        file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12 
           Partition
             partition values:
               ds 2008-04-08
@@ -60,7 +61,7 @@ STAGE PLANS:
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location file:/data/users/pchakka/workspace/oshive2/build/ql/test/data/warehouse/srcpart
+                location file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/srcpart
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: srcpart
 
@@ -71,7 +72,7 @@ STAGE PLANS:
 
 query: select a.* from srcpart a where rand(1) < 0.1 and a.ds = '2008-04-08' and not(key > 50 or key < 10) and a.hr like '%2'
 Input: default/srcpart/ds=2008-04-08/hr=12
-Output: file:/data/users/pchakka/workspace/oshive2/build/ql/tmp/499802678/10000
+Output: file:/data/users/njain/hive1/hive1/build/ql/tmp/206596522/10000
 42	val_42	2008-04-08	12
 44	val_44	2008-04-08	12
 26	val_26	2008-04-08	12
@@ -112,18 +113,19 @@ STAGE PLANS:
                   File Output Operator
                     compressed: false
                     GlobalTableId: 0
-                    directory: file:/data/users/pchakka/workspace/oshive2/build/ql/tmp/1606994614/10001
+                    directory: file:/data/users/njain/hive1/hive1/build/ql/tmp/2011784836/10001
                     table:
                         input format: org.apache.hadoop.mapred.TextInputFormat
                         output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                         properties:
                           columns a.key,a.value,a.ds,a.hr
                           serialization.format 1
+                          columns.types string:string:string:string
       Needs Tagging: false
       Path -> Alias:
-        file:/data/users/pchakka/workspace/oshive2/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12 
+        file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12 
       Path -> Partition:
-        file:/data/users/pchakka/workspace/oshive2/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12 
+        file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12 
           Partition
             partition values:
               ds 2008-04-08
@@ -142,7 +144,7 @@ STAGE PLANS:
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location file:/data/users/pchakka/workspace/oshive2/build/ql/test/data/warehouse/srcpart
+                location file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/srcpart
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: srcpart
 
@@ -153,7 +155,7 @@ STAGE PLANS:
 
 query: select a.* from srcpart a where a.ds = '2008-04-08' and not(key > 50 or key < 10) and a.hr like '%2'
 Input: default/srcpart/ds=2008-04-08/hr=12
-Output: file:/data/users/pchakka/workspace/oshive2/build/ql/tmp/1256518849/10000
+Output: file:/data/users/njain/hive1/hive1/build/ql/tmp/1689821052/10000
 27	val_27	2008-04-08	12
 37	val_37	2008-04-08	12
 15	val_15	2008-04-08	12
diff --git a/ql/src/test/results/clientpositive/regexp_extract.q.out b/ql/src/test/results/clientpositive/regexp_extract.q.out
index 84f0d101ab..881d6485d7 100644
--- a/ql/src/test/results/clientpositive/regexp_extract.q.out
+++ b/ql/src/test/results/clientpositive/regexp_extract.q.out
@@ -53,9 +53,9 @@ STAGE PLANS:
                         type: string
       Needs Tagging: false
       Path -> Alias:
-        file:/Users/char/Documents/workspace/Hive-460/build/ql/test/data/warehouse/src 
+        file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src 
       Path -> Partition:
-        file:/Users/char/Documents/workspace/Hive-460/build/ql/test/data/warehouse/src 
+        file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src 
           Partition
           
               input format: org.apache.hadoop.mapred.TextInputFormat
@@ -70,7 +70,7 @@ STAGE PLANS:
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location file:/Users/char/Documents/workspace/Hive-460/build/ql/test/data/warehouse/src
+                location file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: src
       Reduce Operator Tree:
@@ -88,13 +88,14 @@ STAGE PLANS:
               File Output Operator
                 compressed: false
                 GlobalTableId: 0
-                directory: file:/Users/char/Documents/workspace/Hive-460/build/ql/tmp/377939618/10001
+                directory: file:/data/users/njain/hive1/hive1/build/ql/tmp/73993756/10001
                 table:
                     input format: org.apache.hadoop.mapred.TextInputFormat
                     output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                     properties:
                       columns tmap.key,_c1
                       serialization.format 1
+                      columns.types string:string
 
   Stage: Stage-0
     Fetch Operator
@@ -109,7 +110,7 @@ query: FROM (
 ) tmap
 SELECT tmap.key, regexp_extract(tmap.value, 'val_(\\d+\\t\\d+)',1) WHERE tmap.key < 100
 Input: default/src
-Output: file:/Users/char/Documents/workspace/Hive-460/build/ql/tmp/1157716176/10000
+Output: file:/data/users/njain/hive1/hive1/build/ql/tmp/395306564/10000
 0	0	3
 0	0	3
 0	0	3
@@ -249,9 +250,9 @@ STAGE PLANS:
                         type: string
       Needs Tagging: false
       Path -> Alias:
-        file:/Users/char/Documents/workspace/Hive-460/build/ql/test/data/warehouse/src 
+        file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src 
       Path -> Partition:
-        file:/Users/char/Documents/workspace/Hive-460/build/ql/test/data/warehouse/src 
+        file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src 
           Partition
           
               input format: org.apache.hadoop.mapred.TextInputFormat
@@ -266,7 +267,7 @@ STAGE PLANS:
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location file:/Users/char/Documents/workspace/Hive-460/build/ql/test/data/warehouse/src
+                location file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: src
       Reduce Operator Tree:
@@ -284,13 +285,14 @@ STAGE PLANS:
               File Output Operator
                 compressed: false
                 GlobalTableId: 0
-                directory: file:/Users/char/Documents/workspace/Hive-460/build/ql/tmp/1112689500/10001
+                directory: file:/data/users/njain/hive1/hive1/build/ql/tmp/1617035180/10001
                 table:
                     input format: org.apache.hadoop.mapred.TextInputFormat
                     output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                     properties:
                       columns tmap.key,_c1
                       serialization.format 1
+                      columns.types string:string
 
   Stage: Stage-0
     Fetch Operator
@@ -305,7 +307,7 @@ query: FROM (
 ) tmap
 SELECT tmap.key, regexp_extract(tmap.value, 'val_(\\d+\\t\\d+)') WHERE tmap.key < 100
 Input: default/src
-Output: file:/Users/char/Documents/workspace/Hive-460/build/ql/tmp/1926471082/10000
+Output: file:/data/users/njain/hive1/hive1/build/ql/tmp/1810791707/10000
 0	0	3
 0	0	3
 0	0	3
diff --git a/ql/src/test/results/clientpositive/sample8.q.out b/ql/src/test/results/clientpositive/sample8.q.out
index 3e124ede0e..bd3c65ddde 100644
--- a/ql/src/test/results/clientpositive/sample8.q.out
+++ b/ql/src/test/results/clientpositive/sample8.q.out
@@ -58,12 +58,12 @@ STAGE PLANS:
                         type: string
       Needs Tagging: true
       Path -> Alias:
-        file:/Users/char/Documents/workspace/Hive-460/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 
-        file:/Users/char/Documents/workspace/Hive-460/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12 
-        file:/Users/char/Documents/workspace/Hive-460/build/ql/test/data/warehouse/srcpart/ds=2008-04-09/hr=11 
-        file:/Users/char/Documents/workspace/Hive-460/build/ql/test/data/warehouse/srcpart/ds=2008-04-09/hr=12 
+        file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 
+        file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12 
+        file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/srcpart/ds=2008-04-09/hr=11 
+        file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/srcpart/ds=2008-04-09/hr=12 
       Path -> Partition:
-        file:/Users/char/Documents/workspace/Hive-460/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 
+        file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 
           Partition
             partition values:
               ds 2008-04-08
@@ -82,10 +82,10 @@ STAGE PLANS:
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location file:/Users/char/Documents/workspace/Hive-460/build/ql/test/data/warehouse/srcpart
+                location file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/srcpart
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: srcpart
-        file:/Users/char/Documents/workspace/Hive-460/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12 
+        file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12 
           Partition
             partition values:
               ds 2008-04-08
@@ -104,10 +104,10 @@ STAGE PLANS:
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location file:/Users/char/Documents/workspace/Hive-460/build/ql/test/data/warehouse/srcpart
+                location file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/srcpart
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: srcpart
-        file:/Users/char/Documents/workspace/Hive-460/build/ql/test/data/warehouse/srcpart/ds=2008-04-09/hr=11 
+        file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/srcpart/ds=2008-04-09/hr=11 
           Partition
             partition values:
               ds 2008-04-09
@@ -126,10 +126,10 @@ STAGE PLANS:
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location file:/Users/char/Documents/workspace/Hive-460/build/ql/test/data/warehouse/srcpart
+                location file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/srcpart
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: srcpart
-        file:/Users/char/Documents/workspace/Hive-460/build/ql/test/data/warehouse/srcpart/ds=2008-04-09/hr=12 
+        file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/srcpart/ds=2008-04-09/hr=12 
           Partition
             partition values:
               ds 2008-04-09
@@ -148,7 +148,7 @@ STAGE PLANS:
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location file:/Users/char/Documents/workspace/Hive-460/build/ql/test/data/warehouse/srcpart
+                location file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/srcpart
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: srcpart
       Reduce Operator Tree:
@@ -175,7 +175,7 @@ STAGE PLANS:
               File Output Operator
                 compressed: false
                 GlobalTableId: 0
-                directory: file:/Users/char/Documents/workspace/Hive-460/build/ql/tmp/179920971/10002
+                directory: file:/data/users/njain/hive1/hive1/build/ql/tmp/306194856/10002
                 table:
                     input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                     output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
@@ -188,7 +188,7 @@ STAGE PLANS:
   Stage: Stage-2
     Map Reduce
       Alias -> Map Operator Tree:
-        file:/Users/char/Documents/workspace/Hive-460/build/ql/tmp/179920971/10002 
+        file:/data/users/njain/hive1/hive1/build/ql/tmp/306194856/10002 
             Reduce Output Operator
               key expressions:
                     expr: _col0
@@ -213,9 +213,9 @@ STAGE PLANS:
                     type: string
       Needs Tagging: false
       Path -> Alias:
-        file:/Users/char/Documents/workspace/Hive-460/build/ql/tmp/179920971/10002 
+        file:/data/users/njain/hive1/hive1/build/ql/tmp/306194856/10002 
       Path -> Partition:
-        file:/Users/char/Documents/workspace/Hive-460/build/ql/tmp/179920971/10002 
+        file:/data/users/njain/hive1/hive1/build/ql/tmp/306194856/10002 
           Partition
           
               input format: org.apache.hadoop.mapred.SequenceFileInputFormat
@@ -230,13 +230,14 @@ STAGE PLANS:
           File Output Operator
             compressed: false
             GlobalTableId: 0
-            directory: file:/Users/char/Documents/workspace/Hive-460/build/ql/tmp/179920971/10001
+            directory: file:/data/users/njain/hive1/hive1/build/ql/tmp/306194856/10001
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                 properties:
                   columns s.key,s.value,s.ds,s.hr
                   serialization.format 1
+                  columns.types string:string:string:string
 
   Stage: Stage-0
     Fetch Operator
@@ -253,7 +254,7 @@ Input: default/srcpart/ds=2008-04-08/hr=11
 Input: default/srcpart/ds=2008-04-08/hr=12
 Input: default/srcpart/ds=2008-04-09/hr=11
 Input: default/srcpart/ds=2008-04-09/hr=12
-Output: file:/Users/char/Documents/workspace/Hive-460/build/ql/tmp/1641045144/10000
+Output: file:/data/users/njain/hive1/hive1/build/ql/tmp/1665685376/10000
 0	val_0
 0	val_0
 0	val_0
diff --git a/ql/src/test/results/compiler/plan/cast1.q.xml b/ql/src/test/results/compiler/plan/cast1.q.xml
index cd95622f15..a6a345e679 100644
--- a/ql/src/test/results/compiler/plan/cast1.q.xml
+++ b/ql/src/test/results/compiler/plan/cast1.q.xml
@@ -64,7 +64,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/pchakka/workspace/oshive/build/ql/test/data/warehouse/src</string> 
+            <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
            </void> 
           </object> 
          </void> 
@@ -100,7 +100,7 @@
                         <void property="conf"> 
                          <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                           <void property="dirName"> 
-                           <string>file:/data/users/pchakka/workspace/oshive/build/ql/tmp/994014283/10001</string> 
+                           <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/810438196/10001</string> 
                           </void> 
                           <void property="tableInfo"> 
                            <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -123,6 +123,10 @@
                                <string>serialization.format</string> 
                                <string>1</string> 
                               </void> 
+                              <void method="put"> 
+                               <string>columns.types</string> 
+                               <string>int:double:double:double:int:boolean:int</string> 
+                              </void> 
                              </object> 
                             </void> 
                            </object> 
@@ -148,7 +152,7 @@
                               <void property="type"> 
                                <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
                                 <void property="typeName"> 
-                                 <string>string</string> 
+                                 <string>int</string> 
                                 </void> 
                                </object> 
                               </void> 
@@ -160,7 +164,11 @@
                                <string>_c1</string> 
                               </void> 
                               <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
+                               <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                                <void property="typeName"> 
+                                 <string>double</string> 
+                                </void> 
+                               </object> 
                               </void> 
                              </object> 
                             </void> 
@@ -170,7 +178,7 @@
                                <string>_c2</string> 
                               </void> 
                               <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
+                               <object idref="PrimitiveTypeInfo1"/> 
                               </void> 
                              </object> 
                             </void> 
@@ -180,7 +188,7 @@
                                <string>_c3</string> 
                               </void> 
                               <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
+                               <object idref="PrimitiveTypeInfo1"/> 
                               </void> 
                              </object> 
                             </void> 
@@ -200,7 +208,11 @@
                                <string>_c5</string> 
                               </void> 
                               <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
+                               <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                                <void property="typeName"> 
+                                 <string>boolean</string> 
+                                </void> 
+                               </object> 
                               </void> 
                              </object> 
                             </void> 
@@ -245,11 +257,7 @@
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                              <void property="typeName"> 
-                               <string>boolean</string> 
-                              </void> 
-                             </object> 
+                             <object idref="PrimitiveTypeInfo2"/> 
                             </void> 
                             <void property="value"> 
                              <boolean>true</boolean> 
@@ -259,11 +267,7 @@
                          </object> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>int</string> 
-                          </void> 
-                         </object> 
+                         <object idref="PrimitiveTypeInfo0"/> 
                         </void> 
                        </object> 
                       </void> 
@@ -288,7 +292,7 @@
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo2"/> 
+                             <object idref="PrimitiveTypeInfo0"/> 
                             </void> 
                             <void property="value"> 
                              <int>1</int> 
@@ -298,7 +302,7 @@
                          </object> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
+                         <object idref="PrimitiveTypeInfo2"/> 
                         </void> 
                        </object> 
                       </void> 
@@ -326,7 +330,7 @@
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo2"/> 
+                             <object idref="PrimitiveTypeInfo0"/> 
                             </void> 
                             <void property="value"> 
                              <int>3</int> 
@@ -353,11 +357,7 @@
                               <void method="add"> 
                                <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                                 <void property="typeInfo"> 
-                                 <object id="PrimitiveTypeInfo3" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                                  <void property="typeName"> 
-                                   <string>double</string> 
-                                  </void> 
-                                 </object> 
+                                 <object idref="PrimitiveTypeInfo1"/> 
                                 </void> 
                                 <void property="value"> 
                                  <double>2.0</double> 
@@ -367,14 +367,14 @@
                              </object> 
                             </void> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo2"/> 
+                             <object idref="PrimitiveTypeInfo0"/> 
                             </void> 
                            </object> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo2"/> 
+                         <object idref="PrimitiveTypeInfo0"/> 
                         </void> 
                        </object> 
                       </void> 
@@ -402,7 +402,7 @@
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo3"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                             <void property="value"> 
                              <double>3.0</double> 
@@ -412,7 +412,7 @@
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo3"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                             <void property="value"> 
                              <double>2.0</double> 
@@ -422,7 +422,7 @@
                          </object> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo3"/> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
                        </object> 
                       </void> 
@@ -467,7 +467,7 @@
                               <void method="add"> 
                                <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                                 <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo2"/> 
+                                 <object idref="PrimitiveTypeInfo0"/> 
                                 </void> 
                                 <void property="value"> 
                                  <int>3</int> 
@@ -477,14 +477,14 @@
                              </object> 
                             </void> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo3"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                            </object> 
                           </void> 
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo3"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                             <void property="value"> 
                              <double>2.0</double> 
@@ -494,7 +494,7 @@
                          </object> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo3"/> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
                        </object> 
                       </void> 
@@ -522,7 +522,7 @@
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo3"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                             <void property="value"> 
                              <double>3.0</double> 
@@ -549,7 +549,7 @@
                               <void method="add"> 
                                <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                                 <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo2"/> 
+                                 <object idref="PrimitiveTypeInfo0"/> 
                                 </void> 
                                 <void property="value"> 
                                  <int>2</int> 
@@ -559,14 +559,14 @@
                              </object> 
                             </void> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo3"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                            </object> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo3"/> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
                        </object> 
                       </void> 
@@ -594,7 +594,7 @@
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo2"/> 
+                             <object idref="PrimitiveTypeInfo0"/> 
                             </void> 
                             <void property="value"> 
                              <int>3</int> 
@@ -604,7 +604,7 @@
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo2"/> 
+                             <object idref="PrimitiveTypeInfo0"/> 
                             </void> 
                             <void property="value"> 
                              <int>2</int> 
@@ -614,7 +614,7 @@
                          </object> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo2"/> 
+                         <object idref="PrimitiveTypeInfo0"/> 
                         </void> 
                        </object> 
                       </void> 
@@ -691,7 +691,7 @@
                            <string>_col0</string> 
                           </void> 
                           <void property="type"> 
-                           <object idref="PrimitiveTypeInfo2"/> 
+                           <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
                          </object> 
                         </void> 
@@ -701,7 +701,7 @@
                            <string>_col1</string> 
                           </void> 
                           <void property="type"> 
-                           <object idref="PrimitiveTypeInfo3"/> 
+                           <object idref="PrimitiveTypeInfo1"/> 
                           </void> 
                          </object> 
                         </void> 
@@ -711,7 +711,7 @@
                            <string>_col2</string> 
                           </void> 
                           <void property="type"> 
-                           <object idref="PrimitiveTypeInfo3"/> 
+                           <object idref="PrimitiveTypeInfo1"/> 
                           </void> 
                          </object> 
                         </void> 
@@ -721,7 +721,7 @@
                            <string>_col3</string> 
                           </void> 
                           <void property="type"> 
-                           <object idref="PrimitiveTypeInfo3"/> 
+                           <object idref="PrimitiveTypeInfo1"/> 
                           </void> 
                          </object> 
                         </void> 
@@ -731,7 +731,7 @@
                            <string>_col4</string> 
                           </void> 
                           <void property="type"> 
-                           <object idref="PrimitiveTypeInfo2"/> 
+                           <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
                          </object> 
                         </void> 
@@ -741,7 +741,7 @@
                            <string>_col5</string> 
                           </void> 
                           <void property="type"> 
-                           <object idref="PrimitiveTypeInfo1"/> 
+                           <object idref="PrimitiveTypeInfo2"/> 
                           </void> 
                          </object> 
                         </void> 
@@ -751,7 +751,7 @@
                            <string>_col6</string> 
                           </void> 
                           <void property="type"> 
-                           <object idref="PrimitiveTypeInfo2"/> 
+                           <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
                          </object> 
                         </void> 
@@ -808,14 +808,18 @@
                              <string>key</string> 
                             </void> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
+                             <object id="PrimitiveTypeInfo3" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                              <void property="typeName"> 
+                               <string>string</string> 
+                              </void> 
+                             </object> 
                             </void> 
                            </object> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo3"/> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
                        </object> 
                       </void> 
@@ -839,7 +843,7 @@
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo2"/> 
+                             <object idref="PrimitiveTypeInfo0"/> 
                             </void> 
                             <void property="value"> 
                              <int>86</int> 
@@ -849,14 +853,14 @@
                          </object> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo3"/> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
                        </object> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
+                     <object idref="PrimitiveTypeInfo2"/> 
                     </void> 
                    </object> 
                   </void> 
@@ -879,7 +883,7 @@
                        <string>key</string> 
                       </void> 
                       <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
+                       <object idref="PrimitiveTypeInfo3"/> 
                       </void> 
                      </object> 
                     </void> 
@@ -889,7 +893,7 @@
                        <string>value</string> 
                       </void> 
                       <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
+                       <object idref="PrimitiveTypeInfo3"/> 
                       </void> 
                      </object> 
                     </void> 
@@ -929,14 +933,14 @@
                          <string>key</string> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
+                         <object idref="PrimitiveTypeInfo3"/> 
                         </void> 
                        </object> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo3"/> 
+                     <object idref="PrimitiveTypeInfo1"/> 
                     </void> 
                    </object> 
                   </void> 
@@ -953,7 +957,7 @@
                       <void method="add"> 
                        <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo2"/> 
+                         <object idref="PrimitiveTypeInfo0"/> 
                         </void> 
                         <void property="value"> 
                          <int>86</int> 
@@ -963,14 +967,14 @@
                      </object> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo3"/> 
+                     <object idref="PrimitiveTypeInfo1"/> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo1"/> 
+                 <object idref="PrimitiveTypeInfo2"/> 
                 </void> 
                </object> 
               </void> 
@@ -1008,7 +1012,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/pchakka/workspace/oshive/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>src</string> 
@@ -1020,7 +1024,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/pchakka/workspace/oshive/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/groupby2.q.xml b/ql/src/test/results/compiler/plan/groupby2.q.xml
index 2e0c6375fa..ed442e01ef 100755
--- a/ql/src/test/results/compiler/plan/groupby2.q.xml
+++ b/ql/src/test/results/compiler/plan/groupby2.q.xml
@@ -64,7 +64,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src</string> 
+            <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
            </void> 
           </object> 
          </void> 
@@ -797,7 +797,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>src</string> 
@@ -809,7 +809,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
@@ -850,7 +850,7 @@
               <void property="conf"> 
                <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                 <void property="dirName"> 
-                 <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/841620450/10001</string> 
+                 <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/347262631/10001</string> 
                 </void> 
                 <void property="tableInfo"> 
                  <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -873,6 +873,10 @@
                      <string>serialization.format</string> 
                      <string>1</string> 
                     </void> 
+                    <void method="put"> 
+                     <string>columns.types</string> 
+                     <string>string:bigint:string</string> 
+                    </void> 
                    </object> 
                   </void> 
                  </object> 
@@ -906,7 +910,7 @@
                      <string>_c1</string> 
                     </void> 
                     <void property="type"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
+                     <object idref="PrimitiveTypeInfo1"/> 
                     </void> 
                    </object> 
                   </void> 
diff --git a/ql/src/test/results/compiler/plan/groupby3.q.xml b/ql/src/test/results/compiler/plan/groupby3.q.xml
index cfb25aa55b..193fe12895 100644
--- a/ql/src/test/results/compiler/plan/groupby3.q.xml
+++ b/ql/src/test/results/compiler/plan/groupby3.q.xml
@@ -64,7 +64,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src</string> 
+            <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
            </void> 
           </object> 
          </void> 
@@ -1024,7 +1024,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>src</string> 
@@ -1036,7 +1036,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
@@ -1077,7 +1077,7 @@
               <void property="conf"> 
                <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                 <void property="dirName"> 
-                 <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/1101517581/10001</string> 
+                 <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/2115264666/10001</string> 
                 </void> 
                 <void property="tableInfo"> 
                  <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -1100,6 +1100,10 @@
                      <string>serialization.format</string> 
                      <string>1</string> 
                     </void> 
+                    <void method="put"> 
+                     <string>columns.types</string> 
+                     <string>double:double:double:string:string</string> 
+                    </void> 
                    </object> 
                   </void> 
                  </object> 
@@ -1123,7 +1127,7 @@
                      <string>_c0</string> 
                     </void> 
                     <void property="type"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
+                     <object idref="PrimitiveTypeInfo1"/> 
                     </void> 
                    </object> 
                   </void> 
@@ -1133,7 +1137,7 @@
                      <string>_c1</string> 
                     </void> 
                     <void property="type"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
+                     <object idref="PrimitiveTypeInfo1"/> 
                     </void> 
                    </object> 
                   </void> 
@@ -1143,7 +1147,7 @@
                      <string>_c2</string> 
                     </void> 
                     <void property="type"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
+                     <object idref="PrimitiveTypeInfo1"/> 
                     </void> 
                    </object> 
                   </void> 
diff --git a/ql/src/test/results/compiler/plan/groupby4.q.xml b/ql/src/test/results/compiler/plan/groupby4.q.xml
index 687e9ff2c8..ccad040347 100644
--- a/ql/src/test/results/compiler/plan/groupby4.q.xml
+++ b/ql/src/test/results/compiler/plan/groupby4.q.xml
@@ -64,7 +64,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src</string> 
+            <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
            </void> 
           </object> 
          </void> 
@@ -453,7 +453,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>src</string> 
@@ -465,7 +465,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
@@ -506,7 +506,7 @@
               <void property="conf"> 
                <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                 <void property="dirName"> 
-                 <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/1852637495/10001</string> 
+                 <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/1105635414/10001</string> 
                 </void> 
                 <void property="tableInfo"> 
                  <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -529,6 +529,10 @@
                      <string>serialization.format</string> 
                      <string>1</string> 
                     </void> 
+                    <void method="put"> 
+                     <string>columns.types</string> 
+                     <string>string</string> 
+                    </void> 
                    </object> 
                   </void> 
                  </object> 
diff --git a/ql/src/test/results/compiler/plan/groupby5.q.xml b/ql/src/test/results/compiler/plan/groupby5.q.xml
index ffe2a5051f..c267fc7d58 100644
--- a/ql/src/test/results/compiler/plan/groupby5.q.xml
+++ b/ql/src/test/results/compiler/plan/groupby5.q.xml
@@ -64,7 +64,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src</string> 
+            <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
            </void> 
           </object> 
          </void> 
@@ -545,7 +545,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>src</string> 
@@ -557,7 +557,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
@@ -598,7 +598,7 @@
               <void property="conf"> 
                <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                 <void property="dirName"> 
-                 <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/1170192703/10001</string> 
+                 <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/1208485926/10001</string> 
                 </void> 
                 <void property="tableInfo"> 
                  <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -621,6 +621,10 @@
                      <string>serialization.format</string> 
                      <string>1</string> 
                     </void> 
+                    <void method="put"> 
+                     <string>columns.types</string> 
+                     <string>string:double</string> 
+                    </void> 
                    </object> 
                   </void> 
                  </object> 
@@ -654,7 +658,7 @@
                      <string>_c1</string> 
                     </void> 
                     <void property="type"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
+                     <object idref="PrimitiveTypeInfo1"/> 
                     </void> 
                    </object> 
                   </void> 
diff --git a/ql/src/test/results/compiler/plan/groupby6.q.xml b/ql/src/test/results/compiler/plan/groupby6.q.xml
index 20813c8384..46b78e5d27 100644
--- a/ql/src/test/results/compiler/plan/groupby6.q.xml
+++ b/ql/src/test/results/compiler/plan/groupby6.q.xml
@@ -64,7 +64,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src</string> 
+            <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
            </void> 
           </object> 
          </void> 
@@ -453,7 +453,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>src</string> 
@@ -465,7 +465,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
@@ -506,7 +506,7 @@
               <void property="conf"> 
                <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                 <void property="dirName"> 
-                 <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/1968603230/10001</string> 
+                 <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/406715195/10001</string> 
                 </void> 
                 <void property="tableInfo"> 
                  <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -529,6 +529,10 @@
                      <string>serialization.format</string> 
                      <string>1</string> 
                     </void> 
+                    <void method="put"> 
+                     <string>columns.types</string> 
+                     <string>string</string> 
+                    </void> 
                    </object> 
                   </void> 
                  </object> 
diff --git a/ql/src/test/results/compiler/plan/input20.q.xml b/ql/src/test/results/compiler/plan/input20.q.xml
index 7703b33705..8cf0af77bf 100644
--- a/ql/src/test/results/compiler/plan/input20.q.xml
+++ b/ql/src/test/results/compiler/plan/input20.q.xml
@@ -64,7 +64,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src</string> 
+            <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
            </void> 
           </object> 
          </void> 
@@ -672,7 +672,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>tmap:src</string> 
@@ -684,7 +684,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
@@ -729,7 +729,7 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/1722170347/10001</string> 
+                     <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/1723156263/10001</string> 
                     </void> 
                     <void property="tableInfo"> 
                      <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -752,6 +752,10 @@
                          <string>serialization.format</string> 
                          <string>1</string> 
                         </void> 
+                        <void method="put"> 
+                         <string>columns.types</string> 
+                         <string>string:string</string> 
+                        </void> 
                        </object> 
                       </void> 
                      </object> 
diff --git a/ql/src/test/results/compiler/plan/input3.q.xml b/ql/src/test/results/compiler/plan/input3.q.xml
index 87f77f2354..06fbc8cd2e 100755
--- a/ql/src/test/results/compiler/plan/input3.q.xml
+++ b/ql/src/test/results/compiler/plan/input3.q.xml
@@ -30,7 +30,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/680808962/10000</string> 
+               <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/1354727023/10000</string> 
               </void> 
               <void property="table"> 
                <object id="tableDesc0" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -83,7 +83,7 @@
                   </void> 
                   <void method="put"> 
                    <string>location</string> 
-                   <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/dest1</string> 
+                   <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/dest1</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -93,7 +93,7 @@
                </object> 
               </void> 
               <void property="tmpDir"> 
-               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/680808962/10001</string> 
+               <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/1354727023/10001</string> 
               </void> 
              </object> 
             </void> 
@@ -121,10 +121,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/965360746/10007</string> 
+               <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/1725661518/10007</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/680808962/10000</string> 
+               <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/1354727023/10000</string> 
               </void> 
              </object> 
             </void> 
@@ -142,7 +142,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/965360746/10007</string> 
+               <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/1725661518/10007</string> 
                <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -342,10 +342,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/965360746/10007</string> 
+               <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/1725661518/10007</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/965360746/10007</string> 
+                 <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/1725661518/10007</string> 
                 </void> 
                </object> 
               </void> 
@@ -354,7 +354,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/965360746/10007</string> 
+               <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/1725661518/10007</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object idref="tableDesc0"/> 
@@ -372,7 +372,7 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/680808962/10000</string> 
+                     <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/1354727023/10000</string> 
                     </void> 
                     <void property="tableInfo"> 
                      <object idref="tableDesc0"/> 
@@ -503,7 +503,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/680808962/10002</string> 
+               <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/1354727023/10002</string> 
               </void> 
               <void property="table"> 
                <object id="tableDesc3" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -556,7 +556,7 @@
                   </void> 
                   <void method="put"> 
                    <string>location</string> 
-                   <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/dest2</string> 
+                   <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/dest2</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -566,7 +566,7 @@
                </object> 
               </void> 
               <void property="tmpDir"> 
-               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/680808962/10003</string> 
+               <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/1354727023/10003</string> 
               </void> 
              </object> 
             </void> 
@@ -594,10 +594,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/965360746/10008</string> 
+               <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/1725661518/10008</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/680808962/10002</string> 
+               <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/1354727023/10002</string> 
               </void> 
              </object> 
             </void> 
@@ -615,7 +615,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/965360746/10008</string> 
+               <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/1725661518/10008</string> 
                <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -807,10 +807,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/965360746/10008</string> 
+               <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/1725661518/10008</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/965360746/10008</string> 
+                 <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/1725661518/10008</string> 
                 </void> 
                </object> 
               </void> 
@@ -819,7 +819,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/965360746/10008</string> 
+               <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/1725661518/10008</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object idref="tableDesc3"/> 
@@ -837,7 +837,7 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/680808962/10002</string> 
+                     <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/1354727023/10002</string> 
                     </void> 
                     <void property="tableInfo"> 
                      <object idref="tableDesc3"/> 
@@ -977,7 +977,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/680808962/10004</string> 
+               <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/1354727023/10004</string> 
               </void> 
               <void property="table"> 
                <object id="tableDesc6" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -1034,7 +1034,7 @@
                   </void> 
                   <void method="put"> 
                    <string>location</string> 
-                   <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/dest3</string> 
+                   <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/dest3</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -1044,7 +1044,7 @@
                </object> 
               </void> 
               <void property="tmpDir"> 
-               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/680808962/10005</string> 
+               <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/1354727023/10005</string> 
               </void> 
              </object> 
             </void> 
@@ -1072,10 +1072,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/965360746/10009</string> 
+               <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/1725661518/10009</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/680808962/10004</string> 
+               <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/1354727023/10004</string> 
               </void> 
              </object> 
             </void> 
@@ -1093,7 +1093,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/965360746/10009</string> 
+               <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/1725661518/10009</string> 
                <object id="TableScanOperator2" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -1285,10 +1285,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/965360746/10009</string> 
+               <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/1725661518/10009</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/965360746/10009</string> 
+                 <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/1725661518/10009</string> 
                 </void> 
                </object> 
               </void> 
@@ -1297,7 +1297,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/965360746/10009</string> 
+               <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/1725661518/10009</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object idref="tableDesc6"/> 
@@ -1315,7 +1315,7 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/680808962/10004</string> 
+                     <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/1354727023/10004</string> 
                     </void> 
                     <void property="tableInfo"> 
                      <object idref="tableDesc6"/> 
@@ -1443,6 +1443,9 @@
            <object class="org.apache.hadoop.hive.ql.plan.moveWork"> 
             <void property="loadFileWork"> 
              <object class="org.apache.hadoop.hive.ql.plan.loadFileDesc"> 
+              <void property="columnTypes"> 
+               <string>string</string> 
+              </void> 
               <void property="columns"> 
                <string>src.value</string> 
               </void> 
@@ -1450,7 +1453,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/680808962/10006</string> 
+               <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/1354727023/10006</string> 
               </void> 
               <void property="targetDir"> 
                <string>../../../../build/contrib/hive/ql/test/data/warehouse/dest4.out</string> 
@@ -1481,10 +1484,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/965360746/10010</string> 
+               <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/1725661518/10010</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/680808962/10006</string> 
+               <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/1354727023/10006</string> 
               </void> 
              </object> 
             </void> 
@@ -1502,7 +1505,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/965360746/10010</string> 
+               <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/1725661518/10010</string> 
                <object id="TableScanOperator3" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -1671,10 +1674,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/965360746/10010</string> 
+               <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/1725661518/10010</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/965360746/10010</string> 
+                 <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/1725661518/10010</string> 
                 </void> 
                </object> 
               </void> 
@@ -1683,7 +1686,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/965360746/10010</string> 
+               <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/1725661518/10010</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object id="tableDesc11" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -1706,6 +1709,10 @@
                      <string>serialization.format</string> 
                      <string>1</string> 
                     </void> 
+                    <void method="put"> 
+                     <string>columns.types</string> 
+                     <string>string</string> 
+                    </void> 
                    </object> 
                   </void> 
                  </object> 
@@ -1723,7 +1730,7 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/680808962/10006</string> 
+                     <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/1354727023/10006</string> 
                     </void> 
                     <void property="tableInfo"> 
                      <object idref="tableDesc11"/> 
@@ -1882,7 +1889,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src</string> 
+            <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
            </void> 
           </object> 
          </void> 
@@ -1917,7 +1924,7 @@
                        <int>1</int> 
                       </void> 
                       <void property="dirName"> 
-                       <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/965360746/10007</string> 
+                       <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/1725661518/10007</string> 
                       </void> 
                       <void property="tableInfo"> 
                        <object idref="tableDesc0"/> 
@@ -2186,7 +2193,7 @@
                        <int>2</int> 
                       </void> 
                       <void property="dirName"> 
-                       <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/965360746/10008</string> 
+                       <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/1725661518/10008</string> 
                       </void> 
                       <void property="tableInfo"> 
                        <object idref="tableDesc3"/> 
@@ -2549,7 +2556,7 @@
                        <int>3</int> 
                       </void> 
                       <void property="dirName"> 
-                       <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/965360746/10009</string> 
+                       <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/1725661518/10009</string> 
                       </void> 
                       <void property="tableInfo"> 
                        <object idref="tableDesc6"/> 
@@ -2912,7 +2919,7 @@
                        <int>4</int> 
                       </void> 
                       <void property="dirName"> 
-                       <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/965360746/10010</string> 
+                       <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/1725661518/10010</string> 
                       </void> 
                       <void property="tableInfo"> 
                        <object idref="tableDesc11"/> 
@@ -3126,7 +3133,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>src</string> 
@@ -3138,7 +3145,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/input8.q.xml b/ql/src/test/results/compiler/plan/input8.q.xml
index 79570e5956..e7d3955c1f 100644
--- a/ql/src/test/results/compiler/plan/input8.q.xml
+++ b/ql/src/test/results/compiler/plan/input8.q.xml
@@ -64,7 +64,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src1</string> 
+            <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src1</string> 
            </void> 
           </object> 
          </void> 
@@ -92,7 +92,7 @@
                 <void property="conf"> 
                  <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                   <void property="dirName"> 
-                   <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/2061497779/10001</string> 
+                   <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/1453857342/10001</string> 
                   </void> 
                   <void property="tableInfo"> 
                    <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -115,6 +115,10 @@
                        <string>serialization.format</string> 
                        <string>1</string> 
                       </void> 
+                      <void method="put"> 
+                       <string>columns.types</string> 
+                       <string>double:double:double</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -140,7 +144,7 @@
                       <void property="type"> 
                        <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
                         <void property="typeName"> 
-                         <string>string</string> 
+                         <string>double</string> 
                         </void> 
                        </object> 
                       </void> 
@@ -200,25 +204,21 @@
                   <void method="add"> 
                    <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                     <void property="typeInfo"> 
-                     <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                      <void property="typeName"> 
-                       <string>double</string> 
-                      </void> 
-                     </object> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
                    </object> 
                   </void> 
                   <void method="add"> 
                    <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo1"/> 
+                 <object idref="PrimitiveTypeInfo0"/> 
                 </void> 
                </object> 
               </void> 
@@ -266,28 +266,32 @@
                          <string>key</string> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
+                         <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                          <void property="typeName"> 
+                           <string>string</string> 
+                          </void> 
+                         </object> 
                         </void> 
                        </object> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
                    </object> 
                   </void> 
                   <void method="add"> 
                    <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo1"/> 
+                 <object idref="PrimitiveTypeInfo0"/> 
                 </void> 
                </object> 
               </void> 
@@ -346,21 +350,21 @@
                      </object> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
                    </object> 
                   </void> 
                   <void method="add"> 
                    <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo1"/> 
+                 <object idref="PrimitiveTypeInfo0"/> 
                 </void> 
                </object> 
               </void> 
@@ -413,7 +417,7 @@
                    <string>_col0</string> 
                   </void> 
                   <void property="type"> 
-                   <object idref="PrimitiveTypeInfo1"/> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
@@ -423,7 +427,7 @@
                    <string>_col1</string> 
                   </void> 
                   <void property="type"> 
-                   <object idref="PrimitiveTypeInfo1"/> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
@@ -433,7 +437,7 @@
                    <string>_col2</string> 
                   </void> 
                   <void property="type"> 
-                   <object idref="PrimitiveTypeInfo1"/> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
@@ -455,7 +459,7 @@
                <string>key</string> 
               </void> 
               <void property="type"> 
-               <object idref="PrimitiveTypeInfo0"/> 
+               <object idref="PrimitiveTypeInfo1"/> 
               </void> 
              </object> 
             </void> 
@@ -465,7 +469,7 @@
                <string>value</string> 
               </void> 
               <void property="type"> 
-               <object idref="PrimitiveTypeInfo0"/> 
+               <object idref="PrimitiveTypeInfo1"/> 
               </void> 
              </object> 
             </void> 
@@ -480,7 +484,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src1</string> 
+       <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src1</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>src1</string> 
@@ -492,7 +496,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src1</string> 
+       <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src1</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/input_part1.q.xml b/ql/src/test/results/compiler/plan/input_part1.q.xml
index 56a18df49c..2bf4e3cf1b 100644
--- a/ql/src/test/results/compiler/plan/input_part1.q.xml
+++ b/ql/src/test/results/compiler/plan/input_part1.q.xml
@@ -77,7 +77,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/pchakka/workspace/oshive/build/ql/test/data/warehouse/srcpart</string> 
+            <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/srcpart</string> 
            </void> 
           </object> 
          </void> 
@@ -113,7 +113,7 @@
                         <void property="conf"> 
                          <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                           <void property="dirName"> 
-                           <string>file:/data/users/pchakka/workspace/oshive/build/ql/tmp/1727811300/10001</string> 
+                           <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/1378643606/10001</string> 
                           </void> 
                           <void property="tableInfo"> 
                            <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -136,6 +136,10 @@
                                <string>serialization.format</string> 
                                <string>1</string> 
                               </void> 
+                              <void method="put"> 
+                               <string>columns.types</string> 
+                               <string>string:string:string:string</string> 
+                              </void> 
                              </object> 
                             </void> 
                            </object> 
@@ -881,7 +885,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/pchakka/workspace/oshive/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12</string> 
+       <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>srcpart</string> 
@@ -893,7 +897,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/pchakka/workspace/oshive/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12</string> 
+       <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/input_testxpath.q.xml b/ql/src/test/results/compiler/plan/input_testxpath.q.xml
index 20f7a96e2b..341405e25d 100644
--- a/ql/src/test/results/compiler/plan/input_testxpath.q.xml
+++ b/ql/src/test/results/compiler/plan/input_testxpath.q.xml
@@ -68,7 +68,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src_thrift</string> 
+            <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src_thrift</string> 
            </void> 
           </object> 
          </void> 
@@ -96,7 +96,7 @@
                 <void property="conf"> 
                  <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                   <void property="dirName"> 
-                   <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/1361375093/10001</string> 
+                   <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/1178517652/10001</string> 
                   </void> 
                   <void property="tableInfo"> 
                    <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -119,6 +119,10 @@
                        <string>serialization.format</string> 
                        <string>1</string> 
                       </void> 
+                      <void method="put"> 
+                       <string>columns.types</string> 
+                       <string>int:string:string</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -144,7 +148,7 @@
                       <void property="type"> 
                        <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
                         <void property="typeName"> 
-                         <string>string</string> 
+                         <string>int</string> 
                         </void> 
                        </object> 
                       </void> 
@@ -156,7 +160,11 @@
                        <string>mystring</string> 
                       </void> 
                       <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
+                       <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                        <void property="typeName"> 
+                         <string>string</string> 
+                        </void> 
+                       </object> 
                       </void> 
                      </object> 
                     </void> 
@@ -166,7 +174,7 @@
                        <string>_c2</string> 
                       </void> 
                       <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
+                       <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
                      </object> 
                     </void> 
@@ -191,10 +199,10 @@
                   <void property="typeInfo"> 
                    <object id="MapTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.MapTypeInfo"> 
                     <void property="mapKeyTypeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
+                     <object idref="PrimitiveTypeInfo1"/> 
                     </void> 
                     <void property="mapValueTypeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
+                     <object idref="PrimitiveTypeInfo1"/> 
                     </void> 
                    </object> 
                   </void> 
@@ -203,7 +211,7 @@
                 <void property="index"> 
                  <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                   <void property="typeInfo"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
+                   <object idref="PrimitiveTypeInfo1"/> 
                   </void> 
                   <void property="value"> 
                    <string>key_2</string> 
@@ -211,7 +219,7 @@
                  </object> 
                 </void> 
                 <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
+                 <object idref="PrimitiveTypeInfo1"/> 
                 </void> 
                </object> 
               </void> 
@@ -237,11 +245,7 @@
                   <void property="index"> 
                    <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                     <void property="typeInfo"> 
-                     <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                      <void property="typeName"> 
-                       <string>int</string> 
-                      </void> 
-                     </object> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
                     <void property="value"> 
                      <int>0</int> 
@@ -260,7 +264,7 @@
                  <boolean>false</boolean> 
                 </void> 
                 <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
+                 <object idref="PrimitiveTypeInfo1"/> 
                 </void> 
                </object> 
               </void> 
@@ -275,7 +279,7 @@
                   <void property="typeInfo"> 
                    <object id="ListTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.ListTypeInfo"> 
                     <void property="listElementTypeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
                    </object> 
                   </void> 
@@ -284,7 +288,7 @@
                 <void property="index"> 
                  <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                   <void property="typeInfo"> 
-                   <object idref="PrimitiveTypeInfo1"/> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                   <void property="value"> 
                    <int>1</int> 
@@ -292,7 +296,7 @@
                  </object> 
                 </void> 
                 <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo1"/> 
+                 <object idref="PrimitiveTypeInfo0"/> 
                 </void> 
                </object> 
               </void> 
@@ -345,7 +349,7 @@
                    <string>_col0</string> 
                   </void> 
                   <void property="type"> 
-                   <object idref="PrimitiveTypeInfo1"/> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
@@ -355,7 +359,7 @@
                    <string>_col1</string> 
                   </void> 
                   <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
+                   <object idref="PrimitiveTypeInfo1"/> 
                   </void> 
                  </object> 
                 </void> 
@@ -365,7 +369,7 @@
                    <string>_col2</string> 
                   </void> 
                   <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
+                   <object idref="PrimitiveTypeInfo1"/> 
                   </void> 
                  </object> 
                 </void> 
@@ -387,7 +391,7 @@
                <string>aint</string> 
               </void> 
               <void property="type"> 
-               <object idref="PrimitiveTypeInfo1"/> 
+               <object idref="PrimitiveTypeInfo0"/> 
               </void> 
              </object> 
             </void> 
@@ -397,7 +401,7 @@
                <string>astring</string> 
               </void> 
               <void property="type"> 
-               <object idref="PrimitiveTypeInfo0"/> 
+               <object idref="PrimitiveTypeInfo1"/> 
               </void> 
              </object> 
             </void> 
@@ -419,7 +423,7 @@
               <void property="type"> 
                <object class="org.apache.hadoop.hive.serde2.typeinfo.ListTypeInfo"> 
                 <void property="listElementTypeInfo"> 
-                 <object idref="PrimitiveTypeInfo0"/> 
+                 <object idref="PrimitiveTypeInfo1"/> 
                 </void> 
                </object> 
               </void> 
@@ -456,7 +460,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src_thrift</string> 
+       <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src_thrift</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>src_thrift</string> 
@@ -468,7 +472,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src_thrift</string> 
+       <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src_thrift</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/input_testxpath2.q.xml b/ql/src/test/results/compiler/plan/input_testxpath2.q.xml
index 48827d49cb..9276a029e4 100644
--- a/ql/src/test/results/compiler/plan/input_testxpath2.q.xml
+++ b/ql/src/test/results/compiler/plan/input_testxpath2.q.xml
@@ -68,7 +68,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/pchakka/workspace/oshive/build/ql/test/data/warehouse/src_thrift</string> 
+            <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src_thrift</string> 
            </void> 
           </object> 
          </void> 
@@ -104,7 +104,7 @@
                         <void property="conf"> 
                          <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                           <void property="dirName"> 
-                           <string>file:/data/users/pchakka/workspace/oshive/build/ql/tmp/98140911/10001</string> 
+                           <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/720855656/10001</string> 
                           </void> 
                           <void property="tableInfo"> 
                            <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -127,6 +127,10 @@
                                <string>serialization.format</string> 
                                <string>1</string> 
                               </void> 
+                              <void method="put"> 
+                               <string>columns.types</string> 
+                               <string>int:int:int</string> 
+                              </void> 
                              </object> 
                             </void> 
                            </object> 
@@ -152,7 +156,7 @@
                               <void property="type"> 
                                <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
                                 <void property="typeName"> 
-                                 <string>string</string> 
+                                 <string>int</string> 
                                 </void> 
                                </object> 
                               </void> 
@@ -201,10 +205,14 @@
                             <void property="typeInfo"> 
                              <object id="MapTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.MapTypeInfo"> 
                               <void property="mapKeyTypeInfo"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
+                               <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                                <void property="typeName"> 
+                                 <string>string</string> 
+                                </void> 
+                               </object> 
                               </void> 
                               <void property="mapValueTypeInfo"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
+                               <object idref="PrimitiveTypeInfo1"/> 
                               </void> 
                              </object> 
                             </void> 
@@ -216,11 +224,7 @@
                          <class>org.apache.hadoop.hive.ql.udf.generic.GenericUDFSize</class> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>int</string> 
-                          </void> 
-                         </object> 
+                         <object idref="PrimitiveTypeInfo0"/> 
                         </void> 
                        </object> 
                       </void> 
@@ -249,7 +253,7 @@
                          <class>org.apache.hadoop.hive.ql.udf.generic.GenericUDFSize</class> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
+                         <object idref="PrimitiveTypeInfo0"/> 
                         </void> 
                        </object> 
                       </void> 
@@ -266,7 +270,7 @@
                             <void property="typeInfo"> 
                              <object id="ListTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.ListTypeInfo"> 
                               <void property="listElementTypeInfo"> 
-                               <object idref="PrimitiveTypeInfo1"/> 
+                               <object idref="PrimitiveTypeInfo0"/> 
                               </void> 
                              </object> 
                             </void> 
@@ -278,7 +282,7 @@
                          <class>org.apache.hadoop.hive.ql.udf.generic.GenericUDFSize</class> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
+                         <object idref="PrimitiveTypeInfo0"/> 
                         </void> 
                        </object> 
                       </void> 
@@ -331,7 +335,7 @@
                            <string>_col0</string> 
                           </void> 
                           <void property="type"> 
-                           <object idref="PrimitiveTypeInfo1"/> 
+                           <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
                          </object> 
                         </void> 
@@ -341,7 +345,7 @@
                            <string>_col1</string> 
                           </void> 
                           <void property="type"> 
-                           <object idref="PrimitiveTypeInfo1"/> 
+                           <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
                          </object> 
                         </void> 
@@ -351,7 +355,7 @@
                            <string>_col2</string> 
                           </void> 
                           <void property="type"> 
-                           <object idref="PrimitiveTypeInfo1"/> 
+                           <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
                          </object> 
                         </void> 
@@ -487,7 +491,7 @@
                        <string>aint</string> 
                       </void> 
                       <void property="type"> 
-                       <object idref="PrimitiveTypeInfo1"/> 
+                       <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
                      </object> 
                     </void> 
@@ -497,7 +501,7 @@
                        <string>astring</string> 
                       </void> 
                       <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
+                       <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
                      </object> 
                     </void> 
@@ -519,7 +523,7 @@
                       <void property="type"> 
                        <object class="org.apache.hadoop.hive.serde2.typeinfo.ListTypeInfo"> 
                         <void property="listElementTypeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
                        </object> 
                       </void> 
@@ -671,7 +675,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/pchakka/workspace/oshive/build/ql/test/data/warehouse/src_thrift</string> 
+       <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src_thrift</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>src_thrift</string> 
@@ -683,7 +687,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/pchakka/workspace/oshive/build/ql/test/data/warehouse/src_thrift</string> 
+       <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src_thrift</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/join4.q.xml b/ql/src/test/results/compiler/plan/join4.q.xml
index 00da520052..2d9986f5c9 100644
--- a/ql/src/test/results/compiler/plan/join4.q.xml
+++ b/ql/src/test/results/compiler/plan/join4.q.xml
@@ -1,5 +1,5 @@
 <?xml version="1.0" encoding="UTF-8"?> 
-<java version="1.6.0_03-p3" class="java.beans.XMLDecoder"> 
+<java version="1.6.0_07" class="java.beans.XMLDecoder"> 
  <object class="org.apache.hadoop.hive.ql.exec.MapRedTask"> 
   <void property="id"> 
    <string>Stage-2</string> 
@@ -64,7 +64,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/Users/char/Documents/workspace/Hive-460/build/ql/test/data/warehouse/src</string> 
+            <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
            </void> 
           </object> 
          </void> 
@@ -132,7 +132,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/Users/char/Documents/workspace/Hive-460/build/ql/test/data/warehouse/src</string> 
+            <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
            </void> 
           </object> 
          </void> 
@@ -1643,7 +1643,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/Users/char/Documents/workspace/Hive-460/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>c:a:src1</string> 
@@ -1658,7 +1658,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/Users/char/Documents/workspace/Hive-460/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
@@ -1703,7 +1703,7 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/Users/char/Documents/workspace/Hive-460/build/ql/tmp/1797989074/10001</string> 
+                     <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/1968187449/10001</string> 
                     </void> 
                     <void property="tableInfo"> 
                      <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -1726,6 +1726,10 @@
                          <string>serialization.format</string> 
                          <string>1</string> 
                         </void> 
+                        <void method="put"> 
+                         <string>columns.types</string> 
+                         <string>string:string:string:string</string> 
+                        </void> 
                        </object> 
                       </void> 
                      </object> 
diff --git a/ql/src/test/results/compiler/plan/join5.q.xml b/ql/src/test/results/compiler/plan/join5.q.xml
index b901fb1396..df2cd71081 100644
--- a/ql/src/test/results/compiler/plan/join5.q.xml
+++ b/ql/src/test/results/compiler/plan/join5.q.xml
@@ -1,5 +1,5 @@
 <?xml version="1.0" encoding="UTF-8"?> 
-<java version="1.6.0_03-p3" class="java.beans.XMLDecoder"> 
+<java version="1.6.0_07" class="java.beans.XMLDecoder"> 
  <object class="org.apache.hadoop.hive.ql.exec.MapRedTask"> 
   <void property="id"> 
    <string>Stage-2</string> 
@@ -64,7 +64,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/Users/char/Documents/workspace/Hive-460/build/ql/test/data/warehouse/src</string> 
+            <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
            </void> 
           </object> 
          </void> 
@@ -132,7 +132,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/Users/char/Documents/workspace/Hive-460/build/ql/test/data/warehouse/src</string> 
+            <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
            </void> 
           </object> 
          </void> 
@@ -1643,7 +1643,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/Users/char/Documents/workspace/Hive-460/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>c:a:src1</string> 
@@ -1658,7 +1658,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/Users/char/Documents/workspace/Hive-460/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
@@ -1703,7 +1703,7 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/Users/char/Documents/workspace/Hive-460/build/ql/tmp/712670663/10001</string> 
+                     <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/603347557/10001</string> 
                     </void> 
                     <void property="tableInfo"> 
                      <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -1726,6 +1726,10 @@
                          <string>serialization.format</string> 
                          <string>1</string> 
                         </void> 
+                        <void method="put"> 
+                         <string>columns.types</string> 
+                         <string>string:string:string:string</string> 
+                        </void> 
                        </object> 
                       </void> 
                      </object> 
diff --git a/ql/src/test/results/compiler/plan/join6.q.xml b/ql/src/test/results/compiler/plan/join6.q.xml
index e2142066fd..47dd45e040 100644
--- a/ql/src/test/results/compiler/plan/join6.q.xml
+++ b/ql/src/test/results/compiler/plan/join6.q.xml
@@ -1,5 +1,5 @@
 <?xml version="1.0" encoding="UTF-8"?> 
-<java version="1.6.0_03-p3" class="java.beans.XMLDecoder"> 
+<java version="1.6.0_07" class="java.beans.XMLDecoder"> 
  <object class="org.apache.hadoop.hive.ql.exec.MapRedTask"> 
   <void property="id"> 
    <string>Stage-2</string> 
@@ -64,7 +64,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/Users/char/Documents/workspace/Hive-460/build/ql/test/data/warehouse/src</string> 
+            <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
            </void> 
           </object> 
          </void> 
@@ -132,7 +132,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/Users/char/Documents/workspace/Hive-460/build/ql/test/data/warehouse/src</string> 
+            <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
            </void> 
           </object> 
          </void> 
@@ -1643,7 +1643,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/Users/char/Documents/workspace/Hive-460/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>c:a:src1</string> 
@@ -1658,7 +1658,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/Users/char/Documents/workspace/Hive-460/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
@@ -1703,7 +1703,7 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/Users/char/Documents/workspace/Hive-460/build/ql/tmp/336278542/10001</string> 
+                     <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/671157539/10001</string> 
                     </void> 
                     <void property="tableInfo"> 
                      <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -1726,6 +1726,10 @@
                          <string>serialization.format</string> 
                          <string>1</string> 
                         </void> 
+                        <void method="put"> 
+                         <string>columns.types</string> 
+                         <string>string:string:string:string</string> 
+                        </void> 
                        </object> 
                       </void> 
                      </object> 
diff --git a/ql/src/test/results/compiler/plan/join7.q.xml b/ql/src/test/results/compiler/plan/join7.q.xml
index 8d6e519204..279cbb9c7e 100644
--- a/ql/src/test/results/compiler/plan/join7.q.xml
+++ b/ql/src/test/results/compiler/plan/join7.q.xml
@@ -1,5 +1,5 @@
 <?xml version="1.0" encoding="UTF-8"?> 
-<java version="1.6.0_03-p3" class="java.beans.XMLDecoder"> 
+<java version="1.6.0_07" class="java.beans.XMLDecoder"> 
  <object class="org.apache.hadoop.hive.ql.exec.MapRedTask"> 
   <void property="id"> 
    <string>Stage-2</string> 
@@ -64,7 +64,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/Users/char/Documents/workspace/Hive-460/build/ql/test/data/warehouse/src</string> 
+            <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
            </void> 
           </object> 
          </void> 
@@ -132,7 +132,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/Users/char/Documents/workspace/Hive-460/build/ql/test/data/warehouse/src</string> 
+            <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
            </void> 
           </object> 
          </void> 
@@ -200,7 +200,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/Users/char/Documents/workspace/Hive-460/build/ql/test/data/warehouse/src</string> 
+            <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
            </void> 
           </object> 
          </void> 
@@ -2446,7 +2446,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/Users/char/Documents/workspace/Hive-460/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>c:a:src1</string> 
@@ -2464,7 +2464,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/Users/char/Documents/workspace/Hive-460/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
@@ -2509,7 +2509,7 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/Users/char/Documents/workspace/Hive-460/build/ql/tmp/2127603756/10001</string> 
+                     <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/1723027725/10001</string> 
                     </void> 
                     <void property="tableInfo"> 
                      <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -2532,6 +2532,10 @@
                          <string>serialization.format</string> 
                          <string>1</string> 
                         </void> 
+                        <void method="put"> 
+                         <string>columns.types</string> 
+                         <string>string:string:string:string:string:string</string> 
+                        </void> 
                        </object> 
                       </void> 
                      </object> 
diff --git a/ql/src/test/results/compiler/plan/join8.q.xml b/ql/src/test/results/compiler/plan/join8.q.xml
index 4015afe3d3..2ec832cf1e 100644
--- a/ql/src/test/results/compiler/plan/join8.q.xml
+++ b/ql/src/test/results/compiler/plan/join8.q.xml
@@ -1,5 +1,5 @@
 <?xml version="1.0" encoding="UTF-8"?> 
-<java version="1.6.0_03-p3" class="java.beans.XMLDecoder"> 
+<java version="1.6.0_07" class="java.beans.XMLDecoder"> 
  <object class="org.apache.hadoop.hive.ql.exec.MapRedTask"> 
   <void property="id"> 
    <string>Stage-2</string> 
@@ -64,7 +64,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/Users/char/Documents/workspace/Hive-460/build/ql/test/data/warehouse/src</string> 
+            <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
            </void> 
           </object> 
          </void> 
@@ -132,7 +132,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/Users/char/Documents/workspace/Hive-460/build/ql/test/data/warehouse/src</string> 
+            <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
            </void> 
           </object> 
          </void> 
@@ -1643,7 +1643,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/Users/char/Documents/workspace/Hive-460/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>c:a:src1</string> 
@@ -1658,7 +1658,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/Users/char/Documents/workspace/Hive-460/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
@@ -1707,7 +1707,7 @@
                       <void property="conf"> 
                        <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                         <void property="dirName"> 
-                         <string>file:/Users/char/Documents/workspace/Hive-460/build/ql/tmp/2060759954/10001</string> 
+                         <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/638204967/10001</string> 
                         </void> 
                         <void property="tableInfo"> 
                          <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -1730,6 +1730,10 @@
                              <string>serialization.format</string> 
                              <string>1</string> 
                             </void> 
+                            <void method="put"> 
+                             <string>columns.types</string> 
+                             <string>string:string:string:string</string> 
+                            </void> 
                            </object> 
                           </void> 
                          </object> 
diff --git a/ql/src/test/results/compiler/plan/sample1.q.xml b/ql/src/test/results/compiler/plan/sample1.q.xml
index af6c2c8a5c..b2d652965b 100644
--- a/ql/src/test/results/compiler/plan/sample1.q.xml
+++ b/ql/src/test/results/compiler/plan/sample1.q.xml
@@ -77,7 +77,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/srcpart</string> 
+            <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/srcpart</string> 
            </void> 
           </object> 
          </void> 
@@ -113,7 +113,7 @@
                         <void property="conf"> 
                          <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                           <void property="dirName"> 
-                           <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/133862678/10001</string> 
+                           <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/316066904/10001</string> 
                           </void> 
                           <void property="tableInfo"> 
                            <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -136,6 +136,10 @@
                                <string>serialization.format</string> 
                                <string>1</string> 
                               </void> 
+                              <void method="put"> 
+                               <string>columns.types</string> 
+                               <string>string:string:string:string</string> 
+                              </void> 
                              </object> 
                             </void> 
                            </object> 
@@ -720,7 +724,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11</string> 
+       <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>s</string> 
@@ -732,7 +736,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11</string> 
+       <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/subq.q.xml b/ql/src/test/results/compiler/plan/subq.q.xml
index 663daa136a..25329dcb21 100644
--- a/ql/src/test/results/compiler/plan/subq.q.xml
+++ b/ql/src/test/results/compiler/plan/subq.q.xml
@@ -23,6 +23,9 @@
            <object class="org.apache.hadoop.hive.ql.plan.moveWork"> 
             <void property="loadFileWork"> 
              <object class="org.apache.hadoop.hive.ql.plan.loadFileDesc"> 
+              <void property="columnTypes"> 
+               <string>string:string</string> 
+              </void> 
               <void property="columns"> 
                <string>unioninput.key,unioninput.value</string> 
               </void> 
@@ -30,7 +33,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/pchakka/workspace/oshive/build/ql/tmp/1410037290/10000</string> 
+               <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/147216436/10000</string> 
               </void> 
               <void property="targetDir"> 
                <string>../build/ql/test/data/warehouse/union.out</string> 
@@ -61,10 +64,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/pchakka/workspace/oshive/build/ql/tmp/1164893495/10001</string> 
+               <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/144092508/10001</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/pchakka/workspace/oshive/build/ql/tmp/1410037290/10000</string> 
+               <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/147216436/10000</string> 
               </void> 
              </object> 
             </void> 
@@ -82,7 +85,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/pchakka/workspace/oshive/build/ql/tmp/1164893495/10001</string> 
+               <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/144092508/10001</string> 
                <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -282,10 +285,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/pchakka/workspace/oshive/build/ql/tmp/1164893495/10001</string> 
+               <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/144092508/10001</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/pchakka/workspace/oshive/build/ql/tmp/1164893495/10001</string> 
+                 <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/144092508/10001</string> 
                 </void> 
                </object> 
               </void> 
@@ -294,7 +297,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/pchakka/workspace/oshive/build/ql/tmp/1164893495/10001</string> 
+               <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/144092508/10001</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object id="tableDesc2" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -317,6 +320,10 @@
                      <string>serialization.format</string> 
                      <string>1</string> 
                     </void> 
+                    <void method="put"> 
+                     <string>columns.types</string> 
+                     <string>string:string</string> 
+                    </void> 
                    </object> 
                   </void> 
                  </object> 
@@ -334,7 +341,7 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/pchakka/workspace/oshive/build/ql/tmp/1410037290/10000</string> 
+                     <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/147216436/10000</string> 
                     </void> 
                     <void property="tableInfo"> 
                      <object idref="tableDesc2"/> 
@@ -503,7 +510,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/pchakka/workspace/oshive/build/ql/test/data/warehouse/src</string> 
+            <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
            </void> 
           </object> 
          </void> 
@@ -546,7 +553,7 @@
                                <int>1</int> 
                               </void> 
                               <void property="dirName"> 
-                               <string>file:/data/users/pchakka/workspace/oshive/build/ql/tmp/1164893495/10001</string> 
+                               <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/144092508/10001</string> 
                               </void> 
                               <void property="tableInfo"> 
                                <object idref="tableDesc2"/> 
@@ -1004,7 +1011,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/pchakka/workspace/oshive/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>unioninput:src</string> 
@@ -1016,7 +1023,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/pchakka/workspace/oshive/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/udf1.q.xml b/ql/src/test/results/compiler/plan/udf1.q.xml
index 13c04aeda7..30b04a487f 100644
--- a/ql/src/test/results/compiler/plan/udf1.q.xml
+++ b/ql/src/test/results/compiler/plan/udf1.q.xml
@@ -64,7 +64,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/pchakka/workspace/oshive/build/ql/test/data/warehouse/src</string> 
+            <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
            </void> 
           </object> 
          </void> 
@@ -100,7 +100,7 @@
                         <void property="conf"> 
                          <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                           <void property="dirName"> 
-                           <string>file:/data/users/pchakka/workspace/oshive/build/ql/tmp/1348140895/10001</string> 
+                           <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/1654033759/10001</string> 
                           </void> 
                           <void property="tableInfo"> 
                            <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -123,6 +123,10 @@
                                <string>serialization.format</string> 
                                <string>1</string> 
                               </void> 
+                              <void method="put"> 
+                               <string>columns.types</string> 
+                               <string>boolean:boolean:boolean:boolean:boolean:boolean:boolean:boolean:boolean:boolean:boolean:boolean:boolean:string:string:string:string</string> 
+                              </void> 
                              </object> 
                             </void> 
                            </object> 
@@ -148,7 +152,7 @@
                               <void property="type"> 
                                <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
                                 <void property="typeName"> 
-                                 <string>string</string> 
+                                 <string>boolean</string> 
                                 </void> 
                                </object> 
                               </void> 
@@ -280,7 +284,11 @@
                                <string>_c13</string> 
                               </void> 
                               <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
+                               <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                                <void property="typeName"> 
+                                 <string>string</string> 
+                                </void> 
+                               </object> 
                               </void> 
                              </object> 
                             </void> 
@@ -290,7 +298,7 @@
                                <string>_c14</string> 
                               </void> 
                               <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
+                               <object idref="PrimitiveTypeInfo1"/> 
                               </void> 
                              </object> 
                             </void> 
@@ -300,7 +308,7 @@
                                <string>_c15</string> 
                               </void> 
                               <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
+                               <object idref="PrimitiveTypeInfo1"/> 
                               </void> 
                              </object> 
                             </void> 
@@ -310,7 +318,7 @@
                                <string>_c16</string> 
                               </void> 
                               <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
+                               <object idref="PrimitiveTypeInfo1"/> 
                               </void> 
                              </object> 
                             </void> 
@@ -348,7 +356,7 @@
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                             <void property="value"> 
                              <string></string> 
@@ -358,7 +366,7 @@
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                             <void property="value"> 
                              <string>.*</string> 
@@ -368,11 +376,7 @@
                          </object> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>boolean</string> 
-                          </void> 
-                         </object> 
+                         <object idref="PrimitiveTypeInfo0"/> 
                         </void> 
                        </object> 
                       </void> 
@@ -400,7 +404,7 @@
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                             <void property="value"> 
                              <string>ab</string> 
@@ -410,7 +414,7 @@
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                             <void property="value"> 
                              <string>a</string> 
@@ -420,7 +424,7 @@
                          </object> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
+                         <object idref="PrimitiveTypeInfo0"/> 
                         </void> 
                        </object> 
                       </void> 
@@ -448,7 +452,7 @@
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                             <void property="value"> 
                              <string>ab</string> 
@@ -458,7 +462,7 @@
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                             <void property="value"> 
                              <string>_a%</string> 
@@ -468,7 +472,7 @@
                          </object> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
+                         <object idref="PrimitiveTypeInfo0"/> 
                         </void> 
                        </object> 
                       </void> 
@@ -496,7 +500,7 @@
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                             <void property="value"> 
                              <string>ab</string> 
@@ -506,7 +510,7 @@
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                             <void property="value"> 
                              <string>\%\_</string> 
@@ -516,7 +520,7 @@
                          </object> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
+                         <object idref="PrimitiveTypeInfo0"/> 
                         </void> 
                        </object> 
                       </void> 
@@ -544,7 +548,7 @@
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                             <void property="value"> 
                              <string>%_</string> 
@@ -554,7 +558,7 @@
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                             <void property="value"> 
                              <string>\%\_</string> 
@@ -564,7 +568,7 @@
                          </object> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
+                         <object idref="PrimitiveTypeInfo0"/> 
                         </void> 
                        </object> 
                       </void> 
@@ -592,7 +596,7 @@
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                             <void property="value"> 
                              <string>ab</string> 
@@ -602,7 +606,7 @@
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                             <void property="value"> 
                              <string>%a_</string> 
@@ -612,7 +616,7 @@
                          </object> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
+                         <object idref="PrimitiveTypeInfo0"/> 
                         </void> 
                        </object> 
                       </void> 
@@ -640,7 +644,7 @@
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                             <void property="value"> 
                              <string>ab</string> 
@@ -650,7 +654,7 @@
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                             <void property="value"> 
                              <string>%a%</string> 
@@ -660,7 +664,7 @@
                          </object> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
+                         <object idref="PrimitiveTypeInfo0"/> 
                         </void> 
                        </object> 
                       </void> 
@@ -688,7 +692,7 @@
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                             <void property="value"> 
                              <string>b</string> 
@@ -698,7 +702,7 @@
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                             <void property="value"> 
                              <string>%a%</string> 
@@ -708,7 +712,7 @@
                          </object> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
+                         <object idref="PrimitiveTypeInfo0"/> 
                         </void> 
                        </object> 
                       </void> 
@@ -736,7 +740,7 @@
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                             <void property="value"> 
                              <string>a</string> 
@@ -746,7 +750,7 @@
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                             <void property="value"> 
                              <string>[ab]</string> 
@@ -756,7 +760,7 @@
                          </object> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
+                         <object idref="PrimitiveTypeInfo0"/> 
                         </void> 
                        </object> 
                       </void> 
@@ -787,7 +791,7 @@
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                             <void property="value"> 
                              <string>abc</string> 
@@ -797,7 +801,7 @@
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                             <void property="value"> 
                              <string>b</string> 
@@ -807,7 +811,7 @@
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                             <void property="value"> 
                              <string>c</string> 
@@ -817,7 +821,7 @@
                          </object> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
                        </object> 
                       </void> 
@@ -845,7 +849,7 @@
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                             <void property="value"> 
                              <string>hadoop</string> 
@@ -855,7 +859,7 @@
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                             <void property="value"> 
                              <string>o*</string> 
@@ -865,7 +869,7 @@
                          </object> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
+                         <object idref="PrimitiveTypeInfo0"/> 
                         </void> 
                        </object> 
                       </void> 
@@ -893,7 +897,7 @@
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                             <void property="value"> 
                              <string>hadoop</string> 
@@ -903,7 +907,7 @@
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                             <void property="value"> 
                              <string>[a-z]*</string> 
@@ -913,7 +917,7 @@
                          </object> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
+                         <object idref="PrimitiveTypeInfo0"/> 
                         </void> 
                        </object> 
                       </void> 
@@ -941,7 +945,7 @@
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                             <void property="value"> 
                              <string></string> 
@@ -951,7 +955,7 @@
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                             <void property="value"> 
                              <string>[ab]</string> 
@@ -961,7 +965,7 @@
                          </object> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
+                         <object idref="PrimitiveTypeInfo0"/> 
                         </void> 
                        </object> 
                       </void> 
@@ -992,7 +996,7 @@
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                             <void property="value"> 
                              <string>hadoop</string> 
@@ -1002,7 +1006,7 @@
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                             <void property="value"> 
                              <string>(.)[a-z]*</string> 
@@ -1012,7 +1016,7 @@
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                             <void property="value"> 
                              <string>$1ive</string> 
@@ -1022,7 +1026,7 @@
                          </object> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
                        </object> 
                       </void> 
@@ -1053,7 +1057,7 @@
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                             <void property="value"> 
                              <string>abbbb</string> 
@@ -1063,7 +1067,7 @@
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                             <void property="value"> 
                              <string>bb</string> 
@@ -1073,7 +1077,7 @@
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                             <void property="value"> 
                              <string>b</string> 
@@ -1083,7 +1087,7 @@
                          </object> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
                        </object> 
                       </void> 
@@ -1114,7 +1118,7 @@
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                             <void property="value"> 
                              <string>abc</string> 
@@ -1124,7 +1128,7 @@
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                             <void property="value"> 
                              <string>z</string> 
@@ -1134,7 +1138,7 @@
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                             <void property="value"> 
                              <string>a</string> 
@@ -1144,7 +1148,7 @@
                          </object> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
                        </object> 
                       </void> 
@@ -1172,7 +1176,7 @@
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                             <void property="value"> 
                              <string>a</string> 
@@ -1182,7 +1186,7 @@
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                             <void property="value"> 
                              <string>%a%</string> 
@@ -1192,7 +1196,7 @@
                          </object> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
+                         <object idref="PrimitiveTypeInfo0"/> 
                         </void> 
                        </object> 
                       </void> 
@@ -1329,7 +1333,7 @@
                            <string>_col0</string> 
                           </void> 
                           <void property="type"> 
-                           <object idref="PrimitiveTypeInfo1"/> 
+                           <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
                          </object> 
                         </void> 
@@ -1339,7 +1343,7 @@
                            <string>_col1</string> 
                           </void> 
                           <void property="type"> 
-                           <object idref="PrimitiveTypeInfo1"/> 
+                           <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
                          </object> 
                         </void> 
@@ -1349,7 +1353,7 @@
                            <string>_col2</string> 
                           </void> 
                           <void property="type"> 
-                           <object idref="PrimitiveTypeInfo1"/> 
+                           <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
                          </object> 
                         </void> 
@@ -1359,7 +1363,7 @@
                            <string>_col3</string> 
                           </void> 
                           <void property="type"> 
-                           <object idref="PrimitiveTypeInfo1"/> 
+                           <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
                          </object> 
                         </void> 
@@ -1369,7 +1373,7 @@
                            <string>_col4</string> 
                           </void> 
                           <void property="type"> 
-                           <object idref="PrimitiveTypeInfo1"/> 
+                           <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
                          </object> 
                         </void> 
@@ -1379,7 +1383,7 @@
                            <string>_col5</string> 
                           </void> 
                           <void property="type"> 
-                           <object idref="PrimitiveTypeInfo1"/> 
+                           <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
                          </object> 
                         </void> 
@@ -1389,7 +1393,7 @@
                            <string>_col6</string> 
                           </void> 
                           <void property="type"> 
-                           <object idref="PrimitiveTypeInfo1"/> 
+                           <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
                          </object> 
                         </void> 
@@ -1399,7 +1403,7 @@
                            <string>_col7</string> 
                           </void> 
                           <void property="type"> 
-                           <object idref="PrimitiveTypeInfo1"/> 
+                           <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
                          </object> 
                         </void> 
@@ -1409,7 +1413,7 @@
                            <string>_col8</string> 
                           </void> 
                           <void property="type"> 
-                           <object idref="PrimitiveTypeInfo1"/> 
+                           <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
                          </object> 
                         </void> 
@@ -1419,7 +1423,7 @@
                            <string>_col9</string> 
                           </void> 
                           <void property="type"> 
-                           <object idref="PrimitiveTypeInfo1"/> 
+                           <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
                          </object> 
                         </void> 
@@ -1429,7 +1433,7 @@
                            <string>_col10</string> 
                           </void> 
                           <void property="type"> 
-                           <object idref="PrimitiveTypeInfo1"/> 
+                           <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
                          </object> 
                         </void> 
@@ -1439,7 +1443,7 @@
                            <string>_col11</string> 
                           </void> 
                           <void property="type"> 
-                           <object idref="PrimitiveTypeInfo1"/> 
+                           <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
                          </object> 
                         </void> 
@@ -1449,7 +1453,7 @@
                            <string>_col12</string> 
                           </void> 
                           <void property="type"> 
-                           <object idref="PrimitiveTypeInfo1"/> 
+                           <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
                          </object> 
                         </void> 
@@ -1459,7 +1463,7 @@
                            <string>_col13</string> 
                           </void> 
                           <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
+                           <object idref="PrimitiveTypeInfo1"/> 
                           </void> 
                          </object> 
                         </void> 
@@ -1469,7 +1473,7 @@
                            <string>_col14</string> 
                           </void> 
                           <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
+                           <object idref="PrimitiveTypeInfo1"/> 
                           </void> 
                          </object> 
                         </void> 
@@ -1479,7 +1483,7 @@
                            <string>_col15</string> 
                           </void> 
                           <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
+                           <object idref="PrimitiveTypeInfo1"/> 
                           </void> 
                          </object> 
                         </void> 
@@ -1489,7 +1493,7 @@
                            <string>_col16</string> 
                           </void> 
                           <void property="type"> 
-                           <object idref="PrimitiveTypeInfo0"/> 
+                           <object idref="PrimitiveTypeInfo1"/> 
                           </void> 
                          </object> 
                         </void> 
@@ -1546,7 +1550,7 @@
                              <string>key</string> 
                             </void> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                            </object> 
                           </void> 
@@ -1602,7 +1606,7 @@
                      </object> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
                    </object> 
                   </void> 
@@ -1625,7 +1629,7 @@
                        <string>key</string> 
                       </void> 
                       <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
+                       <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
                      </object> 
                     </void> 
@@ -1635,7 +1639,7 @@
                        <string>value</string> 
                       </void> 
                       <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
+                       <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
                      </object> 
                     </void> 
@@ -1675,7 +1679,7 @@
                          <string>key</string> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
                        </object> 
                       </void> 
@@ -1716,7 +1720,7 @@
                  </object> 
                 </void> 
                 <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo1"/> 
+                 <object idref="PrimitiveTypeInfo0"/> 
                 </void> 
                </object> 
               </void> 
@@ -1754,7 +1758,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/pchakka/workspace/oshive/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>src</string> 
@@ -1766,7 +1770,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/pchakka/workspace/oshive/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/udf4.q.xml b/ql/src/test/results/compiler/plan/udf4.q.xml
index 9af07ed37c..45e5beb43e 100644
--- a/ql/src/test/results/compiler/plan/udf4.q.xml
+++ b/ql/src/test/results/compiler/plan/udf4.q.xml
@@ -64,7 +64,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/dest1</string> 
+            <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/dest1</string> 
            </void> 
           </object> 
          </void> 
@@ -92,7 +92,7 @@
                 <void property="conf"> 
                  <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                   <void property="dirName"> 
-                   <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/49378414/10001</string> 
+                   <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/493977205/10001</string> 
                   </void> 
                   <void property="tableInfo"> 
                    <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -115,6 +115,10 @@
                        <string>serialization.format</string> 
                        <string>1</string> 
                       </void> 
+                      <void method="put"> 
+                       <string>columns.types</string> 
+                       <string>bigint:bigint:bigint:bigint:bigint:bigint:double:double:double:bigint:bigint:bigint:bigint:double:int:int:int:int:int</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -140,7 +144,7 @@
                       <void property="type"> 
                        <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
                         <void property="typeName"> 
-                         <string>string</string> 
+                         <string>bigint</string> 
                         </void> 
                        </object> 
                       </void> 
@@ -202,7 +206,11 @@
                        <string>_c6</string> 
                       </void> 
                       <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
+                       <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                        <void property="typeName"> 
+                         <string>double</string> 
+                        </void> 
+                       </object> 
                       </void> 
                      </object> 
                     </void> 
@@ -212,7 +220,7 @@
                        <string>_c7</string> 
                       </void> 
                       <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
+                       <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
                      </object> 
                     </void> 
@@ -222,7 +230,7 @@
                        <string>_c8</string> 
                       </void> 
                       <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
+                       <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
                      </object> 
                     </void> 
@@ -272,7 +280,7 @@
                        <string>_c13</string> 
                       </void> 
                       <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
+                       <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
                      </object> 
                     </void> 
@@ -282,7 +290,11 @@
                        <string>_c14</string> 
                       </void> 
                       <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
+                       <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                        <void property="typeName"> 
+                         <string>int</string> 
+                        </void> 
+                       </object> 
                       </void> 
                      </object> 
                     </void> 
@@ -292,7 +304,7 @@
                        <string>_c15</string> 
                       </void> 
                       <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
+                       <object idref="PrimitiveTypeInfo2"/> 
                       </void> 
                      </object> 
                     </void> 
@@ -302,7 +314,7 @@
                        <string>_c16</string> 
                       </void> 
                       <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
+                       <object idref="PrimitiveTypeInfo2"/> 
                       </void> 
                      </object> 
                     </void> 
@@ -312,7 +324,7 @@
                        <string>_c17</string> 
                       </void> 
                       <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
+                       <object idref="PrimitiveTypeInfo2"/> 
                       </void> 
                      </object> 
                     </void> 
@@ -322,7 +334,7 @@
                        <string>_c18</string> 
                       </void> 
                       <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
+                       <object idref="PrimitiveTypeInfo2"/> 
                       </void> 
                      </object> 
                     </void> 
@@ -357,11 +369,7 @@
                   <void method="add"> 
                    <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                     <void property="typeInfo"> 
-                     <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                      <void property="typeName"> 
-                       <string>double</string> 
-                      </void> 
-                     </object> 
+                     <object idref="PrimitiveTypeInfo1"/> 
                     </void> 
                     <void property="value"> 
                      <double>0.0</double> 
@@ -524,11 +532,7 @@
                  </object> 
                 </void> 
                 <void property="typeInfo"> 
-                 <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                  <void property="typeName"> 
-                   <string>bigint</string> 
-                  </void> 
-                 </object> 
+                 <object idref="PrimitiveTypeInfo0"/> 
                 </void> 
                </object> 
               </void> 
@@ -563,7 +567,7 @@
                  </object> 
                 </void> 
                 <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo2"/> 
+                 <object idref="PrimitiveTypeInfo0"/> 
                 </void> 
                </object> 
               </void> 
@@ -598,7 +602,7 @@
                  </object> 
                 </void> 
                 <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo2"/> 
+                 <object idref="PrimitiveTypeInfo0"/> 
                 </void> 
                </object> 
               </void> 
@@ -657,7 +661,7 @@
                  </object> 
                 </void> 
                 <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo2"/> 
+                 <object idref="PrimitiveTypeInfo0"/> 
                 </void> 
                </object> 
               </void> 
@@ -692,7 +696,7 @@
                  </object> 
                 </void> 
                 <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo2"/> 
+                 <object idref="PrimitiveTypeInfo0"/> 
                 </void> 
                </object> 
               </void> 
@@ -727,7 +731,7 @@
                  </object> 
                 </void> 
                 <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo2"/> 
+                 <object idref="PrimitiveTypeInfo0"/> 
                 </void> 
                </object> 
               </void> 
@@ -769,11 +773,7 @@
                       <void method="add"> 
                        <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                         <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo3" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>int</string> 
-                          </void> 
-                         </object> 
+                         <object idref="PrimitiveTypeInfo2"/> 
                         </void> 
                         <void property="value"> 
                          <int>3</int> 
@@ -783,7 +783,7 @@
                      </object> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
                    </object> 
                   </void> 
@@ -825,7 +825,7 @@
                  </object> 
                 </void> 
                 <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo2"/> 
+                 <object idref="PrimitiveTypeInfo0"/> 
                 </void> 
                </object> 
               </void> 
@@ -884,7 +884,7 @@
                  </object> 
                 </void> 
                 <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo2"/> 
+                 <object idref="PrimitiveTypeInfo0"/> 
                 </void> 
                </object> 
               </void> 
@@ -919,7 +919,7 @@
                  </object> 
                 </void> 
                 <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo2"/> 
+                 <object idref="PrimitiveTypeInfo0"/> 
                 </void> 
                </object> 
               </void> 
@@ -947,7 +947,7 @@
                   <void method="add"> 
                    <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo3"/> 
+                     <object idref="PrimitiveTypeInfo2"/> 
                     </void> 
                     <void property="value"> 
                      <int>1</int> 
@@ -974,7 +974,7 @@
                       <void method="add"> 
                        <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo3"/> 
+                         <object idref="PrimitiveTypeInfo2"/> 
                         </void> 
                         <void property="value"> 
                          <int>2</int> 
@@ -984,14 +984,14 @@
                      </object> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo3"/> 
+                     <object idref="PrimitiveTypeInfo2"/> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo3"/> 
+                 <object idref="PrimitiveTypeInfo2"/> 
                 </void> 
                </object> 
               </void> 
@@ -1019,7 +1019,7 @@
                   <void method="add"> 
                    <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo3"/> 
+                     <object idref="PrimitiveTypeInfo2"/> 
                     </void> 
                     <void property="value"> 
                      <int>1</int> 
@@ -1029,7 +1029,7 @@
                   <void method="add"> 
                    <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo3"/> 
+                     <object idref="PrimitiveTypeInfo2"/> 
                     </void> 
                     <void property="value"> 
                      <int>2</int> 
@@ -1039,7 +1039,7 @@
                  </object> 
                 </void> 
                 <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo3"/> 
+                 <object idref="PrimitiveTypeInfo2"/> 
                 </void> 
                </object> 
               </void> 
@@ -1064,7 +1064,7 @@
                   <void method="add"> 
                    <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo3"/> 
+                     <object idref="PrimitiveTypeInfo2"/> 
                     </void> 
                     <void property="value"> 
                      <int>3</int> 
@@ -1074,7 +1074,7 @@
                  </object> 
                 </void> 
                 <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo3"/> 
+                 <object idref="PrimitiveTypeInfo2"/> 
                 </void> 
                </object> 
               </void> 
@@ -1082,7 +1082,7 @@
                <string>_col14</string> 
                <object id="exprNodeConstantDesc0" class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                 <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo3"/> 
+                 <object idref="PrimitiveTypeInfo2"/> 
                 </void> 
                 <void property="value"> 
                  <int>3</int> 
@@ -1120,7 +1120,7 @@
                  </object> 
                 </void> 
                 <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo2"/> 
+                 <object idref="PrimitiveTypeInfo0"/> 
                 </void> 
                </object> 
               </void> 
@@ -1145,7 +1145,7 @@
                   <void method="add"> 
                    <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo3"/> 
+                     <object idref="PrimitiveTypeInfo2"/> 
                     </void> 
                     <void property="value"> 
                      <int>1</int> 
@@ -1155,7 +1155,7 @@
                  </object> 
                 </void> 
                 <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo3"/> 
+                 <object idref="PrimitiveTypeInfo2"/> 
                 </void> 
                </object> 
               </void> 
@@ -1304,7 +1304,7 @@
                    <string>_col0</string> 
                   </void> 
                   <void property="type"> 
-                   <object idref="PrimitiveTypeInfo2"/> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
@@ -1314,7 +1314,7 @@
                    <string>_col1</string> 
                   </void> 
                   <void property="type"> 
-                   <object idref="PrimitiveTypeInfo2"/> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
@@ -1324,7 +1324,7 @@
                    <string>_col2</string> 
                   </void> 
                   <void property="type"> 
-                   <object idref="PrimitiveTypeInfo2"/> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
@@ -1334,7 +1334,7 @@
                    <string>_col3</string> 
                   </void> 
                   <void property="type"> 
-                   <object idref="PrimitiveTypeInfo2"/> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
@@ -1344,7 +1344,7 @@
                    <string>_col4</string> 
                   </void> 
                   <void property="type"> 
-                   <object idref="PrimitiveTypeInfo2"/> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
@@ -1354,7 +1354,7 @@
                    <string>_col5</string> 
                   </void> 
                   <void property="type"> 
-                   <object idref="PrimitiveTypeInfo2"/> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
@@ -1394,7 +1394,7 @@
                    <string>_col9</string> 
                   </void> 
                   <void property="type"> 
-                   <object idref="PrimitiveTypeInfo2"/> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
@@ -1404,7 +1404,7 @@
                    <string>_col10</string> 
                   </void> 
                   <void property="type"> 
-                   <object idref="PrimitiveTypeInfo2"/> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
@@ -1414,7 +1414,7 @@
                    <string>_col11</string> 
                   </void> 
                   <void property="type"> 
-                   <object idref="PrimitiveTypeInfo2"/> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
@@ -1424,7 +1424,7 @@
                    <string>_col12</string> 
                   </void> 
                   <void property="type"> 
-                   <object idref="PrimitiveTypeInfo2"/> 
+                   <object idref="PrimitiveTypeInfo0"/> 
                   </void> 
                  </object> 
                 </void> 
@@ -1444,7 +1444,7 @@
                    <string>_col14</string> 
                   </void> 
                   <void property="type"> 
-                   <object idref="PrimitiveTypeInfo3"/> 
+                   <object idref="PrimitiveTypeInfo2"/> 
                   </void> 
                  </object> 
                 </void> 
@@ -1454,7 +1454,7 @@
                    <string>_col15</string> 
                   </void> 
                   <void property="type"> 
-                   <object idref="PrimitiveTypeInfo3"/> 
+                   <object idref="PrimitiveTypeInfo2"/> 
                   </void> 
                  </object> 
                 </void> 
@@ -1464,7 +1464,7 @@
                    <string>_col16</string> 
                   </void> 
                   <void property="type"> 
-                   <object idref="PrimitiveTypeInfo3"/> 
+                   <object idref="PrimitiveTypeInfo2"/> 
                   </void> 
                  </object> 
                 </void> 
@@ -1474,7 +1474,7 @@
                    <string>_col17</string> 
                   </void> 
                   <void property="type"> 
-                   <object idref="PrimitiveTypeInfo3"/> 
+                   <object idref="PrimitiveTypeInfo2"/> 
                   </void> 
                  </object> 
                 </void> 
@@ -1484,7 +1484,7 @@
                    <string>_col18</string> 
                   </void> 
                   <void property="type"> 
-                   <object idref="PrimitiveTypeInfo3"/> 
+                   <object idref="PrimitiveTypeInfo2"/> 
                   </void> 
                  </object> 
                 </void> 
@@ -1506,7 +1506,11 @@
                <string>key</string> 
               </void> 
               <void property="type"> 
-               <object idref="PrimitiveTypeInfo0"/> 
+               <object id="PrimitiveTypeInfo3" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                <void property="typeName"> 
+                 <string>string</string> 
+                </void> 
+               </object> 
               </void> 
              </object> 
             </void> 
@@ -1516,7 +1520,7 @@
                <string>value</string> 
               </void> 
               <void property="type"> 
-               <object idref="PrimitiveTypeInfo0"/> 
+               <object idref="PrimitiveTypeInfo3"/> 
               </void> 
              </object> 
             </void> 
@@ -1531,7 +1535,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/dest1</string> 
+       <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/dest1</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>dest1</string> 
@@ -1543,7 +1547,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/dest1</string> 
+       <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/dest1</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/udf6.q.xml b/ql/src/test/results/compiler/plan/udf6.q.xml
index d5d2f1a2bd..fe91ec0b3a 100644
--- a/ql/src/test/results/compiler/plan/udf6.q.xml
+++ b/ql/src/test/results/compiler/plan/udf6.q.xml
@@ -64,7 +64,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src</string> 
+            <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
            </void> 
           </object> 
          </void> 
@@ -92,7 +92,7 @@
                 <void property="conf"> 
                  <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                   <void property="dirName"> 
-                   <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/785930518/10001</string> 
+                   <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/1381018045/10001</string> 
                   </void> 
                   <void property="tableInfo"> 
                    <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -115,6 +115,10 @@
                        <string>serialization.format</string> 
                        <string>1</string> 
                       </void> 
+                      <void method="put"> 
+                       <string>columns.types</string> 
+                       <string>string:int</string> 
+                      </void> 
                      </object> 
                     </void> 
                    </object> 
@@ -152,7 +156,11 @@
                        <string>_c1</string> 
                       </void> 
                       <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
+                       <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                        <void property="typeName"> 
+                         <string>int</string> 
+                        </void> 
+                       </object> 
                       </void> 
                      </object> 
                     </void> 
@@ -188,11 +196,7 @@
                   <void method="add"> 
                    <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                     <void property="typeInfo"> 
-                     <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                      <void property="typeName"> 
-                       <string>int</string> 
-                      </void> 
-                     </object> 
+                     <object idref="PrimitiveTypeInfo1"/> 
                     </void> 
                     <void property="value"> 
                      <int>1</int> 
@@ -367,7 +371,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>src</string> 
@@ -379,7 +383,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/udf_case.q.xml b/ql/src/test/results/compiler/plan/udf_case.q.xml
index ca16379291..28a35308ae 100644
--- a/ql/src/test/results/compiler/plan/udf_case.q.xml
+++ b/ql/src/test/results/compiler/plan/udf_case.q.xml
@@ -64,7 +64,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src</string> 
+            <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
            </void> 
           </object> 
          </void> 
@@ -96,7 +96,7 @@
                     <void property="conf"> 
                      <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                       <void property="dirName"> 
-                       <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/395753358/10001</string> 
+                       <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/1473642109/10001</string> 
                       </void> 
                       <void property="tableInfo"> 
                        <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -119,6 +119,10 @@
                            <string>serialization.format</string> 
                            <string>1</string> 
                           </void> 
+                          <void method="put"> 
+                           <string>columns.types</string> 
+                           <string>int:int</string> 
+                          </void> 
                          </object> 
                         </void> 
                        </object> 
@@ -144,7 +148,7 @@
                           <void property="type"> 
                            <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
                             <void property="typeName"> 
-                             <string>string</string> 
+                             <string>int</string> 
                             </void> 
                            </object> 
                           </void> 
@@ -192,11 +196,7 @@
                        <string>_col0</string> 
                       </void> 
                       <void property="type"> 
-                       <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                        <void property="typeName"> 
-                         <string>int</string> 
-                        </void> 
-                       </object> 
+                       <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
                      </object> 
                     </void> 
@@ -206,7 +206,7 @@
                        <string>_col1</string> 
                       </void> 
                       <void property="type"> 
-                       <object idref="PrimitiveTypeInfo1"/> 
+                       <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
                      </object> 
                     </void> 
@@ -228,7 +228,7 @@
                   <void method="add"> 
                    <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
                     <void property="value"> 
                      <int>11</int> 
@@ -238,7 +238,7 @@
                   <void method="add"> 
                    <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
                     <void property="value"> 
                      <int>12</int> 
@@ -248,7 +248,7 @@
                   <void method="add"> 
                    <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
                     <void property="value"> 
                      <int>13</int> 
@@ -258,7 +258,7 @@
                   <void method="add"> 
                    <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
                     <void property="value"> 
                      <int>14</int> 
@@ -268,7 +268,7 @@
                   <void method="add"> 
                    <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
                     <void property="value"> 
                      <int>15</int> 
@@ -281,7 +281,7 @@
                  <class>org.apache.hadoop.hive.ql.udf.generic.GenericUDFCase</class> 
                 </void> 
                 <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo1"/> 
+                 <object idref="PrimitiveTypeInfo0"/> 
                 </void> 
                </object> 
               </void> 
@@ -293,7 +293,7 @@
                   <void method="add"> 
                    <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
                     <void property="value"> 
                      <int>1</int> 
@@ -303,7 +303,7 @@
                   <void method="add"> 
                    <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
                     <void property="value"> 
                      <int>1</int> 
@@ -313,7 +313,7 @@
                   <void method="add"> 
                    <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
                     <void property="value"> 
                      <int>2</int> 
@@ -323,7 +323,7 @@
                   <void method="add"> 
                    <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
                     <void property="value"> 
                      <int>3</int> 
@@ -333,7 +333,7 @@
                   <void method="add"> 
                    <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
                     <void property="value"> 
                      <int>4</int> 
@@ -343,7 +343,7 @@
                   <void method="add"> 
                    <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
                     <void property="value"> 
                      <int>5</int> 
@@ -356,7 +356,7 @@
                  <class>org.apache.hadoop.hive.ql.udf.generic.GenericUDFCase</class> 
                 </void> 
                 <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo1"/> 
+                 <object idref="PrimitiveTypeInfo0"/> 
                 </void> 
                </object> 
               </void> 
@@ -414,7 +414,11 @@
                <string>key</string> 
               </void> 
               <void property="type"> 
-               <object idref="PrimitiveTypeInfo0"/> 
+               <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                <void property="typeName"> 
+                 <string>string</string> 
+                </void> 
+               </object> 
               </void> 
              </object> 
             </void> 
@@ -424,7 +428,7 @@
                <string>value</string> 
               </void> 
               <void property="type"> 
-               <object idref="PrimitiveTypeInfo0"/> 
+               <object idref="PrimitiveTypeInfo1"/> 
               </void> 
              </object> 
             </void> 
@@ -439,7 +443,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>src</string> 
@@ -451,7 +455,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/udf_when.q.xml b/ql/src/test/results/compiler/plan/udf_when.q.xml
index c7cc678ec1..be2fcf0fb7 100644
--- a/ql/src/test/results/compiler/plan/udf_when.q.xml
+++ b/ql/src/test/results/compiler/plan/udf_when.q.xml
@@ -64,7 +64,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src</string> 
+            <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
            </void> 
           </object> 
          </void> 
@@ -96,7 +96,7 @@
                     <void property="conf"> 
                      <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                       <void property="dirName"> 
-                       <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/792684261/10001</string> 
+                       <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/1177328759/10001</string> 
                       </void> 
                       <void property="tableInfo"> 
                        <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -119,6 +119,10 @@
                            <string>serialization.format</string> 
                            <string>1</string> 
                           </void> 
+                          <void method="put"> 
+                           <string>columns.types</string> 
+                           <string>int:int</string> 
+                          </void> 
                          </object> 
                         </void> 
                        </object> 
@@ -144,7 +148,7 @@
                           <void property="type"> 
                            <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
                             <void property="typeName"> 
-                             <string>string</string> 
+                             <string>int</string> 
                             </void> 
                            </object> 
                           </void> 
@@ -192,11 +196,7 @@
                        <string>_col0</string> 
                       </void> 
                       <void property="type"> 
-                       <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                        <void property="typeName"> 
-                         <string>int</string> 
-                        </void> 
-                       </object> 
+                       <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
                      </object> 
                     </void> 
@@ -206,7 +206,7 @@
                        <string>_col1</string> 
                       </void> 
                       <void property="type"> 
-                       <object idref="PrimitiveTypeInfo1"/> 
+                       <object idref="PrimitiveTypeInfo0"/> 
                       </void> 
                      </object> 
                     </void> 
@@ -248,7 +248,7 @@
                       <void method="add"> 
                        <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
+                         <object idref="PrimitiveTypeInfo0"/> 
                         </void> 
                         <void property="value"> 
                          <int>12</int> 
@@ -258,7 +258,7 @@
                       <void method="add"> 
                        <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
+                         <object idref="PrimitiveTypeInfo0"/> 
                         </void> 
                         <void property="value"> 
                          <int>11</int> 
@@ -268,7 +268,7 @@
                      </object> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                     <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
                       <void property="typeName"> 
                        <string>boolean</string> 
                       </void> 
@@ -279,7 +279,7 @@
                   <void method="add"> 
                    <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
                     <void property="value"> 
                      <int>13</int> 
@@ -309,7 +309,7 @@
                       <void method="add"> 
                        <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
+                         <object idref="PrimitiveTypeInfo0"/> 
                         </void> 
                         <void property="value"> 
                          <int>14</int> 
@@ -319,7 +319,7 @@
                       <void method="add"> 
                        <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
+                         <object idref="PrimitiveTypeInfo0"/> 
                         </void> 
                         <void property="value"> 
                          <int>10</int> 
@@ -329,14 +329,14 @@
                      </object> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                     <object idref="PrimitiveTypeInfo1"/> 
                     </void> 
                    </object> 
                   </void> 
                   <void method="add"> 
                    <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
                     <void property="value"> 
                      <int>15</int> 
@@ -349,7 +349,7 @@
                  <class>org.apache.hadoop.hive.ql.udf.generic.GenericUDFWhen</class> 
                 </void> 
                 <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo1"/> 
+                 <object idref="PrimitiveTypeInfo0"/> 
                 </void> 
                </object> 
               </void> 
@@ -381,7 +381,7 @@
                       <void method="add"> 
                        <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
+                         <object idref="PrimitiveTypeInfo0"/> 
                         </void> 
                         <void property="value"> 
                          <int>1</int> 
@@ -391,7 +391,7 @@
                       <void method="add"> 
                        <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
+                         <object idref="PrimitiveTypeInfo0"/> 
                         </void> 
                         <void property="value"> 
                          <int>1</int> 
@@ -401,14 +401,14 @@
                      </object> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                     <object idref="PrimitiveTypeInfo1"/> 
                     </void> 
                    </object> 
                   </void> 
                   <void method="add"> 
                    <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
                     <void property="value"> 
                      <int>2</int> 
@@ -438,7 +438,7 @@
                       <void method="add"> 
                        <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
+                         <object idref="PrimitiveTypeInfo0"/> 
                         </void> 
                         <void property="value"> 
                          <int>3</int> 
@@ -448,7 +448,7 @@
                       <void method="add"> 
                        <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
+                         <object idref="PrimitiveTypeInfo0"/> 
                         </void> 
                         <void property="value"> 
                          <int>5</int> 
@@ -458,14 +458,14 @@
                      </object> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                     <object idref="PrimitiveTypeInfo1"/> 
                     </void> 
                    </object> 
                   </void> 
                   <void method="add"> 
                    <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
                     <void property="value"> 
                      <int>4</int> 
@@ -475,7 +475,7 @@
                   <void method="add"> 
                    <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
                     <void property="value"> 
                      <int>5</int> 
@@ -488,7 +488,7 @@
                  <class>org.apache.hadoop.hive.ql.udf.generic.GenericUDFWhen</class> 
                 </void> 
                 <void property="typeInfo"> 
-                 <object idref="PrimitiveTypeInfo1"/> 
+                 <object idref="PrimitiveTypeInfo0"/> 
                 </void> 
                </object> 
               </void> 
@@ -546,7 +546,11 @@
                <string>key</string> 
               </void> 
               <void property="type"> 
-               <object idref="PrimitiveTypeInfo0"/> 
+               <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                <void property="typeName"> 
+                 <string>string</string> 
+                </void> 
+               </object> 
               </void> 
              </object> 
             </void> 
@@ -556,7 +560,7 @@
                <string>value</string> 
               </void> 
               <void property="type"> 
-               <object idref="PrimitiveTypeInfo0"/> 
+               <object idref="PrimitiveTypeInfo2"/> 
               </void> 
              </object> 
             </void> 
@@ -571,7 +575,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>src</string> 
@@ -583,7 +587,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/union.q.xml b/ql/src/test/results/compiler/plan/union.q.xml
index 3c760e23c6..5248a434e0 100644
--- a/ql/src/test/results/compiler/plan/union.q.xml
+++ b/ql/src/test/results/compiler/plan/union.q.xml
@@ -23,6 +23,9 @@
            <object class="org.apache.hadoop.hive.ql.plan.moveWork"> 
             <void property="loadFileWork"> 
              <object class="org.apache.hadoop.hive.ql.plan.loadFileDesc"> 
+              <void property="columnTypes"> 
+               <string>string:string</string> 
+              </void> 
               <void property="columns"> 
                <string>unioninput.key,unioninput.value</string> 
               </void> 
@@ -30,7 +33,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/pchakka/workspace/oshive/build/ql/tmp/907054306/10000</string> 
+               <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/1796533964/10000</string> 
               </void> 
               <void property="targetDir"> 
                <string>../build/ql/test/data/warehouse/union.out</string> 
@@ -61,10 +64,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/pchakka/workspace/oshive/build/ql/tmp/602498110/10001</string> 
+               <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/665057992/10001</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/pchakka/workspace/oshive/build/ql/tmp/907054306/10000</string> 
+               <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/1796533964/10000</string> 
               </void> 
              </object> 
             </void> 
@@ -82,7 +85,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/pchakka/workspace/oshive/build/ql/tmp/602498110/10001</string> 
+               <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/665057992/10001</string> 
                <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -282,10 +285,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/pchakka/workspace/oshive/build/ql/tmp/602498110/10001</string> 
+               <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/665057992/10001</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/pchakka/workspace/oshive/build/ql/tmp/602498110/10001</string> 
+                 <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/665057992/10001</string> 
                 </void> 
                </object> 
               </void> 
@@ -294,7 +297,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/pchakka/workspace/oshive/build/ql/tmp/602498110/10001</string> 
+               <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/665057992/10001</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object id="tableDesc2" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -317,6 +320,10 @@
                      <string>serialization.format</string> 
                      <string>1</string> 
                     </void> 
+                    <void method="put"> 
+                     <string>columns.types</string> 
+                     <string>string:string</string> 
+                    </void> 
                    </object> 
                   </void> 
                  </object> 
@@ -334,7 +341,7 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/pchakka/workspace/oshive/build/ql/tmp/907054306/10000</string> 
+                     <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/1796533964/10000</string> 
                     </void> 
                     <void property="tableInfo"> 
                      <object idref="tableDesc2"/> 
@@ -503,7 +510,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/pchakka/workspace/oshive/build/ql/test/data/warehouse/src</string> 
+            <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
            </void> 
           </object> 
          </void> 
@@ -571,7 +578,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/pchakka/workspace/oshive/build/ql/test/data/warehouse/src</string> 
+            <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
            </void> 
           </object> 
          </void> 
@@ -618,7 +625,7 @@
                                    <int>1</int> 
                                   </void> 
                                   <void property="dirName"> 
-                                   <string>file:/data/users/pchakka/workspace/oshive/build/ql/tmp/602498110/10001</string> 
+                                   <string>file:/data/users/njain/hive1/hive1/build/ql/tmp/665057992/10001</string> 
                                   </void> 
                                   <void property="tableInfo"> 
                                    <object idref="tableDesc2"/> 
@@ -1458,7 +1465,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/pchakka/workspace/oshive/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>null-subquery1:unioninput-subquery1:src</string> 
@@ -1473,7 +1480,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/pchakka/workspace/oshive/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive1/hive1/build/ql/test/data/warehouse/src</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/serde/src/gen-java/org/apache/hadoop/hive/serde/Constants.java b/serde/src/gen-java/org/apache/hadoop/hive/serde/Constants.java
index 37df1f8d29..4a5c178bea 100644
--- a/serde/src/gen-java/org/apache/hadoop/hive/serde/Constants.java
+++ b/serde/src/gen-java/org/apache/hadoop/hive/serde/Constants.java
@@ -70,6 +70,10 @@ public class Constants {
   public static final String MAP_TYPE_NAME = "map";
 
   public static final String STRUCT_TYPE_NAME = "struct";
+  
+  public static final String LIST_COLUMNS = "columns";
+  
+  public static final String LIST_COLUMN_TYPES = "columns.types";
 
   public static final Set<String> PrimitiveTypes = new HashSet<String>();
   static {
diff --git a/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazySimpleSerDe.java b/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazySimpleSerDe.java
index 15be0a1f17..8114a018f1 100644
--- a/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazySimpleSerDe.java
+++ b/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazySimpleSerDe.java
@@ -67,6 +67,7 @@ public class LazySimpleSerDe implements SerDe {
   final public static byte[] DefaultSeparators = {(byte)1, (byte)2, (byte)3};
 
   private ObjectInspector cachedObjectInspector;
+  private boolean         useJSONSerialize; // use json to serialize
 
   public String toString() {
     return getClass().toString()
@@ -212,9 +213,9 @@ public static SerDeParameters initSerdeParams(Configuration job,
         .equalsIgnoreCase("true"));
 
     // Read the configuration parameters
-    String columnNameProperty = tbl.getProperty("columns");
+    String columnNameProperty = tbl.getProperty(Constants.LIST_COLUMNS);
     // NOTE: if "columns.types" is missing, all columns will be of String type
-    String columnTypeProperty = tbl.getProperty("columns.types");
+    String columnTypeProperty = tbl.getProperty(Constants.LIST_COLUMN_TYPES);
 
     // Parse the configuration parameters
 
@@ -374,7 +375,7 @@ public Writable serialize(Object obj, ObjectInspector objInspector)
         if (!foi.getCategory().equals(Category.PRIMITIVE)
             && (declaredFields == null || 
                 declaredFields.get(i).getFieldObjectInspector().getCategory()
-                .equals(Category.PRIMITIVE))) {
+                .equals(Category.PRIMITIVE) || useJSONSerialize)) {
           serialize(serializeStream, SerDeUtils.getJSONString(f, foi),
               PrimitiveObjectInspectorFactory.javaStringObjectInspector,
               serdeParams.separators, 1, serdeParams.nullSequence,
@@ -493,4 +494,18 @@ public static void serialize(ByteStream.Output out, Object obj,
     throw new RuntimeException("Unknown category type: "
         + objInspector.getCategory());
   }
+
+  /**
+   * @return the useJSONSerialize
+   */
+  public boolean isUseJSONSerialize() {
+    return useJSONSerialize;
+  }
+
+  /**
+   * @param useJSONSerialize the useJSONSerialize to set
+   */
+  public void setUseJSONSerialize(boolean useJSONSerialize) {
+    this.useJSONSerialize = useJSONSerialize;
+  }
 }
diff --git a/service/if/hive_service.thrift b/service/if/hive_service.thrift
index 2b9bddcffd..3ea6a9f23b 100644
--- a/service/if/hive_service.thrift
+++ b/service/if/hive_service.thrift
@@ -50,6 +50,6 @@ service ThriftHive extends hive_metastore.ThriftHiveMetastore {
   list<string> fetchAll() throws(1:HiveServerException ex)
 
   # Get the Thrift DDL string of the query result
-  string getSchema() throws(1:HiveServerException ex)
+  hive_metastore.Schema getSchema() throws(1:HiveServerException ex)
 
 }
diff --git a/service/src/gen-javabean/org/apache/hadoop/hive/service/ThriftHive.java b/service/src/gen-javabean/org/apache/hadoop/hive/service/ThriftHive.java
index 0fbc35a843..b1c4e53d06 100644
--- a/service/src/gen-javabean/org/apache/hadoop/hive/service/ThriftHive.java
+++ b/service/src/gen-javabean/org/apache/hadoop/hive/service/ThriftHive.java
@@ -28,7 +28,7 @@ public interface Iface extends org.apache.hadoop.hive.metastore.api.ThriftHiveMe
 
     public List<String> fetchAll() throws HiveServerException, TException;
 
-    public String getSchema() throws HiveServerException, TException;
+    public org.apache.hadoop.hive.metastore.api.Schema getSchema() throws HiveServerException, TException;
 
   }
 
@@ -182,7 +182,7 @@ public List<String> recv_fetchAll() throws HiveServerException, TException
       throw new TApplicationException(TApplicationException.MISSING_RESULT, "fetchAll failed: unknown result");
     }
 
-    public String getSchema() throws HiveServerException, TException
+    public org.apache.hadoop.hive.metastore.api.Schema getSchema() throws HiveServerException, TException
     {
       send_getSchema();
       return recv_getSchema();
@@ -197,7 +197,7 @@ public void send_getSchema() throws TException
       oprot_.getTransport().flush();
     }
 
-    public String recv_getSchema() throws HiveServerException, TException
+    public org.apache.hadoop.hive.metastore.api.Schema recv_getSchema() throws HiveServerException, TException
     {
       TMessage msg = iprot_.readMessageBegin();
       if (msg.type == TMessageType.EXCEPTION) {
@@ -1442,7 +1442,7 @@ public String toString() {
   }
 
   public static class getSchema_result implements TBase, java.io.Serializable   {
-    private String success;
+    private org.apache.hadoop.hive.metastore.api.Schema success;
     private HiveServerException ex;
 
     public final Isset __isset = new Isset();
@@ -1455,7 +1455,7 @@ public getSchema_result() {
     }
 
     public getSchema_result(
-      String success,
+      org.apache.hadoop.hive.metastore.api.Schema success,
       HiveServerException ex)
     {
       this();
@@ -1465,16 +1465,17 @@ public getSchema_result(
       this.__isset.ex = true;
     }
 
-    public String getSuccess() {
+    public org.apache.hadoop.hive.metastore.api.Schema getSuccess() {
       return this.success;
     }
 
-    public void setSuccess(String success) {
+    public void setSuccess(org.apache.hadoop.hive.metastore.api.Schema success) {
       this.success = success;
       this.__isset.success = true;
     }
 
     public void unsetSuccess() {
+      this.success = null;
       this.__isset.success = false;
     }
 
@@ -1541,8 +1542,9 @@ public void read(TProtocol iprot) throws TException {
         switch (field.id)
         {
           case 0:
-            if (field.type == TType.STRING) {
-              this.success = iprot.readString();
+            if (field.type == TType.STRUCT) {
+              this.success = new org.apache.hadoop.hive.metastore.api.Schema();
+              this.success.read(iprot);
               this.__isset.success = true;
             } else { 
               TProtocolUtil.skip(iprot, field.type);
@@ -1574,10 +1576,10 @@ public void write(TProtocol oprot) throws TException {
       if (this.__isset.success) {
         if (this.success != null) {
           field.name = "success";
-          field.type = TType.STRING;
+          field.type = TType.STRUCT;
           field.id = 0;
           oprot.writeFieldBegin(field);
-          oprot.writeString(this.success);
+          this.success.write(oprot);
           oprot.writeFieldEnd();
         }
       } else if (this.__isset.ex) {
diff --git a/service/src/gen-php/ThriftHive.php b/service/src/gen-php/ThriftHive.php
index 9a9072c923..eacf4d0d7f 100644
--- a/service/src/gen-php/ThriftHive.php
+++ b/service/src/gen-php/ThriftHive.php
@@ -1003,7 +1003,8 @@ class ThriftHive_getSchema_result {
       self::$_TSPEC = array(
         0 => array(
           'var' => 'success',
-          'type' => TType::STRING,
+          'type' => TType::STRUCT,
+          'class' => 'metastore_Schema',
           ),
         1 => array(
           'var' => 'ex',
@@ -1042,8 +1043,9 @@ class ThriftHive_getSchema_result {
       switch ($fid)
       {
         case 0:
-          if ($ftype == TType::STRING) {
-            $xfer += $input->readString($this->success);
+          if ($ftype == TType::STRUCT) {
+            $this->success = new metastore_Schema();
+            $xfer += $this->success->read($input);
           } else {
             $xfer += $input->skip($ftype);
           }
@@ -1070,8 +1072,11 @@ class ThriftHive_getSchema_result {
     $xfer = 0;
     $xfer += $output->writeStructBegin('ThriftHive_getSchema_result');
     if ($this->success !== null) {
-      $xfer += $output->writeFieldBegin('success', TType::STRING, 0);
-      $xfer += $output->writeString($this->success);
+      if (!is_object($this->success)) {
+        throw new TProtocolException('Bad type in structure.', TProtocolException::INVALID_DATA);
+      }
+      $xfer += $output->writeFieldBegin('success', TType::STRUCT, 0);
+      $xfer += $this->success->write($output);
       $xfer += $output->writeFieldEnd();
     }
     if ($this->ex !== null) {
diff --git a/service/src/gen-py/hive_service/ThriftHive-remote b/service/src/gen-py/hive_service/ThriftHive-remote
index c7e636e922..fb7509074f 100644
--- a/service/src/gen-py/hive_service/ThriftHive-remote
+++ b/service/src/gen-py/hive_service/ThriftHive-remote
@@ -25,7 +25,7 @@ if len(sys.argv) <= 1 or sys.argv[1] == '--help':
   print '  string fetchOne()'
   print '   fetchN(i32 numRows)'
   print '   fetchAll()'
-  print '  string getSchema()'
+  print '  Schema getSchema()'
   print ''
   sys.exit(0)
 
diff --git a/service/src/gen-py/hive_service/ThriftHive.py b/service/src/gen-py/hive_service/ThriftHive.py
index 6bf3422e4c..e8926e7613 100644
--- a/service/src/gen-py/hive_service/ThriftHive.py
+++ b/service/src/gen-py/hive_service/ThriftHive.py
@@ -791,7 +791,7 @@ def __ne__(self, other):
 class getSchema_result:
 
   thrift_spec = (
-    (0, TType.STRING, 'success', None, None, ), # 0
+    (0, TType.STRUCT, 'success', (hive_metastore.ttypes.Schema, hive_metastore.ttypes.Schema.thrift_spec), None, ), # 0
     (1, TType.STRUCT, 'ex', (HiveServerException, HiveServerException.thrift_spec), None, ), # 1
   )
 
@@ -814,8 +814,9 @@ def read(self, iprot):
       if ftype == TType.STOP:
         break
       if fid == 0:
-        if ftype == TType.STRING:
-          self.success = iprot.readString();
+        if ftype == TType.STRUCT:
+          self.success = hive_metastore.ttypes.Schema()
+          self.success.read(iprot)
         else:
           iprot.skip(ftype)
       elif fid == 1:
@@ -835,8 +836,8 @@ def write(self, oprot):
       return
     oprot.writeStructBegin('getSchema_result')
     if self.success != None:
-      oprot.writeFieldBegin('success', TType.STRING, 0)
-      oprot.writeString(self.success)
+      oprot.writeFieldBegin('success', TType.STRUCT, 0)
+      self.success.write(oprot)
       oprot.writeFieldEnd()
     if self.ex != None:
       oprot.writeFieldBegin('ex', TType.STRUCT, 1)
diff --git a/service/src/java/org/apache/hadoop/hive/service/HiveServer.java b/service/src/java/org/apache/hadoop/hive/service/HiveServer.java
index 26abb3a1d0..8cec7e8498 100644
--- a/service/src/java/org/apache/hadoop/hive/service/HiveServer.java
+++ b/service/src/java/org/apache/hadoop/hive/service/HiveServer.java
@@ -18,30 +18,16 @@
 
 package org.apache.hadoop.hive.service;
 
-import java.io.PrintStream;
 import java.util.List;
-import java.util.Map;
 import java.util.Vector;
 
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
-import org.apache.hadoop.conf.Configuration;
-import org.apache.hadoop.fs.Path;
 import org.apache.hadoop.hive.conf.HiveConf;
-import org.apache.hadoop.hive.ql.plan.tableDesc;
-import org.apache.hadoop.hive.ql.exec.ColumnInfo;
 import org.apache.hadoop.hive.service.ThriftHive;
-import org.apache.hadoop.hive.service.ThriftHive.*;
 import org.apache.hadoop.hive.service.HiveServerException;
 import org.apache.hadoop.hive.ql.session.SessionState;
-import org.apache.hadoop.hive.serde2.Deserializer;
-import org.apache.hadoop.hive.serde2.SerDeException;
-import org.apache.hadoop.util.ReflectionUtils;
-import org.apache.hadoop.util.StringUtils;
 
-import com.facebook.fb303.FacebookBase;
-import com.facebook.fb303.FacebookService;
-import com.facebook.fb303.fb_status;
 import com.facebook.thrift.TException;
 import com.facebook.thrift.TProcessor;
 import com.facebook.thrift.TProcessorFactory;
@@ -133,11 +119,11 @@ public void execute(String cmd) throws HiveServerException, TException {
     /**
      * Return the schema of the query result
      */
-    public String getSchema() throws HiveServerException, TException {
+    public Schema getSchema() throws HiveServerException, TException {
       try {
-        String schema = driver.getSchema();
+        Schema schema = driver.getSchema();
         if (schema == null) {
-          schema = "";
+          schema = new Schema();
         }
         LOG.info("Returning schema: " + schema);
         return schema;
diff --git a/service/src/test/org/apache/hadoop/hive/service/TestHiveServer.java b/service/src/test/org/apache/hadoop/hive/service/TestHiveServer.java
index 4d44bb9862..2e11c88e0a 100644
--- a/service/src/test/org/apache/hadoop/hive/service/TestHiveServer.java
+++ b/service/src/test/org/apache/hadoop/hive/service/TestHiveServer.java
@@ -4,6 +4,9 @@
 
 import org.apache.hadoop.fs.Path;
 import junit.framework.TestCase;
+
+import org.apache.hadoop.hive.metastore.api.FieldSchema;
+import org.apache.hadoop.hive.metastore.api.Schema;
 import org.apache.hadoop.hive.service.HiveInterface;
 import org.apache.hadoop.hive.service.HiveClient;
 import org.apache.hadoop.hive.service.HiveServer;
@@ -77,7 +80,11 @@ public void testExecute() throws Exception {
       client.execute("select count(1) as cnt from " + tableName);
       String row = client.fetchOne();
       assertEquals(row, "500");
-      assertEquals("struct result { string cnt}#cnt#string", client.getSchema());
+      Schema schema = client.getSchema();
+      List<FieldSchema> listFields = schema.getFieldSchemas();
+      assertEquals(listFields.size(), 1);
+      assertEquals(listFields.get(0).getName(), "cnt");
+      assertEquals(listFields.get(0).getType(), "i64");
       client.execute("drop table " + tableName);
     }
     catch (Throwable t) {
@@ -171,7 +178,18 @@ public void testDynamicSerde() throws Exception {
     Properties dsp = new Properties();
     dsp.setProperty(Constants.SERIALIZATION_FORMAT, org.apache.hadoop.hive.serde2.thrift.TCTLSeparatedProtocol.class.getName());
     dsp.setProperty(org.apache.hadoop.hive.metastore.api.Constants.META_TABLE_NAME, "result");
-    dsp.setProperty(Constants.SERIALIZATION_DDL, client.getSchema().split("#")[0]);
+    String serDDL = new String("struct result { ");
+    List<FieldSchema> schema = client.getSchema().getFieldSchemas();
+    for (int pos = 0; pos < schema.size(); pos++) {
+      if (pos != 0) 
+          serDDL = serDDL.concat(",");
+      serDDL = serDDL.concat(schema.get(pos).getType());
+      serDDL = serDDL.concat(" ");
+      serDDL = serDDL.concat(schema.get(pos).getName());
+    }
+    serDDL = serDDL.concat("}");
+
+    dsp.setProperty(Constants.SERIALIZATION_DDL, serDDL);
     dsp.setProperty(Constants.SERIALIZATION_LIB, ds.getClass().toString());
     dsp.setProperty(Constants.FIELD_DELIM, "9");
     ds.initialize(new Configuration(), dsp);
@@ -181,13 +199,25 @@ public void testDynamicSerde() throws Exception {
 
     assertEquals(o.getClass().toString(), "class java.util.ArrayList");
     List<?> lst = (List<?>)o;
-    assertEquals(lst.get(0), "238");
+    assertEquals(lst.get(0), 238);
 
     // TODO: serde doesn't like underscore  -- struct result { string _c0}
     sql = "select count(1) as c from " + tableName;
     client.execute(sql);
     row = client.fetchOne();
-    dsp.setProperty(Constants.SERIALIZATION_DDL, client.getSchema().split("#")[0]);
+
+    serDDL = new String("struct result { ");
+    schema = client.getSchema().getFieldSchemas();
+    for (int pos = 0; pos < schema.size(); pos++) {
+      if (pos != 0) 
+          serDDL = serDDL.concat(",");
+      serDDL = serDDL.concat(schema.get(pos).getType());
+      serDDL = serDDL.concat(" ");
+      serDDL = serDDL.concat(schema.get(pos).getName());
+    }
+    serDDL = serDDL.concat("}");
+
+    dsp.setProperty(Constants.SERIALIZATION_DDL, serDDL);
     // Need a new DynamicSerDe instance - re-initialization is not supported.
     ds = new DynamicSerDe();
     ds.initialize(new Configuration(), dsp);
