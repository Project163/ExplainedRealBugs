diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/tez/DagUtils.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/tez/DagUtils.java
index c342801f4d..a54d8b7829 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/tez/DagUtils.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/tez/DagUtils.java
@@ -156,8 +156,8 @@ public static Edge createEdge(JobConf vConf, Vertex v, JobConf wConf, Vertex w)
     // all edges are of the same type right now
     EdgeProperty edgeProperty =
         new EdgeProperty(ConnectionPattern.BIPARTITE, SourceType.STABLE,
-            new OutputDescriptor(OnFileSortedOutput.class.getName(), null),
-            new InputDescriptor(ShuffledMergedInput.class.getName(), null));
+            new OutputDescriptor(OnFileSortedOutput.class.getName()),
+            new InputDescriptor(ShuffledMergedInput.class.getName()));
     return new Edge(v, w, edgeProperty);
   }
 
@@ -204,8 +204,8 @@ private static Vertex createVertex(JobConf conf, MapWork mapWork, int seqNo,
     Vertex map = null;
     if (inputSplitInfo.getNumTasks() != 0) {
       map = new Vertex("Map "+seqNo,
-          new ProcessorDescriptor(MapProcessor.class.getName(),
-              MRHelpers.createUserPayloadFromConf(conf)),
+          new ProcessorDescriptor(MapProcessor.class.getName()).
+               setUserPayload(MRHelpers.createUserPayloadFromConf(conf)),
           inputSplitInfo.getNumTasks(), MRHelpers.getMapResource(conf));
       Map<String, String> environment = new HashMap<String, String>();
       MRHelpers.updateEnvironmentForMRTasks(conf, environment, true);
@@ -277,9 +277,9 @@ private static Vertex createVertex(JobConf conf, ReduceWork reduceWork, int seqN
 
     // create the vertex
     Vertex reducer = new Vertex("Reducer "+seqNo,
-        new ProcessorDescriptor(ReduceProcessor.class.getName(),
-            MRHelpers.createUserPayloadFromConf(conf)),
-            reduceWork.getNumReduceTasks(), MRHelpers.getReduceResource(conf));
+        new ProcessorDescriptor(ReduceProcessor.class.getName()).
+             setUserPayload(MRHelpers.createUserPayloadFromConf(conf)),
+        reduceWork.getNumReduceTasks(), MRHelpers.getReduceResource(conf));
 
     Map<String, String> environment = new HashMap<String, String>();
 
